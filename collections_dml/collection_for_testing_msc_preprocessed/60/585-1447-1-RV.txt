vyacheslav m abramov optimal control of a large dam with compound poisson input and costs depending on water levels abstract this paper studies a discrete model of a large dam where the difference between lower and upper levels l is assumed to be large passage across the levels leads to damage and the damage costs of crossing the lower or upper level are proportional to the large parameter l input stream of water is described by compound poisson process and the water cost depends upon current level of water in the dam the aim of the paper is to choose the parameters of output stream specifically defined in the paper minimizing the long run expenses that include the damage costs and water costs the present paper addresses the important question how does the structure of water costs affect the optimal solution we prove the existence and uniqueness of a solution a special attention is attracted to the case of linear structure of the costs as well the paper contributes to the theory of state dependent queue ing systems the inter relations between important characteristics of a state dependent queueing system are established and their asymptotic analysis that involves analytic techniques of tauberian theory and heavy traffic approximations is provided contents 1 introduction 5 1 1 description of the system and formulation of the problem 5 1 2 motivation discussion of the study and review of related literature 7 1 3 organization of the paper 10 2 methodology of analysis 11 2 1 state dependent queueing system with poisson input and its characteristics 11 2000 mathematical subject classification 60 k 30 40 e 05 90 b 05 60 k 25 key words and phrases state dependent queue compound poisson in put asymptotic analysis control problem heavy traffic analysis tauberian theorems 3 4 v abramov 2 2 state dependent queueing system with compound poisson input and its characteristics 13 3 main result 24 3 1 heavy traffic conditions 24 3 2 series of objective functions 25 3 3 formulation of the main result 27 4 asymptotic theorems for the stationary probabilities p 1 and p 2 27 4 1 preliminaries 27 4 2 extension of taka cs lemma 28 4 3 exact formulae for p 1 and p 2 29 4 4 preliminary asymptotic expansions for large l 30 4 5 asymptotic theorems for p 1 and p 2 under usual assumptions 32 4 6 asymptotic theorems for p 1 and p 2 under special heavy traffic conditions 34 5 asymptotic theorems for the stationary probabilities qi 35 5 1 explicit representation for the stationary probabilities qi 36 5 2 asymptotic analysis of the stationary probabilities qi the case 1 1 37 5 3 asymptotic analysis of the stationary probabilities qi the case 1 1 l 38 5 4 asymptotic analysis of the stationary probabilities qi the case 1 1 l 38 6 derivations for the objective function 40 6 1 the case 1 1 40 6 2 the case 1 1 l 41 6 3 the case 1 1 l 41 7 a solution to the control problem and its properties 41 7 1 alternative representations for the last terms in the objective functions and their properties 42 7 2 proof of the main result and discussion of optimal solution 43 8 example of linear costs 46 9 numerical study 48 10 proofs 49 proof of lemma 4 8 49 proof of theorem 4 10 50 proof of theorem 4 13 51 proof of theorem 4 15 52 proof of theorem 5 3 53 proof of theorem 5 4 54 proof of proposition 6 2 55 proof of proposition 6 3 56 proof of lemma 7 1 57 optimal control of a large dam 5 proof of lemma 7 2 58 proof of lemma 7 3 60 proof of lemma 7 4 61 acknowledgements 62 references 62 1 introduction 1 1 description of the system and formulation of the problem the paper studies a discrete model of a large dam a large dam is specified by the parameters llower and lupper which are respectively the lower and upper levels of the dam if the current water level is between these bounds the dam is assumed to be in a normal state the difference l lupper llower is large and this is the reason for calling the dam large this feature enables us to use asymptotic analysis as l and solve different problems of optimal control a direct way without an asymptotic analysis is very hard let lt denote the water level at time t if l lower lt lupper then the state of the dam is called normal passage across upper level flooding or reaching lower level emptiness lead to damage the costs per unit time of this damage are 1 1 j 1 j 1 l for the lower level and respectively 1 2 j 2 j 2 l for the upper level where j 1 and j 2 are given real constants in real dams that are large the damage costs are proportional to the capacity of dam the water inflow is described by a compound poisson process namely the probability generating function of input amount of water which is assumed to be an integer valued random variable in an interval t is given by 1 3 ft z exp t 1 i 1 riz i where ri is the probability that at a specified moment of poisson arrival the amount of water will increase by i units in practice this means that the arrival of water is registered at random instants t 1 t 2 the times between consecutive instants are mutually independent and exponentially distributed with parameter and quantities of water number of water units of input flow are specified as a quantity i with probability ri r 1 r 2 1 clearly that this assumption is more applicable to real 6 v abramov world problems than the assumption of 4 where the inter arrival times of water units are exponentially distributed with parameter for example the assumption made in the present paper enables us to approach a continuous dammodel assuming that the water levels lt take the discrete values j where j is a positive integer and step is a positive small real constant in the paper the water levels lt are assumed to be integer valued the aforementioned set of values j for water levels can be obtained by scaling the outflow of water is state dependent as follows if the level of wa ter is between llower and lupper then an interval between departures of water units has the probability distribution function b 1 x c depend ing on parameter c the meaning of which will become clear later if the level of water exceeds lupper then an interval between departures of water units has the probability distribution function b 2 x the probability distribution function b 2 x is assumed to obey the condi tion 0 xdb 2 x 1 e where e is the mean batch size if the level of water is llower exactly then output of water is frozen and it resumes again as soon as the level of water exceeds the level llower the exact mathematical formulation of the problem taking into account some specific details is given below let clt denote the cost of water at level lt the sequence ci is as sumed to be positive and non increasing the problem of the present paper is to choose the parameter c and specifically 0 xdb 1 x c and 0 x 2 db 1 x c of the dam in the normal state minimizing the ob jective function 1 4 j p 1 j 1 p 2 j 2 lupper i llower 1 ciqi where p 1 lim t pr lt llower 1 5 p 2 lim t pr lt lupper 1 6 qi lim t pr lt llower i i 1 2 l 1 7 and j 1 and j 2 are defined in 1 1 and 1 2 usually llower is identified with an empty queue i e llower 0 and lupper l just this assumption is made in the paper and the dam model is the following queueing system with service depending on queue length if immediately before moment of a service start the number of customers in the system exceeds the level l then the customer is served by the probability distribution function b 2 x otherwise the service time distribution is b 1 x the value p 1 is the stationary probability of an empty system the value p 2 is the stationary probability that a customer optimal control of a large dam 7 is served by probability distribution b 2 x and qi i 1 2 l are the stationary probabilities of the queue length process so p 1 p 2 l i 1 qi 1 for the described queueing system the right hand side limits in relations 1 5 1 7 do exist so in the present paper we assume that llower 0 and lupper l we also assume that initial water level is 0 in our study the parameter l increases unboundedly and we deal with the series of queueing systems the above parameters such as p 1 p 2 j 1 j 2 as well as other parameters are functions of l the argument l will be often omitted in these functions 1 2 motivation discussion of the study and review of related literature similarly to 4 it is assumed that the input parameter the probabilities r 1 r 2 and probability distribution function b 2 x are given while the appropriate probability distribution function b 1 x c should be found from the specified parametric family of functionsb 1 x c where 1 8 c lim l l l where l is a specified nonnegative vanishing parameter of the system as l the reason of solving this specific problem where the probability dis tribution function b 2 x is given while the probability distribution func tioned b 1 x c is controlled is that in practical problems of the water resources planning it is important to know how much water should be used per unit time in order to minimize the risks of the disasters such as emptiness or flooding the dam the outflow rate should be chosen such that to minimize the objective function of 1 4 with respect to the parameter c which results in choice of the corresponding probability distribution function b 1 x c of that family a particular problem have been studied in 4 a circle of problems associated with the results of 4 are discussed in a review paper 5 the simplest model with poisson input stream and the objective func tion having the form j p 1 j 1 p 2 j 2 i e the water costs are not taken into account has been studied in 4 denote 2 0 xdb 2 x and 1 1 c 0 xdb 1 x c the optimal value of c is unique in a minimization problem precisely formulated in 4 it was shown in 4 that the unique solution to the control problem has one of the three forms given there in the formulation of theorem 5 1 the aforementioned three forms in the formulation of theorem 5 1 in 4 fall into the category of a large area of heavy traffic analysis in queueing theory we mention the books of chen and yao 7 and whitt 33 where a reader can find many other references it has also been shown in 4 that the solution to 8 v abramov the control problem is insensitive to the type of probability distributions b 1 x c and b 2 x specifically it is expressed via the first moment of b 2 x and the first two moments of b 1 x c compared to the earlier studies in 4 the solution of the problems in the present paper requires a much deepen and delicate analysis the results of 4 are extended in two directions 1 the arrival process is compound poisson rather than poisson and 2 structure of water costs in dependence of the level of water in the dam is included the first extension leads to new techniques of stochastic analysis the main challenge in 4 was reducing the certain characteristics of the sys tem during a busy period to the convolution type recurrence relation such as qn n i 0 qn i 1 fi q 0 0 where f 0 0 fi 0 for all i 1 i 0 fi 1 and then using the known results on the asymptotic behaviour of qn as n in the case when arrivals are compound poisson the same characteristics of the system cannot be reduced to the aforementioned convolution type of recurrence relation instead we obtain a more general scheme including as a part the aforementioned recurrence relation in this case asymptotic analysis of the required characteristics becomes very challenging it is based on special stochas tic domination methods the second extension leads to new analytic techniques of asymptotic analysis asymptotic methods of 4 are no longer working and more delicate techniques should be used instead that is instead of taka cs asymptotic theorems 31 p 22 23 special tauberian theorems with re mainder by postnikov 21 sect 25 should be used for different applica tions of the aforementioned taka cs asymptotic theorems and tauberian theorems of postnikov see 5 another challenging problem for the dam model in the present paper is the solution to the control problem that is the proof of a uniqueness of the optimal solution in the case of the model in 4 the existence and uniqueness of a solution follows automatically from the explicit represen tations of the functionals obtained there the existence of a solution follows from the fact that in the case 1 1 we get a bounded value of the functional while in the cases 1 1 and 1 1 the functional is unbounded then the uniqueness of a solution reduces to elementary minimization problem for smooth convex functions in the case of the model in the present paper the solution of the problem with extended criteria 1 4 is related to the same set of solutions as in 4 that is it must be either 1 1 or one of the two limits of 1 1 l 1 1 l for positive small vanishing l as the series parameter l increases unboundedly and l l c in the present study it is convenient to define the parameter c as 1 9 c lim l l 1 l 1 optimal control of a large dam 9 and use c l l 1 l 1 as a series parameter hence it is quite nat ural to consider 1 l as a control sequence while c l is a sequence de rivative from 1 l furthermore in this case c l is expressed uniquely via 1 l and vice versa the definition of the parameter c given here differs from that definition given in 4 unlike 4 where c was defined as a nonnegative control parameter see 1 8 in the present definition 1 9 the value of c can be either positive or negative unlike 4 we use the notation 1 l l l 0 xldb 1 x c l l 2 3 the existence of 1 3 l i e the moments of the third order of b 1 x c l will be specially assumed in the formulations of the state ments corresponding to the case studies it is assumed in the present paper that ci is a nonincreasing sequence if the cost sequence ci were an arbitrary bounded sequence then a richer set of possible cases could be studied however in the case of arbitrary cost sequence the solution does not need be unique a nonincreasing sequence ci depends on l in series this means that as l changes increasing to infinity we have different not increasing sequences see example in section 8 the initial value c 1 and final value cl are taken fixed and strictly positive and the limit of cl as l is assumed to be positive as well realistic models arising in practice assume that the probability dis tribution function b 1 x c should also depend on i i e have the repre sentation b 1 i x c the model of the present paper where b 1 x c is the same for all i under appropriate additional information can ap proximate those more general models namely one can suppose that the stationary service time distribution b 1 x c has the representation b 1 x c l i 1 qib 1 i x c qi i 1 2 l are the state proba bilities and the solution to the control problem for b 1 x c enables us to find then the approximate solution to the control problem for b 1 i x c i 1 2 l the additional information about b 1 i x c i 1 2 l might be that all these distributions belong to the same parametric family of distributions with known relationships between the values of a parameter for instance the simplest model can be of the formb 1 x c ab 1 x c bb 1 x c where the distributionsb 1 x c and b 1 x c are of the same type say two phase erlang distributions a l 0 i 1 qi l 0 l and respectively b l i l 0 1 qi and the rela tionship between the means 0 xdb 1 x c 0 xdb 1 x c is known in the present paper we address the following questions 10 v abramov uniqueness of an optimal solution and its structure interrelation between the parameters j 1 j 2 2 ci i 1 2 l when the optimal solution is 1 1 the uniqueness of an optimal solution is given by theorem 3 7 in the case of the model considered in 4 the condition when the optimal solution is 1 1 the interrelation between the parameters j 1 j 2 and 2 is j 1 j 2 2 1 2 in the case of the model considered in this paper when the optimal solution is 1 1 the interrelation between the aforementioned and some additional parameters gives us the inequality j 1 j 2 2 1 2 see section 7 corollary 7 5 a more exact result is obtained in the particular case of linearly de creasing costs as the level of water increases for brevity this case is called linear costs in this case a numerical solution of the problem is given the solution to the control problem enables us to find optimal initial condition of the system the steady state distribution under which the optimal value of the control parameter 1 l is achieved is associated with the optimal initial level of water in the dam 1 3 organization of the paper the rest of the paper is organized as follows in section 2 the main ideas and methods of asymptotic anal ysis are given in section 2 1 we recall the basic methods related to state dependent queueing system with ordinary poisson input that have been used in 4 then in section 2 2 extensions of these methods for the model considered in this paper are given specifically the methodol ogy of constructing linear representations between mean characteristics given during a busy period is explained main results of the paper are formulated in section 3 the sections following after section 3 are of two types the first type of the results is presented in sections 4 and 5 these large sections present the preliminary results of the paper and study the characteristics of the system their asymptotic behaviour and specifically the asymptotic behaviour of different stationary probabilities the second type of the results is presented in sections 6 7 8 and 9 and related to the solution to the control problem and further study of its properties in section 4 the asymptotic behavior of the stationary probabilities p 1 and p 2 for specific sets of states are studied in section 4 1 known tauberian theorems that are used in the asymptotic analysis in the paper are recalled section 4 3 establishes explicit formulae for the probabilities p 1 and p 2 in section 4 4 some preliminary results are established for the further study of asymptotic behaviour of stationary probabilities p 1 and p 2 as l in sections 4 5 and 4 6 section 5 is devoted to asymptotic analysis of the stationary probabilities ql i i 1 2 in section 5 1 optimal control of a large dam 11 the explicit representation for the stationary probabilities qi is derived on the basis of this explicit representation and tauberian theorems in following sections 5 2 5 3 and 5 4 asymptotic theorems for these station ary probabilities are established in the cases 1 1 1 1 l and 1 1 l correspondingly where positive l is assumed vanishing such that l 1 l 1 c as l in section 6 the objective func tion given in 1 4 is studied in following sections 6 1 6 2 and 6 3 the asymptotic theorems for this objective function are established for the cases 1 1 1 1 l and 1 1 l correspondingly in section 7 the theorem on existence and uniqueness of a solution is proved in section 8 the case of linear costs is studied numerical results relevant to section 8 are provided in section 9 section 10 contains long proofs of the lemmas theorems and propositions formulated in the paper 2 methodology of analysis in this section we describe the methodology used in the present paper this is very important for the following two reasons the first reason is that the standard approach of a diffusion approximation transient of a dam process with the following computation of the stationary distri bution of the diffusion is hard because in that case we should deal with the interchange of the order of limits see discussion on the page 514 of whitt 34 as well as in whitt 35 the second reason is that the earlier methods of 4 do not work for this extended model and hence need in substantial revision we start from the model where arrivals are poisson and then we ex plain how the methods should be developed for the model where an arrival process is compound poisson in this and later sections we write b 1 x rather than b 1 x c as well the parameter l will be omitted from the related notation for the characteristics of the system 2 1 state dependent queueing system with poisson input and its characteristics in this section we consider the simplest model in which arrival flow is poisson with parameter the service time de pends upon queue length as follows if immediately before a service of a customer the number of customers in the system is not greater than l then the probability distribution function is b 1 x otherwise if the number of customers in the system exceeds l then the probability dis tribution function is b 2 x note that in the case when l 0 then the only first customer arrived in a busy period has the probability distribu tion function is b 1 x all other has the probability distribution function b 2 x let tl denote the length of a busy period of this system and let t 1 l t 2 l denote the cumulative times spent for service of customers arrived 12 v abramov during that busy period with probability distribution functions b 1 x and b 2 x correspondingly for k 1 2 the expectations of service times will be denoted by 1 k 0 xdbk x and the loads by k k let l 1 l and 2 l denote correspondingly the number of served customers during a busy period and the numbers of those customers served by the probability distribution functions b 1 x and b 2 x the random variable t 1 l coincides in distribution with a busy period of them g 1 l queueing system l is the number of waiting places excluding the place for server the elementary explanation of this fact is based on a property of level crossings and the property of the lack of memory of exponential distribution e g 4 so the analytic representation for et 1 l is the same as this for the expected busy period of the m g 1 l queueing system the recurrence relation for the laplace stieltjes transform and consequently that for the expected busy period of them g 1 l queueing system has been derived by tomko 32 see also cooper and tilt 8 so for et 1 l the following recurrence relation is satisfied 2 1 et 1 l l i 0 et 1 l i 1 0 e x x i i db 1 x where et 1 0 1 1 remark 2 1 the random variable t 1 i is defined similarly to that of t 1 l in that case the parameter i is the threshold value of the model and the set et 1 i may be thought as the set of mean busy periods of m g 1 i queueing systems with the same parameter of poisson input the same probability distribution of service time but different number of waiting places recurrence relation 2 1 is a particular form of the recurrence relation 2 2 qn n i 0 qn i 1 fi where q 0 0 f 0 0 fi 0 i 1 2 and i 0 fi 1 see taka cs 31 using the obvious system of equations given by 2 1 and 2 2 in 4 and wald s equations see 9 p 384 given by 2 3 and 2 4 in 1 one can express the quantities etl e l et 2 l e 1 l and e 2 l all via et 1 l as the linear functions since equations 2 1 2 4 of 4 should be mentioned many times in this paper we find convenient to list them optimal control of a large dam 13 here for following direct references etl et 1 l et 2 l 2 3 e l e 1 l e 2 l 2 4 et 1 l 1 1 e 1 l 2 5 et 2 l 1 2 e 2 l 2 6 then to obtain the desired linear representations note that the num ber of arrivals during a busy cycle coincides with the total number of customers served during a busy period that is for their expectations we have 2 7 etl 1 etl 1 e l which together with the aforementioned relations 2 3 2 6 yields the linear representations required for example 2 8 e 2 l 1 1 2 1 1 1 1 2 et 1 l and 2 9 et 2 l 2 1 2 2 1 1 1 1 2 et 1 l as a result the stationary probabilities p 1 and p 2 both are expressed via e 1 l as follows p 1 1 2 1 1 2 e 1 l p 2 2 2 1 1 e 1 l 1 1 2 e 1 l it is interesting to note that the coefficients in the linear representations all are insensitive to the probability distribution functions b 1 x and b 2 x and are only expressed via parameters such as 1 2 and the asymptotic behaviour of et 1 l as l that given by 2 1 is established on the basis of the known asymptotic behaviour of the sequence qn as n that given by 2 2 see 31 p 22 21 as well as recent paper 5 to make the paper self contained the necessary results about the asymptotic behaviour of qn as n are given in section 4 1 2 2 state dependent queueing system with compound poisson input and its characteristics 14 v abramov 2 2 1 historic background for mx g 1 l queues certain characteris tics associated with busy periods have been studied by rosenlund 22 developing the results of tomko 32 rosenlund 22 has derived the re currence relations for the joint laplace stieltjes and z transform of two dimensional distributions of a generalized busy period and the number of customers served during that period in turn both of these approaches 32 and 22 are based on a well known taka cs method see 29 or 30 for further analysis 22 used matrix analytic techniques and tech niques of the theory of analytic functions this type of analysis is very hard and seems cannot be easily adapted for the purposes of the present paper where a more general model than that from 22 is studied busy periods and loss characteristics during busy periods for mx g 1 n sys tems have also been studied by pacheco and ribeiro 19 20 and fer reira pacheco and ribeiro 10 along with previously mentioned paper 4 the method of asymptotic analysis closely related to subject matter of this paper have been consid ered by abramov 2 and 3 and further reviewed in 5 the first studies of single server queueing systems with poisson input and service depending on queue length were due to suzuki 25 26 and the paper by suzuki and ebe 27 was probably the first one to consider decision rules problems since then there have been numerous publications related to state dependent queueing systems e g knessl et al 13 14 mandelbaum and pats 15 miller 17 and miller and mcinnes 18 some of these publications include control problems as well basic results for a single server queueing system with poisson input and service depending on queue length can also be found in abramov 1 2 2 2 structure of busy periods and reasoning for the recurrence rela tions of convolution type in this section we explain how the method of section 2 1 can be extended and how the characteristics of the system can be expressed via the similar convolution type recurrence relations to explain the origin of the convolution type recurrence relations in queueing systems and further representation for the required mean char acteristics we recall what the structure of busy period in systems with poisson input is and how this structure is extended from relatively simple systems to more complicated ones let us first recall the structure of a busy period in them g 1 queueing system e g taka cs 29 30 the busy period starts upon arrival of a customer in the idle system if during the service time of the customer no arrival occurs then the length of the busy period coincides with the length of the service if at least one arrival occurs then the structure of busy period is as follows suppose that during a service time there are n arrivals then the time interval from the moment of service beginning when there are n customers in the optimal control of a large dam 15 figure 1 general scheme of a busy period in the m g 1 queue system until the moment when there remain only n 1 customers in the system at the first time after the interval start coincides in distribution with a busy period in figure 1 the typical structure of them g 1 busy period is shown consider now the busy period in the m g 1 queueing system with threshold level l in this system the service time distribution depends on the number of customers in the queue as follows if immediately before the service start the number of customers in the system is greater than l then the service time distribution of that customer is b 2 x otherwise it is b 1 x the typical structure of a busy period is indicated 16 v abramov figure 2 general scheme of a busy period in the state dependent m g 1 queue where l is the threshold level in figure 2 where customers that are over the threshold level served by probability distribution b 2 x are indicated with white color and all other customers served by probability distribution b 1 x are indicated with dark color unlike the case of the standard m g 1 queue without threshold in the case of the state dependent queueing systems with service depending on queue length a time interval from the moment of service beginning when the number of customers in the system is i until the time moment when the number of customers becomes i 1 at the first time since its optimal control of a large dam 17 figure 3 general scheme of a busy period in the mx g 1 queue start depends on i specifically if i l then the length of the afore mentioned cycle is distributed as the state dependent queueing system with the biased threshold equal to l i 1 but if i l then the length of a busy cycle coincides with the length of a busy period of the standard m g 1 queue the service time of customers which is b 2 x then the recurrence relations for the mean busy periods are understandable let us now consider the standard mx g 1 queueing system without threshold the structure of a busy period for this queueing system is given in figure 3 18 v abramov as we can see from the comparison of figures 1 and 3 the only differ ence between them is that in the case of the system with batch arrivals the elements of busy cycles that are indicated in figure 3 are groups of customers rather than isolated customers as in figure 1 that is the number of cycles indicated in figure 3 is associated with the number of batches arrived during the service time of the first batch of arrived customers however in the case of the present queueing system that is with batch arrivals and threshold the structure of a busy period is much more com plicated than that in the previous cases we consider the state dependent queueing system with batch arrivals in the following formulation the arrival of a batch is poisson if immediately before a service start the queue length is not greater than l then the probability distribution func tion of the customer is b 1 x otherwise it is b 2 x the description of the system implies that the first customer in a busy period is served with probability distribution function b 1 x this situation makes the system artificial in the more natural situation when the service depends on queue length at the moment of a service start rather than immedi ately before the service start the structure of the process is more com plicated and its analysis is technically harder however the asymptotic behavior as l increases to infinity is the same to avoid the technical complications the problem is considered in the aforementioned simplified formulation then the linear representations are similar to those derived for the state dependent queueing system with ordinary poisson input indeed equations 2 3 2 6 all hold in the case of the present queueing system as well the first two 2 3 and 2 4 are obvious and 2 5 and 2 6 follow from the same wald s identities as in the case of ordinary poisson arrivals however instead of 2 7 given in section 2 1 the relation between etl and e l in the case of batch arrivals is slightly different specifically 2 10 e etl 1 e etl e e l note that the left hand side of 2 10 can be rewritten in the different way 2 11 e etl 1 1 1 1 1 e etl 1 1 1 e 1 optimal control of a large dam 19 where 1 is the first batch that starts a busy period from 2 11 we have 2 12 e etl 1 1 1 1 e 1 e l 1 the meaning of the quantity 1 1 e 1 on the left hand side of 2 12 is the expected number of customers in the system after the service com pletion of the first customer in the busy period that is the expected number of independent busy cycles after the service completion of the first customer in the busy period is 2 13 e 1 1 1 e 1 the main difficulty however is that the recurrence relation for et 1 l or that for the corresponding quantity e 1 l cannot be presented as a convolution type recurrence relation in simple terms as 2 2 since as it was indicated the structure of a busy period in the case of batch arrivals and threshold becomes very complicated and is not quite similar to that given in figure 2 this is because the size of the first batch is random and this is essentially affected to the complexity however under the assumption that the first batch that starts a busy period contains a single customer only the structure of the busy period will become similar to that given in figure 2 in following figure 4 the typical structure of such busy period is in dicated the number of cycles that are indicated in figure 4 coincides with the number of customers arrived during the service time of the first customer for instance suppose that during the service time of the first customer three batches of customers arrived if the corresponding numbers of customers in those batches are 2 1 and 3 then the total number of cycles is 6 each of these 6 customers is considered as a tagged customer in the corresponding cycle and the structure of the busy period becomes similar to that in figure 2 2 2 3 analysis of the busy period we first start from the structure in dicated in figure 4 for this model let t j j 1 2 l denote the time interval starting from a moment when there are l j 1 customers in the system until the moment when there remain l j customers for the first time since beginning of that interval similarly to the notation used in section 2 1 we introduce the random variables t 1 j t 2 j j 1 j 2 j j 1 2 l which have the same meaning as before specifically when j takes the value l t l is the length a busy period starting from a single customer 1 busy period l is the number of customers that served during a 1 busy period and so on comparison of the busy periods structures in figures 2 and 4 enables us to conclude that taka cs method 29 30 that was applied previously 20 v abramov figure 4 particular scheme of a busy period in the state dependent mx g 1 queue when the first batch contains only one customer l is the threshold level to them g 1 state dependent queueing system is applicable to the state dependent mx g 1 queueing system in which the first batch contains a single customer based on the aforementioned taka cs method the recurrence relation similar to that of 2 1 is 2 14 et 1 l l i 0 et 1 l i 1 0 1 i difx z dzi z 0 db 1 x where et 1 0 1 1 and the generating function fx z is given by 1 3 optimal control of a large dam 21 so the only difference between 2 1 and 2 14 is in their integrands on the right hand side of 2 14 and in the particular case r 1 1 ri 0 i 2 we clearly arrive at the same expression as 2 1 the explicit results associated with recurrence relation 2 14 is given later in the paper apparently the similar system of equations as 2 3 2 6 is satisfied for the characteristics of the state dependent queueing system mx g 1 namely et l et 1 l et 2 l 2 15 e l e 1 l e 2 l 2 16 et 1 l 1 1 e 1 l 2 17 et 2 l 1 2 e 2 l 2 18 therefore the same linear representations via et 1 l hold for character istics of these systems where by 1 and 2 one now should mean the expected numbers of arrived customers per service time not the ex pected number of arrivals having the probability distribution function b 1 x and respectively b 2 x in other words for all l 1 2 we have et l a bet 1 l with 2 19 a 2 1 2 b 1 2 1 1 2 let us now consider the length of a busy period tl and associated ran dom variables t 1 l t 2 l l 1 l and 2 l in the following consideration all these characteristics are associated with queueing models in which a batch size that starts a busy period initial batch size can be different the original batch size that starts a busy period 1 has the distribution pr 1 i ri then the random variable 1 1 1 1 is the total number of customers in the system after the service completion of the first customer in a busy period or the number of independent busy cycles after the service completion of the first customer in a busy period where the random variable 1 denotes the total number of customers arrived during the service time of the first customer in a busy period recall see relation 2 13 that e 1 1 1 e 1 based on this a busy period will be denoted tl 1 and the basic characteristics of the queueing system associated with the busy period will be denoted t 1 l 1 t 2 l 1 l 1 1 l 1 and 2 l 1 another value of the initial characteristic of these random functions that is considered below is 1 l where a b denotes min a b that is instead of the argument 1 in the random functions we will consider the argument 1 l by restricting the space of possible events in which 22 v abramov 1 1 l 1 then the queueing models with different initial charac teristics 1 and 1 l are assumed to be given on the same probability space and the corresponding notation for the characteristics of queueing system in which that argument is 1 l is tl 1 l t 1 l 1 l t 2 l 1 l l 1 l 1 l 1 l and 2 l 1 l the busy period tl 1 can be represented 2 20 tl 1 d 1 1 l i 1 t l i 1 1 l i 1 t 0 i where 1 is the service time of the first customer 1 busy periods t l i 1 i 1 2 l are mutually independent and 1 and 1 are independent of these 1 busy periods hence 1 is also inde pendent of the aforementioned 1 busy periods t 0 i i 1 2 is a sequence of independent and identically dis tributed 1 busy periods of the mx g 1 queueing system the service times of which all are independent and identically distributed random variables having the probability distribution function b 2 x and the dis tributions of interarrival times and batch sizes are the same as in the original state dependent queueing system d denotes the equality in distribution in the case where 1 l 0 the empty sum in 2 20 is assumed to be zero in turn the representation for t 1 l 1 is as follows 2 21 t 1 l 1 d 1 1 l i 1 t 1 l i 1 notice that along with 2 21 we also have 2 22 t 1 l 1 l d 1 1 l l i 1 t 1 l i 1 1 1 l i 1 t 1 l i 1 that is t 1 l 1 and t 1 l 1 l coincide in distribution whereas et 1 l 1 is determined by recurrence relation 2 14 which is a particular case of 2 2 the convolution type recurrence relation as it is mentioned in section 2 2 2 is no longer valid for et 1 l 1 2 2 4 techniques of asymptotic analysis for et 1 l when l large and asso ciated characteristics for the following asymptotic analysis of et 1 l and other mean characteristics such as e 1 l e 2 l we will use the following techniques let fl denotes the algebra of the random variable 1 l optimal control of a large dam 23 then we have an increasing family of algebras f 1 f 2 f where f is the algebra of the random variable 1 apparently pr 1 n n pr 1 n 1 n for all n 1 2 and any fixed n and hence lim l pr 1 l n pr 1 n and consequently for all n 1 2 we have e 1 n e 1 n 1 and consequently lim l e 1 l e 1 from 2 21 and 2 22 we have 2 23 et 1 l 1 l et 1 l 1 for any l 1 based on 2 23 let us now study the mean characteristics etl 1 l et 1 l 1 l et 2 l 1 l e 1 l 1 l and e 2 l 1 l showing first the justice of the linear representations that are similar to those 2 8 and 2 9 writing et i a bet 1 i i 1 2 l where a and b are specified constants by the total expectation formula we obtain etl 1 l ee tl 1 l fl 1 1 l i 1 pr 1 l i i j 1 et l j 1 1 1 l i 1 pr 1 l i i j 1 a bet 1 l i 1 1 1 a l i 1 ipr 1 l i b l i 1 pr 1 l i i j 1 et 1 l i 1 1 1 ae 1 l bee t 1 l 1 l fl 1 1 ae 1 l bet 1 l 1 l hence we obtained the representation 2 24 etl 1 l 1 1 ae 1 l bet 1 l 1 l keeping in mind 2 19 we obtain etl 1 l 1 1 2 1 2 e 1 l 1 2 1 1 2 et 1 l 1 l 24 v abramov 3 main result in this section we formulate the main result of this paper the main result of the paper is based on heavy traffic conditions they are mo tivated by the fact mentioned later in remark 4 12 and based on the statement of theorem 4 10 that the only case 1 1 gives finite limit of the functional j l as l increases to infinity in all other cases where 1 is fixed the functional is not bounded in limit and only in the cases where l 1 l 1 converges to finite limit that is positive negative or zero may give the optimal solution to the control problem so we start from the heavy traffic conditions and explicit representa tions for the objective function under these conditions 3 1 heavy traffic conditions condition 3 1 assume that l 1 l 1 c 0 as l as sume also that 1 3 l is a bounded sequence e 3 and the limit liml 1 2 l 1 2 exists condition 3 2 assume that l 1 l 1 c 0 as l as sume also that 1 3 l is a bounded sequence e 3 and the limit liml 1 2 l 1 2 exists remark 3 3 the case when c 0 is also considered and is related to both of these conditions let b 1 s 0 e sxdb 1 x s 0 condition 3 4 under condition 3 2 let l 1 1 l and assume that there exists 0 0 such that for all l 0 as l each of the functional equations z b 1 z depending on the parameter has a unique solution in the interval 1 remark 3 5 conditions 3 1 and 3 2 contain some technical assump tions such as 1 3 l e 3 and the existence of the limit liml 1 2 l 1 2 the aforementioned assumptions are originated from the analytic approach that is based on taylor s expansion and appli cation of tauberian theorems we do think that these assumptions can be avoided by using the direct approach that considers a diffusion approx imation of the transient dam process and computes then the stationary distribution of the diffusion on this way these technical assumptions can be avoided however one would have deal with interchange of limits large l vs large t this problem is very hard in general see dis cussion of a similar problem in whitt 34 for solution of the limits interchange problem in generalized jackson networks in heavy traffic see gamarnik and zeevi 11 and braverman dai and miyazawa 6 the further references can be found in 6 optimal control of a large dam 25 condition 3 4 is originated from an application of the analytic method of 36 it requires to consider the class of probability distributions the laplace stieljes transform of which is analytic in some negative area of res and use taylor s expansion for small values of this class of distributions is smaller than that under conditions 3 1 or 3 2 and implies the existence of all moments of the distributions 3 2 series of objective functions let c l z l 1 j 0 cl jz j denote a backward generating cost function and let c l l 1 l 1 be the function of l we introduce the following series of objective functions corresponding to the cases i c l 0 ii c l 0 and iii c l 0 which are subject to minimization below we define three series of objective functions jupper l c l and j lower l c l and j 0 l c l depending on large parameter l and the objective function in the aforementioned marginal case the first se ries jupper l c l is associated with condition i the second one j lower l c l with condition ii and the last case is associated with condition iii the problem is to find a function 1 l under which as l the functionals jupper l c l or j lower l c l in dependence which of the conditions is satisfied converges in limit as l to minimum if 1 l converges to 1 then we arrive at the limiting case associated with iii where 1 2 liml 1 2 l and c liml c 0 l see also remark 3 6 below 3 2 1 series of objective functions corresponding to the case i 3 1 jupper l c l c l j 1 1 exp 2 c l e 1 2 l e 3 e 2 e 1 j 2 2 exp 2 c l e 1 2 l e 3 e 2 e 1 2 exp 2 c l e 1 2 l e 3 e 2 e 1 cupper l c l 26 v abramov where 3 2 cupper l c l 2 c l e 1 2 l e 3 e 2 e exp 2 c l e 1 2 l e 3 e 2 e exp 2 c l e 1 2 l e 3 e 2 e 1 1 l c l 1 2 c l e 1 2 l e 3 e 2 e l the series of objective functions given by 3 1 and 3 2 is used in proposition 6 2 3 2 2 series of objective functions corresponding to the case ii 3 3 j lower l c l c l j 1 exp 1 2 l e 3 e 2 e 2 c l e j 2 2 1 2 exp 1 2 l e 3 e 2 e 2 c l e 1 clower l c l where 3 4 clower l c l 2 c l e 1 2 l e 3 e 2 e 1 exp 2 c l e 1 2 l e 3 e 2 e 1 1 l c l 1 2 c l e 1 2 l e 3 e 2 e l the series of objective functions given by 3 3 and 3 4 is used in proposition 6 3 3 2 3 series of objective functions corresponding to the case iii 3 5 j 0 l j 1 1 2 l e 3 e 2 e 2 j 2 2 1 2 1 2 l e 3 e 2 e 2 c 0 l where c 0 l 1 l l i 1 ci remark 3 6 the series of the second moments 1 2 l that are used in 3 1 3 2 3 3 3 4 and 3 5 is assumed to converge to the limit 1 2 optimal control of a large dam 27 3 3 formulation of the main result theorem 3 7 under the assumption that the costs ci are nonincreasing and under conditions 3 1 3 2 and 3 4 a solution to the control problem do exist and unique in the sense explained below the solution to the control problem in 1 4 1 7 is defined as follows let j be the minimum value of the possible limits j upper c lim l jupper l c l for the series of objective function jupper l c l defined in 3 1 and 3 2 and respectively let j be the minimum value of the possible limits j lower c lim l j lower l c l or j 0 0 lim l j 0 l for the series of objective functions j lower l c l defined in 3 3 and 3 4 or j 0 l defined in 3 5 then there is a function 1 l satisfying the following properties if j 1 j 2 2 1 2 is satisfied then only for a positive limit lim l l 1 l 1 c 0 the optimal value of the objective function j is reached otherwise for the optimal value of the objective function the limit lim l l 1 l 1 can be positive negative or zero 4 asymptotic theorems for the stationary probabilities p 1 and p 2 in this section the explicit expressions are derived for the stationary probabilities and their asymptotic behavior is studied these results will be used in our further findings of the optimal solution 4 1 preliminaries in this section we recall the main properties of re currence relation 2 2 the detailed theory of these recurrence rela tions can be found in taka cs 31 for the generating function q z j 0 qjz j z 1 we have 4 1 q z q 0 f z f z z where f z j 0 fjz j asymptotic behavior of qn as n has been studied by taka cs 31 and postnikov 21 recall the theorems that are needed in this paper denote m limz 1 d mf z dzm 28 v abramov lemma 4 1 taka cs 31 p 22 23 if 1 1 then 4 2 lim n qn q 0 1 1 if 1 1 and 2 then lim n qn n 2 q 0 2 if 1 1 then 4 3 lim n qn q 0 n 1 f q 0 1 1 where is the least in absolute value root of the functional equation z f z and f z is the derivative of f z lemma 4 2 postnikov 21 sect 25 let 1 1 2 and f 0 f 1 1 then as n 4 4 qn 1 qn 2 q 0 2 o 1 4 2 extension of taka cs lemma for the following considerations we also need in extended version of taka cs lemma 4 1 in the case when 1 1 let qn l be a series of number satisfying for each l the system of recurrence relations 4 5 qn l n i 0 qn i 1 l fn l whereq 0 l is an arbitrary positive number and i 0 fi l 1 fi l 0 and let 4 6 f n lim l fn l exist so 4 5 is an extended version of recurrence relations given by 2 2 where the series parameter l is added with the limiting sequence given by 4 6 assume that for all l 1 l i 1 ifi l 1 so as l increases to infinity from 4 6 we have 4 7 lim l 1 l 1 denote by fl z the series fl z i 0 fi l z i and by l the least in absolute value root of the functional equation z fl z optimal control of a large dam 29 lemma 4 3 assume that 1 1 4 8 lim l q 0 l q 0 then 4 9 lim l lim n qn l l n lim n q n n where q n liml qn l and is the least in absolute value root of the functional equation z f z f z liml fl z proof it follows from 4 5 that qn l are defined for all l and there exists the limit q n of qn l as l as well the sequence l converges to its limit which is due to the assumption 1 1 strictly less than 1 the limit lim n qn l l n is defined and according to 4 3 of lemma 4 1 expressed via the quan tity q 0 l divided by 1 f l l where f l z is the derivative of fl z hence taking into account assumption 4 8 and the convergence f z liml fl z we obtain 4 10 lim n lim l qn l l n lim n q n n the convergence in l depending on 1 and q 0 only is uniform hence the moore osgood theorem on interchanging order of limits is applicable and 4 9 follows from 4 10 4 3 exact formulae for p 1 and p 2 in this section we derive the exact formulae for p 1 and p 2 these formulae follow from the following two steps see the proof of lemma 4 4 1 we establish the linear representations for e 2 l 1 in terms of e 1 l 1 2 then the explicit formulae for p 1 and p 2 follow from renewal reward theorem lemma 4 4 we have 4 11 p 1 1 2 e 1 e 1 1 2 e 1 l 1 1 and 4 12 p 2 2 e 1 2 1 1 e 1 l 1 1 e 1 1 2 e 1 l 1 1 where 1 and 2 mean the load parameters of the system that is the expected numbers of arrived customers per service time having the prob ability distribution function b 1 x and respectively b 2 x 30 v abramov proof first derive the linear representation of e 2 l 1 via e 1 l 1 from relation 2 10 and equations 2 3 2 6 which also hold true in the case of the present queueing system with batch arrivals we obtain 4 13 e 2 l 1 e 1 1 2 1 1 1 2 e 1 l 1 1 using renewal arguments e g 23 and relation 2 10 we have 4 14 p 1 1 et 1 l 1 et 2 l 1 1 e 1 e 1 l 1 e 2 l 1 and 4 15 p 2 et 2 l 1 et 1 l 1 et 2 l 1 1 2 e 2 l 1 e 1 l 1 e 2 l 1 now substituting 4 13 for the right sides of 4 14 and 4 15 we obtain relations 4 11 and 4 12 of this lemma 4 4 preliminary asymptotic expansions for large l the explicit results for p 1 and p 2 that are established in lemma 4 4 are expressed via the unknown quantity e 1 l 1 so the aim is to find the asymptotic behaviour of e 1 l 1 as l increases to infinity and thus to find the asymptotic behaviour of p 1 and p 2 in this section we obtain some preliminary asymptotic representations that follow from the explicit results those asymptotic representations will be used in the sequel the results of this section are as follows 1 we first establish the linear representation for e 2 l in terms of e 1 l see lemma 4 5 2 by similar way we derive the representation for e 2 l 1 l in terms of e 1 l 1 l see lemma 4 6 3 based on that representation we prove that e 2 l 1 e 2 l 1 l o 1 as l see lemma 4 7 lemma 4 5 for e 2 l l 1 2 we have the following representa tion 4 16 e 2 l e 1 2 1 1 1 2 e 1 l where 1 e 1 and 2 e 2 1 and e 1 l is given by 4 17 e 1 l l i 0 e 1 l i 1 0 1 i difx z dzi z 0 db 1 x e 1 0 1 optimal control of a large dam 31 proof taking into account that the number of arrivals during 1 busy cycle 1 busy period plus idle period coincides with the number of cus tomers served during the same 1 busy period according to wald s iden tity we have e et l 1 e et l e e l e 1 l e 2 l this equality together with 2 15 2 18 yields the desired statement of the lemma where 4 17 in turn follows from 2 14 and wald s identity 2 17 the next step is to derive representations for e 1 l 1 l and e 2 l 1 l we have the following lemma lemma 4 6 for e 2 l 1 l we have 4 18 e 2 l 1 l e 1 l 1 2 1 1 1 2 e 1 l 1 l 1 where similarly to 2 22 4 19 e 1 l 1 l 1 e 1 l i 1 1 l i 1 and e 1 l i 1 i 1 2 l are given by 4 17 proof following the same arguments as in the proof of 2 24 one can write 4 20 e 2 l 1 l ae 1 l b e 1 l 1 l 1 for the specified constants a and b for which the linear representation e 2 l a be 1 l is satisfied hence according to relation 4 16 of lemma 4 5 a 1 1 2 and b 1 1 1 2 the proof is completed the following lemma yields an estimate for the difference e 2 l 1 e 2 l 1 l lemma 4 7 as l 4 21 e 2 l 1 e 2 l 1 l o 1 proof it follows from 2 23 and wald s identity that e 1 l e 1 l 1 l hence 4 20 can be rewritten in the form e 2 l 1 l 1 1 2 e 1 l 1 1 1 2 e 1 l 1 1 and 4 21 follows 32 v abramov 4 5 asymptotic theorems for p 1 and p 2 under usual assump tions by usual assumption we mean the standard cases as 1 1 or 1 1 for the asymptotic behaviour as l in the following sections the heavy traffic assumptions are assumed by the heavy traffic assumptions we mean such a case where for some positive constant c 4 22 c lim l l 1 l 1 c and 2 1 the main result of section 4 3 is lemma 4 4 where the stationary probabilities p 1 and p 2 are expressed explicitly via e 1 l 1 the aim of this section is to obtain the analogue of asymptotic theorem 3 1 of 4 to this end we do as follows 1 we first study the asymptotic behavior of e 1 l as l for this purpose derive the representation for the generating function j 0 e 1 j z j then we obtain the asymptotic behaviour of e 1 l as l by using taka cs theorem lemma 4 1 or lemma 4 3 containing an extension of taka cs theorem and postnikov s theorem lemma 4 2 2 then we derive asymptotic representation for e 1 l 1 l as l and on the basis of this representation and renewal reward theorem e g 23 we find asymptotic behaviour of stationary probabilities p 1 and p 2 as l to derive the generative function j 0 e 1 j z j we use representation 4 17 this yields 4 23 j 0 e 1 j z j j 0 zj j i 0 e 1 l i 1 0 1 i difx u dui u 0 db 1 x u z u z z where 4 24 u z 0 exp x 1 i 1 riz i db 1 x b 1 r z by b 1 s s 0 we denote the laplace stieltjes transform of b 1 x and r z i 1 riz i z 1 hence from 4 24 and 4 23 we obtain 4 25 j 0 e 1 j z j b 1 r z b 1 r z z optimal control of a large dam 33 notice that the right hand side of 4 23 and hence that of 4 25 has the same form as 4 1 therefore we can use lemmas 4 1 and 4 2 and according to these lemmas the asymptotic behaviour of e 1 l as l is given by the following statements lemma 4 8 if 1 1 then 4 26 lim l e 1 l 1 1 1 if 1 1 and additionally 1 2 0 x 2 db 1 x and e 2 then 4 27 e 1 l e 1 l 1 2 e 1 2 e 3 e 2 e o 1 if 1 1 then 4 28 lim l e 1 l 1 l 1 b 1 r r 1 1 1 where 1 is the least positive root of the functional equation z b 1 r z the proof of this lemma is given in section 10 remark 4 9 in the case when 1 is the function of l relation 4 28 of lemma 4 8 is rewritten as follows 4 29 lim l le 1 l 1 l 1 b 1 r r where is the root of functional equation associated with the limiting functions depending of l as l limit relation 4 29 is based on application of lemma 4 3 instead of lemma 4 1 with the aid of lemma 4 8 one can obtain the statements on asymp totic behavior of e 1 l 1 e 1 l 1 l and consequently p 1 and p 2 the theorem below characterizes asymptotic behavior of the probabilities p 1 and p 2 as l theorem 4 10 if 1 1 then lim l p 1 l 1 1 4 30 lim l p 2 l 0 4 31 if 1 1 and additionally 1 2 0 x 2 db 1 x and e 2 then lim l lp 1 l 1 2 e 3 e 2 e 2 e 4 32 lim l lp 2 l 2 1 2 1 2 e 3 e 2 e 2 e 4 33 34 v abramov if 1 1 then 4 34 lim l p 1 l l 1 2 1 b 1 r r 1 2 4 35 lim l p 2 l 2 1 1 1 2 where is defined in the formulation of lemma 4 8 the proof of this theorem is given in section 10 remark 4 11 in the case when 1 is the function of l relations 4 34 and 4 35 of lemma 4 10 remain the same since an application of lemma 4 3 instead of lemma 4 1 gives the same result in this case is the root of functional equation associated with the limiting functions depending of l as l remark 4 12 it follows from theorem 4 10 under the assumption 1 1 we have 4 30 and 4 31 the probability p 1 l tends to the positive limit as l while the probability p 2 l vanishes as l then for large l the functional j j l in 1 4 is estimated as j 1 1 j 1 1 1 j 1 l that is it increases proportionally to large parameter l under the assumption 1 1 we have 4 34 and 4 35 then for large l the probability p 1 l is estimated as p 1 l 1 2 1 b 1 r r 1 2 l that is tends to zero since 1 the probability p 2 l converges to the positive limit as l this means that for large l the functional j j l in 1 4 is estimated as j 2 1 1 1 2 j 2 2 1 1 1 2 j 2 l that is similarly to the case 1 1 it tends to infinity with the rate proportional to l under the assumption 1 1 following the limits 4 32 and 4 33 the limit of j l is finite so the only case 1 1 among these three cases 1 1 1 1 and 1 1 can be a candidate to the optimal solution in fact the case 1 1 belongs to the class of heavy traffic conditions given by 4 22 an optimal solution must belong to the set of traffic parameters 1 l such as there is the limit l 1 l depending on parameters j 1 j 2 and the sequence of costs ci depending of water levels in the dam 4 6 asymptotic theorems for p 1 and p 2 under special heavy traf fic conditions in this section we establish asymptotic theorems for p 1 and p 2 under heavy traffic assumptions where j 1 1 l or jj 1 1 l and l is a vanishing positive parameter as l optimal control of a large dam 35 the theorems presented in this section are analogues of the theorems of 4 given in section 4 of that paper the conditions are special because these heavy traffic conditions include the change of the parameter 1 as l increases to infinity and l vanishes but the other load parameter 2 remains unchanged in case j we have the following two theorems theorem 4 13 under condition 3 1 we have lp 1 c exp 2 ce 1 2 e 3 e 2 e 1 1 o 1 4 36 lp 2 c 2 exp 2 ce 1 2 e 3 e 2 e 1 2 exp 2 ce 1 2 e 3 e 2 e 1 1 o 1 4 37 the proof of this theorem is given in section 10 theorem 4 14 under condition 3 1 assume that l l 0 then lim l lp 1 l 1 2 e 3 e 2 e 2 e 4 38 lim l lp 2 l 2 1 2 1 2 e 3 e 2 e 2 e 4 39 proof the statement of the theorem follows by expanding the main terms of asymptotic relations 4 36 and 4 37 for small c in case jj we have the following two theorems theorem 4 15 under condition 3 2 we have p 1 exp 1 2 e 3 e 2 e 2 ce 1 o 1 4 40 p 2 2 exp 1 2 e 3 e 2 e 2 ce 1 1 2 1 o 1 4 41 the proof of this theorem is given in section 10 theorem 4 16 under condition 3 2 assume that l 0 then we have 4 38 and 4 39 proof the proof of the theorem follows by expanding the main terms of the asymptotic relations 4 40 and 4 41 for small c 5 asymptotic theorems for the stationary probabilities qi the aim of this section is asymptotic analysis of the stationary prob abilities qi i 1 2 l as l the challenge is to first obtain the explicit representation for qi in terms of e 1 i 1 and then to study 36 v abramov the asymptotic behavior of qi as l on the basis of the known asymptotic results for e 1 l 1 as l to find asymptotic behaviour of stationary probabilities we need the following major steps 1 first we derive representation for stationary probabilities in terms of e 1 i 1 i 0 1 where e 1 i 1 with lower index i has the similar meaning as e 1 l 1 with the replacement of the level l by i see lemma 5 1 2 then we study asymptotic behaviour of the difference e 1 l j 1 e 1 l j 1 1 as l this difference is an important part of the formula that defines the asymptotic behaviour of the stationary proba bilities 3 the asymptotic behaviour of the aforementioned difference should be studied for the following three cases 1 1 1 1 l and 1 1 l where l is a positive vanishing value the first two cases are based on a standard study based on asymptotic behaviour of the difference e 1 l j 1 e 1 l j 1 1 and the main results for this study are theorems 5 2 and 5 3 the third case is more complicated and involves special results on asymptotic behaviour of this type of sequences 36 as well some special additional assumptions are required see theorem 5 4 5 1 explicit representation for the stationary probabilities qi the aim of this section is to prove the following statement lemma 5 1 for i 1 2 l we have 5 1 qi 1 p 1 e 1 i 1 e 1 i 1 1 proof rewriting relation 2 12 in the form 5 2 etl 1 1 1 e 1 e e l 1 1 e and now using renewal arguments e g 23 relation 5 2 and wald s identities et 1 i 1 1 1 1 e e 1 i 1 1 i 1 2 l we obtain 5 3 qi et 1 i 1 et 1 i 1 1 etl 1 1 1 e 1 i 1 e 1 i 1 1 e l 1 i 1 2 l optimal control of a large dam 37 taking into account that e l 1 e 1 l 1 e 2 l 1 and then apply ing the linear representation for e 2 l 1 given by 4 13 from 5 3 we obtain qi 1 1 2 e 1 e 1 1 2 e 1 l 1 1 e 1 i 1 e 1 i 1 1 i 1 2 l hence representation 5 1 follows from 4 11 see lemma 4 4 and lemma 5 1 is proved 5 2 asymptotic analysis of the stationary probabilities qi the case 1 1 let us study asymptotic behavior of the stationary proba bilities qi we start from the following modified version of 4 27 lemma 4 8 5 4 e 1 l j e 1 l j 1 2 e 1 2 e 3 e 2 e o 1 which is assumed to be satisfied under the conditions 1 2 and e 2 under the same conditions similarly to 10 3 we obtain 5 5 e 1 l j 1 l e 1 l j 1 1 l 2 e 1 2 e 3 e 2 e l i 1 ipr 1 l i o 1 2 e e 1 1 2 e 3 e 2 e o 1 hence since for any j l e 1 l j 1 l e 1 l j 1 l j e 1 l j 1 then from 5 5 we have the estimate 5 6 e 1 l j 1 e 1 l j 1 1 2 e e 1 1 2 e 3 e 2 e o 1 asymptotic relations 5 6 4 32 together with explicit relation 5 1 of lemma 5 1 leads to the following theorem theorem 5 2 in the case 1 1 under the additional conditions 1 2 and e 2 for large values j such that j l 1 as l we have 5 7 lim l lqj 1 38 v abramov note that the asymptotic relation given by 5 7 is not expressed via e and therefore it is invariant and hence the same as that for the queueing system with ordinary poisson arrivals 5 3 asymptotic analysis of the stationary probabilities qi the case 1 1 l in the case 1 1 l 0 the asymptotic behaviour of qi is specified by the following theorem theorem 5 3 assume that condition 3 1 is satisfied and e 3 then for all j 0 we have 5 8 ql j exp 2 ce 1 2 e 3 e 2 e exp 2 ce 1 2 e 3 e 2 e 1 1 2 e 1 2 e 3 e 2 e j 2 e 1 2 e 3 e 2 e o the proof of this theorem is given in section 10 5 4 asymptotic analysis of the stationary probabilities qi the case 1 1 l in the case 1 1 l 0 the study is more delicate and based on special analysis the additional assumption of this case is that the class of probability distribution functions b 1 x and pr i are given such that there exists a unique root 1 of the equation 5 9 z b 1 r z and there exists the first derivative b 1 r under the assumption that 1 1 the root of 5 9 is not necessarily exists and if exists it is not necessarily unique such type of condition has been considered by willmot 36 to obtain the asymptotic behavior for high queue level probabilities in stationary m g 1 queues the analysis provided here consists of the following three parts 1 we consider mx g 1 queueing system with 1 1 and under the assumption that the first batch in a busy period consists of only one customer we derive the asymptotic formula for the stationary probability qi for large i the idea is first to extend the asymptotic result of willmot 36 obtained for them g 1 queueing system similarly to willmot 36 we show that the stationary probability qi is presented as c i 1 o 1 with exact explicit expression for the constant c 2 based on this result we then express via the numerical charac teristics e 1 l j l which in turn were studied in section 4 optimal control of a large dam 39 3 then we provide asymptotic study of as 1 approaches 1 the study is based on taylor s expansion for an explicit analytic expression denote the stationary probabilities in the m g 1 queueing system by qi m g 1 i 0 1 it was shown in 36 that 5 10 qi m g 1 1 1 1 i 1 b 1 1 o 1 as i where b 1 s denotes the laplace stieltjes transform of the service time distribution in the m g 1 queueing system and denotes a root of the equation z b 1 z greater than 1 which is assumed to be unique on the other hand according to the pollaczek khintchine formula e g taka cs 30 p 242 qi m g 1 can be represented explicitly 5 11 qi m g 1 1 1 e 1 i e 1 i 1 i 1 2 where the random variable 1 i in this formula is associated with the number of served customers during a busy period of the state dependent m g 1 queueing system where the value of the system parameter where the service is changed is i see section 2 1 representation 5 11 can be easily checked since in this case 5 12 j 0 e 1 j z j b 1 z b 1 z z and multiplication of the right hand side of 5 12 by 1 1 1 z leads to the well known pollaczek khintchine formula then from 5 10 and 5 11 there is the asymptotic proportion for large l and any j 0 5 13 e 1 l j e 1 l j 1 e 1 l e 1 l 1 j 1 o 1 in the case of batch arrivals the results are similar one can prove that the same proportion as 5 13 holds in this case as well where in the case of batch arrivals denotes a unique real root of the equation of 5 9 which is greater than 1 recall that our convention is an existence of a unique real solution of 5 9 greater than 1 indeed the arguments of 36 are elementary extended for the queueing system with batch arrivals the simplest way to extend these results straightforwardly is to consider the stationary queueing system with batch poisson arrivals in which the first batch in each busy period is equal to 1 denote this system by m 1 x g 1 for this specific system similarly to 5 10 we obtain 5 14 qi m 1 x gi 1 1 1 1 i 1 b 1 r r 1 o 1 as i 40 v abramov where qi m 1 x gi 1 i 0 1 denotes the stationary probabilities in this system then taking into account 4 25 similarly to 5 11 one can write 5 15 qi m 1 x gi 1 1 1 e 1 i e 1 i 1 i 1 2 from 5 14 and 5 15 we obtain 5 16 e 1 l j e 1 l j 1 e 1 l e 1 l 1 j 1 o 1 from 5 16 and the results of sections 4 4 and 4 5 see 4 26 the state ment on asymptotic behaviour of e 1 l 1 l as l given in section 10 relation 10 2 and the equality e 1 l 1 l e 1 l 1 we also have the estimate 5 17 e 1 l j 1 e 1 l j 1 1 e 1 l 1 e 1 l 1 1 j 1 o 1 which coincides with 5 13 now we formulate and prove a theorem on asymptotic behavior of the stationary probabilities qi in the case 1 1 0 the special assumption in this theorem is that the class of probability distributions b 1 x is defined according to the above convention more precisely in the case 1 1 0 and vanishing as l this means that condition 3 4 should be satisfied theorem 5 4 assume that conditions 3 2 and 3 4 are satisfied and e 3 then 5 18 ql j 1 exp 2 ce 1 2 e 3 e 2 e 1 2 e 1 2 e 3 e 2 e 1 2 e 1 2 e 3 e 2 e j 1 o 1 for any j 0 the proof of this theorem is given in section 10 6 derivations for the objective function 6 1 the case 1 1 in this section we prove the following result optimal control of a large dam 41 proposition 6 1 in the case 1 1 under the additional conditions 1 2 and e 2 we have 6 1 lim l j l j 1 1 2 e 3 e 2 e 2 e j 2 2 1 2 1 2 e 3 e 2 e 2 e c where c lim l 1 l l i 1 ci proof the first two terms in the right hand side of 6 1 follow from asymptotic relations 4 32 and 4 33 theorem 4 10 the last term c of the right hand side of 6 1 follows from 5 7 theorem 5 2 since lim l l i 1 qici lim l 1 l l i 1 ci c 6 2 the case 1 1 l in the case 1 1 l 0 we have the following statement proposition 6 2 under the assumptions of theorem 5 3 for the series of objective functions j l we have representation 3 1 then a solu tion to the control problem is found in the set of possible limits j upper c the proof of proposition 6 2 is given in section 10 6 3 the case 1 1 l in the case 1 1 l 0 we have the following statement proposition 6 3 under the assumptions of theorem 5 4 for the series of objective functions j l we have representation 3 3 then a solu tion to the control problem is found in the set of possible limits j lower c the proof of proposition 6 3 is given in section 10 7 a solution to the control problem and its properties in this section we discuss the solution to the control problem and study its properties 42 v abramov 7 1 alternative representations for the last terms in the objec tive functions and their properties the series of objective functions jupper l c l and j lower l c l are given by 3 1 and respectively by 3 3 and the last terms in these functionals are given by 3 2 and respectively by 3 4 for our further analysis we need in other repre sentations for these last terms recall that when 1 l 1 l the parameter c defined in 1 9 is positive while in the opposite case 1 l 1 l it is negative for the following study of the properties of the possible limits of cupper l c l and clower l c l as l we need to introduce the function 7 1 c lim l l 1 j 0 cl j 1 2 ce 1 2 l e 3 e 2 e l j l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j and establish its connection with the aforementioned limits however for the purposes it is profitable to split this function into two different functions in order to distinguish two case studies so instead of 7 1 we consider two functions both defined for a positive argument specifically denoting d c consider the following two functions 7 2 d lim l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j and 7 3 d lim l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j since ci is a nonincreasing and bounded sequence then the limits of 7 2 and 7 3 do exist denote cupper c lim l cupper l c l and clower c lim l clower l c l the relations between cupper c and d and respectively between clower c and d are given in the lemma below lemma 7 1 we have 7 4 cupper c d and 7 5 clower c d optimal control of a large dam 43 the proof of this lemma is given in section 10 the next lemma establishes the main properties of functions d and d lemma 7 2 the function d is a nonincreasing function and its maximum is 0 c the function d is a nondecreasing function and its minimum is 0 c recall that c liml 1 l l i 1 ci is defined in proposition 6 1 the proof of this lemma is given in section 10 in the following we need in stronger results that is given by lemma 7 2 namely we prove the following lemmas lemma 7 3 if the sequence ci contains at least two distinct values then the function d is a strictly decreasing function and the function d is a strictly increasing function the proof of this lemma is given in section 10 lemma 7 4 under assumption of lemma 7 3 the function d is convex and the function d is concave the proof of this lemma is given in section 10 7 2 proof of the main result and discussion of optimal solution 7 2 1 preliminaries before starting the proof we discuss the structure of an optimal solution if it exists as it has already been discussed in remark 4 12 that a possible opti mal solution falls into the category of the heavy traffic conditions which are specified by the relation between the parameters j 1 and j 2 and the structure of costs ci following remark 4 12 the existence of a solution is intuitively understandable since according to relations 4 32 and 4 33 of theorem 4 10 under the conditions 1 1 1 2 and e 2 both limits liml lp 1 l and liml lp 2 l are finite and the func tional 1 4 must be finite more rigorous arguments are given in section 7 2 2 here we classify different cases of an optimal solution the three possible cases of the heavy traffic conditions are as follows case 1 liml l 1 l 1 c 0 analysis of this case is based on heavy traffic assumption j of condition 3 1 and the statements of theorem 4 13 this case is associated with condition i and series of objective functions defined by 3 1 and 3 2 case 2 liml l 1 l 1 c 0 analysis of this case is based on heavy traffic assumption jj of conditions 3 2 and 3 4 and the statements 44 v abramov of theorem 4 15 this case is associated with condition ii and series of objective functions defined by 3 3 and 3 4 case 3 liml l 1 l 1 0 analysis of this case is based the statements of theorem 4 14 note that asymptotic results under this heavy traffic condition coincides with limit relations 4 32 and 4 33 of theorem 4 10 this case is associated with condition iii and series of objective functions defined by 3 5 in the proof given below we consider case 1 the other cases can be studied similarly 7 2 2 existence of a solution note first that under the assumptions made there is a solution to the control problem considered in this paper indeed a solution contains two terms one of them corresponds to the expression for p 1 j 1 p 2 j 2 in 1 4 and another one corresponds to the term lupper i llower 1 ciqi in 1 4 the first term of a solution is related to the models where the water costs are not taken into account for case 1 this term can be extracted from the function jupper l c l in 3 1 by setting cupper l c l 0 and passing to the limit as l denoting this function by j c we have the following explicit expression 7 6 j c c j 1 1 exp 2 ce 1 2 e 3 e 2 e 1 j 2 2 1 2 exp 2 ce 1 2 e 3 e 2 e exp 2 ce 1 2 e 3 e 2 e 1 taking derivative in c and equating it to zero we obtain the equation 7 7 j 1 1 2 ce 1 2 e 3 e 2 e exp 2 ce 1 2 e 3 e 2 e exp 2 ce 1 2 e 3 e 2 e 1 j 2 2 1 2 exp 2 ce 1 2 e 3 e 2 e 1 2 ce 1 2 e 3 e 2 e exp 2 ce 1 2 e 3 e 2 e exp 2 ce 1 2 e 3 e 2 e 1 0 equation 7 7 has a solution indeed setting c 0 for the left hand side of 7 7 transforms it to the inequality j 1 j 2 2 1 2 0 optimal control of a large dam 45 on the other hand setting c 1 2 e 3 e 2 e 2 e we obtain the inequality j 1 1 e e 1 j 2 2 1 2 1 e e 1 0 thus 7 7 has a solution 7 2 3 uniqueness of a solution to prove that the solution that is dis cussed in section 7 2 2 is unique we are to prove that the second de rivative of the function j c defined in 7 6 is positive indeed the derivative of the function on left hand side of 7 7 is j 1 j 2 2 1 2 2 c e 2 1 2 e 3 e 2 e 2 exp 2 ce 1 2 e 3 e 2 e exp 2 ce 1 2 e 3 e 2 e 1 2 0 and taking into account that the left hand side of 7 7 is presented as exp 2 ce 1 2 e 3 e 2 e 1 dj dc we arrive at the conclusion that the second derivative of the function j c is positive hence the function j c is convex the second term which is the limit cupper c is defined in section 7 1 according to lemma 7 1 cupper c c according to lemma 7 4 the function c is a convex function in c and its maximum is 0 c the function d c is a concave function in d convex in c with 0 c hence the solution to control problem is unique 7 2 4 structure of the optimal solution and corollary now we discuss the structure of the optimal solution to the control problem it is asso ciated with three possible cases considered in section 7 2 1 case 1 liml l 1 l 1 0 this case is associated with con dition i in this case the minimum of j upper c occurs for c c 0 then cupper c c and the value of the limiting term for p 1 j 1 p 2 j 2 lupper i llower 1 ciqi of the series of objective functions in 1 4 is given by j upper c case 2 liml l 1 l 1 c 0 this case is associated with condition ii and under this condition the inequality j 1 j 2 2 1 2 is satisfied in this case the minimum of j lower c occurs for c c 0 then clower 0 c and the value of the limiting term for p 1 j 1 p 2 j 2 lupper i llower 1 ciqi of the series of objective function in 1 4 is given by junder c 46 v abramov case 3 liml l 1 l 1 0 since cupper 0 c cupper c for any positive c then this case must belong to the case j 1 j 2 2 1 2 where the only equality holds in the only case of same constant water cost for any level of the dam in this case the minimum of j lower c occurs for c c 0 then clower 0 c and the limiting term for p 1 j 1 p 2 j 2 lupper i llower 1 ciqi of the series of objective functions in 1 4 is j 1 1 2 e 3 e 2 e 2 e j 2 2 1 2 1 2 e 3 e 2 e 2 e c the result is mentioned in 6 1 note that as in the first case so in the third one the optimal value of the limiting term for p 1 j 1 p 2 j 2 lupper i llower 1 ciqi of the series of objective functions must be less then it is given by 6 1 since otherwise the strategy with 1 1 would be also selected which is impossible since the optimal solution is unique so theorem 3 7 is proved and the cases are discussed from theorem 3 7 we have the following evident property of the opti mal control corollary 7 5 the solution to the control problem can be 1 1 only in the case j 1 j 2 2 1 2 specifically the only equality is achieved for ci c i 1 2 l where c is an arbitrary positive constant although corollary 7 5 provides a result in the form of simple inequal ity this result is not really useful since it is an evident extension of the result of 4 a more constructive result is obtained for the special case considered in the next section 8 example of linear costs in this section we study an example related to the case of linear costs assume that c 1 and cl c 1 are given then the assumption that the costs are linear means that 8 1 ci c 1 i 1 l 1 c 1 cl i 1 2 l it is assumed that as l is changed the costs are recalculated as follows the first and last values of the cost c 1 and cl remains the same other costs in the intermediate points are recalculated according to 8 1 therefore to avoid confusing with the appearance of the index l for the fixed unchangeable values of cost c 1 and cl we use the other nota tion c 1 c and cl c then 8 1 has the form 8 2 ci c i 1 l 1 c c i 1 2 l optimal control of a large dam 47 in the following we shall also use the inverse form of 8 2 namely 8 3 cl i c i l 1 c c i 0 1 l 1 apparently 8 4 c c c 2 for cupper c we have 8 5 cupper c d lim l l 1 j 0 c j l 1 c c 1 2 de 1 2 l e 3 e 2 e l j l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j c c c lim l 1 l 1 l 1 j 0 j 1 2 ce 1 2 l e 3 e 2 e l j l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j c c c 1 2 l e 3 e 2 e 2 ce 2 ce 1 2 l e 3 e 2 e exp 2 ce 1 2 l e 3 e 2 e 1 exp 2 ce 1 2 l e 3 e 2 e 1 for example as c d 0 in 8 5 then cupper 0 is c 1 2 c c c this is in agreement with the statement of proposition 6 1 in turn for clower c c is negative we have 8 6 clower c d lim l l 1 j 0 c j l 1 c c 1 2 ce 1 2 l e 3 e 2 e l j l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j c c c lim l 1 l 1 l 1 j 0 j 1 2 ce 1 2 l e 3 e 2 e l j l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j c c c 1 2 l e 3 e 2 e 2 ce 2 ce 1 2 l e 3 e 2 e 1 exp 2 ce 1 2 l e 3 e 2 e 1 exp 2 ce 1 2 l e 3 e 2 e again as c 0 in 8 6 then clower 0 is c 1 2 c c c so we arrive at the agreement with the statement of proposition 6 1 48 v abramov table 1 the values of parameter j 2 and corresponding arguments of optimal value c parameter argument of optimal value difference j 2 c c j 2 1 c j 2 1 06 0 200 1 08 0 180 0 020 1 10 0 162 0 018 1 12 0 144 0 018 1 14 0 128 0 016 1 16 0 112 0 016 1 18 0 096 0 016 1 20 0 081 0 015 1 22 0 067 0 014 1 24 0 054 0 013 1 26 0 042 0 012 1 28 0 030 0 012 1 30 0 019 0 011 1 32 0 009 0 010 1 34 0 0 009 9 numerical study the explicit solution in the case of linear costs is very routine and cumbersome we provide below a numerical study for simplicity the input flow in the numerical example is assumed to be ordinary poisson that is we set e 1 and e 2 1 in our calculations following corollary 7 5 take first j 1 j 2 2 1 2 clearly that for this relation between parameters j 1 and j 2 the minimum of j lower c must be achieved for c 0 while the minimum of j upper c must be achieved for a positive c now keeping j 1 fixed assume that j 2 increases then the problem is to find the value of parameter j 2 such that the value c corresponding to the minimization of j upper c reaches zero in our example we take j 1 1 2 1 2 c 1 c 2 1 2 1 in the table below we outline some values j 2 and the corresponding value c for the optimal solution of j upper c it is seen from the table that the optimal value is achieved in the case j 2 1 34 therefore in the present example j 1 1 and j 2 1 34 lead to the optimal solution 1 1 it is seen from table 1 that as j 2 increases the value of cost c is monotonically decreases the inverse proportion between j 2 and c im plies that the optimal value of j upper c will be lower when the value of j 2 is larger that is when the damage of flooding is kept increased the value c and consequently the value of j upper c must be decreased the third column in the table shows how the the parameter c decreases optimal control of a large dam 49 0 0 05 0 1 0 15 0 2 0 25 0 0 5 1 1 parameter j 2 p a ra m e te r c 5 figure 5 graph of the dependence of c on j 2 when the parameter j 2 increases it shows almost linear dependence of these parameters the graph of the dependence of c on j 2 is shown in figure 5 10 proofs proof of lemma 4 8 asymptotic relations 4 26 and 4 28 follow by application of those 4 2 and respectively 4 3 of lemma 4 1 in order to prove asymptotic relation 4 27 we should apply a taube rian theorem by postnikov lemma 4 2 then asymptotic relation 4 27 is to follow from 4 4 if we prove that the tauberian condition f 0 f 1 1 of lemma 4 2 is satisfied in the case of the present model we must prove that for some 0 0 the equality 10 1 0 e 0 x 1 0 r 1 x db 1 x 1 is not the case without loss of generality r 1 in 10 1 can be set to be equal to 1 since 0 e 0 x 1 0 r 1 x db 1 x 0 e 0 x 1 0 x db 1 x 50 v abramov thus we have to prove the inequality 0 e x 1 x db 1 x 1 indeed 0 e x 1 x db 1 x is an analytic function in and hence according to the theorem on the maximum module of an analytic func tion equality 10 1 where r 1 1 must hold for all 0 0 this means that 10 1 is valid if and only if 0 e 0 x 0 x i i db 1 x 0 for all i 2 and 0 0 since 0 e x x idb 1 x is the ith derivative of the laplace stieltjes transform b 1 then in this case the laplace stieltjes transform b 1 must be a linear function in i e b 1 d 0 d 1 where d 0 and d 1 are some constants however since b 1 1 we must have d 0 1 and d 1 0 this is a trivial case where b 1 x is concentrated in point 0 and therefore it is not a probability distribution function having a positive mean thus 10 1 is not the case and the aforementioned tauberian conditions are satisfied now the final part of the proof of 4 27 reduces to an elementary algebraic calculations 2 d 2 dz 2 b 1 r z z 1 e 2 e 1 1 2 e 2 the lemma is proved proof of theorem 4 10 let us first find asymptotic representation for e 1 l 1 l as l according to lemma 4 8 and explicit representation 4 19 we obtain as follows if 1 1 then 10 2 lim l e 1 l 1 l 1 1 1 lim l l i 1 ipr 1 l i 1 e 1 1 1 if 1 1 1 2 and e 2 then 10 3 lim l e 1 l 1 l l 2 e 1 2 e 3 e 2 e lim l l i 1 ipr 1 l i 2 e e 1 1 2 e 3 e 2 e optimal control of a large dam 51 if 1 1 then 10 4 lim l e 1 l 1 l l 1 1 b 1 r r lim l l i 1 ipr 1 l i e 1 1 b 1 r r therefore taking into account these limiting relations 10 2 10 3 and 10 4 by virtue of the equality e 1 l 1 l e 1 l 1 and explicit representations 4 11 and 4 12 lemma 4 4 for p 1 and p 2 we finally arrive at the statements of the theorem the theorem is proved proof of theorem 4 13 note first that under condition 3 1 there is the following expansion for 10 5 1 2 e 1 2 e 3 e 2 e o 2 where itself is the limiting root of the series of functional equations based on application of lemma 4 3 this expansion is similar to that given originally in the book of subhankulov 24 p 362 and its proof is provided as follows write the equation b 1 r and expand the right hand side by taylor s formula taking 1 z where z is small enough when is small we obtain 10 6 1 z 1 1 z 1 2 e 3 1 e 2 e 2 e z 2 o z 3 disregarding the small term o z 3 in 10 6 we arrive at the quadratic equation 10 7 z 1 2 e 3 1 e 2 e 2 e z 2 0 the positive solution of 10 7 z 2 e 1 2 e 3 1 e 2 e leads to the expansion given by 10 5 let us now expand the right hand side of 10 4 when is small for the term 1 b 1 r r we have the expansion 10 8 1 b 1 r r o 2 52 v abramov then according to the l hospitale rule lim u 1 1 r u 1 u e hence 10 9 1 r 1 e 1 o 1 substituting 10 5 10 8 and 10 9 into 10 4 we obtain the expan sion 10 10 e 1 l 1 l exp 2 ce 1 2 e 3 e 2 e 1 e 1 o 1 hence relations 4 36 and 4 37 of the theorem follow by virtue of the equality e 1 l 1 l e 1 l 1 and explicit representations 4 11 and 4 12 lemma 4 4 for p 1 and p 2 proof of theorem 4 15 the explicit representation for the generat ing function for e 1 j is given by 4 25 since the sequence e 1 j is increasing then the asymptotic behavior of e 1 l 1 as l under the assumptions l 1 l 1 c as l can be found according to a tauberian theorem of hardy and littlewood see e g 21 31 p 203 and 28 namely according to that theorem the behaviour of e 1 l as l and l 1 l 1 c can be found from the asymptotic expansion of 10 11 1 z b 1 r z b 1 r z z as z 1 similarly to the evaluation given in the proof of theorem 4 3 4 we have 10 12 1 z b 1 r z b 1 r z z 1 z 1 z 1 1 z 1 2 e 3 e 2 e 2 e 1 z 2 o 1 z 3 1 1 2 e 3 e 2 e 2 e 1 z o 1 z 2 1 1 1 2 e 3 e 2 e 2 e 1 z o 1 z 2 1 exp 1 2 e 3 e 2 e 2 e 1 z 1 o 1 optimal control of a large dam 53 where l denoted the difference 1 1 l therefore assuming that z l 1 l 1 as l from 10 12 we arrive at the following estimate 10 13 e 1 l 1 exp 1 2 e 3 e 2 e 2 ce 1 o 1 comparing 4 28 with 10 4 and taking into account 10 9 which holds true in the case of this theorem as well we obtain 10 14 e 1 l 1 l e exp 1 2 e 3 e 2 e 2 ce 1 o 1 hence relations 4 40 and 4 41 of the theorem follow by virtue of the equality e 1 l 1 l e 1 l 1 and explicit representations 4 11 and 4 12 lemma 4 4 for p 1 and p 2 proof of theorem 5 3 based on lemma 4 3 we have the following expansion of 4 28 for large l 10 15 e 1 l j j l 1 b 1 r r 1 o 1 in turn from 10 15 for large l we obtain 10 16 e 1 l j e 1 l j 1 1 j l 1 b 1 r r 1 o 1 from 10 16 similarly to 10 4 we further have e 1 l j 1 l e 1 l j 1 1 l 1 r 1 j 1 b 1 r r 1 1 o 1 and according to the equality e 1 l 1 l e 1 l 1 10 17 e 1 l j 1 e 1 l j 1 1 1 r 1 j 1 b 1 r r 1 1 o 1 54 v abramov next under the conditions of the theorem asymptotic expansions 10 5 10 8 and 10 9 hold taking into consideration these expan sions we arrive at the following asymptotic relations for j 0 1 e 1 l j 1 e 1 l j 1 1 exp 2 ce 1 2 e 3 e 2 e 1 2 e 1 2 e 3 e 2 e j 2 e 1 2 e 3 e 2 e 1 o 1 now taking into account asymptotic relation 4 36 of theorem 4 13 and the explicit formula given by 5 1 lemma 5 1 we arrive at the statement of the theorem proof of theorem 5 4 under the assumptions of this theorem let us first derive the following asymptotic expansion 10 18 1 2 e 1 2 e 3 e 2 e o 2 asymptotic expansion 10 18 is similar to that of 10 5 and its proof is also similar namely taking into account that the equation z b 1 r z has a unique solution in the set 1 and this solu tion approaches 1 as vanishes therefore by the taylor expansion of this equation around the point z 1 we have 10 19 1 z 1 1 z 1 2 e 3 1 e 2 e 2 e z 2 o z 3 disregarding the term o z 3 from 10 19 we arrive at the quadratic equation z 1 2 e 3 1 e 2 e 2 e z 2 0 and obtain a positive solution z 2 e 1 2 e 3 1 e 2 e this proves 10 18 next from 5 17 10 18 and explicit formula 5 1 we obtain 10 20 ql j ql 1 2 e 1 2 e 3 e 2 e j 1 o 1 optimal control of a large dam 55 taking into consideration l 1 j 0 1 2 e 1 2 e 3 e 2 e j 1 2 e 3 e 2 e 2 e 1 2 e 1 2 e 3 e 2 e l 1 1 2 e 3 e 2 e 2 e exp 2 ce 1 2 e 3 e 2 e 1 1 o 1 from the normalization condition p 1 p 2 l i 1 qi 1 and the fact that both p 1 and p 2 have the order o we obtain 10 21 ql 2 e 1 2 e 3 e 2 e 1 exp 2 ce 1 2 e 3 e 2 e 1 1 o 1 the desired statement of the theorem follows from 10 21 proof of proposition 6 2 the representation for the term c j 1 1 exp 2 ce 1 2 l e 3 e 2 e 1 j 2 2 exp 2 ce 1 2 l e 3 e 2 e 1 2 exp 2 ce 1 2 l e 3 e 2 e 1 of the right hand side of 3 1 follows from 4 36 and 4 37 theorem 4 13 this term is similar to that of 5 2 in 4 the new term which takes into account the water costs is cupper c liml c upper l c l 56 v abramov taking into account representation 5 8 for this term we obtain cupper c lim l l 1 j 0 ql jcl j lim l l 1 j 0 cl j exp 2 ce 1 2 l e 3 e 2 e exp 2 ce 1 2 l e 3 e 2 e 1 1 2 le 1 2 l e 3 e 2 e l j 2 le 1 2 l e 3 e 2 e l and since liml l c representation 3 2 follows proof of proposition 6 3 the representation for the term c j 1 exp 1 2 l e 3 e 2 e 2 ce j 2 2 1 2 exp 1 2 l e 3 e 2 e 2 ce 1 of the right hand side of 3 3 follows from 4 40 and 4 41 theorem 4 15 this term is similar to that 5 3 in 4 the new term which takes into account the water costs is clower c liml c lower l c l taking into account representation 5 18 for this term we obtain clower c lim l l 1 j 0 ql jcl j lim l l 1 j 0 cl j 1 exp 2 ce 1 2 l e 3 e 2 e 1 1 2 le 1 2 l e 3 e 2 e l j 2 le 1 2 l e 3 e 2 e l and because of lim l l 1 l 1 c 0 representation 3 4 follows optimal control of a large dam 57 proof of lemma 7 1 from 7 2 and 7 3 we correspondingly have the representations 10 22 lim l 1 l l 1 j 0 cl j 1 2 ce 1 2 l e 3 e 2 e l j d lim l 1 l l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j and since d c c is negative 10 23 lim l 1 l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j lim l 1 l l 1 j 0 cl j 1 2 ce 1 2 l e 3 e 2 e l j d lim l 1 l l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j the desired results follow by direct transformations of the corresponding right hand sides of 10 22 and 10 23 indeed for the right hand side of 10 22 we obtain 10 24 d lim l 1 l l 1 j 0 1 2 ce 1 2 l e 3 e 2 e l j d lim l 1 exp 2 ce 1 2 l e 3 e 2 e l 1 2 l e 3 e 2 e 2 ce on the other hand from 3 2 we have 10 25 cupper c 1 exp 2 ce 1 2 l e 3 e 2 e 1 2 l e 3 e 2 e 2 ce 1 l l 1 j 0 cl j 1 2 ce 1 2 l e 3 e 2 e l j hence from 10 22 10 24 and 10 25 we obtain 7 2 the proof of 7 5 is completely analogous and uses the representations of 3 4 and 10 23 58 v abramov proof of lemma 7 2 let us first prove that 0 c is a maximum of d for this purpose we use the following well known inequality e g hardy littlewood and polya 12 or marschall and olkin 16 let an and bn be arbitrary sequences one of them is increasing and another decreasing then for any finite sum we have 10 26 l n 1 anbn 1 l l n 1 an l n 1 bn applying inequality 10 26 to the finite sums of the left hand side of 10 22 and passing to the limit as l we have 10 27 lim l 1 l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j lim l 1 l l 1 j 0 cl j lim l 1 l l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j 0 lim l 1 l l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j then comparing 10 22 with 10 27 enables us to conclude 0 c d i e 0 c is the maximum value of d a more delicate result we are going to prove is that d is a non increasing convex function we first prove that the function d is nonincreasing and then following formulated lemmas 7 3 and 7 4 we later prove that d is a nontrivial convex function if the sequence of costs ci is decreasing that is the values ci all are not equal to a same constant to prove the fact that d is a nonincreasing convex function we are to derive the function d ind and show that the derivative is negative from the explicit representation for d d lim l 1 l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j 1 l l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j optimal control of a large dam 59 we have 10 28 d dd lim l 1 l l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j 2 lim l 1 l l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j lim l d dd 1 l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j lim l 1 l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j lim l d dd 1 l l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j the task is to prove that the expression in the arc brackets of 10 28 is negative or zero that is we are to prove that for sufficiently large l 10 29 l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j d dd l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j d dd l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j is negative note that 10 29 is associated with the representation 10 30 d dd l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j 2 60 v abramov so the technical task reduces to the following let 10 31 fl z l i 0 aiz i l i 0 z i 1 z l i 0 aiz i 1 zl 1 a 0 l i 1 ai ai 1 z i 1 zl 1 be the function z 1 in which ai is an increasing sequence for the derivative of this function we have 10 32 dfl dz l i 1 i ai ai 1 z i 1 1 zl 1 l 1 zl a 0 l i 1 ai ai 1 z i 1 zl 1 2 since ai is an increasing sequence then the derivative dfl dz is positive then for the function fl 1 y l in which the argument z is replaced with 1 y l 0 y l now the derivative of this function in y is nega tive so as l increases to infinity the derivative dfl 1 y l dy tends to the negative value or zero this enables us to arrive at the conclusion that 10 28 is negative and as l it tends to the negative value or zero the first statement of lemma 7 2 is proved the proof of the second statement of this lemma is similar proof of lemma 7 3 in order to prove this lemma it is sufficient to prove that if the sequence ci is nontrivial that is there are at least two distinct values of this sequence then for any distinct posi tive real numbers c 1 c 2 the values of functions are also distinct that is c 1 c 2 and c 1 c 2 let us prove the first inequality c 1 c 2 rewrite 7 2 as 10 33 d lim l 1 l l 1 j 0 cl j 1 2 de 1 2 l e 3 e 2 e l j 1 l l 1 j 0 1 2 de 1 2 l e 3 e 2 e l j the limit of the denominator is equal to 1 exp 2 de 1 2 e 3 e 2 e 1 2 e 3 e 2 e 2 de the limit of the numerator does exist and finite since the sequence ci is assumed to be nonincreasing and bounded as well according to the other representation following from lemma 7 1 and relation 3 2 it is an analytic function in d taking a nontrivial set of values optimal control of a large dam 61 the analytic function c is defined for all real c 0 and it can be extended analytically for the whole complex plane extension to the negative values of c enables us to arrive at the function c c which is now an analytic function for all real values c and due to analytic continuation is an analytic function in whole complex plane according to the maximum principle for the module of an analytic function if an analytic function takes the same values in two distinct points inside the domain of its definition then the function must be the constant if ci c for all i 1 2 then this is just the case where c c for all c if there exist i 0 and i 1 such that ci 0 ci 1 then the function c cannot be a constant because the analytic function is uniquely defined by the coefficients in the series expansion so the inequality c 1 c 2 for distinct values c 1 and c 2 follows the proof of the second inequality c 1 c 2 is the part of the first one since c c is the same analytic function proof of lemma 7 4 to prove the lemma we are to derive the func tion d in d twice and show that the second derivative is nonnegative note that in the nontrivial case when the sequence ci is a decreasing se quence containing distinct values the first derivative of d according to lemmas 7 2 and 7 3 is strictly negative the proof given in lemma 7 2 cannot guarantee this since the limit as l may reach 0 but the statement of lemma 7 3 does guarantee this since the analytic function that is not a constant must take distinct values only the expression for the second derivative is hardly observable there fore we do not write down the exact derivations and instead of them we provide the scheme of calculations only we consider the function defined by 10 31 that is used in the proof of lemma 7 2 its derivative is defined by 10 32 deriving this function the second time show that the second derivative is positive denote the expression in 10 32 by i 1 l z i 2 l z where i 1 l z is the first term fraction of the expression and i 2 l z is the second one for the derivative of the first term we obtain 10 34 di 1 l dz l i 2 i i 1 ai ai 1 z i 2 1 zl 1 l 1 zl l i 1 i ai ai 1 z i 1 1 zl 1 2 62 v abramov and for the derivative of the second term we obtain 10 35 di 2 l dz l 1 zl l i 1 i ai ai 1 z i 1 1 zl 1 2 l 1 lzl 1 a 0 l i 1 ai ai 1 z i 1 zl 1 2 2 l 1 zl a 0 l i 1 ai ai 1 z i 1 zl 1 3 keeping in mind that the sequence ai is increasing we assume that all of a 1 a 2 of the sequence are not equal to a same constant it is read ily seen that all the terms fractions on the right hand sides of 10 34 and 10 35 are positive that is the derivatives di 1 l dz and di 2 l dz both are positive with the following change of argument the derivatives di 1 l 1 y l dy and di 2 l 1 y l dy where 0 y l both are neg ative this means that the required second derivative d 2 fl 1 y l dy 2 is positive this statement implies that d is a convex function the proof of the fact that d is a concave function is similar acknowledgements the author expresses his gratitude to all the people who made critical comments officially or privately the author thanks prof phil howlett university of south australia whose questions in a local seminar at the university of south australia in 2005 initiated the solution of this circle of problems including the earlier paper by the author 4 references 1 abramov v m 1991 investigation of a queueing system with service de pending on queue length donish dushanbe russian with tajik resume 2 abramov v m 2002 asymptotic analysis of the gi m 1 n loss system as n increases to infinity annals of operations research 112 35 41 3 abramov v m 2004 asymptotic behavior of the number of lost messages siam journal on applied mathematics 64 746 761 4 abramov v m 2007 optimal control of a large dam journal of applied probability 44 249 258 5 abramov v m 2010 taka cs asymptotic theorem and its applications a survey acta applicandae mathematicae 109 609 651 6 braverman a dai j g and miyazawa m 2017 heavy traffic approx imation for the stationary distribution of a generalized jackson network the bar approach stochastic systems 7 143 196 7 chen h and yao d d 2001 fundamentals of queueing networks per formance asymptotics and optimization springer new york optimal control of a large dam 63 8 cooper r b and tilt b 1976 on the relationship between the distribu tion of maximal queue length in the m g 1 queue and the mean busy period in the m g 1 n queue journal of applied probability 13 1 195 199 9 feller w 1966 an introduction to probability theory and its applications vol 2 john wiley new york 10 ferreira f pacheco a and ribeiro h 2017 moments of losses dur ing busy periods of regular and non preemptive oscilating mx g 1 n systems annals of operations reseach 252 191 211 11 gamarnik d and zeevi a 2006 validity of heavy traffic steady state ap proximation in generalized jackson networks the annals of applied probability 16 56 90 12 hardy g h littlewood j e and polya g 1952 inequalities second edn cambridge univ press london 13 knessl c matkowsky b j schuss z and tier c 1986 on the performance of state dependent single server queues siam journal on applied mathematics 46 4 657 697 14 knessl c matkowsky b j schuss z and tier c 1994 a state dependent gi g 1 queue european journal of applied mathematics 5 2 217 241 15 mandelbaum a and pats g 1995 state dependent queues approxima tions and applications in stochastic networks f p kelly and r j williams eds ima vol 71 springer new york pp 239 282 16 marschall a w and olkin i 2011 inequalities theory of majorization and its applications second edition springer new york 17 miller b m 2009 optimization of queueing system via stochastic control automatica j ifac 45 1423 1430 18 miller b m and mcinnes d j 2011 management of a large dam via op timal price control in proc 18 th world congress ifac milano italy august 28 september 2 2011 pp 12432 12438 19 pacheco a and ribeiro h 2008 moments of duration of busy periods of mx g 1 n systems probability in the engineering and informational sciences 22 1 8 20 pacheco a and ribeiro h 2008 consecutive customer losses in regular and oscillating mx g 1 n systems queueing systems 58 121 136 21 postnikov a g 1980 tauberian theory and its application proceedings of the steklov mathematical institute 2 144 ams transl from russian 22 rosenlund s i 1973 on the length and number of served customers of the busy period of a generalised m g 1 queue with finite waiting room advances in applied probability 5 379 389 23 ross s m 2000 introduction to probability models seventh edn har court academic press burlington 24 subhankulov m a 1976 tauberian theorems with remainder nauka moscow russian 25 suzuki t 1961 on a queueing process with service depending on queue length commentarii mathematici univ st pauli 10 1 12 26 suzuki t 1962 a queueing system with service depending on queue length journal of the operations research society of japan 4 147 169 27 suzuki t and ebe m 1967 decision rules for the queueing system m g 1 with service depending on queue length memoirs of the defence academy japan 7 no 3 7 13 64 v abramov 28 sznajder r and filar j a 1992 some comments on a theorem of hardy and littlewood journal of optimization theory and applications 75 201 208 29 taka cs l 1955 investigation of waiting time problems by reduction to markov processes acta mathematica hungarica 6 101 129 30 taka cs l 1962 introduction to the theory of queues oxford university press new york london 31 taka cs l 1967 combinatorial methods in the theory of stochastic pro cesses john wiley new york 32 tomko j 1967 a limit theorem in the queueing problem with indefinitely increasing intensity of flow studia scientiarum mathematicarum hungarica 2 447 454 in russian 33 whitt w 2001 stochastic process limits an introduction to stochastic process limits and their application to queues springer new york 34 whitt w 2004 heavy traffic limits for loss proportions in single server queues queueing systems 46 507 736 35 whitt w 2005 heavy traffic limits for the g h 2 m n queue mathematics of operations research 30 1 27 36 willmot g e 1988 a note on the equilibriumm g 1 queue length journal of applied probability 25 228 231 and 839