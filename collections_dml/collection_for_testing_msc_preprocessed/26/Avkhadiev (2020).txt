a strong form of hardy type inequalities on domains of the euclidean space f g avkhadiev 1 submitted by a m elizarov 1 kazan federal university russia 420008 kazan 35 kremlyovskaya ul room 601 received march 11 2020 revised march 18 2020 accepted april 10 2020 abstract we prove new integral inequalities for real valued test functions defined on subdomains of the euclidean space namely we obtain several new hardy type inequalities that contain the scalar product of gradients of test functions and of the gradient of the distance function from the boundary of an open subset of the euclidean space our method of proof is based on interior and exterior approximations of a given domain by sequences of simplest domains and has two important ingredients the first one is approximations of a given domain by elementary domains that admit a special partition the second ingredient is pre sented in this paper by theorems 1 and 2 about convergence everywhere of the sequences of distance functions from boundary of approximating elementary domains as well as about convergence almost everywhere for their gradients in the proofs we also use some basic theorems due to rademacher hardy motzkin and hadwiger 2010 mathematical subject classification 26 d 15 26 d 10 keywords and phrases hardy inequality euclidean maximal modulus distance function rademacher theorem motzkin theorem hyperbolic radius 1 introduction on open sets rn such that n 2 and rn we will consider inequalities for test functions u c 10 where c 1 0 is the family of smooth real valued functions with compact supports in the open set let dist x be the distance from the point x to the boundary of i e dist x inf y rn x y this distance function is well studied see for instance 1 ch 2 it has the following basic property dist x dist y x y x y 1 by rademacher s theorem 2 published in 1919 every lipschitz function f r is almost every where differentiable in therefore the distance function is differentiable in s where s is the set of all singular points such that the lebesgue measure mesns 0 consequently at any point x s the gradient dist x is well defined and dist x h dist x dist x h o h x s x h h 0 2 where dist x h is the euclidean scalar product of vectors from 1 and 2 it follows that dist x 1 x s 3 e mail avkhadiev 47 mail ru 2 avkhadiev as is indicated in 1 p 52 the assertion 3 is due to k s motzkin 3 and later it is proved independently by several other mathematicians in addition by motzkin s theorem a point x s if and only if there exists a unique point x such that dist x x x and that dist x x x x x moreover the gradient dist x of the distance function is a continuous function on its domain of definition i e on the set s there are many papers on hardy type inequalities see for instance the papers 4 22 one can find the basic results with detailed proofs in the book 1 by a a balinsky w d evans and r t lewis suppose that parameters p 1 and s for real valued functions u c 10 we will study a new hardy type inequality u x dist x pdx dists p x c p s u x pdx dists x u c 10 4 where u denotes the gradient of the function u r u x dist x is the scalar product the constant c p s 0 is defined to be maximal i e it is defined by the following formula c p s inf u c 10 u 0 u x dist x pdx dists p x dx u x pdx dists x 5 notice that c p s is invariant under linear conformal transformation in particular one has that c p s c p s a b where a b y rn y ax b x with a fixed point b rn and a fixed number a 0 inequality 4 is well studied by hardy in the case when n 1 and 0 r in this case one has that dist x x hardy considered separately three cases for 1 p s 2 and 2 p 1 s 1 and 3 p 1 s 1 the following theorem presents a unified version of hardy s results in a form suitable for our considerations theorem a compare 23 suppose that p 1 and s r then for every function f 0 r satisfying the conditions f c 10 0 and f 0 the following inequality is valid 0 f t p ts p dt s 1 p pp 0 f t p ts dt 6 where the constant s 1 p pp is sharp the following theorem is presented by a a balinsky w d evans in 13 theorem b 13 suppose that n 2 and rn is a convex domain such that rn if the parameter p 1 then u x dist x pdx p 1 p pp u x pdx distp x u c 10 7 where the constant p 1 p pp is sharp for every convex domain rn such that its boundary is smooth in a neighborhood of a point y we give see theorem 3 below a new proof of this theorem in a generalized and improved form more precisely we prove that c p s s 1 p pp for every convex domain rn rn and arbitrary fixed parameters p 1 and s 1 also we will prove an improved version see theorem 5 below of the following theorem due to the author theorem c see 8 and 9 suppose that n 2 p 1 s n rn is an open set such that rn then u x pdx dists p x s n p pp u x pdx dists x u c 10 8 lobachevskii journal of mathematics strong hardy inequalities 3 where the constant s n p pp is optimal one i e there exist domains rn rn for which the quantity s n p pp is the best possible constant in our recent paper 21 it is proved the following hyperbolic analog of theorem b instead of the distance function we use the hyperbolic radius r x satisfying the liouville equation 2 r x r x n r x 2 4 n x and the boundary condition r x 0 notice that the hyperbolic radius is a smooth function such that r x dist x in particular for the unit ball b x rn x 1 and the half space h n x 1 xn rn x 1 0 one has that r x b 1 x 2 and that r x h n 2 x 1 theorem bh see 17 and 21 suppose that n 2 1 p 1 n 2 s rn is a domain of hyperbolic type then for every real valued function u c 10 the following inequality is valid u x r x p dx rs p x 2 pnp pp u x pdx rs x if s 1 n 2 and h n then the constant 2 pnp pp in this inequality is sharp for any p 1 and any n 2 we will need the following result of hadwiger on convex bodies theorem d compare 24 let a rn be a convex compact set with 0 a and 0 a i e the origin is an interior point of a then for every 1 there exists an n dimensional convex polytope p such that p a p notice that for an n dimensional convex polytope p the set p p is a bounded convex subdomain of rn it is not difficult to obtain the following corollary of hadwiger s theorem corollary 1 let a rn be a convex compact set with 0 a and 0 a i e the origin is an interior point of a and let k a a be a compact set then there exist a number 1 and a corresponding n dimensional convex polytope p such that k p p a p suppose that p 1 s r let cp s be the best constant in the inequality u x pdx dists p x cp s u x pdx dists x u c 10 i e cp s inf u c 10 u 0 u x pdx dists p x dx u x pdx dists x since u x u x dist x for almost all x one has that cp s c p s notice that theorems 1 5 below were announced in the short communication 22 2 convergence theorems for distance functions for an open set rn we will consider two approximations by open sets j rn j n and we will study convergence of the distance functions j x dist x j and their gradients on an arbitrary compact set k 1 interior approximation suppose that rn j j 1 for all j n and j 1 j note that for every compact set k there exists a number n such that k j for any j n we will suppose that k j for all j n lobachevskii journal of mathematics 4 avkhadiev 2 exterior approximation we suppose that int i e is the set of interior points of 1 rn j 1 j for all j n and j 1 j in the sequel we will need the set compare 1 p 49 52 p x x dist x x x x evidently p x is a non empty set for every point x since rn according to motzkin s result 3 see also 1 p 52 the distance function dist x is differen tiable at the point x if and only if the set p x contains one point only consequently a point x s if and only if the set p x contains at least two points we have the following assertion for the case of the interior approximation theorem 1 let n 2 and let j 1 j where and j are open sets of the euclidean space rn rn and let k be a compact set denote x dist x j x dist x j suppose that k j j 1 j n then we have the following assertions i one has that j x x as j uniformly on the compact set k i e lim j max x k x j x 0 ii there exists a set s k such that n dimensional lebesgue measure mesns 0 and at any point x k s lim j j x x proof for a fixed point x k the sequence j x is non decreasing and bounded since j x x therefore there exists lim j j x 0 x next we will prove that 0 x to this end we consider a sequence of points x j p x j and its subsequence x jk convergent to a point x 0 as k one has that x x 0 0 clearly if 0 x then the point x 0 consequently for all sufficiently big j the point x 0 with some its neighborhood lie in the set j that contradicts the choice of x jk jk for any k n taking into account the fact that limk x jk x 0 now we prove that j x x as j uniformly on the compact set k suppose the contrary then there exist a number 0 0 and points xj k such that xj j xj 0 since k is a compact set there exists a subsequence xjk having a limit point x 0 k one has that 0 xjk jk xjk xjk x 0 x 0 jk x 0 jk x 0 jk xjk therefore taking into account the convergence jk x 0 x 0 and the lipschitz condition 1 for the distance functions and j j n one obtains a contradiction since 0 2 xjk x 0 x 0 jk x 0 0 as k now we prove assertion ii define s j 1 s j s k according to rademacher s theorem one has that mesns 0 lobachevskii journal of mathematics strong hardy inequalities 5 let x k s according to the definition of the set s the distance functions and j j n are differentiable at this point in addition using the motzkin result see 1 p 52 we have that p x x p x j x j and that x x x x x j x x x j x j x for all j n we have to prove that limj x j x suppose that this is not true consequently there exists a convergent subsequence xjk such that limk x jk x 0 and that x 0 x since jk x x xjk x x 0 jk x x as k one has that x x x 0 therefore x 0 p x x consequently x 0 x we have a contradiction that completes the proof of the theorem corollary 2 suppose that p 1 s r and n 2 let j 1 j where r n and j rn are open sets such that rn and that j j 1 for all j n then c p s lim sup j c p s j and cp s lim sup j cp s j proof consider a fixed function u c 10 with the compact support k u there exists a numberj 0 such that k j for every j j 0 choosing a subsequence jm m n such that jm j 0 and that lim sup j c p s j lim m c p s jm one can write jm u x dist x jm pdx dists p x jm c p s jm jm u x pdx dists x jm since k u jm m 1 jm we can rewrite this inequality in the form u x dist x jm pdx dists p x jm c p s jm u x pdx dists x jm letting m and applying theorem 1 we get that u x dist x pdx dists p x lim m c p s jm u x pdx dists x since the function u is an arbitrary function u c 10 and the constant c p s 0 is defined to be maximal see 5 we obtain that c p s lim m c p s jm lim sup j c p s j by the same way one gets cp s lim m cp s jm lim sup j cp s j lobachevskii journal of mathematics 6 avkhadiev whenever a subsequence jm m n is chosen such that jm j 0 and that lim sup j cp s j lim m cp s jm an analog of theorem 1 is valid for the exterior approximation too theorem 2 let j 1 j where and j are open sets of the euclidean space r n n 2 int 1 rn and let k be a compact set such that k denote x dist x j x dist x j suppose that j 1 j j n then the following two assertions are valid i one has that j x x as j uniformly on the compact set k i e lim j max x k x j x 0 ii there exists a set s k such that the n dimensional lebesgue measure mesns 0 and at any point x k s lim j j x x proof it is evident that for every point x the sequence j x is non increasing and j x x therefore there exists lim j j x 0 x on the other hand one has that j x 0 for all j n therefore the set j 1 j contains the ball b 0 x y r n x y 0 since int one has that b 0 x consequently 0 x thus one obtains that 0 x if the uniform convergence j x x as j on the compact set k is not true then there exist a number 0 0 and a subsequence xjk k points such that lim k xjk x 0 k xjk jk xjk 0 using the convergence jk x 0 x 0 the lipschitz condition 1 for the functions and j j n and the inequalities 0 xjk jk xjk xjk x 0 x 0 jk x 0 jk x 0 jk xjk we obtain the following contradiction 0 2 xjk x 0 x 0 jk x 0 0 as k using the scheme of proof of the corresponding assertion in the proof of the precedent theorem we easily obtain the convergence limj j x x of the gradients of distance functions at every point x k s corollary 3 suppose that p 1 s r and n 2 let j 1 j where int r n and j rn are open sets such that 1 rn and that j 1 j for all j n then c p s lim sup j c p s j and cp s lim sup j cp s j lobachevskii journal of mathematics strong hardy inequalities 7 proof first as in the proof of corollary 2 we consider a fixed function u c 10 with the compact support k u and choose a subsequence jm m n such that lim sup j c p s j lim m c p s jm next for this function u we have that u x dist x jm pdx dists p x jm c p s jm u x pdx dists x jm letting m and applying theorem 2 we get that u x dist x pdx dists p x lim m c p s jm u x pdx dists x for this function u consequently for every function u c 10 therefore as in the proof of corollary 2 we obtain that c p s lim m c p s jm lim sup j c p s j using the same scheme of proof one obtains cp s lim m cp s jm lim sup j cp s j 3 main results in the sequel we consider inequalities for real valued functions u c 10 the following theorem generalizes the theorem b and improves and generalizes several results from the papers 1 8 9 and 16 more precisely we generalize theorem b of balinsky and evans in addition we improve the theorem by proving that the constant in the corresponding inequality is sharp for every convex domain rn such that rn theorem 3 suppose that n 2 and rn is a convex domain such that rn if p 1 and s 1 then u x dist x pdx dists p x s 1 p pp u x pdx dists x u c 10 9 where the constant s 1 p pp is sharp more precisely for every convex domain rn and arbitrary fixed parameters p 1 and s 1 one has that c p s s 1 p pp proof suppose that n 2 parameters p 1 and s 1 in principle we have to prove that c p s s 1 p pp for every convex domain rn such that rn to obtain this assertion we have to prove that c p s s 1 p pp and that c p s s 1 p pp proof of the inequality c p s s 1 p pp first we consider the case when is a bounded convex domain clearly on it is sufficient to prove inequality 9 for an arbitrary but fixed function u c 10 let k u supp u be the compact support of this fixed function u c 10 in the bounded convex domain according to corollary 1 of hadwiger s theorem d for the convex compact set a there exist a constant 1 1 and the corresponding convex polytope p 1 such that k 1 k u p 1 p 1 1 p 1 by induction we construct a sequence j and convex polytopes p j such that j 1 for any j n and that limj j 1 and that kj p j 1 p j p j jp 1 j 2 lobachevskii journal of mathematics 8 avkhadiev evidently one has that j 1 j where j p j p j are convex domain such that k u 1 and that j j 1 for all j n it is clear that j is an intersection of finite number of open half spaces suppose that the boundary of the open polytope j consists on mj different faces jm of dimension n 1 then j mj m 1 jm j s j mj m 1 jm where jm is defined by jm x j p x jm let jm be the set of interior points of jm and let n jm be the vector of interior normal to the face jm of j suppose that p x y where y jm then there exists a continuous function jm jm 0 such that jm x rn x y t n jm y jm t dist x j 0 jm y suppose that x x t jm x jm t dist x j therefore by fubini s theorem jm g x t dx jm dx jm x 0 g x t dt 10 for any bounded function g c jm putting p 1 s 1 x x t and applying the hardy inequality see theorem a to the function u c 10 with respect to the variable t 0 jm x one gets jm x 0 u x t t p tp sdt s 1 ppp jm x 0 u x t p t sdt taking into account formulas t dist x j and 10 and the identity u x t t u x dist x j 11 we obtain jm u x dist x j pdx dists p x j s 1 p pp jm u x pdx dists x j since j s j mj m 1 jm one gets j u x dist x j pdx dists p x j s 1 p pp j u x pdx dists x j which is equivalent to the inequality u x dist x j pdx dists p x j s 1 p pp u x pdx dists x j because of the inclusions k u j letting j in this inequality applying theorem 1 and lebesgue s theorem on the majorized convergence of integrals we obtain inequality 9 thus inequality c p s s 1 p pp is proved on every bounded convex domain rn now let rn be an unbounded convex domain such that rn evidently if the number j 0 is sufficiently big and j n then j x rn x j 0 j are convex bonded subdomains lobachevskii journal of mathematics strong hardy inequalities 9 of and j 1 j it is proved that c p s j s 1 p pp therefore applying corollary 2 to the unbounded domain rn we obtain the desired inequality c p s lim sup j c p s j s 1 p pp proof of the inequality c p s s 1 p pp let rn be a convex domain such that rn suppose that p 1 s 1 let cp s the best constant in the inequality u x pdx dists p x cp s u x pdx dists x u c 10 since u x u x dist x one has cp s c p s s 1 p pp 12 next we need an additional fact suppose that x s then there exists a point x such that x x dist x let b y rn y x x x b y rn y 2 x x x x one has that b and b rn in addition it is easy to show that x is a common boundary point for these balls according to theorem 1 of the author and i k shafigullin from 16 we obtain that for such a domain cp s s 1 p pp using this fact and inequalities 12 one gets that c p s s 1 p pp and this completes the proof of theorem 3 using theorem 2 from 16 and theorem 3 one gets the following assertion corollary 4 suppose that p 1 s 1 and n 2 then for every convex domain rn such that rn the equalities c p s cp s s 1 p pp are valid letting s p in theorem 3 we obtain corollary 5 suppose that p 1 n 2 and rn is a convex domain such that rn then u x dist x pdx p 1 p pp u x pdx distp x u c 10 where the constant p 1 p pp is sharp more precisely for every convex domain rn and arbitrary fixed parameters p 1 one has that c p p p 1 p pp in the case p 1 one gets corollary 6 suppose that n 2 and rn is a convex domain such that rn if s 1 then u x dist x dx dists 1 x s 1 u x dx dists x u c 10 where the constant s 1 is sharp more precisely for every convex domain rn and every s 1 one has that c 1 s s 1 next we give an improvement of a result by the author and k j wirths from the paper 10 see also 12 14 and 1 for related results we will need the inradius 0 supx x and the lamb constant 0 0 940 defined as the first positive root of the equation j 0 t 2 tj 1 t 0 where j 0 and j 1 are bessel s functions of order 0 and 1 respectively lobachevskii journal of mathematics 10 avkhadiev theorem 4 let rn be a convex domain such that 0 then for any real valued function u c 10 the following inequality is valid u x dist x 2 dx 1 4 u x 2 dx dist 2 x 20 20 u x 2 dx 13 where the constant 1 4 is sharp for every convex domain rn rn the second constant 20 2 0 is optimal namely for any n 2 there are convex domains r n for which 0 and the second constant is sharp too proof first we prove the inequality 13 for the case when is a bounded convex domain clearly it is sufficient to prove the inequality for an arbitrary but fixed function u c 10 let k u supp u we will need the following inequality see 10 a 0 g t 2 dt 1 4 a 0 g t 2 t 2 dt 20 a 2 a 0 g t 2 dt 14 which is valid with an arbitrary constant a 0 for all functions g c 1 0 a such that g 0 0 using corollary 1 of hadwiger s theorem d as in the proof of theorem 3 we construct a sequence j and convex polytopes p j such that j 1 for any j n and that limj j 1 and that kj p j 1 p j p j jp 1 j 2 therefore one has that j 1 j where j p j p j are convex domain such that k u 1 and that j j 1 for all j n as in the proof of theorem 3 the boundary of the open polytope j consists on mj different faces jm of dimension n 1 in addition one has that j mj m 1 jm j s j mj m 1 jm where jm is defined by jm x j p x jm as in the proof of theorem 3 we define the set jm interior points of jm and the vector n jm of interior normal to the face jm of j moreover consider p x y where y jm then there exists a continuous function jm jm 0 such that jm x rn x y t n jm y jm t dist x j 0 jm y therefore by fubini s theorem jm f x t dx jm dx jm x 0 f x t dt for any bounded function f c jm using this formula putting x x t and applying the inequality 14 with a jm x 0 j to the function u c 10 with respect to the variable t one gets jm x 0 u x t t 2 dt 14 jm x 0 u x t 2 t 2 dt 20 20 j jm x 0 u x t 2 dt taking into account formulas t dist x j and 10 and the identity 11 we obtain jm u x dist x j 2 dx 1 4 jm u x 2 dx dist 2 x j 20 20 j jm u x 2 dx using the formula j s j mj m 1 jm and summing one gets j u x dist x j 2 dx 1 4 j u x 2 dx dist 2 x j 20 20 j j u x 2 dx 15 lobachevskii journal of mathematics strong hardy inequalities 11 which is equivalent to the inequality u x dist x j 2 dx 1 4 u x 2 dx dist 2 x j 20 20 j u x 2 dx since k u j letting j in this inequality applying theorem 1 and lebesgue s theorem on the majorized convergence of integrals we obtain inequality 13 in the case of bounded convex domains now suppose that rn is an unbounded convex domain such that rn consider a real valued function u c 10 with the support k u for a sufficiently big number j 0 we will use the following representation j 1 j where the sets j x rn x j 0 j are convex bonded subdomains of andk u j for all j n on the bounded convex domain j we have the inequality 15 letting j in the inequality 15 we arrive to the inequality 13 in the case of unbounded convex domains to complete the proof of theorem 4 we have to justify assertions on the sharpness of the constants 1 4 and 20 2 0 from theorem 3 it follows that c 2 2 1 4 therefore the constants 1 4 in the inequality 15 is sharp for every convex domain rn such that rn in the paper 10 it is proved that the constants 20 2 0 in the inequality u x 2 dx 1 4 u x 2 dx dist 2 x 20 20 u x 2 dx u c 10 is sharp for certain convex domains in particular for domains of the form 0 1 rn 1 since u x u x dist x we have that the constants 20 2 0 in the inequality 15 is sharp for domains of the form 0 1 rn 1 too this completes the proof we will need a numerical characteristic of the open set rn n 2 namely the euclidean maximum modulus m 0 by definition m 0 sup a 2 1 ln ra ra where the supremum is taken over all domains a a ba ra ra x rn ra x ba ra having the following properties a ba 0 ra ra if such a domain a doesn t exist then we take by definition that m 0 0 compare 8 and 21 the following theorem improves a result of the author see the papers 8 and 9 theorem 5 let n 2 and let rn be an open set such that rn suppose that p 1 s n then u x dist x pdx dists p x s n p pp u x pdx dists x u c 10 16 where the constant s n p pp is optimal namely one has the sharp value c p s s n p pp for every open set rn such that rn and that m 0 proof it suffices to prove the desired inequality for the case when is a domain since an open set of the euclidean space is a finite or countable union of domains clearly if the inequality is established for every component of the open set then summing one obtains the desired inequality on the open set to prove the inequality on a domain rn for a given function u c 10 k suppu we use an interior approximation of with a sequence of non decreasing cubic open sets j where every lobachevskii journal of mathematics 12 avkhadiev j is a union of finite number of cubes with faces parallel to the coordinate planes evidently we use approximations similar to approximations used to construct the interior jordan measure in 8 and 9 we used a special representation of such a set j s j as a union of its simplest subdomains jm for integral over subdomains jm it is possible to use formulas similar to equations 10 and 11 with a coordinate t j x dist x j that are interpreted as a cartesian coordinate or the radius in some generalized polar system of coordinates now we describe our construction of the approximating sequence for the domain rn let k be a compact set we suppose that k is the compact support of the given function u c 10 for a sufficiently small number h 0 1 we consider the covering of the euclidean space rn by the cubes c z h x rn x hz y y 0 h n z zn define h as the set of interior points of the union of all cubes c z h such that c z h x rn x 1 h we suppose that the parameter h 0 1 is sufficiently small then h is a non empty open set and its closure consists on finite number of cubes c z h in addition we suppose that 0 h d k n where d k dist k inf x y x k y 0 clearly for such a parameter h the compact set k h and 1 dist x dist x h 1 h n d k for all points x k now we define j hj where hj h 2 j 1 j n one has that j 1 j k j j 1 j n next we need a partition of the boundary of the domain j j n it is clear that j is a union of n 1 dimensional faces of some cubes c z hj we will precise this partition of the boundary set using cubic faces of dimension smaller than n 1 let k 0 1 n 1 and let gjm j be a k dimensional face of a cube c z hj first we remark that the singular set s j consists on points x j such that p x j gjm and p x j gjm where gjm gjm it is easy to show that the set of all points x j disposed in a same distance from the different cubic faces is a bounded subset of an n 1 dimensional plane or an n 1 dimensional surface of second order since j contains a finite number of our cubic faces then mesns j mesns j 0 where s j means the closure in j of the set s j we define sets gjm in the following way if dimgjm 0 i e this face is a corner of a cube then we put that g g if dimgjm k 1 n 1 then we assume that up to rotations and translations the set gjm is identic to 0 h k and gjm gjm and consequently the closure of gjm is the face gjm j it is clear that there exist a finite number of sets gjm m 1 2 mj such that gjm gjm for m m and that j mj m 1 gjm now we define a subset of the set j by w gjm x j s j p x j y y gjm lobachevskii journal of mathematics strong hardy inequalities 13 clearly for every bounded continuous function g c j one can write j g x dx mj m 1 w gjm g x dx denote rn k t 1 tn k r n k t 1 0 tn k 0 and sn k t r n k t 1 let gjm be a face of dimension k 0 1 n 1 and let mesnw gjm 0 then up to rotations and translations the set w gjm can be presented as a subset of the orthogonal product gjm rn k more precisely w gjm y y gjm sn k 0 k y gjm j where k is a continuous function satisfying the inequalities 0 k y gjm j 0 j let ak 0 and let x y r where r dist x j for the given function u c 10 we will need the following inequalities ak 0 u y r r p rp s n 1 kdr s n k ppp ak 0 u y r p rs n 1 k dr 17 where k 0 1 n 1 inequalities 17 follow from the hardy inequalities ak 0 u y r r p rp skdr sk 1 ppp ak 0 u y r p rsk dr for sk 1 in the case sk s n 1 k where s n since sk 1 s n k s n for every k 0 1 n 1 then 17 imply that ak 0 u y r r p rp s n 1 kdr s n ppp ak 0 u y r p rs n 1 k dr 18 where p 1 s n k 0 1 n 1 to compute integrals over the set w gjm with the variable r dist x j as a component of the space variable of integration we will use spherical cylindric or cartesian coordinates using fubini s theorem one obtains n different formulas for iterated integrals which contain functions k y k y gjm j 0 0 j more precisely one has the following cases if dim gjm n 1 then w gjm g x dx gjm dy n 1 y 0 0 g y r 0 dr if dim gjm n k mesnw gjm 0 and 2 k n 1 then w gjm g x dx gjm dy sk d n k y 0 g y r rk 1 dr if dim gjm 0 i e gjm x 0 and mesnw gjm 0 then w gjm g x dx sn d 0 x 0 0 g x 0 r r n 1 dr lobachevskii journal of mathematics 14 avkhadiev taking into account these formulas and the identity 11 applying one dimensional integral inequal ities of the form 18 with respect to the variable r j x dist x j we obtain some inequalities for integrals over the set w gjm mesnw gjm 0 summing for m 1 2 mj one gets that j u x dist x j pdx dists p x j s n p pp j u x pdx dists x j 19 letting j in the inequality 19 and applying theorem 1 and lebesgue s theorem on the majorized convergence of integrals we obtain the final inequality 16 consequently c p s s n p pp for every open set rn such that rn now suppose that p 1 s n rn ia an open set such that rn and m 0 we have to prove that c p s s n p pp by definition of the maximal euclidean modulus the condition m 0 implies that there exists a sequence of domains ak a bk rk rk such that bk 0 rk rk lim k rk rk it is evident that x bk dist x x bk rk for x ak rk x bk rk rk 2 we define a new sequence of subdomains by a k a bk r k r k where r k r k r k r k we have that x bk dist x x bk rk for all x a k and that bk 0 r k r k lim k r k r k by definition of the constant c p s see 4 and 5 for the chosen one can write a k u x dist x pdx dists p x c p s a k u x pdx dists x u c 10 a k k n from this it follows that a k u x pdx min x bk s p x bk r k s p c p s a k u x pdx x bk s u c 10 a k k n we consider a change of variables in integrals of the latter inequality taking y x bk rkrk denote k x bk rkrk x a k x bk rkrk x a k by straightforward computations one gets that 0 0 0 k a k a qk 1 qk k qk r k r k lim k qk 0 and that a k u y pdy min y s p y qk s p c p s a k u y pdy y s u c 10 a k k n 20 let us consider a fixed real valued function f c 10 r n 0 for all sufficiently big k n the support of the function f lies in the domain a k applying the inequality 20 to the function u f and letting k one has that rn f y p dy y n p c p s rn f y p dy y n lobachevskii journal of mathematics strong hardy inequalities 15 for the function f consequently for all f c 10 r n 0 taking radial functions f y y we obtain that 0 r p dr rs n 1 p c p s 0 r p dr rs n 1 c 10 0 from the hardy inequality see theorem a it follows that 0 r p dr rs n 1 p s n p pp 0 r p dr rs n 1 c 10 0 with sharp constant s n p pp therefore c p s s n p pp and this completes the proof of theorem 5 corollary 7 suppose that p 1 n 2 and s n then for every open set rn such that rn and that m 0 the equalities c p s cp s s n p pp are valid letting s p in theorem 5 we obtain corollary 8 let n 2 and let rn be an open set such that rn suppose that p n then u x dist x pdx p n p pp u x pdx distp x u c 10 where the constant p n p pp is optimal namely one has the sharp value c p p p n p pp for every open set rn such that rn and that m 0 if p 1 then theorem 5 implies corollary 9 let n 2 and let rn be an open set such that rn suppose that s n then u x dist x dx dists 1 x s n u x dx dists x u c 10 where the constant s n is optimal namely one has the sharp value c 1 s s n for every open set rn such that rn and that m 0 4 some remarks suppose that p 1 s 1 and n 2 in the moment it is not clear whether the equality c p s cp s is valid for every open set rn such that rn one can ask for a more elementary problem find a domain rn such that cp s 0 but c p s 0 for some values of p 1 and s 1 denote s the closure in of the set of all singular points of the distance function in 2003 c mantegazza and a c mennucci 25 presented an example of a bounded convex domain r 2 for which the set s has a positive two dimensional lebesgue measure in principle in 25 a family of such a domain r 2 is presented the geometric description of r 2 is simple and based on the construction of smith volterra cantor type sets on the unit circle x r x 1 evidently the example of mantegazza and mennucci may be generalized to the dimension n 3 clearly one can take a sufficiently big number a 0 and consider the following n dimensional convex domain 0 a n 2 for which mesns 0 notice that the domains considered in theorems 3 5 may have similar properties i e in the theorems are admissible domains with the propertymesns 0 but in proofs of the theorems we used bounded approximating domains j such that s j s j therefore mesns j 0 acknowledgments this work was supported by the russian science foundation under grant no 18 11 00115 lobachevskii journal of mathematics 16 avkhadiev references 1 a a balinsky w d evans and r t lewis the analysis and geometry of hardy s inequality universitext heidelberg new york dordrecht london springer 2015 2 h rademacher u ber partielle und totale differenzierbarkeit i math ann 89 4 340 359 1919 3 t s motzkin sur quelques proprie te s characte ristiques des ensembles convexes atti real accad naz lincei rend cl sci fis mat natur serie vi 21 1935 562 567 1935 4 c bandle and m flucher table of inequalities in elliptic boundary value problems in recent progress in inequalities v milovanovic ed kluwer academic publ 97 125 1998 5 e b davies a review of hardy inequalities the maz ya anniversary collection vol 2 oper theory adv appl 110 55 67 1999 6 v m miklyukov and m k vuorinen hardy s inequality for w 1 p 0 functions on riemanni an manifolds proc amer math soc 9 127 2145 2154 1999 7 m hoffmann ostenhof t hoffmann ostenhof and a laptev a geometrical version of hardy s inequal ity j func anal 189 539 548 2002 8 f g avkhadiev hardy type inequalities in higher dimensions with explicit estimate of constants lobachevskii j math 21 3 31 2006 9 f g avkhadiev hardy type inequalities on planar and spacial open sets proc steklov inst math 255 2 12 2006 10 f g avkhadiev and k j wirths unified poincare and hardy inequalities with sharp constants for convex domains z angew math mech zamm 87 8 9 632 642 2007 11 f g avkhadiev and a laptev hardy inequalities for nonconvex domains international mathematical series around research of vladimir maz ya i function spaces springer v 11 1 12 2010 12 f g avkhadiev and k j wirths weighted hardy inequalities with sharp constants lobachevskii j math 31 1 1 7 2010 13 a a balinsky w d evans some recent results on hardy type inequalities appl math inf sci 4 2 191 208 2010 14 f g avkhadiev and k j wirths sharp hardy type inequalities with lamb s constants bull belg math soc simon stevin 18 723 736 2011 15 f g avkhadiev a geometric description of domains whose hardy constant is equal to 1 4 izv math 78 5 855 876 2014 16 f g avkhadiev and i k shafigullin sharp estimates of hardy constants for domains with special boundary properties russian math iz vuz 58 2 58 61 2014 17 f g avkhadiev integral inequalities in hyperbolic type domains and their applications sbornik mathe matics 206 12 1657 1681 2015 18 f g avkhadiev hardy rellich inequalities in domains of the euclidean space j math anal appl 442 469 484 2016 19 f g avkhadiev sharp hardy constants for annuli j math anal appl 466 936 951 2018 20 f g avkhadiev r v makarov hardy type inequalities on domains with convex complement and uncertainty principle of heisenberg lobachevskii j math 40 9 1250 1259 2019 21 f g avkhadiev conformally invariant inequalities in domains in euclidean space izv math 83 5 909 931 2019 22 f g avkhadiev properties and applications of the distance functions on open sets of the euclidean space russian math iz vuz 64 4 78 81 2020 23 g h hardy j e littlewood and g polya inequalities cambridge univ press cambridge 1934 24 h hadwiger vorlesungen u ber inhalt oberfla cher und isoperimetrie springer berlin go ttingen heidelberg 1957 25 c mantegazza a c mennucci hamilton jacobi equations and distance functions on riemannian manifolds appl math optim 47 1 25 2003 lobachevskii journal of mathematics