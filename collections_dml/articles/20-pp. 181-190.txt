  МНОГОМАСШТАБНЫЙ АНАЛИЗ НА ОСНОВЕ МКЭ И ВЕЙВЛЕТ-ПРЕОБРАЗОВАНИЯ 1  С.П. Копысов, Ю.A. Сагдеева Институт прикладной механики УрО РАН, г. Ижевск  1 Введение  Теория вейвлетов, хотя и появилась сравнительно недавно, активно используется для решения самых разных прикладных задач [1–3]. Одно из главных преимуществ вейвлет-представления функции заключается в возможности работать с функцией в том масштабе, который нас интересует, т. е. при необходимости можно рассматривать как мелкие детали функции, так и ее общее поведение. Такая возможность выбора разрешения привлекательна при решении дифференциальных уравнений Lu = f с быстро изменяющимися коэффициентами (например, задачи теории упругости композитных материалов). Исходное уравнение в таких задачах заменяется на осредненное, так, чтобы решение осредненной задачи соответствовало решению исходной задачи.  Наиболее разработанной теорией осреднения является асимптотическое осреднение (осреднение Н.С. Бахвалова) [4], при котором решение представляется в виде нескольких составляющих – грубой (осредненной) компоненты и быстроосциллирующих локальных уточнений. Этот метод требует решения периодических задач в представительном объеме и довольно сложен для программной реализации. На сегодняшний день примеры его реализации ограничены двухмерным случаем (см., например, [5]).  Проводить осреднение также можно с помощью вейвлетов. В этом случае вейвлет-преобразование комбинируется с одним из сеточных методов – методом конечных разностей (МКР) или методом конечных элементов(МКЭ), причем вейвлеты используются на разных этапах решения задачи. Так, вейвлеты могут быть выбраны в качестве базисных функций в МКЭ или использоваться на этапе решения СЛАУ, полученной в ходе решения (многомасштабный анализ). Использование вейвлетов в качестве базисных функций еще недостаточно изучено, но первые примеры по 1Работа выполнена при поддержке РФФИ, проект № 02-07-90265.  182    С.П. Копысов, Ю.A. Сагдеева  казали, что СЛАУ, полученные в МКЭ, имеют худшие свойства по сравнению с классическими базисными функциями (см. [6]).  В многомасштабном анализе достаточно хорошо исследовано применение вейвлетов к СЛАУ, формируемым в МКР. В этом случае доказано [7], что оператор L, осредненный с помощью кратномасштабного анализа, сохраняет свой вид, что позволяет найти соответствие между полученным вектором решения и узлами сетки. В случае МКЭ интерпретация решения для сетки затруднена, т. к. не существует явного выражения дискретизированного оператора для МКЭ. Матрица СЛАУ складывается из отдельных элементных матриц, причем в соседних строках (т. е. тех, которые будут осредняться) могут стоять переменные, отвечающие узлам, расположенным далеко друг от друга. Однако МКЭ позволяет решать задачи для более сложных сеток и широко используется при решении трехмерных задач. Поэтому геометрическая интерпретация решения является важной задачей. Работы, представленные в этой области, ограничены пока одномерным случаем.  Данная работа посвящена применению двумерного вейвлетпреобразования Хаара к СЛАУ, полученным в МКЭ. Работа имеет следующую структуру. Сначала вводится понятие ”вейвлет”, затем определяется процедура многомасштабной декомпозиции. Особое внимание уделяется алгоритму двумерного преобразования. Приводится численный пример.  2 Вейвлеты и их свойства  Рассмотрим пространство V . Вейвлетами называются функции, образующие базис пространства V , и получаемые сдвигом и сжатием одной функции (обозначим ее ψ(x)), называемой материнским вейвлетом, по формулам  ψj,k(x) = 2 j/2ψ(2jx− k), k, j ∈ Z.  Эти функции имеют конечный носитель и их средние равны нулю. В качестве пространства V часто выбирают пространство L2(R).  Кроме того, вводят масштабирующие функции φj,k(x), которые тоже являются базисом пространства L2(R) и образуются по  183    Многомасштабный анализ на основе МКЭ и вейвлет-преобразования  аналогичной схеме  φj,k(x) = 2 j/2φ(2jx− k), (2.1)  но среднее этих функций равно единице, т. е. ∫ φj,k(x) = 1. Функ ций, обладающих вышеописанными свойствами, достаточно много. Предпочтительными среди них являются те, которые обладают свойствами ортогональности, симметричности, гладкости и имеют компактные носители. Однако единственным базисом, удовлетворяющим всем свойствам, кроме третьего, является базис Хаара. Вместе с тем этот базис является и наиболее простым. Базис Хаара задается следующими функциями:  ψ(x) =  { 1, x ∈ [0, 1/2), −1, x ∈ [1/2, 1], φ(x) =  { 1, x ∈ [0, 1], 0, x /∈ [0, 1].  Однако он плохо подходит для аппроксимации гладких функций, поэтому рассматривают также полуортогональные и биортогональные вейвлеты.  3 Кратномасштабная декомпозиция функции  В силу иерархического определения масштабирующих функций и вейвлетов таким же свойством иерархичности будет обладать последовательность определяемых ими пространств. Рассмотрим для каждого n пространство Vn = span {φn,k(x)}. Благодаря (2.1) последовательность пространств Vn будет вложенной, т. е.  V0 ⊂ V1 ⊂ . . . ⊂ Vn ⊂ . . . (3.1)  Пространство Vn+1 может быть определено как прямая сумма пространства Vn и дополнения к нему: Vn+1 = Vn ⊕Wn (в случае базиса Хаара это дополнение будет ортогональным). Функции ψn,k(x) образуют базис пространства Wn. Следовательно, существует единственное представление базисной функции φn+1,j(x) через базисные функции подпространств:  φn+1,j(x) = cnφn,j(x) + dnψn,j(x). (3.2)  184    С.П. Копысов, Ю.A. Сагдеева  Иерархические свойства этих двух типов функций лежат в основе кратномасштабного анализа. Такой анализ позволяет представить функцию в виде ее последовательных приближений. Основу декомпозиции составляют два положения о свойствах этих пространств: вложенность (3.1) и выполнение условия: f(x) ∈ Vj ⇐⇒ f(2x) ∈ Vj+1, и существует такая функция φ(x) ∈ V0, что ее сдвиги φ(x) образуют ортонормированный базис пространства V0. Масштабирующие функции и вейвлеты как раз определяют такую последовательность подпространств. Таким образом, f(x) ∈ L2(R) может аппроксимироваться последовательностью функций fn(x) ∈ Vn.  Наилучшей аппроксимацией функции f(x) в пространстве L2(R) является ее ортогональная проекция на это пространство:  fn(x) = ∑  k  (f(x), φn,k(x))φn,k(x)) = ∑  k  cn,k(x)φn,k(x). (3.3)  В силу иерархичности пространств fn(x) ∈ Vn можно представить через функции подпространств Vj и Wj , j = n− 1, . . . , n−M :  fn(x) = fn−1(x) + gn−1(x) = fn−M +  M∑  i=1  gn−i(x).  С учетом (3.2) и (3.3) имеем  fn(x) = c00φ(x) +  n−1∑  j=0  ∑  k∈Z  djkψj,k(x).  Такое представление называется вейвлет-разложением функции fn. Таким образом, функция из Vn представляется в виде совокупности грубого приближения (функция φ(x)) и уточняющих добавок (функции ψj,k(x)).  Введем в рассмотрение вектор cn размерности 2 n.Данный век тор представим как последовательность коэффициентов разложения в кратномасштабном анализе некоторой функции:  fn = 2n∑  k=1  cn,kφn,k, cn = (cn,1, cn,2, . . . , cn,2n).  185    Многомасштабный анализ на основе МКЭ и вейвлет-преобразования  В свою очередь базисные функции одного пространства тоже запишем через базисные функции более широкого пространства. Поэтому коэффициенты разложения выразятся в матрично-векторном виде  cn−1 = Pncn, dn−1 = Qncn. (3.4)  Вектор cn−1 является проекцией вектора cn на пространство Vn−1, т. е. его огрубленным представлением. Вектор dn−1 соответствует уточняющим коэффициентам. Строки матриц P и Q образуются последовательным сдвигом первой строки, т. к. масштабирующие функции инвариантны относительно сдвига. Кроме того, возможна и обратная операция восстановления:  ( cn−1 dn−1  ) =  ( Pn Qn  ) cn, cn = (P  −1 n |Q−1n )  ( cn−1 dn−1  ) .  Если масштабирующие функции ортогональны между собой, ортогональны вейвлетам и вейвлеты ортогональны между собой, то преобразование Wn = (Pn/Qn) является ортогональным, т. е. W−1n = W  T n , а операции декомпозиции и восстановления запи шутся в виде rn =Wncn, cn =W T n rn, где rn = (cn−1/dn−1).  По аналогии можно выразить решение СЛАУ, если в конечном итоге нам необходимо знать не точное решение, а осредненное представление неизвестного вектора.  Применим к системе  Ax = b, A = (aij), b = (bi), x = (xi), i, j = 1, . . . , 2 n, (3.5)  вейвлет-преобразование Wn. Получим  WnAx =Wnb, WnAW T nWnx =Wnb,  ( Pn Qn  ) A(PTn Q  T n )  ( xcn−1 xdn−1  ) =  ( bcn−1 bdn−1  ) ,  ( PnAP  T n PnAQ  T n  QnAP T n QnAQ  T n  )( xcn−1 xdn−1  ) =  ( bcn−1 bdn−1  ) . (3.6)  Осредненный вектор xcn−1 (этот вектор имеет вдвое меньше координат, чем исходный) выражается из последнего уравнения с помощью дополнения Шура. Введем обозначения  K11 = QnAQ T n , K12 = QnAP  T ,  186    С.П. Копысов, Ю.A. Сагдеева  K21 = PnAQ T n , K22 = PnAP  T n ,  x1 = x d n−1, x2 = x  c n−1, b1 = b  d n−1, b2 = b  c n−1  и перепишем систему (3.6) в виде  ( K11 K12 K21 K22  )( x1 x2  ) =  ( b1 b2  ) .  Выразив x1 из первого уравнения и подставив его во второе, получим систему  Sx2 = b, (3.7)  где S – дополнение Шура:  S = K22 −K21K−111 K12, b = b2 −K21K−111 b1.  Разрешив ее, получим искомое осредненное решение. Кроме того, по найденному x2 можно найти x1 = K  −1 11 (f1 − K12x2) и восста новить исходное решение x системы (3.5). Однако существует и второй вариант: не разрешать систему (3.7), а опять применить к ней вейвлет-преобразование. Таким образом, рекурсивно использовав вейвлет-преобразование несколько раз, можно найти грубое представление вектора x на нужном нам масштабе, причем на самом грубом масштабе получится система из одного уравнения. Вообще систему (3.7) рассматривают как осредненную систему для (3.5).  Двумерное вейвлет-преобразование  Введем расширение вейвлет-представления с одномерного случая на двумерный. Базисные функции в этом случае будут образовываться за счет всевозможных комбинаций тензорных произведений базисных функций для одномерного случая. Базисными будут являться функции φj,k ⊗ φj,k, ψj,k ⊗ φj,k, φj,k ⊗ ψj,k, ψj,k ⊗ ψj,k. Аналогично одномерному случаю введем последовательность вложенных пространств Vn и пространства Wn:  Vn = span {φn,k1 ⊗ φn,k2 , ki ∈ Z},  Wn = span {ψn,k3 ⊗ φn,k4 , φn,k5 ⊗ ψn,k6 , ψn,k7 ⊗ ψn,k8 , ki ∈ Z}.  187    Многомасштабный анализ на основе МКЭ и вейвлет-преобразования  Как видно, dim(Wn) = 3 dim(Vn). Пространство Vn = Vn ⊗ Vn отвечает за осредненные величины, пространство Wn содержит информацию о взаимосвязи двух направлений и уточняющую информацию: Wn = (Wn ⊗Wn)⊕ (Wn ⊗ Vn)⊕ (Vn ⊗Wn).  Две проекции вектора cn ∈ Vn на пространства Vn−1 и Wn−1 выражаются аналогично одномерному (3.4), но в двумерном случае вектор dn−1 состоит из трех компонент, поэтому вейвлетпреобразование будет состоять из четырех операторов проекций  Wn = (P Q1 Q2 Q3)T ,  P : Vn ⊗ Vn −→ Vn−1 ⊗ Vn−1, Q1 : Vn ⊗ Vn −→ Vn−1 ⊗Wn−1, Q2 : Vn ⊗ Vn −→Wn−1 ⊗ Vn−1, Q3 : Vn ⊗ Vn −→Wn−1 ⊗Wn−1. Операторы будут состоять из двух блоков – один, действующий по координате x, второй – по координате y:  P = PxPy, Q1 = PxQy, Q2 = QxPy, Q3 = QxQy.  Преобразование W является ортогональным, т. к. свойства базисных функций сохраняются. Применив преобразование Wn к системе Ax = b, получим (индексы n и n− 1 опущены)  WAWTWx =Wb,    P Q1 Q2 Q3   A(P  ∗Q∗1Q∗2Q∗3)     xc  xd1 xd2 xd3    =     bc  bd1 bd2 bd3     или в матрично-блочном виде система приводится к виду     K11 K12 K13 K14 K21 K22 K23 K24 K31 K32 K33 K34 K41 K42 K43 K44        x1 x2 x3 x4    =     b1 b2 b3 b4    .  Размерность полученной системы будет совпадать с размером исходной. Разложение системы на подпространства меньшей размерности может быть продолжено, как и в одномерном случае.  188    С.П. Копысов, Ю.A. Сагдеева  4 Численные примеры  В качестве тестового примера рассматривалась следующая задача теории упругости:  Lu = f, (4.1)  где L – дифференциальный оператор, описывающий поведение неоднородного линейно-упругого тела, u = (u1, u2) – вектор перемещения:  −divE(x)∇u(x) = f(x), x ∈ Ω, (4.2) u(x) = U(x), x ∈ Γu, (4.3)  n(x) · E(x)∇u(x) = t(x), x ∈ Γt. (4.4) На двумерную прямоугольную пластинку размерами 0.1 × 0.1м по краю действует растягивающая сила F=69000. Симметрично в центре пластинки находится включение квадратной формы. Матрица композита имеет постоянные ν = 0.33, µ = 178947.36, а включение – ν = 0.2, µ = 1178750. Схема осреднения представлена на рис. 1. За один шаг осреднения общее число узлов сокращается в 4 раза. На рис. 2, 3 и 4 представлены результаты осреднения. На первом рисунке показано поле перемещений без использования осреднения. На втором и третьем рисунках – результаты, полученные после трех и четырех шагов осреднения соответственно. Как видно, картина, близкая к точной, наблюдается после трех шагов. После четырех шагов осреднения сетка становится грубой и начинает оказывать сильное влияние на решение.  5 Заключение  В работе представлены некоторые положения теории вейвлетов. Применение вейвлетов дает выгоду при получении осредненного решения СЛАУ, получаемых в МКЭ. Такое осредненное решение может быть использовано затем для получения эффективных свойств композитов.  Следующим этапом работы является разработка программного обеспечения для трехмерных композитов и переход от областей правильных форм к произвольным областям.  189    Многомасштабный анализ на основе МКЭ и вейвлет-преобразования  x x  x x  Ïåðåìåùåíèå  0.01276  0.011361  0.0099624  0.0085634  0.0071644  0.0057655  0.0043665  0.0029675  0.0015685  0.00016966  Рис. 1: Схема двумерного осреднения. Исходная сетка и сетка после одного шага осреднения  Рис. 2: Решение на мелкой сетке 64× 64  Ïåðåìåùåíèå  0.011604 0.010403  0.009203  0.0080028  0.0068025  0.0056023  0.004402  0.0032018  0.0020015  0.00080137  Ïåðåìåùåíèå  0.010295 0.0093252  0.0083552  0.0073853  0.0064153  0.0054454  0.0044754  0.0035055  0.0025355  0.0015656  Рис. 3: Решение после 3 шагов – сетка 8× 8  Рис. 4: Решение после 4 шагов – сетка 4× 4  190   