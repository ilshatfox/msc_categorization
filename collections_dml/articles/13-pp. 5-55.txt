  НЕЯВНЫЕ РАЗНОСТНЫЕ СХЕМЫ ДЛЯ НЕСТАЦИОНАРНОГО ДВИЖЕНИЯ  ВЯЗКОГО ГАЗА 1  А.В. Попов Московский государственный университет  им. М.В. Ломоносова  Проведены построение и исследование точности неявных конечно-разностных схем для нестационарного движения вязкого газа. Рассмотрены случаи одной и двух пространственных переменных. В двумерном случае построенная разностная схема является экономичной, что достигается за счет использования на верхнем временном слое расщепляющихся операторов. Исследование точности проводится на примере простейших модельных задач: уравнения переноса с переменным коэффициентом и нелинейного уравнения Бюргерса, а затем полученные результаты обобщаются. Исследовано влияние ошибок округления арифметических операций на точность разностного решения.  1 Введение  Построение и анализ разностных схем (р. с.) для систем уравнений газовой динамики представляют значительный практический и теоретический интерес [3], [24], [26], [27], [28], [29]. Однако вопросы корректности р. с. и оценки их погрешности в исходной нелинейной постановке для многомерных задач пока трудно поддаются решению.  Рассмотрим систему уравнений, описывающую нестационарное движение вязкого баротропного газа:  ∂ρ  ∂t + div (ρu) = 0,  ρ  [ ∂u  ∂t + (u,∇)u  ] +∇p = Lu+ ρf ,  p = p(ρ),  (1.1)  1Работа выполнена при финансовой поддержке РФФИ, проект N 99-01 01146  5    Неявные разностные схемы. . .  где L есть линейный эллиптический оператор:  Lu ≡ div (µ∇u) + 1 3 ∇(µdiv u).  Выше через µ обозначен коэффициент вязкости газа, который будем считать для простоты изложения известной положительной константой. Неизвестные функции (плотность ρ и вектор скорости u) являются функциями переменных Эйлера  (t,x) ∈ Q = [0, T ]× Ω.  В уравнения входят еще две известные функции: давление газа p, зависящее от плотности, и вектор внешних сил f , являющийся функцией переменных Эйлера. Заметим, что условие баротропности газа наложено для сокращения выкладок. Все излагаемые далее методы без существенных усложнений переносятся на случай теплопроводного газа.  Дополним систему (1.1) начальными и граничными условиями:  (ρ,u)|t=0 = (ρ0,u0), x ∈ Ω, u(t,x) = 0, (t,x) ∈ [0, T ]× ∂Ω.  (1.2)  В настоящее время теоремы о существовании и единственности решения задачи (1.1) - (1.2) в целом по времени доказаны только в случае одной пространственной переменной. Это объясняется тем, что в одномерном случае система уравнений (1.1) при переходе к лагранжевым массовым переменным записывается в удобном для исследования относительно компактном виде. В многомерном же случае переход к этим переменным не дает таких преимуществ, и до сих пор известны лишь локальные по времени теоремы разрешимости. Обзор результатов по качественной теории системы (1.1) можно прочитать в [4].  В разностном случае, так же как и в дифференциальном, серьезные продвижения в теории получены в случае одной пространственной переменной, где построены и исследованы в целом по времени р. с. для системы (1.1), записанной в лагранжевых массовых переменных [2]. В многомерном случае следует выделить работу [14], в которой построена оригинальная слабо устой 6    А.В. Попов  чивая р. с. Среди многочисленных работ, посвященных моделированию течений вязкого газа, отметим работу [13]. В ней анализируется связь между решениями, получаемыми с помощью кинетически-согласованных разностных схем, и решением уравнений Навье-Стокса для течений вязкого сжимаемого газа.  В данной работе построены неявные двухслойные р. с. для задачи (1.1) - (1.2) в случае одной и двух пространственных переменных [20], [21]. Для расчета решения на n-м временном шаге приходится решать несколько систем линейных алгебраических уравнений, решение которых существует и единственно до тех пор, пока значения сеточной функции H, приближающей функцию плотности ρ, остаются положительными. Возможность выполнения этого условия при выборе шагов сетки достаточно малыми следует из положительности значений функции ρ и доказываемой оценки для разности между функциейH и проекцией на сетку функции ρ.  Построенные р. с. экономичны. Под экономичностью имеется в виду следующее. Во-первых, р. с. должна быть безусловно устойчивой. Во-вторых, для расчета решения требуется совершить количество арифметических операций, прямо пропорциональное числу неизвестных. В двумерном случае последнее условие обеспечивается использованием на верхнем временном слое расщепляющихся операторов.  Для рассматриваемых р. с. методом энергетических неравенств доказаны оценки погрешности численного интегрирования. В частности, из этих оценок следует сходимость р. с. в послойных нормах W 12,h. Примененный способ исследования р. с. существенным образом опирается на предположение о существовании и единственности гладкого точного решения задачи (1.1) - (1.2). Такой способ исследования точности разностных методов изложен в монографии [8] на примере ОДУ. Основная идея доказательства состоит в том, что разность между разностным решением и проекцией на сетку точного решения дифференциальной задачи не становится больше некоторого критического значения. Для этого нужно оценивать эту разность в достаточно сильной норме, чтобы с ее помощью можно было оценить норму ошибки в пространстве Ch. На этом этапе могут накладываться условия на шаги τ и h. В одномерном случае связи между τ и h не возникает, а в  7    Неявные разностные схемы. . .  двумерном случае появляется условие  τ ≤ C| lnh|. (1.3) Поскольку ограничение на шаг τ в зависимости от шага h, задаваемое условием (1.3), очень слабое, то р. с. в двумерном случае также можно считать экономичной.  При выводе оценок погрешности численного интегрирования будем предполагать выполнение следующих условий для задачи (1.1) - (1.2):  (A) существует единственное классическое решение; (B) (ρ, u) ∈ C2,4(Q), grad(ρ) ∈ C2,3(Q), grad(u) ∈ C1,3(Q),  где Cq,p(Q) – класс функций, имеющих производные порядка q по временной переменной t и порядка p по пространственным переменным x в области Q;  (C) γM ≥ ρ(t, x) ≥ γm > 0 при (t,x) ∈ Q; (D) ‖p‖C2[γm/2;γM+γm/2] ≤ pM и ‖f‖C(Q) ≤ fM . Исследование нелинейных р. с. в окрестности известного ре шения использовалась многими авторами (см., например, [1], [15], [16], [17]). В этих работах изучены р. с., ориентированные на конкретные задачи и типы задач математической физики. В работе [6] рассматривались двухслойные нелинейные р. с. общего вида, а в работе [5] получены общие теоремы о сходимости нелинейных р. с., использующие представление схемы в виде одного операторного уравнения и теоремы существования решения в окрестности известного элемента.  Для решения возникающих алгебраических систем в процессе счета по предлагаемым р. с. предлагается использовать метод прогонки. Проведено исследование влияния ошибок округления на точность разностного решения при совершении арифметических операций [23]. В этом исследовании используются идеи статьи [7].  Построения и исследования р. с. сначала проводятся на примере простейших модельных задач: уравнения переноса с переменным коэффициентом и уравнения Бюргерса, а затем обобщаются на случай задачи (1.1) - (1.2).  Работоспособность построенных р. c. проверялась на двумерной задаче конвекции, описанной в [19], [18], [9], и задаче обтекания прямоугольного препятствия.  8    А.В. Попов  2 Основные обозначения и вспомогательные утверждения  В разностных методах, используемых для решения задач в ограниченной области Q = [0, T ] × Ω, используется множество точек Qτh, называемое сеткой. Точки, из которых состоит сетка, называются узлами.  Простейшая сетка в случае одной пространственной переменной, когда Ω = [0, X], строится следующим образом. Строятся две одномерные сетки ωτ = {nτ | n = 0, . . . , N}, где Nτ = T, и ω̄h = {mh | m = 0, . . . ,M}, где Mh = X. В результате в области Q можно ввести сетку Qτh = ωτ × ω̄h. Внутренние узлы сетки ω̄h будем обозначать ωh. К ним относятся узлы с номерами m = 1, . . . ,M − 1. Узлы с номерами m = 0 и m = M будем называть граничными.  Значение функции g, определенной на сетке Qτh, в узле (n,m) будем обозначать через gnm. Если индексы будут опущены, то это означает, что они равны n и m. Для сокращения записи значений функции g в узлах, соседних с узлом (n,m), используются следующие обозначения:  gnm±1 = g ±1, gn+1m = ĝ.  В случае, если вычисления по разностной схеме организованы по временным слоям, т. е. на каждом шаге ищутся значения разностного решения на слое (n + 1) по уже известным значениям этого решения на слоях с меньшими номерами, то (n+ 1)-й слой называют верхним, а слои с меньшими номерами, явно используемые в расчетных формулах, нижними.  Для разностных операторов применяются следующие обозначения, принятые в [25]:  gt = gn+1m − gnm  τ , gx =  gnm+1 − gnm h  ,  g◦ x = gnm+1 − gnm−1  2h , gx̄ =  gnm − gnm−1 h  .  Введем скалярные произведения сеточных функций, задан 9    Неявные разностные схемы. . .  ных на сетке ω̄h:  (v, u) =  M−1∑  m=1  hvmum, (u, v[=  M−2∑  m=1  hvmum,  [u, v) = (u, v) + hu0v0, [u, v] = (u, v) + h/2(u0v0 + uMvM ).  Для сравнения двух сеточных функций требуется задать способ оценки их разности, иными словами, определить норму сеточной функции. Это можно сделать многими способами. Приведем несколько из них, которые будут использоваться ниже:  ‖v‖Ch = M  max m=0 |vm|, ‖v‖ =  √ (v, v), |[v‖ =  √ [v, v),  |[v]| = √  [v, v], ‖v‖12 = √ |[v]|2 + |v|21,  где через |v|1 обозначена полунорма, задаваемая следующим образом:  |v|1 = |[vx‖. Сформулируем леммы, позволяющие оценить одну норму се точной функции, заданной на сетке ω̄h, через другую ее норму.  Лемма 2.1. Для любой сеточной функции v, обращающейся в нуль в граничных узлах, справедливы неравенства:  ‖v‖Ch ≤ √ X  2 |[vx‖, (2.1)  ‖v‖2 ≤ X 2  8 |[vx‖2. (2.2)  Лемма 2.2. Для любой сеточной функции v верно  ‖v‖Ch ≤ 1√ h |[v]|, (2.3)  ‖v‖2Ch ≤ ( 1  ε +  1  X  ) |[v]|2 + ε|v|21, (2.4)  где ε – любое положительное число.  10    А.В. Попов  Доказательства этих неравенств можно найти в [25]. При выводе оценок будем использовать известные сеточные  неравенства |[v, u]| ≤ |[v]| · |[u]|, (2.5)  |[v, wu]| ≤ ‖w‖Ch · |[v]| · |[u]|. (2.6) Ниже будет часто использоваться следующий вариант раз ностной леммы Гронуолла.  Лемма 2.3. Пусть неотрицательные величины Y0, Y1, . . . , YN удовлетворяют неравенству  Yn ≤ Yn−1 + Cτ (Yn−1 + Yn) + τbn, n = 1, . . . , N.  Кроме того, известно, что bn ≥ 0 для n = 1, . . . , N , τ < τ0, τ0C = 1/2, τN = T . Тогда верна оценка  max n=1,...,N  √ Yn ≤ eCT  √√√√Y0 + 2τ N∑  n=1  bn.  Ввиду важности этой леммы в дальнейших рассуждениях приведем ее  Доказательство. Перепишем неравенство из условия леммы в виде  (1− τC)Yn ≤ (1 + τC)Yn−1 + τbn, n = 1, . . . , N.  В силу условия леммы оно равносильно неравенству  Yn ≤ 1 + τC  1− τC Yn−1 + τ  1− τC bn, n = 1, . . . , N.  Из последнего неравенства заключаем, что  Yn ≤ ( 1 + τC  1− τC  )n Y0+  τ  1− τC  n∑  k=1  ( 1 + τC  1− τC  )n−k bk, n = 1, . . . , N.  Отсюда, учитывая, что  (1 + τC)n ≤ (1 + τC)CT/τC ≤ eCT  11    Неявные разностные схемы. . .  и  (1− τC)n ≥ (1− τC)−CT/−(τC) ≥ e−CT ,  получаем  Yn ≤ e2CT ( Y0 + 2τ  N∑  n=1  bn  ) ,  откуда следует утверждение леммы. 2  Условимся ниже в неравенствах обозначать через C, Cα, Kα, α = 1, 2, . . . , положительные величины, которые зависят от параметров дифференциальной задачи (размеров области, свойств коэффициентов и точного решения) и не зависят от шагов сетки и номера временного слоя.  В дальнейших выкладках часто будет использоваться ε-неравенство ab ≤ εa2 + b2/4ε. Буква ε будет использоваться только в случае применения этого неравенства. Ниже не будет указываться зависимость величин C и Cα, α = 1, 2, . . . , от ε. Те константы, для которых важно подчеркнуть независимость их выбора от ε, будут обозначаться через Kα, α = 1, 2, . . . .  В случае двух пространственных переменных мы будем рассматривать область Ω прямоугольной формы:  Ω = [0; X1]× [0; X2].  Такое условие на форму Ω приходится накладывать из-за способа построения разностных аппроксимаций, в основу которых положена идея расщепления оператора на верхнем временном слое [12]. Условие прямоугольной формы области может быть заменено на условие, что Ω состоит из конечного числа прямоугольников, стороны которых параллельны осям координат.  Введем в области Ω сетку  ω̄h = {(m1h1, m2h2) | m1 = 0, 1, . . . ,M1, m2 = 0, 1, . . . ,M2},  Xk =Mkhk, k = 1, 2.  Для различных подмножеств множества узлов этой сетки, операций разностного дифференцирования мы будем использовать  12    А.В. Попов  обозначения, принятые в [25]. Напомним, что в [25] значения функции в соседних узлах с узлом (m1,m2) обозначаются следующим образом:  gm1±1,m2 = g ±11 , gm1,m2±1 = g  ±12 .  Среднее значение сеточной функции в двух соседних узлах будем обозначать  usk = (u (+1k)+u)/2, u ◦  sk = (u(+1k)+u(−1k))/2, us̄k = (u  (−1k)+u)/2.  Ниже используются следующие полунормы и нормы сеточных функций  |[v]|2 = M1∑  m1=0  M2∑  m2=0  h1h2v 2,  |v|12 = M1−1∑  m1=0  M2∑  m2=0  h1h2v 2 x1  +  M1∑  m1=0  M2−1∑  m2=0  h1h2v 2 x2 ,  |v|22 = M1−1∑  m1=1  M2∑  m2=0  h1h2v 2 x1x̄1  +  +  M1−1∑  m1=0  M2−1∑  m2=0  h1h2v 2 x1x2  +  M1∑  m1=0  M2−1∑  m2=1  h1h2v 2 x2x̄2  ,  ‖v‖12 = |[v]|2 + |v|12, ‖v‖Ch = M1,M2 max  m1,m2=0 |v|.  При выводе оценок используются неравенства (2.5), (2.6) и следующая  Лемма 2.4. Для любой функции v, заданной на сетке ω̄h, верно неравенство  ‖v‖Ch ≤ K |ln |h|| 0,5 ‖v‖1.  Доказательство. Для сеточной функции u, такой, что u |γ= 0, справедливо неравенство [11]  ‖v‖Ch ≤ K0 |ln |h|| 0,5 |v|1.  13    Неявные разностные схемы. . .  С другой стороны, произвольную сеточную функцию v, заданную на прямоугольнике Π, можно продолжить на больший прямоугольник Π̃, симметрично отображая ее относительно границы. Домножив продолженную функцию на сеточный аналог функции срезки, получим функцию ṽ, заданную на Π̃ и обладающую свойствами:  1) |ṽ|1,Π̃ ≤ C‖v‖1,Π, где величина C зависит от размеров Π и Π̃ и не зависит от функции v;  2) v |γ(Π̃)= 0. Отсюда следует утверждение леммы.  3 Уравнение переноса с переменным коэффициентом  Рассмотрим в качестве простейшего модельного уравнения для системы (1.1) уравнение переноса с переменным коэффициентом:  ∂u  ∂t + ∂au  ∂x = 0, (3.1)  где функция u = u(t, x) подлежит определению, а функция a = a(t, x) считается известной. Ниже будет рассматриваться случай, когда функция a гладкая в области Q = [0, T ] × [0, X] и удовлетворяет следующим граничным условиям:  a(t, 0) = a(t,X) = 0, t ∈ [0, T ].  Поставим задачу о нахождении решения этого уравнения в области Q, удовлетворяющего начальному условию  u|t=0 = u0(x), x ∈ [0, X]. (3.2)  У модельной задачи (3.1) - (3.2) мы будем предполагать существование и единственность гладкого решения, следовательно, можно записать уравнение (3.1) в виде  ∂u  ∂t +  1  2  ∂(au)  ∂x + a  2  ∂u  ∂x + u  2  ∂a  ∂x = 0. (3.3)  14    А.В. Попов  Для поиска численного решения задачи (3.1) - (3.2) предлагается использовать р. с.  vt,0 + 1  2 (av̂)x,0 +  1  2 v0ax,0 − Φ0(a, v) = 0,  vt + 1  2 (av̂)0  x + a  2 v̂0 x + v  2 a0 x = 0, m = 1, . . . ,M − 1, (3.4)  vt,M + 1  2 (av̂)x̄,M +  vM 2 ax̄,M +ΦM (a, v) = 0,  где  Φ0(a, v) = h  2  [ (av)xx̄,1 −  1  2 (av)xx̄,2 + v0axx̄,1 −  1  2 v0axx̄,2  ] ,  ΦM (a, v) = h  2  [ (av)xx̄,M−1 −  1  2 (av)xx̄,M−2 +  +v0axx̄,M−1 − 1  2 v0axx̄,M−2  ] .  В качестве значений разностного решения на нулевом слое берется проекция на сетку ω̄h функции u0:  v0m = u0(mh), m = 0, . . . ,M. (3.5)  Заметим, что разностная аппроксимация записана непосредственно для уравнения (3.3). Слагаемые Φ0 и ΦM порядка h, использующие значения функций a и v с нижнего слоя в уравнениях с номерами m = 0 и m =M , были добавлены с целью повышения порядка аппроксимации в граничных узлах сетки, поскольку в этих уравнениях используются односторонние разностные производные по пространственной переменной.  Обозначим через ϕ невязку, появляющуюся в результате подстановки проекции точного решения задачи (3.1) - (3.2) в р. с. (3.4) - (3.5):  ϕ0 = ut,0 − 1  2 (aû)x,0 −  1  2 u0ax,0 +Φ0(a, u),  ϕ = ut − 1  2 (aû)0  x − a  2 û0 x − u  2 a0 x , m = 1, . . . ,M − 1,  15    Неявные разностные схемы. . .  ϕM = ut,M − 1  2 (aû)x̄,M −  uM 2 ax̄,M − ΦM (a, u).  Величина |[ϕ]| имеет порядок τ+h2 при условии, что функции a и u достаточно гладкие. Увеличив требование на гладкость, можно получить, что |ϕ|1 тоже будет порядка τ + h2.  Теорема 3.1. Решение р. с. (3.4) - (3.5) существует и единственно.  Доказательство. Решение р. с. (3.4) - (3.5) на верхнем временном слое является решением системы линейных уравнений  Av̂ = b(v).  Матрица A – трехдиагональная и представима в виде суммы двух матриц  A = E +A1(a), (3.6)  где E – единичная матрица (она соответствует члену vt), а A1(a) – кососимметричная матрица, элементы которой определяются функцией a.  Поскольку для любого вектора v (v 6= 0)  [Av, v] = [v, v] + [A1v, v] = [v, v] > 0,  то матрица A – невырождена и решение на (n + 1)-м временном слое всегда однозначно определяется по n-му слою. Следовательно, решение р. с. (3.4) - (3.5) существует и единственно при любой функции u0. 2  Обозначим через w ошибку численного интегрирования по р. с. (3.4) - (3.5):  w = v − u, где под сеточной функцией u понимается проекция на сетку точного решения задачи (3.1) - (3.2). Функция w является решением задачи  wt,0 + 1  2 (aŵ)x,0 +  1  2 w0ax,0 − Φ0(a,w) = ϕ0,  wt + 1  2 (aŵ)0  x + a  2 ŵ0 x + w  2 a0 x = ϕ, m = 1, . . . ,M − 1, (3.7)  16    А.В. Попов  wt,M + 1  2 (aŵ)x̄,M +  wM 2 ax̄,M +ΦM (a,w) = ϕM ,  w0m = 0, m = 0, . . . ,M.  Теорема 3.2. Для ошибки численного интегрирования по р. с. (3.4) - (3.5) справедливы следующие оценки:  max n=1,...,N  |[wn]|2 ≤ C ( |[w0]|2 + τ  N−1∑  n=0  |[ϕn]|2 ) , (3.8)  max n=1,...,N  ‖wn‖21 ≤ C ( ‖w0‖21 + τ  N−1∑  n=0  ‖ϕn‖21  ) . (3.9)  Доказательство. Умножим уравнения (3.7) с номерами m = 0 и m = M на hŵm/2, а остальные – на hŵm и сложим получившиеся равенства:  [ŵ, wt] + [ŵ, A1(a)ŵ] + (ŵ, wa◦x) + h  4 (ŵ0w0ax,0 + ŵMwMax̄,M )−  −hŵ0 2  Φ0(a,w) + hŵM 2  ΦM (a,w) = [ŵ, ϕ], (3.10)  где A1(a) – матрица из равенства (3.6). Оценим нужным нам образом каждое слагаемое в равенстве (3.10), используя при этом гладкость функции a = a(t, x) и неравенства (2.5) и (2.6). Получим  [ŵ, wt] ≥ |[ŵ]|2 − |[w]|2  2τ , (3.11)  (ŵ, A1(a)ŵ) = 0 (3.12)  в силу кососимметричности матрицы A1. Далее,  ∣∣∣(ŵ, wa◦ x ) +  h  4 (ŵ0w0ax,0 + ŵMwMax̄,M )−  hŵ0 2  Φ0(a,w)+  + hŵM 2  ΦM (a,w) ∣∣∣ ≤ C  ( |[ŵ]|2 + |[w]|2  ) ,  (3.13)  так как a0 = aM = 0. Кроме того  ∣∣∣[ŵ, ϕ] ∣∣∣ ≤  1  2  ( |[ŵ]|2 + |[ϕ]|2  ) . (3.14)  17    Неявные разностные схемы. . .  Используя оценки (3.11) - (3.14), из равенства (3.10) выводим неравенство  |[ŵ]|2 − |[w]|2 ≤ τC ( |[w]|2 + |[ŵ]|2  ) + τ |[ϕ]|2. (3.15)  Из этого неравенства при помощи разностной леммы Гронуолла получаем оценку (3.8).  Для вывода неравенства (3.9) выпишем ещеM равенств, полученных из уравнений (3.7) вычитанием из уравнения с номером m уравнения с номером m−1 и делением на шаг h для m = 1, . . . ,M :  wxt,0 + α0(a,w) = 0,  wxt + 1  2 (aŵ)0  xx + (a 2 ŵ0 x  ) x + (w 2 a0 x  ) x = 0, m = 1, . . . ,M − 2,  wxt,M−1 + αM−1(a,w) = 0. (3.16)  Выше через функции α0(a,w) и αM−1(a,w) были обозначены выражения  α0(a,w) = (1 2 (aŵ)0  x,1 + a  2 ŵ0 x,1  + w  2 a0 x,1 −  −1 2 (aŵ)x,0 −  1  2 w0ax,0Φ0(a,w)  ) /h,  (3.17)  αM−1(a,w) = (1 2 (aŵ)x̄,M +  wM 2 ax̄,M +ΦM (a,w)  −1 2 (aŵ)0  x,M−1 − a  2 ŵ0 x,M−1  − w 2 a0 x,M−1  ) /h.  (3.18)  Домножим теперь скалярно уравнения (3.16) на ŵx:  [ŵx, wxt) + hŵx,0α0(a,w)+  + (ŵx, 1  2 (aŵ)0  xx [+(ŵx,  (a 2 ŵ0 x  ) x [+  + (ŵx, (w 2 a0 x  ) x [+hŵx,M−1αM−1(a,w) = [ŵx, ϕx).  (3.19)  Оценим слагаемые в равенстве (3.19). Первое слагаемое из левой его части оценивается снизу следующим образом:  [ŵx, wtx) ≥ |ŵ|21 − |w|21  2τ . (3.20)  18    А.В. Попов  При оценке второго и последнего слагаемых в левой части равенства (3.19) используем равенство нулю функции a в граничных точках. В результате получим ∣∣∣hŵx,0α0(a,w) + hŵx,M−1αM−1(a,w)  ∣∣∣ ≤ C ( |ŵ|21 + |[w]|21  ) . (3.21)  Оценка третьего и четвертого слагаемых в левой части равенства (3.19) достаточно громоздка. Поэтому приведем преобразования и оценку для интеграла  X∫  0  ∂u  ∂x  ∂2au  ∂x2 dx,  которые аналогичны тем, что нужно провести в разностном случае, но гораздо более компактны. Имеем  ∣∣∣∣∣  X∫  0  ∂u  ∂x  ∂2au  ∂x2 dx  ∣∣∣∣∣ =  =  ∣∣∣∣∣  X∫  0  u ∂u  ∂x  ∂2a  ∂x2 dx+ 2  X∫  0  ( ∂u  ∂x  )2 ∂a  ∂x dx+  X∫  0  a ∂u  ∂x  ∂2u  ∂x2 dx  ∣∣∣∣∣ =  =  ∣∣∣∣∣  X∫  0  u ∂u  ∂x  ∂2a  ∂x2 dx+ 2  X∫  0  ( ∂u  ∂x  )2 ∂a  ∂x dx+  1  2  X∫  0  a ∂  ∂x  (( ∂u  ∂x  )2) dx  ∣∣∣∣∣ =  =  ∣∣∣∣∣  X∫  0  u ∂u  ∂x  ∂2a  ∂x2 dx+  3  2  X∫  0  ( ∂u  ∂x  )2 ∂a  ∂x dx  ∣∣∣∣∣ ≤ C‖u‖ 2 W 12 . (3.22)  Проводя в разностном случае такие же преобразования, получаем ∣∣∣∣(ŵx,  1  2 (aŵ)0  xx [+(ŵx,  (a 2 ŵ0 x  ) x [  ∣∣∣∣ ≤ C‖ŵ‖ 2 1. (3.23)  Для оставшихся слагаемых справедливы неравенства ∣∣∣(ŵx,  (w 2 a0 x  ) x [ ∣∣∣ ≤ C  ( |ŵ|21 + ‖w‖21  ) , (3.24)  19    Неявные разностные схемы. . .  |[ŵx, ϕx)| ≤ 1  2  ( |ŵ|21 + |ϕ|21  ) . (3.25)  Используя оценки (3.20), (3.21), (3.23) - (3.25), из равенства (3.19) получаем неравенство  |ŵ|21 − |w|21 ≤ τC ( ‖w‖21 + |ŵ|21  ) + τ |ϕ|21.  Складывая это неравенство с неравенством (3.15), имеем  ‖ŵ‖21 − ‖w‖21 ≤ τC ( ‖w‖21 + ‖ŵ‖21  ) + τ‖ϕ‖21. (3.26)  Из этого неравенства при помощи разностной леммы Гронуолла получаем оценку (3.9). 2  Следствие 3.1. При условии, что функции u и a таковы, что ‖ϕ‖ порядка τ+h2, из оценки (3.8) следует сходимость разностной схемы с порядком τ + h2 в норме пространства L2,h. Если же к этому условию добавить требование, чтобы и |ϕ|1 тоже была порядка τ + h2, то из оценки (3.9) следует сходимость разностной схемы с порядком τ + h2 в норме пространства W 12,h.  Замечание 3.1. Оценка (3.9) получена в норме пространства W 12,h, что позволяет при помощи неравенства (2.4) оценить погрешность численного интегрирования в норме пространства Ch без условия на шаги сетки. Однако платой за это является требование более высокой гладкости функций u и a.  4 Уравнение Бюргерса  В качестве простейшего нелинейного модельного уравнения для системы (1.1) рассмотрим уравнение Бюргерса  ∂u  ∂t + u  ∂u  ∂x = µ  ∂2u  ∂x2 , (4.1)  где функция u = u(t, x) подлежит определению, а параметр µ считается известной положительной константой. Поставим задачу о нахождении решения этого уравнения в областиQ = [0, T ]×[0, X],  20    А.В. Попов  удовлетворяющего следующим начальному и граничным условиям:  u|t=0 = u0, x ∈ [0, X], u(t, 0) = u  γ 0 , u(t,X) = u  γ X , t ∈ [0, T ].  (4.2)  Мы будем предполагать существование и единственность гладкого решения, следовательно, можно записать уравнение (4.1) в следующем виде:  ∂u  ∂t + u  3  ∂u  ∂x +  1  3  ∂u2  ∂x = µ  ∂2u  ∂x2 . (4.3)  Для поиска численного решения задачи (4.1) - (4.2) предлагается использовать р. с.  v̂0 = u γ 0((n+ 1)τ, 0),  vt + v  3 v̂0 x +  1  3 (vv̂)0  x = µv̂xx̄, m = 1, . . . ,M − 1,  v̂M = u γ X((n+ 1)τ,X).  (4.4)  В качестве значений разностного решения на нулевом слое берется проекция на сетку ω̄h функции u0:  v0m = u0(mh), m = 0, . . . ,M. (4.5)  Теорема 4.1. Решение р. с. (4.4) - (4.5) существует и единственно.  Доказательство. Решение р. с. (4.4) - (4.5) на верхнем временном слое является решением системы линейных уравнений  Av̂ = b(v).  Матрица A – трехдиагональная и представима в виде суммы трех матриц  A = E +A1(v) +A2(µ), (4.6)  где E – единичная матрица (она соответствует члену vt), A1(v) – кососимметричная матрица, элементы которой определяются функцией v с нижнего слоя, и A2(µ) – симметричная положительно определенная матрица, задающая аппроксимацию второй разностной производной функции v̂ по переменной x.  21    Неявные разностные схемы. . .  Поскольку для любого вектора v (v 6= 0)  (Av, v) = (v, v) + (A1v, v) + (A2v, v) > (v, v) > 0,  то матрица A невырождена, и решение на (n + 1)-м временном слое всегда однозначно определяется по n-му слою. Следовательно, решение р. с. (4.4) - (4.5) существует и единственно при любой функции u0. 2  Обозначим через ϕ невязку, появляющуюся в результате подстановки проекции точного решения задачи (4.1) - (4.2) в р. с. (4.4) - (4.5):  ϕ = µûxx̄ − ut − u  3 û0 x − 1  3 (uû)0  x , m = 1, . . . ,M − 1.  При условии, что u ∈ C2,4(Q), ‖ϕ‖ является величиной порядка τ + h2.  Обозначим через w ошибку численного интегрирования по р. с. (4.4) - (4.5):  w = v − u,  где под сеточной функцией u понимается проекция на сетку точного решения задачи (4.1) - (4.2). Функция w является решением следующей задачи:  ŵ0 = ŵM = 0,  wt + v  3 ŵ0 x +  1  3 (vŵ)0  x + w  3 û0 x +  1  3 (wû)0  x = µŵxx̄ + ϕm,  m = 1, . . . ,M − 1, w0m = 0.  (4.7)  Теорема 4.2. Для ошибки численного интегрирования по р. с. (4.4) - (4.5) справедлива оценка  max n=1,...,N  ‖wn‖2 + 2τµ N∑  n=1  |[wx‖2 ≤ C0(τ + h2)2 (4.8)  при условии, что ‖u‖C2,4(Q) ≤ K.  22    А.В. Попов  Доказательство. Умножим скалярно уравнения (4.7) на ŵ:  (ŵ, wt) + (ŵ, v  3 ŵ0 x ) + (ŵ,  1  3 (vŵ)0  x ) + (ŵ,  w  3 û0 x )+  +(ŵ, 1  3 (wû)0  x ) = (ŵ, µŵxx̄) + (ŵ, ϕ).  (4.9)  Оценим нужным нам образом каждое слагаемое в равенстве (4.9), использовав при этом гладкость функции u = u(t, x) и неравенства (2.5) и (2.6). Получим  (ŵ, wt) ≥ ‖ŵ‖2 − ‖w‖2  2τ , (4.10)  (ŵ, v  3 ŵ0 x ) + (ŵ,  1  3 (vŵ)0  x ) = 0, (4.11)  поскольку матрица A1(v) из равенства (4.6) является кососимметричной. Далее  ∣∣∣(ŵ, w  3 û0 x ) + (ŵ,  1  3 (wû)0  x ) ∣∣∣ ≤ C  ( ‖ŵ‖2 + ‖w‖2  ) + µ|[wx‖2. (4.12)  При выводе неравенства (4.12) использовались гладкость функции u и ε-неравенство. Кроме того,  (ŵ, µŵxx̄) = −µ|[ŵx‖2, (4.13) ∣∣∣(ŵ, ϕ)  ∣∣∣ ≤ 1/2 ( ‖ŵ‖2 + ‖ϕ‖2  ) . (4.14)  Используя оценки (4.10)-(4.14), из равенства (4.9) выводим неравенство  (‖ŵ‖2 + 2τµ|[ŵx‖2)− (‖w‖2 + 2τµ|[wx‖2) ≤ ≤ τC  ( ‖w‖2 + ‖ŵ‖2  ) + τ‖ϕ‖2.  (4.15)  Из этого неравенства при помощи разностной леммы Гронуолла получаем утверждение теоремы. 2  При практическом использовании р. с. бывает нужно знать оценку погрешности в норме Ch. Из условия теоремы 4.2 такую оценку можно получить, используя неравенство (2.3). Для того,  23    Неявные разностные схемы. . .  чтобы гарантировать, что ‖w‖Ch ≤ δ, требуется ввести ограничения на шаги τ и h, определяемые необходимостью выполнения условия  τ + h2√ h ≤ δ√  C0 .  В частности, это означает необходимость выполнения условия на шаги сетки вида  τ ≤ C1 √ h.  Его можно снять, оценив ошибку в более сильной норме. Это сделано в следующей теореме.  Теорема 4.3. Для ошибки численного интегрирования по р. с. (4.4) - (4.5) справедлива оценка  max n=1,...,N  ‖wn‖21 + τµ N∑  n=1  ‖wxx̄‖2 ≤ C0(τ + h2)2 (4.16)  при условиях: 1) ‖u‖C2,4(Q) ≤ K; 2) τ ≤ τmax, h ≤ hmax.  Доказательство. Предположим, что для некоторого 0 ≤ J ≤ N − 1 при выполненном условии теоремы справедлива оценка  max n=1,...,J  ‖wn‖21 + τµ J∑  n=1  ‖wxx̄‖2 ≤ C0(τ + h2)2. (4.17)  Докажем, что существуют такие величины τmax, hmax и C0, что неравенство (4.17) будет верно также и для J + 1.  Выберем величину δ произвольной положительной константой. Будем считать, что τmax и hmax выбраны так, что выполнено следующее неравенство:  τ + h2 ≤ 2δ√ C0X  . (4.18)  Тогда из неравенств (4.17) и (4.18) следует, что  ‖wn‖Ch ≤ δ, 0 ≤ n ≤ J. (4.19)  24    А.В. Попов  Умножив скалярно уравнения (4.7) на ŵ, как и при доказательстве теоремы 4.2, получим неравенство (4.15).  Умножим теперь скалярно уравнения (4.7) на ŵxx̄:  (ŵxx̄, wt) + (ŵxx̄, v  3 ŵ0 x ) + (ŵxx̄,  1  3 (vŵ)0  x ) + (ŵxx̄,  w  3 û0 x )+  +(ŵxx̄, 1  3 (wû)0  x ) = (ŵxx̄, µŵxx̄) + (ŵxx̄, ϕ).  (4.20)  Оценим каждое слагаемое в равенстве (4.20), используя гладкость функции u и неравенства (2.5) и (2.6), а также оценку (4.19). Имеем  −(ŵxx̄, wt) = [ŵx, wtx) ≥ |[ŵx‖2 − |[wx‖2  2τ , (4.21)  ∣∣∣(ŵxx̄, v  3 ŵ0 x ) ∣∣∣ ≤  1  3 ‖ŵxx̄‖ · ‖v‖Ch · |[ŵx‖ ≤ ε‖ŵxx̄‖2 +C|[ŵx‖2. (4.22)  Аналогично, преобразуя сначала выражения при помощи формул разностного дифференцирования по частям, получаем  ∣∣∣∣(ŵxx̄, 1  3 (vŵ)0  x ) + (ŵxx̄,  w  3 û0 x ) + (ŵxx̄,  1  3 (wû)0  x )  ∣∣∣∣ ≤  ≤ ε‖ŵxx̄‖2 + C ( ‖ŵ‖21 + ‖w‖21  ) . (4.23)  При выводе неравенства (4.23) использовались гладкость функции u и предположение (4.17). Далее,  (ŵxx̄, µŵxx̄) = µ‖ŵxx̄‖2, (4.24)  ∣∣∣(ŵxx̄, ϕ) ∣∣∣ ≤ ε‖ŵxx̄‖2 +  1  4ε ‖ϕ‖2. (4.25)  Используя оценки (4.21) - (4.25), из равенства (4.20) получаем неравенство  |[ŵx‖2 − |[wx‖2 + τ(2µ− 6ε)‖ŵxx̄‖2 ≤ ≤ τC  ( ‖w‖21 + ‖ŵ‖21  ) +  τ  2ε ‖ϕ‖2.  (4.26)  25    Неявные разностные схемы. . .  Выбрав ε = µ/6 в неравенстве (4.26) и сложив его с неравенством (4.15), получим  (‖ŵx‖21 + 2τµ|[ŵx‖2 + τµ‖ŵxx̄‖2)− −(‖wx‖21 + 2τµ|[wx‖2 + τµ‖wxx̄‖2) ≤  ≤ τC ( ‖w‖21 + ‖ŵx‖21  ) + τ  3 + µ  µ ‖ϕ‖2.  Используя это неравенство и разностную лемму Гронуолла, запишем оценку (4.17) для J + 1. Выбор величин τmax, hmax и C0 зависел от параметров дифференциальной задачи, т. е. от размеров области Q и величин K и µ, и от величины δ, которую мы сами выбираем, и не зависел от J . Из этого следует справедливость оценки (4.16) в силу принципа математической индукции, поскольку при J = 0 неравенство (4.17) очевидно выполнено. 2  5 О методе исследования погрешности  Проведем обобщение тех приемов исследования точности р. с., при помощи которых были получены оценки погрешности в случае уравнений переноса и Бюргерса. Для этого рассмотрим нестационарную задачу  L(u) = f, u(0, x) = u0(x).  (5.1)  Пусть для ее решения предлагается использовать двухслойную р. с. вида  B(v)vt +A(v, v̂) = f τ h ,  v0m = u0(mh). (5.2)  Ниже будем считать, что решения задач (5.1) и (5.2) существуют и единственны. Относительно функции u будем также предполагать ее гладкость.  Обозначим через сеточную функцию ϕ невязку, возникающую в результате подстановки в разностные уравнения (5.2) проекции на сетку функции u:  ϕ = B(u)ut +A(u, û)− f τh ,  26    А.В. Попов  а через w = v − u – разность между численным решением и точным решением в узлах сетки.  Предположим, что исследуя погрешность р. с. (5.2) методом энергетических неравенств, можно получить следующее соотношение:  A2n+1 −A2n ≤ τC1(A2n+1 +A2n) + τC2b2n, (5.3) где An и bn – нормы функций w и ϕ на n-м слое соответственно. Тогда, если неравенство (5.3) получено без каких либо дополнительных условий для любых n от 0 до N−1, из разностной леммы Гроуолла следует оценка  An ≤ C0  √√√√τ N∑  n=1  b2n (5.4)  для всех n ≤ N . Примерами оценок такого вида служат неравенства из теорем 3.2 и 4.2.  В случае нелинейных р. с. неравенство (5.3) часто удается получить лишь при условии, что  ‖wn‖Ch ≤ C3. (5.5)  Тогда, предположив, что оценка (5.5) справедлива при всех n ≤ J , получаем неравенство (5.3) также и при n = J + 1. Из чего, в свою очередь, следует оценка (5.4) для n = J+1. Заметим, что поскольку в конечномерном пространстве все нормы эквивалентны, то  ‖wJ+1‖Ch ≤ α(h)AJ+1, (5.6) где α(h) – константа эквивалентности. Она может зависеть от размерности пространства, т. е. от h.  Из неравенств (5.4) и (5.6) выводим  ‖wJ+1‖Ch ≤ α(h)C0  √√√√τ N∑  n=1  b2n. (5.7)  Величина √ τ ∑N  n=1 b 2 n зависит от порядка аппроксимации р. с.  27    Неявные разностные схемы. . .  (5.2) задачи (5.1). Пусть для решения u можно показать, что  √√√√τ N∑  n=1  b2n ≤ C4(τk + hl),  где k и l больше 0. В этом случае из неравенства (5.7) следует, что  ‖wJ+1‖Ch ≤ α(h)C0C4(τk + hl).  В случае, если  α(h)(τk + hl) ≤ C3 C0C4  , (5.8)  получаем, что неравенство (5.5) выполнено и для слоя J + 1. Неравенство (5.8) можно выполнить за счет наложения условий τ ≤ τmax и h ≤ hmax в том случае, если  α(h)τk ≤ C5, α(h)hl ≤ C6,  где C5+C6 = C3/(C0C4). Другими словами, если константа эквивалентности α зависит от h, то первое из этих неравенств означает ограничение на выбор шага τ в зависимости от шага h, а второе налагает требование, чтобы порядок аппроксимации р. с. по пространственным переменным был достаточно большим.  Поскольку все константы Ck (k = 0, 1, . . . ) не зависят от номера слоя J и шагов сетки, а оценка (5.5) очевидно выполнена при n = 0, то, используя принцип математической индукции и разностную лемму Гронуолла, получаем оценку (5.4) для всех n ≤ N .  Тем самым доказана следующая  Лемма 5.1. Существуют τmax и hmax, такие, что  N max n=1  An ≤ C0(τk + hl),  если τ ≤ τmax, h ≤ hmax и α(h)(τk + hl) ≤ C.  28    А.В. Попов  Примером оценок такого вида служит неравенство из теоремы 4.3.  Докажем теперь лемму, которая играет очень важную роль в получении оценок численного интегрирования определенного типа р. c. для нестационарных задач. Это утверждение в той или иной форме использовалось в работах [10], [20] - [22].  Лемма 5.2. Пусть решение р. с. (5.2) найдено на J-м слое и известно, что:  1. справедлива оценка (5.4) при n = J ;  2. верно неравенство α(h) √ τ ∑N  n=1 b 2 n ≤ K;  3. на (J + 1)-м временном слое решение существует и единственно при всех τ ≤ τmax и h ≤ hmax;  4. величина AJ+1 непрерывно зависит от величины τ и AJ+1 = AJ при τ = 0.  Тогда, если  τCα2(h)A4J+1 − (1− τC)A2J+1 + τ(1 + τC)A2J + τC2b2J ≥ 0, (5.9)  то верно неравенство (5.3) при n = J .  Доказательство. Вычислим дискриминант квадратного уравнения относительно A2J+1 :  D = 1− τ(2C − τC2 + 4τCα2(h)((1 + τC)A2J + C2b2J )).  Из условия леммы следует, что  |2C − τC2 + 4τCα2(h)((1 + τC)A2J + C2b2J )| ≤ C3.  Потребовав, чтобы τmaxC3 < 1/2, получим D ≥ 1/2. Решая неравенство (5.9), получаем, что величина a = α2(h)A2J+1 при любой допустимой паре (τ, h) принадлежит множеству точек  [0, a1(τ)] ⋃  [a2(τ),∞],  где  a1(τ) = 1− τC −  √ D  2τC и a2(τ) =  1− τC + √ D  2τC .  29    Неявные разностные схемы. . .  На самом деле величина a при любой допустимой паре (τ, h) удовлетворяет неравенству  a ≤ a1(τ). (5.10)  Докажем это. Предположим противное. Пусть существует допустимая пара  (τ0, h0), такая, что  a ≥ a2(τ). (5.11) Зафиксируем величину h0. Величина a может быть рассмотрена как функция a(τ), где τ ∈ [0, τ0]. Функция a(τ) по условию леммы непрерывна на отрезке [0, τ0] и конечна при τ = 0. С другой стороны, a2(τ) > a1(τ) при любых τ ∈ [0, τ0]. Поэтому в силу непрерывности a(τ) и предположения (5.11) получаем, что неравенство (5.11) справедливо для всех τ ∈ [0, τ0]. Но при τ → 0 имеем a2(τ) → ∞, что противоречит ограниченности величины a. Это противоречие возникло вследствие предположения (5.11). Следовательно, оно ложно, т. е. неравенство (5.10) доказано. Из (5.11) можно получить, что a ≤ C4. Подставив эту оценку в неравенство (5.9), получим (5.3). 2  6 Одномерное нестационарное движение вязкого газа  Одномерное нестационарное движение вязкого баротропного газа описывается системой уравнений  ∂ρ  ∂t + ∂ρu  ∂x = 0, (6.1)  ρ  [ ∂u  ∂t + u  ∂u  ∂x  ] + ∂p(ρ)  ∂x = µ  ∂2u  ∂x2 + ρf. (6.2)  Искомые величины – плотность ρ и скорость u – являются функциями переменных Эйлера (t, x) ∈ Q = [0, T ]× [0, X]. Величину µ будем считать заданной положительной константой. Кроме того, система содержит известные функции p (зависящую от величины ρ) и f (зависящую от эйлеровых переменных).  30    А.В. Попов  Дополним систему (6.1) - (6.2) начальными и краевыми условиями:  (ρ, u)|t=0 = (ρ0, u0), x ∈ [0, X] , (6.3)  u(t, 0) = u(t,X) = 0, t ∈ [0, T ] . (6.4)  Численное решение задачи (6.1) - (6.2) будем обозначать (H,V ). Сеточная функция H задает приближение для функции плотности, а V – для функции скорости. Для решения уравнения (6.1) предлагается следующая конечно-разностная аппроксимация:  Ht,0 + 1  2 (ĤV )x,0 +  1  2 H0Vx,0 − Φ0(V,H) = 0,  Ht + 1  2 HV0  x +  1  2 (ĤV )0  x +  1  2 V Ĥ0  x = 0, m = 1, . . . ,M − 1,  Ht,M + 1  2 (ĤV )x̄,M +  1  2 HMVx̄,M +ΦM (V,H) = 0, (6.5)  где значения выражений Φ0(V,H) и ΦM (V,H) были определены в разделе 3.  Лемма 6.1. Зная H и V на n-м временном шаге и используя аппроксимацию (6.5), мы однозначно получим H на (n + 1)-м временном шаге.  Доказательство этого утверждения совпадает с доказательством теоремы 3.2.  Для решения уравнения (6.2) предлагается следующая конечноразностная аппроксимация:  V̂0 = V̂M = 0,  HVt + HV  3 (V̂ )0  x + H  3 (V V̂ )0  x + p(H)0  x = µV̂xx̄ +Hf,  m = 1, . . . ,M − 1. (6.6)  Лемма 6.2. Зная H и V на n-м временном шаге и используя аппроксимацию (6.6), мы однозначно находим V на (n+1)-м временном слое при условии, что Hnm > 0, m = 1, . . . ,M − 1.  31    Неявные разностные схемы. . .  Доказательство. Поиск V̂ из уравнений (6.6) сводится к решению системы линейных уравнений  Av̂ = b(V ).  Матрица A – трехдиагональная и представима в виде суммы трех матриц  A = E +A1(V ) +D −1A2(µ),  где E – единичная матрица, D – диагональная матрица с элементами, равными значениям функции H, A1(V ) – кососимметричная матрица, элементы которой определяются функцией V с нижнего слоя, и A2(µ) – симметричная положительно определенная матрица, задающая аппроксимацию второй разностной производной функции v̂ по переменной x.  Поскольку для любого вектора v (v 6= 0)  (Av, v) = (v, v) + (A1v, v) + (D −1A2v, v) > (v, v) > 0,  то матрица A невырождена, и решение на (n + 1)-м временном слое всегда однозначно определяется по n-му слою.  Добавим к разностным уравнениям (6.5) - (6.6) начальные условия  H0m = ρ0(mh), V 0 m = u0(mh), m = 0, . . . ,M. (6.7)  Разностная схема (6.5) - (6.7) аппроксимирует задачу (6.1) - (6.4) при выполненных условиях (B) и (D) из раздела 1 с точностью O(τ + h2).  Теорема 6.1. Пусть выполнены условия (A) - (D) из раздела 1. Тогда существуют величины τmax, hmax и C, которые зависят только от:  a) размера области Q; b) норм точного решения дифференциальной задачи (6.1)  (6.4) в классах функций, указанных в условии (B); c) констант µ, γM , γm, pM , fM ,  такие, что верна оценка  max n=1,...,N  ( (‖Hn − ρn‖1)2 + (‖V n − un‖1)2  ) +  32    А.В. Попов  +τµ  N∑  n=1  ‖V nxx̄ − unxx̄‖2 ≤ C(τ + h2)2,  если τ ≤ τmax, h ≤ hmax.  Замечание 6.1. Используя неравенства леммы 2.2, из утверждения этой теоремы можно получить оценку ошибки численного интегрирования в норме ‖ · ‖Ch .  Доказательство. Для доказательства теоремы используем метод, описанный в разделе 5.  Введем обозначения для разности между сеточными функциями H и V и точным решением задачи (6.1) - (6.4):  H = ρ+R, V = u+W. (6.8)  Подставим теперь выражения (6.8) в уравнения (6.5) - (6.7). Перегруппировав слагаемые, получим  Rt,0 + 1  2 (R̂V )x,0 +  1  2 R0Vx,0 − Φ0(V,R)+  + 1  2 (ρ̂W )x,0 +  1  2 ρ0Wx,0 − Φ0(W,ρ) = ϕ0,  Rt + 1  2 RV0  x +  1  2 (R̂V )0  x +  1  2 V R̂0  x +  1  2 ρW0  x +  1  2 (ρ̂W )0  x +  1  2 Wρ̂0  x = ϕ,  m = 1, . . . ,M − 1, (6.9)  Rt,M + 1  2 (R̂V )x̄,M +  1  2 RMVx̄,M +ΦM (V,R)+  + 1  2 (ρ̂W )x̄,M +  1  2 ρMWx̄,M +ΦM (W,ρ) = ϕM ,  Ŵ0 = ŴM = 0,  HWt + HV  3 Ŵ0  x + H  3 (V Ŵ )0  x + HW  3 û0 x + H  3 (Wû)0  x + Ru  3 û0 x +  + R  3 (uû)0  x + p(H)0  x − p(ρ)0  x +Rut = µŴxx̄ +Rf + ψ,  33    Неявные разностные схемы. . .  m = 1, . . . ,M − 1, (6.10) где  ϕ0 = ρt,0 − 1  2 (ρ̂u)x,0 −  1  2 ρ0ux,0 +Φ0(u, ρ),  ϕ = ρt − 1  2 ρu0  x − 1  2 (ρ̂u)0  x − 1  2 uρ̂0  x , m = 1, . . . ,M − 1,  ϕM = ρt,M − 1  2 (ρ̂u)x̄,M −  1  2 ρMux̄,M − ΦM (u, ρ),  ψ = µûxx̄+ρf−ρut− ρu  3 û0 x − ρ  3 (uû)0  x −p(ρ)0  x , m = 1, . . . ,M−1.  Обозначим через An следующее выражение:  A2n = (‖Rn‖1)2 + (‖Wn‖1)2 + τµ‖Wnxx̄‖2.  Предположим, что для всех n ≤ J доказано неравенство  An ≤ C(τ + h2). (6.11)  Тогда из леммы 2.2 следует, что  ‖Rn‖C ≤ γm/2, ‖Wn‖C ≤ γm/2, 0 ≤ n ≤ J, (6.12)  если τmax + h  2 max ≤  γm 2C(1 +X−1)  .  Вспоминая, что по условию (C) раздела 1 функция ρ ≥ γm в области Q, получим  ρ+R ≥ γm/2, 0 ≤ n ≤ J, (6.13)  и, следовательно, по лемме 6.2 разностное решение существует и единственно на (J + 1)-м слое.  Домножая скалярно уравнения (6.9) на R̂, а уравнения (6.10) на Ŵ − Ŵxx̄ и используя технику оценок, использованную в разделах 3 и 4, можно получить неравенство  |[Rn+1]|2 − |[Rn]|2 + ‖Wn+1‖21 − ‖Wn‖21 + τµ‖Wn+1xx̄ ‖2 ≤ ≤ τC(A2n +A2n+1) + τ |[ϕn]|2 + τC1‖ψn‖2, 0 ≤ n ≤ J.  (6.14)  34    А.В. Попов  Аналогично (3.16) из уравнений (6.9) получим еще M равенств:  Rxt,0 + α0(W,R) + α0(u,R) + α0(W,ρ) = ϕx,0,  Rxt + 1  2 (WR̂)0  xx +  ( W  2 R̂0  x  )  x  +  ( R  2 W0  x  )  x  + 1  2 (uR̂)0  xx +  + (u 2 R̂0  x  ) x +  ( R  2 u0 x  )  x  + 1  2 (Wρ̂)0  xx +  ( W  2 ρ̂0 x  )  x  + (ρ 2 W0  x  ) x = ϕx,  m = 1, . . . ,M − 2, (6.15)  Rxt,M−1 + αM−1(W,R) + αM−1(u,R) + αM−1(W,ρ) = ϕx,M−1,  где функции α0(u, ρ) и αM−1(u, ρ) были определены равенствами (3.17) и (3.18).  Домножив скалярно уравнения (6.15) на R̂x и проведя оценки слагаемых в получившемся тождестве аналогично тому, как это делалось в случае равенства (3.19), получим неравенство  |R̂|21 − |R|21 ≤ τC ( ‖R‖21 + ‖R̂‖21 + ‖R̂‖41 + ‖W‖21  ) +  +τµ‖Wxx̄‖2 + τ |ϕ|21, 0 ≤ n ≤ J. (6.16)  В правую часть неравенства (6.16) по сравнению с неравенством (3.19) добавились нормы функции W , а также ‖R̂‖41. Это произошло потому, что в рассматриваемом случае функция W не является проекцией на сетку известной гладкой функции и в связи с этим поменялся способ оценки скалярных произведений  (R̂x, 1  2 (WR̂)0  xx [ и (R̂x,  ( W  2 R̂0  x  )  x  [.  В отличие от случая раздела 3 их приходится оценивать без условия ограниченности норм функций Wx и Wxx̄ в пространстве Ch. Покажем, как это можно сделать.  Как и в разделе 3, проведем оценку на примере интеграла  X∫  0  ∂ρ  ∂x  ∂2uρ  ∂x2 dx,  35    Неявные разностные схемы. . .  Как и раньше в (3.22), преобразуем его к виду  X∫  0  ∂ρ  ∂x  ∂2uρ  ∂x2 dx =  X∫  0  ρ ∂ρ  ∂x  ∂2u  ∂x2 dx+  3  2  X∫  0  ( ∂ρ  ∂x  )2 ∂u  ∂x dx. (6.17)  Для слагаемых из правой части равенства (6.17) справедливы цепочки неравенств  ∣∣∣∣∣∣  X∫  0  ρ ∂ρ  ∂x  ∂2u  ∂x2 dx  ∣∣∣∣∣∣ ≤ ‖ρ‖C[0;X]  ∥∥∥∥ ∂ρ  ∂x  ∥∥∥∥ L2[0;X]  ∥∥∥∥ ∂2u  ∂2x  ∥∥∥∥ L2[0;X]  ≤  ≤ C ‖ρ‖W 12 [0;X] ∥∥∥∥ ∂ρ  ∂x  ∥∥∥∥ L2[0;X]  ∥∥∥∥ ∂2u  ∂2x  ∥∥∥∥ L2[0;X]  ≤  ≤ C ε ‖ρ‖4W 12 [0;X] + ε  ∥∥∥∥ ∂2u  ∂2x  ∥∥∥∥ 2  L2[0;X]  ,  ∣∣∣∣∣∣  X∫  0  ( ∂ρ  ∂x  )2 ∂u  ∂x dx  ∣∣∣∣∣∣ ≤ ∥∥∥∥ ∂ρ  ∂x  ∥∥∥∥ 2  L2[0;X]  ∥∥∥∥ ∂u  ∂x  ∥∥∥∥ C[0;X]  ≤  ≤ C ∥∥∥∥ ∂ρ  ∂x  ∥∥∥∥ 2  L2[0;X]  ∥∥∥∥ ∂u  ∂x  ∥∥∥∥ W 12 [0;X]  ≤ C ε  ∥∥∥∥ ∂ρ  ∂x  ∥∥∥∥ 4  L2[0;X]  + ε  ∥∥∥∥ ∂u  ∂x  ∥∥∥∥ 2  W 12 [0;X]  .  Проведя аналогичные оценки в разностном случае, получим  ∣∣∣∣(R̂x, 1  2 (WR̂)0  xx [+(R̂x,  ( W  2 R̂0  x  )  x  [  ∣∣∣∣ ≤ (6.18)  ≤ C(ε) ( ‖R̂‖41 + |[Wx‖2  ) + τε‖Wxx̄‖2.  Сложив (6.14) и (6.16), получим неравенство  A2n+1 −A2n ≤ τC(A2n +A2n+1 + ‖Rn+1‖41) + τ |[ϕn]|2 + τC1‖ψn‖2,  0 ≤ n ≤ J. Используя это неравенство и леммы 5.1 и 5.2, завершаем доказательство теоремы.  36    А.В. Попов  7 Уравнение переноса в случае двух пространственных переменных  Рассмотрим уравнение переноса с переменными коэффициентами в случае двух пространственных переменных:  ∂u  ∂t + ∂(a1u)  ∂x1 + ∂(a2u)  ∂x2 = 0, (7.1)  где функция u = u(t,x) подлежит определению, а функции ak = ak(t,x) (k = 1, 2) считаются известными гладкими функциями в области Q = [0, T ]× Ω (Ω = [0, X1] × [0, X2]), удовлетворяющими граничным условиям  a1(t,x) = a2(t,x) = 0, (t,x) ∈ [0, T ]× ∂Ω.  Поставим задачу о нахождении в области Q решения этого уравнения, удовлетворяющего следующему начальному условию  u|t=0 = u0(x), x ∈ Ω. (7.2)  У задачи (7.1) - (7.2) мы будем предполагать существование и единственность гладкого решения.  Обозначим численное решение поставленной задачи через v. Для его поиска предлагается использовать р. с.  2∏  k=1  [ E + τA1k(ak) + ντ  2A2k(a) ] v̂ = v + τb(v,a). (7.3)  Значения разностного решения на нулевом слое определяются проекцией на сетку функции, заданной в условии (7.2):  v0m1m2 = u0(m1h1,m2h2), (7.4)  m1 = 0, . . . ,M1, m2 = 0, . . . ,M2.  Выше через E обозначен единичный оператор. Операторы A1k(ak) аппроксимируют часть дифференциального оператора диверген 37    Неявные разностные схемы. . .  ции, содержащую производную по переменной xk:  A1k(ak)v̂ =      [ (akv̂) ◦  xk  + akv̂ ◦ xk  ] /2, xm ∈ ω̄h \ (γk ∪ γ−k) ,  (akv̂)xk /2, xm ∈ γ−k, (akv̂)x̄k /2, xm ∈ γk.  (7.5) Операторы A2k(a) появляются вследствие расщепления разностного оператора и играют роль регуляризаторов:  A2k(a)v̂ =      − (Φkv̂xk)x̄k , xm ∈ ω̄h \ (γk ∪ γ−k) , −2h−1k Φkv̂xk , xm ∈ γ−k,  2h−1k Φ (−1k) k v̂x̄k , xm ∈ γk.  (7.6)  Через Φ1 и Φ2 обозначены функции, заданные на сетке ω̄h:  Φ1 = |a|2s1s2s̄2 , Φ2 = |a| 2 s1s̄1s2  .  При этом считается, что функция |a|2 четным образом продолжена за границу сетки ω̄h.  Сеточная функция b(v,a) задается формулой  b(v,a) =      − ( va1 ◦  x1 + va2 ◦  x2  ) /2, xm ∈ ωh,  −{vakxk − hk[v ( a (+1k) kxkx̄k  − a(+2k)kxkx̄k/2 ) +  +(vak) (+1k) xkx̄k  − (vak)(+2k)xkx̄k /2]}/2, xm ∈ γ−k,  −{vakx̄k + hk[v ( a (−1k) kxkx̄k  − a(−2k)kxkx̄k/2 ) +  +(vak) (−1k) xkx̄k  − (vak)(−2k)xkx̄k /2]}/2, xm ∈ γk.  (7.7)  Обозначим через ϕ невязку, появляющуюся в результате подстановки проекции точного решения задачи (7.1) - (7.2) в р. с. (7.3) - (7.4). Имеем  ϕ =  u+ τb(u,a)− 2∏  k=1  [ E + τA1k(ak) + ντ  2A2k(a) ] û  τ .  38    А.В. Попов  Как и в случае одной пространственной переменной, величина |[ϕ]| имеет порядок τ +h2 при условии, что функции a и u достаточно гладкие. Увеличив требование на гладкость, можно получить, что |ϕ|1 тоже будет порядка τ + h2.  Теорема 7.1. Решение р. с. (7.3) - (7.4) существует и единственно.  Доказательство. Для определения значений неизвестной функции v̂ в узлах сетки ω̄h из уравнения (7.3) выводим систему линейных алгебраических уравнений  Ã1Ã2v̂ = b̃,  где Ãk (k = 1, 2) – квадратная матрица размера (M1 + 1)(M2 + 1). Матрица Ãk имеет блочно-диагональную структуру. Каждый блок имеет размер (Mk +1) и представляет собой матрицу, являющуюся суммой трех матриц. Первая матрица – диагональная, на диагонали которой в первой и последней строках элементы равны 1/2, а в остальных строках – единице. Вторая матрица – кососимметричная, третья – симметричная и неотрицательно определенная. Вследствие такой структуры каждый блок является невырожденным, следовательно, и вся матрица Ãk не вырождена. Отсюда и следуют существование и единственность решения на верхнем временном слое. 2  Теорема 7.2. Р. с. (7.3) - (7.4) является экономичной.  Доказательство. Экономичность р. с. вытекает из трехдиагональности матриц Ãk и, следовательно, возможности применения алгоритма прогонки для их обращения. 2  Обозначим через w = v − u ошибку численного интегрирования по этой р. с., где под сеточной функцией u понимается проекция на сетку точного решения задачи (7.1) - (7.2). Функция w является решением задачи  wt + ∑3  k=0 τ kαk(w,a) = ϕ,  w0 = 0, (7.8)  где α0(w,a) = (A  1 1(a1) +A  1 2(a2))ŵ − b(w,a),  39    Неявные разностные схемы. . .  α1(w,a) = (A 1 1(a1)A  1 2(a2) + νA  2 1(a) + νA  2 2(a))ŵ,  α2(w,a) = ν(A 1 1(a1)A  2 2(a) +A  2 1(a)A  1 2(a2))ŵ,  α3(w,a) = ν 2A21(a)A  2 2(a)ŵ.  Теорема 7.3. Для ошибки численного интегрирования по р. с. (7.3) - (7.4) при ν > 3/2 справедливы оценки  max n=1,...,N  |[wn]|2 ≤ C ( |[w0]|2 + τ  N−1∑  n=0  |[ϕn]|2 ) , (7.9)  max n=1,...,N  ‖wn‖21 ≤ C ( ‖w0‖21 + τ  N−1∑  n=0  ‖ϕn‖21  ) (7.10)  при условии, что τ ≤ τmax. Доказательство. Строгое доказательство неравенства (7.9)  очень громоздко, поэтому мы приведем все оценки для соответствующей дифференциальной задачи, для которой они существенно более компактны, чем в разностном случае. Для сокращения записи ниже мы используем обозначения  ∂u  ∂t = ut,  ∂u  ∂xk = uxk , (k = 1, 2),  ∫  Ω  uv dx = (u, v),  √√√√ ∫  Ω  u2 dx = ‖u‖.  Дифференциальным аналогом задачи для ошибки (7.8) служит следующая задача, где τ – малый параметр:  wt + 1  2 (a1w)x1 +  1  2 (a2w)x2 +  a1 2 wx1 +  a2 2 wx2 +  w  2 a1x1 +  w  2 a2x2+  + τ  4  ( (a1(a2w)x2)x1 + a1(a2w)x2x1 + a1 (a2wx2)x1 + (a1a2wx2)x1  ) −  −τν (( |a|2wx1  ) x1  + ( |a|2wx2  ) x2  ) −  −τ 2ν  2  ( a1 ( |a|2wx2  ) x2x1  + ( a1 ( |a|2wx2  ) x2  ) x1  +  40    А.В. Попов  + ( |a|2 (a2wx2)x1  ) x1  + ( |a|2 (a2w)x2x1  ) x1  ) +  +τ3ν2 ( |a|2  ( |a|2wx2  ) x2x1  ) x1  = ϕ,  w|t=0 = w0(x). (7.11) Умножив уравнение (7.11) скалярно на w, оценим каждое из слагаемых получающего тождества. Во-первых,  (w,wt) =  ( ‖w‖2  ) t  2 . (7.12)  Далее, в силу кососимметричности дифференциальных операторов  ∂  ∂xk · ak + ak ·  ∂  ∂xk получаем  ( w,  1  2 (a1w)x1 +  1  2 (a2w)x2 +  a1 2 wx1 +  a2 2 wx2  ) = 0. (7.13)  Используя ε-неравенство и аналоги неравенств (2.5) и (2.6), выводим следующие оценки:  ∣∣∣ ( w,  w  2 a1x1 +  w  2 a2x2  )∣∣∣ ≤ C‖w‖2; (7.14)  τ  4  ( w, (a1(a2w)x2)x1 + a1(a2w)x2x1 + a1 (a2wx2)x1 + (a1a2wx2)x1  ) −  −τν ( w, ( |a|2wx1  ) x1  + ( |a|2wx2  ) x2  ) ≥  ≥ τ(ν − 1− τC) ( ‖|a|wx1‖2 + ‖|a|wx2‖2  ) − C‖w‖2; (7.15)  τ2ν  2  ∣∣∣∣ ( w, a1  ( |a|2wx2  ) x2x1  + ( a1 ( |a|2wx2  ) x2  ) x1  +  + ( |a|2 (a2wx2)x1  ) x1  + ( |a|2 (a2w)x2x1  ) x1  )∣∣∣ ≤  ≤ τ(0, 5 + τC) ( ‖|a|wx1‖  2 + ‖|a|wx2‖  2 ) +  41    Неявные разностные схемы. . .  + τ3ν2  2 ‖|a|wx1x2‖2 + C‖w‖2; (7.16)  τ3ν2 ( w, ( |a|2  ( |a|2wx2  ) x2x1  ) x1  ) ≥  ≥ τ3ν2 ( (1− τC)‖|a|wx1x2‖2−  −C τ  ( ‖|a|wx1‖  2 + ‖|a|wx2‖  2 + ‖w‖2  ) ) ; (7.17)  |(w,ϕ)| ≤ ‖w‖ 2 + ‖ϕ‖2 2  . (7.18)  Окончательно, из (7.12) - (7.17) следует  ( ‖w‖2  ) t  2 + τ(ν − 1, 5− τC)  ( ‖|a|wx1‖2 + ‖|a|wx2‖2  ) +  + τ3ν2  2 (1− τC)‖|a|wx1x2‖2 ≤ C‖w‖2 + ‖ϕ‖2/2.  (7.19)  В разностном случае можно получить аналог неравенства (7.19). Выберем параметр ν и τmax так, чтобы  ν − 1, 5− τC ≥ 0 и 1− τC ≥ 0.  В этом случае мы получаем, что для ошибки р. с. (7.3) - (7.4) выполняется аналог неравенства (3.15), из которого по разностной лемме Гронуолла следует справедливость оценки (7.9).  Оценка (7.10) следует из аналога неравенства (3.26), который можно получить, если разностным образом продифференцировать уравнение для ошибки (7.8) по пространственным переменным, получить энергетическое тождество, домножив полученные уравнения скалярно на ŵx и ŵy соответственно, и оценить в этом тождестве все слагаемые аналогично тому, как это было сделано в разделе 3 и при выводе неравенств (7.15) - (7.17). 2  Следствие 7.1. При условии, что функции u и a таковы, что |[ϕ]| порядка τ + h2, из оценки (7.9) следует сходимость разностной схемы с порядком τ +h2 в норме пространства L2,h. Если же к этому условию добавить требование, чтобы и |ϕ|1  42    А.В. Попов  тоже была порядка τ + h2, то из оценки (7.10) следует сходимость разностной схемы с порядком τ + h2 в норме пространства W 12,h.  8 Разностная схема для двумерного нестационарного движения вязкого газа  Разностное решение задачи (1.1) - (1.2) обозначим (H,V1, V2). Для его поиска предлагается использовать р. с.  2∏  k=1  [ E + τA1k(Vk) + 3τ  2A2k(V) ] Ĥ = H + τb(H,V); (8.1)  [ E +  τ  3  ( V1∂ ◦  x1 + ∂ ◦  x1 V1 − 4ν∂x1∂x̄1  )] ×  × [ E +  τ  2  ( V2∂ ◦  x2 + ∂ ◦  x2 V2 − 2ν∂x2∂x̄2  )] V̂1 =  = V1 + τb1, xm ∈ ωh; V̂1 = 0, xm ∈ γh; (8.2)  [ E +  τ  2  ( V1∂ ◦  x1 + ∂ ◦  x1 V1 − 2ν∂x1∂x̄1  )] ×  × [ E +  τ  3  ( V2∂ ◦  x2 + ∂ ◦  x2 V2 − 4ν∂x2∂x̄2  )] V̂2 =  = V2 + τb2, xm ∈ ωh; V̂2 = 0, xm ∈ γh.  (8.3)  Проекции на сетку ω̄h функций, заданных в условии (1.2), используются в качестве начальных условий  (H, V)|t=0 = (ρ0, u0). (8.4) В уравнениях (8.1) - (8.3) через E обозначен единичный оператор, а операторы Vk∂ ◦  xm и ∂ ◦  xm Vk действуют по правилу  Vk∂ ◦ xm  (W ) = VkW ◦ xm , (∂ ◦  xm Vk)W = (VkW ) ◦  xm .  Операторы A1k и A 2 k (k = 1, 2), а также функция b были опреде лены в разделе 7. Сеточная функция ν является константой на каждом времен ном шаге n: νn =  µ  min xm∈ω̄h  Hn .  43    Неявные разностные схемы. . .  Сеточные функции b1 и b2 задаются формулами  b1 = V1V2 ◦ x2 /2−H−1p ◦  x1 + f1 + (3H)  −1 ( µV2 ◦  x2  ) ◦ x1  +  +4/3[µH−1V1x1x̄1 − νV1x1x̄1 ] + µH−1V1x2x̄2 − νV1x2x̄2 ,  b2 = V2V1 ◦ x1 /2−H−1p ◦  x2 + f2 + (3H)  −1 ( µV1 ◦  x1  ) ◦ x2  +  +4/3[µH−1V2x2x̄2 − νV2x2x̄2 ] + µH−1V2x1x̄1 − νV2x1x̄1 . Теорема 8.1. Пусть для дифференциальной задачи (1.1)  (1.2) выполнены условия (A) - (D) из раздела 1. Тогда существуют величины τmax, hmax, K и C, зависящие от параметров дифференциальной задачи и ε (относительной точности выполнения арифметических операций на ЭВМ), такие, что для сеточных норм разности между разностным решением и проекцией точного решения дифференциальной задачи на сетку Qτh верна оценка  max n≤N  ‖(Hn, Vn)− (ρn, un)‖21 + τ N∑  n=1  (|V − u|22 + ‖Vt̄ − ut̄‖2) ≤  ≤ C (( τ + h21 + h  2 2  )2 + (φc)  2 ) ,  где τ ≤ τmax, h ≤ hmax, τ ≤ K|ln|h|2|−1/2  и величина φc определяется как  φc = ε  τ  (( 1  h1 +  1  h2  ) 2∏  k=1  ( 1 +  τ  hk + τ2  h2k + τ3  h3k  ) +  2∏  k=1  ( 1 +  τ  h2k  )) .  Эта теорема доказывается методом энергетических неравенств, примененным выше для исследования точности р. с. в случае модельных задач для системы (1.1). Доказательство этой оценки без учета ошибок, вносимых за счет погрешности округлений при выполнении арифметических операций, можно найти в [20] и [21]. В работе [23] теорема 8.1 доказана при условии, что для решения алгебраических задач используется метод прогонки c относительной точностью выполнения арифметических операций, равной ε.  44    А.В. Попов  Доказательство основано на том, что можно выписать возмущенную задачу, точным решением которой служат сеточные функции (H∗, V ∗1 , V  ∗ 2 ), получаемые при реальных вычислениях. В разде лах 9 и 10 выписаны эти возмущенные задачи и для них получены все необходимые оценки.  Заметим, что в процессе доказательства теоремы 8.1 делается предположение о том, что величина φc удовлетворяет условию  φ ≤ K|ln|h|2|−0,5.  9 Возмущения системы линейных уравнений  Н.С.Бахвалов в работе [4] предложил подход к исследованию вопроса об ошибке, получаемой при применении методом прогонки с относительной точностью арифметических операций ε, для решения систем линейных алгебраических уравнений. Он рассмотрел систему уравнений  (E + τB) û = u+ τb,  где B = B∗ > 0 – трехдиагональная матрица второй разностной производной. Им было доказано, что использовав метод прогонки с относительной точностью арифметических операций ε, мы получим вектор û∗, удовлетворяющий системе уравнений  (E + τB + τBε) û ∗ = (1 + ξ)(u+ τb).  Матрица Bε является трехдиагональной. Для её элементов выполнена следующая оценка:  |bεij | ≤ C ( 1  τ +  1  h2  ) ε,  а значения функции ξ имеют порядок ε. Используем этот подход для исследования системы уравнений  ( E + τA1k(vk) + ντ  2A2k(|v|) ) R = g,  где операторы A1k(vk) и A 2 k(v) определены в разделе 7. Решение  этой системы может быть преобразовано к решению серии систем  AH = F, (9.1)  45    Неявные разностные схемы. . .  где матрица A имеет вид    4h2 + 2τ2b0 2τha0 − 2τ 2b0 0 ............................................ 0  ........................................................................................................  ...0 − τhaj−1 − τ 2bj−1 4h  2 + τ2(bj + bj−1) τhaj − τ 2bj 0...  ........................................................................................................ 0 ........................... 0 − 2τhaN−1 − 2τ  2bN−1 4h 2 + 2τ2bN−1     .  Элементы ak, bk (k = 0, . . . , N − 1) и координаты вектора F = (F0, . . . , FN ) ограничены константой C, не зависящей отN . Кроме того, все элементы bk (k = 0, . . . , N − 1) неотрицательны.  Решение этой системы методом прогонки может быть получено по следующим формулам:  α0 = −τha0 + τ2b0 2h2 + τ2b0  , β0 = F0/2  2h2 + τ2b0 ,  αj = −τhaj + τ2bj  4h2 + τ2(bj + bj−1)− αj−1(τhaj−1 + τ2bj−1) ,  βj = Fj + βj−1(τhaj−1 + τ  2bj−1)  4h2 + τ2(bj + bj−1)− αj−1(τhaj−1 + τ2bj−1) , (9.2)  j = 1, . . . , N − 1,  HN = FN/2 + βN−1(τhaN−1 + τ  2bN−1)  2h2 + τ2bN−1 − αN−1(τhaN−1 + τ2bN−1) ,  Hk = αkHk+1 + βk, k = N − 1, . . . , 0. В силу условия b0 ≥ 0 получаем, что  |α0| ≤ τ |a0| 2h  + 1 ≤ C τ h + 1.  Докажем теперь, что  |αj | ≤ C τ  h + 1 (9.3)  для всех j (0 ≤ j ≤ N − 1). Сначала докажем, что знаменатель дроби, определяющей αj ,  может быть представлен как сумма 4h2 + τ2bj + γj , где γj ≥ 0. Доказательство проведем по индукции.  46    А.В. Попов  Для α0 это очевидно. Предположим, что такое представление верно для всех αj с j ≤ J . Докажем это для αJ+1. Знаменатель дроби, определяющей αJ+1, равен  4h2 + τ2bJ+1 + τ 2bJ − αJ (τhαJ + τ2bJ ).  Следовательно, мы должны доказать, что  τ2bJ − αJ (τhαJ + τ2bJ ) ≥ 0. (9.4)  Согласно предположению мы имеем  αJ = −τhaJ + τ2bJ 4h2 + τ2bJ + γJ  .  Подставлив это выражение в левую часть неравенства (9.4), получим  γJ+1 = τ 2bJ +  τ2h2a2J − τ4b2J 4h2 + τ2bJ + γJ  ≥ τ 2h2a2J  4h2 + τ2bJ + γJ ≥ 0,  поскольку bj ≥ 0 для всех j. Таким образом, мы доказали, что γJ+1 ≥ 0. Следовательно,  γj ≥ 0 для всех j. Используем доказанное для оценки |αj |:  |αj | = | −τhaj + τ2bj 4h2 + τ2bj + γj  | ≤ τ |aj | 4h  + 1 ≤ C τ h + 1, j = 1, . . . , N − 1.  Пусть метод прогонки реализуется на ЭВМ с относительной точностью арифметических операций ε. Тогда формулы (9.2) преобразуются следующим образом:  α∗0 = D0 + δ0 E0 + p0  , β∗0 = F0/2 + r0 E0 + p0  ,  α∗j = Dj + δj  Ej − α∗j−1Qj−1 + pj , β∗j =  Fj +Qj−1β ∗ j−1 + rj  Ej − α∗j−1Qj−1 + pj ,  j = 1, . . . , N − 1, (9.5)  H∗N = FN/2 +QN−1β  ∗ N−1 + rN  EN − α∗N−1QN−1 + pN ,  47    Неявные разностные схемы. . .  H∗k = (α ∗ kH  ∗ k+1(1 + κk+1) + β  ∗ k)(1 + ωk+1), k = N − 1, . . . , 0.  В формулах (9.5) использованы обозначения  Dj = −τhaj + τ2bj , j = 0, . . . , N − 1,  E0 = 2h 2 + τ2b0, EN = 2h  2 + τ2bN−1,  Ej = 4h 2 + τ2(bj + bj−1), j = 1, . . . , N − 1,  Qj = τhaj + τ 2bj , j = 0, . . . , N − 1,  δj = δ 1 j τhaj + δ  2 j τ  2bj , j = 0, . . . , N − 1,  p0 = 2p 1 0h  2 + p20τ 2b0, pj = 4p  1 jh  2 + p2jτ 2bj + p  3 jτ  2bj−1+  +p4jα ∗ j−1τhaj−1 + p  5 jα ∗ j−1τ  2bj−1, j = 1, . . . , N − 1,  pN = 2p 1 Nh  2 + p2Nτ 2bN−1 + p  3 Nα  ∗ N−1τhaN−1 + p  4 Nα  ∗ N−1τ  2bN−1,  r0 = r 1 0F0, rj = r  1 jFj + β  ∗ j−1σj ,  σj = r 2 j τhaj−1 + r  3 j τ  2bj−1, j = 1, . . . , N.  В этих формулах и всюду далее считаем, что величины δkl , p k l , r  k l ,  κk и ωk (k, l = 0, 1, . . . ) имеют порядок ε. Обозначим через β∗∗k выражение  β∗∗k = β ∗ k + κk+1α  ∗ kH  ∗ k+1 + ω  k+1H∗k , (9.6)  где ωk = ωk  1 + ωk . Таким образом, мы имеем  H∗k = α ∗ kH  ∗ k+1 + β  ∗∗ k , k = 0, . . . , N − 1. (9.7)  Теперь найдем такую функцию F ∗, чтобы формулы (9.2) остались верными, если α, β и F заменить на α∗, β∗∗ и F ∗ при условии, что pj будет прибавлена к знаменателю αj , βj и HN , а δj будет прибавлена к числителю αj .  Определим выражение для F ∗0 . С этой целью подставим в формулу для β∗0 в (9.5) его выражение через β  ∗∗ 0 согласно (9.6):  β∗∗0 = F0/2 + r0 E0 + p0  + κ1α ∗ 0H  ∗ 1 + ω  1H∗0 .  48    А.В. Попов  Из этого выражения получаем, что  F ∗0 = F0/2 + r0 + (D0 + δ0)κ1H ∗ 1 + (E0 + p0)ω  1H∗0 .  Аналогично могут быть получены равенства  F ∗k = Fk + r 1 kFk −Qk−1  ( κkα  ∗ k−1H  ∗ k + ω  kH∗k−1 )  +σk ( β∗∗k−1 − κkα∗k−1H∗k − ωkH∗k−1  ) + (Dk + δk)κk+1H  ∗ k+1  +(Ek − α∗k−1Qk−1 + pk)ωk+1H∗k , k = 1, . . . , N − 1,  F ∗N = FN/2 + r 1 NFN −QN−1  ( κNα  ∗ N−1H  ∗ N + ω  NHN )  +σN ( β∗∗N−1 − κNα∗N−1H∗N − ωNHN−1  ) .  В формулах для F ∗ согласно (9.7) заменим β∗∗:  F ∗0 = F0/2 + r0 + (D0 + δ0)κ1H ∗ 1 + (E0 + p0)ω  1H∗0 ,  F ∗k = Fk + r 1 kFk −Qk−1  ( κkα  ∗ k−1H  ∗ k + ω  kHk )  +σk ( H∗k−1 − α∗k−1H∗k − κkα∗k−1H∗k − ωkH∗k−1  ) + (Dk + δk)κkH  ∗ k  + ( Ek − α∗k−1Qk−1 + pk  ) ωk+1H∗k , k = 1, . . . , N − 1,  (9.8) F ∗N = FN/2 + r  1 NFN −QN−1  ( κNα  ∗ N−1H  ∗ N + ω  NH∗N )  +σN ( H∗N−1 − α∗N−1H∗N − κNα∗N−1H∗N − ωNH∗N−1  ) .  Заметим, что  |α∗j | ≤ C ( τ h + 1 ) , j = 0, . . . , N − 1. (9.9)  Эта оценка может быть доказана аналогично доказательству неравенства (9.3) при дополнительном условии, что величина ε(h−2+ 1) достаточно мала.  Итак, мы доказали, что решение системы (9.1), полученное по формулам (9.2) с относительной точностью арифметических операций ε, является точным решением системы  (A+Apδ)H ∗ = F ∗, (9.10)  где Apδ – двухдиагональная матрица. Элементы диагоналей Apδ – это значения функций p и δ.  49    Неявные разностные схемы. . .  Из формул (9.8) следует, что система (9.10) может быть переписана в виде  (A+A∗)H∗ = F + F ∗∗,  где F ∗∗k = r 1 kFk, а A  ∗ – трехдиагональная матрица. Из оценки (9.9) и формул (9.8) следует оценка для элементов A∗:  |a∗ij | ≤ C (( τh+ τ2  ) ( 1 +  τ  h  ) + h2  ) ε.  Возвращаясь к первоначальной задаче, имеем ( E + τA1k(vk) + ντ  2A2k(v) +Akε ) R∗ = (1 + ξ)g.  Следующие оценки имеют силу для оператора Akε и функции ξ:  ‖Akεu‖ ≤ C    ( τh+ τ2  ) ( 1 +  τ  h  )  h2 + 1    ε‖u‖,  ‖ξ‖ ≤ C · ε.  10 Устойчивость разностной схемы по отношению к ошибками округления  Рассмотрим разностную схему, которая получается на каждом временном слое решением уравнения  B1B2x = b, (10.1)  где B1 и B2 – трехдиагональные матрицы. Это равенство может быть легко сведено к системе уравнений  { B1y = b, B2x = y.  (10.2)  Результатом решения уравнения  Bkzk = dk  на ЭВМ методом прогонки служит функция z∗k, которая является точным решением уравнения (см. раздел 9)  (Bk +B ∗ k)z  ∗ k = (1 + ξk)dk.  50    А.В. Попов  Таким образом, решение системы (10.2) с учетом округлений мы получаем в виде двух функций x∗ и y∗, которые являются точными решениями системы  { (B1 +B  ∗ 1)y  ∗ = (1 + ξ1)b, (B2 +B  ∗ 2)x  ∗ = (1 + ξ2)y ∗.  (10.3)  Система (10.3) может быть сведена к одному равенству  (B1B2 +B ∗)x∗ = b+ b∗, (10.4)  где B∗ = B∗1B2 +B1B  ∗ 2 +B  ∗ 1B  ∗ 2 ,  b∗ = ξ1b+ (B1 +B ∗ 1)  ( ξ2  1 + ξ2 (B2 +B  ∗ 2)x  ∗  ) .  Рассмотрим конкретную задачу, где уравнение (10.1) реализовано в (8.1). В этом случае с использованием результатов раздела 9 мы получим следующие оценки:  ‖B∗u‖ ≤ C ( ε  ( 1 +  τ  h2 + τ2  h22  )    ( τh1 + τ  2 )(  1 + τ  h1  )  h21 + 1   +  +ε  ( 1 +  τ  h1 + τ2  h21  )    ( τh2 + τ  2 )(  1 + τ  h2  )  h22 + 1   +  +ε2 2∏  k=1  (( τhk + τ  2 )(  1 + τ  hk  ) 1  h2k + 1  )) ‖u‖, (10.5)  ‖b∗‖ ≤ Cε ( ‖b‖+  + 2∏  k=1  ( 1 +  τ  hk + τ2  h2 + ε  (( τhk + τ  2 )(  1 + τ  hk  ) 1  h2 + 1  ))) ‖x∗‖.  (10.6)  51    Неявные разностные схемы. . .  Можно получить аналогичные оценки для уравнений (8.2) - (8.3):  ‖B∗u‖ ≤ Cε ( 1 +  τ  h21  )( 1 +  τ  h22  ) ‖u‖, (10.7)  ‖b∗‖ ≤ Cε ( ‖b‖+  ( 1 +  τ  h21  )( 1 +  τ  h22  ) ‖x∗‖  ) . (10.8)  Таким образом, решение, которое мы получаем, используя арифметические операции с относительной точностью ε, только приближенно удовлетворяет равенствам (8.1) - (8.3). Следовательно, эти равенства должны быть заменены на равенства (10.4). После этого разностная схема может быть исследована методом энергетических неравенств, описанным выше, с использованием оценок (10.5) - (10.8). В этом случае мы получим оценку дополнительной ошибки численного интегрирования, которая зависит от параметров τ , h разностной схемы и относительной точности ε. Окончательный результат сформулирован в теореме 8.1.  Литература  [1] Абрашин В.Н., Матус П.П. О точности разностных схем для одномерных задач газовой динамики // Дифференциальные уравнения. - 1981. - T. XYII. - N 7. - С. 1155-1170.  [2] Амосов А.А, Злотник А.А. Разностная схема для квазиосредненных уравнений одномерного движения вязкого теплопроводного газа с негладкими данными//Ж. выч. мат. и мат. физ. - 1999. - Т. 39. - N 4. - С. 592-611.  [3] Андерсон А., Таннехилл Дж., Плетчер Р.Вычислительная гидромеханика и теплообмен. - М.: Мир, 1990. - Т. 1. - 384 с.; М.: Мир, 1990. - Т. 2. - 392 с.  [4] Антонцев С.Н., Кажихов А.В., Монахов В.Н.Краевые задачи механики жидкостей и газов. - Новосибирск: Наука, 1983. 320 с.  52    А.В. Попов  [5] Арделян Н.В. Разрешимость и сходимость нелинейных разностных схем// ДАН СССР. - 1988. - Т. 302. - N 6. - С. 12891292.  [6] Арефьев В.С. Об устойчивости нелинейных разностных схем// ДАН СССР. - 1985. - Т. 285. - N 1. - С. 11-14.  [7] Бахвалов Н.С. О накоплении вычислительной погрешности при численном решении дифференциальных уравнений//Сб. работ ВЦ МГУ, 1962. - N 1. - С. 47-68.  [8] Бахвалов Н.С., Жидков Н.П., Кобельков Г.М. Численные методы. - М.: Лаборатория Базовых Знаний, 2000. - 624 с.  [9] Гончаров В.А., Кривцов В.М., Чарахчьян А.А. Численная схема моделирования дозвуковых течений вязкого сжимаемого газа// Ж. выч. мат. и мат. физ. - 1988. - Т. 28. - N 12. С. 1858-1866.  [10] Джгамадзе Н.О., Попов А.В. О сходимости разностной схемы для двумерных уравнений газовой динамики//Ж. выч. мат. и мат. физ. - 1992. - Т.31. - N 4.  [11] Дьяконов Е.Г. Разностные методы решения краевых задач. Вып. 1 (Стационарные задачи). - М.: Изд-во МГУ, 1971; Вып. 2 (Нестационарные задачи). - М.: Изд-во МГУ, 1972.  [12] Дьяконов Е.Г. Минимизация вычислительной работы. Асимптотически оптимальные алгоритмы для эллиптических задач. - М.: Наука, 1980. - 272 с.  [13] Елизарова Т.Г., Четверушкин Б.Н. Кинетически-согласованные разностные схемы для моделирования течений вязкого теплопроводного газа//Ж. выч. мат. и мат. физ. - 1988. - Т. 28. - N 11. - С. 1695-1710.  [14] Kobelkov G.M., Sokolov A.G. On finite difference schemes for viscous barotropic compressible gas problems// Sov. J. Numer. Mat. Modelling. - 1994. - No 9. - P. 223-229.  53    Неявные разностные схемы. . .  [15] Лапин А.В. О корректности и сходимости в сильной норме разностных схем для квазилинейных параболических уравнений, I, II// Изв. вузов. Математика. - 1974. - N 7. - С. 42-52; N 8. - С. 47-53.  [16] Лапин А.В., Ляшко А.Д. О сходимости разностных схем для квазилинейных параболических уравнений// Изв. вузов. Математика. - 1975. - N 12. - С. 30-42.  [17] Ляшко А.Д., Федоров Е.М. О корректности нелинейных двухслойных операторно-разностных схем // Дифференциальные уравнения. - 1981. - Т. XVII. - N 7. - С. 1304-1316.  [18] Махвиладзе Г.М., Щербак С.Б. Разностная схема для численного исследования нестационарных двумерных движений сжимаемого газа//Препринт N 113. - М.: ИПМехан. АН СССР, 1978.  [19] Полежаев В.И. Численное решение системы двумерных нестационарных уравнений Навье-Стокса для сжимаемого газа в замкнутой области// Изв. АН СССР. Механ. жидкости и газа. - 1967. - N 2. - С. 103-111.  [20] Popov A.V. A study of cost-effective finite difference scheme for the system of equations for two-dimensional flow of a viscous barotropic gas//Sov. J. Numer. Mat. Modelling. - 1990. - No 5. - P. 395-417.  [21] Попов А.В. Исследование экономичного конечно-разностного метода для двухмерных уравнений вязкого теплопроводного газа// Ж. выч. мат. и мат. физ. - 1991. - Т. 30. - N 7. - C. 10661080.  [22] Popov A.V. A study of finite-difference method for solving gas dynamic equations in Euler coordinates// Sov. J. Numer. Mat. Modelling. - 1991. - No 6. - P. 377-394.  [23] Popov A.V. Convergence analysis of a finite difference scheme for viscous gas problems// Technical Report N 20. - 1997. Department of Mathematical Modelling. Technical University of Denmark.  54    Н.Б. Плещинский  [24] Рождественский Б.Л., Яненко Н.Н. Системы квазилинейных уравнений и их приложения к газовой динамике. - М.: Наука, 1968. - 592 с.  [25] Самарский А.А. Теория разностных схем. - М.: Наука, 1983. - 616 с.  [26] Самарский А.А., Попов Ю.П. Разностные методы решения задач газовой динамики. - М.: Наука, 1973. - 352 с.  [27] David A. Kopriva Multidomain Spectral Solution of Compressible Viscous Flows//J. Comput. Phyz. - 1994. - V. 115. - No 1. P. 184-189.  [28] Collins J.P., Colella P., Glaz H.M. An Implicit-Explicit Eulerian Godunov Scheme for Compressible Flow//J. Comput. Phyz. 1995. - V. 116. - No 2. - P. 195-211.  [29] Renaud Francois, Gauthier Serge A Dynamical Pseudo-Spectral Domain Decomposition Technique: Application to Viscous Compressible Flows//J. Comput. Phyz. - 1997. - V. 131. - No 1. - P. 89-108.  АБСТРАКТНАЯ ТЕОРИЯ ПРИБЛИЖЕННЫХ МЕТОДОВ  РЕШЕНИЯ ЛИНЕЙНЫХ ЗАДАЧ 1  Н.Б. Плещинский Казанский государственный университет  В лекции обсуждаются основные положения абстрактной теории приближенных методов решения линейных операторных уравнений, в рамках которой можно провести теоретическое обоснование различных способов численного решения граничных задач  1Работа выполнена при поддержке Фонда НИОКР Республики Татарстан  55   