.  ЧИСЛЕННОЕ ИНТЕГРИРОВАНИЕ В Р-ВЕРСИИ МКЭ 1  С.П. Копысов, И.В. Красноперов Институт прикладной механики УрО РАН, г. Ижевск  1 Введение  Для всех элементов высокого порядка численное интегрирование является обязательным, и стоимость (используемое машинное время) этого процесса необходимо свести к минимуму. Более экономичные квадратуры позволяют значительно сократить объем вычислений при интегрировании.  Целью работы является повышение эффективности численного интегрирования при формировании конечно-элементных матриц жёсткости, поскольку эта часть вычислений в МКЭ занимает значительный процент всего времени решения задачи. Ситуация значительно осложняется, если применяются иерархические элементы высокого порядка (p-версия МКЭ), например, элементы, построенные на проинтегрированных полиномах Лежандра [1,2]. Такие элементы могут иметь различные порядки на ребрах и гранях [3, 4] и используются там, где требуются элементы с разным числом степеней свободы в различных направлениях. При этом количество элементов и их размеры не изменяются.  Высокая степень точности, которая может быть достигнута с помощью элементов высших степеней, означает, что приемлемые для практических целей решения часто могут быть получены при использовании весьма небольшого числа таких элементов.  1Работа выполнена при поддержке РФФИ, проект № 02-07-90265 и гранта  молодых ученых УрО РАН.  162    С.П. Копысов, И.В. Красноперов  При решении практических задач часто требуется моделировать границы весьма сложного вида, и формы элементов существенно влияют на сходимость решения.  Вычисления на уровне элемента включают в себя вычисления матрицы жёсткости и вектора правой части системы. При вычислении матриц жёсткости используется численное интегрирование, например, для задач теории упругости:  A =  ∫  Ωx  B T ψDBψdΩx =  ∫  Ωξ  B T ψDBψ detJdΩξ = (1.1)  =  nG∑  i=1  nG∑  j=1  nG∑  k=1  WiWjWk · detJ[(B(ξ1i, ξ2j , ξ3k))TDB(ξ1i, ξ2j , ξ3k)],  где матрица Bψ – результат произведения матрицы дифференцирования на матрицу функций формы; D – матрица упругих постоянных; J – якобиан; Wi – весовые коэффициенты квадратур.  Для численного интегрирования матриц жёсткости и векторов сил преимущественно используются квадратурные формулы Гаусса-Лежандра [1]. Их решающее преимущество состоит в том, что высокая точность достигается при незначительном числе точек интегрирования. Число точек интегрирования по каждой координате может быть различным, однако, как правило, предпочитают выбирать их равными. Установление порядка интегрирования представляет важную задачу. Если порядок интегрирования принимается слишком высоким, то возрастает время счёта. Слишком малый порядок интегрирования ведёт к потере точности, при этом ошибка может быть настолько большой, что решение получается бессмысленным или вообще не существует.  При использовании полиномиальных функций формы интеграл (1.1) может быть представлен следующим образом:  ∫  Ωξ  ΘΩξ(ξ)γΩξ(ξ)dξ, (1.2)  где ΘΩξ(ξ) обозначает полиномиальную часть подынтегральной функции, которая может быть точно проинтегрирована. Если мак 163    Численное интегрирование в р-версии МКЭ  симальная степень полного полинома в функции формы равна p, значит, выражение BTψDBψ в (1.1) имеет степень 2(p− 1).  Не полиномиальную часть γΩξ(ξ) составляет якобиан J, который не может быть проинтегрирован точно.  Число точек интегрирования при использовании квадратур Гаусса-Лежандра можно определять как  nG =  [ 3p− 2  2  ] × . . .×  [ 3p− 2  2  ]  ︸ ︷︷ ︸ d  , (1.3)  где p – максимальная степень в конечном элементе. С точки зрения вычислительных затрат интегрирование по трёхмерной области (d = 3) по схеме Гаусса-Лежандра требует O(n3G) вычислений значений функций и для элементов высокого порядка становится существенным.  2 Вычисление матриц жёсткости  Рассмотрим вычисление типичного элемента матрицы жёсткости:  Aij = Dij  ∫  Ωx  ( ∂ψi ∂x  )T ( ∂ψj ∂x  ) dΩx = (2.1)  = Dij  ∫  Ωξ  ( ∂ψi ∂ξ  ∂ξ  ∂x  )T ( ∂ψj ∂ξ  ∂ξ  ∂x  ) detJ(ξ)dΩξ =  =  ∫  Ωξ  { ∂ψi ∂ξ1  ∂ψj ∂ξ1  K11 + ∂ψi ∂ξ1  ∂ψj ∂ξ2  K12 + . . .+ ∂ψi ∂ξ3  ∂ψj ∂ξ3  K33  } dΩξ,  где ψi и ψj – i-я и j-я функции формы соответственно; Dij – постоянная для данного материала матрица упругости;  Klm(ξ) = Dij  3∑  i=1  ∂ξi ∂xl  ∂ξi ∂xm  detJ(ξ), l,m = 1, 2, 3. (2.2)  164    С.П. Копысов, И.В. Красноперов  Использовав субпараметрические элементы и соответствующее отображение x(ξ), выражение (1.3) можно переписать в виде  Aij = Dij  ∫  Ωξ  Θ(ξ)γ(ξ)dΩξ,  где  Θ(ξ) = ∂ψi ∂ξl  ∂ψj ∂ξm  , γ(ξ) = ∂ξl ∂xk  ∂ξm ∂xk  detJ(ξ).  Здесь ∂ξl /∂xk – производная обратного отображения ξ(x). Подынтегральная функция γ(ξ) не может быть точно проинтегрирована. Поэтому будем аппроксимировать её полиномиальными базисными функциями, тогда для Klm(ξ) можно записать  γ(ξ) = Klm(ξ) ≈ 8∑  i=1  klmnψn, (2.3)  где ψi – стандартные линейные базисные функции. Для вычисления интеграла (2.1) необходимо вычислить толь ко коэффициенты интерполяции klmn, которые найдем из соотношения  klmn =  [ ∂ξi ∂xl  ∂ξj ∂xm  detJ  ] (ξ1n, ξ2n, ξ3n), n = 1, 8,  так как ψn принимают значение единица в данном узле и нуль – в остальных семи. Значения detJ и ∂ξi /∂xl , ∂ξj /∂xm (элементы матрицы, обратной к матрице Якоби) также известны во всех узлах элемента. Подставив (2.3) в выражение (2.1), получим  Aij =  ∫  Ωξ  { 8∑  n=1  3∑  l=1  3∑  m=1  klmn ∂ψi ∂ξl  ∂ψj ∂ξm  ψn  } dΩξ =  = 8∑  n=1  3∑  l=1  3∑  m=1  klmn  ∫  Ωξ  ∂ψi ∂ξl  ∂ψj ∂ξm  ψn dΩξ  ︸ ︷︷ ︸ ρijlmn  ,  165    Численное интегрирование в р-версии МКЭ  где ρijlmn определяют интегралы, которые могут быть вычислены заранее, и тогда элементы матрицы жесткости  Aij = 8∑  n=1  3∑  l=1  3∑  m=1  klmnρijlmn.  3 Оценка вычислительных затрат  Оценим вычислительные затраты, необходимые для получения решения задач теории упругости по p-версии МКЭ с использованием иерархических аппроксимаций.  Заранее вычисленные интегралы в разработанной программе хранятся в файлах. Хранимые данные распределяются по файлам в зависимости от максимальной степени используемых базисных функций, т. е. от текущего порядка элемента: интегралы, необходимые для построения матриц жёсткости элементов p-го порядка, записаны в p-й файл. Пока предусмотрено повышение порядка до пятого, но благодаря иерархичности базисных функций и такому способу хранения данных список файлов и порядков может быть продолжен.  Таким образом, в затраты входят: во-первых, место на носителе информации, занимаемое файлами со значениями интегралов, а это порядка 4.5Mb, если каждое значение имеет пятнадцать знаков после запятой; во-вторых, место в оперативной памяти, куда считываются эти данные, примерно 1.6Mb. Между тем выигрыш по времени получился существенным. На рис. 1 представлен график относительных затрат интегрирования по Гауссу-Лежандру к сокращенному алгоритму интегрирования.  В случае сокращенного интегрирования также имеется возможность неоднородного повышения порядка элементов, входящих в рассматриваемую область. При этом, если на каком-то элементе порядок повышается, например, до второго, то степень рёбер смежных с ним элементов автоматически повысится до второй. То же самое имеем и для граней. Благодаря этому можно избежать излишних вычислений, если знать максимальный порядок, до которого следует повышать порядок каждого конкретного элемента. Такой подход значительно сокращает затраты на апостериорную оценку погрешности.  166    С.П. Копысов, И.В. Красноперов  Рис. 1: Относительные вычислительные затраты  4 Численные примеры В первом тестовом примере исследовалось нагружение закрепленной балки прямоугольного сечения распределенной нагрузкой по торцу свободного конца (рис. 2). Рассматривалось влияние формы элемента и порядка аппроксимации на точность решения (u – точное решение). На рис. 3 приведены результаты сравнения. Следует отметить существенное влияние формы элемента, характеризуемое отношением b/a, на результаты по h-версии МКЭ (p = 1) и слабую зависимость при увеличении порядка (p = 5). Расчеты с использованием сокращенного интегрирования показали, что результаты совпадают только для случая элементов всех порядков и правильной формы.  Во втором тестовом примере рассматривалась 1/8 часть полой сферы, нагруженной внутренним давлением и свободной наружной поверхностью. Задача также имеет аналитическое решение.  На рис. 4 приведена конечно-элементная сетка, аппроксимирующая сферу шестью элементами.  Сравнение результатов расчетов c интегрированием по Гауссу и сокращенному алгоритму интегрирования для p-версии МКЭ с однородным повышением порядка (p = 1 . . . 5) c аналитическим решением представлено на рис. 5 – 7. Как видно из рисунков, решение, полученное по модифицированному алгоритму, незначительно уступает в точности, но даёт существенную экономию времени.  167    Численное интегрирование в р-версии МКЭ  Рис. 2: Схема балки  Рис. 3: Перемещения конца балки  Рис. 4: Конечно-элементная сетка  Рис. 5: Сравнение результатов расчетов при p = 1 с точным решением  168    С.П. Копысов, И.В. Красноперов  Рис. 6: Сравнение результатов расчетов при p = 3 с точным решением  Рис. 7: Сравнение результатов расчетов при p = 5 с точным решением  5 Заключение  При использовании полиномиальных функций формы интегралы для вычисления матрицы жёсткости и вектора правой части представлены в виде произведения полиномиальной части подынтегральных функций, которые могут быть легко точно проинтегрированы, и не полиномиальной части, которые не могут быть проинтегрированы точно. Вторая часть аппроксимировалась полиномиальными базисными функциями. В результате подынтегральная функция представляется как набор интегралов, который может быть точно вычислен заранее один раз и хранится, и части, которая зависит от геометрии конкретного элемента.  Полученные результаты показали, что время формирования матриц жесткости сокращается в десятки раз. По точности решений, полученных по рассматриваемому алгоритму, судя по тестовым примерам, можно сказать следующее: если решение ищется на сетке, элементы которой имеют грани, параллельные осям в прямоугольной системе координат, то решения, найденные с использованием квадратур Гаусса и сокращенного интегрирования, имеют одинаковую точность. В случае сильно искривлённых элементах последний алгоритм значительно уступает в точности, но при этом имеет возможности улучшения точности, например, за счёт увеличения числа точек интерполяции рациональной части  169   