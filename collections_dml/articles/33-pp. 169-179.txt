 ИСПОЛЬЗОВАНИИ ДИНАМИЧЕСКИХ СЕТОК ПРИ РЕШЕНИИ ЗАДАЧ КОНВЕКЦИИ-ДИФФУЗИИ1  И. В. Капырин  Институт вычислительной математики РАН, г. Москва  Введение  В настоящей работе рассматривается трехмерная задача конвекции-диффузии, возникающая при моделировании переноса примесей в пористых средах. Для ее численного решения применяется конечно-элементный метод, предложенный Ж. Жаффре (INRIA), особенностью которого являются разные способы аппроксимации для эллиптической и гиперболической частей пространственного оператора: конвективный член вычисляется явно, диффузионный — схемой Кранка – Николсон. Для обеспечения устойчивости по отношению к сеточному числу Пекле используется технология “вверх по потоку” (upwind). К достоинствам метода относятся: консервативность благодаря непрерывности как конвективных, так и диффузионных потоков; формально второй порядок точности по времени и по пространству; решение на каждом шаге по времени одной глобальной линейной системы с симметричной положительно определенной матрицей; приемлемые ограничения на устойчивость τ ∼ h (по сравнению с полностью явными схемами, где τ ∼ h2). Аппроксимация базируется на неструктурированных тетраэдральных сетках, что позволяет учитывать сложную геометрию расчетных областей, локально измельчать и загрублять сетку. Предлагается технология автоматического перестроения сетки в зависимости от поведения решения, что позволяет сократить общее время работы программы в силу меньшего числа неизвестных в системе, получить более высокую точность в областях, где решение быстро изменяется, например, в задачах о движении фронтов концентрации.  1Работа выполнена при частичной финансовой поддержке РФФИ, проект № 04-07-90336, и программы ОМН РАН “Вычислительные и информационные проблемы решения больших задач”  169    Об использовании динамических сеток . . .  1 Постановка задачи и численный метод ее решения  1.1 Задача конвекции-диффузии Пусть Ω — ограниченная полиэдральная область в R3 с гра ницей ∂Ω. Рассмотрим следующую модельную задачу (для простоты изложения приняты однородные граничные условия типа Дирихле):  ∂C  ∂t −∇ ·D∇C +~b · ∇C = f в Ω × (0, T ),  C = 0 на ∂Ω × (0, T ), (1.1) C = g0(x) при t = 0.  Здесь C — концентрация загрязнителя, ~b — бездивергентное векторное поле конвективного потока, f ∈ L2(Ω) — функция источников или стоков, D(x) — симметричный положительно определенный тензор диффузии. Обозначим через (·, ·)S скалярное произведение в L2(S), причем (·, ·) ≡ (·, ·)Ω. Введем пространства  V = L2(Ω), W = H(div,Ω) = {~w ∈ (L2(Ω))3 : ∇~w ∈ L2(Ω)},  а также новую переменную ~r — диффузионный поток. Тогда можно переформулировать задачу (1.1) в слабой смешанной постановке: найти такую пару (~r, C) ∈W × V , для которой  ( ∂C  ∂t , v  ) + (∇~r, v) +  ( ~b · ∇C, v  ) = (f, v) ∀v ∈ V,  ( D−1~r, ~w  ) − (C,∇~w) = 0 ∀~w ∈W.  (1.2)  1.2 Дискретизация задачи Пусть εh — конформное разбиение Ω на тетраэдры. Введем на  сетке εh конечно-элементные пространства Vh ⊂ V и Wh ⊂ W . Пусть Vh — пространство функций, разрывных на гранях тетраэдров и линейных внутри них (разрывные конечные элементы). Ограничение Wh ⊂W означает для любой внутренней грани непрерывность нормальной составляющей вектора ~w из Wh. Простейшим представителем Wh является пространство RT0(Ω, εh) Равьяра – Тома низшего порядка [2], базисные функции которого  170    И. В. Капырин  линейны внутри тетраэдров, имеют единичный поток через одну из граней сетки и нулевой — через все остальные. Концентрация C и поток ~r аппроксимируются в пространствах Vh и Wh соответственно. Смешанная конечно-элементная постановка задачи (1.2) имеет вид  ∑  E∈εh  ( ∂C  ∂t , v  )  E  + ∑  E∈εh  (∇~r, v)E + ∑  E∈εh  ( ~b · ∇C, v  ) E  =  = ∑  E∈εh  (f, v)E ∀v ∈ Vh, ( D−1~r, ~w  ) − (C,∇~w) = 0 ∀~w ∈Wh.  Шаг предлагаемой схемы по времени состоит из трех подшагов (переменные интегрирования, объем dx и площадь ds в дальнейшем опускаются):  I.  ∫  E  Cn+1/2 − Cn ∆t/2  m+  ∫  E  ( 3  2 div ~rn −  1  2 div ~rn−1  ) m−  ∫  E  ~bCn · ∇m+  +  ∫  ∂E  ~bCnin · ~nm = ∫  E  fnm ∀m ∈ Vh (E) ∀E ∈ εh; (1.3a)  II.  ∫  E  C∗ − Cn ∆t  m+  ∫  E  div ~rn + div ~rn+1  2 m−  ∫  E  ~bCn+1/2 · ∇m+  +  ∫  ∂E  ~bC n+1/2 in or out · ~nm =  ∫  E  fn+1/2m ∀m ∈ Vh (E) ∀E ∈ εh, (1.3b)  ∫  Ω  D−1 ~rn + ~rn+1  2 ~w −  ∫  Ω  Cn + C∗  2 div ~w = 0 ∀~w ∈Wh. (1.3c)  III. Ограничитель наклона C∗ −→ Cn+1.  Здесь Vh(E) — сужение Vh на тетраэдр E. На шаге (1.3a) явно вычисляется промежуточная концентрация, которая в (1.3b) используется для нахождения конвективных членов. На шаге (1.3b) – (1.3c) применяется явная схема по времени для аппроксимации конвективной части оператора и схема Кранка – Николсон для диффузионной части. При этом для стабилизации схемы в  171    Об использовании динамических сеток . . .  конвективном члене используется технология “вверх по потоку”  (upwind), то есть в интеграле по грани концентрация C n+1/2 in or out бе рется с того тетраэдра, у которого конвективный поток в направлении внешней нормали к данной грани положителен. Для реализации шага (1.3b) – (1.3c) воспользуемся разложением пространства Vh(E) на ортогональные подпространства: Vh(E) = V  0(E)⊕ ⊕Ṽ 1(E), где V 0(E) — константы на элементе E, а Ṽ 1(E) — линейные на E функции с нулевым средним. Тогда второй шаг распадается на два подшага:  IIa.  ∫  E  C̄∗ − C̄n ∆t  v +  ∫  E  div ~rn + div ~rn+1  2 v +  ∫  ∂E  ~bC n+1/2 in or out · ~nv =  =  ∫  E  fn+ 1 2 v ∀v ∈ V 0 (E) ∀E ∈ εh; (1.4a)  ∫  Ω  D−1 ~rn + ~rn+1  2 ~w −  ∫  Ω  C̄n + C̄∗  2 div ~w = 0 ∀~w ∈Wh; (1.4b)  IIb.  ∫  E  C̃∗ − C̃n ∆t  ṽ − ∫  E  ~bCn+1/2 · ∇ṽ + ∫  ∂E  ~bC n+1/2 in or out · ~nṽ =  =  ∫  E  fn+ 1 2 ṽ ∀ṽ ∈ Ṽ 1 (E) ∀E ∈ εh. (1.4c)  В силу определения пространства Wh диффузионные потоки не входят в (1.4c). Шаг (1.4c) выполняется локально по тетраэдрам с возможным использованием данных из соседних тетра эдров (C n+1/2 in or out). В (1.4c) C̃  ∗ и C̃n — ортогональные константе линейные составляющие концентраций C∗ и Cn.  В уравнениях (1.4a), (1.4b) C̄ — средняя концентрация на тетраэдре. Система (1.4a), (1.4b) представляет собой стандартную постановку метода смешанных конечных элементов (МСКЭ). Гибридизация и исключения неизвестных [3] приводят к линейной системе с симметричной положительно определенной матрицей, размерность которой равна числу граней в сетке. После решения этой системы методом сопряженных градиентов с переобуславливателем восстанавливаются значения C̄ и ~r на каждом тетраэдре.  172    И. В. Капырин  На третьем подшаге схемы (1.3a) – (1.3c) к полученному решению C∗ для стабилизации применяется ограничитель наклона — лимитер [4]. Более подробно численный метод (1.3) – (1.4) описан в [1].  2 Применение динамических сеток  2.1 Технология перестроения сетки Для учета особенностей решения требуется локально измель чать сетку. При этом в областях, где решение близко к линейному, нет необходимости в мелкой сетке. Используемый алгоритм позволяет автоматически измельчать и загрублять сетку с течением времени в требуемых областях.  Перестроение сеток осуществляется с помощью алгоритма отмеченного ребра [5] (реализация В.Н. Чугунова). Он обладает следующими достоинствами:  • умеренным ростом числа элементов сетки на каждом уровне разбиения; число тетраэдров вырастает не более, чем вдвое;  • применимостью как в трехмерном, так и в двумерном пространствах; в любом случае перестроение сетки основано на разбиении одного элемента на два более мелких;  • сохранением свойства регулярности сетки;  • возможностью загрубления ранее измельченной сетки.  Воспользовавшись независимостью от размерности пространства, проиллюстрируем один цикл перестроения сетки с помощью алгоритма отмеченного ребра в двумерном случае (рис. 1). Пусть задана исходная конформная грубая сетка и отмечены ее элементы, которые требуется измельчить (рис. 1, слева). Присвоим всем элементам этой сетки уровень 1. Разбиение элемента с уровнем i дает два элемента с уровнем i + 1. Сначала разбиваются отмеченные элементы с наименьшим уровнем (рис. 1, центр). На следующем шаге восстанавливается конформность сетки (рис. 1, справа), т. е. измельчаются те элементы, которые содержат ребро, разделенное пополам. Затем производится разбиение элементов со следующим наименьшим уровнем, и снова восстанавливается  173    Об использовании динамических сеток . . .  Рис. 1: Разбиение методом отмеченного ребра  Рис. 2: Разбиение элемента ABCD на тетраэдры ABED и EBCD  конформность сетки. Процесс продолжается до тех пор, пока все отмеченные элементы не будут измельчены.  Сетка строится иерархически, каждый элемент имеет свой уровень. Два элемента, полученные в результате одного разбиения, несут информацию друг о друге, что делает возможным обратное загрубление сетки.  2.2 Перенос решения с одной сетки на другую После перестроения сетки требуется определить на ней но вые значения концентраций C, средних концентраций на гранях λ (требуются в МСКЭ) и диффузионных потоков ~r. При измельчении сетки процедура переноса решения включает следующие действия (см. рис. 2).  • Для концентрации C берется ее след на новой сетке (C —  174    И. В. Капырин  линейная функция внутри тетраэдра, CE = (CA + CC)/2);  • По средним значениям концентрации на гранях λ восстанавливается линейный интерполянт на каждом тетраэдре. На границе двух разбиваемых тетраэдров λ находится как след полусуммы интерполянтов с этих тетраэдров в центрах масс новых граней (грани ADE, ABE, BEC, DEC). Для грани BED, возникающей внутри тетраэдра, значение λ принимается равным следу интерполянта в ее центре масс;  • Новые диффузионные потоки ~r находятся как след потоков, определенных на старой сетке в пространстве Равьяра – Тома.  При загрублении сетки новые переменные восстанавливаются следующим образом:  • Сначала концентрация в точках A и С переносится с тетраэдров ABED и EBCD соответственно; в точках B и D берется полусумма концентраций с этих тетраэдров. Затем вычисляется поправка, необходимая для сохранения среднего значения концентрации в элементе ABCD, и равномерно распределяется по его вершинам;  • λ на гранях ABC и ACD вычисляется как полусумма средних концентраций на гранях ABE, BEC и ADE, DEC соответственно;  • Диффузионные потоки восстанавливаются так же, как и λ.  3 Результаты вычислительных экспериментов  3.1 Задача о переносе фронта концентрации от границы  Расчетной областью является прямоугольный параллелепипед Ω̄ = [0; 80] × [−20; 20] × [−20; 20], тензор диффузии D = 10−7I, ~b = (1; 0; 0). Начальная концентрация в Ω нулевая. На всех границах заданы условия типа Дирихле:  C =  { 1 при x = 0, ‖y‖ < 5, ‖z‖ < 5, 0 на остальных границах.  175    Об использовании динамических сеток . . .  Рис. 3: Перенос фронта на равномерной сеткe, t = 30  Для решения задачи использовались статическая равномерная сетка (∼ 400000 тетраэдров, ∼ 800000 неизвестных в линейной системе) и динамическая сетка (6 125000 тетраэдров, 6 250000 неизвестных в линейной системе). На рис. 3, 4 представлены графики решения в момент времени t = 30 на сечении плоскостью y = 0. Как видно из рисунков, решение задачи на динамической сетке позволяет при существенно ме́ньшем числе неизвестных получить не менее точное решение задачи переноса фронта, чем на статической равномерной сетке. Время работы программы на динамической сетке составляет 34 мин., на равномерной сетке — 112 мин. (Intel Pentium D, 2.6 GHz).  3.2 Задача о вращении пятна Задача (1.1) ставится в области Ω̄ = [0; 1] × [0; 0.5] × [0; 1],  тензор диффузии D = 10−7I, поле конвективных потоков ~b = = (z − 0.5; 0;−(x − 0.5)). В качестве начальных условий берется гладкий “всплеск” с центром в точке (0.75; 0.25; 0.5):  g0(x) =      cos(5π(x− 0.75)) cos(5π(y − 0.25)) cos(5π(z − 0.5)) при (x; y; z) ∈ [0.65; 0.85] × [0.15; 0.35] × [0, 4; 0.6];  0 в ином случае. Требуется найти решение на промежутке времени [0; 2π], за  который “всплеск” делает полный оборот вокруг оси x = z = = 0.5. По степени уменьшения максимума концентрации в реше 176    И. В. Капырин  Рис. 4: Перенос фронта на динамической сетке, t = 30  нии можно судить о численной диффузии, так как физическая диффузия очень мала. На динамической сетке максимум концентрации падает до 0.72, на статической — до 0.63.  Рис. 5: Вращение “всплеска”, равномерная сетка  На рис. 5, 6 представлены изолинии решения и ребра сетки на сечении плоскостью y = 0 в начальный и конечный моменты времени. Равномерная сетка (рис. 5) содержит 98304 тетраэдра, динамическая (рис. 6) — не более 45000 тетраэдров. Изолинии  177    Об использовании динамических сеток . . .  Рис. 6: Вращение “всплеска”, динамическая сетка  соответствуют уровням концентрации от 1/6 до 5/6 с шагом 1/6. Время работы программ: 66 мин. на динамической сетке (∆t = = 0.005); 85 мин. на равномерной сетке (∆t = 0.01).  Литература  1. Василевский Ю.В., Капырин И.В. Параллельное трехмерное моделирование распространения примесей в пористых средах // Матричные методы и технологии решения больших задач. – М.: ИВМ РАН, 2005. – С. 33–50.  2. Brezzi F., Fortin M. Mixed and hybrid finite element methods. – New York: Springer Verlag, 1991.  3. Chen Z. Equivalence between and multigrid algorithms for nonconforming and mixed methods for second-order elliptic problems // East-West J. of Numerical Mathematics. – 1996. – V. 4. – P. 1–33.  4. Siegel P., Mose R., Ackerer Ph., Jaffre J. Solution of the advection-diffusion equation using a combination of discontinuous and mixed finite elements // Int. J. for Numerical Methods in Fluids. – 1997. – V. 24. – P. 595–613.  178   