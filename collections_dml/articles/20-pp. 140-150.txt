.  ПРИМЕНЕНИЕ ЯВНЫХ РАЗНОСТНЫХ СХЕМ ПРИ РЕШЕНИИ ЗАДАЧИ О НЕПРЕРЫВНОЙ  ВЫПЛАВКЕ СТАЛИ 1  Р.Ф. Кадыров, A.В. Лапин Казанский государственный университет, г. Казань  1 Введение  Задача об охлаждении слитка стали в процессе непрерывной выплавки моделируется задачей Стефана с предписанной конвекцией [1, 2]. Теоремы существования и единственности для таких задач доказаны в [3]. При численном решении традиционно используются полностью неявные схемы или неявные схемы с аппроксимацией по характеристикам оператора переноса (см. [4–6] и библиографию этих работ). Эти схемы безусловно устойчивы, однако для их численной реализации используются итерационные методы типа метода верхней релаксации, обладающие невысокой  1Работа выполнена при поддержке РФФИ, проект № 01-01-00068  141    Применение явных разностных схем . . .  скоростью сходимости. Ускорение вычислений производится за счет применения методов декомпозиции области [7,8] и/или многосеточных процедур.  Как известно, явные схемы с постоянным шагом обладают лишь условной устойчивостью, что существенно сужает область их применения при решении прикладных задач. В то же время в работах [9–11] предложены эффективные алгоритмы на основе явных схем с переменными шагами для решения как линейных, так и нелинейных нестационарных задач. В настоящей заметке изложены результаты применения явных схем с переменными шагами к нестационарной нелинейной задаче о непрерывной выплавке стали.  2 Постановка краевой задачи  Пусть Ω ∈ R2 – прямоугольник [0, Lx] × [0, Ly] с закругленным нижним левым углом, радиус закругления R > 0, Ω = Ω ∪ ∂Ω. Пусть далее V = Ω × (0, Lz) – трехмерная область с границей Γ = ∂V , состоящей из частей:  Γ0 = Ω× {0} , ΓN = {(x, y) ∈ ∂Ω : x = 0 ∨ y = 0} × (LM , Lz] ∪ Ω× {Lz} , ΓS = {(x, y) ∈ ∂Ω : x 6= 0 ∧ y 6= 0} × (0, Lz] , ΓM = {(x, y) ∈ ∂Ω : x = 0 ∨ y = 0} × (0, LM ] ,  где 0 6 LM < Lz.  G 0  GN  GN  GM  GM  Рис. 1: Область и границы  142    Р.Ф. Кадыров, A.В. Лапин  В рассматриваемой прикладной задаче область V занята металлическим слитком (или расплавом), при этом Ω – четверть поперечного сечения слитка, Lz – его длина, в то время как LM – длина зоны первичного охлаждения слитка.  Определению подлежит температурное поле слитка по прошествии некоторого времени t > 0 с момента начала охлаждения. Температура T = T (x, y, z, t) задана в каждой точке (x, y, z) в любой момент времени t ∈ [0, Tf ] (Tf – время окончания процесса выплавки).  Определим функцию энтальпии H (T ) и температуру Кирхгофа K (T ) следующим образом:  H (T ) = ρ     T∫  0  c (ξ) dξ + L (1− fs (T ))    , K (T ) =  T∫  0  k (ξ) dξ ,  где ρ, c(T ), k(T ) и L – плотность, теплоемкость, теплопроводность и скрытая теплота плавления, fs (T ) – жидкая фракция для температуры T :  fs (T ) =  { 1, T > Ts, 0, T < Tl.  Здесь Ts – температура плавления, Tl – температура кристаллизации. На приведенных ниже рисунках изображены примеры графиков для функций энтальпии и температуры Кирхгофа. Отметим монотонную непрерывную зависимостьH = H(T ), это позволяет определить также обратную функцию T = T (H).  1100 1200 1300 1400 1500 1600 5  5.5  6  6.5  7  7.5  8  8.5  9  9.5  10 x 10  6 Enthalpy  Temperature (C0)  H (T  )  (k  J/ m  3 )  1100 1200 1300 1400 1500 1600 30  35  40  45  50  55  60 Kirchhoff’s transformation  Temperature (C0)  K (T  )  (k  W /m  )  Рис. 2: График H(T ) Рис. 3: График K(T )  143    Применение явных разностных схем . . .  Задача о непрерывной выплавке стали моделируется следующей начально-краевой задачей:      ∂H (T )  ∂t + v  ∂H (T )  ∂z −∆K (T ) = 0 в V × (0, Tf ] ,  T = T0 на Γ0 × (0, Tf ] , ∂K (T )  ∂n + h (T − Tw) + σε  ( T 4 − T 4ext  ) = 0  на ΓN × (0, Tf ] ,  ∂K (T )  ∂n = Q на ΓM × (0, Tf ] ,  T (x, y, z, 0) = T 0 в V.  (2.1)  Здесь: n – единичный вектор нормали к границе ∂V , σ > 0 – постоянная Стефана-Больцмана, ε > 0 – коэффициент эмиссии, v > 0 – скорость проката, h = h (x, y, z, t) и Q = Q (x, y, z) – заданные функции охлаждения, Tw = Tw (x, y, z) и Text = Text (x, y, z) – заданные функции, соответствующие температуре охлаждающей жидкости и внешней среды, Tf – время окончания процесса выплавки.  Систему (2.1) будем называть температурной постановкой задачи. Наряду с ней будем рассматривать так называемую энтальпийную постановку:      ∂H  ∂t + v  ∂H  ∂z −∆K (H) = 0 в V × (0, Tf ] ,  H = H(T0) на Γ0 × (0, Tf ] , ∂K (H)  ∂n + h (T (H)− Tw) + σε  ( T 4 (H)− T 4ext  ) = 0  на ΓN × (0, Tf ] ,  ∂K (H)  ∂n = Q на ΓM × (0, Tf ] ,  H (x, y, z, 0) = H0 в V.  (2.2)  В (2.2) искомой функцией является энтальпия H.  144    Р.Ф. Кадыров, A.В. Лапин  3 Сеточная задача и ее решение  Пусть для некоторого ε > 0 известно значение τ = τ (ε), такое, что  ∂H  ∂t + v  ∂H  ∂z = H − H̃ τ  + ω (t) , с ‖ω (t) ‖ 6 ε ∀t : 0 6 t < t+ τ 6 Tf ,  где H̃ = H (x, y, z − vτ, t− τ). Это означает, что при данном τ выполняется локальная ε-аппроксимация оператора ∂H/∂t+v∂H/∂z в некоторой выбранной норме ‖ · ‖.  Запишем задачу в слабой (интегральной) постановке:  1  τ  ∫  V  ( H (T )− H̃  ) τηdx+  ∫  V  ∇K (T ) · ∇ηdx+  +  ∫  ΓN  { h (T − Tw) + σε  ( T 4 − T 4ext  )} ηdΓN = 0,  ∀η ∈ V 0 = { v ∈ H1 (V ) : η|Γ0 = 0  } .  (3.1)  Здесь H1 (V ) – пространство Соболева первого порядка. Далее, разобьем область Ω на четырехугольные конечные эле менты и построим на ней сетку, топологически эквивалентную прямоугольной. Сетка на V является тензорным произведением сетки на Ω и неравномерной сетки на [0, Lz]. Запишем конечноэлементную аппроксимацию задачи (3.1). Пусть Vh – конечноэлементная аппроксимация пространства H1(V ), основанная на полилинейных элементах. Далее через wh будем обозначать Vhаппроксимацию функции w, для непрерывной функции w – это ее Vh-интерполянт. Пусть V  T0 h = {vh ∈ Vh (V ) : vh = T0h на Γ0},  V 0h = {vh ∈ Vh (V ) : vh = 0 на Γ0}. Тогда аппроксимация задачи (3.1) определяется так:  1  τ  ∫  V  ( Hh (Th)− H̃h  ) ηdx+  ∫  V  ∇Kh (Th) · ∇ηdx+  +  ∫  ΓN  { h (Th − Tw,h) + σε  (( T 4 ) h − ( T 4ext  ) h  )} ηdΓN = 0,  ∀η ∈ V 0h .  (3.2)  145    Применение явных разностных схем . . .  Задача (3.2) эквивалентна следующей системе нелинейных алгебраических уравнений (здесь и далее для сеточных и непрерывных функций будем использовать одни и те же обозначения, предполагая, что из контекста будет ясно, о какой именно функции идет речь):  H (T )− H̃ τ  +AK (T ) +B (h) (T − Tw) +B ( T 4 − T 4ext  ) = 0. (3.3)  Здесь: A – дискретный оператор Лапласа, в данной конечноэлементной реализации ему соответствует 11-диагональная матрица; B,B (h) – диагональные матрицы с разреженной главной диагональю.  В энтальпийной постановке система (3.3) будет выглядеть следующим образом:  H − H̃ τ  +AK (H) +B (h) (T (H)− Tw)+  +B ( T (H)  4 − T 4ext ) = 0.  (3.4)  Далее будем рассматривать конечноэлементную аппроксимацию задачи в ее энтальпийной постановке, т. е. систему (3.4). Обозначим  f (H) = AK (H) +B (h) (T (H)− Tw) +B ( T (H)  4 − T 4ext ) .  Тогда явный метод Эйлера для данной задачи примет вид  Hk+1 = Hk − τk+1f ( Hk ) , H0 = H  ( T 0 ) , k = 0, 1, 2, . . . (3.5)  Здесь τk – временные шаги, Hk = H  ( t =  k∑ i=1  τ i )  – приближенное  решение на момент времени t. Производная Фреше отображения f (H) имеет вид  J(H) = A ◦K ′(H) +B (h) ◦ T ′(H) + 4B ◦ ( T 3(H)T ′(H)  ) .  Пусть (λ, ξ) – собственная пара оператора J , тогда  ( K ′ +A−1B (h)T ′ + 4A−1BT 3T ′  ) ξ = λmaxA  −1ξ.  146    Р.Ф. Кадыров, A.В. Лапин  Здесь и далее опускаем аргументH у функций T , T ′ иK ′. Нетрудно получить следующие оценки:  (K ′ξ, ξ) + ( A−1B (h)T ′ξ, ξ  ) + 4  ( A−1BT 3T ′ξ  ) 6  6 ( LHKλ  A max  ) ( A−1ξ, ξ  ) + 4  ( A−1BT 3T ′ξ,BT 3T ′ξ  ) ( A−1ξ, ξ  )1/2 +  + ( A−1B (H)T ′ξ,B (H)T ′ξ  )1/2 ( A−1ξ, ξ  )1/2 6  6  ( LHKλ  A max + cond(A)  1/2LHT ‖B (h)‖+  +4 cond(A)1/2LHT L H T 3  ) ( A−1ξ, ξ  ) .  Отсюда получим верхнюю оценку для максимального собственного числа оператора J :  λmax 6 L H Kλ  A max + cond (A)  1/2 LHT ‖B (h)‖+ 4 cond (A)  1/2 LHT L  H T 3 .  Здесь  • λAmax – максимальное собственное число оператора A;  • cond (A) = λAmax/λAmin – число обусловленности оператора A;  • LHK = sup H∈[H(0),H(Ts)]  K ′ (H);  • LHT = sup H∈[H(0),H(Ts)]  K ′ (H);  • LHT 3 = sup H∈[H(0),H(Ts)]  T 3 (H).  При шаге τk = τ0 получим явный метод Эйлера с постоянным шагом. Условие аппроксимации в этом случае определяется величиной τ : τ0 6 τ . Для устойчивости же требуется τ0 6 cou, где число Куранта определено равенством cou = 2/λmax. Как видим, последнее условие при большой величине λmax является довольно жестким и может потребовать слишком большого количества шагов явного метода.  147    Применение явных разностных схем . . .  Пусть теперь { τk }N−1 k=0  – цикл из N шагов явного метода Эй лера (3.5). Пусть также lN = ∑N−1 k=0 τ  k – суммарный шаг этого цикла. В работе [9] показано, что оптимальным выбором шагов τk в смысле максимума величины lN , исходя из условий аппроксимации и устойчивости суммарного цикла, являются значения, обратные корням полинома Чебышева, которые могут быть найдены по приведенной ниже схеме. Обозначим:  • g = τ/ cou;  • θ = λmax +m λmax −m  > 1, где 0 6 m 6 λmax – некий параметр,  подлежащий определению;  • α = θ−1;  • h0 = (1 + α) cou /2;  • β0 = cos[π/(2N)];  • κN = (j0, j1, . . . , jN−1) – перестановка индексов (0, 1, . . . , N − 1), гарантирующая устойчивость чебышевского итерационного процесса (алгоритм нахождения такой перестановки определен в [9] для случаев N = 2p, N = 2p3q);  • βk = cosπωk;  • ωk = (2jk − 1) /(2N).  Тогда значения шагов могут быть найдены по формуле  τk = h0  1− αβk , k = 0, 1, . . . , N − 1. (3.6)  Очевидно следующее соотношение:  τmax = max k  τk ≡ h 0  1− αβ0 . (3.7)  Условие аппроксимации на каждом шаге цикла будет выполнено, если  τmax 6 τ. (3.8)  148    Р.Ф. Кадыров, A.В. Лапин  Осталось определить параметры α (следовательно, и m) и N . Использовав (3.7), (3.8) для предельного случая (α = 1), получим нижнюю оценку для длины цикла N :  N =  [ π  4 (arcsin  1√ 2g  )−1 ] ,  где [a] означает целую часть a. Из соотношения (3.8) определим значение α:  α = 2g − 1  2gβ0 + 1 .  Особенность конкретной реализации заключается в следующем. Нами решалась задача непрерывной выплавки, к исходной постановке которой (2.2) была добавлена необходимость выдавать решение через каждые τ < τf ¿ Tf единиц времени. Таким образом, возникла необходимость сконструировать цикл временных  шагов { τk }N−1 k=0  так, чтобы lN ≈ τf . Мы действовали следующим образом. Очевидно, что при фиксированном значении N суммарный шаг для цикла, определенного по формуле (3.6), растет с увеличением значения τ – максимального шага цикла. Таким образом, задав вместо условия τ 0 = τ условие τ0 ∈ [τ− M τ, τ ] так, чтобы при неком фиксированном N выполнялось соотношение: lN (τ− M τ) 6 τf 6 lN (τ), мы можем, применив любой из методов минимизации выпуклой функции, найти такое значение τε, чтобы величина lN (τε) была сколь угодно близка к τf . Величины N = 2p и τ при этом определяли экспериментально. Данная схема не дала теоретического N -кратного выигрыша в вычислительной сложности для циклического явного метода по сравнению с одношаговым, но определенный выигрыш в расчетном времени все-таки присутствовал. В табл. 1 приведено сравнение явной разностной схемы с переменными шагами со стандартным неявным методом Эйлера. Решение возникающей системы уравнений в неявной схеме проводилось методом Гаусса-Зейделя с предварительной ньютоновской линеаризацией. В колонке "Итерации" указаны: для неявной схемы – среднее количество итераций, потребовавшихся для решения соответствующей системы нелинейных уравнений на одном временном слое, для явной – количество шагов в цикле. В колонке "Время итерации" указано среднее время одной итерации в миллисекундах.  149    Применение явных разностных схем . . .  Метод Итерации  Время итерации  (млс) Сетка: 11x17x221 Tf = 1000  Явная схема 8 116  τf = 5 Неявная схема 24 256  Сетка: 8x16x150 Tf = 1000  Явная схема 8 56  τf = 5 Неявная схема 19 107  Сетка: 8x16x150 Tf = 900  Явная схема 4 28  τf = 3 Неявная схема 14 73  Таблица 1: Результаты расчетов  Литература  [1] Laitinen E., Neittaanmäki P. On numerical simulation of the continuous casting problem //J. Eng. Math. – 1987. – V. 22. – P. 335–354.  [2] Louhenkilpi S., Laitinen E., Nieminen R. Real time simulation of heat transfer in continuous casting // Metall. Trans. B. – 1993. – V. 24B. – P. 685–693.  [3] Rodrigues J. F., Yi F. On a two-phase continuous casting Stefan problem with nonlinear flux // Euro J. App. Math. – 1990. – V. 1. – P. 259–278.  [4] Chen Z., Jiang L. Approximation of a two phase continuous casting problem // J. Part. Diff. Equations. – 1998. – V. 11. – P. 59–72.  [5] Laitinen E., Lapin A. Implicit approximation and iterative solution for the continuous casting problem // Preprint, July, 1999, Dep. of Math. Sci., University of Oulu. – 1999. – 17 p.  150   