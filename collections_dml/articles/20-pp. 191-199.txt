 . . .  ИСПОЛЬЗОВАНИЕ ТРЕУГОЛЬНЫХ И ПОПЕРЕМЕННО-ТРЕУГОЛЬНЫХ  ПЕРЕОБУСЛАВЛИВАТЕЛЕЙ ДЛЯ МЕТОДОВ ВАРИАЦИОННОГО ТИПА 1  О.A. Лапшина Южно-Российский региональный центр информатизации  высшей школы, г. Ростов-на-Дону  1 Постановка задачи  При решении различных задач математической физики в движущихся средах двумя базовыми процессами являются конвекция (перенос субстанции за счет движения среды) и диффузия (перемещение молекул). Поэтому, изучая уравнение конвекциидиффузии как модельную задачу, можно получить достаточно много информации о поведении решения конкретных практических задач.  Рассмотрим стационарное уравнение конвекции-диффузии      −Pe−1∆u+ 1 2 {v1ux + v2uy + (v1u)x + (v2u)y} = f,  u(x, y)|∂Ω = 0, div v̄ = 0, v̄ = (v1, v2), (x, y) ∈ Ω = [0, 1]× [0, 1], f = f(x, y), u = u(x, y).  (1.1)  Здесь Pe – безразмерная величина, называемая числом Пекле, ∆ – оператор Лапласа, v̄ = (v1, v2) – вектор скорости. Первое слагаемое в уравнении (1.1) соответствует диффузионному переносу, а остальные – конвективному.  Главная особенность этого уравнения с точки зрения численного решения заключается в несамосопряженности разностного оператора, полученного после аппроксимации непрерывной задачи. Кроме того, задача может иметь и другие особенности, осложняющие решение. Например, увеличив число Пекле, мы получим малый параметр при старшей производной. Поэтому при решении  1Работа выполнена при поддержке РФФИ, проект № 03-01-000050, и про граммы "Университеты России", проект № 03.01.019  192    О.A. Лапшина  подобных задач очень важен как выбор способа аппроксимации непрерывной задачи [1], наиболее подходящий для данного конкретного случая, так и метод численного решения полученной системы уравнений. В данной работе большее внимание уделяется второму вопросу.  2 Конечно-разностная аппроксимация уравнения конвекции-диффузии  Для решения дифференциального уравнения (1.1) воспользуемся методом конечных разностей [1]. Для этого введем равномерную сетку по пространству с шагами hx и hy : ωh = {xi = ihx, yj = = jhy, i = 0, 1, . . . , Nx, j = 0, 1, . . . , Ny, hxNx = 1, hyNy = 1 }. Соответствующая разностная задача получается дискретизацией дифференциальной задачи на сетке ωh согласно [1].  Для аппроксимации первых производных будем использовать центральные разности. Запись уравнения конвекции-диффузии в симметричном виде при центрально-разностной аппроксимации позволит нам сохранить основные свойства дифференциальных операторов этого уравнения.  При естественном упорядочивании узлов сетки перейдем к системе линейных уравнений  Ax = b, (2.1)  где A – несимметричная матрица размерности (N − 1)× (N − 1), x – вектор решений, а b – вектор правой части, полученный в результате аппроксимации правой части и краевых условий задачи (1.1).  В случае центрально-разностной аппроксимации конвективных членов в (1.1) оператор A можно естественным образом представить в виде суммы симметричного положительно определенного оператора A0 и кососимметричного оператора A1. Здесь A0 – разностный аналог оператора Лапласа, описывающий диффузионный процесс в (1.1), а A1 аппроксимирует конвективные члены.  Определение 2.1 [2]. Оператор A называется диссипативным, если его симметричная часть положительно определена.  193    Использование треугольных и попеременно-треугольных . . .  Учитывая результаты из [3], получим, что в результате центрально-разностной аппроксимации имеем диссипативную матрицу. Таким образом, при аппроксимации уравнений в частных производных придем к системе разностных уравнений со специальной матрицей, которая имеет ряд особенностей (разреженность, ленточная структура, большая размерность). Эти характеристики, с одной стороны, облегчают решение указанной задачи, а с другой стороны, требуют создания специальных методов решения, которые бы учитывали специфику задачи.  3 Вариационные итерационные методы  В последнее время как в нашей стране, так и за рубежом широкое распространение получили вариационные итерационные методы или методы подпространства Крылова, как их называют в иностранной литературе, появившиеся в начале 50-х годов прошлого столетия. Этот подход основан на идее минимизации некоторой величины (нормы) в подпространстве Крылова или на условиях ортогональности (биортогональности) векторов к подпространству Крылова.  Определение 3.1. Пространство Km = { r0, Ar0, ..., A  m−1r0 }  называется пространством Крылова m-й размерности, построенным для A и r0 = b−Ax0.  Здесь r0 – начальная невязка. В зависимости от тех условий, по которым строится r, получим один из методов подпространства Крылова.  Эти методы хорошо зарекомендовали себя при решении широкого круга задач математического моделирования, так как обладают следующими важными свойствами: они численно устойчивы (благодаря использованию техники ортогонализации), наиболее выгодны для разреженных матриц большой размерности (так как самой трудоемкой операцией является умножение матрицы на вектор), применимы для решения систем с несимметричными матрицами. На последнее свойство следует обратить особое внимание. Исторически подобные алгоритмы применялись, в первую очередь, для симметричных систем, и лишь относительно недавние результаты показали возможность расширения сферы их при 194    О.A. Лапшина  менения на несимметричные задачи, что является очень важным аспектом при их дальнейшем развитии.  Наибольшее распространение в классе обсуждаемых методов получили две вычислительные процедуры: процедура Арнольди и процедура Ланцоша.  На базе процедуры Арнольди разработан алгоритм метода GMRES (Generalized Minimal Residual algorithm) [4]. Он был предложен Саадом (Saad) и Шульцем(Schultz) в 1986 году [7] и построен таким образом, что на каждом шаге минимизируется вектор невязки, отсюда его название.  Применение техники Ланцоша легло в основу методов, подобных BiCG [5,6]. Впервые алгоритм метода BiCG предложил Ланцош в 1952, но современную (CG-подобную) версию разработал Флетчер в 1974 [7]. Метод бисопряженных градиентов – это проекционный процесс в пространстве Km = {v1, Av1, . . . , Am−1v1}, ортогональном к Lm = {w1, ATw1, . . . , (AT )m−1w1}. Следовательно, строим не один ортогональный базис (как в случае GMRES), а два базиса, ортогональных друг другу. Эта процедура называется двухсторонним методом Ланцоша.  4 Треугольные и попеременно-треугольные переобуславливатели  Практически применяемые алгоритмы представляют собой комбинацию методов подпространств Крылова и переобуславливания, которое является вспомогательной операцией, направленной на улучшение вычислительных свойств исходной матрицы без искажения конечного результата. От успешного выбора переобуславливателя зависит вычислительная эффективность решения.  Основная идея следующая: исходная система линейных алгебраических уравнений трансформируется в другую систему с матрицей, которая обладает лучшими свойствами, и итерационный метод сходится быстрее. Вместо системы (1.1) решается другая:  B−1Ax = B−1b. (4.1)  Оператор B называется левым переобуславливателем.  195    Использование треугольных и попеременно-треугольных . . .  Идея использования треугольных и попеременно-треугольных методов в качестве переобуславливателей основывается на работах Л.А. Крукиера [3, 8, 9], где в качестве обращаемых матриц берутся треугольные части кососимметричной составляющей исходной системы. Этот класс методов был предложен для решения систем линейных алгебраических уравнений с несимметричной матрицей. Основной идеей, реализованной в этих методах, было использование в обращаемом операторе информации о поведении конвективных членов, что обеспечивало достаточно устойчивый итерационный процесс и быструю сходимость методов, особенно в случае сильно меняющегося поля скоростей и при больших значениях числа Пекле.  Вычисление кососимметричной составляющей исходной матрицы не требует большого количества операций и предварительных аналитических действий. В большинстве случаев она получается явно еще при построении дискретной модели, и ее использование в обращаемом операторе метода позволяет учесть структуру изменений именно этой части матрицы. Это особенно важно, когда кососимметрическая часть матрицы преобладает. Единственным ограничением этих методов является требование диссипативности исходной матрицы.  В табл. 1 приведены рассматриваемые нами треугольные и попеременно-треугольные кососимметричные методы, где KB и KH – соответственно верхняя и нижняя треугольные составляющие кососимметричной матрицы A1 (оператор A можно естественным образом представить в виде суммы симметричного положительно определенного оператора A0 и кососимметричного оператора A1), τ – скалярный итерационный параметр. Параметры предложенных методов αi, α > 0 выбираются по формулам: α = ‖M‖, αi = Σ|mij |, i = 0, . . . , n, где M = {mij}0n – симметричная матрица, которая строится следующим образом M = A0 +KB −KH , n – размерность матрицы A.  5 Вычислительные эксперименты  В данной работе представлено исследование двух методов вариационного типа: BiCG и GMRES(10). Для улучшения их сходимости использовалась технология переобуславливания, где в ка 196    О.A. Лапшина  Метод оператор B TKM BC = E TKM1 B = BC + 2τKH или B = BC + 2τKB BC = αiE TKM2 BC = αE БTKM BC = E БTKM1 B = BC + 2KH или B = BC + 2KB BC = αiE БTKM2 BC = αE ПTKM BC = E ПTKM1 B = (BC + τKH)BC  −1(BC + τKB) BC = αiE ПTKM2 BC = αE БПTKM BC = E БПTKM1 B = (BC + 2KH)BC  −1(BC + 2KB) BC = αiE БПTKM2 BC = αE  Таблица 1: Треугольные и попеременно-треугольные переобуславливатели  № Задачи v1(x, y) v2(x, y) 1 1 -1 2 1-2x 2y-1 3 x+y x-y 4 sin(πx) −πy cos(πx)  Таблица 2: Коэффициенты вектора скорости v  честве переобуславливателей применялись методы из класса треугольных и попеременно-треугольных кососимметрических методов. Для того, чтобы показать эффективность такого подхода, полученные численные результаты сравнивались с аналогичными результатами для "классических" переобуславливателей, таких, как SSOR. Серия расчетов проводилась на сетках 32 × 32 и 64×64 для четырех тестируемых задач, коэффициенты векторов скорости которых приведены в табл. 2. Все задачи определены на единичном квадрате Ω = [0, 1] × [0, 1], вектор правых частей f (x, y) и граничные условия Дирихле удовлетворяют точному решению UT = e  xy sin(πx) sin(πy). Число Пекле варьировалось в пределах от 10 до 107, а итерационный процесс прекращался, если ‖rm‖/‖r0‖ < 10−6.  197    Использование треугольных и попеременно-треугольных . . .  128× 128 Pe BiCG BiCG+БTKM1 BiCG+ПТКМ BiCG+SSOR  Задача 1 102 5 5 3 5 104 379 361 379 246 106 1287 1565 1283 1289  Задача 2 102 4 8 4 4 104 439 439 228 161 106 2751 1669 2717 2785  Задача 3 102 5 7 4 5 104 562 319 178 181 106 40380 15889 11250 11818  Задача 4 102 12 15 5 7 104 1779 529 721 505 106 16898 5439 11350 8213  Таблица 3: Число итераций рассматриваемых методов  6 Выводы  Было установлено, что использование попеременно-треугольных методов в качестве переобуславливателей для GMRES(10) значительно снижает вычислительные затраты.  Вычислительные эксперименты подтвердили, что сходимость метода BiCG с ТКМ и ПТКМ в качестве преобуславливателей сильно зависит от выбора итерационного параметра, наименее чувствительными к точному выбору значения оказались методы BiCG+ТКМ2 и BiCG+ПТКМ2.  Численные результаты показали, что для задач с постоянным и слабо изменяющимся полем скоростей (задачи 1 и 2) лучше всего применять метод BiCG без переобуславливателя. В задачах с сильно изменяющимся полем скоростей (задачи 3 и 4) использование некоторых треугольных и попеременно-треугольных схем в качестве переобуславливателей для BiCG позволяет уменьшить  198    О.A. Лапшина  Рис. 1: Сходимость метода BiCG без переобуславливателя (слева) и с использованием ПТКМ в качестве переобуславливателя (справа); L = lg(‖rn‖/‖r0‖), N – число итераций, задача 3, сетка 32× 32, Pe = 107  Рис. 2: Сходимость метода BiCG без переобуславливателя (слева) и с использованием БТКМ1 в качестве переобуславливателя (справа); L = lg(‖rn‖/‖r0‖), N – число итераций, задача 4, сетка 32× 32, Pe = 107  нерегулярную сходимость метода с одной стороны, а с другой – сократить число итераций, следовательно, и временные затраты.  Наиболее эффективным переобуславливателем BiCG для задачи 3 показал себя ПТКМ, а для задачи 4 – БТКМ1 (рис. 1, рис. 2).  Таким образом, применение разработанного класса треугольных и попеременно-треугольных переобуславливателей к методам вариационного типа наиболее эффективно для задач конвекции-диффузии с преобладающей конвекцией и сильно изменяющимся полем скоростей.  199   