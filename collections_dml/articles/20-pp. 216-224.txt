  ИЗУЧЕНИЕ СПЕКТРА МАТРИЦ, ПОЛУЧЕННЫХ В РЕЗУЛЬТАТЕ ЦЕНТРАЛЬНО–РАЗНОСТНОЙ  АППРОКСИМАЦИИ УРАВНЕНИЯ КОНВЕКЦИИ–ДИФФУЗИИ 1  В.О. Соколов Ростовский государственный университет, г. Ростов-на-Дону  1 Введение  Задачи конвекции-диффузии являются типичными для математических моделей механики жидкости и газа. Распространение тепла или примесей, например, происходит не только за счет диффузии, но и обусловлено движением среды, в результате чего происходит конвективный перенос. Конвективно-диффузионный перенос играет определяющую роль при моделировании самых различных газо- и гидродинамических процессов. В частности, важное значение приобретают экологические проблемы, связанные с описанием процессов распространения примесей в атмосфере и водоемах, с моделированием загрязненных грунтовых вод. Задачи конвекции-диффузии являются базовыми при моделировании проблем динамики и тепломассообмена в атмосфере и океане.  Будем рассматривать задачу конвекции-диффузии в квадрате  Ω = {x|x = (x1, x2) , 0 6 xα 6 1, α = 1, 2} ,  записанную в симметричной форме [3]  − 1 Pe  ∆u+ 1  2  ( v1 ∂u  ∂x + v2  ∂u  ∂y + ∂ (v1u)  ∂x + ∂ (v2u)  ∂y  ) + cu = f, x ∈ Ω.  (1.1) Уравнение (1.1) дополним краевыми условиями первого рода (условия Дирихле), которые, не нарушая общности, можно записать в виде  u|∂Ω = 0. (1.2) Поставленная краевая задача (1.1) – (1.2) является характерным примером стационарной задачи конвекции-диффузии.  1Работа выполнена при поддержке РФФИ, проект № 03-01-00005  217    Изучение спектра матриц, полученных в результате . . .  2 Аппроксимация уравнения конечными разностями  Будем использовать равномерную по каждому направлению сетку ωh с шагом h = hx = hy : ωh = {ωij = (xi, yj), xi = ih, yj = = jh, i = 1 . . . n, j = 1 . . . n}.  Обозначим Lh разностный оператор, аппроксимирующий дифференциальный оператор в уравнении (1.1). Тогда уравнению (1.1) можно поставить в соответствие разностное уравнение  Lhu = ϕ. (2.1)  Аппроксимируем конвективные члены центральными разностями, тогда разностная схема примет вид  (Lhu)ij = − 1  Pe  [ ui+1j + ui−1j + uij−1 + uij+1 − 4uij  h2  ] +  + 1  2  [ v1ij  ui+1j − ui−1j 2h  + v2ij uij+1 − uij−1  2h +  + v1i+1jui+1j − v1i−1jui−1j  2h + v2ij+1uij+1 − v2ij−1uij−1  2h  ] +cuij = ϕij .  Найдем коэффициенты матрицы Lh в уравнении  a1ijuij + a1ijui+1j + a3ijui−1j + a4ijuij+1 + a5ijuij+1 = ϕij ,  где  a1ij = 4  Peh2 + c, a2ij = −  1  Peh2 +  1  4h (v1ij + v1i+1j) ,  a3ij = − 1  Peh2 − 1  4h (v1ij + v1i−1j) ,  a4ij = − 1  Peh2 +  1  4h (v2ij + v2ij+1) ,  a5ij = − 1  Peh2 − 1  4h (v2ij + v1ij−1) .  Использовав естественный порядок неизвестных, домножив левую и правую часть на Peh2, трансформируем (2.1) в несимметричную пятидиагональную систему линейных уравнений  Au = b. (2.2)  218    В.О. Соколов  3 Нахождение спектра матрицы системы (2.2)  Будем исследовать спектр матриц A, полученных путем аппроксимации задачи (1.1) – (1.2), на сетках с различным числом узлов, при различных числах Pe, при разных v1 и v2 (см. таб. 1), используя QR алгоритм.  № задачи v1 v2 1 1 -1 2 1− 2x 2y − 1 3 x+ y x− y 4 sin (2πx) −2πy cos (2πx)  Таблица 1: Компоненты вектора скорости для тестируемых задач  3.1 QR алгоритм  Использование QR алгоритма началось с работы Френсиса [5], который установил в 1961 – 1962 гг., что QR итерации переводят матрицу Хессенберга опять в матрицу Хессенберга, что делает процесс экономичным, а также положительно отражается на устойчивости, так как нет необходимости вычислять нулевые элементы.  С 1960 года и по сегодняшний день QR является стандартным алгоритмом для вычисления всех точек спектра вещественных матриц. MATLAB, например, для нахождения спектра использует одну из четырех реализованных в нем разновидностей QR алгоритма. В свободно распространяемом пакете LAPACK [6], хорошо работающем на многопроцессорных системах с общей памятью, также реализован QR алгоритм. В пакете ScaLAPACK [7], предназначенном для выполнения матричных вычислений на параллельных компьютерах с распределенной памятью, реализована параллельная версия алгоритма, предложенная Генри в 1997 году [4].  Теорема 3.1 (вещественное разложение Шура) [1]. Если матрица A ∈ Rn×n, то существует ортогональная матрица  219    Изучение спектра матриц, полученных в результате . . .  Q ∈ Rn×n, такая, что  QTAQ = R =     R11 R12 . . . R1m 0 R22 . . . R2m ...  ... . . .  ... 0 0 . . . Rmm    ,  где каждый блок Rii – либо матрица 1× 1, либо матрица 2× 2, имеющая комплексно сопряженные собственные значения.  Матрица R в теореме 3.1 называется вещественной формой Шура матрицы A.  Алгоритм QR итерации. Положим A0 = A и вычислим последовательность матриц Ak следующим образом:  A0 = Q0R0, A1 = R0Q0 = Q1R1,  ... Ak = QkRk = Rk−1Qk−1, k = 1, 2, . . .  Лемма 3.1 [2]. Пусть Ai – матрица, вычисляемая в вышеуказанном алгоритме. Тогда Ai = Z  T i AZi, где Zi – ортогональ ная матрица, и если все собственные значения имеют разные модули, то матрицы Ai сходятся к форме Шура.  Данный алгоритм является вычислительно невыгодным, небольшие его изменения могут значительно улучшить метод [1]. Приведем матрицу A к верхней хессенберговой форме перед тем, как применить метод. Как уже говорилось выше, QR итерации не "портят" хессенбергову матрицу. Если QR алгоритм применить к исходной матрице, то это потребует O(n3) флопп на каждый шаг, в то время, как шаг QR алгоритма, примененного к хессенберговой матрице, будет стоить O(n2) флопп [1]. Также можно увеличить скорость сходимости метода, применив его не к матрице R (R – верхняя хессенбергова матрица, подобная матрице A), а к матрице Rσ, полученной путем сдвига исходной матрицы. Найдя спектр матрицы Rσ и произведя сдвиг в обратную сторону, получим искомый спектр.  220    В.О. Соколов  3.2 Численные результаты  Далее приведены спектральные портреты матриц системы (2.2) при числе узлов, равном 12 и 18, при c = 0 и различных числах Pe. Приведены также спектральные портреты масштабированных матриц D−1A, где D – диагональная часть матрицы A.  4 4 4 −1.5  −1  −0.5  0  0.5  1  1.5 x 10  4  4 4 4 4 4 −1.5  −1  −0.5  0  0.5  1  1.5 x 10  4  Рис. 1: Задача 1, Pe = 105, сетка 12× 12  Рис. 2: Задача 1, Pe = 105, сетка 18× 18  4 4 4 −1.5  −1  −0.5  0  0.5  1  1.5 x 10  5  1 1 1 1 1 1 1 −4000  −3000  −2000  −1000  0  1000  2000  3000  4000  Рис. 3: Задача 1, Pe = 106, сетка 12× 12  Рис. 4: Задача 1, Pe = 105, сетка 12×12, масштабированная матрица  221    Изучение спектра матриц, полученных в результате . . .  3 3.2 3.4 3.6 3.8 4 4.2 4.4 4.6 4.8 5 −8000  −6000  −4000  −2000  0  2000  4000  6000  8000  Рис. 5: Задача 2, Pe = 105, сетка 12× 12  2.5 3 3.5 4 4.5 5 5.5 −8000  −6000  −4000  −2000  0  2000  4000  6000  8000  Рис. 6: Задача 2, Pe = 105, сетка 18× 18  3 3.2 3.4 3.6 3.8 4 4.2 4.4 4.6 4.8 5 −8  −6  −4  −2  0  2  4  6  8 x 10  4  0.75 0.8 0.85 0.9 0.95 1 1.05 1.1 1.15 1.2 1.25 −2000  −1500  −1000  −500  0  500  1000  1500  2000  Рис. 7: Задача 2, Pe = 106, сетка 12× 12  Рис. 8: Задача 2, Pe = 105, сетка 12×12, масштабированная матрица  222    В.О. Соколов  4 4 4 −1.5  −1  −0.5  0  0.5  1  1.5 x 10  4  Рис. 9: Задача 3, Pe = 105, сетка 12× 12  4 4 4 −1  −0.8  −0.6  −0.4  −0.2  0  0.2  0.4  0.6  0.8  1 x 10  4  Рис. 10: Задача 3, Pe = 105, сетка 18× 18  4 4 4 −1.5  −1  −0.5  0  0.5  1  1.5 x 10  5  1 1 1 1 1 1 1 −4000  −3000  −2000  −1000  0  1000  2000  3000  4000  Рис. 11: Задача 3, Pe = 106, сетка 12× 12  Рис. 12: Задача 3, Pe = 105, сетка 12×12, масштабированная матрица  223    Изучение спектра матриц, полученных в результате . . .  3 3.2 3.4 3.6 3.8 4 4.2 4.4 4.6 4.8 5 −4  −3  −2  −1  0  1  2  3  4 x 10  4  Рис. 13: Задача 4, Pe = 105, сетка 12× 12  2.5 3 3.5 4 4.5 5 5.5 −2.5  −2  −1.5  −1  −0.5  0  0.5  1  1.5  2  2.5 x 10  4  Рис. 14: Задача 4, Pe = 105, сетка 18× 18  3 3.2 3.4 3.6 3.8 4 4.2 4.4 4.6 4.8 5 −4  −3  −2  −1  0  1  2  3  4 x 10  5  0.75 0.8 0.85 0.9 0.95 1 1.05 1.1 1.15 1.2 1.25 −1  −0.8  −0.6  −0.4  −0.2  0  0.2  0.4  0.6  0.8  1 x 10  4  Рис. 15: Задача 4, Pe = 106, сетка 12× 12  Рис. 16: Задача 4, Pe = 105, сетка 12×12, масштабированная матрица  224   