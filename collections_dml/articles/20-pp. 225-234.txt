 . . .  СРАВНЕНИЕ ТРЕУГОЛЬНЫХ РАЗНОСТНЫХ СХЕМ С МЕТОДАМИ ВЫСОКОГО ПОРЯДКА  ТОЧНОСТИ ПРИ РЕШЕНИИ УРАВНЕНИЯ КОНВЕКЦИИ–ДИФФУЗИИ 1  Т.Н. Субботина Южно-Российский региональный центр информатизации  высшей школы, г. Ростов-на-Дону  1 Введение  В последние годы наблюдается резкий рост вычислительных возможностей компьютерной техники и вместе с тем увеличивается интерес с математическому моделированию различных физических процессов. Так, при моделировании переноса вещества в воздухе или в воде необходимо решить нестационарное уравнение конвекции-диффузии. Известно, что при наличии малого параметра при старшей производной, т. е. при доминировании конвективных процессов, задача усложняется, особенно если решение содержит внутренние или пограничные слои. Для таких задач было разработано большое количество явных и неявных разностных схем [1–5].  Предложенные в данной работе треугольные кососимметричные разностные схемы относятся к классу схем, эффективно решающих задачи, т. к. треугольные матрицы легко обратимы и не требуют большого числа арифметических действий. Вместе с тем показано, что при выполнении определенных условий разностные схемы с таким оператором устойчивы. Теоретические исследования базируются на известных результатах теории устойчивости операторно-разностных схем и операторных неравенств [6,7]. Численные эксперименты проводились для уравнения конвекциидиффузии с малым параметром при старшей производной, с четырьмя различными полями скоростей и для задачи с решением типа погранслоя. Особый интерес представляет сравнение результатов работы треугольных схем со схемами высокого поряд 1Работа выполнена при поддержке РФФИ, проект № 03-01-00005-a и про граммы "Университеты России", проект № 03.01.019  226    Т.Н. Субботина  ка [8, 9], позволяющих эффективно решать задачи со сложными полями скоростей или с погранслоями. Результаты, изложенные в статье, справедливы для разностных операторов по пространству, обладающих свойством диссипативности, т. е. для несамосопряженных операторов, у которых симметричная часть положительно определена. Разностные операторы, обладающие такими свойствами, могут быть получены при аппроксимации достаточно широкого класса научно-технических проблем, связанных с процессами конвекции и диффузии, таких, как гидродинамика вязких несжимаемых жидкостей, распространение веществ и распределение температуры в атмосфере, в водоемах и т. д. [10]  2 Постановка задачи и методы ее решения  Динамическую задачу конвективно-диффузионного переноса вещества в случае двух пространственных переменных можно записать в "симметричной" форме, учитывая несжимаемость среды (div ~V = 0) [10]:      ∂ϕ  ∂t − 1  Pe ∆ϕ+  1  2  ( ∂v1ϕ  ∂x + v1  ∂ϕ  ∂x + ∂v2ϕ  ∂y + v2  ∂ϕ  ∂y  ) = f,  ϕ|t=0 = ϕ0(x, y), ϕ|∂D = ϕгр, D = [0, 1]× [0, 1].  (2.1)  В уравнении (2.1) ~V = (v1(x, y), v2(x, y)) – вектор скорости движения среды, первое слагаемое соответствует динамике задачи, второе слагаемое – диффузионному переносу, а остальные – конвективному переносу, f = f(x, y, t).  После аппроксимации пространственных производных уравнения (2.1) на стандартном пятиточечном шаблоне, где конвективная часть аппроксимируется центральными разностями, получим операторно-разностную схему [6]  B yk+1 − yk  τ +Ayk = fk, k = 0, 1, . . . , (2.2)  y0 = u0. (2.3)  227    Сравнение треугольных разностных схем . . .  Здесь A, B – линейные операторы (матрицы) в H, H – вещественное конечномерное гильбертово пространство, f , y0 ∈ H, y0 – начальное условие, yk – решение задачи (2.1) на k-м шаге по времени, τ – шаг по времени.  2.1 Треугольные кососимметричные схемы  Представим матрицу A в виде суммы симметричной и кососимметричной частей: A = A0 +A1, A0 = 0.5 (A+A  ∗) , A1 = 0.5 (A− −A∗) , A1 = KB + KH , где KB и KH – верхняя и нижняя треугольные части матрицы A1, KB = −K∗H .  Следуя основной идее определить оператор B с легко обратимой матрицей, положим B = E + ωK, где K = KB или K = = KH [10], ω = 2τ . Тогда матрица, соответствующая оператору B, будет иметь треугольную структуру. Заметим, что симметричная B0 и кососимметричная B1 части оператора B = E + ωKH имеют вид B0 = E + 0.5ω (KH −KB) , B1 = τA1.  Рассмотрим оператор перехода S в предположении, что B0 = = B∗0 > 0:  S = B−1 (B − τA) = (B0 +B1)−1 (B0 +B1 − τA0 − τA1) = = (B0 + τA1)  −1 (B0 − τA0) =  = B −1/2 0 (E + τP1)  −1 (E − τP0)B1/20 .  Здесь  P0 = B −1/2 0 A0B  −1/2 0 = P  ∗ 0 , (2.4)  P1 = B −1/2 0 A1B  −1/2 0 = −P ∗1 . (2.5)  Таким образом, оператор S подобен оператору (E + τP1) −1×  × (E − τP0). Перейдя к уравнению эквивалентных погрешностей для вектора yk = B  −1/2 0 xk, получим  ‖S‖B0 = ∥∥∥(E + τP1)−1 (E − τP0)  ∥∥∥ .  Теорема 2.1. Пусть оператор A несамосопряжен, оператор B имеет вид B = E + τR + τA1, R = j(KH −KB), j = −1, 1, B0 = E+ τR = B  ∗ 0 > 0. Тогда для устойчивости разностной схе мы (2.2) по начальным данным в энергетическом пространстве  228    Т.Н. Субботина  HB0 достаточно, чтобы ‖(E + τP1) −1  (E − τP0)‖ 6 1, где P0 и P1 заданы формулами (2.4) и (2.5) соответственно.  Теорема 2.2. Пусть оператор A несамосопряжен, оператор B имеет вид B = E + τR + τA1, R = j(KH − KB), j = −1, 1, B0 = E+ τR = B  ∗ 0 > 0. Тогда для устойчивости разностной схе мы (2.2) по начальным данным в энергетическом пространстве HB0 достаточно выполнения условия 0 6 0.5τA0 6 B0.  Доказательство. Имеем  ‖S‖B0 = ∥∥∥(E + τP1)−1 (E − τP0)  ∥∥∥ 6 ∥∥∥(E + τP1)−1  ∥∥∥ ‖(E − τP0)‖ .  Обозначим u = (E + τP1) −1 x и оценим  ∥∥∥(E + τP1)−1 ∥∥∥ 2  = sup x6=0  ( (E + τP1)  −1 x, (E + τP1)  −1 x )  (x, x) =  = sup u6=0  (u, u)  ((E + τP1)u, (E + τP1)u) =  = sup u6=0  (u, u)  (u, u) + (u, τP1u) + (τP1u, u) + τ2 (P1u, P1u) =  = sup u6=0  1  1 + τ2(P1u, P1u)/(u, u) .  В силу неравенства (P1u, P1u)/(u, u) > 0 имеем ‖(E+τP1)−1‖ 6 1. Учитывая последнее неравенство, получим, что для устойчивости разностной схемы (2.2) в энергетическом пространстве HB0 достаточно выполнения условия ‖S‖B0 6 ‖E − τP0‖ 6 1, которое по свойствам операторных неравенств [7] эквивалентно операторному неравенству 0 6 0.5τA0 6 B0.  В ходе вычислительных экспериментов решалась задача (2.1) разностной схемой (2.2) с оператором B в виде  1. B = E — явная схема с центральными разностями (Явная ц.-р.);  2. B = E + 2τKH — треугольная кососимметричная схема (ТКС).  229    Сравнение треугольных разностных схем . . .  2.2 Схемы высокого порядка точности  Помимо двухслойной схемы (2.2) для расчетов использованы схемы высокого порядка точности. Для этого перепишем уравнение конвекции-диффузии задачи (2.1) в недивергентной форме:      ∂ϕ  ∂t − 1  Pe ∆ϕ+ v1  ∂ϕ  ∂x + v2  ∂ϕ  ∂y = f(x, y, t),  ϕ|t=0 = ϕ0(x, y), ϕ|∂D = ϕгр, D = [0, 1]× [0, 1].  (2.6)  В силу несжимаемости среды (div ~V = 0) эти формы записи эквивалентны.  Производную по времени аппроксимируем разностью вперед, а к пространственным производным применим метод контрольных объемов [5]:  yn+1i,j − yni,j τ  + Fni+1/2,j − Fni−1/2,j + Fni,j+1/2 − Fni,j−1/2 = fni,j , (2.7)  где Fn i−1/2,j  , Fn i,j−1/2  – аппроксимированные потоки, входящие в i-ю ячейку в направлениях x и y, F n  i+1/2,j , Fn  i,j+1/2 – аппроксими рованные потоки, исходящие из i-й ячейки в направлениях x и y, причем  Fni+1/2,j = 1  hx  [ − 1 Pe  yni+1,j − yni,j hx  + v1i,jy n i+1/2,j  ] , (2.8)  Fni,j+1/2 = 1  hy  [ − 1 Pe  yni,j+1 − yni,j hy  + v2i,jy n i,j+1/2  ] . (2.9)  Здесь yi+1/2,j и yi,j+1/2 – аппроксимация функции ϕ в ∂xϕ и ∂yϕ соответственно. Очевидно, что при  yi+1/2,j = yi,j + yi+1,j  2 , yi,j+1/2 =  yi,j + yi,j+1 2  получим схему с центральными разностями второго порядка точности, а при  yi+1/2,j = yup,j =  { yi,j , v1i,j > 0, yi+1,j , v1i,j < 0,  230    Т.Н. Субботина  yi,j+1/2 = yi,up =  { yi,j , v2i,j > 0, yi,j+1, v2i,j < 0  противопотоковую схему, аппроксимирующую конвективные члены с погрешностью O(hx) и O(hy).  В работе [11] изложены методы более высокого порядка – методы коррекции потока. Суть этих схем сводится к добавлению численной диффузии в точках, где быстро изменяется градиент решения:  yi+1/2,j = yup,j + 1 2 Ψ ( qi+1/2,j  ) (ydown,j − yup,j) ,  yi,j+1/2 = yi,up + 1 2 Ψ ( qi,j+1/2  ) (yi,down − yi,up) ,  ydown,j =  { yi+1,j , v1i,j > 0, yi,j , v1i,j < 0,  yi,down =  { yi,j+1, v2i,j > 0, yi,, v2i,j < 0,  qi+1/2,j = yi,j − yi−1,j yi+1,j − yi,j  , qi,j+1/2 = yi,j − yi,j−1 yi,j+1 − yi,j  .  Ограничитель Ψ(θ) потока выбирается таким образом, чтобы приближенное решение удовлетворяло условию TVD [12]:  TV ( yn+1  ) 6 TV  ( yn+1  ) ,  TV (y) = ∑ i,j  (|yi+1,j − yi,j |+ |yi,j+1 − yi,j |). (2.10)  В [13] доказана устойчивость таких схем. Для вычислительных экспериментов были выбраны следую щие ограничители потока Ψ(θ), при которых выполняется условие (2.10):  1. Ψ(θ) = 0 – явная противопотоковая схема (Явная п.-п.);  2. Ψ(θ) = |θ|+ θ 1 + θ  – ограничитель Ван Лира [14] (TVD van  Leer);  3. Ψ(θ) = max {0,min {1, θ}} – ограничитель Minmod [15] (TVD Minmod);  4. Ψ(θ) = max {0,min {1, 2θ} ,min {θ, 2}} – ограничитель Роя "superbee" [16] (TVD Roe).  231    Сравнение треугольных разностных схем . . .  3 Вычислительные эксперименты  С использованием выбранных схем решены четыре задачи, коэффициенты векторов скорости которых приведены в таблице 1. Начальные и краевые условия, а также f(x, y, t) выбирались так, чтобы аналитическим решением задачи (2.1) была функция типа погранслоя ϕ(x, y, t) = exp[−104((x− 0.5)4 + (y − 0.5)4) + t].  Задачи решались на временном отрезке t ∈ [0, 1] с шагом по времени τ = 0.002. Решения получены на сетке 32 × 32 по пространству при числах Пекле Pe = 103 и Pe = 105.  № задачи v1(x, y) v2(x, y) 1 1 1 2 1− 2x 2y − 1 3 x+ y x− y 4 sin 2πx −2πy cos 2πx  Таблица 1: Коэффициенты вектора скорости ~V  Схема Задача 1 Задача 2 Задача 3 Задача 4 Явная 24.47543 20.74568 16.53508 неустойц.-р. 3:55 3:91 3:45 чива ТКС 24.22212 20.57566 16.41067 17.62228  3:88 3:92 3:94 4:29 Явная 36.06121 28.19499 25.22353 25.55366 п.-п. 3:50 3:59 3:53 3:47 TVD 11.65008 30.64363 13.46182 12.99627  van Leer 5:12 5:78 5:17 5:79 TVD 15.33777 30.01111 12.6609 12.04883  Minmod 5:78 5:87 5:11 5:77 TVD 12.6213 32.51945 14.98483 18.07337 Roe 5:13 5:13 5:14 5:89  Таблица 2: Относительная погрешность (%) и время (сек.) решения задачи конвекции-диффузии при Pe = 103  В таблицах 2 – 3 представлены численные результаты решения задачи конвекции-диффузии с каждым из четырех векторов  232    Т.Н. Субботина  Схема Задача 1 Задача 2 Задача 3 Задача 4 Явная 26.22307 17.17119 12.66984 неустойц.-р. 3:53 3:52 3:57 чива ТКС 22.7161 17.05375 11.79074 16.0886  3:93 3:96 3:94 4:33 Явная 42.53958 19.24174 26.75893 27.83396 п.-п. 3:47 3:51 3:48 3:73 TVD 13.27552 25.11064 6.83251 9.91812  van Leer 5:87 5:14 5:97 5:80 TVD 18.57055 22.59932 8.93811 9.2275  Minmod 5:18 5:67 5:67 5:85 TVD 9.25114 29.82123 11.32621 16.85083 Roe 5:13 5:68 5:11 5:93  Таблица 3: Относительная погрешность (%) и время (сек.) решения задачи конвекции-диффузии при Pe = 105  скорости. Показаны относительная погрешность решения в норме пространства С на последнем шаге по времени и время, затраченное на решение задачи на отрезке [0, 1].  4 Выводы  Числовые расчеты показали, что точность решения задачи (2.1) треугольной кососимметричной схемой несколько выше, чем явной схемой с центральными разностями. Наибольшая погрешность наблюдалась при решении задачи (2.1) явной противопотоковой схемой.  При увеличении числа Пекле точность решения схемами TVD и схемами для уравнения конвекции-диффузии, записанного в "симметричной" форме, возрастает.  Для задачи с постоянным полем скоростей (задача 1) самой точной оказалась TVD схема с ограничителем Роя. Если в задаче присутствует поле скоростей с разделяющимися коэффициентами (задача 2), то эффективнее всего для решения использовать треугольную схему. Для задач со смешанным или быстро изменяющимся полем скоростей (задачи 3 и 4 соответственно) решение с наименьшей погрешностью может быть получено TVD схемой с ограничителем Minmod.  233    Сравнение треугольных разностных схем . . .  На решение задачи при одних и тех же условиях TVD схемы затрачивают больше времени, что снижает их эффективность, но, тем ни менее, их применение позволяет уменьшить погрешность решения. Для некоторых типов задач применение треугольных схем оправдано благодаря из достаточно высокой точности и быстроты работы.  Литература  [1] Самарский А.А. Теория разностных схем. – М.: Наука, 1989. – 616 с.  [2] Годунов С.К., Рябенький В.С. Разностные схемы. Введение в теорию. – М.: Наука, 1977. – 439 с.  [3] Рихтмайер Р.Д., Мортон К. Разностные методы решения краевых задач. – М.: Мир, 1972. – 418 с.  [4] Peaceman D.W., Rachford H.H. The numerical solution of parabolic and elliptic differential equations // SIAM J. – 1955. – V. 3. – P. 28-41.  [5] Роуч П. Вычислительная гидродинамика. – М.: Мир, 1980. – 616 с.  [6] Самарский А.А., Гулин А.В. Устойчивость разностных схем. – М.: Наука, 1973. – 415 с.  [7] Гулин А.В. Устойчивость разностных схем и операторные неравенства // Диф. уравнения. – 1979. – Т. 15. – № 12. – С. 2238–2250.  [8] Von Neumann J., Richtmyer R.D. A method for the numerical calculation of hydrodynamic shocks // J. Appl. Phys. – 1950. – V. 21. – P. 232–237.  [9] Lax P.D., Wendroff B. Systems of conservation laws // Comm. Pure Appl. Math. – 1960. – V. 13. – P. 217–237.  [10] Крукиер Л.А. Неявные разностные схемы и итерационный метод их решения для одного класса систем квазилинейных уравнений // Изв. вузов, Матем. – 1979. – № 7. – С. 41–52.  234   