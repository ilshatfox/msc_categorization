  АНАЛИЗ СПОСОБОВ ПЕРЕСТРОЕНИЯ ТРЕУГОЛЬНЫХ КОНЕЧНО-ЭЛЕМЕНТНЫХ СЕТОК1  С.П. Копысов, А.К. Новиков Институт прикладной механики УрО РАН, г. Ижевск  1 Адаптивное перестроение конечно-элементной сетки  Перестроением конечно-элементной сетки можно уменьшить ошибку аппроксимации функции u на области Ω [1]  ‖u− uh‖W 1 2 (Ω) 6 c  h  sin θ ‖u‖W 2  2 (Ω)  за счет уменьшения шага сетки h и (или) увеличения минимального угла θ. На этом основаны процессы адаптивного уточнения сеточной модели. Шаг сетки может быть уменьшен делением конечных элементов (h-версия МКЭ) [2–4] или движением (изменением координат) узлов сетки (r-версия) [5].  Предлагается следующий алгоритм адаптивного уточнения.  1. Решаем задачу на сетке Tk с координатами узлов Xk (для исходной сетки k = 0).  2. Вычисляем погрешность решения η(Tk).  3. Если η(Tk) 6 η∗ или |η(Tk) − η(Tk−1)| 6 ε, то полагаем, что получено решение с погрешностью η(Tk), и выходим из алгоритма. В другом случае:  (a) выбираем конечные элементы из Tk для перестроения по h-версии;  (b) вычисляем новые координаты Xk+1 узлов сетки;  (c) перестраиваем сетку по h-версии и получаем Tk+1.  Увеличиваем k на единицу и переходим на шаг 1.  1Работа выполнена при поддержке РФФИ, проекты № 02-07-90265, № 03 07-06119 и Уральского отделения РАН  171    Анализ способов перестроения треугольных . . .  Данный алгоритм достаточно универсален: пропустив шаг 3, b, получим h-версию МКЭ; пропустив шаг 3c – r-версию. Если переставить эти шаги, то можно получить h-версию со сглаживанием. Условие завершения гарантирует выход из алгоритма как при достижении допустимой величины погрешности η∗, так и в случае, когда погрешность изменяется несущественно. Уменьшение погрешности [6] при применении r-версии МКЭ ограничивается с одной стороны фиксированным числом узлов сетки, а с другой – изменением геометрии треугольников (минимальный внутренний угол в треугольнике уменьшается). Несмотря на то, что размерность системы конечно-элементных уравнений не увеличивается, многократное решение задач на сетках с большим числом конечных элементов требует больших вычислительных затрат. Поэтому движение узлов будем рассматривать в сочетании с h-версией МКЭ как вспомогательную процедуру уточнения.  Деление треугольных конечных элементов осуществляется внесением нового узла (или нескольких узлов) на ребро или внутрь треугольника. Таким образом, элемент может быть поделен на два, три или четыре треугольника. При делении на два треугольника новый узел помещается на одно из ребер перестраиваемого треугольника, при делении на три – внутрь треугольника, на четыре – узлы помещаются на середины всех, по одному на каждое ребро. В основном применяются деление на два треугольника (деление по наибольшей стороне, деление по новому узлу) и деление на четыре треугольника – регулярное деление [2, 7].  Кроме того, применяется замена общего ребра в смежных треугольниках на основе леммы Делоне [4]. Этот способ перестроения позволяет увеличить минимальный угол конечного элемента и уменьшить шаг сетки без внесения в сетку дополнительных узлов.  Далее под перестроением понимаем деление треугольников или замену общих ребер в смежных треугольниках.  2 Способы перестроения треугольной сетки  Будем полагать, что в исходном треугольнике 4ABC ∈ T ребра упорядочены следующим образом: |BC| 6 |AC| 6 |AB|. Как следствие α 6 β 6 γ (рис. 1, а).  172    С.П. Копысов, А.К. Новиков  Процесс перестроения сетки в общем случае состоит из двух этапов: уточняющего и согласующего перестроений. Необходимость согласующего перестроения вызвана нарушением конформности сетки при уточняющем перестроении (рис. 1, б). Треугольник 4CBD является неконформным треугольником и будет поделен ребром A′D при согласующем перестроении. До согласующего перестроения ребро CB будет неконформным ребром 4CBD, а узел A′ – его неконформным узлом. Далее неконформный узел будем обозначать vu, а вершину в неконформном треугольнике, противолежащую неконформной стороне, – vcu (в рассматриваемом случае это вершина D). Неконформные треугольники должны делиться в порядке их появления. В другом случае возможно появление более одного неконформного узла на ребре, например, узлы C и C ′ на рис. 4, б, если ребро AB не принадлежит границе Ω.  Все способы деления треугольников можно осуществить одним из двух алгоритмов: разделить все уточняемые треугольники, затем выполнить согласующее перестроение для всей сетки или выполнить согласующее перестроение после деления каждого уточняемого треугольника. Остановимся подробнее на способах деления треугольных конечных элементов.  g  ba  a a  a  b  b  b  g g  g  à) á)  d a  a-d a  A  B’  C’ B  A’  C  AC’ B  B’ A’  DC  Рис. 1: Регулярное деление  Регулярное деление осуществляется внесением новых узлов на середины сторон делимого треугольника (рис. 1). При этом получаются четыре треугольника. Как видно из рис. 1, величины внутренних углов треугольников не изменяются вследствие подобия треугольников. Внесение новых узлов нарушает конформ 173    Анализ способов перестроения треугольных . . .  ность сетки. Для устранения неконформностей применяются следующие способы.  1. Для треугольника с одним неконформным ребром выполнить одно из следующих действий:  (a) соединить узел vu с вершиной vcu;  (b) поделить по наибольшей стороне, при этом появится новый узел v′; если узлы vu и v  ′ не совпадают, тогда соединить vu и v  ′.  2. Треугольник с двумя или тремя неконформными ребрами поделить регулярно.  Недостатком регулярного деления является невозможность локального перестроения при применении только регулярного деления треугольников. Для устранения одной неконформности необходимо применить соединение неконформного узла vu с противолежащей вершиной vcu (способ 1a), известный как "green" refinements [2]. Кроме того, на следующем шаге уточнения необходимо вернуться к триангуляции T̃i−1, в которой есть треугольники с одним неконформым ребром, это усложняет параллельную реализацию алгоритма.  Внесение нового узла внутрь треугольника, например, в центр тяжести, приводит к появлению трех новых треугольников (рис. 2). При этом конформность сетки не изменится, т. к. перестроение совершается внутри треугольника. Использование данного способа приводит к появлению вытянутых треугольников с двумя малыми углами. Поэтому необходимо в полученных треугольниках заменить ребра максимальной длины, использовав замену общего ребра в смежных треугольниках (рис. 2, а). Ребро BC заменяется на DD′. Поскольку эти ребра являются диагоналями четырехугольника ABD′C, то описанный способ часто называют заменой диагонали. При последовательном внесении нового узла внутрь граничного треугольника происходит вырождение треугольника (рис. 2, б). Отметим, что увеличить величину минимального угла в триангуляции возможно только заменой общих ребер, движением узлов или удалением треугольника с минимальным углом при огрублении сетки.  174    С.П. Копысов, А.К. Новиков  A B  C  D  D’  AA A B  C  DN  D1  |DD |=i |CD |/3N i  Di  á)à)  Рис. 2: Внесение нового узла внутрь треугольника и замена общего ребра  Одним из способов деления треугольного элемента на два является деление по новейшему узлу (newest node bisection [2]). Треугольник делится из узла, внесенного в сетку последним. На рис. 3, б это вершина C ′. Новый узел вносится на середину противолежащего ребра. В качестве начального нового узла выбирается вершина при максимальном угле в треугольнике из T0. На рис. 3, а это вершина C. При таком способе деления угол делится только один раз и не происходит деления минимального угла. Образующиеся при перестроении треугольники могут быть только 4 видов (рис. 3, а, б).  a ab b  g  a d2  g  d1 g  d1 g  e p-e  d1 g  d2 g  x x d2  g  g  b 2 3  1 1  4 4  d =g-d2 1 g g  x=p-g  c/2 c/2  d ab  A B  C  C’ A BC’  C  A’B’  à) á)  Рис. 3: Деления треугольника на два  Другой способ деления треугольника на два – это деление по наибольшей стороне (longest side bisection [3]). Оно осуществля 175    Анализ способов перестроения треугольных . . .  ется внесением нового узла на середину наибольшей стороны делимого треугольника (рис. 4). В зависимости от величин углов исходного 4ABC деление по наибольшей стороне может совпадать с делением по новейшему узлу (рис. 3) или отличаться (рис. 4). Деление наибольшего ребра связано с делением наибольшего уг A B  C  C’ A B  C“  C  à) á)  C“C’  B’  Рис. 4: Деление по наибольшей стороне: особенности  ла, что предотвращает появление малых углов. Неконформности, оставшиеся после уточняющего перестроения, устраняются одним из следующих способов:  1. В каждом неконформном треугольнике соединить неконформный узел vu с противолежащей ему вершиной vcu.  2. Каждый неконформный треугольник поделить по наибольшей стороне, при этом появится новый узел v′. Если узлы vu и v  ′ не совпадают, тогда соединить vu и v ′ .  3. Неконформные треугольники делить по наибольшей стороне, пока сетка не станет конформной. При этом конформность триангуляции достигается за конечное число шагов [2].  Деление равнобедренных или равносторонних треугольников по наибольшей стороне может привести к увеличению области перестроения. В таком случае уменьшить область перестроения позволяет второй способ. От деления по новейшему узлу (или по наибольшей стороне в случае рис. 3, б) можно перейти к регулярному делению (рис. 1, а), заменив ребро CC ′ на ребро A′B′.  176    С.П. Копысов, А.К. Новиков  Все рассмотренные способы деления треугольников приводят к локальному уменьшению шага сетки. Определив шаг сетки h(Ti) как длину ребра, получим h(Ti+1) = h(Ti)/2 для регулярного деления |BC|/2. При делении наибольшего ребра шаг сетки будет |AB|/2 или |AC|/2, а в случае неравномерной сетки возможно |BC|/2. Если шаг вычислен через диаметр треугольника h(Ti) = = diam(t), тогда h(Ti) = a/ sinα, и шаг тоже может уменьшиться вдвое, т. к. a – сторона треугольника, противолежащая углу α. В этой оценке величина шага зависит от величин углов треугольника. Поэтому уменьшение шага может быть вызвано не только уменьшением длины ребра, но и увеличением синуса угла. Важно отметить, что hmin < h(Ti+1) < hmax, где hmax/hmin À 1. Отношение максимального шага к минимальному увеличивается на каждой итерации процесса адаптивного уточнения.  3 Границы внутренних углов треугольных элементов при перестроении  Рассмотрим изменения углов в конечных элементах, происходящие при перестроении сетки. Предварительно оценим минимальный и максимальный углы в произвольном треугольнике.  Замечание 3.1. Максимальный угол γ в треугольнике может быть острым π/3 < γ < π/2, прямым γ = π/2 или тупым π/2 < γ < π. Минимальный угол 0 < α < π/3.  Существуют три особых случая: отсутствие экстремума, если α = β = γ = π/3 (равносторонний треугольник); два минимума, если α = β (равнобедренный треугольник с одним большим углом γ) и два максимума, если β = γ (равнобедренный треугольник с одним малым углом α). Исходя из этого, выделим три типа исходных сеток: сетки из прямоугольных треугольников, сетки из равнобедренных (равносторонних) треугольников и сетки общего типа, которые состоят из треугольников различной геометрии.  Оценим углы, появляющиеся в треугольных элементах после перестроения. В регулярном делении изменение углов происходит при согласующем перестроении, которое может привести к делению минимального внутреннего угла α в треугольнике. Для сетки из треугольников с углами α = β = π/4 получим δα1 ≈ π/10. В  177    Анализ способов перестроения треугольных . . .  общем случае минимальным углом будет один из α, δα1 , δ α 2 , δ  β 1 , δ  β 2 ,  δ γ 1 , δ  γ 2 , а максимальным – один из γ, ²  α 1 , ²  α 2 , ²  β 1 , ²  β 2 , ²  γ 1 , ²  γ 2 (рис. 3).  Оптимальной для этого способа деления будет исходная сетка из равносторонних треугольников, тогда δα1 = δ  α 2 = π/6 и макси мальный угол ²1 = ²2 = π/2. В других случаях можно получить θT 6 π/8, здесь θT – минимальный угол θ по всей сетке T .  При внесении нового узла внутрь будет поделен угол α, поэтому минимальный угол будет δα1 6 α/2.  Минимальный угол при делении на два треугольника – один из углов α, δ  γ 1 , δ  γ 2 (рис. 3, а). Максимальный угол – один из γ, ζ, ²1,  ²2 (рис. 3). Деление на два треугольника предпочтительно применять для сеток, состоящих из треугольников с максимальными внутренними углами γ > π/2. Тогда в случае прямоугольных равнобедренных треугольников минимальный угол будет α = π/4, а максимальный угол ²1 = π/2. В случае произвольного прямоугольного треугольника α < π/4 и ²1 > π/2. Для тупоугольного треугольника γ > π/2 максимальным тоже будет угол ²1 > π/2, а минимальным – α или δ  γ 1 .  Рассмотрим возможные случаи на примере 4ABC (рис. 5, а). Будем изменять угол α = ∠CAB, полагая |AC| = |ACi|, |AB|/2 < < |AC| < |AB| и δγ = ∠BCiA, где i = 1, 2, 3. Если C = C1, т. е. принадлежит подобластиD1D2B, то4ABC – остроугольный треугольник, при этом α < δ  γ 1 . При C = C2, т. е. принадлежа щей дуге D2B, – прямоугольный треугольник и α = δ γ 1 . Когда C  принадлежит подобласти D2BC ′, то треугольник тупоугольный  и α > δ γ 1 . Таким образом, при делении треугольных элементов  уменьшение θT может произойти только за счет деления острых углов. В других случаях угол θT = infT {α}.  Предположим, что α =const и будем перемещать C на отрезке AA2. Величина угла δ  γ будет уменьшаться (∠AA1C ′ > ∠AC2C  ′ > > ∠AA2C  ′) и достигнет минимума при |AC| = |AA2| = |AB|. Применив теорему синусов и формулу для синуса суммы углов к треугольникам 4ABC и 4ACC ′ (рис. 3, а), получим  tg δ γ 1 =  sin γ sinα  2 sinβ − sin γ cosα.  178    С.П. Копысов, А.К. Новиков  C’ABC’  D 2  D 1  D 2  D 1  BF 3  F 1  F 2  G  A  à) á)  C 1  C 2D2  A 2  A 1  C 3  Рис. 5: Границы внутренних углов треугольника  Так как |AC| = |AA2| = |AB|, то sin γ = sinβ, значит,  tg δ γ 1 =  sinα  2− cosα = √ 1− cos2 α 2− cosα .  На интервале 0 6 α 6 π/3 отношение α/δ γ 1 возрастает от 1 до  2. Тем не менее, оценить sin θ априори можно только в частных случаях. Для сеток общего типа возможна только апостериорная оценка (после перестроения) с применением полученных зависимостей.  Кроме того, геометрия треугольных элементов влияет на процесс перестроения. Так, если C принадлежит подобласти D1F1F2D2 (рис. 5, б) илиD2F2C  ′, то деления по новейшему узлу и наибольшему ребру совпадают. Если C ∈ C ′F2F3 или C ∈ F2F3B, то при делении по наибольшей стороне происходит повторное деление угла ∠ACB (рис. 4, б). При C ∈ F1F2G или C ∈ GF2B происходит деление "внутрь" (рис. 4, а).  4 Численный пример  Были проведены экспериментальные исследования способов перестроения на сетках с различной геометрией треугольных элементов при решении плоских задач теории упругости. На рис. 6  179    Анализ способов перестроения треугольных . . .  показаны начальная и перестроенная (после 7 шагов адаптивного уточнения) сетки (задача Ламе о деформировании толстостенного цилиндра). Исследования показали, что перестроение сеток по наибольшей стороне не привело к уменьшению минимального угла θT0 = θT8 ≈ π/9. Наблюдалось увеличение максимального угла с π/2 до 3π/4. Минимальный шаг сетки hmin уменьшился в 8 раз. Наибольший шаг сетки уменьшился в 2 раза. Погрешность  à) á)  Рис. 6: Исходная и перестроенная сетки  решения, оцененная в энергетической норме [8], уменьшилась с 40.75% до 5.82%. Для сравнения: исходная сетка состояла из 39 узлов, перестроенная сетка – из 686 узлов, а сетка с равномерным шагом, обеспечивающая погрешность 5.99%, содержит 2626 узлов. Проведенный анализ показал, что уменьшение угла θ при перестроении треугольных конечных элементов происходит при регулярном делении (за счет согласующего перестроения), при этом на сетках из прямоугольных треугольников и сетках общего типа можно получить θ 6 π/8. При делении по новейшему узлу или по наибольшей стороне угол θ уменьшается только в остроугольных треугольниках. В этом случае θ = δ  γ 1 , минимум  которого достигается на равнобедренном треугольнике. Поэтому для сеток из прямоугольных треугольников и сеток общего вида предпочтительнее применять деление по новейшему узлу или деление по наибольшей стороне с последующей заменой общего ребра.  180   