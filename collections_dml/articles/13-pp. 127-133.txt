.  ПАРАЛЛЕЛЬНЫЕ СХЕМЫ МЕТОДА СОПРЯЖЕННЫХ ГРАДИЕНТОВ  М.Ю. Альес, С.П. Копысов, А.К. Новиков ИПМ УрО РАН, г. Ижевск  1 Введение  При решении краевых задач методом конечных элементов возникают разреженные системы линейных алгебраических уравнений  Au = f, A ∈ RN×N , u ∈ RN , f ∈ RN . (1.1)  Матрица коэффициентов A и вектор правой части f системы (1.1) в этом случае формируются следующим образом [1]:  A =  M∑  e=1  cTe aece, (1.2)  f = M∑  e=1  cTe fe, (1.3)  127    Параллельные схемы метода сопряженных градиентов  где M – число конечных элементов, ae ∈ Rn×n, ce ∈ Zn×N , fe ∈ Rn, n – число неизвестных одного конечного элемента. Матрица инциндентности ce конечного элемента e [2] – это булева матрица, определяемая следующим образом: ce – прямоугольная матрица n × N , причем cij = 1, если неизвестная j является i-й неизвестной конечного элемента, и cij = 0 в другом случае.  Выражения (1.2), (1.3) можно записать другим способом [3]:  A = CT ÃC, (1.4)  f = CT f̃ , (1.5)  где Ã ∈ RN1×N1 , f̃ ∈ RN1 , C ∈ ZN1×N , N1 = n ·M . Матрица Ã = [Aii] – блочно-диагональная матрица с блоками Aii = ae, C  T =[ CT1 , C  T 2 , . . . , C  T M  ] , CTi = c  T e , i, e = 1, 2, . . . ,M . Введем векторы,  получаемые по следующему правилу:  x̄ = Cx, x̄ ∈ RN1 , x ∈ RN , (1.6)  и скалярное произведение  xT y = (CT x̃)TCT ỹ = x̃TCCT ỹ = x̃T ȳ. (1.7)  В работе [3] введен способ вычисления скалярных произведений через векторы (1.6), отличный от (1.7). При его использовании может накапливаться погрешность, связанная с представлением бесконечных дробей в конечной арифметике ЭВМ.  2 Алгоритм метода сопряженных градиентов  Для систем (1.1) большой размерности с положительно определенной матрицей коэффициентов применяется метод сопряженных градиентов (МСГ). Различные варианты этого метода рассматриваются во многих работах, например, [1], [3] - [9]. Приняв за основу формулы для МСГ из [6] и учитывая (1.2) - (1.7), получим  Ã ∈ RN1×N1 , f̃ , r̃, r̄, q̃, q̄, p̄, ū ∈ RN1 , α, β, ρ, γ, ε ∈ R1;  – Инициализация:  ū0 = 0, r̃0 = f̃ − Ãū0, r̄0 = CCT r̃0, p̄0 = r̄0, ρ0 = r̃T0 r̄0.  128    М.Ю. Альес, С.П. Копысов, А.К. Новиков  – Итерационное уточнение k = 0, 1, . . . :  q̃k = Ãp̄k; (2.1)  q̄k = CC T q̃k; (2.2)  γk = q̃ T k p̄k; (2.3)  αk = ρk/γk; (2.4)  ūk+1 = ūk + αkp̄k; (2.5)  r̃k+1 = r̃k − αkq̃k; (2.6) r̄k+1 = r̄k − αkq̄k; (2.7) ρk+1 = r̃  T k r̄k; (2.8)  если ρk+1/ρ0 < ε, то выход; (2.9)  βk = ρk+1/ρk; (2.10)  p̄k+1 = r̄k+1 + βkp̄k. (2.11)  Данный алгоритм позволяет решать систему уравнений, не формируя ее в каноническом виде (1.1).  3 Параллельные схемы МСГ  При решении краевых задач на многопроцессорных ЭВМ выражения (1.2), (1.3) имеют вид  A =  P∑  I=1  M∑  e=1  cTe aece, f =  P∑  I=1  M∑  e=1  cTe fe, (3.1)  где P – число процессоров ЭВМ. Для применения блочного распараллеливания в МСГ [8], [9] необходимо собрать матрицу коэффициентов A и вектор правой части f , разделить на блоки и разослать блоки по вычислительным узлам ЭВМ (далее узлы).  В отличие от [8], [9] в рассматриваемой далее схеме (см. также [10]) разбиение отличается тем, что разбиение на блоки матрицы коэффициентов и векторов задается отображением конечноэлементной сетки на сеть узлов ЭВМ. Данный алгоритм основан на схеме (2.1) - (2.11) и равенствах (1.4) - (1.5), записанных в виде  A =  P∑  I=1  CTI ÃIICI , f =  P∑  I=1  CTI f̃I , (3.2)  129    Параллельные схемы метода сопряженных градиентов  где ÃII = [aii] ∈ RN2×N2 , aii = ae, CI ∈ ZN2×N , CI = [Ci] , Ci = ce, i = 1, 2 . . . , N2, e = N2(I−1)+1, N2(I−1)+2, . . . , N2 · I, f̃I ∈ RN2 , N2 = N1/P .  Пусть xI – вектор, помещенный в вычислительный узел I, та кой, что x = P∑  I=1  xI , где xI , x ∈ RN . Тогда его можно представить в виде суммы принадлежащих узлу I (внутренних) и общих для нескольких узлов слагаемых:  xI = C T I (x̃  Com I + x̃  In I ) +  PI∑  J=1  xExIJ , (3.3)  где CTI x̃ Com I – общие слагаемые, принадлежащие узлу I; C  T I x̃  In I –  внутренние слагаемые; PI∑ J=1  xExIJ – сумма внешних слагаемых с уз лов, смежных с I; PI – число смежных с I узлов; x Ex IJ = C  T J x̃  Com JI ;  CTI , C T J – части C  T , соответствующие блокам узлов I и J . Соответственно x̄I = CIxI , x̄I ∈ RN2 , CI ∈ ZN2×N .  Вычисляя ρk+1 через (r̃k − αkq̃k, r̄k − αk q̄k) и учитывая (3.3), получим следующую схему:  ÃII ∈ RN2×N2 , f̃I , r̃I , r̄I , q̃I , q̄I , p̄I , ūI ∈ RN2 ,  αI , βI , ρI , γI , α, β, ρ, γ, ε ∈ R1.  – Инициализация:  ū0I = 0, r̃0I = f̃I − ÃII ū0I ,  r0I = C T I r̃0I +  PI∑  J=1  rEx0IJ ,  r̄0I = CIr0I , p̄0I = r̄0I , ρ0I = r̃ T 0I r̄0I , ρ0 =  P∑  I=1  ρ0I .  130    М.Ю. Альес, С.П. Копысов, А.К. Новиков  – Итерационное уточнение k = 0, 1, . . . :  q̃kI = ÃII p̄kI ; (3.4)  qkI = C T I (q̃  Com kI  + q̃InkI ) +  PI∑  J=1  qExkIJ ; (3.5)  q̄kI = CIqkI ; (3.6)  ωkI = q̃ T kI r̄kI ; (3.7)  θkI = q̃ T kI q̄kI ; (3.8)  γkI = q̃ T kI p̄kI ; (3.9)  γk =  P∑  I=1  γkI , ωk =  P∑  I=1  ωkI , θk =  P∑  I=1  θkI ; (3.10)  αk = ρk/γk; (3.11)  ūk+1I = ūkI + αkp̄kI ; (3.12)  r̄k+1I = r̄kI − αk q̄kI ; (3.13) ρk+1 = ρk − 2αkωk + α2kθk; (3.14)  если ρk+1/ρ0 < ε, то выход; (3.15)  βk = ρk+1/ρk; (3.16)  p̄k+1I = r̄k+1I + βkp̄kI . (3.17)  Данная схема требует две коммуникации на итерации при выполнении операций (3.5) и (3.10) за счет вычисления ρk+1 через (3.7), (3.8), (3.14). В то же время при параллельном выполнении (2.1) - (2.11) необходимы три коммуникации.  Сокращение затрат на коммуникации достигается также при совмещении вычислений и коммуникаций при выполнении (3.5), т. к. обмен общими слагаемыми может производиться одновременно с вычислениями внутренних слагаемых. Для этого сначала вычисляются общие слагаемые, после чего обмены можно совмещать с вычислениями.  Для решения системы с k правыми частями число векторов и операций над векторами необходимо увеличить в k раз, что аналогично увеличению размерности векторов при исходном числе векторных операций. Итерационное уточнение в этом случае завершается по наименее сходящемуся процессу.  131    Параллельные схемы метода сопряженных градиентов  4 Численные исследования  Рассмотренные схемы использовались при решении плоских задач теории упругости в перемещениях с использованием h-версии метода конечных элементов [10]. Вычисления осуществлялись на 8-узловой параллельной вычислительной системе MIMD архитектуры Parsytec CC-8. Время исполнения, оценки ускорения и эффективности, полученные при решении системы с N = 23338 неизвестными на сетке из M = 23049 треугольных элементов, приведены в таблице 1.  Число процессоров, P 1 2 4 8 Время в сек., TP 967.35 519.09 246.56 137.18 Ускорение, SP 1 1.86 3.92 7.05 Эффективность в %, EP 100 93 98 88.1  Таблица 1: Ускорение SP = T1/TP и эффективность EP = (SP /P )100%  Совмещение обменов с вычислениями и уменьшение числа обменов на каждой итерации позволили снизить временные затраты в сравнении с параллельным выполнением алгоритма (2.1) (2.11) на 15-20%.  Литература  [1] Фрид. Еще о градиентных итерационных методах в конечноэлементных исследованиях // Ракетная техника и космонавтика, 1969. – Т. 7. – N 3. – С. 213-215.  [2] Писсанецки С. Технология разреженных матриц. – М.: Мир, 1988. – 416 с.  [3] Barragy E., Carey G.F., van de Geun R. Perfomance and Scalability of Finite Element Analysis for Distributed Parallel Computation // J. of Parallel and Distributed Computing. 1994. – V 21. – P. 202-212.  [4] Самарский А.А., Гулин А.В. Численные методы. – М.: Наука, 1989. – 432 с.  132    Е.М. Андреева, Г.В. Муратова  [5] Бахвалов Н.С., Жидков Н.П., Кобельков Г.М. Численные методы. – М.: Наука, 1987. – 600 с.  [6] Хейгман Л., Янг Д. Прикладные итерационные методы. – М.: Мир, 1986. – 448 с.  [7] Воеводин В.В., Кузнецов Ю.А. Матрицы и вычисления. – М.: Наука, 1984. – 320 с.  [8] Рябенький В.С. Введение в вычислительную математику. – М.: Наука, 1994. – 336 с.  [9] Ортега Дж. Введение в параллельные и векторные методы решения линейных систем. – М.: Мир, 1991. – 368 с.  [10] Копысов С.П., Альес М.Ю., Новиков А.К., Устюжанин С.Л. Методы декомпозиции для решения задач деформирования с динамическим перестроением сеточных моделей // Высокопроизводительные вычисления и их приложения. Тр. Всеросс. научной конференции, г. Черноголовка, 30.10 2.11.2000 г. – М.: МГУ, 2000. – С. 119-122.  МОДИФИКАЦИЯ МНОГОСЕТОЧНОГО МЕТОДА ДЛЯ РЕШЕНИЯ ЗАДАЧИ  КОНВЕКЦИИ-ДИФФУЗИИ С МАЛЫМ ПАРАМЕТРОМ 1  Е.М. Андреева, Г.В. Муратова Ростовский государственный университет, г. Ростов-на-Дону  Введение  Математическое моделирование процесса конвекции-диффузии широко применяется при решении многих научных и инженерных задач. Существует большое количество конкретных природ 1Работа выполнена при финансовой поддержке РФФИ, проект N 00-01 00011  133   