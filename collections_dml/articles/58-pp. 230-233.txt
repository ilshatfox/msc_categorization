 «ЛОБАЧЕВСКИЕ ЧТЕНИЯ - 2019»  УДК 004.93’12  РАСПОЗНАВАНИЕ ОБЪЕКТОВ НА ФОТОГРАФИИ С ИСПОЛЬЗОВАНИЕМ АРХИТЕКТУРЫ НЕЙРОННОЙ СЕТИ YOLO V3  А.А. Бердников1, Н.М. Давлетшин2  1 andreyberdnikov1998@gmail.com; Казанский (Приволжский) федеральный университет, Институт вычислительной математики и информационных технологий 2 davlet-9@ya.ru; Казанский (Приволжский) федеральный университет, Институт вычислительной математики и информационных технологий  Статья посвящена созданию системы обноружения объектов на фотографиях из социалной сети Вконтакте, для последуючего анализа содержимых объектов. Приведен разбор одной из передовой системы, обнаружения объектов в реальном времени - YOLO.  Ключевые слова: YOLO, нейронные сети, глубокое обучение, обнаружение объектов на фотографиях, распознавание объектов на фотографиях  Обнаружение объектов на фотографиях с помощью нейросетей находит свое применение в многочисленных проектах. Существуют различные методы для нахождения объектов на фотографиях, такие как: R-CNN, Fast-RCNN, Faster-RCNN, RetinaNet, SSD и YOLO.  Данные для обработки нейросетью получены со страниц пользователей социальной сети Вконтакте.  Для получения данных выполняется запрос к методу users.get API Вконтакте. Пример запроса (студент Давлетшин Нагим):  1 r = requests.get("https://api.vk.com/method/users.get", 2 params={"user_ids": 444599814,"fields":"crop_photo", 3 "access_token": access_token,"v": 5.101})  В ответе на запрос приходит ссылка на фотографию:url: ht t ps : //sun9−27.u...44c/−2G HY Sn4kQ. j pg API ВКонтакте — это интерфейс, который позволяет получать информацию из  базы данных vk.com с помощью http-запросов к специальному серверу.[5] Основной целью исследования являлась разработка системы для анализа со держимого главной фотографии с личных страниц социальной сети ВКонтакте пользователей.  Глубокое обучение — Deep learning — это набор алгоритмов машинного обучения, которые моделируют высокоуровневые абстракции в данных, используя архитектуры, состоящие из множества нелинейных преобразований.[1]  YOLO - это алгоритм, который использует глубокие сверточные нейронные сети для обнаружения объектов.  Самое большое преимущество модели YOLO, отражено в названии — You Only Look Once. Эта модель накладывает на изображение сетку, разделяя его на ячейки. Каждая ячейка пытается предсказать координаты зоны обнаружения с оценкой уверенности для этих полей и вероятностью классов. Затем оценка уверенности для каждой зоны обнаружения умножается на вероятность класса, чтобы получить окончательную оценку. Пример работы модели YOLO проиллюстрирован на Рис.1.    А.А. Бердников, Н.М. Давлетшин 231  Рис. 1. Архитектура работы YOLO v3  В рамках данного исследования были использованы язык программирования Python 3.6 (библиотеки: numpy, time, cv2).  Решение поставленной задачи производилось по следующему алгоритму. Для начала загружаются метки классов и устанавливаются случайные цвета для  каждого. Указываются пути к файлам весов и конфигурации YOLO с последующей за грузкой YOLO с диска. Для загрузки YOLO, используется функция cv2.dnn.readNetFromDarknet  (OpenCV) которая обязательно должна принимать параметры configPath и weightsPath:  Далее изображение загружается в нейросеть и извлекаются его размеры. Определяются имена выходных слоев из модели YOLO. Строится blob с картинки (функция cv2.dnn.blobFromImage) и выполняется прямой проход через сеть YOLO.  В дальнейшем проходясь по слоям изображения, выделяются объекты слоя и для каждого определяется его классовое название и вероятность. Если найденная вероятность объекта не меньше заданного минимума, то у данного объекта извлекаются начальные координаты x, y, а также ширина и высота. После применяется «подавление не максимума»(детектор границ Кэнни).  Полученные объекты на фотографии выделяются цветной (для каждого объекта изначально был задан свой цвет) прямоугольной рамкой. Также для дальнейшего анализа данные об объектах записывались в csv файл в виде: название файла, имя объекта и вероятность.  Пример найденных объектов после обработки изображения на YOLO приведен на Рис.2.  В заключении результата нашего исследования была достигнута основная цель — разработка системы для анализа содержимого главной фотографии с личных    232 «ЛОБАЧЕВСКИЕ ЧТЕНИЯ - 2019»  Рис. 2. Обнаруженные объекты на изображении  страниц социальной сети ВКонтакте пользователей.  Благодарности  Исследование выполнено за счет гранта Российского научного фонда (проект №19-18-00253, «Нейросетевая психометрическая модель когнитивноповеденческих предикторов жизненной активности личности на базе социальных сетей»)  Литература  1. Франсуа Ш. Глубокое обучение на Python – СПб.: Питер, 2018. — 400 с.  2. Тархов Д. А. Нейросетевые модели и алгоритмы. Справочник / Д.А. Тархов. // М.: Радиотехника, 2014. - 6191 c.  3. Хайкин С. Нейронные сети. Полный курс / Саймон Хайкин. – М.: Вильямс, 2016. - 807 c.  4. Kosinski M.Deep neural networks aremore accurate than humans at detecting sexual orientation from facial images /M. Kosinski, Y.Wang // Journal of Personality and Social Psychology, 2018. - №114(2). - Pp. 246-257.  5. Документация об использовании API ВКонтакте[Электронный ресурс] /Mail.ru Group// Документация API ВКонтакте URL: https://vk.com/dev/manuals.  RECOGNIZING OBJECTS IN A PHOTOGRAPH USING THE NEURAL NETWORK ARCHITECTURE YOLO V3  A.A. Berdnikov, N.M. Davletshin  The article is devoted to the creation of a system for detecting objects in photographs from the social network Vkontakte, for the subsequent analysis of the contents of objects. The analysis of one of the advanced systems, real-time object detection - YOLO.    Н.М. Давлетшин, А.А. Бердников, П.Н. Устин 233  Keywords: YOLO, neural networks, deep learning, detection of objects in photographs, recognition of objects in photographs  УДК 004.421  МЕТОДЫ АВТОМАТИЧЕСКОГО СБОРА ИНФОРМАЦИИ ОБ АКТИВНОСТИ ПОЛЬЗОВАТЕЛЕЙ СОЦИАЛЬНОЙ СЕТИ ВКОНТАКТЕ  Н.М. Давлетшин1, А.А. Бердников2, П.Н. Устин3  1 davlet-9@ya.ru; Казанский (Приволжский) федеральный университет, Институт вычислительной математики и информационных технологий 2 andreyberdnikov1998@gmail.com; Казанский (Приволжский) федеральный университет, Институт вычислительной математики и информационных технологий 3 pavust@mail.ru; Казанский (Приволжский) федеральный университет, Институт психологии и образования  Целью данной работы является исследование методов, позволяющих производить автоматизированный сбор данных об активности пользователей в социальной сети «ВКонтакте». На языке Python c использованием методов API VK разработаны высокопроизводительные алгоритмы, которые позволяют отслеживать время нахождения пользователя в социальной сети, а также алгоритмы, позволяющие получать информацию о "лайках проставленных пользователем на интересных страницах и страницах друзей.  Ключевые слова: ВКонтакте, социальная сеть, сбор данных, активность пользователей, API, запрос API, API ВКонтакте, прогностика, психометрия  На сегодняшний день в жизни современного человека социальные сети играют важную роль. При помощи социальных сетей миллионы людей общаются и делятся информацие по всему миру. Пользователи ежедневно пополняют свой профиль огромным количеством данных, которые отражают разнообразные аспекты их «виртуального Я», дают возможность как диагностировать их личностные особенности, так и прогнозировать вероятное поведение в реальной жизни. В связи с этим отмечается значительный интерес исследователей к проектам, посвященным проблеме предсказания поведения пользователей социальных сетей на основе психометрических данных, отраженных в их персональных профилях. Наиболее известными здесь выступают работы, выполненные в рамках проекта «Моя личность». Данный проект объединяет более 200 ученых со всего мира, которые занимаются проблемой психометрических показателей поведения личности в социальных сетях (прежде всего, «Фейсбук»). К настоящему времени ими уже выделены различные маркеры, которые позволяют прогнозировать поведение человека на основе его виртуальных следов в социальных сетях [2, 3].  Самой популярной социальной сетью в Росии является социальная сеть ВКонтакте. Этим онлайн сервисом пользуются не только в России, но и по всему миру. На данный момент количество пользователей Вконтакте составляет около 565 миллионов. Однако на сегодняшний день, несмотря на актуализацию российских исследовательских проектов, связанных с прогностическими возможностями социальной   