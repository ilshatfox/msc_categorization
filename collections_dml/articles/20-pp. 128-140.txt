. – УФА ИМВЦ УНЦ РАН, 2000.  [3] Popov A.V. Of finite difference sheme for viscous weakly compressible gas problem//Department of Mathematics Univesity of Nijmengen. Report No 9617. – The Netherlands, 1996. – P. 1–13.  [4] Темам Р. Уравнения Навье-Стокса. – М.: Мир, 1981.  [5] Чижонков Е.В. Релаксационные методы решения седловых задач. – М.: ИВМ РАН, 2002. – 239 с.  [6] Яненко Н.Н. Метод дробных шагов решения многомерных задач математической физики. – Новосибирск, 1966.  ПРИМЕНЕНИЕ СМЕШАННЫХ ГИБРИДНЫХ ЭЛЕМЕНТОВ ПРИ РЕШЕНИИ ЭЛЛИПТИЧЕСКИХ  ОДНОСТОРОННИХ КРАЕВЫХ ЗАДАЧ 1  М.А. Игнатьева НИИММ им. Н.Г. Чеботарева КазГУ, г. Казань  Ю.А. Кузнецов Университет Хьюстона, г. Хьюстон  А.В. Лапин Казанский государственный университет, г. Казань  1 Введение  Смешанные и смешанные гибридные формулировки краевых задач с дифференциальными операторами второго порядка позволяют применять методы конечных элементов (МКЭ) с одновременной аппроксимацией искомой функции и ее градиента.  Теория смешанных и гибридных МКЭ достаточно полно развита для линейных краевых задач (см. монографии [1, 2] и библиографии в них), существенные результаты по сходимости и точности таких конечных элементов получены для нелинейных эллиптических уравнений (см., например, [3–9]).  1Работа выполнена при поддержке РФФИ, проект № 01-01-00068  129    Применение смешанных гибридных элементов . . .  В результате применения смешанных и смешанных гибридных аппроксимаций получаются системы сеточных уравнений с так называемым седловым оператором. Одной из ключевых проблем становится построение эффективных итерационных методов решения соответствующих систем уравнений.  В работе [10] построен спектрально эквивалентный предобусловливатель для конденсированной матрицы смешанной гибридной аппроксимации линейного эллиптического уравнения при применении элементов первого порядка. В качестве предобусловливателя выступает сеточный оператор Лапласа на более мелкой сетке. Это позволяет применять разработанные методы и программное обеспечение при реализации соответствующих итерационных методов.  В настоящей работе результаты [10] обобщены на случай эллиптических вариационных неравенств с ограничениями на границе. Основное внимание уделено задаче Синьорини. Для рассматриваемых вариационных неравенств построены смешанные гибридные схемы КЭ первого порядка.  В результате так называемой процедуры конденсации соответствующие схемы МКЭ сводятся к сеточным вариационным неравенствам относительно вспомогательных переменных (по существу, множителей Лагранжа) с симметричной положительно определенной матрицей. Согласно [10] эта матрица спектрально эквивалентна дополнению Шура сеточного оператора Лапласа на более мелкой сетке, что позволяет построить итерационные методы, где этот сеточный оператор Лапласа является предобусловливателем. Построенный итерационный метод сходится со скоростью, не зависящей от параметров сетки. Следует однако отметить, что реализация каждого шага этого метода состоит в решении сеточного вариационного неравенства с сеточным оператором Лапласа и, тем самым, эффективность построенного метода зависит от эффективности соответствующей двуступенчатой процедуры его реализации.  2 Постановка задачи  Подробное описание аппроксимации и построение метода проведем на примере задачи Синьорини.  130    М.А. Игнатьева, Ю.А. Кузнецов, А.В. Лапин  Пусть Ω ⊂ R2 – область с кусочно-гладкой границей ∂Ω = = ΓD ∪ ΓN ∪ ΓC , где ΓD,ΓN и ΓC – непересекающиеся части ∂Ω и mes ΓD 6= ∅. Пусть также V = {p ∈ H1(Ω) : p(x) = 0 п. вс. на ΓD}, K = {p ∈ V : p(x) > 0 п. вс. на ΓC} – выпуклое замкнутое множество.  Рассмотрим задачу: найти функцию p ∈ K, удовлетворяющую в области Ω вариационному неравенству  ∫  Ω  ∇p∇(q − p)dx > ∫  Ω  f(q − p)dx ∀q ∈ K. (2.1)  Отметим, что решение данного вариационного неравенства является обобщенным решением краевой задачи, поточечную запись которой можно представить в следующем виде:      −∆p = f в Ω, p = 0 на ΓD, ∂p  ∂n = 0 на ΓN ,  p > 0, ∂p  ∂n > 0, p  ∂p  ∂n = 0 на ΓC .  3 Смешанная постановка  Введем новую переменную ū и запишем задачу относительно пары неизвестных ū и p:      ū−∇p = 0, div ū = −f в Ω, p = 0 на ΓD,  ū · n̄ = 0 на ΓN , p > 0, ū · n̄ > 0, (ū · n̄)p = 0 на ΓC .  (3.1)  Чтобы определить слабое решение задачи (3.1), введем следующие пространства: H(div,Ω) = {ū ∈ L2(Ω)n : div ū ∈ L2(Ω)} с нормой ‖ū‖2 =  ∫ Ω (|ū|2 + | div ū|2)dx, H(div,Ω) = {ū ∈ H(div,Ω) :  ū·n̄ ∈ L2(∂Ω)} с нормой ‖ū‖2H = ‖ū‖2+ ∫ ∂Ω  (ū·n̄)2dΓ иHN (div,Ω) = = {ū ∈ H(div,Ω) : ū · n̄ = 0 п. вс. на ΓN}. Пусть также K = {ū ∈  131    Применение смешанных гибридных элементов . . .  HN (div,Ω) : ū · n̄ > 0 п. вс. на ΓC} – выпуклое замкнутое подмножество HN (div,Ω). Под слабым решением задачи (3.1) понимаем пару (ū, p) ∈ K × L2(Ω), удовлетворяющую соотношениям      ∫  Ω  ū(v̄ − ū)dx+ ∫  Ω  p div(v̄ − ū)dx > 0 ∀v̄ ∈ K, ∫  Ω  div ū · qdx = − ∫  Ω  fqdx ∀q ∈ L2(Ω). (3.2)  4 Гибридная поставка  Смешанная гибридная постановка основана на разбиении области Ω на непересекающиеся подобласти (элементы). Пусть Ω̄ = = ⋃m i=1 ēi, где ēi – подобласти с кусочно-гладкими границами ∂ei,  ei ∩ ej = ∅ для i 6= j, а ēi и ēj могут иметь только либо общую вершину, либо общую сторону, которую обозначим через Γij , где i 6= j, i, j = 1,m. Далее предположим, что граница области Ω состоит из s отрезков, которые обозначим через Γ1, . . . ,Γs. Пусть разбиение построено таким образом, что части границы ΓD,ΓN и ΓC составлены из целых сторон элементов ei. Пересечение сторон элементов ∂ei с Γj , j = 1, s обозначим через Γi,m+j , i = 1,m, j = 1, s. Пусть, кроме того, Γi,m+j для j = 1, s1, s1 < s составляют часть границы ΓN ∪ ΓC , в то время как остальные Γi,m+k, k = s1 + 1, s – часть границы ΓD.  Пусть ū = (ū1, . . . , ūm), p = (p1, . . . , pm), тогда система (3.1) может быть записана в виде      ūi −∇pi = 0, div ūi = −fi на ei, i = 1,m, pi − pj = 0, ūi − ūj = 0 на Γij , i, j = 1,m, pi = 0 на ΓD ∩ Γi,m+j , i = 1,m, j = 1, s ūi · n̄i = 0 на ΓN ∩ Γi,m+j , i = 1,m, j = 1, s, ūi · n̄i > 0, pi > 0, (ūi · n̄i)pi = 0  на ΓC ∩ Γi,m+j , i = 1,m, j = 1, s,  (4.1)  где n̄i – вектор внешней нормали к ∂ei, fi – значение функции f на элементе ei.  132    М.А. Игнатьева, Ю.А. Кузнецов, А.В. Лапин  Умножив уравнения первой строки системы на соответствующие пробные функции и применив в первом уравнении формулу интегрирования по частям, получим      ∫  ei  ūi · v̄idx+ ∫  ei  pi div v̄idx− ∫  ∂ei  pi(v̄i · n̄i)dΓ = 0  ∀v̄i ∈ H(div, ei),∫  ei  qi div ūidx = − ∫  ei  fiqidx ∀qi ∈ L2(ei), (4.2)  где пространство H(div, ei) определено подобно H(div,Ω). Пусть λij = pi|Γij = pj |Γij , i, j = 1,m и λi,m+j = pi|Γi,m+j , i = 1,m, j = 1, s, тогда первое уравнение (4.2) может быть записано как  ∫  ei  ūi · v̄idx+ ∫  ei  pi div v̄idx−  − ∑  i<j  ∫  Γij  λij(v̄i · n̄ij)dΓ + ∑  i>j  ∫  Γij  λij(v̄i · n̄ji)dΓ = 0, (4.3)  где n̄ij – вектор нормали к границе элементов ei и ej , направленный от ei к ej . На основании (4.1), (4.2) и (4.3) мы можем определить смешанную гибридную формулировку задачи (2.1).  Пусть V = (HN (div, ei))m, Q = (L2(ei))m и W = ∏ i<j L2(Γij).  Пусть также Mad = {λ ∈W : λi,m+j > 0 на Γi,m+j ∩ΓC} – выпуклое замкнутое подмножество пространства W . Определим билинейные формы  M(ū, v̄) = m∑  i=1  ∫  ei  ūi · v̄idx, B(p, v̄) = m∑  i=1  ∫  ei  pi div v̄idx,  C(λ, v̄) = m∑  i=1  m∑  j=i+1  ∫  Γij  λij(v̄j − v̄i) · n̄ijdΓ−  − m∑  i=1  s1∑  j=1  ∫  Γi,m+j  λi,m+j(v̄i · n̄i,m+j)dΓ  133    Применение смешанных гибридных элементов . . .  и линейный функционал  F (q) = m∑  i=1  ∫  ei  fiqidx.  Будем искать тройку (ū, p, λ) ∈ V × Q ×Mad, удовлетворяющую следующим соотношениям:      M(ū, v̄) + B(p, v̄) + C(λ, v̄) = 0 ∀v ∈ V, B(q, ū) = −F (q) ∀q ∈ Q, C(λ− µ, ū) 6 0 ∀µ ∈Mad.  (4.4)  Справедливо следующее  Предложение 4.1. Если (ū, p, λ) – решение задачи (4.4), то функция p = (p1, . . . , pm), pi = p|ei – решение задачи (2.1). Обратно, если p – решение задачи (2.1), обладающее дополнительной гладкостью так, что ∂p/∂n ∈ L2(S) для любой гладкой кривой S ⊂ Ω̄ (n̄ – нормаль к S), то вектор (ū, p, λ) с ui = ∇pi, λi = p|∂ei есть решение задачи (4.4).  5 Аппроксимация  Далее предположим, что в качестве области Ω выбран единичный квадрат. Построим в Ω квадратную сетку с шагом h = 1/n, где n – целое число. Линии сетки определяют разбиение области на квадратные элементы ei. Определим следующие конечномерные пространства.  Пусть Vh = {ū = (ū1, . . . , ūm) : ūi = (u1i , u2i ) ∈ P1,0×P0,1 на ei}, Qh = {p̄ = (p1, . . . , pm) : pi ∈ P0,0 на ei}, где Pk,l – пространство полиномов степени k по направлению x1 и степени l по x2, и Wh = {λij ∈ P0 на Γij}. Заменив в уравнениях (4.4) функции соответствующими конечномерными аппроксимациями и использовав затем процедуру сборки, получим в итоге уравнение относительно неизвестных (ū, p, λ), которое можно записать в матричновекторном виде    M BT CT  B 0 0 C 0 0      ū p λ   +     0 0  −Σ(λ)    3     0 −f 0    , (5.1)  134    М.А. Игнатьева, Ю.А. Кузнецов, А.В. Лапин  где Σ – диагональный максимально монотонный оператор, отвечающий за условия, накладываемые на искомую функцию на границе ΓC , а матрицы M , B и C определяются билинейными формами, аппроксимирующими, соответственно,M, B и C в (4.4). Здесь за векторами узловых параметров сохранены обозначения, используемые для соответствующих функций. Значения pi относим к серединам ячеек ei, а значения u  1 i , u  2 i и λij – к серединам  соответствующих сторон элементов.  Представим уравнение (5.1) в виде      Mū+BT p+ CTλ = 0,  Bū = −f, Cū− Σλ 3 0.  (5.2)  Выразив последовательно из первого уравнения ū, из второго p и подставив полученные выражения в последнее уравнение системы, получим так называемое "конденсированное" уравнение (включение) относительно λ  Sλ+Σλ 3 F, (5.3)  где  S = CM−1CT − CM−1BT (BM−1BT )−1BM−1CT ,  F = −CM−1BT (BM−1BT )−1f.  Заметим, что S – симметричная положительно определенная матрица.  6 Предобусловливатель  Построим предобусловливатель для уравнения (5.3), для чего в области Ω введем сетку с шагом h/2 и обозначим через A матрицу, соответствующую аппроксимации оператора Лапласа на стандартном пятиточечном шаблоне на этой сетке. Узлы мелкой сетки разобьем на две группы: к первой отнесем точки, соответствующие узлам λ на исходной сетке, ко второй – все остальные (назовем их фиктивными узлами, а соответствующие им узловые  135    Применение смешанных гибридных элементов . . .  параметры обозначим через λ̃). Это разбиение определяет соответствующее разбиение оператора A на блоки:  A = ( A11 A12 A21 A22  )( λ  λ̃  ) .  В работе [10] показано, что оператор S эквивалентен дополнению Шура  SA = A11 −A12A−122 A21 с константами эквивалентности, не зависящими от шага сетки. В частности, в случае рассматриваемой задачи на квадратной сетке справедливы неравенства  (SAµ, µ) 6 (Sµ, µ) 6 3(SAµ, µ) ∀µ. (6.1)  Использовав оценки эквивалентности S и SA и свойство максимальной монотонности оператора Σ, заключаем, что выбрав оператор SA в качестве предобусловливателя, получим итерационный метод решения вариационного неравенства (5.3) со скоростью сходимости не хуже, чем для линейного уравнения с матрицей S.  7 Итерационный метод и его реализация  Итак, для решения (5.3) будем использовать следующий итерационный процесс  SA λn+1 − λn  τ + Sλn +Σλn+1 3 F. (7.1)  Использовав оценки спектра (6.1), получим, что метод (7.1) сходится при τ ∈ (0, 2/3), и теоретически оптимальным параметром является τ = 0.5.  Операцию обращения дополнения Шура SA можно свести к обращению оператора Лапласа на сетке с шагом h/2, использовав следующий прием. Дополним уравнение (5.3) до системы уравнений на мелкой сетке фиктивными  { Sλ+Σλ 3 F, 0 = 0  136    М.А. Игнатьева, Ю.А. Кузнецов, А.В. Лапин  и запишем для этой расширенной системы итерационный процесс с оператором A в качестве предобусловливателя:    A11  λn+1 − λn τ  +A12 λ̃n+1 − λ̃n  τ + Sλn +Σλn+1 3 F,  A21 λn+1 − λn  τ +A22  λ̃n+1 − λ̃n τ  + 0 = 0.  (7.2)  Выразив из второго уравнения фиктивные компоненты и подставив полученное выражение в первое уравнение, можно убедиться, что соотношения (7.2) – эквивалентная запись итерационного процесса (7.1).  При реализации (7.2) на каждой итерации следует вычислять выражение F − Sλn. Это легко сделать, использовав равенство  F − Sλn = Cun.  Таким образом, для нахождения решения (5.1) получаем следующий алгоритм.  1. Задаем λ0.  2. Для n > 0 на каждом из элементов ei находим p n i и ū  n i по  формулам pni = D  −1 i (fi −BTi M  −1 i C  T i λ  n i ),  uni = −M−1i (BTi pni + CTi λni ). Здесь Di = BiM  −1 i B  T i – диагональная матрица, индекс i  показывает, что все матрицы в выражениях локальные, и вычисления pi, ūi производятся для каждого элемента независимо от других.  3. Вычисляем Cun.  4. Находим (λn+1, λ̃n+1) как решение уравнения  A τ  ( λn+1 − λn λ̃n+1 − λ̃n  ) +  ( Σλn+1  0  ) 3 ( Cun  0  ) . (7.3)  5. n := n+ 1, переход к п. 2.  137    Применение смешанных гибридных элементов . . .  Замечание 7.1. Полученный алгоритм легко переносится на случай, когда Σ – произвольный диагональный максимально монотонный оператор. Например, приведенные выше рассуждения справедливы для вариационного неравенства  ∫  Ω  ∇p∇(q − p)dx+ ∫  ΓC  |q| − |p|dΓ > ∫  Ω  f(q − p)dx ∀q ∈ V, (7.4)  где V = {p ∈ H1(Ω) : p = 0 п. вс. на ΓD}. Здесь в качестве оператора Σ выступает функция Хевисайда.  8 Численные результаты  В тестовых расчетах в качестве области Ω был выбран единичный квадрат, расчеты проводились на квадратной сетке. Граница области состояла из следующих частей: ΓC = {(x1, 0), 0 < x1 < 1}∪ ∪{(1, x2), 0 < x2 < 0.5}, ΓN = {(0, x2), 0 < x2 < 1}∪{(1, x2), 0.5 < < x2 < 1}, ΓD = {(x1, 1), 0 < x1 < 1}. Во всех задачах правая часть задавалась формулой f = 4π2 sin(2πx)y(1− y) + 2 sin(2πx).  Для обращения оператора на верхнем слое итерационного процесса (7.3) был использован итерационный процесс – поточечный метод верхней релаксации (SOR). Релаксационные итерации продолжались, пока не выполнилось условие ‖µn+1 − µn‖L2 < < 10−13, где µ = (λ, λ̃). Условие выхода из внешнего процесса – ‖λn+1 − λn‖L2 < 10−12. В качестве итерационного параметра τ взят теоретически оптимальный, т. е. τ = 0.5, в методе SOR использован оптимальный параметр метода для решения задачи Дирихле на сетке соответствующей размерности [11].  Была проведена серия расчетов на сетках с различными шагами. В первом столбце табл. 1 указано число точек сетки по обоим направлениям, в остальных – число внешних итераций. Во втором столбце приведены результаты работы программы для задачи Дирихле с однородными краевыми условиями, т. е. в случае ΓD = ∂Ω, в третьем – для вариационного неравенства (2.1) и в четвертом – для вариационного неравенства (7.4). Из таблицы видно, что число итераций для вариационных неравенств оказывается практически таким же, как и для уравнения (в случае  138    М.А. Игнатьева, Ю.А. Кузнецов, А.В. Лапин  уравнения число итераций несколько меньше из-за однородных краевых условий) и не зависит от шага сетки.  N ур-е Пуассона в. н. (2.1) в. н. (7.4) 11 36 39 38 21 37 39 38 41 37 39 39 81 37 39 39 161 38 39 39  Таблица 1: Число итераций для уравнения Пуассона и вариационных неравенств  Отметим, что приведенное число итераций необходимо для достижения очень высокой точности. В случае остановки по критерию ‖µn+1 − µn‖L2 < 10−4 достаточно сделать порядка десяти итераций.  Также были проведены эксперименты с неполным обращением оператора перехода итерационного процесса (7.1), из которых следует, что для сходимости достаточно лишь нескольких внутренних итераций. В табл. 2 мы сравнили суммарное число релаксационных итераций, требуемых для достижения точности ‖p−pex‖L2 < 10−4 в гибридной схеме и стандартной конечно-разностной схеме с аппроксимаций оператора Лапласа на пятиточечном шаблоне. В качестве pex взято решение, полученное численно при решении уравнений соответствующих схем с большой точностью. Для гибридного метода в таблице приведены: оптимальное число итераций внутреннего итерационного процесса – метода верхней релаксации, число внешних итераций и суммарное число релаксационных итераций. Оптимальность здесь понимается в смысле минимума общего числа итераций.  Из таблицы видно, что число итераций в методе, использованном для решения гибридной схемы, примерно в четыре раза больше, чем для стандартной конечно-разностной схемы, но следует отметить, что в этом случае в результате решения получаем также потоки, так что суммарное число неизвестных в уравнении гибридной схемы на сетке N ×N имеет порядок 3N 2. Основываясь на результатах расчетов, можно сделать вывод, что  139    Применение смешанных гибридных элементов . . .  Гибридная схема Стандартная схема N итерации внешние всего итерации  SOR итерации итераций SOR 11 2 80 160 31 21 4 80 320 77 41 8 81 648 153 81 17 75 1275 304 161 33 77 2541 605  Таблица 2: Число итераций для гибридной и конечно-разностной схем  при увеличении размерности сетки по обоим направлениям в два раза необходимо увеличить число внутренних итераций также в два раза, при этом число внешних итераций остается примерно одинаковым, независимо от шага сетки.  Литература  [1] Brezzi F., Fortin M. Mixed and hybrid finite element methods. – New-York: Springer Verlag, 1991.  [2] Roberts J.E., Thomas J.M. Mixed and hybrid methods//Numer. Anal. – 1991. – V. II. – P. 523–639.  [3] Farhloul M. A mixed finite element method for a nonlinear Dirichlet problem//IMA J. of Numer. Anal. – 1998. – V. 18. – P. 121–132.  [4] Milner F.A. Mixed finite element methods for quasilinear secondorder elliptic problems//Math. Comp. – 1985. – V. 44. – P. 303– 320.  [5] Milner F.A., Park E.-J. A mixed finite element method for a strongly nonlinear second order elliptic problem//Math. Comp. – 1995. – V. 64. – P. 973–988.  [6] Park E.-J. Mixed finite element methods for nonlinear second order elliptic problems//SIAM J. Numer. Anal. – 1995. – V. 32. – P. 865–885.  140   