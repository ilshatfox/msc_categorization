.  МЕТОД ДЕКОМПОЗИЦИИ ОБЛАСТИ НА ОСНОВЕ ФИКТИВНЫХ КОМПОНЕНТ ДЛЯ УРАВНЕНИЯ  ПУАССОНА 1  Р. З. Даутов, А. В. Лапин, С. Ю. Федотов  Казанский государственный университет, г. Казань  В работе предлагается новый итерационный метод решения системы сеточных уравнений, аппроксимирующей линейное эллиптическое уравнение второго порядка. Построение и исследование метода проводятся на примере однородной задачи Дирихле для уравнения Пуассона. Существо предлагаемого метода состоит в комбинации метода декомпозиции области (см., напр., [1]) и метода фиктивных компонент [2] – [4]. Вычислительные эксперименты подтверждают высокую эффективность предложенного метода, в частности, практическую независимость его скорости сходимости от шага сетки и преимущество по сравнению с некоторыми известными итерационными методами, основанными на декомпозиции области. Обоснование сходимости метода проведено для случая конечно-разностной аппроксимации рассматриваемой дифференциальной задачи в прямоугольной области.  1Работа выполнена при финансовой поддержке РФФИ, проект № 04-0100484  107    Метод декомпозиции области на основе фиктивных компонент. . .  1 Дифференциальная задача и ее исходная сеточная аппроксимация  В ограниченной многоугольной области Ω ⊂ R2 с границей ∂Ω = Ω̄ \ Ω рассмотрим дифференциальную задачу  −△u = f(x), x ∈ Ω,  u(x) = 0, x ∈ ∂Ω. (1.1)  Пусть V = H10 (Ω) — пространство Соболева функций из L2(Ω), имеющих обобщенные производные первого порядка и равных нулю на ∂Ω. Тогда задача (1.1) имеет следующую вариационную формулировку:  u ∈ V : ∫  Ω  ∇u · ∇v dx = ∫  Ω  fv dx ∀v ∈ V. (1.2)  Известно, что эта задача имеет единственное решение при любой правой части f ∈ L2(Ω).  Аппроксимируем (1.2) схемой метода конечных элементов (см., напр., [5]). Пусть Vh ⊂ V — пространство линейных треугольных конечных элементов, построенное на регулярной триангуляции Th области Ω̄, и конечномерная задача  uh ∈ Vh : a(uh, v) = (f, v) ∀v ∈ Vh (1.3)  является аппроксимацией (1.2). Ломаной Γh, состоящей из сторон треугольников триангуляции Th, разобьем Ω на две односвязные подобласти Ω1 и Ω2 (на рис. 1 сеточные узлы в этих областях отмечены значками (•) и (◦) соответственно; узлы на Γh отнесены к множеству со значком (•)). Пронумеруем независимо узлы от 1 до n1 в Ω1 ∪ Γh и от 1 до n2 в Ω2. Пусть ϕj(x) — функция из базиса Лагранжа в Vh, соответствующая узлу xj , j = 1, . . . , n1+ +n2. Если xj = x  1 i ∈ Ω1 ∪ Γh, то ϕj(x) будем обозначать ϕ1i (x).  Соответственно, ϕj(x) = ϕ 2 i (x) для xj ∈ Ω2. Тогда произвольная  функция vh ∈ Vh будет иметь представление  vh(x) =  n1∑  i=1  v1iϕ 1 i (x) +  n2∑  i=1  v2iϕ 2 i (x) = v1h(x) + v2h(x).  108    Р. З. Даутов, А. В. Лапин, С. Ю. Федотов  Ω 1    Ω 2    Γ h    Рис. 1: Декомпозиция и триангуляция области Ω  Отметим, что v2h ≡ 0 в Ω̄1 (т. е. и на Γh), v1h = 0 в Ω̄2 за исключением области меры O(h), образованной элементами триангуляции, лежащими в Ω2, и имеющими сторону, принадлежащую Γh. Произвольной функции vh ∈ Vh поставим во взаимно однозначное соответствие вектор-столбец узловых параметров согласно разложения по базису:  v1h ⇔ (v11, . . . , v1n1), v2h ⇔ (v21, . . . , v2n2), vh ⇔ v = (v1, v2).  Далее через 〈·, ·〉 будем обозначать евклидово скалярное произведение в произвольном Rk (длины векторов будут ясны из контекста). Имеем  a(uh, vh) = a(u1h, v1h) + a(u1h, v2h) + a(u2h, v1h)+  + a(u2h, v2h) = 〈A11u1, v1〉 + 〈A12u1, v2〉 + + 〈A21u2, v1〉 + 〈A22u2, v2〉 = 〈A0u, v〉 ,  где матрицы Axz имеют элементы aij = a(ϕ  x j , ϕ  z i ), (1.4)  при z, x = 1, 2,  A0 =  ( A11 A12  A21 A22  ) .  109    Метод декомпозиции области на основе фиктивных компонент. . .  Аналогично определим вектор правых частей:  (f, vh) = (f, v1h + v2h) = 〈f, v〉 , f = ( f1 f2  ) .  В результате задача (1.3) приводится к системе линейных алгебраических уравнений  A0u = f, или  ( A11 A12  A21 A22  )( u1 u2  ) =  ( f1 f2  ) . (1.5)  Очевидно, что матрицы A11 размерности n1 ×n1 и A22 размерности n2 × n2 симметричны и положительно определены, матрица A12 размерности n1 × n2 равна (A21)T . В целом A0 — симметричная и положительно определенная матрица, и система (1.5) однозначно разрешима.  2 Расширенная система алгебраических уравнений  Введем на Ω2 новую триангуляцию T 1 h так, что на Γh уз лы сохраняются прежними (на рис. 2 внутренние узлы новой триангуляции отмечены значком (⋄), их общее число n3). Пусть  Γ h     Ω 2     Рис. 2: Дополнительная триангуляция области Ω2  V 3h ⊂ {v ∈ H1(Ω2) : v = 0 на ∂Ω2\Γh} — пространство линейных  110    Р. З. Даутов, А. В. Лапин, С. Ю. Федотов  треугольных конечных элементов на триангуляции T 1h , ϕ 3 i (x) —  базис Лагранжа в V 3h . Тогда произвольная функция vh ∈ V 3h будет иметь представление  vh(x) = ∑  x1 i ∈Γh  v1iϕ 1 i (x) +  n3∑  i=1  v3iϕ 3 i (x) = v1h(x) + v3h(x). (2.1)  Отметим, что v3h ∈ H10 (Ω2). Далее будем считать, что v3h продолжена нулем в Ω1, так что множество функций вида (2.1) определяют новую аппроксимацию пространства H10 (Ω). Обозначим ее  через ◦  V 3 h.  Пусть функция uh = u1h+u3h ∈ V 3h определяется из уравнения  a(u1h + u3h, v3h) = (0, v3h) ∀v3h ∈ ◦  V 3 h.  В матричном виде это уравнение примет вид  A31u1 +A 33u3 = 0, (2.2)  где матрицы A31 размера n3 × n1 и A33 размера n3 × n3 имеют элементы, определяемые согласно (1.4) при z, x = 1, 3.  Из (1.5) и (2.2) получим расширенную систему уравнений  Au = f̃ , (2.3)  где  A =     A11 A12 0 A21 A22 0 A31 0 A33    , u =     u1 u2 u3    , f̃ =     f1 f2 0    .  Из положительной определенности матриц A0 и A 33 следует од нозначная разрешимость (2.3). Введя обозначения  B =     A11 0 A13  A21 A22 0 A31 0 A33   , C =     0 A12 −A13 0 0 0 0 0 0   , A31 = (A13)T ,  получим эквивалентную форму записи (2.3):  Bu+ Cu = f̃ . (2.4)  111    Метод декомпозиции области на основе фиктивных компонент. . .  3 Итерационный метод и исследование его сходимости  Систему (2.4) будем решать следующим итерационным методом:  Buk+1 + Cuk = f̃ . (3.1)  Ясно, что реализация одного шага итерационного процесса (3.1) состоит в последовательном решении систем уравнений  A11uk+11 +A 13uk+13 = z1 −A12uk2 +A13uk3 ,  A31uk+11 +A 33uk+13 = 0  и A22uk+12 = f2 −A  12uk+11 ,  т. е. в решении задачи в области Ω “на сетке 1+3” и решении задачи в области Ω2 “на сетке 2” с условием Дирихле на Γh.  Канонический вид итерационного метода следующий:  B(uk+1 − uk) +Auk = f̃ , (3.2) Как видим, в (3.2) как A, так и B — несимметричные N × N матрицы, N = n1 + n2 + n3.  Пусть u ∈ RN — некоторое решение системы (2.4). Тогда для векторов ошибки zk = uk − u метода (3.1) справедливы соотношения  zk+1 = −B−1Czk, k = 0, 1, 2, . . . Известно, что необходимым и достаточным условием сходимо сти метода (3.1) является условие  ρ(B−1C) = max λ∈ Sp(B−1C)  |λ| < 1,  где ρ(B−1C) — спектральный радиус матрицы B−1C. Рассмотрим обобщенную проблему собственных значений  Cu = λBu. (3.3)  Записав (3.3) покомпонентно, получим следующую систему:     A12u2 −A13u3 = λ(A11u1 +A13u3), λ(A21u1 +A  22u2) = 0,  λ(A31u1 +A 33u3) = 0.  (3.4)  112    Р. З. Даутов, А. В. Лапин, С. Ю. Федотов  Доказательство неравенства |λ| < 1, т. е. сходимости итерационного метода (3.1), проведем лишь для конечно-разностной аппроксимации модельной задачи. Именно, рассмотрим задачу  −1 −0.8 −0.6 −0.4 −0.2 0 0.1 0.4 0.7 1 0  0.2  0.4  0.6  0.8  1 i = −1 i = 1   Ω 1  Ω 2   Γ h  Рис. 3: Пример покрытия сеткой области Ω для модельной задачи  (1.1) в прямоугольнике [−1, 1] × [0, 1]. Введем в Ω1 и Ω2 равномерные сетки ω1h и ω  2 h с шагом hy по направлению y и h ≡ hx —  по направлению x, так что Nxh = 1, Nyhy = 1. Введем также в Ω2 неравномерную сетку ω  3 h с шагом hy по направлению y и с  шагом H > hx по направлению x, c сохранением приграничной полосы равномерной сетки ω2h при x = h (см. рис. 3). Тогда исходная конечно-разностная схема (на сетке ω1h + ω  2 h) может быть  записана в алгебраической форме (1.5), где, в частности, A11 и A22 являются матрицами сеточных операторов Лапласа со знаком минус:  A11u1 ∼ −∂2xxu1 − ∂2yyu1, A22u2 ∼ −∂2xxu2 − ∂2yyu2.  Аналогично, алгебраическая форма расширенной конечно-разност 113    Метод декомпозиции области на основе фиктивных компонент. . .  ной схемы имеет вид (2.3), при этом A33u3 ∼ −∂2xbxu3 − ∂2yyu3, где     ( ∂2xx̂v  ) i =  2  h+H  ( v2 − v1 H  − v1 − v0 h  ) , i = 1,  ( ∂2xx̂v  ) i =  1  H2 (vi−1 − 2vi + vi+1) , i > 1.  Рассмотрим задачу (3.4) и будем искать ненулевые решения λ. Пусть α = 1/λ, тогда первое уравнение в (3.4) примет вид  A11u1 + (1 + α)A 13u3 − αA12u2 = 0.  Это уравнение соответствует сеточной задаче     −∂2xx̄u1 − ∂2yȳu1 = 0 при −1 < x 6 0, 0 < y < 1, u1 = αu2 − (1 + α)u3 при x = h, 0 < y < 1, u1 = 0 на остальной части границы.  (3.5)  Второе и третье уравнения в (3.4) соответствуют сеточным задачам     −∂2xx̄u2 − ∂2yȳu2 = 0 при 0 < x < 1, 0 < y < 1, u2 = u1 при x = 0, u2 = 0 на остальной части границы,  (3.6)      −∂2xbxu3 − ∂2yȳu3 = 0 при 0 < x < 1, 0 < y < 1, u3 = u1 при x = 0, u3 = 0 на остальной части границы.  (3.7)  Будем искать решения задач (3.5) – (3.7) в виде рядов  ui(x, y) =  Ny∑  j=1  uij(x) sin(jπy), i = 1, 2, 3, (3.8)  и пусть  u1(0, y) ≡ g = Ny∑  j=1  gj sin(jπy). (3.9)  Из (3.6), (3.8) и (3.9) имеем для коэффициента Фурье u2j (x) задачу  { −∂2xx̄u2j (x) + µju2j (x) = 0, 0 < x < 1, u2j (0) = gj ; u  2 j (1) = 0,  114    Р. З. Даутов, А. В. Лапин, С. Ю. Федотов  где µj = 4/h 2 y sin  2(jπy/2) — собственное число оператора −∂2yy с однородными граничными условиями Дирихле.  Обозначив u2j = gjφj , получим для каждого φj , j = 1, . . . , Ny, задачу вида {  −φxx̄ + µφ = 0, 0 < x < 1, φ(0) = 1, φ(1) = 0,  (3.10)  где µ принимает значение µj для φj . Аналогично, если u 3 j = gjψj ,  то для ψj , j = 1, . . . , Ny, имеем задачу { −ψxbx + µψ = 0, 0 < x < 1, ψ(0) = 1, ψ(1) = 0.  (3.11)  Наконец, пусть u1j = gjUj , тогда для Uj , j = 1, . . . , Ny, имеем задачу      −Uxx + µU = 0, −1 < x < h, U(−1) = 0, U(0) = 1, U(h) = αφ(h) − (1 + α)ψ(h).  (3.12)  Рассмотрим систему (3.12) на отрезке [−1, 0], исключив из рассмотрения условие в точке x = h. Нетрудно видеть, что решение этой системы в точке x = −h совпадает с φ(h). Запишем первое уравнение системы в точке x = 0:  −U−1 + 2U0 − U1 + h2µU0 = 0.  Учитывая, что U−1 = φ(h), U0 = 1 и U1 = αφ(h) − (1 + α)ψ(h), получим  −φ(h) + (2 + h2µ) − (αφ(h) − (1 + α)ψ(h)) = 0,  т. е.  1 + α = 2 + h2µ  φ(h) − ψ(h) . (3.13)  Матрица системы (3.11) естьM -матрица. Отсюда, во-первых, следует, что решение ψ неотрицательно. Далее, сравнив решение ψ системы (3.11) с решением системы  { −zxbx = 0, 0 < x < 1, z(0) = 1, z(1) = 0,  115    Метод декомпозиции области на основе фиктивных компонент. . .  равным z = 1 − x, получим ψ(x) 6 1 − x ∀x. Аналогичные утверждения справедливы для решения φ системы (3.10). Таким образом,  −1 < φ(h) − ψ(h) < 1. (3.14) Если φ(h)−ψ(h) > 0, то из (3.13), (3.14) выведем 1+α > 2 ⇒ λ = = 1/α < 1. Если же −1 < φ(h) − ψ(h) < 0, то 1 + α < −2 ⇒ λ = = 1/α > −1/3. Итак, |λ| < 1, и сходимость итерационного метода для случая конечно-разностной схемы установлена.  4 Результаты вычислительных экспериментов  В этом разделе опишем результаты, которые были получены в ходе вычислительных экспериментов при решении уравнения Пуассона с нулевыми граничными условиями в области, изображенной на рис. 1.  Результаты, представленные в табл. 4.1, соответствуют решению исходной задачи (1.5) предобусловленным методом сопряженных градиентов (далее PCG-метод), где в качестве предобусловливателя было взято неполное разложение Холецкого матрицы A0 [6]. Начальное приближение u  0 = 0. Здесь kPCGM — количество итераций, необходимых для достижения заданной точности, tsec — машинное время.  В качестве условия окончания итерационного метода было выбрано условие достаточной малости L∞-нормы вектора невязки  ‖rn‖L∞ = ‖A0un − f‖L∞ < ε.  В табл. 4.2 приведены результаты решения расширенной системы (2.4) итерационным методом (3.1). Вычисления проводились по следующей схеме: на сетке 1+3 задача решалась прямым  методом с использованием LU -разложения матрицы  ( A11 A13  A31 A33  ) ,  а в области 2 на сетке 2 с условием Дирихле на Γh задача решалась предобусловленным методом сопряженных градиентов (предобусловливатель — неполное разложение Холецкого матрицы A22). Здесь в столбце k стоит число внешних итераций метода (3.1), а в скобках — число внутренних итераций PCG-метода на каждой итерации внешнего цикла.  116    Р. З. Даутов, А. В. Лапин, С. Ю. Федотов  Таблица 4.1  ε N = n1 + n2 kPCGM tsec 2632 = 1912 + 720 27 1.25 × 10−1  10−4 5990 = 4372 + 1618 35 4.06 × 10−1 9073 = 1908 + 7165 61 1.00 2632 = 1912 + 720 32 1.40 × 10−1  10−5 5990 = 4372 + 1618 47 4.69 × 10−1 9073 = 1908 + 7165 72 1.26 2632 = 1912 + 720 39 1.72 × 10−1  10−6 5990 = 4372 + 1618 56 5.94 × 10−1 9073 = 1908 + 7165 83 1.42  Таблица 4.2  N = n1 + n2 ε k tsec 10−4 3(14,12,1) 3.10 × 10−2  2632 = 1912 + 720 10−5 3(20,17,5) 6.20 × 10−2 10−6 3(24,23,9) 6.30 × 10−2 10−4 2(22,16) 1.25 × 10−1  5990 = 4372 + 1618 10−5 3(30,25,3) 1.88 × 10−1 10−6 3(36,34,11) 2.03 × 10−1 10−4 2(51,51) 1.45  9073 = 1908 + 7165 10−5 4(64,63,9,5) 2.09 10−6 3(82,80,29) 2.79  На основании полученных данных можно сделать следующие выводы.  1. Скорость сходимости итерационного метода (3.1) практически не зависит от шага сетки.  2. Предложенный метод показал хорошие результаты в задачах, где мера области Ω2 намного меньше меры области Ω1. В противном случае он проигрывает по времени по сравнению с решением исходной системы уравнений. В частности, если число узлов триангуляции в области Ω2 больше, чем в Ω1 (см. табл. 4.1 и  117   