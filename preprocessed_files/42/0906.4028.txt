ar x iv 0 90 6 40 28 v 4 m at h c a 2 3 ju n 20 10 martingale transforms the dyadic shift and the hilbert transform a sufficient condition for boundedness between matrix weighted spaces robert kerr abstract we give sufficient conditions on n n matrix weights u and v for the dyadic martingale transforms to be uniformly bounded from l 2 v to l 2 u we also show that these conditions imply the uniform boundedness of the dyadic shifts as well as the boundedness of the hilbert transform between these spaces 1 introdution much progress has been made recently on the two weight problem for various important operators for example the sawyer type characterizations of f nazarov s treil and a volberg see e g 6 and the two weight inequalities for maximal singular integrals by m lacey e t sawyer and i uriarte tuero 13 this is currently an area of much activity and new proofs with broader scope and deeper insight are appearing little attention has been given so far to understanding two weight problems on vector valued function spaces the work of c m pereyra and n h katz 8 being a notable exception in contrast to the one weight case for which an analogue of the hunt muckenhoupt wheeden characterization has been shown in 12 by s treil and a volberg a sufficient condition for the operator weight case has been given by s pott in 11 and in 14 it is shown that the dyadic operator weight analogue of the matrix weight dyadic hunt muckenhoupt wheeden condition does not imply the boundedness of the martingale transforms we turn our attention firstly to conditions which imply the uniform boundedness of dyadic martingale transforms and then to other dyadic operators the motivation here is that such dyadic operators can often be used as models for more general singular integral operators 2 the martingale transform let d denote the standard grid of dyadic subintervals of r d k 2 n k 1 2 n where n and k range over the integers the haar functions associated to a dyadic interval i are defined as hi 1 i i i where i and i are the largest proper dyadic subintervals of i on the right and the left respectively the hi form 2000 mathematics subject classification primary 42 a 50 key words and phrases matrix weights dyadic martingale transforms dyadic haar shift two weights this work was completed with the support of the epsrc part of this work was done while visiting the fields institute as part of the thematic program on new trends in harmonic analysis 1 http arxiv org abs 0906 4028 v 4 2 robert kerr an orthonormal basis for l 2 r let l 2 r cn denote the space of measurable functions f r cn r f t f t cndt f l 2 r cn r f t f t cndt 1 2 we consider the operator t on l 2 r cn defined by the mapping t f 7 i d i hifi where fi i fhi is the haar coefficient for i and i 1 the t are dyadic martingale transforms and are unitary operators on l 2 r cn for a matrix valued function v which is positive and invertible almost everywhere let l 2 r cn v be the space of measurable functions f r cn r v t 1 2 f t v t 1 2 f t dt with norm f l 2 r cn v r v t 1 2 f t v t 1 2 f t dt 1 2 this generalizes the notion of weighted l 2 spaces of scalar functions where a weight is a measurable almost everywhere positive function we refer to matrix functions which are measurable almost everywhere positive and invertible as matrix weights the purpose of this paper is to find conditions on a pair of matrix weights u and v which imply that the dyadic martingale transforms are uniformly bounded from l 2 r cn v to l 2 r cn u this is equivalent to showing that the operators m 1 2 v t m 1 2 u are uniformly bounded on the unweighted space l 2 r cn the suf ficient conditions we find on a pair of matrix weights are a joint a 2 condition a matrix a condition on one weight and a matrix reverse h lder condition on the other weight we can also as a corollary replace the matrix reverse h lder condi tion by the matrix a condition the matrix a and reverse h lder condition will be discussed in the next section in what follows we will denote l 2 r cn v and l 2 r cn u by l 2 v and l 2 u 3 the a 2 0 condition and reverse h lder definition 3 1 a matrix weight u satisfies the dyadic reverse h lder inequality if there exists constants c 0 and r 2 such that i u 1 2 x u 1 2 i y rdx c i y r holds for all dyadic intervals i and nonzero vectors y note that our definition of the reverse h lder property is in general weaker the existing definition in the literature by christ and goldberg 2 but is equivalent for finite dimensional spaces our definition generalizes the scalar version and is in a form we find applicable matrix weighted martingale transforms 3 definition 3 2 we say that a matrix weight u is in the a 2 0 class of weights if following inequality holds uniformly over all intervals i det u i c exp log detu i this a 2 0 condition is a matrix analog of the scalar a condition see 4 for discussion on this also see 1 for some reformulations and context of this property lemma 3 3 if a matrix weight u satisfies the a 2 0 condition then it satisfies the reverse h lder inequality proof if the weight u has the a 2 0 condition then by lemma 3 2 and lemma 3 3 of 1 we have that 3 1 1 i i u 1 2 x 2 1 2 c exp log u 1 2 x i for all nonzero x and intervals i consequently 1 i i u 1 2 x 2 c exp log u 1 2 x 2 i and thus the scalar weight u 1 2 x 2 satisfies the a condition and hence a reverse h lder inequality 1 i i u 1 2 x 2 r 1 2 r c 1 i i u 1 2 x 2 1 2 for some r 1 all intervals i and all nonzero x note that the index r does not depend on x because it only depends on the a constant c in 3 1 which is uniform for all x as this is true for all nonzero x we can replace x by u 1 2 i y where 0 6 y cn thus for all intervals i r and y cn 1 i i u 1 2 u 1 2 i y 2 r 1 2 r c 1 i i u 1 2 u 1 2 i y 2 1 2 c y 4 boundedness of the martingale transform we are now in a position to state our main theorem concerning sufficient condi tions for the boundedness of the dyadic martingale transforms theorem 4 1 let u and v be matrix weights satisfying the joint a 2 condition v 1 1 2 i u i v 1 1 2 i c for all dyadic intervals i where c is a constant multiple of the identity if v 1 a 2 0 and u satisfies the matrix reverse h lder inequality then the dyadic martingale transforms are uniformly bounded from l 2 v to l 2 u corollary 4 2 let u and v be matrix weights satisfying a joint a 2 condition v 1 12 i u i v 1 12 i c for all dyadic intervals i where c is a constant multiple of the identity if u and v 1 are also in a 2 0 then the dyadic martingale transforms are uniformly bounded from l 2 v to l 2 u 4 robert kerr proof by lemma 3 3 theorem 4 1 implies this corollary note that the conditions on the matrix weights u and v 1 are symmetric in this corollary also in theorem 6 1 of 3 the conditions and implications in corollary 4 2 are stated but specifically for the scalar valued function space setting this is also mentioned in 5 5 proof of theorem 4 1 using a two weighted dyadic square function we introduce the operator dv 1 defined by dv 1 f dv 1 i d fihi x 7 i d v 1 1 2 i fihi x for functions with finite haar expansion write m 1 2 v t m 1 2 u as m 1 2 v t d 1 v 1 dv 1 m 1 2 u and note that t and d 1 v 1 com mute this allows us to estimate the norm as m 1 2 v t m 1 2 u m 1 2 v t d 1 v 1 dv 1 m 1 2 u m 1 2 v d 1 v 1 t dv 1 m 1 2 u we know that t is bounded on unweighted l 2 so we are interested in finding conditions on the matrix weights u and v 1 that imply the boundedness of the operators m 1 2 v d 1 v 1 and dv 1 m 1 2 u on unweighted l 2 r cn we deal with dv 1 m 1 2 u a two weighted dyadic square function using a stopping time argument and cotlar s lemma theorem 5 1 let u and v 1 be matrix weights such that u has the dyadic reverse h lder inequality and such that for all dyadic intervals i v 1 12 i u i v 1 12 i c then the two weighted square function s m 1 2 u dv 1 is bounded on l 2 r cn for m 1 2 v d 1 v 1 we state without proof a theorem of nazarov and treil theorem 5 2 let u be a matrix weight such that w a 2 0 then d 1 w m 1 2 w is bounded on l 2 r cn proof this is theorem 7 8 of 4 note that the proof of this theorem uses a bellman function technique this theorem also applies to m 1 2 v d 1 v 1 if we note that its adjoint is d 1 v 1 m 1 2 v we now introduce the stopping time used in the proof of theorem 5 1 5 1 stopping time let 1 and let j 1 j be the collection of maximal dyadic subintervals i of j such that 5 1 1 i i v 1 1 2 j u x v 1 1 2 j dx or 5 2 1 i i v 1 1 2 j v 1 x v 1 1 2 j dx matrix weighted martingale transforms 5 or 5 3 1 i i u 1 2 j u x u 1 2 j dx then we define j k j as i j k 1 j j 1 i for k 1 let f 1 j be the col lection of those dyadic subintervals of j which are not a subinterval of any interval in j 1 j we likewise define f k j iteratively to be i j k 1 j f 1 i then kf k i forms a decomposition of the dyadic subintervals of i lemma 5 3 if u and v are matrix weights such that for some c 0 v 1 1 2 i u i v 1 1 2 i c for all dyadic intervals i then j is a decaying stopping time for some 1 by decaying stopping time we mean that for a sufficiently large we have a constant 0 1 such that j i k k i for all k we call this conditions on the two matrix weights the joint a 2 condition proof we first restrict ourselves to showing that j k j i j k 1 j j 1 i is a decaying stopping time when j 1 i is defined as the collection of maximal subintervals of i satisfying only 5 3 rather than all three conditions we have the following series of inequalities i i u 1 2 i u x u 1 2 i dx j j 1 j u 1 2 i u x u 1 2 i dx cn j j 1 j u 1 2 i u x u 1 2 i where cn is a constant dependent on the matrix this is possible due to the equivalence of all matrix norms and the additivity of the trace norm on positive matrices by 5 3 cn j j 1 j u 1 2 i u x u 1 2 i cn j j 1 j and hence 1 cn i j j 1 j j 1 thus we can choose to be large enough such that 1 cn 1 and we have j 1 i i iteration now yields that j k i k i we use a similar argument for 5 1 and 5 2 individually and then note that the finite union of decaying stopping times will also be a decaying stopping time after a possible change of 5 2 proof of theorem 5 1 this proof of this theorem is where the core of our technical analysis takes place it draws from theorem 3 1 in 11 we are presenting a generalization for the finite dimensional case proof we choose 0 such that the condition j in 5 3 is a decaying stopping time first note that almost everywhere on j j j v 1 12 j u x v 1 12 j 6 robert kerr u 1 2 j u x u 1 2 j and v 1 1 2 j v 1 x v 1 1 2 j in this context stands for the identity matrix scaled by and the inequalities are matrix inequalities let us take f l 2 r cn with finite haar expansion assume without loss that f is supported in the unit interval we write jj and fj for j j 0 1 and f j 0 1 define jf k fj hkfk and sjf s jf u 1 2 k fj v 1 1 2 k hkfk we can check that j 1 jf f and also that j 1 sjf sf we show that s is bounded using cotlar s lemma first note that sjf 2 l 2 jj 1 sjf 2 cn dx jj 1 jj sjf 2 cn dx jj sjf 2 cn dx we estimate jj 1 jj sjf 2 cn dx and then jj sjf 2 cn dx jj 1 jj sjf 2 cn dx j jj 1 j j j sjf 2 cn dx j jj 1 j j j u 1 2 x k f j v 1 1 2 k hk x fk 2 cn dx j jj 1 j j j u 1 2 x v 1 1 2 j v 1 1 2 j k f j v 1 1 2 k hk x fk 2 cn dx j jj 1 j j j u 1 2 x v 1 12 j 2 v 1 12 j k f j v 1 12 k hk x fk 2 cn dx j jj 1 j j j v 1 12 j k f j v 1 12 k hk x fk 2 cn dx j jj 1 j k f j v 1 1 2 j v 1 1 2 k 2 fk 2 cn dx j jj 1 j k f j fk 2 cn dx since for k f j v 1 1 2 j v 1 k v 1 1 2 j 1 k k v 1 1 2 j v 1 x v 1 1 2 j matrix weighted martingale transforms 7 thus sjf 2 l 2 j jj 1 j k f j fk 2 cn dx j jj 1 2 k f j j fk 2 cn dx 2 jf l 2 we now consider jj sjf 2 cn dx j jj 1 i j j i u 1 2 x k f j v 1 12 fkhk x 2 cn dx as hk is constant on i j j for k f j this is equal to j jj 1 i j j i u 1 2 i k f j v 1 12 k fkhk 2 cn dx j jj 1 i j j i u 1 2 i u 1 2 j 2 cn u 1 2 j k f j v 1 1 2 k fkhk 2 cn dx 2 2 jf 2 l 2 we have shown that there is a constant c such that sjf 2 c jf 2 let us now show that there exists a constant c and 0 d 1 such that for k j jk 1 sjf 2 dx c dk j jf 2 cotlar s lemma see 7 then implies that s sj is bounded note that jk 1 sjf 2 dx j jj i jk j 1 j i u 1 2 x l jj 1 k f l v 1 12 k hk x fk 2 cn dx note that l jj 1 k f l v 1 1 2 k hkfk is constant on j jj and denote this constant by mjf the above expression is equal to j jj i jk j 1 j i u 1 2 i mjf 2 cn j jj 1 j j j i jk j 1 j i u 1 2 i mjf 2 cn j jj 1 j j j i jk j 1 j i 1 2 u 1 2 i mjf i 1 2 u 1 2 i mjf j jj 1 j j j i jk j 1 j i 1 2 u 1 2 i u 1 2 j u 1 2 j mjf i 1 2 u 1 2 i u 1 2 j u 1 2 j mjf j jj 1 j j j i jk j 1 j i u i u 1 2 j u 1 2 j mjf u 1 2 j u 1 2 j mjf j jj 1 j j j jk j 1 j u 1 2 x u 1 2 j u 1 2 j mjf 2 dx 8 robert kerr we now apply h lder s inequality with p such that 2 p is the r from our reverse h lder inequality on u then the above expression is less than or equal to j jj 1 j j j jk j 1 j u 1 2 x u 1 2 j u 1 2 j mjf 2 pdx 1 p jk j 1 j 1 q we now use the fact that we are working with a decaying stopping time to see that this is less than or equal to j jj 1 j j j jk j 1 j u 1 2 x u 1 2 j u 1 2 j mjf 2 pdx 1 p d k j 1 q j 1 q where 0 d 1 now we apply the reverse h lder inequality 3 1 with vector u 1 2 j mjf to obtain that this is less than or equal to j jj 1 j j j u 1 2 j mjf 2 c 1 p j 1 p d k j 1 q j 1 q d k j 1 q c 1 p j jj 1 j j u x 1 2 mjf 2 d k j 1 q c 1 p j jj 1 j j sjf 2 this is our core estimate to apply cotlar s lemma consider s ksjf g l 2 sjf skg l 2 jk 1 sjf x skg x cn dx jk 1 sjf x cn skg x cndx jk 1 sjf x 2 cn 1 2 jk 1 skg x 2 cn dx 1 2 this is true as the support of skf is contained in jk 1 and by cauchy schwartz we have just dealt with the relevant bounds for the two factors at the end of this chain of inequalities also note that sks j f g l 2 s j f s kg l 2 s j f s k g l 2 js f ks g l 2 0 as the i are self adjoint orthogonal projections this finishes the proof of theorem 5 1 remark 5 4 the proof of corollary 4 2 also follows from the embedding theorem of nazarov and treil theorem 5 2 ideally we would like to prove this independently of their theorem however we were unable to do this m 1 2 v t m 1 2 u can be written as m 1 2 v d 1 v 1 dv 1 t dud 1 u m 1 2 u note that t commutes with dv 1 and we can estimate the norm as follows m 1 2 v t m 1 2 u m 1 2 v d 1 v 1 dv 1 t dud 1 u m 1 2 u m 1 2 v d 1 v 1 t dv 1 du d 1 u m 1 2 u we need conditions on u and v that imply that the operators m 1 2 v d 1 v 1 dv 1 du and d 1 u m 1 2 u are bounded theorem 5 2 immediately gives us that d 1 u m 1 2 u is matrix weighted martingale transforms 9 bounded this theorem also applies to m 1 2 v d 1 v 1 if we note that its adjoint is d 1 v 1 m 1 2 v all we need to show now is that under the hypothesis dv 1 du is a bounded operator this follows from the joint a 2 condition 6 application to the hilbert transform as well as showing that the martingale transforms are uniformly bounded under the conditions of the two main theorems we can also show that the dyadic shift x defined below will be bounded and hence the hilbert transform by way of s petermichl s averaging techniques 9 10 definition 6 1 the dyadic shift x with respect to the standard dyadic grid is the operator given by xf x i d fihi i d f hi hi hi where f is supported on the unit interval and has finite haar expansion definition 6 2 define the operator d v as d v f i d fihi 7 i d v 1 2 i fihi and the operator d v as d v f i d fihi 7 i d v 1 2 i fihi for f l 2 cn with finite haar expansion if we split the shift operator into a sum of two operators each of which is bounded xf x 1 x 2 f i d f hi hi i d f hi hi we can then check that d v 1 x 1 d 1 v 1 x 1 and d v 1 x 2 d 1 v 1 x 2 as before we can estimate m 1 2 u xm 1 2 v 1 m 1 2 u x 1 x 2 m 1 2 v 1 m 1 2 u d v 1 x 1 d 1 v 1 d v 1 x 2 d 1 v 1 m 1 2 v 1 m 1 2 u d v 1 x 1 m 1 2 u d v 1 x 2 d 1 v 1 m 1 2 v 1 we have already dealt with the boundedness of the third operator and it is known that x 1 and x 2 are bounded on unweighted l 2 this leaves the operators m 1 2 u d v 1 and m 1 2 u d v 1 d v 1 m 1 2 u f 2 m 1 2 u d v 1 2 m 1 2 u f f d v 1 2 m 1 2 u f m 1 2 u f i d v 1 i u 1 2 f ihi m 1 2 u f i d v 1 i u 1 2 f ihi m 1 2 u f i d 1 i i v 1 x u 1 2 f ihi m 1 2 u f dx 10 robert kerr i d 1 i i v 1 x u 1 2 f ihi u 1 2 f ihi dx i d 1 i i v 1 x u 1 2 f ihi m 1 2 u f dx i d 2 i i v 1 x u 1 2 f ihi m 1 2 u f dx 2 m 1 2 u dv 1 2 m 1 2 u f f the first inequality is true because we are integrating a positive function v 1 x u 1 2 f ihi u 1 2 f ihi v 1 2 x u 1 2 f ihi v 1 2 x u 1 2 f ihi over a larger interval the second last equality is due to the fact that i 1 2 i the boundedness of m 1 2 u d v 1 then follows from our previous bounding of m 1 2 u dv 1 and taking adjoints where appropriate for m 1 2 u d v 1 the proof is similar definition 6 3 instead of this canonical dyadic grid we can define the shift oper ator x r on the grid dr r 2 m 0 1 l n m 2 i n i l m z x rf x r i d r fihi i d r f hi hi hi the shift operators defined with respect to these dyadic grids will be bounded l 2 v l 2 u given the joint a 2 condition is satisfied u satisfies the reverse h lder condition and v 1 the a 2 0 condition all on this new lattice the resulting estimate for the norm will be independent of the lattice assuming the joint a 2 condition that u satisfies the reverse h lder condition and v the a 2 0 condition all on arbitrary intervals allows us to estimate the norm of the hilbert transform in terms of these translated and dilated haar shifts using the results from 9 and 10 theorem 6 4 let u and v be matrix weights satisfying the joint a 2 condition v 1 1 2 i u i v 1 1 2 i c for all intervals i where c is a constant multiple of the identity if v 1 a 2 0 and u satisfies the matrix reverse h lder inequality then the hilbert transform is bounded from l 2 v to l 2 u proof m 1 2 u hm 1 2 v f g c m 1 2 u 0 1 z 2 1 x rm 1 2 v f dr r dp g c 0 1 z 2 1 m 1 2 u x r m 1 2 v f g dr r dp c 0 1 z 2 1 m 1 2 u x rm 1 2 v f g dr r dp cc 0 1 z 2 1 f g dr r dp cc f g where c is the proportion of the hilbert transform to the average of the shift operators and c is the uniform operator norm of the shift operators the heuristic for adapting our main argument to the case of the dyadic shift can be applied to a more general class of operators band operators matrix weighted martingale transforms 11 7 application to band operators and certain singular integral operators definition 7 1 a band operator t is a bounded operator on l 2 such that there exists an integer r 0 for which thi hj 0 for all haar functions hi hj where j is at least a distance of r away from i by distance we mean tree distance between dyadic intervals where the tree is formed by connecting each interval with its parent and children intervals one crucial fact is that for each r there are only a finite number of haar basis elements h i less than tree distance r from hi suppose there are m haar basis elements less than r away from each hi and we label these basis elements hii for i 1 m then our band operator t will be of the form f 7 i d m i 1 i ii f hi hii where is a function from d d to c lemma 7 2 if we have a band operator t written in the form f 7 i d m i 1 i ii f hi hii then the function d d c is bounded proof suppose that is unbounded as t is a bounded operator we can choose i and ii such that i ii t then we can see that thi i d m i 1 i ii hi hi hii m i 1 i ii hii m i 1 i ii hii t condradicting our hypothesis that t is bounded i i i i i i i figure 1 a dyadic interval i together with first and second gen eration subintervals theorem 7 3 let u and v be matrix weights satisfying the dyadic joint a 2 con dition v 1 12 i u i v 1 12 i c 12 robert kerr i i i i i i i figure 2 the tree formed by connecting dyadic intervals to their parents and children for all dyadic intervals i where c is a constant multiple of the identity if v 1 a 2 0 and u satisfies the dyadic matrix reverse h lder inequality then any band op erator t is bounded from l 2 v to l 2 u if r is the maximum distance associated to the band operator then the bound will depend only on r the l 2 l 2 norm of the operator and the a 2 a 2 0 and reverse h lder constants associated to the weights proof again we note that tf i d m i 1 i ii f hi hii where is a function from d d to c i and ii will always share an ancestor less than r generations away for each i 1 m in the case that ii is a descendant of i then i will be the common ancestor in the case where ii is an ancestor of i then ii will be the common ancestor it is also possible to be in a situation where neither of these are true but the intervals still share a common ancestor we can split t into a sum of m bounded operators t m i 1 ti where ti is the operator f 7 i d ii i f hii hi this sum is constructed so that for each summand ti and haar basis element hi there is exactly one haar coefficient f hi being mapped to hi due to the nature of the band operator there are at most m haar coefficients being mapped to each basis element and thus it is possible to decompose t into a finite sum of these operators we proceed to estimate m 1 2 u tm 1 2 v 1 note that tdv 1 m i 1 ti dv 1 m i 1 d i v 1 ti matrix weighted martingale transforms 13 where di v 1 is the operator f 7 i d v 1 1 2 ii fihi so m 1 2 u tm 1 2 v 1 m 1 2 u tdv 1 d 1 v 1 m 1 2 v 1 m 1 2 u m i 1 di v 1 ti d 1 v 1 m 1 2 v 1 m i 1 m 1 2 u di v 1 ti d 1 v 1 m 1 2 v 1 m i 1 m 1 2 u div 1 ti d 1 v 1 m 1 2 v 1 we know that each ti is bounded and we have already dealt with the boundedness of d 1 v 1 m 1 2 v 1 so it remains to bound each m 1 2 u di v 1 so for any f l 2 m 1 2 u div 1 f 2 m 1 2 u div 1 2 m 1 2 u f f div 1 2 m 1 2 u f m 1 2 u f i d v 1 ii u 1 2 f ihi m 1 2 u f i d v 1 ii u 1 2 f ihi m 1 2 u f i d 1 ii ii v 1 x u 1 2 f ihi m 1 2 u f dx i d 2 r i i v 1 x u 1 2 f ihi m 1 2 u f dx where i is the common ancestor of i and ii this is true because each term v 1 x u 1 2 f ihi m 1 2 u f v 1 2 x u 1 2 f ihi v 1 2 x u 1 2 f ihi is positive we have seen before that if a matrix weight u satisfies the dyadic a 2 0 condition then for any vector the scalar weight u 1 2 2 will satisfy the scalar dyadic a condition so if we have a dyadic interval i and a dyadic interval j contained in i such that the tree distance between these two is less than r i e i 2 r j then one of the standard properties of a see 15 page 196 tells us that i u 1 2 2 j u 1 2 2 for some 0 1 bounded away from 0 with the bound dependent only on r and the a constant using our hypothesis that v 1 a 2 0 we can see that i d 2 r i i v 1 x u 1 2 f ihi m 1 2 u f dx i d 2 r i i v 1 2 x u 1 2 f ihi v 1 2 x u 1 2 f ihi dx i d 2 r i i v 1 2 x u 1 2 f i hi dx i d 2 r i i v 1 2 x u 1 2 f i 2 dx i hi 2 dx i d 2 r i i v 1 2 x u 1 2 f i 2 dx i d 2 r i i v 1 2 x u 1 2 f i 2 dx 14 robert kerr i d 2 r 1 i i v 1 x dx 1 2 u 1 2 f i 2 dx 2 r dv 1 m 1 2 u f 2 this reduces the estimate of each di v 1 m 1 2 u to dv 1 m 1 2 u which was dealt with in theorem 5 1 if k is a function from r 0 to r that is twice differentiable and such that the function x 3 k x is almost everywhere bounded and the limit as x of both k x and the first derivative k x are 0 then the following theorem due to vagharshakyan s allows us to apply our hypothesis to singular integral operators of convolution type with such kernels k vagharshakyan s theorem models singular integral operators with such kernels in terms of translations and dilations of band operators theorem 7 4 vagharshakyan if t is a singular integral operator of convolution type with kernel k as defined above then t is a positive multiple of the following operator f 7 0 1 z 2 1 b r f dr r dp where b r is a band operator defined in terms of the dyadic grid d r exactly as they are defined for the canonical dyadic grid theorem 7 5 let u and v be matrix weights satisfying the joint a 2 condition v 1 12 i u i v 1 12 i c for all intervals i where c is a constant multiple of the identity if v 1 a 2 0 and u satisfies the matrix reverse h lder inequality then the singular integral operator of convolution type with kernel k is bounded from l 2 v to l 2 u proof m 1 2 u tm 1 2 v f g c m 1 2 u 0 1 z 2 1 b rm 1 2 v f dr r dp g c 0 1 z 2 1 m 1 2 u b rm 1 2 v f g dr r dp c 0 1 z 2 1 m 1 2 u b rm 1 2 v f g dr r dp c c 0 1 z 2 1 f g dr r dp c c f g where c is the constant multiple of the singular integral operator corresponding to the average of the band operators and c is the operator norm of the band operators note by uniform norm we mean that a particular band operator then defined with respect to different dyadic grids will have the same operator norm matrix weighted martingale transforms 15 references 1 m bownik inverse volume inequalities for matrix weights indiana univ math j 50 1 2001 383 410 2 m christ m goldberg vector a 2 weights and a hardy littlewood maximal function trans amer math soc 353 2001 no 5 1995 2002 3 m t lacey s petermichl m c reguera sharp a 2 inequality for haar shift operators preprint http arxiv org abs 0906 1941 4 f nazarov and s treil the hunt for a bellman function applications to estimates for singular integral operators and to other classical problems of harmonic analysis st petersburg math j 8 1997 5 pp 721 824 5 f nazarov s treil a volberg the bellman functions and two weight inequalities for haar multipliers j amer math soc 12 1999 no 4 909 928 6 f nazarov s treil a volberg two weight inequalities for individual haar multipliers and other well localized operators math res lett 15 2008 no 3 583 597 7 m c pereyra lecture notes on dyadic harmonic analysis second summer school in analysis and mathematical physics cuernavaca 2000 1 60 contemp math 289 8 m c pereyra k n hawk on the two weights problem for the hilbert transform rev mat iberoamericana 13 1997 no 1 211 243 9 s petermichl dyadic shifts and a logarithmic estimate for hankel operators with matrix symbol c r acad sci paris s r i math 330 2000 10 s petermichl s treil and a volberg why the riesz transforms are averages of the dyadic shifts proceedings of the 6 th international conference on harmonic analysis and partial differential equations el escorial 2000 11 s pott a sufficient condition for the boundedness of operator weighted martingale trans forms and hilbert transforms studia math 182 2007 no 2 99 111 12 s treil a volberg wavelets and the angle between past and future j funct anal 143 1997 no 2 269 308 13 m t lacey e t sawyer i uriarte tuero a characterization of two weight norm inequalities for maximal singular integrals preprint http arxiv org abs 0807 0246 14 t a gillespie s pott s treil and a volberg logarithmic growth for matrix martingale transforms j london math soc 2 64 2001 no 3 624 636 15 e stein harmonic analysis real variable methods orthogonality and oscillatory integrals princeton university press 1993 department of mathematics university gardens university of glasgow g 12 8 qw e mail address rkerr maths gla ac uk 1 introdution 2 the martingale transform 3 the a 2 0 condition and reverse h lder 4 boundedness of the martingale transform 5 proof of theorem 4 1 using a two weighted dyadic square function 5 1 stopping time 5 2 proof of theorem 5 1 6 application to the hilbert transform 7 application to band operators and certain singular integral operators references