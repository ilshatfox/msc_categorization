ar x iv 1 20 1 43 19 v 1 1 m at h c a 1 m ar 2 01 4 two weight inequality for the hilbert transform a real variable characterization i michael t lacey eric t sawyer chun yen shen and ignacio uriarte tuero abstract let and w be locally finite positive borel measures on r which do not share a common point mass assume that the pair of weights satisfy a poisson a 2 condition and satisfy the testing conditions below for the hilbert transform h i h 1 i 2 dw i i h w 1 i 2 d w i with constants independent of the choice of interval i then h maps l 2 to l 2 w verifying a conjecture of nazarov treil volberg the proof has two components a global to local reduction carried out in this paper and an analysis of the local problem carried out in part ii of this series contents 1 introduction 1 2 dyadic grids and haar functions 3 3 the global to local reduction 6 4 energy monotonicity and poisson 11 5 the functional energy inequality 13 references 19 1 introduction define a truncated hilbert transform of a locally bounded signed measure by h x y x d y y x 0 m l supported in part by the nsf grant 0968499 and a grant from the simons foundation 229596 to michael lacey and the australian research council through grant arc dp 120100399 e t s research supported in part by nserc i u t has been partially supported by grants dms 0901524 dms 1056965 us nsf mtm 2010 16232 mtm 2009 14694 c 02 01 spain and a sloan foundation fellowship 1 http arxiv org abs 1201 4319 v 11 http arxiv org abs arc dp 1201003 2 m t lacey e t sawyer c y shen and i uriarte tuero given weights i e locally bounded positive borel measures and w on the real line r we consider the following two weight norm inequality for the hilbert transform 1 1 sup 0 r h f 2 dw n 2 r f 2 d f l 2 where n is the best constant in the inequality uniform over all truncations of the hilbert transform kernel below we will write the inequality above as h f l 2 w n f l 2 w that is the uniformity over the truncation parameters is suppressed the primary question is to find a real variable characterization of this inequality and the theorem below is an answer to the beautiful conjecture of nazarov treil volberg see 29 set p i r i i 2 dist x i 2 dx which is approximately the poisson extension of to the upper half plane evaluated at xi i where xi is the center of i theorem 1 2 let and w be locally finite positive borel measures on the real line r with no common point masses then the two weight inequality 1 1 holds if and only if these three conditions hold uniformly over all intervals i p i p w i a 2 1 3 i h 1 i 2 dw t 2 i i h 1 iw 2 d t 2 w i 1 4 there holds 1 5 n a 1 2 2 t h where a 2 and t are the best constants in the inequalities above it is well known 29 that the a 2 condition is necessary for the norm inequality and the inequal ities 1 4 are obviously necessary thus the content of the theorem is the sufficiency of the a 2 and testing inequalities in this paper we will carry out a global to local reduction in the proof of sufficiency with the analysis of the local problem being carried out in part ii of this series 5 the nazarov treil volberg conjecture has only been verified before under additional hypotheses on the pair of weights hypotheses which are not necessary for the two weight inequality the so called pivotal condition of 29 is not necessary as was proved in 8 the pivotal condition is still an interesting condition it is all that is needed to characterize the boundedness of the hilbert transform together with the maximal function in both directions but the boundedness of this triple of operators is decoupled in the two weight setting 24 our argument has these attributes certain degeneracies of the pair of weights must be ad dressed the contribution of the innovative 2004 paper of nazarov treil volberg 17 also see 29 which was further sharpened with the property of energy in 8 a crucial property of the hilbert transform this theme is further developed herein with notion of functional energy in 5 the proof should proceed through the analysis of the bilinear form h f gw as one expects certain paraproducts to appear still the paraproducts have no canonical form suggesting that two weight hilbert transform 3 the proof be highly non linear in f and g the non linear point of view was initiated in 9 and is central to this paper a particular feature of our arguments is a repeated appeal to certain quasi orthogonality arguments providing many simplifications over prior arguments for instance we never find ourselves constructing auxiliary measures and verifying that they are carleson a frequent step in many related arguments one can phrase a two weight inequality question for any operator t a question that became ap parent with the foundational paper of muckenhoupt 11 on ap weights for the maximal function indeed the case of hardy s inequality was quickly resolved by muckenhoupt 12 the maximal function was resolved by one of us 26 as well as the fractional integrals and essential for this paper poisson integrals 27 the latter paper established a result which closely paralleled the contemporaneous t 1 theorem of david and journ 1 this connection fundamental in nature was not fully appreciated until the innovative work of nazarov treil volberg 14 16 in develop ing a non homogeneous theory of singular integrals the two weight problem for dyadic singular integrals was only resolved recently 18 partial information about the two weight problem for singular integrals 21 was basic to the resolution of the a 2 conjecture 3 and several related results 4 6 21 22 our result is the first real variable characterization of a two weight inequality for a continuous singular integral interest in the two weight problem for the hilbert transform arises from its natural occurrence in questions related to operator theory 20 25 spectral theory 20 and model spaces 23 and analytic function spaces 10 in the context of operator theory sarason posed the conjecture see 2 that the hilbert transform would be bounded if the pair of weights satisfied the full poisson a 2 condition this was disproved by nazarov 13 advances on these questions have been linked to finer understanding of the two weight question see for instance 19 20 which build upon nazarov s counterexample acknowledgment the authors benefited from a stimulating conference on two weight inequalities at the american institute of mathematics palo alto california in october 2011 the review ing process has lead to many improvements in this paper including a streamlining of the main contribution of this paper for which we thank the referees 2 dyadic grids and haar functions 2 1 choice of truncation we have stated the main theorem with hard cut offs in the trun cation of the hilbert transform there are many possible variants in the choice of truncation moreover the proof of sufficiency requires a different choice of truncation consider a truncation given by h f x f y k y x dy 4 m t lacey e t sawyer c y shen and i uriarte tuero where k y is chosen to minimize the technicalities associated with off diagonal considerations specifically set k 0 0 and otherwise k y is odd and for y 0 k y y 2 2 0 y 1 y y y 2 2 y 2 0 2 y this is a c 1 function on 0 2 and is lipschitz convex and monotone on 0 we now argue that we can use these truncations in the proof of the sufficiency bound of our main theorem proposition 2 1 if the pair of weights w satisfy the a 2 bound 1 3 then one has the uniform norm estimate with the hard truncations 1 1 if and only if one has uniform norm estimate for the smooth truncations sup 0 h f w n f indeed h f h f a f a f where these last two operators are single scale averages namely a x 1 x 3 x 3 y dy but the simple a 2 bound is all that is needed to provide a uniform bound on the operators a so the proposition follows henceforth we use the truncations h and we suppress the tilde in the notation the particular choice of truncation is motivated by this off diagonal estimate on the kernels proposition 2 2 suppose that 2 x x x y then k y x k y x cx x y x x y x y x where cx x y 1 2 x y 1 2 2 3 and is otherwise positive and never more than 4 proof the assumptions imply that y x and y x have the same sign assume without loss of generality that 0 y x y x if 2 x y 1 2 it follows that x y and so by the definition k y x k y x 1 y x 1 y x x x y x y x and in the general case there holds d dt k t 4 t 2 so that 0 k y x k y x y x y x 4 t 2 dt 4 x x y x y x two weight hilbert transform 5 2 2 dyadic grids a collection of intervals g is a grid if for all g g g we have g g g g by a dyadic grid we mean a grid d of intervals of r such that for each interval i d the subcollection i d i i partitions r aside from endpoints of the intervals in addition the left and right halves of i denoted by i are also in d for i d the left and right halves i are referred to as the children of i we denote by di the unique interval in d having i as a child and we refer to di as the d parent of i we will work with subsets f d we say that i has f parent fi f if f f is the minimal element of f that contains i 2 3 haar functions let be a weight on r one that does not assign positive mass to any endpoint of a dyadic grid d if i d is such that assigns non zero weight to both children of i the associated haar function is h i i i i i i i i in this definition we are identifying an interval with its indicator function and we will do so throughout the remainder of the paper this is an l 2 normalized function and has integral zero for any dyadic interval i 0 it holds that i 0 1 2 i 0 h i i d i i 0 is an orthogonal basis for l 2 i 0 we will use the notations f i f h i as well as i f f h i h i i e i f i e i f ie i f the second equality is the familiar martingale difference equality and so we will refer to i f as a martingale difference it implies the familiar telescoping identity e j f i i j e j i f for any function the haar support of f is the collection i d f i 0 2 4 good bad decomposition with a choice of dyadic grid d understood we say that j d is r good if and only if for all intervals i d with i 2 r 1 j the distance from j to the boundary of either child of i is at least j i 1 for f l 2 we set p goodf i d i is r good i f the projection p w goodg is defined similarly to make the two reductions below one must make a random selection of grids as is detailed in 8 29 the use of random dyadic grids has been a basic tool since the foundational work of 14 16 important elements of the suppressed construction of random grids are that 1 it suffices to consider a single dyadic grid d 2 for any fixed 0 1 2 we can choose integer r sufficiently large so that it suffices to consider f such that f p goodf and likewise for g l 2 w namely it suffices to estimate the constant below for arbitrary dyadic grid d h f g w ngood f g w where it is required that f p good l 2 and g pwgood l 2 w 6 m t lacey e t sawyer c y shen and i uriarte tuero that the functions are good is at some moments an essential property we suppress it in notation however taking care to emphasize in the text those places in which we appeal to the property of being good a reduction using randomized dyadic grids allows one the extraordinarily useful reduction in the next lemma this is a well known reduction due to nazarov treil volberg explained in full detail in the current setting in 17 4 below h is as in 1 5 the normalized sum of the a 2 and testing constants lemma 2 4 for all sufficiently small and sufficiently large r this holds suppose that for any dyadic grid d such that no endpoint of an interval i d is a point mass for or w 1 there holds 2 5 h p goodf p w goodg w h f g w then the same inequality holds without the projections p good and p w good inequality 2 5 should be understood as an inequality uniform over the class of smooth trun cations of the hilbert transform but we can suppress this in the notation without causing confusion the bilinear form only needs to be controlled for r good functions f and g good ness being defined with respect to a fixed dyadic grid suppressing the notation we write good for r good and it is always assumed that the dyadic grid d is fixed and only good intervals are in the haar support of f and g though is also suppressed in the notation 3 the global to local reduction the goal of this section is to reduce the analysis of the bilinear form in 2 5 to the local estimate 3 4 it is sufficient to assume that f and g are supported on an interval i 0 by trivial use of the interval testing condition we can further assume that f and g are of integral zero in their respective spaces thus f is in the linear span of good haar functions h i for i i 0 and similarly for g and h f g w i j i j i 0 h i f w j g w the argument is independent of the choice of truncation that implicitly appears in the inner product above the double sum is broken into different summands many of the resulting cases are elementary and we summarize these estimates as follows define the bilinear form babove f g i i i 0 j j ij e ij i f h ij w j g w where here and throughout j i means j i and 2 r j i in addition the argument of the hilbert transform ij is the child of i that contains j so that i f is constant on ij define bbelow f g in the dual fashion 1 this set of dyadic grids that fail this condition have probability zero in standard constructions of the random dyadic grids two weight hilbert transform 7 lemma 3 1 there holds with the notation of 1 5 h f g w b above f g bbelow f g h f g w this is a common reduction in a proof of a t 1 theorem and in the current context it only requires goodness of intervals and the a 2 condition for a proof one can consult 17 29 the lemma is specifically phrased and proved in this way in 9 8 these definitions are needed to phrase the global to local reduction the following definition depends upon the essential energy inequality 4 7 in the next section definition 3 2 given any interval f 0 define fenergy f 0 to be the maximal subintervals f f 0 such that p f 0 f 2 e w f 2 w f 10 c 0 h 2 f where e w f is defined in 4 6 and c 0 is the constant in proposition 4 8 there holds f f f f 0 1 10 f 0 definition 3 3 let i 0 be an interval and let s be a collection of disjoint intervals contained in i 0 a function f l 2 0 i 0 is said to be uniform w r t s if these conditions are met 1 each energy stopping interval f fenergy i 0 is contained in some s s 2 the function f is constant on each interval s s 3 for any interval i i 0 which is not contained in any s s e i f 1 we will say that g is weakly adapted to a function f uniform w r t s if j s for some interval s s implies that g hwj w 0 we will also say that g is weakly adapted to s the constant l is defined as the best constant in the local estimate 3 4 babove f g l i 0 1 2 f g w where f g are of mean zero on their respective spaces supported on an interval i 0 moreover f is uniform and g is weakly adapted to f the inequality above is homogeneous in g but not f since the term i 0 1 2 is motivated by the bounded averages property of f theorem 3 5 global to local reduction there holds babove f g h l f g w the same inequality holds for the dual form bbelow f g a reduction of this type is a familiar aspect of many proofs of a t 1 theorem proved by exploiting standard off diagonal estimates for calder n zygmund kernels but in the current setting it is a much deeper fact a consequence of the functional energy inequality of 5 we make the following construction for an f l 2 i 0 of integral zero add i 0 to f and set f i 0 e i 0 f in the inductive stage if f f is minimal add to f those maximal descendants f of f such that f fenergy f or e f f 10 f f then define f f f f e f f 2 f f e f f otherwise 8 m t lacey e t sawyer c y shen and i uriarte tuero if there are no such intervals f the construction stops we refer to f and f as calder n zygmund stopping data for f following the terminology of 9 def 3 5 their key properties are collected here lemma 3 6 for f and f as defined above there holds 1 i 0 is the maximal element of f 2 for all i d i i 0 we have e i f 10 f fi 3 f is monotonic if f f f and f f then f f f f 4 the collection f is carleson in that 3 7 f f f s f 2 s s d 5 we have the inequality 3 8 f f f f f f proof the first three properties are immediate from the construction the fourth the carleson property is seen this way it suffices to check the property for s f now the f children can be in fenergy s which satisfy f fenergy s f 1 10 s otherwise note that by choice of f we have e s f 2 f s these intervals f satisfy e f f 10 f s 5 e s f these intervals satisfy the display above with 1 10 replaced by 1 5 hence 3 7 holds for the final property let g f be the subset at which the stopping values change if f f g and g is the g parent of f then f f f g set g f f gf g f define gk g 2 k for k 0 1 the carleson property implies integrability of all orders in measure of g using the third moment we have gk 2 3 k g then estimate f f f f f 2 g g f g g 2 k 0 k 1 1 1 g g f g 2 k 1 gk 2 k 0 k 1 2 g g f g 2 k 1 gk x 2 k 0 k 1 2 g g f g 222 k gk two weight hilbert transform 9 g g f g 2 g mf 2 f 2 note that we have used cauchy schwarz in k at the step marked by an in the step marked with for each point x the non zero summands are a super geometric sequence of scalars so the square can be moved inside the sum finally we use the estimate on the measure of gk and compare to the maximal function mf to complete the estimate we will use the notation p f f i d f i f i f f f and similarly for qwf but rather than use fj in the definition we use fj defined to be the minimal f f with j f without this alternate definition some delicate case analysis would be forced upon us the inequality 3 8 allows us to estimate f f f f f 1 2 p f f q w f g w f f f f 2 f p f f 2 f f qwf g 2 w 1 2 f g w 3 9 we will refer to this as the quasi orthogonality argument and we remark that it only requires orthogonality of the projections qwf g it is very useful lemma 3 10 there holds babove f g babovef f g h f g w where babovef f g f f babove p f f q w f g proof we apply functional energy of 5 observe that f f f p f f and j j i 0 wj g f f qwf g from the definition of babove f g we can assume that g equals the sum above therefore babove f g f f f f babove p f f q w f g in the sum above we can also add the restriction that f f for otherwise babove p f f q w f g 0 for a pair of intervals j ij note that this implies that j fi that is fj fi therefore we can add the restriction f f the case of f f is the definition of babovef f g so that it suffices to estimate 3 11 f f f f f babove p f f q w f g 10 m t lacey e t sawyer c y shen and i uriarte tuero observe that the functions gf q w f g are f adapted in the sense of definition 5 1 and by construction f satisfies the carleson measure condition 3 7 we take these steps to apply functional energy inequality the argument of the hilbert transform is if the child of i that contains f write if f if f and use linearity of h note that by the standard martingale difference identity and the construction of stopping data i i f e if i f f f f f hence invoking interval testing f f i i f e if i f h f gf w f f f f h f gf w h f f f f f 1 2 gf w quasi orthogonality bounds this last expression for the second expression when the argument of the hilbert transform is if f first note that i i f e if i f if f f f f f f f f therefore by the definition of f adapted the monotonicity property 4 3 applies and yields i i f e if i f h if f gf w j j f p j x j jgf w f f here j f are the maximal good intervals j f and gf j j f j f g j h w j so that every term has a positive inner product with x the sum over f f of this last expression is controlled by functional energy and the property that f this completes the bound for 3 11 proof of theorem 3 5 by lemma 3 10 it remains to control babovef f g keeping the quasi orthogonality argument in mind we see that appropriate control on the individual summands is enough to control it for each f f let sf be the f children of f observe that the function 3 12 c f f 1 p f f is uniform on f w r t sf for appropriate absolute constant c moreover the function q w f g does not have any interval j in its haar support strongly contained in an interval s sf that is it is weakly adapted to the function in 3 12 therefore by assumption babove p f f q w f g l f f f 1 2 p f f q w f g w the sum over f f of the right hand side is bounded by the quasi orthogonality argument of 3 9 two weight hilbert transform 11 4 energy monotonicity and poisson our theorem is particular to the hilbert transform and so depends upon special properties of it they largely extend from the fact that the derivative of 1 y is positive the following monotonicity property for the hilbert transform was observed in 9 lemma 5 8 and is basic to the analysis of the functional energy inequality lemma 4 1 monotonicity property let k i be two intervals and assume that does not have point masses at the end point of i then for any function g l 2 i w with w integral zero and 2 k 4 2 p k i i x i g w lim inf 0 h k i g w here g j g j hwj is a haar multiplier applied to g if j is a good interval j i then for function g l 2 j w with w integral zero and signed measures and supported on k i with it holds that 4 3 sup 0 h g w p j x j g w the truncations enter into the formulation of the lemma since they play a notable role here we need this preparation lemma 4 4 let i and j be two intervals which share an endpoint a at which neither nor w have a point mass then 4 5 sup 0 h i j w a 1 2 2 i w j proof if i j this inequality is the weak boundedness principle of 8 2 2 so let us assume that 10 i j then it remains to bound h i j 10 i w n 11 i w j n 1 i ni n i i i 1 2 p w i 1 2 w j 1 2 a 1 2 2 i w j this depends upon obvious kernel bounds and an application of cauchy schwarz to derive the poisson term above proof of lemma 4 1 by linearity it suffices to prove 4 2 in the case of g hwi the point is to separate the supports of the functions involved since i does not have a point mass at the end point of i we have i i 0 as 1 it follows that we can fix a 1 sufficiently small so that p k i i p k i i and one more condition that we will come back to then for 0 1 2 1 i we estimate as below where xi is the center of i h k i h w i w k i i k y x k y xi h w i x w dx dy 12 m t lacey e t sawyer c y shen and i uriarte tuero k i i x xi y x y xj hwi x w dx dy p k i i x xi i hwi w we have subtracted the term since hwi has integral zero then applied 2 3 with cx xj y 1 as follows from our choices of and then note that x xj h w i 0 so that we can pull out the poisson term the last line follows by our selection of sufficiently close to 1 then the last condition needed is to select sufficiently close to one that in view of 4 5 sup h i i h w i w a 1 2 2 i i cp k i i x xi i hwi w in the last line c 0 is an absolute constant this completes the proof of 4 2 turn to 4 3 the estimate 2 3 applies h g w k i j k y x k y xj h w j x w dx dy k i j cx xj y x xj y x y xj hwj x w dx dy but recall that 0 cx xj y 4 and equals one for sufficiently small moreover y x and y xj have the same sign and x xj h w j x 0 so an upper bound is obtained by passing from to h g w k i j x xj y x y xj hwj x w dx dy p j x j hwj w the concept of energy is fundamental to the subject for interval i define 4 6 e w i 2 e w dx i e w dx i x x 2 i 2 2 w i j i x i hwj 2 w now consider the energy constant the smallest constant e such that this condition holds as presented or in its dual formulation for all dyadic intervals i 0 all partitions p of i 0 into dyadic intervals it holds that 4 7 i p p i 0 i 2 e w i 2 w i e 2 i 0 this was shown in 8 proposition 2 11 proposition 4 8 for a finite constant c 0 e 2 c 0 a 1 2 2 t 2 c 0 h 2 we will always estimate e by h the proof is recalled here two weight hilbert transform 13 proof it suffices to consider the case of finite partitions p of i we first prove a version of the energy inequality with holes in the argument of the poisson it follows from 4 2 that we can fix 0 such that p i 0 i i 2 e w i 2 w i h i 0 i 2 l 2 i i p then using linearity and interval testing we have i p h i 0 2 l 2 i h i 0 2 l 2 i h 2 i 0 and i p h i 2 l 2 i h 2 i p i h 2 i 0 then by the a 2 bound we have p i i 2 e w i 2 w i i which we can sum over the partition this completes the proof one should keep in mind that the concept of energy is related to the tails of the hilbert transform the energy inequality and its multi scale extension to the functional energy inequality show that the control of the tails is very subtle in this problem we also need the following elementary poisson estimate from 29 used occasionally in this argument it is crucial to the proof of lemma 3 1 lemma 4 9 suppose that j i i 0 and that j is good then 4 10 j 2 1 p i 0 i j i 2 1 p i 0 i i proof we have dist j i 0 i j i 1 so that for any x i 0 i we have j 2 j dist x j 2 i 2 i dist x i 2 integrating this last expression it follows that j 2 1 p i 0 i j j 2 1 i 0 i j j dist x j 2 d i 2 i 0 i 1 j dist x j 2 d and this proves the inequality 5 the functional energy inequality we state an important multi scale extension of the energy inequality 4 7 definition 5 1 let f be a collection of dyadic intervals a collection of good functions gf f f in l 2 w is said to be f adapted if for all f f the haar support of the function gf is contained in j fj f 14 m t lacey e t sawyer c y shen and i uriarte tuero definition 5 2 let f be the smallest constant in the inequality below or its dual form the inequality holds for all non negative h l 2 all carleson collections f and all f adapted collections gf f f f f j j f p h j x j gfj w f h f f gf 2 w 1 2 here j f consists of the maximal good intervals j f note that the estimate is universal in h and f separately this constant was identified in 9 and is herein shown to be necessary from the a 2 and interval testing inequalities recall the definition of h in 1 5 theorem 5 3 assume that f satisfies 3 7 then f h the first step in the proof is the domination of the constant f by the best constant in a certain two weight inequality for the poisson operator with the weights being determined by w and in a particular way this is the decisive step since there is a two weight inequality for the poisson operator proved by one of us it reduces the full norm inequality to simpler testing conditions which are in turn controlled by the a 2 and hilbert transform testing conditions 5 1 the two weight poisson inequality consider the weight f f j j f p w f j x j 2 w xj j here pwf j j j j f j f wj we can replace x by x c for any choice of c we wish the projection is unchanged and q denotes a dirac unit mass at a point q in the upper half plane r 2 we prove the two weight inequality for the poisson integral p h l 2 r 2 h h for all nonnegative h above p denotes the poisson extension operator to the upper half plane so that in particular p h 2 l 2 r 2 f f j j f p h xj j 2 p w f j x j 2 w where xj is the center of the interval j the proof of theorem 5 3 follows by duality phrasing things in this way brings a significant advantage the characterization of the two weight inequality for the poisson operator 27 reduces the full norm inequality above to these testing inequalities for any dyadic interval i d r 2 p i 2 d x t h 2 i 5 4 r p ti 2 dx a 2 i t 2 d x t 5 5 two weight hilbert transform 15 where i i 0 i is the box over i in the upper half plane and p is the dual poisson operator p ti i t 2 t 2 x y 2 dy dt one should keep in mind that the intervals i are restricted to be in our fixed dyadic grid a reduction allowed as the integrations on the left in 5 4 and 5 5 are done over the entire space either r 2 or r goodness of the intervals i above is not needed this reduction is critical to the analysis below remark 5 6 a gap in the proof of the poisson inequality at 27 page 542 can be fixed as in 28 or 7 5 2 the poisson testing inequality the core this subsection is concerned with a part of inequality 5 4 restrict the integral on the left to the set i r 2 i p i 2 d x t h 2 i since xj j i if and only if j i we have i p i x t 2 d x t f f j j f j i p i xj j 2 p w f j x j 2 w for each j p w f j x j 2 w j x ewj x j 2 dw x 2 e w j 2 w j 2 w j 5 7 let f 0 be the maximal f f which are strictly contained in i and let j be those dyadic j such that xj j is in the support of but has no parent in f 0 these intervals are necessarily disjoint observe that by 5 7 and the energy inequality j j p f xj j 2 xj j j j p f j 2 e w j 2 w j h 2 f 5 8 we claim that 5 9 f f 0 f p i f x t 2 d x t h i this is sufficient since i p i x t 2 d x t lhs 5 8 lhs 5 9 f f 0 f p f x t 2 d x t h 2 i f f 0 f p f x t 2 d x t 16 m t lacey e t sawyer c y shen and i uriarte tuero the individual terms in the last sum are set up for a recursive application of this inequality due to the carleson condition 3 7 this recursion will finish the proof it remains to prove 5 9 which is another instance of the energy inequality for an interval f 0 f 0 and f f strictly contained in f 0 each interval j j f is contained in some j 0 j f 0 then the intervals f f are not good but j and j 0 are good hence p i f 0 xj j 2 xj j i f 0 j j 2 x xj 2 2 p w f j x j 2 w i f 0 1 j 2 x xj 2 2 pwf jx 2 w i f 0 j 0 j 0 2 x xj 0 2 2 p w f j x j 0 2 w this follows from goodness for x i f 0 j 2 x xj 2 x xj 2 x xj 0 2 j 0 f 0 1 but then we can add the projections pwf j due to orthogonality and use 5 7 again to see that f f f f 0 j j f j j 0 p i f 0 xj j 2 xj j p i xj 0 j 0 2 f f f f 0 j j f j j 0 p w f j x j 0 2 w p i xj 0 j 0 2 e w j 0 2 w j 0 the sum over f 0 f 0 and j 0 j f 0 is controlled by the energy inequality this completes the proof of 5 9 5 3 the poisson testing inequality the remainder now we turn to proving the following estimate for the global part of the first testing condition 5 4 r 2 i p i 2 d a 2 i decompose the integral on the left into four terms with fj the unique f f with j j f and using 5 7 r 2 i p i 2 d j xj j r 2 i p i xj j 2 p w fj j x j 2 w j j 3 i j i j j 3 i i j j i j i j j i p i xj j 2 w j two weight hilbert transform 17 a b c d decompose term a according to the length of j and its distance from i to obtain a n 0 k 1 j j 3 k 1 i 3 ki j 2 n i 2 n i dist j i 2 i 2 w j n 0 2 2 n k 1 i 2 i w 3 k 1 i 3 ki 3 ki 4 i n 0 2 2 n k 1 3 2 k 3 k 1 i w 3 k 1 i 3 ki 2 i a 2 i decompose term b according to the length of j and then use the poisson inequality 4 10 available to use because of goodness of intervals j we then obtain b n 0 j j 3 i i j 2 n 2 n 2 4 i 2 i 2 w j n 0 2 n 2 4 3 i w 3 i 3 i 2 i a 2 i for term c for n 1 2 set jn to be those good dyadic intervals j with j i j i and n 1 j dist i j n j these intervals have bounded overlaps indeed suppose that j 1 jr are all members for j 1 then by goodness dist j 1 i dist jr i n 1 2 r j 1 dist j 1 jr n 1 2 r 2 r 1 j 1 which is a contradiction to membership in jn restricting the sum to intervals in jn there holds j jn p i xj j 2 w j i 2 j jn w j n 4 j 2 i 2 i j jn w j i n 4 j 2 i n 2 i i p w i a 2 i n 2 and this is summable in n n 18 m t lacey e t sawyer c y shen and i uriarte tuero in the last term d all the intervals j contain i note that j j i p i xj j 2 w j i 2 j j i w j j 2 i i i j j i w j i j 2 i i i p w i a 2 i 5 4 the dual poisson testing inequality we are considering 5 5 note that there is a power of t on both sides and that the expressions on the two sides of this inequality are i t 2 dx dt f f j j f j i pwf jx 2 w p ti x f f j j f j i pwf jx 2 w j 2 x xj 2 we are to dominate p ti 2 by the first expression above the squared norm will be the sum over integers s of ts below in which the relative lengths of j and j are fixed by s suppressing the requirement that j j i ts f f j j f f f j j f j 2 s j pwf jx 2 w j 2 x xj 2 pwf j x 2 w j 2 x xj 2 d ms f f j j f pwf jx 2 w where ms sup f f sup j j f f f j j f j 2 s j 1 j 2 x xj 2 w j j 2 j 2 x xj 2 d the estimate 5 7 has been used in the definition of ms we claim the term ms is at most a constant times a 22 s and it is here that the full poisson a 2 condition is used fix j and let n n be the integer chosen so that n 1 j dist j j n j estimate the integral in the definition of ms by w j j j 2 j 2 x xj 2 j j 2 x xj 2 d a 22 2 s two weight hilbert transform 19 this estimate is adequate for n 0 1 2 then estimate the sum over j as follows f f j j f j 2 s j n 1 j dist j j n j 2 2 s 2 s because the relative lengths of j and j are fixed and each j is in at most one j f for the case of n 3 restrict j to be to the right of j and let tn xj xj 2 so that xj tn xj tn n j first estimate the integral in the definition of ms on the interval tn w j j tn j 2 j 2 x xj 2 j j 2 x xj 2 d a 2 2 2 s n 2 then estimate the sum over j as follows f f j j f j 2 s j n 1 j dist j j n j 2 2 s n 2 2 s n 2 this is clearly summable in n 4 now estimate on the integral on the interval tn w j j tn j 2 j 2 x xj 2 j j 2 x xj 2 d 2 2 s w j j tn j j 2 x xj 2 j 2 j 2 x xj 2 d 2 2 s w j n 2 j p j drop the term with the geometric decay in s and sum over n and j to see that n 4 f f j j f j 2 s j n 1 j dist j j n j w j n 2 j p i p w j p j a 2 here we have appealed to the full poisson a 2 condition this completes the control of the dual poisson testing condition references 1 guy david and jean lin journ a boundedness criterion for generalized calder n zygmund operators ann of math 2 120 1984 no 2 371 397 mr 763911 85 k 42041 2 v p havin and n k nikolski eds linear and complex analysis problem book 3 part i lecture notes in mathematics vol 1573 springer verlag berlin 1994 mr 1334345 96 c 00001 a 3 tuomas p hyt nen the sharp weighted bound for general calder n zygmund operators ann of math 2 175 2012 no 3 1473 1506 20 m t lacey e t sawyer c y shen and i uriarte tuero 4 tuomas p hyt nen michael t lacey henri martikainen tuomas orponen maria carmen reguera eric t sawyer and ignacio uriarte tuero weak and strong type estimates for maximal truncations of calder n zygmund operators on ap weighted spaces j anal math 118 2012 177 220 5 michael t lacey two weight inequality for the hilbert transform a real variable characterization ii submitted 2013 available at http www arxiv org abs 1301 4663 6 michael t lacey stefanie petermichl and maria carmen reguera sharp a 2 inequality for haar shift operators math ann 348 2010 no 1 127 141 mr 2657437 7 michael lacey eric t sawyer and ignacio uriarte tuero a characterization of two weight norm inequalities for maximal singular integrals with one doubling measure anal pde 5 2012 no 1 1 60 8 michael t lacey eric t sawyer and ignacio uriarte tuero a two weight inequality for the hilbert transform assuming an energy hypothesis j funct anal 263 2012 305 363 9 michael t lacey eric t sawyer chun yun shen and ignacio uriarte tuero the two weight inequality for the hilbert transform coronas and energy conditions 2011 available at http www arxiv org abs 1108 2319 10 yurii i lyubarskii and kristian seip complete interpolating sequences for paley wiener spaces and mucken houpt s ap condition rev mat iberoamericana 13 1997 no 2 361 376 mr 1617649 99 e 42004 11 benjamin muckenhoupt weighted norm inequalities for the hardy maximal function trans amer math soc 165 1972 207 226 mr 0293384 45 2461 12 hardy s inequality with weights studia math 44 1972 31 38 collection of articles honoring the completion by antoni zygmund of 50 years of scientific activity i mr 0311856 47 418 13 f nazarov a counterexample to sarason s conjecture preprint msu 1997 available at http www math msu edu fedja prepr html 14 f nazarov s treil and a volberg cauchy integral and calder n zygmund operators on nonhomogeneous spaces internat math res notices 15 1997 703 726 15 accretive system tb theorems on nonhomogeneous spaces duke math j 113 2002 no 2 259 312 16 the tb theorem on non homogeneous spaces acta math 190 2003 no 2 151 239 17 two weight estimate for the hilbert transform and corona decomposition for non doubling measures 2004 available at http arxiv org abs 1003 1596 18 two weight inequalities for individual haar multipliers and other well localized operators math res lett 15 2008 no 3 583 597 mr 2407233 2009 e 42031 19 f nazarov and a volberg the bellman function the two weight hilbert transform and embeddings of the model spaces k j anal math 87 2002 385 414 dedicated to the memory of thomas h wolff 20 nikolai nikolski and s treil linear resolvent growth of rank one perturbation of a unitary operator does not imply its similarity to a normal operator j anal math 87 2002 415 431 dedicated to the memory of thomas h wolff mr 1945291 2004 e 47004 21 carlos p rez s treil and a volberg on a 2 conjecture and corona decomposition of weights 2010 available at http arxiv org abs 1006 2630 22 sharp weighted estimates for dyadic shifts and the a 2 conjecture 2010 available at http arxiv org abs 1010 0755 23 alexei poltoratski and donald sarason aleksandrov clark measures recent advances in operator related function theory contemp math vol 393 amer math soc providence ri 2006 pp 1 14 mr 2198367 2006 i 30048 24 maria carmen reguera and james scurry on joint estimates for maximal functions and singular integrals on weighted spaces proc amer math soc 141 2013 no 5 1705 1717 25 donald sarason exposed points in h 1 ii topics in operator theory ernst d hellinger memorial volume oper theory adv appl vol 48 birkh user basel 1990 pp 333 347 mr 1207406 94 a 46031 http www arxiv org abs 1301 4663 http www arxiv org abs 1108 2319 http www math msu edu fedja prepr html http arxiv org abs 1003 1596 http arxiv org abs 1006 2630 http arxiv org abs 1010 0755 two weight hilbert transform 21 26 eric t sawyer a characterization of a two weight norm inequality for maximal operators studia math 75 1982 no 1 1 11 mr 676801 84 i 42032 27 a characterization of two weight norm inequalities for fractional and poisson integrals trans amer math soc 308 1988 no 2 533 545 mr 930072 89 d 26009 28 e sawyer and r l wheeden weighted inequalities for fractional integrals on euclidean and homogeneous spaces amer j math 114 1992 no 4 813 874 mr 1175693 94 i 42024 29 a volberg calder n zygmund capacities and operators on nonhomogeneous spaces cbms regional con ference series in mathematics vol 100 published for the conference board of the mathematical sciences washington dc 2003 school of mathematics georgia institute of technology atlanta ga 30332 e mail address lacey math gatech edu department of mathematics statistics mcmaster university 1280 main street west hamilton ontario canada l 8 s 4 k 1 e mail address sawyer mcmaster ca department of mathematics national central university chungli 32054 taiwan e mail address chunyshen gmail com department of mathematics michigan state university east lansing mi e mail address ignacio math msu edu 1 introduction 2 dyadic grids and haar functions 3 the global to local reduction 4 energy monotonicity and poisson 5 the functional energy inequality references