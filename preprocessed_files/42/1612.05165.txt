arxiv 1612 05165 v 6 math sp 27 dec 2017 ar x iv 1 61 2 05 16 5 v 6 m at h s p 2 7 d ec 2 01 7 two spectra theorem with uncertainty n makarov and a poltoratski abstract the goal of this paper is to combine ideas from the theory of mixed spectral problems for differential operators with new results in the area of the uncertainty principle in harmonic analysis up using recent solutions of gap and type problems of up we prove a version of borg s two spectra theorem for schro dinger operators allowing un certainty in the placement of the eigenvalues we give a formula for the exact size of uncertainty calculated from the lengths of the inter vals where the eigenvalues may occur among other applications we describe pairs of indeterminate operators in the three interval case of the mixed spectral problem at the end of the paper we discuss further questions and open problems 1 introduction this paper studies connections between classical harmonic analysis and spectral problems for differential operators a newly developed approach in the area of the uncertainty principle in harmonic analysis up based on the use of toeplitz operators has brought new progress to several long standing problems the toeplitz approach pioneered by hruschev nikolski and pavlov in 36 19 was further developed and applied to a broader class of problems in 24 25 recent applications of the toeplitz approach in 32 39 40 37 33 41 involved a variety of problems of up and adjacent fields two of such problems the so called gap and type problems will be revisited in this note while most of the remaining open problems of up are extremely hard progress in any of them usually invites numerous applications in related fields one of such related fields is spectral theory for differential equations and krein s canonical systems the so called weyl titchmarsh transform which can be viewed as a generalization of the fourier transform for a broad class of linear differential operators provides clear analogies between spec tral theory and fourier analysis however despite being clearly visible at the intuitive level such analogies can take time and significant effort to for mulate in rigorous mathematical language one of the recent examples of such relations is the result on equivalence between the so called beurling malliavin problem on completeness of complex exponentials solved in 1960 s the first author is supported by n s f grant dms 1500821 the second author is supported by n s f grant dms 1665264 1 http arxiv org abs 1612 05165 v 6 2 n makarov and a poltoratski and mixed spectral problems for schro dinger operators found by m hor vath only in 2004 18 see also 24 as was mentioned above the goal of this paper is to discuss the connections between the gap and type problems and the so called mixed spectral prob lems for second order differential operators surprisingly such connections do not seem to be reflected in the literature while most of our results on spectral problems could be formulated in more general classes of differential operators such as krein s canonical systems we choose to test our methods on one the most studied models the schro dinger sturm liouville operator on an interval we consider the equation u qu z 2 u 1 1 on the interval 0 to simplify the statements and formulas we will always assume that the potential function q belongs to l 2 0 although most of our results admit lp analogs with p 1 classical spectral problems are divided into two main groups direct and inverse problems in direct problems one needs to find the spectra or the spectral measure of the operator from its potential q while in inverse prob lems one aims to recover q from the spectral information a famous result by marchenko 28 29 says that q can be uniquely recovered from the spectral measure another classical result is borg s two spectra theorem 6 which says that q can be recovered from two spectra corresponding to different pairs of boundary conditions see section 2 2 for further discussion a relatively new type of spectral problems the so called mixed spectral prob lem asks to recover the operator from partial information on the potential and the spectrum the well known theorem by hochstadt and lieberman from 1978 17 says that knowing the potential on one half of the interval 0 2 and knowing one of the spectra allows one to recover the opera tor uniquely the result is precise in the sense that the knowledge of the spectrum minus one point or of the potential on 0 2 is insufficient further results in the same direction obtained by del rio gesztesy horvath simon and others 45 13 11 18 24 allow one to combine various parts of the spectral and direct information to recover the operator together these results bring about the following quantitative interpretation of the spectral data suppose one is given a certain amount of spectral information on an opera tor in general such information can be very diverse from knowing a part of the spectrum to knowing parts of several spectra e g 11 24 or some of the pointmasses of one or several of the spectral measures the general question one may ask in such a situation is what part of the full spectral information is missing in some cases the answer is ready for instance as follows from borg s theorem one spectrum gives exactly one half of the full two spectra theorem with uncertainty 3 information since to recover the operator one needs two spectra results on the mixed spectral problems suggest that knowing a subsequence of the spectra of relative density say one half gives one forth of the full informa tion since it needs to be complemented with the knowledge of the potential on three fourths of the interval knowing the spectra of two restrictions of the original operator on 0 a and a gives one half of the informa tion if the spectra are disjoint because to recover the operator one needs to complement it with one spectrum of the whole operator 14 etc the ideas of mixed spectral problems allow us to formulate this rather vague question in precise mathematical terms we may say that the given spec tral information lacks a part of size a 0 a 1 if together with the potential on any 0 a 0 this information allows one to determine the operator uniquely while knowing the potential on 0 a is insuffi cient it becomes an interesting problem to determine a for various sets of incomplete spectral information in the present paper we answer this question for the uncertainty ver sion of borg s problem suppose that instead of knowing two spectra of a schro dinger operator we are given a sequence of intervals on the real line where the eigenvalues from the two spectra must occur clearly this spec tral information is incomplete but what part of the full information does it constitute this question can be considered within the context of uncer tainty quantification which is an active research area in natural sciences engineering and numerical analysis in section 4 2 we give a formula to find a in this problem which of course depends on the lengths of the intervals as we will see this question turns out to be closely related to the gap and type problems of up our formula for the size of uncertainty in the two spectra problem is equivalent to a case of the gap problem which can only be solved with recent results of 32 39 40 41 let be a non zero finite complex measure on the real line by we denote its fourier transform z exp izt d t in many applications a special role is played by measures with a spectral gap i e those non zero measures for which 0 on a a for some a 0 such measures are associated for instance with the exponential version of the moment problem determinacy properties in the theory of random processes and the study of high pass signals in electrical engineering in its most general formulation the gap problem asks for necessary and sufficient conditions for a measure to have a spectral gap of a given size the original statement of up as formulated by norbert wiener says that a measure function distribution and its fourier transform cannot be simul taneously small the gap problem traditionally belongs to the area of up 4 n makarov and a poltoratski here the smallness of is understood in the sense of the size of the gap the statement that one hopes to obtain is that if the support of has a large gap then the support of cannot be too rare its weight cannot decay too fast etc for more on the history of the gap problem see 2 20 22 41 the area of mixed spectral problems has direct connections to the gap problem the first evidence of such a connection can be seen from one of the main results of 45 which says that the difference of the weyl functions of two operators whose potentials coincide on 0 c must decay fast at infinity see section 4 1 experts in the gap problem could recognize such a decay condition as an estimate for the cauchy transform of a measure with a spectral gap after a square root substitution in section 4 1 we will see that the potentials of two operators coincide on 0 a if and only if the difference of the two spectral measures has the gap 2 a 2 a in its fourier spectrum another result of this paper is a parametrization of counterexamples inde terminate operators in the so called three interval case of the mixed spectral problem after the theorem by hochstadt and lieberman mentioned above and further results by del rio gesztesy simon and horvath the case of two intervals i e the case when the potential is known on 0 a 0 a and unknown on a is relatively well studied the logical problem is to try to replace 0 a with other subsets of 0 starting with a natural next step of two intervals 0 a b 0 a b however such attempts immediately meet the following elegant counterexample contained in 14 let the potential q of a schro dinger operator l satisfy q x q x for all x 0 2 let l be the operator with the reflected potential q x q x for all x it is well known that then the spectra of the two operators with any pair of symmetric boundary conditions at the end points will coincide nonetheless the operators are not identical unless q x q x for x 2 2 thus having almost complete direct in formation knowing the potential on the two intervals of total length 2 and a spectrum is insufficient to recover the operator this counterexample shows that the two interval problem is substantially different from the three interval case in view of horvath s result see sec tions 3 3 5 4 it seems that these differences are a reflection of the dif ferences between problems of completeness of exponential functions in l 2 over one interval the classical case and two or more intervals the case of band spectrum even though the classical case was solved via the famous beurling malliavin theorem in 1960 s the latter case is still widely open see for instance 34 we discuss these connections and formulate further questions in sections 3 1 and 5 4 until now the counterexample for the three interval problem mentioned above was the only one existing in the literature prompting some of the experts to ask if it was in some sense the only counterexample of that two spectra theorem with uncertainty 5 kind in section 4 3 we formulate a result describing all possible counterex amples for the three interval problem in terms of the spectral measures of the operators it follows from our parametrization that the pairs of oper ators with almost symmetric potentials provide only a submanifold of all pairs of indeterminate operators all other such pairs however have to be close to symmetric in terms of the asymptotics of the spectral measure see section 4 3 in the opposite direction we show that there exists a large class of operators which are uniquely determined by their potentials on two intervals and a proper part of the spectrum this raises the natural ques tion of describing the operators with such uniqueness properties discussed in section 5 2 the paper is organized as follows in sections 2 1 and 2 2 we define the spectra spectral measures and weyl functions for schro dinger operators in section 2 3 we discuss special properties of an operator with even potential and point out a connection between its spectral measure and the classical problem on completeness of polynomials in section 2 4 we give definitions and discuss basic properties of hermite biehler functions and de branges spaces in section 2 5 we discuss those spaces in relation to schro dinger operators in section 2 6 we give a description of hermite biehler functions corresponding to schro dinger operators with square summable po tentials in section 2 7 we define the krein spectral shift function for a schro dinger equation and prove some of its properties to be used in the main proofs in section 3 1 we give definitions of beurling malliavin bm density and formulate the famous bm theorem which solves the classical problem on completeness of families of exponential functions in section 3 2 we give an overview of some of the recent results on the gap and type problems to be used in section 4 2 in section 3 3 we formulate and give a short proof to a theorem by horvath on the connection between mixed spectral problems for schro dinger operators and the bm problem on completeness of ex ponential systems in section 4 1 we establish the connection between the gap and type problems and mixed spectral problems for schro dinger operators in section 4 2 we formulate and prove a version of the two spectra theorem with uncertainty mentioned in the introduction in section 4 3 we parametrize all examples of non uniqueness in the three interval version of the mixed spectral problem in section 4 4 we show the existence of operators uniquely determined by the 3 interval mixed data in sections 5 1 5 4 we discuss further examples and open problems 6 n makarov and a poltoratski 2 holomorphic functions in spectral problems 2 1 the schro dinger operator and its spectra as was mentioned in the introduction we consider the schro dinger equation lu u qu z 2 u 2 1 on the interval 0 to avoid unnecessary technicalities we will make the following assumptions even though some of our results can be extended to the case q lp we mostly restrict ourselves to square summable potentials q l 2 which makes some of the statements considerably shorter for the same reason we will consider only dirichlet u 0 or neumann u 0 boundary conditions at the endpoints the operator l u 7 u qu is a self adjoint operator in l 2 0 whose domain is the set of functions u with absolutely continuous derivatives which satisfy the boundary condi tions and the condition u qu l 2 0 in the case q l 2 0 the domain consists of functions from the sobolev space w 2 2 satisfying the boundary conditions the spectrum of the operator with q l 1 and any self adjoint boundary conditions at the endpoints is bounded from below we will assume the spectrum nd of l with dirichlet neumann bound ary conditions to be positive this assumption is not overly restrictive as any operator can be made positive by adding a positive constant to q the spectrum then shifts to the right by the same constant we will denote the set of operators satisfying the above conditions by s 2 occasionally we will use the notation s 1 for the operators with summable potentials as it is often done in this area to facilitate the application of standard tools of fourier analysis we will apply the square root transform to the spectra and analytic functions associated with our operators in particular we will denote by dd and nd the spectra of the operator l after the square root transform dd n 2 n dd 0 nd n 2 n nd note that under our positivity assumptions both spectra are real we say that a sequence of complex numbers is discrete if it does not have finite accumulation points both spectra dd and nd are real discrete sequences moreover it is well known that dd n n z 0 0 n n c n an n n n 2 2 two spectra theorem with uncertainty 7 and nd n n n n n 1 2 c n bn n n n 2 3 where c is a real constant and an bn l 2 conversely two interlacing sequences are equal to the spectra dd nd of a schro dinger operator on 0 with an l 2 potential if and only if the sequences satisfy the above asymptotics with some an bn l 2 these asymptotics follow from more general formulas by marchenko 29 see also 42 or 1 2 2 analytic integrals of spectral measures we denote by the pois son measure on the real line d x dx 1 x 2 and by l 1 the space of poisson summable functions on r if u l 1 we define its herglotz integral as hu z 1 1 t z t 1 t 2 u t dt if is a poisson finite measure on r i e d x 1 x 2 then h z 1 1 t z t 1 t 2 d t denote by uz t the solution of 2 1 with boundary conditions u 0 0 u 0 1 the weyl function m is defined as m u z zuz it is well known that m is a herglotz integral of a positive measure sup ported on dd n m z h z 0 0 n n n n n n 1 cn n 1 cn l 2 2 4 similarly if vz t is the solution of 2 1 with boundary conditions v 0 v 1 one defines m v z 0 zvz 0 then is defined via m z h z 0 0 n n n n n 8 n makarov and a poltoratski n 1 dn n 1 dn l 2 2 5 the asymptotics of the pointmasses n n can be deduced from the spec tral asymptotics of dd and nd discussed in the last section moreover together the asymptotics for n dd n nd and for n n give an if and only if condition for a positive measure to be a spectral measure of a schro dinger operator from s 2 the famous theorem by marchenko says that a regular q l 1 schro dinger operator can be uniquely recovered from its spectral measure or another classical result is the follow ing two spectra theorem by borg throughout the paper we will say that a schro dinger operator is uniquely determined by its mixed spectral data if any other operator from the same class with the same data must have the same potential q a e on 0 theorem 1 borg 6 a schro dinger operator l s 1 is uniquely deter mined by its spectra dd and nd no proper subset of dd nd has the same property as was mentioned in the introduction we will present an uncerainty version of this theorem in section 4 2 for a subinterval a b of 0 we denote bym m a b the transfer matrix the matrix valued entire function defined as m z uz b vz b u z b v z b where uz and vz are solutions for the restriction of the equation 2 1 on the interval a b with dirichlet and neumann initial conditions at a respec tively note that by thewronskian identity detm 1 andm wz a w z a t wz b w z b t for any solution wz of 2 1 2 3 the even operator we will call an operator l even with respect to the middle of the interval if its potential satisfies q x q x for all x 0 2 such an operator is uniquely defined by one of its spectra say dd see for instance 42 if n is a sequence satisfying 2 2 we denote by n the sequence of pointmasses of the spectral measure n n corresponding to the unique even operator with dd n notice that in the even case lemma 1 for any schro dinger operator l s 1 the pointmasses of satisfy n n 2 n two spectra theorem with uncertainty 9 proof let uz vz be solutions defined as above for l notice that for the even operator l such solutions coincide up to a constant multiple and denote by wz one of these solutions the functions zuz zvz 0 and zwz are entire functions of z of exponential type which are real on the real line and have zeros at n since such an entire function is unique up to a real constant multiple zuz zvz 0 and zwz are equal up to a constant multiple since all three functions must be equivalent to sin z z as z iy y see for instance 42 page 13 theorem 3 they must be the same denote this entire function by f z let dd let u c and v 0 d notice that uniqueness of dirichlet dirichlet solution implies c 1 d since m z m z u v 0 f 2 z 2 o 1 as z we conclude that n n 1 f n 2 it is left to notice that since the right hand side does not depend on l for the even operator we must have n n 2 n 1 f n 2 remark 1 the constants n the pointmasses of the spectral measure of the even operator appear under different names in other problems of analysis as an example let us point out the following connection with the classical problem of completeness of polynomials in weighted spaces throughout the paper we assume that all discrete real sequences are enu merated in natural increasing order we say that a sequence n has two sided upper density d if lim sup a a a 2 a d if d 0 we say that the sequence has zero density a discrete sequence n is called balanced if the limit lim n n n n 1 2 n 2 6 exists 10 n makarov and a poltoratski let n be a balanced sequence of finite upper density for each n n put pn 1 2 log 1 2 n n 6 k k log 1 2 k k n 2 where the sum is understood in the sense of principle value i e as lim n 0 n k n log 1 2 k k n 2 we will call the sequence of such numbers p pn the characteristic sequence of here is a sample of a statement on completeness of polynomials in terms of characteristic sequences theorem 2 37 41 let be a finite positive discrete measure supported on r such that l 1 contains polynomials polynomials are not dense in l 1 if and only if there exists a balanced zero density subsequence n supp such that its characteristic sequence p pn satisfies exp pn o n as n similar statements can be formulated for families of exponential functions in place of polynomials in such statements zero density sequences are replaced with sequences of positive density which makes them closer related to the regular spectral problems considered in this note for such results along with the case of lp p 6 1 or bernstein s spaces see for instance 37 41 the case of a general measure can be reduced to the discrete case via some of the standard tools of completeness problems for further references and historic remarks see also 23 30 as the reader may have already guessed the characteristic sequence pn is nothing else but the sequence of pointmasses of the even operator n in the case when is a spectral sequence i e p since any discrete sequence is a spectral sequence for a suitably chosen krein s canonical sys tem one could formulate the last statement using pointmasses of the even operator instead of characteristic sequences as we saw in the last proof an alternative way to define the constants n is n 1 f n where f z 1 z n two spectra theorem with uncertainty 11 2 4 hermite biehler functions and de branges spaces if f z is an entire function we denote by f z the reflected function f z f z note that f f on r an entire function f z belongs to the paley wiener class pwa a 0 if and only if it is a fourier transform of a square summable function supported on a a an equivalent definition the equivalence is established by the paley wiener theorem is that f pwa iff f z e iaz h 2 c f z e iaz h 2 c where h 2 c is the hardy space in the upper half plane c the definition of the de branges spaces of entire functions may be viewed as a generalization of the last definition of the paley wiener spaces with e iaz replaced by a more general entire function consider an entire function e z satisfying the inequality e z e z z c such functions are usually called de branges functions the de branges spaceb e associated with e z is defined to be the space of entire functions f z satisfying f z e z h 2 c f z e z h 2 c it is a hilbert space equipped with the norm f e f e l 2 r if e z is of exponential type then all the functions in the de branges space b e are of exponential type not greater then the type of e z such a de branges space is called short or regular if together with every function f z it contains f z f a z a for any a c one of the most important features of de branges spaces is that they admit a second axiomatic definition let h be a hilbert space of entire functions that satisfies the following axioms a 1 if f h f 0 then f z z z h with the same norm a 2 for any 6 r point evaluation at is a bounded linear functional on h a 3 if f h then f h with the same norm then h b e for a suitable de branges function e this is theorem 23 in 7 usually for a given hilbert space of entire functions it is not difficult to verify the above axioms and conclude that the space is a de branges space it is however a challenging problem in many situations to find a generating function e this problem can be viewed as an abstract generalization of the inverse spectral problem for second order differential operators 12 n makarov and a poltoratski in the case of regular de branges spaces this connection can be illustrated as follows given a spectral measure of a regular differential operator one con structs a chain of hilbert spaces of entire functions equal to paley wiener spaces as sets with norms inherited from l 2 the norms generated by measures corresponding to regular schro dinger operators or dirac systems will be equivalent to the standard norms in pwa see for instance 26 af ter that by verifying the axioms one can prove that the resulting spaces are de branges spaces the problem of recovering the generating functions et then becomes equivalent to the inverse spectral problem since these func tions provide a solution to the original equation system thus allowing one to recover the operator we will discuss such chains of spaces and relations between et and solutions to the schro dinger equation in the next section recall that an entire function is called real if it is real on r any entire function f can be represented as f c id where c 1 2 f f d 1 2 i f f are real entire functions in the case when e a ib is a de branges function its real and imaginary parts a and b can be viewed as analogs of sin z and cos z in the standard fourier settings we will adopt a common terminology and call de branges functions with no real zeros hermite biehler functions hermite biehler functions form an important subclass of de branges functions appearing in many applications in particular de branges functions associated with schro dinger equations represent the hermite biehler class it is well known that e a ib e 6 0 in c of exponential type is an hermite biehler function if and only if the real functions a and b have real alternating interlacing zeros each de branges space possess a family of spectral measures i e discrete measures on r such that the natural embedding b e l 2 is a unitary operator one of the natural choices for the spectral measure is the measure defined by the equation h e 2 b a where a 1 2 e e and b 1 2 i e e are the real and imaginary parts of e on r the isomorphism b e l 2 generalizes the parseval theorem for more on de branges spaces see 7 44 27 2 5 de branges spaces in schro dinger settings now let us return to schro dinger equations and the discussion of related analytic functions in section 2 2 as before let uz t denote the solution of 2 1 satisfying the dirichlet boundary conditions at 0 two spectra theorem with uncertainty 13 for any t 0 the function et z zuz t iu z t is an entire function from the hermit biehler class the spaces b et form a chain i e b et is isometrically embedded into b es for any t s it follows from our definitions of the schro dinger spectral measures and the above discussion of spectral measures for de branges spaces that is a spectral measure for b e i e the spaces b et 0 t are isometrically embedded in l 2 similarly one can consider the right to left chain of de branges spaces b fs fs z zvz s iv z s satisfying b ft b fs for t s the measure is a spectral measure for b f 0 and all b fs are isometrically embedded into l 2 the well known asymptotics of the solutions uz and vz imply that both chains are regular it is well known that in the case of regular schro dinger operators the de branges spaces b et are equal to paley wiener spaces pwt as sets with equivalent norms indeed it follows from the asymptotics 2 4 that the norm of l 2 is equivalent to the standard norm in each pwt 0 t see for instance 35 verifying the axioms we can show that each pwt equipped with the l 2 norm is a de branges space by the uniqueness of a regular de branges chain in each l 2 space over a poisson finite measure the new chain has to coincide with b et similarly b fs pw s as sets for more on the basics of de branges theory see 7 44 for the particular case of schro dinger equations see 9 43 one can consider the above to be a shortcut definition of de branges chains corresponding to schro dinger equations i e one can define b et to be the paley wiener space pwt equipped with an equivalent norm from l 2 establishing the equivalence of norms is a good exercise let us remark that the study of more general measures providing equivalent norms for the payley wiener spaces is yet another deep classical problem of analysis see for instance 35 after the equivalence of norms is established verifying the axioms is straight forward with a bit of technical work one can also verify that et z zuz t iu z t is an hermite biehler function and proceed with the first definition which leads to the same chain of spaces the equality of de branges spaces to paley wiener spaces as sets is one of the tools of the gelfand levitan theory in the area of spectral problems for schro dinger equations and dirac systems see for instance 12 21 in these papers the differential operator is defined on the half axis 0 and restrictions of the operator to 0 t give rise to a chain of de branges spaces b et each equal to the paley wiener space pwt as sets after that the well studied structure of the pw spaces allows one to write integral equa tions for the fourier transform of the spectral measure of the operator and 14 n makarov and a poltoratski obtain results relating its properties to the properties of the potential see also 26 31 the same property can be viewed from perturbational point of view for small summable potentials the de branges chain coincides as sets with the paley wiener chain of spaces which is the de branges chain for the free operator q 0 in this regard one may ask for what general canonical sys tems schro dinger equations dirac systems the corresponding de branges chains coincide as sets one of the versions of this problem is to characterize hamiltonians such that de branges spaces are paley wiener spaces as sets we know this is true for regular schrodinger and dirac operators while paley wiener spaces appear only in the case of a regular left end point the method applies in the singular case as well at least in the compact resolvent case but the model de branges spaces will no longer be paley wiener spaces 2 6 hermite biehler functions for schro dinger operators not ev ery hermite biehler function can be obtained from a schro dinger equation in the way described in the last section characterization of such functions is important for applications as we will illustrate in section 3 3 such a characterization was recently obtained in 1 here we present a version of the same result which will be more convenient for our purposes consider the backward shift operator s on pwa defined as s f f f 0 z this is a bounded operator with a dense image we will denote the image of s by pw a functions from pw a appear naturally in relation with schro dinger operators theorem 3 an entire function e a ib of hermite biehler class cor responding to a schro dinger equation from s 2 satisfies a sin z f and b cos z g 2 7 where f is an odd function from pw 1 and g is an even function from pw 1 such that f s f g s g for some f g pw 1 f 0 g 0 moreover for any such f g pw 1 with f 0 g 0 there exists 0 such that for any c 1 r c 1 and c 2 r c 2 the function e a ib with a sin z c 1 f and b cos z c 2 g 2 8 is an hermite biehler function corresponding to a schro dinger equation from s 2 proof if the real entire functions a and b have the form as in 2 8 with small enough ck then their zero sets satisfy the asymptotics 2 2 2 3 hence these sequences form spectra dd and nd for an operator l s 2 then the hermite biehler functions a b obtained from l must coincide with a b up to constant multiples because the zero sets of a and b two spectra theorem with uncertainty 15 coincide with those of a and b correspondingly it follows from the well known asymptotics for the solutions of regular schro dinger equations uz see for instance theorem 3 p 13 of 42 that the functions are equal in the opposite direction if e is obtained from a schro dinger equation then the zero sets n of a and n of b satisfy 2 2 2 3 representing each function as an infinite product we obtain that a n c an n 1 and b n 1 2 c bn n 1 for some c r an bn l 2 by parseval s theorem there exist unique functions f g pw 1 such that f n na n c and g n 1 2 nb n 1 2 c put f s f and g s g once again from the asymptotics of solutions we see that a z sin z zuz sin z pw 1 since the functions from pw 1 are uniquely determined by their values at n and a n sin n f n a sin z f similarly b cos z g remark 2 note that as follows from the proof the constant can always be chosen as 1 max f 2 g 2 the statement of the theorem implies the asymptotics of the spectra 2 2 2 3 and of the pointmasses of spectral measures 2 4 2 5 and is in fact equivalent to those asymptotics via parseval s theorem and the equivalence of the corresponding de branges chains to pw chains 2 7 krein spectral shift note that if is a positive measure then h has a positive imaginary part in c hence logh is a well defined holo morphic function in c since h is real on r one may consider a branch of logh whose imaginary part takes values between 0 and in c and define the krein spectral shift function k x k x corresponding to as k logh on r note that if is a positive singular measure then k is a function which takes only two values 0 and on r if is a discrete measure concentrated on a sequence then k on a union of disjoint intervals n n cn and zero elsewhere the lengths of the intervals cn are determined by the pointmasses of at n more general krein spectral shift functions appear in perturbation problems see for instance 5 the above definition corresponds to the simplest case of the theory when the perturbed operator is a self adjoint operator with the spectral measure and the perturbation is self adjoint of rank one in this case n form the spectrum of the original operator and n cn of the perturbed one see for instance 38 as follows from the above definition k k satisfies h z exp hk z c 2 9 16 n makarov and a poltoratski for some real constant c the function k and the constant c are uniquely determined by as seen from the above equation c log h i in the opposite direction for a fixed function k there is a family of positive measures satisfying 2 9 differing from each other by a constant multiple ec lemma 2 let n n be a positive poisson finite measure supported on a separated sequence n o 1 n let k k be the corresponding krein spectral shift suppose that k on n n n then either n o n n as n 2 10 or n n 1 n 1 o n n as n 2 11 proof let and k be like in the statement first let us show that either n 0 or n n 1 n 1 0 indeed if neither holds then there exists 0 such that for infinitely many n both n and n n 1 n 1 notice that for such n n 1 n suppose now that n 0 the statement follows from res e h n n n n n and h k 6 n n k k n o log n the second case can be treated similarly let and h be sequences like in 2 2 2 3 as was discussed before such sequences present two spectra of a schro dinger operator l we will call the krein function k which is equal to on n n n 1 n on r and on n n n n on r and to 0 elswhere the krein spectral shift function of l it can be easily seen from our definitions that k is the krein spectral shift function for i e the function and the measure satisfy 2 9 note that because of the asymptotics 2 4 the constant in 2 9 has to be 0 hence the krein spectral shift uniquely determines making an obvious obser vation that k in its turn is uniquely determined by its positive and negative jumps i e by the two sequences dd and nd and applying marchenko s uniqueness result we deduce borg s two spectra theorem 1 this is the proof given by donoghue in 8 for further extensions of the same method including multi dimensional analogs of the krein function see 15 16 two spectra theorem with uncertainty 17 3 completeness gap and type problems 3 1 beurling malliavin densities and the radius of completeness if in is a sequence of disjoint intervals on r we call it short if in 2 1 dist 2 0 in and long otherwise if is a sequence of real points define its exterior beurling malliavin bm density effective bm density as d sup d long in such that in d in n for a non real sequence its density can be defined as d d where is a real sequence n 1 1 n if has no imaginary points or as d d c with a properly chosen real constant c otherwise a dual definition is used to introduce the interior bm density d inf d long in such that in 6 d in n both densities play important role in harmonic analysis by appearing in a number of fundamental results their applications were recently extended in to the area of spectral problems for differential operators via the methods discussed in this paper as an example let us recall the original appearance of d in the solution of a completeness problem by beurling and malliavin for any complex sequence its radius of completeness is defined as r sup a e e i z is complete in l 2 0 a one of the fundamental results of harmonic analysis is the following theo rem see 41 for history and further references theorem 4 beurling and malliavin around 1961 3 4 let be a dis crete sequence then r 2 d we will return to this result and the exterior density when we discuss hor vath theorem in section 3 3 the other density d which has recently made a new appearance in the area of the gap and type problems see 32 39 40 41 will be used in our statements below note that for subse quences of sequences close to arithmetic progressions the two densities are related to each other in a rather simple way in particular for sequences satisfying 2 4 or 2 5 for any d d d d 1 18 n makarov and a poltoratski 3 2 spectral gaps types and sign changes we will call a lower semi continuous function w r 1 a weight on r we will say that a measure on r is w finite if w wd note that w finite measures are forced to be supported on the subset of r where w is finite if w is a weight we define its type tw as tw sup a w finite non zero measure with a spectral gap a a this is one of seveal equivalent definitions for tw see 41 the type of w is used in applications such as problems on completeness of exponential systems in lp and bernstein s spaces if is a real measure on r we will denote by its positive and negative parts we will say that has a spectral gap a a if fd 0 for all f pwa l 1 note that for finite measures this property coincides with 0 on a a if a and b are two closed subsets of r let mwa a b be the class of all non zero w finite real measures with a spectral gap a a such that supp a and supp b the following statement is a combination of lemmas 13 and 16 from 33 lemma 3 if mwa a b is non empty it contains a discrete measure whose positive and negative parts have interlacing supports the following version of the type theorem is theorem 36 from 41 theorem 5 tw sup d logw n 1 2 n for some d uniform sequence if the set is non empty and 0 otherwise the notion of d uniform sequences first appeared in 39 in this paper we do not need a full definition of a d uniform sequence since the sequences we are concerned with are separated for a separated sequence i e a discrete sequence such that n n 1 c 0 for all n is d uniform iff d d see for instance example 1 on page 27 of 41 this implies corollary 1 tw sup d logw n 1 2 n for some separated d d from one of the results of 33 or theorem 17 chapter 4 in 41 we deduce two spectra theorem with uncertainty 19 corollary 2 if w is a weight a is a separated sequence and b is any closed set then sup a mwa a b 6 2 d a we denote log x max 0 log x we will also need the following corollary 3 let x xn be a separated sequence of real numbers let cn xn be a discrete measure with spectral gap a a then for any d a there exists x d d such that xn log cn 1 n 2 proof let w be the weight defined as w xn 1 cn 1 x 2 on x and as infinity elsewhere then is a w finite measure of type at least a the rest follows from corollary 1 3 3 a new proof of horvath theorem the following theorem is one of the main results of 18 here we formulate it in an equivalent form using our version of the m functions after the square root transform theorem 6 18 let n be a sequence of distinct non zero complex numbers 0 a 1 the following statements are equivalent 1 for any schro dinger operator l s 2 if l s 2 is such that q q on 0 a and m m on then l and l coincide identically 2 the system of exponentials ei z is complete in l 2 0 2 2 a the notation in the statement stands for any two points in c a version of the above theorem is proved in 18 for all 1 p in this paper we treat only the case p 2 although a similar argument can be applied to other p a simple proof for the un mixed case a 0 is given in 1 here we show how to deduce the full statement from theorem 3 and lemma 4 if f g are two functions from the smirnov class in c we say that f is divisible by g if f g again belongs to the smirnov class in c we denote by pw evena the subset of pwa consisting of functions which are even on r proof let l l be the operators with q q on 0 a by corollary 5 in the next section the function h h a b a b ab a b b b 3 1 20 n makarov and a poltoratski is divisible by ei 2 az in the upper half plane since b b grows like ei 2 az along ir the numerator grows no faster than e i 2 2 a z together with theorem 3 we obtain that ab a b f is an odd function such that zf pw 2 2 a if m m on zf is zero on recall that it has a double zero at 0 if the system of exponentials is complete then is a uniqueness set for pw even 2 2 a and we obtain that l l let l s 2 be any operator and let e a ib if the exponential system is incomplete is not a uniqueness set and there exists a real f pw even 2 2 a vanishing on and with an additional double zero at 0 then using the second part of theorem 3 a a cf z with sufficiently small c and b b will produce l with the same values of the m function on notice also that the function in 3 1 will be divisible by ei 2 az in c and by corollary 5 below q q on 0 a horvath theorem establishes equivalence between mixed spectral problems for schro dinger operators and the beurling malliavin problem on complete ness of exponentials in l 2 spaces discussed in section 3 1 combining the orems 6 and 4 we obtain the following statement which is the sharpest possible result formulated in terms of the density of the defining sequence corollary 4 let n be a sequence of distinct non zero complex numbers 0 a 1 the following statements are equivalent 1 any two schroedinger operators l and l such that q q on 0 d for some d a and m m on coincide identically 2 d 1 a 4 applications to mixed spectral problems 4 1 fourier gaps and schro dinger operators we will formulate the results of this section for a slightly broader class s 1 of schro dinger operators with summable potentials lemma 4 let l l s 1 then q q on 0 a iff has a spectral gap 2 a 2 a similarly q q on b iff has a spectral gap 2 1 b 2 1 b proof if q q on 0 a then et e t t 0 a since b et b e t pwt as sets for any f g pwt f g d f g b et f g b e t f g d for t 0 a it follows that the measure annihilates any function of the form f g where f g pwt for for t 0 a next we notice that two spectra theorem with uncertainty 21 linear combinations of the products f g are dense in pw 2 t indeed any function in pw 2 t can be represented as e i t zg 1 g 2 e i t zg 3 for some gk pwt by approximating unit pointmasses at 0 and t with l 2 functions and taking their fourier transforms in place of the exponentials we approximate any such sum with linear combinations of products f g thus annihilates pw 2 t and therefore has the stated spectral gap the argument can be reversed to prove the opposite implication and the second statement follows similarly remark 3 it is a well known statement in the area of the gap problem that a real measure has a spectral gap a a if and only if h iy o e ay as y see for instance lemma 4 5 in 32 in this statement o e ay can be replaced with o e y 1 a and the positive imaginary half axis with negative lemma 5 let l l s 1 and let k k be the corresponding krein functions then q q on 0 a iff the measure k k dx has a spectral gap 2 a 2 a proof recall that has a spectral gap 2 a 2 a if and only ifh iy o e 2 ay as y but h h 1 h h h 1 eh k k since is a positive measure its herglotz integral decays no faster than polynomially on ir hence h k k must decay to zero faster than e 2 1 ay as was mentioned above the presence of spectral gap can be equivalently reformulated in terms of decay along ir corollary 5 consider two operators l and l from s 2 and let k k be their krein functions then the potentials q and q are equal on 0 a iff h k k iy o e 2 ay as y iff h k k iy o e 2 1 ay as y for any 0 remark 4 it follows from the proof of lemma 4 that q q on 0 a iff has a spectral gap 2 a 2 a where is the spectral measure corresponding to the neumann boundary condition at 0 the same fact follows from lemma 5 because k and k are krein functions for and more generally any self adjoint boundary condition at 0 or can be used in this statement with the same proof 22 n makarov and a poltoratski together with the above this produces the following statement which is one of the main results of 45 it is formulated in 45 in an equivalent form using a different m function before the square root transform corollary 6 the potentials q and q coincide on 0 a iff the m functions satisfy m iy m iy o e 2 ay as y 4 2 the size of uncertainty recall that for an operator l we denote by dd n and nd n its spectra after the square root transform we will enumerate the sequences as described in section 2 1 let i in n z be a sequence of intervals on r consider the set si of those operators l s 2 for which dd and nd lie in the union of in following our discussion in the introduction we can ask what part of the necessary spectral information we are given by this inclusion condition let us define the size of uncertainty for the sequence of intervals i in as the number u i equal to the infimum of a such that knowing the potential of an operator l si on 0 a one can recover l uniquely theorem 7 below gives the following formula for the size of uncertaity u i sup d n log in 1 n 2 let us now make our statements more precise theorem 7 let n n n be positive numbers a 0 1 tfae 1 any two schro dinger operators l and l satisfying n n 2 n n n 2 n 1 n n 4 1 and q x q x on 0 d d a must coincide identically i e q q a e on 0 2 any sequence of distinct integers z such that n n log n 1 n 2 4 2 satisfies d a proof by corollary 6 q x q x on 0 d for some d a iff the measure k x k x dx has a spectral gap 2 d 2 d suppose now that 4 2 is satisfied only for d a but there exist l l satisfying 4 1 with q x q x on 0 d d a notice that the intervals n n n n are disjoint when n is large wlog we will assume that they are disjoint for all n the union of these intervals constitutes the support of the function l k k two spectra theorem with uncertainty 23 define the weight w x as w x 1 n 1 x 2 on n n n n and continuously on the rest of r denote a l 0 b l 0 then the set mwd a b is non empty because it contains the measure l x dx by lemma 3 it contains a discrete measure whose positive and negative parts alternate between a and b i e each of the intervals n n n n contains at most one pointmass of with all positive masses contained in a and all negative ones in b let x xn be the support of define the weight function v x to be infinity on r x and to be equal to w x at the points of x then tv 2 d because is a v finite measure which has a spectral gap 2 d 2 d on the other hand tv 2 a by 4 1 4 2 and corollary 1 in the opposite direction suppose that 4 2 is satisfied for some d a let us show that then there exist l l satisfying 4 1 with q x q x on 0 a let v v 0 1 be the even weight which is infinite outside of z 2 and equals to 12 n 1 x 2 at n and to 12 n 1 1 x 2 at n 1 2 for n n by 4 2 and corollary 1 tv 2 a hence there exists a v finite measure supported on z 2 with the spectral gap 2 a 2 a wlog n 2 n l 2 and the measure is even let k be the krein spectral shifts for the positive and negative parts of then k is supported on the union of intervals nk 2 nk 2 k and k is supported on the union of intervals mk 2 mk 2 k wlog has a pointmass at 0 then n 0 0 by lemma 2 the pointmasses and the krein functions of satisfy either 2 10 or 2 11 near we will assume that both satisfy 2 10 other cases can be treated similarly in this case nk k l 2 define the spectral sequences n n h n h n of l and l in the following way since k tend to zero for large enough c the supports of k become disjoint on c we will also assume that c does not belong to either of the supports denote l k k the spectral sequences h h will be made of points where the function l makes the jumps so that for the krein functions p and p of l and l we had l p p to achieve the last equation first distribute all the jumps of l at integer points of c as follows add x to if l k k has a positive jump at x or add it to if l makes a negative jump at x next if x is an integer jump point of l which was added to add the next jump of l to and vice versa if l does not make a jump at an integer point x c add it to both and l as far as half integer jumps if x c x z 1 2 then add x to h if l k k makes a negative jump at x or add it to h if l makes a positive jump at x if x was added to h add the next jump of l to h and vice versa 24 n makarov and a poltoratski if l does not make a jump at a half integer point x c add it to both h and h distribute the points similarly on c so that the sequences h and h are even on 0 c assign the points nk to nk k to h mk to and mk k to h on c 0 assign x to the same sequence as x note that this way we keep the sequences even and assign the same number c 1 of points to l and c 1 1 points to h h if c 1 is less than c 2 z 0 c which is the case if skipped some of the points of z 2 we choose an interval inside 0 c where l is zero and choose any 2 c 2 c 1 points on that interval after that we assign those points to and h so that all points are alternating between the sets those points put in should also be added to and those put in h to h note that wlog 0 c has a subinterval where l is zero otherwise we can just increase c on c 0 assign the symmetric points to keep all four sequences even clearly the sequences satisfy the asymptotics 2 2 2 3 and therefore define two schro dinger operators l and l we claim that q x q x on 0 a indeed by our construction for the krein spectral shifts p and p of l and l we have h p p iy h k k iy const h h o e 2 a y wlog we can assume that h i 0 otherwise take any two zeros a a r and consider the function z 2 1 z 2 a h it is not difficult to show that the last function is again a herglotz integral h z 2 1 z 2 a which decays exponentially along ir hence the measure z 2 1 z 2 a has the desired spectral gap then the constants in the formula 2 9 for k coincide and const in the last equation is 1 by lemma 5 it implies the statement in particular we obtain the following uncertainty version of borg s theorem corollary 7 let in be a sequence of intervals on r u in tfae 1 the condition dd nd u 4 3 together with the values of the potential q on 0 for any 0 determines an operator l s 2 uniquely 2 for every n satisfying n log in 1 n 2 two spectra theorem with uncertainty 25 there exists a long sequence of intervals jn in r such that jn jn 0 as n the first statement can be equivalently formulated as follows if l l s 2 satisfy 4 3 and q q on 0 for some 0 then l l the definition of long sequences of intervals in the sense of beurling and malliavin was given in section 3 1 proof notice that if n in then the condition in the second statement holds iff 4 2 in theorem 7 is satisfied only for sequences of interior density 0 now the statement follows from theorem 7 with a 0 4 3 three interval statements our goal in this section is to describe all possible counterexamples in the three interval problem to formulate theorem 8 below we will need some preparation let be a positive measure on r such that pwa l 2 for all a 0 it is well known see for instance 35 that any spectral measure of a schro dinger operator from s 2 satisfies this condition we define the type of as t inf a pwa is dense in l 2 let now be a sequence satisfying the asymptotics 2 2 denote by the counting measure of it follows from the type theorem of 40 41 and in fact from much earlier results on the type problem that t 1 moreover as follows for instance from the results of 35 l 2 pw 1 as sets let now 0 c d 1 be real constants in our next statement we will need two even functions f g f l 2 pwc g l 2 pwd which satisfy certain asymptotics see 4 4 as we will discuss after the statement such functions form dense subsets in the corresponding infinite dimensional subspaces of l 2 recall that by we denote the char acteristic sequence of or equivalently the sequence of pointmasses of the even operator see section 2 3 theorem 8 let be a sequence satisfying the asymptotics 2 2 n denote by the counting measure of let a b 0 1 2 be arbitrary constants 1 for any two real even functions f g f l 2 pw 2 a g l 2 pw 2 b 26 n makarov and a poltoratski satisfying n f n an n g n an 1 bn n 1 4 4 for some an bn l 2 bn n 1 the measures n n and n n where n f n 2 f 2 n 4 2 n g n f n n f n 2 f 2 n 4 2 n g n f n 4 5 when an 6 0 and n n 1 cn n for some cn l 2 when an 0 are spectral measures for two schro dinger operators l l s 2 such that dd dd q q on 0 a 1 b 2 for any two spectral measures of schro dinger operators l l on 0 such that dd dd q q on 0 a 1 b their pointmasses must satisfy n n f n 1 n 1 n 2 n g n for some even functions f l 2 pw 2 a g l 2 pw 2 b satisfying 4 4 with some an bn l 2 bn n 1 remark 5 in regard to the functions f and g from the statement note that since 2 a 2 b 1 and l 2 pw 1 the orthogonal complements of pw 2 a and pw 2 b in l 2 are large infinite dimensional subspaces if a function h belongs to l 2 pw 2 a then p z re h z re h z is an odd real function from the same subspace the function f z p z z will satisfy the conditions for f moreover the set of such functions is dense in the space of all even functions from l 2 pw 2 a to choose g assume for instance that a b choose two more real odd functions p 1 p 2 in l 2 pw 2 a as described above then the function r z p 1 z p 2 0 p 1 0 p 2 z will have a double zero at 0 the function g f r z 2 will satisfy the conditions for g if a b one may proceed in the opposite direction first choosing g and then f proof of theorem 8 1 if n and n satisfy 4 5 then and satisfy the asymptotics 2 5 hence they are the spectral measures of some schro dinger operators l and l since f pw 2 a q q on 0 a by lemma 4 by lemma 1 g and therefore by lemma 4 q q on 1 b two spectra theorem with uncertainty 27 2 in the opposite direction if l and l are as in the statement then by lemma 4 the measures and have spectral gaps hence they annihilate the corresponding pw spaces i e f and g for some even functions f l 2 pw 2 a g l 2 pw 2 b lemma 1 and the asymptotics 2 4 2 5 imply 4 4 theorem 8 describes all possible counterexamples for the three interval prob lem as we can see this set is richer than previously thought with the origi nal counterexample from 14 discussed in the introduction corresponding to the case f g i e bn 0 in the notations of the statement on the other hand all of the counterexamples must be close to the original in the sense that the difference between f and g has higher order of decay in comparison with either function 4 4 uniqueness in the 3 interval problem near the even operator in this section we will look at the 3 interval problem from a slightly different point of view we will ask if there exist operators l uniquely determined by the 3 interval information our result here can be viewed as a set up for the problem of description of such operators discussed in the next section let n n denote the spectral measure of an operator l from s 2 as defined in section 2 2 for z denote d max d n n 1 6 n z once again for a discrete sequence r we denote by its character istic sequence from section 2 3 theorem 9 let 0 a 1 2 and let n n n be a sequence of positive numbers such that for n the inequality n log n 1 n 2 4 6 implies d a then any operator l s 2 satisfying n n n 4 7 where n dd is uniquely determined by its spectrum dd and its potential q on 0 d 1 d for any d a i e if l satisfies 4 7 then any l s 2 with dd dd and q q on 0 d 1 d for some d a must be identical to l remark 6 the last statement displays an interesting phenomenon as we can see from the original counterexample if an operator is close to even but not even in terms of potential in the sense of direct problem namely if its potential is even on 0 d 1 d then it is not uniquely defined by 28 n makarov and a poltoratski the corresponding mixed spectral data however if an operator is close to even in terms of the spectral measure in the sense of inverse problem then it is uniquely defined by the mixed spectral data this property is yet to be fully understood one of its particular consequences is a statement typical for the area of the uncertainty principle an operator cannot be close to even without being even simultaneously with respect to its potential and spectrum in the sense of the last statement it is clear from the proof below that instead of dd dd one could require that the intersection of the spectra have large enough density proof let dd let l be an operator as in part 1 of the statement different from l then f n n n and g n n n are the functions like in the statement of theorem 8 notice that g 2 nf n f n and f g 2 n 2 n f nf 2 n f n since the measure f g annihilates pw 2 d by corollary 3 n log 2 n 2 n f nf 2 1 n 2 for some d 2 d let d a be a sequence of maximal density satisfying 4 6 notice that at each point of z either 2 n 2 n f nf 2 0 or f n n denote the set of indices corresponding to the first case by 1 and those for the second case by 2 then d 2 0 hence up to a sequence of density 0 must be contained in 1 but the measure f g is positive on n n 1 hence its negative part must be contained in up to a sequence of density 0 by corollary 2 the support of the negative part must have density at least d which contradicts the relation d a 5 further examples and open problems 5 1 problem 1 description of defining sequences in the case of condition free endpoint in the two interval problem in horvath theorem discussed in section 3 3 the operator is recovered from a part of its potential on 0 a and the values of the weyl function m obtained by fixing a boundary condition at the opposite point what if we consider a similar problem with a condition free end at i e try to recover an operator from its potential near 0 and the function m obtained by fixing a boundary condition at the same endpoint 0 in this case the statement analogous to horvath theorem fails two spectra theorem with uncertainty 29 example 1 the simplest counterexample is a modification of the 3 interval counterexample from 14 mentioned before let the operators l and l from s 2 be such that q q on 0 1 and q x q 2 x on 1 consider an auxiliary operator la on 0 2 whose potential is defined as qa q on 0 and qa x q 2 x on 2 let l a be an operator such that q a q on 0 and q a x q 2 x on 2 note that then the dd spectra of la and l a coinside denote this sequence by it is not difficult to see the weyl functions m and m of the operators l and l will coincide on it is left to notice that the density of is 2 i e much larger than although as we can see from the last example not any sequence of large enough density can be used in our modified two interval problem there are some sequences which can be used as shown by the following proposition 1 let g l 2 0 2 and let dd be the spectrum of the schro dinger operator from s 2 0 with q g then any two l l s 2 0 such that q q g on 0 and m m on a subsequence of d 2 must be identical proof let uz and u z denote the solutions satisfying the dirichlet boundary conditions at 0 for z the restrictions of uz and u z on satisfy dirichlet boundary conditions at therefore the m functions m m corresponding to the restrictions of l and l on coincide with m m on since m m on we have that m m on the difference m m is a herglotz integral with poles on a sequence of density at most 2 and zeros on a sequence of larger density by a version of the beurling malliavin theorem it implies that the difference is identically zero and q q let g l 2 0 denote by s 2 g the set of all operators from s 2 such that q g on 0 the natural problem which arises from the last two propositions is to describe the set of sequences such that the values of the weyl function m on determine an operator uniquely within the class s 2 g the example shows that the set does not contain all of the sequences of proper density and the last statement shows that the set is non empty 5 2 problem 2 description of unique operators in the three interval case let 0 a b 1 and a 1 b 1 2 as follows from the discussion in the previous section there exist schro dinger opera tors l s 2 on 0 with the following uniqueness property if l s 2 is another schro dinger operator such that q q on 0 a b and d dd dd 2 b a then l l 30 n makarov and a poltoratski this rises a natural question of description of all such unique operators i e operators uniquely determined by the restriction of their potentials on 0 a b and a properly sized subsequence of the spectrum the example provided by theorem 9 presents an operator which is close to even in the spectral case the question one may start with is whether there are other examples while our discussion in this paper concentrates on the s 2 case it can be extended to regular case without much difficulty further cases of this prob lem may concern similar examples and descriptions in non regular cases if q is unsummable the correct question would be to describe l such that any l with the above properties and such that q q is small summable for instance must coincide with l the three interval case is only a model case in which we already see some of the difficulties that were not present in the two interval problem the ultimate goal in this and similar problems would be to consider other subsets of the interval we continue this discussion in the last subsection 5 3 problem 3 uncertainty in other types of spectral data the version of the two spectra problem treated in section 4 2 is not the only case when a problem of uncertainty quantification appears naturally in spectral settings let us give another example of such a problem let l s 2 be a schro dinger operator with the spectral measure n n let e n be a sequence of positive numbers denote by el the set of operators l s 2 such that n n n n n similarly to section 4 2 denote by u el the infimum of a such that the values of the potential on 0 a determine a schro dinger operator from el uniquely proposition 2 u el sup d n log n 1 n 2 the proof follows easily from lemma 4 and corollary 3 the estimates of the size of uncertainty in other variations of spectral prob lems may require different techniques the definition of u d for the spec tral data d which worked for us in the problems considered in this paper may need to be further developed for other kinds of data let us point out for instance that the present definition of u will not work properly if one replaces with in the definition of el above even though an obvious modification of u by replacing 0 a with 1 a will fix this particular problem one would like to have a more universal definition two spectra theorem with uncertainty 31 5 4 problem 4 further connections between mixed spectral prob lems and completeness problems horvath theorem 6 has established a connection between the beurling malliavin bm problem on complete ness of systems of exponentials in l 2 on an interval and the original case of the mixed spectral problem the two interval case without a condition free endpoint even though cases of multiple intervals were considered in the literature see for instance 42 chapter 4 problem 10 a similar connec tions are yet to be found it is interesting to observe that the analog of the bm theorem with one interval replaced with any other subset of the line including the next simplest case of a union of two intervals does not exist despite a number of deep results on completeness of exponential systems in l 2 over general sets see for instance 34 there is no formula for the radius of completeness or a good idea on what could replace such a formula even in the case of two intervals as we saw in our discussion in section 4 3 many of the same complications appear in mixed spectral problems when moving from the two interval to the three interval and multiple interval case moreover analogies between the weyl transform and the fourier transform together with the use of the lat ter in bm theory suggest that the mixed spectral problems for more general subsets of the interval must be closely related to bm problems over general sets finding such connections i e formulating an analog of horvath the orem for more general subsets seems to be an interesting and challenging problem references 1 baranov a belov yu and poltoratski a de branges functions for schroedinger equations preprint 2016 2 beurling a on quasianalyticity and general distributions mimeographed lecture notes summer institute stanford university 1961 3 beurling a malliavin p on fourier transforms of measures with compact support acta math 107 1962 291 302 4 beurling a malliavin p on the closure of characters and the zeros of entire functions acta math 118 1967 79 93 5 birman m sh yafaev d r the spectral shift function the papers of m g krein and their further development st petersburg math j 4 833 870 1993 6 borg g eine umkehrung der sturm liouvilleschen eigenwertaufgabe acta math 79 1946 1 96 7 de branges l hilbert spaces of entire functions prentice hall englewood cliffs nj 1968 8 donoghue w f jr on the perturbation of spectra comm pure appl math 18 1965 559 579 9 dym h an introduction to de branges spaces of entire functions with applications to differential equations of the sturm lioville type advances in math 5 1971 395 471 10 dym h mckean h p gaussian processes function theory and the inverse spectral problem academic press new york 1976 11 rafael del rio fritz gesztesy and barry simon inverse spectral analysis with partial information on the potential iii updating boundary conditions internat math res notices 15 1997 751 758 32 n makarov and a poltoratski 12 gelfand i m levitan b m on the determination of a differential equation from its spectral function russian izvestiya akad nauk sssr ser mat 15 1951 309 360 english translation in amer math soc translation ser 2 1 1955 253 304 13 gesztezy f simon b a new approach to inverse spectral theory ii general real potentials and the connection to the spectral measure ann of math 152 2000 593 643 14 gesztezy f simon b inverse spectral analysis with partial information on the potential ii the case of discrete spectrum trans ams 352 2000 2765 2787 15 gesztesy f simon b uniqueness theorems in inverse spectral theory for one dimensional schro dinger operators trans amer math soc 348 1996 no 1 349 373 16 gesztesy f tsekanovskii e on matrix valued herglotz functions math nachr 218 2000 61 138 17 hochstadt h lieberman b an inverse sturm liouville problem with mixed given data siam j appl math 34 1978 676 680 18 horva th m inverse spectral problems and closed exponential systems ann math 162 2005 2 885 918 19 hruschev s nikolskii n pavlov b unconditional bases of exponentials and of reproducing kernels lecture notes in math vol 864 214 335 20 koosis p the logarithmic integral vol i ii cambridge univ press cambridge 1988 21 levitan b m sargsjan i s sturm liouville and dirac operators kluwer dor drecht 1991 22 levinson n gap and density theorems ams colloquium publications 26 1940 23 d s lubinsky a survey of weighted polynomial approximation with exponential weights surveys in approximation theory 3 1105 2007 24 makarov n poltoratski a meromorphic inner functions toeplitz kernels and the uncertainty principle in perspectives in analysis springer verlag berlin 2005 185 252 25 makarov n poltoratski a beurling malliavin theory for toeplitz kernels in vent math vol 180 issue 3 2010 443 480 26 makarov n poltoratski a etudes for the inverse spectral problem preprint 27 makarov n poltoratski a sodin m lectures on linear complex analysis book in preparation 28 marchenko v some questions in the theory of one dimensional linear differential operators of the second order i trudy mosk mat obsch 1 1952 327 420 29 marchenko v sturm liouville operators and applications birkhauser basel 1986 30 mergelyan s weighted approximation by polynomials uspekhi mat nauk 11 1956 107 152 english translation in amer math soc translations ser 2 10 1958 59 106 31 c remling schro dinger operators and de branges spaces j funct anal 196 2002 323 394 32 mitkovski m and poltoratski a polya sequences toeplitz kernels and gap theorems advances in math 224 2010 pp 1057 1070 33 mitkovski m and poltoratski a on the determinacy problem for measures invent math 202 2015 1241 1267 34 olevskii a and ulanovskii a functions with disconnected spectrum sampling interpolation translates univ lecture series ams 2016 35 ortega cedra j seip k fourier frames annals of math 155 2002 789 806 36 pavlov b the basis property of a system of exponentials and the condition of muck enhoupt dokl acad nauk sssr 247 1979 37 40 two spectra theorem with uncertainty 33 37 a poltoratski bernstein s problem on weighted polynomial approximation operator related function theory and time frequency analysis abel symposia vol 9 springer 2015 pp 147 171 38 poltoratski a kre n s spectral shift and perturbations of spectra of rank one al gebra i analiz 10 1998 no 5 143 183 translation in st petersburg math j 10 1999 no 5 833 859 39 poltoratski a spectral gaps for sets and measures acta math 2012 volume 208 number 1 pp 151 209 40 poltoratski a a problem on completeness of exponentials ann math 178 983 1016 2013 41 poltoratski a toeplitz approach to problems of the uncertainty principle cbms series providence rhode island published by the american mathematical society 2015 42 j poshel e trubowitz inverse spectral theory academic press new york 1987 43 remling c schro dinger operators and de branges spaces j func anal volume 196 issue 2 2002 323394 44 romanov r canonical systems and de branges spaces preprint lecture notes 2016 45 simon b a new approach to inverse spectral theory i fundamental formalism ann of math 150 1999 1029 1057 california institute of technology department of mathematics pasadena ca 91125 usa e mail address makarov its caltech edu texas a m university department of mathematics college station tx 77843 usa e mail address alexeip math tamu edu