dyadic harmonic analysis and weighted inequalities the sparse revolution mar a cristina pereyra abstract we will introduce the basics of dyadic harmonic analysis and how it can be used to obtain weighted estimates for classical calder n zygmund singular integral operators and their commutators harmonic analysts have used dyadic models for many years as a first step towards the understanding of more complex continuous operators in 2000 stefanie petermichl discovered a representation formula for the venerable hilbert transform as an average over grids of dyadic shift operators allowing her to reduce arguments to finding estimates for these simpler dyadic models for the next decade the technique used to get sharp weighted inequalities was the bellman function method introduced by nazarov treil and volberg paired with sharp extrapolation by dragi evi et al other methods where introduced by hyt nen lerner cruz uribe martell p rez lacey reguera sawyer uriarte tuero involving stopping time and median oscillation arguments precursors of the very successful domination by positive sparse operators methodology the culmination of this work was tuomas hyt nen s 2012 proof of the a 2 conjecture based on a representation formula for any calder n zygmund operator as an average of appropriate dyadic operators since then domination by sparse dyadic operators has taken central stage and has found applications well beyond hyt nen s ap theorem we will survey this remarkable progression and more in these lecture notes contents 1 introduction 2 2 weighted norm inequalities 6 2 1 some basic notation and prototypical operators 7 2 2 hilbert transform 8 2 3 maximal function 11 2 4 why are we interested in these estimates 13 2 5 first linear estimates 13 2 6 extrapolation and hyt nen s ap theorem 14 2 7 two weight problem for the hilbert transform and the maximal function 16 3 dyadic harmonic analysis 18 3 1 dyadic intervals dyadic maximal functions 18 3 2 one third trick and lerner s proof of buckley s result 19 3 3 random dyadic grids on r 21 3 4 haar bases 22 3 5 dyadic analysis on spaces of homogeneous type 24 4 dyadic operators weighted inequalities and hyt nen s representation theorem 30 2010 mathematics subject classification primary 42 b 20 42 b 25 secondary 47 b 38 key words and phrases weighted norm estimate hilbert transform commutators dyadic operators ap weights carleson sequences bellman functions sparse operators 1 ar x iv 1 81 2 00 85 0 v 1 m at h c a 3 d ec 2 01 8 2 m c pereyra 4 1 martingale transform 30 4 2 dyadic square function 31 4 3 petermichl s dyadic shift operator 33 4 4 haar shift operators of arbitrary complexity 34 4 5 dyadic paraproduct 35 4 6 hyt nen s representation theorem 36 5 a 2 theorem for the dyadic paraproduct a bellman function proof 37 5 1 weighted carleson sequences weighted carleson lemma and little lemma 37 5 2 the 3 2 bound for the paraproduct on weighted l 2 39 5 3 algebra of carleson sequences lemma and weighted haar bases 39 5 4 a 2 conjecture for the dyadic paraproduct 41 5 5 auxiliary lemmas 43 6 case study commutator of hilbert transform and function in bmo 45 6 1 lp theory for b h 45 6 2 weighted inequalities 46 6 3 dyadic proof of chung s theorem 47 6 4 a quantitative transference theorem 47 7 sparse operators and sparse families of dyadic cubes 50 7 1 sparse operators 51 7 2 sparse vs carleson families of dyadic cubes 51 7 3 a 2 theorem for sparse operators 52 7 4 domination by sparse operators 53 7 5 domination of martingale transform d apr s lacey 54 7 6 case study sparse operators vs commutators 55 8 summary and recent progress 57 references 58 1 introduction these notes are based on lectures delivered by the author on august 7 9 2017 at the cimpa 2017 research school ix escuela santal harmonic analysis geometric measure theory and applications held in buenos aires argentina the course was titled dyadic harmonic analysis and weighted inequalities the main question of interest in these notes is to decide for a given operator or class of operators and a pair of weights u v if there is a positive constant cp u v t such that tf lp v cp u v t f lp u for all functions f lp u the main goals in these lectures are two fold first given an operator t or family of operators identify and classify pairs of weights u v for which the operator s t is are bounded on weighted lebesgue spaces more specifically from lp u to lp v qualitative bounds second understand the nature of the constant cp u v t quantitative bounds we concentrate on one weight lp inequalities for 1 p that is the case when u v w for the prototypical operators dyadic models and their commutators although we will state some of the known two weight results the operators we will focus on are the hardy littlewood maximal function calder n zygmund operators t such as the hilbert transform dyadic harmonic analysis and weighted inequalities 3 h and their dyadic analogues specifically the dyadic maximal function the martingale trans form the dyadic square function the haar shift multipliers the dyadic paraproducts and the sparse dyadic operators the question now reduces to given weight w and 1 p is there a constant cp w t 0 such that for all functions f lp w tf lp w cp w t f lp w we have known since the 70 s that the maximal function is bounded on lp w if an only if the weight w is in the muckenhoupt ap class mu similar result holds for the hilbert transform hmw general calder n zygmund operators and dyadic analogues are bounded on lp w cofe when the weight w ap and the same holds for their commutators with functions in the space of bounded mean oscillation bmo bl abkpz the quantitative versions of these results were obtained several decades later in 1993 for the maximal function bu 1 in 2007 for the hilbert transform pet 2 in 2012 for calder n zygmund singular integral operators hyt 2 and for their commutators chppz we will say more about ap weights and the quantitative versions of these classical results in the following pages we will show or at least describe for the model operators t the validity of a weighted l 2 inequality that is linear on w a 2 the a 2 characteristic of the weight namely there is a constant c 0 such that for all weights w a 2 and for all functions f l 2 w tf l 2 w c w a 2 f l 2 w that this holds for all calder n zygmund singular integrals operators was the a 2 conjecture we will also describe several approaches for the corresponding quadratic estimate for the commutator b t bt tb where b is a function in bmo namely b t f l 2 w c w 2 a 2 b bmo f l 2 w dyadic models have been used in harmonic analysis and other areas of mathematics for a long time terry tao has an interesting post in his blog 1 regarding the ubiquitous dyadic model for a presentation suitable for beginners see the lecture notes by the author p 1 which describe the status quo of dyadic harmonic analysis and weighted inequalities as of 2000 this millennium has seen new dyadic techniques evolve become mainstream and help settle old problems these lecture notes try to illustrate some of this progress in particular averaging and sparse domination techniques with and by dyadic operators have allowed researchers to transfer results from the dyadic world to the continuous world no longer the dyadic models are just toy models in harmonic analysis they can truly inform the continuous models here are some examples where this dyadic paradigm has been useful the dyadic maximal function controls the maximal function the converse is immediate by means of the one third trick estimates for the dyadic maximal function are easier to obtain and transfer to the maximal function painlessly the walsh model is the dyadic counterpart to fourier analysis the first real progress towards proving boundedness of the bilinear hilbert transform lth result that earned 1 https terrytao wordpress com 2007 07 27 dyadic models 4 m c pereyra christoph thiele and michael lacey the 1996 salem prize 2 was made by thiele in his 1995 phd thesis proving the walsh model version of such result th stefanie petermichl showed in 2000 that one can write the hilbert transform as an average of dyadic shift operators over random dyadic grids pet 1 she achieved this using the well known symmetry properties that characterize the hilbert transform namely the hilbert transform commutes with translations and dilations and anticommutes with reflections a linear and bounded operator on l 2 r with those properties must be a constant multiple of the hilbert transform similarly the riesz transforms pet 3 can be written as averages of suitable dyadic operators petermichl proved the a 2 conjecture for these dyadic operators using bellman function techniques pet 2 pet 3 these results added a very precise new dyadic perspective to such classic and well studied operators in harmonic analysis and earned petermichl the 2006 salem prize first time this prize was awarded to a female mathematician the martingale transform was considered the dyadic toy model par excellence for calde r n zygmund singular integral operators for many years one would test the martingale transform first and if successful then worry about the continuous versions in 2000 janine wittwer proved the a 2 conjecture for the martingale transform using bellman functions w 1 the beurling transform can be written as an average of martingale transforms in the complex plane and this allowed stefanie petermichl and sasha volberg petv to prove in 2002 linear weighted inequalities on lp w for p 2 and as a consequence deduce an important end point result in the theory of quasiconformal mappings that had been conjectured by kari astala tadeusz iwaniec and eero saksman ais surprisingly all calder n zygmund singular integral operators can be written as averages of haar shift dyadic operators of arbitrary complexity and dyadic paraproducts as proven by tuomas hyt nen hyt 2 in 2008 oleksandra beznosova proved the a 2 conjecture for the dyadic paraproduct be 2 and together with hyt nen s dyadic representation theorem this lead to hyt nen s proof of the full a 2 conjecture hyt 2 leading towards hyt nen s result there were a number of breakthroughs that have recently coalesced under the umbrella of domination by finitely many sparse positive dyadic oper ators andrei lerner s early results le 5 played a central role in this development it is usually straightforward to verify that these sparse operators have desired quantitative esti mates it is harder to prove appropriate domination results for each particular operator and function it acts on this methodology has seen an explosion of applications well beyond the original a 2 conjecture where it originated identifying the sparse collections associated to a given operator and function is the most difficult part of the argument and it involves using weak type inequalities stopping time techniques and adjacent dyadic grids we will explore some of these examples in the lecture notes with emphasis on quantitative weighted estimates we will illustrate in a few case studies different techniques that have evolved as a result of these investigations such as bellman functions quantitative extrapolation and transference theorems and reduction to studying dyadic operators either by averaging or by sparse domination the structure of the lecture notes remains faithful to the lectures delivered by the author in buenos aires except for some minor reorganization some themes are touched at the beginning to wet the appetite of the audience and are expanded on later sections most 2 the salem prize founded by the widow of raphael salem is awarded every year to a young mathematician judged to have done outstanding work in salem s field of interest primarily the theory of fourier series the prize is considered highly prestigious and many fields medalists previously received salem prize wikipedia dyadic harmonic analysis and weighted inequalities 5 objects are defined as they make their first appearance in the story naturally more details are provided than in the actual lectures some details were in the original slides but had to be skipped or fast forwarded those topics are included in these lecture notes the sections are peppered with historical remarks and references but inevitably some will be missing or could be inaccurate despite the time and effort spent by the author on them thus the author apologizes in advance for any inaccuracy or omission and gratefully would like to hear about any corrections for future reference in section 2 we introduce the basic model operators the hilbert transform and the max imal function and we discuss their classical lp and weighted lp boundedness properties we show that ap is a necessary condition for the boundedness of the maximal function on weighted lebesgue spaces lp we describe why are we interested on weighted estimates and more recently on quantitative weighted estimates in particular we describe the linear weighted l 2 estimates saga leading towards the resolution of the a 2 conjecture and how to derive quantitative weighted lp estimates using sharp extrapolation we finalize the section with a brief summary of the two weight results known for the hilbert transform and the maximal function in section 3 we introduce the elements of dyadic harmonic analysis and the basic dyadic maximal function more precisely we discuss dyadic grids regular random adjacent and haar functions on the line on rd on spaces of homogeneous type as a first example illustrating the power of the dyadic techniques we present lerner s proof of buckley s quan titative lp estimates for the maximal function which reduces using the one third trick to estimates for the dyadic maximal function we also describe given dyadic cubes on spaces of homogeneous type how to construct corresponding haar bases and briefly describe the auscher hyt nen wavelets in this setting in section 4 we discuss the basic dyadic operators the martingale transform the dyadic square function the haar shifts multipliers petermichl s and those of arbitrary complexity and the dyadic paraproducts these are the ingredients needed to state petermichl s and hyt nen s representation theorems for the hilbert transform and calder n zygmund opera tors respectively for each of these dyadic model operators we describe the known lp and weighted lp theory and we state both petermichl s and hyt nen s representation theorems in section 5 we sketch beznosova s proof of the a 2 conjecture for the dyadic paraproduct this is a bellman function argument as a first approach we get a 3 2 estimate and with a refinement the linear estimate for the dyadic paraproduct is obtained along the way we introduce weighted carleson sequences a weighted carleson embedding lemma some bellman function lemmas the little lemma and the lemma and weighted haar functions needed in the argument we also sketch the proofs of these auxiliary results in section 6 we discuss weighted inequalities in a case study the commutator of the hilbert transform h with a function b in bmo we summarize chronologically the weighted norm inequalities known for the commutator we sketch the dyadic proof of the quantitative weighted l 2 estimate for the commutator b h due to daewon chung yielding the optimal quadratic dependence on the a 2 characteristic of the weight we discuss a very useful trans ference theorem of daewon chung carlos p rez and the author and present its proof based on the celebrated coifman rochberg weiss argument the transference theorem allows to deduce quantitative weighted lp estimates for the commutator of a linear operator with a bmo function from given weighted lp estimates for the operator 6 m c pereyra in section 7 we introduce the sparse domination by positive dyadic operators paradigm that has emerged and proven to be very powerful with applications in many areas not only weighted inequalities we discuss a characterization of sparse families of cubes via carleson families of dyadic cubes due to andrei lerner and fedja nazarov we present the beautiful proof of the a 2 conjecture for sparse operators due to david cruz uribe chema martell and carlos p rez we illustrate with one toy model example the martingale transform how to achieve the pointwise domination by sparse operators following an argument by michael lacey finally we briefly discuss a sparse domination theorem for commutators valid for rough calder n zygmund singular integral operators due to andrei lerner sheldon ombrosi and israel rivera r os that yields a new quantitative two weight estimates of bloom type and recovers all known weighted results for the commutators finally in section 8 we present a summary and briefly discuss some very recent progress throughout the lecture notes a constant c 0 might change from line to line the notation a b or b a means that a is defined to be b the notation a b means that there is a constant c 0 such that a cb the notation a b means that a b and b a the notation a r s b means that the constant c 0 in the implied inequality depends only on the parameters r s acknowledgements i would like to thank ursula molter carlos cabrelli and all the organizers of the cimpa 2017 research school ix escuela santal harmonic analysis geometric measure theory and applications held in buenos aires argentina from july 31 to august 11 2017 for the invitation to give the course on which these lecture notes are based it meant a lot to me to teach in the pabell n 1 de la facultad de ciencias exactas having grown up hearing stories about the mythical universidad de buenos aires uba from my parents concepci n ballester and victor pereyra and dear friends 3 who like us were welcomed in venezuela in the late 60 s and 70 s and to whom i would like to dedicate these lecture notes unfortunately the flow is now being reversed as many venezuelans of all walks of life are fleeing their country and many among them mathematicians and scientists are finding a home in other south american countries in particular in argentina i would also like to thank the enthusiastic students and other attendants as always there is no course without an audience you are always an inspiration for us i thank the kind referee who made many comments that greatly improved the presentation and my former phd student david weirich who kindly provided the figures last but not least i would like to thank my husband who looked after our boys while i was traveling and my family in buenos aires who lodged and fed me 2 weighted norm inequalities in this section we introduce some basic notation and the model operators the hilbert transform and the maximal function and we discuss their classical lp and weighted lp bound edness properties we show that ap is a necessary condition for the boundedness of the maximal function on weighted lp we describe why are we interested in weighted estimates and more recently on quantitative weighted estimates in particular we describe the linear weighted l 2 estimates saga leading towards the resolution of the a 2 conjecture and how to 3 dear friends such as juli n and amanda araoz manolo bemporad mischa and yanny cotlar rebeca guber mauricio and gloria milchberg cora ratto and manuel sadosky cora sadosky and daniel goldstein and cristina zoltan some saddly no longer with us dyadic harmonic analysis and weighted inequalities 7 derive quantitative weighted lp estimates using sharp extrapolation we finalize the section with a brief summary of the two weight results known for the hilbert transform and the maximal function 2 1 some basic notation and prototypical operators we introduce some basic nota tion used throughout the lecture notes we remind the reader the basic spaces weighted lp and bounded mean oscillation bmo and the prototypical continuous operators to be stud ied namely the maximal function the hilbert transform and its commutator with functions in bmo we briefly recall some of the settings where these operators appear the weights u and v are locally integrable functions on rd namely u v l 1 loc rd that are almost everywhere positive functions given a weight u a measurable function f is in lp u if and only if f lp u rd f x p u x dx 1 p when u 1 we denote lp rd lp u and f lp f lp rd given f g l 1 rd their convolution is given by 2 1 f g x rd f x y g y dy a locally integrable function b is in the space of bounded mean oscillation namely b bmo if and only if 2 2 b bmo sup q 1 q q b x b q dx where b q 1 q q b t dt here q rd are cubes with sides parallel to the axes q denotes the volume of the cube q and more generally e denotes the lebesgue measure of a measurable set e in rd note that l rd the space of essentially bounded functions on rd is a proper subset of bmo e g log x is a function in bmo but not in l r we will consider linear or sublinear operators t lp u lp v among the linear operators the calder n zygmund singular integral operators and their dyadic analogues will be most important for us the prototypical calder n zygmund singular integral operator is the hilbert transform on r given by convolution with the distributional hilbert kernel kh x p v 1 x 2 3 hf x kh f x p v 1 f y x y dy lim 0 1 x y f y x y dy the hilbert transform and its periodic analogue naturally appear in complex analysis and in the study of convergence on lp of partial fourier sums integrals the hilbert transform siblings the riesz transforms on rd and the beurling transform on c are intimately connected to partial differential equations and to quasiconformal theory respectively its cousin the cauchy integral on curves and higher dimensional analogues is connected to rectifiability and geometric measure theory a prototypical sublinear operator is the hardy littlewood maximal function 2 4 mf x sup q x q 1 q q f y dy 8 m c pereyra here the supremum is taken over all cubes q rd containing x and with sides parallel to the axes the maximal function naturally controls many singular integral operators and approximations of the identity its weak boundedness properties on l 1 rd imply the lebesgue differentiation theorem another sublinear operator that we will encounter in these lectures is the dyadic square function see section 4 2 given t a linear or sublinear operator its commutator with a function b is given by b t f b t f t bf the commutators are important in the study of factorization for hardy spaces and to char acterize the space of bounded mean oscillation bmo they also play a central role in the theory of partial differential equations pdes we refer the reader to gr 1 gr 2 st for encyclopedic presentations of classical harmonic analysis duo 1 for a more succinct yet deep presentation and pw for an elementary pre sentation emphasizing the dyadic point of view 2 2 hilbert transform we now recall familiar facts about the hilbert transform including its lp and one weight quantitative lp boundedness properties the hilbert transform is defined by 2 3 on the underlying space and on frequency space the following representation as a fourier multiplier with fourier symbol mh holds 2 5 h f mh f where mh i sgn to connect the two representations for the hilbert transform on the underlying space and on the frequency space remember that multiplication on the fourier side corresponds to convolution on the underlying space therefore kh the hilbert kernel is given by the inverse fourier transform of the fourier symbol mh hf x kh f x where kh x mh x p v 1 x which is precisely the content of 2 3 here the fourier transform and inverse fourier transform of a schwartz function f on r are defined by f r f x e 2 i x dx f x r f e 2 i x d the fourier transform is a bijection and an l 2 isometry on the schwartz class that can be extended to be an isometry on l 2 r that is f l 2 r f l 2 r plancherel s identity and it can also be extended to be a bijection on the space of tempered distributions the convolution f g is a well defined function on lr r when f lp r and g lp r provided 1 p 1 q 1 r 1 and p q r 1 moreover on the same range young s inequality holds 2 6 g f lr g lq f lp in these lecture notes we will explore in section 4 3 a third representation for the hilbert transform in terms of dyadic shift operators discovered by stefanie petermichl pet 1 in 2000 2 2 1 lp boundedness properties of h fourier theory ensures boundedness on l 2 r for the hilbert transform h in fact applying plancherel s identity twice and using the fact that mh 1 a e one immediately verifies that h is an isometry on l 2 r namely hf l 2 h f l 2 f l 2 f l 2 dyadic harmonic analysis and weighted inequalities 9 young s inequality 2 6 for p 1 q 1 hence r p imply that if g l 1 r and f lp r then g f lp r moreover g f lp g l 1 f lp this would imply boundedness on lp r for the hilbert transform if the hilbert kernel kh were integrable but is not despite this fact the following boundedness properties for the hilbert transform hold shared by all calder n zygmund singular integral operators the hilbert transform is not bounded on l 1 r it is of weak type 1 1 kolmogorov 1927 that is there is a constant c 0 such that for all 0 and for all f l 1 r x r hf x c f l 1 the hilbert transform is bounded on lp r for all 1 p m riesz 1927 namely there is a constant cp 0 such that for all f lp r hf lp cp f lp best constant was found by pichorides in 1972 note that for 1 p 2 the lp boundedness can be obtained by marcinkiewicz interpolation theorem from the weak type 1 1 and the l 2 boundedness then for 2 p the bound edness on lp r can be obtained by a duality argument suffices to observe that the adjoint of h is h that is the hilbert transform is almost self adjoint however the marcinkiewicz interpolation did not exist in 1927 riesz proved instead that boundedness on lp r implied boundedness on l 2 p r hence boundedness on l 2 r implied boundedness on l 4 r then on l 8 r and by induction on l 2 n r strong interpolation which already existed then gave boundedness on lp r for 2 n p 2 n 1 and for all n 1 that is for all 2 p finally a duality argument took care of 1 p 2 in section 4 3 we will deduce the lp boundedness of the hilbert transform from the lp boundedness of dyadic shift operators see section 2 6 interpolation is an extremely powerful tool in analysis that allows to deduce intermediate norm inequalities given two end point weak norm inequalities we will not discuss interpo lation further in these notes instead we will focus on extrapolation that allows us to deduce weighted lp norm inequalities for all 1 p given weighted lr norm inequalities for one index r 1 finally it is important to note that the hilbert transform is not bounded on l r however it is bounded on the larger space bmo of functions of bounded mean oscillation c fefferman 1971 to illustrate the lack of boundedness on l r and on l 1 r it is helpful to calculate the hilbert transform for some simple functions showing in fact that the hilbert transform does not map neither l 1 r nor l r into themselves this immediately eliminates the possibility for the hilbert transform being bounded on either space example 2 1 hilbert transform of an indicator function h 1 a b x 1 log x a x b where the indicator 1 a b x 1 when x a b and zero otherwise a bounded and integrable function that is 1 a b l 1 r l r however log x is neither in l r nor in l 1 r but it is a function of bounded mean oscillation the functions f in l 1 r whose hilbert transforms hf are also in l 1 r constitute the hardy space h 1 r such functions need to have some cancellation r f x dx 0 clearly not shared by the indicator function 1 a b 10 m c pereyra 2 2 2 one weight inequalities for h the one weight theory la muckenhoupt for the hilbert transform is well understood the qualitative theory has been known since 1973 hmw the quantitive estimates were settled by stefanie petermichl in 2007 pet 2 the two weight problem on the other hand was studied for a long time but the necessary and sufficient conditions la muckenhoupt for pairs of weights u v that ensure boundedness of the hilbert transform from lp u into lp v were only settled in 2014 by michael lacey chun yen shen eric sawyer and ignacio uriarte tuero l 1 lssu theorem 2 2 hunt muckenhoupt wheeden 1973 the hilbert transform is bounded on lp w for 1 p if and only if the weight w ap in either case there is a constant cp w 0 depending on p and on the weight w such that hf lp w cp w f lp w for all f lp w at this point we remind the reader that a weight w is in the muckenhoupt ap class if and only if w ap where the ap characteristic of the weight w is defined to be w ap sup q 1 q q w x dx 1 q q w 1 p 1 x dx p 1 for 1 p the supremum is taken over all cubes q in rd with sides parallel to the axes we will denote integral averages with respect to lebesgue measure on cubes or on measurable sets e by f e 1 e e f x dx also given w a weight w e will denote the w mass of the measurable set e that is w e e w x dx with this notation w a 2 sup q w q w 1 q note that w a 2 if and only if w 1 a 2 example 2 3 power weights offer examples of ap weights on rd w x x is in ap if and only if d d p 1 for 1 p in theorem 2 2 the optimal dependence of the constant cp w on the ap characteristic w ap of the weight w was found more than 30 years later theorem 2 4 petermichl 2007 given 1 p for all w ap and for all f lp w we have that hf lp w p w max 1 1 p 1 ap f lp w note that the estimate is linear on w ap for p 2 and of power 1 p 1 for 1 p 2 cartoon of the proof the following is a very brief sketch of petermichl s argument first write h as an average over dyadic grids of dyadic shift operators pet 1 second find linear estimates uniform on the dyadic grids for the dyadic shift operators on l 2 w pet 2 deduce from the first two steps linear estimates on l 2 w for the hilbert transform namely estimates valid for all w a 2 and for all f l 2 w of the form hf l 2 w w a 2 f l 2 w third use a sharp extrapolation theorem dgppet to get estimates for p 6 2 from the linear l 2 w estimate dyadic harmonic analysis and weighted inequalities 11 same estimates hold for all calder n zygmund singular integral operators solving the famous a 2 conjecture which was proven by tuomas hyt nen in 2012 see hyt 2 we will say more about petermichl s and hyt nen s landmark results as well as about sharp extrapolation later in section 2 6 and in section 4 2 3 maximal function we summarize the lp and one weight quantitative lp bounded ness properties for the maximal function we also show that the ap condition on the weight w is a necessary condition for boundedness of the maximal function on lp w 2 3 1 lp boundedness properties of m from its definition 2 4 it is clear that the maximal function is bounded on l rd with norm one the maximal function is not bounded on l 1 rd however it is of weak type 1 1 hardy littlewood 1930 the next example shows that the maximal function does not map l 1 r onto itself example 2 5 the characteristic function 1 0 1 is integrable however its image under the maximal function m 1 0 1 is not the diligent reader can verify that m 1 0 1 x 1 1 x if x 0 m 1 0 1 x 1 if 0 x 1 and m 1 0 1 x 1 x if x 1 marcinkiewicz interpolation gives boundedness of the maximal function on lp rd for 1 p from the strong l and the weak type 1 1 boundedness results we will present an alternate argument in section 3 2 2 that will cover the weighted lp estimates as well without reference to neither interpolation nor extrapolation 2 3 2 one weight lp inequalities for m the maximal function is of weak lp w type if and only if w ap moreover the following quantitative result was proven in 1972 by benjamin muckenhoupt mu for p 1 and for all w ap 2 7 m lp w lp w p w 1 p ap where the quantity on the left hand side m lp w lp w denotes the smallest constant c 0 such that for all 0 and for all f lp w w x rd mf x c f lp w p we say a weight w is in the muckenhoupt a 1 class if and only if there is a constant c 0 such that mw x cw x for a e x rd the infimum over all possible such constants c is denoted w a 1 the a 1 class of weights is contained in all ap classes of weights for p 1 the maximal function is bounded on lp w moreover the following quantitative result was proven in 1993 by stephen buckley bu 1 valid for p 1 and for all w ap and f lp w 2 8 mf lp w p w 1 p 1 ap f lp w buckley deduced these estimates from quantitative self improvement integrability results known for ap weights the weak lp w boundedness of the maximal function and marcinkie wicz interpolation more precisely w ap implies w ap with w 1 p ap and w ap 2 w ap on the other hand h lder s inequality implies ap ap and w ap w ap in terpolating between weak lp w and weak lp w estimates and keeping track of the constants one gets buckley s quantitative estimate 2 8 12 m c pereyra in particular when p 2 the maximal function obeys a linear estimate on l 2 w with respect to the a 2 characteristic of the weight namely for all w a 2 and f l 2 w mf l 2 w w a 2 f l 2 w a beautiful proof of buckley s quantitative estimate for the maximal function was presented in 2008 by andrei lerner le 1 mixed ap a estimates in 2011 by tuomas hyt nen and car los p rez hytpz and extensions to spaces of homogeneous type in 2012 by tuomas hyt nen and anna kairema hytk we will present lerner s proof of buckley s inequality 2 8 in section 3 2 2 2 3 3 ap is a necessary condition for lp w boundedness of m we would like to demystify the appearance of the ap weights in the theory by showing that w ap is a necessary condition for the maximal function to be bounded on lp w when p 1 we will show that if the maximal function is bounded on lp w then the weight w must be in the muckenhoupt ap class proof by hypothesis there is a constant c 0 such that for all f lp w mf lp w c f lp w for all 0 let emf be the level set for the maximal function mf that is e mf x r d mf x then by chebychev s inequality 4 and using the hypothesis we conclude that w e mf e mf w x dx 1 p rd mf x pw x dx c p p f p lp w fix a cube q rd for any integrable function f 0 supported on the cube q let 1 q q f y dy then mf x for all x q hence q emf moreover 2 9 1 q q f x dx p w q pw emf c p q fp x w x dx consider the specific function f w 1 p 1 1 q supported onq and chosen so that both integrands coincide namely f fpw substitute this specific function f into 2 9 to obtain the following inequality only pertaining the weight w and the cube q 1 q p q w 1 p 1 x dx p 1 w q cp distribute q and take the supremum over all cubes q to conclude that w ap cp and hence w ap there is one technicality the chosen function may not be integrable choose instead f 1 q w 1 p 1 run the argument for each 0 then let go to zero we just showed that if the maximal function m is bounded on lp w then it is of weak lp w type moreover w 1 pap m lp w lp w therefore muckenhoupt s weak lp w bound 2 7 is optimal 4 namely for g l 1 it holds that x r g x 1 g l 1 for all 0 in other words if g l 1 then g l 1 where g lp means g lp sup 0 1 p x rd g x dyadic harmonic analysis and weighted inequalities 13 2 4 why are we interested in these estimates we record a few instances where lp and weighted lp estimates are of importance in analysis fourier analysis boundedness of the periodic hilbert transform on lp t implies convergence on lp t of the partial fourier sums complex analysis hf is the boundary value of the harmonic conjugate of the poisson extension to the upper half plane of a function f lp r factorization theory of holomorphic hardy spaces hp elements of hp can be defined as those distributions whose image under properly defined maximal functions or other suitable singular operators or square functions are in lp approximation theory boundedness properties of the martingale transform a dyadic analogue of the hilbert transform show that haar functions and other wavelet families are unconditional bases of several functional spaces pdes boundedness of the riesz transforms analogues of the hilbert transform on rd and their commutators have deep connections to partial differential equations quasiconformal theory boundedness of the beurling transform singular inte gral operator on c on lp w for p 2 and with linear estimates on w ap implies borderline regularity result operator theory weighted inequalities appear naturally in the theory of hankel and toeplitz operators perturbation theory etc we expand on the weighted estimate needed in quasiconformal theory which propelled the interest in quantitative weighted estimates this was work by kari astala tadeusz iwaniec and eero saksman in 2001 we refer to their paper ais for appropriate definitions they showed that for 1 k every weakly k quasi regular mapping contained in a sobolev space w 1 qloc with 2 k k 1 q 2 is quasi regular on that is to say it belongs to w 1 2 loc for each q 2 k k 1 there are weakly k quasi regular mappings f w 1 q loc c which are not quasi regular the only value of q that remained unresolved was the endpoint they conjectured that all weakly k quasi regular mappings f w 1 qloc with q 2 k k 1 are in fact quasi regular they reduced the conjecture to showing ais proposition 22 that the beurling transform t satisfies linear bounds in lp w for p 1 namely tg lp w p w ap g lp w for allw ap and g lp w fortunately the values of interest for q are 1 q 2 and p q 2 linear bounds for the beurling transform and p 2 were proven in 2002 by stefanie petermichl and sasha volberg petv as a consequence the regularity at the borderline case q 2 k k 1 was established for 1 p 2 the correct estimate for the beurling transform is of the form tg lp w p w 1 p 1 ap g lp w for all w ap and g lp w as shown in dgppet 2 5 first linear estimates interest in quantitative weighted estimates exploded in this millennium a chronology of the early linear estimates on l 2 w for the weight w in the muckenhoupt a 2 class namely tf l 2 w c w a 2 f l 2 w is as follows maximal function buckley 93 bu 1 martingale transform wittwer 00 w 1 dyadic square function hukovic treil volberg 00 htv wittwer 02 w 2 beurling transform petermichl volberg 02 petv 14 m c pereyra hilbert transform petermichl 07 pet 2 riesz transforms petermichl 08 pet 3 dyadic paraproduct beznosova 08 be 2 except for the maximal function all these linear estimates were obtained using bellman functions and bilinear carleson estimates for certain dyadic operators petermichl dyadic shift operators martingale transform dyadic paraproducts dyadic square function and then either the operator under study was one of them or had enough symmetries that it could be represented as a suitable average of dyadic operators beurling hilbert and riesz transforms the bellman function method was introduced in the 90 s to harmonic analysis by fedja nazarov sergei treil and sasha volberg nt ntv 2 although they credit donald burkholder in his celebrated work finding the exact lp norm for the martingale transform bur 2 with their students and collaborators they have been able to use the bellman function method to obtain a number of astonishing results not only in this area see volberg s inria lecture notes v and references in volberg s own words 5 the bellman function method makes apparent the hidden multiscale properties of harmonic analysis problems a flurry of work ensued and other techniques were brought into play including stopping time techniques corona decompositions and median oscillation techniques these techniques became the precursors of what is now known as the method of domination by dyadic sparse op erators with important contributions from david cruz uribe chema martell carlos p rez andrei lerner tuomas hyt nen michael lacey mari carmen reguera stefanie petermichl fedja nazarov sergei treil sasha volberg and others we will say more about sparse domi nation in section 7 the culmination of this work was the celebrated resolution of the a 2 conjecture by tuomas hyt nen hyt 2 in 2012 where he showed first every calder n zygmund operator could be written as an average of dyadic shift operators of arbitrary complexity dyadic paraproducts and their adjoints second the weighted l 2 norm of the dyadic shifts depended linearly on the a 2 characteristic of the weight and polynomially on the complexity and third these ingredients implied that the calder n zygmund operator obeyed linear bounds on l 2 w how about weighted lp estimates for 1 p 2 6 extrapolation and hyt nen s ap theorem there is a by now classical technique to obtain weighted lp estimates from weighted l 2 estimates or more generally from weighted lr estimates called extrapolation in this section we recall the classical rubio de francia extrapolation theorem a quantitative version due to oliver dragi evi et al called sharp extrapolation and deduce from the later hyt nen s ap theorem 2 6 1 rubio de francia extrapolation theorem jos luis rubio de francia introduced in the 80 s his celebrated extrapolation result a theorem that allowed to transfer estimates from weighted lr provided it held for all ar weights to weighted lp for all 1 p and all ap weights theorem 2 6 rubio de francia 1981 given t a sublinear operator and r r with 1 r if for all w ar there is a constant ct r d w 0 such that tf lr w ct r d w f lr w for all f lr w 5 http www sop inria fr apics ahpi summerschool 11 bellman lectures volberg 1 pdf dyadic harmonic analysis and weighted inequalities 15 then for each 1 p and for all w ap there is a constant ct p r d w 0 such that tf lp w ct p r d w f lp w for all f lp w if we choose r 2 paraphrasing antonio c rdoba 6 we will conclude that there is no lp just weighted l 2 since w 1 ap for all p there are books dedicated to the subject that cover this and many useful variants of this theorem the classical reference is the out of print 1985 book by garc a cuerva and rubio de francia garu a modern presentation including quantitative versions of this theorem is the 2011 book by david cruz uribe chema martell and carlos p rez crmpz 1 2 6 2 sharp extrapolation in the 80 s and 90 s the interest was on qualitative weighted es timates once the interest on quantitative weighted estimates was sparked it was natural to consider quantitative extrapolation theorems what we call sharp extrapolation theorems this is precisely what stefanie petermichl and sasha volberg did petv to obtain linear esti mates for the beurling transform and p 2 they missed the range 1 p 2 because it was of no interest and their calculation was very specific to the martingale transforms that properly averaged yielded the beurling transform it was soon realized that a general principle was at work dgppet we state a simplified version of what a quantitative extrapolation theorem says useful for the purposes of this survey theorem 2 7 dragi evi et al 2005 let t be a sublinear operator r r with 1 r if for all w ar there are constants ct r d 0 such that tf lr w ct r d w ar f lr w for all f l r w then for each 1 p and for all w ap there is a constant ct p r d 0 such that tf lp w ct p r d w max 1 r 1 p 1 ap f lp w for all f lp w the proof follows by now standard arguments involving the celebrated rubio de francia al gorithm and inserting whenever possible buckley s quantitative bounds 2 8 for the maximal function bu 1 an alternative streamlined proof of the sharp extrapolation theorem was presented by javier duoandikoetxea in duo 2 extending the result to more general settings including off diagonal and partial range extrapolation it was observed crmpz 1 that one can replace the pair tf f by a pair of functions g f in the extrapolation theorem in particular one could consider the pair f tf instead as long as one has the corresponding initial weighted inequalities required to jump start the theorem sharp extrapolation is sharp in the sense that no better power for w ap can appear in the conclusion that will work for all operators for some operators it is known that the extrapolated lp w bounds from the known optimal lr w estimates are themselves optimal for all 1 p however it is not necessarily optimal for a particular given operator here are some examples illustrating this phenomenon example 2 8 start with buckley s sharp estimate on lr w 1 r 1 for the maximal function extrapolation will give sharp bounds only for 1 p r 6 see page 8 in jos garc a cuerva s eulogy for jos luis rubio de francia 1949 1988 ga 16 m c pereyra example 2 9 sharp extrapolation from r 2 1 is sharp for the hilbert beurling riesz transforms for all 1 p for p 2 petv pet 2 pet 3 1 p 2 dgppet example 2 10 extrapolation from linear bound on l 2 w is sharp for the dyadic square function only when 1 p 2 sharp dgppet only le 2 however extrapolation from square root bound on l 3 w is sharp for all p 1 crmpz 2 2 6 3 hyt nen s ap theorem sharp extrapolation was used by tuomas hyt nen to prove the celebrated ap theorem the quantitative weighted lp estimates for calder n zygmund operators hyt 2 theorem 2 11 hyt nen 2012 let 1 p and let t be any calder n zygmund singular integral operator on rd then for all w ap and f lp w tf lp w t d p w max 1 1 p 1 ap f lp w cartoon of the proof enough to prove the p 2 case thanks to sharp extrapolation to prove the linear weighted l 2 estimate two important steps were required first prove a representation theorem in terms of haar shift operators of arbitrary complex ity dyadic paraproducts and their adjoints on random dyadic grids introduced in ntv 3 this representation hinges on certain reductions obtained in pztv second prove linear estimates on l 2 w with respect to the a 2 characteristic for para products be 2 and haar shift operators lpetr but with polynomial dependence on the complexity independent of the dyadic grid hyt 2 we will say more about random dyadic grids haar shift operators and paraproducts the ingredients in hyt nen s theorem in sections 3 and 4 it is now well understood that the l 2 w bounds for the haar shift operators not only depend linearly on the a 2 characteristic of w but also depend linearly on the complexity t sharp extrapolation has also been used to obtain quantitative estimates in other settings for example sandra pott and mari carmen reguera used sharp extrapolation when studying the bergman projection on weighted bergman spaces in terms of the b koll constant por they proved the base estimate on l 2 w for certain sparse dyadic operators and then showed the bergman projection could be dominated with these sparse dyadic operators 2 7 two weight problem for the hilbert transform and the maximal function we briefly state a necessarily incomplete chronological list of two weight results for the hilbert transform the maximal function and allied dyadic operators 2 7 1 two weight problem for h and its dyadic model the martingale transform in the 80 s mischa cotlar and cora sadosky found necessary and sufficient conditions la helson szeg solving the two weight problem for the hilbert transform the methods used involved com plex analysis and had applications to operator theory cs 1 cs 2 afterwards various sets of sufficient conditions la muckenhoupt were found to be valid also in the matrix valued con text one of the earliest such sets appeared in 1997 in joint work with nets katz kp see also the 2005 unpublished manuscript ntv 5 necessary and sufficient conditions for uniform and individual martingale transform and well localized dyadic operators were found in 1999 and 2008 respectively by fedja nazarov sergei treil sasha volberg ntv 1 ntv 4 using bellman function techniques we will say more about this in section 4 1 long time sought necessary and sufficient conditions for two weight boundedness of the hilbert transform were dyadic harmonic analysis and weighted inequalities 17 found in 2014 by michael lacey eric sawyer chun yen shen and ignacio uriarte tuero l 1 lssu for pairs of weights that do not share a common point mass corresponding quan titative estimates were obtained using very delicate stopping time arguments see also l 2 improvements have since been obtained relaxing the conditions on the weights by the same authors and tuomas hyt nen hyt 4 2 7 2 two weight estimates for the maximal function in 1982 eric sawyer showed in s 1 that the maximal function m is bounded from l 2 u into l 2 v if and only if the following testing conditions 7 hold for the weights u and v there is a constant cu v 0 such that for all cubes q q m 1 qu 1 x 2 v x dx cu vu 1 q and q m 1 qv x 2 u 1 x dx cu vv q sawyer also identified necessary and sufficient conditions for two weight inequalities for certain positive operators the fractional and poisson integrals s 2 these results were of qualitative type in 2009 kabe moen presented the first quantitative result moe he proved that the two weight operator norm of m is comparable to the constants cu v in sawyer s result note that sawyer s testing conditions imply the following joint a 2 condition u v a 2 sup q u 1 q v q where v q v q q in 2015 carlos p rez and ezequiel rela pzr considered a particular case when u v a 2 and u 1 a and showed the following so called mixed type estimate m l 2 u l 2 v u v 1 2 a 2 u 1 1 2 a in the one weight setting when u v w one gets the following improved mixed type estimate m l 2 w l 2 w w 1 2 a 2 w 1 1 2 a w a 2 the a class of weights is defined to be the union of all the ap classes of weights for p 1 the classical a characteristic is given by w acl sup q w q exp logw q a weight w is in a if and only if w acl an equivalent characterization is obtained using instead the fujii wilson characteristic defined by w a sup q 1 w q q m w q x dx the fujii wilson a characteristic is smaller than the classical one bere for mixed type estimates of similar nature for calder n zygmund singular integral operators see hytpz for sharp weighted inequalities for fractional integral operators see lmpzto 7 nowadays called sawyer s testing conditions 18 m c pereyra 3 dyadic harmonic analysis in this section we introduce the elements of dyadic harmonic analysis and the basic dyadic maximal function more precisely we discuss dyadic grids regular random adjacent and haar functions on the line on rd and on spaces of homogeneous type as a first example illustrating the power of the dyadic techniques we present lerner s proof of buckley s quan titative lp estimates for the maximal function which reduces using the one third trick to estimates for the dyadic maximal function we also describe given dyadic cubes on spaces of homogeneous type how to construct corresponding haar bases and briefly describe the auscher hyt nen wavelets in this setting 3 1 dyadic intervals dyadic maximal functions in this section we recall the dyadic intervals and the weighted dyadic maximal function on the line as well as basic lp estimates for the dyadic maximal function 3 1 1 dyadic intervals the standard dyadic grid d on r is the collection of intervals of the form k 2 j k 1 2 j for all integers k j z the dyadic intervals are organized by generations d j zdj where i dj if and only if i 2 j note that the larger j is the smaller the intervals are for each interval j d denote by d j the collection of dyadic intervals i contained in j the standard dyadic intervals satisfy the following properties partition property each generation dj is a partition of r nested property if i j d then i j i j or j i one parent property if i dj then there is a unique interval i dj 1 called the parent of i such that i i the parent is twice as long as the child that is i 2 i two children property given i dj there are two disjoint intervals ir il dj 1 the right and left children such that i il ir tower of dyadic intervals each point x r belongs to exactly one dyadic interval ij x dj the family ij x j z forms a tower or cone over x the union of the intervals in a tower j zij x is a quadrant two quadrant property the origin 0 separates the positive and the negative dyadic interval creating two quadrants more generally a dyadic grid on r is a collection of intervals organized in generations with the partition nested and two children properties in this subsection we reserve the name d for the standard dyadic grid however later on we will use d to denote a general dyadic grid the partition and nested properties are common to all dyadic grids the one parent property is a consequence of these properties the two children property is responsible for the name dyadic the equal length property is a consequence of choosing to subdivide in halves and is in general not so important one could subdivide into two children of different lengths if the ratio is uniformly bounded we have a homogeneous or doubling dyadic grid one can manufacture dyadic grids on the line where each interval has two equal length children but there is no distinguished point and only one quadrant this is because given an interval in the grid its descendants are completely determined however we have two choices for the parent hence four choices for the grandparent etc in len dyadic grids are defined to have one quadrant such grids have the additional useful property that given any compact set there will be a dyadic interval containing it dyadic harmonic analysis and weighted inequalities 19 there are many variants for example we could subdivide each interval into a uniformly bounded number of children or into arbitrarily finitely many children in fact there are regular dyadic structures on rd where the role of the intervals is played by cubes with sides parallel to the axes in this case each cube in the dyadic grid is subdivided into 2 d congruent children see section 3 4 2 we will also see that there are dyadic structures in spaces of homogeneous type where each cube may have no more than a fixed number of children but sometimes it will only have one child itself for several generations see section 3 5 2 in all cases the dyadic grids provide a hierarchical structure that allows for simplified arguments in this setting the so called induction on scale arguments 3 1 2 dyadic maximal function given a dyadic grid d on rd and a weight u the weighted dyadic maximal function mdu is defined like the maximal function m except that instead of taking the supremum over all cubes in rd with sides parallel to the axes we restrict to the dyadic cubes this is often how one transitions from continuous to dyadic models more precisely the weighted dyadic maximal function with respect to a weight u and a dyadic grid d on rd is defined by mdu f x sup q d q 3 x 1 u q q f y u y dy here u q q u x dx when u 1 a e then md 1 m d the dyadic maximal function inherits boundedness properties from the regular maximal function this is clear once one notices that the dyadic maximal function is trivially pointwise dominated by the maximal function however these properties are much easier to verify for the dyadic maximal function we now list three basic boundedness properties of the dyadic maximal function with a word or two as how one can verify each one of them first the dyadic maximal function mdu is of weak l 1 u type with constant one inde pendent of dimension this is an immediate corollary of the calder n zygmund lemma a stopping time no covering lemmas are required unlike the usual arguments for m second clearly mdu is bounded on l u with constant one interpolation between the weak l 1 u and the l u estimates shows that mdu is bounded on l p u for all p 1 moreover the following estimate holds with a constant independent of the weight v and the dimension d 3 1 mdu f lp u p f lp u where 1 p 1 p 1 and p 1 third the dyadic maximal function is pointwise comparable to the maximal function we explain in section 3 2 1 why this domination holds in the one dimensional case d 1 3 2 one third trick and lerner s proof of buckley s result we present the one third trick on r and how it can be used to dominate the maximal function by a sum of dyadic maximal functions the one third trick appeared in print in 1991 in kate okikiolu characterization of subsets of rectifiable curves in rd ok lemma 1 b see cr footnote p 32 for fascinating historical remarks on the one third trick this was probably well known among the john garnett s school of thought see for example gj and also by the polish school specifically by tadeusz figiel fi we illustrate how this principle can be used to recover buckley s quantitative weighted lp estimate for the maximal function 20 m c pereyra 3 2 1 one third trick the families of intervals di j zdij for i 0 1 2 where d i j 2 j 0 1 m 1 j i 3 m z are dyadic grids satisfying partition nested and two equal children properties we make four observations first when i 0 we recover the standard dyadic grid d 0 d second the grids d 1 and d 2 are nested but there is only one quadrant the line r third the grids di for i 0 1 2 are as far away as possible from each other to be made more precise in example 3 3 fourth given any finite interval i r for at least two values of i 0 1 2 there are j i di such that i j i 3 i j i 6 i in particular this implies that given i 6 k i k 0 1 2 there is at least one interval j di dk such that i j and 3 i j 6 i and furthermore 1 i i f y dy 6 j j f y dy this last observation allows us to dominate the maximal functionm by its dyadic counterpart in fact the following estimate holds 3 2 mf x 6 mdf x md 1 f x more precisely for i 6 k mf x sup i 3 x 1 i i f y dy 6 sup j di dk j 3 x 1 j j f y dy 6 max mdif x mdkf x 6 md i f x md k f x in particular setting i 0 and k 1 we obtain 3 2 there is an analogue of the one third trick in higher dimensions in rd one can get by with 3 d grids as is very well explained in len section 3 with 2 d grids hytpz or with d 1 grids and this is optimal by cleverly choosing the grids for r and for the d torus see me for rd and d 1 see c 3 2 2 buckley s ap estimate for the maximal function we illustrate the use of dyadic tech niques paired with domination to recover stephen buckley s quantitative weighted lp estimate for the maximal function bu 1 namely for all w ap and f lp w mf lp w w 1 p 1 ap f lp w the beautiful argument we present is due to andrei lerner le 1 lerner s proof by the one third trick suffices to check that for 1 p there is a constant cp 0 such that for all w ap and for all f lp w then mdf lp w cp w 1 p 1 ap f lp w independently of the dyadic grid d chosen on rd for any dyadic cube q d let ap q w q q p 1 q p where we denote by w 1 p 1 the dual weight of w then 1 q q f x dx ap q 1 p 1 q w q 1 q q f x 1 x x dx p 1 1 p 1 dyadic harmonic analysis and weighted inequalities 21 w 1 p 1 ap 1 w q q md f 1 x w 1 x w x dx p 1 1 p 1 taking the supremum over q d we obtain mdf x w 1 p 1 ap mdw m d f 1 p 1 w 1 x 1 p 1 computing the lp w norm on both sides recalling that p 1 p p where 1 p 1 p 1 and carefully peeling off the maximal functions we get mdf lp w w 1 p 1 ap mdw md f 1 p 1 w 1 1 p 1 lp w w 1 p 1 ap mdw 1 p 1 lp w md f 1 lp w 1 p 1 ap mdw 1 p 1 lp w md lp f 1 lp p 1 p 1 p w 1 p 1 ap f lp w where we used in the last line the uniform bounds 3 1 of mdw on l p w and md on lp notice that in this argument neither extrapolation nor interpolation are used for exten sions to two weight inequalities and to the fractional maximal function see moe 3 3 random dyadic grids on r for the purpose of this section a dyadic grid on r is a collection of intervals that are organized in generations each generation provides a partition of r and the family has the nested one parent and two equal length children per interval properties shifted and scaled regular dyadic grid are dyadic grids these are not the only ones there are other dyadic grids such as the ones defined for the one third trick d 1 and d 2 the following parametrization will capture all dyadic grids in r hyt 1 lemma 3 1 hyt nen 2008 for each scaling parameter r with 1 r 2 and shift param eter 0 1 z meaning i i z with i 0 or 1 then dr j zdr j is a dyadic grid where d r j rd j and d j xj dj with xj i j i 2 i we shift by a different parameter xj at each level j in a way that is consistent and preserves the nested property of the grid moreover the shift parameter j 0 1 for j z encodes the information whether a base interval at level j will be the right or the left half of its parent example 3 2 shifted and scaled regular grids correspond to the shift parameter i 0 for all i n or i 1 for all i n for some integer n these are the grids with two quadrants comparatively speaking this set of dyadic grids is negligible since it corresponds to a set of measure zero in parameter space described below example 3 3 the 1 3 shifted dyadic grids introduced in the previous section correspond to hyt nen s dyadic grids for r 1 more precisely d i d 1 i for i 0 1 2 where for all j z 0 j 0 or 1 1 j 12 z j and 2 j 12 z 1 j 22 m c pereyra we call these grids random dyadic grids because we view the parameters j and r as independent identically distributed random variables there is a very natural probability space say p associated to the parameters 1 2 0 1 z averaging in this context means calculating the expectation in this probability space that is e f f dp 2 1 0 1 z f r d dr r where stands for the canonical probability measure on 0 1 z which makes the coordinate functions j independent with j 0 j 1 1 2 random dyadic grids have been used for example in the study of t b theorems on metric spaces with non doubling measures ntv 3 hytma and of bmo from dyadic bmo on the bidisc and product spaces of spaces of homogeneous type piw clw inspired by celebrated work of john garnett and peter jones from the 80 s gj they have also been used in hyt nen s representation theorem hyt 2 and in the resolution of the two weight problem for the hilbert transform lssu l 1 3 4 haar bases associated to dyadic intervals or dyadic cubes there is a very important collection of step functions the haar functions in this section we recall the haar bases on r and on rd and some of their well known properties 3 4 1 haar basis on r the haar function associated to an interval i r is defined to be hi x i 1 2 1 ir x 1 il x where ir and il are the right and left halves respectively of i and the characteristic function 1 i x 1 if x i zero otherwise haar functions have mean zero that is r hi 0 and they are normalized on l 2 r the haar functions indexed on any dyadic grid d hi i d form a complete orthonormal system of l 2 r haar 1910 in particular for all f l 2 r with f g r f x g x dx f i d f hi hi you can find a complete proof of this statement in pw chapter 9 the haar basis is an unconditional basis of lp r and of lp w if w ap for 1 p tv this is deduced from the boundedness properties of the martingale transform we will say more about this dyadic operator in section 4 1 the haar basis constitutes the first example of a wavelet basis 8 and its corresponding haar multiresolution analysis provides the canonical example of a multiresolution analysis pw chapters 9 11 3 4 2 dyadic cubes and haar basis on rd in d dimensional euclidean space the regular dyadic cubes are cartesian products of regular dyadic intervals of the same generation more precisely a cube q dj rd if and only if q i 1 id where in dj r for n 1 2 d each generation dj rd is a partition of rd and they form a nested grid each cube has one parent and 2 d congruent children and there are 2 d quadrants had we 8 an orthonormal wavelet basis of l 2 r is an orthonormal basis where all its elements are translations and dilations of a fixed function called the wavelet more precisely a function l 2 r is a wavelet if and only if the functions j k x 2 j 2 2 jx k for j k z form an orthonormal basis of l 2 r dyadic harmonic analysis and weighted inequalities 23 used dyadic intervals with just one quadrant then the corresponding dyadic cubes in rd will also have only one quadrant we denote d rd the collection of all dyadic cubes in all generations that is d rd j zdj rd for q d rd we denote d q the set of dyadic cubes contained in q for each dyadic cubeq in rd we can associate 2 d step functions constant on each children of q by taking appropriate tensor products more precisely for q d rd and 1 d with n 0 or 1 let h q x 1 xd h 1 i 1 x 1 h did xd where for each dyadic interval i we denote h 0 i hi and h 1 i i 1 21 i note that h 1 q q 1 21 q where 1 1 1 1 the remaining 2 d 1 functions are the haar functions associated to the cube q the tensor product haar functions h q for 6 1 are supported on the corresponding dyadic cube q they have mean zero l 2 norm one and they are constant on q s children the collection h q 6 1 q d rd is an orthonormal basis of l 2 rd and an unconditional basis of lp rd 1 p the haar basis figure 3 4 2 and figure 3 4 2 illustrate the haar functions associated to a square in r 2 and to a cube in r 3 respectively 1 2 1 1 2 1 1 2 1 1 2 1 1 2 1 1 2 1 figure 1 the three haar function associated to the unit square in r 2 figure kindly provided by david weirich we figure 2 the seven haar functions associated to a cube in r 3 figure kindly provided by david weirich we the tensor product construction just described seems very rigid it is very dependent on the geometry of the cubes and on the group structure of the euclidean space rd can we do 24 m c pereyra dyadic analysis on other settings the answer is a resounding yes one such setting is on spaces of homogeneous type introduced by coifman and weiss in the early 70 s in section 3 5 we will describe how to construct haar basis on spaces of homogeneous type given suitable collections of dyadic cubes and arg e why they constitute an orthonormal basis this argument can be used to show that the haar functions introduced in this section constitute an orthonormal basis of l 2 rd 3 5 dyadic analysis on spaces of homogeneous type in this section we will define spaces of homogeneous type we will present a generalization of the dyadic cubes adapted to this setting given dyadic cubes we will show how to construct corresponding haar functions and briefly discuss the auscher hyt nen wavelets on spaces of homogeneous type before we start we would like to quote yves meyer one is amazed by the dramatic changes that occurred in analysis during the twentieth century in the 1930 s complex methods and fourier series played a seminal role after many improvements mostly achieved by the calder n zygmund school the action takes place today on spaces of homogeneous type no group structure is available the fourier transform is missing but a version of harmonic analysis is still present indeed the geometry is conducting the analysis yves meyer 9 in his preface to dh 3 5 1 spaces of homogeneous type sht let us first define what is a space of homogeneous type in the sense of coifman and weiss cow definition 3 4 coifman weiss 1971 for a set x a triple x is a space of homoge neous type sht in coifman weiss s sense if 1 x x 0 is a quasi metric on x more precisely the following hold a positive definite x y 0 if and only if x y b symmetry x y y x 0 for all x y x c quasi triangle inequality there exists constant a 0 1 such that x y a 0 x z z y for all x y z x 2 is a nonzero borel regular 10 measure with respect to the topology induced by the quasimetric 11 3 quasi metric balls are measurable a quasi metric ball is the set b x r y x x y r where x x and r 0 4 is a doubling measure namely there exists a constant d 1 the doubling constant of the measure such that for each quasimetric ball b x r 0 b x 2 r d b x r for all x x r 0 9 recipient of the 2017 abel prize 10 a measurable set e of finite measure is borel regular if there is a borel set b such that e b and e b 11 the topology induced by a quasi metric is the largest topology t such that for each x x the quasi metric balls centered at x form a fundamental system of neighborhoods of x equivalently a set is open t if for each x there exists r 0 such that the quasi metric ball b x r a set in x is closed if it is the complement of an open set dyadic harmonic analysis and weighted inequalities 25 notice that condition 4 implies that there are constants 0 known as an upper dimension of and c 1 such that for all x x 1 and r 0 b x r c b x r in fact we can choose c d 1 and log 2 d the quasi metric balls may not be open in the topology induced by the quasi metric as example 3 5 shows therefore the assumption that the quasimetric balls are measurable is not redundant the following example illustrate this phenomenon hytk example 3 5 consider the set x 1 0 the map x x 0 given by 1 0 0 1 1 2 and x y x y otherwise and the measure e 1 e m e 0 where m is the lebesgue measure and 1 the point mass at x 1 that is 1 e 0 if 1 e and 1 e 1 if 1 e then is not a metric since 1 1 2 3 2 1 1 2 1 0 0 1 however is a quasi metric and the measure is doubling it is a good exercise to compute both the quasi triangle constant of and the doubling constant of finally the ball b 1 1 1 0 is not open because it does not contain any ball centered at 0 with positive radius r since 0 r b 0 r and the interval 0 r is not contained in b 1 1 a couple of further remarks are in order first a given quasi metric may not be h lder regular recall that is a h lder regular quasi metric if there are constants 0 1 and c 0 0 such that x y x y c 0 x x x y x y 1 x x y x metrics are h lder regular for any 0 1 c 0 1 the quasi metric in example 3 5 is not continuous let alone h lder regular quasi metric balls for h lder regular quasi metrics are always open second roberto mac as and carlos segovia showed in 1979 ms that given a space of homogeneous type x there is an equivalent h lder regular quasi metric on x and some 0 1 and for which the measure is 1 ahlfors regular more precisely b x r r 1 here are some examples of spaces of homogeneous type rn with the euclidean metric and the lebesgue measure rn with the euclidean metric and an absolutely continuous measure with respect to the lebesgue measure d w dx where w is a doubling weight for example w could be an a weight quasi metric spaces with d ahlfors regular measure b x r rd e g lipschitz surfaces fractal sets n thick subsets of rn more concretely consider for example x the four corners cantor set with the euclidean metric and the one dimensional hausdorff measure or consider x the graph of a lipschitz function f rn r with the induced euclidean metric and measure the volume of the set s shadow e m x rn x f x e where m is the lebesgue measure on rn c manifolds with doubling volume measure for geodesic balls nilpotent lie groups g with the left invariant riemannian metric and the induced measure e g heisenberg group where x is the boundary of the unit ball in cn z w 1 z w and with surface measure 26 m c pereyra the 2015 book by ryan alvarado and marius mitrea ami discusses in more detail many of these examples and relies heavily on the mac as segovia philosophy meaning they consider equivalent classes of quasi metrics knowing that among them they can choose a representative that is h lder regular and for which the measure is ahlfors regular 3 5 2 dyadic cubes in sht systems of dyadic cubes were built by hugo aimar and roberto mac as eric sawyer and richard wheeden and guy david in the 80 s aim sw da and by michael christ in the 90 s chr on spaces of homogeneous type and by tuomas hyt nen and anna kairema in 2012 on geometrically doubling quasi metric spaces hytk without reference to a measure a geometrically doubling quasi metric space x d is one such that every quasi metric ball of radius r can be covered with at most n quasi metric balls of radius r 2 for some natural number n example 3 6 spaces of homogeneous type in the coifman weiss sense are geometrically doubling cow systems d of dyadic cubes in spaces of homogeneous type or more generally on geometri cally doubling spaces are organized in disjoint generations dk k z such that d k zdk and the following qualitative properties hold a each generation dk is a partition of x so the cubes in a generation are pairwise disjoint and form a covering of x b the generations are nested that is there is no partial overlap across generations c as a consequence each cube has unique ancestors in earlier generations d dyadic cubes have at most m children for some positive natural number m this is a consequence of the geometric doubling property e there exists a constant 0 1 such that for every dyadic cube in dk there are inner and outer balls of radius roughly k the sidelength of the cube f the outer ball corresponding to a dyadic cube s child is inside its parent s outer ball note that since 0 1 the larger k is the smaller in diameter the cubes are if q dk then its parent will be the unique cube q dk 1 such that q q furthermore cubes can be constructed to have a small boundary property chr hytk which is very useful in applications a quantitative and more precise statement of the defining properties for a dyadic system of cubes on geometric doubling metric spaces is encapsulated in the following construction that appeared in hytk theorem 2 2 theorem 3 7 hyt nen kairema 2012 given x d a geometrically doubling quasi metric space suppose the constants c 0 c 0 1 and 0 1 satisfy 12 a 30 c 0 c 0 given a set of points zk ak where ak is a countable set of indexes with the properties that d zk z k c 0 k 6 min ak d x zk c 0 k for all x x for each k z and ak there exists sets qk qk q k called open half open and closed dyadic cubes such that 1 qk and q k are the interior and closure of q k respectively 2 nested if k then either q qk or qk q dyadic harmonic analysis and weighted inequalities 27 3 partition x ak q k for all k z 4 inner outer balls b zk c 1 k qk b zk c 1 k where c 1 3 a 20 1 c 0 and c 1 2 a 0 c 0 5 if k and q qk then b z c 1 b zk c 1 k the open and closed cubes qk and q k depend only on the points z for k the half open cubes qk depend on z for min k k 0 where k 0 z is a preassigned number entering the construction the geometrically doubling condition implies that sets of points xk k z ak with the required separation properties exist and that the set ak is a countable set of indices for each k z the cubes in this construction are built as countable unions of quasi metric balls hence once a space of homogeneous type is given the cubes will be measurable sets q uq 1 uq 2 uq 3 uq 4 uq 5 q e 1 q e 1 q q e 2 q e 2 q q e 3 q e 3 q q e 4 q e 4 q q figure 3 the 4 haar functions for a cube with 5 children in sht figures kindly provided by david weirich we 3 5 3 haar basis on sht given a space of homogeneous type x with a dyadic struc ture d given by theorem 3 7 we can construct a system of haar functions that will be an orthonormal basis of l 2 x given a cube q d denote by ch q the collection of dyadic children of q and by n q its cardinality that is q has n q children let sq be the subspace of l 2 x spanned by those square integrable functions that are supported on q and are constant on the children of q the subspace sq has dimension n q as the characteristic functions of the children cubes normalized with respect to the l 2 norm namely 1 q q q ch q form an orthonormal basis for sq the subspace s 0 q of sq consisting of those functions that have mean zero that is q f x dx 0 will have one fewer dimension namely dim s 0 q n q 1 given an enumeration of the children of q that is a bijection uq 1 2 n q ch q we will define recursively subsets of q that are unions of children of q more precisely at each stage we will remove one child according to the given enumeration let e 1 q q given ekq q let e k 1 q e k q uq k for k 1 2 n q 1 we can split each of these sets into two disjoint pieces eiq e i q e i q where e i q uq i the child removed green in 28 m c pereyra figure 3 5 2 and ei q e i 1 q blue in figure 3 5 2 with this notation the haar functions associated to the cube q and the enumeration uq as illustrated in figure 3 5 2 are supported on q and are constant on the colored regions positive on the green regions negative on the blue regions and zero on the red regions thus they are given by hiq x a 1 ei q x b 1 e i q x 1 i n q 1 where the positive constants a and b dependent on the base cube q and the label i are chosen to enforce l 2 normalization and mean zero more precisely the unknowns a b must satisfy the system of two equations q hiq x 2 d a 2 e i q b 2 e i q 1 q hiq x d a e i q b e i q 0 solving the system of equations we get the positive solutions a e i q eiq e i q b e i q eiq e i q note that the doubling condition on the measure ensures q 0 for all q d and hence also eiq 0 for all labels i the haar basis consists of all functions hiq where q d and i 1 2 n q 1 note that a cube may not subdivide for a while meaning that it could have just one child itself for several generations or forever in the former case we wait until we subdivide to define the subspace s 0 q in the later case we let s 0 q be the trivial subspace by construction for each q d the collection hiq i 1 n q 1 is normalized on l 2 x each haar function has mean zero and by the nested property of the dyadic cubes it is easy to verify this is an orthonormal family no matter what enumeration for ch q we use we will get each time an orthonormal basis of s 0 q the orthogonal projection onto s 0 q of a square integrable function f is independent of the orthonormal basis chosen on s 0 q given x q choose an enumeration so that x uq 1 r ch q then projsqf x f h 1 q h 1 q x f r f q where f g denotes the inner product in l 2 x and f q denotes the average of f the first equality holds by support considerations since hi x 0 for all i 1 by the choice of the enumeration the second equality is now a simple calculation by substitution using a telescoping sum argument one can verify that completeness of the haar basis on l 2 hinges on the following limits holding in the l 2 sense lim j e j f f lim j e j f 0 where ejf f q with x q dj or ejf q dj f q 1 q that the limits do hold can be justified by martingale theory hyt 3 mul in fact they do hold in lp x for 1 p the pointwise convergence a e of the averages to f as j goes to infinity is a consequence of the lebesgue differentiation theorem which holds because the measure is assumed to be borel regular see ami section 3 3 dyadic harmonic analysis and weighted inequalities 29 haar type bases for l 2 x have been constructed in general metric spaces and the construction along the lines described here is well known to experts haar type wavelets associated to nested partitions in abstract measure spaces were constructed in 1997 by girardi and sweldens gs for the case of spaces of homogeneous type there is a lot of work related to haar bases done in argentina this millennium specifically by hugo aimar and collaborators osvaldo gorosito ana bernardis bibiana iaffei and luis nowak aig ai aibi aibn 1 aibn 2 all descendants of eleonor harboure haar functions have been used in geometrically doubling metric spaces nrv for the case of a geometrically doubling quasi metric space x with a positive borel regular measure see klpw 3 5 4 random dyadic grids adjacent dyadic grids and wavelets on sht the counterparts of the random dyadic grids and the one third trick have been identified in the general setting of geometrically doubling quasi metric spaces by tuomas hyt nen and his students and collab orators using them pascal auscher and tuomas hyt nen constructed in 2013 a remarkable orthonormal basis of l 2 x ah 1 ah 2 a notion of random dyadic grids can be introduced on geometrically doubling quasi metric spaces x d by randomizing the order relations in the construction of the hyt nen kairema cubes hytma hytk in 2014 tuomas hyt nen and olli tapiola modified the random ization to improve upon auscher hyt nen wavelets in metric spaces hytta a different randomization can be found in nrv one can find finitely many adjacent families of hyt nen kairema dyadic cubes dt for t 1 t with the same parameters that play the role of the 1 3 shifted dyadic grids in r the main property the adjacent families of dyadic cubes have is that given any ball b x r x with r k then there is t 1 2 t and a cube in the t grid and in the kth generation q dtk such that b x r q b x cr where c 0 is a geometric constant only dependent on the quasi metric and geometric doubling parameters of x hytk furthermore given a finite measure on x the adjacent dyadic systems can be chosen so that all cubes have small boundaries q 0 for all q tt 1 dt hytk given nested maximal sets xk of k separated points in x for k z let yk xk 1 xk and relabel points in yk by yk to each point y k auscher and hyt nen associate a wavelet function k a linear spline of regularity 0 1 that is morally supported near y k at scale k with mean zero and some smoothness more precisely these functions are not compactly supported but have exponential decay away from the base cube qk and they have h lder regularity exponent 0 where depends only on and on some finite quantities needed for extra labeling of the random dyadic grids used in the construction of the wavelets the number of indexes so that yk yk for each qk is exactly n qk 1 where recall that n qk denotes the number of children of q k this is the right number of wavelets per cube qk if our intuition is to be guided by the constructions of the haar functions the precise nature of these wavelets is detailed in ah 1 theorem 7 1 furthermore the functions k k z yk form an unconditional basis on lp x for all 1 p and the following wavelet expansion is valid in lp x f x k z yk yk f k k x hyt nen and tapiola were able to build such wavelets for all 0 1 in the context of metric spaces hytta it is still an open problem to construct smooth wavelets that are 30 m c pereyra compactly supported these wavelets have been used to study hardy and bmo spaces on product spaces of homogeneous type as well as their dyadic counterparts klpw 4 dyadic operators weighted inequalities and hyt nen s representation theorem in this section we introduce the model dyadic operators the martingale transform the dyadic square function the dyadic paraproduct petermichl s haar shift operator and haar shift operators of arbitrary complexity all ingredients in hyt nen s proof of the a 2 conjecture hyt 2 we will state the known quantitative one and two weight inequalities for these dyadic operators we end the section with hyt nen s representation theorem in terms of haar shift operators of arbitrary complexity dyadic paraproducts and adjoints of dyadic paraproducts over random dyadic grids valid for all calder n zygmund operators and key to the resolution of the a 2 conjecture 4 1 martingale transform let d denote a dyadic grid on r the martingale transform is the linear operator formally defined as t f x i d i f hi hi x where i 1 this is a constant haar multiplier in analogy to fourier multipliers where here the haar coefficients are modified multiplying them by uniformly bounded constants the haar symbol i i d in this case arbitrary changes of sign the martingale transform is bounded on l 2 r in fact it is an isometry on l 2 r by plancherel s identity that is t f l 2 f l 2 the martingale transform is a good toy model for calder n zygmund singular integral op erators such as the hilbert transform suffices to recall that on fourier side the hilbert trans form is a fourier multiplier with fourier symbol mh i sgn compare the fourier transform of the hilbert transform and the haar transform of the martingale transform namely h f i sgn f and t f hi i f hi unconditionality of the haar basis on lp r follows from uniform on the choice of signs boundedness of the martingale transform t on lp r more precisely for all f lp r sup t f lp p f lp this was proven by donald burkholder in 1984 he also found the optimal constant cp in work that can be described as the precursor of the exact bellman function method bur 2 unconditionality of the haar basis on lp w when w ap follows from the uniform bound edness of t on lp w this was proven in 1996 by sergei treil and sasha volberg tv 4 1 1 quantitative weighted inequalities for the martingale transform quantitative one and two weight inequalities are known for the martingale transform in fact the a 2 conjecture linear bound was proven by janine wittwer in 2000 and necessary and sufficient conditions for two weight uniform on the symbol l 2 boundedness were identified by fedja nazarov sergei treil and sasha volberg in 1999 we present now the precise statements sharp linear bounds on l 2 w when w is an a 2 weight are known w 1 more precisely for all there is c 0 such that for all w a 2 and all f l 2 w t f l 2 w c w a 2 f l 2 w dyadic harmonic analysis and weighted inequalities 31 sharp extrapolation gives optimal bounds on lp w when w is an ap weight dgppet more precisely for all there is a constant cp 0 such that for all w ap and f lp w t f lp w cp w max 1 1 p 1 ap f lp w necessary and sufficient conditions on pairs of weights u v are known ensuring two weight boundedness ntv 1 more precisely theorem 4 1 nazarov treil volberg 1999 the martingale transforms t are uniformly on bounded from l 2 u to l 2 v if and only if the following conditions hold simultaneously i u v is in joint dyadic a 2 namely u v a 2 supi d u 1 i v i ii i i u 1 2 v i i d is a u 1 carleson sequence iii i iv 2 u 1 i i d is a v carleson sequence dual condition iv the positive dyadic operator t 0 is bounded from l 2 u into l 2 v where t 0 f x i d i i f i 1 i x with i iv v i i u 1 u 1 i i and iv v i v i a sequence i i d is v carleson if and only if there is constant b 0 such that i d j i bv j for all j d the smallest constant b is called the intensity of the sequence when u v w a 2 then i iii hold and by example 5 8 the sequence i i d is a 1 carleson sequence implying iv in 2008 nazarov treil and volberg found necessary and sufficient conditions for two weight boundedness of individual martingale transforms and other well localized operators ntv 4 see also vu 1 4 2 dyadic square function the dyadic square function is the sublinear operator formally defined as sdf x i d f hi 2 i 1 i x 1 2 the dyadic square function is an isometry on l 2 r as a calculation quickly reveals namely sdf l 2 f l 2 it is also bounded on lp r for 1 p furthermore sdf lp f lp this result plays the role of plancherel on lp littlewood paley theory it readily implies boundedness of t on lp r since sd t f sdf as follows t f lp sd t f lp sdf lp f lp a somewhat convoluted argument can be done to prove the lp boundedness of the dyadic square function first prove l 2 w estimates for a 2 weights w second extrapolate to get lp w estimates for ap weights w and third set w 1 ap stephen buckley has a very nice and elementary argument showing boundedness of the dyadic square function on l 2 w when w is an a 2 weight bu 2 or see p 1 section 2 5 1 one can track the dependence on the weight an get a 3 2 power on the a 2 characteristic of the weight becmop section 5 far from the optimal linear dependence discussed in section 4 2 1 32 m c pereyra 4 2 1 one weight estimates for sd quantitative one weight inequalities are known for the dyadic square function the a 2 conjecture linear bound was proven by sanja hukovic sergei treil and sasha volberg in 2000 htv and the reverse estimate was proven by stefanie petermichl and sandra pott in 2002 petpo we present now the precise statements for all weights w a 2 and functions f l 2 w w 1 2 a 2 f l 2 w sdf l 2 w w a 2 f l 2 w the direct and reverse estimates on l 2 w for the dyadic square function play the role of plancherel on l 2 w we can use these inequalities to obtain l 2 w bounds for the martingale transform t of the form w 3 2 a 2 however the optimal bound is linear w 1 as we already mentioned in section 4 1 1 boundedness on l 2 w for all weights w a 2 implies by extrapolation boundedness on lp r and on lp w for all w ap however sharp extrapolation will only yield the optimal power for 1 p 2 if one starts with the optimal linear bound on l 2 w not only sd is bounded on lp w if w ap moreover for 1 p and for all w ap and f lp w sdf lp w p w max 1 2 1 p 1 ap f lp w the power max 1 2 1 p 1 is optimal it corresponds to sharp extrapolation starting at r 3 with square root power crmpz 2 more precisely for all w a 3 and f l 3 w sdf l 3 w w 1 2 a 3 f l 3 w this estimate is valid more generally for wilson s intrinsic square function le 2 wil 2 sharp extrapolation from the reverse estimate on l 2 w also yields the following reverse estimate on lp w for all w ap and f lp w f lp w p w 1 2 max 1 1 p 1 ap sdf lp w this estimate can be improved using deep estimates of chang wilson and wolff cwilw for all p 1 to the following 1 2 power of the smaller fujii wilson a characteristic f lp w p w 1 2 a sdf lp w this estimate is better in the range 1 p 2 where the power is 1 2 instead of 1 2 p 1 for future reference we can compute precisely the weighted l 2 norm of sdf as follows sdf 2 l 2 w i d f hi 2 w i 4 2 2 two weight estimates for sd two weight inequalities are understood for the dyadic square function the necessary and sufficient conditions for two weight l 2 boundedness are known ntv 1 qualitative mixed estimates have been found by different authors these estimates reduce to the linear estimate in the one weight case we present now the precise statements theorem 4 2 nazarov treil volberg 1999 the dyadic square function sd is bounded from l 2 u into l 2 v if and only if the following conditions hold simultaneously i u v a 2 joint dyadic a 2 ii i iu 1 2 v i i d is a u 1 carleson sequence with intensity cu v dyadic harmonic analysis and weighted inequalities 33 notice ii is a localized testing condition on test functions u 11 j also note that the necessary and sufficient conditions i iii in theorem 4 1 for the martingale transform can be now replaced by i sd is bounded from l 2 u into l 2 v ii sd is bounded from l 2 v 1 into l 2 u 1 this is because u v a 2 if and only if v 1 u 1 a 2 a quantitative version of the boundedness estimate in terms of the constants appearing in the necessary and sufficient conditions is the following sd l 2 u l 2 v u v ad 2 cu v 1 2 there are similar two weight lp estimates for continuous square function lli 1 lli 2 see also becmop theorem 6 2 if the weights u v a 2 and u 1 a then they satisfy the necessary and sufficient conditions in theorem 4 2 and the following estimate holds becmop sd l 2 u l 2 v u v a 2 u v a 2 u 1 a 1 2 setting u v w a 2 this improves the known linear bound to a mixed type bound sd l 2 w w a 2 w 1 a 1 2 w a 2 same one weight estimate have been shown to hold for the dyadic square function and for matrix valued weights hytpetv quantitative weighted estimates from lp u into lq v in terms of quadratic testing condition are known vu 2 4 3 petermichl s dyadic shift operator given parameters r 1 2 0 1 z the petermichl s dyadic shift operator xr pronounced sha associated to the random dyadic grid dr is defined for functions f l 2 r by xr f x i dr f hi hi x i dr 2 1 2 i f h i hi x where hi 2 1 2 hir hil and i is 1 depending whether i is the right or left child of i s parent i more precisely i 1 if i i r and i 1 if i i l when r 1 and j 0 for all j z the corresponding grid is the regular dyadic grid and we denote the associated daydic shift operator simply x petermichl s dyadic shift operators are isometries on l 2 r that is for all r xr f l 2 f l 2 and they are bounded operators on lp r as can be readily seen using plancherel s identity and dyadic square function estimates each operator xr is a good dyadic model for the hilbert transform h the images under xr of the haar functions are the normalized differences of the haar functions on its children namely xr hj x hj x the functions hj and hj can be viewed as localized sines and cosines in the sense that if we were to extend them periodically with period the length of the support we will see two square waves shifted by half the length of the period more evidence comes from the way the family xr r interacts with translations dilations and reflections each dyadic shift operator does not have symmetries that characterize the hilbert transform 12 but an average over all random dyadic grids dr does it is a good 12 recall that any bounded linear operator on l 2 r that commutes with dilations and translations and anticommutes with reflexions must be a constant multiple of the hilbert transform 34 m c pereyra exercise to figure out how each individual shift interacts with these rigid motions they almost commute except that the dyadic grid changes for example regarding reflections it can be seen that if we denote by r x x then rxr xr r where 1 i i z the corresponding rules for translations and dilations are slightly more complicated but what matters is that there is a one to one correspondence between the dyadic grids so that when averaging over all dyadic grids the average will have the desired properties and hence it will be a constant multiple of the hilbert transform this is precisely what stefanie petermichl proved in 2000 a ground breaking and unexpected new result for the hilbert transform pet 1 more precisely she showed that h 8 e xr 8 xr dp r the result follows after verifying that the averages have the invariance properties that char acterize the hilbert transform pet 1 hyt 1 because the shift operators xr are uniformly bounded on lp r for 1 p this representation will immediately imply that the hilbert transform h is bounded on lp r in the same range a result first proved by marcel riesz in 1928 similarly once uniform on the dyadic grids dr weighted inequalities are verified for xr the inequalities will be inherited by the hilbert transform petermichl proved the linear bounds on l 2 w for the shift operators using bellman function methods and hence she proved the a 2 conjecture for the hilbert transform pet 2 these results added a very precise new dyadic perspective to such a classic and well studied operator as the hilbert transform similar representations hold for the beurling and the riesz transforms petv pet 3 these operators have many invariance properties as the hilbert transform does for a while it was believed that such invariances were responsible for these representation formulas it came as a surprise when tuomas hyt nen proved in 2012 that there is a representation formula valid for all calder n zygmund singular integral operators hyt 2 to state hyt nen s result we need to introduce haar shift operators of arbitrary complexity and paraproducts 4 4 haar shift operators of arbitrary complexity the haar shift operators of com plexity m n associated to a dyadic grid d were introduced by michael lacey stefanie petermichl and mari carmen reguera lpetr they are defined on l 2 r as follows xm nf x l d i dm l j dn l cli j f hi hj x where the coefficients cli j i j l and dm l denotes the dyadic subintervals of l with length 2 m l the cancellation property of the haar functions and the normalization of the coefficients ensures that xm nf l 2 f l 2 square function estimates ensure boundedness on lp r for all 1 p the martingale transform t is a haar shift operator of complexity 0 0 petermichl s xr operators are haar shift operators of complexity 0 1 the dyadic paraproduct b to be introduced in section 4 5 is not one of these and nor is its adjoint b the following estimates are known for dyadic shift operators of arbitrary complexity first michael lacey stefanie petermichl and mari carmen reguera proved the a 2 conjecture for the haar shift operators of arbitrary complexity with constant depending exponentially on the complexity lpetr unlike their predecessors they did not use bellman functions instead dyadic harmonic analysis and weighted inequalities 35 they used stopping time techniques and a two weight theorem for well localized operators of ntv 4 second david cruz uribe chema martell and carlos p rez crmpz 2 used a local median oscillation technique introduced by andrei lerner le 1 le 2 the local median oscillation method was quite flexible they obtained new results such as the sharp bounds for the square function for p 2 for the dyadic paraproduct also for vector valued maximal operators as well as two weight results however for the dyadic shift operators the weighted estimates still depended exponentially on the complexity third tuomas hyt nen hyt 2 obtained the linear estimates with polynomial dependence on the complexity needed to prove the a 2 conjecture for calder n zygmund singular integral operators 4 5 dyadic paraproduct quoting from an article on what is a paraproduct for the broader public by arpad b nyi diego maldonado and virginia naibo bmn the term paraproduct is nowadays used rather loosely in the literature to indicate a bilinear operator that although noncommutative is somehow better behaved than the usual product of functions paraproducts emerged in j m bony s theory of paradifferential operators bo which stands as a milestone on the road beyond pseudodifferential operators pioneered by r r coifman and y meyer in cm incidentally the greek word para translates as beyond in english and au d l de in french just as in the title of cm the defining properties of a paraproduct should therefore go beyond the desirable properties of the product the dyadic paraproduct associated to a dyadic grid d and to b bmod is an operator acting on square integrable functions f as follows bf x i d f i b hi hi x where f i 1 i i f x dx f 1 i i a function b is in the space of dyadic bounded mean oscillation bmod if and only if b bmod sup j d 1 j j b x b j 2 dx 1 2 notice that we are using an l 2 mean oscillation instead of the l 1 mean oscillation used in 2 2 in the definition of bmo and of course we are restricting to dyadic intervals as it turns out one could use an lp mean oscillation for any 1 p and obtain equivalent norms in bmo thanks to the celebrated john nirenberg lemma jn formally expanding f and b in the haar basis multiplying and separating the terms into upper triangular diagonal and lower triangular parts one gets that bf bf bf fb in doing so is important to note that i d i j f hi hi f j it is well known that multiplication by a function b is a bounded operator on lp r if and only if the function is essentially bounded that is b l r however the paraproduct is a bounded operator on lp r if and only if b bmod which is a space strictly larger than l r the l 2 estimate can be obtained using for example the carleson embedding lemma see section 5 1 using a weighted carleson embedding lemma one can check that the paraproduct is bounded on l 2 w for all w a 2 p 1 furthermore beznosova proved the a 2 conjecture for 36 m c pereyra paraproducts be 2 namely bf l 2 w c w a 2 b bmod f l 2 w by extrapolation one concludes that the paraproduct is bounded on lp w for all w ap and 1 p in particular it is bounded on lp r in section 5 we will present beznosova s bellman function argument proving the a 2 conjecture for the dyadic paraproduct this argument was generalized to rd in ch 3 and to spaces of homogeneous type in we it was pointed out to us recently wic that the paraproduct is a well localized operator for trivial reasons in the sense of ntv 4 and therefore it falls under their theory to finish this brief introduction to the paraproduct we would like to mention its intimate connection to the t 1 and t b theorems of guy david jean lin journ and stephen semmes das dajs these theorems give necessary and sufficient conditions to verify boundedness on l 2 r for singular integral operators t with a calder n zygmund kernel when fourier analysis almost orthogonality cotlar s lemma or other more standard techniques fail in the t 1 theorem the conditions amount to checking some weak boundedness property which is a necessary condition and checking that the function 1 is mapped under the operator and its adjoint t 1 and t 1 into bmo once this is verified the operator can be decomposed into a simpler operator s with the property that s 1 s 1 0 a paraproduct t 1 and the adjoint of a paraproduct t 1 the paraproduct terms are bounded on l 2 r the operator s can be verified to be bounded on l 2 r and as a consequence so will be the operator t we have defined all these model operators in the one dimensional case there are corre sponding haar shift operators and dyadic paraproducts defined on rd as well as t 1 and t b theorems 4 6 hyt nen s representation theorem let us remind the reader that a bounded oper ator on l 2 rd is a calder n zygmund singular integral operator with smoothness parameter 0 if it has an integral representation tf x rd k x y f y dy x supp f for a kernel k x y defined for all x y rd rd such that x 6 y and verifying the standard size and smoothness estimates respectively k x y c x y d and k x h y k x y k x y h k x y c h x y d for all x y 2 h 0 and some fixed 0 1 it is worth remembering that such calder n zygmund singular integral operators are bounded on lp rd for all 1 p they are of weak type 1 1 and they map bmo into itself we now have all the ingredients to state the celebrated hyt nen s representation theorem hyt 2 at least in the one dimensional case theorem 4 3 hyt nen s 2012 let t be a calder n zygmund singular integral operator with smoothness parameter 0 then t f e m n n 2 e m n 2 xr m n f r t 1 f r t 1 f dyadic harmonic analysis and weighted inequalities 37 where for each pair of random parameters r the operator xr m n is a haar shift operators of complexity m n the operator r t 1 is a dyadic paraproduct and the operator r t 1 is the adjoint of a dyadic paraproduct all defined on the random dyadic grid dr the paraproducts and their adjoints in the decomposition depend on the operator t via t 1 and t 1 the haar shift operators in the decomposition also depend on t although it is not obvious in the notation we used indeed the coefficients cli j in the definition of the haar shift multiplier of complexity m n see section 4 4 will depend on the given operator t for each l dr i dr m l and j dr n l notice that the exponential nature of the coefficients in the expansion explains why the haar shift multipliers of arbitrary complexity will need to be bounded with a bound depending at most polynomially on the complexity to the author this is a remarkable result providing a dyadic decomposition theorem for a large class of operators once you have such decomposition and l 2 w estimates for each of the components haar shift operators paraproducts and their adjoints that are linear on w a 2 and that are uniform on the dyadic grids then the a 2 conjecture is resolved in the positive as tuomas hyt nen did in his celebrated paper hyt 2 5 a 2 theorem for the dyadic paraproduct a bellman function proof as a model example we will present in this section beznosova s argument proving the a 2 conjecture for the dyadic paraproduct be 2 the goal is to show that for all weights w a 2 functions b bmod and functions f l 2 w the following estimate holds bf l 2 w w a 2 b bmod f l 2 w we remind the reader that the dyadic paraproduct associated to b bmod is defined by bf x i d f i bi hi x where bi b hi and f i 1 i i f y dy to achieve a preliminary estimate where instead of the linear bound on w a 2 we get a 3 2 bound namely w 3 2 a 2 we need to introduce a few ingredients weighted carleson sequences beznosova s little lemma and the weighted carleson lemma afterwards in section 5 4 we will refine the argument to get the desired linear bound to achieve the linear bound we will need a few additional ingredients including the lemma introduced by oleksandra beznosova in her original proof be 1 both the little lemma and the lemma are proved using bellman functions and we sketch their proofs as well as the proof of the weighted carleson lemma 5 1 weighted carleson sequences weighted carleson lemma and little lemma in this section we introduce weighted an unweighted carleson sequences and the weighted carleson embedding lemma we also present bezonosova s little lemma that enables us to ensure that given a weight w and a carleson sequence i i d we can create a w weighted carleson sequence by multiplying each term of the given sequence by the reciprocal of w 1 i 5 1 1 weighted carleson sequences and lemma given a weight w a positive sequence i i d is w carleson if there is a constant a 0 such that i d j i aw j for all j d where w j j w x dx the smallest constant a 0 is called the intensity of the sequence when w 1 a e we say that the sequence is carleson not 1 carleson 38 m c pereyra example 5 1 if b bmod then the sequence b 2 i i d is carleson with intensity b 2 bmod indeed for any j d the collection of haar functions corresponding to dyadic intervals i j hi i d j forms an orthonormal basis on l 20 j f l 2 j j f x dx 0 the function b b j j belongs to l 20 j therefore by plancherel s inequality i d j b 2 i i d j b hi 2 j b x b j 2 dx b 2 bmod j the following weighted carleson lemma that appeared in ntv 1 will be extremely useful in our estimates you can find a proof in mop that we reproduce in section 5 5 3 lemma 5 2 weighted carleson lemma given a weight v then i i d is a v carleson sequence with intensity a if and only if for all non negative f l 1 v we have i d i inf x i f x a r f x v x dx the following particular instance of the weighted carleson lemma will be useful example 5 3 let i i d be a v carleson sequence with intensity a let f l 2 v and set f x mdv f x 2 where mdv is the weighted dyadic maximal function namely mdv f x sup i d x i f vi where f vi f v i v i by definition of the dyadic maximal function f vi infx imdv f x then by the weighted carleson lemma lemma 5 2 and the boundedness of mdv on l 2 v with operator bound independent of the weight we conclude that i d i f vi 2 a mdv f 2 l 2 v a f 2 l 2 v specializing even further we get another useful result that establishes the boundedness of the dyadic paraproduct on l 2 r when b bmod example 5 4 in particular if v 1 and b bmod then i b 2 i for i d defines a carleson sequence with intensity b 2 bmod hence bf 2 l 2 i d bf hi 2 i d b 2 i f 2 i b 2 bmod f 2 l 2 5 1 2 beznosova s little lemma we will need to create w carleson sequences from given carleson sequences the following lemma will come in handy be 2 lemma 5 5 little lemma let w be a weight such that w 1 is also a weight let i i d be a carleson sequence with intensity a the sequence i w 1 i i d is w carleson with intensity 4 a in other words for all j d 5 1 i d j i w 1 i 4 a w j the proof uses a bellman function argument that we will present in section 5 5 note that the weight w in the little lemma is not required to be in the muckenhoupt a 2 class it does require that the reciprocal w 1 is a weight of course if w a 2 then w 1 is a weight in a 2 dyadic harmonic analysis and weighted inequalities 39 example 5 6 let b bmod and w a 2 the sequence b 2 i w i i d is a w 1 carleson with intensity 4 b 2 bmod by example 5 1 the sequence b 2 i i d is a carleson sequence with intensity b 2 bmod and then applying lemma 5 5 with the roles of w and w 1 interchanged we get the stated result 5 2 the 3 2 bound for the paraproduct on weighted l 2 we now show that the para product b is bounded on l 2 w when w a 2 and b bmod with bound w 3 2 a 2 b bmod not yet the optimal linear bound proof by duality suffices to show that for all f l 2 w and g l 2 w 1 bf g w 3 2 a 2 b bmod f l 2 w g l 2 w 1 by definition of the dyadic paraproduct and the triangle inequality bf g i d f i bi g hi first using the cauchy schwarz inequality we can estimate as follows bf g i d f 2 i b 2 i w 1 i 1 2 i d g hi 2 w 1 i 1 2 second using the fact that sdg 2 l 2 w 1 i d g hi 2 w 1 i and the linear bound on l 2 v for the square function for v w 1 a 2 with w 1 a 2 w a 2 we further estimate by bf g i d f ww 1 i w 1 i 2 b 2 i w i w i w 1 i 1 2 sdg l 2 w 1 w 1 2 a 2 i d f w w 1 i 2 b 2 i w i 1 2 w a 2 g l 2 w 1 third using the weighted carleson lemma lemma 5 2 for the w 1 carleson sequence b 2 i w i i dwith intensity 4 b 2 bmod see example 5 6 together with the fact that f l 2 w fw l 2 w 1 we get that bf g w 3 2 a 2 2 b bmod m d w 1 fw l 2 w 1 g l 2 w 1 w 3 2 a 2 b bmod f l 2 w g l 2 w 1 where in the last line we used the boundedness of the dyadic weighted maximal function mdv on l 2 v with an operator norm independent of the weight v this implies that bf l 2 w w 3 2 a 2 b bmod f l 2 w this is precisely what we set out to prove 5 3 algebra of carleson sequences lemma and weighted haar bases to get a linear bound instead of the 3 2 power bound we just obtained we will need a couple more ingredients some algebra with carleson sequences the lemma and weighted haar bases 40 m c pereyra 5 3 1 algebra of carleson sequences given weighted carleson sequences we can create new weighted carleson sequences by linear operations or by taking geometric means lemma 5 7 algebra of carleson sequences given a weight v let i i d and i i d be two v carleson sequences with intensities a and b respectively then for any c d 0 i the sequence c i d i i d is a v carleson sequence with intensity at most ca db ii the sequence i i i d is a v carleson sequence with intensity at most ab the proof is a simple exercise which we leave to the interested reader we do need some specific carleson sequences and we record them in the next example example 5 8 let u v a and iv v i v i then i the sequence iv v i 2 i i d is a carleson sequence with intensity c log w a ii let i iv v i iu u i i the sequence i i d is a carleson sequence iii when v a 2 u v 1 also in a 2 the sequence i i d defined in item ii has intensity at most log v a 2 example 5 8 i was discovered by robert fefferman carlos kenig 13 and jill pipher 14 in 1991 see fkp the sharp constant c 8 was obtained by vasily vasyunin using the bellman function method va in fact this example provides a characterization of a by summation conditions for many more such characterizations for other weight classes see bu 2 bere example 5 8 ii iii follow from example 5 8 i and from lemma 5 7 ii 5 3 2 the lemma the key to dropping from power 3 2 to linear power in the weighted l 2 estimate for the paraproduct is the following lemma discovered by beznosova like the little lemma in the course of writing her phd dissertation be 1 see also be 2 mop both lemmas were proved using bellman functions and we will sketch the arguments in section 5 5 lemma 5 9 lemma if w a 2 and 0 then the sequence i w i w 1 i i iw 2 w 2 i iw 1 2 w 1 2 i i d is a carleson sequence with intensity at most c w a 2 and c max 72 2 2 576 notice that the algebra of carleson sequences encoded in lemma 5 7 together with the r fefferman kenig pipher example 5 8 iii give for i an intensity of w a 2 log w a 2 which is larger by a logarithmic factor than the one claimed in the lemma this lesser estimate will improve the 3 2 estimate to a linear times logarithmic estimate be 1 the stronger lemma will yield the desired linear estimate example 5 10 let w a 2 and b bmod by the lemma and the algebra of carleson sequences we conclude that i i iw 2 w 1 2 i i i d is carleson with intensity c 1 4 w 2 a 2 c 1 4 576 ii bi i i d is carleson with intensity 24 w a 2 b bmod 13 carlos kenig an argentinian mathematician was elected president of the international mathematical union in july 2018 in the international congress of mathematicians icm held in brazil and for the first time in the southern hemisphere 14 jill pipher is the president elect of the american mathematical society ams and will begin a two year term in 2019 dyadic harmonic analysis and weighted inequalities 41 5 3 3 weighted haar basis the last ingredient before we present the proof of the a 2 conjec ture for the dyadic paraproduct is the weighted haar basis given a doubling weight w and an interval i the weighted haar function hwi is given by hwi x w i w i w i 1 i x w i w i w i 1 i x the collection hwi i d of weighted haar functions indexed on d a system of dyadic intervals is an orthonormal system of l 2 w in fact the weighted haar functions are the haar functions corresponding to the space of homogeneous type x r with the euclidean metric the doubling measure d w dx and the dyadic structure d defined in section 3 5 3 there is a very simple formula relating the weighted haar function and the regular haar function more precisely given i d there exist numbers wi wi such that hi x w i h w i x w i 1 i x i the coefficients can be calculated precisely and they have the following upper bounds i wi w i ii wi iw w i where iw w i w i 5 4 a 2 conjecture for the dyadic paraproduct we present a proof of beznosova s the orem namely for all b bmod w a 2 and f l 2 w bf l 2 w b bmod w a 2 f l 2 w the proof uses the same ingredients introduced by oleksandra beznosova be 2 and a beautiful argument by fedja nazarov sasha reznikov and sasha volberg that yields polyno mial in the complexity bounds for haar shift operators on geometric doubling metric spaces nrv an extension of their result to paraproducts with arbitrary complexity can be found in joint work with jean moraes mop proof suffices by duality to prove that bf g c b bmod w a 2 f l 2 w g l 2 w 1 we introduce weighted haar functions to obtain two terms to be estimated separately bf g i d bi f ww 1 i gw 1 w hi 1 2 explicitly the sums 1 and 2 are obtained replacing hi wi h w i w i 1 i i and using the estimates on the coefficients i i to get 1 i d bi f ww 1 i gw 1 w hwi w i 2 i d bi f ww 1 i g w 1 w i iw w i i first sum 1 denote the l 2 w pairing h k l 2 w hw k to estimate the first sum we observe that the weighted average with respect to the weight w 1 of the function f w over a dyadic interval is bounded by the corresponding dyadic weighted maximal function evaluated at any point on the interval hence by the infimum over the interval more precisely 42 m c pereyra f ww 1 i w 1 i infx imdw 1 fw x then using the definition of a 2 and the cauchy schwarz inequality we get 1 i d bi w i f ww 1 i w 1 i gw 1 hwi l 2 w w i w 1 i w a 2 i d bi w i inf x i mdw 1 fw x gw 1 hwi l 2 w w a 2 i d bi 2 w i inf x i mdw 1 fw x 2 1 2 i d gw 1 hwi l 2 w 2 1 2 using the weighted carleson lemma lemma 5 2 with f x md w 1 fw x 2 with weight v w 1 a 2 recalling w a 2 w 1 a 2 and with w 1 carleson sequence b 2 i w i i d with intensity 4 b 2 bmod by the little lemma lemma 5 1 we get that 1 2 w a 2 b bmod r mdw 1 fw x 2 w 1 x dx 1 2 gw 1 l 2 w 4 w a 2 b bmod f l 2 w g l 2 w 1 where we used in the last inequality the estimate 3 1 for the weighted dyadic maximal function and noting that h l 2 w if and only if hw l 2 w 1 moreover hw l 2 w 1 h l 2 w we used this twice for h f and for h gw 1 second sum 2 using similar arguments to those used for 1 we get 2 i d bi f ww 1 w 1 i g w 1 w i w i iw 2 w 1 2 i i i d bi i inf x i mdw 1 fw x m d w gw 1 x where bi 2 and i iw 2 w 1 2 i i are carleson sequences with intensities b 2 bmod and w 2 a 2 respectively by example 5 1 and example 5 10 i then by the algebra of carleson sequences the sequence bi i is a carleson sequence with intensity b bmod w a 2 using the weighted carleson lemma lemma 5 2 with f x md w 1 fw x mdw gw 1 x and with v 1 we conclude that 2 w a 2 b bmod r mdw 1 fw x m d w gw 1 x dx to finish we use the cauchy schwarz inequality the fact that w 1 2 x w 1 2 x 1 and esti mate 3 1 for the weighted dyadic maximal functions to get that 2 w a 2 b bmod r mdw 1 fw x 2 w 1 x dx 1 2 r mdw gw 1 x 2 w x dx 1 2 w a 2 b bmod m d w 1 fw l 2 w 1 m d w gw 1 l 2 w 4 w a 2 b bmod f l 2 w g l 2 w 1 dyadic harmonic analysis and weighted inequalities 43 all together this implies that bf l 2 w 8 w a 2 b bmod f l 2 w proving the a 2 conjec ture for the dyadic paraproduct 5 5 auxiliary lemmas we now present the bellman function proofs or at least the main ideas for the little lemma lemma 5 5 and the lemma lemma 5 9 to illustrate the method in a very simple setting for completeness we also present the proof of the weighted carleson lemma lemma 5 2 the lemmas in this section hold on rd and also on geometri cally doubling metric spaces ch 3 nrv 5 5 1 proof of beznosova s little lemma we wish to prove lemma 5 5 the proof uses a bellman function argument which we now describe as usual the argument proceeds in two steps first lemma 5 11 encodes what now is called an induction on scales argument if we can find a bellman function with certain properties then we will solve our problem by induction on scales this type of arguments shows that if we can find a function with certain size domain and dyadic convexity properties tailored to the inequality of interest we will be able to induct on scales and obtain the desired inequality second lemma 5 12 will show that such bellman function exists lemma 5 11 beznosova 2008 suppose there exists a real valued function of 3 variables b x b u v l whose domain d contains points x u v l d u v l r 3 u v 0 uv 1 and 0 l 1 whose range is given by 0 b x u and such that the following convexity property holds 5 2 b x b x b x 2 4 v for all x x d with x x x 2 0 0 then lemma 5 5 will be proven more precisely 5 1 holds proof without loss of generality we may assume that the intensity a of the carleson sequence i i d in lemma 5 5 is one a 1 fix a dyadic interval j let uj w j vj w 1 j and j 1 j i d j i then xj uj vj j d recall that d j denotes the intervals i d such that i j let x xj d then xj xj xj 2 0 0 j where j j j hence by the size and convexity property 5 2 and j j j 2 j w j j b xj j b xj j b xj j 4 w 1 j repeat the argument this time for j b xj and j b xj use that b 0 on d and keep repeating to get after dividing by j that w j 1 4 j i d j i w 1 i which implies 5 1 after multiplying through by 4 j the lemma is proved the previous induction on scales argument is conditioned on the existence of a function with certain properties a bellman function we now establish the existence of such function both lemmas appeared in be 2 44 m c pereyra lemma 5 12 beznosova 2008 the function b u v l u 1 v 1 l is i defined on the domain d introduced in lemma 5 11 ii 0 b x u for all x u v l d and iii obeys the following differential estimates on d b l u v l 1 4 v and du dv dl d 2 b u v l du dv dl t 0 where d 2 b u v l denotes the hessian matrix of the function b evaluated at u v l more over these imply the dyadic convexity condition b x b x b x 2 4 v proof differential conditions can be checked by a direct calculation that we leave as an exercise for the reader by the mean value theorem and some calculus b x b x b x 2 b l u v l 1 2 1 1 1 t b t dt 4 v where b t b x t and x t 1 t 2 x 1 t 2 x for 1 t 1 note that x t d whenever x and x are in the domain since d is a convex domain and x t is a point on the line segment between x and x and l is a point between l and l l 2 this proves the lemma these two lemmas prove beznosova s little lemma lemma 5 5 5 5 2 lemma we present a very brief sketch of the argument leading to the proof of the lemma lemma 5 9 see be 2 for 0 1 2 and mop for 1 2 recall that we wish to show that if w a 2 and 0 then the sequence i w i w 1 i i iw 2 w 2 i iw 1 2 w 1 2 i for i d is a carleson sequence with intensity at most c w a 2 and c max 72 2 2 576 sketch of the proof use the bellman function method figure out the domain range and dyadic convexity conditions needed to run an induction on scale argument that will yield the inequality verify that the bellman function b u v uv satisfies those conditions or at least a differential version that can then be seen implies the dyadic convexity for 0 1 2 for 1 2 just observe that one can factor out w 1 4 i w 1 1 4 i w 1 4 a 2 and then use the already proven lemma when 1 4 1 2 5 5 3 weighted carleson lemma finally we present a proof of the weighted carleson lemma lemma 5 2 that states that if v is a weight l l d a v carleson sequence with intensity a and f a positive measurable function on r then l d l inf x l f x a r f x v x dx the weighted carleson lemma we present here is a variation in the spirit of other weighted carleson embedding theorems that appeared before in the literature ntv 1 the converse is immediately true by choosing f x 1 j x dyadic harmonic analysis and weighted inequalities 45 proof assume that f l 1 v otherwise the first statement is automatically true setting l inf x l f x we can write 5 3 l d l l l d l 0 l t dt 0 l d l t l dt where l t 1 for t l and zero otherwise and where we used the monotone convergence theorem in the last equality define the level set et x r f x t since f l 1 v then et is a v measurable set for every t and we have by chebychev s inequality that the v measure of et is finite for all t 0 moreover there is a collection of maximal disjoint dyadic intervals pt that will cover et except for at most a set of v measure zero finally observe that l et if and only if l t 1 all together we can rewrite the integrand in the right hand side of 5 3 as l d l t l l et l l pt i d l i a l pt v l av et where we used in the second inequality the fact that j i d is a v carleson sequence with intensity a thus we can estimate l d l inf x l f x l d l l a 0 v et dt a r f x v x dx where the last equality follows from the layer cake representation 6 case study commutator of hilbert transform and function in bmo in this section we summarize chronologically the weighted norm inequalities known for the commutator b t where t is a linear operator and b a function in bmo in particular we will consider t h the hilbert transform we sketch a dyadic proof of the first quantitative weighted estimate for the commutator b h due to daewon chung ch 2 yielding the opti mal quadratic dependence on the a 2 characteristic of the weight we discuss a very useful transference theorem of chung p rez and the author chppz and present its proof based on the celebrated coifman rochberg weiss argument the transference theorem allows to deduce quantitative weighted lp estimates for the commutator of a linear operator with a bmo function from given quantitative weighted lp estimates for the operator 6 1 lp theory for b h recall that the commutator of a function b bmo and h the hilbert transform is defined to be b h f b hf h bf the commutator b h is bounded on lp r for 1 p if and only if b bmo corw moreover the following estimate is known to hold for all b bmo and f lp r b h f lp p b bmo f lp in fact the operator norm b h l 2 l 2 b bmo observe that bh and hb are not neces sarily bounded on lp r when b bmo the commutator introduces some key cancellation this is very much connected to the celebrated h 1 bmo duality theorem by feffferman and stein fs where the hardy space h 1 can be defined as those functions f in l 1 r such that their maximal function mf is also in l 1 r 46 m c pereyra the commutator b h is more singular than h as evidenced by the fact that unlike the hilbert transform the commutator is not of weak type 1 1 pz 1 in particular the commutator is not a calder n zygmund operator if it were it would be of weak type 1 1 and is not 6 2 weighted inequalities the first two weight results for the commutator that we present are of a qualitative nature the first one is a two weight result due to steven bloom for the commutator of the hilbert transform with a function in weighted bmo when both weights are in ap bl theorem 6 1 bloom 1985 if u v ap then b h lp u lp v is bounded if and only if b bmo where u 1 pv 1 p where b bmo if and only if 6 1 b bmo sup i r 1 i i b x b i dx what is important in this setting is that the hypothesis u v ap imply that a 2 as can be seen by a direct calculation using h lder s inequality the weighted bmo space defined by 6 1 was first introduced by eric sawyer and richard wheeden sw and it has been called in the literature somewhat misleadingly bloom bmo for a modern dyadic proof of bloom s result see holw 1 holw 2 the second result is a one weight result for very general linear operators t obtained by josefina lvarez richard bagby doug kurtz and carlos p rez abkpz they also prove two weight estimates theorem 6 2 lvarez bagby kurtz p rez 1993 let t be a linear operator on the set of real valued lebesgue measurable functions defined on rd with a domain of definition which contains every compactly supported function in a fixed lp space if w ap and b bmo then there is a constant cp w 0 such that for all f lp w the following inequality holds b t f lp w cp w b bmo f lp w the proof uses a classical argument by raphy coifman 15 richard rochberg and guido weiss corw in section 6 4 2 we will present a quantitative version of this argument chppz for a proof of bloom s result using this type of argument see hyt 5 the next result is a quantitative weighted inequality obtained by daewon chung in his phd dissertation ch 1 ch 2 theorem 6 3 chung 2010 for all b bmo w a 2 and f l 2 w the following holds b h f l 2 w b bmo w 2 a 2 f l 2 w the quadratic power on the a 2 characteristic and the linear bound on the bmo norm are both optimal powers the quadratic dependence on the a 2 characteristic is another indication that this operator is more singular than the calder n zygmund singular integral operators for whom the dependence is linear hyt 2 as we have emphasized throughout these lectures 15 as i am writing these notes it has been announced that coifman won the 2018 schock prize in mathe matics for his fundamental contributions to pure and applied harmonic analysis dyadic harmonic analysis and weighted inequalities 47 6 3 dyadic proof of chung s theorem we now sketch chung s dyadic proof of the quadratic estimate for the commutator ch 2 sketch of proof chung s dyadic proof is based on using petermichl s dyadic shift operators xr instead of h pet 1 and proving uniform on the dyadic grids dr quadratic estimates for the corresponding commutators xr b to ease notation we drop the superscripts r and simply write x for xr the estimates will be independent of the parameters r and to achieve this we first recall the decomposition of a product bf in terms of paraproducts and their adjoints bf bf bf fb notice that the first two terms are bounded on lp w when b bmo and w ap the enemy is the third term decomposing the commutator accordingly we get 6 2 b x f b x f b x f xf b x fb known linear bounds on l 2 w for the dyadic paraproduct b its adjoint b and for pe termichl s dyadic shift operator x see be 2 pet 2 immediately give by iteration quadratic bounds for the first two terms on the right hand side of 6 2 surprisingly the third term is better it obeys a linear bound and so do halves of the first two commutators as shown in ch 2 using bellman function techniques namely xf b x fb l 2 w x b f l 2 w bx f l 2 w c b bmo w a 2 f l 2 w all together providing uniform on the random dyadic grids dr quadratic bounds for the commutators b xr and hence averaging over the random grids we get the desired qua dratic estimate for b h the quadratic estimate and the corresponding extrapolated estimates namely for all b bmo w ap and f lp w 6 3 b h f lp w p w 2 max 1 1 p 1 ap b bmo f lp w are optimal for all 1 p as can be seen considering appropriate power functions and power weights chppz the bad guys are the non local terms bx x b a posteriori one realizes the pieces that obey linear bounds are generalized haar shift operators and hence their linear bounds can be deduced from general results for those operators as a byproduct of chung s dyadic proof we get that the extrapolated bounds for the dyadic paraproduct are optimal p 2 namely for all b bmo w ap and f lp w bf lp w p w max 1 1 p 1 ap b bmo f lp w proof by contradiction if not for some p then b h will have a better bound in lp w than the known optimal bound given by 6 3 for that p 6 4 a quantitative transference theorem the following theorem provides a mechanism for transferring known quantitative weighted estimates for linear operators to their commu tators with bmo functions chppz p 2 48 m c pereyra theorem 6 4 chung pereyra p rez 2012 given linear operator t and 1 r such that for all w ar and f lr w the following estimate holds tf lr w t d w ar f lr w then the commutator of t with b bmo is such that for all w ar and f lr w b t f lr w r t d w max 1 1 r 1 ar b bmo f lr w the proof follows the classical coifman rochberg weiss argument using i the cauchy integral formula ii the following quantitative coifman fefferman result w ar implies w rhq with q 1 cd w ar and w rhq 2 iii a quantitative version of the estimate b bmo implies e b ar for small enough with control on e b ar we will present the whole argument in the case r 2 in section 6 4 2 here the reverse h lder q weight class rhq for 1 q is defined to be all those weights w such that w rhq sup q wq 1 qq w 1 q where the supremum is taken over all cubes in rd with sides parallel to the axes a variation on the argument yields corresponding estimates for the higher order commu tators t kb b t k 1 b for k 1 and t 0 b t more precisely given the initial estimate t 0 b f lr w w ar valid for all w ar then the following estimate holds for all k 1 b bmo w ar and f lr w t kb f lr w r t d w kmax 1 1 r 1 ar b kbmo f lr w transference theorems for commutators are useless unless there are operators known to obey an initial lr w bound valid for all w ar we have already mentioned that the class of calder n zygmund singular integral operators obey linear bounds on l 2 w thanks to hyt nen s a 2 theorem hyt 2 we conclude that for all calder n zygmund singular integral operators t their commutators obey a quadratic bound on l 2 w more precisely b t f l 2 w t d w 2 a 2 b bmo f l 2 w with a slight modification of the argument one can see chppz that the correct estimate for the iterated commutators of calder n zygmund singular integral operators and function b bmo is t kb f l 2 w t d w 1 ka 2 b k bmo f l 2 w there are operators for example the hilbert riesz and beurling transforms for whom these estimates are optimal in terms of the powers both for the a 2 characteristic and the bmo norm this can be seen testing power functions and weights chppz 6 4 1 some generalizations there are extensions to commutators with fractional integral operators two weight problem and more crmoe cr there are mixed a 2 a estimates where recall thata p 1 ap and w a w a 2 hytpz orpzre more precisely estimates of the form b t l 2 w w 1 2 a 2 w a w 1 a 3 2 b bmo there are generalizations to commutators of matrix valued operators and bmo ikp as well as to the two weight setting both weights in ap la bloom holw 1 holw 2 and also for biparameter journ operators hopetw see also the comprehensive paper bmmst dyadic harmonic analysis and weighted inequalities 49 where a systematic use of the coifman rochberg weiss trick recovers all known results and some new ones such as boundedness of the commutator of the bilinear hilbert transform and a function in bmo pointwise control by sparse operators adapted to the commutator improving weak type orlicz bounds and quantitative two weight bloom bounds was recently obtained leor 1 leor 2 we will say more about this generalization in section 7 6 4 2 proof of the transference theorem we now present the proof of the quantitative trans ference theorem when r 2 following the lines of the coifman rochberg weiss argument corw with a few quantitative ingredients for r 6 2 see p 2 proof in chppz conjugate the operator as follows for any z c define tz f e zb t e zbf a computation together with the cauchy integral theorem give for nice functions b t f d dz tz f z 0 1 2 i z tz f z 2 dz 0 now by minkowski s integral inequality b t f l 2 w 1 2 2 z tz f l 2 w dz 0 the key point is to find an appropriate radius 0 to that effect we look at the inner norm and try to find bounds depending on z more precisely tz f l 2 w t e zbf l 2 w e 2 rez b we use the main hypothesis namely that t is bounded on l 2 v if v a 2 with t l 2 v c v a 2 for v w e 2 rez b we must check that if w a 2 then v a 2 for z small enough indeed v a 2 sup q 1 q q w x e 2 rez b x dx 1 q q w 1 x e 2 rez b x dx it is well known that if w a 2 then w rhq for some q 1 cofe there is a quantitative version of this result pz 2 namely if q 1 1 2 d 5 w a 2 then 1 q q wq x dx 1 q 2 q q w x dx similarly for w 1 a 2 and for the same q since w a 2 w 1 a 2 we have that 1 q q w q x dx 1 q 2 q q w 1 x dx in what follows q 1 1 2 d 5 w a 2 using these estimates and holder s inequality we have for an arbitrary cube q 1 q q w x e 2 rez b x dx 1 q q w x 1 e 2 rez b x dx 1 q q wq x dx 1 q 1 q q e 2 rezq b x dx 1 q 1 q q w q x dx 1 q 1 q q e 2 rezq b x dx 1 q 50 m c pereyra 4 1 q q w x dx 1 q q w 1 x dx 1 q q e 2 rez q b x dx 1 q 1 q q e 2 rez q b x dx 1 q 4 w a 2 e 2 rez q b 1 q a 2 taking the supremum over all cubes we conclude that v a 2 w e 2 rez b a 2 4 w a 2 e 2 rez q b 1 q a 2 now since b bmo there are 0 d 1 and d 1 such that if 2 rez q d b bmo then e 2 rez q b a 2 d see chppz lemma 2 2 hence for these z v a 2 4 w a 2 1 q d 4 w a 2 d we have shown that if z d 2 q b bmo then v a 2 4 w a 2 d and tz f l 2 w t e zbf l 2 v v a 2 f l 2 w 4 w a 2 d f l 2 w where the first inequality holds since e zbf l 2 v e zbf l 2 we 2 rez b f l 2 w thus choose the radius d 2 q b bmo and get b t f l 2 w 1 2 2 z tz f l 2 w dz 1 2 2 z 4 w a 2 d f l 2 w dz 1 4 w a 2 d f l 2 w note that 1 w a 2 b bmo because q 1 2 d 5 w a 2 2 d w a 2 b t f l 2 w cd w 2 a 2 b bmo which is exactly what we wanted to prove 7 sparse operators and sparse families of dyadic cubes in this section we discuss the sparse domination by finitely many positive dyadic operators paradigm that has recently emerged as a byproduct of the study of weighted inequalities this sparse domination paradigm has proven to be very powerful with applications in areas other than weighted norm inequalities in this section we introduce the sparse operators and the sparse families of cubes we discuss a characterization of sparse families of cubes via carleson families of dyadic cubes due to andrei lerner and fedja nazarov however this was well known 20 years earlier by igor verbitsky ve corollary 2 p 23 see also ha we present the beautiful proof of the a 2 conjecture for sparse operators due to david cruz uribe chema martell and carlos p rez we record the sparse domination results for the operators discussed in these notes we present how to dominate pointwise the martingale transform by a sparse operator following michael lacey s argument illustrating the technique in a toy model finally we briefly discuss a sparse domination theorem for commutators valid for rough calder n zygmund singular integral operators due to andrei lerner sheldy ombrosi and israel rivera r os that yields new quantitative two weight estimates of bloom type and recovers all known weighted results for the commutators dyadic harmonic analysis and weighted inequalities 51 7 1 sparse operators david cruz uribe chema martell and carlos p rez showed in crmpz 2 the a 2 conjecture in a few lines for sparse operators as defined as follows asf x q s f q 1 q x here s is a sparse collection of dyadic cubes a collection of dyadic cubes s in rd is sparse 0 1 if there are pairwise disjoint measurable sets eq for each q s such that eq q with eq q for all q s a primary example for us are the calder n zygmund singular integral operators they and the rough calder n zygmund operators have been shown to be pointwise dominated by a finite number of sparse operators le 4 cr len l 3 a quantitative form of these estimates can be found in le 6 hytrota more recently see sparse domination principles for rough calder n zygmund singular integral operators cudipou 1 ccudipou hytrota diphytli 7 2 sparse vs carleson families of dyadic cubes we have seen in section 4 how car leson sequences and carleson embedding lemmas come handy when proving weighted inequal ities there is an intimate connection between carleson families of cubes and sparse families of cubes a family of dyadic cubes s in rd is called carleson for 1 if p s p q p q q d notice that a family of cubes being carleson is equivalent to the sequence p 1 s p p d being carleson with intensity furthermore the notion is equivalent to the family of cubes being 1 sparse these type of conditions are also called carleson packing conditions lemma 7 1 verbitsky 1996 lerner nazarov 2014 let 1 the family of dyadic cubes s in rd is carleson if and only if s is 1 sparse proof we sketch the beautiful argument in len the family of cubes sbeing 1 sparse means that for all cubes p s there are pairwise disjoint subsets ep p that have a considerable portion of the total mass of the cube more precisely ep p hence p s p q p p s p q ep q where the last inequality holds because the sets ep q and are pairwise disjoint therefore the family of cubes s is carleson assume now that s is a carleson family we say that a family s has a bottom layer dk if for all q swe have q dk for some k k assume s has a bottom layer dk then consider all cubes in the bottom layer q s dk and choose any sets eq q with eq 1 q this choice is always possible because of the nature of the lebesgue measure and the sets will automatically be pairwise disjoint because the cubes in a fixed generation dk are pairwise disjoint then go up layer by layer meaning we have already selected sets er r for all r s dj and k j k with the property that er 1 r then for each 52 m c pereyra q dk k k choose any eq q r s r qer with eq 1 q such choice is always possible because for every q swe have r s r q er 1 r s r q r 1 q 1 1 q where we used in the inequality the hypothesis that s is a carleson family therefore q r s r qer 1 q hence there is enough mass left in q after removing the sets er corresponding to r in s and proper subcubes of q to select a subset eq of q with the aformentioned property moreover by construction the sets eq are pairwise disjoint and we are done but what if there is no bottom layer the idea is to run the construction for each k 0 and pass to the limit one has to be a bit careful as lerner and nazarov put it all we have to do is replace free choice with canonical choice the diligent reader can find the details of the argument including a very illuminating picture in len lemma 6 3 and figure 8 7 3 a 2 theorem for sparse operators we now present david cruz uribe chema martell and carlos p rez s beautiful proof of the a 2 conjecture for sparse operators crmpz 2 theorem 7 2 cruz uribe martell p rez 2012 let s be an sparse family of cubes then forall w a 2 and f l 2 w the following inequality holds 7 1 asf l 2 w w a 2 f l 2 w proof for w a 2 s and sparse family with 0 1 showing 7 1 is equivalent by duality to showing that for all f l 2 w g l 2 w 1 asf g w a 2 f l 2 w g l 2 w 1 by the cauchy schwarz inequality eq eq w 1 2 w 1 2 w eq 1 2 w 1 eq 1 2 using the definition of the sparse operator some algebra and the definition of an sparse family of cubes namely q 1 eq we get that asf g q s f q g q q 1 q s f ww 1 q w 1 q g w 1 w q w q w q w 1 q eq w a 2 q s f ww 1 q w 1 q w 1 eq 1 2 g w 1 w q w q w eq 1 2 using once more the cauchy schwarz inequality and the fact that for all x eq q it holds that h v q v q mdv h x therefore h v q v q 2 v eq eq mdv h x 2 v x dx we conclude that asf g w a 2 q s f ww 1 2 q w 1 2 q w 1 eq 1 2 q s g w 1 w 2 q w 2 q w eq 1 2 dyadic harmonic analysis and weighted inequalities 53 w a 2 q s eq mdw 1 fw x 2 w 1 x dx 1 2 q s eq mdw gw 1 x 2 w x dx 1 2 w a 2 mdw 1 fw l 2 w 1 m d w gw 1 l 2 w w a 2 fw l 2 w 1 gw 1 l 2 w w a 2 f l 2 w g l 2 w 1 where in the line before the last we used the fact that the sets eq for q s are pairwise disjoint and in the last line we used estimate 3 1 for the weighted dyadic maximal functions similar argument yields linear bounds on lp w for p 2 and by duality sparse operators are self adjoint we get bounds like w 1 p 1 ap w 1 p 1 ap when 1 p 2 see moe in other words we can get directly the same lp w bounds that sharp extrapolation will give if we were to extrapolate from the linear l 2 w bounds namely for all w ap and f lp w 7 2 asf lp w w max 1 1 p 1 ap f lp w 7 4 domination by sparse operators many operators can be dominated by finitely many sparse operators pointwise in norm or by forms the collections s si are sparse families tailored to the operator and the particular function f the operator is acting on identifying these sparse families is where most of the work lies usually done using some sort of weak 1 1 inequality that is available a priori or a specific stopping time designed for the problem at hand we will illustrate this process for the martingale transform in section 7 5 here is the status in terms of sparse domination of the operators we have been discussing in these lecture notes in particular quantitative weighted estimates for corresponding sparse operators such as 7 2 immediately transfer to the dominated operators providing new and streamlined proofs of the quantitative weighted inequalities we have been focusing on previous sections the martingale transforms and the dyadic paraproduct are locally pointwise dominated by sparse operators l 3 more precisely given a cube q 0 and f l 1 r there are sparse families s s such that 1 q 0 t f 1 q 0 as f 1 q 0 b f 1 q 0 as f we will say more about the martinagale transform in section 7 5 calder n zygmund operators are pointwise dominated by finitely many sparse operators cr le 6 len more precisely given t and f there are finitely many sparse families si for i 1 nd such that tf nd i 1 asif the dyadic square function is pointwise dominated by finitely many sparse like operators lli 2 more precisely given f there are finitely many sparse families si for i 1 nd such that sdf 2 nd i 1 q si f 2 q 1 q notice that the sparse like operators have been adapted to the square function 54 m c pereyra commutator b t for t an calder n zygmund operator with satisfying a dini condi tion b l 1 loc r can be pointwise dominated by finitely many sparse like operators and their adjoints leor 1 leor 2 we will say more about this in section 7 6 the finitely many sparse families come from the analogue of the one third trick for the dyadic grids usually nd 3 d will suffice 7 5 domination of martingale transform d apr s lacey we would like to illustrate how to achieve domination by sparse operators for a toy model operator the martingale transform t on l 2 r following an argument of michael lacey l 3 section 3 given interval i 0 d and function f l 1 r supported on i 0 we need to find a 1 2 sparse family s d such that for all choices of signs there is a constant c 0 such that 1 i 0 t f cas f proof without loss of generality we can assume that f l 1 r is not only supported on i 0 but also i 0 f x dx 0 we will need the following well known weak type estimates first the sharp truncation t is of weak type 1 1 bur 1 with a constant independent of the choice of signs thus sup 0 x r t f x c f l 1 r where t f supi d i d i i i f hi hi second the maximal function m is also of weak type 1 1 therefore sup 0 x r mf x c f l 1 r as a consequence there exists a constant c 0 0 such that the subset of i 0 defined by fi 0 x i 0 max mf x t f x 12 c 0 f i 0 has no more than half the mass of i 0 that is fi 0 12 i 0 in fact suppose no such constant would exist then for all c 0 0 it would hold that fi 0 x i 0 max mf x t f x 12 c 0 f i 0 12 i 0 therefore for each c 0 0 it must be that either x i 0 mf x 12 c 0 f i 0 1 4 i 0 or x i 0 t f x 12 c 0 f i 0 1 4 i 0 but either of these sets has measure bounded above by 2 c f l 1 r c 0 f i 0 choosing c 0 large enough so that 2 c f l 1 r c 0 i 0 f y dy 1 4 a contradiction will be reached it sems as if the constant c 0 depends on the interval i 0 however once we recall that the function f is supported on i 0 then all is required is that 2 c c 0 1 4 let ei 0 be the collection of maximal dyadic intervals i d contained in the set fi 0 then we claim that 7 3 t f x 1 i 0 x c 0 f i 0 i ei 0 t i f x where t i f i f i 1 i j j i j f hj hj and i is the parent of i repeat for each i ei 0 and the function t i f which is supported on i then repeat for each i ei etc let s 0 i 0 and sj i sj 1 ei finally let s j 0 sj for each dyadic harmonic analysis and weighted inequalities 55 i s let ei i fi by construction the sets ei i are pairwise disjoint and ei 12 i therefore s is a 1 2 sparse family moreover 1 i 0 t f c 0 as f which is what we set out to prove we are done modulo verifying the claimed inequality 7 3 which we now prove note that t f x 2 t f x thus if x i 0 fi 0 then t f x c 0 f i 0 and 7 3 is satisfied if x fi 0 then there is unique i s 1 ei 0 with x i and recalling that f hi hi x f i f i we conclude that t f x j i j f hj hj x j i j f hj hj x j i j f hj hj x i f i t i f x therefore we find that when x fi 0 and for all y i the following inequality holds 7 4 t f x t f y mf y i ei 0 t i f x in particular because i is a maximal dyadic interval in fi 0 there must be y 0 i i such that y 0 fi 0 and therefore t f y 0 mf y 0 12 c 0 f i 0 substituting y y 0 in 7 4 and using this estimate proves the claimed inequality 7 3 and therefore the pointwise localized domination by sparse operators for the martingale transform is proven 7 6 case study sparse operators vs commutators carlos p rez and israel rivera r os proposed the following l logl sparse operator as a candidate for sparse domination of the commutator bsf x q s f l logl q 1 q x the reason for this choice is that m 2 ml logl is the correct maximal function for the com mutator however they showed that these operators cannot bound pointwise the commutator b t in pzr andrei lerner sheldy ombrosi and israel rivera r os proposed the following sparse like operator and its adjoint adapted to the commutator with locally integrable function b ts bf x q s b x b q f q 1 q x t s bf x q s b b q f q 1 q x they showed in leor 1 that finitely many of these operators will provide pointwise dom ination for the commutator b t where t is a rough calder n zygmund operator and b a locally integrable function theorem 7 3 lerner ombrosi rivera r os 2017 let t be an calder n zygmund sin gular integral operator with satisfying a dini condition b l 1 loc rd for every compactly 56 m c pereyra supported f l rd there are 3 n dyadic lattices d k and 1 2 9 n sparse families sk d k such that for a e x rd b t f x d t 3 n k 1 tsk b f x t sk b f x quadratic bounds on l 2 w for the commutator b t will follow from quadratic bounds for these adapted sparse operators leor 1 the following quadratic bounds on l 2 w for ts b t s b hold ts bf l 2 w t s bf l 2 w w 2 a 2 b bmo f l 2 w these quadratic bounds the corresponding extrapolated bounds on lp w ts bf lp w t s bf lp w p w 2 max 1 1 p 1 ap b bmo f lp w and much more follow from a key lemma that we now state lemma 7 4 lerner ombrosi rivera r os 2017 given s an sparse family in d b l 1 loc r d then there is a larger collection s d which is an 2 1 sparse family s s such that for all q s the following estimate holds b x b q 2 d 2 r s r q b r 1 r x a e x q where b r 1 r r b x b r dx the mean oscillation of b on the dyadic cube r from this lemma we immediately deduce quantitative bloom bounds for the sparse like adjoint operator associated to the commutator leor 1 a similar result holds for ts b corollary 7 5 quantitative bloom let u v ap u 1 pv 1 p and b bmo then there is a constant cd p 0 such that for all f lp u the following inequality holds t s b f lp v cd p b bmo v ap u ap max 1 1 p 1 f lp u similarly for ts b proof first notice that since b bmo supq q b q q t s b f x cd b bmo as a s f x where s is the larger sparse family given by lemma 7 4 taking lp v norm on both sides and unfolding we conclude that t s b f lp v cd p b bmo as lp v as lp u f lp u cd p b bmo v ap u ap max 1 1 p 1 f lp u where in the last line we used the one weight estimates on both lp u and lp v for the sparse operator a s given that u and v are ap weights by assumption observing that t s b f x t s b f x we get the desired estimate dyadic harmonic analysis and weighted inequalities 57 setting u v w ap then 1 b bmo and we recover the expected one weight quantitative lp estimates for the sparse like operators dominating the commutator and hence for the commutator itself without using extrapolation ts b f lp w t s b f lp w cn p b bmo w 2 max 1 1 p 1 ap f lp w 8 summary and recent progress in these lecture notes we have studied weighted norm inequalities through the dyadic har monic analysis lens we focused on classical operators such as the hilbert transform and the maximal function and dyadic operators such as the dyadic maximal function the martingale transform the dyadic square function haar shift multipliers the dyadic paraproduct and the latest kid in the block the dyadic sparse operator to carry on our program we discussed dyadic tools such as dyadic cubes regular random adjacent and haar functions on r rd and more generally on spaces of homogenenous type in this millennium the interest shifted from qualitative weighted norm inequalities to quan titative weighted norm inequalities new techniques were developed to obtain quantitative estimates including bellman function and median oscillation techniques quantitative extrap olation and transference theorems corona decompositions and stopping times representation of operators as averages of dyadic operators and most recently domination by dyadic sparse operators one important landmark in this quest was the proof of the a 2 conjecture some of these techniques are amenable to generalizations to other settings that support dyadic structures such as spaces of homogeneous type we tried to illustrate the power of the dyadic methods studying in detail the maximal function and the commutator of the hilbert transform with a function in bmo via their dyadic counterparts in both cases obtaining the optimal estimates on weighted lebesgue spaces we presented a self contained bellman function proof of the a 2 conjecture for the dyadic paraproduct in order to illustrate these technique we showed how to pointwise dominate the martingale transform by sparse operators and we presented the beautiful and simple proof of the a 2 conjecture for sparse operators we illustrated the power of pointwise domination techniques by sparse like operators through a case study the commutator of calder n zygmund singular integral operators and locally integrable functions recovering all the quantitative weighted norm inequalities discussed in the notes and some new ones the methods developed in this millennium initially to study quantitative weighted inequal ities for operators defined on rd have proven to be quite flexible and far reaching there are extensions to metric spaces with geometrically doubling condition spaces of homogeneous type and beyond doubling even in a non commutative setting of operator valued dyadic har monic analysis hyt 4 nrv klpw lomapa dgklwy thtv clo there are off diagonal sharp two weight estimates for sparse operators fahyt there are generalizations to matrix valued operators ikp so far the best weighted l 2 estimates in this setting are 3 2 powers for the matrix valued paraproducts shift operators and calder n zygmund operators satisfying a dini condition npettv and linear for the square function hytpetv the validity of the a 2 conjecture in the matrix setting is unknown two weight estimates have been obtained for well localized operators with matrix weights bicutw and a weighted carleson embedding theorem with matrix weights is known and proved using a bellman function with a parame ter cut researchers are busy working towards increasing our knowledge on this setting 58 m c pereyra see for example cupetpo where a bilinear carleson embedding theorem with matrix weight and scalar measure is proved using bellman function techniques more importantly out of these investigations a domination paradigm by sparse positive dyadic operators has emerged and proven to be very powerful with applications in many areas not only weighted inequalities the following is a partial and ever growing list of such applica tions to maximal rough singular integrals cudipou 1 ccudipou hytrota diphytli singular non integral operators bfpet multilinear maximal and singular integral operators cudipou 2 len bmu 1 z non homogeneous spaces and operator valued singular inte gral operators cpa vz uncentered variational operators defz variational carleson op erators dipdou walsh fourier multipliers cudiplou bochner riesz multipliers bblu lmer kl maximally truncated oscillatory singular integral operators krl 1 krl 3 spher ical maximal function l 4 radon transform ob hilbert transform along curves clou pseudodifferential operators bcl the lattice hardy littlewood maximal operator halo fractional operator with l r h rmander conditions ibrivi rubio de francia s littlewood paley square function grs sparse t 1 theorems lme and applications in the discrete setting krl 2 kme cukl have been found as well as logarithmic bounds for maximal sparse operators kal we are starting to understand why in certain settings this philosophy does not work for example very recently it was shown that dominating the dyadic strong maximal function by 1 1 type sparse forms based on rectangles with sides parallel to the axes is impossible bacour this is in the realm of multiparameter analysis were many questions still need to be answered perhaps a new type of sparse domination in this setting will have to be dreamed not only the methodology is tried on each author s favorite operator far reaching exten sions and broader understanding is being gained for example the convex body domination paradigm npettv shows that if a scalar operator can be dominated by a sparse opera tor then its vector version can be dominated by a convex body valued sparse operator a transference theorem similarly multiple vector valued extensions of operators and more can be explained through the very general helicoidal method bmu 2 yet another far reaching transference methodology this is a very active area of research and we hope this lecture notes have helped to impress on the reader its vitality references ai h aimar construction of haar type bases on quasi metric spaces with finite assouad dimension anal acad nac cs ex f y nat buenos aires 54 2002 aibi h aimar a bernardis b iaffei multiresolution approximations and unconditional bases on weighted lebesgue spaces on spaces of homogeneous type j approx theory 148 no 1 2007 12 34 aibn 1 h aimar a bernardis l nowak dyadic fefferman stein inequalities and the equivalence of haar bases on weighted lebesgue spaces proc roy soc edinburgh sect a 141 no 1 2011 1 21 aibn 2 h aimar a bernardis l nowak equivalence of haar bases associated with different dyadic systems j geom anal 21 no 2 2011 288 304 aig h aimar o gorosito unconditional haar bases for lebesgue spaces on spaces of homogeneous type proc spiee 4119 wavelet applications in signal and image processing viii 2000 556 563 aim h aimar r a mac as weighted norm inequalities for the hardy littlewood maximal operator on spaces of homogeneous type proc amer math soc 91 2 1984 213 216 ami r alvarado m mitrea hardy spaces on ahlfors regular quasi metric spaces a sharp theory springer lecture notes in mathematics 2142 2015 dyadic harmonic analysis and weighted inequalities 59 abkpz j lvarez r j bagby d s kurtz c p rez weighted estimates for commutators of linear oper ators studia math 104 2 1993 195 209 ais k astala t iwaniec e saksman beltrami operators in the plane duke math j 107 1 2001 27 56 ah 1 p auscher t hyt nen orthonormal bases of regular wavelets in spaces of homogeneous type appl comput harmon anal 34 no 2 2013 266 296 ah 2 p auscher t hyt nen addendum to orthonormal bases of regular wavelets in spaces of homogeneous type appl comput harmon anal 39 no 3 2015 568 569 bacour a barron j conde alonso y ou g rey sparse domination and the strong maximal function available at arxiv 1811 01243 bcl d beltran l cladek sparse bounds for pseudodifferential operators to appear in j anal math available at arxiv 1711 02339 bblu c benea f bernicot t luque sparse bilinear forms for bochner riesz multipliers and applications available on arxiv 1605 06401 bmu 1 c benea c muscalu multiple vector valued inequalities via the helicoidal method anal pde 9 8 2016 1931 1988 bmu 2 c benea c muscalu sparse domination via the helicoidal method available at arxiv 1707 05484 bmn a b nyi d maldonado v naibo what is a paraproduct notices amer math soc 57 no 7 2010 858 860 bmmst a b nyi j m martell k moen e stachura r torres boundedness results for commutators with bmo functions via weighted estimates a comprehensive approach available on arxiv 1710 08515 bfpet f bernicot d frey s petermichl sharp weighted norm estimates beyond calder n zygmund theory anal pde 9 2016 1079 1113 be 1 o beznosova bellman functions paraproducts haar multipliers and weighted inequalities phd dis sertation university of new mexico 2008 be 2 o beznosova linear bound for the dyadic paraproduct on weighted lebesgue space l 2 w j func anal 255 2008 994 1007 becmop o beznosova d chung j moraes m c pereyra on two weight estimates for dyadic operators harmonic analysis partial differential equations complex analysis banach spaces and operator theory vol 2 135 169 assoc women math ser 5 springer cham 2017 bere o beznosova a reznikov equivalent definitions of dyadic muckenhoupt and reverse holder classes in terms of carleson sequences weak classes and comparability of dyadic l logl and a constants rev mat iberoam 30 issue 4 2014 1191 1190 bicutw k bickel a culiuc s treil b wick two weight estimates for well localized operators with matrix weights to appear trans amer math soc doi 10 1090 tran 7400 bl s bloom a commutator theorem and weighted bmo trans amer math soc 292 no 1 1985 103 122 bo j m bony calcul symbolique et propagation des singularit s pour les quations aux d riv es partielles non lin aires ann sci cole norm sup 14 1981 209 246 bu 1 s m buckley estimates for operator norms on weighted spaces and reverse jensen inequalities trans amer math soc 340 no 1 1993 253 272 bu 2 s m buckley summation condition on weights michigan math j 40 1993 153 170 bur 1 d l burkholder martingale transforms ann math statist 37 no 6 1966 1494 1504 bur 2 d l burkholder boundary value problems and sharp inequalities for martingale transforms ann probab 12 1984 647 702 cwilw s y a chang j m wilson t h wolff some weighted norm inequalities concerning the schr dinger operators comment math helv 60 no 2 1985 217 246 clw p chen j li l a ward bmo from dyadic bmo via expectations on product spaces of homogeneous type j func anal 265 no 10 2013 2420 2451 chr m christ a t b theorem with remarks on analytic capacity and the cauchy integral colloq math 60 61 no 2 1990 601 628 ch 1 d chung commutators and dyadic paraproducts on weighted lebesgue spaces phd dissertation uni versity of new mexico 2010 ch 2 d chung sharp estimates for the commutators of the hilbert riesz and beurling transforms on weighted lebesgue spaces indiana u math j 60 issue 5 2011 1543 1588 60 m c pereyra ch 3 d chung weighted inequalities for multivariable dyadic paraproducts publ mat 55 no 2 2011 475 499 chppz d chung m c pereyra c p rez sharp bounds for general commutators on weighted lebesgue spaces trans amer math soc 364 2012 1163 1177 clou l cladek y ou sparse domination of hilbert transforms along curves math res lett 25 no 2 2018 415 436 cofe r coifman c fefferman weighted norm inequalities for maximal functions and singular integrals studia math 51 1974 241 250 com r r coifman y meyer au d l des op rateurs pseudo diff rentiels ast risque 57 1979 corw r r coifman r rochberg g weiss factorization theorems for hardy spaces in several variables ann of math 103 1976 611 635 cow r r coifman g weiss analyse harmonique non commutative sur certains espaces homog nes etude de certaines int grales singuli res lecture notes in math 242 springer verlag berlin 1971 c j m conde a note on dyadic coverings and nondoubling calder n zygmund theory j math anal appl 397 2 2013 785 790 ccudipou j m conde alonso a culiuc f di plinio y ou a sparse domination principle for rough singular integrals anal pde 10 no 5 2017 1255 1284 clo j m conde alonso l d l pez s nchez operator valued dyadic harmonic analysis beyond doubling measures proc amer math soc 144 no 9 2016 3869 3885 cpa j m conde alonso j parcet nondoubling calder n zygmund theory a dyadic approach to appear in j fourier anal appl available at arxiv 1604 03711 cr j m conde alonso g rey a pointwise estimate for positive dyadic shifts and some applications math annalen 365 3 4 2016 1111 1135 cs 1 m cotlar c sadosky on the helson szeg theorem and a related class of modified toeplitz kernels in harmonic analysis in euclidean spaces ed by g weiss and s wainger proc symp pure math 35 amer math soc providence r i 1979 383 407 cs 2 m cotlar c sadosky on some lp versions of the helson szeg theorem conference on harmonic analysis in honor of antoni zygmund vol i ii chicago ill 1981 306 317 wadsworth math ser wadsworth belmont ca 1983 cr d cruz uribe two weight norm inequalities for fractional integral operators and commutators advanced courses of mathematical analysis vi 2017 25 85 crmoe d cruz uribe k moen sharp norm inequalities for commutators of classical operators publ mat 56 2012 147 190 crmpz 1 d cruz uribe j m martell c per z weights extrapolation and the theory of rubio the francia birkh user 2011 crmpz 2 d cruz uribe j m martell c p rez sharp weighted estimates for classical operators adv math 229 2012 408 441 cudiplou a culiuc f di plinio m t lacey y ou endpoint sparse bound for walsh fourier multipliers of marcinkiewicz type submitted to rev mat iberoam available at arxiv 1805 06060 cudipou 1 a culiuc f di plinio y ou uniform sparse domination of singular integrals via dyadic shifts math res lett 25 no 1 2018 21 42 cudipou 2 a culiuc f di plinio y ou domination of multilinear singular integrals by positive sparse forms j london math soc 98 no 2 2018 369 392 cukl a culiuc r kesler m t lacey sparse bounds for the discrete cubic hilbert transform to appear in anal pde available at arxiv 1612 08881 cupetpo a culiuc s petermichl s pott a matrix weighted bilinear carleson lemma and maximal function available at arxiv 1811 05838 cut a culiuc s treil the carleson embedding theorem with matrix weights to appear int math res not https doi org 10 1093 imrn rnx 222 available at arxiv 1508 01716 da g david morceaux de graphes lipschitziens et int grales singuli res sur une surface rev mat iberoam 4 1 1988 73 114 das g david s semmes a boundedness criterion for generalized calder n zygmund operators ann of math 20 1984 371 397 dyadic harmonic analysis and weighted inequalities 61 dajs g david j l journ s semmes op rateurs de calder n zygmund fonctions paraaccr tives et interpolation rev mat iberoam 1 no 4 1985 1 56 defz f c de fran a silva and p zorin kranich sparse domination of sharp variational truncations avail able at arxiv 1604 05506 dipdou f di plinio y do g uraltsev positive sparse domination of variational carleson operators ann sc norm super pisa cl sci 5 18 no 4 2018 1443 1458 diphytli f di plinio t hyt nen k li sparse bounds for maximal rough singular integrals via the fourier transform submitted to ann inst fourier grenoble available at arxiv 1706 07111 dh d g deng y han harmonic analysis on spaces of homogeneous type springer verlag 2009 dgppet o dragi evi l grafakos m c pereyra s petermichl extrapolation and sharp norm estimates for classical operators in weighted lebesgue spaces publ mat 49 2005 73 91 duo 1 j duoandicoetxea fourier analysis graduate studies in math 29 amer math soc providence ri 2001 duo 2 j duoandicoetxea extrapolation of weights revisited new proofs and sharp bounds j func anal 260 issue 6 15 2011 1886 1901 fahyt s fackler t hyt nen off diagonal sharp two weight estimates for sparse operators new york j math 24 2018 21 42 dgklwy x t duong r gong m j s kuffner j li b wick d yang two weight commutators on spaces of homogeneous type and applications available at arxiv 1809 07942 fkp r fefferman c kenig j pipher the theory of weights and the dirichlet problem for elliptic equations ann of math 2 134 no 1 1991 65 124 fs c fefferman e stein hp spaces of several variables acta math 129 no 3 4 1972 137 193 fi t fiegel singular integral operators a martingale approach in geometry of banach spaces london math soc lecture notes ser 158 cambridge univ press 1990 95 110 ga j garc a cuerva jos luis rubio de francia 1949 1988 collect math 38 1987 3 15 garu j garc a cuerva and j l rubio de francia weighted norm inequalities and related topics north holland mathematics studies 116 amsterdam 1981 grs r garg l roncal s shrivastava quantitative weighted estimates for rubio de francia s littlewood paley square function available at arxiv 1809 02937 gj j garnett p w jones bmo from dyadic bmo pac j math 99 no 2 1982 351 371 gs m girardi w sweldens a new class of unbalanced haar wavelets that form an unconditional basis for lp on general measure spaces j fourier anal appl 3 no 4 1997 45 474 gr 1 l grafakos classical fourier analysis third edition graduate texts in math 249 springer new york 2014 gr 2 l grafakos modern fourier analysis third edition graduate texts in math 250 springer new york 2014 ha t s h nninen equivalence of sparse and carleson coefficients for general sets available at arxiv 1709 10457 halo t s h nninen e lorist sparse domination for the lattice hardy littlewood maximal operator avail able at arxiv 1712 02592 holw 1 i holmes m t lacey b wick commutators in the two weight setting math ann 367 2017 5 80 holw 2 i holmes m t lacey b wick bloom s inequality commutators in a two weight setting arch math basel 106 1 2016 53 63 hopetw i holmes s petermichl b wick weighted little bmo and two weight inequalities for journ commutators anal pde 11 no 7 2018 1693 1740 htv s hukovic s treil a volberg the bellman function and sharp weighted inequalities for square functions in complex analysis operators and related topics oper theory adv appl 113 2000 97 113 birka ser basel hmw r hunt b muckenhoupt r wheeden weighted norm inequalities for the conjugate func tion and the hilbert transform trans amer math soc 176 1973 227 252 hyt 1 t hyt nen on petermichl s dyadic shift and the hilbert transform compt rend math 346 2008 1133 1136 62 m c pereyra hyt 2 t hyt nen the sharp weighted bound for general calder n zygmund operators ann of math 2 175 no 3 2012 1473 1506 hyt 3 t hyt nen martingales and harmonic analysis preprint 2013 can be found online at http www ctr maths lu se media matp 29 2016 vt 2016 maha eng 1 pdf hyt 4 t hyt nen the two weight inequality for the hilbert transform with general measures proc london math soc 117 issue 3 2018 483 526 hyt 5 t hyt nen the holmes wick theorem on two weight bounds for higher order commutators revisited archiv der mathematik 107 4 2016 389 395 hytk t hyt nen a kairema systems of dyadic cubes in a doubling metric space colloq math 126 1 2012 1 33 hytl t hyt nen m t lacey the ap a inequality for general calder n zygmund operators indiana univ math j 61 2012 2041 2052 hytli t hyt nen k li weak and strong ap a estimates for square functions and related operators proc amer math soc 146 no 6 2018 2497 2507 hytma t hyt nen h martikainen non homogeneous tb theorem and random dyadic cubes on metric measure spaces j geom anal 22 4 2012 1071 1107 hytpz t hyt nen c p rez sharp weighted bounds involving a anal pde 6 no 4 2013 777 818 hytpetv t hyt nen s petermichl a volberg the sharp square function estimate with matrix weight available on arxiv 1702 04569 hytrota t hyt nen l roncal o tapiola quantitative weighted estimates for rough homogeneous singular integrals israel j math 218 no 1 2017 133 164 hytta t hyt nen o tapiola almost lipschitz continuous wavelets in metric spaces via a new randomiza tion of dyadic cubes j approx theory 185 2014 12 30 ibrivi g h iba ez firnkorn m s riveros r e vidal sharp bounds for fractional operator with l r h rmander conditions available at arxiv 1804 09631 ikp j isralowitz h k kwon s pott matrix weighted norm inequalities for commutators and paraproducts with matrix symbols j london math soc 2 96 no 1 2017 243 270 jn f john l nirenberg on functions of bounded mean oscillation comm pure appl math 14 1961 415 426 klpw a kairema j li m c pereyra l a ward haar bases on quasi metric measure spaces and dyadic structure theorems for function spaces on product spaces of homogeneous type j func anal 271 7 2016 1793 1843 kal g a karagulyan m t lacey on logarithmic bounds of maximal sparse operators available on arxiv 1802 00954 kp n h katz m c pereyra on the two weight problem for the hilbert transform rev mat iberoamer icana 13 01 1997 211 242 kl r kesler m t lacey sparse endpoint estimates for bohner riesz multipliers on the plane collec math 69 no 3 2018 427 435 kme r kesler d mena uniform sparse bounds for discrete quadratic phase hilbert transform anal math phys 2017 https doi org 10 1007 s 13324 017 0195 3 krl 1 b krause m t lacey sparse bounds for maximal monomial oscillatory hilbert transforms studia math 242 no 3 2018 217 229 krl 2 b krause m t lacey sparse bounds for random discrete carleson theorems 50 years with hardy spaces 317 332 oper theory adv appl 261 birkh user springer cham 2018 krl 3 b krause m t lacey sparse bounds for maximally truncated oscillatory singular integrals to appear annal sci scuola norm sup doi number 10 2422 2036 2145 201706 023 available at arxiv 1701 05249 l 1 m t lacey two weight inequality for the hilbert transform a real variable characterization ii duke math j 163 no 15 2014 2821 2840 l 2 m t lacey the two weight inequality for the hilbert transform a primer harmonic analysis partial differential equations banach spaces and operator theory vol 2 11 84 assoc women math ser 5 springer cham 2017 l 3 m t lacey an elementary proof of the a 2 bound israel j math 217 2017 181 195 dyadic harmonic analysis and weighted inequalities 63 l 4 m t lacey sparse bounds for spherical maximal functions to appear in j d analyse math available at arxiv 1702 08594 lli 1 m t lacey k li two weight norm inequalities for the g function math res lett 21 no 03 2014 521 536 lli 2 m t lacey k li on ap a estimates for square functions math z 284 2016 1211 1222 lme m t lacey d mena the sparse t 1 theorem houston j math 43 no 1 2017 111 127 lmer m t lacey d mena m c reguera sparse bounds for bochner riesz multipliers j fourier anal appl 2017 https doi org 10 1007 s 00041 017 9590 2 lmpzto m t lacey k moen c p rez r h torres sharp weighted bounds for fractional integral operators j funct anal 259 2010 107 1097 lpetr m t lacey s petermichl m c reguera sharp a 2 inequality for haar shift operators math ann 348 2010 127 141 lssu m t lacey e sawyer c y shen i uriarte tuero the two weight inequality for the hilbert transform coronas and energy conditions duke math j 163 no 15 2014 2795 2820 ls m t lacey s spencer sparse bounds for oscillatory and random singular integrals new york j math 23 2017 119 131 lth m t lacey c thiele lp bounds for the bilinear hilbert transform ann of math 146 1997 693 724 le 1 a k lerner an elementary approach to several results on the hardy littlewood maximal operator proc amer math soc 136 no 8 2008 2829 2833 le 2 a k lerner sharp weighted norm inequalities for littlewood paley operators and singular integrals adv math 226 2011 3912 3926 le 3 a k lerner mixed ap ar inequalities for classical singular integrals and littlewood paley operators j geom anal 23 2013 1343 1354 le 4 a k lerner on an estimate of calder n zygmund operators by dyadic positive operators j anal math 121 2013 141 161 le 5 a k lerner a simple proof of the a 2 conjecture int math res not 14 2013 3159 3170 le 6 a k lerner on pointwise estimates involving sparse operators new york j math 22 2016 341 349 lemoe a k lerner k moen mixed ap a estimates with one supremum studia math 219 no 3 2013 247 267 len a k lerner f nazarov intuitive dyadic calculus the basics to appear in expo math available at arxiv 1508 05639 leor 1 a k lerner s ombrosi i rivera r os on pointwise and weighted estimates for commutators of calder n zygmund operators adv math 319 2017 153 181 leor 2 a k lerner s ombrosi i rivera r os commutators of singular integrals revisited to appear in bull london math soc online nov 2018 https doi org 10 1112 blms 12216 lomapa l d l pez s nchez j m martell j parcet dyadic harmonic analysis beyond doubling measures adv math 267 2014 44 93 ms r a mac as c segovia lipschitz functions on spaces of homogeneous type adv math 33 1979 257 270 me t mei bmo is the intersection of two translates of dyadic bmo c r math acad sci paris 336 no 12 2003 1003 1006 moe k moen sharp one weight and two weight bounds for maximal operators studia math 194 2 2009 163 180 mop j c moraes m c pereyra weighted estimates for dyadic paraproducts and t haar multiplies with complexity m n publ mat 57 2013 265 294 mu b muckenhoupt weighted norm inequalities for the hardy littlewood maximal function trans amer math soc 165 1972 207 226 muw b muckenhoupt r wheeden weighted bounded mean oscillation and the hilbert transform studia math 54 1975 76 221 237 mul p f x m ller isomorphisms between h 1 spaces mathematics institute of the polish academy of sciences mathematical monographs new series 66 birkh user verlag basel 2005 npettv f nazarov s petermichl s treil a volberg convex body domination and weighted estimates with matrix weights adv math 318 2017 279 306 64 m c pereyra nrtv f nazarov a reznikov s treil a volberg a bellman function proof of the l 2 bump conjecture j anal math 121 2013 255 277 nrv f nazarov a reznikov a volberg the proof of a 2 conjecture in a geometrically doubling metric space indiana univ math j 62 no 5 2013 1503 1533 nt f nazarov s treil the hunt for a bellman function applications to estimates for singular integral operators and to other classical problems of harmonic analysis st petersburg math j 8 1997 721 824 ntv 1 f nazarov s treil a volberg the bellman functions and the two weight inequalities for haar multipliers j amer math soc 12 1999 909 928 ntv 2 f nazarov s treil a volberg bellman function in stochastic optimal control and harmonic analysis how our bellman function got its name oper theory adv appl 129 2001 393 424 ntv 3 f nazarov s treil a volberg the tb theorem on non homogeneous spaces acta math 190 2003 151 239 ntv 4 f nazarov s treil a volberg two weight inequalities for individual haar multipliers and other well localized operators math res lett 15 no 3 2008 583 597 ntv 5 f nazarov s treil a volberg two weight estimate for the hilbert transform and corona decompo sition for non doubling measures preprint 2005 posted in 2010 available arxiv 1003 1596 ob r oberlin sparse bounds for a prototypical singular radon transform canadian math bull 12 pages https doi org 10 4153 cmb 2018 007 5 ok k okikiolu characterization of subsets of rectifiable curves in rn j london math soc 2 46 no 2 1992 336 348 orpzre c ortiz caraballo c p rez e rela improving bounds for singular operators via sharp reverse h lder inequality for a operator theory advances and applications 229 2013 303 321 p 1 m c pereyra lecture notes on dyadic harmonic analysis contemp math 289 2001 1 60 p 2 m c pereyra weighted inequalities and dyadic harmonic analysis excursions in harmonic analysis volume 2 281 306 appl numer harmon anal birkhauser springer new york 2013 pw m c pereyra l a ward harmonic analysis from fourier to wavelets student mathematical library series 63 amer math soc 2012 pz 1 c p rez endpoint estimates for commutators of singular integral operators j func anal 1 128 1995 163 185 pz 2 c p rez a course on singular integrals and weights harmonic and geometric analysis advanced courses in mathematics c r m barcelona birkauser basel 2015 pzr c p rez e rela a new quantitative two weight theorem for the hardy littlewood maximal operator proc amer math soc 143 2015 641 655 pztv c p rez s treil a volberg sharp weighted estimates for dyadic shifts and the a 2 conjecture j reine angew math crelle s journal 687 2014 43 86 pet 1 s petermichl dyadic shift and a logarithmic estimate for hankel operators with matrix symbol c r acad sci paris s r i math 330 no 6 2000 455 460 pet 2 s petermichl the sharp bound for the hilbert transform on weighted lebesgue spaces in terms of the classical ap characteristic amer j of math 129 2007 1355 1375 pet 3 s petermichl the sharp weighted bound for the riesz transforms proc amer math soc 136 04 2007 1237 1249 petpo s petermichl s pott an estimate for weighted hilbert transform via square functions trans amer math soc 354 2002 281 305 petv s petermichl a volberg heating of the ahlfors beurling operator weakly quasiregular maps on the plane are quasiregular duke math j 112 2 2002 281 305 piw j pipher l a ward bmo from dyadic bmo on the bidisc j london math soc 77 no 2 2008 524 544 por s pott m c reguera sharp bekolle estimates for the bergman projection j func anal 265 12 2013 3233 3244 s 1 e sawyer a characterization of a two weight norm inequality for maximal functions studia math 75 no 1 1982 1 11 s 2 e sawyer a characterization of two weight norm inequalities for fractional and poisson integrals trans amer math soc 308 no 2 1988 533 545 dyadic harmonic analysis and weighted inequalities 65 sw e sawyer r l wheeden weighted inequalities for fractional integrals on euclidean and homogeneous spaces amer j math 114 4 1992 813 874 st e stein harmonic analysis real variable methods orthogonality and oscillatory integrals first edition princeton university press 1993 th c thiele time frequency analysis in the discrete phase plane phd thesis yale 1995 thtv c thiele s treil a volberg weighted martingale multipliers in the non homogeneous setting and outer measure spaces adv math 285 2015 1155 1188 t s treil sharp a 2 estimates of haar shifts via bellman function recent trends in analysis 187 208 theta ser adv math theta bucharest 2013 tv s treil a volberg wavelets and the angle between past and future j func anal 143 2 1997 269 308 va v vasyunin cincinnati lectures on bellman functions edited by l slavin available at arxiv 1508 07668 ve i verbitsky imbedding and multiplier theorems for discrete littlewood paley spaces pacific j math 176 no 2 1996 529 556 v a volberg bellman function technique in harmonic analysis lectures of inria summer school in antibes preprint 2011 1 58 available at arxiv 1106 3899 vz a volberg p zorin kranish sparse domination on non homogeneous spaces with an application to ap weights rev mat iberoam 34 no 3 2018 1401 1414 vu 1 e vuorinen lp lq characterization for well localized operators j fourier anal appl 22 5 2016 1059 1075 vu 2 e vuorinen two weight lp inequalities for dyadic shifts and the dyadic square function studia math 237 1 2017 25 56 we d weirich weighted inequalities for dyadic operators over spaces of homogeneous type phd dissertation university of new mexico 2018 wic b wick personal communication april 2016 wil 1 m wilson weighted inequalities for the dyadic square function without dyadic a duke math j 55 1987 19 49 wil 2 m wilson weighted littlewood paley theory and exponential square integrability lecture notes in mathematics 1924 springer berlin 2008 w 1 j wittwer a sharp estimate on the norm of the martingale transform math res letters 7 2000 1 12 w 2 j wittwer a sharp estimate on the norm of the continuous square function proc amer math soc 130 8 2002 2335 2342 z p zorin kranish ap a estimates for multilinear maximal and sparse operators to appear in j anal math mar a cristina pereyra department of mathematics and statistics 1 university of new mexico 311 terrace st ne msc 01 1115 albuquerque nm 87131 0001 e mail address crisp math unm edu 1 introduction 2 weighted norm inequalities 2 1 some basic notation and prototypical operators 2 2 hilbert transform 2 3 maximal function 2 4 why are we interested in these estimates 2 5 first linear estimates 2 6 extrapolation and hyt nen s ap theorem 2 7 two weight problem for the hilbert transform and the maximal function 3 dyadic harmonic analysis 3 1 dyadic intervals dyadic maximal functions 3 2 one third trick and lerner s proof of buckley s result 3 3 random dyadic grids on r 3 4 haar bases 3 5 dyadic analysis on spaces of homogeneous type 4 dyadic operators weighted inequalities and hyt nen s representation theorem 4 1 martingale transform 4 2 dyadic square function 4 3 petermichl s dyadic shift operator 4 4 haar shift operators of arbitrary complexity 4 5 dyadic paraproduct 4 6 hyt nen s representation theorem 5 a 2 theorem for the dyadic paraproduct a bellman function proof 5 1 weighted carleson sequences weighted carleson lemma and little lemma 5 2 the 3 2 bound for the paraproduct on weighted l 2 5 3 algebra of carleson sequences lemma and weighted haar bases 5 4 a 2 conjecture for the dyadic paraproduct 5 5 auxiliary lemmas 6 case study commutator of hilbert transform and function in bmo 6 1 lp theory for b h 6 2 weighted inequalities 6 3 dyadic proof of chung s theorem 6 4 a quantitative transference theorem 7 sparse operators and sparse families of dyadic cubes 7 1 sparse operators 7 2 sparse vs carleson families of dyadic cubes 7 3 a 2 theorem for sparse operators 7 4 domination by sparse operators 7 5 domination of martingale transform d apr s lacey 7 6 case study sparse operators vs commutators 8 summary and recent progress references