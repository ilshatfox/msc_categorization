a simple modeling framework for prediction in the human glucose insulin system d j albers 1 2 m e levine 3 m sirlanci 3 and a m stuart 3 1 department of pediatrics division of informatics and data science university of colorado medicine aurora co 80045 2 department of biomedical informatics columbia university new york ny 10032 3 department of computing and mathematical sciences california institute of technology pasadena ca 91125 abstract in this paper we build a new simple and interpretable mathematical model to describe the human glucose insulin system our ultimate goal is the robust control of the blood glucose bg level of individuals to a desired healthy range by means of adjusting the amount of nutrition and or external insulin appropriately by constructing a simple yet flexible model class with interpretable parameters this general model can be specialized to work in different settings such as type 2 diabetes mellitus t 2 dm and intensive care unit icu different choices of appropriate model functions describing uptake of nutrition and removal of glucose differentiate between the models in addition to data driven decision making and control we believe the model is also useful for the basic quantification of endocrine physiology in both cases the available data is sparse and collected in clinical settings major factors that have constrained our model choice to the simple form adopted the model has the form of a linear stochastic differential equation sde to describe the evolution of the bg level the model includes a term quantifying glucose removal from the bloodstream through the regulation system of the human body and another two terms representing the effect of nutrition and externally delivered insulin the stochastic fluctuations encapsulate model error necessitated by the simple model form and enable flexible incorporation of data the parameters entering the equation must be learned in a patient specific fashion leading to personalized models we present numerical results on patient specific parameter estimation and future bg level forecasting in t 2 dm and icu settings the resulting model leads to the prediction of the bg level as an expected value accompanied by a band around this value which accounts for uncertainties in the prediction such predictions then have the potential for use as part of control systems which are robust to model imperfections and noisy data finally a comparison of the predictive capability of the model with two different models specifically built for t 2 dm and icu contexts is also performed david albers cuanschutz edu mlevine caltech edu sirlanci caltech edu astuart caltech edu 1 ar x iv 1 91 0 14 19 3 v 2 q bi o q m 2 4 a ug 2 02 0 1 introduction 1 1 background broadly speaking mathematical models of human physiology may serve one of two purposes elucida tion of the detailed mechanisms which comprise the complex systems underlying observed physiology or prediction of outcomes from the complex system for the purposes of medical intervention to ame liorate undesirable outcomes in principle these two objectives interact a model which explains the detailed mechanisms if physiologically accurate and compatible with observed data will of course be good for prediction however in many complex human physiological systems basic understanding of the mechanisms involved is still developing it is arguably the case that simple interpretable models which are trained on observed data may suffice for the purpose of prediction and control in situations where the detailed underlying physiological mechanisms are not yet fully understood additionally human physiological data are often sparse implying a limited capacity for resolving high fidelity physiological details and unique physiological inference the human glucose insulin sys tem provides an important example of a system where these issues come in to play because in most settings insulin representing two of three dominant state variables is never measured moreover depending on the purpose of the study and the structure and size of the available data one needs to decide the required level of model fidelity 43 here because we aim to resolve the mean and variance of glucose dynamics we ignore higher fidelity physiology and build a lower fidelity model in a way that it includes common clinically relevant inputs the objective of this paper is to introduce a simple modeling framework for the human glucose insulin system which is interpretable can be trained on and largely limited to observed data and then has predictive capability in a predictive test data sense the model developed here is in some sense a radical departure from the norm this is because it proposes a closed model for blood glucose dynamics meaning the model includes parameters and states limited to those either directly related to or directly inferable from commonly available data rather than the model including a full set of features believed to drive the system the model treats all unmeasured states that interact with blood glucose as either representable by inferred parameters or as noise in particular insulin levels are modeled through parametric dependence which can be modified to incorporate measured insulin delivery whilst noise in the model allows for imprecision arising from this simple approach in this way the primary hypothesis of this paper is to investigate if a glycemic model which does not include equations describing the evolution of interstitial and plasma insulin levels in the body can be used to represent and accurately forecast blood glucose while retaining some physiological fidelity the motivation for this formulation is built on both inference and the scientific process in general lacking measurements for quantities related to dominant states in the system such as insulin causes identifiability failure and hence instability in the inference to avoid this situation we represent insulin implicitly through parametric dependence within the equation for glucose with noise introduced to allow for inadequacies in this representation instead of modeling it explicitly via a state our results demonstrate that this approach is viable as our model is able to forecast glucose by many metrics as well or better than many accepted models which explicitly model insulin in terms of flexibility and interpretability of inference there is a trade off between data assimilation da and machine learning ml approaches in ml we project data onto a complex highly flexible function space however the resulting algorithms often fail to be directly interpretable limiting their potential for use and creating the possibility of unwanted and unexplainable effects on the other hand in da we project data onto a model that is usually interpretable and this may be used to design away unwanted and unexplainable effects our approach combines the data driven nature and flexibility of ml algorithms whilst retaining some the interpretability and benefits that stem from it that arise from da 2 1 2 literature review depending on their particular purposes researchers have developed various mathematical models ranging from extremely simple to extremely complex to describe glucose metabolism in humans some of these models are developed to describe a very specific system for example a particular biological function of the pancreas 13 34 77 whereas others have been developed to predict hypoglycemia 31 61 78 glucose control 11 14 24 30 70 89 91 or disease pathogenesis 32 35 36 some of these are continuous time models in the form of ordinary differential equations odes whilst others use ml in 13 34 77 the authors develop system of odes to model the phenomenon they investigate while efforts directed at inference tasks such as predicting hypoglycemia ml approaches are more common for example to predict hypoglycemia in 78 various classification methods such as random forest support vector machine k nearest neighbors are used for the same purpose in 61 a simple model consisting of a logistic function based on the mean and standard deviation of bg measurements is developed and in 31 a linear mixed effects model is used in 88 an ml approach is used to investigate the variability in postprandial bg levels to identical meals based on several covariates such as blood parameters dietary habits and gut microbiota over a course of one week time period for 800 individuals with this method the authors successfully predicted postprandial blood glucose levels in a personalized manner and estimated personalized diets that could reduce the postprandial blood glucose for these patients moreover another class of ml models that are used for analysis and prediction are the arima auto regressive integrated moving average models in 59 authors use an armax model which consists of an arma auto regressive moving average model combined with exogenous input model to analyze the data collected from t 2 dm patients in 87 an arima model is used for forecasting bg levels whereas in 60 a sarima seasonal arima model is used for the same purpose on the other hand for glucose control a wide range of approaches are used such as systems of odes 11 combination of systems of odes and partial differential equations pdes 30 stochastic differential equations sdes 89 and various network models 14 91 there is also research to understand how t 2 dm patients and their health care providers reason about self collected data how this type of data should be used to make accurate future bg level forecasting and what kind of strategies should be designed to maximize the usefulness of self monitored data 57 58 in 23 a mobile application is developed for post meal bg level forecasting with self tracked data it is also tested on two populations one consisting of individuals who are educated about t 2 dm and familiar with mobile applications whereas the other consisting of individuals with low literacy and limited mobile app usage both population find the mobile app useful in managing their disease another study investigating the reasoning mechanism of self management strategies of t 2 dm patients which is reported in 22 shows the importance of effective visualizations in self management of t 2 dm on the other hand in 6 a da framework is used for future bg level forecasting based on self collected data the results obtained with the da approach is compared with other approaches such as gaussian process model regression and with the prediction of expert diabetes educators in another work 7 the da framework was developed as a computational method which combines ml and mechanistic modeling to forecast future bg levels and to infer t 2 dm phenotypes on the other hand in 33 a two compartmental relatively simple ode model is used to analyze continuous glucose measurement cgm data collected from t 2 dm patients to investigate possible improvements that could be achieved with this type of data in the t 2 dm setting one of the earliest quantitative models was bergman s minimal model 12 this ode model was developed with the purpose of estimating insulin sensitivity in the intravenous glucose tolerance test ivgtt setting another widely known ode model was developed by sturis et al 77 with the aim of elucidating the cause of the ultradian long period oscillations of insulin and glucose the concluding hypothesis of the sturis et al 77 paper was that production of glycemic oscillations required a model with three states beyond those described in the minimal model interstitial insulin plasma insulin and a delayed effect of the liver s release of glucose there are alternative hypotheses for sources of ultradian oscillations due to other factors e g 55 but in all cases a full description of the ultradian oscillations and their careful validation with data remains an open question one 3 important theme in all of the papers that address ultradian oscillations points to a mathematical feature that does seem to be required to produce ultradian glycemic oscillations a delayed response in glucose use and production for example routine numerical bifurcation analysis of the sturis et al 77 model reveals that oscillatory dynamics appear via a presumably hopf bifurcation due to variation in parameters that control the time delay governing hepatic glucose production this important observation led to the introduction of delay differential equations ddes to model the long period oscillations of insulin and glucose others have developed models driven more strongly by clinically minded motivations in 35 authors use a mathematical model to understand why it is easier to prevent type 2 diabetes mellitus t 2 dm than to cure it the model is based on a negative feedback mechanism within a system of nonlinear odes as an update to the pioneering model 80 to describe cell mass glucose and insulin dynamics because they describe a specific aspect of the system these models are relatively simple and easy to interpret there are models on the other hand that aim to describe more complicated systems with multiple and multi scale interacting components such as the events that occur during oral glucose ingestion 21 50 these models are comprised of a large number of odes or ddes with many model parameters such models which describe events in a very detailed manner are typically used to understand the physiological network that results in the emergent behavior of the system there are also machine learning models that could be used for the same purposes time series analysis could be used to identify and exploit systemic patterns in the data and these patterns used to provide models for forecasting in 1 8 information theoretic methods were developed to understand and model phenotypic 4 5 and health care process measurement process driven 42 44 differences observable from clinically collected glucose data these efforts led to 72 where a nonlinear computational model was used to estimate unmeasured variables and unknown model parameters based on sparse measurement data for glycemic management in icu context more directed at autoregressive modeling in 16 using autocorrelation analysis of continuous bg data it is shown that future bg levels can be predicted by using recent time history of the glucose following this result simple autoregressive modeling is used for forecasting based on continuous bg data collected from either type 1 or type 2 diabetic individuals in 28 74 on the other hand in 45 linear regression model is used to examine the roles of insulin dependent and insulin independent factors in glucose tolerance based on data collected during ivgtt the models cited in the previous paragraph are often developed in order to understand disease pathogenesis e g of t 2 dm where the system generally changes much more slowly than state variables evolve in time in settings where the system evolves very quickly e g in the intensive care unit icu setting a number of additional hurdles appear for using the resulting computational models for glycemic prediction and control these include the wide variation in clinical response within and between patients and resultant concerns about safety issues in 90 a model consisting of fractional polynomials and interaction terms is used with a linear regression approach to determine the initial insulin dose setting in 82 bergman s minimal model is modified so that it applies beyond the initial goal of explaining ivgtts and is instead applicable in the icu setting in this context it is referred to as the icu minimal model icu mm in 52 a control mechanism framework is developed that uses two compartment glucose insulin model accounting for time varying parameters there is also a large body of research developed for similar purposes in type 1 diabetes mellitus t 1 dm context often under the umbrella of artificial pancreas beta cell research researchers have long recognized the importance of efficient mathematical algorithm describing the glucose insulin reg ulation 17 18 20 63 64 indeed in 17 and 63 mathematical model is explicitly counted as one of the main components of artificial pancreas development in all these works and many oth ers 26 27 49 79 that are focused on closed loop control of bg levels of t 1 dm patients the amount of insulin to be infused via a pump is decided based on mainly the cgm hence the math ematical models mostly describe the glucose insulin regulation without incorporating any nutrition information however since nutrition is one of the main drivers of the bg level developing models accounting for nutrition factor and using these models within the human in the loop control systems for tight glycemic management in t 1 dm setting may have the potential to advance current glycemic 4 management results and reduce the possibility of diabetes related complications in all of the models discussed above parameters enter and play an important role in making predictions with the model yet may be difficult to determine as they are not directly measurable furthermore their values will vary from one patient to another there are two overarching approaches to learning about parameters optimization in which a model data mismatch is minimized to deter mine parameters 25 and the bayesian approach 46 in which the distribution on the parameters given the data and given the assumed noisy model data framework is computed generally speak ing the bayesian approach provides more information as it gives not only parameter estimates but uncertainties this can be very useful in biomedical prediction as it may be used to predict and hence avoid rare events with extreme consequences these advantages are not free the bayesian approach is typically more costly as it requires determining an entire distribution and not just a point the two are linked through the negative logarithm of the posterior distribution on the parameters which is a penalized model data mismatch functional in 82 parameter estimation is performed based on surgical icu data using a standard least squares approach in 39 building on an adaptive modeling approach introduced in 82 the authors use the icu mm to predict bg levels of patients over a moving time interval that starts right after the interval used for parameter estimation employing a nonlinear least squares approach in 10 the authors employ hybrid newton observer design to pre dict bg levels of icu patients within the framework of the icu mm this is a method introduced in 15 to obtain numerical solution of a system of nonlinear odes through simulation by using newton s method and eliminating the dependence on the exact discrete time model when this exact model is not known analytically another approach developed in 40 the authors construct a mechanistic model consisting of five sub models describing glucose regulation in critical care they adopt a bayesian approach in which the prior regularizing distribution is formed based on the both prior expert knowledge and routinely collected icu data by this approach time invariant model parameters as well as a time varying model parameter which represents the temporal variation in insulin sensitivity are estimated another mathematical model consisting of odes is developed in 86 in which with the exception of the time varying insulin sensitivity parameter all the model parameters are fixed at reasonable values known a priori then the insulin sensitivity parameter is estimated online with a least squares approach and used to compute future insulin input by minimizing a quadratic cost function to control future bg levels there are also models that are specifically developed or used to control blood glucose levels of icu patients in a healthy range in 67 the authors combine the intensive control insulin nutrition glucose icing model introduced in 53 with a subcutaneous insulin delivery model for automated insulin delivery system in 48 in addition to the models used in 67 the authors add another model representing the suppression of endogeneous glucose production by insulin 71 again for purposes of controlling bg levels of critical care patients similarly in 47 the icing model is used with another model respresenting subcutaneous insulin dynamics 84 in a linear zone model predictive control framework nonlinear models representing glucose insulin dynamics are also of interest and using these models for control purposes requires some modification in the computational methodology in 38 a general nonlinear model predictive control nmpc schema is developed to be used for control of systems governed by nonlinear dynamics the problem of bg control in icu is used as an example to show the effectiveness of this nmpc approach in 38 on the other hand it is known that the glycemic control in the icu is fundamentally different than the glycemic control in diabetes as an icu patient could experience an hyperglycemic episode without being diabetic this situation is caused by the body s stress response rather than diabetes therefore it could provide valuable knowledge to understand the pancreatic response of icu patients for this purpose in 65 the authors construct an algorithm to assess the pancreatic response of critical care patients they also show the requirement of incorporating this system in bg control frameworks in in icu settings none of these constructions have been shown to work robustly for data collected in an icu and appear to require continuous glucose monitors cgm and or insulin measurements to function propery cgms are not common and insulin is never measured in icu settings posing a substantial barrier to use 5 an alternative but related approach to prediction is to consider bg levels as discrete time series data and use models such as autoregressive integrated moving average arima for prediction in 87 the authors use an arima model to predict blood glucose levels and hypoglycemia for similar purposes in 68 authors use an autoregressive ar 1 model from a perspective in which the aim is to resolve the mean and variance of blood glucose levels for the purposes of prediction the model that we develop in this paper can be viewed as a generalized ar 1 model a standard ar 1 model uses only the bg measurements and provides predictions based on the information obtained from this data with the model we develop here in addition to the blood glucose measurements we use nutrition and external insulin data to account for non stationarity in the environment and calculate the effects of nutrition and external insulin on the discrete time series by means of an underlying continuous time model in this sense we aim to achieve and enhance what an arima process can do by using an underlying continuous time mechanistic model to describe known and measured environmental factors moreover by constructively formulating the functional form of a model embedded with hard coded physiological mechanisms we are hoping to provide both a pathway for incorporating external physiological knowledge reducing the data required to estimate the model and a modeling framework that being based in physiology is likely to be more interpretable to humans working in systems physiology and in a clinic all of these different models and the algorithms that stem from them demonstrate significant diversity in the dynamics of the glucose insulin system between individuals this highlights the importance of personalized models for parameter inference prediction and control using data collected from individual patients or perhaps once more data is gathered by clustering patients and using representative parameter settings from the appropriate cluster many of the models described have so many unknown parameters that it is very hard to use them in such realistic settings recently some researchers have started to address the applicability of the models in the real patient data setting 70 14 91 and these papers demonstrate some of the difficulties which arise in this paper we aim to develop a simple interpretable mathematical model that in view of its interpretability can be used safely for glucose prediction and control and in view of its simplicity can be trained on patient data we concentrate primarily on the t 2 dm and icu settings and comment briefly on the relevance of our modeling approach for type one diabetes t 1 dm 1 3 our contribution we describe a simple interpretable modeling framework limited to states and parameters that are directly observable or inferable from data for prediction within the human glucose insulin system based on a continuous time linear gaussian stochastic differential equation sde for glucose dynamics in which the effect of insulin appears parametrically we completely describe and detail the inference machinery necessary in a data assimilation and inverse problems framework to estimate a stochastic differential equation model of glucose dynamics with real world data the framework is sufficiently general to be usable within the icu t 2 dm and potentially t 1 dm settings we demonstrate in a train test set up that the models are able to fit individual patients with reasonable accuracy both icu and t 2 dm data are used the test framework we use is a predictive one laying the foundations for future control methodologies comparison of the data fitting for t 2 dm and icu patients reveals interesting structural differ ences in their glucose regulation we make a comparison of the predictive power of our stochastic modeling framework with that of more sophisticated models developed for both t 2 dm and the icu demonstrating that the simple stochastic approach is generally more accurate in both settings 6 1 4 outline an outline of the paper is as follows in section 2 we introduce the general continuous time mathe matical model that describes the human glucose insulin system then in section 3 we introduce the specific versions of this model relevant in t 2 dm and icu settings the two model classes all derive from a single general model and differ according to how nutrition uptake and glucose removal are represented in section 4 we construct the framework for stating the parameter estimation problem and its solution in section 5 we describe the datasets the experiments we design for parameter estimation and forecasting and the methods we use for parameter estimation and forecasting for the t 2 dm and icu settings section 6 presents the numerical results on parameter estimation and forecasting along with some uncertainty quantification uq results separately for t 2 dm and icu settings finally in section 7 we make some concluding remarks and discuss future directions that we intend to pursue 2 continuous time model we begin by providing a constructive explanation of the continuos time model including the model equations the description of unknown model parameters and the precise role of each component of the model then we also provide a detailed conceptual explanation of how a stochastic modeling approach could be used to represent blood glucose dynamics 2 1 components of the model in accordance with our goal which is to develop a highly simplified yet interpretable model we work with a forced sde of ornstein uhlenbeck type to describe glucose evolution together with an observation model of linear form subject to additive gaussian noise the gaussian structure allows for computational tractability in prediction since probability distributions on the glucose state are described by gaussians and hence represented by simply a mean and variance note that the protocols for managing glucose depend on intervals e g a goal may be to keep glucose between 80 150 mg dl and interval deviation from this goal e g 151 180 mg dl induce changes in the insulin dosage this means that decisions are made based on boundaries of glycemic trajectories nevertheless because glucose oscillates under continuous feeding clinicians typically aim to ensure that the glycemic mean does not fall below 60 mg dl or above 180 mg dl for any length of time the intervals are then a proxy for this balance of managing the mean and protecting against trajectories diverging too high or low at any time including between observations hence accurately resolving mean and standard deviation in bg levels is extremely important furthermore the kalman filter may be used to incorporate the data and also works entirely within the gaussian framework and finally parameter learning although non gaussian is well developed in the kalman filter setting both from the fully bayesian and optimization empirical bayes perspectives the ornstein uhlenbeck process has three contributions a damping term which drives the bg level towards its base value at a rate which is possibly insulin dependent a forcing representing nutritional intake and a white noise contribution which is used to encapsulate the high frequency dynamics as these dynamics are difficult to be resolved with sparse measurements the presence of noise in the glucose evolution model as well as in the data acquisition process allows for model error which is natural in view of the the rather simple modeling framework we obtain the following model for the evolution of blood glucose g t g t g t gb m t i t 2 2 w t 2 1 the bg level at time t is measured in the units of mg dl i t is the rate of intravenous insulin insulin iv at time t in the units of u min where u is the insulin unit and m t is the meal function representing the rate of glucose intake at time t in the units of mg dl min here w t is a brownian 7 motion and describes variations in the bg level g t which are not encapsulated in the simple damped driven exponential decay model that we use here in our approach we use the stochastic differential equation as stated in 2 1 in this model gb represents the basal glucose value in mg dl units and is the decay rate of bg level to its basal value with its own effect in the units of 1 min is a proportionality constant for the effect of insulin iv on the bg level in the units of mg dl u and is the variance of the oscillations we will use simple models for the meal function m t and the insulin delivery function i t that will enable explicit solution of the continuous time model between events events in our model are times at which the meal function or insulin delivery function change discontinuously or points at which bg is measured the precise notation will be given below the simple structure of brownian motion w t means that when integrated it will lead to normally distributed random variables in discrete time with analytically calculable means and variances the model is thus highly tractable the equation given in 2 1 is analytically solvable meaning that we can write a formula in continuous time that gives the bg level at any time t the output of the system as a function of the nutrition and insulin delivered up to time t the inputs to the system for computational purposes and because data is typically available in discrete time we need the discrete time version of the model 2 1 the time discretization is defined completely by the dataset in the following sense let t m k km k 1 denote the starting time of meals in the t 2 dm setting and the discontinuous nutrition level change in the icu setting let t i k ki k 1 denote the discontinuous insulin iv level change times in icu setting finally let t o k ko k 1 denote the measurement observation times in both settings we call the re ordered union of these sets tk nk 0 t m k km k 1 t i k ki k 1 t o k ko k 1 to be the event times which naturally identify the time discretization in order to make use of analytical tractability of the model 2 1 and account for the fact that event times occur at discrete irregular times we obtain the discrete time version by integrating 2 1 over the event time intervals tk tk 1 k 0 1 n 1 and refer to the resulting model as the event time model we will exhibit the differing versions of the general event time model for t 2 dm and icu settings in more detail in the following sections but here we make a general overarching observation about the form of the event time model if we integrate 2 1 over tk tk 1 with use of ito formula 1 we obtain that g tk 1 gb e hk g tk gb tk 1 tk e tk 1 s m s ds tk 1 tk e tk 1 s i s ds 1 e 2 hk k 2 2 where hk tk 1 tk and k n 0 1 independent random variables for k 0 1 n 1 2 2 conceptual explanation of how the stochastic model represents glu cose physiology the model we propose represents blood glucose dynamics broadly with two classes of terms determin istic components and stochastic components the deterministic terms govern the mean through both endogenous and exogenous factors for example the mean equilibrium or homeostasis for blood glucose represents one of the endogenous relationships between glucose and insulin through the basal rate similarly changes in the mean are also controlled by the deterministic component but here due to exogenous drivers such as nutrition or administered insulin the stochastic class governs the faster time scale fluctuations about the deterministically specified mean the glycemic fluctuations due to endogenous factors are assumed to be mean zero independent of the value of the blood glucose and are mean reverting to the basal rate in this way the range of the glycemic fluctuations represent the endogenous glucose insulin oscillatory dynamics that are often difficult to resolve given the sampling rate effectively the glycemic fluctuations due to endogenous insulin random effects and moderate 1 equivalent to using integrating factors in this case 8 changes in activity e g walking from a car to a restaurant are modeled as fast time scale random fluctuations of glucose more explicitly the deterministic governing terms of the model determine the rate of change of mean blood glucose level the first deterministic term g t gb in the general version of the model given in 2 1 represents the endogenous regulation either by consumption or by secreted insulin to revert blood glucose level to its person specific basal glucose value gb with a person specific rate in the absence of nutrition and exogenous insulin the basal value represents the mean blood glucose level that all glycemic trajectories fluctuate around and are reverted to the second category of deterministic terms including m t represents and quantifies the effect of exogenous nutrition on the rate of change of the blood glucose level nutrition increases the rate of change and cause the blood glucose level to increase as the rate and amount of exogenous nutrition delivery increases the third category of terms including i t represents the effect of exogenous insulin on the rate of change of the blood glucose level exogenous insulin drives the rate of glucose use to increase causing the blood glucose level to decrease both the second and third classes of terms are able to shift the glycemic equilibrium depending on their amount and the length of time they are present and effective the stochastic governing terms of the model determine the fast time scale fluctuations about the mean blood glucose level effectively determining the variance of the glycemic fluctuations about the mean these fluctuations are formulated to be continuous in time random processes that are specified only by amplitudes their coordinates are variances rather than an exact glucose position implying that the true trajectory of the blood glucose level is never resolved but with oscillations or fluctuation amplitudes in this way we are assuming that the glycemic fluctuations due to endogenous factors e g glycemic fluctuations due to small amounts of movement are captured by the random terms in the model because we do not have data to resolve the existence or source of these glycemic fluctuations we are effectively considering the unresolvable glycemic fluctuations to be random effects larger changes in a mean e g via exercise would be controlled by the deterministic components of the model we do not include a term that could account for more vigorous exercise explicitly because we do not collect data that would allow such a term to be inferred it is possible that a combination of existing deterministic and stochastic parameters e g that controls the rate of return to basal are enough to fully explain exercise based variation in blood glucose but as we do not currently have the data to evaluate this question we cannot evaluate success or failure of the model s ability to account for exercise there is an interplay between the stochastic and deterministic components of the model for example while the movement of the mean is controlled by the deterministic terms reversion to the mean is controlled both by deterministic and stochastic terms meaning the ability of the body to regulate glucose homeostasis by endogenous means via the reversion to the mean is controlled by both the deterministic and the stochastic terms it is clear that this model has limiting factors the key question is how do these limiting factors affect our ability to predict blood glucose and the body s response to exogenous inputs of particular importance is an understanding of what fidelity is lost and what features are differently resolvable with the stochastic and the non stochastic models note also that from another perspective the resulting sde model may also be considered as a more sophisticated version of the arima type models referenced in the earlier literature review which are used to describe stochastic processes generally with the aim of analyzing data and or forecasting future values more precisely the model given in 2 2 can be thought as an arima model with specific interpretable and time inhomogeneous coefficient structure adopting this point of view can be interpreted as using the simplicity of arima models but formulating the parametric dependence of the coefficients in such a way that the resulting model is also a representative of the underlying physiology 9 3 event time model in this section we show how the general continuous time model 2 1 takes specific forms in the t 2 dm and icu settings in sections 3 1 and 3 2 we define the specific meal function for each case and derive the final discrete time model which we refer to as the event time model note also that the focus of our data driven studies here are the icu and t 2 dm patients the development of an analogous t 1 dm model is not considered here and is left for future work the general model in 2 1 takes different forms when it is stated in different settings for example in the icu setting the meal function m t is a piecewise constant function describing a constant rate of nutrition it is important to note that because of the way that the nutrition is delivered to the icu patients it is a reasonable modeling choice to use a piecewise constant function made quantitative using the raw nutrition data i e the amount of carbohydrates to model the effect of nutrition on the blood glucose level moreover as we will explain in more detail in section 7 attempts at using a smoother function to mimic gradual decrease in the effect of nutrition delivery on blood glucose level did not yield better forecasting results on the other hand in the t 2 dm setting our dataset includes the total glucose amount ingested at each meal and through initial experiments with simpler models we determined that in this context it is important to model the time history of the resulting glucose intake as this happens in a more complicated fashion than for icu patients to this end we use a function consisting of the difference of two exponential functions to model the effect of each meal on the blood glucose level in a realistic manner that is for each meal the effect of the nutrition on the blood glucose level proportionally to the carbohydrate amount in the meal initially increases monotonically reaches a peak value after a time on the order of an hour and then starts to decrease to an negligible level over a time on the order of hours this behavior namely how long it takes to reach the peak value and how long it takes to effectively disappear from the system is characterized by two unknown model parameters these are estimated from the data more details about this function are given in section 3 1 taking into account all of these sorts of differences we state the event time version of the continuous general model in 2 1 3 1 t 2 dm in this setting we will consider a system that is driven by nutrition namely the only input to the model in its current version is the nutrition that is we are developing a t 2 dm model assuming that individuals do not inject insulin since none of the patients in our dataset use subcutaneous insulin however we could easily modify the model to include injectable insulin note that besides incorporating the effect of injectable insulin into the model we will also modify it to account for the use of drugs such as metformin so in this setting we choose to model glucose removal to occur at a constant rate setting 0 the variable i t which represents the rate of insulin iv does not enter the model at all on the other hand the meal function m t in this case requires to make some additional modeling decisions as briefly described above in order to model the glucose input from each meal into the system we use the difference of two exponential functions there are two reasons for making this choice the first is to describe the uptake of glucose into the bloodstream via ingestion through the stomach and the second is to have a smooth function of model parameters from which we will benefit when performing parameter estimation from data note that using a smooth function to model glucose intake has a substantial impact on inference and the details about the choice of this function will be discussed later in section 7 now recall that t m k km k 1 denotes the starting time of the meals over the whole time interval that we work on then we define m t km k 1 gk ck e a t t m k e b t t m k t m k t 3 1 where gk is the total amount of glucose mg dl in the k th meal and ck is normalizing constant so that t m k e a t t m k e b t t m k dt 1 for k 1 2 km also a is called the characteristic 10 function and defined as follows a x 1 x a 0 x a therefore the model in 2 1 becomes g t g t gb km k 1 gk ck e a t t m k e b t t m k t m k t 2 2 w t 3 2 in the t 2 dm setting in this model the first term represents body s own effect to remove insulin from the bloodstream the second term represents the effect of nutrition on the rate of change of bg and the last term models the oscillations in the bg level integrating over t 0 t we can write the analytic solution of this equation as g t gb e t t 0 g t 0 gb km k 1 gk ck e a t t m k e t t m k a e b t t m k e t t m k b t m k t t t 0 e t s 2 2 dw s 3 3 note that in practice we need to evaluate bg level at specific time points and hence need the discrete time model implied by the continuous time representation in 3 3 now by integrating 3 2 over tk tk 1 and denoting gk g tk for k 0 1 n we obtain gk 1 gb e hk gk gb mk 1 e 2 hk k k 0 1 2 n 1 3 4 as a special case of 2 2 also for any fixed tk find the meal times t m j such that t m j tk and denote the index set of these meal times by ik then mk in 3 4 becomes mk j ik gj cj e a tk 1 t m j e hke a tk t m j a e b tk 1 t m j e hke b tk t m j b 3 5 for k 0 1 2 n 1 hence note that in this case we have five model parameters to be estimated gb a b recall that in this setting gb represents the basal glucose value that bg level stays around starting some time after nutrition intake until the next nutrition intake represents the decay rate of bg level to gb after the nutrition intake and represents the amplitude of the bg level oscillations the parameters a and b entering the meal function implicitly control the time needed for the glucose nutrition rate to reach its peak value and the time needed for this rate to return back to the vicinity of 0 because of these simple physiological meanings the parameters entering the event time model are important not only for accurately capturing and predicting glucose dynamics based on data but also contain implicit information about the health condition of the patient for example the basal glucose value is measured during some tests to check if an individual is healthy pre diabetic or diabetic 3 2 icu in the icu setting real data is available for both nutrition and insulin iv nutrition is typically delivered through enteral feeding tube which is a mechanism to deliver nutrition via a tube entering to the mouth and running to the gut on the other hand 8 10 of the icu patients are diabetic and only 5 of those are t 1 dm patients however more than 90 of icu patients require glycemic management and 10 20 of them experience a hypoglycemic event over the course of management 11 consequently regardless of being diabetic or non diabetic they are typically given insulin iv to control bg levels for simplicity and because it is a reasonable approximation of reality i e insulin iv and tube feed are delivered at a constant rate we approximate both nutrition and insulin as piecewise constant functions furthermore in contrast to the situation for t 2 dm we do not set 0 unless patient is not delivered insulin iv in this case t m k km k 1 represents the change of rate times for nutrition and the meal function becomes m t km k 1 dk t m k t m k 1 t 3 6 where dk is the nutrition rate over the time interval t m k t m k 1 k 1 km that is directly obtained from the dataset remember that the insulin rate function i t is also a piecewise constant function which we formulate as i t ki k 1 ik t i k t i k 1 t 3 7 where ik is the rate of insulin over the time interval t i k t i k 1 again obtained directly from the data set therefore substituting 3 6 and 3 7 into the general equation 2 1 the icu version of our model becomes g t g t gb km k 1 dk t m k t m k 1 t ki k 1 ik t i k t i k 1 t 2 2 w t 3 8 in this model the first term models the glucose removal rate with body s own effort the second term shows the effect of nutrition on the bg level the third term i t models the external insulin effect and the last term models the oscillations in the bg level now integrate 3 8 to get the analytical solution for any t t 0 as follows g t gb e t t 0 g t 0 gb km k 1 dk t t 0 e t s t m k t m k 1 s ds ki k 1 ik t t 0 e t s t i k t i k 1 s ds 2 2 t t 0 e t s dw s 3 9 for the same reasons explained in the t 2 dm setting we will put together all event times and rewrite the meal function m t and the insulin function i t with respect to this new discretization of the time interval then once again using the same notation and integrating 3 8 over tk tk 1 we obtain the discrete version as follows gk 1 gb e hk gk gb 1 1 e hk dk 1 1 e hk ik 1 e 2 hk k k 0 1 2 n 1 3 10 as another special case of 2 2 note that in this case we have four model parameters to estimate gb remember once again gb is the basal glucose value and is the decay rate of the bg level to its basal value and is a measure for the magnitude of the bg oscillations finally is another proportionality constant which is used to scale the effect of insulin iv on the bg rate change appropriately these four parameters represent physiologically meaningful quantities that could properly resolve the mean and variance of the bg level 12 4 parameter estimation our goal in this section is to formulate the parameter estimation problem in section 4 1 we construct an overarching bayesian framework for our parameter estimation problems we then describe two solution approaches for this problem an optimization based approach which identifies the most likely solution given our model and data assumptions and mcmc which samples the distribution on parameters given data under the same model and data assumptions these two solution approaches are detailed in sections 4 2 and 4 3 respectively as shown in detail before our model takes slightly different forms in the t 2 dm and icu settings in the former the model parameters to be estimated are gb a b whereas in the latter the unknown parameters are gb however we adopt a single approach to parameter estimation to describe this approach we let the vector represent the unknown model parameters to be determined from the data noting that this is a different set of parameters in each case many problems in biomedicine and the problems we study here in particular have both noisy models and noisy data leading to a relationship between parameter and data y of the form y g 4 1 where unknown is a realization of a mean zero random variable but its value is not known to us the objective is to recover from y we will show how our models of the glucose insulin system lead to such a model 4 1 bayesian formulation the bayesian approach to parameter estimation is desirable for two primary reasons first it allows for seamless incorporation of imprecise prior information with uncertain mathematical model and noisy data by adopting a formulation in which all variables have probabilities associated to them secondly it allows for the quantification of uncertainty in the parameter estimation whilst extraction of information from the posterior probability distribution on parameters given data is challenging stable and practical computational methodology based around the bayesian formulation has emerged over the last few decades see 76 in this work we will follow two approaches a obtaining the maximum a posteriori map estimator which leads to an optimization problem for the most likely parameter given the data and b obtaining samples from the posterior distribution on parameter given data using markov chain monte carlo mcmc techniques now let us formulate the parameter estimation problem within the event time framework let g gk n k 0 be the vector of bg levels at event times tk n k 0 and y yk ko k 1 be the vector of measurements at the measurement times t o k ko k 1 tk n k 0 by using the event time version and defining k nk 0 to be independent and identically distributed standard normal random variables we see that given the parameters g has multivariate normal distribution i e p g n m c equivalently g m c n 0 i 4 2 let l be a ko n 1 matrix that maps gk nk 0 to yk ko k 1 that is if a measurement i 1 ko is taken at the event time tj j 0 1 n then the ith row of l has all 0 s except the j 1 st element which is 1 adding a measurement noise we state the observation equation as follows y lg n 0 i 4 3 where is a diagonal matrix representing the measurement noise thus we obtain the likelihood of the data given the glucose time series and the parameters namely p y g n lg 13 however when performing parameter estimation we are not interested in the glucose time series itself but only in the parameters thus we directly find the likelihood of the data given the parameters implicitly integrating out g by combining 4 2 and 4 3 to obtain y lm s n 0 i 4 4 where s lc lt since has multivariate normal distribution using the properties of this distribution we find that given the parameters y also has multivariate normal distribution with mean lm and covariance matrix s this is the specific instance of equation 4 1 that arises for the models in this paper we have thus obtained p y n lm s that is p y 1 2 km det s exp 1 2 y lm ts 1 2 y lm 4 5 this is the likelihood of the data y given the parameters also since we prefer to use log p y rather than directly using p y for the sake of computation we state it explicitly as follows log p y km 2 log 2 1 2 log det s 1 2 y lm ts 1 y lm 4 6 moreover by using bayes theorem we write p y p y p p y p y p 4 7 note that the second statement of proportionality follows from the fact that the term p y on the denominator is constant with respect to the parameters and plays the role of a normalizing constant from another point of view considering 4 2 and 4 4 we see that given g y has multivari ate normal distribution with mean and covariance matrix that could be computed from the above equations since given everything is explicitly known then integrating g out in other words computing the marginal distribution we obtain the distribution of y which corresponds to the one stated in 4 4 now to define the prior distribution p we assume that the unknown parameters are distributed uniformly across a bounded set and define p 1 1 0 4 8 where is the characteristic function as defined above and is the volume of the region defined by thus by substituting the likelihood 4 5 and the prior distribution 4 8 into 4 7 we formulate the posterior distribution as follows p y 1 2 km det s exp 1 2 y lm ts 1 2 y lm 4 9 now we will show how we use this posterior distribution to state the parameter estimation problem 4 2 optimization in this approach the goal is to determine parameter values which maximize the posterior distri bution p y and is called to be the map estimator using the prior distribution as specified above the parameter estimation problem becomes arg max p y arg max p y arg min log p y 4 10 14 then substituting 4 6 into 4 10 the problem will take the form arg min s 1 2 y lm 2 log det s 4 11 hence placing uniform prior distribution turns the problem of finding the map estimator into a constrained optimization problem to solve this problem we use built in matlab functions such as fmincon and multistart fmincon is a gradient based minimization algorithm for nonlinear func tions multistart starts the optimization procedure from the indicated number of starting points that are picked uniformly over the region defined by the constraints it uses fmincon and other simi lar type of algorithms to perform each optimization process independently and provides the one that achieves the minimum function value among the result of all separate runs with this approach we have the opportunity to compare different optimization procedures that starts from different initial points this provides some intuitive understanding of the solution surface and hence the estimated optimal parameters 4 3 mcmc once an optimal point has been found we may also employ the laplace approximation 56 62 to obtain a gaussian approximation to the posterior distribution the laplace approximation is a reasonable approximation in many data rich scenarios in which all parameters are identifiable from the data because of the bernstein von mises theorem 81 which asserts that the posterior distribution will then be approximately gaussian centered near the truth and with variance which shrinks to zero as more as more data is acquired however data is not always abundant and not all parameters are identifiable even if it is in this setting sampling the posterior distribution is desirable mcmc methods are a flexible set of techniques which may be used to sample from a target distribution which is not necessarily analytically tractable 54 69 for example the distribution p y is the conditional distribution of the random model parameters given the data y even though we can explicitly formulate it as in equation 4 7 it is not always an easy task to extract useful quantities such as posterior mean and variance from that formula in such cases mcmc techniques are used to generate random samples from this target distribution and this random sample is used to obtain the desired information which could be anything such as the mean mode covariance matrix or higher moments of the parameters moreover this technique is also very helpful to obtain uq results for the estimated parameters in order to obtain more extensive knowledge than map estimator can provide about the posterior distribution of parameters given the data y we use mcmc methods as a natural choice to sample from that distribution among different possible algorithms see 29 we use the standard random walk metropolis hastings algorithm in order to make sure the resulting sample is indeed a good representer of the posterior distribution we perform some diagnostics such as checking if chains for each parameter converged and if they are uncorrelated then after removing the burn in period we compute the mean and the covariance matrix fro the remaining part of the sample we use the mean as a point estimator for simulation and forecasting and the covariance matrix provided valuable information to quantify uncertainty for the estimated parameters in general it is hard to obtain efficient results with mcmc methods even when sampling from the joint distribution of four or five parameters due to the issues such as parameter identification moreover obtaining accurate results with this approach requires careful choice of starting point and tuning some other parameters in general the performance of the algorithm will depend on the initial point we tested the use of both random starting points and map estimators as starting point the former enables us to detect when several modes are present in the posterior distribution the latter helps to focus sampling near to the most likely parameter estimate and to quantify uncertainty in it however it is also important to note that using map estimator as a starting point is not helpful in all cases more precisely if the map estimator is not a global minimum but a local minimum then 15 the chain could get stuck around this point therefore it requires careful analysis comparison and synthesis of the results obtained with these different approaches 5 methods datasets and experimental design in this section we describe the datasets that we have in the t 2 dm and icu settings the experiments that we design to present our numerical results and the methods that we follow to perform parameter estimation and forecasting depending on the specifics of each case and to reflect the real life situation we designed slightly different experiments in the t 2 dm and icu settings however the mathematical solution approaches for parameter estimation and forecasting stay the same for both settings because we use similar mechanistic models in this opening discussion we first describe the features that are common to both the t 2 dm and the icu settings the two following subsections 5 1 5 2 then detail features specific to each of the two cases because we use a linear gaussian stochastic differential equation to model the bg level our forecast is a gaussian characterized by its mean and standard deviation hence rather than having a point estimate for the future bg levels we obtain a normal random variable for each prediction in testing predictions of the model it is natural to check if 1 and 2 stdev intervals around the respective means capture the true bg levels note that the probability of a gaussian random variable to take values within 1 and 2 stdev regions around its mean are 68 and 95 respectively we define the observational noise covariance defined in 4 3 to be a diagonal matrix with form diag lm whilst we could estimate alongside from the data we have chosen a heuristic to set it in advance specifically we found that above a value of around 0 3 all forecasts were very noisy and contained little predictive value on the other hand below 0 3 results appeared to be fairly robust to the value chosen for in all the experiments presented in section 6 we choose 0 1 5 1 t 2 dm 5 1 1 model parameters and dataset in this setting we use the model 3 4 with the function mk defined as in 3 5 hence there are five parameters to be estimated basal glucose value gb bg decay rate the measure for the amplitude of bg oscillations and a and b which are the parameters implicitly modeling the time needed for the rate of glucose in the nutrition entering the bloodstream to reach its maximum value and the total time needed for this rate to decrease back to 0 we assume that the prior distribution is non informative and initially the parameters are independent except for a constraint on the ordering of a and b we determine realistic lower and upper bound values for each of them define 0 750 0 5 0 100 0 01 0 05 0 01 0 05 in the order of gb a b and then define from by adding the constraint a b we thereby form the prior distribution as defined in 4 8 recall that these bounds define the constraints employed when we define the parameter estimation problem in the optimization setting for the map point the set is determined from clinical and physiological prior knowledge and by simulating the model 3 2 and requiring realistic bg levels data are collected from three different t 2 dm patients for each patient the dataset consists of the meal times the glucose amount in the meal and bg measurements along with the measurement times more detailed information on the dataset such as number of measurements recorded meals and mean glucose value over training testing or over entire data sets can be found in table 5 1 5 1 2 parameter estimation and uncertainty quantification we perform parameter estimation for three patients separately first we estimate parameters by using data over four consecutive non overlapping time intervals with optimization and mcmc approaches 16 besides estimated values we also provide uq results in the optimization setting we use the laplace approximation as discussed at the start of subsection 4 3 the optimal parameters determine the mean of the gaussian approximation and the inverse of the hessian matrix becomes the covariance matrix providing the tools for uq in the mcmc approach we use the resulting random samples for uq 5 1 3 forecasting we adopt a train test set up as follows since the health conditions of the t 2 dm patients are unlikely to change over time intervals that are on the order of days we design an experiment in which we use one week of data for training the patient specific parameters then we use the estimated parameters to form a patient specific model and use this model to forecast bg levels for the following three weeks using the known glucose input through the meals this leads to a three week testing phase from a practical patient centric point of view this leads to a setting in which forecasting bg levels for the following three weeks requires patients to collect bg data for only one week in every month and then the patient specific model will be able to capture their dynamics and provide forecasts based on nutrition intake data over the rest of the month 5 2 icu 5 2 1 model parameters and dataset in the icu setting we use the model 3 10 and there are now four parameters to be estimated basal glucose value gb bg decay rate the parameter used to quantify the amplitude of the oscillations in the bg level and a proportionality constant to scale the effect of insulin iv on the bg level similar to what we did in the t 2 dm setting we find realistic lower and upper bounds for the unknown parameter values and set 0 750 0 02 1 0 100 20 110 to obtain the prior distribution as defined in 4 8 in this case we impose two further linear constraints namely gb 3 5 115 and 1110 10 these constraints are imposed to ensure that the model predictions remaining biophysically plausible and are determined simply by forward simulation of the sde model the resulting inequality constraints do not overly constrain the parameters in that good fits can be found patient id patient 1 patient 2 patient 3 total glucose measurement 304 211 91 total meals recorded 122 76 46 total days measured 26 6 27 67 28 12 mean measured glucose 113 25 127 32 124 26 training set glucose measurement 80 53 29 training set meals recorded 26 18 15 training set days measured 7 02 7 7 05 training set mean measured glucose 112 25 116 28 125 24 testing set glucose measurement 224 158 31 testing set meals recorded 96 58 62 testing set days measured 19 58 20 67 21 07 testing set mean measured glucose 113 25 130 33 123 27 table 5 1 information about the data set that is used in the t 2 dm setting which is collected from three different t 2 dm patients note that there is a considerable variability between the data collection behaviour of each patient which is also reflected in the number of recorded measurements and meals also recall that we intentionally used one week of data for training and the following three week of data for testing 17 which satisfy these constraints and yet they yield more realistic bg level behavior than solutions found without them thus as in the t 2 dm case we the bounds and constraints chosen are based on physiological knowledge and requiring simulated bg levels resulting from values within the region to be realistic in this case the dataset consists of the rate of glucose in the nutrition and the rate of insulin infusion along with the times at which there is a rate change it also contains the bg measurements and the measurement times summary statistics about the data set that is used in the icu setting can be found in table 5 2 note that in this case we used all available data for each patient to perform parameter estimation and forecasting and all three icu patients are non t 2 dm patient id patient 4 patient 5 patient 6 total glucose measurement 177 204 271 total days measured 13 99 16 8 24 48 mean measured glucose 141 18 151 32 151 43 training set average glucose measurement 14 13 13 5 14 07 testing set average glucose measurement 1 1 1 table 5 2 information about the dataset that is used in the icu setting collected from three icu patients who are not t 2 dm because of the experiment we designed the training sets are moving with by overlapping with each other so we provide average number of glucose measurements over these moving windows also since we forecast until the next measurement time following the training time window each testing set contains only one glucose measurement other information that is included in table 5 1 but not here such as mean measured glucose over training set s is neither meaningful nor helpful in this setting 5 2 2 parameter estimation and uncertainty quantification we use both the optimization and mcmc approaches for parameter estimation in a patient specific manner in this setting too however for uq we use only mcmc to estimate the posterior mean and variance on the parameter this is because there were cases where it was not appropriate to use the laplace approximation something that will be explained in more detail in section 6 2 5 2 3 forecasting patients in the icu exhibit bg time series that are very different from t 2 dm patients in particular the time series is often non stationary in complex ways and on different time scales on slower time scales patients eventually leave the icu because their health either improves or declines but there can be fast time scale changes too due to interventions and or sudden health related events such as a stroke these health changes will lead to changes in the best fit parameters of the model in other words the patient specific model itself may change abruptly in contrast to the t 2 dm case where changes in the best fit parameters typically occurs on a much longer time scale and reflects gradual changes in health condition to avoid compensating for different values of parameters over longer time intervals and to make more accurate predictions we use only one day of data for parameter estimation in the icu moreover to construct an experiment that reflects real life scenarios we need be able to estimate the model parameters with smaller size datasets than in the t 2 dm case because of the imperative of regular intervention within the icu setting typically on a time scale of hours as a consequence our train test set up in this case differs quantitatively from the t 2 dm case the training sets for each patient consist of approximately one day of data over a moving time intervals with end points chosen to be bg measurement times thus the time windows are obtained by moving the left end point to the next bg measurement time and choosing its right end point with the constraint that it contains approximately one day of data and the new time window is not contained in the previous 18 one so in this case there is a large overlap between the consecutive time windows of the training sets on the other hand because of rapidly changing conditions forecast of bg levels needs only to be accurate over shorter time scales too indeed in general it is important to know glycemic dynamics on the order of hours not days to manage the glycemic response of patients so for each training set the left end point of the time window of the corresponding testing set is chosen to be the right end point of the time window of the patient s training set then we choose the right end point of the test set to be the next bg measurement time we follow the same procedure over the moving time intervals to the end of the whole dataset for each patient note that from a practical point of view this experiment exhibits a real life situation in which we use only one day of data for parameter estimation and then perform forecasting for the next few hours based on the estimated parameters such a set up would be desirable as a support to glycemic management of these patients 5 3 evaluation metrics before having a closer look at the numerical results in the next section let us give the definitions of the statistics that will be used to evaluate and compare the forecasting capability of the models let yi ni 1 denote the true bg measurements over the predefined testing time window for an experiment let y i ni 1 denote the forecast at the true measurement time points obtained by a model note that if the model is a stochastic one y i ni 1 represents the mean of the model output while it is simply the model output for a deterministic ode model when a stochastic model is used it is natural to obtain a confidence interval as this may be obtained as a direct consquence of the fact that the model output is in the form of a random variable such a model output cannot be obtained for an ode type of a model when parameters are learned through optimization however by using appropriate parameter and state estimation techniques it may again be possible to obtain a similar kind of confidence interval for the model output which is in the form of a point estimate when we have probabilistic forecasts we let i ni 1 denote the corresponding standard deviation for each forecast at the true measurement points so that we can form 1 and 2 stdev bands as y i i y i i ni 1 and y i 2 i y i 2 i n i 1 respectively then for each model we can compute the percentage of true measurements yi ni 1 that are captured in their respective 1 and 2 stdev bands these two percentages will be two of the evaluation tools that will be used in evaluation below in addition in some cases we will use standard measures such as mean squared error mse root mean squared error rmse and mean percentage error mpe which are computed as follows mse 1 n n i 1 yi y i 2 rmse 1 n n i 1 yi y i 2 mpe n i 1 yi y i yi 100 6 numerical results in this section we present numerical results concerning the simple yet interpretable model introduced in this paper we refer to this as the minimal stochastic glucose msg model from now on for ease of exposition the two primary conclusions are that we can achieve good accuracy forecasting future bg levels in both the t 2 dm and icu settings and the uncertainty bands with which we equip our forecasts play an important role in this regard we can learn a substantial amount about the interpretable parameters within the models with possible clinical uses deriving from the parameter estimates and from tracking them over time again using the uncertainty measures that accompany them as measures of confidence 19 we justify these conclusions using t 2 dm self monitoring data from a previous prospective self management trial and using retrospective icu data extracted from the columbia university medical center clinical data warehouse the combination of simple predictive model and data acquisition model accounts for the uncontrolled and complex nature of the data including data sparsity inac curacy noisiness non stationarity and biases resulting from the health care process 3 9 41 42 43 44 51 66 whilst also being interpretable and leading to patient specific parameter inference and prediction to forecast bg for individuals we first solve the parameter estimation problem to entrain the model to the individual and we present the numerical results in this order even though the msg model is relatively simple physiologically it is not always identifiable given data for example having two parameters and related to bg decay rate in the icu context made it hard to identify these parameters accurately given the sparsity of the data the non stationarity of the patient and the complexity of the glycemic dynamics despite lack of identifiability of some parameters parameters as estimated lead to models which are able to forecast and represent the glucose insulin dynamics for example in both the t 2 dm and icu cases the uq results along with estimated parameter values indicate that the estimates of both the basal glucose rate gb and the proportionality constant be tween the basal glucose rate and the variance of the glycemic dynamics reflect realistic values with uncertainties that manage to capture future data but remain narrow enough to potentially delineate different treatment pathways to answer whether the parameter estimates forecasts and uncertainty quantification are good enough to impact clinical understand and decision making or to construct physiologically anchored phenotypes 4 5 7 would require evaluation e g manual chart review in conjunction with a qualitative trial of clinical decision making or a phenotyping analysis respectively in the absence of these analyses we will rely on face validity validation 19 37 85 of the forecasting and uq capturing future measures as well as a host of quantitative measures of forecast accuracy we also reemphasize that the parameter estimates themselves may be useful as they carry information about gradual disease progression t 2 dm and sudden changes in health condition icu 6 1 t 2 dm we will start by showing numerical results for parameter estimation and forecasting based on the real world data collected from t 2 dm patients these results demonstrate the effectiveness of the msg model in capturing the patients bg dynamics specifically the effectiveness is reflected in the estimated parameter values and in the efficacy in forecasting future bg levels using these parameters over time periods of length up to three weeks 6 1 1 parameter estimation our numerical results exhibit three substantive pieces of evidence which support the validity of the model and its potential effectiveness for both understanding the physiologic state of an individual and for forecasting for that individual in the context of t 2 dm first the estimated model parameter values and their evolution over time are physiologically meaningful that is the estimated values reflect the patient s state as evaluated given available data moreover the evolution of the estimated parameter values over time reflects changes in the patients states in a manner consistent with both the data and what is known about the non stationary nature of t 2 dm second the uq intervals for the estimated parameters are physiologically plausible and have three features that make the model potentially useful i relative to the value of the estimated parameter the uq intervals are wide enough to provide information on the reliability of the point estimates of the model parameters ii the uq intervals evolution over time demonstrating a sensitivity to time and the ability to adapt to non stationary patients and iii the uq intervals are narrow enough to plausibly be used to differentiate behavior choices and third the uq and parameter estimation appears to be robust different estimation methods arrive at similar results a comparison of the estimated parameter values and corresponding uq intervals obtained using optimization and mcmc are very similar in almost all of the cases implying robustness of the estimates and a relative insensitivity to the estimation 20 a optimization b mcmc c optimization d mcmc e optimization f mcmc figure 6 1 parameter estimation and uncertainty quantification in the t 2 dm setting the left hand panel is obtained with optimization and the right hand panel is obtained with mcmc both are in a patient specific manner it shows that the point estimates obtained with two approaches are very close to each other in most cases also the width of the 1 and 2 stdev intervals which are obtained with laplace approximation in the optimization case and directly from the approximate posterior samples in the mcmc setting are also agreement with each other in addition obtaining estimated values that are in alignment with real physiological values these results enforces the reliability of the parameter estimation results methodology together these features imply that with a reasonable inference scheme this model could potentially provide useful information for clinical decision making and deeper clinical understanding of the patient robustly to demonstrate that the estimated parameters are physiologically meaningful consider figure 6 1 where we see the point estimates as well as uq intervals for all parameters and all three patients obtained with optimization and mcmc methods the estimated basal glucose gb values are in the 21 ranges of 95 105 mg dl 105 140 mg dl and 105 125 mg dl over the course of four weeks for patients 1 2 and 3 respectively these values are indeed in the expected ranges based on the bg measurements of these patients in addition as we will describe later in more detail the estimated parameters are able to usefully predict the glycemic mean and variance of patients with t 2 dm on time scales of around three weeks the forecast of glycemic mean and variance in response to nutrition is limited to three weeks because the data shows non stationary effects over longer time intervals figure 6 1 reveals parameter changes that over four weeks are significant enough to render predictions less reliable whilst on a three week time horizon they are accurate to show that the uq intervals are potentially useful in practice once again consider figure 6 1 the range of uq intervals for each estimated parameter in most of the cases contains physiologically plausible parameter values that are tight enough to enforce the reliability of the point estimates of the parameters to quantify this statement we computed the coefficient of variation defined as the standard deviation over the mean this measure is generally interpreted as a dispersion of the probability density and can be interpreted as the variability of the distribution in relation to the mean smaller values of coefficient of variation imply less variability or dispersion within the population and that the distribution is accumulated around the mean when the coefficient of variability is low point estimates of the mean are particularly meaningful and represent the population well whereas when the coefficient of variation is large the mean is less representative of the population as a whole note that the population we are quantifying here is not of different patients but rather a population of different forecasts parameter estimates or realizations of the stochastic model for the same patient at a given time for basal glucose rate gb and amplitude of oscillations the coefficient of variation is in the 2 3 band and 8 20 band respectively for all three patients implying that the mean of the estimated gb is a very good point estimator even though the coefficient of variation values are not as small for these values are still quite small and demonstrate limited dispersion together these results support the reliability of the point estimates that are used to form patient specific models to describe dynamics of each patient in addition the evolution of these uq intervals for each parameter over four weeks present in figure 6 1 demonstrates their sensitivity to time and the model s ability to adapt and capture the non stationarity in the dynamics of patients over time we can see the robustness of the estimated parameter values by comparing parameter estimates using two different methods mcmc and optimization the results are shown in figure 6 1 the left and right columns show parameter estimates using optimization and mcmc respectively the point estimates as well as the corresponding uq intervals for basal glucose value gb and amplitude of oscillations obtained with optimization and mcmc are very close to each other some parameters have more variation between methods specifically the rate of decay to the basal glucose rate and the meal function nutrition absorption parameters a and b do show variation between the results obtained with optimization and mcmc methods this variation does not seem to have substantial effect on the model s ability to represent patient dynamics the overall result is a model whose ability to represent the data is relatively insensitive to parameter estimation techniques 6 1 2 forecasting the stochastic modeling approach is simple in the sense that we have few state and parameters and the model s high frequency dynamics are represented as a diffusion process whose centroid is governed by processes such as physiology driven mean reversion in contrast this modeling approach is complex because a stochastic process doesn t have an explicit glucose trajectory a particular glucose value at a given time but rather is a function that defines a glycemic distribution at every time point e g with a mean and a variance because of this subtly the model is both intuitive it reflects what we know and do not know about glycemic dynamics at given unmeasured time and it is foreign because there is not an explicit glycemic trajectory however we can construct an example glycemic trajectory or a realization of the stochastic process by sampling the sde defined glycemic distribution at every time point in another words the realization is one of the infinitely many possible trajectories that the stochastic process could follow when it is realized similarly we assume the collected measurements 22 represent a realization of a random process that is described by the solution of our sde model together these pieces form a framework within which we interpret and evaluate the model as such we evaluate the model along two pathways a face validity pathway that is mostly motivated by potential clinical decision making and a more statistical based pathway that is motivated by our desire to be quantitative in a sense both evaluations address whether the data could plausibly be generated by the model the first evaluation face validity is to consider whether the model can capture the dynamics qualitatively because the model s forecast is in the form of a distribution the forecast we have to evaluate is anchored to the mean and standard deviation an initial inspection of figure 6 2 a where the red circles represent the true bg measurements and blue crosses represent one realization of the model over only the first week of the test set does indeed seem to represent the data well the second evaluation quantifies how plausible it is that the data we observe could have originated from the model we quantify this plausibility using the two sample kolmogorov smirnov ks test to start figure 6 2 b shows the kernel density estimates obtained from the bg measurements blue curve and from ensemble of 100 different realizations of the estimated stochastic process red curve over the same time period in figure 6 2 a to generate the data to compute the model based density estimate we select a sample from the distribution defined by the model at every time point the model can also be visualized as a probability density function for example the kernel density estimate of a model realization is the probability density function of the distribution and the real data are shown in the right panel of figure 6 2 the similarity of the behavior of the estimated realization blue crosses with the assumed realization red circles of the stochastic process in figure 6 2 a and kernel density estimates in figure 6 2 b support the idea that both are plausible draws from the same distribution to calculate the two sample kolmogorov smirnov ks test we created data sets i resampled 1 000 points from the raw bg measurement data and ii a realization of the estimated stochastic process over the same time period as shown in figure 6 2 a the two sample kolmogorov smirnov test did not reject the hypothesis that the two samples came from the same distribution with a p value of 9 8217 10 9 this implies that our initial assumption which is that the bg values can be described by our simplified stochastic model is indeed a valid assumption in this setting given this understanding of the model our evaluation of bg forecasting focuses on evaluating a an arbitrary realization with bg measurements b kernel density estimates figure 6 2 in 6 2 a a realization of the estimated ornstein uhlenbeck process is shown over the first week of the test data along with the true bg measurements and in 6 2 b kernel density estimates of bg measurements and realizations of the estimated model are shown in 6 2 a the red circles show true bg measurements the blue crosses show an arbitrary realization of the model output and the gray area represents the estimated 2 stdev band around the mean of the model output this figure shows rationale behind the msg model comparison of the true bg measurements and an arbitrary realization of the estimated distribution implies that they could indeed be considered as two different realizations of the same random process as most of the true and simulated bg levels stay within the 2 stdev band 23 a patient 1 b patient 2 c patient 3 figure 6 3 forecasting results in the t 2 dm setting obtained via models formed by using the esti mated parameters with the optimization approach in each plot the red circles show the true bg measurements the blue curve shows the mean of the model output and the gray region is the esti mated 2 stdev band around the mean of the model output these forecasting results show that the proposed model mean when equipped with confidence bands found from standard deviations esti mate the bg levels accurately and in a patient specific way this reinforces the claim that the model parameters could be used to provide information about the health condition of individual patients 24 the ability of the model to estimate and track the mean and variance of bg levels the msg model s forecast is in the form of a distribution because it is stochastic and is therefore represents the glycemic distribution at every time point in this way the only forecast we have to evaluate is the mean and variance and clinical understanding and decision making is done relative to the mean and variance of glycemic dynamics as such we have two key results first the forecasted mean of the msg model output the stochastic model for bg movements captures the essence of the behavior of true bg measurements in a realistic way and second the forecast uncertainty as quantified using the standard deviation of the process encapsulates a large percent 94 on average over the three patients of true future bg measurements while remaining narrow enough to delineate changes in nutrition input and potentially treatment strategy surprisingly the forecast uncertainty is more narrow than the empirical uncertainty while capturing more of the data meaning that the forecast uncertainty captures the future uncertainty of the data more accurately more narrow but more specific than the data themselves capture their own uncertainty this is of course possible because the model is modeling glycemic response not just the glycemic time series because the optimization and mcmc approaches produced very similar parameter estimation and hence forecasting results we only used the map estimators obtained with the first week of data to form the patient specific model for forecasting over the following three weeks the mean of our glucose model represents the mean glycemic homeostasis and the mean glycemic response to nutrition figure 6 3 demonstrates how this mean reflects the dynamics of true bg measurements in this figure we estimated the model parameters using one week of data producing a model of the glycemic homeostasis and response given nutrition input to evaluate the forecasting ability of this model we then use this model to forecast glucose for the following three weeks the subfigures of figure 6 3 show the resulting forecast of bg for patients 1 2 and 3 respectively for the three weeks after the model was estimated in each subfigure red circles represent the bg measurements the blue curve shows the mean of the msg model output and the gray area is the 2 stdev band around the mean we see that the blue curve the proper forecast encapsulates the behavior of the true measurements for each three patients not all glycemic responses follow the mean and forecasts carry uncertainty one particularly important and challenging task of a forecast is accurate estimate of uncertainty because of the nature of our stochastic model uncertainty is quantified naturally using the standard deviation of the model process figure 6 3 demonstrate the effectiveness of the models ability to capture relevant forecast uncertainty with two standard deviation 2 stdev bands around the model mean these bands capture nearly every future bg measurement these results are further quantified in table 6 1 that shows summary statistics for how often the measurements were captured by the 2 stdev bands as well as the estimated standard deviation of bg measurements and the empirical standard deviation obtained directly from the raw bg measurement data being able to contain 90 97 of the true bg measurements in these confidence regions with a smaller model standard deviation than the empirical standard deviation for all three patients is an indicator of this model s capability in capturing the patient dynamics and hence its predictive capability this model is providing substantial forecasting information beyond what is available given the data alone 1 stdev 2 stdev model stdev data stdev patient 1 73 66 94 20 19 3700 24 4629 patient 2 62 66 89 87 25 6625 32 5589 patient 3 51 61 96 77 22 2388 27 1433 table 6 1 percentages of the true bg measurements included in the forecasted 1 and 2 stdev bands in the t 2 dm setting besides visuals provided for forecasting results this table shows indeed a large amount of true bg measurements are captured in the forecasted confidence intervals comparison of the model stdev with the raw bg data stdev shows that the confidence intervals act really as tight bands around the measurement values hence providing true information about their variance 25 6 1 3 comparison of forecasting accuracy with ldp model in this section we will compare the forecasting accuracy of the t 2 dm version of the msg model with a well known model developed by ha sherman 36 it is important to note that this model the longitudinal diabetes pathogenesis ldp model was designed to understand diabetes progression not for forecasting future bg level purposes the experiment in this setting will be the same as described above in section 6 1 2 this model consists of a set of coupled odes to estimate the unknown model parameters within the ldp model we use a constrained ensemble kalman filter enkf algorithm whose details can be found in 2 as a result of using this type of an algorithm whose output comprises an ensemble of estimates we can also assess the uncertainty in the estimated parameters using the ensembles moreover we can propagate the uncertainty in the estimated model parameters to quantify the uncertainty in the forecasted model states thus using this approach we can obtain confidence bands as we do with the msg model the ldp model that we use for comparison has 11 model parameters however we will not attempt to estimate all these parameters as it is not a feasible task to achive with the sparse data that we have available instead we set some model parameters to reasonable values based on the literature and estimate the remaining ones using the constrained enkf method more precisely we perform the same experiment by estimating three different sets of parameters si si hepasi si hepasi r 20 and setting the remaining parameters at known default values the comparison results can be found in table 6 2 the results in table 6 2 show that the msg model is better at forecasting future bg levels in t 2 dm patients than all variants of the ldp model considered first even though we fit the normal distributed model output to the data rather than directly fitting the mean of the model output to the data we can achieve smaller mse and mpe than all different variations of the ldp model for all three patients second we see the advantage of using a stochastic model which quantifiies the level of certainty in the bg predictions for both the ldp and msg cases it is worth noting that the msg model is based on learning parameters of a stochastic model whilst the ldp quantifies uncertainties by learning an ensemble of parameters this may contribute to the differences between them at the level of uncertainty prediction the pecentages in table 6 2 show that the msg model is substantially better in capturing the true measurements in the corresponding confidence bands note also that the mse is also smaller for the msg than for the ldp demonstrating that it is preferable as a point estimator as well as probabilistically in summary the msg model is preferable to the ldp for decision making in the context we use here as it gives a better point forecasts and better confidence bands enabling knowledge of possible high and low values for future bg levels finally we want to note also that the datasets belonging to patient 1 and patient 2 here were also used in 6 to compare the efficacy of some other data assimilation techniques to forecast future bg levels among different filtering approaches and mechanistic models the best performance was achieved by a modified dual unscented kalman filter ukf that estimates both the states and unknown model parameters that is used along with the ultradian model with this approach the mse for patient 1 is reported to be 680 mg dl 2 whereas it is 950 mg dl 2 for patient 2 this shows that we obtain better forecasting accuracy with the msg model for patient 1 however the forecasting accuracy is better for patient 2 with the ukf approach used with the ultradian model in addition the authors used the well known meal model introduced in 21 for forecasting future bg levels for this model among various different filtering techniques they achieved the best accuracy again with ukf the mses obtained with the meal model along with ukf are 730 mg dl 2 and 1300 mg dl 2 for patients 1 and 2 respectively the msg model achieves better forecasting accuracy than the meal model for both of the patients these comparisons are another indicator that the msg model can provide accurate forecasting results for t 2 dm patients without including exogenous insulin as a state variable and with a relatively simpler representation of the underlying physiology 26 6 2 icu we now move from evaluating the model with t 2 dm self management data to the more complex and difficult case of modeling and forecasting glycemic dynamics in the icu where non stationarity is manifest on much shorter time scales parameter estimation and prediction are in general harder in the icu context because patients within the icu typically have much more volatile physiological dynamics for at least three reasons glycemic dynamics under continuous feeding are oscillatory the patients are acutely ill and their health state changes quickly because of their disease state and the patients are constantly being intervened on to help them heal to paint a picture 90 of the patients will not require insulin outside of the icu but do during their icu stay and around 20 of patients have a hypoglycemic episode that would not occur when they are not acutely ill the icu is a much more complex forecasting and modeling setting 6 2 1 parameter estimation the difficulties presented in the icu setting are reflected in our parameter estimation results despite these complexities our numerical results exhibit four substantive pieces of evidence which support the validity of the model and its potential effectiveness for both understanding the physiological state of an individual and for forecasting for that individual in the context of icu patients first the model captures the dynamics as meaningfully as possible based on the data that is the estimated model parameters are physiologically plausible and represent the observable dynamics second the estimated model parameters which have the most influence in resolving the mean and variance of the bg level are physiologically meaningful in most of the cases as was the case in the t 2 dm setting third the changes in the parameter estimation results over moving time windows are realistic and reflective of the expected non stationary behavior of icu patients and fourth the uq results show that the parameters basal glucose rate gb and the model standard deviation which have the most patient 1 1 std 2 std mse rmse mpe msg model 73 66 94 20 403 94 20 10 12 84 ldp model si 41 96 65 62 524 03 22 89 13 72 si hepasi 40 18 66 96 483 99 22 00 13 77 si hepasi r 20 43 30 65 62 487 89 22 09 13 59 patient 2 1 std 2 std mse rmse mpe msg model 62 66 89 87 1123 40 33 52 17 35 ldp model si 20 89 37 34 1563 20 39 54 21 00 si hepasi 15 82 32 91 1952 30 44 18 24 20 si hepasi r 20 18 35 33 54 1630 60 40 38 21 71 patient 3 1 std 2 std mse rmse mpe msg model 51 61 96 77 586 32 24 21 17 11 ldp model si 29 03 50 00 1043 40 32 20 18 98 si hepasi 30 65 53 23 1080 90 32 88 18 69 si hepasi r 20 19 35 46 77 1117 60 33 43 19 81 table 6 2 comparison of the forecasting results with two different models for each different case of the ldp model the results in the corresponding row shows which parameters are estimated during the whole forecasting experiment note that we obtain better forecasting accuracy with the msg model than with the ldp model furthermore for the ldp model the forecasting accuracy decreases as the number of parameters being estimated increases 27 influence in resolving mean and variance of bg levels are estimated with more certainty having tighter bands around the point estimates for these parameters indicates the robustness of the estimation a gb 108 24 0 09 1 35 b gb 135 23 0 51 0 0016 c gb 139 87 1 00 10 17 figure 6 4 bg simulations are shown with respective to the estimated parameters over training time window in each plot the light blue curve is the glucose rate in the nutrition delivered to the patient right y axis the red circles show the true bg measurements left y axis the red curve is the mean of the model output left y axis and the gray area is the 2 stdev band around the mean of the model output left y axis these figures show two main cases that could arise as a result of parameter estimation in the icu setting figure 6 4 a the input nutrition rate is reflected in the output bg measurements figures 6 4 b and 6 4 c the input is not reflected in the output which makes it impossible to estimate the decay rate before we begin the evaluation first consider figure 6 4 which demonstrates both the model s relative robustness and its capability of capturing the dynamics and various complexities encountered in different conditions in the icu setting these figures show simulated bg values for patient 4 see table 5 2 over different training time windows whose data nutrition rate and bg measurements are used to estimate the corresponding model parameters using the optimization approach here the the red curves represent the mean of the blood glucose dynamics that are assumed to be oscillatory the amplitude of oscillations are expected to lie in the gray region as it is the 2 stdev band around the mean and the bg measurements are shown as red circles and the blue curve shows the tube nutrition input rate for simplicity we are considering patient 4 who did not need external insulin so the tube feed nutrition is the only driver of the bg level each subfigure of figure 6 4 shows a different training time window that is representative of different circumstances relative to our ability to estimate the basal glucose rate gb the decay of glucose to the basal rate and the parameter that resembles the width of the glycemic dynamics figure 6 4 a shows a situation where the bg measurements reflect the nutrition rate quite well in this case all the estimated model parameters are physiologically meaningful and the resulting simulation is a good representative of the dynamics as can be seen by the parameter and state estimates tracking one another in contrast figures 6 4 b and 6 4 c demonstrate a situation where the bg measurements do not reflect the nutrition rate over the time window this failure is seen by the lack of consistency in the movement of the parameters to one another and the nutrition rate this failure can have one of two sources first if there is no change in the nutrition rate over the training time window it is impossible to estimate the glycemic decay rate parameter second when changes in the bg measurements are uncorrelated with the changes in the nutrition rate potentially due to changes in health states or other interventions e g other hormone drips it is also impossible for the model parameters to accurately reflect the physiology as they are accounting for dynamical glucose features they were not designed to accommodate these issues do not mean the model cannot represent and forecast the glycemic dynamics it still is usually able to represent glycemic dynamics but some of the parameters might lose their intended meaning for example in the two respective examples despite parameter estimate issues in both of these cases the estimated basal glucose rate gb and the the parameter that is a measure for the amplitude of the bg level oscillations are physiologically meaningful and these parameters are enough to capture the mean and variance of the bg measurements accurately moreover estimated decay parameter takes an arbitrary value larger than a pre set threshold resulting in that the mean of the model 28 a patient 4 b patient 5 c patient 6 figure 6 5 parameter estimation and uncertainty quantification results in the icu setting obtained with mcmc approach in each plot the blue stars represent the point estimate of each parameter mean of the resulting random samples and the gray area is the 2 stdev band around the point estimates also obtained from the resulting random samples these results show that the estimated model parameters exhibit biophysically realistic values and change relatively smoothly this is to be expected since the consecutive moving time windows each of length around one day have a large overlap however the cases where there is a considerable change in the estimated parameter are also understandable because of rapid changes in the patients health condition and or the difficulty in extracting such information due to patients glycemic response on the other hand 1 and 2 stdev bands enforces the reliability of the estimated parameters especially gb and which are the most important parameters in predicting the mean and variance of bg levels 29 being estimated as flat these examples are not the only cases where we observe parameter estimates that are not physiologically meaningful while at the same time the glucose forecast and modeling itself remains accurate the other examples are all variations on the same theme we do not have the available data to estimate a parameter accurately or the data are behaving in a more complex manner and in both cases the parameters make up for these data driven and model driven short comings by deviating from their normal roles to render a robust glucose forecast it is likely that problems such as these will not be eliminated by using more complex data sets and more complex models because full representation of the relevant processes is out of reach in such non stationary icu settings with the complexity of icu data in mind figures 6 5 and 6 6 show the time course of parameter estimates for each icu patient obtained with mcmc and optimization approaches respectively and demonstrate how the estimated parameters are physiologically plausible in figure 6 5 we show estimated basal glucose rate gb the decay parameter the parameter used as a measure for the amplitude of bg level oscillations and the proportionality constant for each of the patients the mean of each parameter as estimated using mcmc is shown using blue stars the parameters are estimated for every forecasting process using data from the previous day allow us to update the model to forecast the glycemic response and states implying a moving time window of parameter estimates these parameter estimates are physiologically plausible for all three patients except in a small number of cases for example estimates of the basal glucose rate gb were around 110 150 mg dl 140 200 mg dl 120 200 mg dl for patients 4 5 and 6 respectively all plausible values given the patient s data as was the case for the example discussed in the first paragraph of this section it was not possible to compute good estimates for parameters and in some of the cases if we estimate the parameters using optimization changing the paradigm under which we estimate parameters we can gain further insight into complexities regarding parameter estimation figure 6 6 demonstrates some variability and occasionally unrealistic estimates for basal glucose rate gb in figure 6 6 we observe times where the basal glucose rate gb being estimated very low too low to be plausible the reason why the basal rate is estimated incorrectly however is not so complex and is in fact correctable the time periods where the basal rate is incorrectly estimated coincide with time intervals where we cannot estimate the decay rate this problem occurs again when the nutrition rate is not changed over the course of the training period making it impossible to estimate glycemic response to nutrition if over the course of the optimization the decay rate is estimated to be too high it negates the effect of nutrition to the bg rate because the model now has much less dependence on nutritional input it makes up for this by estimating the basal rate gb as being higher than it should be in contrast if the estimated decay rate is underestimated then the influence of nutrition on bg is excessive and to make up for this the basal rate is underestimated in this situation we can still calculate the basal rate accurately by estimating the shifted basal rate which is the sum of estimated basal glucose value and estimated effect of nutrition rate this shifted basal rate is how the model is modeling the glucose in the system and the calculation for the shifted basal rate is effectively deconvolving how the model is coping with the data insufficiency this example demonstrates some of the icu specific complexity and that despite the identifiability failure due to data sparsity the model was robust enough able to estimate the data and because the model is relatively simple this further demonstrates how we are able to pull apart the modeling inaccuracies such that we can understand and account or otherwise compensate for these model errors in addition the estimated values which are the measures of the amplitude of bg level oscillations attain physiologically meaningful values using the optimization approach as well this is important because it is generally the amplitude of oscillations that will have the largest impact on clinical decision making and finally despite these difficulties the bg dynamics were still quite accurate as we will see in the forecasting evaluation cf figures 6 7 and 6 8 figure 6 5 also shows that the time evolution of the estimated parameters is realistic within the icu context in icu the training time windows move in positive increasing time direction increments of measurements given a measurement the model is estimated using the previous 24 hours of data 14 data points to forecast the future measurement whenever it comes so that the consecutive time 30 a patient 4 b patient 5 c patient 6 figure 6 6 parameter estimation results in the icu setting obtained with the optimization approach in each plot the blue stars represent the map estimator of the corresponding model parameter these results provide important understanding of the system through the cases whether the data is interpretable through the model or not when both of the basal glucose value gb and the decay rate attain physiologically plausible values this is mostly representative of a case where the data is interpretable through the model whereas other cases reflect when it is not possible to estimate the decay rate and how this situation propagates through the other estimated parameters 31 windows have an overlap of 20 23 hours this means that the model varies relatively continuously between consecutive time windows this relative continuity is reflected in figure 6 5 that shows the time evolution of estimated parameters for all three patients the choice of the time window used to estimate the model faces the same problem that all moving window approaches short time windows imply less data and higher estimation variance and long time windows imply poor adaptability in non stationary settings but have lower variance and ample data this is an optimization problem we will not tackle here instead we set the window size on the assumption that the patient health state defined by the parameters would not change too much over the previous 24 hours and assumption that is usually but not always correct even though the health condition of the icu patients can change rapidly the estimated parameters do not change wildly in most of the cases reflecting the expectation under these settings nevertheless the patients are clearly non stationary and the observed evolution of the parameter estimates e g of the basal glucose value gband decay rate shown in figure 6 4 reflect this non stationarity and finally as was the case in the t 2 dm setting the model is relatively robust to the methods used to estimate it however as can be seen in figure 6 8 and inferred from the discussion above about parameters and their face validity to physiology the icu formulation of the model can have more complex parameter estimation issues compared to the t 2 dm setting in particular in the icu setting there are some cases where the laplace approximation does not work well because the parameter misfit solution surface is flat in some parameter directions a reflection of identifiability issues in these cases we used mcmc to provide uq results in general we observe that the basal glucose rate gb and the parameter related to variance both allow for more robust estimation compared to the estimation of and the robustness of the estimation of is important for clinical applications because the variance is what is used for deciding insulin doses as a demonstration of the robustness of consider figure 6 5 here we can see the 2 stdev band around the mean for is tighter than or as tight as the 2 stdev bands for gb and for all three patients this implies that the msg model is able to robustly estimate the amplitude of the bg level fluctuations which again is important to clinicians on the other hand considering the plots for and estimation the width of the 2 stdev bands shows that we are less certain about the estimated values remember that both of these parameters are related to the glucose removal rate from the blood this is perhaps an indicator of an identifiability issue for these parameters but it is also true that we are indeed less certain about this physiology glucose can be removed at different rates by different physiological processes e g liver versus adipose tissue and we are not resolving these physiological subsystems moreover due to the non stationary and sparse nature of the data in the icu setting it is harder to estimate some of the model parameters accurately separating these inference issues is not possible given the data presently collected in these settings nevertheless the parameters that play a key role in resolving the mean and variance of the bg dynamics can be estimated accurately up to the desired level 6 2 2 forecasting forecasting results in the icu setting are indicative of two major features of this model i we can capture the trend of bg measurements through the mean of the model and ii we can estimate the variance of the bg measurements accurately once again since resolving mean and variance of bg dynamics is central to glycemic management these results show potential usefulness of this model in the icu context figures 6 7 and 6 8 demonstrate that the forecasted mean of the model and reflect it encapsulates the essence of the behavior of bg measurements for all three patients in each of the plots in figures 6 7 and 6 8 the red circles show the bg measurements and the blue stars are the mean of the model the gray region is the 2 stdev band around the mean once again obtained separately for each forecasting process with the corresponding patient specific model in addition to representing the trend of the bg measurements the forecasted mean of the model is nearly identical when computed using two independent methods reinforcing the point that the model is reliable 32 a patient 4 b patient 5 c patient 6 figure 6 7 forecasting results obtained based on parameters estimated with optimization in the icu setting in each plot the red circles show the true bg measurements the blue stars show the mean of the model output and the gray region shows the 2 stdev band around this mean for all three patients the forecasted mean captures the actual behavior of bg levels not used in the training of parameters moreover the 2 stdev band narrows down over the time periods on which bg levels are relatively stable and widen over the intervals where the bg value has larger variance capturing this behavior with reasonably tightly confidence bands is a very useful and valuable feature of the proposed model 33 a patient 4 b patient 5 c patient 6 figure 6 8 forecasting results obtained based on parameters estimated with mcmc in the icu setting in each plot the red circles show the true bg measurements the blue stars show the mean of the model output and the gray region shows the 2 stdev band around this mean these results are in general very close to those obtained using the optimization approach and the most relevant properties are shared by them both obtaining similar results with another numerical solution technique based on the same mechanistic model shows the reliability of the model and estimated model parameters 34 1 stdev 2 stdev average model stdev data stdev optimization mcmc optimization mcmc optimization mcmc patient 4 59 06 64 33 94 15 93 57 16 69 17 48 17 21 patient 5 60 62 67 36 84 46 87 05 25 70 29 09 29 15 patient 6 55 81 62 40 86 05 89 54 33 64 37 79 38 12 table 6 3 percentages of the true bg measurements included in the forecasted 1 and 2 stdev bands in the icu setting these percentages show that a large number of forecasted confidence intervals include the true bg measurements mcmc approach provides slightly better rates which is in accordance with the higher average model stdev in the mcmc case the average model stdev values obtained with optimization and mcmc for all three patients are smaller than the raw data stdev in all but one case together with the percentage values this means that the confidence bands are tight enough to provide accurate information on the variance of bg levels in the icu context as well to observe the effectiveness of this model in estimating the variance of the bg measurements accurately consider figures 6 7 and 6 8 and table 6 3 figures 6 7 and 6 8 shows the ability of the models to estimate the variance in glycemic dynamics visually where a large number of true bg measurements are contained in the gray regions that represent the forecasted 2 stdev bands around the forecasted mean these results are quantified in table 6 3 which contains summary statistics both for optimization and mcmc methods we see that with one exception mcmc model estimation for patient 4 the average model standard deviation is smaller than the empirical standard deviation of the bg measurements yet the proportion of the bg measurements captured in these regions are in the range of 84 94 for all three patients with two different methods these results demonstrate the forecasting accuracy of the msg model and imply potential use in the icu for glycemic management 6 2 3 comparison of forecasting accuracy with the icu minimal model in this section we will use the icu minimal model icu mm introduced in 82 and 39 for the comparison of the forecasting result we obtain with the icu version of the msg model the icu mm has twelve unknown model parameters one of those model parameters is used for the purpose of having units equal on both sides of the equation and set to be 1 two of the model parameters represent the volume of glucose and insulin distribution space and are set to nominal values from the literature this leaves us with nine unknown model parameters to be estimated to estimate these parameters we use the constrained enkf method as we did in when fitting the ldp model in the t 2 dm setting recall that with this type of approach the ensemble enables us to obtain confidence bands for our forecasting results the numerical results for the comparison are shown in table 6 4 first similar to the results in t 2 dm setting the percentages of the true bg measurements that are captured in the 2 stdev bands with the msg model are higher than the ones obtained for the icu mm by using the constrained enkf algorithm second the point estimators in the msg case exhibit comparable or improved accuracy in comparison to the icu mm mse and mpe are also smaller for the msg model except for patient 4 these results show that with a relatively simple model we are able to reach the same or better accuracy in forecasting bg behavior than a more physiologically based high fidelity model with a larger number of unknown model parameters third the confidence bands that we use to quantify possible high and low values of bg level could provide better results the improved accuracy of the msg model in terms of uncerainty forecasting may be related in part to the fact that the model we use is inherently stochastic and fits the stochastic fluctuations to data in contrast in the icu mm provides uncertainty bands only through the ensemble of solutions which are a product of the algorithm used to fit the data and not inherent to the model itself once again this improved forecast and uncertainty accuracy is indeed a crucial tool in making decisions regarding future bg levels of icu patients 35 patient 4 1 std 2 std mse rmse mpe msg model 60 23 93 57 343 31 18 53 11 03 icu mm 49 71 80 70 335 15 18 31 10 48 patient 5 1 std 2 std mse rmse mpe msg model 60 62 84 46 1104 20 33 23 19 20 icu mm 23 83 49 22 1480 40 38 48 20 52 patient 6 1 std 2 std mse rmse mpe msg model 55 81 86 05 1927 50 43 90 25 84 icu mm 26 74 46 90 2018 40 44 93 25 28 table 6 4 comparison of the forecasting results obtained with the msg model and the icu mm the percentages of 1 and 2 stdev bands that capture the true bg measurements with the msg model is substantially higher than the icu mm on the other hand mse and mpe values are much closer yet the msg model still provides smaller value for these measures as well 7 conclusion summary of the modeling framework in this paper we introduce a new mathematical model that describes the glucose insulin regulatory system in humans the model was developed with five goals in mind i to create a model anchored to real clinical data and that given these data the model would be useful for personalized parameter estimation and state forecasting 73 ii to create a model that was interpretable in the sense that patient specific parameters may be used to explain and quantify basic physiological mechanisms iii a model which is physiologically simple even if it was functionally complex to avoid parameter identifiability problems present in many existing physiological models iv a model framework generalizable and adaptable to several contexts including t 2 dm and glycemic management in the icu and v a model that was amenable to a model based control environment with these goals driving the model development the model we developed follows a somewhat dif ferent approach compared to many other glucose insulin modeling efforts where the goals of increasing physiological fidelity or explaining a new physiological subsystem were drivers for example where as others e g sturis et al 77 or lui et al 55 work to understand and resolve the nature of the fast time scale oscillations the model developed here incorporates these sub day glucose fluctuations into the noise process and the parameter estimation is aimed at capturing the slower moving dynamical properties such as the evolution of the rates of glucose use and production this is done whilst keeping their compartmentalization and thus number of parameters to a minimum we do this because in many cases we do not have data to support resolution of higher fidelity physiological processes 43 as is the case in many common real world data collection settings and since our overarching goal and model validation and evaluation metrics are based on the models ability to forecast future bg levels accurately for the sake of computational efficiency we end up developing a lower fidelity model which is simple yet interpretable and anchored to physiology summary of key results the model developed here is flexible enough to enable a priori plausible models valid for t 2 dm and icu settings experiments with t 2 dm and icu data demonstrate that this a priori plausibility is borne out a posteriori the model has physiologically interpretable parameters which can be estimated robustly based on real world data moreover the estimated parameter values are physiologically plausible for both the t 2 dm and icu settings hence the new model has demonstrable capability to capture the bg dynamics of t 2 dm and icu patients in particular it does so well enough to resolve the mean and variance of their bg levels in both 36 retrospective and predictive modes this feature of the model reveals its potential for use in glycemic management it also reveals the potential for future bg level forecasting after being trained based on one week of data it can accurately forecast future bg levels for the following three weeks in the t 2 dm context on the other hand in the icu context it is capable of capturing the dynamics based on one day of data then it can be used for forecasting bg levels for the following 2 4 hours in both settings the choice of mathematical model naturally provides confidence bands for the future forecasting of bg levels these confidence bands are extremely helpful to have an understanding about how low and how high bg levels could be in the future and hence for the design of glucose or insulin uptake strategies to ameliorate undesirable health effects model development constrained by real world data restricting model development to the constraints imposed by readily available real world data is a severe but important restriction we can hypothesize how physiology might work in detail and we can envisage experiments to gather new datasets that could exist to test our hypotheses but we have not yet exploited data that are readily available to forge an understanding of what can be explained and predicted given current data acquisition instruments cost constraints on data acquisition and time constraints required for real time prediction to help facilitate the circular process of allowing our knowledge of systems physiology to inform and impact how people and clinicians manage the health of people and help allow the gaps in understanding at the bedside to help us choose impactful systems physiological problems to focus our efforts on we need a bridge between these worlds and the bridge proposed here is through inference with data based on simple yet interpretable models application in clinical settings within a clinical setting there are two scenarios where model based efforts could be of potential help i obtaining deeper understanding of the patient specific attributes of the glucose insulin regulatory system this requires accurate parameter estimation ii guidance for immediate decision making such as insulin administration and glycemic management this is a situation where we can tolerate some inaccuracy with parameter estimation provided that the state forecasts including the uncertainty bands are accurate and robust in the context of the model introduced here we have shown situations where the model parameter estimates are accurate as well as situations where model parameter estimates are not accurate nevertheless in the situations where the parameter estimates are not accurate the state forecast accuracy remains robust and the parameter estimate failures can be explained and for a large part mitigated for example in some circumstances in the icu we cannot directly estimate the basal glucose rate accurately but we are nevertheless able to obtain an accurate estimate of the rate at which glucose returns to its base value in many situations we demonstrate that this is enough to make accurate short term forecasts and also provides a starting point for more fundamental physiologically based systems a key requirement when translating the model framework to a clinical setting is quantification of uncertainty in predictions in this context our modeling effort was a success in both t 2 dm and icu settings blood glucose forecasting summary the msg model works well at estimating and forecasting blood glucose mean and variation boundaries in t 2 dm and icu settings for example the model based forecasts have more forecasting accuracy while retaining tighter uncertainty bands compared to measures derived from the data alone the model identifies different characteristic behaviors between t 2 dm and icu patients demonstrating both generalizability and robustness of the models with respect to forecasting moreover in these two scenarios the models are able to cope with the relative pace of non stationarity of the patients order weeks and order days for the t 2 dm and icu settings respectively this demonstrates both the efficiency of the msg model and its flexibility given these results and the fact that the model is simple and interpretable with understandable parameters implies a potential for providing a new perspective in understanding the glucose insulin system in humans 37 comparison of the efficacy of the model for t 2 dm and icu settings the t 2 dm and icu contexts are very different settings primarily because of the time scales on which parameters change and the different relative importance of external events not included in the model this difference imposes different needs in the two settings for example the change of the health states of the t 2 dm patients are in the order of days or even weeks whereas health states change on the order of hours for icu patients keeping these case specific differences in mind one obvious way to compare the effectiveness of the model in these two settings is through the forecasting results however unlike other fields such as atmospheric physics biomedicine is mostly missing a standardized and normalized techniques for context sensitive forecast verification and evaluation especially in regard to clinical effectiveness of the forecast because of this gap evaluation of the models and quantitative comparison of their potential usefulness in a context dependent way is not possible regardless it is important to emphasize that we do not expect the results for the two settings to have the same accuracy due to the characteristic differences mentioned before more precisely comparison of figures 6 3 6 7 and 6 8 shows that the mean of the model output in icu setting does not look as close to the true bg measurements as the same comparative forecasts in the t 2 dm case once again this situation is expected due to highly non stationary behavior of icu patients however in this setting it could be argued that being able to forecast the variance of glycemic dynamics to identify e g hypoglycemia could be more important to capture than the dynamics with the mean model output these different needs are context specific and without context specific evaluation machinery direct quantitative comparisons are not yet possible instead we are left showing figures 6 7 c and 6 8 c that demonstrate the model can forecast a hypoglycemia event on day 13 for patient 6 a feature that does demonstrate the context specific effectiveness of the model in the icu setting developing a model that is as simple as possible but not simpler while building the final model presented here we started with the simplest possible representation of each process and built in complexity until the model had desired predictive capability for example to model the meal function in the t 2 dm setting we first used an impulse function that concentrates all the ingested glucose at a single meal time instant numerical simulations showed that this choice was too simple to reflect reality the source of the problem is insightful concentrating all of the glucose in the meal at one time point the start time of the meal caused the corresponding simulated bg levels to increase very rapidly to very high values which were not even on the same order as the true bg measurements e g when bg measurements are in the range of 100 150 mg dl the simulated bg values are in the range of 700 800 mg dl physiologically it is likely that a sharp spike in glucose intake would cause a spike in bg but it is also likely the spike would be narrow and bg would return to near normal values quickly however a full discussion of the physiological effects of such a dose of glucose is beyond the scope of this discussion we then tried a simplistic solution in which we represented nutrition ingestion as a square wave function which was sum of constant functions that have the value gi t over the interval t m i t m i t where gi is the total amount of glucose ingestion in the meal starting at time t m i and t is a time scale for transfer of glucose from stomach to blood that is we set m t km i 1 gi t t m i t m i t t and let t be a model parameter to be estimated for each patient from data this function produced reasonable realistic simulation results however the cost function we minimize to fit the model to data see 4 11 exhibited discontinuities related to discontinuous behaviour of the meal model with respect to t the somewhat surprising result of this discontinuity was our inability to accurately estimate glycemic responses to nutrition meaning with a square wave nutrition delivery function inference failed these failures led us to choose a smooth function for nutrition delivery that then led to a continuous cost function with respect to the unknown model parameters these issues led to the meal function as defined in 3 1 that satisfies both the requirements meaning the model development was driven both by the need to reconcile the model with realistic physiology and by the need to be able to preform inference with data similar considerations applied to other aspects of model development 38 impact of the nutrition function choice in the icu context we also consider different form for the nutrition function in the icu setting in order to test robustness of our modeling to the simplistic piecewise constant model that we adopt in this case and in view of the fact that in the t 2 d setting we found the need for a more sophistictaed model for nutrition uptake first note that because of icu patients are tube fed with nutrition quantities that are considerably less per unit time than a healthy indivudual would ingest per unit time over the duration of a regular meal it is reasonable to consider the use of a piecewise constant function to model the effect of nutrition on the bg levels for icu patients nonetheless we investigated if modifying the piecewise constant function as shown in figure 7 1 could improve the parameter estimation and or forecasting results the idea behind this modification is to model the effect of nutrition on bg level via an initial exponential increase that reaches a maximum value and then when the nutrition delivery stops this effect decreases exponentially the rate of increase and decrease are represented by two model parameters a and b these parameters are similar to the ones that we used to model the effect of nutrition in the t 2 dm context but the nutrition function is not exactly the same since the nutrition effect in these two cases have different characteristics in addition since the values of these two parameters can be patient specific using this function introduces two more parameters to be estimated in the icu setting increasing the flexibility and the complexity at the same time hence the parameters to be estimated are gb a b figure 7 1 smoothing piecewise constant nutrition function that is used for icu patients the function we use has the following form m t km k 1 ck 1 e a t t m k t m k t m k 1 t 1 e ah m k 2 eb t t m 1 k t m 1 k t m k 1 ln 2 b t 7 1 where h m k t m 1 k t m k and ck dkh m k h m k e ah m k a 1 e ah m k 2 ln 2 1 b is the normalizing constant for k 1 2 km the numerical results concerning the forecasting capability of the msg model with this nutrition function are summarized in table 7 1 a quick comparison of these results with the ones in tables 6 3 and 6 4 shows that the percentages for 1 and 2 stdev bands are a little less whereas mse and mpe are either the same or slightly higher than the ones obtained with piecewise constant nutrition function hence this comparison suggests that using the more physiologically accurate version of the meal function did not in this icu case introduce any improvements since the new function introduced two more new parameters to be estimated this also leads to a problem that is computationally more 39 challanging especially when the problem is prone to identification issues overall our work comparing the original and new meal function demonstrates that the original piecewise constant choice of the meal function is an appropriate choice in this case 1 std 2 std mse rmse mpe average model std patinet 4 56 73 91 81 392 90 19 82 11 87 16 86 patient 5 59 59 83 42 1239 70 35 21 19 68 25 25 patient 6 57 36 84 11 2094 70 45 77 26 01 33 40 table 7 1 forecasting results obtained with optimization approach for the msg model with the nutrition function given in 7 1 even though the nutrition function could be considered as a better representation of the reality it did not introduce improvement in the forecasting results comparison of forecasting efficiency with other models in order to evaluate the effective ness of the msg model we ran experiments comparing it with the ldp model the t 2 dm setting and with the icu mm the icu setting the ldp and icu mm models are built to represent the co evolution of glucose and insulin dynamics in contrast to our simplified model which models glu cose dynamics with insulin as parameterically dependent input for the purpose of comparison we used 1 and 2 stdev band percentages mse rmse and mpe as the evaluation metrics in both the t 2 dm icu settings we showed that i even though the msg model was developed to capture the mean behavior of bg level and the numerical scheme used for identification is not specifically designed to minimize the mse the mse over the test data obtained with the msg level is typically smaller than and in the worst case at the same level as the mse obtained with the ldp model for t 2 dm and icu mm for icu ii the confidence bands obtained via the msg model are more effective in that they capture a higher proportion of the true bg measurements than the confidence bands found from the ldp model and the icu mm this is likely due in part to the fact that the msg model uses a stochastic description to encapsulate possible fluctuations around the mean in the quanity of interest which is the bg measurements the ldp and icu mm are deterministic models and fluctuations are captured through the ensemble method used to fit the data these two points show that the msg model is at least as effective in forecasting future bg levels as the ldp and icu mm models in the t 2 dm and icu settings indeed it is typically more effective achieving this level of accuracy in the two different settings is achieved by using a simple model apprpropriate for the available data but complex enough to be interpretable and to capture the underlying physiology the resulting simple msg model has a smaller number of unknown parameters than do the ldp and icu mm models therby providing more robust estimation and inference results generalizability of parameter estimation finally a careful investigation of the estimated pa rameters and simulated bg levels in the icu context shows that we can estimate parameter values that represent the bg levels very well when the true bg measurements are interpretable with the model 3 8 that is if measured bg values are responsive to the changes in the rate of nutrition and insulin iv then the bg simulations with the estimated parameters based on this data provide a very good representation of the dynamics however if the bg level behavior is not driven by the nutrition and the insulin iv rates i e if its response is driven by other factors such as stress induced counter regulatory hormone levels then the model estimated mean is estimated to be almost constant this mean estimate is still good as a representation of the average of bg measurements and the variance of the measurements are still estimated accurately enough that the 2 stdev band around the mean envelopes nearly every bg measurement for all patients in all disease cases independent of param eter estimation complexities we obtain good estimates of the forecast mean and variance of the bg levels we achieve with the model are likely accurate enough to be helpful in clinical settings 40 outlook the model we have developed has demonstrable predictive capability and discriminates between datasets in a patient specific manner yes it has some limitations which give space for future development and also suggests some natural next step applications we outline a number of possible future directions glycemic control given the msg model construction an obvious next step is to formulate the work on the control problem where we determine estimates of the input ranges of nutrition and insulin necessary to keep the output here bg in a desired target range this is a similar approach to something like the artificial pancreas beta cell project but the inputs would include nutrition the settings would include t 2 dm and icu glycemic management and the goal would not be a closed loop but rather an open loop system parameter estimation short comings and advancement in t 2 dm setting the estimation results with optimization and mcmc approaches for the parameters a and b used to define the rate of appearance and absorption of glucose produce conflicting results in the icu setting we observe some identifiability issues for the parameters modeling glucose removal with body s own effort and with insulin iv we plan to address these issues in future key questions are whether different parameter estimation techniques can resolve the problems or whether further data is required and if so which data and more fundamentally whether the model used is appropriate for the data a related issue is the possibility of using mixed effects models 75 83 in order to share common information in different patient data sets whilst also retaining the advantages of patient specific learning comparison with more complex models in order to have a better understanding about the effectiveness of this model to encapsulate bg dynamics and resolve the mean and variance of bg levels we plan to compare it with more complex models such as a second order linear sde which would allow for oscillatory dynamics but retain the advantages of linearity and gaussianity exploited here and the ultradian model 77 which is a widely accepted physiogically based model such a comparison would happen within design similar to what we used in this paper for both t 2 dm and icu context furthermore in the situation where control machinery has been added to the model we can evaluate the various model s effectiveness in a control based setting phenotyping because the parameters of the msg model are interpretable and track physiology reasonable well we could potentially use the model parameter estimates for phenotyping studies 4 5 7 meaning we could estimate parameter for individuals in a given health state establishing an inferred phenotype for the patient and then relate this phenotype to other external health features or cluster the patient phenotypes in an effort to find structure among the inferred physiology we have deemed efforts such as this high fidelity phenotyping 43 and believe that this model has the potential to be used to these ends exploiting model error to understand physiology it is known that bg levels are mainly driven by the carbohydrates however there are also other factors that impact glucose levels a partial list of particularly interesting features that impact bg levels and are of practical interest include macro nutrients other than carbohydrates exercise sleep and stress levels of patients the presence of these features will induce systematic forecasting errors allowing us to use machine learning to explore the statistical relationship between these factors and bg levels this would give us a systematic platform for potentially furthering the understanding of the glucose insulin system and result in more accurate parameter estimation and forecasting further model generalization to include other glucose data driven situations we have not investigated how the msg model might work given oral glucose tolerance test ogtt data the ogtt is one of the standard settings for glucose insulin model development and potential use we know of only one model that currently generalized to both ogtt and clinical data 35 and we would like to add the msg model to this list t 1 dm we have a initial version of the msg model that could be used within t 1 dm setting it would be interest to test this version on t 1 dm data since the time scales of health progression here are more similar to those of t 2 dm than the icu setting giving hope that the method might have similar predictive capability in this setting because of not having access to such a t 1 dm dataset we haven t been able to work with this version in this paper we plan to pursue a number of the research directions outlined here in the immediate future 41 acknowledgements we acknowledge financial support from nih ro 1 lm 012734 mechanistic machine learning da acknowledges helpful discussions with bruce gluckman rammah abohtyra and cecilia diniz behn the authors have no conflicting or competing interests to declare references 1 d j albers and g hripcsak using time delayed mutual information to discover and interpret temporal correlation structure in complex populations chaos 22 013111 2012 2 david j albers paul adrien blancquart matthew e levine elnaz esmaeilzadeh seylabi and andrew stuart ensemble kalman methods with constraints inverse problems 35 9 095007 2019 3 david j albers noe mie elhadad jan claassen rimma perotte a goldstein and george hripc sak estimating summary statistics for electronic health record laboratory data for use in high throughput phenotyping algorithms journal of biomedical informatics 78 87 101 2018 4 david j albers noe mie elhadad e tabak adler perotte and george hripcsak dynamical phe notyping using temporal analysis of clinically collected physiologic data to stratify populations plos one 9 6 e 96443 2014 5 david j albers george hripcsak and michael schmidt population physiology leveraging electronic health record data to understand human endocrine dynamics plos one 7 12 e 48058 2012 6 david j albers matthew levine bruce gluckman henry ginsberg george hripcsak and lena mamykina personalized glucose forecasting for type 2 diabetes using data assimilation plos computational biology 13 4 e 1005232 2017 7 david j albers matthew e levine andrew stuart lena mamykina bruce gluckman and george hripcsak mechanistic machine learning how data assimilation leverages physiologic knowledge using bayesian inference to forecast the future infer the present and phenotype journal of the american medical informatics association 25 10 1392 1401 10 2018 8 dj albers and g hripcsak estimation of time delayed mutual information from sparsely sampled sources chaos solitons and fractals 45 853 860 2012 9 dj albers and george hripcsak a statistical dynamics approach to the study of human health data resolving population scale diurnal variation in laboratory data physics letters a 374 9 1159 1164 2010 10 jerzy baranowski piotr bania waldemar bauer jedrzej chilin ski and pawe l piatek hybrid newton observer in analysis of glucose regulation system for icu patients in polish control conference pages 818 827 springer 2017 11 melissa barazandegan fatemeh ekram ezra kwok bhushan gopaluni and aditya tulsyan assessment of type ii diabetes mellitus using irregularly sampled measurements with missing data bioprocess and biosystems engineering 38 4 615 629 2015 12 richard n bergman y ziya ider charles r bowden and claudio cobelli quantitative esti mation of insulin sensitivity american journal of physiology endocrinology and metabolism 236 6 e 667 1979 42 13 alessandro bertuzzi serenella salinari and geltrude mingrone insulin granule trafficking in b cells mathematical model of glucose induced insulin secretion american journal of physiology endocrinology and metabolism 2007 14 lucas p beverlin derrick k rollins nisarg vyas and david andre an algorithm for optimally fitting a wiener model mathematical problems in engineering 2011 2011 15 emrah b y k and murat arcak a hybrid redesign of newton observers in the absence of an exact discrete time model systems control letters 55 6 429 436 2006 16 troy bremer and david a gough is blood glucose predictable from previous values a solicitation for data diabetes 48 3 445 451 1999 17 paolo brunetti marco orsini federici and massimo massi benedetti the artificial pancreas artificial cells blood substitutes and biotechnology 31 2 127 138 2003 18 frederick chee and tyrone fernando closed loop control of blood glucose volume 368 springer 2007 19 gilbert a churchill jr a paradigm for developing better measures of marketing constructs journal of marketing research 16 1 64 73 1979 20 claudio cobelli and alfredo ruggeri evaluation of portal peripheral route and of algorithms for insulin delivery in the closed loop control of glucose in diabetes a modeling study ieee transactions on biomedical engineering 2 93 103 1983 21 chiara dalla man robert a rizza and claudio cobelli meal simulation model of the glucose insulin system ieee transactions on biomedical engineering 54 10 1740 1749 2007 22 pooja m desai matthew e levine david j albers and lena mamykina pictures worth a thousand words reflections on visualizing personal blood glucose forecasts for individuals with type 2 diabetes in proceedings of the 2018 chi conference on human factors in computing systems page 538 acm 2018 23 pooja m desai elliot g mitchell maria l hwang matthew e levine david j albers and lena mamykina personal health oracle explorations of personalized predictions in diabetes self management in proceedings of the 2019 chi conference on human factors in computing systems page 370 acm 2019 24 f ekram l sun o vahidi e kwok and r b gopaluni a feedback glucose control strategy for type ii diabetes mellitus based on fuzzy logic the canadian journal of chemical engineering 90 6 1411 1417 2012 25 heinz werner engl martin hanke and andreas neubauer regularization of inverse problems volume 375 springer science business media 1996 26 pier giorgio fabietti valentina canonico marco orsini federici massimo massi benedetti and eugenio sarti control oriented model of insulin and glucose dynamics in type 1 diabetics medical and biological engineering and computing 44 1 2 69 78 2006 27 pier giorgio fabietti valentina canonico marco orsini federici eugenio sarti and massimo massi benedetti clinical validation of a new control oriented model of insulin and glucose dy namics in subjects with type 1 diabetes diabetes technology therapeutics 9 4 327 338 2007 28 adiwinata gani andrei v gribok srinivasan rajaraman w kenneth ward and jaques reif man predicting subcutaneous glucose concentration in humans data driven glucose modeling ieee transactions on biomedical engineering 56 2 246 254 2009 43 29 andrew gelman john b carlin hal s stern david b dunson aki vehtari and donald b rubin bayesian data analysis chapman and hall crc 2013 30 eleni i georga vasilios c protopappas and dimitrios i fotiadis glucose prediction in type 1 and type 2 diabetic patients using data driven techniques in knowledge oriented applications in data mining intechopen 2011 31 bryan s gibson sheri r colberg paul poirier denise maria martins vancea jason jones and robin marcus development and validation of a predictive model of acute glucose response to exercise in individuals with type 2 diabetes diabetology metabolic syndrome 5 1 33 2013 32 pranay goel insulin resistance or hypersecretion the ig picture revisited journal of theoretical biology 384 131 139 2015 33 pranay goel durga parkhi amlan barua mita shah and saroj ghaskadbi a minimal model approach for analyzing continuous glucose monitoring in type 2 diabetes frontiers in physiology 9 673 2018 34 gerold m grodsky a threshold distribution hypothesis for packet storage of insulin and its mathematical modeling the journal of clinical investigation 51 8 2047 2059 1972 35 joon ha leslie s satin and arthur s sherman a mathematical model of the pathogenesis prevention and reversal of type 2 diabetes endocrinology 157 2 624 635 2015 36 joon ha and arthur sherman type 2 diabetes one disease many pathways biorxiv 2019 37 david m hardesty and william o bearden the use of expert judges in scale development im plications for improving face validity of measures of unobservable constructs journal of business research 57 2 98 107 2004 38 niels haverbeke tom van herpe moritz diehl greet van den berghe and bart de moor non linear model predictive control with moving horizon state and disturbance estimation application to the normalization of blood glucose in the critically ill ifac proceedings volumes 41 2 9069 9074 2008 39 tom van herpe marcelo espinoza niels haverbeke bart de moor and greet van den berghe glycemia prediction in critically ill patients using an adaptive modeling approach journal of diabetes science and technology 1 3 348 356 2007 pmid 19885089 40 roman hovorka ludovic j chassin martin ellmerer johannes plank and malgorzata e wil inska a simulation model of glucose regulation in the critically ill physiological measurement 29 8 959 2008 41 george hripcsak and david j albers next generation phenotyping of electronic health records journal of the american medical informatics association 20 1 117 121 2012 42 george hripcsak and david j albers correlating electronic health record concepts with health care process events journal of the american medical informatics association 20 e 2 e 311 e 318 2013 43 george hripcsak and david j albers high fidelity phenotyping richness and freedom from bias journal of the american medical informatics association 25 3 289 294 2017 44 george hripcsak david j albers and adler perotte exploiting time in electronic health record correlations journal of the american medical informatics association 18 supplement 1 i 109 i 115 2011 44 45 steven e kahn ronald l prigeon david k mcculloch edward j boyko richard n bergman michael w schwartz james l neifing w kenneth ward james c beard and jerry p palmer the contribution of insulin dependent and insulin independent glucose uptake to intravenous glucose tolerance in healthy human subjects diabetes 43 4 587 592 1994 46 jari kaipio and erkki somersalo statistical and computational inverse problems volume 160 springer science business media 2006 47 timothy d knab gilles clermont and robert s parker zone model predictive control and moving horizon estimation for the regulation of blood glucose in critical care patients ifac papersonline 48 8 1002 1007 2015 48 timothy d knab gilles clermont and robert s parker a virtual patient cohort and math ematical model of glucose dynamics in critical care ifac papersonline 49 26 1 7 2016 49 boris p kovatchev marc breton chiara dalla man and claudio cobelli in silico preclinical trials a proof of concept in closed loop control of type 1 diabetes 2009 50 ed lehmann and t deutsch a physiological model of glucose insulin interaction in type 1 diabetes mellitus journal of biomedical engineering 14 3 235 242 1992 51 matthew e levine david j albers and george hripcsak methodological variations in lagged regression for detecting physiologic drug effects in ehr data journal of biomedical informatics 86 149 159 2018 52 j lin jg chase gm shaw cv doran ce hann mb robertson pm browne t lotz gc wake and b broughton adaptive bolus based set point regulation of hyperglycemia in critical care in the 26 th annual international conference of the ieee engineering in medicine and biology society volume 2 pages 3463 3466 ieee 2004 53 jessica lin normy n razak christopher g pretty aaron le compte paul docherty jacque lyn d parente geoffrey m shaw christopher e hann and j geoffrey chase a physiological intensive control insulin nutrition glucose icing model validated in critically ill patients com puter methods and programs in biomedicine 102 2 192 205 2011 54 jun s liu monte carlo strategies in scientific computing springer science business media 2008 55 weijiu liu chingchun hsin and fusheng tang a molecular mathematical model of glucose mobilization and uptake mathematical biosciences 221 2 121 129 2009 56 david jc mackay information theory inference and learning algorithms cambridge university press 2003 57 lena mamykina matthew e levine patricia g davidson arlene m smaldone noemie elhadad and david j albers data driven health management reasoning about personally generated data in diabetes with information technologies journal of the american medical informatics association 23 3 526 531 03 2016 58 lena mamykina matthew e levine patricia g davidson arlene m smaldone noemie elhadad and david j albers from personal informatics to personal analytics investigating how clinicians and patients reason about personal data generated with self monitoring in diabetes in cognitive informatics in health and biomedicine pages 301 313 springer 2017 59 barbara martinovic john leth torben knudsen tinna bjo rk arado ttir and henrik bengtsson modelling the glucose insulin system of type 2 diabetes patients using armax models in 2019 australian new zealand control conference anzcc pages 88 93 ieee 2019 45 60 eslam montaser jose luis d ez and jorge bondia stochastic seasonal models for glucose pre diction in the artificial pancreas journal of diabetes science and technology 11 6 1124 1131 2017 61 glen h murata richard m hoffman jayendra h shah christopher s wendel and william c duckworth a probabilistic model for predicting hypoglycemia in type 2 diabetes mellitus the diabetes outcomes in veterans study doves archives of internal medicine 164 13 1445 1450 2004 62 art b owen monte carlo theory methods and examples 2013 63 robert s parker francis j doyle and nicholas a peppas the intravenous route to blood glucose control ieee engineering in medicine and biology magazine 20 1 65 73 2001 64 robert s parker francis j doyle jennifer h ward and nicholas a peppas robust h glucose control in diabetes using a physiological model aiche journal 46 12 2537 2549 2000 65 robert s parker timothy d knab and gilles clermont the impact of a responsive endogenous pancreas in critical care glucose control in 2018 annual american control conference acc pages 3595 3601 ieee 2018 66 rimma pivovarov david j albers jorge l sepulveda and noe mie elhadad identifying and mitigating biases in ehr laboratory tests journal of biomedical informatics 51 24 34 2014 67 ari pritchard bell gilles clermont timothy d knab john maalouf michael vilkhovoy and robert s parker modeling glucose and subcutaneous insulin dynamics in critical care control engineering practice 58 268 275 2017 68 jaques reifman srinivasan rajaraman andrei gribok and w kenneth ward predictive mon itoring for improved management of glucose levels journal of diabetes science and technology 1 4 478 486 2007 69 christian robert and george casella monte carlo statistical methods springer science business media 2013 70 derrick k rollins nidhi bhandari jim kleinedler kaylee kotz amber strohbehn lindsay boland megan murphy dave andre nisarg vyas greg welk et al free living inferential modeling of blood glucose level using only noninvasive inputs journal of process control 20 1 95 107 2010 71 anirban roy and robert s parker a phenomenological model of plasma ffa glucose and insulin concentrations during rest and exercise in proceedings of the 2010 american control conference pages 5161 5166 ieee 2010 72 madineh sedigh sarvestani david j albers and bruce j gluckman data assimilation of glucose dynamics for use in the intensive care unit in 2012 annual international conference of the ieee engineering in medicine and biology society pages 5437 5440 ieee 2012 73 rachel e sherman steven a anderson gerald j dal pan gerry w gray thomas gross nina l hunter lisa lavange danica marinac dabic peter w marks melissa a robb et al real world evidence what is it and what can it tell us n engl j med 375 23 2293 2297 2016 74 giovanni sparacino francesca zanderigo stefano corazza alberto maran andrea facchinetti and claudio cobelli glucose concentration can be predicted ahead in time from continuous glucose monitoring sensor time series ieee transactions on biomedical engineering 54 5 931 937 2007 46 75 walter w stroup generalized linear mixed models modern concepts methods and applications crc press 2012 76 andrew m stuart inverse problems a bayesian perspective acta numerica 19 451 559 2010 77 jeppe sturis kenneth s polonsky erik mosekilde and eve van cauter computer model for mechanisms underlying ultradian oscillations of insulin and glucose american journal of physiology endocrinology and metabolism 260 5 e 801 e 809 1991 78 bharath sudharsan malinda peeples and mansur shomali hypoglycemia prediction using machine learning models for patients with type 2 diabetes journal of diabetes science and technology 9 1 86 90 2014 79 hood thabit martin tauschmann janet m allen lalantha leelarathna sara hartnell malgo rzata e wilinska carlo l acerini sibylle dellweg carsten benesch lutz heinemann et al home use of an artificial beta cell in type 1 diabetes new england journal of medicine 373 22 2129 2140 2015 80 brian topp keith promislow gerda devries robert m miura and diane t finegood a model of cell mass insulin and glucose kinetics pathways to diabetes journal of theoretical biology 206 4 605 619 2000 81 aad w van der vaart asymptotic statistics volume 3 cambridge university press 2000 82 tom van herpe bert pluymers marcelo espinoza greet van den berghe and bart de moor a minimal model for glycemia control in critically ill patients in 2006 international conference of the ieee engineering in medicine and biology society pages 5432 5435 ieee 2006 83 geert verbeke and geert molenberghs linear mixed models for longitudinal data springer science business media 2009 84 michael vilkhovoy ari pritchard bell gilles clermont and robert s parker a control relevant model of subcutaneous insulin absorption ifac proceedings volumes 47 3 10988 10993 2014 85 irving b weiner and w edward craighead the corsini encyclopedia of psychology volume 4 john wiley sons 2010 86 sha wu and eiko furutani nonlinear model predictive glycemic control of critically ill patients using online identification of insulin sensitivity in 2016 38 th annual international conference of the ieee engineering in medicine and biology society embc pages 2245 2248 ieee 2016 87 jun yang lei li yimeng shi and xiaolei xie an arima model with adaptive orders for predicting blood glucose concentrations and hypoglycemia ieee journal of biomedical and health informatics 23 3 1251 1260 2018 88 david zeevi tal korem niv zmora david israeli daphna rothschild adina weinberger orly ben yacov dar lador tali avnit sagi maya lotan pompan et al personalized nutrition by prediction of glycemic responses cell 163 5 1079 1094 2015 89 yan zhang tim a holt and natalia khovanova a data driven nonlinear stochastic model for blood glucose dynamics computer methods and programs in biomedicine 125 18 25 2016 90 zhongheng zhang a mathematical model for predicting glucose levels in critically ill patients the pignoli model peerj 3 e 1005 2015 91 raed abu zitar and abdulkareem al jabali towards neural network model for insulin glucose in diabetics ii informatica 29 2 2005 47 1 introduction 1 1 background 1 2 literature review 1 3 our contribution 1 4 outline 2 continuous time model 2 1 components of the model 2 2 conceptual explanation of how the stochastic model represents glucose physiology 3 event time model 3 1 t 2 dm 3 2 icu 4 parameter estimation 4 1 bayesian formulation 4 2 optimization 4 3 mcmc 5 methods datasets and experimental design 5 1 t 2 dm 5 1 1 model parameters and dataset 5 1 2 parameter estimation and uncertainty quantification 5 1 3 forecasting 5 2 icu 5 2 1 model parameters and dataset 5 2 2 parameter estimation and uncertainty quantification 5 2 3 forecasting 5 3 evaluation metrics 6 numerical results 6 1 t 2 dm 6 1 1 parameter estimation 6 1 2 forecasting 6 1 3 comparison of forecasting accuracy with ldp model 6 2 icu 6 2 1 parameter estimation 6 2 2 forecasting 6 2 3 comparison of forecasting accuracy with the icu minimal model 7 conclusion