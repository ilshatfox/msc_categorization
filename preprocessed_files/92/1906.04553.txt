screening by changes in stereotypical behavior during cell motility luke tweedy 1 2 patrick witzel 3 doris heinrich 3 4 robert h insall 2 and robert g endres 1 1 department of life sciences and centre for integrative systems biology and bioinformatics imperial college london united kingdom 2 cruk beatson institute glasgow g 61 1 bd scotland uk 3 fraunhofer institute for silicate research isc neunerplatz 2 97082 wu rzburg germany 4 leiden institute of physics lion leiden university corresponding author abstract stereotyped behaviors are series of postures that show very little variability between repeats they have been used to classify the dynamics of individuals groups and species without reference to the lower level mechanisms that drive them stereotypes are easily identified in animals due to strong constraints on the number shape and relative positions of anatomical features such as limbs that may be used as landmarks for posture identification in contrast the identification of stereotypes in single cells poses a significant challenge as the cell lacks these landmark features and finding constraints on cell shape is a non trivial task here we use the maximum caliber variational method to build a minimal model of cell behavior during migration without reference to biochemical details we are able to make behavioral predictions over timescales of minutes using only changes in cell shape over timescales of seconds we use drug treatment and genetics to demonstrate that maximum caliber descriptors can discriminate between healthy and aberrant migration thereby showing potential applications for maximum caliber methods in automated disease screening for example in the identification of behaviors associated with cancer metastasis introduction moving in the right way at the right time can be a matter of life and death whether avoiding a predator or searching for food choosing the correct movements in response to specific stimuli is a crucial part of how an organism interacts with its environment the repetitive highly coordinated movements that make up behavioral stereotypes have been shown to be entwined with survival strategies in a number of species for example the incredible correlation in posture between prey capture events in raptors 1 and the escape response of c elegans when exposed to extreme heat 2 understanding these stereotypes is vital to creating a full picture of a species interactions with its environment if stereotypes represent evolved selection driven behavior in animals might the same not be true for single celled organisms this point of view may be particularly useful in understanding chemotaxis the guided movement of a cell in response to a chemical gradient during chemotaxis eukaryotic cells change their shape through the repeated splitting and extension of actin rich structures called pseudods 3 5 though this behavior is well known the study of chemotaxis has traditionally focused on the signaling events that regulate cytoskeletal remodeling even where pseudopods are acknowledged to be relevant the focus is on the biochemical mechanisms that generate and regulate them 6 8 these mechanisms are however staggeringly complex 9 and the way chemotaxis emerges from these lower level processes remains largely unknown rather than delving deeper into the network of biochemical interactions we can instead learn from the shape changes and movements that this intricate machine has evolved to produce such an approach also known as morphological profiling shows great promise in biomedicine 10 here we explore this question using dictyostelium discoideum a model for chemotaxis noted for its reproducible directional migration towards cyclic adenosine monophosphate camp 11 12 which it senses using typical g protein coupled receptors to capture cell shape or posture at any given point in time we employ fourier shape descriptors a rotationally invariant method of quantifying shapes used previously to show that cell shape and environment are intrinsically linked 13 fig 1 a these shape data are naturally of high dimensionality making further analysis difficult we reduce their dimensionality using principal component analysis pca a method used previously to obtain the key directions of variability from the shapes of cells 13 15 and animals fig 1 b 2 16 17 our final challenge and the focus of this paper is to quantify behavior which we define as the movement between shapes there are many potential ways to do so 18 19 however we have adapted the variational maximum ar x iv 1 90 6 04 55 3 v 1 q bi o c b 1 1 ju n 20 19 caliber maxcal approach 20 21 to this end these methods have several advantages over conventional alternatives firstly fourier descriptors capture all available information on shape and the subsequent pca provides a natural quantitative means of discarding its less informative elements easier methods such as measuring aspect ratio or eccentricity require us to assume that they provide a useful description a priori and cannot inform us how much or what we have discarded for the sake of simplicity secondly our chosen methods are blind to the researcher s preconceptions as well as to previous descriptions of shape and behavior any behavioral modes identified have emerged from the data without our deciding on and imposing them as we might if using supervised machine learning or fitting parameters to a preconceived biochemical model finally the minimal model we construct using maximum caliber makes no reference to any underlying biochemistry and therefore cannot make potentially incorrect assumptions about it we demonstrate the usefulness of these methods by showing that they successfully discriminate between the behavior of drug treated or genetically altered cells and their parental strains results maximum caliber approach to behavioral classification cells continuously change shape as they migrate creating trajectories in the space of shapes that are specific to their situation for example we have previously shown that cells follow different shape trajectories in environments with low and high chemoattractant signal to noise ratios 13 here defined as the local gradient squared over the background concentration fig 1 c in this example it is important to note that the distributions of cell shape for each condition overlap significantly this means that it is not always possible to accurately determine the cell s condition from a static snapshot of its shape in contrast the dynamics of shape change in each condition are clearly distinct our aim here is to quantify the details of these shape changes making a small set of values that can act as a signature for a given mode of behavior we can then use such signatures to quantitatively compare or to discriminate between various conditions or genotypes to this end we employ the maxcal method fig 2 a maxcal was originally proposed by e t jaynes 22 to treat dynamical problems in physics and is much like his better known maximum entropy maxent method used in equilibrium physics the motivation is the same for both we wish to find the probability of a given structure for a system in a way that neither assumes something we do not know nor contradicts something we do know i e an observation of the system s behavior in the case of maxent this is achieved by finding the maximum shannon entropy with respect to the probabilities of the set of possible configurations the system can take 23 maxcal uses the probabilities of the possible trajectories a dynamical system can follow instead in this case the entropy is replaced by the caliber c 20 so called because the flow rate in a pipe relates to its caliber or internal diameter in essence the method extracts the degree to which different rates or events within the system are coupled or co occur beyond random chance this method has previously been used to sucessfully predict the dynamics of neuronal spiking the flocking behavior of birds and gene regulatory networks 24 26 generally the caliber takes the form c p j j p j ln p j j p j n n j sn j p j 1 where p j is the potentially time dependent probability of the jth trajectory the first term on the right hand side of eq 1 represents a shannon entropy like quantity and the second ensures that the p j are normalized the third constrains the average values of some properties sn j of the trajectories j to the values of some macroscopically observed quantities sn making sure we do not contradict any known information by maximizing the caliber the probabilities of the trajectories p j q 1 exp n nsn j 2 are found where q j exp n nsn j is the dynamical partition function and n are a set of lagrange multipliers this boltzmann type distribution fulfils detailed balance even for non equilibrium problems practically the problem is to find these lagrange multipliers and hence the partition function to this end we exploit their relations to the externally observed average values of some quantities sn lnq n 3 where the values of the sn are determined from experiment this training process is equivalent to maximum likelihood fitting to observed data 2 13 as our interest is in cell shape and motility we derive our values for the sn from the shape dynamics of migrating dictyostelium cells in order to effectively parameterise our model we must constrain the continuum of possible shape changes to a much smaller set of discrete unit changes in our principal components pcs we therefore build our model from discretized values of the shape measures pc 1 and 2 assigning them to the variables n 1 and n 2 respectively their values are analagous to particle numbers in a chemical reaction the switching between continuous and discrete variables is possible as x nx 0 035 is small with x 1 2 for pcx and x the standard deviation we reduce the size of the time step t until we no longer observe changes greater than 1 in a single t similar to deviations of master equations as pc 2 accounts for less overall variation than pc 1 see fig 1 b we naturally reach this minimal change for a much larger value of t which is undesirable because by the time t is small enough for pc 1 changes in pc 2 are almost never observed making correlations between the two pcs difficult to detect we therefore scale all changes in pc 2 by a factor of 1 2 in order that unit changes are observed in both pcs for a similar value of t practically our training data yielded a t of 0 1875 s as each 3 s frame in the video data was divided into 16 sections in which the intermediate pc values were linearly interpolated the advantage of limiting the possible macroscopic shape changes in t to the following an increase a decrease or no change in each pc as changes in each pc can be considered independently this gives us a total of 3 x 3 9 cases that is no change form the current position or a move to any of the 8 neighbouring spaces see fig 2 a inset these macroscopic cases are taken to be the observable effects of an underlying microscopic structure from our analogy of a chemical reaction we treat increases to be particle creation and denote the microscopic variable for an increase in trajectory j as sx j where x 1 2 correspond to pc 1 and 2 respectively for small t this variable is binary taking the value 1 when nx increases over a single time step and taking the value 0 otherwise decreases will be treated as particle decay with nx separate variables s x i j are used to denote decays for the ith particle with 1 i nx these s x i j are equal to 1 if the ith particle decays in t and equal to 0 otherwise hence in each t there are nx 2 possible microtrajectories for each component an increase no change or the removal of any particle nx fig 2 b we choose such a first order decay over a zeroth order decay in order to introduce a virtual force bringing the system back toward the mean see fig s 2 as the two components may change independently there are n 1 2 n 2 2 possible microtrajectories in a single t over pc 1 and 2 applying eq 3 we constrain the probabilities of these microtrajectories such that they agree with the macroscopically observed rates sx with an increase or decrease in component x respectively we then expand the model to include a following time step allowing us to capture short term correlations between events this increases the number of possible trajectories substantially the number of microtrajectories in a given time step depends on nx at time t t and this quantity is different dependent on the pathway taken in the first time step so we must include this history dependence for example a reduction in component x can happen in nx ways and will cause nx to go down by one this change is followed by nx 1 2 possible microtrajectories in the following time step multiplying the quantities for each time step gives us nx nx 1 microtrajectories in which there is a decrease in the first time step accounting for the effect of the changing values of n 1 and n 2 over interval t t t in each microtrajectory on the interval starting at time t t the number of microtrajectories over 2 t is n 21 3 n 1 5 n 2 2 3 n 2 5 each observable has a corresponding value in trajectory j of sxy j which is 1 if the correlation is observed and 0 otherwise we can reduce this to 10 time correlated observables by assuming symmetry under order reversal i e sxy j s yx j fig 2 c this assumption is justified if we consider a negatively correlated movement between pc 1 and pc 2 we may see transitions in the order 1 2 1 here the two couplets 1 2 and 2 1 both represent the same phenomenon see fig s 3 this leads to an additional 16 observables s xy where x y 1 2 are shape pcs and denote a change in the component displayed above we constrain our analysis to the first two shape components only as further components account for relatively little residual variance in shape whilst increasing computational complexity geometrically as an example we show the partition function in a single shape component in which there are 5 observables s s s s s qn 1 n 1 n 1 n 1 1 n 4 where e corresponds to a rate when divided by t with the lagrange multiplier associated with observable s the first line in eq 4 shows all possible transitions that begin with an increase over the first time step and so the whole line shares the factor the rate of increase a subsequent increase contributes a further as well as a coupling term which allows us to capture the likelihood of adjacent transitions beyond the naive probability a subsequent decrease can happen in n 1 ways each linked to the rate of decrease the term is a coupling constant controling the likelihood of an adjacent increase and decrease beyond the naive probability finally the 1 allows for the possibility of 3 13 no transition occurring in the subsequent time step the second and third lines correspond to a decrease in the first time step and no transition occurring in the first time step respectively the lagrange multipliers corresponding to observables are found using eq 3 which yields a set of equations to be solved simultaneously see supplementary material for details in the case of a single component these equations are s 2 2 2 n 1 5 a s 2 n 1 2 n 2 n n 1 5 b s 5 c s 2 n 5 d s n n 1 5 e the equations for the two component partition function and lagrange multipliers can be found in the si this method effectively allows us to build a map of the commonality of complex correlated behaviors relative to basic rates of shape change as quantified using principal components for a given lagrange multiplier governing a particular correlation a value less than zero indicates a behavior that is less common than expected and a value greater than zero represents a behavior that is more common stereotypical behavior without biochemical details after training our model on dictyostelium shape trajectories we confirmed that the method had adequately captured the observed correlations by using them to simulate the shape changes of untreated cells responding to camp in order to illustrate the importance of the correlations we also ran control simulations trained only on the basic rates of increase and decrease in each pc without these correlations we compared the activities of the uncorrelated and correlated simulations against the observed data the uncorrelated model acts entirely proportional to the observed rates though interestingly did not match them fig 2 d in contrast individual cells from the experimental data show very strong anticorrelation with increases in one component coupled with decreases in the other this behavior is clearly replicated by the correlated simulations in both cases appearing in the plot as a red diagonal from the bottom left to the top right furthermore we see suppression of turning behavior in both pcs with the most poorly represented activity relative to chance being a switch in direction in either pc for example 1 followed by 1 this too is reflected in the correlated simulations the predictive power of maxcal simulations goes beyond those correlations on which they were directly trained we tested the simulations ability to predict repetition of any given transition these patterns took the form of n transitions in t time steps e g five 1 transitions in ten time steps the maxcal model predicted frequencies of appearance for these patterns that closely resembled the real data fig 3 a model in red real data in black in contrast the uncorrelated model predicted patterns at a much lower rate for example there are runs of 5 consecutive increases in pc 1 in the real data at a rate of around one in 1 35 minutes the correlated model predicts this pattern rate to be one in every three minutes the uncorrelated model predicts the same pattern at a rate of one in 6 67 hours this result indicates that no higher order correlations are required to recapitulate the data allowing us to avoid the huge increase in model complexity that their inclusion would entail the greater predictive power of the maxcal model is reflected by its lower jensen shannon divergence from the observed data for these kinds of pattern fig 3 b the maxcal model also more closely matches the observed probabilities of generating a given number of transitions in a row with predictions almost perfect up to 4 transitions in a row twice the length scale of the measured correlations and far stronger predictive power than the uncorrelated model over even longer timescales fig 3 c a real world application of maxcal methods to discriminate between genotypes we wondered whether the maxcal methods would accurately discriminate between biologically relevant conditions to investigate this we used two comparisons first we compared shape data from control ax 2 cells against the same cells treated with two drugs targeting cytoskeletal function the phospholipase a 2 inhibitor p bromophenacyl bromide bpb and the phosphoinositide 3 kinase inhibitor ly 294002 ly for details see 27 second we compared a stable myosin heavy chain knockout against its parent strain again ax 2 fig 4 a we first looked at the effects of these conditions on the distribution of cell shapes to see whether their effect could be identified from shape rather than behavior the drug treatment caused a substantial change in the distribution within the population fig 4 b but still left a substantial overlap in contrast the 4 13 mhca cells showed no substantial difference to their parent in shape distribution fig 4 c in both cases the identification of a condition from a small sample of shape data would not be feasible we then compared the behavioral lagrange multipliers of each condition found by maxcal producing distributions for the estimated values of these by bootstrapping our data sampling with replacement the values of 1 1 and 2 2 are lower in the untreated condition than those in drug treated condition indicating the persistence of shape change in wt cells fig 4 d the anticorrelation between pcs 1 and 2 through pseudopod splitting is reflected in 1 2 and 1 2 both of which have values greater than 1 in wt cells in comparison the drug treated cells have only a moderate anticorrelation in the mhca strain the differences in the values of 1 1 1 2 and 1 2 when compared with their parent show similar changes to those observed in drug treatment fig 4 e in both cases the differences highlighted by these dynamical measurements are striking we then applied the maxcal model to the task of classification we settled upon classification using k nearest neighbors knn in order to see how the strength of our prediction improved with more data we classified based on the preferred class of n repeats all known to come from the same data set we estimated the classification power of our methods by cross validation dividing the drug treated data and its control into three sets containing different cells and dividing the mhca and its parent by the day of the experiment we first performed the classification by shape alone taking small subsamples of frames from each cell and projecting them into their shape pcs with our distance measure for the knn being the euclidean distance in these pcs with one two or 3 pcs we were able to achieve reasonable classification of the drug treated cells against their parent as data set size increased with the accuracy of classification leveling off at around 0 85 with 1 being perfect and 0 5 being no better than random chance fig 5 a c blue in contrast classification of mhca cells was little better than random chance even with relatively many data fig 5 a c green this is unsurprising given the similarity of the distributions of these two conditions we then calculated our maxcal multipliers for subsamples of each of these groups bootstrapping 100 estimates from 20 of each set we then repeat our knn classification instead using for a distance measure the two maxcal values that best separate our training classes as the test data come from entirely separated sources in the case of drug treated cells coming from different cells and in the case of the mhca being taken on different days we can be confident that we do not conflate our training and test data in both the drug treated case and the mhca mutant the dynamics differ very cleanly between our test and control data as such our classification is close to perfect even for only a few samples fig 5 d as the two lagrange multipliers that best classified the data both encoded correlations between adjacent time steps we guessed that this short term memory might be key to recapitulating the dynamic properties of cell shape change a key aspect of the shape dynamics of ax 2 cells is the anticorrelation between the first two pcs at the single cell level which is definitionally absent at the population level as pca produces uncorrelated axes to see if memory is vital to recapitualting this dynamical aspect of cell shape change we constructed two versions of the master equation for our maxcal system see si for details the first is markovian that is at a given time the probabilities of each possible next event only depend on the current state of the system we ran gillespie simulations corresponding to this master equation and compared the correlations of trajectories from these simulations with those from real data the expected anticorrelation is clearly observed in the data fig 5 e black line but the trajectories of our markovian gillespie simulations fail to recapitulate it fig 5 e blue line we then introduced a memory property to the simulations allowing the probabilities of each possible event to depend on the nature of the previous event with the very first event taken using the uncorrelated probabilities the model has nine possible states with each state containing its own set of event probabilities corresponding to the nine possible events that might have preceeded it these are an increase a decrease or no change in each pc indepenently 3 x 3 events these non marovian simulations recovered the distribution of correlations observed in the data fig 5 e red line this indicates that such features of cell shape change can only be addressed by methods that acknowledge a dependency on past events discussion eukaryotic chemotaxis emerges from a vast network of interacting molecular species here instead of examining the molecular details of chemotaxis in dictyostelium discoideum we have inferred properties that capture cell behavior from observations of shape alone for this purpose we quantified shape using fourier shape descriptors reduced these shape data to a small tractable dimensionality by principal component analysis and built a minimal model of behavior using the maximum caliber variational method unlike conventional modeling approaches such as master equations and their simplifications our method is intrinsically non markovian capturing memory effects and short term history in the values of the behavioral signature it yields see si for further discussion of memory and a comparison to the master equation our approach has the advantage of ease requiring only the observation of what a cell naturally does 14 without tagging or genetic manipulation as well as of generality being independent from the specific and poorly understood biochemistry of any one cell type this is important to understanding chemotaxis as the biochemistry governing this process can vary greatly for example the spermatazoa of c elegans chemotax and migrate with no actin at all 28 but strategies for accurate chemotaxis might be shared among biological systems and cell types a number of recent studies have demonstrated the importance of pairwise or short scale correlations in determining complex 5 13 behaviors both in space and time the behavior of large flocks of starlings can be predicted from the interactions of individual birds with their nearest neighbors 29 30 and the pairwise correlations between neurons can be used to replicate activity at much higher coupling orders correctly reproducing the coordinated firing patterns of large groups of cells 23 furthermore cells in many circumstances use short range spatial interactions to organise macroscopically 31 interestingly these systems appear to exhibit self organized criticality 32 33 in which the nature of their short range interactions leads to periods of quiescence puntuated by sudden changes this could indicate the coupling strengths inherent to a system such as the temporal correlations in our shape modes in dictyostelium cells are crucial for complex behavior absence of this behavior could be an indicator of disease as illustrated by both of our aberrant cell types here we employ a very simple classifier to demonstrate the usefulness of our maxcal multipliers as a measurement by which we can classify cell behaviours we choose maxcal because it is a minimal statistical approach to modelling a complex phenomenon allowing high descriptive power with no assumptions made about the underlying mechanism as our understanding of the molecular biology controlling cell shape improves an interesting alternative would be to use our data in training recurrent neural network rnn auto encoders a self supervised method in which the neural network trains a model to accurately represent the input data in particular long short term memory rnns have recently been used to accurately identify mitotic events 34 in cell video data and classes of random migration based on cell tracks 35 the two approaches are not mutually exclusive maxcal can provide a neat compressed basis in which to identify behavioural states of cells whilst rnns could be used to learn time series rules for transitions between behavioural states it is increasingly clear that cell shape is a powerful discriminatory tool 10 for example diffeomorphic methods of shape analysis have the power to discriminate between healthy and diseased nuclei 36 shape characteristics can also be used as an indicator of gene expression 15 an automated shape based classification of drosophila haemocytes recently showed that shape characteristics correlate with gene expression levels specifically that depletion of the tumor suppressor pten leads to populations with high numbers of rounded and elongated cells of particular note is the observation from this study that genes regulate shape transitions as opposed to the shapes themselves illustrating the importance of tools to quantify behavior as well as shape this may be an appropriate approach to take if for example creating automated assistance for pathologists when classifying melanocytic lesions a task which has already proved tractable to automated image analyses 37 as classes are few in number predefined and extensive training data are available a drawback of the method used by 15 is that their classes are decided in advance and the divisions between them are arbitrary this means that the method cannot find novel important features of shape by definition as it can only pick between classes decided upon by a person in advance a stronger alternative would be to take some more general description of shape and behavior such as the one we detail here which could be used to give biopsied cells a quantitative signature training would then map these data not onto discrete classes but onto measured outcomes based on the long term survival of patients it will be important for any such method to account for the heterogeneity of primary tissue samples as small sub populations lost in gross measurements may be key determinants of patient outcomes such an approach would allow a classifier to identify signs of disease and metastatic potential not previously observed or conceived of by the researchers themselves as machine learning advances it will be vital to specify the problem without the insertion of our own biases then behavioral quantification will become a powerful tool for medicine 1 methods cell culture the cells used in our experiments are either of the dictyostelium discoideum ax 2 strain or a stable myosin heavy chain knockout mhca in an ax 2 background cells are grown in a medium containing 10 g ml geneticin 418 disulfate salt g 418 sigma aldrich and 10 g ml blasticidine s hydrochloride sigma aldrich cells are concentrated to c 5 106 cells ml in shaking culture 150 rpm five hours prior to the experiment cells are washed with 17 mm k na pbs ph 6 0 sigma aldrich four hours prior to the experiment cells are pulsed every 6 minutes with 200 nm camp and are introduced into the microfluidic chamber at c 2 5 105 cells ml measurements are performed with cells starved for 5 7 h drug treated cells were exposed to 200 pm p bromophenacyl bromide and 50 nm ly 294002 no cells sampled in ax 2 control drug treated ax 2 parent mhca are respectively 313 23 858 198 microfluidics and imaging the microfluidic device is made of a slide 3 in 1 microfluidic chamber ibidi as described in 12 with three 0 4 1 0 mm 2 inflows that converge under an angle of 32 to the main channel of dimension 0 4 3 0 23 7 mm 3 both side flows are connected to reservoirs built from two 50 ml syringes braun melsungen ag separately connected to a customized suction control pressure pump nanion two micrometer valves upchurch scientific reduce the flow velocities at the side flows the central flow is connected to an infusion syringe pump tse systems which generates a stable flow of 1 ml h measurements were performed with an axiovert 135 tv microscope zeiss with ld plan neofluar objectives 20 x 0 50 n a and 40 x 0 75 n a zeiss in combination with a dv 2 dualview system photometrics a solution of 1 m alexa fluor 568 hydrazide invitrogen was used to characterize the concentration profile of camp sigma aldrich because of their comparable molecular weight 6 13 image preprocessing we extracted a binary mask of each cell from the video data using canny edge detection thresh olding and binary closing and filling the centroid of each mask was extracted to track cell movement overlapping masks from multiple cells were discarded in order to avoid unwanted contact effects such as distortions through contact pressure and cell cell adhesion for each binary mask the coordinates with respect to the centroid of 64 points around the perimeter were encoded in a complex number with each shape therefore recorded as a 64 dimensional vector of the form s x iy these vectors were passed through a fast fourier transform in order to create fourier shape descriptors principal component analysis was performed on the power spectra with the power spectrum p f s f 2 for the frequency domain signal s f to find the dominant modes of variation this approach is superior to simple descriptors such as circularity and elongation as key directions of variability within the high dimensional shape data cannot be known a priori as we have previously reported 13 90 of dictyostelium shape variation can be accounted for using the first three principal components pcs corresponding to the degree of cell elongation pc 1 pseudopod splitting pc 2 and polarization in the shape pc 3 fig 1 b with around 85 of variability accounted for in just two and 80 in one 2 acknowledgements we are grateful to b rn meier for sharing his data and to both andr brown linus schumacher and peter thomason for a critial reading of the manuscript this work was supported by cancer research uk core funding l t the deutsche forschungs gemeinschaft dfg fund he 5958 2 1 the volkswagen foundation grant i 85100 d h and the bbsrc grant bb n 00065 x 1 r g e well as the erc starting grant 280492 pphpi r g e author contributions statement lt and rge designed the study lt and pw performed the experiments and lt conducted data analysis and modelling all authors lt pw dh rhi rge analyzed results and data and wrote the paper additional information competing interests all authors declare that there is no conflict of interest neither financial nor non financial references 1 csermely d mainardi d agostini n 1989 the predatory behaviour of captive wild kestrel falco tinnunculus l bull zool 56 317 320 2 stephens g j johnson kerner b bialek w ryu w s 2008 dimensionality and dynamics in the behavior of c elegans plos comput biol 4 e 1000028 3 andrew n insall r h 2007 chemotaxis in shallow gradients is mediated independently of ptdins 3 kinase by biased choices between random protrusions nat cell biol 9 193 200 4 neilson mp et al 2011 chemotaxis a feedback based computational model robustly predicts multiple aspects of real cell behaviour plos biol 9 e 1000618 5 van haastert p j m 2010 a model for a correlated random walk based on the ordered extension of pseudopodia plos comput biol 6 e 1000874 6 otsuji m terashima y ishihara s kuroda s matsushima k 2010 a conceptual molecular network for chemotactic behaviors characterized by feedback of molecules cycling between the membrane and the cytosol sci signal 152 ra 89 7 westendorf c et al 2013 actin cytoskeleton of chemotactic amoebae operates close to the onset of oscillations proc nat acad sci usa 110 3853 3858 8 davidson a j amato c thomason p a insall rh 2017 wasp family proteins and formins compete in pseudopod and bleb based migration j cell biol jcb 201705160 9 swaney k f huang c h devreotes p n 2010 eukaryotic chemotaxis a network of signaling pathways controls motility directional sensing and polarity ann rev biophys 39 265 289 10 marklein r a lam j guvendiren m sung k e bauer s r 2017 functionally relevant morphological profiling a tool to assess cellular heterogeneity trends biotech 36 105 118 11 van haastert p j m postma m 2007 biased random walk by stochastic fluctuations of chemoattractant receptor interactions at the lower limit of detection biophys j 93 1787 1796 7 13 12 tweedy l knecht d a mackay g m insall r h 2016 self generated chemoattractant gradients attractant depletion extends the range and robustness of chemotaxis plos biol 14 3 e 1002404 13 tweedy l meier b stephan j heinrich d endres r g 2013 distinct cell shapes determine accurate chemotaxis sci rep 3 10 1038 srep 02606 14 keren k et al 2008 mechanism of shape determination in motile cells it nature 453 475 480 15 yin z et al 2013 a screen for morphological complexity identifies regulators of switch like transitions between discrete cell shapes nat cell biol 15 860 872 16 broekmans o d rodgers j b ryu w s stephens g j 2016 resolving coiled shapes reveals new reorientation behaviors in c elegans elife 5 e 17227 17 gyenes b brown a e x 2016 deriving shape based features for c elegans locomotion using dimensionality reduction methods front behav neurosci 10 159 18 valletta j j torney c kings m thornton a madden j 2017 applications of machine learning in animal behaviour studies animal behav 124 203 220 19 gomez marin a stephens g j brown a e x 2016 hierarchical compression of caenorhabditis elegans locomotion reveals phenotypic differences in the organization of behaviour front behav neurosci 13 20160466 20 press s ghosh k phillips r dill k a 2010 dynamical fluctuations in biochemical reactions and cycles phys rev e 82 031905 21 press s ghosh k lee j and dill ka 2013 principles of maximum entropy and maximum caliber in statistical physics rev mod phys 85 1115 1141 22 jaynes e t 1980 the minimum entropy production principle ann rev phys chem 31 579 601 23 schneidman e berry m j segev r bialek w 2006 weak pairwise correlations imply strongly correlated network states in a neural population nature 440 1007 1012 24 cavagna a et al 2014 dynamical maximum entropy approach to flocking phys rev e 89 042707 25 vasquez j c marre o palacios a g berry ii m j cessac b 2012 gibbs distribution analysis of temporal correlations structure in retina ganglion cells j physiology paris 106 120 127 26 firman t bal zsi g ghosh k 2017 building predictive models of genetic circuits using the principle of maximum caliber j biophys j 113 2121 2130 27 meier b et al 2011 chemotactic cell trapping in controlled alternating gradient fields proc natl acad sci usa 108 11417 11422 28 nelson g a roberts t m ward s 1982 caenorhabditis elegans spermatozoan locomotion amoeboid movement with almost no actin j cell biol 92 121 131 29 toner j tu y 1995 long range order in a two dimensional dynamical xy model how birds fly together phys rev lett 75 4326 4329 30 bialek w et al 2012 statistical mechanics for natural flocks of birds proc nat acad sci usa 109 4786 4791 31 de palo g yi d endres rg 2017 a critical like collective state leads to long range cell communication in dictyostelium discoideum aggregation plos biol 15 1 25 32 mora t bialek w 2011 are biological systems poised at criticality j stat phys 2 268 302 33 chialvo d r 2010 emergent complex neural dynamics nat phys 6 774 750 34 phan h t h kumar a feng d fulham m kim j 2018 unsupervised two path neural network for cell event detection and classification using spatio temporal patterns ieee t med imaging doi 10 1109 tmi 2018 2885572 35 kimmel j c brack a s marshall w f 2019 deep convolutional and recurrent neural networks for cell motility discrimination biorxiv doi 10 1101 159202 36 rohde g k ribeiro a j s dahl k n murphy r f 2008 deformation based nuclear morphometry capturing nuclear shape variation in hela cells cytom part a 73 a 341 350 37 esteva a et al 2017 dermatologist level classification of skin cancer with deep neural networks nature 542 115 118 8 13 x s y s y x n 5 a 2 4 5 1 pcs included r es id ua l v ar ia nc e 10 m 1 3 5 90 n 12 s pc 1 elongation pc 2 splitting pc 3 polarization b p c 2 pc 1 pc 1 c shallow attractant gradient steep attractant gradient 0 50 100 150 10 0 10 20 30 0 50 100 150 10 0 10 20 30 figure 1 fourier shape descriptors reveal low dimensional shape space a left the outline of a live cell is converted to a set of coordinates which are a function of the distance traveled around the perimeter s right the original outline can be reconstructed with increasing accuracy by increasing the number n of included fourier components we record 64 components for each shape and use all of them in our analyses b principal component analysis pca performed on fourier spectra of cell shapes from 900 cells in a wide range of chemical gradients reveals that 90 83 of shape variability in d discoideum can be accounted for in the first three two principal components corresponding to elongation splitting and polarization in the spatial domain the inset picture above each pc shows its reconstruction in the spatial domain i e after reverse fourier transformation each is added to solid line and subtracted from dashed line the mean cell shape descriptor in order to guarantee their invariance when rotated or flipped we use only the power spectrum of the fourier component which renders their reconstructions symmetric we show shapes here that are two standard deviations above solid lines and below dashed lines the mean shape in each pc for fourier contributions to each pc see fig s 1 for details on data collection and analysis see materials and methods and 13 c example trajectories in the pc 1 and pc 2 shape space for one low and one high signal to noise ratio cell example cell outlines from the two trajectories are superimposed in their correct positions 9 13 t t t 2 t n t particles n t 1 n t 1 n t 2 n t 2 1 1 n t 1 1 1 1 1 1 n t 1 n t n t 1 t time b t t t t t 1 1 2 2 t t 1 1 2 2 1 1 2 2 1 1 2 2 c d 1 1 2 2 1 11 11 12 12 1 11 12 12 2 22 22 2 22 2 2 1 1 22 12 2 2 22 1 1 11 12 no change 1 2 11 a pc 2 pc 1 1 1 1 1 1 1 2 2 22 2 2 1 2 12 12 1 2 coupled multiplier values calculated uncorrelated simulatedobserved 1 2 3 4 possible moves in 1 t figure 2 maxcal trained simulations reproduce local correlations a the panel shows the trajectory of a cell in shape space over time as it shortens splits pseudopods commits to one pseudopod and lengthens again our aim is to distil this complex behavioral information into a small quantifiable signature for this behavor in a manner that will yield similar signatures for similar behaviors we subdivide the shape space and register specific small events when cells cross boundaries the elements of our signature are a series of multipliers that are determined by the rates at which particular events are observed we introduce multipliers for two types of events simple events which encode the average rate of increase or decrease in each principal component of shape and correlated events which encode how often we see certain combinations of simple events in quick succession for every pair of simple events there is a specific multiplier see c as multipliers for simple events encode the average rate at which transitions between squares occur in any particular direction the input data for these events are any two adjacent time points for example the first two red spots here we see that pc 1 has decreased increasing the average value of the multiplier 1 and pc 2 has increased thereby increasing the value of 2 in contrast the first two yellow points occupy the same square and as we are encoding the likelihood of transitions the values of all simple event multipliers are lowered to represent this inactivity multipliers for correlated events involve three adjacent time points as they encode the likelihood of any one simple event following another particular simple event for example the three red dots increase the value of three correlated multipliers 1 1 due to a decrease in pc 1 being adjacent to another decrease in pc 1 2 2 due to an increase in pc 2 being adjacent to another increase in pc 2 and 1 2 due to a decrease in pc 1 being adjacent to an increase in pc 2 the set of yellow dots does not increase the likelihood of any such correlated events as there are no transitions in the first time step the contributions of the whole trajectory can eventually comprise a quantitative signature in which correlated events appear more or less frequently than would be expected by chance shown below the main diagram with blue indicating a higher and red a lower likelihood the calculation of the magnitudes of these contributions is complicated and makes up much of this paper note that though the example trajectory shown here is real the sub divisions and time points are instructional only inset in a single timestep 1 t a cell may be observed to move to any of the eight neighbouring squares or may move to none of them resulting in nine possible observed trajectories b diagram of all possible trajectories for a single shape component over time interval 2 t the redundancy of each path is indicated by the number above c correlation parameters inferred from data lagrange multipliers are found corresponding to increases 1 and decreases 1 in pc 1 and increases 2 and decreases 2 in pc 2 additional lagrange multipliers controlling the rates at which these events occur in neighboring time steps are shown in the table and rates are assumed to be symmetric i e event a followed by event b is equivalent to event b followed by event a d co occurrences of transitions in neighboring time steps are shown for simulations based only on naive probabilities without correlations left for data centre and for simulations that include short term temporal correlations right all are scaled relative to the naive rates of transition observed in the data 10 13 1 observed correlated uncorrelated 1 01 02 05 1 2 5 0 1 10 7 10 5 10 3 p ro ba bi lit y d en si ty p ro ba bi lit y p re di ct ed p ro ba bi lit y observed probability divergence bits a b c correlated uncorrelated correlated uncorrelated 0 1 0 2 0 5 1 2 4 6 8 transitions transitions 2 4 6 8 10 10 12 10 10 10 8 10 6 10 4 10 2 2 4 6 8 10 0 10 20 30 1 2 1 2 time s figure 3 maxcal model reproduces long term cell behavior a top example track of naive transitions possible patterns are highlighted three 2 in a row and four 1 in a row are given as examples this panel is illustrative though the track shown does correspond to the shape transition in the cartoon there are spaces in between all transitions here and actual 3 in a row transitions would be even denser bottom observed versus predicted probabilities of various patterns of transitions for simulations containing red or ignoring blue short term temporal correlations the black line corresponds to perfect matching of predicted and observed probabilities patterns are always for a single transition type e g 1 only and are of the form n transitions in t time steps for varying n and t e g three 1 transitions in four time steps t runs from 10 to 20 in unit steps n runs from t 8 to t in unit steps b jensen shannon divergence between patterns of transitions observed in the data and both correlated red and uncorrelated blue simulations c probability of observing repeated transitions of a single type under 3 models the correlated model red the uncorrelated model blue and when observed black results shown for 1 left and 1 right the x axis gives the number of repeats in a row of this transition 11 13 parental drug treated mhca 3 2 1 0 1 0 20 40 60 80 100 11 1 0 0 0 1 0 0 20 40 60 80 100 22 0 0 0 5 1 0 0 50 100 150 12 0 0 0 5 1 0 1 5 2 0 0 50 100 150 12 0 4 0 0 0 4 0 40 80 120 0 2 0 0 0 2 0 4 0 20 40 60 0 4 0 6 0 8 1 0 0 40 80 120 0 4 0 6 0 8 1 0 0 50 100 150 200 d e 100 0 100 2000 00 0 05 0 10 0 15 0 20 10 0 10 20 0 00 0 05 0 10 0 15 pc 1 pc 2 c 0 100 200 300 0 00 0 05 0 10 0 15 20 10 0 10 0 00 0 05 0 10 0 15 0 20 0 25 pc 1 pc 2 a ax 2 parent mhca ax 2 dic ax 2 phase mhca drug treated b figure 4 maximum caliber coupling strengths reflect behavioral differences a representative phase contrast images of ax 2 l cells and mhca r cells scale bar is 10 m b outlines of cells as they move for all conditions in the study we imaged drug treated cells paired with an ax 2 parental control in differential interference contrast dic and the mhca control with an ax 2 parent in phase contrast microscopy so we present these controls separately here for clarity we show outlines at intervals of one minute or thirty frames c distributions in shape space of the bpb ly treated cells red and the mhca strain green vs their respective controls blue darker red and green areas show where the compared conditions overlap d lagrange multipliers x log 10 x from maxcal model trained on untreated cells blue and p bromophenacyl bromide bpb and ly 294002 treated cells red untreated cells have coupling values for 1 1 and 2 2 much lower than 0 indicating the persistence in the direction of cell shape change or more accurately the rarity of reversals in contrast treatment with causes cells to have couplings values for 1 1 and 2 2 that are not significantly different to zero indicating a lack of such persistence untreated cells also have much higher values than drug treated for 1 2 and 1 2 indicating a stronger anticorrelation between the two components remaining distributions of rates can be found in fig s 4 the distributions of all 14 rates differ significantly upon drug treatment 0 001 kolmogorov smirnov test e the distributions for the same parameters for mhca cells green against their parental control blue the changes in 1 1 1 2 and 1 2 show similar changes to those observed in drug treatment these experiments used phase contrast microscopy rather than the dic used in the drug treated case leading to the differences in the extremity of these coupling coefficients 12 13 c la ss ifi ca tio n sc or e c 10 20 30 40 50 5 10 15 20 ax 2 vs bpb ly ax 2 vs mhc using 3 shape pcs using maxcal samples samples 1 0 0 5 0 5 1 0 0 2 0 4 0 6 0 8 1 0 1 2 correlation pc 1 pc 2 pdf data memory no memory e c la ss ifi ca tio n sc or e a using one shape pc b using two shape pcs 10 20 30 40 50 0 5 0 6 0 7 0 8 0 9 1 0 10 20 30 40 50 0 5 0 6 0 7 0 8 0 9 1 0 d figure 5 discriminators trained on maxcal behavioral descriptors perform better than shape alone a c success rates for k nearest neighbors based on the shapes of cells alone some number of samples are taken from the same condition and individually classified using the first 1 a 2 b or 3 c shape pcs with the most commonly chosen classification used to identify the group classification is performed on both untreated vs bpb ly treated blue and parental vs mhca green data d a similar k nearest neighbor classification to a c but with distances between neighbors based on the values of the two lagrange multipliers that best separate the training data e degree of correlation between pc 1 and pc 2 across a number of simulated cell trajectories three lines are shown corresponding to the data black a non markovian red master equation in which transition probabilities depend on the last transition made and a markovian blue master equation in which they simply depend on the current state the markovian model without memory lacks the skew toward negative correlations seen in the data the non markovian model with memory recovers these 13 13 1 methods 2 acknowledgements references