ar x iv 1 70 6 07 44 5 v 1 m at h a c 2 2 ju n 20 17 interpolating between hilbert samuel and hilbert kunz multiplicity william d taylor abstract we define a function called s multiplicity that interpolates between hilbert samuel multiplicity and hilbert kunz multiplicity by comparing powers of ideals to the frobenius powers of ideals the function is continuous in s and its value is equal to hilbert samuel multiplicity for small values of s and is equal to hilbert kunz multiplicity for large values of s we prove that it has an associativity formula generalizing the associativity formulas for hilbert samuel and hilbert kunz multiplicity we also define a family of closures such that if two ideals have the same s closure then they have the same s multiplicity and the converse holds under mild conditions we describe the s multiplicity of monomial ideals in toric rings as a certain volume in real space 1 introduction the purpose of this paper is to investigate a function that interpolates continuously between hilbert samuel multiplicity and hilbert kunz multiplicity first we define a limit that behaves like a multiplicity then we normalize it to get a proper interpolation between the hilbert samuel and hilbert kunz multiplici ties this interpolating function which we call s multiplicity is a single object which captures the behavior of both multiplicities as well as a family of multiplicity like functions between them many of the similarities between the two multiplicities such as the existence of an associativity formula and the connection to a closure can be interpreted as special cases of a more general statement about s multiplicity throughout this paper all rings will be assumed noetherian by r m we mean the length of m as an r module when the ring r is understood we may write m for r m definition 1 1 let r m be a local ring of dimension d i r an m primary ideal of r and m a finitely generated r module the hilbert samuel multiplicity of m with respect to i is defined to be e i m lim n d m inm nd we often write e i for e i r many properties of the hilbert samuel multiplicity are well known for instance if i j are ideals that have the same integral closure then e i e j and if r is formally equidimensional then the converse holds ree 61 the hilbert samuel multiplicity is always a positive integer e m 1 if r m is regular and if r is formally equidimensional the converse holds nag 62 theorem 40 6 when r is of prime characteristic p 0 the frobenius map f r r taking r 7 rp is a ring homomorphism and so we may treat r as a module over itself via the action r x rpx in this case we often denote the module r with this new action by f r and elements of this module by f r for r r an r module homomorphism f r r is called a p 1 linear map and has the property that for any r x r r f x f rpx if f r is finitely generated as an r module we say the ring r is f finite for an ideal i r and e n the eth frobenius power of i denoted i pe is the ideal generated by the peth powers of the elements of i equivalently by the pe th powers of a set of generators for i for any p 1 linear map and ideal i r f i p i when r is a ring of positive characteristic we can define a limit similar to the hilbert samuel multiplicity using the frobenius powers of the ideal instead of the powers definition 1 2 let r m be a local ring of dimension d i r an m primary ideal of r and m a finitely generated r module the hilbert kunz multiplicity of m with respect to i is defined to be ehk i m lim e m i p e m ped 1 http arxiv org abs 1706 07445 v 1 2 william d taylor we often write ehk i for ehk i r the hilbert kunz multiplicity has some properties similar to the hilbert samuel multiplicity in partic ular if i j are ideals that have the same tight closure then ehk i ehk j and if r is complete and equidimensional then the converse holds hh 90 theorem 8 17 the hilbert kunz multiplicity is a real number at least 1 though unlike the hilbert samuel multiplicity it need not be an integer however like the hilbert samuel multiplicity ehk m 1 if r m is regular and if r is unmixed then the converse holds wy 00 theorem 1 5 a brief outline of the paper is as follows in section 2 we prove the existence of the limit used to define the s multiplicity and establish many of its fundamental properties that we will use throughout the paper of particular note are the results that the s multiplicity is continuous in the parameter s and the associativity formula for s multiplicity in section 3 we examine the relationship between the s multiplicity and the hilbert samuel and hilbert kunz multiplicity and compute the limit from section 2 for regular rings which allows us to finish the definition of the s multiplicity in section 4 we define a collection of closures and prove that they have exactly the same relationship with s multiplicity as integral closure resp tight closure has with hilbert samuel resp hilbert kunz multiplicity in section 5 we describe a method for computing the s multiplicity of pairs of ideals in toric rings and use it to compute the s multiplicity of the an singularities and rational normal curves acknowledgments the author would like to thank his ph d advisor mark johnson for very many fruitful discussions and much excellent advice additionally the author is indebted to lance edward miller neil epstein and paolo mantero for profitable discussions 2 the multiplicity like function hs i j m we begin by considering a limit which combines aspects of the limits defining the hilbert samuel and hilbert kunz multiplicities the idea is to take the colengths of a sum of ideals one of which corresponds to the increasing frobenius powers of an ideal j and one of which corresponds to a subsequence of the powers of another ideal i this subsequence will be determined by a real number s we require that both of these ideals be primary to the maximal ideal of the ring they belong to so that at the extreme values of the parameter s one of the two ideals will dominate the other this guarantees that in the extremal cases we will get a limit related to either the hilbert samuel multiplicity of i or the hilbert kunz multiplicity of j theorem 2 1 let r m be a local ring of dimension d and characteristic p 0 let i and j be m primary ideals of r let m be a finitely generated r module and let s 0 the limit lim e m i sp e j p e m ped exists to prove this we require a few results that will describe the generators of certain modules as k vector spaces and establish some combinatorial facts which will allow us to effectively estimate the module lengths involved in the proof lemma 2 2 let r m k be a local ring containing its residue field and let m be an r module of finite length let x 1 xt be a set of generators for m and m 1 mn a set of generators for m then i m is generated as a k vector space by elements of the form xb 11 x bt t mj where b 1 bt n and 1 j n and ii if i f 1 fm is an m primary ideal of r then m is generated as a k vector space by elements of the form fa 11 famm gmj where a 1 am n 1 j n and g is a generator of r i as a k vector space proof i by definition m is generated as a k vector space by elements of the form rmj with r r and 1 j n for each such r we have that r v t i 1 rixi for some v k and ri r since r k m as a k vector space for each i we may write ri vi n j 1 rijxj with vi k and rij r and so r v t i 1 vixi 1 i j t ri jxixj interpolating between hilbert samuel and hilbert kunz multiplicity 3 we may repeat this process until every term either has a coefficient of the xi s which is an element of k or has a degree in the xi s large enough that the term annihilates m and so may be removed ii by part i m is generated as a k vector space by terms of the form fa 11 famm x b 1 1 x bt t mj with ai bi n fix a set of k vector space generators gi of r i suppose that we have an element fa 11 famm x b 1 1 x bt t mj m with x b 1 1 x bt t gi there exists i such that x b 1 1 x bt t gi i and so there exist r 1 rm r such that xb 11 x bt t gi m 1 r f therefore fa 11 famm gimj m 1 fa 11 f a 1 f am m r mj we know by part i that r mj is a k linear combination of terms of the form x b 1 1 x b t t mj and so we have that is a k linear combination of terms of the form fa 11 famm gimj and f a 1 1 f a m m x b 1 1 x b t t mj with a 1 a continuing in this way we may write as a k linear combination of terms either of the form fa 11 famm gimj for some i or of the form f a 1 1 famm x b 1 1 x bt t mj with i ai arbitrarily large since i n annihilates m for some n we may throw out all the terms of the second kind which finishes the proof bounding the lengths of the ideals we are concerned with will involve some combinatorial calculations for convenience we introduce some notation for positive integers d and m and real number r we set smd r to be the number of monomials in d variables with degree less than r and with degree in each variable less than m certain properties of the numbers smd r are easy to see first if r 0 then sm 1 r min m r second for d 1 we have that smd r m 1 i 0 s m d 1 r i indeed if we denote one of the variables by x then for i 0 1 m 1 there are smd 1 r i monomials with degree exactly i in x degree less than r and with degree in each variable less than m we will occasionally use a combinatorial description of the numbers sdm r which is established in the following lemma this result appeared in a more general form as rs 13 lemma 2 5 though the method of proof was different lemma 2 3 for positive integers d and m and real number r smd r d i 0 1 i d i r im 1 d d proof the number of monomials in d variables of degree less than r where each of a given set of i vari ables has degree at least m is the number of monomials in d variables of degree less than r im that is r im 1 d d thus the total number of monomials in d variables of degree less than r with degree in each variable less than m is r 1 d d d i 1 1 i 1 r im 1 d d by the inclusion exclusion principle our next lemma is a technical result on the behavior of the numbers smd r as m and r grow lemma 2 4 if f g n r are functions such that f n g n cn o n for some c r f n g n for n 0 and u is a positive integer then lim sup n sund f n sund g n nd ud 1 c proof we proceed by induction on d suppose d 1 and let n n large enough that f n g n if un g n we have that sun 1 f n sun 1 g n 0 and if un g n then sun 1 f n sun 1 g n f n g n f n g n 1 4 william d taylor therefore lim sup n sun 1 f n sun 1 g n n lim sup n f n g n 1 n c now suppose that d 1 then sund f n sund g n un 1 i 0 sund 1 f n i sund 1 g n i un sund 1 f n in sund 1 g n in where in is the value of i with 1 i un 1 that maximizes the expression sund 1 f n i sund 1 g n i by induction lim sup n sund f n sund g n nd lim sup n un sund 1 f n in sund 1 g n in nd u lim sup n sund 1 f n in sund 1 g n in nd 1 u ud 2 c ud 1 c proof of theorem 2 1 if d 0 then for large enough e i sp e j p e 0 and so the limit is simply r suppose that d 1 if k is not infinite we may replace r by s r x mr x for any r module n we have r n s n r s and so we may assume without loss of generality that the ring r has infinite residue field let k be a reduction of i generated by d elements f 1 fd r and let w be the reduction number of i with respect to k let x 1 xt r be a set of generators for the maximal ideal m let m 1 mn m be a set of generators of m let v n such that kv j let q q be varying powers of p if q w d s then for sufficiently large q we have that k sq j q q i sq j q q i sq q j q q k sq q w j q q k sq d 1 j q q therefore m k sq d 1 j q q m m i sq q j q q m m k sq j q q m if we divide the first and last terms of this inequality by qd then the limit as q exists by mon 83 theorem 1 8 hence lim sup q 1 qd m i sq q j q q m lim inf q 1 qd m i sq q j q q m lim q 1 qd m k sq j q q m m k sq d 1 j q q m lim q 1 qd k sq d 1 j q q m k sq j q q m let q k sq d 1 j q q m k sq j q q m k q sq d 1 m k q sq j q q m k q sq d 1 m as an r module q is generated by elements of the form f y 1 q 1 f ydq d m where i yi sq d 1 and 1 n therefore by lemma 2 2 q can be generated as a k vector space by elements of the form f y 1 q z 1 1 f ydq zd d gm where bi yi zi n i yi sq d 1 and g is a k vector space generator of r k letting ci yi zi q and ai zi q zi q we have that ciq ai yiq zi and ai q and so q can be generated as a k vector space by elements of the form f c 1 q a 1 1 f cdq ad d gm where ai bi ci n interpolating between hilbert samuel and hilbert kunz multiplicity 5 ai q i ci sq d 1 g is a k vector space generator of r k and 1 n however if i ci sq or ci vq for some i then the product above vanishes in q therefore q qd s vq d sq svq d sq d 1 r k n from this we have that lim sup q 1 qd m i sq j q m lim inf q 1 qd m i sq j q m lim sup q 1 q q d m i sq q j q q m lim inf q 1 q q d m i sq q j q q m lim q qd s vq d sq svq d sq d 1 r k n q q d s vq d sq svq d sq d 1 r k n q d since this holds for all q 0 and by lemma 2 4 lim sup q 1 qd m i sq j q m lim inf q 1 qd m i sq j q m lim sup q s vq d sq svq d sq d 1 r k n q d 0 thus the limit exists and the theorem is proved definition 2 5 let r m be a local ring of dimension d and characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module for s 0 we set hs i j m lim e m i sp e j p e m ped we will often write hs i j for hs i j r hs i m for hs i i m hs i for hs i r and hs m for hs m m if we wish to emphasize the ring r we will write h r s i j m or a similarly decorated variant we next establish some properties of hs i j m we will use the next result repeatedly throughout the paper often without explicit reference proposition 2 6 let r m be a local ring of dimension d and characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module the following statements hold i hs i j m min s d d e i m ehk j m ii if dimm d then hs i j m 0 iii if s s then hs i j m hs i j m iv if i and j are ideals of r such that i i and j j then hs i j m hs i j m v if i is an ideal of r with the same integral closure as i then hs i j m hs i j m vi if j is an ideal of r with the same tight closure as j then hs i j m hs i j m proof i for all e n we have that i spe j pe i spe hence lim e m i sp e j p e m ped lim e m i sp e m spe d spe d ped sd d e i m furthermore for all e n we have that i spe j pe j pe hence lim e m i sp e j p e m ped lim e m j p e m ped ehk j m ii by mon 83 lemma 1 2 ehk j m 0 for any m with dimm d and so part i gives us the result 6 william d taylor iii for all e n we have that i spe j pe i s pe j pe hence m i sp e j p e m m i s pe j p e m iv for all e n we have that i sp e j pe i spe j pe hence m i spe j pe m m i sp e j p e m v it suffices to prove the case where i i the integral closure of i if s 0 then we have that by part iv and hs 06 proposition 11 2 1 0 hs i j m hs i j m lim e 1 ped i spe j p e i sp e j p e lim e 1 ped i sp e i sp e sd d e i e i 0 vi it suffices to prove the case where j j the tight closure of j we have that by part iv and hh 90 theorem 8 17 0 hs i j m hs i j m lim e 1 ped i sp e j pe i sp e j p e lim e 1 ped j p e j p e ehk j ehk j 0 theorem 2 7 let r m be a local ring of characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module the function hs i j m is lipschitz continuous proof let 0 the function hs i j m is increasing by proposition 2 6 iii so we need only bound hs i j m hs i j m above in terms of let d dimr if d 0 then hs i j m hs i j m m so 0 is a lipschitz constant for hs i j m suppose d 1 we may assume that r m is infinite and so we may assume that i is generated by d elements by replacing it with a minimal reduction by proposition 2 6 v let i f 1 fd let m x 1 xt let v n such that iv j and let m 1 mn be a set of generators for m then hs i j m hs i j m lim e 1 ped m i s p e j p e m m i sp e j p e m lim e 1 ped i sp e j p e m i s p e j p e m lim e 1 ped i sp e m i s p e j p e m i spe m the quotient module in the last line is generated as a k vector space by elements of the form fa 11 f ad d gm where i ai spe g is a k vector space generator of r i and 1 n however if i ai s pe or ai vpe for some i then the corresponding product vanishes therefore i sp e m i s p e j p e m i spe m s vpe d s p e svp e d sp e r i n and so by lemma 2 4 hs i j m hs i j m lim sup e s vpe d s p e svp e d sp e r i n ped vd 1 r i n hence vd 1 r i n is a lipschitz constant for hs i j m our most important application of theorem 2 7 is the next result which proves that hs i j m is additive on short exact sequences a direct consequence of this will be the associativity formula for s multiplicity theorem 2 8 let r m be a local ring of characteristic p 0 and let i and j be m primary ideals of r if 0 m m m 0 is a short exact sequence of finitely generated r modules then hs i j m hs i j m hs i j m interpolating between hilbert samuel and hilbert kunz multiplicity 7 proof let d dimr let m be the minimal number of generators of i and fix e n for any e n we have that i s m p e pe e j p e e i sp e j p e pe i sp e e j p e e by mon 83 theorem 1 6 we have that m i sp e e j p e e m m i sp e e j p e e m m i sp e j p e pe m m i sp e j p e pe m m i sp e j p e pe m o pe d 1 m i s m p e pe e j p e e m o pe d 1 dividing by p e e d and taking the limit as e we obtain that hs i j m hs i j m hs m pe i j m this holds for all e and so hs i j m hs i j m hs i j m since by theorem 2 7 hs i j m is continuous in s for the other inequality note that for any e n the sequence m i sp e j p e m m i sp e j p e m m i sp e j p e m 0 is exact whence m i sp e j p e m m i sp e j p e m m i sp e j p e m therefore hs i j m hs i j m hs i j m the additivity of hs i j m on short exact sequences is exactly what we need to prove the associativity formula for s multiplicity this proof follows the proof in nag 62 theorem 23 5 for the associativity formula for hilbert samuel multiplicity theorem 2 9 the associativity formula let r m be a local ring of characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module we have that hrs i j m p asshr hr ps i r p j r p rp mp where asshr p specr dimr p dimr proof we proceed by induction on m p asshr rp mp if m 0 then dimm dimr and so hrs i j m 0 now suppose that m 1 and fix q asshr such that rq mq 1 then q 0 r x for some x m and so we have an exact sequence 0 r q m m rx 0 we have that m rx m 1 and so by induction hrs i j m rx p asshr hr ps i r p j r p rp m rx p p asshr hr ps i r p j r p rp mp hr qs i r q j r q 8 william d taylor therefore it suffices to show that hrs i j r q h r q s i r q j r q since then by theorem 2 8 we will have the desired formula this however is an easy computation hrs i j r q lim e 1 ped r r q i sp e j p e r q lim e 1 ped r q r q i r q spe j r q pe hr qs i r q j r q 3 s multiplicity the behavior of hs i j m is related to two thresholds concerning the interactions between powers and frobenius powers of ideals definition 3 1 mtw 05 dnbp 16 let r be a ring of characteristic p 0 and let i j be ideals of r for e n let ij p e sup n n in 6 j p e and ij p e inf n n j p e 6 in the f threshold of i with respect to j is cj i lim e ij e pe similarly we set bj i lim e ij e pe lemma 3 2 let r be a ring of characteristic p 0 and let i j be ideals of r the limits defining cj i and bj i are defined furthermore if i 6 j then cj i if j r then cj i and if i j 6 r then 0 cj i similarly if j 6 i then bj i 0 if i r then bj i and if j i 6 r then bj i 0 if i 6 0 i j j i and i is contained in the jacobson radical of r then bj i cj i proof if i 6 j then ij p e for all e and so cj i if j r then ij pe for all e and so cj i suppose 1 j 6 r so that for all e 0 ij pe and so cj i 0 that cj i exists in the case i j is dnbp 16 theorem 3 4 the proof of which also shows that cj i in this case if j 6 i then ij p e 1 for all e and so bj i 0 if i r then i j p e for all e and so bj i suppose that j i 6 r the proof of the existence of bj i in this case is nearly identical to that of the existence of cj i let e e n we have that j pe e j p e pe i i j pe 1 pe ip e i j pe pe and so ij p e e pe ij p e pe therefore lim inf e ij p e pe lim inf e ij p e e pe e lim e ij p e 1 pe ij p e 1 pe hence lim inf e ij p e pe lim sup e ij p e 1 pe lim sup e ij p e pe and so the limit defining bj i exists since j i there exists e n such that j pe i and so ij pe 2 hence bj i i j pe 1 pe 0 for the last statement suppose i 6 0 i j j i and i is in the jacobson radical of r for e n we have that i i j pe 1 j pe i ij pe 1 by nakayama s lemma we have that ij pe 1 ij pe 1 therefore cj i lim e ij p e pe lim e ij p e 2 pe bj i lemma 3 3 let r m be a local ring of dimension d and characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module 1 if s bj i then hs i j m s d d e i m 2 if s cj i then hs i j m ehk j m interpolating between hilbert samuel and hilbert kunz multiplicity 9 proof if s bj i then for infinitely many e n ij pe spe and so j p e i spe therefore hs i j m lim e m i sp e j p e m ped lim e m i sp e m ped lim e m i sp e m spe d spe d ped e i m sd d if s cj i then for infinitely many e n ij pe spe and so i sp e j pe therefore hs i j m lim e m i sp e j p e m ped lim e m j p e m ped ehk j m the continuity of hs i j m gives the cases s bj i and s cj i when s is large then hs i j m precisely equals ehk j while when s is small it equals a well understood multiple of e i depending only on s and the dimension of the ring hence in order to properly interpolate between the two functions we need a normalizing factor that will take this difference in behavior into account to determine a good candidate for this factor we look at one of the most notable properties of e and ehk namely if r m is a regular local ring of positive characteristic then e m ehk m 1 to that end we calculate hs r for power series rings over a field proposition 3 4 if k is a field of characteristic p 0 and r k x 1 xd then hs r s i 0 1 i d d i s i d proof let m x 1 xd if d 0 then m 0 and so hs r 1 s i 0 1 i 0 i s i 0 if d 1 then by lemma 2 3 we have that hs r lim e smd sp e ped d i 0 1 i d i lim e 1 ped spe ipe 1 d d s i 0 1 i d d i s i d proposition 3 4 gives us our normalizing factor and so we are ready to define the s multiplicity definition 3 5 let r m be a local ring of characteristic p 0 let i and j be m primary ideals of r let m be a finitely generated r module and let s 0 then the s multiplicity of m with respect to the pair i j is defined to be es i j m hs i j m hs d where hs r s i 0 1 i d d i s i d we may write es i j for es i j r es i m for es i i m es i for es i r and es m for es m m if we wish to emphasize the ring r we will write e r s i j m or a similarly decorated variant in order to describe the interpolating properties of the s multiplicity we need some additional facts about the functions hs d first we describe the functions explicitly for d up to 3 example 3 6 hs 0 1 hs 1 s if 0 s 1 1 if s 1 10 william d taylor hs 2 1 2 s 2 if 0 s 1 1 2 s 2 s 1 2 if 1 s 2 1 if s 2 hs 3 1 6 s 3 if 0 s 1 1 6 s 3 1 2 s 1 3 if 1 s 2 1 6 s 3 1 2 s 1 3 1 2 s 2 3 if 2 s 3 1 if s 3 certain properties of hs d are suggested by the above examples and are confirmed in the next lemma lemma 3 7 the functions hs d have the following properties i if d 1 then hs d s s 1 ht d 1 dt ii hs d is nondecreasing iii hs d is a lipschitz continuous function of s iv if s d then hs d 1 v if 0 s 1 then hs d sd d proof i this is clear for d 1 so suppose that d 2 let q and q be varying powers of p we have that hs d lim q s qq d sqq qq d lim q qq 1 i 0 s qq d 1 sqq i qq d lim q q q 1 i 0 s qq d 1 sqq qi qq d 1 q q 1 i 0 lim q s qq d 1 s i q qq qq d 1 1 q q 1 i 0 hs i q d 1 since the above holds for all q we have that hs d lim q 1 q q 1 i 0 hs i q d 1 s s 1 ht d dt a similar argument only using the inequality qq 1 i 0 s qq d 1 sqq i q q i 1 s qq d 1 sqq qi in the second line shows that hs d s s 1 ht d dt ii this is by inspection for d 0 for d 1 let 0 so by induction hs d hs d s s 1 ht d 1 ht d 1 dt 0 iii we claim that the functions hs d have lipshitz constants at most 1 this is trivial for d 0 so suppose d 1 and let 0 1 by induction hs d hs d s s 1 ht d 1 ht d 1 dt s s 1 dt iv this statement is true for d 0 by inspection assume that d 1 and hs d 1 1 for s d 1 then for s d we have that hs d s s 1 ht d 1 dt s s 1 1 dt 1 and the result follows by induction v this is clear from the definition interpolating between hilbert samuel and hilbert kunz multiplicity 11 many properties of the hs i j m immediately imply similar properties for the s multiplicity some of these properties are listed in the next three corollaries the first corollary makes explicit the interpolating properties of the s multiplicity while the second contains some auxiliary results listed for completeness the third is the associativity formula for s multiplicity corollary 3 8 let r m be a local ring of dimension d and characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module i if 0 s min 1 bj i then es i j m e i m ii if s max d cj i then es i j m ehk j m iii if r is a regular ring then es r 1 proof statements i and ii simply combine lemma 3 3 and lemma 3 7 for statement iii we may assume without loss of generality that r is complete with residue field k in which case r k x 1 xd the result then follows from definition 3 5 and proposition 3 4 corollary 3 9 let r m be a local ring of dimension d and characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module the following statements hold i es i j m is a lipschitz continuous function of s ii es i j m ehk j m hs d iii if dimm d then es i j m 0 iv if i and j are m primary ideals of r such that i i and j j then es i j m es i j m v if i is an m primary ideal of r with the same integral closure as i then es i j m es i j m vi if j is an m primary ideal of r with the same tight closure as j then es i j m es i j m vii if 0 m m m 0 is a short exact sequence of finitely generated r modules then es i j m es i j m es i j m proof i we have that es i j m is constant hence lipschitz continuous on 0 min 1 bj i by lemma 3 7 hs d is lipschitz continuous and nonzero on min 1 bj i and by theorem 2 7 hs i j m is lipschitz continuous and so es i j m is lipschitz continuous on min 1 bj i thus es i j m is lipschitz continuous parts ii vi follow from proposition 2 6 part vii follows from theorem 2 8 corollary 3 10 associativity formula for s multiplicity let r m be a local ring of characteristic p 0 let i and j be m primary ideals of r and let m be a finitely generated r module we have that ers i j m p asshr er ps i r p j r p rp mp where asshr p specr dimr p dimr proof for any p asshr dimr p d and so er ps i r p j r p h r p s i r p j r p hs d by theorem 2 9 we have that hrs i j m p asshr hr ps i r p j r p rp mp therefore dividing each term of this equation by hs d proves the result an immediate application of corollary 3 10 is the following result which shows that the s multiplicity of a module is in many cases determined by the s multiplicity of the ring itself proposition 3 11 let r m be a local domain of characteristic p 0 and let i and j be m primary ideals of r if m is a finitely generated r module then es i j m es i j rankm proof by the associativity formula we have that ers i j m e r s i j r 0 m 0 ers i j rankm 12 william d taylor the problem of finding general bounds for the value of the s multiplicity seems to be difficult but we have a few results along those lines proposition 3 12 let r m s n be a local homomorphism of local rings of dimension d and characteristic p 0 such that ms is n primary let i and j be m primary ideals of r and let m be a finitely generated r module then ess is js m r s ers i j m s s ms and we have equality if is a flat ring homomorphism proof for any r module n of finite length we have that s n r s r n s s ms thus for any s 0 and e n we have that s m r s is spe js pe m r s s m i sp e j p e m r s r m i sp e j p e m s s ms dividing both sides by ped and taking the limit as e goes to infinity gives us that hss is js m r s hrs i j m s s ms and dividing both sides by hs d gives us the result for s multiplicity if is a flat ring homomorphism then for any r module n we have that s n r s r n s s ms and so we have equality everywhere corollary 3 13 if r m k be a local ring of characteristic p 0 and i is an ideal generated by a system of parameters in r then es i r i furthermore equality holds if r is cohen macaulay proof we may assume that r is complete let d dimr let x 1 xd be a system of parameters generating i and let s k x 1 xd r now by proposition 3 12 and corollary 3 8 iii ers i ess x 1 xd r r i r r i furthermore if r is cohen macaulay then r is a free s module hence is flat over s so equality holds 4 s closure the s multiplicity is related to closures just as the hilbert samuel and hilbert kunz multiplicities are we see this already in the guise of proposition 2 6 and corollary 3 9 with respect to integral and tight closure the natural question to ask at this point is whether there are closures that are similarly related to the various s multiplicities in this section we define these closures and show that in sufficiently nice rings we get a strong connection between the closure operators and the s multiplicity we use the notation r to stand for the complement of the union of the minimal primes of r definition 4 1 let r be a ring of characteristic p 0 let i be an ideal of r and let s 1 be a real number an element x r is said to be in the weak s closure of i if there exists c r such that for all e 0 cxpe i spe i pe we denote the set of all x in the weak s closure of i by iw cls remark 4 2 if i is of positive height then x iw cls if and only if there exists c r such that cxp e i spe i pe for all e n to see this suppose that there exists c r and e n such that c xp e i spe i pe for e e since i is of positive height there exists c i spe i p e r setting c c c we have that c r and cxpe i spe i pe for all e n for a given ideal i iw cls is clearly an ideal containing i however it is not clear that the weak s closure is idempotent that is it is not clear that iw cls w cls iw cls if the ring is noetherian we can construct an idempotent operation out of the weak s closure by iterating the operation until the chain of ideals stabilizes interpolating between hilbert samuel and hilbert kunz multiplicity 13 definition 4 3 let r be a ring of characteristic p 0 let i be an ideal of r and let s 1 be a real number the s closure of i is defined to be the union of the following chain of ideals i iw cls iw cls w cls iw cls w cls w cls we denote this ideal by icls notice that for s 1 the s closure is integral closure and for s ci i the s closure is tight closure furthermore if s s then icls icls for all ideals i thus the s closure interpolates monotonically between integral closure and tight closure as s increases one should note that new closures do in fact arise example 4 4 let r k x y where k is a field of characteristic p 0 let i x 3 y 3 then icls x y 3 if s 1 x 3 x 2 y 2 y 3 if 1 s 4 3 x 3 y 3 if s 4 3 in particular if 1 s 4 3 then i i icls i x y 3 example 4 4 demonstrates that in some cases an ideal i will only have finitely many distinct s closures for various values of s in fact this will occur whenever r is local and i is primary to the maximal ideal however even in regular rings there can be infinitely many distinct s closures example 4 5 let r k x y where k is a field of characteristic p 0 let 1 s s 2 choose n n such that n 2 s s and let i x 2 n y 2 n then x sn y sn iw cls since for any e n 2 2 n sn pe 2 n 2 1 s 2 pe spe and so x 2 ny 2 n x sn y sn p e x 2 n y 2 n spe however x sn y sn iw cls since for any a n letting e n such that pe a we have that 2 a sn pe 2 n a sn 1 p e n sn 2 p e n spe 2 pe n spe s s pe s pe and so xaya x sn y sn p e x 2 n y 2 n s pe thus iw cls 6 iw cls and hence icls 6 icls by theorem 4 6 thus we find that there are infinitely many distinct s closures on r one for every real number in the interval 1 2 if i and i have the same integral closure then e i e i while if i and i have the same tight closure then ehk i ehk i our main theorem in this section is a similar result for s multiplicity and s closure theorem 4 6 let r m be a local ring of characteristic p 0 and let i and j be m primary ideals of r with i j if j icls then es j es i if r is an f finite complete domain then the converse holds and icls iw cls proof let d dimr suppose that x iw cls so that there exists c r such that for all e 0 we have that cxp e i spe i pe ipe hence x is in the integral closure of i and so hs i x i x hs i i x by proposition 2 6 v now for large e n c annihilates i spe i x p e i sp e i p e let s r cr so that for e 0 r i sp e i x p e i sp e i p e s i sp e i x p e i sp e i p e s s is sp e i x s pe is sp e is p e and so since dims d 1 hs i i hs i i x lim e 1 ped r i sp e i x p e i sp e i p e lim e 1 ped s is sp e i x s pe is sp e is p e lim e 1 pe d dims hss is is hss is i x s 0 14 william d taylor therefore hs i x hs i for any x iw cls hence hs iw cls hs i by induction hs icls hs i hence hs j hs i and so es j es i now suppose that r is an f finite complete domain and x r such that es i x es i in this case hs i x hs i and so hs i i x hs i i and therefore 0 lim e 1 ped i sp e i x p e i sp e i p e lim e 1 ped r i sp e i p e r x pe let f r r be a nonzero p 1 linear map and let f f p 1 1 fp 1 n where f 1 fn is a generating set for i then f i sp e 1 i p e 1 r x pe 1 xp e f i sp e 1 i p e 1 f f p 1 1 f p 1 n i spe 1 i p e let a 1 an n with a 1 an spe 1 then n i 1 ai p 1 p n i 1 ai p spe and so f p 1 1 fp 1 n i sp e 1 i sp e p therefore f f p 1 1 fp 1 n i sp e 1 i spe and so f i sp e 1 i p e 1 r x pe 1 xp e i sp e i p e that is f i sp e 1 i p e 1 r x pe 1 i sp e i p e r x pe since this holds for all e n by pt 16 theorem 5 5 we must have that e 0 i sp e i p e r x pe 6 0 that is there is some 0 6 c r such that for all e n cxpe i spe i pe therefore x iw cls thus we have that if r is an f finite complete domain and hs i x hs i then x iw cls therefore if hs j hs i then j iw cls icls furthermore in this case if x icls then hs i x hs i and hence x iw cls therefore icls iw cls 5 s multiplicity of toric rings in this section we construct an equivalence between s multiplicity for toric rings and certain volumes in euclidean space we will then use that equivalence to compute the s multiplicity for a few toric rings see hj 17 for a more general treatment of the correspondence between limits in positive characteristic and volumes in real space definition 5 1 let k be a field by a normal toric ring of dimension d over k or simply toric ring we will mean the ring k s where s zd is a cone in rd not containing any line through the origin and s inherits the semigroup structure of zd furthermore we will require that the cone be rational that is cone v 1 vn for some v 1 vn zd and of full dimension that is the r span of is all of rd we will denote the monomial elements of k s by xv for v s and if cone v 1 vn we may write k xv 1 xvn for k s definition 5 2 for a monomial ideal i k s where k s is a toric ring we denote by exp i the set v s xv i and by hull i the convex hull of exp i in rd lemma 5 3 let r m k s s be a normal toric ring of dimension d over a field k of characteristic p 0 where s zd let i xu 1 xun be a monomial ideal of r for any m e n with m 1 m n hull i zd exp im mhull i zd and exp i p e pe exp i zd proof let v m n hull i zd then there exist a 1 an r 0 such that a 1 an 1 and v m n a 1 u 1 anun zd for each 1 i n let bi m n ai since each ui we have that v m n a 1 u 1 anun zd b 1 u 1 bnun zd interpolating between hilbert samuel and hilbert kunz multiplicity 15 since b 1 bn m n a 1 an n m we have that v exp im this shows the first inclusion in the first statement a monomial xv is in im if and only if v a 1 u 1 anun zd for some a 1 an n with a 1 an m if this is the case then v m a 1 m u 1 an m un zd mhull i zd this shows the second inclusion in the first statement a monomial xv is in i p e if and only if v peu for some u exp i that is xv i pe if and only if v u exp i peu zd pe u exp i u zd pe exp i zd which proves the second statement theorem 5 4 let r m k s s be a normal toric ring of dimension d over a field k of characteristic p 0 where s zd and let i and j be m primary monomial ideals of r then hs i j vol shull i expj where vol is the standard euclidean volume in rd proof let e n the length of r i spe j pe is precisely the size of the set ve v s xv i sp e j p e v s v exp i sp e exp j p e from lemma 5 3 we have that spehull i pe expj zd ve spe n hull i pe expj zd scaling every set by 1 pe in each dimension we get that shull i expj 1 pe z d 1 pe ve s n pe hull i expj 1 pe z d since the volume of shull i exp j is equal to the volume of its interior we obtain that vol shull i expj lim e 1 ped shull i expj 1 pe z d lim e 1 ped ve lim e 1 ped s n pe hull i expj 1 pe z d vol shull i expj and so we have equality throughout since hs i j lim e 1 ped ve the theorem is proved theorem 5 4 allows us to calculate the s multiplicity of toric rings we compute two examples example 5 5 an singularities let n n n 1 and take an k x 1 x 2 x 3 x 1 x 2 xn 13 k x y x 1 yn 1 the geometry of this toric ring is illustrated below the shaded region corresponds to the cone and the lattice points 1 0 0 1 and 1 n 1 correspond to x y and x 1 yn 1 respectively 16 william d taylor 1 0 0 1 1 n 1 we wish to calculate es an so we need to calculate hullm and expm where m x y x 1 yn 1 these are illustrated below 1 0 0 1 1 n 1 hullm 1 0 0 1 1 n 1 n n 1 1 n n 1 n 1 expm there are three situations to consider s 1 1 s 2 1 n 1 and s 2 1 n 1 when s 1 shullm expm is illustrated below 1 0 0 1 1 n 1 s 0 0 s s n 1 s from this we can compute hs an s 2 for s 1 now suppose that 1 s 2 1 n 1 the picture now becomes 1 0 0 1 1 n 1 n s 1 n s 1 n 1 n s 1 1 1 s s n 1 n s n 1 n n 1 interpolating between hilbert samuel and hilbert kunz multiplicity 17 calculating the area of the unshaded region in gives hs an n 1 n s 1 2 2 s 1 1 when 1 s 2 1 n 1 now consider the case when s 2 1 n 1 in this case the picture becomes 1 0 0 1 1 n 1 n n 1 1 n n 1 n 1 and so we compute hs an 2 1 n 1 when s 2 1 n 1 with this we can write down the s multiplicity for the an singularities es an 2 if 0 s 1 n 1 n s 1 2 2 s 1 1 1 2 s 2 s 1 2 if 1 s 2 1 n 1 2 1 n 1 1 2 s 2 s 1 2 if 2 1 n 1 s 2 2 1 n 1 if s 2 example 5 6 let k be a field and consider the nth 2 dimensional veronese subring vn k x xy xy n the geometry of this ring is illustrated below the shaded region corresponds to and for 0 a n the lattice points 1 a corresponds to the monomial xya 1 0 1 n letting m x xy xyn we have the following pictures for hullm and expm hullm expm 18 william d taylor thus we have the following pictures for various values of s s 0 s ns 0 s 1 s n s 1 s 1 1 s 1 1 n 1 1 n 1 s 1 1 n with these figures we can caluclate hs vn and es vn hs vn ns 2 2 if 0 s 1 n 2 2 s 1 2 n s 1 n 2 if 1 s 1 1 n n 1 2 if s 1 1 n es vn n if 0 s 1 n 2 2 s 1 2 n s 1 n 2 1 2 s 2 s 1 2 if 1 s 1 1 n n 1 1 2 s 2 s 1 2 if 1 1 n s 2 n 1 2 if s 2 example 5 7 the normalizing factors hs d can be easily visualized as areas in space in the same manner indeed since k x 1 xd is a toric ring we simply apply the construction above to calculate hs x 1 xd for instance when d 2 we have the following picture 0 s s 0 0 s 1 hs 2 12 s 2 s 1 1 1 s 1 1 s 2 hs 2 12 s 2 s 1 2 s 2 hs 2 1 interpolating between hilbert samuel and hilbert kunz multiplicity 19 references dnbp 16 alessandro destefani luis nu n ez betancourt and felipe pe rez on the existence of f thresholds and related limits arxiv 1605 03264 2016 hh 90 melvin hochster and craig huneke tight closure invariant theory and the brianc on skoda theorem j amer math soc 3 1 31 116 1990 hj 17 daniel herna ndez and jack jeffries local okounkov bodies and limits in prime characteristic arxiv 1701 02575 2017 hs 06 craig huneke and irena swanson integral closure of ideals rings and modules london mathematical society lecture note series 336 cambridge university press cambridge 2006 mon 83 paul monsky the hilbert kunz function math ann 263 1 43 49 1983 mtw 05 mircea mustat a shunsuke takagi and kei ichi watanabe f thresholds and bernstein sato polynomials in euro pean congress of mathematics pages 341 364 eur math soc zu rich 2005 nag 62 masayoshi nagata local rings interscience tracts in pure and applied mathematics no 13 interscience publishers a division of john wiley sons new york london 1962 pt 16 thomas polstra and kevin tucker f signature and hilbert kunz multipicity a combined approach and comparison arxiv 1608 02678 2016 ree 61 david rees a transforms of local rings and a theorem on multiplicities of ideals proc cambridge philos soc 57 8 17 1961 rs 13 marcus robinson and irena swanson explicit hilbert kunz functions of 2 2 determinantal rings arxiv 1304 7274 2013 wy 00 kei ichi watanabe and ken ichi yoshida hilbert kunz multiplicity and an inequality between multiplicity and colength j algebra 230 1 295 317 2000 department of mathematical sciences university of arkansas fayetteville ar 72701 e mail address wdtaylor uark edu 1 introduction 2 the multiplicity like function hs i j m 3 s multiplicity 4 s closure 5 s multiplicity of toric rings references