ar x iv 2 11 1 11 97 8 v 1 m at h a c 2 3 n ov 2 02 1 around pru fer extensions of rings gabriel picavet and martine picavet l hermitte abstract the paper intends to apply the properties of pru fer extensions investigated in the knebusch zhang book to ring ex tensions r s the integral closure r of r in s is shown to be the intersection of all t r s such that t s is pru fer we are then able to establish an avoidance lemma for integrally closed subextensions rings of sections of the affine scheme defined by r provide results on s regular ideals some results on pullbacks characterizations of pru fer extensions are given we introduce lo cally strong divisors examining the properties of strong divisors of a local ring and their links with pru fer extensions the locally strong divisors allow us to give characterizations of qr extensions we apply our results to nagata extensions of rings we also look at the pru fer hull of a nagata extension we define quasi pru ferian rings that may differ from quasi pru fer integral domains we then derive some results on minimal and fcp extensions finally we study the set of all primitive elements in an extension 1 introduction and notation we consider the category of commutative and unital rings whose flat epimorphisms will be strongly involved like localizations with respect to a multiplicatively closed subset if r s is a ring extension we denote by r s the set of all r subalgebras of s and by r s fg the set of all t r s such that t is of finite type over r any undefined material is explained in the next subsection and in the following sections 1 1 an overview of the paper we present some properties of pru fer extensions of rings and derive from them new results using the properties and definitions of knebusch and zhang 26 it is well known that pru fer extensions are nothing but normal pairs pru fer 2010 mathematics subject classification primary 13 b 02 13 b 22 13 b 40 sec ondary 13 b 30 key words and phrases integral closure pru fer extension pullback qr extension quasi pru ferian ring nagata extension strong divisor ring of sections 1 http arxiv org abs 2111 11978 v 1 2 g picavet and m picavet extensions are defined by flat epimorphims while normal pairs are de fined by the integrally closed property we will deal with the pru fer aspect except in section 6 in section 2 we give some recalls about pru fer extensions we also give rules on flat epimorphisms and direct limits in order to make easier our proofs if r s is a ring extension an ideal i of r is called s regular by 26 if is s such ideals are a useful concept in the next sections moreover these ideals i permit to factorize the extension through the ring of sections defined by the open subset associated to i this is developed in section 3 with some applications to pru fer extensions by the way we give rules allowing to calculate rings of sections in section 4 we show that the integral closure r of a ring extension r s is the set intersection of all t r s such that t s is pru fer this statement generalizes a classical result on integral closures as an application we show that an avoidance lemma with respect to finitely many integrally closed subrings holds the proof is not easy and uses manis valuations we also show an avoidance lemma with respect to finitely many flat epimorphisms this is explained in section 5 section 6 deals with pullbacks results olivier proved that integrally closed extensions are characterized by pullbacks in which some mor phism is of the form v k where v is a semi hereditary ring with total quotient ring k we adapt this result to the pru fer case and evi dently reuse the normal pairs another result concerns a more classical situation in section 7 we deal with extensions over local rings and introduce the strong divisors considered by 26 a strong divisor is a regular element t of a ring r such that rt is comparable to each ideal of r the maximal pru fer extension of a local ring r is the localization of r with respect to the multiplicatively closed subset of all strong divisors of r we develop a theory of strong divisors the most striking results are that a regular element x of a local ring is a strong divisor if and only if r rx is pru fer and that an extension of finite type of r is pru fer if and only if it is of the form r rx where x is a strong divisor qr extensions r s are studied in section 8 they are extensions such that each t r s is isomorphic to a localization they are evidently pru fer we also look at the bezout extensions of 26 and examine the bezout and pru fer hull of an extension over a local ring or a nagata ring r x the pru fer bezout and and qr properties are equivalent to go further we have introduced locally strong divisors as locally strong divisors appear each time we are dealing with pru fer around pru fer exrensions 3 extensions we see that a ring r admits non trivial pru fer extensions if r has locally strong divisors that are non units this concept is more stable than that of strong divisors an interesting result is that qr extensions are characterized by using locally strong divisors another one is that a qr extension r s verifies that for each s s there is a locally strong divisor such that s r the section ends on extensions whose supports are finite section 9 is concerned with nagata extensions r x s x we show that such an extension is pru fer if and only if r s is pru fer we already said that over a nagata ring the pru fer and qr concepts coincide the pru fer hull r of an extension gives r x for its nagata extension in a lot of cases it may be that the result holds for any extension but we do not know the answer when r is a local ring we show that the strong divisors of r x are in some sense the strong divisors of r we define in section 10 quasi pru ferian rings as rings r such that r r x is an i extension but our definition is not equivalent to r tot r is quasi pru fer in the sense of 42 contrary to the integral domains context where we recover the classical notion of quasi pru fer rings we get some results about these rings largely inspired by the integral domain context a sequence of statements in a theorem shows that a ring is quasi pru fer if it is quasi pru ferian the converse holds if the total quotient ring of the ring is zero dimensional section 11 is devoted to minimal or fcp extensions of a local ring that are either pru fer or have the qr property a special attention is paid to b extensions extensions that are locally determined in some sense the paper ends by considering the set of all primitive elements in an extension a study initiated by dobbs and houston there is a link with quasi pru fer extensions 1 2 basics concepts as usual spec r and max r are the set of prime and maximal ideals of a ring r and u r is the set of all its units we now give some notation for a ring morphism f r s we denote by af the spectral map spec s spec r then xr s or x s is the image of the map af and we say that f is an i morphism if af is injective if q is a prime ideal of s lying over p in r the ring morphism rp sq is called the local morphism at q of the morphism then r s is the conductor of an extension r s the integral closure of r in s is denoted by r s or by r if no confusion can occur 4 g picavet and m picavet a local ring is here what is called elsewhere a quasi local ring for an extension r s and an ideal i of r we write vs i p spec s i p and ds i for its complement if r is a ring then z r denotes the set of all its zero divisors the support of an r module e is suppr e p spec r ep 6 0 and msuppr e suppr e max r when r s is an extension we will set supp t r suppr t r and supp s t suppr s t for each t r s unless otherwise specified if r s is a ring extension and a mcs of r i e a multiplicatively closed subset of r then s is both the localization s as a ring and the localization at of the r module s that is s r r let 1 and 2 be two mcs of a ring r we denote by 2 1 the image of 2 in r 1 we recall that r 1 2 r 1 2 1 it follows that if x r and is a mcs of r then rx r x 1 flat epimorphisms and their properties are the main tool in this paper we use the theory that was developed by d lazard 29 chapter iv the reader may also use the scholium of our paper 42 when r s and r t are ring morphisms we will write s r t or s t if there is an isomorphism of r algebras s t it may happens that is replaced with let r s be an extension a chain of r subalgebras of s is a set of elements of r s that are pairwise comparable with respect to inclusion we say that r s is chained if r s is a chain we also say that the extension has fcp or is an fcp extension if each chain in r s is finite or equivalently the poset r s is artinian and noetherian an extension is called fip if r s has finitely many elements an extension r s is called minimal if r s r s according to 19 the ore me 2 2 a minimal extension is either integral or a flat epimorphism finally x is the cardinality of a set x denotes proper inclusion contrary to 26 where denotes the large inclusion a compact topological space does not need to be separated for a positive integer n we set nn 1 n 2 some definitions notation and useful results an extension r s is called pru fer if r t is a flat epimorphism for each t r s or equivalently if r s is a normal pair 26 theorem 5 2 p 47 a pru fer integral extension is trivial we denote by q r the complete ring of quotients utumi lambeck of a ring r definition 2 1 26 a ring extension r s has around pru fer exrensions 5 1 a greatest flat epimorphic subextension r r s called the morita hull of r in s 2 a greatest pru fer subextension r r s called the pru fer hull of r in s we set r r s and r r s if no confusion can occur a ring r has 1 29 a maximal flat epimorphic extension r m r r q r also termed the maximal flat epimorphic extension by some authors like 29 2 26 a maximal pru fer extension r p r r q r note that r s is denoted by p r s in 26 and r s coincide with the weakly surjective hull m r s of 26 our terminology is justified because morita s construction is earlier 32 corollary 3 4 the morita hull can be computed by using a transfinite induction 32 let s be the set of all s s such that there is some ideal i of r such that is s and is r then r s is a subextension of r s we set s 1 s and si 1 si si by 32 p 36 if r s is an fcp extension then r sn for some integer n we also note the following known consequence proposition 2 2 an extension r s is a flat epimorphism if and only if for each s s there is some ideal i of r such that is s and is r or equivalently r r s s s corollary 2 3 an extension r s is pru fer if and only if r s r r s r s for each s s proof use the definition of pru fer extensions by flat epimorphisms if an extension r s is pru fer and is a mcs of r then r s is pru fer we have a converse proposition 2 4 42 proposition 1 1 an extension r s is pru fer if and only if rm sm is pru fer for each m max r resp for each m spec r proposition 2 5 42 corollary 3 15 pru fer extensions are descended by faithfully flat morphisms proposition 2 6 the pru fer property of extensions r s is local on the spectrum that is if spec r d r 1 d rn for some elements r 1 rn r and rri sri is pru fer for each i 1 n then r s is pru fer 6 g picavet and m picavet proof the extension rr 1 rrn sr 1 srn is pru fer 26 proposition 5 20 p 56 to conclude use proposition 2 5 since r rr 1 rrn is faithfully flat in 42 a minimal flat epimorphism is called a pru fer minimal ex tension an fcp pru fer extension has fip and is a tower of finitely many pru fer minimal extensions 42 proposition 1 3 in 42 we defined an extension r s to be quasi pru fer if it can be factored r r s where r r is integral and r s is pru fer in this case r is necessarily r an fcp extension is quasi pru fer 42 corollary 3 4 an extension r s is called almost pru fer if it can be factored r s s where the first extension is pru fer and the second is integral in this case s is necessarily r an almost pru fer extension is quasi pru fer 42 we now give some rules on flat epimorphisms the following result of lazard is a key result let r be a ring we denote by fe the collection of classes up to an isomorphism of flat epimorphisms whose domain is r and by x the set of subsets of spec r that are affine schemes when endowed with the induced sheave the elements of x are compact and stable under generization proposition 2 7 29 proposition 2 5 p 112 the map fe spec r defined by t 7 x t is a bijection onto x the inverse map is as fol lows an affine scheme x of spec r gives r x the ring of sections over x the next result proved in 23 proposition 3 4 10 p 242 will be useful in the sequel proposition 2 8 l rule let r e be a ring morphism and e lim ei where each ei is an r algebra then x e x ei we will use proposition 2 7 under the following form proposition 2 9 x rule let r e be a flat epimorphism and r f a ring morphism 1 there is a factorization r e f if and only if x f x e 2 if r f is a flat epimorphism then e f if and only if x f x e proof 1 the ring morphism f f r e is a flat epimorphism if x f x e then the spectral morphism of is surjective because there is a surjective map spec f r e spec e spec r spec f around pru fer exrensions 7 23 corollaire 3 2 7 1 p 235 it follows that is a faithfully flat epi morphism whence an isomorphism by 29 lemme 1 2 p 109 and an implication is proved its converse is obvious now 2 can be proved by using 1 but it is also a consequence of proposition 2 7 corollary 2 10 mcs rule let r e be a ring morphism 1 if e r where is a mcs of r then x e d s s 2 if e lim rsi where si is family of elements of r then e r where is the mcs of r generated by the family proof the proof is a consequence of the above rules 3 s regular ideals and rings of sections if i is an ideal of a ring r then d i r or d i denotes the ring of sections of the scheme spec r over the open subset d i all that we need to know is that d r r 0 and if f r s is a ring morphism there is a commutative diagram because af 1 d i d is r s y y d i d is we denote by ass r the set of all bourbaki prime ideals p associ ated to the r module r that is p min v 0 r for some r r re call that a ring morphism f r s is called schematically dominant if for each open subset u of spec r the map u r af 1 u s is injective 23 proposition i 5 4 1 the first author proved that a flat ring morphism f r s is schematically dominant if and only if ass r x s 40 proposition 52 clearly if min r ass r for example if r is an integral domain and f is injective and flat then f is schematically dominant lemma 3 1 a flat extension r s is schematically dominant proof if p ass r there is some a r such that p min v 0 a from 0 s a r 0 a we deduce that r 0 a s 0 s a is injective and then p 0 a can be lifted up to a minimal prime ideal q 0 s a hence q ass s is above p let r s be an extension and an ideal i of r then i is called s regular if is s 26 note that s regular ideals play a prominent role in 26 they are involved in certain questions for example if f r s is a ring morphism the fiber at a prime ideal p of r is af 1 p this fiber is homeomorphic to the spectrum of the ring 8 g picavet and m picavet sp psp therefore the fiber is empty if and only if sp psp which means that prp is sp regular if f is a flat epimorphism the fiber at p is empty if and only if s ps 29 proposition 2 4 p 111 remark 3 2 let f r s be an extension 1 an ideal i of r is s regular if and only if x s d i 39 lemma 2 3 such an ideal i is dense that is 0 i 0 1 a i is s regular if and only if i is s regular because d is af 1 d i af 1 d i d is 1 b i is s regular if and only if ip is sp regular for each p spec r we need only to show that if the local condition holds then i is s regular suppose that is s then there is some prime ideal q of s such that is q if p q r then qp is a prime ideal of sp such that ipsp qp a contradiction 2 if i is s regular we have spec s d is af 1 d i so that there is a factorization r d i s if in addition f is flat then f is schematically dominant lemma 3 1 so that we can consider that there is a tower of extensions r d i s moreover d i is an open subset which is topologically dense in spec r because a schematically dominant morphism is dominant 23 proposition i 5 4 3 i e its spectral image is dense the density follows from x s d i this result holds if the extension is pru fer and then r d i is pru fer 3 we will use the following consequence of proposition 2 7 if i is an ideal of r then r d i is a flat epimorphism and x d i d i if and only if d i is an affine open subset of spec r for example if i is principal in which case d i d j where j is a finitely generated ideal we can say more after looking at the following recall adapted to ring morphisms the reader is referred to 23 definition i 4 2 1 p 260 for the definition of an open immersion of schemes we will say that a ring morphism is an open immersion if the morphism of schemes associated is an open immersion proposition 3 3 let f r s be a ring morphism 1 23 i 4 2 2 f is an open immersion if and only if spec s x s is a homeomorphism x s is an open subset and the local morphisms of f are isomorphisms 2 a flat epimorphism r s such that x s is zariski open is an open immersion 3 22 the ore me 17 9 1 p 79 f is an open immersion if and only if f is a flat epimorphism of finite presentation around pru fer exrensions 9 4 7 theorem 1 1 an injective flat epimorphism of finite type is of finite presentation whence is an open immersion proof we need only to prove 2 and using 1 since f is a flat epimorphism its spectral map is an homeomorphism onto its image by 29 corollaire 2 2 p 111 which is an open subset of the form d i moreover the local morphisms of the map are isomorphisms proposition 3 4 let r s be an injective flat epimorphism of finite type then x s is an open affine subset d i where i is a s regular ideal and there is an r isomorphism d i s r s is of finite presentation and i is a dense ideal conversely if d i is an open affine subset where i is a finitely gen erated dense ideal then r d i is an injective flat epimorphism of finite type presentation such that x d i d i proof to apply proposition 2 7 we need only to look at injective flat epimorphisms of finite type r s we know that such a ring morphism f r s is of finite presentation according to proposi tion 3 3 4 by the chevalley theorem x s is a zariski quasi compact open subset of spec r therefore of the form d i where i is an ideal of r of finite type we have af 1 d i d is spec s be cause x s d i so that is s and then i is dense because it is s regular moreover d i s by proposition 2 9 2 because x s d i x d i assume that the hypotheses of the converse hold since the mor phism r d i is an open immersion by proposition 3 3 we get that r d i is of finite presentation moreover 0 i 0 which is equivalent to ass r d i 29 corollaire 1 14 p 93 so that r d i is injective by 29 proposition 3 3 p 96 we note the following result proposition 3 5 26 theorem 2 8 p 101 theorem 2 6 p 100 let r s be an extension which is a flat epimorphism then the extension is pru fer if and only if for every finitely generated s regular ideal i of r the ring r i is arithmetical resp i is locally principal proposition 3 6 let r s be a flat epimorphism then r s is pru fer if and only if for each p spec r the set of sp regular ideals of rp is a chain proof according to 42 proposition 1 1 2 the extension is pru fer if and only if rp sp is manis for each p spec r and equivalently rp sp is pru fer manis the result follows from 26 theorem 3 5 p 190 10 g picavet and m picavet we recall that the dominion of a ring morphism f r s is the subring dom f x s x 1 1 x in s r s of s which contains the subring f r actually dom f is the kernel of the morphism of r modules i 1 i 2 s s r s where i 1 i 2 are the natural ring morphisms s s r s proposition 3 7 if f r s is a flat morphism and i an ideal of r such that xr s d i then 1 d i dom f and d i s is an injective flat mor phism 2 if in addition f is a ring extension r r d i each of the extensions in s being flat in particular if d i is affine then r d i 3 if g r b is a flat morphism setting c s r b then xb c d ib and d i r b d ib 4 if p is a prime ideal of r then d ip d i p in particular if p d i then d i p rp 5 d i x d i 6 if i d i d i then d i x d i so that d i is an open affine subset if in addition r d i is a flat epimorphism proof 1 is a translation of 39 theorem 2 7 the flatness of d i s follows from 29 proposition 3 1 2 p 112 2 if f is a ring extension observe that r dom f because r r is an epimorphism and then y 1 1 y for each y r 29 lemme 1 0 p 108 the flatness of the extensions r r s result from 29 proposition 3 1 2 p 112 at last if d i is affine then r d i is a flat epimorphism by remark 3 2 2 so that r d i 3 because spec c spec b spec r spec s is a surjective map 23 corollaire 3 2 7 1 p 235 we have xb c ag 1 d i d ib to conclude use 1 and the fact that a kernel tensorised by b which is flat over r is the kernel of the tensorised map 4 is gotten by taking b rp in 3 5 according to 4 an element p of d i is such that d i p rp it follows that there is a prime ideal q of d i lying over p 6 holds because i is d i regular we can apply the above result in the following three contexts when i r 1 rn is an ideal of finite type of r the hypothesis of this result entails that i j where j is an ideal of finite type we can suppose that d i 6 and that the set d r 1 d rn is an around pru fer exrensions 11 antichain so that the ri s cannot be nilpotent the first sample is certainly the most interesting because when i rr we recover that d r rr 1 we can consider the flat ring morphism r rr 1 rrn si which is such that x si d i actually is of finite presentation 23 proposition 6 3 11 p 306 and its local morphisms are isomorphisms but may not be a flat epimorphism when it is not an i morphism in case d ri defines a partition on d i is an i morphism whence a flat epimorphism in this case d i rri 2 let fi r x 1 xn r 1 x 1 rnxn 1 be the forcing r algebra with structural morphism fi associated to a finitely gener ated ideal i r 1 rn it would be more correct to write associ ated to the sequence r 1 rn this ring is not zero for otherwise 1 r 1 x 1 rnxn 1 p x 1 xn for some p x 1 xn r x 1 xn implies that 1 r 1 x 1 rnxn u r x 1 xn so that r 1 x 1 rnxn would be nilpotent and then also the ri s then i is fi regular and for every ring morphism r s for which i is s regular there is a factorization r fi s but fi s does not need to be unique according to 39 theorem 2 7 and remark 2 8 1 the ring morphism fi is flat x fi d i and d i dom fi moreover d i fi is an injective flat ring morphism 3 the first author introduced in 38 the following construction that we adapt to the present context let r be a ring and i an ideal of r denoting by c p x the content of a polynomial p x r x we consider the mcs p x r x d i d c p x setting r d i r x we get a flat morphism r r d i such that x r d i d i 4 integral closures as intersections we start by giving some results that do not seem to have been ob served they are consequences of a paper by p samuel 46 let v be a valuation on a ring r following 26 we denote by av the valuation ring of v lemma 4 1 46 the ore me 1 d an extension r s such that s r is multiplicatively closed is integrally closed for example r s is integrally closed if there is some valuation v on s such that r av the valuation ring of v we will use the next result 12 g picavet and m picavet lemma 4 2 46 theorem 4 let r s be an extension and p a prime ideal of r due to zorn lemma there is a maximal pair r p dominating r p and s r is a mcs a manis valuation v on a ring s is a valuation such that v s v is surjective where v is the value group of v a ring extension r s is called manis if r av for some manis valuation v on s pru fer manis extensions are defined as pru fer exten sions r s such that there is some manis valuation v on s such that av r 26 definition 1 p 58 by 26 theorem 3 5 p 190 a flat epimorphism r s is pru fer manis if and only if the set of all s regular ideals of r is a chain lemma 4 3 26 theorem 3 3 p 187 theorem 3 1 p 187 proposi tion 5 1 iii p 46 47 the following statements are equivalent for an extension r s 1 r s is pru fer manis 2 s t is a mcs for each t r s 3 r s is integrally closed and chained 4 r s is pru fer and s r is a mcs if the above condition 3 holds for an fcp extension then r s has fip by 26 we know that for a pru fer extension r s and p supp s r the subset sp rp is multiplicatively closed also 26 proposition 5 1 iii p 46 47 shows that if u r s and s u is a mcs then u s is pru fer manis corollary 4 4 a minimal extension r s is a flat epimorphism if and only if it is pru fer and if and only if it is pru fer manis proof the extension is a flat epimorphism if and only if it is integrally closed to complete the proof it is enough to use 19 proposition 3 1 which states that s r is a mcs when r s is a flat epimorphism corollary 4 5 an fcp pru fer extension has fip and is a tower of finitely many pru fer manis minimal extensions we will need the two following results they generalize known re sults about the integral closure of an integral domain which is the intersection of valuation rings lemma 4 6 let r s be an extension and x s r then there is some t r s such that t s is pru fer respectively pru fer manis and x is not integral over t and then x t around pru fer exrensions 13 proof it is enough to mimic the first part of the proof of 46 the ore me 8 more precisely let t be a maximal element of the inductive set u r s x us we intend to show that t s is pru fer manis in view of the above results we need only to show that any v t s with v 6 s is such that s v is multiplicatively closed and then such that t s is integrally closed now replace a with v in the second paragraph of the proof of 46 the ore me 8 and the result follows theorem 4 7 let r s be an extension then rs is the intersection of all t r s such that t s is pru fer resp pru fer manis and also the intersection of all u r s such that s u is a mcs proof the second result is 46 the ore me 8 now lemma 4 6 shows that r s contains the intersection of all t r s such that t s is pru fer resp pru fer manis for the reverse inclusion consider an element x s integral over r then t t x is integral and a flat epimorphism for any t r s such that t s is pru fer we deduce from 29 lemme 1 2 p 109 that t t x and x belongs to t remark 4 8 as a consequence of the above theorem we get that an extension r s is quasi pru fer if and only if the set of all t r s such that t s is pru fer has a smallest element 5 avoidance lemmata some of the following results are known in the context of integral domains and valuation domains we will use the frame of their proofs but shorter different argumentations kostra proved the next theorem 28 lemma 2 and theorem 2 in case s is a field to prove it in our context we follow the steps of his difficult proof by using theorem 4 7 if v s is pru fer manis s is endowed with a valuation v s v which is surjective there is no need to consider invertible elements that may not exist but elements x v such that v x 0 that is x pv the center of v moreover if v x 0 then v 1 x 0 lemma 5 1 let r t v v 1 vn be subrings of a ring s where n is a positive integer and such that v s and vi s are pru fer manis for each i nn let vi be the valuation associated to vi assume that there is some b t i nnvi v then there exists c t i nnvi v such that vi c 0 for any i nn moreover for any w r s such that w s is pru fer manis with b 6 w then c 6 w 14 g picavet and m picavet proof we build by induction the sequence s bi ni 0 in the following way set b 0 b and bk 1 k 1 i 0 bi for any k nn then bk t i nnvi for any k 0 n so that vi bk 0 for any i nn and any k 0 n if bl bk for some k 6 l assume that k l then bk 1 bk k 1 j 0 j 6 l bj giving that bk 1 k 1 j 0 j 6 l bj 1 so that vi bk vi 1 k 1 j 0 j 6 l bj vi 1 with bk and 1 k 1 j 0 j 6 l bj both in vi for any i nn it follows that vi bk 0 and vi 1 k 1 j 0 j 6 l bj 0 as vi 1 0 leads to vi bk 0 for any i nn and the proof of the lemma is gotten for bk assume now that bj 6 bk for any k j 0 n k 6 j so that s n 1 we claim that for any i nn there is at most one bij s such that vi bij 0 if vi bk 0 for any k 0 n then holds otherwise let j 0 be the least integer of 0 n such that vi bj 0 6 0 that is vi bj 0 0 it follows that for any k j 0 we have vi k j 0 bj 0 so that vi bk 1 vi 1 k j 0 bj vi 1 0 since vi bk 0 for any k j 0 we get that vi bk 6 0 if and only if k j 0 then holds hence bj s i nn such that vi bj 6 0 n s it follows that there exists some c bk t i nnvi such that vi c 0 for any i nn it remains to show that c 6 v we prove by induction on j 0 k that bj 6 v for any j 0 k this is satisfied for j 0 since b 0 b assume that bj 6 v for any j 0 l where l k but s v is a mcs so that l j 0 bj 6 v which implies that bl 1 6 v and then c bk 1 k 1 j 0 bj 6 v now let w r s be such that w s is pru fer manis with b 6 w we follow the proof of 28 remark page 173 we consider the previous sequence bj with b 0 b and bj 1 j 1 i 0 bi we still have c t i nnvi obviously since b 6 w so is any bi and then bk c 6 w because s w is an mcs theorem 5 2 let r b 1 bn be subrings of a ring s where n is a positive integer n 1 if the bis are integrally closed in s except at most two of them and r b 1 bn then r is contained in some of the subrings bi proof first we may remark that r b 1 b 2 implies that r is con tained in one of the subrings b 1 b 2 by an obvious property of additive subgroups so we may assume that n 3 with bi integrally closed around pru fer exrensions 15 in s for any i 3 there is no harm to assume that n is the least integer such that r b 1 bn that is r 6 i nn i 6 jbi for each j nn to prove the theorem it is enough to show that if r is not contained in any of the subrings bi we get a contradiction that is r 6 b 1 bn or equivalently there exists some x r b 1 bn this x is gotten after five steps step 1 assume that r b 1 bn with r not contained in any of the subrings bi according to for any j nn there exists aj r bj i nn i 6 jbi fix some i nn i 6 j i 2 since bi s is integrally closed by theorem 4 7 there exists a family vk i bi s such that vk i s is pru fer manis with bi vk i let vk i be the manis valuation associated to vk i as aj 6 bi there exists some vj i such that aj 6 vj i moreover aj vk j for any k if j 2 set m vj i i 2 i 6 j then b 3 bn i 2 i 6 jvj i vj i mvj i for each ak set m k vj i m ak vj i so that vk j m j for any k if j 2 step 2 if m k 6 then ak r vj i m k vj i vk i it follows from lemma 5 1 that there exists ck r such that vj i ck 0 for any vj i m k and ck 6 vk i in particular ck vj i for any vj i m k if m k set ck ak r since ak 6 vj i for any vj i m it follows that ck 6 vj i for any vj i m step 3 set d 0 n k 1 ck then d 0 r we claim that d 0 6 v for any v m let v m then there exist i 0 j 0 i 0 2 i 0 6 j 0 such that v vj 0 i 0 so that aj 0 6 v whatever is m j 0 we have that cj 0 6 v it is obvious if m j 0 6 if m j 0 then cj 0 6 vj i for any vj i m in particular cj 0 6 v it follows that vj 0 i 0 cj 0 0 consider ck for some k 6 j 0 if ck 6 v then vj 0 i 0 ck 0 if ck v we cannot have m k so that m k 6 if v m k then vj 0 i 0 ck 0 and ak vj 0 i 0 if v 6 m k then ak 6 vj 0 i 0 and ck 6 vj 0 i 0 by lemma 5 1 which leads to vj 0 i 0 ck 0 in any case vj 0 i 0 ck 0 to conclude vj 0 i 0 d 0 n k 1 vj 0 i 0 ck vj 0 i 0 cj 0 0 this implies that d 0 6 v for any v m and then d 0 6 b 3 bn set m 0 v 1 i i 2 v 2 i i 2 v 3 i i 3 with v 3 i i 3 if n 3 obviously m 0 m so that d 0 6 vj i for any vj i m 0 let t 1 t 2 n t 1 6 t 2 we claim that vj i dt 10 6 vj i dt 20 for any vj i m 0 assume that t 1 t 2 and set t t 1 t 2 that is t 1 t t 2 it follows that d t 1 0 d t 2 0 d t 0 so that vj i d t 1 0 vj i d t 2 0 vj i d t 0 16 g picavet and m picavet now vj i d t 1 0 vj i d t 2 0 implies vj i d t 0 0 that is d t 0 vj i but vj i s is pru fer manis and then integrally closed so that d 0 vj i a contradiction then vj i d t 1 0 6 vj i dt 20 let l 1 2 3 and consider the corresponding al defined at the beginning of the proof then there exists at most one tj i l n such that vj i al vj i d tj i l 0 if there does not exist such tj i l we have vj i al 6 vj i d 0 in this case set tj i l 1 it follows that in any case and for any t tj i l we have vj i al 6 vj i dt 0 let t 0 sup 1 tj i l j l 1 2 3 i 3 n i j then v dt 00 6 v al for any v m 0 and any l 1 2 3 step 4 set d dt 00 then v d 6 v al for any v m 0 moreover for any v m we have d 0 6 v which implies d 6 v since v s is integrally closed in particular d 6 b 3 bn but d 0 r implies d r b 1 b 2 b 3 bn so that d b 1 b 2 now b 1 b 2 b 1 b 2 b 1 b 2 b 2 b 1 step 5 we are going to consider the three possible cases for d 1 d b 1 b 2 set x a 3 d r since a 3 r b 3 i nn i 6 3 bi we have a 3 6 b 1 b 2 so that x 6 b 1 b 2 moreover d 6 b 3 which implies that x 6 b 3 let i 3 if v 3 i d v 3 i a 3 then v 3 i x v 3 i a 3 d v 3 i d 0 because d 6 v 3 i then x 6 bi if v 3 i d v 3 i a 3 then v 3 i d v 3 i a 3 by so that v 3 i x v 3 i a 3 0 because a 3 6 v 3 i then x 6 bi it follows that x 6 b 1 b 2 b 3 bn a contradiction 2 d b 1 b 2 set x a 2 d r since a 2 6 b 1 we have x 6 b 1 and since a 2 b 2 this implies that x 6 b 2 so that x 6 b 1 b 2 let i 2 if v 2 i d v 2 i a 2 then v 2 i x v 2 i d 0 because d 6 v 2 i then x 6 bi if v 2 i d v 2 i a 2 then v 2 i d v 2 i a 2 by so that v 2 i x v 2 i a 2 0 because a 2 6 v 2 i then x 6 bi it follows that x 6 b 1 b 2 b 3 bn a contradiction 3 d b 2 b 1 the proof is similar as in 2 by changing b 1 and b 2 to conclude we get a contradiction in any case so that there exists some i such that r bi proposition 5 3 let r s be a pru fer extension and u b 1 bn r s such that b 1 bn u and u s is pru fer manis then there is some i such that bi u around pru fer exrensions 17 proof actually this result is given under an equivalent form in 27 theorem 1 4 p 4 let b 1 bn r s be such that b 1 bn u then we have u u b 1 bn ub 1 ubn by 26 theorem 1 4 4 p 86 87 now u s is a chain 26 theorem 3 1 p 187 so that u ubi for some i and then bi u note that if the extension r s is pru fer manis so is u s for any u r s 26 corollary 3 2 p 187 gotlieb proved the following result for a ring extension r k where r is an integral domain with quotient field k 21 theorem 6 theorem 5 4 let r s be an extension and t t 1 tn r s such that t r where is a mcs of r and r ti is a flat epimorphism for i 1 n such that t t 1 tn then t is contained in some ti proof assume that t is not contained in any ti by the x rule there are prime ideals pi x ti x t and x t p spec r p we set i p 1 pn we deduce from t t 1 tn that i there exists some prime ideal p of r such that i p and p then some pi is contained in p so that pi x t hence we get a contradiction 6 pullback results consider the following pullback diagram d in the category of com mutative unital rings r i s f y yg v j k where i and j are ring extensions it can be considered as a composite of the two diagrams ker d r s y y r ker f s ker g and im d f r g s y y v k the first diagram is a pullback because ker f ker g thanks to the pullback diagram d it follows that r f r g s s 18 g picavet and m picavet it is of the form a b y y a i b i where i is an ideal shared by the rings a and b we recall that in this case a b is pru fer if and only if a i b i is pru fer 26 proposition 5 8 p 52 it is easy to prove that the second diagram is a pullback and is such that f r is isomorphic to v g s recall that a ring r is called semi hereditary if each of its finitely generated ideals is a projective r module olivier proved that an extension of rings r s is integrally closed if and only if there is a pullback diagram d where v is a semi hereditary ring with an absolutely flat total quotient ring k 35 corollary p 56 or 33 the ore me de ker chalon 2 1 in this case we call do the diagram d therefore the pru fer property is not descended in pullbacks since v k is pru fer 15 theorem 2 and there are integrally closed extensions that are not pru fer on the other hand we have a pullback example provided by the following result proposition 6 1 13 theorem 6 8 and theorem 6 10 if r is a local ring an extension r s is pru fer if and only if there exists p spec r such that s rp p sp and r p is a valuation domain under these conditions s p is the quotient field of r p and p is a divided prime ideal of r i e comparable to each ideal of r in particular r s is a chain proof to complete the proof observe that there is an order isomor phism r s r p s p given by t 7 t p for t r s we now use olivier s result to find a characterization of pru fer ex tensions theorem 6 2 let r s be an integrally closed extension and do the pullback diagram where v is semi hereditary with total quotient ring k then r s is pru fer if and only if g t v g s g t for each t r s or equivalently the following diagram dt is a pullback for each t r s t s y y g t v k in that case we have r v g t v t and g t v v r t around pru fer exrensions 19 proof we use the characterization of pru fer extensions by normal pairs and flat epimorphisms suppose that dt is a pullback since an over ring of a semi hereditary ring is semi hereditary 6 corollary p 143 olivier s result implies that t s is integrally closed hence r s is pru fer we now prove the converse suppose that r s is pru fer then r t is a flat epimorphism tensoring the diagram d by rt we get another pullback diagram because the pullback r is a kernel of a morphism of r modules and t is flat over r we next identify the rings of the new pullback we have clearly t r r t moreover we also have s r t s this is a consequence of 47 satz 2 2 d which states that if m is a t module and r t an epimorphism then m r t m an isomorphism of t modules we next show that v r t g t v consider the natural map v r t k its image is g t v then v v rt is a flat epimorphism deduced from r t by the base change r v and v v r t g t v is in jective it follows that v r t g t v is an isomorphism because a flat epimorphism is essential by 29 lemme 1 2 p 109 then we show that k r t k we first observe that k k r t is a flat epimor phism whose domain is an absolutely flat ring this map is surjective to see this if j is the kernel of the morphism then k j k r t is a faithfully flat epimorphism because k j is absolutely flat whence is an isomorphism by 29 lemme 1 2 p 109 moreover v v r t identifies to v g t v whence is injective as v k is flat the map k v r t v k k r t is injective so that k k r t therefore we have proved that there is a pullback diagram dt to complete the proof it is enough to consider im dt in which case the pullback condition on t can be written g t v g s g t nevertheless we give some example of pullbacks where the ascent property holds proposition 6 3 let i be an ideal of a ring s and set s s i denote by the canonical map s s i let r be a subring of s and r the pullback ring in the following diagram r s y y r s then r s is pru fer if and only of r s is pru fer proof clearly i is an ideal shared by r and s now observe that r identifies to r i i r i r r i it is then enough to apply 26 proposition 5 8 p 52 20 g picavet and m picavet 7 the case of a local base ring when the base ring r is local we already gave a characterization of pru fer extensions in proposition 6 1 definition 7 1 an extension r s is called module distributive if r x y r x r y for each pair of r submodules x y of s cf 26 p 119 we say that r s is distributive if the lattice r s endowed with compositum and intersection as laws is distributive 26 theorem 5 4 p 121 shows that an extension is r s module distributive if and only if it is pru fer as a consequence we get that the set of rp submodules of sp rp is a chain 16 corollary 2 when the extension is pru fer this gives a stronger result than that of propo sition 6 1 moreover we see that a pru fer extension is both module distributive and distributive for the distributivity use 41 propo sition 5 18 since a pru fer extension r s is arithmetical that is rm sm is chained for any m max r in order to get more results we introduce the following considera tions in view of 26 proposition 5 2 p 119 an ideal i of a ring r is called distributive if i j k i j i k for all ideals j k of r when r is local an ideal i is distributive if and only if i is comparable to each ideal principal ideal of r in this case r is local we will call i a strong divisor if in addition 0 i 0 the following result will be useful proposition 7 2 26 example 5 1 p 119 let r s be a pru fer extension an s regular ideal i of r is distributive in particular such an ideal is a strong divisor if r is local we can translate some results of 16 lemma 1 1 corollary as fol lows let r be a ring and set r z r r is distributive then is a saturated mcs of r moreover if t is a mcs of r such that t r z r and r rt is pru fer then t we next examine the local case we may find in 26 p 123 the following definition and result definition 7 3 a strong divisor t of a local ring r is an element t of r such that the ideal rt is a strong divisor the set r of all strong divisors of r is a saturated mcs of r and u r r we observe that for t r the open subset d t q spec r q rt around pru fer exrensions 21 recall that a ring r has a maximal pru fer extension r p r r q r where q r is the complete ring of quotients of r utumi lambeck 26 then p r is called the pru fer hull of r it is known that a pru fer extension r s where r is local is a qr extension that is is such that each t r s verifies t r an isomorphism ofr algebras for some mcs ofr for more information see proposition 8 3 next result refines this observation proposition 7 4 let r be a local ring and r s an extension 1 p r r r 2 an extension r s is pru fer if and only if s r for some mcs r and if and only if r rs i e s 1 exists and belongs to r for each s s r in this case s tot r proof the proof is a consequence the following facts r r is the pru fer hull of r if r s is pru fer there is some mcs r such that s r in which case r r r r 26 remark 5 9 proposition 5 10 p 123 the last assertion is 9 proposition 3 1 lemma 7 5 let r r s be an extension of finite type where is a mcs of r then there is some x such that s rx proof it follows from 7 theorem 1 1 that r r s is of fi nite presentation because it is an injective flat epimorphism of finite type therefore according to the mcs rule x s d r r is an open subset of the patch topology constructible topology by the chevalley theorem and is even open because a flat morphism of finite presentation is open for the zariski topology as the patch topology is compact and the sets d r for r are closed in this topology we get that x s is the intersection of finitely many d ri for i 1 n with ri setting x r 1 rn we get that x s d x and then s rx by the x rule the next result is now clear proposition 7 6 an extension r s of finite type over a local ring r is pru fer if and only if there is some s r such that s rs proof suppose that r s is pru fer then s r for some mcs r proposition 7 4 we deduce from lemma 7 5 that s rs for some s r the converse is obvious the following results will be useful proposition 7 7 let r be a local ring and x r a regular element then x is a strong divisor if and only if r rx is pru fer 22 g picavet and m picavet proof proposition 7 6 gives one implication suppose that r rx is pru fer from proposition 7 6 we deduce that rx rs for some strong divisor s r it follows that rx rs and then sn yx for some n n and y r therefore x is a strong divisor example 7 8 let r be a local arithmetical ring the set of all its ideals is a chain it follows that each regular element x of r is a strong divisor and then r rx is pru fer proposition 7 9 let f r r be a faithfully flat ring morphism between local rings and x r if f x is a strong divisor so is x proof observe that x is regular in r to conclude use proposition 2 5 because r f x rx r r let r s be an extension and a mcs of r the large quotient ring r of r in s with respect to is the set of all x s such that there is some s with sx r in case r p where p is a prime ideal of r we set r p r proposition 7 10 let r be a local ring and r s a flat extension then r r r r where r u s proof by proposition 7 4 there is some multiplicatively closed subset of r such that r r we have clearly u s so that it follows that r r while r r is pru fer and therefore r r now let z r r there is some t r such that x tz r since rt is a strong divisor rt and rx are comparable moreover since r s is flat t is also regular in s if rx rt then x at so that z a r because t is regular if rt rx then t bx and since r is saturated we get that x r and x is regular we deduce from that bz 1 in s it follows that z u s and z b 1 with b r u s so that z r to conclude we have r r r as the reverse inclusion is obvious we get finally that r r r if q is a prime ideal of a ring r we denote by q its generization i e p spec r p q the first author defined a prime g ideal as a prime ideal q such that q is an open subset of spec r 37 if q is a g ideal of r then q is a goldman ideal of r that is r p p is of finite type as an algebra 37 proposition 7 11 let s be a non unit strong divisor of a local ring r and r s rs the pru fer extension associated then p rsn around pru fer exrensions 23 n n is a prime g ideal s rp ps p is a divided prime ideal of r and r p is a valuation domain with quotient field s p we will denote by ps the ideal p proof there exists p spec r such that s rp ps p is a divided prime ideal of r and r p is a valuation domain with quotient field s p according to proposition 6 1 note s the saturated mcs generated by s and set i rsn n n remark that s usn n n u u r note that p r s we are aiming to show that i p we have i p because if not there is some x i s and then xy sp bsp 1 for some y b r and p n since s is regular it follows that s is a unit a contradiction now let x p and suppose that x i then x rsn for some positive integer n because sn is a strong divisor we get rsn rx and then x belongs to s a contradiction now p is a prime g ideal because p d s is an open subset if r s is a pru fer extension of finite type over a local ring there is some s r such that s rs by proposition 7 6 remark 7 12 we use the notation of proposition 7 11 it is easy to prove that p rsp because s is regular and p rsn n n therefore if r m is noetherian and local and s is not a unit from p mp we deduce that p 0 and r needs to be an integral domain so that r is a noetherian valuation domain that is a discrete valuation domain and s is the quotient field of r another consequence is that if r is not an integral domain the only strong divisors of r are the units the next result is now clear proposition 7 13 let r s be an extension over a local ring the set of rings f rs r s s r u s is a chain and r is the set union of all elements of f it follows that r tot r definition 7 14 we say that two ideals i and j of a ring r are equivalent if i j equivalently d i d j we also say that two elements x y of r are equivalent if d x d y and we write x y this condition is equivalent to rx ry and also to rx ry note that if x is a strong divisor and x y then y is a strong divisor because rx ry and the set of all strong divisors is a saturated mcs remark 7 15 we reconsider the context of proposition 7 11 and we set r r u r there is a surjective map r ps s 24 g picavet and m picavet r defined by s 7 ps setting spec r ps s r there is therefore a bijective map r spec r then spec r is a chain it follows that the set intersection of all its elements is a prime ideal r that could be called the strong radical of the local ring r now according to proposition 7 13 and the mcs rule x p r d s s r p s s r r it follows that p r rr if r s is a ring extension then r p r s r r we think that the set spec r deserves a deeper study especially with respect to some classes of rings proposition 7 16 let r s be a pru fer extension where r is local and i an ideal of finite type of r then i is s regular if and only if i r where is a strong divisor of r invertible in s proof assume that i is s regular from is s we deduce that i is a principal ideal r by 26 theorem 1 13 p 91 and proposition 2 3 p 97 because is s means that i is s regular and r being local is s invertible whence principal of the form i r an appeal to proposition 7 2 yields that r is a strong divisor and s s shows that is invertible in s the converse is obvious 8 qr extensions we first give some notation and definitions for an extension r s for t r s we set t u t r which is a mcs of r whose elements are regular and such that r r t t a pru fer extension r s is called bezout if each finitely generated s regular ideal of r is principal 26 definition 1 theorem 10 2 p 145 let r m be a local ring then an extension r s is bezout if and only if it is pru fer and if and only if r m is manis in s 26 scholium 10 4 p 147 we call qr extension any extension r s such that each t r s is of the form t r an isomorphism of r algebras for some mcs of r in which case the elements of are regular invertible in s and t r t it is easy to show that r s is a qr extension if and only if the defining property holds for each t r s fg moreover an extension r s is a qr extension if and only if it is pru fer and each finitely generated s regular ideal i of r satisfies i rx for some x r which implies that d i d x is special affine 26 proposition 4 15 p 116 a pru fer extension does not need to be a qr extension look at the example 20 section 4 examples around pru fer exrensions 25 proposition 8 1 a bezout extension r s is a qr extension proof we first observe that a subextension r t is bezout then 26 proposition 10 16 p 152 shows that t r for some mcs of r and therefore the extension is qr corollary 8 2 each extension r s has a unique bezout subexten sion r t that contains any t r s such that r t is bezout then t is called the bezout hull of r and denoted here by r proof it is enough to use 26 theorem 10 14 p 151 moreover we have the next result proposition 8 3 let r s be an extension where projective r modules of rank one are free then r s is pru fer if and only if it is a qr extension and if and only if r s is bezout if the above statements hold then a finitely generated s regular ideal i of r is of the form i r where is a locally strong divisor proof the first equivalence is 26 proposition 4 16 p 116 the sec ond is a consequence of 26 proposition 2 3 p 97 because under the hypotheses on r a pru fer extension is bezout and the converse holds for an arbitrary ring r the last statement is a consequence of propo sition 7 16 the condition on projective modules that are involved in this paper are either r is semilocal or a nagata ring a x 18 in particular we recover proposition 6 1 in case r is a local ring we will need an extension of the notion of strong divisors a regular element of a ring r is called a locally strong divisor shorten in lsd if r rx is pru fer in order to justify this definition we recall that an extension r s is pru fer if and only if all its localizations by a prime ideal of r are pru fer hence if x r is a lsd and p is a prime ideal of r then x 1 rp is a strong divisor for the converse use that if x r is regular in every ring rp where p is a prime ideal so is x because r rm m max r is injective the set of all locally strong divisors is a saturated mcs clearly a strong divisor of a local ring is a lsd now if r s is a ring extension we denote by r the ring r u s remark 8 4 let f r s be a ring morphism 1 if f is a flat morphism and x r is such that f x is a lsd then so is x indeed for q spec s lying over p then rp sq is faithfully flat 26 g picavet and m picavet 2 if f is a flat epimorphism and x r is a lsd so is f x because for each q spec s and p f 1 q the natural map rp sq is an isomorphism theorem 8 5 let r s be an extension then r s is a qr extension if and only if each t r s of finite type over r is of the form t rs for some lsd s r in particular if these conditions hold each t r s is of the form t rt where t is a mcs proof one implication is clear suppose that the extension is qr to see that the condition holds it is enough to suppose that it is of finite type according to lemma 7 5 there is some s r such that s rs then r s is pru fer whence so is rp sp for each prime ideal p of r and sp rp s 1 we have also sp rp y where y rp by proposition 7 6 it follows that d s 1 d y and by definition 7 14 s 1 is a strong divisor the last statement follows from the mcs rule applied to the flat epimorphism r t since t is is a union of finitely generated qr extensions theorem 8 6 any extension r s has a qr hull that is there exists a largest qr extension r r s contained in r as a consequence r is the compositum of all qr extensions in r s proof let x be the set of all qr extensions in r s fg which is di rected upwards take t u x they are of the form rx and ry where x and y are regular in r because they are units in s then we have rx ry rxy we can now use the proof of 8 theorem 5 which holds for an arbitrary extension r s and show that rxy x denote by r the set union of the elements of x since a qr extension in r s is a union of finitely generated qr extensions it is contained in r to complete the proof observe that an element of r r fg is contained in an element of x whence is in x from which we infer that r r is a qr extension actually the proof of davis shows that the set of all elements x r such that r rx is a qr extension is a mcs r also denoted contained in the mcs moreover in case r is either local or a nagata ring projective r modules of rank one are free so that an extension r s is pru fer if and only if it is a qr extension by propo sition 8 3 giving u s u s an application of the x rule gives the following result corollary 8 7 if r s is an extension then r r u s it follows that an extension r s is a qr extension if and only if for each s s there is some u s such that s r around pru fer exrensions 27 we remark that r r r r proposition 8 8 an extension r s is a qr extension if and only if each s regular finitely generated ideal is equivalent to a principal ideal of r and there exists a mcs u s such that s r if these conditions hold then s r u s proof assume first that r s is a qr extension by the recall before proposition 8 1 each s regular finitely generated ideal is equivalent to a principal ideal of r according to theorem 8 5 there exists a mcs whose elements are some lsd of r and such that s r conversely assume that each s regular finitely generated ideal is equivalent to a principal ideal of r and there exists a mcs whose elements are some lsd of r and such that s r let m max r it follows that sm r m rm where is a mcs whose elements are some lsd of rm then proposition 7 4 implies that rm sm is pru fer since this holds for anym max r we get that r s is pru fer and then a qr extension by the recall before proposition 8 1 if these conditions hold set u s s since is a mcs whose elements are units of s it follows that r s but implies s r r s so that s r we end this section by considering ring extensions r s that are flat epimorphisms such that the support supp s r of the r module s r is finite we recall that r s is a flat epimorphism for all p spec r either rp sp is an isomorphism or s ps these two conditions being mutually exclusive 29 proposition 2 4 p 112 it is known that the support supp s r of the r module s r is the set of all p spec r such that ps s therefore each element of the support is s regular moreover the support is closed because as any support it is stable under specialization hence the support equals to v j where j is the intersection of all elements p 1 pn of the support now each pi is the radical of an s regular finitely generated ideal as an examination of the proof of 2 corollary 13 by abbas and ayache shows moreover assume that r s is a qr extension using 26 proposition 4 15 p 116 we get that pi is of the form rxi for some xi r then j rx where x x 1 xn now if i is an s regular finitely generated ideal and q is a prime ideal of r containing i then q is s regular reasoning as above we see that i ry for some y r taking into account the characterization of qr extensions at the beginning of the section we see that we have proved the following result 28 g picavet and m picavet proposition 8 9 let r s be a pru fer extension where supp s r is finite in particular if r s has fcp we set j p p supp s r the following statements are equivalent 1 r s is a qr extension 2 each element of supp s r is equivalent to a principal ideal 3 each s regular finitely generated ideal of r is equivalent to a principal ideal in case one of the above statement holds j is a s regular ideal equiv alent to a principal ideal rx and d j rx proof we only need to prove the following by the flatness of the extension js ps p supp s r s remark 8 10 proposition 20 of 2 states that if in addition to the above hypotheses s is an integral domain then each t r s is of the form rx for some x r this proves that the extension is strongly affine actually in the proof of 2 proposition 20 we can replace the kaplansky transform of an ideal by a ring of sections 9 nagata extensions we start this section by recalling some facts about nagata rings that are explained in 14 section 3 let r be a ring and r x the polynomial ring in the indeterminate x over r we denote by c p the content of any polynomial p r x then r p r x c p r is a saturated mcs of r x each of whose elements is a non zero divisor of r x the nagata ring of r is defined to be r x r x r its main properties that are used in this section are the following if i is an ideal of r we set i x ir x which is an ideal of r x now if p is a prime ideal of r then p x is a prime ideal of r x lying over p the inclusion map r r x is a faithfully flat ring homomorphism and max r x m x m max r hence r x is local if r is local in fact r x r m x m max r also note that any ring homomorphism f r s extends to a ring homomorphism fe r x s x that fixes x and fe in turn induces a ring homomorphism fnag r x s x that also fixes x by the remark before 12 proposition ii 9 if f is an extension then so is fnag finally if f r s is a ring homomorphism we will say that r x r s s x canonically with respect to f if the ring homomorphism g r x r s s x that is induced by f is an isomorphism we will also say that f verifies the property t an fcp extension f verifies t 14 proposition 3 2 one sees easily that r x mr x rm x for each m spec r around pru fer exrensions 29 we recall some results frequently used in the section proposition 9 1 38 section iv proposition 4 and proposition 7 a ring morphism f r s verifies t when it is either integral no necessarily injective or a flat epimorphism consequently for each p spec r the ring morphism rp sp verifies t we say that the morphism verifies tp we deduce from the above proposition a if is a mcs of r then r x r x b if i is an ideal of r then r i x r x i x proposition 9 2 if f r s verifies t and tm for some maximal ideal m of r then r x m x s x m x identifies to rm x sm x proof we have sm x tm sm rmrm x s rrm rmrm x s rrm x s rr x m x s rr x r x r x m x t s x m x lemma 9 3 let r s be an extension and q a prime ideal of s lying over p in r then q x is lying over p x and the natural map r x p x s x q x identifies to rp x sq x proof that q x is lying over p x is an easy consequence of the following fact if p r x and q r x is such that c q r then c pq c p this follows from the lemma of dedekind mertens proposition 9 4 42 corollary 3 15 let r s be an extension of rings r r a faithfully flat base change and s r r s if r s is pru fer then r s is pru fer proposition 9 5 let r s be a ring extension the following statements are equivalent 1 r s is a flat epimorphism 2 r x s x is a flat epimorphism 3 r x s x where r x is the mcs of all p x r x whose contents in s are s proof 1 is equivalent to 3 by 36 lemma 3 11 now r x s x is a flat epimorphism if r s is a flat epimorphism 14 lemma 3 1 g and proposition 9 1 to prove the converse we use 42 scholium a 1 which states that a ring morphism a b is a flat epimorphism if and only if its local morphisms are isomorphisms and a b is an i morphism we then consider a prime ideal q of s lying over p suppose that r x s x is a flat epimorphism from lemma 30 g picavet and m picavet 9 3 we get that rp x r x p x sq x s x q x and deduce that rp x sq x is an isomorphism whence rp sq is injective identifying this map with an extension rp sq we get that rp x sq x it follows from 14 lemma 3 1 f that rp sq rp x sq sq x sq the injectivity of spec s spec r may be proved as follows if q and q are prime ideals of s lying over p in r then q x and q x are lying over p x theorem 9 6 an extension r s is quasi pru fer if and only if r x s x is quasi pru fer in that case r x r x r r r x and s x s r r x proof assume that r s is pru fer we intend to show that so is r x s x we can suppose that r m is local according to proposition 9 2 in order to use proposition 2 4 and proposition 6 1 then it is enough to know the following facts v x is a valuation domain if so is v and r x p x r x p x rp x 4 theorem 4 and lemma 2 r x p x r p x for p spec r now suppose that r x s x is pru fer then r s is a flat epimorphism by proposition 9 5 hence s x r x r s by proposition 9 1 it follows that proposition 9 4 entails that r s is pru fer since r r x is faithfully flat for the quasi pru fer case it is enough to use the pru fer case and proposition 9 1 because r x r x corollary 9 7 an element x of ring r is a lsd of r if and only if x is a lsd of the ring r x proof obvious by theorem 9 6 and proposition 7 7 proposition 9 8 if r s is an extension then r x s x is a pru fer extension if and only if it is a qr extension and in this case s x r x r x u s x proof if r x s x is pru fer it is a qr extension because over r x each projective module of rank one is free propositions 8 3 8 8 and 18 theorem 3 1 proposition 9 9 let r s be a pru fer extension of finite type then s x r x g x for some lsd g x r x proof we know that r x s x is pru fer to complete the proof use the above result and theorem 8 5 if r is a local ring within a unit a non unit strong divisor of the local ring r x can be written p x 1 where p x r x is regular with content c p x 6 r then r x p x 1 is comparable to each around pru fer exrensions 31 ideal we note that if x is an element of r which is a strong divisor in r x it is a strong divisor of r by proposition 7 9 theorem 9 10 let r be a local ring p x 1 a non unit strong divisor of r x and i the content ideal of p x n i 0 aix i r x then i r where is a strong divisor of r such that p x 1 in r x in fact i x r x p x 1 if p x 1 r x ai for some ai then i rai moreover xr r x p x 1 d i proof we start by showing that i x r x p x 1 we have that i n i 0 rai and p x 1 i x moreover p x 1 being a strong divisor of r x the ideal r x p x 1 is comparable to each r x ai assume first that ai p x r x for each ai then i x r x p x 1 i x gives i x r x p x 1 assume now that p x 1 r x ai for some ai then p x 1 aiq x s x for some q x s x r x with c s r and ai is regular this im plies that p x s x aiq x in r x by the lemma of dedekind mertens c ps c p i aic q rai i gives i rai moreover aic q c p rai leads to c q r to conclude ai 1 p x s x q x and we recover i x r x p x 1 in both cases i x r x p x 1 shows that i x is a strong divisor of r x we claim that i is a strong divisor of r let x r then xr x is comparable to i x if x i x then x 1 r x t x with r x i x and t x r x with c t r it follows that xt x r x in r x so that c xt rx c r i if i x xr x let y i we have y 1 xu x v x with u x v x r x and c v r so that yv x xu x r x giving yc v ry xc u rx then i rx in any case rx is comparable to i and i is a strong divisor of r setting s r x p x 1 we have that r x s is pru fer be cause p x ir x i x is s regular and then we have a tower of extensions r x d i x s by remark 3 2 2 it follows that r x d i x is pru fer because r r x is faithfully flat d i x d i r r x by proposition 3 7 3 according to proposition 2 5 faithfully flat morphisms descend pru fer extensions and then r d i is pru fer since i x r x p x 1 we get is s then d is d s s it follows that r d i is of finite presentation because this property is descended by faithfully flat ring morphism 34 proposition 5 3 therefore there is a strong divisor t r such that d i rt by proposition 7 6 since i x is a principal ideal generated by a regular element it is free and then a flat ideal but i x i rr x 32 g picavet and m picavet by flatness of r r x because faithfully flat morphisms descend flatness 34 proposition 4 1 i is a flat ideal of finite type whence is free over r therefore i is a principal ideal r then i x r x r x p x 1 shows that is a strong divisor of r the image of spec s spec r is d i because ag d p x d i we get xr s d i by remark 3 2 1 let p d i so that there exists some coefficient of p x which is not in p giving p x 1 6 p x which is a prime ideal of r x then there exists q spec s lying over p x and then over p spec r it follows that p xr s giving xr s d i remark 9 11 if r s is a pru fer extension of finite type for ex ample an fcp extension or a minimal extension and r is a local ring there is a strong divisor of r such that s r it follows that s x r x as r x s x is of finite type and pru fer s x is of the form r x p x 1 where p x 1 is a strong divisor of r x we therefore have p x 1 we recover proposition 9 9 under a more precise form here is an example illustrating proposition 9 10 let r be a local arithmetical ring according to example 7 8 each of its regular elements is a strong divisor now let p x 1 be a regular element of r x where p x r x has a content 6 r if a 0 an are the coefficients of p x one of them say ai is a multiple of all the others it follows that p x aiq x where the content of q x is r and ai is regular therefore ai is a strong divisor and p x 1 ai note that r x is local and arithmetical 1 theorem 3 1 we now give some conditions implying that the pru fer hull commutes with the formation of nagata rings we don t know if these conditions are superfluous we say that a ring r is quasi pru ferian if r r x is an i morphism these rings will be studied in section 10 proposition 9 12 let r s be a ring extension where r is quasi pru ferian and r s is lying over for example if the extension is almost pru fer then r x r x proof if r is quasi pru ferian so is r because r r is a flat epimor phism according to proposition 10 3 1 therefore spec r x spec r is bijective the extension r x r x is pru fer whence a flat epimorphism which is surjective if it has lying over a prime ideal of r x is of the form p x where p is a prime ideal of r let q around pru fer exrensions 33 be a prime ideal of s above p then q x contracts to p x which gives a prime ideal of r x lying over p x proposition 9 13 let r s be a ring extension such that the map r s r x s x defined by t 7 t x is bijective then r x r x proof according to theorem 9 6 r x r x is pru fer then r x r x assume that r x 6 r x so that there exists t r s t 6 r such that t x r x because is bijective using again theorem 9 6 it asserts that r t is pru fer leading to t r and then to t x r x r x r x to conclude r x r x proposition 9 14 let r s be a ring extension where r is local quasi pru ferian then r x r x proof since r x r x is pru fer and r x is local proposition 6 1 says that there exists q spec r x such that r x r x q in the same way there exists p spec r x such that r x r x p we still have r x r x so that q p set p p r and q q r as r is quasi pru ferian it follows that p p x and q qr x with q p then r x r x p rp x a same reasoning gives r x r x q rq x s x in particular r r x s rp x s rp now rq rq x s x shows that rq r s but r rq is pru fer since so is r x rq x r x then we have rq rp rq which implies rq rp and then rq x rp x that is r x r x proposition 9 15 if r s is almost pru fer then r x s x is almost pru fer so that r x r x proof if r s is almost pru fer then r r is pru fer and r s is integral so that r x r x is pru fer and r x s x is integral whence r x s x is almost pru fer with r x r x in case r s is an fcp extension we get more results a minimal extension r s is such that there exists a maximal ideal m of r satisfying supp s r m such a prime ideal m is called the crucial maximal ideal c r s of r s 13 theorem 2 1 34 g picavet and m picavet lemma 9 16 let r s be an fcp ring extension such that r r then r x r x proof if r x 6 r x there is some t r x r x such that r x t is pru fer minimal set m c r x t which is in msupp s x r x let m msupp s r be such that m mr x 14 lemma 3 3 since 42 proposition 4 18 2 asserts that m 6 msupp r x r x msupp r x r x this gives that m 6 msupp r r which entails that m msupp s r by 43 lemma 1 8 there exists t r r such that m c r t with r t pru fer minimal since t 6 r r a contradiction proposition 9 17 if r s has fcp then r x r x proof because r r is pru fer r x r x is pru fer by proposi tion 9 6 then r x r x assume that r x 6 r x and set t r so that t t giving t x t x r x by lemma 9 16 hence t x r x is a pru fer extension contradicting the definition of t x so r x r x 10 quasi pru ferian rings we call a ring r quasi pru fer if r tot r is quasi pru fer in order to have a coherent definition r is classically called pru fer if r tot r is pru fer trivially a total quotient ring is quasi pru fer proposition 10 1 gives another example we recall that a ring r is called mccoy or satisfies the condition a if each finitely generated ideal i of r contained in z r is such that 0 i 6 0 30 it is easy to prove that if r s is an injective flat epimorphism and r is mccoy then s is mccoy indeed a finitely generated ideal of s is of the form is for some finitely generated ideal i of r it is well known that r x is mccoy for any ring r whence so is r x 24 corollary 1 we will need the following definitions and results let m be an r module and p spec r then p is called an attached prime ideal of m a strong krull prime ideal by 25 if for each finitely generated ideal i p there is some x m such that i 0 x p the set of all attached prime ideals of m is denoted by att m we recall that z r p p att r around pru fer exrensions 35 1 an element of att r x is of the form p x for some p att r 25 theorem 2 5 therefore the set of zero divisors of r x is z r x p x p att r 2 the mcs s p x r x c p x r is contained in r x z r x and the elements of att r x are of the form p x where p att r it follows that r x r x tot r x and then tot r x tot r x lucas proved that a ring r is mccoy if and only if tot r x tot r x tot r x by 30 proposition 4 1 and the above result 2 proposition 10 1 let r be a quasi pru fer mccoy ring then tot r x tot r x and r x is quasi pru fer proof we have tot r x tot r x so thatr x tot r x is quasi pru fer because deduced from the flat epimorphism r tot r by the base change r r x quasi pru fer rings defined in the book 17 do not coincide with our quasi pru fer rings they are called elsewhere quasi pru ferian a terminology we adopt definition 10 2 5 a ring r is called quasi pru ferian if for each prime resp maximal ideal m of r any prime ideal q of r x such that q m x is of the form q r x it is easy to show that a ring r is quasi pru ferian if and only if the faithfully flat ring morphism r r x is an i extension because any maximal ideal of r x is of the form mr x for some m max r another characterization is spec r x p x p spec r we will use the following characterization a ring r is quasi pru ferian if and only if r r x has the incomparability property the inc property the class of quasi pru ferian rings is stable under the formation of factor rings and the formation of nagata rings moreover a ring r is quasi pru ferian if and only if rp is quasi pru ferian for each p spec r over an integral domain the two classes quasi pru fer and quasi pru ferian coincide 17 section 6 5 it follows that a ring which is locally a quasi pru fer domain is quasi pru ferian the stability of the class of quasi pru ferian rings under various op erations does not seem to be valid for the class of quasi pru fer rings for example the formation of total quotient rings does not commute with localizations we will show at the end of the section example 10 8 that these classes are different we will use and sometimes generalize some results of 3 holding in the integral domain context 36 g picavet and m picavet we intend now to generalize 3 lemma 2 3 and theorem 2 7 proposition 10 3 let f r s be a ring morphism 1 if r is quasi pru ferian and f is either an integral morphism or a flat epimorphism then s is quasi pru ferian 2 if s is quasi pru ferian and f is injective and integral then r is quasi pru ferian 3 if r is quasi pru ferian and f is a quasi pru fer extension then s is quasi pru ferian proof 1 if r is quasi pru ferian and f is either integral or a flat epimorphism then s x r x r s by proposition 9 1 so that r x s x has the inc property and so has r r x it follows easily that s s x has the inc property 2 suppose that f is integral and injective then so is r x s x therefore each couple p p of prime ideals of r x can be lifted up to a couple q q of prime ideals of s x by the lying over and going up properties of an integral extension because s s x has the inc property as well as r s we can assert that r r x has the inc property 3 we have a tower of extensions r r s where the last extension is pru fer as usual if p is a prime ideal of a ring r a prime ideal q of r x is called an upper of p if q 6 p x and p q r theorem 10 4 each next statement on a ring r implies the following 1 r is quasi pru ferian 2 if p spec r and m max r then no upper of p is contained in m x 3 ifm is a maximal ideal of r then no upper of a minimal prime ideal of r is contained in m x 4 any flat injective epimorphism r s is quasi pru fer 5 r tot r is quasi pru fer i e r is quasi pru fer proof we will follow the scheme of the proof of 3 theorem 2 7 we first prove the contrapositive of 4 3 suppose that an injec tive flat epimorphism r s is not quasi pru fer then there exists some u s such that r r u does not satisfies inc hence by 10 theorem 2 3 there exist distinct prime ideals q 1 q 2 of r u and a maximal ideal m of r such that q 1 r q 2 r m con sider the ring morphism e r x r u defined by x 7 u and set qi e 1 q i let also be a minimal prime ideal n q 1 of r u and set n e 1 n now because r u s is injective there is a minimal around pru fer exrensions 37 prime idealw of s lying over n because r s is flat whence has the going down property we get that w r n r is a minimal prime ideal of r as q 1 q 2 are distinct prime ideals e is a surjective map of r x lying over m it follows that q 1 m x it is enough to consider the field r m suppose that n is not an upper of then n x we then have a factorization r r x r x x r x n r u n s w into injective morphisms an appeal to 29 corollaire 3 2 ii p 114 yields that r r x is a faithfully flat epimor phism whence an isomorphism an absurdity since q 1 m x n then 3 fails lemma 10 5 a ring r with r x treed is treed and quasi pru ferian proof 3 proposition 2 2 is valid for arbitrary rings proposition 10 6 let r be a ring such that tot r is zero dimensional then r is quasi pru ferian if and only if r is quasi pru fer in this case r x is treed and tot r x tot r r r x tot r x proof if r is quasi pru ferian then r is quasi pru fer by theorem 10 4 to prove the converse and according to lemma 10 3 we can suppose that r is pru fer then we can reduce to the case where r is local because for any prime ideal p of r we have r x p rp x and tot r p tot rp so that tot rp is zero dimensional the proof of the last statement is as follows there is an injective ring morphism tot r tot rp because rp is flat over r this morphism in duces another one tot r r rp tot rp there is a factorization tot r tot r rrp tot rp the first morphism is a flat epi morphism and the composite is injective we get that tot r rrp tot rp is injective by 29 lemme 3 4 p 114 to conclude we use the following fact an injective flat epimorphism whose domain is zero dimensional is an isomorphism 29 lemme 1 2 p 109 whence the injective flat epimorphism tot r r rp tot rp is an isomor phism we claim that r is treed if r tot r is pru fer when r is local in this case there exists some divided prime ideal p of r such that tot r rp and r p is a valuation domain as t rp is zero dimensional p is a minimal prime ideal of t in fact spec t p then p is also a minimal prime ideal of r because t rp moreover r t being injective p is the unique minimal prime ideal of r at last spec r v p is a chain because r p is a valuation domain so that r is treed 38 g picavet and m picavet the same proof works for r x which is also local and such that r x t x is pru fer to begin with t being zero dimensional so is t x because the minimal prime ideals maximal ideals of t x are of the form mt x where m min t m max t then there is a factorization r x tot r r r x tot r x where the first morphism is a flat epimorphism and the composite is an injec tive flat epimorphism it follows that the last morphism being a flat injective epimorphism is an isomorphism because its domain is zero dimensional therefore t x t r r x tot r x leading to r x tot r x is pru fer with tot r x zero dimensional mimicking the proof we got for r it follows that r x is treed and we can apply lemma 10 5 to get that r is quasi pru ferian remark 10 7 if we suppose that dim m r 0 then m rp m r p to see this it is enough to use 29 proposition 3 5 p 115 suppose now in addition that r m r is quasi pru fer mimick ing the proof of proposition 10 6 we can also show that r is quasi pru ferian the reader may find in 29 many contexts in which tot r m r example 10 8 a total quotient ring which is a quasi pru fer ring need not to be quasi pru ferian to see this we consider the following example given by lucas 31 example 2 11 there is a total quotient ring r which is not locally pru fer because there is a prime ideal p of r such that rp is not pru fer but is integrally closed actually an ufd suppose that quasi pru fer rings are quasi pru ferian then rp would be quasi pru ferian since quasi pru fer as it is integrally closed it would be pru fer a contradiction 11 pru fer fcp extensions over a local ring clearly a minimal extension is a flat epimorphism if and only if it is pru fer so we will call pru fer minimal such extensions we note as a first result the following proposition which results from proposi tion 8 9 proposition 11 1 a pru fer minimal extension with crucial ideal max imal m is a qr extension if and only if m is equivalent to a principal ideal proposition 6 1 take the following form observing that a pru fer ex tension is integrally closed proposition 11 2 13 theorem 6 8 and theorem 6 10 if r is a local ring an extension r s is pru fer fcp resp minimal if and only around pru fer exrensions 39 if there exists p spec r such that s rp p sp and r p is a finite dimensional resp one dimensional valuation domain under these conditions s p is the quotient field of r p and p is a divided prime ideal of r the conductor of a ring extension r s is denoted by r s the following corollary recalls for a pru fer minimal extension r s the link between the crucial ideal maximal c r s and r s corollary 11 3 if r s is a pru fer minimal extension with crucial ideal maximal m then p r s is a prime ideal of r p m and there is no prime ideal of r contained strictly between p and m proof first p r s is a prime ideal of r by 19 lemme 3 2 moreover pm prm rm sm with rm 6 sm shows that p m at last rm sm is also a pru fer minimal extension then according to proposition 11 2 rm pm is a one dimensional valuation domain so that there is no prime ideal ofrm contained strictly between pm andmrm giving that there is no prime ideal ofr contained strictly between p and m corollary 11 4 let r s be a pru fer minimal extension over a local ring r m then with the notation of proposition 11 2 each element t m p is a strong divisor of r s rt p rtn n n and m rt proof because t p we have t u s and then a factorization r rt s so that s rt by minimality by proposition 7 6 t is a strong divisor the third statement follows from corollary 7 11 because r p is one dimensional m is the only prime ideal containing p so that m rt proposition 11 5 let r s be a ring extension where r m is a local ring the following statements are equivalent 1 r s is a pru fer minimal extension 2 there is a strong divisor a r u r such that s ra and ra rb ra rb or equivalently d a d b d a d b for each b r u r 3 there is a strong divisor a r u r such that s ra and m ra 4 there is a strong divisor a r u r such that s ra and such that d a is an open affine subset maximal in the set of proper open affine subsets proof we have clearly 2 3 by corollary 11 4 once 1 2 is proved we then prove that 1 is equivalent to 2 suppose that 40 g picavet and m picavet r s is a minimal extension that is a flat epimorphism then r s is clearly a pru fer extension by proposition 7 10 there is a mcs of r whose elements are strong divisors and such that the extension identifies with r r picking an arbitrary element a we get a factorization r ra r its factors are injective because the flat epimorphism r ra verifies 29 lemme 3 4 p 114 as a is not invertible r 6 ra implies s ra by minimality of r s in the same way a factorization r rb ra implies rb ra or equivalently d a d b d a d b which means that ra rb ra rb we prove the converse observe that for any mcs of r and a r such that there is a factorization r r ra we have d a d suppose that r s verifies the conditions of the proposition then s ra where a r u r is a strong divisor and then r s is pru fer so that any subextension r t s is pru fer by proposition 7 10 we get that t r for some mcs of r the above observation shows that d a d for any the last condition entails that a and then t ra therefore r s is minimal and a flat epimorphism clearly 4 implies 2 the converse is a consequence of the following facts if d a d i where d i is an open affine subset different from spec r we have a factorization r d i ra and r d i is an injective flat epimorphism whose spectral image is d i lemma 11 6 let r be a ring and a r then there exists some m max r such that m ra if and only if supp ra r m proof let m max r then m ra m is the only p spec r containing a for any p spec r m a 6 p and a m for any p spec r m a 1 u rp and a 1 6 u rm for any p spec r m rp ra p and rm 6 ra m supp ra r m proposition 11 7 let r s be a ring extension the following statements are equivalent 1 r s is a minimal qr extension 2 there exists some m max r such that supp s r m and there is a lsd a r u r such that s ra 3 there is a lsd a r u r such that s ra and there exists some m max r such that m ra if these conditions are satisfied then m 6 p max r p 6 m proof 1 2 assume that r s is a minimal qr extension then there exists some m max r such that supp s r m around pru fer exrensions 41 since r s is a minimal qr extension theorem 8 5 asserts that there is a lsd a r u r such that s ra since s is of finite type over r it follows that supp ra r m which gives m ra by lemma 11 6 so that a m p max r p 6 m giving m 6 p max r p 6 m proving the last assertion 2 1 assume that there exists some m max r such that supp s r m and there is a lsd a r u r such that s ra these two conditions lead to m ra by lemma 11 6 as a 1 is a strong divisor of rm and sm ra m rm a 1 proposition 11 5 shows that rm sm is minimal pru fer moreover rp sp for any p max r p 6 m implies that r s is minimal pru fer at last theorem 8 5 shows that r s is a qr extension since minimal 2 3 by lemma 11 6 corollary 11 8 a minimal pru fer extension r s such that s rs for some lsd s of r is a qr extension proof since r s is minimal there exists some m max r such that supp s r m then proposition 11 7 shows that r s is a qr extension example 11 9 set r z p pz where p is a prime integer and s zp obviously supp s r p so that s rp and p rp then p 1 is a strong divisor of rp and p 1 u rm for any m spec r p showing that p is a lsd of r we recover the fact that z zp is a minimal pru fer qr extension next result shows that pru fer fcp extensions can be described in a special manner proposition 11 10 42 proposition 1 3 let r s be an fcp ex tension then r s is integrally closed r s is pru fer r s is a tower of pru fer minimal extensions theorem 11 11 an fcp qr extension r s admits a tower of pru fer minimal extensions r r 1 ri ri 1 rn s where ri 1 ri ai rai for some lsd ai r and s ra 1 an ran the integer n is independent of the sequence and is equal to supp s r proof there is a tower of pru fer minimal extensions ri ri 1 by proposition 11 10 because a qr extension is pru fer therefore each t r s is a localization ra for some lsd a r by theorem 8 5 and ri ri 1 identifies to ri rai for some lsd ai r u ri then by minimality we get that ri 1 rai ri ai and the result follows the last result is 13 proposition 6 12 42 g picavet and m picavet the above result applies when r s is an fcp extension a x b x or equivalently a b has fcp 14 theorem 3 9 proposition 11 12 let r s be an fcp pru fer extension over a local ring r m 1 there is a sequence of pru fer minimal extensions between local rings r r 1 ri ri 1 rn s where ri 1 ri ai rai for some ai r and s ra 1 an ran in fact r s ri ni 0 moreover r s is a qr extension 2 there is some subset p 0 p 1 pn of spec r with p 0 m and pi pi 1 for i 1 n such that ri rpi piri pi and r pi is a valuation domain whose dimension is i 3 for all i 1 n and t pi 1 pi we have ri rt moreover each element of m pn is a strong divisor 4 any finitely generated s regular ideal is equivalent to a principal ideal proof 1 we know that r s is chained because r is local 13 theorem 6 10 and each ri is local by proposition 11 2 moreover this proposition shows that for each i nn there exists pi spec r such that ri rpi piri pi and r pi is a i dimensional valuation domain therefore r s is a qr extension then apply theo rem 11 11 2 since r r 1 is pru fer minimal p 0 m c r r 1 as s rn it follows that r pn is a n dimensional valuation domain and p 0 p 1 pn 1 supp s r according to 13 proposition 6 12 with pi pi 1 for each i nn 3 let t pi 1 pi then t is a unit of rpi ri and rt ri as t pi 1 this implies that t is a not a unit of rpi 1 ri 1 so that rt 6 ri 1 but r s is a chain which leads to rt ri let x m pn since p 0 p 1 pn is a chain there exists some i nn such that x pi 1 pi then rx ri by the first part of 3 to end proposition 7 6 and definition 7 14 show that x is a strong divisor 4 since r s is a qr extension any finitely generated s regular ideal is equivalent to a principal ideal according to the recall at the beginning of section 8 we end this section by a generalization of proposition 11 12 to b extensions we recall that an extension r s is a b extension if the map r s rm sm m msupp s r defined by t 7 tm m msupp s r is bijective actually an fcp extension r s is a around pru fer exrensions 43 b extension if and only if r p is a local ring for each p supp s r 44 proposition 2 21 the following lemma gives a first special case of b extension for any extension r s the length r s of r s is the supremum of the lengths of chains of r subalgebras of s notice that if r s has fcp then there does exist some maximal chain of r subalgebras of s with length r s 14 theorem 4 11 lemma 11 13 let r s be an fcp pru fer extension such that msupp s r 1 then r s is a b extension where supp s r and r s are chains with n supp s r r s 1 there is a tower of pru fer minimal extensions r r 1 ri ri 1 rn s such that r s ri ni 0 we define as follows a subset p 0 p 1 pn of spec r by supp s r p 0 p 1 pn 1 and pn r rn 1 s where pi pi 1 for each i nn in particular supp ri r p 0 p 1 pi 1 proof from msupp s r 1 we deduce that r s is a b extension by 44 proposition 2 21 if m msupp s r the map r s rm sm defined by t tm for any t r s is bijective but rm sm is chained by proposition 11 12 whence r s is chained according to 45 theorem 3 10 supp s r has a least element p and supp s r v p is chained moreover supp s r r s 1 r s by 13 proposition 6 12 if n r s 1 there is a sequence of pru fer minimal extensions r r 1 ri ri 1 rn s such that r s ri ni 0 since r s is chained moreover there is some subset p 0 p 1 pn of spec r such that supp s r p 0 p 1 pn 1 where pi pi 1 for each i nn 1 in particular supp ri r p 0 p 1 pi 1 for each i nn in fact we have pi r c ri ri 1 for each i 0 n 1 by 13 corollary 3 2 and also pi r ri 1 ri for each i nn 1 by corollary 11 3 proposition 11 14 let r s be an fcp pru fer extension such that msupp s r 1 set r s ri ni 0 pn r rn 1 s and supp s r p 0 p 1 pn 1 as defined in lemma 11 13 the following conditions are equivalent 1 r s is a qr extension 2 for each i nn there is some lsd ai r such that ri rai 3 for each i nn there is some ai r such that pi 1 rai if these conditions hold then for each i nn we have ri ri 1 ai and ai pi 1 pi moreover ai satisfies 2 if and only if it satisfies 3 proof 1 2 by theorem 8 5 and 3 1 by proposition 8 9 44 g picavet and m picavet assume that 2 holds with ai an lsd such that ri rai obviously ri ri 1 ai let p spec r then ai p implies that pri ri so that p supp ri r p 0 p 1 pi 1 then there is some j i such that p pj and ai 6 pi to prove that ai pi 1 we localize the extension r s at m set r j rj m p j pjrm for each j 0 n and a i ai 1 then r s is an fcp pru fer extension over the local ring r m with n r s using proposition 11 12 we get that p 0 p 1 p n is the subset of spec r such that r i r p i p ir i p i it follows that gives r i r a i r i 1 a i with r i 1 a local ring with maximal ideal p i 1 then a i p i 1 since r i r i 1 a i 6 r i 1 which gives ai pi 1 pi to conclude pi 1 rai as the least prime ideal of r containing ai and also the least element of supp ri r it follows that ai satisfies 3 conversely if there is some bi such that pi 1 rbi then rai rbi implies ri rai rbi by definition 7 14 in order to generalize lemma 11 13 to an arbitrary fcp pru fer b extension we need the following definition introduced in 45 let r s be an fcpb extension andm msupp s r the elementary splitter m t associated to m is defined by msupp t r m and msupp s t msupp s r m such a t always exists see 45 theorem 4 6 and the paragraph after corollary 5 5 proposition 11 15 let r s be an fcp pru fer b extension and qr extension let t r s and set msupp t r m 1 mn for each i nn let pi be the least element of supp t r contained in mi then there exists some lsd t r such that t rt and rt pi i nn proof since r s is an fcp pru fer b and qr extension so is r t by 45 proposition 3 5 for the b extension property set msupp t r m 1 mn for each i nn according to 45 theorem 3 10 there is a least element pi of supp t r contained in mi the same reference gives that v pi is a chain whose greatest element is mi and least element is pi for each i nn set ti mi so that msupp ti r 1 moreover for any p v pi we have p supp ti r then supp ti r v pi because msupp ti r mi and we can apply proposition 11 14 for each i nn we have ti rai for some lsd ai r and pi rai for each i nn set t a 1 an which is still an lsd now 45 proposition 5 11 asserts that t ti i around pru fer exrensions 45 nn rai i nn rt moreover rt rai i nn rai i nn pi i nn 12 the set of all primitive elements let r s be an extension an element s s is called primitive over r if there exists a polynomial p x r x whose content is r and such that p s 0 an extension r s is called a p extension if all the elements of s are primitive over r important examples of p extensions are given by the pru fer extensions of 26 equivalently normal pairs 26 theorem 5 2 p 47 we recall that an element s of s is primitive if and only if r r s has the inc property 10 theorem 2 3 and that an extension r s is a p extension if and only if r s is a inc pair 10 corollary 2 4 we proved that an inc pair is nothing but a quasi pru fer extension 42 theorem 2 3 it follows easily that an extension is quasi pru fer if and only if it is a p extension therefore an fcp extension is a p extension 42 corollary 3 4 for an extension r s we denote by ps r the set of all elements of s that are primitive over r a set studied by dobbs houston in 11 we defined in 42 theorem 3 18 the quasi pru fer closure or hull r of an extension r s this closure is the greatest quasi pru fer subextension r t of r s and is equal to r it follows that r ps r obviously r ps r proposition 12 1 let r s be an extension then ps r is a ring if and only if ps r r proof it is enough to show that if ps r is a ring it is contained in r that is r ps r is pru fer but we may assume that r s is integrally closed because an element of s primitive over r is primitive over r by 11 proposition 2 6 we can also assume that r is local let s ps r then either s r or s is a unit of s such that s 1 r according to 11 corollary 2 5 if s r then r s r s 2 if s is a unit of s such that s 1 r then s 1 r s 2 implies s r s 2 and we still have r s r s 2 therefore for each s ps r we have r s 2 r s we deduce from 26 chapter 1 theorem 5 2 that the ring ps r is pru fer over r and then ps r r it may happen that an extension r s is such that ps r s for example if we denote by tot r the total ring of quotients of a 46 g picavet and m picavet ring r then ptot r r is a ring if and only if ptot r r tot r 11 corollary 2 9 if r s defines a lying over pair then ps r r 11 proposition 3 11 the next result generalizes some results of 11 corollary 12 2 an extension r s is such that ps r s if and only if r s is quasi pru fer references 1 d d anderson d f anderson and r markanda the rings r x and r x j algebra 95 1985 96 115 2 r abbas and a ayache on questions related to normal pairs comm algebra 49 3 2021 956 966 3 d f anderson d e dobbs and m fontana on treed nagata rings j pure appl algebra 61 1989 107 122 4 j t arnold on the ideal theory of the kronecker function ring and the domain d x canadian j math 21 1969 558 563 5 a ayache p j cahen and o echi annneaux quasi pru fe riens et p anneaux bollettino u m i 7 10 b 1996 1 24 6 v p camillo a note on semi hereditary rings arch math vol xxiv 1973 142 143 7 s h cox jr and d e rush finiteness in flat modules and algebras j algebra 32 1974 44 50 8 e d davis overrings of commutative rings iii normal pairs trans amer math soc 182 1973 175 185 9 t m k davison distributive homomorphisms of rings and modules j reine angew math 271 1974 28 34 10 d e dobbs lying over pairs of commutative rings can j math xxxiii 2 1981 454 475 11 d e dobbs and e houston on sums and products of primitive elements comm algebra 45 2017 357 370 12 d e dobbs b mullins g picavet and m picavet l hermitte on the fip property for extensions of commutative rings comm algebra 33 2005 3091 3119 13 d e dobbs g picavet and m picavet l hermitte characterizing the ring extensions that satisfy fip or fcp j algebra 371 2012 391 429 14 d e dobbs g picavet and m picavet l hermitte transfer results for the fip and fcp properties of ring extensions comm algebra 43 2015 1279 1316 15 s endo on semi hereditary rings j math soc japan 13 no 2 1961 109 119 16 v erdog du the distributive hull of a ring j algebra 132 1990 263 269 17 m fontana j a huckaba and i j papick pru fer domains monographs and textbooks in pure and applied mathematics 203 marcel dekker inc new york 1997 18 d ferrand trivialisation des modules projectifs la me thode de kro necker j pure appl algebra 24 1982 261 264 around pru fer exrensions 47 19 d ferrand and j p olivier homomorphismes minimaux d anneaux j algebra 16 1970 461 471 20 r gilmer and j ohm integral domains with quotient overrings math ann 153 1964 813 818 21 c gotlieb finite unions of overrings of an integral domain j commut algebra doi 10 1216 jca 2020 12 87 22 a grothendieck ele ments de ge ome trie alge brique iv etude locale des sche mas et des morphismes de sche mas iv inst hautes etudes sci publ math 32 1967 361 pp 23 a grothendieck and j dieudonne ele ments de ge ome trie alge brique i springer verlag berlin 1971 24 j a huckaba and j m keller annihilation of ideals in commutative rings pacific j math 83 no 2 1979 375 379 25 j iroz and d e rush associated prime ideals in non noetherian rings can j math vol xxxvi no 2 1984 344 360 26 m knebusch and d zhang manis valuations and pru fer extensions i springer berlin 2002 27 m knebusch and t kaiser manis valuations and pru fer extensions ii springer cham heidelberg 2014 28 j kostra the covering of rings by integrally closed rings mathematica slovaca 34 no 2 1984 171 176 29 d lazard autour de la platitude bull soc math france 97 1969 81 128 30 t g lucas two annihilator conditions property a and a c comm algebra 14 3 1986 557 580 31 t g lucas some results on pru fer rings pacific j math 124 1986 333 343 32 k morita flat modules injective modules and quotient rings math z 120 1971 25 40 33 j p olivier fermeture inte grale et changements de base absolument plats colloque d alge bre commutative rennes 1972 exp no 9 13 pp publ se m math univ rennes anne e 1972 univ rennes rennes 1972 34 j p olivier descente de quelques proprie te s e le mentaires par morphismes purs an acad brasil ci 45 1973 17 33 35 j p olivier going up along absolutely flat morphisms j pure appl algebra 30 1983 47 59 36 l paudel and s tchamna kronecker function rings of ring extensions j algebra appl vol 16 no 11 2018 1850021 37 g picavet autour des ide aux premiers de goldman d un anneau com mutatif ann sci univ clermont 57 math no 11 1975 73 90 38 g picavet proprie te s et applications de la notion de contenu comm algebra 13 1985 2231 2265 39 g picavet geometric subsets of a spectrum commutative ring theory and applications fez 2001 387 417 lecture notes in pure and appl math 231 dekker new york 2003 40 g picavet recent progress on submersions a survey and new properties algebra doi org 10 1155 2013 128064 2913 2013 article id 128064 14 p 2013 48 g picavet and m picavet 41 g picavet and m picavet l hermitte some more combinatorics results on nagata extensions palest j math 5 2016 49 62 42 g picavet and m picavet l hermitte quasi pru fer extensions of rings pp 307 336 in rings polynomials and modules springer 2017 43 g picavet and m picavet l hermitte rings extensions of length two j algebra appl 18 2019 no 9 1950174 34 pp 44 g picavet and m picavet l hermitte boolean fip ring extensions comm algebra 48 2020 1821 1852 45 g picavet and m picavet l hermitte splitting ring extensions arxiv 2107 04102 v 1 math ac 46 p samuel la notion de place dans un anneau bull soc math france 85 1957 123 133 47 h h storrer epimorphismen von kommutativen ringen comment math helv 43 1968 378 401 mathe matiques 8 rue du forez 63670 le cendre france email address picavet mathu at orange fr http arxiv org abs 2107 04102 1 introduction and notation 1 1 an overview of the paper 1 2 basics concepts 2 some definitions notation and useful results 3 s regular ideals and rings of sections 4 integral closures as intersections 5 avoidance lemmata 6 pullback results 7 the case of a local base ring 8 qr extensions 9 nagata extensions 10 quasi pr ferian rings 11 pr fer fcp extensions over a local ring 12 the set of all primitive elements references