ar x iv 2 10 2 06 64 2 v 1 m at h a c 1 2 f eb 2 02 1 generalizations of samuel s criteria for a ring to be a unique factorization domain daniel daigle gene freudenburg and takanori nagamine abstract we give several criteria for a ring to be a ufd including generalizations of some criteria due to p samuel these criteria are applied to construct for any field k 1 a z graded non noetherian rational ufd of dimension 3 over k and 2 k affine rational ufds defined by trinomial relations 1 introduction let a be a unique factorization domain ufd this paper considers ring extensions of the following two types i arxs where ax b for relatively prime a b p azt 0 u such that aa and aa ba are prime ideals ii arxs where a has a z grading and xn f for some positive integer n and homogeneous prime f p a with degree relatively prime to n in his 1964 treatise on ufds samuel 21 studied each of these kinds of extension in case i samuel demonstrated that if a is noetherian then arxs is a ufd 21 proposi tion 7 6 we show that the noetherian condition can be weakened to a local condition namely if the hypotheses of i are satisfied and i 1 paa baq i p 0 q then arxs is a ufd theorem 3 1 in case ii samuel considered rings of the form a rrx 1 xns a polynomial ring over a ufd r where a is z graded by positive weights over r he showed that if either n is congruent to 1 modulo degf or every finitely generated projective r module is free then arxs is a ufd 21 theorem 8 1 we show more generally that arxs is a ufd whenever the conditions of ii hold theorem 3 8 after some preliminaries section 3 gives these and other new criteria for a ring to be a ufd and applies them to certain families of affine algebras over a field k which motivated our work to generalize samuel s criteria in the first place in section 4 we construct a z graded non noetherian ufd over k with krull dimension 3 and quotient field kp 3 q the field of rational functions in three variables over k this example is similar to one given in 5 but the existence of a z grading allows for a much simpler proof section 5 introduces a family of k affine rings defined by trinomial relations theorem 5 1 shows that the rings in this family are ufds such rings appear in the classification of affine factorial k varieties which admit a torus action of complexity one for an algebraically closed field k of characteristic zero these rings were studied in 11 the bourbaki volume 1 claims that arxs is a ufd whenever the conditions of i above hold however this assertion is wrong we construct a counterexample in section 6 date february 15 2021 2010 mathematics subject classification 14 r 05 13 a 02 13 c 20 key words and phrases krull domain divisor class group unique factorization domain non noetherian ring the work of the first author was supported by grant 04539 rgpin 2015 from nserc canada the work of the third author was supported by jsps overseas challenge program for young researchers no 201880243 and jsps kakenhi grant numbers jp 18 j 10420 and jp 20 k 22317 1 http arxiv org abs 2102 06642 v 1 2 preliminaries all rings are commutative with unity and any domain is understood to be an integral domain for the ring a a is the group of units of a dima is the krull dimension of a and for an ideal i a htpiq is the height of i if f p a then af s 1 a where s tfn n p nu for the integer n 0 arns is the polynomial ring in n variables over a and ar ns is the ring of laurent polynomials in n variables over a when a is an integral domain fracpaq is its field of fractions and if a b are integral domains then tr degab is the transcendence degree of fracpbq over fracpaq for the field k kpnq denotes the field of fractions of the polynomial ring krns 2 1 krull domains and divisor class groups given an integral domain a we write ppaq for the set of height 1 prime ideals of a krull domains can be characterized as follows 1 chap vii 1 n 7 thm 4 theorem 2 1 a ring a is a krull domain if and only if it is an integral domain satisfying each of the following three conditions a for each p p ppaq ap is a dvr b a ppppaq ap c for each x p azt 0 u p p ppaq x p p is a finite set let a be a krull domain k fracpaq and divpaq the free abelian group on the set ppaq elements of divpaq are formal sums ppppaq npp with np p z for all p p ppaq and np 0 for almost all p for each p p ppaq ap is a discrete valuation ring and we denote by vp k z the corresponding normalized valuation i e the valuation with vppk q z given x p k the set p p ppaq vppxq 0 is finite by theorem 2 1 c so diva k divpaq divapxq ppppaq vppxqp px p k q defines a group homomorphism the elements of divpaq are called the divisors of a and those of prinpaq divapxq x p k are called the principal divisors of a the quotient group clpaq divpaq prinpaq is the divisor class group of a see 17 20 proposition 2 2 21 cor a to prop 4 1 the intersection of a finite number of krull domains within a common field is a krull domain proposition 2 3 21 prop 4 2 and thm 6 3 if a is a krull domain and s azt 0 u is a multiplicatively closed set then s 1 a is a krull domain if s is generated by prime elements of a then clps 1 aq clpaq proposition 2 4 let a be an integral domain let p 1 pn p azt 0 u be primes and let s azt 0 u be the multiplicatively closed set generated by p 1 pn a a s 1 a xapp 1 q x xappnq b assume that appiq is a dvr 1 i n if s 1 a is a krull domain then a is a krull domain proof let x p s 1 axapp 1 q x xappnq since x p s 1 a we may write x a s where a p a and s p s are chosen in such a way that for each i satisfying pi s we have pi a if s r a then there exists i such that pi s so pi a since x p appiq we have x ai si for some ai p a and si p azppiq thus asi ais so pi pasiq where pi a and pi si a contradiction so s p a and hence x p a this proves a part b follows from part a and proposition 2 2 proposition 2 5 8 prop 6 1 a ring a is a ufd if and only if it is a krull domain satisfying clpaq 0 2 2 2 nagata s criterion let a be an integral domain it is well known that if a is a ufd then every localization of a is a ufd a partial converse is given by nagata recall that an integral domain is atomic if every nonzero element factors as a finite product of irreducible elements recall also that every krull domain is atomic theorem 2 6 let a be an integral domain and s a a multiplicatively closed set generated by a set of prime elements 0 r s assume that s 1 a is a ufd if a is an atomic domain then a is a ufd nagata s original formulation assumed a to be noetherian 20 lemma 2 samuel extended it to the case a is a krull domain 21 corollary to theorem 6 3 then kaplansky generalized it to the case where a satisfies the accp 13 theorem 177 the version of the criterion stated above together with an elementary proof is due to cohn 2 11 3 theorem 5 2 3 samuel s criterion recall that in an integral domain a elements a b p azt 0 u are rela tively prime if aax ba aba theorem 2 7 21 proposition 7 6 assume that a is an integral domain and a b p azt 0 u are relatively prime let arxs ar 1 s and a 1 arxs pax bq and consider the subring arb as of fracpaq a the kernel of the a surjection arxs arb as x b a equals pax bq consequently pax bq is a prime ideal of arxs and a 1 arb as b if a is a noetherian normal domain and aa and aa ba are prime ideals then a 1 is a noetherian normal domain and clpa 1 q clpaq c if a is a noetherian ufd and aa and aa ba are prime ideals then a 1 is a noetherian ufd the statement of this result in samuel s paper does not assume a b 0 but this was clearly an oversight since the result is not generally true if a 0 or b 0 part a of this theorem is somewhat stronger than samuel s original formulation it states the full consequences of samuel s proof we also need lemma 2 8 assume that a is an integral domain and f g p azt 0 u are relatively prime a fm and gn are relatively prime for each pair of integers m n 1 b f and g fh are relatively prime for each h p a such that g fh 0 c given h p a if gh p fa then h p fa d let b be an integral domain containing a if b is a free a module then f and g are relatively prime in b the reader can easily verify parts a b and c of this lemma part d is 9 lemma 2 46 note that part d includes the case b arns for some n 1 2 4 prime avoidance the following lemma represents an instance of the prime avoidance lemma 1 lemma 2 9 given n p n and a 1 an b c p z with gcdpa 1 an b cq 1 there exist m 1 mn p z with gcdpc b m 1 a 1 mnanq 1 proof the lemma is clearly true if c 1 so assume that c 2 let pa 1 anq dz and let p 1 ps be the distinct prime factors of c s 1 suppose that b dz p 1 z y y psz let tp 1 psu s 1 y s 2 where elements of s 1 divide b and elements of s 2 do not divide b by hypothesis s 1 set i ppsi pz i 1 2 and let b d where is the product of the elements of s 2 then b p 1 and by hypothesis either p 1 or p 2 if p 1 then d p 1 implies d p 1 a contradiction since gcdpd b cq 1 if p 2 then b p 2 also a contradiction 1 see for example www math lsa umich edu hochster 615 w 17 supdim pdf 3 therefore b dz is not contained in p 1 zy ypsz pick an element b n i 1 miai not in s j 1 pjz where mi p z then gcd c b n i 1 miai 1 2 5 z gradings lemma 2 10 let a be an integral domain with a non trivial z grading and let be a nonzero homogeneous element of a there exist homogeneous elements f p azt 0 u and w p a f such that af paf q 0 rw w 1 s paf q r 1 s 0 where paf q 0 denotes the subring of af of degree zero elements proof let d gcd i p z ai 0 and note that d 0 because the grading is not trivial there exist homogeneous elements a b p azt 0 u such that degpaq degpbq d define f ab p azt 0 u and w a b then w p a f and w is homogeneous of degree d given any homogeneous x p af we have degpxq id for some i p z so x w i p paf q 0 and hence x p paf q 0 rw w 1 s showing that af paf q 0 rw w 1 s since degpwq 0 w is algebraically independent over paf q 0 so paf q 0 rw w 1 s paf q r 1 s 0 3 criteria for a ring to be a ufd 3 1 first criterion let a be an integral domain and let pa bq p a 2 define the set p pa pa bqq set of prime elements p of a satisfying a p pa and pa ba a the pair pa pa bqq is said to satisfy condition p if it satisfies each of the following four conditions p i a b are nonzero and relatively prime and a is either a unit or a product of primes of a p ii pa ba is a prime ideal for every p p p pa pa bqq p iii q r pa ba for every non associate pair p q p p pa pa bqq p iv i 0 ppa baq i p 0 q for every p p p pa pa bqq note that if a is a power of a prime then condition p iii is satisfied since there are no non associate pairs p q p p pa pa bqq in this case the following generalizes theorem 2 7 theorem 3 1 let a be a krull domain let pa bq p a 2 and define the ring a 1 arxs pax bq where arxs ar 1 s assume that pa pa bqq satisfies condition p a a 1 is a krull domain and clpa 1 q clpaq b a 1 is a ufd if and only if a is a ufd several preliminaries are needed for the proof of this theorem recall that if w is an ideal of a ring a and t p a one defines the ideal pw tq by pw tq x p a tx p w notation 3 2 any triple pb s tq of elements of a ring a determines an ideal w pb s tq of a defined as follows first define sequences jn and wn of ideals of a n 0 by setting w 0 a j 0 pw 0 tq a and wi bji 1 s ia ji pwi tq for all i 1 then wi 1 wi and ji 1 ji for each i 0 set w pb s tq i 0 wi lemma 3 3 let a be a domain a b p azt 0 u relatively prime and let s t p a be such that a st and s t are relatively prime let arxs ar 1 s and i pax bqarxs then the following are equivalent a i 0 ps iarxs iq i b a x i 0 ps iarxs iq 0 4 moreover ax i 0 ps iarxs iq w pb s tq proof since i x a 0 it is clear that a implies b to prove the converse suppose that b is true and consider f p i 0 ps iarxs iq by the division algorithm there exist n 0 q p arxs and r p a such that anf pax bqq r note that r pax bqq anf where both ax b and f belong to i 0 ps iarxs iq so r p a x i 0 ps iarxs iq since b is true we have r 0 so anf pax bqq since a b are relatively prime lemma 2 8 implies an q in arxs so f p i proving that a is true this shows that a and b are equivalent to prove that ax i 0 ps iarxs iq w pb s tq consider an element r p ax i 0 ps iarxs iq fix n 0 and let us prove that r p wn we have r pax bqu snv for some u v p arxs write u 8 i 0 uix i and v 8 i 0 vix i where ui vi p a for all i 0 and ui 0 vi for i 0 then 1 bu 0 s nv 0 r and aui 1 bui s nvi 0 for all i 0 we claim 2 si ui for all i p t 0 nu we proceed by induction on i the case i 0 being obvious assume that i is such that 0 i n and si 1 ui 1 then 1 implies that s i bui so s i ui this proves 2 define pu 1 0 u 1 nq p a n 1 by u 1 i ui s i 0 i n dividing the second part of 1 by si gives 3 tu 1 i 1 bu 1 i s n ivi 0 for all i p t 1 nu by descending induction on i we shall now prove that 4 u 1 i p jn i 1 for all i p t 0 n 1 u since u 1 n 1 p a j 0 the case i n 1 of 4 is true if i is such that 0 i n 1 and u 1 i p jn i 1 then 3 gives tu 1 i 1 bu 1 i s n ivi p bjn i 1 s n ia wn i so u 1 i 1 p pwn i tq jn i this proves 4 it follows that u 0 u 1 0 p jn 1 and consequently that r bu 0 s nv 0 p bjn 1 s na wn since n is arbitrary r p w pb s tq this shows that a x i 0 ps iarxs iq w pb s tq for the reverse inclusion consider an element r p w pb s tq fix n 0 and let us prove that r p snarxs i it is convenient to define j 1 a and to note that the relations wi bji 1 s ia and ji pwi tq are also valid for i 0 we first prove that assertions pp 0 q ppnq are true where for each j p t 0 nu we define ppjq there exist pu 1 0 u 1 jq pv 0 vjq p a j 1 satisfying paq r bu 1 0 snv 0 pbq if j 0 then tu 1 i 1 bu 1 i s n ivi 0 for all i p t 1 ju pcq u 1 j p jn j 1 since r p w pb s tq we have r p wn bjn 1 s na and so we can choose u 1 0 p jn 1 and v 0 p a such that r bu 1 0 snv 0 so pp 0 q is true consider j p t 1 nu such that ppj 1 q is true then we have pu 1 0 u 1 j 1 q pv 0 vj 1 q p a j satisfying the above conditions since u 1 j 1 p jn j pwn j tq we have tu 1 j 1 p wn j bjn j 1 s n ja so we can choose u 1 j p jn j 1 and vj p a such that tu 1 j 1 bu 1 j s n jvj 0 then pu 1 0 u 1 jq pv 0 vjq p a j 1 satisfy the requirements of ppjq by induction it follows that pp 0 q ppnq are true since ppnq is true there exist pu 1 0 u 1 nq pv 0 vnq p a n 1 satisfying r bu 1 0 snv 0 and 3 then pax bq n 1 i 0 u 1 is ix i sn bu 1 nx n n i 0 vix i r so r p snarxs i and we are done lemma 3 4 let a be a ring and b s t p a a if t p i 0 pba s iaq then w pb s tq i 0 pba s iaq b if ba sa ta a or if b s t is an a regular sequence then w pb s tq i 0 pba saq i 5 proof a if t p i 0 pba s iaq then one can prove by induction that wi ba s ia and ji a for all i 0 so the conclusion follows b let j ba sa observe that if the condition 5 pji tq ji for all i 0 is satisfied then it follows by induction that wi j i ji for all i 0 from which we get the desired conclusion so it s enough to prove 5 if ba sa ta a then ji ta a for all i 0 so 5 is true and we are done so we may assume that b s t is an a regular sequence also the case i 0 of 5 is trivially true and the case i 1 is an immediate consequence of the fact that b s t is an a regular sequence by part i of thm 27 on page 98 of 16 it suffices to prove that b s is an a quasiregular sequence the fact that b s is a quasiregular follows from part ii of the same theorem together with the fact that b s is an a regular sequence proof of theorem 3 1 assume that pa pa bqq satisfies p then a 1 is an integral domain by theo rem 2 7 and a is a subring of a 1 we may assume that a r a otherwise the claim is trivial so by p i a is a nonempty product of primes let p p pa pa bqq and let q be the set of primes p p a such that a p pa note that p q if p p q then a 1 pa 1 arxs pax b pq a ppa baqrxs pa ppa baqq r 1 s therefore if p p p then p is a prime element of a 1 and if p p qzp then p is a unit of a 1 let s t be the multiplicative sets of a generated by p and q respectively since a p t we have t 1 a 1 t 1 a since qzp a 1 we have s 1 a 1 t 1 a 1 thus s 1 a 1 t 1 a therefore by proposition 2 3 s 1 a 1 is a krull domain since a is a krull domain the set tpa p p p u is finite consequently tpa 1 p p p u is finite by proposition 2 4 if a 1 ppq is a dvr for each p p p then a 1 is a krull domain we thus need to show 6 i 0 pia 1 p 0 q for every p p p let i pax bqarxs for each p p p define elements sppq and tppq of a by the conditions a sppq tppq sppq is a power of p and tppq r pa given p p p the condition i 0 p ia 1 p 0 q is equivalent to i 0 sppq ia 1 p 0 q which is equivalent to i 0 psppq iarxs iq i which by lemma 3 3 is equivalent to w pb sppq tppqq p 0 q so condition 6 is equivalent to 7 w pb sppq tppqq p 0 q for every p p p we show that condition p iii implies that w pb sppq tppqq i 0 ppa baq i for every p p p by condition p iv this suffices to prove 6 given p p p let s sppq and t tppq in view of lemma 3 4 b and of the fact that i 0 ppa baqi i 0 psa baqi it suffices to show that ba sa ta a or b s t is an a regular sequence assume that ba sa ta a and let us prove that b s t is a regular since s pe for some e 1 it suffices to show that b p t is a regular see 16 thm 26 p 96 note that p ba pa is a prime ideal because p p p and p ii is true since t r a because ba sa ta a and since a is a product of primes we have t q 1 qn for some q 1 qn p q if qi p p then qi r p by condition p iii if qi p qzp then qia p qia ba a so again qi r p so t r p clearly a b a multiplication by b is injective since p is prime and p b a ba p a ba is injective since p is a prime ideal and t r p a p t a p is injective so b p t is a regular and equation 6 is confirmed therefore a 1 ppq is a dvr for each p p p and a 1 is a krull domain in addition by proposition 2 3 clpaq clpt 1 aq clps 1 a 1 q clpa 1 q 6 this proves assertion a and assertion b follows immediately from a and proposition 2 5 corollary 3 5 let a be a noetherian ufd and let pa bq p a 2 define the ring a 1 arxs pax bq where arxs ar 1 s if pa pa bqq satisfies p i and p ii then a 1 is a noetherian ufd proof as in the proof of theorem 3 1 a 1 is an integral domain each p p p pa pa bqq is prime in a 1 and s 1 a 1 t 1 a since a 1 is noetherian it follows by nagata s criterion that a 1 is a ufd 3 2 second criterion theorem 3 6 consider krull domains a b such that b is finitely generated as an a module there exist group homomorphisms i clpaq clpbq and n clpbq clpaq such that n i clpaq clpaq is the map n with n rfracpbq fracpaqs bourbaki gives a proof of the special case of this theorem where a and b are assumed to be noetherian see 1 chap vii 4 n 8 being unable to find a reference for the theorem in its general form we give a proof in fact our proof is essentially the one given in bourbaki the following pargraphs are preparatory we use the notations introduced in paragraph 2 1 consider krull domains a b such that b is finitely generated as an a module letk fracpaq and l fracpbq and let n rl ks then for each p p ppbq we have p x a p ppaq moreover for each p p ppaq the set p p ppbq p x a p is nonempty and by thm 2 1 c finite and bp p p ppbq and p x a p is the set of all valuation rings r of l satisfying r x k ap caution if p p ppbq and p p x a then the map vp l z is not an extension of the map vp k z because both vp and vp are normalized by convention i e vppk q z and vppl q z however there exists a positive integer epp pq such that the valuation v 1 p 1 epp pq vp l 1 epp pq z is an extension of vp the number epp pq is the ramification index of v 1 p over vp and we have vppxq epp pqvppxq for all x p k we shall also consider the residual degree fpp pq of v 1 p over vp i e fpp pq r ppq ppqs where ppq bp pbp and ppq ap pap also note that v 1 p p p ppbq and p x a p is a complete system of extensions of vp to l given p p ppaq we write p p as an abbreviation for p p ppbq and p xa p consider the norm nl k l k we claim for each p p ppaq we have p p epp pqfpp pq n 8 for each x p l and p p ppaq we have vp nl kpxq p p fpp pqvppxq 9 where p p means ppx with x p p ppbq p xa p indeed let p p ppaq then ap bp are krull domains and bp is finitely generated as an ap module let q denote the maximal ideal of ap so ppapq tqu the valuations v 1 q 1 epq qq vq with q p ppbpq constitute a complete system of extensions of vq vp to l since bp is the integral closure of ap in l and bp is finite over ap 1 chap vi 8 n 5 thm 2 implies that qpppbpq epq qqfpq qq n and cor 3 of that theorem implies that for all x p l vq nl kpxq qpppbpq epq qqfpq qqv 1 qpxq qpppbpq fpq qqvqpxq the rule q qxb defines a bijection ppbpq p p ppbq pxa p and for each q p ppbpq if we define p q xb then epq qq epp pq fpq qq fpp pq and vqpxq vppxq this proves 8 and 9 we now proceed with the proof of theorem 3 6 7 proof let a b be krull domains such that b is a finitely generated a module let k fracpaq l fracpbq and n rl ks define the map i ppaq divpbq ippq p p epp pqp for each p p ppaq extend i to a group homomorphism i divpaq divpbq by 1 chap vii 1 n 10 prop 14 we have ipdivapxqq divbpxq for all x p k so i induces a group homomorphism i clpaq clpbq define a map n ppbq divpaq by declaring that if p p ppbq and p p x a then nppq fpp pqp extend n to a homomorphism of groups n divpbq divpaq we claim 10 n divbpxq diva nl kpxq for each x p l indeed let x p l and let ppbq ppaq be the map p p xa then n divbpxq n ppppbq vppxqp ppppbq vppxqnppq ppppbq vppxqfpp ppqq ppq ppppaq p p vppxqfpp pqp ppppaq vp nl kpxq p diva nl kpxq where the penultimate equality is 9 so 10 is true and consequently n induces a group homo morphism n clpbq clpaq for each p p ppaq we have npippqq n p p epp pqp p p epp pqnppq p p epp pqfpp pqp np by 8 so n i divpaq divpaq is multiplication by n and consequently n i clpaq clpaq is multiplication by n as a corollary to this theorem we give the following descent property for integral extensions corollary 3 7 consider s r t where r is a krull domain and s t are ufds assume that s and t are finitely generated r modules and that the integers rfracpsq fracprqs and rfracpt q fracprqs are relatively prime then r is a ufd proof by proposition 2 5 we have clpsq 0 clpt q and it suffices to show that clprq 0 let s rfracpsq fracprqs and t rfracpt q fracprqs so gcdps tq 1 by theorem 3 6 there exist group homomorphisms f clprq clpsq g clpsq clprq f clprq clpt q g clpt q clprq such that pg fqp q s and pg f qp q t for every p clprq then s t 0 and hence 0 for every p clprq i e clprq 0 and r is a ufd 3 3 third criterion the following criterion generalizes samuel 21 thm 8 1 theorem 3 8 let a be an integral domain f p azt 0 u and c 0 an integer and define the ring b arzs pzc f q where arzs ar 1 s assume that there exists a z grading of a such that f is homogeneous and gcdpc degf q 1 then b is an integral domain and fracpbq fracpaq moreover if f is prime in a then the following hold a a is a krull domain if and only if b is a krull domain b assume that a b are krull domains then clpbq is a direct summand of clpaq clpaq and clpaq is a direct summand of clpbq clpbq moreover if one of clpaq clpbq is finitely generated then clpaq clpbq 8 c a is a ufd if and only if b is a ufd remark 3 9 in theorem 3 8 the assertion fracpbq fracpaq does not mean that the canonical map a b extends to an isomorphism of the fields of fractions actually the canonical map extends to an embedding fracpaq fracpbq that satisfies rfracpbq fracpaqs c remark 3 10 let g be the z grading of a in theorem 3 8 and let degg f extend the z grading c g of a to a z grading g 1 of arzs by letting z be homogeneous of degree then zc f is g 1 homogeneous and the quotient b arzs pzc f q arzs has the z grading induced by g 1 this z grading of b has the property that z p b is homogeneous of degree for the proof we need the following facts the proof of each of the first two lemmas is straight forward and left to the reader lemma 3 11 let r be an integral domain rrx ys rr 2 s p r and a b p z positive and relatively prime then rrx ys pxayb q rrz z 1 s rr 1 s where z xn ym for integers m n with am bn 1 lemma 3 12 let pg q be an abelian group and w ipgwi a g graded ring given any group homomorphism g w 0 the map w w defined by ipg wi ipg piqwi where wi p wi is an automorphism of w both as a g graded ring and as a w 0 algebra notation 3 13 let g h be abelian groups if n p zzt 0 u we write g n h as an abbreviation for there exist group homomorphisms g h g such that g g is the multiplication by n we write g h as an abbreviation for for each r p zzt 0 u there exists n p zzt 0 u such that gcdpn rq 1 and g n h we write rank 0 pgq for the torsion free rank of g i e the dimension of the q vector space q bz g lemma 3 14 let g h be abelian groups a if there exists n p zzt 0 u such that g n h then rank 0 pgq rank 0 phq b if there exist m n p zzt 0 u such that g m h g n h and gcdpm nq 1 then g is a direct summand of h h in particular if g h then g is a direct summand of h h c assume that there exist relatively prime integers n r 0 satisfying g n h and rg 0 then g is a direct summand of h d assume that one of g h is finitely generated if g h and h g then g h proof a consider homomorphisms g h g such that g g is the multiplication by n then we have qbzg 1 qbzh 1 qbzg where 1 1 qbzg qbzg is the multiplication by n so 1 1 is an automorphism of q bz g so 1 is injective and rank 0 pgq rank 0 phq b for each i p tm nu let g i h i g be homomorphisms such that i i g g is the multiplication by i choose a b p z such that am bn 1 and define g 1 h h 1 g by declaring that 1 pgq p mpgq npgqq for all g p g and 1 px yq a mpxq b npyq for all x y p h then 1 1 is the identity map of g so g is a direct summand of h h c consider g h g such that g g is the multiplication by n choose u v p z such that un vr 1 and define 1 h g by 1 pyq u pyq for all y p h then x unx for all x p g so 1 is the identity map of g so g is a direct summand of h d the hypothesis together with b implies that g is a direct summand ofh h andh is a direct summand of g g so both g h are finitely generated by part a we have rank 0 pgq rank 0 phq 9 so it suffices to show that t pgq t phq where t pgq denotes the torsion subgroup of g since g t pgq is an additive functor we have t pgq n t phq for each n satisfying g n h so we have t pgq t phq and by symmetry t phq t pgq since t pgq is a finite group there exists an integer r 0 satisfying rt pgq 0 by c t pgq is a direct summand of t phq by symmetry t phq is a direct summand of t pgq since t pgq t phq are finite they are isomorphic proof of theorem 3 8 let degpf q with respect to the given z grading of a with no loss of generality we may assume that 0 if 0 then c 1 and b a in which case the result is trivial so we shall assume throughout that 0 let us first show that zc f is an irreducible element of krzs where k fracpaq in view of 15 theorem 9 1 it suffices to show that f cannot be written in the form f n d with p k n p zzt 0 u and d 1 a divisor of c by contradiction suppose that f is written in that form write u v where u v p a then fv d nud which implies that d since d c d 1 and gcdpc q 1 we have a contradiction so zc f is an irreducible element of krzs now let be an element of an algebraic closure of k satisfying c f then zc f is the minimal polynomial of over k consider the surjective a homomorphism arzs ar s defined by pzq clearly pzc f qarzs ker consider an element gpzq p ker by the division algorithm there exist qpzq rpzq p arzs such that gpzq qpzqpzc f q rpzq and degz rpzq c then rp q 0 since z c f is the minimal polynomial of over k we have rpzq 0 so gpzq qpzqpzc f q p pzc f qarzs thus ker pzc f qarzs and consequently b arzs pzc f q is isomorphic to ar s so b is a domain moreover the above argument shows that rfracpbq fracpaqs c by lemma 2 10 there exist homogeneous f p fazt 0 u and x p paf q where the z grading of a is extended to af such that af paf q 0 rx x 1 s paf q r 1 s 0 interchanging x and x 1 if necessary we have deg x e where we define e gcd i p z ai 0 since f is homogeneous of degree there exists p paf q 0 such that f x e in af since f f we have f p a f so p a f and consequently is a unit of paf q 0 note that the canonical homomorphism arzs b is injective on a let z pzq so that b arzs let m n p z be such that cm p eqn 1 by lemma 3 11 we see that bf af rzs pz c f q paf q 0 rx x 1 zs pzc x eq paf q 0 rx x 1 zs ppx 1 q ezc q paf q 0 rx y y 1 s paf q 0 ry y 1 s paf q r 1 s 0 af where y znxm so bf af and in particular fracpbq fracpaq this proves the first assertion since b zb a fa it is clear that f is prime in a if and only if z is prime in b until the end of the proof we assume that f is prime in a and z is prime in b a choose integers s t 0 such that sc 1 pmod q tc 1 pmod q and gcdps tq 1 for instance first choose s 0 such that sc 1 pmod q and let t s let u and v be indeterminates over b and define s bru s pus zq brus and t brv s pv t zq brvs note that gcdps q 1 and that by remark 3 10 there is a z grading of b such that z is homogeneous of degree this allows us to apply the first part of the proof to s and conclude that s is a domain and rfracpsq fracpbqs s similarly t is a domain and rfracpt q fracpbqs t also define brqs pqst zq brqs where brqs br 1 s since gcdpst q 1 is a domain then 10 srxs pxt uq t ry s py s vq and we have the commutative diagram of integral domains t a b 55 s 55 where all homomorphisms are injective the fact that gcdps tq 1 implies that s x t b taking the intersection in indeed this follows by considering that brqs is a free b module with basis t 1 q qst 1 u and that s brqts and t brqss are free b modules with bases tqtius 1 i 0 and tq siut 1 i 0 respectively since f zc usc we see that s arus aru s pusc f q let w aru u 1 s ar 1 s the z grading of a extends to a z grading of w in which u is homogeneous of degree 0 and w 0 a 0 ru u 1 s since sc 1 pmod q there exists d p z such that sc d 1 consider the group homomorphism z w 0 piq udi and the corresponding automorphism w w defined in lemma 3 12 then pusc f q usc ud f ud pu f q where ud p w so maps the principal ideal pusc f qw onto the principal ideal pu f qw so induces an isomorphism in su w pusc f q w pu f q af therefore su af since t satisfies tc 1 pmod q the same argument shows that tv af assume that a is a krull domain since su af su is a krull domain by proposition 2 3 in addition since s us a fa u is prime in s as an a module we have s a au ausc 1 choose h p ipn u is and write h h 0 h 1 u hsc 1 u sc 1 for hj p a by hypothesis h p uscis f is f ia f iau f iausc 1 for each i p n therefore hj p f ia for each j 0 sc 1 and each i p n since a is a krull domain hj 0 for each j 0 sc 1 so h 0 therefore i uis p 0 q since u is prime in s it follows that spuq is a dvr by proposition 2 4 s is a krull domain so t is a krull domain by the same argument and b s x t is a krull domain by proposition 2 2 this shows that if a is a krull domain then so is b conversely assume that b is a krull domain since s bru s pus zq brus and gcdps q 1 the above argument shows that s is a krull domain as u is prime in s we get j ujs 0 using usc f we see that i f ia j ujs 0 so apf q is a dvr we also know that af is a krull domain because su af by proposition 2 4 a is a krull domain this proves a but let us also observe that since su af where u is prime in s and f is prime in a proposition 2 3 implies that clpsq clpsuq clpaf q clpaq b assume that a b are krull domains the proof of a shows that if s p z satisfies s 0 and sc 1 pmod q then s bru s pus zq is a krull domain and a finite b module such that rfracpsq fracpbqs s and clpsq clpaq by theorem 3 6 there exist group homomorphisms clpbq clpsq clpbq whose composition clpbq clpbq is multiplication by s this means that clpbq s clpsq see notation 3 13 and since clpsq clpaq we have in fact shown that clpbq s clpaq for every integer s 0 satisfying sc 1 pmod q it follows that 11 clpbq clpaq 11 indeed let r p zzt 0 u choose any s 0 p z such that s 0 c 1 pmod q since gcdp s 0 rq 1 lemma 2 9 implies that there exists m p z satisfying gcdpr s 0 m q 1 then for n large enough the number s s 0 m n r satisfies s 0 gcdps rq 1 and sc 1 pmod q so gcdps rq 1 and clpbq s clpaq this proves 11 note that 11 says that we have clpbq clpaq for any pair of rings pa bq that satisfies the hypotheses of assertion b let s p z be such that s 0 and sc 1 pmod q and consider s bru s pus zq then in view of remark 3 10 the pair pb sq satisfies the hypotheses of assertion b so 11 implies that clpsq clpbq it follows that clpaq clpbq because clpsq clpaq was noted at the beginning of the proof of b thus clpaq clpbq and clpbq clpaq now assertion b follows from lemma 3 14 assertion c is an immediate consequence of a b and proposition 2 5 corollary 3 15 let r be a ufd a 1 an p nzt 0 u and rrx 1 xns r rns where n 3 assume that one of the following holds 1 n 4 and gcdpan a 1 an 1 q 1 2 n 3 and a 1 a 2 a 3 are pairwise relatively prime then the ring rrx 1 xns px a 1 1 xann q is a ufd proof let a rrx 1 xn 1 s and define f p a by f x a 1 1 x an 1 n 1 the conditions on the ai imply that f is irreducible in fracprqrx 1 xn 1 s and it follows easily that f is irreducible in a let lcmpa 1 an 1 q and let a have the z grading over r for which xi is homogeneous of degree ai then f is homogeneous of degree and gcdp anq 1 theorem 3 8 implies that rrx 1 xns px a 1 1 xann q arzs pz an f q is a ufd 3 4 fourth criterion theorem 3 16 let a be a z graded integral domain let a b p azt 0 u be relatively prime and let n 0 be such that gcdpn deg b deg aq 1 let arzs ar 1 s a pazn bq is a prime ideal of arzs b assume that a is a noetherian ufd if b is prime in a and pa pa bqq satisfies p ii then b arzs pazn bq is a ufd and fracpbq fracpaq proof extend the z grading to arxs ar 1 s so that x is homogeneous and degx deg b deg a then ax b is homogeneous and the ring a 1 arxs pax bq is z graded write a 1 arxs where x is the canonical image of x in a 1 in particular x 0 then x is homogeneous and deg x deg b deg a it follows by theorem 2 7 that a 1 is an integral domain it is also clear that fracpa 1 q fracpaq we have b arx zs pax b zn xq a 1 rzs pzn xq since gcdpn degpxqq 1 theorem 3 8 implies that b is an integral domain this proves part a assume that the hypotheses of part b hold then pa pa bqq satisfies ppiq and since a is a ufd a 1 is a ufd by corollary 3 5 since a 1 xa 1 a ba we see that x is a prime element of a 1 so theorem 3 8 implies that b a 1 rzs pzn xq is a ufd and that fracpbq fracpa 1 q fracpaq so part b is proved 3 5 fifth criterion theorem 3 17 let a ipzai be a z graded integral domain and let f p a zt 0 u p z let arz 1 zns a rns for n 1 and let e 1 en 1 be integers such that gcdpe 1 en q 1 a pze 1 1 zenn f q is a prime ideal of arz 1 zns 12 b define b arz 1 zns pz e 1 1 zenn f q if a is a noetherian ufd and f is prime in a then b is a ufd and fracpbq fracpaqpn 1 q proof we may assume that n 1 otherwise both parts of the claim follow from theorem 3 8 by lemma 2 9 there exist m 1 mn 1 p z so that gcdpen pm 1 e 1 mn 1 en 1 qq 1 extend the z grading of a to a z grading of r arz 1 zn 1 s by declaring that zi is homo geneous of degree mi noting that r is an integral domain define a b p r by a z e 1 1 z en 1 n 1 and b f then a and b are nonzero elements of r with ar x br abr and deg b and deg a m 1 e 1 mn 1 en 1 since gcdpen deg b deg aq 1 theorem 3 16 a implies that pazenn bq pz e 1 1 zenn f q is a prime ideal of arz 1 zns this proves part a assume that the hypotheses of part b hold note that r is a noetherian ufd it is easy to check that b is prime in r b a in r and for each i p t 1 n 1 u pzi bq is a prime ideal of r so theorem 3 16 b implies that b is a ufd and that fracpbq fracprq fracpaqpn 1 q 4 application i rational ufds of dimension three 4 1 a family of three dimensional affine ufds the following lemma generalizes lemma 10 15 in 8 and lemma 2 in 4 lemma 4 1 let d be an integral domain n 0 u 1 un p d rn drz 0 zns d rn 1 s and a 1 an b 1 bn positive integers such that gcdpai b 1 biq 1 for each i p t 1 nu then in pu 1 z a 1 1 zb 1 0 unz an n z bn n 1 q is a prime ideal of rn and zn r in proof we proceed by induction on n the case n 0 being clear i 0 p 0 q r 0 drz 0 s let n 1 and assume that in 1 is a prime ideal of rn 1 drz 0 zn 1 s and that zn 1 r in 1 define a z grading of rn 1 over d for which zi is homogeneous of degree b 1 biai 1 an 1 0 i n 1 then the quotient ring a rn 1 in 1 is a z graded integral domain let f p a be the image of zbnn 1 since zn 1 r in 1 and in 1 is prime we have z bn n 1 r in 1 and hence f 0 note that degf b 1 bn by hypothesis gcdpan degf q 1 therefore by theorem 3 8 a the ring arzs pzan u 1 n f q rn in is an integral domain so in is prime if zn p in then the image of z in arzs pz an u 1 n f q is zero which is not the case because f 0 so zn r in and the proof is complete theorem 4 2 let k be a noetherian ufd n p n krz 0 zn 1 s k rn 2 s ui vi p k and ai bi positive integers such that gcdpai b 1 biq 1 1 i n define the ring an krz 0 zn 1 s pfizi 1 uiz ai i viz bi i 1 q 1 i n where f 1 fn p kzt 0 u and the set of prime factors of fi in k is the same for all i 1 n then an is a ufd and fracpanq fracpkrz 0 z 1 sq pfrackq p 2 q proof since fizi 1 uiz ai i viz bi i 1 vipv 1 i fizi 1 uiv 1 i z ai i z bi i 1 q we may assume each vi 1 let n krz 0 zn 1 s an be the standard surjection the restriction of n to k is injective to see this observe that the ideal pfizi 1 uiz ai i z bi i 1 q 1 i n of krz 0 zn 1 s is included in pz 0 zn 1 q and pz 0 zn 1 q xk t 0 u so k an let pk be the set of prime elements of k dividing some hence all fi if pk then f 1 fn are units of k and consequently an krz 0 z 1 s k r 2 s in which case the theorem is true so we may assume throughout that pk given p pk and m p t 0 nu define the ring qpm q pk kqrz 0 zms pu iz ai i z bi i 1 q 1 i m 13 where u i is the class of ui in k k by lemma 4 1 qpm q is an integral domain note that 0 in am because m is injective on k moreover am am krz 0 zm 1 s p fizi 1 uiz ai i z bi i 1 q 1 i m qpm qrzm 1 s qpm q r 1 s assuming that m n define hm p am by hm mpum 1 z am 1 m 1 z bm 1 m q then am p am hmamq krz 0 zm 1 s p uiz ai i z bi i 1 q 1 i m 1 qpm 1 q also note that hm r am indeed the image of hm in am am qpm qrzm 1 s qpm q r 1 s is not zero because it has the form uz am 1 m 1 c with u c p qpm q u 0 and am 1 0 we have shown that for each p pk the following two statements are true for each m p t 0 nu am is a nonzero prime ideal of am 12 for each m p t 0 n 1 u am hmam is a prime ideal of am and hm r am 13 by induction onm we proceed to show am is a ufd for allm 0 n since a 0 krz 0 z 1 s kr 2 s we have a basis for induction consider m p t 0 n 1 u such that am is a ufd let us prove the following assertions i fm 1 hm p amzt 0 u fm 1 am x hmam fm 1 hmam and fm 1 is a product of primes in am ii for each prime element p of am such that fm 1 p pam we have pam hmam p specam since pk we have fm 1 1 r for some 1 r p pk and r 1 by 12 each i is a prime element of am so fm 1 0 in am and fm 1 is a product of primes in am since hm r 1 am by 13 we have hm 0 in am actually 13 gives hm r iam for all i 1 r so fm 1 and hm are relatively prime in am and consequently fm 1 am x hmam fm 1 hmam this proves i to prove ii consider a prime element p of am satisfying fm 1 p pam then for some i we have p i in am since i is a prime element of am we have p u i for some u p a m so pam hmam iam hmam we have iam hmam p specam by 13 so ii is proved it follows from i and ii that pam pfm 1 hmqq satisfies the conditions p i and p ii stated just before theorem 3 1 since am 1 amrzm 2 s pfm 1 zm 2 hmq corollary 3 5 implies that am 1 is a ufd by induction we obtain that a 0 an are ufds since an is in particular an integral domain the assertion fracpanq fracpkrz 0 z 1 sq pfrackq p 2 q is now clear let krxs kr 1 s for a field k ui vi p k and let p 1 pxq pnpxq p krxszt 0 u be such that each pipxq has the same set of prime factors define the affine k algebra 14 bn krxsrz 0 zn 1 s ppipxqzi 1 uiz ai i viz bi i 1 q 1 i n where a 1 an b 1 bn are positive integers such that gcdpai b 1 biq 1 for each i using k krxs in theorem 4 2 it follows that for each n 1 bn is an affine rational ufd of dimension 3 over k proposition 4 3 if pipxq r k and ai bi 2 for all i then the minimum number of generators of bn as a k algebra is n 3 proof it suffices to prove the case where k is algebraically closed let d be the minimum number of generators of bn over k then clearly d n 3 set x specpbnq a n 3 k affine n space over k for 1 i n let fi pipxqzi 1 uiz ai i viz bi i 1 let j be the jacobian matrix of pf 1 fnq namely j bfi bx bfi bzj 1 i n 0 j n 1 14 then j is a matrix of size n pn 3 q for 1 i n and 0 j n 1 we have bfi bx p 1 ipxqzi 1 and bfi bzj pipxq pj i 1 q uiaiz ai 1 i pj iq vibiz bi 1 i 1 pj i 1 q 0 potherwiseq for a maximal ideal m of bn we denote by jpmq the jacobian matrix at m that is jpmq bfi bx pmq bfi bzj pmq 1 i n 0 j n 1 where for g p bn gpmq means the image of g in bn m take a common prime divisor qpxq p krxs of p 1 pxq pnpxq which is possible since pipxq r k and each pipxq generates the same radical ideal in krxs let m be the maximal ideal of bn generated by qpxq z 0 zn 1 since ai bi 2 for each i we see that rankpjpmqq 0 hence we have dimkpm m 2 q pn 3 q rankpjpmqq n 3 therefore the dimension of the tangent space at m is n 3 which implies d n 3 example 4 4 in 4 the authors give the following rings let k be a field of characteristic zero and let p q be prime integers with p 2 q given n 0 define n krx z 0 zn 1 s xzi 1 z p i z q i 1 1 i n where x z 0 zn 1 are indeterminates over k then for each n 0 there exists a locally nilpotent derivation of kr 4 s with kernel isomorphic to n moreover proposition 4 3 shows that n is minimally generated by n 3 elements over k remark 4 5 one motivation to consider ufds of the type given in this section comes from the study of locally nilpotent derivations of polynomial rings crns for the field c of complex numbers the kernel a of such a derivation is a ufd of transcendence degree n 1 over c it is known that a is quasi affine 22 and fracpaq is ruled 6 that a crn 1 s if 1 n 3 18 and that a is generally non noetherian if n 5 3 10 for n 4 it is further known that a is rational 6 and that there can be no a priori bound on the number of generators needed 4 but the question whether a must be affine when n 4 or even noetherian is open we are thus led to study quasi affine rational ufds of transcendence degree 3 over c 4 2 a graded rational non noetherian ufd of dimension 3 let k be a field and let krx z 0 z 1 z 2 s be the polynomial ring in a countably infinite number of variables x zi i 0 define krx z 0 z 1 z 2 s px 2 i zi 1 zi z 2 i 1 qi 1 krx z 0 z 1 z 2 s where x zi denote the images of x zi under the standard surjection of onto for each n 1 define fn x 2 n zn 1 zn z 2 n 1 p n krx z 0 zn 1 s k rn 3 s since the ring displayed in 14 is a ufd hence a domain we see that the ideal in pf 1 fnq is a prime ideal of n let i be the ideal i pf 1 f 2 f 3 q then i n 1 in which implies that i is a prime ideal and is an integral domain in addition rx 1 s krx x 1 z 0 z 1 s krx x 1 sr 2 s fracp q kp 3 q define ideals in by p pz 0 z 1 z 2 q and m px z 0 q 15 lemma 4 6 m is a maximal ideal of and x and p are prime ideals properly contained in m in addition a zi z 2 i 0 p x for each i 1 and b zi r x for each i 0 proof define the subring r and maximal ideal j r by r krx zi z 2 i 1 si 1 and j px zi z 2 i 1 qi 1 then rrz 0 s r r 1 s and j x i it follows that x j pr jqrz 0 s krz 0 s k r 1 s x krz 0 s k r 1 s where z 0 is the image of z 0 in j and z 0 is the image of z 0 in x therefore x is a prime ideal and z 0 r x for each i 1 we have zi z 2 i 1 p x parts a and b now follow by induction since fi p pz 0 z 1 z 2 q for each i 1 we see hat p krxs kr 1 s and p is prime since m k m is maximal part a shows p m since neither x nor p is maximal their containment in m is proper define a z grading dpz d by letting x and each zi be homogeneous deg x 1 and deg zi 2 i a monomial p is of the form xr ipn z ei i for r ei p n note that each monomial is homogeneous and that the set of all monomials forms a multiplicative monoid define min i i xs i z i i s i p n given d p n let d i 0 di 2 i be its binary expansion where di p t 0 1 u for each i and di 0 for all but finitely many i define the function n d fd i 0 z di i since fd p d for d p n it follows that is injective note that since zi r x for all i 0 fd r x for all d p n lemma 4 7 given d p z the set bd tx mfn m n p n n m du is a k basis of d proof fix d p z suppose that c 1 x m 1 fn 1 csx msfns 0 for ci p k s 2 and distinct pmi niq p n 2 with ni mi d note that m 1 ms are distinct we may assume m 1 minimi then fn 1 p x in contradiction to the above stated property therefore elements of bd are k linearly independent let v d be the subspace spanned by bd we proceed by induction on to show that every monomial p d is in v from this it follows that v d let p d be a monomial where x r i z ei i and i ei if 0 then xrf 0 p v assume that p v whenever p d is a monomial with 0 if maxi ei 1 then xrfd r p v otherwise let em maxi ei 2 and write em 2 a b for integers a 1 and b p t 0 1 u let p zemm then pzemm pz b mpz 2 mq a p 1 qapzbmpx 2 m 1 zm 2 zm 1 q a p 1 qapzbm a j 0 a j xj 2 m 1 z j m 2 z a j m 1 p 1 qa a j 0 a j xj 2 m 1 pzbmz a j m 1 z j m 2 16 for each j we see that mj x j 2 m 1 pzbmz a j m 1 z j m 2 is a monomial in d and that mj p i m eiq b pa jq j i ei by the inductive hypothesis mj p v it follows that p v lemma 4 8 m 0 x m p 0 q proof since j m 0 x m is a graded ideal it suffices to show that j x d 0 for every d p z arguing by contradiction assume that 0 f p j x d for some d p z then by lemma 4 7 f i maxp 0 dq aix ifd i where ai p k for all i let m min i ai 0 then i m aix ifd i p xm 1 and since f p j f p xm 1 so xmfd m p x m 1 so fd m p x a contradiction theorem 4 9 is a ufd proof let q x by lemma 4 8 q is a discrete valuation ring since rx 1 s x q prop 2 4 implies that is a krull domain since rx 1 s is a ufd and x is prime it follows by nagata s criterion that is a ufd corollary 4 10 z 0 is a prime ideal properly contained in p proof since rx 1 s krx x 1 z 0 z 1 s krx x 1 sr 2 s z 0 is irreducible in rx 1 s since z 0 r x z 0 is irreducible in by theorem 4 9 is a ufd therefore z 0 is prime in the inclusion z 0 p is clear suppose that z 1 p z 0 then z 1 p z 0 rx 1 s where rx 1 s krx x 1 z 0 z 1 s krx x 1 sr 2 s which is not possible therefore z 0 p theorem 4 11 dim 3 and htpmq 3 consequently is not noetherian proof since fracp q kp 3 q we see that tr degkp q 3 since dim tr degkp q see for example 14 theorem 5 5 we have dim 3 since p 0 q z 0 p m is a chain of primes in it follows that htpmq 3 and dim 3 since m is generated by two elements it follows from the krull dimension theorem 7 theorem 10 2 that cannot be noetherian 5 application ii affine ufds defined by trinomial relations let k be a field assume that the following data are given d 1 an integer n 2 and partition n n 0 n 1 nr where r 2 and ni 1 for 0 i r this induces a partition of variables tij in the polynomial ring k rns krns krt 0 t 1 trs where ti tti 1 tiniu 0 i r d 2 a sequence 0 r where i p i 1 iniq p z ni 0 i r satisfy if di gcdp i 1 iniq 0 i r then d 0 dr are pairwise relatively prime this induces a sequence t 0 0 t rr p krt 0 trs of monomials t i i t i 1 i 1 t in i ini 0 i r d 3 a sequence of distinct elements 2 r p k theorem 5 1 given the data and notation in d 1 d 2 and d 3 above the ring b krt 0 trs pt 0 0 it 1 1 t i i q 2 i r is an affine rational ufd of dimension n r 1 over k and the image of t 0 0 t 1 1 in b is prime for each p k zt 2 ru 17 proof in a slight abuse of notation we use ti and tij to denote their images in b we proceed by induction on r define subrings b 1 b 2 br b by bm krt 0 tms pt 0 0 it 1 1 t i i q 2 i m note that b 1 krt 0 t 1 s k rn 0 n 1 s which is a rational ufd moreover it follows easily from theorem 3 17 a that t 0 0 t 1 1 is prime in b 1 for each p k this gives a basis for induction assume that for some m 2 b 1 bm 1 are rational ufds over k and that t 0 0 t 1 1 is prime in bm 1 for every p k zt 2 m 1 u let f t 0 0 mt 1 1 given i with 0 i m 1 suppose that di di 1 i 1 dini ini for dij p z put an n grading on bm 1 by letting tij be homogeneous with degptijq dijd 0 d i dm 1 then for each monomial t i i 0 i m 1 we have deg t i i degpt i 1 i 1 t in i ini q pdi 1 i 1 dini iniqpd 0 d i dm 1 q d 0 dm 1 therefore f is homogeneous and degf d 0 dm 1 since bm bm 1 rtms pt m m f q and gcdp m 1 mnm degf q 1 theorem 3 17 b implies that bm is a ufd and that fracpbmq fracpbm 1 q pnm 1 q since bm 1 is rational over k it follows that bm is rational over k given p k zt 2 mu let g t 0 0 t 1 1 and b m 1 bm 1 gbm 1 since g is a homogeneous prime of bm 1 it follows that b m 1 is a z graded integral domain we have bm gbm bm 1 rtms pt 0 0 t 1 1 t mm t 0 0 mt 1 1 q b m 1 rtms pt m m p m qt 1 1 q and theorem 3 17 a implies that this ring is an integral domain so g is prime in bm by induction it follows that br b is a rational ufd over k and t 0 0 t 1 1 is prime in b for each p k zt 2 ru example 5 2 in 19 mori classified affine ufds of dimension two over an algebraically closed field k which admit a nontrivial n grading each such ring is of the form krx y z 1 zn s px a iy b zcii q 1 i n where n 0 a b c 1 cn 2 are pairwise relatively prime and 1 1 n p k are distinct these rings conform to the data d 1 n n 2 r n 1 where t 0 x t 1 y and ti zi 1 2 i r d 2 0 a 1 b and i ci 1 2 i r d 3 i i 1 2 i r remark 5 3 a ufd b of the type presented in theorem 5 1 admits a non degenerate 2 grading by zn r when k is algebraically closed this means that the variety x specpbq admits a torus action of complexity one surfaces and threefolds of this type were classified by mori 19 and ishida 12 respectively more recently hausen herppich and su ss 11 classified all such varieties in terms of cox rings under the additional assumption that the characteristic of k is zero their description matches that given in theorem 5 1 in that when k is algebraically closed of characteristic zero every k affine rational ufd of dimension d that admits a non degenerate zd 1 grading is one of the rings of theorem 5 1 however our description uses simpler data aligning with mori s description for surfaces moreover theorem 5 1 is valid for any field k 6 a counterexample the bourbaki volume 1 includes the following exercise p 549 exercise 15 b vii 1 let a be a krull domain and a b two nonzero 3 elements of a such that aa and aa ab are prime and distinct show that arxs pax bq is a krull domain and that the divisor class group cparxs pax bqq is isomorphic to cpaq 2 let pg q be an abelian group and r ipg ri a g graded ring we say that the grading is non degenerate if i p g ri 0 is a generating set of g 3 the hypothesis that a b 0 appears in part a of the exercise 18 in this section we construct a counterexample to this assertion let k be a field of characteristic zero and let a krx ys kr 2 s define a sequence of integers spnq by sp 1 q 2 sp 2 q 3 and spnq n 1 i n 2 spiq for n 3 let arz 0 z 1 z 2 s be the polynomial ring in a countably infinite number of variables zi over a and define b arz 0 z 1 z 2 s pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 qi 1 theorem 6 1 the following properties hold a b is a non noetherian ufd of transcendence degree 4 over k the surjection of arz 0 z 1 s onto b is injective on a x y p b are non associated primes of b and xb yb is a maximal ideal b let brt s br 1 s the ring b 1 brt s pxt yq is an integral domain which does not satisfy the ascending chain condition on principal ideals the proof consists of the following series of lemmas lemma 6 2 let k be a field r a k algebra and r 1 r 2 r 3 finitely generated subalgebras of r such that r n 1 rn consider j 1 j 2 j 3 where for each n 1 jn is a prime ideal of rn then j n 1 jn is a prime ideal of r moreover consider the following conditions i there exists a positive integer d such that tr degkprn jnq d for all n 1 ii for each n 2 rn jn is an algebraic extension of the image of rn 1 rn jn ii 1 for each n 2 rn jn is a birational extension of the image of rn 1 rn jn then the following hold a if i and ii hold then j xrn jn and tr degkpr jq tr degkprn jnq for all n 1 b if i and ii 1 hold then j xrn jn and fracpr jq fracprn jnq for all n 1 proof it is clear that j is a prime ideal of r assume that i and ii hold and let us prove 15 for all m n such that 1 m n we have jn xrm jm it suffices to prove the case where m n 1 so fix n 2 and let rn 1 rn jn be the composition rn 1 rn rn jn assumptions i and ii give the first two equalities in tr degk rn 1 jn 1 tr degk rn jn tr degk prn 1 q tr degk rn 1 pjn xrn 1 q we have jn 1 jn x rn 1 where both jn 1 and jn x rn 1 are prime ideals of rn 1 so the equality tr degk rn 1 jn 1 tr degk rn 1 pjn x rn 1 q implies that jn 1 jn x rn 1 as desired this proves 15 it follows that 16 j xrn jn for all n 1 indeed consider f p j x rn then there exists n n such that f p jn so f p jn x rn jn by 15 so 16 is proved let s r j let r s be the canonical surjection and let sn prnq for each n 1 then 16 implies that sn rn jn for all n 1 moreover assumption ii implies that sn is an algebraic extension of sn 1 for every n 2 since s n 1 sn it follows that s is an algebraic extension of sn so tr degkpr jq tr degkprn jnq for all n 1 if i and ii 1 hold then all of the above is true and sn is a birational extension of sn 1 for every n 2 so s is a birational extension of sn so fracpr jq fracprn jnq for all n 1 lemma 6 3 the canonical map a b is injective b is a domain and fracb pfracaqp 2 q kp 4 q proof we use lemma 6 2 with r arz 0 z 1 s and for each n 1 rn arz 0 zn 1 s and jn pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 q n i 1 let j n 1 jn pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 qi 1 then r j b since j pz 0 z 1 q and pz 0 z 1 q x a p 0 q we have j x a p 0 q so a b is injective by the same argument a rn jn is injective for each n 1 19 fix n 1 for each i p t 1 nu let i be the a automorphism of rn defined by ipzi 1 q zi 1 xzi 1 y spi 1 q 1 z spi 1 q i and ipzjq zj for all j p t 0 n 1 uzti 1 u then n 1 maps jn onto pz 0 zn 1 q so rn jn a r 2 s so condition i of lemma 6 2 is satisfied write rn jn arz 0 zn 1 s where zi is the image of zi by the canonical surjection rn rn jn since a rn jn is injective we have x 0 in rn jn so xzn 1 y spn 1 q 1 z spn 1 q n zn 1 0 implies zn 1 p fracparz 0 znsq showing that rn jn is a birational extension of the image of rn 1 rn jn i e condition ii 1 of lemma 6 2 is satisfied by that lemma b is a domain and fracb fracprn jnq pfracaq p 2 q kp 4 q lemma 6 4 b xb is a domain of transcendence degree 2 over k proof we use lemma 6 2 with r arz 0 z 1 s and for each n 1 rn arz 0 zn 1 s and jn pxq pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 q n i 1 let j i 1 jn then b xb r j fix n 1 then jn pxq py spi 1 q 1 z spi 1 q i zi 1 q n i 1 if we write vi 1 y spi 1 q 1 z spi 1 q i zi 1 for i 1 n then rn krx y v 0 vn 1 zn zn 1 s and jn px v 0 vn 1 q so rn jn k r 3 s and jn is a prime ideal of rn of height n 1 it follows from lemma 6 2 that j is a prime ideal of r and hence that b xb is a domain let us prove 17 the composition kry z 0 s r r j b xb is injective to see this it s enough to show that kry z 0 sxj p 0 q so it s enough to show that kry z 0 sxjn p 0 q for all n 1 let n 1 if y p jn then we see that z 0 zn 1 p jn and x y p jn so htjn n 1 a contradiction so y r jn if z 0 p jn then using that jn is prime and that y r jn we see that z 0 zn p jn and x p jn so htjn n 1 a contradiction so z 0 r jn consider the k homomorphism rn kry z 0 s defined by pxq 0 pz 1 q pzn 1 q pyq y and pz 0 q z 0 if f is a nonzero element of kry z 0 s xjn write f z m 0 g where m p n g p kry z 0 s and z 0 g since jn is prime and z 0 r jn we have g p jn write g xg 0 n i 1 py spi 1 q 1 z spi 1 q i zi 1 qgi g 0 gn p rn and note that g pgq z 0 pg 1 q p z 0 kry z 0 s a contradiction this shows that f does not exist i e kry z 0 s x jn p 0 q so 17 is true write b xb kry z 0 z 1 s where zi is the canonical image of zi in r j b xb then yspi 1 q 1 z spi 1 q i zi 1 0 in b xb for all i 1 since y 0 in b xb it follows that zi is algebraic over kpy z 0 zi 1 q for all i 1 so fracpb xbq is an algebraic extension of kpy z 0 q we have kpy z 0 q k p 2 q by 17 so tr degkpb xbq 2 lemma 6 5 b yb is a domain and fracpb ybq kp 3 q proof we use lemma 6 2 with r arz 0 z 1 s and for each n 1 rn arz 0 zn 1 s and jn pyq pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 q n i 1 let j i 1 jn then b yb r j fix n 1 then jn pyq pxzi 1 zi 1 q n i 1 if we define vi 1 xzi 1 zi 1 for i 1 n then rn krx y v 0 vn 1 zn zn 1 s and jn py v 0 vn 1 q so rn jn k r 3 s and jn is a prime ideal of rn of height n 1 by lemma 6 2 j is a prime ideal of r so b yb is a domain note that x 0 in rn jn otherwise we would have x p jn so x y z 0 zn 1 p jn so htjn n 1 a contradiction write rn jn krx z 0 zn 1 s where zi is the canonical image of zi in rn jn since xzn 1 zn 1 0 and x 0 in rn jn we have zn 1 p kpx z 0 znq so condition ii 1 of lemma 6 2 is satisfied it follows that fracpb ybq fracprn jnq k p 3 q lemma 6 6 b is a ufd x y are prime elements of b such that x y and m xb yb is a maximal ideal of b 20 proof define l kpyq s kryszt 0 u al s 1 a lrxs and bl s 1 b then bl lrxsrz 0 z 1 z 2 s pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 qi 1 according to 5 the ring r lrxsrz 0 z 1 z 2 s pxzi 1 z spi 1 q i zi 1 qi 1 is a ufd let be the lrxs automorphism of lrxsrz 0 z 1 z 2 s defined by pziq yzi for all i 0 then maps the ideal pxzi 1 z spi 1 q i zi 1 qi 1 of lrxsrz 0 z 1 z 2 s onto the ideal pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 qi 1 of lrxsrz 0 z 1 z 2 s so bl l r and bl is a ufd write b krx y z 0 z 1 s where zi is the canonical image of zi in b then xzi 1 y spi 1 q 1 z spi 1 q i zi 1 0 in b for all i 1 since x 0 in b because a b is injective it follows that bx axrz 0 z 1 s since fracb kp 4 q by lemma 6 3 z 0 z 1 must be algebraically independent over a so bx a r 2 s x is a ufd next we claim that b bx xbl indeed define bn arzn zn 1 s for all n 0 since xzi 1 y spi 1 q 1 z spi 1 q i zi 1 0 for all i 1 we have zn p bn 1 and hence bn bn 1 for all n 0 this gives the filtration b n 0 bn since z 0 z 1 are algebraically independent over a and since z 0 z 1 p bn arzn zn 1 s for all n 0 zn zn 1 are algebraically independent over a and hence bn a r 2 s for all n 0 so bx n 0 axrzn zn 1 s and bl n 0 alrzn zn 1 s where axrzn zn 1 s a r 2 s x and alrzn zn 1 s a r 2 s l for all n 0 given f p bx x bl choose n 0 so that f p axrzn zn 1 s xalrzn zn 1 s and write f i j ijz i nz j n 1 i j ijz i nz j n 1 p ij p ax ij p alq by uniqueness of coefficients in fracpaqrzn zn 1 s fracpaq r 2 s we see that ij ij for each pair i j 0 so these coefficients belong to ax xal a so f p bn b and b bx xbl is proved since b is the intersection of two ufds it is a krull domain since x is prime in b and bx is a ufd it follows by nagata s criterion that b is a ufd since by lemma 6 4 and lemma 6 5 tr degkpb xbq 2 and tr degkpb ybq 3 the prime ideals xb and yb are nonzero and distinct so x y are prime elements of b and x y we have b m krx y z 0 z 1 s j where j px yq pxzi 1 y spi 1 q 1 z spi 1 q i zi 1 qi 1 px y z 0 z 1 q so b m k and m is a maximal ideal of b we continue to use the notation b krx y z 0 z 1 s where zi is the canonical image of zi in b lemma 6 7 we have 0 z 0 p n 1 m n moreover b is not noetherian proof for each i 1 we have xzi 1 y spi 1 q 1 z spi 1 q i zi 1 0 and hence zi 1 p mzi mzi 1 so z 0 p j 1 mzj and for each n 1 j 1 mnzj j 1 mnpmzj 1 mzj 2 q j 1 mn 1 zj it follows that z 0 p j 1 m nzj for all n 1 so z 0 p n 1 m n note that z 0 0 because fracpbq kpx y z 0 z 1 q k p 4 q since m is a proper ideal of the domain b the fact that n 1 m n p 0 q implies that b is non noetherian by the krull intersection theorem 7 corollary 5 4 21 lemma 6 8 let b 1 brt s pxt yq where brt s br 1 s then b 1 bry xs fracpbq and b 1 does not satisfy the ascending chain condition on principal ideals in particular b 1 is not a ufd proof by lemma 6 6 b is a ufd and x y p b are nonzero relatively prime elements by samuel s criterion theorem 2 7 b 1 is an integral domain isomorphic to bry xs since y p xb 1 lemma 6 7 shows that 0 z 0 p n 0 xnb 1 using that m is a proper ideal of b and that x y are relatively prime in b we find that x is not a unit of b 1 consequently b 1 does not satisfy the ascending chain condition on principal ideals so b 1 is not a ufd acknowledgments the work of the third author was supported by jsps overseas challenge program for young researchers no 201880243 and jsps kakenhi grant numbers jp 18 j 10420 and jp 20 k 22317 the authors gratefully acknowledge the helpful advice of s bhatwadekar and xiasong sun in preparing this article the third author wishes to express his gratitude to members of the department of mathematics at western michigan university which he visited for periods in 2018 and 2019 references 1 n bourbaki commutative algebra elements of math addison wesley 1972 reading ma 2 p cohn algebra vol 2 john wiley and sons 1977 chichester new york 3 d daigle and g freudenburg a counterexample to hilbert s fourteenth problem in dimension five j algebra 221 1999 528 535 4 a note on triangular derivations of krx 1 x 2 x 3 x 4 s proc amer math soc 129 2001 657 662 5 j david a characteristic zero non noetherian factorial ring of dimension three trans amer math soc 180 1973 315 325 6 j deveney and d finston fields of ga invariants are ruled canad math bull 37 1994 37 41 7 d eisenbud commutative algebra with a view toward algebraic geometry graduate texts in mathematics vol 150 springer verlag 1995 8 r fossum the divisor class group of a krull domain ergebnisse der mathematik und ihrer grenzgebiete vol 74 springer verlag berlin heidelberg new york 1973 9 g freudenburg algebraic theory of locally nilpotent derivations second ed encyclopaedia of mathematical sciences vol 136 springer verlag berlin heidelberg new york 2017 10 g freudenburg and s kuroda cable algebras and rings of ga invariants kyoto j math 57 2017 325 363 11 j hausen e herppich and h su ss multigraded factorial rings and fano varieties with torus actions doc math 16 2011 71 109 12 m ishida graded factorial rings of dimension 3 of a restricted type j math kyoto univ 17 1977 441 456 13 i kaplansky commutative rings revised edition university of chicago press chicago 1974 14 g kemper a course in commutative algebra graduate texts in mathematics vol 256 springer verlag 2011 15 s lang algebra third edition addison wesley 1993 16 h matsumura commutative algebra second edition math lecture note series vol 56 benjamin cummings publishing reading mass 1980 17 commutative ring theory cambridge studies in adv math vol 8 cambridge university press 1986 18 m miyanishi normal affine subalgebras of a polynomial ring algebraic and topological theories to the mem ory of dr takehiko miyata tokyo kinokuniya 1985 pp 37 51 19 s mori graded factorial domains japan j math 3 1977 224 238 20 m nagata a remark on the unique factorization theorem j math soc japan 9 1957 143 145 21 p samuel lectures on unique factorization domains tata institute of fundamental research lectures on math ematics vol 30 tata institute of fundamental research bombay 1964 22 j winkelmann invariant rings and quasiaffine quotients math z 244 2003 163 174 department of mathematics and statistics university of ottawa ottawa ontario k 1 n 6 n 5 22 canada ddaigle uottawa ca department of mathematics western michigan university kalamazoo michigan 49008 usa gene freudenburg wmich edu national institute of technology kosen oyama college 771 nakakuki oyama tochigi 323 0806 japan t nagamine 14 oyama ct ac jp 23 1 introduction 2 preliminaries 2 1 krull domains and divisor class groups 2 2 nagata s criterion 2 3 samuel s criterion 2 4 prime avoidance 2 5 z gradings 3 criteria for a ring to be a ufd 3 1 first criterion 3 2 second criterion 3 3 third criterion 3 4 fourth criterion 3 5 fifth criterion 4 application i rational ufds of dimension three 4 1 a family of three dimensional affine ufds 4 2 a graded rational non noetherian ufd of dimension 3 5 application ii affine ufds defined by trinomial relations 6 a counterexample references