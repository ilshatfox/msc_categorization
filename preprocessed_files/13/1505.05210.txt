ar x iv 1 50 5 05 21 0 v 2 m at h a c 2 5 o ct 2 01 6 the equations defining blowup algebras of height three gorenstein ideals andrew r kustin claudia polini and bernd ulrich abstract we find the defining equations of rees rings of linearly presented height three goren stein ideals to prove our main theorem we use local cohomology techniques to bound the maximum generator degree of the torsion submodule of symmetric powers in order to conclude that the defining equations of the rees algebra and of the special fiber ring generate the same ideal in the symmetric al gebra we show that the ideal defining the special fiber ring is the unmixed part of the ideal generated by the maximal minors of a matrix of linear forms which is annihilated by a vector of indeterminates and otherwise has maximal possible height an important step in the proof is the calculation of the degree of the variety parametrized by the forms generating the height three gorenstein ideal 1 introduction this paper deals with the algebraic study of rings that arise in the process of blowing up a variety along a subvariety these rings are the rees ring and the special fiber ring of an ideal rees rings are also the bi homogeneous coordinate rings of graphs of rational maps between projective spaces whereas the special fiber rings are the homogeneous coordinate rings of the images of such maps more precisely let r be a standard graded polynomial ring over a field and i be an ideal of r minimally generated by forms g 1 gn of the same degree these forms define a rational map whose image is a variety x the bi homogeneous coordinate ring of the graph of is the rees algebra of the ideal i which is defined as the graded subalgebra r i r it of the polynomial ring r t this algebra contains as direct summands the ideal i as well as the homogeneous coordinate ring of the variety x it is a fundamental problem to find the implicit defining equations of the rees ring and thereby of the variety x this problem has been studied extensively by commutative algebraists algebraic geometers and most recently by applied mathematicians in geometric modeling a complete solution obviously requires that one knows the structure of the ideal i to begin with there is a large body of work dealing with perfect ideals of height two which are known to be ideals of maximal minors of an almost square matrix see for instance 25 46 47 27 15 35 10 13 36 48 14 5 44 much less is known for the next cases determinantal ideals of arbitrary size 6 7 and gorenstein ideals of height three 46 30 the class of ideals that satisfies the buchsbaum eisenbud structure theorem 8 in the present paper we treat the case where i is a height three gorenstein ideal and the ams 2010 mathematics subject classification primary 13 a 30 13 h 15 14 a 10 13 d 45 secondary 13 d 02 14 e 05 the first author was partially supported by the simons foundation the second and third authors were partially supported by the nsf keywords blowup algebra castelnuovo mumford regularity degree of a variety hilbert series ideals of linear type jacobian dual local cohomology morphism multiplicity rees ring residual intersections special fiber ring 1 http arxiv org abs 1505 05210 v 2 2 andrew r kustin claudia polini and bernd ulrich entries of a homogeneous presentation matrix of i are linear forms or more generally generate a complete intersection ideal see theorem 9 1 and remark 9 2 height three gorenstein ideals have been studied extensively and there is a vast literature dealing with the various aspects of the subject see for instance 52 8 20 41 3 42 16 1 17 22 45 34 49 43 12 24 4 33 though it may be impossible to determine the implicit equations of rees rings for general classes of ideals one can still hope to bound the degrees of these equations which is in turn an important step towards finding them in the present paper we address this broader issue as well traditionally one views the rees algebra as a natural epimorphic image of the symmetric algebra sym i of i and one studies the kernel of this map 0 a sym i r i 0 the kernel a is the r torsion submodule of sym i the defining equations of the symmetric algebra can be easily read from the presentation matrix of the ideal i hence the simplest situation is when the symmetric algebra and the rees algebra are isomorphic in which case the ideal i is said to be of linear type when the ideal i is perfect of height two or is gorenstein of height three or more generally is in the linkage class of a complete intersection then i is of linear type if and only if the minimal number of generators of the ideal ip ip is at most dimrp for every prime ideal p v i see 25 28 if the condition ip dimrp is only required for every non maximal prime ideal p v i then we say that i satisfies gd where d is the dimension of the ring r the condition gd can be interpreted in terms of the height of fitting ideals i htfitti i whenever i d the property gd is always satisfied if r i is 0 dimensional or if i is a generic perfect ideal of height two or a generic gorenstein ideal of height three for ideals in the linkage class of a complete intersection the assumption gd means that a is annihilated by a power of the maximal homogeneous ideal m of r in other words a is the zeroth local cohomology h 0 m sym i one often requires the condition gd when studying rees rings of ideals that are not necessarily of linear type to identify further implicit equations of the rees ring in addition to the equations defining the symmetric algebra one uses the technique of jacobian dual see for instance 51 let x 1 xd be the variables of the polynomial ring r and t 1 tn be new variables let be a minimal homogeneous presentation matrix of the forms g 1 gn generating i there exits a matrix b with d rows and entries in the polynomial ring s r t 1 tn such that the equality of row vectors t 1 tn x 1 xd b holds choose b so that its entries are linear in t 1 tn the matrix b is called a jacobian dual of if is a matrix of linear forms then the entries of b can be taken from the ring t k t 1 tn this b is uniquely determined by and is called the jacobian dual of the choice of generators of i gives rise to homogeneous epimorphisms of graded r algebras s sym i r i the equations defining blowup algebras of height three gorenstein ideals 3 we denote by l and j the ideals of s defining sym i and r i respectively the ideal l is generated by the entries of the row vector t 1 tn x 1 xd b cramer s rule shows that l id b j and if equality holds then j or r i is said to have the expected form the expected form is the next best possibility for the defining ideal of the rees ring if i is not of linear type linearly presented ideals whose rees ring has the expected form are special cases of ideals of fiber type an ideal i is of fiber type if the defining ideal j of r i can be reconstructed from the defining ideal i x of the image variety x or more precisely j i x s it has been shown in 47 that the rees ring has the expected form if i is a linearly presented height two perfect ideal satisfying gd in this situation the rees algebra is cohen macaulay there has been a great deal of work investigating the defining ideal of rees rings when i is a height two perfect ideal that either fails to satisfy gd or is not linearly presented in this case r i usually does not have the expected form and is not cohen macaulay see for instance 27 15 35 10 13 36 48 14 5 44 much less is known for height three gorenstein ideals in this case n is odd and the presentation matrix can be chosen to be alternating according to the buchsbaum eisenbud structure theorem 8 the defining ideal j of the rees ring has been determined provided that i satisfies gd n d 1 and moreover has linear entries 46 or more generally i 1 is generated by the entries of a single row of 30 it turns out that r i does not have the expected form but is cohen macaulay under these hypotheses on the other hand this is the only case when the rees ring is cohen macaulay in fact the rees ring of a height three gorenstein ideal satisfying gd is cohen macaulay if and only if either n d or else n d 1 and i 1 is generated by the entries of a single generalized row of 49 observe that if n d 1 then d is necessarily even the approximate resolutions of the symmetric powers of i worked out in 41 show that if n d 1 and d is even then sym i has r torsion in too low a degree for j to have the expected form see also 46 as it turns out the alternating structure of the presentation matrix is responsible for unexpected elements in j let an alternating matrix of linear forms presenting a height three gorenstein ideal and let b be its jacobian dual as in 41 one builds an alternating matrix from and b b bt b 0 the submaximal pfaffians of this matrix are easily seen to belong to j we regard the last of these pfaffians as a polynomial in t x 1 xd and consider its content ideal c in t the main theorem of the present paper says that c together with the expected equations generates the ideal j theorem 9 1 let i be a linearly presented height three gorenstein ideal that satisfies gd then the defining ideal of the rees ring of i is j id b s c s 4 andrew r kustin claudia polini and bernd ulrich and the defining ideal of the variety x is i x id b c where is a minimal homogeneous alternating presentation matrix for i in particular i is of fiber type and if d is odd then c 0 and r i has the expected form we now outline the method of proof of our main theorem the proof has essentially four ingre dients each of which is of independent interest and applies in much greater generality than needed here some of these tools are developed in other articles 41 38 39 40 and we are going to describe the content of these articles to the extent necessary for the present paper the first step is to prove that any ideal i satisfying the assumptions of theorem 9 1 is of fiber type corollary 6 4 once this is done it suffices to determine i x a crucial tool in this context is the standard bi grading of the symmetric algebra if is the degree of the generators of i then the r module i is generated in degree zero and its symmetric algebra sym i is naturally standard bi graded as it turns out the ideal i is of fiber type if and only if the bi homogeneous ideal a h 0 m sym i of the symmetric algebra is generated in degrees 0 or equivalently the r modules h 0 m symq i are generated in degree zero for all non negative integers q this suggests the following general question if m is a finitely generated graded r module what are bounds for the generator degrees of the local cohomology modules him m this question is addressed in 39 there we consider approximate resolutions which are homogeneous complexes of finitely generated graded r modules c j of sufficiently high depth c c 1 c 0 0 such that h 0 c m and h j c have sufficiently small dimension for all positive integers j we prove for instance that h 0 m m is concentrated in degrees b 0 cd d and is generated in degrees b 0 cd 1 d 1 where b 0 c j denotes the largest generator degree of c j these theorems from 39 are reproduced in the present paper as corollary 5 4 and theorem 5 6 whereas similar results for the concentration degree of local cohomology modules have been established before to study castelnuovo mumford regularity see e g 23 it appears that the sharper bound on the generation degree is new and more relevant for our purpose under the hypotheses of theorem 9 1 the complexes dq from 41 are approximate resolutions of the symmetric powers symq i and we deduce that indeed the r modules h 0 m symq i are generated in degree zero this is done in theorem 6 1 and corollary 6 4 in fact theorem 6 1 is considerably more general it deals with height two perfect ideals and height three gorenstein ideals that are not necessarily linearly presented we record an explicit ex ponent n so that mn a 0 and we provide an explicit bound for the largest x degree p so that a p contains a minimal bi homogeneous generator of a theorem 6 1 is a significant generalization of part of 36 where the same results are established under fairly restrictive hypotheses with the hypotheses of theorem 9 1 we know that id b c i x see 40 or corollary 8 8 in the present paper to show that this inclusion is an equality we first prove that the two ideals have the equations defining blowup algebras of height three gorenstein ideals 5 the same height which is n d if d n in fact we show much more under weaker hypotheses assume i is any ideal of r generated by forms of degree i is of linear type on the punctured spectrum and a sufficiently high symmetric power symq i has an approximate free resolution that is linear for the first d steps then up to radical j has the expected form in symbols j id b and as a consequence i x id b where b is the jacobian dual of the largest submatrix of that has linear entries this is theorem 7 2 in the present paper we point out that even though our primary interest was the defining ideal i x of the variety x we had to consider the entire bi graded symmetric algebra of i since our main assumption uses the first component of the bi grading which is invisible to the homogeneous coordinate ring of x the third step in the proof of theorem 9 1 is to show that the ideal id b c is unmixed in the relevant case when d n in 40 we construct more generally complexes associated to any d by n matrix b with linear entries in t that is annihilated by a vector of indeterminates b t t 0 the ideal of d by d minors of such a matrix cannot have generic height n d 1 however if the height is n d our complexes give resolutions of id b and of id b c although these ideals fail to be perfect in general thus we obtain resolutions in the context of theorem 9 1 because we have seen in the previous step that id b has height n d using these resolutions we prove that the ideal id b c is unmixed and hence is the unmixed part of id b in 40 we also compute the multiplicity of the rings defined by these ideals we have seen that the two ideals id b c and i x are unmixed and have the same height thus to conclude that the inclusion id b c i x is an equality it suffices to prove that the rings defined by these ideals have the same multiplicity since the multiplicity of the first ring has been computed in 40 it remains to determine the multiplicity of the coordinate ring a t i x or equivalently the degree of the variety x to do so we observe that the rational map is birational onto its image because the presentation matrix is linear proposition 4 1 therefore the degree of x can be expressed in terms of the multiplicity of a ring defined by a certain residual intersection of i proposition 4 2 finally the multiplicity of such residual intersections can be obtained from the resolutions in 41 see 38 and theorem 4 4 in the present paper once we prove in theorem 9 1 that i x id b c then in corollary 9 3 we are able to harvest much information from the results of 40 in particular we learn the depth of the homogeneous coordinate ring a of x the entire hilbert series of a and the fact that i x has a linear resolution when d is odd 2 conventions and notation 2 1 if is a matrix then t is the transpose of if is a matrix or a homomorphism of finitely generated free r modules then ir is the ideal generated by the r r minors of or any matrix representation of 6 andrew r kustin claudia polini and bernd ulrich 2 2 we collect names for some of the invariants associated to a graded module let r be a graded noetherian ring and m be a graded r module define topdeg m sup j m j 6 0 indeg m inf j m j 6 0 and b 0 m inf p r j p m j m if r is non negatively graded r 0 is local m is the maximal homogeneous ideal of r m is finitely generated and i is a non negative integer then also define ai m topdeg h i m m and bi m topdeg tor r i m r m observe that both definitions of the maximal generator degree b 0 m give the same value the expressions topdeg indeg and bi are read top degree initial degree and maximal i th shift in a minimal homogeneous resolution respectively if m is the zero module then topdeg m b 0 m and indeg m in general one has ai m and bi m 2 3 recall the numerical functions of 2 2 let r be a non negatively graded noetherian ring with r 0 local and m be the maximal homogeneous ideal of r the a invariant of r is defined to be a r adim r r furthermore if r is the graded canonical module of r then a r indeg r 2 4 let r be a standard graded polynomial ring over a field k m be the maximal homogeneous ideal of r and m be a finitely generated graded r module recall the numerical functions of 2 2 the castelnuovo mumford regularity of m is regm max ai m i max bi m i 2 5 let i be an ideal in a noetherian ring the unmixed part iunm of i is the intersection of the primary components of i that have height equal to the height of i 2 6 let r be a noetherian ring i be a proper ideal of r and m be a finitely generated non zero r module we denote the projective dimension of the r module m by pdr m the grade of i is the length of a maximal regular sequence on r which is contained in i if r is cohen macaulay then the grade of i is equal to the height of i the r module m is called perfect if the grade of the annihilator of m denoted annm is equal to the projective dimension of m the inequality grade annm pdr m holds automatically the ideal i in r is called a perfect ideal if r i is a the equations defining blowup algebras of height three gorenstein ideals 7 perfect r module a perfect ideal i of grade g is a gorenstein ideal if ext g r r i r is a cyclic r module 2 7 denote by m the minimal number of generators of a finitely generated module m over a local ring r recall from artin and nagata 2 that an ideal i in a noetherian ring r satisfies the condition gs if ip dimrp for each prime ideal p v i with dimrp s 1 the condition gs can be interpreted in terms of the height of fitting ideals an ideal i of positive height satisfies gs if and only if i ht fitti i for 0 i s the property gd for d dimr is always satisfied if r i is 0 dimensional or if i is a generic perfect ideal of grade two or a generic gorenstein ideal of grade three 2 8 let r be a noetherian ring i be an ideal of height g k be a proper ideal and s be an integer with g s a the ideal k is called an s residual intersection of i if there exists an s generated ideal a i such that k a i and s htk b the ideal k is called a geometric s residual intersection of i if k is an s residual intersection of i and if in addition s 1 ht i k c the ideal i is said to be weakly s residually s 2 if for every i with g i s and every geometric i residual intersection k of i r k is s 2 2 9 if i is an ideal of a ring r then the rees ring of i denoted r i is the subring r it of the polynomial ring r t there is a natural epimorphism of r algebras from the symmetric algebra of i denoted sym i onto r i if this map is an isomorphism we say that the ideal i is of linear type 3 defining equations of graphs and images of rational maps data 3 1 let k be a field and let r k x 1 xd t k t 1 tn and s r t 1 tn be poly nomial rings let m x 1 xd be the maximal homogeneous ideal of r and i a homogeneous ideal of r minimally generated by forms g 1 gn of the same positive degree such forms define a rational map g 1 gn pd 1 k p n 1 k with base locus v i we write x for the closed image of the variety parametrized by and a t i x for the homogeneous coordinate ring of this variety in this section we collect some general facts about rational maps and rees rings data 3 1 is in effect throughout 3 2 recall the definition of the rees ring r i r it r t from 2 9 we consider the epimor phism of r algebras s r i 8 andrew r kustin claudia polini and bernd ulrich that sends ti to git let j be the kernel of this map which is the ideal defining the rees ring we set degxi 1 0 degti 0 1 and deg t 1 thus s and the subring r i of r t become standard bi graded k algebras is a bi homogeneous epimorphism and j is a bi homogeneous ideal of s if m is a bi graded s module and p a fixed integer we write m p j m p j and m p i p m i 3 3 the rees algebra r i is the bi homogeneous coordinate ring of the graph of in fact the natural morphisms of projective varieties p d 1 k p n 1 k graph oo p n 1 k x im oo correspond to bi homogeneous homomorphisms of k algebras s r i t t oo a oo since t s 0 we see that a r i 0 k g 1 t gnt and 3 3 1 i x j 0 j t we also observe that there is a not necessarily homogeneous isomorphism of k algebras k g 1 t gnt k g 1 gn r moreover the identification r i 0 r i r i 0 gives a homogeneous isomorphism a r i mr i the latter ring is called the special fiber ring of i and its dimension is the analytic spread of i written i the analytic spread plays an important role in the study of reductions of ideals and satisfies the inequality 3 3 2 i min d n notice that i dima dimx 1 3 4 the graded r module i is generated in degree zero and hence its symmetric algebra sym i is a standard bi graded k algebra there is a natural bi homogeneous epimorphism of k algebras sym i r i the equations defining blowup algebras of height three gorenstein ideals 9 whose kernel we denote by a the epimorphism from 3 2 factors through this map and gives a bi homogeneous epimorphism of k algebras s sym i we write for the kernel of this epimorphism the advantage of over j is that can be easily described in terms of a presentation matrix of i see 3 6 notice that a j the ideal i is of linear type if any of the following equivalent conditions holds a 0 j j is generated in bi degrees 1 notice that if i is of linear type then necessarily i x 0 the ideal i is said to be of fiber type if any of the following equivalent conditions holds a i x sym i a is generated in bi degrees 0 j i x s j is generated in bi degrees 1 and 0 see 3 3 1 for the equivalence of these conditions 3 5 the ideal a in the exact sequence 0 a sym i r i 0 is the r torsion of sym i hence a contains the zeroth local cohomology of sym i as an r module which in turn contains the socle of sym i as an r module 3 5 1 a h 0 m sym i 0 sym i m 0 sym i m 3 6 consider the row vectors x x 1 xd t t 1 tn g g 1 gn and let be a minimal homogeneous presentation matrix of g there exits a matrix b with d rows and entries in the polynomial ring s such that the equality of row vectors 3 6 1 t x b holds if b is chosen so that its entries are linear in t 1 tn then b is called a jacobian dual of we say that a jacobian dual is homogeneous if the entries of any fixed column of b are homogeneous of the same bi degree whenever is a matrix of linear forms then the entries of b can be taken from the ring k t 1 tn this b is uniquely determined by and is called the jacobian dual of notice that the entries of b are linear forms and that b is indeed a jacobian matrix of the t algebra sym i 10 andrew r kustin claudia polini and bernd ulrich the ideal l defining the symmetric algebra is equal to i 1 t which coincides with i 1 x b for the rees algebra the inclusions 3 6 2 id b s m j obtain see also 51 if the equality id b j holds then j or r i is said to have the expected form notice that in this case the inclusions of 3 5 1 are equalities in other words a is the socle of sym i as an r module 3 7 it is much easier to determine when the first inclusion of 3 5 1 is an equality namely 3 7 1 a h 0 m sym i i is of linear type on the punctured spectrum of r the second condition means that ap 0 for all p in spec r m this leads to the question of when an ideal is of linear type thus let j be an ideal of a local cohen macaulay ring of dimension d if j is perfect of height two or gorenstein of height three then j is in the linkage class of a complete intersection 21 52 if j is in the linkage class of a complete intersection then j is strongly cohen macaulay 28 1 11 and hence satisfies the sliding depth condition of 26 if j satisfies the sliding depth condition then j is weakly d 1 residually s 2 in the sense of 2 8 c 26 3 3 in the presence of the weak d 2 residually s 2 condition it follows from 11 3 6 b that j is of linear type j satisfies gd 1 in particular j is of linear type on the punctured spectrum j satisfies gd alternatively one uses 25 combining these facts we see that if the ideal i of data 3 1 is perfect of height two or gorenstein of height three then 3 7 2 i is of linear type i satisfies gd and n d and 3 7 3 a h 0 m sym i i satisfies gd 4 the degree of the image of a rational map this section deals with the dimension and the degree of the image of rational maps as in data 3 1 applied to the special case of linearly presented gorenstein ideals of height three this information will be an important ingredient in the proof of theorem 9 1 we first treat the question of when the rational map is birational onto its image x proposi tion 4 1 we then express the degree of x in terms of the multiplicity of a ring defined by a residual intersection of the ideal i defining the base locus of proposition 4 2 the multiplicity of rings the equations defining blowup algebras of height three gorenstein ideals 11 defined by residual intersections of linearly presented height three gorenstein ideals was computed in 38 using the resolutions worked out in 41 for completeness we state this result in theo rem 4 3 finally we combine proposition 4 1 proposition 4 2 and theorem 4 3 in corollary 4 4 to compute the degree of x under the hypotheses of theorem 9 1 proposition 4 1 adopt data 3 1 assume further that the ideal i is linearly presented a if the ring r i has dimension zero then the map is biregular onto its image in particular a has multiplicity d 1 b if a has dimension d then the rational map is birational onto its image proof we may assume that the field k is algebraically closed let be a minimal presentation matrix of g g 1 gn with homogeneous linear entries in r and let p pn 1 k be a point in x according to 19 the ideal i 1 p i defines the fiber 1 p scheme theoretically this ideal cannot be the unit ideal because the fiber is not empty on the other hand the ideal i 1 p is generated by linear forms hence is a prime ideal of r thus i 1 p i i 1 p is generated by linear forms a we consider the embedding a k g r which corresponds to the rational map onto its image if the ring r i r g has dimension zero then r is finitely generated as an a module it follows that the fiber 1 p consists of finitely many points since this fiber is defined by a linear ideal it consists of a single reduced point this shows that is biregular onto its image the claim about the multiplicity follows because in particular is birational onto its image see for instance 37 5 8 b let q be a general point in pd 1 k and p be its image q in x since a k g and r have the same dimension the fiber 1 p consists of finitely many points therefore again 1 p consists of a single reduced point which means that is birational onto its image proposition 4 2 adopt data 3 1 further assume that the field k is infinite that d n and that the ideal i is weakly d 2 residually s 2 and satisfies gd let f 1 fd 1 be general k linear combinations of the generators g 1 gn of i then the following statements hold a the ring r f 1 fd 1 i is cohen macaulay of dimension one b the ring a has dimension d c the ring a has multiplicity e a 1 r e r f 1 fd 1 i where r is the degree of the rational map proof let f 1 fd be general k linear combinations of the generators g 1 gn of i the gd property of the ideal i implies that 4 2 1 d 1 ht f 1 fd 1 i and d ht f 1 fd 1 i fd 12 andrew r kustin claudia polini and bernd ulrich according to 2 2 3 or 50 1 6 a furthermore the ideal f 1 fd 1 i is proper because i requires at least d generators now 11 3 1 and 3 3 a implies that f 1 fd 1 i is unmixed of height d 1 which proves a to show b we suppose that dima d in this case the ring k g 1 gn a is integral over the subring k f 1 fd 1 and therefore the ideal i is integral over the ideal f 1 fd 1 in 3 7 we have seen that locally on the punctured spectrum i is of linear type and hence cannot be integral over a proper subideal thus d ht f 1 fd 1 i which contradicts a we now prove c item b allows us to apply 37 3 7 which gives e a 1 r e r f 1 fd 1 i on the other hand item a and the inequality d ht f 1 fd 1 i fd imply that the element fd of i is regular on r f 1 fd 1 i it follows that f 1 fd 1 i f 1 fd 1 i the following statement which is used in the proof of theorem 4 4 is part of 38 1 2 we do not need the entire h vector of r in the present paper but the entire h vector is recorded in 38 1 2 theorem 4 3 adopt data 3 1 further assume that the ideal i is a linearly presented gorenstein ideal of height three let a be a subideal of i minimally generated by s homogeneous elements for some s with 3 s be the minimal number of generators of i a j be the ideal a i and r r j assume that 1 the homogeneous minimal generators of a live in two degrees indeg i and indeg i 1 2 the ideal j is an s residual intersection of i that is j 6 r and s htj then the ring r has multiplicity e r 12 i 0 s 2 2 i s 1 the latter is also equal to the number of monomials m of degree at most 1 in s variables with degm odd theorem 4 4 is the main result of this section where the dimension and the degree of the variety x are computed theorem 4 4 adopt data 3 1 further assume that d n that i is a linearly presented gorenstein ideal of height three and that i satisfies gd then a has dimension d and multiplicity e a n d 2 i 0 n 2 2 i d 2 which is equal to the number of monomials of even degree at most n d in d 1 variables if d is odd the number of monomials of odd degree at most n d in d 1 variables if d is even the equations defining blowup algebras of height three gorenstein ideals 13 proof we may assume that the field k is infinite we first observe that the ideal i satisfies the hypotheses of proposition 4 2 see 3 7 according to proposition 4 2 b proposition 4 1 b and proposition 4 2 c the dimension of a is d and the multiplicity of a is e a e r f 1 fd 1 i where f 1 fd 1 are general k linear combinations of homogeneous minimal generators of i write j f 1 fd 1 i this ideal is a d 1 residual intersection of i by 4 2 1 apply theorem 4 3 with s replaced by d 1 and replaced by n d 1 in order to obtain e a e r j n d 2 i 0 n 2 2 i d 2 5 results from degree bounds for local cohomology an important step in the proof of theorem 9 1 is to show that an ideal is of fiber type see 3 4 for a definition and to identify a power of the maximal ideal that annihilates the torsion of the symmetric algebra in 3 7 3 and 3 4 we have seen that this amounts to finding degree bounds for local cohomology modules such degree bounds are given in 39 in the present section we recall some of the results from 39 these results are applied to the study of blowup algebras in sections 6 and 7 data 5 1 let r be a non negatively graded noetherian algebra over a local ring r 0 with dimr d m be the maximal homogeneous ideal of r m be a graded r module and c c 1 c 0 0 be a homogeneous complex of finitely generated graded r modules with h 0 c m in 39 we find bounds on the degrees of interesting elements of the local cohomology modules him m in terms of information about the ring r and information that can be read from the complex c the ring r need not be a polynomial ring the complex c need not be finite need not be acyclic and need not consist of free modules and the parameter i need not be zero instead we impose hypotheses on the krull dimension of h j c and the depth of c j in order to make various local cohomology modules h m h j c and h m c j vanish recall that if m and n are modules over a ring then n is a subquotient of m if n is isomorphic to a submodule of a homomorphic image of m or equivalently if n is isomorphic to a homomorphic image of a submodule of m also recall the numerical functions of 2 2 the next proposition is 39 3 2 proposition 5 2 adopt data 5 1 fix an integer i with 0 i d assume that 1 j i 1 depthc j for all j with 0 j d i 1 and 14 andrew r kustin claudia polini and bernd ulrich 2 dimh j c j i for all j with 1 j then a him m is a graded subquotient of h d m cd i and b ai m b 0 cd i a r remark 5 3 typically one applies proposition 5 2 when the modules c j are maximal cohen macaulay modules for example free modules over a cohen macaulay ring because in this case hypothesis 1 about depthc j is automatically satisfied similarly if 5 3 1 h j c p 0 for all j and p with 1 j d i 1 p spec r and i 2 dimr p then hypothesis 2 is satisfied we record an immediate consequence of proposition 5 2 this is 39 3 4 corollary 5 4 adopt the hypotheses of proposition 5 2 with i 0 then the following statements hold a if cd 0 then h 0 m m 0 b if cd 6 0 then h 0 m m p 0 for all p with b 0 cd a r p the next result an obvious consequence of corollary 5 4 is 39 3 5 corollary 5 5 adopt the hypotheses of proposition 5 2 with i 0 assume further that r k x 1 xd is a standard graded polynomial ring over a field and that the subcomplex cd c 1 c 0 0 of c is a q linear complex of free r modules for some integer q that is c j r j q j for 0 j d then h 0 m m is concentrated in degree q that is h 0 m m p 0 for all p with p 6 q the next theorem is 39 5 5 and the main result of this section it provides an upper bound for the generation degree of the zeroth local cohomology theorem 5 6 let r k x 1 xd be a standard graded polynomial ring over a field with maximal homogeneous ideal m let c c 2 c 1 c 0 0 be a homogeneous complex of finitely generated graded r modules and m h 0 c assume that dimh j c j whenever 1 j d 1 and that min d j 2 depthc j whenever 0 j d 1 then b 0 h 0 m m b 0 cd 1 d 1 the equations defining blowup algebras of height three gorenstein ideals 15 remark 5 7 the hypotheses of theorem 5 6 about depth and dimension are satisfied if the modules c j are free and condition 5 3 1 holds 6 bounding the degrees of defining equations of rees rings in this section we apply the local cohomology techniques of 39 to bound the degrees of the defining equations of rees rings this style of argument was inspired by work of eisenbud huneke and ulrich see 18 to apply the results of 39 most notably corollary 5 4 and theorem 5 6 of the present paper we need approximate resolutions c of the symmetric powers of i for an ideal i as in data 3 1 that satisfies gd if i is perfect of height two we take c to be a homogeneous strand of a koszul complex the fact that this choice of c satisfies the hypotheses of corollary 5 4 and theorem 5 6 is shown in the proof of theorem 6 1 a if i is gorenstein of height three we take c to be one of the complexes dq from 41 in this paper these complexes are introduced in 6 1 4 they are shown to satisfy the hypotheses of corollary 5 4 and theorem 5 6 in lemma 6 3 in theorem 6 1 we carefully record the degrees of the entries in a minimal homogeneous presen tation matrix for i but we do not insist that these entries be linear for the ideal a of the symmetric algebra defined in 3 4 we give an explicit exponent n so that mn a 0 and we obtain an explicit bound for the largest x degree p so that a p q a p q contains a minimal bi homogeneous generator of a assertions ai and aii of theorem 6 1 about perfect height two ideals are significant general izations of corollaries 2 5 2 and 2 16 1 respectively in 36 where the same results are obtained for d 2 and n 3 the starting point for 36 is the perfect pairing of jouanolou 31 32 which exists because the symmetric algebra of a three generated height two perfect ideal is a complete intersection with the present hypotheses the symmetric algebra is only a complete intersection on the punctured spectrum of r and there is no perfect pairing analogous to the pairing of jouanolou theorem 6 1 is particularly interesting when the ideal i is linearly presented indeed assertions aii and bii say that i is of fiber type for height two perfect ideals this was already observed in 47 for height three gorenstein ideals this is a new result and a main ingredient in the proof of theorem 9 1 the application of theorem 6 1 to the situation where i is a linearly presented height three gorenstein ideal is recorded as corollary 6 4 theorem 6 1 adopt data 3 1 and recall the bi homogeneous ideal a of the symmetric algebra defined in 3 4 assume further that i satisfies the condition gd a assume that the ideal i is perfect of height two and the column degrees of a homogeneous hilbert burch matrix minimally presenting i are 1 2 n 1 then the following statements hold when d n 1 i if di 1 i 1 p then a p 0 in particular m 1 d i 1 i 1 a 0 16 andrew r kustin claudia polini and bernd ulrich ii if a p contains a minimal bi homogeneous generator of a then p d 1 i 1 i 1 b assume that the ideal i is gorenstein of height three and every entry of a homogeneous alter nating matrix minimally presenting i has degree d then the following statements hold i if d d 1 p when d is odd d 1 d 1 n d 12 d 1 p when d is even then a p 0 in particular md d 1 1 a 0 if d is odd m d 1 d 1 n d 1 2 da 0 if d is even ii if a p contains a minimal bi homogeneous generator of a then p d 1 d 1 remarks a we may safely assume that d n 1 in theorem 6 1 because otherwise a 0 see 3 7 2 b the assumptions on the degrees of the entries in a presentation matrix do not impose any re striction in a the inequalities 1 2 n 1 can be achieved by a permutation of the columns in b all entries necessarily have the same degree as can be seen from the symmetry of the minimal homogeneous r resolution of r i c results similar to but more complicated than theorem 6 1 can be obtained without the as sumption that the ideal i is generated by forms of the same degree d the degree of the forms g 1 gn in data 3 1 is n 1 i 1 i in the setting of theorem 6 1 a and is n 1 2 d in theorem 6 1 b see 9 and 8 respectively proof we have seen in 3 7 3 that the ideal a of sym i is equal to the local cohomology module h 0 m sym i we apply corollary 5 4 and theorem 5 6 to learn about the r modules 6 1 1 h 0 m symq i p a p q a q a let be a minimal homogeneous hilbert burch matrix for i in other words is an n n 1 matrix with homogeneous entries from r such that 0 f 1 f 0 g i 0 is a homogeneous exact sequence of r modules where g is the row vector g 1 gn of 3 6 f 0 r n and f 1 n 1 i 1 r i it induces a bi homogeneous presentation of the symmetric algebra sym f 0 r f 1 0 1 sym f 0 sym i 0 the equations defining blowup algebras of height three gorenstein ideals 17 where sym f 0 is the standard bi graded polynomial ring s of 3 2 and is the row vector t 1 tn of 3 6 we consider the koszul complex of k s s r f 1 0 1 s r r f 1 0 1 it is a bi homogeneous complex of free s modules with h 0 k equal to sym i the ideal i is perfect of height two and satisfies gd see 2 7 it follows that the sequence 1 n 1 is a regular sequence locally on the punctured spectrum of r see observation 6 2 and therefore the koszul complex k is acyclic on the punctured spectrum of r in particular for each non negative integer q the component of degree q of k is a homogeneous complex of graded free r modules has zeroth homology equal to symq i and is exact on the punctured spectrum of r this component looks like cq 0 c q n 1 c q n 2 c q 1 c q 0 0 with cqr symq r f 0 r r f 1 1 i 1 ir n 1 rbr r j 1 i j for br rank symq r f 0 q r n 1 n 1 the assumption 1 2 n 1 yields that if cqr 6 0 then 6 1 2 b 0 c q r r i 1 i for 1 r n 1 notice that if c q r 0 then b 0 c q r apply corollary 5 4 see also remark 5 3 to the complex cq to conclude that 6 1 3 h 0 m symq i p 0 for all p with b 0 c q d a r p recall that the index q in 6 1 3 is arbitrary apply 6 1 1 6 1 2 and 6 1 3 to conclude that a p 0 for all p with d i 1 i d p assertion ai has been established apply theorem 5 6 see also remark 5 7 to the complex c q to conclude that every minimal homogeneous generator of h 0 m symq i satisfies deg b 0 cqd 1 d 1 once again 6 1 1 and 6 1 2 yield that b 0 a q d 1 i 1 i d 1 18 andrew r kustin claudia polini and bernd ulrich the parameter q remains arbitrary every minimal bi homogeneous generator of a is a minimal homogeneous generator of a q for some q we conclude that if a p q contains a minimal bi homogeneous generator of a then p d 1 i 1 i d 1 and this establishes assertion aii b let be an n n homogeneous alternating matrix which minimally presents i and for each non negative integer q let d q 0 d q n 1 d q n 2 d q 1 d q 0 0 be the complex from 41 def 2 15 and fig 4 7 that is associated to the alternating matrix the zeroth homology of d q is symq i see 41 4 13 b the hypothesis that every entry of has degree d yields that 6 1 4 dqr kq r r r rd q r if r min q n 1 qq r r 1 d n r 1 2 d if r q 1 q is odd and r n 1 0 if r q 1 and q is even 0 if min q 2 n r for some non zero betti numbers qr indeed the graded r module symq i is generated in degree zero moreover each map ka b ka 1 b 1 is linear in the entries of see 41 2 15 d and the map qq k 0 q may be represented by a column vector whose entries consist of the pfaffians of the principal n r 1 n r 1 alternating submatrices of see 41 2 15 c and 2 15 f notice from 6 1 4 that 6 1 5 if dqr qq then d q r 1 0 notice also that max q dqd 6 0 b 0 d q d dd if d is odd d 1 d n d 12 d if d is even 6 1 6 max q dqd 6 0 b 0 d q d 1 d 1 d 6 1 7 one uses 6 1 5 in order to see 6 1 7 because the condition dqd 6 0 forces d q d 1 kq d 1 d 1 by hypothesis the ideal i satisfies the condition gd so i satisfies the hypothesis 6 3 1 of lemma 6 3 for s d 1 and therefore the complex dq p is acyclic for every p spec r with dimrp d 1 and every non negative integer q the hypotheses of corollary 5 4 and theo rem 5 6 are satisfied by the complexes d q we deduce that either d q d and h 0 m symq i are both zero or else d q d 6 0 h 0 m symq i p 0 for all p with b 0 d q d a r p and every minimal homogeneous generator of h 0 m symq i satisfies deg b 0 dqd 1 d 1 the equations defining blowup algebras of height three gorenstein ideals 19 in the case d q d 6 0 we apply 6 1 1 6 1 6 and 6 1 7 to conclude that a p q 0 for dd d p if d is odd d 1 d n d 12 d d p if d is even and every minimal homogeneous generator of a q satisfies deg d 1 d d 1 keep in mind that if a p q is a minimal bi homogeneous generator of a then is also a minimal homogeneous generator of a q assertions bi and bii have been established two small facts were used in the proof of theorem 6 1 to guarantee that the complexes cq and d q satisfy the hypotheses of corollary 5 4 and theorem 5 6 we prove these facts now observation 6 2 let r be a cohen macaulay local ring and i be an ideal of positive height as sume that ip dimrp 1 for each prime ideal p v i if sym i p j is any homogeneous presentation where p is a standard graded polynomial ring over r in n variables and j is a homo geneous ideal of p then j has height n 1 proof one has ht j dimp dimp j dimr n dim sym i n 1 where the first equality holds because r is cohen macaulay local and j is homogeneous and the last equality follows from the dimension formula for symmetric algebras see 29 2 6 lemma 6 3 let r be a cohen macaulay ring and i be a perfect gorenstein ideal of height three let be an alternating presentation matrix for i dq be the family of complexes in 41 which is associated to and s be an integer if 6 3 1 ip dimrp 1 for each prime ideal p v i with dimrp s then the complex d q p is acyclic for every p spec r with dimrp s and every non negative integer q proof let p spec r with dimrp s notice that dq p dq p this complex has length at most n 1 where n is the size of the matrix p according to 41 4 3 d see also 6 1 4 moreover by assumption 6 3 1 the matrix p satisfies condition wmc 1 and therefore wpc 1 see 41 5 8 5 9 5 11 a now 41 6 2 shows that the complex d q p is acyclic theorem 6 1 is particularly interesting when i is a linearly presented height three gorenstein ideal one quickly deduces that such ideals are of fiber type see 3 4 for the definition this is a new result and a main ingredient in the proof of theorem 9 1 corollary 6 4 adopt the setting of theorem 6 1 b with d 1 then the ideal i is of fiber type furthermore a is annihilated by m when d is odd and by m n d 1 2 when d is even 20 andrew r kustin claudia polini and bernd ulrich proof theorem 6 1 bii shows that the ideal a of sym i is generated by a 0 which means that i is of fiber type see 3 4 the assertion about which power of m annihilates a is explicitly stated in theorem 6 1 bi 7 the defining ideal of rees rings up to radical in this section we mainly work under the assumption that the ideal i of data 3 1 is of linear type on the punctured spectrum of r and that a sufficiently high symmetric power symt i has an approximate free resolution that is linear for the first d steps with these hypotheses alone we prove somewhat surprisingly that the defining ideal j of the rees ring has the expected form up to radical see 3 6 for the definition of expected form we also describe the defining ideal i x of the variety x up to radical and we deduce that id b has maximal possible height where b is the jacobian dual of the linear part of a minimal homogeneous presentation matrix of i see 3 6 for the definition of jacobian dual this is done in theorem 7 2 the computation of the height of id b is relevant for the proof of theorem 9 1 because it ensures that the complexes constructed in 40 are free resolutions of id b and of id b c where b b is the full jacobian dual in this case and c is the content ideal of definition 8 1 a step towards the proof of theorem 7 2 is lemma 7 1 where we show that up to radical a is the socle of the symmetric algebra as an r module and i is of fiber type see 3 4 for the definition of fiber type we deduce this statement from the other parts of the same lemma which say that even locally on the punctured spectrum of the polynomial ring s the ideal a belongs to the socle and i is of fiber type these facts are proved using the methods of 39 most notably corollary 5 5 of the present paper the assumption that i is of linear type on the punctured spectrum of r is rather natural see 3 7 it is satisfied for instance if i is perfect of height two or gorenstein of height three and i satisfies gd if such an ideal is in addition linearly presented then the hypothesis about an approximate resolution c of symt i holds as well see remark 7 4 the index t of the symmetric power symt i in lemma 7 1 and theorem 7 2 can be any integer greater than or equal to the relation type of i the relation type of an ideal i as in data 3 1 is the largest integer q such that a q contains a minimal bi homogeneous generator of a we recall the bi homogeneous ideal a j of sym i as well as the bi homogeneous ideals and j of s that define the symmetric algebra and the rees ring respectively see 3 2 and 3 4 lemma 7 1 adopt data 3 1 suppose further that i is of linear type on the punctured spectrum of r and that for some index t greater than or equal to the relation type of i there exists a homogeneous complex c c 1 c 0 0 of finitely generated graded free r modules such that 1 h 0 c symt i 2 the subcomplex cd c 0 of c is linear that is ci r i i for 0 i d and the equations defining blowup algebras of height three gorenstein ideals 21 3 dimh j c j for 1 j d 1 let m be the ideal x 1 xd t 1 tn of s then the following statements hold a on spec s m the ideal a of sym i is annihilated by m that is ma p 0 for every p spec s m b on spec s m i is of fiber type that is ap i x sym i p for every p spec s m c the ideal j of s satisfies j s m i x proof recall that a h 0 m sym i since i is of linear type on the punctured spectrum of r see 3 7 1 in particular a t h 0 m symt i apply corollary 5 5 to the r module symt i to conclude that a t a 0 t therefore a t a 0 t because by the definition of relation type a t generates a t as a module over sym i hence over sym i 0 it follows that t 1 tn ta a 0 t which gives t 1 tn t a 0 0 since moreover a 0 vanishes locally on spec r m we deduce that a 0 0 locally on spec s m this completes the proof of a because ma a 0 and of b because a i x a 0 as for c we recall the obvious inclusion s m j part a shows that if p spec s m contains s m then p contains j since m contains j anyway we deduce that j s m the same argument with part a replaced by b shows that j i x theorem 7 2 retain all of the notation and hypotheses of lemma 7 1 let be a minimal homoge neous presentation matrix of g 1 gn be the submatrix of that consists of the linear columns of b be a homogeneous jacobian dual of and b be the jacobian dual of in the sense of 3 6 then the following statements hold a the ideal i x of t which defines the variety x satisfies i x id b b ht id b n dima c the ideal j of s which defines the rees ring r i satisfies j l id b l id b 22 andrew r kustin claudia polini and bernd ulrich proof part b is an immediate consequence of a we prove items a and c simultaneously we first notice that b is a submatrix of b the ideal id b of s is bi homogeneous the two ideals m id b and m id b of s are equal and the two ideals id b t and id b of t are equal from lemma 7 1 c we know that j s m the ideal l s m is the annihilator of the s module m ms l the ideal ms is generated by the entries of x and the ideal l is generated by the entries of x b it follows that m is presented by b where is a presentation matrix of x with entries in m therefore l s m anns m fitt 0 m m id b it follows that j m id b m id b intersecting with t we obtain i x j t m id b t m id b t id b where the last two radicals are taken in the ring t this proves part a from lemma 7 1 c we also know that j i x and then by part a j l id b finally recall the inclusions id b id b j and the proof of part c is complete remark 7 3 retain the notation and the hypotheses of theorem 7 2 and recall the definition of analytic spread from 3 3 if d n then i n and if i n then has at least n 1 columns proof write s for the number of columns of which is also the number of columns of b one has n d n i n dim a ht id b max s d 1 0 where the first inequality holds by 3 3 2 the first equality follows from 3 3 the second equality is theorem 7 2 b and the last inequality holds by the eagon northcott bound on the height of determinantal ideals these inequalities show that if 0 n d then 0 n i and if 0 n i then n d s d 1 remark 7 4 adopt data 3 1 further assume that i is perfect of height two or gorenstein of height three i is linearly presented and i satisfies gd then the hypotheses of lemma 7 1 and theorem 7 2 are satisfied the equations defining blowup algebras of height three gorenstein ideals 23 proof we know from 3 7 1 and 3 7 3 that the ideal i is of linear type on the punctured spectrum we now establish the existence of a complex c in the first case when i is perfect of height two we can take c to be the complex c t k t defined in the proof of theorem 6 1 a this is a linear complex of finitely generated graded free r modules which is acyclic on the punctured spectrum and has symt i as zeroth homology these facts are shown in the proof of theorem 6 1 a most notably in 6 1 2 in the second case when i is gorenstein of height three we take c to be the complex d t used in the proof of theorem 6 1 b with the additional restriction that d t this is a complex of finitely generated graded free r modules which has symt i as zeroth homology moreover this complex is acyclic on the punctured spectrum see lemma 6 3 and it is linear for the first d steps see 6 1 4 we end this section by recording a fact that is contained in the proof of theorem 6 1 b but may well be of independent interest recall the functions ai and reg from 2 2 and 2 4 proposition 7 5 adopt data 3 1 further assume that i is a linearly presented gorenstein ideal of height three let q be a non negative integer if ip dimrp 1 for each prime ideal p v i with dimrp d 2 then ai symq i q i if q is even or q 6 d i 1 q n q 2 1 i if q is odd and q d i 1 in particular reg symq i q if q is even or d q q n q 2 1 if q is odd and q d 1 proof apply proposition 5 2 with m symq i and c the complex d q of 6 1 4 lemma 6 3 guarantees that dimh j d q 1 for every j with 1 j thus proposition 5 2 a see also remark 5 3 gives that him symq i is a graded subquotient of h d m d q d i for 0 i d from 6 1 4 we see that either d q d i 0 or else d q d i r d i q d i if q is even or q 6 d i 1 r d i 1 n q 2 if q is odd and q d i 1 therefore the top degree of hdm d q d i is at most d i d i if q is even or q 6 d i 1 d i 1 n q 2 d i 1 n q 2 if q is odd and q d i 1 notice the second case cannot occur if q is even or d q on the other hand the fact that the r module symq i is generated in degree 0 implies that the regularity of symq i is non negative now the assertions follow 24 andrew r kustin claudia polini and bernd ulrich 8 the candidate ideal c in the present section we exhibit the candidate for the defining ideal of the variety x most of this material is taken from 40 definition 8 1 let k be a field and n and d be positive integers for each n n alternating matrix with linear entries from the polynomial ring r k x 1 xd define an ideal c in the polynomial ring t k t 1 tn as follows let b be the d n matrix with linear entries from t such that the matrix equation 8 1 1 t 1 tn x 1 xd b holds consider the n d n d alternating matrix b bt b 0 with entries in the polynomial ring s k x 1 xd t 1 tn let fi be 1 n d i times the pfaf fian of b with row and column i removed view each fi as a polynomial in t x 1 xd and let c ct fn d be the content ideal of fn d in t a description of c which is almost coordinate free is given in 40 the description depends on the choice of a direct sum decomposition of the degree one component of the ring t into v 1 v 2 where v 1 has dimension one the almost coordinate free description of c depends on the choice of direct sum decomposition however every decomposition gives rise to the same ideal c see also proposition 8 4 b below for the convenience of the reader we provide direct proofs of the more immediate properties of the ideal c most notably we describe a generating set of this ideal in proposition 8 5 the more difficult results about depth unmixedness hilbert series and resolutions however are merely restated from 40 see theorem 8 7 lemma 8 2 retain the setting of definition 8 1 there exists a polynomial h in s so that the equality of row vectors f 1 fn d h t 1 tn x 1 xd obtains proof we may assume that the row vector f f 1 fn d is not zero then b has rank at least n d 1 the alternating property of and equality 8 1 1 imply 0 t t t x b t t since the matrix b has only entries in the polynomial ring t we conclude that b t t 0 and t bt 0 the equations defining blowup algebras of height three gorenstein ideals 25 hence t 1 tn x 1 xd b 0 since also f 1 fn d b 0 and b has almost maximal rank there exists an element h in the quotient field of s such that f 1 fn d h t 1 tn x 1 xd the element h is necessarily in s because the ideal t 1 tn x 1 xd of s has grade at least two lemma 8 2 shows that either h and the submaximal paffians of b all vanish or else these ele ments are all non zero in the latter case n d has to be odd moreover regarding s as standard bi graded with degx j 1 0 and degti 0 1 we see that b is the matrix of a bi homogeneous linear map thus the paffians of this matrix are bi homogeneous hence h is bi homogeneous and computing bi degrees one sees that degh n d 1 2 d 1 in particular if h 6 0 then d n the next remark is now immediate remark 8 3 retain the setting of definition 8 1 a the ideal c of t is generated by homogeneous forms of degree d 1 b if n d or n d is even then c 0 the next proposition shows that the ideal c can be defined using any submaximal pfaffian of b it also relates c to the socle modulo the ideal id b of t proposition 8 4 retain the setting of definition 8 1 a ct fi ti ct fn j ti c for every 1 i n and 1 j d b ct fn j c for every 1 j d c c id b t t 1 tn in other words the image of c is contained in the socle of the standard graded k algebra t id b proof lemma 8 2 shows that ct fi ct h ti ti ct h for 1 i n and ct fn j ct h x j ct h for 1 j d this proves a part b is an immediate consequence of a finally the definition of fi shows that in the range 1 i n fi id b s and therefore ct fi id b now apply a to deduce c 26 andrew r kustin claudia polini and bernd ulrich in light of remark 8 3 b we now assume that d n and n d is odd fix an integer i with 1 i n let j j 1 jd be a subset of 1 n i with j 1 js i js 1 jd write j j 1 jd d s let pfj i be the pfaffian of the matrix obtained from by deleting rows and columns i j 1 jd and denote by j b the determinant of the d d matrix consisting of columns j 1 jd of b let k y 1 yd be another polynomial ring in d variables that acts on the polynomial ring t x 1 xd by contraction and let denote the contraction operation for m a monomial in k y 1 yd of degree n d 1 2 we define 8 4 1 fm 1 ti j 1 j m pfj i j b where j ranges over all subsets of 1 n i of cardinality d notice that since pfj i k x 1 xd is a homogeneous polynomial of degree n d 1 2 the element m pfj i k is simply the coefficient in this polynomial of the monomial in k x 1 xd corresponding to m similarly fix an integer j with 1 j d let j j 1 jd 1 be a subset of 1 n and set j j 1 jd 1 write pfj for the pfaffian of the matrix obtained from by deleting rows and columns j 1 jd 1 and denote by j b j the determinant of the matrix consisting of columns j 1 jd 1 of b with row j removed let m k y 1 yd be a monomial of degree n d 12 that is divisible by y j we define 8 4 2 hm j 1 j m pfj j b j where j ranges over all subsets of 1 n of cardinality d 1 notice that m pfj k is the coefficient in pfj of the monomial corresponding to m proposition 8 5 adopt the setting of definition 8 1 with d n and n d odd the ideal c of t is generated by the elements fm of 8 4 1 where m ranges over all monomials in k y 1 yd of degree n d 12 it is also generated by the elements hm of 8 4 2 where m ranges over all monomials of degree n d 12 that are divisible by y j proof we prove the first claim from proposition 8 4 a we know that c 1 ti ct fi for 1 i n expanding the pfaffian fi by maximal minors of b one obtains fi j 1 j pfj i j b where again j ranges over all subsets of 1 n i of cardinality d see for instance 43 lemma b 1 regarded as polynomials in t x 1 xd the elements j b are constants and fi is homogeneous of degree n d 12 therefore the content ideal ct fi is generated by the elements m fi j 1 j m pfj i j b where m ranges over all monomials in k y 1 yd of degree n d 1 2 to prove the second claim we recall that c ct fn j for 1 j d see proposition 8 4 b now expand the paffian fn j along the last d 1 rows and use the fact that the monomials in the the equations defining blowup algebras of height three gorenstein ideals 27 support of fn j t x 1 xd have degree n d 12 and are divisible by x j see lemma 8 2 and the discussion following it we illustrate the propositions above with an application to the ideal id b c in the case n d 1 see 30 2 10 for a similar result example 8 6 adopt the setting of definition 8 1 with n d 1 write i for the maximal minor of b obtained by deleting column i the first part of proposition 8 5 or proposition 8 4 a and the fact that fi i show that c is the principal ideal generated by iti for any i with 1 i n therefore id b c is the principal ideal generated by iti the next theorem is 40 8 3 theorem 8 7 adopt the setting of definition 8 1 with 3 d n and n odd if n d ht id b then the following statements hold a the ring t id b c is cohen macaulay on the punctured spectrum and depth t id b c 1 if d is odd 2 if d is even and d 3 n n 1 if d 1 n b the unmixed part of id b is equal to id b unm id b c c if d is odd then the ideal id b is unmixed furthermore id b has a linear free resolution and reg t id b d 1 d the hilbert series of t id b c is d 2 0 n d 1 n d 1 z n d 2 0 1 d 1 d 1 d 1 z 2 d n 1 z d 1 d j n d 32 j d 1 d 1 z 2 j 2 d n e the multiplicity of t id b c is n d 2 i 0 n 2 2 i d 2 remark the conclusions of assertion c do not hold when d is even the ideal id b can be mixed and the minimal homogeneous resolution of id b unm may not be linear see for example 40 4 4 5 corollary 8 8 adopt data 3 1 further assume that i is a linearly presented gorenstein ideal of height three let be a minimal homogeneous alternating presentation matrix for g 1 gn b be the jacobian dual of in the sense of 3 6 and c be the content ideal of definition 8 1 then id b c id b t t 1 tn i x in particular id b c is contained in the defining ideal j of the rees ring of i 28 andrew r kustin claudia polini and bernd ulrich proof the first containment follows from proposition 8 4 c since i is linearly presented id b is an ideal of t and therefore id b i x according to 3 6 2 and 3 3 1 now the second contain ment follows because i x is a prime ideal containing id b but not t 1 tn 9 defining equations of blowup algebras of linearly presented height three gorenstein ideals in this section we assemble the proof of the main result of the paper theorem 9 1 we also provide a more detailed version of the theorem than the one stated in the introduction in particular we express the relevant defining ideals as socles and iterated socles theorem 9 1 let r k x 1 xd be a polynomial ring over a field k i be a linearly presented gorenstein ideal of height three which is minimally generated by homogeneous forms g 1 gn be a minimal homogeneous alternating presentation matrix for g 1 gn b be the jacobian dual of in the sense of 3 6 c be the ideal of t k t 1 tn given in definition 8 1 and l be the ideal of s r t 1 tn which defines sym i as described in 3 6 if i satisfies gd then the following statements hold a the ideal of s defining the rees ring of i is j l id b s c s if d is odd then c is zero and j has the expected form b the ideal of t defining the variety x parametrized by g 1 gn is i x id b c c the two ideals j and s x 1 xd t 1 tn of s are equal d the three ideals i x id b t t 1 tn and id b unm of t are equal proof from corollary 8 8 we have the containment 9 1 1 id b c i x if n d then j l by 3 7 2 and hence i x 0 by 3 3 1 which also gives id b c 0 therefore we may assume that d n corollary 6 4 guarantees that the ideal i is of fiber type which means that j l i x s see 3 4 thus a follows from part b and remark 8 3 b according to theorem 4 4 the homogeneous coordinate ring a t i x of x has dimension d now remark 7 4 and theorem 7 2 a show that 9 1 2 ht id b ht i x n d the hypothesis of theorem 8 7 is satisfied hence assertions b and e of theorem 8 7 yield 9 1 3 id b unm id b c the equations defining blowup algebras of height three gorenstein ideals 29 and the multiplicity of t id b c is n d 2 i 0 n 2 2 i d 2 by theorem 4 4 the coordinate ring a t i x has the same multiplicity by 9 1 1 and 9 1 2 the rings t id b c and t i x have the same dimension and by 9 1 3 both rings are unmixed hence the containment id b c i x of 9 1 1 is an equality and b is also established part d follows from corollary 8 8 part b and 9 1 3 for the proof of c notice that parts a b and d give j id b t t 1 tn s therefore j id b s s t 1 tn since id b s s x 1 xd according to 3 6 2 we obtain j s x 1 xd s t 1 tn s x 1 xd t 1 tn j remark 9 2 adopt data 3 1 the assumption in theorem 9 1 that i is linearly presented can be weakened to the condition that the entries of a minimal homogeneous presentation matrix of i generate a complete intersection ideal indeed let be a minimal homogeneous alternating presentation matrix of g 1 gn by the symmetry of the minimal homogeneous r resolution of r i all entries of have the same degree d let y 1 ys be a regular sequence of homogeneous forms of degree d that generate i 1 these forms are algebraically independent over k and r k x 1 xd is flat over the polynomial ring k y 1 ys the entries of are forms of degree d and are r linear combinations of y 1 ys hence these entries are linear forms in the ring k y 1 ys since g 1 gn are signed submaximal paffians of according to 8 these elements also belong to the ring k y 1 ys and by flat descent they satisfy the assumptions of theorem 9 1 as elements of this ring now apply theorem 9 1 flat base change then gives the statements about the rees ring over r with y 1 ys in place of x 1 xd the statements about the ideal i x are independent of the ambient ring paper 40 was written with the intention of understanding the ideals id b unm in order to deter mine the equations defining the rees algebra and the special fiber ring of height three gorenstein ideals the ultimate goal of the present paper in particular in 40 the ideals id b unm have been re solved now that we have proven that id b unm defines the special fiber ring we are able to harvest much information from the results of 40 corollary 9 3 adopt the notation and hypotheses of theorem 9 1 the following statements hold a the variety x is cohen macaulay 30 andrew r kustin claudia polini and bernd ulrich b if n d 1 then the homogeneous coordinate ring a of x is cohen macaulay otherwise depth a 1 if d is odd 2 if d is even c if d is odd and d n then i x has a linear free resolution and reg a d 1 d if d n then the hilbert series of a is d 2 0 n d 1 n d 1 z n d 2 0 1 d 1 d 1 d 1 z 2 d n 1 z d 1 d j n d 32 j d 1 d 1 z 2 j 2 d n proof we may assume that d n since otherwise i x 0 see 3 7 2 and 3 3 1 from theo rem 9 1 b we know that i x id b c where c 0 if d is odd thus the assertions are items a c and d of theorem 8 7 which applies due to 9 1 2 remark the minimal homogeneous resolution of the ideal i x may not be linear when d is even see 40 4 4 5 references 1 i aberbach s huckaba and c huneke reduction numbers rees algebras and pfaffian ideals j pure appl algebra 102 1995 1 15 2 m artin and m nagata residual intersection in cohen macaulay rings j math kyoto univ 12 1972 307 323 3 g boffi and r sa nchez on the resolutions of the powers of the pfaffian ideal j algebra 152 1992 463 491 4 m boij j migliore r m miro roig u nagel and f zanello on the weak lefschetz property for artinian gorenstein algebras of codimension three j algebra 403 2014 48 68 5 j a boswell and v mukundan rees algebras and almost linearly presented ideals j algebra 460 2016 102 127 6 w bruns a conca and m varbaro relations between the minors of a generic matrix adv math 244 2013 171 206 7 w bruns a conca and m varbaro maximal minors and linear powers j reine angew math 702 2015 41 53 8 d buchsbaum and d eisenbud algebra structures for finite free resolutions and some structure theorems for ideals of codimension 3 amer j math 99 1977 447 485 9 l burch on ideals of finite homological dimension in local rings proc camb philos soc 64 1968 941 948 10 l buse on the equations of the moving curve ideal of a rational algebraic plane curve j algebra 321 2009 2317 2344 11 m chardin d eisenbud and b ulrich hilbert functions residual intersections and residually s 2 ideals compo sitio math 125 2001 193 219 12 a conca and g valla betti numbers and lifting of gorenstein codimension three ideals comm algebra 28 2000 1371 1386 13 t cortadellas ben tez and c d andrea rational plane curves parameterizable by conics j algebra 373 2013 453 480 14 t cortadellas ben tez and c d andrea minimal generators of the defining ideal of the rees algebra associated with a rational plane parametrization with 2 canad j math 66 2014 1225 1249 15 d cox j w hoffman and h wang syzygies and the rees algebra j pure appl algebra 212 2008 1787 1796 16 e de negri and g valla the h vector of a gorenstein codimension three domain nagoya math j 138 1995 113 140 17 s diesel irreducibility and dimension theorems for families of height 3 gorenstein algebras pacific j math 172 1996 365 397 18 d eisenbud c huneke and b ulrich the regularity of tor and graded betti numbers amer j math 128 2006 573 605 the equations defining blowup algebras of height three gorenstein ideals 31 19 d eisenbud and b ulrich row ideals and fibers of morphisms mich math j 57 2008 261 268 20 j elias and a iarrobino the hilbert function of a cohen macaulay local algebra extremal gorenstein algebras j algebra 110 1987 344 356 21 f gaeta ricerche intorno alle varieta matriciali ed ai loro ideali atti del quarto congresso dell unione matem atica italiana taormina ii 1951 326 328 22 a geramita and j migliore reduced gorenstein codimension three subschemes of projective space proc amer math soc 125 1997 943 950 23 l gruson r lazarsfeld and c peskine on a theorem of castelnuovo and the equations defining space curves invent math 72 1983 491 506 24 r hartshorne geometry of arithmetically gorenstein curves in p 4 collect math 55 2004 97 111 25 j herzog a simis and w v vasconcelos koszul homology and blowing up rings commutative algebra trento 1981 pp 79 169 lecture notes in pure and appl math 84 dekker new york 1983 26 j herzog w v vasconcelos and r villarreal ideals with sliding depth nagoya math j 99 1985 159 172 27 j hong a simis and w v vasconcelos on the homology of two dimensional elimination j symbolic comput 43 2008 275 292 28 c huneke linkage and the koszul homology of ideals amer j math 104 1982 1043 1062 29 c huneke and m rossi the dimension and components of symmetric algebras j algebra 98 1986 200 210 30 m johnson second analytic deviation one ideals and their rees algebras j pure appl algebra 119 1997 171 183 31 j p jouanolou re sultant anisotrope comple ments et applications the foata festschrift electron j combin 3 1996 32 j p jouanolou formes d inertie et re sultant un formulaire adv math 126 1997 119 250 33 k kimura and n terai arithmetical rank of gorenstein squarefree monomial ideals of height three j algebra 422 2015 11 32 34 j kleppe and r m miro roig the dimension of the hilbert scheme of gorenstein codimension 3 subschemes j pure appl algebra 127 1998 73 82 35 a kustin c polini and b ulrich rational normal scrolls and the defining equations of rees algebras j reine angew math 650 2011 23 65 36 a kustin c polini and b ulrich the bi graded structure of symmetric algebras with applications to rees rings j algebra 469 2017 188 250 37 a kustin c polini and b ulrich blowups and fibers of morphisms nagoya math j 2016 1 34 doi http dx doi org 10 1017 nmj 2016 34 38 a kustin c polini and b ulrich the hilbert series of the ring associated to an almost alternating matrix comm algebra 44 2016 3053 3068 39 a kustin c polini and b ulrich degree bounds for local cohomology preprint 2015 on the arxiv 40 a kustin c polini and b ulrich a matrix of linear forms which is annihilated by a vector of indeterminates j algebra 469 2017 120 187 41 a kustin and b ulrich a family of complexes associated to an almost alternating map with applications to residual intersections mem amer math soc 95 1992 no 461 42 a iarrobino associated graded algebra of a gorenstein artin algebra mem amer math soc 107 1994 no 514 43 a iarrobino and v kanev power sums gorenstein algebras and determinantal loci lecture notes in mathematics 1721 springer verlag berlin 1999 44 j madsen equations of rees algebras of ideals in two variables preprint 2015 45 j migliore and c peterson a construction of codimension three arithmetically gorenstein subschemes of projective space trans amer math soc 349 1997 3803 3821 46 s morey equations of blowups of ideals of codimension two and three j pure appl algebra 109 1996 197 211 47 s morey and b ulrich rees algebras of ideals with low codimension proc amer math soc 124 1996 3653 3661 48 l nguyen on rees algebras of linearly presented ideals j algebra 420 2014 186 200 49 c polini and b ulrich necessary and sufficient conditions for the cohen macaulayness of blowup algebras com positio math 119 1999 185 207 50 b ulrich artin nagata properties and reductions of ideals contemp math 159 1994 373 400 51 w v vasconcelos on the equations of rees algebras j reine angew math 418 1991 189 218 52 j watanabe a note on gorenstein rings of embedding codimension three nagoya math j 50 1973 227 232 http dx doi org 10 1017 nmj 2016 34 32 andrew r kustin claudia polini and bernd ulrich department of mathematics university of south carolina columbia sc 29208 e mail address kustin math sc edu department of mathematics university of notre dame notre dame in 46556 e mail address cpolini nd edu department of mathematics purdue university west lafayette in 47907 e mail address ulrich math purdue edu 1 introduction 2 conventions and notation 3 defining equations of graphs and images of rational maps 4 the degree of the image of a rational map 5 results from degree bounds for local cohomology 6 bounding the degrees of defining equations of rees rings 7 the defining ideal of rees rings up to radical 8 the candidate ideal c 9 defining equations of blowup algebras of linearly presented height three gorenstein ideals references