ar x iv 1 61 0 03 82 0 v 1 m at h a c 1 2 o ct 2 01 6 implicitization of tensor product surfaces in the presence of a generic set of basepoints eliana duarte abstract given a 4 dimensional vector subspace u f 0 f 3 ofh 0 p 1 p 1 o a b a tensor product surface denoted by xu is the closure of the image of the rational map u p 1 p 1 99 k p 3 determined by u these surfaces arise in geometric modeling and in this context it is useful to know the implicit equation of xu in p 3 in this paper we show that if u h 0 p 1 p 1 o a 1 has a finite set of r basepoints in generic position then the implicit equation of xu is determined by two syzygies of iu f 0 f 3 in bidegrees a r 2 0 and a r 2 0 this result is proved by understanding the geometry of the basepoints of u in p 1 p 1 the proof techniques for the main theorem also apply when u is basepoint free contents 1 introduction 1 2 points in p 1 p 1 4 3 ideal of a generic set of points in p 1 p 1 7 4 syzygies of the ideal iu 10 5 applications to implicitization of tensor product surfaces 12 references 18 1 introduction given a parameterized curve or surface in projective space the implicitization problem consists on finding the equations whose vanishing is the closed image of the given param eterization the implicitization problem has been of increasing interest to commutative algebraists and algebraic geometers due to its applications in computer aided geometric design cagd in this context knowing the implicit equation of the curve or surface is important to perform elementary operations with these objects for example describing the curve of intersection of two surfaces or the points of intersection of a curve and a 1 http arxiv org abs 1610 03820 v 1 2 eliana duarte surface equally important is the problem of testing if a given point in the codomain lies in the image of a parameterization using the implicit equations of a curve or surface to perform these operations is computationally and theoretically more efficient than only working with the parameterizations for this reason there is great interest in finding faster algorithms that compute implicit equations of parameterized curves and surfaces there are several general techniques to solve the implicitization problem for parame terized surfaces these include gro bner bases resultants and syzygies to summarize gro bner bases algorithms provide a straightforward theoretical approach that in practice tends to be very slow resultants provide a more convenient representation of the implicit equation as a determinant of a matrix but they fail for parameterizations with basepoints in contrast since their first appearance in the work of sederberg and chen 15 and cox 8 syzygies have provided faster methods to obtain implicit equations that work for more general parameterizations we elaborate more on these methods and compare timings for some examples in section 5 we now focus on the implicitization problem for tensor product surfaces given a 4 di mensional vector space u f 0 f 3 h 0 p 1 p 1 o a b with gcd f 0 f 3 1 we obtain a rational map u p 1 p 1 99 k p 3 a tensor product surface is the closure of the image of u and is denoted xu in this paper we use syzygy techniques to obtain the implicit equation of a tensor product surface xu one of the main tools of this approach is the approximation complex z defined in section 5 approximation complexes were first introduced by herzog simis and vasconcelos 13 to study the defining equations of rees algebras of ideals an introduction to the use of these complexes to obtain implicit equa tions of parameterized hypersurfaces and the connection with rees algebras can be found in chardin s 5 work these techniques were generalized for multigraded hypersurfaces such as tensor product surfaces by botbol 1 in section 5 we use botbol s results to obtain the implicit equation of xu via z in short to find the implicit equation of xu using z we fix a basis and find the matrices representing the maps of z in a suitable degree finally the determinant of the complex z is a power of the implicit equation of xu it is important to point out that for most practical purposes in cagd knowing the matrix of the map d 1 z 1 z 0 is sufficient to perform the aforementioned elementary operations with curves and surfaces for example as shown by buse and luu ba 4 for the intersection of two surfaces the matrix d 1 is known as a representation matrix for xu representation matrices are generically of full rank and the gcd of its maximal minors is equal to a power of the implicit equation of implicitization of tensor product surfaces in the presence of basepoints 3 xu these matrices have been studied by botbol and dickenstein 3 and botbol buse and chardin 2 among others the connection of z with the syzygies of u f 0 f 3 comes from the observation that z 1 syz f 0 f 3 s where s k x y z w is the coordinate ring of p 3 thus to obtain the matrices in z we are led to the computation of syz f 0 f 3 let iu f 0 f 3 be the ideal generated by u inside the total coordinate ring of p 1 p 1 the vanishing locus v iu inside p 1 p 1 is referred to as the set of basepoints of u and is denoted by x if x 6 we say u has basepoints otherwise we say u is basepoint free we also refer to x as the base locus of u the content of this paper follows the ideas from duarte and schenck 10 and of schenck seceleanu and validashti 14 in which the goal is to understand the syzygies that determine z we focus on tensor product surfaces xu such that u h 0 p 1 p 1 o a b has b 1 and such that x is a finite set of generic points tensor product surfaces for which b 1 are also known as rational ruled surfaces in the literature these surfaces have been studied before by chen zheng and sederberg 7 and by dohm 9 chen zheng and sederberg show that the implicit equation of a generically injective parameterization can be obtained from a submodule of the module of syzygies of u and show that this module is of rank two dohm generalizes these results for a parameterization of any degree and provides an algorithm to reparameterize the given rational ruled surface in this work we study the syzygies of u based on the geometry of its base locus x this approach gives the exact degrees of the syzygies that determine z and answers the question raised by chen cox and liu 6 of what can be said about the degrees of the syzygies that determine the implicit equation the statement of the main theorem is the following theorem 1 1 let ix a 1 h 0 a 1 be the k vector space of forms of bidegree a 1 that vanish at a generic set x of r points in p 1 p 1 take u f 0 f 3 to be a generic 4 dimensional vector subspace of ix a 1 and u p 1 p 1 99 k p 3 the rational map deter mined by u then the first map of the approximation complex z in bidegree 2 a 1 0 d 1 is determined by the syzygies of f 0 f 3 in bidegrees a r 2 0 a r 2 0 the map d 1 completely determines the approximation complex z in degree from which we compute the implicit equation of xu using the description of some of the minimal generators the ideal ix associated to a generic set of points x in p 1 p 1 given by van tuyl 17 we are able to understand exactly the degrees of the syzygies of f 0 f 3 that determine the implicit equation of xu the subsequent sections of this paper are organized as follows in section 2 we introduce basic 4 eliana duarte notation and several tools to study points in p 1 p 1 in section 3 we use results of van tuyl 17 to describe the minimal generators of the bihomogeneous ideal ix associated to a set x of points in p 1 p 1 in generic position in section 4 we use the results from section 3 to describe the syzygies of the ideal iu where u ix a 1 is a generic four dimensional vector subspace finally in section 5 we use the results from the previous sections to prove the main theorem for implicitization of tensor product surfaces in the presence of a generic set of basepoints by using the complex z and give some examples throughout this paper k will denote an algebraically closed field of characteristic zero 2 points in p 1 p 1 the idea to prove theorem 1 1 is to study the geometry of the base locus of u in p 1 p 1 to do this we focus on the ideals of r that correspond to generic points in p 1 p 1 in this section we describe such ideals and state a theorem of van tuyl for their bigraded hilbert functions 2 1 notation let r 0 a 0 b h 0 p 1 p 1 o a b be the total coordinate ring of p 1 p 1 for shorter notation we write h 0 a b for h 0 p 1 p 1 o a b the ring r is a bigraded k algebra by taking r a b h 0 a b and r is generated as a k algebra by h 0 1 0 and h 0 0 1 note that dimh 0 1 0 dimh 0 0 1 2 if s t is a basis for h 0 1 0 and u v a basis for h 0 0 1 then r k s t k u v with grading given by deg s t 1 0 and deg u v 0 1 an element f r is bihomogeneous if f r i j for some i j n if f is bihomogeneous we say that its bidegree is degf i j suppose that i f 1 fn r is an ideal if each fi is bihomogeneous then we say that i is a bihomogeneous ideal for u f 0 f 3 h 0 a 1 we let iu f 0 f 3 be the bihomogeneous ideal of r generated by the elements of u 2 2 description of sets of points in p 1 p 1 we follow the notation and definitions from giuffrida maggioni and ragusa 11 and from guardo and van tuyl 12 to describe sets of points in p 1 p 1 a point in p 1 p 1 is a pair a b where a p 1 and b p 1 let h be a non zero linear form in the variables s t that vanishes at a and let l be a non zero linear form in the variables u v that vanishes at b the ideal of r that corresponds to p is denoted by ip and ip h l we think of the form h as a 1 0 line and of l as a 0 1 line in p 1 p 1 these lines are members of the two different rulings of p 1 p 1 and a point in p 1 p 1 is uniquely determined by their intersection if x p 1 pr is a implicitization of tensor product surfaces in the presence of basepoints 5 set of r distinct points and ipi hi li then ix the ideal corresponding to x is given by ix r i 1 ipi there are two projections i p 1 p 1 p 1 defined by 1 a b a and 2 a b b we can visualize points in p 1 p 1 as lying inside a grid of 1 0 and 0 1 lines from now on 1 0 lines will be drawn horizontally and 0 1 lines will be drawn verti cally throughout this paper x will denote a finite set of points in p 1 p 1 and ix will denote its corresponding defining ideal in r as with sets of points in pn we use hilbert functions to study sets of points in p 1 p 1 since the ring r is bigraded the hilbert function of x takes the shape of a matrix definition 2 1 let x be a finite set of points in p 1 p 1 the bigraded hilbert function of x hx z z n is defined by hx i j dimk r i j dimk ix i j the bigraded hilbert function of x has similar properties to the hilbert function of a set of points in projective space when p 1 p 1 is considered as a subvariety of p 3 by the segre embedding x becomes a subscheme of p 3 in this case hx i hx i i degx for all i 0 the work of guardo and van tuyl 12 provides a thorough introduction to the study of bigraded hilbert functions of points in p 1 p 1 2 3 combinatorial description of sets of points in p 1 p 1 using the description of a single point in p 1 p 1 as the intersection of a 1 0 line and a 0 1 line a set of points in p 1 p 1 can be visualized as markings of some intersection points inside a rectangular grid as in example 2 4 we describe sets of points in a combinatorial way using partitions let h 1 hq be the horizontal lines in p 1 p 1 that contain points of x the ordering of these lines doesn t play any role so we may arrange them in such a way that x h 1 x h 2 x hq let i x hi and associate to x the tuple x 1 q note that x is a partition of x an analogous process yields a partition x from x which depends on the points on the vertical rulings of x for the next theorem we use the notion of the conjugate of a partition definition 2 2 the conjugate of a partition is the tuple 1 1 where i j j i 6 eliana duarte for a set x of points in p 1 p 1 we usually have x 6 x theorem 2 3 describes the hilbert function hx i j for i j 0 0 in terms of the partitions it was first formulated by van tuyl 16 here we use the statement from guardo and van tuyl 12 theorem 2 3 guardo van tuyl 12 let x p 1 p 1 be any set of points with associ ated tuples x 1 h and x 1 and let h 1 x and 2 x 1 for all j n if i h 1 then hx i j 1 j 1 where x 1 1 is the conjugate of x and where we make the convention that l 0 if l 1 2 for all i n if j 1 then hx i j 1 j 1 where x 1 1 is the conjugate of x and where we make the convention that l 0 if l 1 thus if we know the values of hx i j for i j 0 we are able to determine and this in turn gives us information about the vertical an horizontal rulings that contain x we will use this theorem to give a geometric description of a generic set of r points in p 1 p 1 in subsection 3 2 example 2 4 let x be the set of points in p 1 p 1 on the left below then x 4 4 3 2 x 3 2 2 2 2 2 and x 4 4 3 2 x 6 6 1 the previous theorem implies that hx has the following form l 1 l 2 l 3 l 4 l 5 l 6 h 1 h 2 h 3 h 4 t t t t t t t t t t t t t hx 0 1 2 3 4 5 6 0 6 6 1 12 12 2 13 13 3 4 8 11 13 13 13 13 4 4 8 11 13 13 13 13 the blank entries cannot in general be deduced from the information contained in x and x in examples 3 4 and 3 5 we illustrate this fact with two sets of points x 1 x 2 in p 1 p 1 whose hilbert function is different but for which x 1 x 2 and x 1 x 2 implicitization of tensor product surfaces in the presence of basepoints 7 3 ideal of a generic set of points in p 1 p 1 in this section we describe minimal generators of ix in bidegree a 1 when x is a generic set of points of p 1 p 1 for this purpose we use the work of van tuyl 17 for the case of p 1 p 1 using this description in section 4 will allow us to find syzygies of iu f 0 f 3 3 1 description of ix definition 3 1 let x be a set of r points in p 1 p 1 the set x is said to be generic if its bigraded hilbert function is determined by hx i j min i 1 j 1 r being a generic set of points is a property of the hilbert function note that from the definition of a generic set of points in p 1 p 1 we cannot immediately describe the bidegrees of the minimal generators of ix nor the distribution of the points of x in families of 1 0 and 0 1 lines we focus on describing these two aspects for the rest of this section if e is any subset of n 2 and a a 0 a 1 n 2 is any tuple then e a denotes the set e a e e let e 1 1 0 and e 2 0 1 for every i 0 j i min t n hx i t hx i t 1 and for every j 0 i j min t n hx t j hx t 1 j theorem 3 2 van tuyl 17 let x be a finite set of points in p 1 p 1 fix e 1 1 0 and j n set i i j j then ix i q 1 e 1 re 1 ix i qe 1 q n in particular if there exists l n 2 and t 1 2 such that hx l hx l et hx l 2 et then ix has no minimal generators of bidegree l theorem 3 2 gives a way to exclude bidegrees that will not show up as bidegrees of minimal generators for ix it also gives us a description of the higher degree pieces of ix once the bigraded hilbert function has stabilized in one of the coordinates define the k s t module m by m i 0 ix i 1 8 eliana duarte following the notation of theorem 3 2 fix j 1 then i 1 is the value of i at which the bigraded hilbert function hx of x stabilizes for the column j 1 so for all q n hx i 1 1 hx i 1 q 1 recall that r is the number of points in x we want to find i 1 and understand the generators of m as a k s t module proposition 3 3 let x be a generic set of r points in p 1 p 1 with associated biho mogeneous ideal ix then the k s t module m has two minimal generators in bidegrees k 1 k 1 if r 2 k and two minimal generators in bidegrees k 1 k 1 1 if r 2 k 1 proof suppose r 2 k then hx i 1 min r i 1 2 for all 0 i k 1 hx i 1 i 1 2 and for i k 1 hx i 1 r thus i 1 k 1 and we have r hx k 1 1 hx k 1 hx k 1 1 using theorem 3 2 we know that ix has no minimal generators of degree k 1 1 or higher thus possible minimal generators of ix are in bidegrees k 1 1 k 1 but we have 1 hx k 1 1 r dimr k 1 1 dim ix k 1 1 so dim ix k 1 1 0 and ix does not have generators in bidegree k 1 1 a similar equation to 1 shows that dim ix k 1 2 therefore m has two generators of bidegree k 1 moreover using the last part of theorem 3 2 we have 2 ix i 1 q 1 e 1 re 1 ix i 1 qe 1 q n since re 1 s t this shows m has two generators in bidegree k 1 as a k s t module the proof for the case when r is odd is done in a similar way 3 2 geometric description of x in terms of rulings let x be a set of generic points in p 1 p 1 using the hilbert function of x we see that for i j with 0 j and i r 1 hx i j r and for i j with 0 i and j r 1 hx i j r using theorem 2 3 we know that for j 0 and i 0 hx i 0 1 r since x consists exactly of r points we conclude that i 0 for all i 0 and x 1 1 has r parts similarly x 1 1 has r parts using the definition of x we know that the number of parts of x is equal to the number of horizontal lines in p 1 p 1 that contain points of x implicitization of tensor product surfaces in the presence of basepoints 9 moreover each part i of x corresponds to the number of points in x that lie on the horizontal line hi from x 1 1 we conclude that there are r distinct horizontal lines in p 1 p 1 each containing exactly one point of x we have a similar statement for x and vertical lines after reordering of the vertical and horizontal lines that contain points of x we can describe x as the set of diagonal points inside an r r grid of lines example 3 4 let ix 1 s u t v s 3 t u v s t u 5 v using macaulay 2 we compute the bigraded hilbert function hx 1 on the right and conclude x 1 is generic the distribution of x 1 on the rulings of p 1 p 1 is illustrated on the left u v u v u 5 v s t s 3 t s t r r r r hx 0 1 2 3 4 0 1 2 3 4 4 1 2 4 4 4 4 2 3 4 4 4 4 3 4 4 4 4 4 4 4 4 4 4 4 using proposition 3 3 we know ix 1 has two generators g 1 g 2 in bidegree 2 1 a macaulay 2 computation yields g 1 6 t 2 u 7 s 2 v 23 stv g 2 2 stu 3 s 2 v 7 stv example 3 5 let ix 2 s u t v s t u v s t u v using macaulay 2 we compute the bigraded hilbert function hx 2 on the right and conclude that x 2 is not generic u v u v u v s t s t s t r r r r hx 0 1 2 3 4 0 1 2 3 4 4 1 2 3 4 4 4 2 3 4 4 4 4 3 4 4 4 4 4 4 4 4 4 4 4 the ideal ix 2 has a minimal generator of bidegree 1 1 whereas the generic set of points x 1 from example 3 4 has no generator of such bidegreee however we have x 1 x 2 and x 1 x 2 in this case the module m from proposition 3 3 has two generators of bidegrees 1 1 and 3 1 10 eliana duarte 4 syzygies of the ideal iu as was highlighted in the introduction the syzygies of iu determine the complex z which in turn determine the implicit equation of xu let syz iu 0 denote the k s t module of syzygies of iu f 0 f 3 r of degree zero in u v the following proposition states that syz iu 0 has rank two and gives the bidegrees of its minimal generators proposition 4 1 let x be a generic set of r points in p 1 p 1 and let u f 0 f 3 be a generic 4 dimensional vector space of ix a 1 with a k then the k s t module syz iu 0 has rank two moreover syz iu 0 has minimal generators of bidegree a k 0 if r 2 k and of bidegrees a k 0 a k 1 0 if r 2 k 1 remark 4 2 if b b 1 bq is a basis for ix a 1 we make the convention that a generic choice of u is given by a matrix c of size 4 q with f cb all of whose maximal minors are nonzero the proof of proposition 4 1 will be done in four steps the steps that will follow are done for the case r 2 k if r 2 k 1 similar steps work by changing to a k 0 and a k 1 0 step 1 use the description of a basis for ix a 1 to show that the generators of the ideal iu may be written in a simpler and more convenient form from proposition 3 3 we know ix k 1 is generated by two elements g 1 g 2 thus by equation 2 in the proof of proposition 3 3 a basis for ix a 1 is given by b sjg 1 s j 1 tg 1 t jg 1 s jg 2 st j 1 g 2 t jg 2 where j a k following our convention from remark 4 2 a generic choice of u is a coefficient matrix c such that every maximal minor of c is nonzero with f cb using the basis b for ix a 1 f 0 f 1 f 2 f 3 t sjg 1 s j 1 tg 1 t jg 1 s jg 2 t jg 2 c t the first j 1 elements of the basis share the common factor g 1 and the last j 1 elements share the factor g 2 thus we may write 3 f 0 f 1 f 2 f 3 g 1 g 2 q 0 q 1 q 2 q 3 p 0 p 1 p 2 p 3 where degqi degpi j 0 are forms in the variables s t denote the rightmost matrix in 3 by qp implicitization of tensor product surfaces in the presence of basepoints 11 using the notation in the first step we let 4 q 0 q 1 q 2 q 3 s j sj 1 t tj at and 5 p 0 p 1 p 2 p 3 s j sj 1 t tj bt denote the matrix of coefficients of qi s by a and the matrix of coefficients of pi s by b observe that c is the block matrix formed by a and b so c a b step 2 reduce the problem to the study of the kernel of the matrix qp lemma 4 3 the ideal iu has a syzygy l of bidegree 0 if and only if l is an element in the kernel of the matrix qp q 0 q 1 q 2 q 3 p 0 p 1 p 2 p 3 over the ring k s t proof suppose that l s 0 s 1 s 2 s 3 is a syzygy of f 0 f 1 f 2 f 3 of degreee 0 then s 0 f 0 s 1 f 1 s 2 f 2 s 3 f 3 0 using step 1 fi qig 1 pig 2 we may substitute this in the previous equation and factor g 1 and g 2 as follows s 0 q 0 s 1 q 1 s 2 q 2 s 3 q 3 g 1 s 0 p 0 s 1 p 1 s 2 p 2 s 3 p 3 g 2 0 the elements g 1 g 2 are minimal generators of ix and thus form a complete intersection using the fact that the only syzygies of a complete intersection are koszul we obtain s 0 q 0 s 1 q 1 s 2 q 2 s 3 q 3 s 0 p 0 s 1 p 1 s 2 p 2 s 3 p 3 q g 2 g 1 note that deg s 0 q 0 s 1 q 1 s 2 q 2 s 3 q 3 deg s 0 p 0 s 1 p 1 s 2 p 2 s 3 p 3 j 0 but deg gi k 1 hence q 0 and s 0 q 0 s 1 q 1 s 2 q 2 s 3 q 3 s 0 p 0 s 1 p 1 s 2 p 2 s 3 p 3 0 so l kerqp verifying the other direction is straightforward from the previous calcula tions 12 eliana duarte step 3 when qp is a matrix whose entries are polynomials in k s t of degree j with coefficients from a generic matrix c as in equations 4 and 5 the kernel of qp has rank two and its minimal generators are of degree j a quick check reveals that the assumption gcd f 0 f 3 1 implies the matrix qp has rank two then it can be proved that if the coefficients of qp are chosen generically following remark 4 2 the two minimal generators of kerqp have degree j a k if the coefficients of qp are not chosen generically we can expect the degrees of the two minimal generators of kerqp to be less than or equal to j step 4 using step 2 we know that the syzygies of iu in bidegree 0 are in one to one correspondence with elements in the kernel of qp following step 3 the kernel of qp is generated by two elements k 1 k 2 of degree j in s t hence iu has two minimal syzygies of bidegree j 0 remark 4 4 note that the two elements k 1 k 2 in the kernel of qp generate a free module indeed qp fits into a sequence 6 0 s 2 s 4 qp s 2 coker qp 0 where the leftmost nonzero map sends s 2 to the two syzygies k 1 k 2 and s k s t then by hilbert s syzygy theorem over s the leftmost map in the sequence 6 is injective 5 applications to implicitization of tensor product surfaces we now focus on obtaining the implicit equation of xu when u f 0 f 3 ix a 1 is a generic 4 dimensional subspace first we give a definition of z and explain how to set up the complex z with an example next we give a proof of the main theorem and apply these techniques for the basepoint free case we also illustrate the advantages of the syzygy method over gro bner bases all of the examples presented in this section were computed using the software macaulay 2 throughout this section the implicit equation of a parameterized surface in p 3 will be denoted by h and it is an element in s k x y z w 5 1 implicitization via syzygies given u f 0 f 3 the complex z has zi ker d f i s where d f i is the differential of the koszul complex associated with the se quence f f 0 f 3 and s k x y z w is the coordinate ring of p 3 the differ ential i zi zi 1 for the complex z is defined to be the differential of the koszul complex associated with the sequence x y z w we use the results by botbol 1 implicitization of tensor product surfaces in the presence of basepoints 13 to compute the implicit equation of xu via the approximation complex z recall that z 1 syz f 0 f 3 s theorem 5 1 botbol 1 let p 1 p 1 99 k p 3 be a rational map with finitely many local complete intersection basepoints given by 4 bihomogeneous polynomials f 0 f 3 r a b without common factors then for 2 a 1 b 1 equiv a 1 2 b 1 detz h deg k x y z w where h is the irreducible implicit equation of xu since u ix a 1 x is the set of basepoints of xu and we are able to use theorem 5 1 to illustrate how the computation of the implicit equation works we have the following example example 5 2 let x be the set of points in p 1 p 1 associated to the ideal ix s u t v uv sv tu st computing the hilbert function of x in macaulay 2 shows that x is generic take a 1 3 1 then ix 3 1 s 3 v t 3 u s 2 tu s 2 tv st 2 u st 2 v we take u to be the generic 4 dimensional subspace given by u s 3 v st 2 u st 2 v t 3 u st 2 u st 2 v s 2 tu st 2 u 3 st 2 v s 2 tv 5 st 2 u st 2 v to compute the implicit equation of xu we need to set up the complex z and then find detz the complex z z 0 z 2 d 2 z 1 d 1 z 0 0 only has three nonzero terms and it is exact following theorem 5 1 5 0 the ideal iu has two syzygies in degree 2 0 and three syzygies in bidegree 1 1 the syzygies in degree 2 0 span a free r module and determine a basis for the syzygies of bidegree 5 0 by multiplying by s 3 s 2 t st 2 t 3 we proceed to apply the map 1 to this basis and obtain the matrix d 1 using macaulay 2 and d 2 ker d 1 we obtain d 1 107 y 0 0 0 107 w 0 0 0 228 y 107 z 52 w 107 y 0 0 107 x 1082 y 535 z 335 w 107 w 0 0 55 x 32 z 41 w 228 y 107 z 52 w 107 y 0 442 x 49 z 295 w 107 x 1082 y 535 z 335 w 107 w 0 0 55 x 32 z 41 w 228 y 107 z 52 w 107 y 0 442 x 49 z 295 w 107 x 1082 y 535 z 335 w 107 w 0 0 55 x 32 z 41 w 228 y 107 z 52 w 0 0 442 x 49 z 295 w 107 x 1082 y 535 z 335 w 0 0 0 55 x 32 z 41 w 0 0 0 442 x 49 z 295 w 14 eliana duarte d 2 1 107 w 0 1 107 x 1082 11449 y 5 107 z 335 11449 w 1 107 w 442 11449 x 49 11449 z 295 11449 w 1 107 x 1082 11449 y 5 107 z 335 11449 w 0 442 11449 x 49 11449 z 295 11449 w 1 107 y 0 228 11449 y 1 107 z 52 11449 w 1 107 y 55 11449 x 32 11449 z 41 11449 w 228 11449 y 1 107 z 52 11449 w 0 55 11449 x 32 11449 z 41 11449 w the determinant of z is computed by detz detm 1 detm 2 where m 1 is a maximal nonzero minor of d 1 and m 2 is the complimentary maximal nonzero minor of d 2 detz 8831798120631365 x 3 y 623043212873630840 x 2 y 2 2432437780569525764 xy 3 154155021741929280 x 2 y z 2181293557648299312 xy 2 z 694982223019864504 y 3 z 516419322835463088 xy z 2 679406142698023733 y 2 z 2 167804164291995935 y z 3 29064644724259583 x 2 yw 2253232567794532976 xy 2 w 347491111509932252 y 3 w 8831798120631365 x 2 zw 1142192364219107259 xy zw 288398353175526028 y 2 zw 109996031138772455 xz 2 w 277318460987824861 y z 2 w 33560832858399187 z 3 w 8831798120631365 x 2 w 2 417342605736743957 xy w 2 335768906731639713 y 2 w 2 103733483380506578 xzw 2 6583704053561563 y zw 2 20232846603628218 z 2 w 2 20232846603628218 xw 3 65676462387967787 y w 3 3693297395900389 zw 3 3693297395900389 w 4 as was mentioned in the introduction the matrix d 1 representing the map z 1 z 0 is sufficient to perform the elementary geometric operations that arise in cagd for this reason the growth of the size of the coefficients for the implicit equation in practice does not affect the speed of the computations 5 2 proof of main theorem to prove theorem 1 1 we need two lemmas the first one states the dimension of z 1 and the second one provides a basis for z 1 lemma 5 3 let z be the approximation complex associated to f 0 f 3 with differen tial on the variables x y z w if u f 0 f 3 has r basepoints each of multiplicity one then dimk z 1 2 ab r where 2 a 1 b 1 proof from the proof of lemma 7 3 in botbol 1 we know that z is acyclic and that z 3 0 hence z has the form z 0 z 2 z 1 z 0 0 using lemma 7 3 and 7 4 from botbol 1 and the fact that iu is a local complete inter section botbol observes that dimk z 2 x x ex implicitization of tensor product surfaces in the presence of basepoints 15 where ex denotes the multiplicity of the basepoint x of u and x is the set of basepoints of u since u has r basepoints each of multiplicity one dimk z 2 r also z 0 r 2 a 1 b 1 thus dimk z 0 2 ab it follows that dimk z 1 2 ab r lemma 5 4 let u f 0 f 3 be a generic 4 dimensional vector subspace of ix a 1 and z the approximation complex associated to f 0 f 3 then a basis for z 1 2 a 1 b 1 is obtained by bumping up the syzygies of iu in bidegree a k 0 if r 2 k and the syzygies in bidegrees a k 0 a k 1 0 if r 2 k 1 proof we have z 1 ker d f 1 syz f 0 f 3 thus z 1 syz f 0 f 3 if r is even then iu has two syzygies s 1 s 2 of bidegree a k 0 by proposition 4 1 using remark 4 4 at the end of section 4 we know that s 1 s 2 span a free module hence the set of syzygies s m si m r a k 1 0 i 1 2 is an independent subset of syz f 0 f 3 note that dimk r a k 1 0 a k thus dimk span s 2 a r from lemma 5 3 dim z 1 2 a r hence a basis for z 1 is determined by bumping up s 1 s 2 an analogous argument works in the case r is odd we are now ready to prove theorem 1 1 theorem let ix h 0 a 1 be the k vector space of forms of bidegree a 1 that vanish at a generic setx of r points in p 1 p 1 take u f 0 f 3 to be a generic 4 dimensional vector subspace of ix a 1 and u p 1 p 1 99 k p 3 the rational map determined by u then the first map of the approximation complex z in bidegree 2 a 1 0 is determined by the syzygies of f 0 f 3 in bidegree a k 0 if r 2 k and bidegrees a k 0 a k 1 0 if r 2 k 1 these syzygies completely determine the complex z from which we compute the implicit equation proof we consider the case r 2 k the case r 2 k 1 is done similarly let s 1 s 2 be the two minimal syzygies of iu in bidegree a k 0 by lemma 5 4 z 1 has a basis given by the elements of the form m si where i 1 2 and m r a k 1 0 denote the matrix of the first map of the complex z by d 1 then d 1 is obtained by applying the koszul differential on the sequence x y z w to all the elements m si using the proof of lemma 5 3 we know z is exact hence d 2 ker d 1 therefore the approximation complex z that determines the implicit equation of xu only depends on the syzygies of iu in degree j 0 corollary 5 5 let x be a set of r points in p 1 p 1 with r 2 k take u to be any 4 dimensional vector subspace of ix k 1 1 then xu is smooth 16 eliana duarte proof from proposition 3 3 ix k 1 1 sg 1 tg 1 sg 2 tg 2 so dimk ix k 1 1 4 thus up to a change of coordinates any choice of u is equivalent to the choice u sg 1 tg 1 sg 2 tg 2 for this u it follows that xu v xw y z hencexu is smooth the results in theorem 1 1 do not generalize immediately to tensor product surfaces of more general bidegree a b with b 1 one of the advantages of the condition b 1 is that the calculation of the syzygies of iu is reduced to finding the kernel of the matrix qp over the polynomial ring k s t which has two fewer variables than r this allows us to show in remark 4 4 that the syzygies of iu are free for more general bidegree the syzygies of iu are not free and computing a basis for syz iu is more difficult because of the possible relations between the generators of syz iu it would be interesting to know if the syzygies of iu for u r a b b 1 can also be calculated and understood from the generators of the ideal ix of the basepoints of u as is the case for b 1 5 3 tensor product surfaces without basepoints the main theorem in this paper allows us to describe the syzygies that determine the implicit equation of a map given by 4 generically chosen forms of bidegree a 1 that vanish at a generic set of points in p 1 p 1 the techniques that we used to prove the main theorem depended on understanding the generators of the k s t module m i 0 ix i 1 and using the description of ix a 1 given by 2 from section 3 for the case of basepoints m g 1 g 2 if x then m u v in the proof of the main theorem we may substitute g 1 g 2 for the complete intersection u v and the proof will still be valid we obtain theorem 5 6 let u f 0 f 3 be a basepoint free generic 4 dimensional vector subspace of r a 1 h 0 a 1 and u p 1 p 1 p 3 the regular map determined by u then the first map of the approximation complex z in bidegree 2 a 1 0 is determined by two syzygies of f 0 f 3 in bidegree a 0 a careful study of the implicitization of basepoint free tensor product surfaces of bidegree 2 1 using syzygies was done by schenck seceleanu and validashti 14 theorem 5 6 recovers their results for the case that iu has no linear syzygies and extends them to bidegree a 1 5 4 overview of implicitization methods and examples as mentioned in the in troduction we may use other methods like gro bner bases and resultants to find implicit equations of parameterized surfaces one way to use gro bner bases is to compute the elimination ideal 7 j x f 0 y f 1 z f 2 w f 3 s implicitization of tensor product surfaces in the presence of basepoints 17 resultants are used for basepoint free parameterizations of the form p 2 p 3 in this case h is computed by res f 0 xf 3 f 1 y f 3 f 2 zf 3 h x y z 1 deg in the following examples we will compute h using gro bner bases and the complex z for further examples that show the advantages of implicitization using syzygies over other methods we refer the reader to the work of botbol and dickenstein 3 section 5 the macaulay 2 code to perform the examples that follow is available at https github com emduart 2 example 5 7 we let x be the set of points in p 1 p 1 in example 5 2 where ix s u t v we fix the bidegree a b 8 1 and let u ix 8 1 be given by u 3 s 6 t 2 u s 8 v 7 s 4 t 4 v s 3 t 5 v t 8 u 5 s 6 t 2 v s 2 t 6 v s 7 tu 11 s 5 t 3 u s 2 t 6 u st 7 u s 4 t 4 u s 3 t 5 u st 7 u s 7 tv 19 s 5 t 3 v st 7 v the coefficient matrix of u with respect to a monomial basis for ix 8 1 is generic we use two algorithms in macaulay 2 to compute the first map d 1 z 1 z 0 of z we refer to these as algorithm 1 and algorithm 2 algorithm 1 computes the minimal syzygies of iu then it selects the two syzygies in bidegree 7 0 using theorem 1 1 we know these syzygies are free then it bumps up these two syzygies to bidegree 2 a 1 b 1 15 0 by multiplying times the monomials in a basis for r 8 0 finally it finds d 1 by applying the koszul map in the variables x y z w with this method it takes 0 133 seconds to compute d 1 algorithm 2 directly computes a basis for the syzygies of iu and then uses the command super basis 3 a 1 2 b 1 image syz iu to find a basis of the syzygies in bidegree 2 a 1 b 1 finally it proceeds to set up d 1 as before with this method the computation of d 1 takes 1 67 seconds notice the speed boost in algorithm 1 that is obtained from knowing the structure of the syzygies that determine d 1 in particular we know the exact degrees of the syzygies of iu and that they span a free module if we use the eliminate command in macaulay 2 to compute the elimination ideal j from equation 7 the computation of the implicit equation takes 149 178 seconds for this example d 1 is a 16 18 matrix the implicit equation h of xu has degree 14 and it contains 115 terms example 5 8 take u to be a random generic 4 dimensional vector subspace of r 20 1 then u is basepoint free this example can be generated in macaualay 2 by finding a basis of r 20 1 using super basis 20 1 r and then multiplying this basis times a random matrix c of coefficients of the correct size for this choice of u algorithm 1 takes 0 751 seconds to compute d 1 z 1 z 0 and algorithm 2 takes 180 seconds the eliminate https github com emduart 2 18 eliana duarte ideal command did not finish the computation in at least 120 minutes and therefore was aborted in this example d 1 is a 40 40 matrix and h has degree 40 acknoledgements the author would like to thank hal schenck for useful discussions and suggestions as well as the referee for the helpful comments that improved the expo sition of this work evidence for this work was provided by many computations done using macaulay 2 by dan grayson and mike stillman macaulay 2 is freely available at http www math uiuc edu macaulay 2 and scripts to perform the computations are available at https github com emduart 2 references 1 botbol n the implicit equation of a multigraded hypersurface j algebra 348 2011 381 401 2 botbol n buse l and chardin m fitting ideals and multiple points of surface parameteriza tions j algebra 420 2014 486 508 3 botbol n and dickenstein a implicitization of rational hypersurfaces via linear syzygies a practical overview j symbolic comput 74 2016 493 512 4 buse l and luu ba t the surface surface intersection problem by means of matrix based representations comput aided geom design 29 8 2012 579 598 5 chardin m implicitization using approximation complexes in algebraic geometry and geometric modeling math vis springer berlin 2006 pp 23 35 6 chen f cox d and liu y the basis and implicitization of a rational parametric surface j symbolic comput 39 6 2005 689 706 7 chen f zheng j and sederberg t w the mu basis of a rational ruled surface comput aided geom design 18 1 2001 61 72 8 cox d curves surfaces and syzygies in topics in algebraic geometry and geometric modeling vol 334 of contemp math amer math soc providence ri 2003 pp 131 150 9 dohm m implicitization of rational ruled surfaces with bases j symbolic comput 44 5 2009 479 489 10 duarte e and schenck h tensor product surfaces and linear syzygies proceedings of the amer ican mathematical society 144 1 2016 65 72 11 giuffrida s maggioni r and ragusa a on the postulation of 0 dimensional subschemes on a smooth quadric pacific j math 155 2 1992 251 282 12 guardo e and van tuyl a arithmetically cohen macaulay sets of points in p 1 p 1 birkha user 2015 13 herzog j simis a and vasconcelos w v approximation complexes of blowing up rings journal of algebra 74 2 1982 466 493 14 schenck h seceleanu a and validashti j syzygies and singularities of tensor product surfaces of bidegree 2 1 mathematics of computation 83 287 2014 1337 1372 http www math uiuc edu macaulay 2 https github com emduart 2 implicitization of tensor product surfaces in the presence of basepoints 19 15 sederberg t w and chen f implicitization using moving curves and surfaces in proceedings of the 22 nd annual conference on computer graphics and interactive techniques 1995 acm pp 301 308 16 van tuyl a the border of the hilbert function of a set of points in pn 1 pnk journal of pure and applied algebra 176 2 2002 223 247 17 van tuyl a the defining ideal of a set of points in multi projective space journal of the london mathematical society 72 1 2005 73 90 department of mathematics university of illinois urbana il 61801 e mail address emduart 2 illinois edu 1 introduction 2 points in p 1 p 1 3 ideal of a generic set of points in p 1 p 1 4 syzygies of the ideal iu 5 applications to implicitization of tensor product surfaces references