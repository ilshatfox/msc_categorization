ar x iv 1 60 7 00 06 2 v 1 m at h a g 3 0 ju n 20 16 local cohomology and base change karen e smith abstract let x f s be a morphism of noetherian schemes with s reduced for any closed subscheme z of x finite over s let j denote the open immersion x z x then for any coherent sheaf f on x z and any index r 1 the sheaf f r rj f is generically free on s and commutes with base change we prove this by proving a related statement about local cohomology let r be noetherian algebra over a noetherian domain a and let i r be an ideal such that r i is finitely generated as an a module let m be a finitely generated r module then there exists a non zero g a such that the local cohomology modules hri m aag are free over ag and for any ring map a l factoring through ag we have hri m a l hri al m a l for all r 1 introduction in his work on maps between local picard groups kolla r was led to investigate the behavior of certain cohomological functors under base change kol the following theorem directly answers a question he had posed theorem 1 1 let x f s be a morphism of noetherian schemes with s reduced suppose that z x is closed subscheme finite over s and let j denote the open embedding of its complement u then for any coherent sheaf f on u the sheaves f r rj f are generically free and commute with base change for all r 1 our purpose in this note is to prove this general statement kolla r himself had proved a special case of this result in a more restricted setting kol thm 78 we pause to say precisely what is meant by generically free and commutes with base change suppose h is a functor which for every morphism of schemes x s and every quasi coherent sheaf f on x produces a quasi coherent sheaf h f on s we say h f is generically free if there exists a dense open set s 0 of s over which date july 4 2016 thanks to ja nos kolla r for encouraging me to write this paper for his insistence that i establish the more general version of the theorem and for sharing his insight as to why my arguments should go through more generally especially the idea to reduce to the affine case in section 2 i d also like to thank mel hochster for listening to my arguments karl schwede for reading a draft and suggesting the reference dgi and barghav bhatt for his interest financial support partially from nsf dms 1501625 1 http arxiv org abs 1607 00062 v 1 2 karen e smith the os module h f is free if in addition for every change of base t p s 0 the natural map p h f h p xf of quasi coherent sheaves on t is an isomorphism where px is the induced morphism x s t x then we say that h f is generically free and commutes with base change see kol 72 remark 1 2 we do not claim the r 0 case of theorem 1 1 in fact it is false for a counterexample consider the ring homomorphism splitting z z q z the corresponding morphism of noetherian schemes z spec z x spec z q s specz satisfies the hypothesis of theorem 1 1 the open set u x z is the component specq of x the coherent sheaf determined by the module q on u is not generically free over z since there is no open affine subset specz 1 n over which q is a free module in this case the map j is affine so the higher direct image sheaves rpj f all vanish for p 0 on the other hand if f is a map of finite type then the r 0 case of theorem 1 1 can be deduced from grothendiecks s lemma on generic freeness see lemma 4 1 for the commutative algebraists we record the following version of the main result which is essentially just the statement in the affine case corollary 1 3 let a be a reduced noetherian ring let r be a noetherian a algebra with ideal i r such that the induced map a r i is finite then for any noetherian r module m the local cohomology modules h ii m are generically free and commute with base change over a for all i 0 explicitly this means that there exists element g not in any minimal prime of a such that the modules h ii m a ag are free over ag and that for any algebra l over ag the natural map h ii m a l h i i m a l is an isomorphism some version of theorem 1 1 may follow from known statements in the literature but looking through works of grothendieck rd lc sga 2 and conrad i am not able to find it nor presumably could kolla r after this paper was written i did find a related statement due to hochster and roberts hr thm 3 4 in a special case not quite strong enough to directly answer kolla r s original question furthermore my proof is different and possibly of independent interest in any case there may be value in the self contained proof here which uses a relative form of matlis duality proved here using only basic results about local cohomology well known to most commutative algebraists local cohomology and base change 3 2 restatement of the problem in this section we show that theorem 1 1 reduces to the following special state ment theorem 2 1 let a be a noetherian domain let r a x 1 xn be a power series ring over a and m a finitely generated r module denote by i the ideal x 1 xn r then the local cohomology modules h ii m are generically free over a and commute with base change for all i for basic definitions and properties of local cohomology modules we refer to lc for the remainder of this section we show how theorem 1 1 and corollary 1 3 follow from theorem 2 1 first theorem 1 1 is local on the base because the scheme s is reduced it is the finite union of its irreducible components each of which is reduced and irreducible so it suffices to prove the result on each of them thus we can immediately reduce to the case where s speca for some noetherian domain a we now reduce to the case where x is affine as well the coherent sheaf f on the open set u extends to a coherent sheaf on x which we also denote by f to simplify notation let us denote the sheaf rrj f by h which we observe vanishes outside the closed set z each section is annihilated by a power of the ideal iz of z so that although the sheaf of abelian groups h on z is not an oz module it does have the structure of a module over the sheaf of os algebras lim t ox it z which we denote o x z put differently h can be viewed as sheaf on the formal scheme x z over s observe that i o x z x 0 o x z where x 0 i x is the inclusion of any open set x 0 x containing the generic points of all the components of z this means that h is generically free as an os module if and only if h x 0 is and there is no loss of generality in replacing x by any such open set x 0 in particular we can choose such x 0 to be affine thus reducing the proof of theorem 1 1 to the case where both x and s are affine we can now assume that x s is the affine map of affine schemes corresponding to a ring homomorphism a t in this case the closed set z is defined by some ideal i of t because z is finite over s speca the composition a t t i is a finite integral extension of a the coherent sheaf f on u extends to a coherent sheaf f on x which corresponds to a finitely generated t module m since x spec t is affine we have natural identifications for r 1 rrj f h r x z f hr 1 i m 4 karen e smith of modules over t lc cor 1 9 thus we have reduced theorem 1 1 to showing that if t is a noetherian ring over a noetherian domain a and i is any ideal such that t i is finitely generated as an a module then for any finitely generated t module m the modules hr 1 i m are generically free and commute with base change over a for r 1 in fact we will be able to show this for all indices r 1 to get to the power series case we first observe that for all i every element of h ii m is annihilated by some power of i this means that h i i m has the structure of a module over the i adic completion t i there is no loss of generality in replacing t and m by their i adic completions t i and m i the module h ii m is canonically identified with h i it i m i so with out loss of generality we assume that t is i adically complete now lemma 2 2 below guarantees that t is a module finite algebra over a power series ring a x 1 xn so the finitely generated t module m is also a finitely generated module over a x 1 xn and the computation of local cohomology is the same viewed over either ring this means that to prove theorem 1 1 it would suffice to prove theorem 2 1 it only remains to prove lemma 2 2 lemma 2 2 let a be a noetherian ring let t be a noetherian a algebra contain ing an ideal i such that the composition of natural maps a t t i is finite then there is a natural ring homomorphism from a power series ring a x 1 xn t i lim t t i t which is also finite proof of lemma fix generators y 1 yn for the ideal i of t consider the a algebra homomorphism a x 1 xn t xi 7 yi we will show that this map induces a ring homomorphism a x 1 xn t i which is finite first note that for each natural number t there is a naturally induced ring homomorphism 1 a x 1 xn x 1 xn t t i t sending the class xi to the class yi claim for every t the map 1 is finite indeed if t 1 td are elements of t whose classes modulo i are a module generators for t i then the classes of t 1 td modulo i t are generators for t i t as a module over a x 1 xn x 1 xn t local cohomology and base change 5 the claim is straightforward to prove using induction on t and the exact sequence 0 i t i t 1 t i t 1 t i t 0 we leave these details to the reader now to prove the lemma we take the direct limit of the maps 1 since at every stage the target is generated over the source by the classes of t 1 td also in the limit t i will be generated over a x 1 xn by the images of t 1 td so the induced ring homomorphism a x 1 xn t is finite having reduced the proof of the main results discussed in the introduction to theorem 2 1 the rest of the paper focuses on the local cohomology statement in the special case our proof of theorem 2 1 uses an a relative version of matlis duality to convert the problem to an analagous one for finitely generated modules over a power series ring where it will follow from the theorem on generic freeness this relative version of matlis duality might be of interest to commutative algebraists in other contexts and holds in greater generality than what we develop here to keep the paper as straightforward and readable as possible we have chosen to present it only in the case we need to prove the main result some related duality is worked out in dgi 3 a relative matlis dual functor 3 1 matlis duality we first recall the classical matlis duality in the complete local noetherian case let r m be a complete local ring and let e be an injective hull of its residue field r m the matlis dual functor homr e is an exact contravariant functor on the category of r modules it takes each noetherian r module i e one satisfying the ascending chain condition to an artinian r module i e one satisfying the descending chain condition and vice versa moreover for any artinian or noetherian r module h we have a natural isomorphism h homr homr h e e that is the matlis dual functor defines an equivalence of categories between the category of noetherian and the category of artinian r modules see lc bh thm 3 2 13 or hoch for more on matlis duality 3 2 a relative version of matlis duality let a be a domain let r be an a algebra with ideal i r such that r i is finitely generated as an a module define the relative matlis dual functor to be the functor r modules r modules m 7 m a lim t homa m i tm a 6 karen e smith we also denote m a by homctsa m a since it is the submodule of homa m a consisting of maps continuous in the i adic topology that is homctsa m a is the r submodule of homa m a consisting of maps m a satisfying i tm 0 for some t proposition 3 1 let r be a noetherian algebra over a noetherian domain a with ideal i r such that r i is finitely generated as an a module 1 the functor homctsa a is naturally equivalent to the functor m 7 homr m hom cts a r a 2 the functor preserves exactness of sequences 0 m 1 m 2 m 3 0 of finitely generated r modules provided that the modules m 3 i nm 3 are lo cally free a modules for all n 0 remark 3 2 if a r i is a field then the relative matlis dual specializes to the usual matlis dual functor homr e where e is the injective hull of the residue field of r at the maximal ideal i denoted here now m indeed one easily checks that homctsa r a is an injective hull of r m to wit the r module homomorphism r m homctsa r a sending r mod m 7 r a s 7 rs mod m is a maximal essential extension of r m proof of proposition statement 1 follows from the adjointness of tensor and hom which is easily observed to restrict to the corresponding statement for modules of continuous maps for 2 we need to show the sequence remains exact after applying the relative matlis dual functor the functor homa a preserves left exactness that is 2 0 homa m 3 a homa m 2 a homa m 1 a is exact we want to show that restricting to the submodules of continuous maps we also have exactness at the right that is we need the exactness of 3 0 homctsa m 3 a hom cts a m 2 a hom cts a m 1 a 0 the exactness of 3 at all spots except the right is easy to verify using the description of a continuous map as one annihilated by a power of i to check exactness of 3 at the right we use the artin rees lemma am 10 10 take homctsa m 1 a by definition of continuous we is annihilated by i n for sufficiently large n by the artin rees lemma there exists t such that for all n t we have in tm 2 m 1 i nm 1 this means we have a surjection m 1 i n tm 2 m 1 m 1 i nm 1 local cohomology and base change 7 therefore the composition m 1 i n tm 2 m 1 m 1 i nm 1 a gives a lifting of to an element in homa m 1 i n tm 2 m 1 a now note that for n 0 we have exact sequences 0 m 1 m 1 i n tm 2 m 2 i n tm 2 m 3 i n tm 3 0 which are split over a by our assumption that m 3 i n tm 3 is projective thus 4 0 homa m 3 i n tm 3 a homa m 2 i n tm 2 a homa m 1 m 1 i n tm 2 a 0 is also split exact this means we can pull homa m 1 i n tm 2 m 1 a back to some element in homa m 2 i n tm 2 a so our original continuous map m 1 a is the restriction of some map m 2 a which satisfies in tm 2 0 this exactly says the continuous map on m 1 extends to a continuous map of m 2 that is the sequence 3 is exact remark 3 3 if m 3 is a noetherian module over a noetherian algebra r over the noetherian domain a then the assumption that m 3 i nm 3 is locally free for all n holds generically on a that is after inverting a single element of a see lemma 4 2 4 generic freeness we briefly review grothendieck s idea of generic freeness and use it to prove that the relative matlis dual of a noetherian r module is generically free over a under suitable noetherian hypothesis on r and a let m be a module over a commutative domain a we say that m is generically free over a if there exists a non zero g a such that m a ag is a free ag module where ag denotes the localization of a at the element g likewise a collectionm of a modules is simultaneously generically free over a if there exists a non zero g a such that m a ag is a free for all modules m m note that any finite collection of generically free modules is always simultaneously generically free since we can take g to be the product the gi that work for each of the mi of course finitely generated a modules are always generically free grothendieck s famous lemma on generic freeness ensures that many other modules are as well lemma 4 1 ega 6 9 2 let a be a noetherian domain let m be any finitely generated module over a finitely generated a algebra t then m is generically free over a we need a version of generic freeness for certain infinite families of modules over more general a algebras 8 karen e smith lemma 4 2 let a be any domain let t be any noetherian a algebra and i t any ideal such that t i is finite over a then for any noetherian t module m the family of modules m inm n 1 is simultaneously generically free over a that is after inverting a single element of a the modules m inm for all n 1 become free over a remark 4 3 we will make use of lemma 4 2 in the case where t a x 1 xn proof if m is finitely generated over t then the associated graded module grim m im im i 2 m i 2 m i 3 m is finitely generated over the associated graded ring grit t i i i 2 i 2 i 3 which is a homomorphic image of a polynomial ring over t i hence grit is a finitely generated a algebra applying the lemma of generic freeness to the grit module grim we see that after inverting a single non zero element of g of a the module grim becomes a free since grim is graded over grit and a acts in degree zero clearly its graded pieces are also free after tensoring with ag we can thus replace a by ag for suitable g and assume that the i nm in 1 m are ag free for all n 0 now consider the short exact sequences 5 0 inm in 1 m m in 1 m m inm 0 for each n 1 we already know that m i 1 m and inm in 1 m for all n 1 are free over ag so by induction we conclude that the sequences 5 are all split over ag for every n in particular the modules m i nm are also free over ag for all n 1 the lemma is proved proposition 4 4 let a be a noetherian domain let r be any noetherian a algebra with ideal i r such that r i is a finitely generated a module then for any noetherian r module m the relative matlis dual homctsa m a is a generically free a module furthermore if g a is a non zero element such that ag a hom cts a m a is free over ag then for any base change a l factoring through ag the natural map homctsa m a a l hom cts l m a l l is an isomorphism of r a l modules functorial in m proof we can invert one element of a so that each m i tm is free over a replace a by this localization we now claim that the a module homctsa m a lim t homa m i tm a local cohomology and base change 9 is free indeed since each m i tm is free and has finite rank over a its a dual homa m itm a is also free of finite rank the direct limit is also a free because the maps in the limit system are all split over a and injective indeed if some finite a linear combination of fi hom cts a m a is zero then that same combination is zero considered as elements of the free submodule homa m itm a of homomorphisms in homctsa m a killed by a large power of i it follows that hom cts a m a is free over a as desired the result on base change follows as well since tensor commutes with direct limits and with dualizing a finitely generated free module remark 4 5 we can interpret proposition 4 4 as saying that generically on a the relative matlis dual functor applied to noetherian r modules is exact and commutes with base change 5 relative local duality and the proof of the main theorem the proof theorem 2 1 and therefore of our main result answering kolla r s ques tion follows from a relative version of local duality theorem 5 1 let r be a power series ring a x 1 xn over a noetherian do main a and let m be a finitely generated r module then after replacing a by its localization at one element there is a functorial isomorphism for all i h ii m ext n i r m r a to prove theorem 5 1 we need the following lemma lemma 5 2 let r be a power series ring a x 1 xn over a ring a there is a natural r module isomorphism homctsa r a hni r where i x 1 xn in particular the relative matlis dual functor can also be expressed m 7 homr m h n i r proof we recall that h ii r is the i th cohomology of the extended c ech complex k on the elements x 1 xn this is the complex 0 r 1 rx 1 rx 2 rxn i j rxixj n rx 1 x 2 xn 0 where the maps are sums of suitably signed localization maps in particular hni r is the cokernel of n which can be checked to be the free a module on the classes of the monomials xa 1 1 xann with all ai 0 1 1 see page 226 of hart although i have included one extra map 1 r rxi sending f 7 f 1 f 1 in order to make the complex exact on the left and my ring is a power series ring over a instead of a polynomial rings over a field this is also discussed in lc page 22 10 karen e smith now define an explicit r module isomorphism from hni r to hom cts a r a by sending the class of the monomial x to the map hom cts a r a r a xb 1 1 xbnn 7 xb 1 a 1 1 1 xbn an 1 n mod i if i i 1 for all i 0 otherwise since x nn is an a basis for r the map is a well defined a module map from r to a and since it sends all but finitely many x to zero it is i adically contin uous thus the map hni r homctsa r a is is an a module homomorphism in fact is an a module isomorphism since it defines a bijection between the a basis x i 0 for h n i r and i 0 for hom cts a r a meaning the dual basis on the free basis x for r over a matching the indices i i i 1 it is easy to check that is also r linear by thinking of it as premultiplication by x 1 on the cokernel of n thus identifies the r modules h n i r and hom cts a r a proof of theorem 5 1 we proceed by proving that both modules are generically iso morphic to a third namely torrn i m h n i r first recall how to compute h ii m let k be the extended c ech complex on the elements x 1 xn 0 r 1 rx 1 rx 2 rxn i j rxixj n rx 1 x 2 xn 0 this is a complex of flat r modules all free over a exact at every spot except the right end thus it is a flat r module resolution of the local cohomology module hni r the local cohomology module h i i m is the cohomology of this complex after tensoring over r with m that is h ii m tor r n i m h n i r on the other hand let us compute the relative matlis dual of extn ir m r let p be a free resolution of m over r the module ext r m r is the cohomology of the complex homr p r we would like to say that the computation of the cohomology of this complex commutes with the relative matlis dual functor but the best we can say is that this is true generically on a to see this we will apply lemma 4 2 to the following finite set of r modules for i 0 n the image di of the i th map of the complex homr p r for i 0 n the cohomology extn ir m r of the same complex lemma 4 2 guarantees that the modules di i tdi and ext n i r m r i textn ir m r local cohomology and base change 11 are all simultaneously generically free over a for all t 1 this allows us to break up the complex ag ahomr p r into many short exact sequences split over ag which satisfy the hypothesis of proposition 3 1 2 using ag in place of a and ag a r in place of r it follows that the computation of cohomology of homr p r commutes with the relative matlis dual functor generically on a thus after replacing a by a localization at one element extn ir m r a is the cohomology of the complex homr homr p r h n i r in general for any finitely generated projective module p and any module h over any noetherian ring r the natural map p h hom hom p r h sending a simple tensor x h to the map which sends f hom p r to f x h is an isomorphism functorially in p and h thus we have a natural isomorphism of complexes p h n i r homr homr p r h n i r and so extn i m r a is identified with torn i m h n i r which as we saw is identified with h ii m since all identifications are functorial we have proven the relative local duality h ii m ext n i m r a generically on a we can finally finish the proof of theorem 1 1 and hence the main result proof of theorem 2 1 let r be a power series ring over a noetherian domain a and let m be any noetherian r module we need to show that the local cohomology modules h ii m are generically free and commute with base change over a in light of corollary 4 4 we can accomplish this by showing that h ii m is the rel ative matlis dual of a noetherian r module generically on a but this is guaranteed by the relative local duality theorem theorem 5 1 which guarantees that h ii m ext n i r m r a generically on a remark 5 3 one could obviously develop the theory of relative matlis duality especially theorem 5 1 further i wrote down only the simplest possible case and the simplest possible statements needed to answer kolla r s question as directly as possible 12 karen e smith references am m f atiyah and i g macdonald introduction to commutative algebra addison wesley series in mathematics addison wesley london 1969 bh winfred burns and ju rgen herzog cohen macaulay rings cambridge series in advanced mathematics v 39 cambridge university press 1993 conrad brian conrad grothendieck duality and base change lecture notes in mathematics 1750 springer 2001 dgi w g dwyer j p c greenlees and s iyengar duality in algebra and topology advances in mathematics volume 200 issue 2 1 march 2006 pages 357 d 402 eisen david eisenbud commutative algebra with a view towards algebraic geometry graduate texts in mathematics 150 springer 1995 ega alexander grothendieck and jean dieudonne e le ments de geome trie alge brique chapter iv part 2 inst hautes e tudes sci pub math 24 1965 sga 2 alexander grothendieck and michele raynaud cohomologie locale des faisceaux cohe rents et the ore mes de lefschetz locaux et globaux sga 2 documents mathe matiques paris 4 paris socie ite mathe matique de france 2005 1968 laszlo yves ed arxiv math 0511279 isbn 978 2 85629 169 6 mr 2171939 lc robin hartshorne local cohomology a seminar given by a grothendieck harvard univer sity fall 1961 lecture notes in mathematics 41 berlin new york springer verlag 1967 mr 0224620 rd robin hartshorne residues and duality lecture notes of a seminar on the work of a grothendieck given at harvard 1963 64 springer verlag lecture notes in mathematics vol 20 1966 hart robin hartshorne algebraic geometry graduate texts in mathematics 52 springer verlag 2006 hoch mel hochster lecture notes on local cohomology unpublished from his university of michigan website http www math lsa umich edu hochster 615 w 11 loc pdf hr mel hochster and joel roberts the purity of frobenius and local cohomology advances in mathematics 21 117 172 1976 kol ja nos kolla r maps between local picard groups arxiv 1407 5108 v 2 preprint 2014 1 introduction 2 restatement of the problem 3 a relative matlis dual functor 3 1 matlis duality 3 2 a relative version of matlis duality 4 generic freeness 5 relative local duality and the proof of the main theorem references