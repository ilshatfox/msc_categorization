ar x iv 1 81 0 12 49 1 v 2 m at h a g 2 a pr 2 01 9 tamely ramified geometric langlands correspondence in positive characteristic shiyu shen abstract we prove a version of the tamely ramified geometric langlands correspondence in positive characteristic for gln k where k is an alge braically closed field of characteristic p n let x be a smooth projective curve over k with marked points and fix a parabolic subgroup of gln k at each marked point we denote by bunn p the moduli stack of quasi parabolic vector bundles on x and by locn p the moduli stack of parabolic flat connections such that the residue is nilpotent with respect to the para bolic reduction at each marked point we construct an equivalence between the bounded derived category db qcoh loc 0 n p of quasi coherent sheaves on an open substack loc 0 n p locn p and the bounded derived category db d 0 bunn p mod of d 0 bunn p modules where d 0 bunn p is a localization of dbunn p the sheaf of crystalline differential operators on bunn p thus we extend the work of bezrukavnikov braverman bb 07 to the tamely ramified case we also prove a correspondence between flat connections on x with regular singularities and meromorphic higgs bundles on the frobenius twist x 1 of x with first order poles 1 introduction 1 1 geometric langlands in positive characteristic let x be a smooth projective curve over c let g be a reductive group over c and let g be its lang lands dual group the geometric langlands correspondence glc as proposed by beilinson and drinfeld in bd 91 is a conjectural equivalence between the appro priately defined category of d modules on the moduli stack bung of g bundles on x and the appropriately defined category of quasi coherent sheaves on the moduli stack loc g of g local systems on x a precise statement of this conjecture can be found in ag 15 in bb 07 a generic version of the glc in positive characteristic is established for g gln k the d modules are interpreted in terms of crystalline differential operators using the azumaya property of crystalline differential operators and a twisted version of the fourier mukai transform the authors prove a generic version of the glc over the open subset of the hitchin base where the spectral curves are smooth in the case of g gln k the results of bb 07 are generalized in various directions in nev 09 the mirabolic version of this correspondence is estab lished in tra 16 the author proved the quantum version of this correspondence in gro 16 the equivalence in bb 07 is extended to the hitchin base of reduced and irreducible spectral curves the results of bb 07 are extended to arbitrary reductive groups in cz 15 and cz 17 1 2 tamely ramified geometric langlands correspondence the main pur pose of this paper is to establish the tamely ramified version of the glc proved in 1 http arxiv org abs 1810 12491 v 2 2 shiyu shen bb 07 i e we allow the flat connections to have regular singularities see fr 04 for a discussion of the tamely ramified glc over c let k be an algebraically closed field of characteristic p and let x be a smooth projective curve over k we will work on the case of g gln k and assume p n let d q 1 q 2 qm be an effective reduced divisor on x and let pd p 1 p 2 pm be an ordered m tuple of parabolic subgroups of gln k we assume that we are in one of the following three cases 1 gx 2 2 gx 1 m 2 and at least two pi are proper parabolic subgroups or m 1 p is a borel subgroup and n 3 3 gx 0 m 4 and all pi are borel subgroups compared to the unramified version of the glc instead of considering bunn and locn we consider the moduli stack bunn pd of quasi parabolic vector bundles vector bundles of rank n with a pi reduction at each qi and the moduli stack locn pd of flat connections on parabolic vector bundles with regular singularities at q 1 q 2 qm such that the residue at each qi is nilpotent with respect to the pi reduction note that the cotangent bundle t bunn pd is isomorphic to the moduli stack higgsn pd of parabolic higgs bundles such that the residue of the higgs field is nilpotent with respect to the parabolic reduction at each qi we denote by dbunn pd the sheaf of crystalline differential operators on bunn pd 1 we will define a localization d 0 bunn pd of dbunn pd and an open substack loc 0 n pd of locn pd see section 5 1 for precise definitions we will construct an oloc 0 n pd d 0 bunn pd module p see section 5 5 and consider the fourier mukai functor with kernel p p d b qcoh loc 0 n pd d b d 0 bunn pd mod from the bounded derived category of quasi coherent sheaves on loc 0 n pd to the bounded derived category of d 0 bunn pd modules the main theorem of the paper is the following theorem 1 1 p is an equivalence of derived categories there are natural functors from both sides of the equivalence the hecke functor h 0 pd see section 5 6 h 0 pd d b d 0 bunn pd mod db d 0 bunn pd dx d mod and the functor w 0 pd w 0 pd d b oloc 0 n pd mod db oloc 0 n pd dx d mod defined by tensoring with the universal flat connection let p x d be the fourier mukai equivalence induced by the pull back of p p x d d b oloc 0 n pd dx d mod db d 0 bunn pd dx d mod the equivalence in theorem 1 1 satisfies the following hecke eigenvalue property theorem 1 2 there is an isomorphism of functors h 0 pd p p x d w 0 pd 1 defined in the sense of bb 07 section 3 13 see section 3 3 and section 5 1 tamely ramified geometric langlands in positive characteristic 3 now let e be a k point of loc 0 n pd we denote by me the image of e under p by theorem 1 2 me satisfies h 0 pd me me e 1 3 summary of the proof we fix a k point q x and a parabolic subgroup p of gln k for the purpose of simplifying notations our exposition will be restricted to the case of d q and pd p from now on the only proof that will be different in the more general setting is the proof of proposition 2 5 in the case of x p 1 m 4 and all pi are borel subgroups we discuss this case in remark 2 9 our proof of theorem 1 1 is based on the same strategy as used in bb 07 but some new ingredients come into play note that in bb 07 the geometric langlands correspondence is established over the open subset of the hitchin base where the spectral curves are smooth compared to the unramified case in bb 07 one of the main difficulties in the tamely ramified case is that unless p is a borel subgroup of gln k there are no smooth spectral curves we resolve this situation by considering the normalization of the spectral curves it is observed in ss 95 that under generic restrictions on the spectral curves a fiber of the hitchin map hp higgsn p bp is isomorphic to the picard stack of the normalization of the corresponding spectral curve in section 2 3 we extend this observation to a family version more precisely we prove theorem 1 3 there exists a zariski open dense subset b 0 p bp and a flat family of smooth projective curves b 0 p such that higgsn p bp b 0 p pic b 0 p for each b b 0 p k b is the normalization of the spectral curve b in section 4 we establish a correspondence between flat connections on x with regular singularity at q and x 1 q twisted higgs bundles on the frobenius twist x 1 of x which can be thought of as a characteristic p version of the non abelian hodge correspondence in sim 90 let a be an unordered n tuple of elements in k we denote by higgsn a x 1 the moduli stack of x 1 q twisted higgs bundles e on x 1 such that the tuple of eigenvalues of the residue resq of the higgs field at q is a let b 1 a be the image of higgsn a x 1 under the hitchin map h 1 we fix a set theoretic section of the artin schreier map k k that maps t to tp t we denote by locn a the moduli stack of flat connections e with regular singularity at q such that the tuple of eigenvalues of resq is a the p curvature of e see section 4 1 defines the hitchin map h for flat connections with regular singularity at q h locn a b 1 a we will define an open substack see section 4 2 locrn a locn a and prove the following theorem 4 shiyu shen theorem 1 4 1 locr n a is a pic 1 b 1 a torsor 2 locn a loc r n a pic 1 b 1 a higgsn a x 1 note that for an arbitrary reductive group g a similar construction is used in cz 15 to establish the characteristic p version of the non abelian hodge correspon dence for flat connections without singularities one of the key steps in our proof of theorem 1 4 is to show that the map h locrn a b 1 a is surjective since we consider flat connections with singularity at q we cannot apply the azumaya property of differential operators on x directly instead we construct a flat connection on x q using the azumaya property construct a flat connection on the formal disk around q by explicitly solving a differential equation for the connection form and glue them together using the beauville laszlo theorem bl 95 note that locn 0 is the moduli stack of flat connections with regular singularity and nilpotent residue at q restricting the isomorphism in theorem 1 4 2 to b 0 p 1 and combining theorem 1 3 we deduce that loc 0 n p locn p b 1 p b 0 p 1 is a pic 1 b 0 p 1 torsor it is proved in bb 07 that for a smooth algebraic stack z that is good in the sense of bd 91 i e z satisfies dimt z 2 dimz there is a natural sheaf of algebras dz on t z 1 that satisfies 1 dz fr dz and the restriction of dz to the maximal smooth open substack t z 0 1 t z 1 is an azumaya algebra of rank p 2 dimz see section 3 3 for a review of this construcion here 1 t z 1 z 1 is the projection and fr z z 1 is the relative frobenius the stack bunn p almost satisfies those two properties and we can still construct a sheaf of algebras dbunn p that satisfies 1 dbunn p fr dbunn p see section 5 1 for details the restriction d 0 bunn p of dbunn p to higgs 1 n p b 1 p b 0 p 1 pic 1 b 0 p 1 is an azumaya algebra we associate with d 0 bunn p its stack of splittings yd 0 bunn p which is a gm gerbe over the picard stack pic 1 b 0 p 1 in section 5 2 we show that d 0 bunn p has a tensor structure therefore yd 0 bunn p has the structure of a commutative group stack and there is a short exact sequence 0 bgm yd 0 bunn p pic 1 b 0 p 1 0 by taking dual we get another short exact sequence 0 pic 1 b 0 p 1 y d 0 bunn p z 0 in section 5 5 we prove that y d 0 bunn p 1 1 1 is isomorphic to loc 0 n p as pic 1 b 0 p 1 torsors therefore we can apply a twisted version of the fourier mukai transform reviewed in section 5 4 to prove the equivalence in theorem 1 1 for the proof of this isomorphism we show that the tautological 1 form 1 on t x q 1 extends to a 1 form 1 on 1 and both pic 1 b 0 p 1 torsors are tamely ramified geometric langlands in positive characteristic 5 isomorphic to the moduli stack of rank one flat connections on with p curvature 1 1 4 structure of the article in section 2 we first review some basic construc tions related to the hitchin fibration then we define the zariski open dense subset b 0 p bp and establish the correspondence between parabolic higgs bundles and the picard stack of the normalization of spectral curves over b 0 p in section 3 we first review some properties of crystalline differential operators in positive charac teristic including the azumaya property and the cartier descent then we describe the correspondence between modules over an azumaya algebra and twisted sheaves associated to its gm gerbe of splittings finally we review the definition of tensor structures on azumaya algebras over group stacks in section 4 we first construct the hitchin map for flat connections with regular singularities then we prove the non abelian hodge correspondence between locn a and higgsn a x 1 in sec tion 5 we first define the sheaf of algebras dbunn p and construct a tensor structure on d 0 bunn p then we review the fourier mukai transforms on commutative group stacks and use this framework to prove the main theorem finally we discuss the hecke eigenvalue property of this equivalence 1 5 notations and definitions unless otherwise mentioned k is an algebraically closed field of characteristic p 0 we consider the general linear group gln k and assume p n let gln k be the lie algebra of gln k we denote by n the nilpotent cone in gln k let p be a parabolic subgroup of gln k the lie algebra of p decomposes as lie p l n p we denote by op the richardson orbit corresponding to p which is the unique nilpotent orbit in gln k such that the intersection with n p is open dense in n p let x be a smooth projective algebraic curve over k let gx be the genus of x we fix a k point q x for any k scheme s we denote by q s s x the base change of q spec k x we denote by px the projection from s x to x and by ps the projection to s definition 1 5 an s family of quasi parabolic vector bundles on x is a vector bundle e of rank n on s x with a p reduction along s q we denote the moduli stack of such objects by bunn p to be more precise bunn p classifies triples e ep where ep is a p bundle on s q and is an isomorphism ep p k n qe let bunn be the moduli stack of rank n vector bundles onx there is a canonical map from bunn p to bunn which is defined by forgetting the p reduction remark 1 6 let b be the borel subgroup of gln k that consists of upper triangu lar matrices there is a one to one correspondence between the set of parabolic sub groups of gln k containing b and the set of ordered n tuples of positive integers 1 2 s such that s i 1 i n this correspondence can be described as follows we consider the standard representation of gln k acting on k n let e 1 e 2 en be the standard basis of k n for i 1 2 s let vi mi j 1 kej where 6 shiyu shen mi i k 1 k then the parabolic subgroup p corresponding to is identified with g gln k g vi vi 1 i s let 1 2 r be the conjugate partition to the richardson orbit corresponding to p consists of m the nilpotent matrix with jordan blocks of sizes 1 2 r let e be a rank n vector bundle on s x a p reduction of the structure group along s q corresponds to a partial flag structure 0 e 0 q e 1 q e 2 q e s q qe where ei is a vector bundle of rank mi on s definition 1 7 an s family of parabolic higgs bundles on x is a parabolic vector bundle e ep together with a higgs field end e p x x q such that the residue of at q which we denote by resq end qe lies in s ep p n p in other words if the parabolic reduction gives the following partial flag structure 0 e 0 e 1 e 2 es qe we require resq ei ei 1 we denote the moduli stack of such objects by higgsn p we denote by higgsn q the moduli stack of x q twisted higgs bundles e end e p x x q there is a canonical map from higgsn p to higgsn q which is defined by forgetting the p reduction remark 1 8 higgsn p t bunn p definition 1 9 an s family of parabolic flat connections on x is a parabolic vector bundle e ep together with a flat connection with regular singularity at q e e p x x q i e is a os linear map of sheaves that satisfies the leibniz rule such that the residue resq of at q lies in s ep p n p we denote the moduli stack of such objects by locn p we denote by locn q the moduli stack of flat connections of rank n on x with regular singularity at q there is a canonical map from locn p to locn q which is defined by forgetting the p reduction 1 6 acknowledgements i would like to thank my advisor tom nevins for many helpful discussions on this subject and for his comments on this paper i would like to thank christopher dodd and michael groechenig for helpful conversations i would like to thank tsao hsien chen for useful comments on an earlier version of this paper this work was supported by nsf grant dms 1502125 tamely ramified geometric langlands in positive characteristic 7 2 spectral data of parabolic higgs bundles 2 1 basic constructions by taking the coefficients of the characteristic polyno mial of the higgs field we get the hitchin map h higgsn q b where b n i 1 x x q i 2 if we require the residue of the higgs field to be nilpotent the image of this map lies in bn n i 1 x ix i 1 q let t x q specx symox tx q where tx q is the sheaf of vector fields on x that vanish at q let be the projection t x q x we denote by y the tautological section of x q for b b 1 b 2 bn bi x x q i we define the spectral curve b to be the zero subscheme of the section yn b 1 y n 1 bn 1 y bn of x q n by an abuse of notation we also denote by the projection from b to x since o b n 1 i 0 tx q i we can compute the genus of b g b n n 1 2 2 g 1 n g 1 1 let e be a k point of higgsn q such that h e b we can think of as a morphism tx q end e by cayley hamilton there is a coherent sheaf f on b such that f e we call f the spectral sheaf corresponding to e conversely let g be a coherent sheaf on b there is a canonical section can x end g x q obtained by adjunction it is proved in bnr 89 that if b is reduced the hitchin fiber h 1 b is isomorphic to the stack of torsion free sheaves on b and if b is smooth h 1 b is isomorphic to the picard stack pic b of b if we require the residue of to be nilpotent then 1 q is a single point q that lies in the zero section of t x q let v spec a be an affine open neighborhood of q in x let x be an element of a that is mapped to a local parameter of x at q shrinking v if necessary we assume dx x is a nowhere vanishing section of v q let u 1 v the section dx x gives a trivialization of t x q v and t x q u under this trivialization the tautological section y is equal to x x considered as an element in ou let b v v x b then o b v is isomorphic to ou fb where fb y n b 1 y n 1 bn 1 y bn bi ov we denote by f b the image of fb in o u q k x y then o b q k x y f b 2 2 the parabolic hitchin base bp now let p be a parabolic subgroup of gln k and we assume the richardson orbitop of p contains the nilpotent matrix 2 more precisely b is the affine space associated to the k vector space n i 1 x x q i i e b spec sym n i 1 x x q i 8 shiyu shen with jordan blocks of sizes 1 2 r r i 1 i n composing h with the forgetful map from higgsn p to higgsn q we get hp higgsn p b in order to describe the image of hp we define the following sets of formal power series let 1 2 s 1 2 s be a decreasing sequence of positive integers let i s j i 1 j for i 0 1 2 s 1 and s 0 we denote by p the set of formal power series of the form y 0 s i 1 ai x y x iy i where ai x y k x y and by p 0 the subset of elements in p that satisfy ai x y k x y in partic ular if m p 0 m is the set of formal power series of the form ym a x y x where a x y k x y lemma 2 1 let e ep be a k point of higgsn p such that hp e b let f b be the element in k x y such that o b q k x y f b as above then f b p this lemma follows from a direct computation see proposition 22 in bk 18 it follows from lemma 2 1 that hp factors through the affine space bp n i 1 x ix i mi q here mi j if j n i j 1 lemma 2 2 let f be a formal power series in p 0 1 2 s 1 2 s then f factorizes uniquely as f f 1 f 2 fs where each fi is a formal power series in p 0 i proof the uniqueness part follows from the fact that k x y is a ufd we proof the existence part by induction on s the length of we assume that the statement is true for any with length smaller than s let f y 0 s i 1 ai x y x iy i where ai x y k x y in order to show that f factorizes as required it is enough to show that f factorizes as f gh where g y 0 s 1 s 1 i 1 bi x y x iy i s 1 p 0 1 2 s 1 and h y s 1 c x y x p 0 s tamely ramified geometric langlands in positive characteristic 9 it is enough to solve the following system of equations b 1 cy 0 s 1 1 a 1 bi bi 1 cy i 1 s 1 i ai for 2 i s 1 bs 1 c as solving this system of equations is equivalent to solving a single equation with one variable c as 1 s 2 i 1 1 ias i 1 y dici 1 s 1 yds 1 cs 1 c as where di i j 1 s 1 j s 1 s j this equation has a solution by hensel s lemma let b 0 p be the subset of bp such that b b 0 p is characterized by the following properties 2 1 b q is smooth 2 2 f lies in p 0 so f factorizes as f f 1 f 2 fr where fi y i ai x y x ai x y k x y if s t for some s 6 t then the constant terms of as and at are not equal to each other in particular if p is a borel subgroup ofgln k b 0 p is characterized by the spectral curve being smooth lemma 2 3 for every b b 0 p there exists a k point of higgsn p that is mapped to b under the hitchin map hp proof let b b be the normalization of the spectral curve b and let b x be the projection to x let d spec o x q be the formal disk around q by 2 2 b x d is the disjoint union of i where i spec k x y y i ai x y x ai x y k x y let l be an invertible sheaf on b then l defines a k point l of higgsn q such that h l b and resq op the richardson orbit of p therefore we can find a partial flag structure on l q such that resq is nilpotent with respect to this partial flag structure remark 2 4 let e ep be a k point of higgsn p that is mapped to b b 0 p condition 2 2 on b enforces that resq lies in the richardson orbit op note that op n p consists of a single p orbit since we are in type a for any x op n p the centralizer of x in gln k lies in p therefore there is a unique partial flag structure on eq that is compatible with resq proposition 2 5 in the following two cases 1 gx 2 2 gx 1 n 3 and p g is a borel subgroup b 0 p is zariski open dense in bp moreover bp is the scheme theoretic image of the hitchin map hp i e the smallest closed subscheme of b through which hp factors 10 shiyu shen proof the first statement together with lemma 2 3 implies the second statement for the first statement we only need to show that both 2 1 and 2 2 define a non empty open subset in bp we start by showing that 2 1 defines a non empty open subset in bp we denote by bsmp the locus in bp where the spectral curves are smooth away from q since bsmp bp is open it is enough to show that it is non empty case 1 gx 2 except for the case when gx 2 n 2 p gl 2 k we use the following version of bertini s theorem in cgm 86 theorem 2 6 cf cgm 86 corollary 1 let v be a smooth algebraic variety over an algebraically closed field k let s be a finite dimensional linear system on v assume that the rational map v 99 k pn corresponding to s induces whenever defined separably generated residue field extensions then a generic element of s defines a subscheme of v that is smooth away from the base locus of s let be the projection t x q x we denote by y the tautological section of x q let s be the linear system of sections in x q n spanned by yn and bi y n i for all bi x i x i mi q i 1 2 n the section yn is not contained in the span of bi y n i the set of spectral curves b with b bp corresponds to the open subset of s defined by the coefficient of y n being non zero let n dim s 1 we denote by fs t x q 99 k pn the map induced by s in order to apply theorem 2 6 we show that fs is unramified away from 1 q which will imply that fs induces finite separable extensions on the residue fields when restricted to t x q by the exact sequence f s pn t x q t x q t x q pn 0 it is enough to show that for any k point p on t x q such that p p 6 q the map induces a surjection onto the fiber of t x q at p let v spec a be an affine open neighborhood of p in x let x be an element of a that is mapped to a local parameter of x at p shrinking v if necessary we assume q v and dx is a nowhere vanishing section of 1 v let u 1 v the section dx gives a trivialization of t x q v and t x q u under this trivialization the tautological section y is equal to x considered as an element in ou and u is a free ou module generated by dx and dy the fiber of u at p is a k vector space of dimension two spanned by dx and dy under our assumptions on gx n and p we have dimk x i x i mi q dimk x i x i mi q p 1 for i 1 dimk x i x i mi q p dimk x i x i mi q 2 p 1 for i 2 take s 1 x n x n mn q x n x n mn q p s 2 x n x n mn q p x n x n mn q 2 p s 3 x n 1 x n 1 mn 1 q x n 1 x n 1 mn 1 q p then d s 2 s 1 and d s 3 y s 1 span the fiber of u at p now we apply theorem 2 6 to the restriction of the linear system s to t x q since q 1 q is the only base point of s a spectral curve b is smooth away from q for a generic b bp tamely ramified geometric langlands in positive characteristic 11 case 2 gx 2 n 2 p gl 2 k by the same arguments as in case 1 the map fs t x q pn is unramified away from the union of 1 p for all p x q that satisfies o 2 p x there are finite many points of x with this property therefore the fact that a generic spectral curve is smooth away from q follows from the following lemma lemma 2 7 let p x q for a generic b bp the spectral cover b x is e tale around p proof this follows easily from the calculation dimk x i x i mi q dimk x i x i mi q p 1 for i 1 case 3 gx 1 we consider the subspace n i 1 x ix bp since x is isomorphic to ox it is easy to find b n i 1 x ix such that the spectral cover b x is e tale away from 1 q now we turn to 2 2 let b bp the condition f b p 0 is equivalent to the condition that for i 1 2 r the n i th component of b lies in x n i x n i i q x n i x n i i 1 q this condition defines a non empty open subset of bp since dimk x n i x n i i q dimk x n i x n i i 1 q 1 under our assumptions on gx n and p the fact that the second condition in 2 2 defines a non empty open subset follows easily from the uniqueness part of lemma 2 2 remark 2 8 the second statement in proposition 2 5 was previous obtained in bk 18 using different methods remark 2 9 proposition 2 5 also holds for the case of x p 1 with ramification at d q 1 q 2 qm m 4 and each parabolic subgroup pi is a borel subgroup we need to show that for a generic b bpd n i 1 p 1 i p 1 i 1 d the spectral curve b is smooth for each i 1 2 m a generic spectral curve is smooth above qi since dimk p 1 n p 1 n 1 d dimk p 1 n p 1 n 1 d qi 1 therefore it is enough to show that there exists b bpd k such that b is smooth away from 1 qi if n 3 the same arguments as in case 1 of the proof of proposition 2 5 would work if n 2 we consider the subspace p 1 p 1 p 1 2 p 1 q 1 q 2 q 3 q 4 bpd since p 1 p 1 0 and p 1 2 p 1 q 1 q 2 q 3 q 4 p 1 op 1 k the spectral curve b is e tale away from 1 qi for any b k 12 shiyu shen 2 3 spectral data of parabolic higgs bundles the next theorem describes the spectral data of parabolic higgs bundles theorem 2 10 cf ss 95 theorem 5 16 for b b 0 p k the fiber of the hitchin map h 1 p b is isomorphic to the picard stack pic b here b b is the normalization of the spectral curve b proof we ve already constructed a map pic b h 1 p b in the proof of lemma 2 3 therefore it is enough to construct the inverse map let e h 1 p b and we denote by f coh b the corresponding spectral sheaf our goal is to show that there is a natural sheaf l coh b such that l f let b spec o b q note that by condition 2 2 in the definition of b 0 p o b k x y f and f f 1 f 2 fr fi p 0 i therefore o b b b r i 1 o i where o i k x y fi each i is the formal disk around a point of b that maps to q under since is an isomorphism away from the pre image of q in order to construct l coh b such that l f it is enough to show that f f b sheafifies on b b b let 0 m 1 m 2 mr m be the primary decomposition of the zero submodule 0 f such that mi is fi primary and m is m primary where m is the maximal ideal in o b then we have an injection f r i 1 f mi f m since b xd is smooth we have f x 1 r i 1 o i x 1 therefore f mi x 1 is isomorphic to o i x 1 and induces an isomorphism 2 3 f x 1 r i 1 f mi x 1 since i is smooth a torsion free sheaf on i is locally free therefore f mi is isomorphic to o i since we require that resq op the nilpotent orbit that contains the nilpotent matrix with jordan blocks of sizes 1 2 r we have dimk f mf r since dimk o i mo i 1 for each i dimk f mf r i 1 dimk f mi m f mi by nakayama s lemma and 2 3 above the map induces an isomorphism f r i 1 f mi since each f mi is isomorphic to o i the isomorphism above implies that f sheafifies on b b b r i 1 i tamely ramified geometric langlands in positive characteristic 13 for the purpose of this paper we need to develop a family version of theorem 2 10 the first step is to construct a simultaneous normalization of the family of spectral curves above b 0 p this can be done since the spectral curves above b 0 p are equisingular to be more precise let b 0 p t x q be the global spectral curve above b 0 p we will construct a new family of curves b 0 p with a proper birational morphism such that for each b b 0 p k the morphism b b b is the normalization of b the construction is as follows recall that q is the closed point of t x q above q x that lies in the zero section of t x q we blow up b 0 p t x q along b 0 p q and denote the strict transform of by 1 let v be an open neighborhood of q and u 1 v for b b 0 p k let b v v x b then o b v is isomorphic to ou f for some f y n b 1 y n 1 bn 1 y bn bi ov since b b 0 p k f factorizes as f f 1 f 2 fr fi p 0 i we write fi y i ai x y x where ai x y k x y we denote v x 1 b by 1 b v then 1 b v is a closed subvariety of spec ou u x yu we denote by q 1 the point defined by y u 0 by assumption 2 1 and the second part of assumption 2 2 in the definition of b 0 p 1 b is smooth away from q 1 let 1 b spec o 1 b q 1 then o 1 b k u y t i 1 y i 1 ai yu y u where t is the largest integer so that t 1 0 let g t i 1 y i 1 ai yu y u and gi y i 1 ai yu y u so g factorizes as g g 1 g 2 gt in each gi there is a unique monomial of the form ym and the degree of such monomial is in decreasing order compared to f 1 the degree of such monomial in g 1 is lower by 1 this observation guarantees that the family of curves can be resolved simultaneously by 1 steps of blow ups now we blow up spec ou u x yu along b 0 p q 1 and denote the strict transform of 1 by 2 repeating this procedure we get a series of families of curves above b 0 p 1 1 1 1 it follows from the observation above that 1 b is smooth for each b b 0 p k the morphism 1 b 0 p is flat since each 1 b is a projective curve of the same genus the morphism 1 is proper and birational by properties of strict transforms we set 1 now we are ready to state the following theorem which is a family version of theorem 2 10 we denote higgsn p bp b 0 p by higgs 0 n p theorem 2 11 the correspondence between higgs bundles and spectral sheaves induces an isomorphism of stacks over b 0 p higgs 0 n p pic b 0 p 14 shiyu shen proof let s be a k scheme since both higgs 0 n p and b 0 p are locally of finite type over k we can assume s is locally of finite type over k let e be an s point of higgs 0 n p such that h e b b 0 p s we denote by f the corresponding spectral sheaf on b the goal is to construct a sheaf f on b such that b f f we set 0 b b f 0 f the strategy is to construct by induction a series of sheaves fk on k b k 1 2 1 such that pk fk fk 1 where pk is the map pk k b k 1 b we assume that we already have f 0 f 1 ft 1 with the required property and aim to obtain ft note that above v an open neighborhood of q while obtaining kb we add a new variable uk to o k 1 b and impose uk 1 uky starting from u 0 x therefore in order to construct ft so that pt ft ft 1 all we need to do is to define an action of ut 1 y on ft 1 note that for any s spec k s a closed point of s s ft 1 is a torsion free sheaf on t 1 b s t 1 b s s spec k therefore if such an action exists it is unique for the existence of such an action we consider the coherent sheaf g ut 1 ft 1 ut 1 ft 1 yft 1 on t 1 b there exists an action of ut 1 y on ft 1 if and only if g 0 by theorem 2 10 such an action exists when restricted to s so s g 0 for all closed points s of s therefore g 0 we set f f 1 since b is smooth f is an invertible sheaf now let e 1 1 and e 2 2 be two s points ofhiggs 0 n p both mapped to b under the hitchin map and we denote the corresponding spectral sheaves by f 1 and f 2 the construction of f implies that there is an isomorphism homo b f 1 f 2 homo b f 1 f 2 therefore we have a morphism of stacks higgs 0 n p pic 0 b 0 p the inverse of this morphism is constructed as follows let l be an invertible sheaf on b since b s t x q there is a morphism os tx q endo b l by adjunction we get a morphism os tx q endo b l endox l by remark 2 4 there is a unique parabolic reduction of l at q that is compatible with this higgs field 3 azumaya property of differential operators in positive characteristic 3 1 frobenius twist of a k scheme let y be a scheme over an algebraically closed field k of characteristic p recall that the absolute frobenius fy y y is the map that fixes the underlying topological space and takes f to fp on regular functions the frobenius twist y 1 of y is the k scheme that fits into the following pull back diagram y 1 y spec k fspec k spec k tamely ramified geometric langlands in positive characteristic 15 the relative frobenius fr y y 1 is the unique map that makes the following diagram commute y fy fr y 1 y spec k fspec k spec k since fr induces a bijection on k points we will not distinguish between k points on y and k points on y 1 let f and g be two oy modules a map f g is called p linear if it is additive and satisfies fs fp s for any f ou s f u and open u y for any oy module f there is a natural p linear map f fy f this map is universally p linear in the sense that any p linear map f g factors through f fy f and gives a unique oy linear map fy f g 3 2 azumaya property of differential operators in this section we review the azumaya property of crystalline differential operators in characteristic p following bb 07 let y be a smooth variety over k we denote bydy the sheaf of crystalline differential operators on y i e the sheaf of algebras generated by oy and ty subject to the relations f f f 1 2 2 1 1 2 for any f ou 1 2 ty u and u y open since we are in characteristic p for any ty u p dy acts as a derivation on ou and we denote this derivation by p ty u there is a p linear map ty dy defined by p p by the discussion above induces an oy linear map fr ty 1 f y ty dy by adjunction we have an oy 1 linear map ty 1 fr dy therefore fr dy sheafifies on t y 1 i e there exists a sheaf of algebras dy on t y 1 that satisfies 1 dy fr dy the following theorem is proved in bmr 08 theorem 3 1 cf bb 07 theorem 3 3 and bmr 08 theorem 2 2 3 1 the map induces an isomorphism of sheaves from ot y 1 to the center of dy 2 the sheaf of algebras dy is an azumaya algebra over t y 1 of rank p 2 d where d is the dimension of y let a be an azumaya algebra on y a splitting of a is defined to be a pair e where e is a locally free sheaf on y and a end e is an isomor phism of oy algebras such a e induces an equivalence between the category qcoh y of quasi coherent sheaves on y and the category a mod of a modules which maps f qcoh y to e f we define an equivalence from an azumaya algebra a to another azumaya algebra b to be a splitting of aop b such a splitting induces an equivalence from the category of a modules to the category of b modules note that if there is a locally free sheaf e that gives a splitting of aop b then homoy e oy gives a splitting of a b op 16 shiyu shen let f z y be a morphism between smooth k varieties we denote by df 1 the frobenius twist of the map induced by the differential of f df 1 z 1 y 1 t y 1 t z 1 let p 2 be the projection to t y 1 then we have proposition 3 2 cf bb 07 proposition 3 7 the azumaya algebras df 1 dz and p 2 dy are canonically equivalent following bb 07 we define f dy mod dz mod to be the composition of the pull back functor dy mod p 2 dy mod the equivalence in proposition 3 2 and the push forward functor df dz mod dz mod similarly we de fine f dz mod dy mod to be the composition of the pull back functor dz mod df dz mod the equivalence in proposition 3 2 and the push forward functor p 2 dy mod dy mod let 1 y be the tautological 1 form on t y 1 we think of 1 y as a map 1 y t y 1 t t y 1 corollary 3 3 cf bb 07 proposition 3 11 and corollary 3 12 1 the azumaya algebra 1 y dt y is canonically equivalent to dy 2 let 1 1 z 1 z 1 and 1 2 y 1 y 1 if f 1 1 2 1 1 then the two azumaya algebras 1 1 dz and 1 2 f 1 dy are canoni cally equivalent let m be a dy module we denote by m the corresponding flat connection m m y there is a p linear map ty end m defined by m m p m p by the discussion in section 3 1 we can associate with it a oy linear map m fr ty 1 end m which we call the p curvature of m we review the cartier descent for flat connections with zero p curvature let f be a quasi coherent sheaf on y 1 there is a canonical dy action on fr f oy o y 1 f which comes from the canonical action of dy on oy therefore we have a flat connection fr f can this construction induces a functor from the category of quasi coherent sheaves on y 1 to the category of dy modules on y with zero p curvature theorem 3 4 cartier descent cf kat 70 theorem 5 1 let y be a smooth vari ety over k then the construction of fr f can induces an equivalence between the category of quasi coherent sheaves on y 1 and the category of dy modules on y with zero p curvature 3 3 differential operators on smooth stacks let y be a smooth irreducible algebraic stack over an algebraically closed field k when k is the field of complex numbers c for y that is good in the sense that it satisfies dimt y 2 dimy the sheaf of differential operators on y is defined in bd 91 as a sheaf of algebras dy on the smooth topology ysm we review this definition as follows the objects of ysm are k schemes s together with a smooth morphism fs s y and the morphisms between s fs and s fs are pairs containing a smooth tamely ramified geometric langlands in positive characteristic 17 morphism s s and fs fs let s fs be an object of ysm we denote by i the left ideal dsts y ds generated by the relative tangent sheaf ts y we define dy s ds i it has a ds action by left multiplication let nds i be the normalizer of i in ds we define dy s nds i i in other words we set dy s endds dy s op for any smooth morphism s s over y we have a canonical isomorphism 3 1 dy s dy s which restricts to an isomorphism 3 2 1 dy s dy s where 1 is the sheaf theoretic inverse image we call dy the sheaf of differential operators on y it is observed in bb 07 that the isomorphism 3 2 no longer holds when k is of characteristic p 0 but meanwhile fr dy is a quasi coherent sheaf on y 1 and the authors constructed a coherent sheaf of algebras dy on t y 1 that satisfies 1 dy fr dy the construction of dy is as follows for any k scheme s with a smooth morphism fs s y we need to define a coherent sheaf of algebras dy s on t y 1 s s 1 y 1 t y 1 we consider the ds module d y s and denote by d y s the corresponding coherent sheaf on t s 1 since we mod out the left ideal generated by ts y when defining d y s the support of d y s lies in the closed substack t y 1 s df 1 s t s 1 we set dy s endds d y s op for any smooth morphism s s over y isomorphism 3 1 induces an isomorphism 1 dy s dy s where is the map t y s t y s therefore dy s sheafifies to be a coherent sheaf of algebras dy on t y 1 we have the following proposition proposition 3 5 cf bb 07 lemma 3 14 and tra 16 proposition 2 7 the co herent sheaf of algebras dy satisfies 1 dy fr dy if the stack y is good in the sense that dimt y 2 dimy and we denote by t y 0 the maximal smooth open substack of t y then the restriction of dy to t y 0 1 is an azumaya algebra of rank p 2 dimy 3 4 d modules azumaya algebras and gm gerbes let k be an algebraically closed field let b be a k scheme locally of finite type let y be a stack locally of finite type over b let y y be a gm gerbe over y we denote by qcoh y the category of quasi coherent sheaves on y we say y splits if there is an isomorphism y y bgm of gm gerbes in this case there is a decomposition qcoh y n z qcoh y n given by the weight of the gm action if y does not split we still have such a decomposition by pulling back along the action map a bgm y y we call qcoh y 1 the category of twisted quasi coherent sheaves associated to y let a be an azumaya algebra on y we associate with it a gm gerbe y a over y which is defined as follows for f s b a map of schemes y a s classifies triples y e where y y s e is a vector bundle on s and y a end e 18 shiyu shen is an isomorphism of algebras over s we call y a the stack of splittings of a we have the following lemma lemma 3 6 cf bb 07 lemma 2 3 and dp 08 example 2 6 there is a canonical equivalence between the category a mod of a modules on y and qcoh y a 1 now let y be a smooth irreducible algebraic stack over k a crystalline d module m on y is the datum of a d module ms on s for each object s fs in ysm and an isomorphism ms ms of d modules for each morphism s s in ysm here denotes the o module pull back with the natural d module structure those isomorphisms need to satisfy the cocycle condition for compositions when k is of characteristic p 0 d modules on y correspond to twisted quasi coherent sheaves associated to a certain gm gerbe gy on t y 1 which is defined as follows for any smooth morphism fs s y we associate with it a gm gerbe gy s on t y 1 s s 1 y 1 t y 1 which is defined to be the pull back of the gm gerbe of splittings of the azumaya algebra ds along df 1 s t y 1 s t s 1 for any smooth morphism s s over y we have an isomorphism 1 gy s gy s since dfs factorizes as s y t y s s s y t y id dfs s s t s d t s and the two azumaya algebras d 1 ds and p 2 ds are equivalent by proposition 3 2 it is shown in tra 16 that the category of d modules on y is equivalent to the category of twisted quasi coherent sheaves associated to gy see theorem 2 3 in tra 16 now we assume y satisfies dimt y 2 dimy and denote by t y 0 the maxi mal smooth open substack of t y recall that in section 3 3 we defined a coherent sheave of algebras dy on t y 1 such that its restriction to t y 0 1 is an azu maya algebra of rank p 2 dimy the gm gerbe of splittings of this azumaya algebra is isomorphic to the restriction of gy to t y 0 1 see proposition 2 7 in tra 16 therefore the category of dy t y 0 1 modules is a localization of the category of crystalline d modules on y 3 5 tensor structures on azumaya algebras let g be a commutative group stack over b and a an azumaya algebra over g we denote the multiplication on g by g g g following ov 07 we define a tensor structure on a to be an equivalence of azumaya algebras from a to a a which is a bimodule m that induces a morita equivalence together with an isomorphism m a a a p 3 m a m a a p 1 m of bimodules that satisfies the pentagon condition dm 82 1 0 1 a tensor structure on the azumaya algebra a induces a group structure on the stack ya of splittings of a as follows let s be a k scheme an s point of ya is a pair a e where a g s and e is a splitting module for a a let a e and b f be two such pairs the locally free sheaf e f is a splitting module for a a b a applying the equivalence between a and a a and then pulling back along the diagonal map s s s s we get a splitting module for a b a the construction of this group structure implies that the projection map ya g is a group homomorphism therefore we have a short exact sequence 0 bgm ya g 0 tamely ramified geometric langlands in positive characteristic 19 4 a non abelian hodge correspondence between locn q and higgsn q 4 1 spectral data for flat connections with regular singularities let e be a flat connection of rank n on x with regular singularity at q we associate with it the p curvature which is a ox linear map fr tx 1 q end e it is associated with the p linear map tx q end e defined by p p for any tx q u and u x open we can think of as a twisted higgs field e e fr x 1 q the coefficients of its characteristic polynomial define a point b of n i 1 x fr x 1 q i let fr n i 1 x 1 x 1 q i n i 1 x fr x 1 q i be the pull back map it follows from a similar argument as in lp 01 proposition 3 2 that b actually lies in the image of fr and we also denote by b the corresponding point in b 1 n i 1 x 1 x 1 q i we call this map h locn q b 1 the hitchin map for flat connections with regular singularity at q the corresponding spectral curve b lies in the total space of fr x 1 q which is isomorphic to x x 1 t x q 1 since b b 1 b fits into the following pull back square b 1 b 1 x fr x 1 where 1 b t x q 1 is the spectral curve above b b 1 as defined in section 2 1 we denote by e coh b the spectral sheaf corresponding to so e satisfies e e let x be a local parameter of ox q let e be a flat connection with regular singularity at q restricting x x to q we get resq end eq which we call the residue of at q lemma 4 1 resq resq p resq proof this equation follows from the computation x x p x x remark 4 2 if we assume resq is nilpotent since p n resq p 0 so resq resq in particular they lie in the same nilpotent orbit 20 shiyu shen 4 2 statement of the theorem let a be an unordered n tuple of elements in k we denote by higgsn a x 1 the moduli stack of x 1 q twisted higgs bundles e on x 1 such that the unordered n tuple of eigenvalues of resq is a let b 1 a be the image of higgsn a x 1 under the hitchin map h 1 note that when a 0 0 0 b 1 a b 1 n we fix a set theoretic section of the artin schreier map k k that maps t to tp t let locn a be the substack of locn q that classifies flat connections e such that the unordered n tuple of eigenvalues of resq is a note that by lemma 4 1 h locn a b 1 a we denote by locr n a the substack of locn a that classifies flat connections e such that the corresponding spectral sheaf e coh b is invertible we have the following theorem theorem 4 3 1 locr n a has a natural structure of a pic 1 b 1 a torsor 2 locn a loc r n a pic 1 b 1 a higgsn a x 1 before getting into the proof of theorem 4 3 we state two corollaries corollary 4 4 there exists an e tale cover u b 1 a such that locn a b 1 a u higgsn a x 1 b 1 a u we denote by higgsn x 1 the moduli stack of x 1 q twisted higgs bundles e on x 1 such that resq is nilpotent and by locn the substack of locn q that classifies e with nilpotent resq then we have corollary 4 5 1 locrn has a natural structure of a pic 1 b 1 n torsor 2 locn loc r n pic 1 b 1 n higgsn x 1 the rest of this section is devoted to the proof of theorem 4 3 we start by showing proposition 4 6 the map h locrn a b 1 a is surjective we need to show that for any b b 1 a k there exists e loc r n a k that is mapped to b under the hitchin map the idea of constructing e is as follows we construct a flat connection e 0 0 on x q and a flat connection e on the formal disk around q such that both flat connections have the correct p curvature then we glue e 0 0 and e together using the beauville laszlo theorem bl 95 4 3 proof of proposition 4 6 let b b 1 a k let x and 1 1 x 1 be the corresponding spectral covers as described in section 4 1 we will construct e such that h e b and the spectral sheaf e is invertible step 1 in this step we show that there exists a flat connection e 0 0 on x q such that the spectral curve of 0 is 1 q and the spectral sheaf e 0 is invertible such a e 0 0 is equivalent to a splitting of the azumaya algebra i 0 dx q where i 0 is the embedding i 0 1 1 1 q t x q 1 note that for any rank p vector bundle f on 1 1 1 q such that end f i 0 dx q tamely ramified geometric langlands in positive characteristic 21 the corresponding spectral sheaf on 1 q is invertible this is because for any p x q and x a local parameter at p x acts as a regular nilpotent matrix on the fiber fp for any p 1 1 1 q such that 1 p p see the proof of lemma 2 2 1 in bmr 08 the existence of such a splitting is guaranteed by the the following theorem theorem 4 7 cf gro 16 theorem 3 21 let y be a scheme of finite type over an algebraically closed field assume dim y 1 then h 2 et y gm 0 in particular every azumaya algebra on y splits step 2 in this step we construct a flat connection e on the formal disk d spec o x q around q that satisfies the following three properties 5 1 e has regular singularity and the unordered n tuple of eigenvalues of res is a 5 2 the spectral curve of is d x 5 3 the spectral sheaf e is invertible now let x be a local parameter of x at q then d spec k x we denote x x x p px by y so o k x y f where f yn b 1 x y n 1 bn 1 x y bn x bi x k x since b b 1 a bi x actually lies in k x p we assume that a consists of t distinct elements a 1 a 2 at each appearing mi times then f k x p y xpk xp y factorizes as f t i 1 y ai mi therefore f factorizes as f f 1 f 2 ft where fi k x p y is monic and f i y ai mi therefore is the disjoint union of i spec k x y fi it is enough to construct flat connections e i i with the following properties 5 1 e i i has regular singularity and the eigenvalues of res i are all ai 5 2 the spectral curve of i is i 5 3 the spectral sheaf e i is invertible since o i is a local ring 5 3 implies that e i is isomorphic to o i let e be its generator a meromorphic flat connection with spectral curve i is determined by the connection acting on e which can be written as e gedx g o i x 1 by 5 1 and 5 2 need to satisfy the following 5 1 x x ai e x y ai e 5 2 x x p x x p e ye since x x p x x p e xp p 1 x g g p e 5 2 is equivalent to the following equation in o i xp p 1 x g g p y we look for solutions of the form g y ai ai x g 1 g 1 k x y so 5 2 is automatically satisfied and 5 1 is equivalent to p 1 x g 1 g p 1 y ai p xp 22 shiyu shen note that since fi y ai mi mod xpk xp y there exists a polynomial h k xp y such that y ai p xp h in o i by a substitution y y ai we can assume that fi y mi mod xpk xp y in this case o i k x y fi therefore it is enough to find a solution g 1 k x y it is easy to see that for any h k xp y the equation p 1 x g 1 g p 1 h has solutions in k x y step 3 let d spec k x be the punctured disk around q and let d d be the spectral curve above d both e 0 d 0 d and e d d give splittings of the azumaya algebra dx since all invertible sheaves on are trivial we have an isomorphism of connections e 0 d 0 d e d d we fix such an isomorphism by the theorem of beauville laszlo bl 95 e 0 and e can be glued together to get a rank n vector bundle e on x since the glueing data is compatible with the connections 0 and are glued together to get a flat connection on e with regular singularity at q this connection e satisfies all the properties we need 4 4 dx modules on spectral covers of x let b b 1 and let x and 1 1 x 1 be the corresponding spectral covers as described in section 4 1 we have the following pull back square 1 1 x fr x 1 there is a canonical dx action on o ox o x 1 o 1 which comes from the canonical action of dx on ox similarly for any quasi coherent sheaf m on 1 the pull back sheaf m ox o x 1 m has a canonical dx action we denote by can the corresponding map can m m ox x definition 4 8 we define a dx module on to be a quasi coherent sheaf f on together with a k linear map f f ox x that satisfies fs can f s f s for f ou s f u and u open let dx q be the subsheaf of algebras of dx generated by ox and tx q similarly we define dx q modules on the only difference is that now is a map f f ox x q we have the following lemma concerning this definition lemma 4 9 1 the structure sheaf o is a dx module on for any quasi coherent sheaf m on 1 the pull back m is a dx module on 2 let e be a flat connection with regular singularity at q such that h e b let e coh be the corresponding spectral sheaf then e is a dx q module on tamely ramified geometric langlands in positive characteristic 23 3 let f 1 1 and f 2 2 be two dx q modules on then f 1 o f 2 and homo f 1 f 2 have canonical structures of dx q modules on in all of the cases above we denote by can the corresponding map induced by the action of tx q let f be a dx q module on such that f is locally free then f has the structure of a flat connection with regular singularity at q 4 5 proof of theorem 4 3 now we construct the map that induces the iso morphism in theorem 4 3 let b b 1 a let e e loc r n a and m higgsn a x 1 both mapped to b under the hitchin map we denote the spec tral sheaf of e e by e coh and the spectral sheaf of m by m coh 1 lemma 4 10 let g coh 1 and let l be an invertible sheaf on the push forward l g is a locally free sheaf of rank n on x if and only if 1 g is a locally free sheaf of rank n on x 1 by lemma 4 9 and lemma 4 10 we get a flat connection e m can on x with regular singularity at q lemma 4 11 1 the flat connection e m can is mapped to b under the hitchin map h 2 the residue resq can has eigenvalues a the construction of e m can is functorial therefore we have a morphism of stacks over b 1 a locrn a b 1 a higgsn a x 1 locn a now we construct a map in the inverse direction let f f be a point of locn a such that h f f b let f coh be the spectral sheaf then by lemma 4 9 there is a canonical dx q action on homo e o f we denote homo e o f by f lemma 4 12 1 the flat connection f can has zero p curvature 2 the residue resq can is nilpotent by lemma 4 1 the residue resq can of f can at q satisfies resq can p resq can 0 this implies resq can is a semisimple matrix with integer eigenvalues but mean while resq can needs to be nilpotent so resq can must be the zero therefore f can is a flat connection without singularities by the cartier descent theorem 3 4 there is a canonical quasi coherent sheaf n on x 1 such that f can is isomorphic to fr n can note that n can be identified with elements in f that vanish under can the action of o 1 preserve those elements therefore there is a canonical quasi coherent sheaf m on 1 such that f can is isomorphic to m can as dx q modules on since e is 24 shiyu shen an invertible sheaf f f e m can the construction of m is functorial therefore we have a morphism of stacks over b 1 a locrn a b 1 a locn a higgsn a x 1 let e e loc r n a such that h e e b and denote the corresponding spectral sheaf by e coh let l be an invertible sheaf on 1 then by lemma 4 11 e l can loc r n a this construction defines an action of pic 1 b 1 a on loc r n a proposition 4 13 this action induces the structure of a pseudo pic 1 b 1 a torsor on locr n a proof let s be a k scheme let b be an s point of b 1 a we need to show that the action of pic 1 b on the fiber loc r n a b loc r n a b 1 a b s is simply transitive when locr n a b is non empty let e e and f f be two points of loc r n a that is mapped to b under the hitchin map we denote the corresponding spectral sheaves by e and f by the discussion after lemma 4 12 there exists a quasi coherent sheaf m on 1 b such that f f e m can since is faithfully flat e and f being invertible sheaves on b implies that m is an invertible sheaf on 1 b the map induces a map homo 1 b o 1 b m homdx q e e f f which is an isomorphism since produces its inverse we denote by locn q is the moduli stack of flat connections on x with regular singularity at q without constraints on the eigenvalues of the residue let locrn q locn q be the substack characterized by the spectral sheaf being invertible we have the following proposition proposition 4 14 the map h locrn q b 1 is smooth before getting into the proof of proposition 4 14 we state a corollary that is going to be used in the proof of theorem 4 3 corollary 4 15 the map h locrn a b 1 a is smooth proof the map locrn q b 1 b 1 a b 1 a is smooth by base change and the fiber product locrn q b 1 b 1 a is the disjoint union of loc r n c where c ranges from all unordered n tuples of elements in k that maps to a under the artin schreier map we denote by l ocn q the stack that classifies triples e where e is a vector bundle of rank n on x e e x q is a flat connection with regular singularity at q and eq kn is a frame of e at q the natural action of gln on the frame gives l ocn q the structure of a gln torsor over locn q lemma 4 16 locn q and l ocn q are algebraic stacks locally of finite type over k tamely ramified geometric langlands in positive characteristic 25 proof the 1 morphism locn q bunn is representable and locally of finite pre sentation since bunn is an algebraic stack locally of finite type over k and l ocn q is a gln torsor over locn q both locn q and l ocn q are algebraic stacks locally of finite type over k lemma 4 17 locrn q and l oc r n q are smooth proof in order to show that l oc r n q is smooth all we need to show is that for any small extension of finite generated artinian local k algebras a a an a point of l oc r n q can be lifted to an a point of l oc r n q i e we want to produce the dashed arrow for the following commutative diagram spec a l oc r n q spec a we denote by e the k point spec a maa spec a l oc r n q the obstruction to the existence of such liftings lies in the second hypercohomology h 2 f e of the complex f e end e q end e end e x q where end e is the canonical connection on end e induced by by serre duality h 2 f e h 0 f e note that h 0 f e is isomorphic to the lie algebra of aut e since e locrn q we have aut e k by proposition 4 13 but multiplication by scalars does not preserve the framing therefore aut e is the trivial group this implies h 2 f e h 0 f e 0 a by product of the proof of lemma 4 17 is the following computation of the dimension of locrn q since h 0 f e h 2 f e 0 dim l oc r n q dimh 1 f e 2 dimh 0 x end e x q dimh 0 x end e q by riemann roch dimh 0 x end e x q dimh 0 x end e q n 2 g therefore dimlocrn q dim l oc r n q dimgln k n 2 2 g 1 proof of proposition 4 14 let b b 1 k by proposition 4 6 and 4 13 the fiber locrn q b loc r n q b 1 b spec k is a pic 1 b torsor we compute that dimb 1 n n 1 2 g 1 2 n 1 g 26 shiyu shen and dimpic 1 b g 1 b 1 n n 1 2 g 1 2 n g 1 therefore dimpic 1 b dimloc r n q dimb 1 since both locrn q and b 1 are smooth the map h is flat by miracle flatness furthermore since pic 1 b is smooth loc r n q b is smooth therefore h is smooth proof of theorem 4 3 the first part follows from proposition 4 13 and corollary 4 15 for the second part it is easy to see that the morphism defined above induces a morphism locrn a pic 1 b 1 a higgsn a x 1 locn a and induces the inverse now we discuss how the residues of higgs bundles and flat connections match under proposition 4 18 let e e loc r n a and m m higgsn a x 1 such that h e e h 1 m m b b 1 a k denote the image of e e and m m under by f f then resq f and resq m lie in the same adjoint orbit proof let e coh be the spectral sheaf of e e and let m coh 1 be the spectral sheaf of m m let x be a local parameter of x at q note that resq m is the action of x p px on the fiber 1 m q and resq f is the action of xp px on the fiber e m q since 1 m q m q with the same xp px action it suffices to show that the action of x p px on m q and e m q lie in the same adjoint orbit this follows from the assumption that e is an invertible sheaf in particular if a 0 proposition 4 18 together with remark 4 2 implies that resq f and resq m lie in the same nilpotent orbit therefore we have the following corollary 4 19 the scheme theoretic image of locn p under the hitchin map h is b 1 p 5 tamely ramified geometric langlands correspondence in positive characteristic 5 1 the algebra dbunn p in this subsection we clarify what we mean by dbunn p since the stack bunn p does not satisfy the property required in proposition 3 5 we cannot apply this proposition directly in order to solve this problem we introduce a new stack bunn p similar to the stack bunn introduced in bb 07 the stack bunn p classifies the same objects as bunn p but the morphisms are different let s be a k scheme and let e e q and f f q be two rank n vector bundles on s x with partial flag structures of type p see remark 1 6 along s q then the set of morphisms between e e q and f f q are defined to be the set tamely ramified geometric langlands in positive characteristic 27 of isomorphic classes of pairs l where l is a line bundle on s and is an isomorphism e e q f p s l f q l by taking l os we get a natural map bunn p bunn p and bunn p is a gm gerbe over bunn p proposition 5 1 the stack bunn p satisfies dim t bunn p 2 dimbunn p proof we apply the same strategy as in gin 01 the main goal is to show that the nilpotent cone n ilp h 1 p 0 t bunn p is isotropic then the argument used in the proof of proposition 7 8 in gin 01 applies here to deduce the desired equality let b be a borel subgroup of gln k that is contained in p we denote by bunb the moduli stack of b bundles on x by lemma 23 in hei 10 the natural map f bunb bunn p is surjective in order to apply lemma 5 in gin 01 to show that n ilp is isotropic all we need to show is that for any e e q n ilp k there exists eb bunb k such that f eb e e q and f 0 t eb bunb i e there exists a complete flag structure of e over x such that its restriction to q is compatible with the partial flag structure e q and the higgs field is nilpotent with respect to this complete flag structure we choose a basis e 1 e 2 en of eq such that the complete flag structure 0 e 1 e 1 e 2 e 1 e 2 en eq is compatible with e q let u speca be an open neighborhood of q over which e and 1 x q trivializes fixing such trivializations the higgs field corresponds to an a linear map an an since resq is nilpotent with respect to e q q ei lies in the k vector space spanned by e 1 e 2 ei 1 shrinking u if necessary the basis e 1 e 2 en of eq can be lifted to a basis e 1 e 2 e n of e over u that still satisfies e i e 1 e 2 e i 1 the b reduction of e over u given by 0 e 1 e 1 e 2 e 1 e 2 e n e u can be extended to a b reduction over x since gln k b is projective such a b reduction satisfies all the properties we need remark 5 2 over c the field of complex numbers the analogue of proposition 5 1 was proved in bkv 17 see theorem 6 7 for a general reductive group g and parahoric p it is not clear to the author if their arguments can be adapted to the characteristic p setting now we apply proposition 3 5 to bunn p and get dbunn p the sheaf of algebras dbunn p is defined to be the pull back of dbunn p to bunn p we denote higgsn p bp b 0 p by higgs 0 n p and locn p b 1 p b 0 p 1 by loc 0 n p since higgs 0 n p is smooth dbunn p restricts to an azumaya algebra d 0 bunn p on higgs 0 n p 1 higgs 1 n p t bun 1 n p now we are in the position to state the main theorem of the paper theorem 5 3 there exists an oloc 0 n p d 0 bunn p module p such that the fourier mukai transform p with kernel p induces an equivalence db qcoh loc 0 n p db d 0 bunn p mod between the bounded derived category of quasi coherent sheaves on loc 0 n p and the bounded derived category of d 0 bunn p modules 28 shiyu shen 5 2 the tensor structure on d 0 bunn p recall that in section 2 we constructed a family of curves b 0 p such that higgs 0 n p pic b 0 p in this subsection we show that there is a natural tensor structure on the azumaya algebra d 0 bunn p in the sense of ov 07 see section 3 5 we denote 1 b 0 p q by 0 where b 0 p x is the universal spectral cover let i be the natural inclusion i 0 b 0 p t x we denote by a the morphism a b 0 p pic b 0 p pic b 0 p that maps x l to l x we denote by the abel jacobi map b 0 p pic b 0 p that maps x b 0 p to o x let x be the tautological 1 form on t x and bunn p the tautological 1 form on t bunn p by the same arguments as in theorem 4 12 in bb 07 we have proposition 5 4 when restricted to 0 b 0 p pic b 0 p i x bunn p a bunn p 0 b 0 p pic b 0 p in particular i x bunn p 0 let 0 bunn p be the restriction of bunn p to higgs 0 n p by lemma 3 14 in bb 07 in order to construct a tensor structure on d 0 bunn p it is enough to show that for the addition map m pic b 0 p pic b 0 p pic b 0 p the 1 form 0 bunn p satisfies the following equality 5 1 m 0 bunn p 0 bunn p 0 bunn p we denote by picd b 0 p the degree d component of pic b 0 p since there are isomorphisms between components of pic b 0 p that preserve 0 bunn p it is enough to prove the equality 5 1 for large enough d d and md d pic d b 0 p pic d b 0 p pic d d b 0 p we denote by d the map d b 0 p d picd b 0 p that maps x 1 x 2 x d b 0 p d to o x 1 x 2 x d for d 2 g b 2 there is an open subset of d such that d is smooth and dominant therefore it is enough to show that d d 0 bunn p d 0 bunn p d 0 bunn p by proposition 5 4 this equality holds on 0 d d therefore it holds on d d tamely ramified geometric langlands in positive characteristic 29 5 3 torsor structure on loc 0 n p by corollary 4 5 proposition 4 18 remark 4 2 remark 2 4 and theorem 2 11 we have the following proposition 5 5 1 the isomorphism in corollary 4 5 induces loc 0 n p locrn b 1 b 0 p 1 pic 1 b 0 p 1 higgs 0 n p 1 2 the action of pic 1 b 0 p 1 on higgs 0 n p 1 gives loc 0 n p the structure of a pic 1 b 0 p 1 torsor let s be a k scheme let b be an s point of b 0 p 1 consider the following commutative diagram b fr b b 1 b 1 1 b 1 b 1 x frx x 1 here b x x 1 1 b there exists a unique map from b to b that makes the diagram commute we call this map note that is finite since fr b is finite and is separeted let e e q e be an s point of locn p such that h e e b let e coh b be the spectral sheaf we associate with it an invertible sheaf e coh b that satisfies e e as follows let e 1 1 loc r n and e 2 2 higgs 0 n p 1 such that h e 1 1 h 1 e 2 2 b and they are mapped to e e under the isomorphism in proposition 5 5 1 let e 1 coh b be the spectral sheaf of e 1 1 and l coh 1 b the spectral sheaf of e 2 2 then we have e e 1 l by theorem 2 11 there exists a unique invertible sheaf l on 1 b such that 1 l l now we define e e 1 l this construction does not depend on the choice of e 1 1 and e 2 2 lemma 5 6 the flat connection can on e o b o b e defined by can f s f s f e d s for any tu f ou s e u and open u b has no singularities here d is the tangent map t b tx proof since b b 0 p 1 q consists of r points q 1 q 2 qr the only places that can might have singularities are q 1 q 2 qr note that b x has ramification index i at qi let t be a local parameter at qi b and x a local 30 shiyu shen parameter at q x such that x t i let u be an open neighborhood of qi since e e has nilpotent residue at q there exists a positive integer n such that for any m n and s e u e x x m s xe we compute that can t t pn f s t t pn f s f e d t t pn s since t t pn f to b and e d t t pn s e ix x pn s xe the sum lies in to b e therefore the residue of e can at q is nilpotent but since e is an invertible sheaf on b the residue must be zero so the flat connection can has no singularity at qi we denote by b the restriction of bunn p to b then we have the following lemma 5 7 the connection e can is mapped to 1 b under the hitchin map h proof let p b such that p p 6 q let x be a local parameter at p we denote x by y so near p the spectral curve b is the vanishing scheme of a polynomial of the form yn b 1 x y n 1 bn 1 x y bn x since b is smooth y y p is a local parameter of b at p since x ydx we have i x y x ydy and i x 1 y x pypdyp let u be an open neighborhood of p for f ou and s e u we compute py f s f d y p s f y x p px s f y x pyp s yp i x 1 f s therefore h e can is equal to i x 1 when restricted to 0 b 1 by propo sition 5 4 h e can 1 b now recall that for a smooth variety y over k dy is the azumaya algebra on t y 1 that satisfies fr dy 1 dy proposition 5 8 let b be an s point of b 0 p 1 the construction of e can induces an isomorphism of stacks between loc 0 n p b loc 0 n p b 0 p 1 b s and the stack of splittings of the azumaya algebra 1 b d b here we think of 1 b as a map 1 b 1 b t 1 b proof both stacks are pic 1 b torsors since is compatible with the pic 1 b actions it induces an isomorphism between those two stacks tamely ramified geometric langlands in positive characteristic 31 5 4 fourier mukai transforms on commutative group stacks in this sub section we review the fourier mukai transforms on commutative group stacks fol lowing bb 07 let k be an algebraically closed field let b be an irreducible k scheme that is locally of finite type let g be a commutative group stack locally of finite type over b the dual commutative group stack g classifies 1 morphisms of group stacks from g to bgm the main examples we are going to consider are examples 5 9 1 g z g bgm 2 g bgm g z 3 g zn g b n here n spec z x x n 1 4 g n g bzn 5 g a is an abelian scheme then g a is the dual abelian scheme by the definition of g there is a universal gm torsor on g g which gives rise to the poincare line bundle pg in bb 07 a commutative group stack g is called very nice if locally in smooth topology g is a finite product of stacks in the examples above under this assump tion the natural map g g is an isomorphism therefore there is another poincare line bundle pg on g g theorem 5 10 cf bb 07 theorem 2 7 let g be a very nice commutative group stack and let g be its dual then the fourier mukai functor pg with kernel pg induces an equivalence of derived categories db qcoh g db qcoh g now let g and g be very nice commutative group stacks that fits into a short exact sequence of group stacks 0 bgm g g 0 by taking dual we get another short exact sequence 0 g g z 0 let g 1 1 1 remark 5 11 note that g 1 classifies maps of group stacks g bgm such that the composition bgm g bgm is the identity such a map gives a splitting of g considered as a gm gerbe over g recall that the bgm action on g gives a decomposition db qcoh g n z db qcoh g n proposition 5 12 cf ari 08 proposition a 7 and bb 07 proposition 2 9 the fourier mukai functor p g restricts to an equivalence of derived categories db qcoh g 1 db qcoh g 1 32 shiyu shen 5 5 proof of theorem 5 3 let yd 0 bunn p be the gm gerbe defined in subsection 3 4 over higgs 0 n p pic 1 b 0 p 1 that classifies splittings of the azumaya algebra d 0 bunn p as discussed in section 3 5 the tensor structure on d 0 bunn p gives yd 0 bunn p the structure of a commutative group stack and it fits into a short exact sequence 0 bgm yd 0 bunn p pic 1 b 0 p 1 0 by taking dual we get another short exact sequence 0 pic 1 b 0 p 1 y d 0 bunn p z 0 proposition 5 13 y d 0 bunn p 1 1 1 is isomorphic to loc 0 n p as pic 1 b 0 p 1 torsors proof it is enough to construct a morphism from y d 0 bunn p 1 to loc 0 n p that is compatible with the pic 1 b 0 p 1 actions let s be a k scheme let b be an s point of b 0 p 1 by remark 5 11 an s point of y d 0 bunn p 1 lying above b gives a splitting of the azumaya algebra d 0 bunn p pic 1 b pulling back along the abel jacobi map 1 1 b pic 1 b by corollary 3 3 2 and proposition 5 4 such a splitting gives a splitting of the azu maya algebra 1 b d b which in turn gives a point of locn p b by proposition 5 8 this map is clearly compatible with the pic 1 b actions now let py be the poincare line bundle on y d 0 bunn p yd 0 bunn p by lemma 3 6 and proposition 5 13 py restricts to an oloc 0 n p d 0 bunn p module p by proposition 5 12 the fourier mukai transform with kernel p p d b qcoh loc 0 n p d b d 0 bunn p mod induces an equivalence of derived categories this completes the proof of theorem 5 3 5 6 the hecke functor let hecke 1 p be the moduli stack of quadruples e e q f f q x i e f where x x q e e q f f q bunn p such that f e is the simple skyscraper sheaf at x and the partial flag structures e q and f q coincide under i we consider the following projections hecke 1 p q yytt tt tt tt tt p bunn p bunn p x q where q maps the quadruple to f f q and p maps the quadruple to e e q x the hecke functor h 0 p is defined by h 0 p d b d 0 bunn p mod d b d 0 bunn p dx q mod tamely ramified geometric langlands in positive characteristic 33 m 7 p q m let e be the universal oloc 0 n p dx q module we define another functor w 0 p w 0 p d b oloc 0 n p mod db oloc 0 n p dx q mod f 7 p 1 f e where p 1 is the projection locn x locn let p x q be the fourier mukai equivalence induced by the pull back of p p x q d b oloc 0 n p dx q mod db d 0 bunn p dx q mod then we have theorem 5 14 there is an isomorphism of functors h 0 p p p x q w 0 p the proof is the same as the proof of theorem 5 4 in bb 07 now let e be a k point of loc 0 n p we denote by me the image of e under p by theorem 5 14 me satisfies h 0 p me me e references ari 08 d arinkin appendix to dp 08 ag 15 d arinkin and d gaitsgory singular support of coherent sheaves and the geometric langlands conjecture selecta math 21 2015 no 1 1 199 bk 18 d baraglia and m kamgarpour on the image of the parabolic hitchin map q j math 69 2018 no 2 681 708 bkv 17 d baraglia m kamgarpour and r varma complete integrability of the parahoric hitchin system preprint 2017 arxiv 1608 05454 bl 95 a beauville and y laszlo un lemme de descente c r acad sci paris sr i math 320 1995 no 3 335 340 bnr 89 a beauville m s narasimhan and s ramanan spectral curves and the generalised theta divisor j reine angew math 398 1989 169 179 bd 91 a beilinson and v drinfeld quantization of hitchin s integrable system and hecke eigensheaves preprint 1991 bb 07 r bezrukavnikov and a braverman geometric langlands correspondence for d modules in prime characteristic the gl n case pure appl math q 3 2007 153 179 bmr 08 r bezrukavnikov i mirkovic and d rumynin localization of modules for a semisimple lie algebra in prime characteristic ann of math 167 2008 no 3 945 991 cz 15 t h chen and x zhu non abelian hodge theory for curves in characteristic p geom funct anal 25 2015 1706 1733 cz 17 t h chen x zhu geometric langlands in prime characteristic compositio math 153 2017 395 452 cgm 86 c cumino s greco and m manaresi an axiomatic approach to the second theorem of bertini j algebra 98 1986 no 1 153 179 dm 82 p deligne and j milne tannakian categories in hodge cycles motives and shimura varieties springer lecture notes in mathematics 900 101 228 springer verlag heidelberg 1982 dp 08 r donagi and t pantev torus fibrations gerbes and duality with an appendix by dmitry arinkin mem amer math soc 193 2008 no 901 fr 04 e frenkel ramifications of the geometric langlands program proceedings of the cime summer school representation theory and complex analysis venice june 2004 gin 01 v ginzburg the global nilpotent variety is lagrangian duke math j 109 2001 no 3 511 519 gro 16 m groechenig moduli of flat connections in positive characteristic math res lett 23 2016 989 1047 https arxiv org abs 1608 05454 34 shiyu shen hei 10 j heinloth uniformization of g bundles math ann 347 2010 499 528 kat 70 n katz nilpotent connections and the monodromy theorem applications of a result of turrittin publ math inst hautes e tudes sci 39 1970 175 232 lp 01 y laszlo c pauly on the hitchin morphism in positive characteristic internat math res notices 3 2001 129 143 nev 09 t nevins mirabolic langlands duality and the quantum calogero moser systems transform groups 14 2009 931 983 ov 07 a ogus and v vologodsky nonabelian hodge theory in characteristic p publ math inst hautes e tudes sci 106 2007 1 138 ss 95 p scheinost and m schottenloher metaplectic quantization of the moduli spaces of flat and parabolic bundles j reine angew math 466 1995 145 219 sim 90 c t simpson harmonic bundles on noncompact curves j amer math soc 3 1990 no 3 713 770 tra 16 r travkin quantum geometric langlands in positive characteristic the gln case duke math j 165 2016 no 7 1283 1361 department of mathematics university of illinois at urbana champaign urbana il 61801 usa e mail address sshen 16 illinois edu 1 introduction 1 1 geometric langlands in positive characteristic 1 2 tamely ramified geometric langlands correspondence 1 3 summary of the proof 1 4 structure of the article 1 5 notations and definitions 1 6 acknowledgements 2 spectral data of parabolic higgs bundles 2 1 basic constructions 2 2 the parabolic hitchin base bp 2 3 spectral data of parabolic higgs bundles 3 azumaya property of differential operators in positive characteristic 3 1 frobenius twist of a k scheme 3 2 azumaya property of differential operators 3 3 differential operators on smooth stacks 3 4 d modules azumaya algebras and gm gerbes 3 5 tensor structures on azumaya algebras 4 a non abelian hodge correspondence between locn q and higgsn q 4 1 spectral data for flat connections with regular singularities 4 2 statement of the theorem 4 3 proof of proposition 4 4 dx modules on spectral covers of x 4 5 proof of theorem 5 tamely ramified geometric langlands correspondence in positive characteristic 5 1 the algebra dbunn p 5 2 the tensor structure on d 0 bunn p 5 3 torsor structure on locn p 0 5 4 fourier mukai transforms on commutative group stacks 5 5 proof of theorem 5 6 the hecke functor references