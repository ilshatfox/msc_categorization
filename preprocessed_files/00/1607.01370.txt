ar x iv 1 60 7 01 37 0 v 1 as tr o ph c o 5 j ul 2 01 6 mnras 000 1 2016 preprint 5 october 2018 compiled using mnras latex style file v 3 0 reconstructing the cosmic horseshoe gravitational lens using the singular perturbative approach alard c iap 98 bis boulevard arago paris july 5 th 2016 abstract the cosmic horseshoe gravitational lens is analyzed using the perturbative approach the two first order perturbative fields are expanded in fourier series the source is reconstructed using a fine adaptive grid the expansion of the fields at order 2 produces a higher value of the chi square expanding at order 3 provides a very significant improvement while order 4 does not bring a significant improvement over order 3 the presence of the order 3 terms is not a consequence of limiting the perturbative expansion to the first order the amplitude and signs of the third order terms are recovered by including the contribution of the other group members this analysis demonstrates that the fine details of the potential of the lens could be recovered independently of any assumptions by using the perturbative approach key words gravitational lensing strong methods numerical 1 introduction strong gravitational lensing offers a unique opportunity to probe the dark halos potential in the vicinity of the einstein circle the lensing potential relates directly to the projected matter distribution and as a consequence is a direct measurement of the matter distribution in the lens however deriving a precise relation between the observations of a gravitational lens and the lensing potential is generally difficult there are basically two main problems first the lens may show some degree of complexity and may not be properly described with simple analytical models and secondly some degree of degeneracy in the modeling of the lens is generally present see for instance saha williams 2006 wucknitz 2002 c 2016 the authors http arxiv org abs 1607 01370 v 1 2 alard c chiba takahashi 2002 a solution to the first point is to use a non parametric method for the reconstruction of the potential for instance potential reconstruction on a grid offers a general model free solution but the obvious drawback is a dramatic increase in the number of parameters which in turn aggravates the degeneracy issue the only solution is to developp a method that offers a direct relation between the arc morphology and the potential this is precisely what the perturbative approach alard 2007 achieves at first order the potential is expanded using two angular functionals the fields f 1 and d f 0 d each of these fields relates directly to the arc morphology f 1 is related to the mean radial position of the arc while d f 0 d is related to width of the arc in the radial dimension this direct relation offers a simple solution to the degeneracy problem another aspect is that the reconstruction of the potential is general and does not require any specific assumptions some specific examples of reconstruction of arcs systems using the perturbative approach are presented in alard 2009 and alard 2010 in particular the reconstruction the lens in alard 2009 shows that very complex systems can be handled in this approach the application of the perturbative method to the cosmic horseshoe gravitational lens offers the possibility to push the reconstruction to a high level of accuracy the hst data available for this lens offer an excellent resolution and a wealth of details allowing to probe the fine details of the halo dark matter distribution let s recall the basic equations of the order one theory by starting from the lens equation eq 1 rs r 1 using the equations relating the fields f 0 and f 1 to the potential r 0 r r r f 0 f 1 r 1 2 the lens equation eq 1 is expanded to order one in alard 2007 rs 2 dr f 1 ur d f 0 d u 3 with f 1 d dr r 1 f 0 1 2 1 d 2 0 dr 2 4 it is useful to introduce the impact parameter of the source namely rs r s r 0 leading to r s 2 dr f 1 ur d f 0 d u 5 with f i fi x 0 cos y 0 sin i 0 1 mnras 000 1 2016 cosmic horseshoe gravitational lens 3 and the impact paremeter vector r 0 r 0 x 0 y 0 2 building the perturbative solution in the perturbative approach alard 2007 alard 2010 2011 the construction of the solution requires the evaluation of the two fields f 1 and d f 0 d these two quantities are functions of the angular variable in the lens plane we recall that these two fields have simple inter pretations for a strong gravitational lens for a circular source with radius r 0 the positions of the images contours are given by alard 2007 2 dr f 1 r 20 d f 0 d 2 6 for convenience the einstein radius is fixed to unity by using a proper choice of radial units as a consequence r 1 dr with 1 it is straightforward to deduce from eq 6 that f 1 corresponds to the mean position of the two image contours and that image are formed in the angluar domain defined by d f 0 d r 0 it is also clear from eq 6 that the maximum image width is obtained when d f 0 d 0 2 1 initial approximation the circular source model is used as a first guess in order to estimate the parameters of a piecewise polynomial model of the fields the reconstruction of f 1 is direct while d f 0 d is estimated using the following constraints the field is near zero in the central region of each images and the the field is above a threshold value in the dark areas in this particular lens the nature of the first guess is simplified since the structure of the images reveal a fold configuration the initial estimation of f 1 is done by taking the mean position of the bright spots in the image an estimation of f 1 can also be done by estimating the closest fold configuration these two estimates gives quite similar results and are both appropriate as a first guess a similar approach is used for d f 0 d one can reconstruct the field by estimating its local behavior near the nodes and make an interpolation with the constraint that the field must be above a certain threshold in the dark areas as for f 1 taking the closest fold configuration give quite similar results this initial guess is consistent with the topological properties of the solution and is an approximate description of its general shape to reach the optimal level of accuracy this solution needs to be refined numerically the numerical mnras 000 1 2016 4 alard c refinement could be performed directly on the polynomial piecewise elements but since the fourier expansion of the fields is related to the multipole expansion of the potential it is more efficient to expand the fields using fourier series f 1 n 1 n cos n 1 n sin n d f 0 d n 0 n cos n 0 n sin n 7 2 2 source and image reconstruction the first step in the construction of the refined numerical model is to make an initial es timation of the fourier series coefficients this is easily accomplished by computing the scalar product of the fourier basis function with the piecewise polynomial model once the fourier coefficient are initiated the optimal value of the coefficient is computed by minimiz ing the chi square between the re constructed image of the source and the hst data the reconstruction of the source and its associated images are complex processes which we now describe in details the reconstruction of the source and of its associated images requires the use of finer grids a finer grid in the image plane is formed by sub dividing the pixels the typical resolution is of a factor of 10 in each direction the values of the image on the sub grid is obtained by b spline interpolation this sub grid in the lens plane is transported in the source plane using the perturbative lens equation at order one eq 3 the size of the grid in the source plane is adapted to the resolution of the grid in the lens plane the grid size in the source plane has to be small enough to allow the reconstruction of all the image details basically two image structures should not merge in the same pixel experiment are made to obtain a suitable minimal value of the grid size in some areas the grid size has to be adapted by extending the size in order to have at least a few points from the image plane falling into the bin in the source plane when several values fall in the same cell of the source plane which is by definition the case when several images are formed the different values are averaged once a source model is constructed the corresponding image is formed by estimating the values of the pixels on the finer grid in the lens plane the finer grid image is integrated to produce an image at the initial resolution 2 3 image deconvolution the source and image reconstruction procedure we described ignores the problem of the convolution of the image with the psf a numerical model of the psf is reconstructed using mnras 000 1 2016 cosmic horseshoe gravitational lens 5 the tiny tim software krist etal 2011 to correct for the effect of the psf convolution on the image an iterative procedure is implemented the difference image between the actual hst image and the image of the source is sent back to the source plane this correction is added to the initial source reconstruction and a new image is computed once again the difference with the actual image is taken and the procedure is iterated the convergence of this method is fast and after a few iterations a convergence is achieved too many steps of this iterative add only noise and as a consequence it is optimal to stop the iteration after a proper number of steps experiments shows that the optimal number of steps is between 5 and 10 finally a number of 8 steps was adopted however changing this number and taking any number between 5 an 10 does not produce significant changes 2 4 accurate numerical estimation of the fields the numerical fit of the data is performed on a selected area first the area occupied by the arc is identified by applying a threshold and then extending the area by performing a convolution with the pixels above the threshold this convolution procedure ensure that the outliers of the arc are properly included additionally a number of control points one third of the former points are included by randomly selecting points in pure noise area in a large ring around the arc these control points are used to identify possible additional images that could be formed by the model in dark areas these additional points are also useful to control the statistics of errors in pure noise areas during the numerical minimization process in the first step of the numerical refinement the fields are modeled by order 2 fourier series given a model of the fields a reconstruction of the source and images of the source are performed using the method described is sec 2 2 and 2 3 using the difference between the reconstructed images and the actual images a weighted chi square is estimated the weights applied in the chi square estimation are computed using the noise expectation see sec 2 5 the reconstruction is applied first to the blue f 475 w hst wfc 3 calibrated image see fig 1 the main asset of the blue band is that the residual contribution of the central deflector to the flux of the arc is very faint despite the weakness of the out layers from the main galaxy a sersic model was fitted to the deflector and the contribution around the arc was subtracted the typical amplitude of the subtraction is at the noise level the refinement process is performed on this processed image of the arc by using the simplex method nelder mead 1965 the approximate guess for the coefficients is used to initialize mnras 000 1 2016 6 alard c the simplex and start the minimization process of the chi square it is important to note that the result of this minimization process does not produce significantly different results if the initial guess is changed experiments were conducted by changing the parameters of the initial guess by an amplitude which is of the order of the refinement the results of these experiments indicates a general convergence to the same solution the stability of the solution is due to the perturbative approach this method provides a fundamental reduction of the degeneracy problem encountered in the modeling of gravitational lenses the result of the simplex minimization are presented in fig 2 in the next step the expansion in fourier series of the numerical solution is extended to higher order first it is extended to order 3 the initial guess is the second order solution with zeros for the third order terms similarly the solution is extended to order 4 an important point is the discussion of the noise and statistical properties of the solutions at different orders 2 5 noise and statistical properties of the solutions the statistical expectation of the noise in the image 0 corresponds to the photon noise derived from the photon counts using this statistical expectation for the noise the chi square and 2 dof are estimated for the different models see table 1 the corresponding histogram of the normalized deviations for each model is presented in fig 4 for comparison the 2 dof for the two other filters available in the hst archive are also presented in table 1 there is a very marked difference between the 2 dof obtained at order 2 and order 3 the gain in 2 obtained by going to order 4 is much less spectacular this suggests that the order 3 terms are important and significant to test this hypothesis it is essential to estimate the amplitude of the noise fluctuation for the fourier coefficients the least square minimization is non linear but can always be linearized near the optimal solution let s define the optimal solution p 0 i 0 i 1 i 1 i i 1 4 we linearize the lens model m p near p m p dp m p n m pn dpn 8 where pn and dpn are the components of the vectors p and dp respectively the model in eq 8 is formally equivalent to a linear least square with basis vectors m pn as a consequence the errors on the parameters are directly the diagonal elements of the inverse of the corresponding normal least square matrix explicitly the normal least square matrix mnras 000 1 2016 cosmic horseshoe gravitational lens 7 elements are ai j image 1 20 m pi m p j defining c a 1 the variance associated with parameter pn is n cnn a numerical es timation of the matrix elements ai j shows that the associated variance elements n are almost constant and equal to 0 510 3 in units of the einstein radius re the calculation of the variance of the fourier components allows a direct estimation of the significance of the components at different orders see fig 5 it is clear in fig 5 that components of order n 3 are well above the 4 limit this is a direct confirmation that the order 3 components are very significant and essential to the modeling of this lens the amplitude of the order 4 component is not significant for the d f 0 d field and is only marginally significant for the f 1 field 3 analyzing the solution the structure of the fourth order solution is now explored in details the reconstruction for the f 475 w filter in the lens plane is presented in fig 6 a comparison of the fine details of the solution and the original hst image in the f 475 w band is presented in fig 7 a general appreciation of the quality of the reconstruction is also provided by the difference image with the original image see fig 8 the reconstruction in the source plane is presented in fig 9 for a more detailed view of the source see fig 10 3 1 effect of degeneracy induced by higher order perturbative terms the first order perturbative expansion neglect the effect of higher order terms in the expan sion for most gravitational arcs it is possible to reduce the higher order expansion to a first order expansion which means that some small degeneracy problem is present the ampli tude of the correction due to higher order terms is evaluated using realistic nfw models for the halo of the deflector let s consider a purely elliptical nfw halo which by definition has no third order distortion of its isophotes we consider the perturbative expansion of this elliptical nfw model to perturbative order 2 the forced reduction of this expansion to order 1 introduces additional degenerate terms in the expansion could these terms be responsible for the order 3 terms that we observe in the lens model the expansion at order mnras 000 1 2016 8 alard c 2 reads alard 2016 rs 2 dr 3 dr 2 2 f 1 f 2 dr ur d f 0 d d f 1 d d f 0 d dr u 9 3 d 3 0 dr 3 r 1 and f 2 2 r 2 assuming a thin arc model dr f 1 2 dr 2 10 the arc presents in this lens present a thickness in the radial direction which is small with respect to the general displacement fields thus eq 10 is certainly appropriate for an evaluation of the amplitude of the third order terms introducing eq 10 in eq 9 leads to alard 2016 r s 2 dr 2 3 f 21 2 22 f 1 f 2 2 ur d f 0 d d f 1 d d f 0 d f 1 2 u 11 eq 11 is equivalent to eq 5 provided that the following subsitutions are performed f 1 f 1 3 f 21 2 22 f 1 f 2 2 d f 0 d d f 0 d d f 1 d d f 0 d f 1 2 12 to evaluate the amplitude of the additional terms in eq 12 we use the nfw halo model the potential for a nfw halo reads meneghetti etal 2003 u 1 1 ln 2 g u u 1 x 2 1 y 2 13 the parameter is related to the ellipticity of the halo the potential normalization implies that the associated einstein radius is equal to the typical halo size which is a common situation for gravitational lenses the definition of the function g u reads g u 1 2 ln u 2 2 2 arctan 2 u 1 u 1 u 1 2 arctanh 2 1 u u 1 u 1 14 using the nfw potential see meneghetti etal 2003 defined in eq 13 the functionals f 0 f 1 and f 2 are calculated the result is introduced in eq 12 to evaluate the correction due to the order 2 terms for the f 1 field the correction is respectively 0 2 x 0 and 0 2 y 0 mnras 000 1 2016 cosmic horseshoe gravitational lens 9 for the cos 3 and sin 3 terms where x 0 y 0 are the source impact parameters the correction for f 0 is of smaller amplitude for this lens x 0 0 03 y 0 0 13 and 0 07 as a consequence the largest third order term is only of 2 10 3 which is similar to the 4 noise limit thus it is clear from this analysis that the observed third order terms in this lens are not the consequence of neglected higher order terms in the perturbative expansion 4 interpretation of the lens model the reconstruction of the lens is directly related to the geometry of the potential the potential iso contours equation dr f 0 alard 2009 is represented in fig 11 by relating the perturbative expansion to the multipole expansion alard 2009 one can reconstruct the potential generated by the distribution of matter inside the einstein circle inner and outside the einstein circle outer the iso countour for the outer potential represented in fig 11 is close to the potential iso contour as a consequence most of the potential is generated outside the einstein circle and even more for the third order terms where more than 90 of the potential originates in the outer distribution the outer distribution includes a number of a galaxies belonging to a small group of galaxies where the central deflector is the main element belokurov etal 2007 spiniello 2011 agnello etal 2013 thus it is interesting to evaluate the perturbating contribution of the accompanying galaxies in the group the first step is to identify the galaxies around the lens a general search for galaxies in a radius corresponding to the size of the group 1 arc minute belokurov etal 2007 was performed objects were identified by looking for local maxima s in a moving mesh with a size of 25 pixels punctual objects with corresponding width not significantly larger than the psf were eliminated the petrosian magnitude petrosian 1976 is evaluated for the remaining objects in the different photometric bands the contribution of each galaxy to the lensing fields is estimated by assuming a proportionality relation between the red f 875 w flux and the total mass the potential of the perturbator is evaluated by considering the three following models i a spherical isothermal sphere ii a point mass iii a spherical nfw profile for each model the lensing fields f 1 and d f 0 d are evaluated using eq 4 it is clear that the assumption of a proportionality between the mass and the red magnitude is crude however it is essential to note that about 90 of the contribution to the lensing perturbation is due to elliptical galaxies with color similar to the central galaxy thus at least for this dominant sub set all galaxies are quite similar and thus it is reasonable to mnras 000 1 2016 10 alard c assume a proportionality relation between flux and mass the flux normalization factor is applied by dividing fluxes by the flux of the main galaxy as a result all masses are expressed in units of the main galaxy mass in this reconstruction another source of error come from the ellipticity of the potential for an axis ratio of the ellipse equal to 1 the typical percentage in error induced by the ellipticity on the fields f 1 and d f 0 d is of the order of for dark matter halos a typical value for is 0 2 the uncertainty on mass is at least of about 10 since the flux to mass proportionality relation applies only to elliptical galaxies as a consequence an error of about 25 at least is expected for this kind of model an estimation of the fields for the different models is presented in table 2 the point mass and nfw models prediction for the third order coefficients is in general agreement with the values reconstructed from the lens model as shown by the relative errors presented in table 3 the isothermal model exceeds the error expectation while the errors for two other models are consistent with the 20 to 30 relative error expectation it is interesting to compare these results with dye etal 2008 who could not find any contribution coming from the other group members however dye etal 2008 used low resolution images taken from the ground and could not reach the level of accuracy obtained with hst images a more recent analysis of the cosmic horseshoe lens was performed by brewer etal 2016 who could not find substantial evidence for substructures in the lens however the problem of evaluating the contribution of substructures in the lens is not equivalent to the evaluation of the group members contributions the elements of the group are more massive than substructures and on average are situated at larger distances than substructures thus it is not surprising that the brewer etal 2016 analysis fails to identify the contribution of the group members 5 conclusion the perturbative method allowed the reconstruction of the cosmic horseshoe lens without making any particular assumptions the inclusion of third order terms was dictated only by the necessity to optimize the chi square these third order terms were related to the group contribution later in the analysis but it was not necessary to make any hypothesis about the group contribution when reconstructing the lens in this case the group is made of quite a large number of galaxies and trying to make an extensive model including each object would require too many parameters such models including many parameters are generally plagued with degeneracies issues which is a constant re occuring problem in conventional mnras 000 1 2016 cosmic horseshoe gravitational lens 11 table 1 the 2 dof as a function of the order of the fourier series expansion of the fields for the three different filters order 2 3 4 2 dof f 475 w 2 29 1 38 1 28 2 dof f 675 w 1 88 1 32 1 22 2 dof f 875 w 2 14 1 52 1 47 table 2 models of the perturbation due to the group members model d f 0 d cos 3 d f 0 d sin 3 f 1 cos 3 f 1 sin 3 isothermal 0 002 0 0073 0 0071 0 00175 point mass 0 01 0 0123 0 0126 0 01 nfw 0 0094 0 011 0 011 0 0096 reconstruction 0 011 0 0078 0 0089 0 014 table 3 relative deviation from reconstructed coefficients for different model of perturbator potential model d f 0 d f 1 isothermal 0 68 0 75 point mass 0 36 0 32 nfw 0 26 0 3 gravitational lens analysis this analysis does not have to include all theses parameters but reduces the lens to a number of fundamental parameters it is clear that this minimal set of parameters basically the expansion of the fields to order 3 corresponds to the expectation of many models when the model include more parameters that the fundamental parameters which would be the case here when modeling all the group as a consequence it is clear that the perturbative approach is a method of choice for complex systems the perturbative approach allows a model free non degenerate fast and simple analysis of any gravitational lens system it is important to note that even in the case of an a priori simple lens system it is useful to apply the perturbative method since this method could reveal unexpected complex contributions essentially in the same way that the contribution of the group was discovered without making any initial hypothesis about the presence of the group acknowledgements this work is based on observations made with the nasa esa hubble space telescope obtained from the data archive at the space telescope science institute stsci is operated by the association of universities for research in astronomy inc under nasa contract nas 5 26555 references alard c 2007 mnras letters 382 58 alard c 2009 a a 506 609 mnras 000 1 2016 12 alard c figure 1 the hst wfc 3 image of the cosmic horseshoe lens taken using the f 475 w filter alard c 2010 a a 513 39 alard c 2016 in preparation agnello a auger m w evans n w 2013 mnras 429 l 35 belokurov v etal 2007 apj 671 l 9 brewer brendon j huijser david lewis geraint f 2016 mnras 455 1819 chiba t takahashi r 2002 pthph 107 625 dye s evans n w belokurov v warren s j hewett p 2008 mnras 388 384 krist j hook r stoehr f 2011 spie 8127 meneghetti m bartelmann m moscardini l 2003 mnras 340 105 nelder j mead r 1965 computer journal 7 308 petrosian v 1976 apj 209 l 1 saha p williams l 2006 apj 653 936 mnras 000 1 2016 cosmic horseshoe gravitational lens 13 figure 2 the initial guess dark color superimposed with the refined solution at fourier order 2 the field d f 0 d is represented by a continuous line while f 1 is represented with a dotted line spiniello c koopmans l trager s czoske o treu t 2011 mnras 417 3000 wucknitz o 2002 mnras 332 951 mnras 000 1 2016 14 alard c figure 3 the solution for the fields at order 2 dark color superimposed with the refined solution at fourier order 4 the field d f 0 d is represented by a continuous line while f 1 is represented with a dotted line mnras 000 1 2016 cosmic horseshoe gravitational lens 15 figure 4 histograms of the normalized deviations for the order 2 green order 3 blue and order 4 red the dashed line corresponds to the theoretical gaussian expectation mnras 000 1 2016 16 alard c figure 5 the amplitude of the fourier components as a function of the order of the component the red line represents the 4 limit the asterisks represents the components of d f 0 d while the diamonds represents the components of f 1 mnras 000 1 2016 cosmic horseshoe gravitational lens 17 figure 6 the reconstructed image in the f 475 w band mnras 000 1 2016 18 alard c figure 7 details of the hst image in the f 475 w band left compared with the corresponding area in the reconstructed image right mnras 000 1 2016 cosmic horseshoe gravitational lens 19 figure 8 the absolute value of the difference between the hst image and the reconstructed image normalized by the noise expectation f 475 w band note that additional points were added in pure noise area as control points one third of total points mnras 000 1 2016 20 alard c figure 9 the reconstruction of the source superimposed with the caustic system of the lens mnras 000 1 2016 cosmic horseshoe gravitational lens 21 figure 10 a detailed view of the source main component mnras 000 1 2016 22 alard c figure 11 the potential iso contours red line super imposed with the iso contours corresponding to the outer distribution black line a circle with radius unity is plotted for reference blue line mnras 000 1 2016 1 introduction 2 building the perturbative solution 2 1 initial approximation 2 2 source and image reconstruction 2 3 image deconvolution 2 4 accurate numerical estimation of the fields 2 5 noise and statistical properties of the solutions 3 analyzing the solution 3 1 effect of degeneracy induced by higher order perturbative terms 4 interpretation of the lens model 5 conclusion