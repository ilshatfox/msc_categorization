chalkis apostolos and vissarion fisikopoulos 1 volesti volume approximation and sampling for convex polytopes in r by apostolos chalkis and vissarion fisikopoulos abstract sampling from high dimensional distributions and volume approximation of convex bodies are fundamental operations that appear in optimization finance engineering artificial intelligence and machine learning in this paper we present volesti an r package that provides efficient scalable algo rithms for volume estimation uniform and gaussian sampling from convex polytopes volesti scales to hundreds of dimensions handles efficiently three different types of polyhedra and provides non existing sampling routines to r we demonstrate the power of volesti by solving several challenging problems using the r language introduction high dimensional sampling from multivariate distributions with markov chain monte carlo mcmc algorithms is a fundamental problem with many applications in science and engineering iyengar 1988 somerville 1998 genz and bretz 2009 schellenberger and palsson 2009 venzke et al 2021 in particular multivariate integration over a convex set and volume approximation of such sets a special case of integration have accumulated a broad amount of effort over the last decades nevertheless those problems are computationally hard for general dimension dyer and frieze 1988 mcmc algorithms have made remarkable progress solving efficiently the problems of sampling and volume estimation of convex bodies while enjoying great theoretical guarantees chen et al 2018 lee and vempala 2018 mangoubi and vishnoi 2019 however theoretical algorithms cannot be applied efficiently to real life computations for example the asymptotic analysis by lov sz and vempala 2006 hides some large constants in the complexity and in lee and vempala 2018 the step of the random walk used for sampling is too small to be an efficient choice in practice therefore practical algorithms have been designed by relaxing the theoretical guarantees and applying new algorithmic and statistical techniques to perform efficiently while on the same time meet the requirements for high accuracy results emiris and fisikopoulos 2014 cousins and vempala 2016 chalkis et al 2019 in this paper we present volesti fisikopoulos et al 2020 an r package containing a variety of high dimensional mcmc methods for sampling from multivariate distributions restricted to a convex polytope and randomized algorithms for volume estimation of convex polytopes in partic ular it includes efficient implementations of three practical volume algorithms sequence of balls sob emiris and fisikopoulos 2014 cooling gaussians cg cousins and vempala 2016 and cooling convex bodies cb chalkis et al 2019 in addition to volume estimation volesti provides efficient implementations for random directions and coordinate directions hit and run rdhr and cdhr smith 1984 ball walk baw hastings 1970 billiard walk biw polyak and gryazina 2014 the first three can be used to sample from multivariate uniform or spherical gaussian distribu tions centered at any point while biw can be employed by definition only for uniform sampling on the whole volesti is the first r package that a performs high dimensional volume estimation b handles efficiently three different types of polyhedra in high dimensions namely h polytopes v polytopes and z polytopes c provides previously absent from r mcmc sampling algorithms for uniform and truncated gaussian distributions namely baw cdhr and biw d solves some challenging problems in finance engineering and applied mathematics on top of volesti presentation we illustrate the usage of volesti in the study of convergence of various random walks e g figure 3 and accuracy of volume estimation methods regarding applications in the last section we illustrate how one can a exploit volesti to detect shock events in stock markets following the results by cal s et al 2018 b evaluate zonotope approximation in engineering kopetzki et al 2017 and c approximate the number of linear extensions of a partially ordered set which is useful in various applications in artificial intelligence and machine learning to improve the presentation of the current paper detailed comparisons and benchmarking of r packages including volesti for solving the problems of mcmc sampling volume computation and numerical integration are presented in a separate blog post chalkis and fisikopoulos 2021 ar x iv 2 00 7 01 57 8 v 3 st at c o 4 s ep 2 02 1 https cran r project org package volesti chalkis apostolos and vissarion fisikopoulos 2 figure 1 examples of three different polytope representations from left to right an h polytope a v polytope and a z polytope a sum of four segments related r software and applications considering mcmc methods to sample from multivariate distributions they are divided in two main categories truncated to a convex body and untruncated distributions for the first category which clearly is the main focus of this paper an important case is the truncated gaussian distribution which arises in several applications in statistics in bolin and lindgren 2015 they sample from truncated gaussian distributions in a novel importance sampling method to study markov processes that exceed a certain level wadsworth and tawn 2014 use sampling from a specific truncated gaussian distribution to develop a novel method for likelihood inference while huser and davison 2013 sample from the same distribution for likelihood estimation for max stable processes in curve prediction they exploit gaussian sampling to compute simultaneous confidence bands to forecast a full curve from explanatory variables aza s et al 2010 gr n and hornik 2012 study the posterior distribution for bayesian inference on mixed regression models to represent human immunodeficiency virus ribonucleic acid levels which is a gaussian restricted to a convex polytope in albert and chib 1993 the probit regression model for binary outcomes have an underlying normal regression structure on latent continuous data sampling from the posterior distribution of the parameters involves sampling from a truncated gaussian distribution another important special case is the truncated uniform distribution in systems biology the flux space of a metabolic network is represented by a convex polytope haraldsd ttir et al 2017 uniform sampling from the interior of that polytope could lead to important biological insights in computational finance the set of all possible portfolios in a stock market is in general a convex polytope volume computation and uniform sampling from that set is useful for crises detection cal s et al 2018 and efficient portfolio allocation and analysis pouchkarev et al 2004 hallerbach et al 2002 considering r packages for the truncated case there is tmg pakman 2015 implementing exact hamiltonian monte carlo hmc with boundary reflections as well as multinomineq heck 2019 lineqgpr lopez 2019 restrictedmvn taylor and benjamini 2016 tmvmixnorm ma et al 2020 implementing variations of the gibbs sampler to our knowledge the only two r packages for uniform sampling is hitandrun van valkenhoef and tervonen 2019 and limsolve den meersche k et al 2009 which exposes the r function xsample den meersche et al 2009 for the untruncated case packages hybridmc morey 2009 rhmc sart rio 2018 and mcmc geyer and johnson 2020 mhadaptive chivers 2012 provide implementations for hmc and metropolis hastings algorithms respectively for volume computation the only existing package geometry roussel et al 2019 computes the volume of the convex hull of a set of points and is based on the c library qhull barber et al 1996 algorithms and polytopes convex polytopes convex polytopes are a special case of convex bodies with special interest in many scientific fields and applications for example in optimization the feasible region of a linear program is a polytope and in finance the set of portfolios is usually expressed by a polytope i e the simplex more formally an h polytope is defined as p x ax b rd where a rm d and b rm and we say that p is given in h representation each row ati r d of matrix a corresponds to a normal vector that defines a halfspace ati x bi i m the intersection of those halfspaces defines the polytope p and the hyperplanes ati x bi i m are called facets of p a v polytope is given by a matrix v rd n which contains n points column wise and we say that p is given in v representation the points of p that cannot be written as convex combinations of other points of p are called vertices the polytope p is defined as the convex hull of those vertices i e the https cran r project org package tmg https cran r project org package multinomineq https cran r project org package lineqgpr https cran r project org package restrictedmvn https cran r project org package tmvmixnorm https cran r project org package hitandrun https cran r project org package limsolve https cran r project org package hybridmc https cran r project org package rhmc https cran r project org package mcmc https cran r project org package mhadaptive https cran r project org package geometry chalkis apostolos and vissarion fisikopoulos 3 p q p q b p q p q figure 2 examples of random walks from left to right rdhr cdhr baw biw p is the point at current step and q the new point computed is the line computed by rdhr and cdhr b is the ball computed by baw dotted lines depict previous steps smallest convex set that contains them equivalently a v polytope can be seen as the linear map of the canonical simplex n 1 x rn xi 0 ni 1 xi 1 according to matrix v i e p x rd y n 1 x vy a z polytope or zonotope is given by a matrix g rd k which contains k segments column wise which are called generators in this case p is defined as the minkowski sum of those segments and we say that it is given in z representation we call order of a z polytope the ratio between the number of segments over the dimension equivalently p can be expressed as the linear map of the hypercube 1 1 k with matrix g i e p x rd y 1 1 k x gy thus a z polytope is a centrally symmetric convex body as a linear map of an other centrally symmetric convex body examples of an h polytope a v polytope and a z polytope in two dimensions are illustrated in figure 1 for an excellent introduction to polytope theory we recommend the book of ziegler 1995 mcmc sampling and geometric random walks we define here more formally the four geometric random walks implemented in volesti namely hit and run two variations rdhr and cdhr ball walk baw and billiard walk biw they are illustrated in figure 2 for two dimensions in general if f rn r is a non negative integrable function then it defines a measure f on any measurable subset a of rd f a a f x dx rd f x dx let be a line in rd and let f be the restriction of to f p p tu p f p tu dt f x dx where p is a point on and u a unit vector parallel to algorithm 1 describes the general hit and run procedure when the line in line 1 of the pseudocode is chosen uniformly at random from all possible lines passing through p then the walk is called random directions hit and run smith 1984 to pick a random direction through point p rd we could sample d numbers g 1 gd from n 0 1 and then the vector u g 1 gd g 2 i is uniformly distributed on the surface of the d dimensional unit ball a special case is called coordinate directions hit and run smith 1984 where we pick uniformly at random from the set of d lines that chalkis apostolos and vissarion fisikopoulos 4 passing through p and are parallel to the coordinate axes algorithm 1 hit and run p p f input polytope p rd point p p f rd r output a point q p 1 pick a line through p 2 return a random point on the chord p chosen from the distribution f the ball walk algorithm 2 needs additionally to hit and run a radius as input in particular ball walk is a special case of metropolis hastings hastings 1970 when the target distribution is truncated for both hit and run and ball walk f is the stationary distribution of the random walk if f x e x x 0 2 2 2 then the target distribution is the multidimensional spherical gaussian with variance 2 and its mode at x 0 when f is the indicator function of p then the target distribution is the uniform distribution algorithm 2 ball walk p p f input polytope p rd point p p radius f rd r output a point q p 1 pick a uniform random point x from the ball of radius centered at p 2 return x with probability min 1 f x f p return p with the remaining probability billiard walk is a random walk for sampling from the uniform distribution polyak and gryazina 2014 it tries to emulate the movement of a gas particle during the physical phenomena of filling uniformly a vessel algorithm 3 implements billiard walk where is the inner product between two vectors is the 2 norm and is the length of a segment algorithm 3 billiard walk p p r input polytope p rd current point of the random walk p p length of trajectory parameter r upper bound on the number of reflections r n output a point q p 1 set the length of the trajectory l ln u 0 1 set the number of reflections n 0 and p 0 p pick a uniformly distributed direction on the unit sphere v 2 update n n 1 if n r return p 0 3 set p tv 0 t l 4 if p return p lv 5 update p p let s be the inner normal vector of the tangent plane on p s t s 1 update l l p v v 2 v s s goto 2 every random walk starts from a point in the convex body and perform a number of steps called walk length the larger the walk length is the less correlated the final with the starting point will be the number of steps to get an uncorrelated point that is a point approximately drawn from f is called mixing time we call cost per step the number of operations performed to generate a point hence the total cost to generate a random point is the mixing time multiplied by the cost per step random walk mixing time cost step cost step h polytope v z polytope rdhr lov sz and vempala 2006 o d 3 o md 2 lps cdhr laddha and vempala 2020 o d 10 o m 2 lps baw lee and vempala 2017 o d 2 5 o md 1 lp biw polyak and gryazina 2014 o d r m r lps table 1 overview of the random walks implemented in volesti lp for linear program r for the number of reflections per point in biw d for the diameter of the polytope table 1 displays known complexities for mixing time and cost per step for the mixing time of chalkis apostolos and vissarion fisikopoulos 5 rdhr we assume that p is well rounded i e bd p c dbd where bd is the unit ball and c a constant in general if rbd p rbd then rdhr mixing time is o d 2 r r 2 for the mixing time of ball walk in table 1 we assume that p is in isotropic position and the radius of the ball is 1 d lee and vempala 2017 there are no theoretical bounds on mixing time for cdhr and biw polyak and gryazina 2014 experimentally shows that biw converges faster than rdhr when diam p i e the diameter of p cdhr is the main paradigm for sampling in practice from h polytopes e g in volume computation emiris and fisikopoulos 2014 and biology haraldsd ttir et al 2017 the main reason behind this is the small cost per step and the same convergence in practice as rdhr emiris and fisikopoulos 2014 for v and z polytopes the cost per step of biw is comparable with that of cdhr and moreover converges fast to the uniform distribution chalkis et al 2019 the fact that all above walks are implemented in volesti enable us to empirically evaluate their mixing time using r e g figure 3 volume estimation as mentioned before volume computation is a hard problem so given a polytope p we have to employ randomized algorithms to approximate vol p within some target relative error e and high probability the keys to success of those algorithms are the multiphase monte carlo mmc technique and sampling from multivariate distributions with geometric random walks in particular we define a sequence of functions f 0 fq fi rd r then vol p is given by the following telescopic product vol p p dx p fq x dx p fq 1 x dx p fq x dx p dx p f 0 x dx 1 then we need to fix the sequence such that q is as small as possible select fi such that each integral ratio can be efficiently estimated estimate p fq x dx for a long time researchers e g lov sz et al 1997 set fi to be indicator functions of concentric balls intersecting p it follows that p fi x dx vol bi p and the sequence of convex bodies p p 1 pq pi bi p forms a telescopic product of ratios of volumes while for vol pq there is a closed formula assuming rbd p rbd then q o d lg r r the trick now is that we do not have to compute the exact value of each ratio ri vol pi vol pi 1 but we can use sampling rejection to estimate it within some target relative error ei if ri is bounded then o 1 e 2 i uniformly distributed points in pi 1 suffices another crucial aspect is the sandwiching ratio r r of p which has to be as small as possible this was tackled by a rounding algorithm that is bringing p to nearly isotropic position lov sz et al 1997 the sob algorithm follows this paradigm and deterministically defines the sequence of pi such that 0 5 vol pi vol pi 1 1 in the cg algorithm each fi is a spherical multidimensional gaussian distribution and the algorithm uses an annealing schedule lov sz and vempala 2006 to fix the sequence of those gaussians the sob algorithm uses a similar annealing schedule but to fix a sequence of convex bodies pi as far as performance is concerned the cb algorithm is the most efficient choice for h polytopes in less than 200 dimensions and for v and z polytopes in any dimension for the rest of the cases the user should choose cg algorithm package the package volesti combines the efficiency of c and the popularity and usability of r the package is using the eigen library guennebaud et al 2010 for linear algebra lpsolve library berkelaar et al 2004 for solving linear programs and boost random library maurer and watanabe 2017 part of boost c libraries for random numbers and distributions all the code development is performed on github platform the package is available in comprehensive r archive network cran and is regularly updated with new features and bug fixes we employ continuous integration to test the package on various systems and deploy environments there is a detailed documentation of all the exposed r classes and functions publicly available we maintain a contribution tutorial to help users and researchers who want to contribute to the development or propose a bug fix the package is shipped under the lgpl 3 license to be open to all the scientific communities we use rcpp eddelbuettel et al 2020 b to interface c with r in particular we create one rcpp function for each procedure such as sampling volume estimation etc and we export it as an r function https github com geomscale volume approximation https github com geomscale volume approximation actions https cran rstudio com web packages volesti volesti pdf https github com geomscale volume approximation blob develop contributing md https cran r project org package rcpp chalkis apostolos and vissarion fisikopoulos 6 in the following sections we demonstrate the use of volesti the r scripts in the following sections use only standard r functions volesti in a single script in section 2 4 we use rfast to compute the assets compound return in a stock market polytope classes and generators the package volesti comes with three classes to handle different representations of polytopes table 2 demonstrates the exposed r classes the name of the classes are the names of polytope representations as defined in the previous section each polytope class has a few variable members that describe a specific polytope demonstrated in table 2 the matrices and the vectors in table 2 correspond to those in the polytope definitions the integer variable type implies the representation 1 is for h polytopes 2 for v polytopes 3 for z polytopes the numerical variable volume corresponds to the volume of the polytopes if it is known volesti provides standard and random polytope generators the first produce well known polytopes such as cubes cross polytopes and simplices and assign the value of the exact volume to volume variable the second are random generators using various probability distributions and methods to produce a variety of different random polytopes notably the generated polytopes has unknown volume class constructor variable members hpolytope hpolytope a b a rm d b rm integer type numerical volume vpolytope vpolytope v v rn d integer type numerical volume zonotope zonotope g g rk d integer type numerical volume table 2 overview of the polytopes classes in volesti uniform sampling from polytopes a core feature of volesti is approximate sampling from convex bodies with uniform or spherical gaussian target distribution using the four geometric random walks defined above the following r script samples 1000 points from the 100 dimensional hypercube 1 1 100 defined as p and stores them in a list r d 100 r p gen cube d h r samples sample points p random walk list walk rdhr burn in 1000 walk length 5 n 1000 we use the random directions hit and run rdhr walk other choices are coordinate direc tions hit and run cdhr ball walk baw and billiard walk biw setting the parameter burn in to 1000 means that volesti burns the first 1000 points rdhr generates setting walk length to 5 means that we keep in the list one every five generated points the default choice for the target distribution is the uniform distribution to evaluate the efficiency of volesti sampling routines one could measure the run time and estimate the effective sample size geyer 2011 per second to estimate the effective sample size in r a standard choice is the package coda plummer et al 2020 in chalkis and fisikopoulos 2021 benchmarks show that volesti can be up to 2 500 times faster than hitandrun for uniform sampling from a polytope moreover using volesti and r we can empirically study the mixing time of the geometric random walks implemented in volesti to this end we sample uniformly from a random rotation of the 200 dimensional hypercube 1 1 200 first we generate the hypercube and use rotate polytope that returns the rotated polytope and the matrix of the linear transformation r d 200 r num of points 1000 r p gen cube d h r retlist rotate polytope p rotation list seed 5 r t retlist t r p retlist p https cran r project org package rfast https cran r project org package coda https cran r project org package hitandrun chalkis apostolos and vissarion fisikopoulos 7 figure 3 uniform sampling from a random rotation of the hypercube 1 1 200 we map the sample back to 1 1 200 and then we project them on r 3 by keeping the first three coordinates each row corresponds to a different walk baw cdhr rdhr biw each column to a different walk length 1 50 100 150 200 that is the sub figure in third row and forth column corresponds to rdhr with 150 walk length then we use sample points to sample from the rotated cube with various walk lengths to test the practical mixing of the random walk r for i in c 1 seq from 50 to 200 by 50 points 1 t t sample points p n num of points random walk list walk baw walk length i seed 5 points 2 t t sample points p n num of points random walk list walk cdhr walk length i seed 5 points 3 t t sample points p n num of points random walk list walk rdhr walk length i seed 5 points 4 t t sample points p n num of points random walk list walk biw walk length i seed 5 finally we map the points back to 1 1 200 using the inverse transformation and then we project all the sample points on r 3 or equivalently on the 3 d cube 1 1 3 by keeping the first three coordinates we plot the results in figure 3 note that in general perfect uniform sampling in the rotated polytope would result to perfect uniformly distributed points in the 3 d cube 1 1 3 hence figure 3 shows an advantage of biw in mixing time for this scenario compared to the other walks it mixes relatively well even with one step i e walk length notice also that the mixing of both cdhr and rdhr seem similar while it is sightly better than the mixing of baw gaussian sampling from polytopes in many bayesian models the posterior distribution is a multivariate gaussian distribution restricted to a specific domain we illustrate the usage of volesti for the case of the truncation being the canonical simplex n x rn xi 0 i xi 1 which is of special interest this situation typically occurs whenever the unknown parameters can be interpreted as fractions or probabilities thus it appears in chalkis apostolos and vissarion fisikopoulos 8 many important applications altmann et al 2014 in particular we consider the following density f x exp 12 x t x if x n 0 otherwise 2 clearly the support of the density in equation 2 is defined by a convex subset of a linear subspace of rn thus to sample from f x we apply a proper linear transformation induced by a matrix n rn n 1 that maps the support to a full dimensional polytope in rn 1 while the covariance matrix changes accordingly to nt n then we apply a cholesky decomposition to llt and employ the linear transformation induced by l to transform the distribution into a spherical gaussian distribution in the following r script we we first generate a random 100 dimensional positive definite matrix then we sample from the multivariate gaussian distribution with the covariance matrix being and the mode being the center of the canonical simplex n to achieve this goal we first apply all the necessary linear transformations to both the probability density function and the n to obtain the standard gaussian distribution n 0 in restricted to a general full dimensional simplex r d 100 r s matrix rnorm d d mean 0 sd 1 d d random covariance matrix r s s t s r shift rep 1 d d r a diag d r b rep 0 d r b b a shift r aeq t as matrix rep 1 d 10 1 r n pracma nullspace aeq r a a n transform the truncation into a full dimensional polytope r s t n s n r a a t chol s cholesky decomposition to transform to the standard gaussian r p hpolytope a a b as numeric b new truncation next we use the sample points function to sample from the standard gaussian distribution restricted to the computed simplex and we apply the inverse transformations to obtain a sample in the initial space r samples sample points p n 100000 random walk list walk cdhr burn in 1000 starting point rep 0 d 1 distribution list density gaussian mode rep 0 d 1 r samples initial space n samples kronecker matrix 1 1 100000 matrix shift ncol 1 in the previous script we set the starting point of the walk to the mode of the gaussian i e the origin note that the default choice in volesti for the target distribution in the case of gaussian sampling is the standard gaussian that is the target distribution in the above script considering comparisons volesti is at least one order of magnitude faster than restrictedmvn and tmg for computing a sample of similar quality for more details on comparison with other packages we refer to chalkis and fisikopoulos 2021 volume estimation let us now give an example of how we approximate the volume of a polytope in volesti since this is a randomized algorithm it makes sense to compute some statistics for the output values using r when approximating the volume of the 10 dimensional cube 1 1 10 generated as an h polytope r p gen cube 10 h r volumes list r for i in seq len 20 volumes i volume p settings list error 0 2 by changing the error to 0 02 we can obtain more accurate results the results are illustrated in figure 4 note that the exact volume is 1024 https cran r project org package restrictedmvn chalkis apostolos and vissarion fisikopoulos 9 figure 4 the boxplot of the estimated volumes of the hypercude 1 1 10 by volesti left the input error parameter is e 0 2 and right is e 0 02 to understand the need of randomized computation in high dimensions implemented in volesti we can consider the state of the art volume computation in r today namely geometry it implements a deterministic algorithm which run time grows exponentially with the dimension because of the later property geometry in general fails to terminate for polytope in dimension d 20 see chalkis and fisikopoulos 2021 for comparison details with geometry the following script illustrates the usage and efficiency of volesti to compute the volume of high dimensional polytopes in particular a v polytope namely the cross polytope and an h polytope namely the hypercube r d 80 r p gen cross 80 v generate a cross polytope in v representation r time system time volume estimation volume p settings list algorithm cb random walk biw seed 127 r exact volume 2 d prod 1 d r cat time 1 abs volume estimation exact volume exact volume 82 874 0 074434 r p gen cube d h generate a hypercube polytope in h representation r time system time volume estimation volume p settings list algorithm cb random walk cdhr seed 23 r exact volume 2 d r cat time 1 abs volume estimation exact volume exact volume 0 657 0 067633 for v and z polytopes the most efficient choice of random walk is biw while for h polytopes is cdhr this explains why we use different random walks in the previous script however notice that the run time for the h polytope is two order of magnitude smaller this happens because the cost per step of a random walk in a v polytope increases comparing to h polytopes last but not least volesti provides random polytope generators the following command estimates the volume of a randomly generated v polytope that is the convex hull of 40 uniformly generated random points from the 20 dimensional cube r p gen rand vpoly 20 40 generator list body cube seed 1729 r volume estimation volume p the next call estimates the volume of an h polytope randomly generated as an intersection of 180 linear halfspaces computed by random tangent hyperplanes on an 60 dimensional hypersphere https cran r project org package geometry https cran r project org package geometry https cran r project org package geometry https en wikipedia org wiki cross polytope chalkis apostolos and vissarion fisikopoulos 10 figure 5 left a copula that corresponds to normal period 07 03 2007 31 05 2007 i 0 2316412 right a copula that corresponds to a crisis period 18 12 2008 13 03 2009 i 5 610785 x axis is for return and y axis is for volatility r p gen rand hpoly 60 180 generator list constants sphere r volume estimation volume p since the exact volume of those polytopes is unknown the accuracy of the computed estimation is unknown and statistical methods such as the effective sample size geyer 2011 could be used applications we demonstrate volesti s potential to solve challenging problems more specifically we provide detailed use cases for applications in finance crises detection and portfolio scoring decision and control multivariate integration and artificial inteligence financial crises detection and portfolio scoring in this subsection we present how one could employ volesti to detect financial crises or shock events in stock markets by following the method of cal s et al 2018 for all the examples in the sequel we use a set of 52 popular exchange traded funds etfs and the us central bank fed rate of return publicly available from https stanford edu class ee 103 portfolio html the following script is used to load the data r matreturns read table https stanford edu class ee 103 data returns txt sep r matreturns matreturns c 1 2 r dates as character matreturns v 1 r matreturns as matrix matreturns c 1 54 r matreturns matrix as numeric matreturns nrow dim matreturns 1 ncol dim matreturns 2 byrow false r nassets dim matreturns 2 the method uses the copula representation to capture the dependence between portfolios return and volatility a copula is an approximation of the bivariate joint distribution while both marginals follow the uniform distribution in normal times portfolios are characterized by slightly positive returns and a moderate volatility in up market times typically bubbles by high returns and low volatility and during financial crises by strongly negative returns and high volatility thus when a copula implies a positive dependence see figure 5 left then it probably comes from a normal period on the other side when the dependence between portfolios return and volatility is negative see figure 5 right the copula comes probably from a crisis period the first case occurs when the indicator that computes the ratio between the red mass over the blue mass is smaller than 1 and the second case when that indicator is larger than 1 the function copula can be used to compute such copulas when two vectors of returns are given as input by the user then the computed copula is related to the problem of momentum effect in stock markets the following script produces figure 5 by setting the starting and the stopping date for the left and the right plot respectively to compute the copula we use the compound asset return which is the rate of return for capital over a cumulative series of time cal s et al 2018 https stanford edu class ee 103 portfolio html chalkis apostolos and vissarion fisikopoulos 11 figure 6 the values of the indicators from 2007 01 04 until 2010 01 04 we mark with red the crisis periods with orange the warning periods and with blue the normal periods that volesti identifies r row 1 which dates in 2008 12 18 r row 2 which dates in 2009 03 13 r compound asset return rfast colprods 1 matreturns row 1 row 2 1 r mass copula r 1 compound asset return sigma cov matreturns row 1 row 2 m 100 n 1 e 06 seed 5 moreover the function compute indicators computes the copulas of all the sets of win len consecutive days and returns the corresponding indicators and the states of the market during the given time period the next script takes as input the daily returns of all the 52 assets from 01 04 2007 until 04 01 2010 when the indicator is 1 for more than 30 days we issue a warning and when it is for more than 60 days we mark this period as a crisis see figure 6 r row 1 which dates in 2007 01 04 r row 2 which dates in 2010 01 04 r market analysis compute indicators returns matreturns row 1 row 2 parameters list win len 60 m 100 n 1 e 06 nwarning 30 ncrisis 60 seed 5 r i market analysis indicators r market states market analysis market states we compare the results with the database for financial crises in european countries proposed in duca et al 2017 the only listed crisis for this period is the sub prime crisis from december 2007 to june 2009 notice that figure 6 successfully points out 4 crisis events in that period 2 crisis and 2 warning periods and detects sub prime crisis as a w shape crisis as a second financial application we will use volesti to evaluate the performance of a given portfolio in particular volesti computes the proportion of all possible allocations that the given portfolio outperforms this score independently introduced in pouchkarev 2005 guegan et al 2011 banerjee and hung 2011 and is an alternative to more classical choices for the evaluation of the performance of a portfolio as the sharpe like ratios proposed in the 1960 s by jensen 1967 sharpe 1966 treynor 2015 however the efficient computation of that score was uncertain until cal s et al 2018 notice that varsi s algorithm varsi 1973 can be used to perform robust computations in high dimensions varsi s algorithm is implemented in volesti by the function frustum of simplex and computes volumes in thousands of dimensions in just a few milliseconds on modest hardware as an example the following r script let us know that in 03 13 2009 any portfolio with return 0 002 outperforms almost the 48 of all possible portfolios r r matreturns which dates in 2009 03 13 r r 0 0 002 r tim system time exact score frustum of simplex r r 0 r cat exact score tim 3 chalkis apostolos and vissarion fisikopoulos 12 figure 7 with blue color a 2 d z polytope with grey color the over approximation of p computed with pca method 0 4773961 0 001 zonotope volumes in decision and control volume approximation for z polytopes or zonotopes could be very useful in several applications in decision and control kopetzki et al 2017 in autonomous driving althoff and dolan 2014 or human robot collaboration pereira and althoff 2015 the complexity of algorithms that manipulate z polytopes strongly depends on their order thus to achieve efficient computations the approach that is common in practice is to over approximate the z polytope at hand p as tight as possible with a second z polytope pred of smaller order then the ratio of fitness vol pred vol p 1 d is a good measure for the quality of the approximation however this ratio cannot computed for dimensions typically larger than 10 see kopetzki et al 2017 volesti is the first software to the best of our knowledge that efficiently approximates the ratio of fitness of a high dimensional z polytope typically up to 100 and order 200 or a z polytope of very high order in lower dimensions e g order 1500 in 10 dimensions as an illustration the following r script generates a random 2 d zonotope computes the over approximation with the pca method and estimates the ratio of fitness the sample points function is then used to plot the two polygons figure 7 r z gen rand zonotope 2 8 generator list distribution uniform seed 1729 r points 1 sample points z random walk list walk brdhr n 10000 r retlist zonotope approximation z z fit ratio true generator list seed 5 r p retlist p r cat retlist fit ratio 1 116799539 r points 2 sample points p random walk list walk brdhr seed 5 n 10000 high dimensional integration computing the integral of a function over a convex set i e convex polytope is a hard fundamental problem with numerous applications volesti can be used to approximate the value of such an integral by a simple mcmc integration method which employs the vol p and a uniform sample in p in particular let i p f x dx 3 chalkis apostolos and vissarion fisikopoulos 13 dimension exact value estimated value rel error exact time sec est time sec 5 0 02738404 0 02446581 0 1065667 0 023 3 983 10 3 224286 e 06 3 204522 e 06 0 00612976 3 562 11 95 15 4 504834 e 11 4 867341 e 11 0 08047068 471 479 33 256 20 1 140189 e 16 64 058 table 3 we compute the integral of the function in equation 5 over a random generated v polytope exact value the exact value of the integral using simplicialcubature and geometry estimated value the estimation of the integral with volesti rel error the relative error of volesti exact time the sum of run times of geometry and simplicialcubature est time the run time of volesti indicates that the program halts then sample n uniformly distributed points x 1 xn from p and i vol p 1 n n i 1 f xi 4 the following r script generates a v polytope for d 5 10 15 20 and estimates the integral of f x n i 1 xi 2 x 2 1 x 2 x 3 5 over the generated v polytope p considering the efficiency of volesti the table 3 reports the exact value of i computed by sim plicialcubature nolan et al 2016 it computes multivariate integrals over simplices hence to compute an integral of a function over a convex polytope p in r one should compute the delaunay triangulation with package geometry and then use the package simplicialcubature to sum the values of all the integrals over the simplices computed by the triangulation the pattern is similar to volume computation for d 5 10 the exact computation is faster than the approximate for d 15 volesti is 13 times faster and for d 20 the exact approach halts while volesti returns an estimation in less than a minute r num of points 5000 r f function x sum x 2 2 x 1 2 x 2 x 3 r for d in seq from 5 to 20 by 5 p gen rand vpoly d 2 d generator list seed 127 points sample points p random walk list walk biw walk length 1 seed 5 n num of points sum f 0 for i in seq len num of points sum f sum f f points i v volume p settings list error 0 05 seed 5 i 2 sum f v num of points combinatorics and artificial intelligence we focus now on a different problem namely counting the linear extensions of a given partially ordered set poset which arises in various applications in artificial intelligence and machine learning such as partial order plans muise et al 2016 and learning graphical models niinim ki et al 2016 let g v e be an acyclic digraph with v n 1 2 n one might want to consider g as a representation of the poset v i j if and only if there is a directed path from node i to node j a permutation of n is called a linear extension of g or the associated poset v if 1 i 1 j for every edge i j e let ple g be the polytope in rn defined by ple g x rn 1 xi 0 for all i 1 2 n https cran r project org package simplicialcubature https cran r project org package geometry https cran r project org package geometry https cran r project org package simplicialcubature https cran r project org package simplicialcubature https cran r project org package simplicialcubature https cran r project org package geometry https cran r project org package simplicialcubature chalkis apostolos and vissarion fisikopoulos 14 figure 8 an acyclic directed graph with 5 nodes 4 edges and 9 linear extensions and xi xj for all directed edges i j e it is well known stanley 1986 that the number of linear extensions of g equals the normalized volume of ple g i e leg vol ple g n it is also well known that counting linear extensions is p complete brightwell and winkler 1991 thus as the number of graph nodes i e the dimension of ple g grows the problem becomes intractable for exact methods interestingly volesti provides an efficient approximation method that could be added to the ones surveyed by talvitie et al 2018 as a simple example consider the graph in figure 8 that has 9 linear extensions 1 this number can be estimated in milliseconds using volesti as in the following script where the estimated number of linear extensions is 9 014706 r a matrix c 1 0 1 0 0 0 1 1 0 0 0 1 0 1 0 0 0 0 1 1 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 ncol 5 nrow 14 byrow true r b c 0 0 0 0 0 0 0 0 0 1 1 1 1 1 r p le hpolytope a a b b r time system time le volume p le settings list error 0 01 seed 1927 factorial 5 concluding remarks and future work volesti is an r package that provides mcmc sampling routines for multivariate distributions restricted to convex polytopes and volume estimation it supports three different polytope representations and thus it is useful for several applications we illustrate the usage of volesti with simple reproducible examples and show how volesti can be used to address challenging problems in modern applications regarding future work the expansion of volesti to support general log concave sampling methods would be of special interest for several applications efficient log concave sampling could also lead to additional sophisticated methods to estimate a multivariate integral over a convex polytope lovasz and vempala 2006 computational details the results in this paper were obtained using r 3 4 4 and r 3 6 3 and volesti 1 1 2 2 the versions of the imported by volesti packages are stats 3 4 4 r core team 2020 b and methods 3 4 4 r core team 2020 a of the linked by volesti packages rcpp 1 0 3 bh 1 69 0 1 eddelbuettel et al 2020 a rcppeigen 0 3 3 7 0 bates and eddelbuettel 2013 and the suggested package testthat 2 0 1 wickham 1 example taken from https people inf ethz ch fukudak lect pclect notes 2016 expoly order pdf https cran r project org package stats https cran r project org package methods https cran r project org package rcpp https cran r project org package bh https cran r project org package rcppeigen https cran r project org package testthat https people inf ethz ch fukudak lect pclect notes 2016 expoly order pdf chalkis apostolos and vissarion fisikopoulos 15 2011 for comparison to volesti and for plots this paper uses geometry 0 4 5 hitandrun 0 5 5 simplicialcubature 1 2 rfast 2 0 3 papadakis et al 2021 ggplot 2 3 1 0 wickham 2016 plotly 4 8 0 sievert 2020 rgl 0 100 50 adler et al 2021 coda 0 19 4 all packages used are available from cran all computations were performed on a pc with intel pentium r cpu g 4400 3 30 ghz 2 cpu and 16 gb ram acknowledgments the main part of the work has been done while a c was supported by google summer of code 2018 and 2019 grants and v f was his mentor the authors acknowledge fruitful discussions with ioannis emiris ludovic cal s elias tsigaridas the r project for statistical computing and the r community bibliography d adler d murdoch et al rgl 3 d visualization using opengl 2021 url https cran r project org package rgl r package version 0 105 13 p 15 j albert and s chib bayesian analysis of binary and polychotomous response data journal of the american statistical association j amer statist assn 88 669 679 06 1993 url https doi org 10 1080 01621459 1993 10476321 p 2 m althoff and j m dolan online verification of automated road vehicles using reachability analysis ieee transactions on robotics 30 4 903 918 aug 2014 issn 1552 3098 url https doi org 10 1109 tro 2014 2312453 p 12 y altmann s mclaughlin and n dobigeon sampling from a multivariate gaussian distribution truncated on a simplex a review in 2014 ieee workshop on statistical signal processing ssp pages 113 116 2014 url https doi org 10 1109 ssp 2014 6884588 p 8 j m aza s s bercu j c fort a lagnoux and p l simultaneous confidence bands in curve prediction applied to load curves journal of the royal statistical society series c applied statistics 59 5 889 904 2010 url https doi org 10 1111 j 1467 9876 2010 00727 x p 2 a banerjee and c h hung informed momentum trading versus uninformed naive investors strategies journal of banking finance 35 11 3077 3089 2011 issn 0378 4266 url https doi org 10 1016 j jbankfin 2011 04 005 p 11 c b barber d p dobkin and h huhdanpaa the quickhull algorithm for convex hulls acm transactions on mathematical software 22 4 469 483 dec 1996 issn 0098 3500 url https doi org 10 1145 235815 235821 p 2 d bates and d eddelbuettel fast and elegant numerical linear algebra using the rcppeigen package journal of statistical software 52 5 1 24 2013 url http www jstatsoft org v 52 i 05 p 14 m berkelaar k eikland and p notebaert lp solve 5 5 open source mixed integer linear program ming system software may 1 2004 url http lpsolve sourceforge net 5 5 p 5 d bolin and f lindgren excursion and contour uncertainty regions for latent gaussian models journal of the royal statistical society series b statistical methodology 77 85 106 01 2015 url https doi org 10 1111 rssb 12055 p 2 g brightwell and p winkler counting linear extensions order 8 225 242 1991 url https doi org 10 1007 bf 00383444 p 14 l cal s a chalkis i emiris and v fisikopoulos practical volume computation of structured convex bodies and an application to modeling portfolio dependencies and financial crises in b speckmann and c d t th editors 34 th international symposium on computational geometry socg 2018 volume 99 of lipics pages 19 1 19 15 dagstuhl germany 2018 schloss dagstuhl leibniz zentrum fuer informatik url https doi org 10 4230 lipics socg 2018 19 p 1 2 10 11 a chalkis and v fisikopoulos blog post on sampling integration and volume computations in r 2021 url https geomscale github io sampling integration volume in r p 1 6 8 9 https cran r project org package geometry https cran r project org package hitandrun https cran r project org package simplicialcubature https cran r project org package rfast https cran r project org package ggplot 2 https cran r project org package plotly https cran r project org package rgl https cran r project org package coda http cran r project org https summerofcode withgoogle com https cran r project org package rgl https cran r project org package rgl https doi org 10 1080 01621459 1993 10476321 https doi org 10 1080 01621459 1993 10476321 https doi org 10 1109 tro 2014 2312453 https doi org 10 1109 tro 2014 2312453 https doi org 10 1109 ssp 2014 6884588 https doi org 10 1111 j 1467 9876 2010 00727 x https doi org 10 1016 j jbankfin 2011 04 005 https doi org 10 1016 j jbankfin 2011 04 005 https doi org 10 1145 235815 235821 https doi org 10 1145 235815 235821 http www jstatsoft org v 52 i 05 http lpsolve sourceforge net 5 5 https doi org 10 1111 rssb 12055 https doi org 10 1007 bf 00383444 https doi org 10 1007 bf 00383444 https doi org 10 4230 lipics socg 2018 19 https geomscale github io sampling integration volume in r chalkis apostolos and vissarion fisikopoulos 16 a chalkis i z emiris and v fisikopoulos practical volume estimation by a new annealing schedule for cooling convex bodies 2019 url http arxiv org abs 1905 05494 p 1 5 y chen r dwivedi m wainwright and b yu fast mcmc sampling algorithms on polytopes journal of machine learning research 19 55 1 86 2018 url http jmlr org papers v 19 18 158 html p 1 c chivers mhadaptive general markov chain monte carlo for bayesian inference using adaptive metropolis hastings sampling 2012 r package version 1 1 8 p 2 b cousins and s vempala a practical volume algorithm mathematical programming computation 8 2 jun 2016 url https doi org 10 1007 s 12532 015 0097 z p 1 k v den meersche k soetaert and d v oevelen xsample an r function for sampling linear inverse problems journal of statistical software code snippets 30 1 1 15 2009 issn 1548 7660 doi 10 18637 jss v 030 c 01 url https www jstatsoft org v 030 c 01 p 2 v den meersche k s k and van oevelen d limsolve solving linear inverse models 2009 url https cran r project org package limsolve r package version 1 5 1 p 2 m duca a koban m basten e bengtsson b klaus p kusmierczyk j lang c detken and t peltonen a new database for financial crises in european countries occasional paper series 194 european central bank july 2017 url https ideas repec org p ecb ecbops 2017194 html p 11 m dyer and a frieze on the complexity of computing the volume of a polyhedron siam journal on computing 17 5 967 974 1988 url https doi org 10 1137 0217060 p 1 d eddelbuettel j w emerson and m j kane bh boost c header files 2020 a url https cran r project org package bh r package version 1 72 0 3 p 14 d eddelbuettel r francois j allaire k ushey q kou n russell d bates and j chambers rcpp seamless r and c integration 2020 b url https cran r project org package rcpp r package version 1 0 5 p 5 i emiris and v fisikopoulos practical polytope volume approximation acm transactions of mathemat ical software 2018 44 4 38 1 38 21 2014 issn 0098 3500 url https doi org 10 1145 3194656 p 1 5 v fisikopoulos a chalkis and contributors in file inst authors volesti volume approximation and sampling of convex polytopes 2020 r package version 1 1 2 p 1 a genz and f bretz computation of multivariate normal and t probabilities springer publishing company incorporated 1 st edition 2009 isbn 364201688 x 9783642016882 p 1 c geyer introduction to markov chain monte carlo handbook of markov chain monte carlo 20116022 45 2011 p 6 10 c j geyer and l t johnson mcmc markov chain monte carlo 2020 r package version 0 9 7 p 2 b gr n and k hornik modelling human immunodeficiency virus ribonucleic acid levels with finite mixtures for censored longitudinal data journal of the royal statistical society series c applied statistics 61 201 218 03 2012 url https doi org 10 1111 j 1467 9876 2011 01007 x p 2 d guegan l cal s and m billio a cross sectional score for the relative performance of an allocation universit paris 1 panth on sorbonne post print and working papers halshs 00646070 hal 2011 url https ideas repec org p hal cesptp halshs 00646070 html p 11 g guennebaud b jacob et al eigen v 3 2010 url http eigen tuxfamily org p 5 w hallerbach c hundack i pouchkarev and j spronk a broadband vision of the development of the dax over time technical report ers 2002 87 f a erasmus university rotterdam 2002 p 2 h haraldsd ttir b cousins i thiele r fleming and s vempala chrr coordinate hit and run with rounding for uniform sampling of constraint based models bioinformatics 33 11 1741 1743 01 2017 url https doi org 10 1093 bioinformatics btx 052 p 2 5 w k hastings monte carlo sampling methods using markov chains and their applications biometrika 57 1 97 109 1970 issn 00063444 url http www jstor org stable 2334940 p 1 4 http arxiv org abs 1905 05494 http jmlr org papers v 19 18 158 html https doi org 10 1007 s 12532 015 0097 z https www jstatsoft org v 030 c 01 https cran r project org package limsolve https ideas repec org p ecb ecbops 2017194 html https doi org 10 1137 0217060 https cran r project org package bh https cran r project org package bh https cran r project org package rcpp https doi org 10 1145 3194656 https doi org 10 1111 j 1467 9876 2011 01007 x https ideas repec org p hal cesptp halshs 00646070 html http eigen tuxfamily org https doi org 10 1093 bioinformatics btx 052 http www jstor org stable 2334940 chalkis apostolos and vissarion fisikopoulos 17 d w heck multinomineq bayesian inference for multinomial models with inequality constraints 2019 r package version 0 2 1 p 2 r huser and a davison composite likelihood estimation for the brown resnick process biometrika 2 06 2013 url https doi org 10 1093 biomet ass 089 p 2 s iyengar evaluation of normal probabilities of symmetric regions siam journal on scientific and statistical computing 9 3 418 423 1988 url https doi org 10 1137 0909028 p 1 m c jensen the performance of mutual funds in the period 1945 1964 ssrn scholarly paper id 244153 social science research network rochester ny may 1967 url https papers ssrn com abstract 244153 p 11 a kopetzki b sch rmann and m althoff methods for order reduction of zonotopes in ieee conference on decision and control pages 5626 5633 2017 url https doi org 10 1109 cdc 2017 8264508 p 1 12 a laddha and s vempala convergence of gibbs sampling coordinate hit and run mixes fast 2020 p 4 y lee and s vempala eldan s stochastic localization and the kls hyperplane conjecture an improved lower bound for expansion in 58 th ieee annual symposium on foundations of computer science focs 2017 berkeley ca usa october 15 17 2017 pages 998 1007 2017 url https doi org 10 1109 focs 2017 96 p 4 5 y lee and s vempala convergence rate of riemannian hamiltonian monte carlo and faster polytope volume computation in proceedings of the 50 th annual acm sigact symposium on theory of computing stoc 2018 pages 1115 1121 2018 isbn 978 1 4503 5559 9 url https doi org 10 1145 3188745 3188774 p 1 a f lopez lineqgpr gaussian process regression models with linear inequality constraints 2019 r package version 0 1 1 p 2 l lov sz and s vempala simulated annealing in convex bodies and an o n 4 volume algorithm journal of computer and system sciences 72 392 417 2006 url https doi org 10 1016 j jcss 2005 08 004 p 5 l lov sz and s vempala hit and run from a corner siam journal on computing 35 4 985 1005 2006 issn 0097 5397 url https doi org 10 1137 s 009753970544727 x p 1 4 l lovasz and s vempala fast algorithms for logconcave functions sampling rounding integration and optimization in 2006 47 th annual ieee symposium on foundations of computer science focs 06 pages 57 68 2006 doi 10 1109 focs 2006 28 p 14 l lov sz r kannan and m simonovits random walks and an o n 5 volume algorithm for convex bodies random structures and algorithms 11 1 50 1997 url https doi org 10 1002 sici 1098 2418 199708 11 1 1 aid rsa 1 3 0 co 2 x p 5 t f r ma s k ghosh and y li tmvmixnorm sampling from truncated multivariate normal and t distributions 2020 r package version 1 1 1 p 2 o mangoubi and n k vishnoi faster polytope rounding sampling and volume computation via a sub linear ball walk in 2019 ieee 60 th annual symposium on foundations of computer science focs pages 1338 1357 2019 url https doi org 10 1109 focs 2019 00082 p 1 j maurer and s watanabe boost random number library software 2017 url https www boost org doc libs 1 73 0 doc html boost random html p 5 r d morey hybridmc implementation of the hybrid monte carlo and multipoint hybrid monte carlo sampling techniques 2009 r package version 0 2 p 2 c muise j beck and s mcilraith optimal partial order plan relaxation via maxsat journal of artificial intelligence research 57 113 149 09 2016 url https doi org 10 1613 jair 5128 p 13 t niinim ki p parviainen and m koivisto structure discovery in bayesian networks by sampling partial orders journal of machine learning research 17 57 1 47 2016 url http jmlr org papers v 17 15 140 html p 13 https doi org 10 1093 biomet ass 089 https doi org 10 1137 0909028 https papers ssrn com abstract 244153 https papers ssrn com abstract 244153 https doi org 10 1109 cdc 2017 8264508 https doi org 10 1109 cdc 2017 8264508 https doi org 10 1109 focs 2017 96 https doi org 10 1109 focs 2017 96 https doi org 10 1145 3188745 3188774 https doi org 10 1145 3188745 3188774 https doi org 10 1016 j jcss 2005 08 004 https doi org 10 1016 j jcss 2005 08 004 https doi org 10 1137 s 009753970544727 x https doi org 10 1002 sici 1098 2418 199708 11 1 1 aid rsa 1 3 0 co 2 x https doi org 10 1002 sici 1098 2418 199708 11 1 1 aid rsa 1 3 0 co 2 x https doi org 10 1109 focs 2019 00082 https www boost org doc libs 1 73 0 doc html boost random html https www boost org doc libs 1 73 0 doc html boost random html https doi org 10 1613 jair 5128 http jmlr org papers v 17 15 140 html http jmlr org papers v 17 15 140 html chalkis apostolos and vissarion fisikopoulos 18 j p nolan with parts adapted from fortran and matlab code by alan genz simplicialcuba ture integration of functions over simplices 2016 url https cran r project org package simplicialcubature r package version 1 2 p 13 a pakman tmg truncated multivariate gaussian sampling 2015 r package version 0 3 p 2 m papadakis m tsagris m dimitriadis s fafalios i tsamardinos m fasiolo g borboudakis j burkardt c zou k lakiotaki and c chatzipantsiou rfast a collection of efficient and extremely fast r functions 2021 url https cran r project org package rfast r package version 2 0 3 p 15 a pereira and m althoff safety control of robots under computed torque control using reachable sets in 2015 ieee international conference on robotics and automation icra pages 331 338 may 2015 url https doi org 10 1109 icra 2015 7139020 p 12 m plummer n best k cowles k vines d sarkar d bates r almond and a magnusson coda output analysis and diagnostics for mcmc 2020 url https cran r project org package coda r package version 0 19 4 p 6 b polyak and e gryazina billiard walk a new sampling algorithm for control and optimization ifac proceedings volumes 47 3 6123 6128 2014 issn 1474 6670 url https doi org 10 3182 20140824 6 za 1003 02312 19 th ifac world congress p 1 4 5 i pouchkarev performance evaluation of constrained portfolios phd thesis erasmus research institute of management the netherlands 2005 p 11 i pouchkarev j spronk and j trinidad dynamics of the spanish stock market through a broadband view of the ibex 35 index estudios econom aplicada 22 1 7 21 2004 p 2 r core team r a language and environment for statistical computing r foundation for statistical computing vienna austria 2020 a url https www r project org p 14 r core team r a language and environment for statistical computing r foundation for statistical computing vienna austria 2020 b url https www r project org p 14 j r roussel c b barber k habel r grasman r b gramacy p mozharovskyi and d c sterratt geometry mesh generation and surface tessellation 2019 r package version 0 4 5 p 2 v sart rio rhmc hamiltonian monte carlo 2018 r package version 1 0 0 p 2 j schellenberger and b palsson use of randomized sampling for analysis of metabolic networks the journal of biological chemistry 284 9 5457 61 2009 url https doi org 10 1074 jbc r 800048200 p 1 w f sharpe mutual fund performance the journal of business 39 1 119 138 1966 issn 0021 9398 url https www jstor org stable 2351741 p 11 c sievert interactive web based data visualization with r plotly and shiny chapman and hall crc 2020 isbn 9781138331457 url https plotly r com p 15 r l smith efficient monte carlo procedures for generating points uniformly distributed over bounded regions operations research 32 6 1296 1308 1984 issn 0030364 x 15265463 url http www jstor org stable 170949 p 1 3 p somerville numerical computation of multivariate normal and multivariate t probabilities over convex regions journal of computational and graphical statistics 7 4 529 544 1998 url https doi org 10 1080 10618600 1998 10474793 p 1 r p stanley two poset polytopes discrete computational geometry 1 1 9 23 mar 1986 issn 1432 0444 url https doi org 10 1007 bf 02187680 p 14 t talvitie k kangas t niinim ki and m koivisto counting linear extensions in practice mcmc versus exponential monte carlo in aaai conference on artificial intelligence 2018 url https aaai org ocs index php aaai aaai 18 paper view 16957 p 14 j taylor and y benjamini restrictedmvn multivariate normal restricted by affine constraints 2016 r package version 1 0 p 2 j l treynor how to rate management of investment funds in treynor on institutional investing pages 69 87 john wiley sons ltd 2015 isbn 978 1 119 19667 9 url https doi org 10 1002 9781119196679 ch 10 p 11 https cran r project org package simplicialcubature https cran r project org package simplicialcubature https cran r project org package rfast https doi org 10 1109 icra 2015 7139020 https cran r project org package coda https doi org 10 3182 20140824 6 za 1003 02312 https doi org 10 3182 20140824 6 za 1003 02312 https www r project org https www r project org https doi org 10 1074 jbc r 800048200 https www jstor org stable 2351741 https plotly r com http www jstor org stable 170949 https doi org 10 1080 10618600 1998 10474793 https doi org 10 1080 10618600 1998 10474793 https doi org 10 1007 bf 02187680 https aaai org ocs index php aaai aaai 18 paper view 16957 https aaai org ocs index php aaai aaai 18 paper view 16957 https doi org 10 1002 9781119196679 ch 10 https doi org 10 1002 9781119196679 ch 10 chalkis apostolos and vissarion fisikopoulos 19 g van valkenhoef and t tervonen hitandrun hit and run and shake and bake for sampling uniformly from convex shapes 2019 url https cran r project org package hitandrun r package version 0 5 5 p 2 g varsi the multidimensional content of the frustum of the simplex pacific journal of mathematics 46 1 303 314 1973 url https projecteuclid org 443 euclid pjm 1102946623 p 11 a venzke d molzahn and s chatzivasileiadis efficient creation of datasets for data driven power system applications electric power systems research 190 106614 2021 issn 0378 7796 url https doi org 10 1016 j epsr 2020 106614 p 1 j wadsworth and j tawn efficient inference for spatial extreme value processes associated to log gaussian random functions biometrika 1 03 2014 url https doi org 10 1093 biomet ast 042 p 2 h wickham testthat get started with testing the r journal 3 5 10 2011 url https journal r project org archive 2011 1 rjournal 2011 1 wickham pdf p 14 h wickham ggplot 2 elegant graphics for data analysis springer verlag new york 2016 isbn 978 3 319 24277 4 url https ggplot 2 tidyverse org p 15 g ziegler lectures on polytopes springer verlag new york 1995 url https doi org 10 1007 978 1 4613 8431 1 p 3 apostolos chalkis department of informatics telecommunications national kapodistrian university of athens greece geomscale org orcid 0000 0002 4628 1907 achalkis di uoa gr vissarion fisikopoulos department of informatics telecommunications national kapodistrian university of athens greece geomscale org orcid 0000 0002 0780 666 x vfisikop di uoa gr https cran r project org package hitandrun https projecteuclid org 443 euclid pjm 1102946623 https doi org 10 1016 j epsr 2020 106614 https doi org 10 1093 biomet ast 042 https journal r project org archive 2011 1 rjournal 2011 1 wickham pdf https journal r project org archive 2011 1 rjournal 2011 1 wickham pdf https ggplot 2 tidyverse org https doi org 10 1007 978 1 4613 8431 1 https doi org 10 1007 978 1 4613 8431 1 mailto achalkis di uoa gr mailto vfisikop di uoa gr 1 volesti volume approximation and sampling for convex polytopes in r 2 1 introduction 2 1 1 related r software and applications 2 2 algorithms and polytopes 2 2 1 convex polytopes 2 2 2 mcmc sampling and geometric random walks 2 2 3 volume estimation 2 3 package 2 3 1 polytope classes and generators 2 3 2 uniform sampling from polytopes 2 3 3 volume estimation 2 4 applications 2 4 1 financial crises detection and portfolio scoring 2 4 2 zonotope volumes in decision and control 2 4 3 high dimensional integration 2 4 4 combinatorics and artificial intelligence 2 5 concluding remarks and future work 2 6 computational details 2 7 acknowledgments