wavelet invariants for statistically robust multi reference alignment matthew hirn department of computational mathematics science and engineering department of mathematics center for quantum computing science and engineering michigan state univeristy east lansing mi mhirn msu edu and anna little department of computational mathematics science and engineering michigan state univeristy east lansing mi littl 119 msu edu july 14 2020 abstract we propose a nonlinear wavelet based signal representation that is translation invariant and ro bust to both additive noise and random dilations motivated by the multi reference alignment prob lem and generalizations thereof we analyze the statistical properties of this representation given a large number of independent corruptions of a target signal we prove the nonlinear wavelet based representation uniquely defines the power spectrum but allows for an unbiasing procedure that can not be directly applied to the power spectrum after unbiasing the representation to remove the ef fects of the additive noise and random dilations we recover an approximation of the power spec trum by solving a convex optimization problem and thus reduce to a phase retrieval problem ex tensive numerical experiments demonstrate the statistical robustness of this approximation proce dure multi reference alignment method of invariants wavelets signal processing wavelet scattering transform 1 introduction the goal in classic multi reference alignment mra is to recover a hidden signal f r r from a collec tion of noisy measurements specifically the following data model is assumed model 1 classic mra the classic mra data model consists of m independent observations of a com pactly supported real valued signal f l 2 r y j x f x t j j x 1 j m 1 where i supp y j 12 12 for 1 j m ii t j m j 1 are independent samples of a random variable t r 1 ar x iv 1 90 9 11 06 2 v 3 ee ss s p 1 3 ju l 20 20 iii j x m j 1 are independent white noise processes on 12 12 with variance 2 the signal is thus subjected to both random translation and additive noise the mra problem arises in numerous applications including structural biology 1 6 single cell genomic sequencing 7 radar 8 9 crystalline simulations 10 image registration 11 13 and signal processing 8 it is a simpli fied model relevant for cryo electron microscopy cryo em an imaging technique for molecules which achives near atomic resolution 14 16 in this application one seeks to recover a three dimensional re construction of the molecule from many noisy two dimensional images projections 17 although mra ignores the tomographic projection of cryo em investigation of the simplified model provides impor tant insights for example 18 19 investigate the optimal sample complexity for mra and demonstrate that m 6 is required to fully recover f in the low signal to noise regime when the translation dis tribution is periodic this optimal sample complexity is the same for cryo em 20 21 recent work has established an improved sample complexity of m 4 for mra when the translation distribution is aperiodic 22 and this rate has been shown to also hold in the more complicated setting of cryo em if the viewing angles are nonuniformly distributed 23 problems closely related to model 1 include the heterogenous mra problem where the unknown signal f is replaced with a template of k unknown sig nals f 1 fk 19 24 26 as well as multi reference factor analysis where the underlying random signal follows a low rank factor model and one seeks to recover its covariance matrix 27 approaches for solving mra generally fall into two categories synchronization methods and methods which estimate the signal directly i e without estimating nuisance parameters synchronization meth ods attempt to recover the signal by aligning the translations and then averaging they include methods based on angular synchronization 28 33 where for each pair of signals the best pairwise shift is com puted and then the translations are estimated from this pairwise information 34 and semi definite pro gramming 35 38 which approximates the quasi maximum likelihood estimator of the shifts by relax ing a nonconvex rank constraint however these methods fail in the low signal to noise regime methods which estimate the signal directly include both the method of moments 23 39 40 and expectation maxi mization or em type algorithms 22 41 a number of em type algorithms have also been developed for the more complicated cryo em problem 42 43 an important special case of the method of moments is the method of invariants which seeks to recover f by computing translation invariant features and thus avoids aligning the translations however the task is a difficult one as a complete representation is needed to recover the signal and yet the representation may be difficult to invert and corrupted by sta tistical bias generally the signal is recovered from translation invariant moments which are estimated in the fourier domain 39 44 recent work 16 18 utilizes such fourier invariants mean power spec trum and bispectrum and recovers f by solving a nonconvex optimization problem on the manifold of phases classic mra however fails to capture many of the biological phenomena arising in molecular imag ing such as the random rotations of the molecules and the tomographic projection associated with the imaging of 3 d objects another shortcoming is that the model fails to capture the dynamics which arise from flexible regions in macromolecular structures these flexible regions are very important in struc tural biology for example in understanding molecular interactions 46 49 and molecular recognition of epigenetic regulators of histone tails 50 52 the large scale dynamics of these regions makes imaging challenging 53 and thus sample preparation in cryo em generally seeks to minimize these dynamics by focusing on well folded macromolecules frozen in vitreous ice 45 however this may severely impact the nature of the intrinsic dynamics and interactions displayed by macromolecules 45 although modern cryo em is making great strides in understanding flexible systems 54 57 formulating models which are more capable of capturing the motions associated with the flexible regions of macromolecules could open the door to applying cryo em more broadly i e to less well folded macromolecules math ematically the motion of the flexible region can be modeled as a diffeomorphism see figure 1 which 2 a molecule with flexible side chain b diffeomorphism of figure 1 a figure 1 dynamics arising from flexible regions in macromolecular structures 45 shows a molecule with a flexible side chain 1 a and a diffeomorphism resulting from movement of the flexible region 1 b figure 1 a is taken from 45 and figure 1 b was obtained by deforming it this article thus generalizes the classic mra problem to include a random diffeomorphism specifi cally we consider recovering a hidden signal f r r from y j x l j f x t j j x 1 j m where l is a dilation operator which dilates by a factor of 1 the dilation operator l is a sim plified model for more general diffeomorphisms l f x f x since in the simplest case when x is affine l simply translates and dilates f see section 2 1 dilations are also relevant for the anal ysis of time warped audio signals which can arise from the doppler effect and in speech processing and bioacoustics for example 58 60 consider a stationary random signal f x which is time warped i e d f x x f x and use a maximum likelihood approach to estimate in 61 62 a simi lar stochastic time warping model is analyzed using wavelet based techniques the noisy dilation mra model considered here corresponds to the simplest case of time warping when is an affine function this special case is in fact very important in imaging applications 13 63 67 where it is critical to com pute features which are scale invariant as objects are naturally dilated by the zoom of an image a new approach is needed to solve this more general mra problem as fourier invariants will fail being unstable to the action of diffeomorphisms including dilations the instability occurs in the high frequencies where even a small diffeomorphism can significantly alter the fourier modes we instead propose l 2 r wavelet coefficient norms as invariants using a continuous wavelet transform this ap proach is inspired by the invariant scattering representation of 68 which is provably stable to the ac tions of small diffeomorphisms however here we replace local averages of the modulus of the wavelet coefficients with global averages i e integrations of the modulus squared thus providing rigid invari ants which can be statistically unbiased similar invariant coefficients have been utilized in a number of applications including predicting molecular properties 69 70 and quantum chemical energies 71 and in microcanonical ensemble models for texture synthesis 72 recent work 73 has also generalized such coefficients to graphs 3 1 1 notation the fourier transform of a signal f l 1 r is f f x e i x d x we remind the reader that compactly supported l 2 r functions are in l 1 r the power spectrum is the nonlinear transform p l 2 r l 1 r that maps f to p f f 2 r we denote f x c g x for some absolute constant c by f x g x we also write f x o g x if f x c g x for all x x 0 for some constants x 0 c 0 f x o g x denotes f x g x 0 as x f x g x denotes c 1 g x f x c 2 g x for all x x 0 for some constants x 0 c 1 c 2 0 the minimum of a and b is denoted a b and the maximum by a b 2 mra models and the method of invariants standard multi reference alignment mra models are generalized to models that include deformations of the underlying signal in section 2 1 section 2 2 reviews power spectrum invariants and introduces l 2 r wavelet coefficient invariants theorem 2 4 proves wavelet coefficient invariants computed with a continuous wavelet transform and a suitable mother wavelet are equivalent to the power spectrum showing there is no information loss in the transition from one representation to the other 2 1 mra data models a standard multi reference alignment mra scenario considers the problem of recovering a signal f l 2 r in which one observes random translations of the signal each of which is corrupted by additive noise the problem is particularly difficult when the signal to noise ratio is low as registration methods become intractable in 16 18 25 26 74 75 the authors propose a method using fourier based invariants which are invariant to translations and thus eliminate the need to register signals a more general mra scenario incorporates random deformations of the signal f which could be used to model underlying physical variability that is not captured by rigid transformations and addi tive noise models for example 20 35 consider a discrete signal f corrupted by an arbitrary group ac tion 8 76 consider random deformations arising in radar and 77 considers a generalization of mra where signals are rescaled by random constants another natural mathematical model is small random diffeomorphisms which leads to observations of the form y j x l j f x t j j x 1 j m 2 where j c 1 r is a random diffeomorphism t j r is a random translation and the signals j x are independent white noise random processes the transform l is the action of the diffeomorphism on f l f x f x if 1 then one can verify l l 2 r l 2 r one of the keys to the fourier invariant approach of 16 18 25 26 74 75 is the authors can unbias the fourier invariants of the noisy signals thus allowing them to devise an unbiased estimator of the fourier invariants of the signal f or a mixture of signals in the heterogeneous mra case for the diffeo morphism model 2 this would require developing a procedure for unbiasing the fourier invariants of y j m j 1 against both additive noise and random diffeomorphisms 4 in order to get a handle on the difficulties associated with the proposed diffeomorphism model in this paper we consider random dilations of the signal f which corresponds to restricting the diffeomor phism to be of the form x x 1 1 2 specifically we assume the following noisy dilation mra model model 2 noisy dilation mra data model the noisy dilation mra data model consists of m independent observations of a compactly supported real valued signal f l 2 r y j x l j f x t j j x 1 j m 3 where l is an l 1 r normalized dilation operator l f x 1 1 f 1 1 x in addition we assume i supp y j 12 12 for 1 j m ii t j m j 1 are independent samples of a random variable t r iii j m j 1 are independent samples of a bounded symmetric random variable satisfying r e 0 var 2 1 2 iv j x m j 1 are independent white noise processes on 12 12 with variance 2 remark 2 1 the interval 12 12 is arbitrary and can be replaced with any interval of length 1 in addition the spatial box size is arbitrary i e 12 12 can be replaced with n 2 n 2 all results still hold with p n replacing wherever it appears thus the hidden signal f is supported on an interval of length 1 and we observe m independent instances of the signal that have been randomly translated randomly dilated and corrupted by additive white noise we assume the hidden signal is real but the proposed methods can also handle complex valued signals with minor modifications recall x is a white noise process if x dbx i e it is the derivative of a brownian motion with variance 2 while the noisy dilation mra model does not capture the full richness of the diffeomorphism model it already presents significant mathematical difficulties indeed as we show in section 5 fourier invari ants specifically the power spectrum cannot be used to form accurate estimators under the action of dilations and random additive noise the reason is that fourier measurements are not stable to the action of small dilations measured here by since the displacement of l f relative to f depends on intuitively high frequency modes are unstable and yet high frequencies are often critical for exam ple removing high frequencies increases the sample complexity needed to distinguish between signals in a heterogeneous mra model 18 we thus replace fourier based invariants with wavelet coefficient invariants which are defined in section 2 2 as we show the wavelet invariants of the signal f can be ac curately estimated from wavelet invariants of the noisy signals y j m j 1 with no information loss relative to the power spectrum of f for future reference we also define the following dilation mra model which includes random trans lations and random dilations but no additive noise thus models 1 and 3 are both special cases of model 2 5 model 3 dilation mra data model the dilation mra data model consists of m independent observa tions of a compactly supported real valued signal f l 2 r y j x l j f x t j 1 j m 4 where l is an l 1 r normalized dilation operator l f x 1 1 f 1 1 x in addition we assume i iii of model 2 2 2 method of invariants we now discuss how invariant representations can be used to solve mra data models and introduce the wavelet invariants used in this article 2 2 1 motivation and related work let tt f x f x t denote the operator which translates by t acting on a signal f invariant measure ment models seek a representation f b in a banach space b such that tt f f t r 5 in mra problems one additionally requires that f g g tt f for some t r 6 the first condition 5 removes the need to align random translations of the signal f whereas the second condition 6 ensures that if one can estimate f from the collection y j m j 1 then one can recover an estimate of f up to translation by solving f arginf g l 1 l 2 r g f b 7 where b is the banach space norm when the observed signals y j m j 1 are corrupted by more than just a random translation though as in model 2 estimating f from y j m j 1 is not always straightforward indeed one would like to compute m f 1 m m j 1 y j 8 but the quantity m f is not always an unbiased estimator of f meaning that limm m f 6 f in order to circumvent this issue one must select a representation such that e y j f b f m 9 where b f m is a bias term depending on the choice of f and the signal corruption model m if 9 holds and if we can compute a b such that e b y j m b f m for b f m then one can amend 8 to reduce the bias m f 1 m m j 1 y j b y j m 6 in which case lim m m f f almost surely by the law of large numbers the main difficulty therefore is twofold on the one hand one must design a representation that satisfies 5 6 and 9 with a bias b that can be estimated on the other hand the optimization 7 must be tractable for random translation plus additive noise models i e model 1 the authors of 16 18 describe a representation based on fourier invariants that satisfies the outlined requirements and for which one can solve 7 despite the optimization being non convex the fourier invariants include f 0 i e the integral of f the power spectrum of f and the bispectrum of f each invariant captures successively more information in f while f 0 carries limited information the power spectrum recovers the magnitude of the fourier transform namely it recovers the nonnegative real valued function such that f e i but the phase information is lost since t t f e i t f the power spectrum is invariant to translations as the fourier modulus kills the phase factor induced by a translation t of f however it is in general not possible to recover a signal from its power spectrum although in certain special cases the phase information can be resolved results along these lines are in the field of phase retrieval 78 79 the bispectrum is also translation invariant and invertible so long as f 6 0 19 in section 5 we show that it is impossible to significantly reduce the power spectrum bias for model 2 which includes translations dilations and additive noise we thus propose replacing the power spec trum with the l 2 r norms of the wavelet coefficients of the signal f these invariants satisfy 5 and 9 for model 2 and yield a convex formulation of 7 they do not satisfy 6 for general f l 2 r but theorem 2 4 in section 2 2 2 shows that knowing the wavelet invariants of f is equivalent to knowing the power spectrum of f which means that any phase retrieval setting in which recovery is possible will also be possible with the specified wavelet invariants for example if the signal lives in a spline or shift invariant space in addition to being real valued then it can be recovered from its phaseless measure ments 78 79 2 2 2 wavelet invariants we now define the wavelet invariants used in this article a wavelet l 2 r is a waveform that is local ized in both space and frequency and has zero average x d x 0 note throughout this article will always denote a wavelet in l 1 l 2 r with zero average satisfying 2 1 as well as the classic admissability condition 2 d a dilation of the wavelet by a factor 0 is denoted x 1 2 x where the normalization guarantees that 2 2 1 the continuous wavelet transform w com putes w f f x 0 x r the parameter corresponds to a frequency variable indeed if 0 is the central frequency of the wavelet coefficients f recover the frequencies of f in a band of size proportional to centered at 0 thus high frequencies are grouped into larger packets which we shall use to obtain a stable invariant representation of f the wavelet transform w f is equivariant to translations but not invariant integrating the wavelet coefficients over x yields translation invariant coefficients but they are trivial since 0 we there fore compute l 2 r norms in the x variable yielding the following nonlinear wavelet invariants 7 definition 2 1 wavelet invariants the l 2 wavelet invariants of a real valued signal f l 1 l 2 r are given by s f f 22 0 10 where x 1 2 x are dilations of a mother wavelet throughout this article can be taken as a morlet wavelet in which case is constructed to have frequency centered at by x c 1 4 e x 2 2 e i x e 2 2 for c 1 e 2 2 e 3 2 4 1 2 but results hold more generally for what we refer to as k admissible wavelets where k 0 is an even integer see appendix a for a precise description of this admissibility criteria the wavelet invariants can be expressed in the frequency domain as s f 1 2 f 2 2 d which motivates the following definition of wavelet invariant derivatives definition 2 2 wavelet invariant derivatives the n th derivative of s f is defined as s f n 1 2 f 2 d n d n 2 d remark 2 2 definition 2 1 assumes f r r which allows the wavelet to be either real or complex our results can easily be extended to complex f but a strictly complex wavelet would be needed with s f computed for all 0 remark 2 3 for a discrete signal of length n computing the wavelet invariants via a continuous wavelet transform is o n 2 while computing the power spectrum is o n logn thus one pays a computational cost to achieve greater stability with no loss of information on the other hand if wavelet invariants are computed for a dyadic wavelet transform i e only for o logn s the computational cost is the same and stability is maintained but more information is lost remark 2 4 when p f f 2 is continuous definition 2 2 reduces to a normal derivative i e one can check that s f n d nd n s f however when p f is not continuous in general s f n 6 d n d n s f and s f n is more convenient for controling the error of the estimators proposed in this article throughout this article the notation s f n will thus denote the derivative of definition 2 2 and d n d n s f will denote the standard derivative under mild conditions one can show that s l 2 r l 1 c 0 the values 2 j for j z cor respond to rigid versions of first order l 2 r wavelet scattering invariants 68 the continuous wavelet transform w f is extremely redundant indeed for suitably chosen mother wavelets the dyadic wavelet transform with 2 j for j z is a complete representation of f however the corresponding operator s restricted to 2 j is not invertible when one utilizes every frequency 0 though the resulting l 2 r norms s f f 22 uniquely determine the power spectrum of f so long as the wavelet satisfies a type of independence condition condition 2 3 define 2 2 2 1 0 if for any finite sequence i n i 1 of distinct positive frequencies the collection i 2 ni 1 are linearly independent functions of we say the wavelet satifies the linear independence condition 8 remark 2 5 condition 2 3 is stated in terms of 2 to avoid assumptions on whether is real or complex when x r 2 2 2 for 0 when is complex analytic 2 2 when c but not complex analytic 2 simply incorporates a reflection of 2 about the origin since we assume f x r 2 uniquely defines s f since s f 12 f 2 2 by the plancherel and fourier convolution theorems theorem 2 4 let f g l 1 l 2 r and assume satisfies condition 2 3 and has compact support then s f sg p f p g proof first assume p f p g which means f 2 g 2 for almost every r using the plancheral and fourier convolution theorems s f f x 2 d x 1 2 f 2 2 d 1 2 g 2 2 d sg 0 now suppose s f sg since s f and sg are continuous in we have 0 s f sg 1 2 f 2 g 2 2 d 0 since f l 1 l 2 r we have f l 2 l r and thus p f l 1 l r by interpolation we have p f l 2 r and the same for p g by applying lemma 2 1 stated below with p p f p g note p is continuous since f g l 1 r we conclude p f p g for almost every lemma 2 1 let p l 2 r be continuous and assume p p has compact support and condi tion 2 3 then p 2 d 0 0 p 0 a e the proof of lemma 2 1 is in appendix c we remark that many wavelets satisfy condition 2 3 and have compactly supported fourier transform so theorem 2 4 is broadly applicable for example propo sition 2 5 below proves that any complex analytic wavelet with compactly supported fourier transform satisfies condition 2 3 morlet wavelets satisfy condition 2 3 see lemma c 1 in appendix c but do not have compactly supported fourier transform however does have fast decay for a morlet wavelet and numerically we observe no issues we also note the assumption that has compact support in theorem 2 4 can be removed if f g are bandlimited the following proposition proved in appendix c gives some sufficient conditions guaranteeding condition 2 3 proposition 2 5 the following are sufficient to guarantee condition 2 3 i 2 has a compact support contained in the interval a b where a and b have the same sign e g complex analytic wavelets with compactly supported fourier transform ii 2 c r and there exists an n such that all derivatives of order at least n are nonzero at 0 e g the morlet wavelet remark 2 6 in practice p f s f are implemented as discrete vectors and s f is obtained from p f via matrix multiplication i e s f f p f for some real matrix f with f t f strictly positive definite thus 9 p f p g 2 1 min s f sg 2 where min 0 is the smallest singular value of the matrix f and the spec tral decay of f which can be explicitly computed thus determines the stability of the representation the smoother the wavelet the more rapidly the spectrum decays since when p c p f t f is defined by a c p kernel and thus has eigenvalues which decay like o 1 np 1 80 there is thus a tradeoff be tween smoothness and stability in this article we choose smoothness over stability since smoothness is required for unbiasing noisy dilation mra and in our experiments the morlet wavelet yielded the best results we therefore invert the representation by solving an optimization problem which is initialized to be close to the desired solution see section 6 5 and we avoid computing the pseudo inverse of f which is unstable for our smooth wavelet 3 unbiasing for classic mra in this section we consider the classic mra model model 1 we discuss unbiasing results for both the power spectrum and wavelet invariants as well as simulation results comparing the two methods in the following proposition we establish unbiasing results for the power spectrum by rederiving some results from 16 extended to the continuum setting the proposition is proved in appendix d proposition 3 1 assume model 1 define the following estimator of p f p f 1 m m j 1 p y j 2 then with probability at least 1 1 t 2 p f p f 2 t p m f 1 11 we obtain an identical result for wavelet invariants proposition 3 2 when signals are corrupted by additive noise only see appendix d for the proof proposition 3 2 assume model 1 define the following estimator of s f s f 1 m m j 1 sy j 2 then with probability at least 1 1 t 2 s f s f 2 t p m f 1 12 as m the error of both the power spectrum and wavelet invariant estimators decays to zero at the same rate and one can perfectly unbias both representations as demonstrated in section 5 this is not possible for noisy dilation mra model 2 as there is a nonvanishing bias term however a nonlinear unbiasing procedure on the wavelet invariants can significantly reduce the bias we illustrate and compare additive noise unbiasing for power spectrum estimation using p f the power spectrum method of proposition 3 1 and s f the wavelet invariant method of proposition 3 2 to approximate p f from the wavelet invariants s f we apply the convex optimization algorithm described in section 6 5 to obtain p s f the power spectrum approximation which best matches the wavelet invariants s f thus throughout this article p s f denotes a power spectrum estimator obtained by first unbiasing wavelet invariants and then running an optimization procedure while p f denotes 10 100 50 0 50 100 0 0 5 1 1 5 2 2 5 3 3 5 a noisy ps snr 0 56 4 6 8 10 12 14 16 7 6 5 4 3 2 1 0 b l 2 error snr 0 56 7 6 5 4 3 2 10 9 8 7 6 5 4 3 2 1 0 c l 2 error m 500 figure 2 simulation results for additive noise model for medium frequency gabor f x e 5 x 2 cos 16 x an estimator computed by directly unbiasing the power spectrum our simulations compare the l 2 error of both of these estimators i e we compare p f p f 2 and p f p s f 2 figure 2 a shows the uncorrupted power spectrum red curve of a medium frequency gabor function f x e 5 x 2 cos 16 x and the power spectrum after the signal is corrupted by additive noise with level 2 3 blue curve the signal to noise ratio snr of the experiment is 0 56 see section 6 1 figure 2 b shows the l 2 error of the power spectrum estimation for the two methods as a function of log 2 m for a fixed snr and figure 2 c shows the l 2 error as a function of log 2 for a fixed m the l 2 errors for the two methods are similar however estimation via wavelet invariants is advantageous when the sample size m is small or the additive noise level is large as m becomes very large or very small the power spectrum method is preferable as the smoothing procedure of the wavelet invariants may numerically erase some extremely small scale features of the original power spectrum 4 unbiasing for dilation mra in this section we analyze the dilation mra model model 3 we thus assume the signals have been randomly translated and dilated but there is no additive noise in fact there is a simple algorithm to recover f under this model since f j 22 f 22 1 j 1 m m j 1 1 f j 22 is an unbiased estimator of 1 f 22 and so f 22 can be accurately approximated once f 22 is recovered one can take any signal y j and dilate it so that y j 22 f 22 and the result will be an accurate approximation of the hidden signal f for m large however this approach collapses in the presence of even a small amount of additive noise in the presence of additive noise an alternative is to attempt a synchronization by centering each signal the center c f of signal f can be defined in the classical way by c f 1 f 22 x f x 2 d x since the signals y j x c f t j are perfectly aligned one can thus attempt an alignment by defining y j x y j x cy j however cy j c f t j o 2 so significant errors arise in the synchroniza tion which cannot be resolved by averaging as our goal is ultimately to produce a method which can be extended to the noisy dilation mra model we abandon both the trivial solution which cannot be extended to noisy dilation mra and the synchronization approach which produces large errors and explore a method based on empirical averages we first observe that random dilations cause 1 m m j 1 p y j and 1 m m j 1 sy j to be biased es timators of p f and s f and the bias for both is o 2 where 2 is the variance of the dila 11 tion distribution however if the moments of the dilation distribution are known and p f s f are suffi ciently smooth one can apply an unbiasing procedure to the above estimators so that the resulting bias is o k 2 where k 2 is an even integer throughout this section we assume k 2 is an even integer and define the constants ci from the first k 2 even moments of by e i ci i for i 2 4 k note since we assume e 2 2 c 2 1 we define the constants b 2 b 4 bk by solving ci i b 2 ci 2 i 2 bi 2 c 2 2 bi 0 13 for i 2 4 k these constants are deterministic functions of the moments of a nonrecursive formula related to the euler numbers can be derived which defines bi explicitly in terms of c 2 ci however the recursive formula 13 is easier to implement numerically we introduce two additional moment based constants which are defined by the ci bi constants t max i 0 2 c 1 i i 14 e max i 0 2 k max j 0 k 2 i t j j bi 1 i j 15 where c 0 b 0 1 and when i j 0 in 15 t j j bi 1 i j is replaced with 1 remark 4 1 since the distribution of is bounded we are guaranteed that t and in general can consider both t and e to be o 1 constants for example for the uniform distribution t p 3 and bi euler i i 1 which gives e p 3 we utilize the following two lemmas which are proved in appendix e to derive results for both the power spectrum and wavelet invariants lemma 4 1 let f l 1 for some function l ck 2 0 and a random variable satisfying the assumptions of section 2 1 and let k 2 be an even integer assume there exist functions i r r r r r such that i l i i for 0 i k 2 k 2 1 k 2 r and define the following estimator of l g f b 2 2 f b 4 4 f 4 bk k f k then g satisfies eg l kr k 2 2 e k 2 var g k 2 r 2 2 where 2 0 i j k 2 i j 2 i j 2 e i j and e is the absolute constant defined in 15 12 lemma 4 2 let the assumptions and notation of lemma 4 1 hold and let 1 m be independent define l 1 m m j 1 g j then with probability at least 1 1 t 2 l l kr k 2 2 e k 2 t p m the deviation of the estimator l from l thus depends on two things 1 the bias of the estima tor which is o k 2 and 2 the standard deviation of the estimator which is o m 1 2 since o 4 1 power spectrum results for dilation mra we now show how this unbiasing procedure based on both the moments of and the even derivatives of p y can be used to obtain an estimator of p f proposition 4 1 assume model 3 and p f ck 2 r define the following estimator of p f p f 1 m m j 1 p y j b 2 2 2 p y j bk k k p y j k where the constants bi satisfy 13 let i i p f i for 0 i k 2 r max k 2 1 k 2 then for all 6 0 with probability at least 1 1 t 2 p f p f kr k 2 2 e k 2 t p m 16 where 0 i j k 2 i j 2 i j 2 e i j proof since p f is a translation invariant representation we can ignore the translation factors tk m k 1 and consider the model y j l j f in addition since y j x r p y j p y j and it is sufficient to consider 0 proposition 4 1 then follows directly from lemma 4 2 with l p f since p y j p f 1 j f j i i and we postpone a discussion of the shortcomings of proposition 4 1 to section 4 3 where we compare the power spectrum and wavelet invariant results for dilation mra 4 2 wavelet invariant results for dilation mra we now apply the same unbiasing procedure to the wavelet invariants unlike for the power spectrum where the error may depend on the frequency see 16 and section 4 3 the wavelet invariant error can be uniformly bounded independently of with high probability the following two lemmas estab lish bounds on the derivatives of s f and are needed to prove proposition 4 2 they are proved in appendix b 13 lemma 4 3 low frequency bound assume p cm r and f l 1 r then the quantity m s f m can be bounded uniformly over all specifically m s f m m f 21 for m defined in 26 lemma 4 4 high frequency bound for differentiable functions assume p cm r and f l 1 r then the quantity m s f m can be bounded by m s f m m 2 f 21 for m defined in 27 when is a morlet wavelet or more generally when is k 2 admissable as described in appendix a these lemmas allow one to bound the error of the order k wavelet invariant estimator for dilation mra in terms of the following quantities i i f 21 i 2 f 21 2 0 i j k 2 i j 2 i j 2 e i j 17 where i i are defined in 26 27 and e is defined in 15 proposition 4 2 assume model 3 the notation in 17 and that is k 2 admissable define the following estimator of s f s f 1 m m j 1 sy j b 2 2 2 sy j bk k k sy j k where the constants bi satisfy 13 then with probability at least 1 1 t 2 s f s f k k 2 2 e k 2 t p m proof since s f is a translation invariant representation we can ignore the translation factors tk m k 1 and consider the model y j l j f since is k 2 admissable ck 2 r which guarantees s f ck 2 0 we note that since f l 1 r p f is continuous and the leibniz integral rule guarantees that s f n d nd n s f for 1 n k 2 by applying lemma 4 3 we have i s f i i f 21 for all 0 i k 2 so that lemma 4 2 holds for l s f i i f 21 and r 1 now by applying lemma 4 4 we have i s f i i f 21 2 for all 0 i k 2 so that lemma 4 2 also holds for l s f i i f 21 2 and r 4 note since 12 k 2 1 k 2 4 thus lemma 4 2 in fact holds with i i f 21 i 2 f 21 since sy j s f 1 j f j we obtain proposition 4 2 since i i f 21 proposition 4 2 guarantees that the error can be uniformly bounded indepen dent of in addition if the signal is smooth the error for high frequency will have the favorable scaling 2 an important question in practice is how to choose k i e what order wavelet invariant estimator minimizes the bias consider for example when f l 1 r and k 2 k 2 f 21 by using a second order estimator we can decrease the bias from o 2 to o 4 and we can further decrease the bias to o 6 by choosing k 4 however k increases very rapidly in k indeed as can be seen from 26 k increases like k thus one possible heuristic assuming is known is to choose k k where k minimizes the bias upper bound k k 2 2 e k 2 since k increases factorially k c k k for some constant c and k 2 will be inversely proportional to that is k 2 1 the following corollary of proposition 4 2 then holds for any k k 14 corollary 4 1 under the assumptions of proposition 4 2 if i 2 e i is decreasing for i k 2 then with probability at least 1 1 t 2 s f s f f 21 k k 2 2 e k 2 tk 2 p m 18 similarly if i 2 e i is decreasing for i k 2 then with probability at least 1 1 t 2 s f s f f 21 2 k k 2 2 e k 2 tk 2 p m 19 remark 4 2 we observe that for a discrete lattice i of values we can define the discrete 1 norm by g l 1 i i g assume the lattice has cardinality n and that i 2 e i i 2 e i are decreasing for i k 2 applying proposition 4 2 with t pns and a union bound over the lattice gives s f s f l 1 i k f 21 k 2 f 21 k 2 2 e k 2 s p nk 2 p m f 21 f 21 with probability at least 1 1 s 2 when n m which is the context for mra the 1 norm of the error is o k 2 as m 4 3 comparison although propositions 4 2 and 4 1 at first glance appear quite similar the wavelet invariant method has several important advantages over the power spectrum method which we enumerate in the following remarks remark 4 3 proposition 4 2 wavelet invariants applies to any signal satisfying f l 1 r but proposition 4 1 requires p f ck 2 r thus as k is increased the power spectrum results apply to an increasingly restrictive function class furthermore as discussed in section 5 if the signal contains any additive noise p y j is not even c 1 which means the unbiasing procedure of proposition 4 1 cannot be applied on the other hand by choosing p c r s f will inherit the smoothness of the wavelet and the wavelet invariant results will hold for any f l 1 r and any k remark 4 4 since p f p f 1 dilation will transport the frequency content at to 1 so that the displacement is thus when is very large p f p f can be large even for small because the wavelet invariants bin the frequency content and these bins become increasingly large in the high frequencies this does not occur for wavelet invariants more specifically there is always a signal f and frequency for which p f p f is large regardless of k consider for example when p f e 2 then k k and p f p f 1 however for m large enough the order k wavelet invariant estimator satisfies s f s f o k k 2 k 2 for all the wavelet invariants are thus stable for high frequency signals where the power spectrum fails remark 4 5 for the wavelet invariants there will be a unique k which minimizes k k 2 2 e k 2 and k does not depend on furthermore k can be explicitly computed given the wavelet and moment constant e on the other hand the minimum of k k 2 2 e k 2 with respect to k will depend on both the frequency and the signal f so that k k f and it becomes unclear how to choose the unbiasing order 4 4 simulation results for dilation mra we first illustrate the unbiasing procedure of propositions 4 1 and 4 2 for the high frequency signal f x e 5 x 2 cos 32 x figure 3 shows the power spectrum estimator p f and the wavelet invariant estimator 15 10 20 30 40 50 60 0 02 0 0 02 0 04 0 06 0 08 0 1 0 12 0 14 0 16 0 th order est 2 nd order est 4 th order est target ps a f 3 x 0 06 10 20 30 40 50 60 0 05 0 0 05 0 1 0 15 0 th order est 2 nd order est 4 th order est target ps b f 3 x 0 12 10 20 30 40 50 60 0 0 02 0 04 0 06 0 08 0 1 0 12 0 14 0 16 0 th order est 2 nd order est 4 th order est target ps c f 3 x 0 06 10 20 30 40 50 60 0 0 02 0 04 0 06 0 08 0 1 0 12 0 14 0 16 0 th order est 2 nd order est 4 th order est target ps d f 3 x 0 12 figure 3 order k 0 2 4 power spectrum estimators p f first two figures and wavelet invariant estimators p s f last two figures for the signal f 3 x e 5 x 2 cos 32 x figures 3 a and 3 c show small dilations and figures 3 b and 3 d show large dilations p s f for k 0 2 4 for both small and large dilations where p s f denotes the combined wavelet invariant unbiasing plus optimization procedure see section 6 5 higher order unbiasing is beneficial for both methods for small dilations but fails for the power spectrum for large dilations both methods will of course fail for large enough but for high frequency signals the power spectrum fails much sooner next we compare p f p f 2 and p f p s f 2 the l 2 error of estimating the power spectrum of the target signal via the power spectrum estimators of proposition 4 1 and via the wavelet invariant es timators of proposition 4 2 followed by a convex optimzation procedure we consider order k 0 2 4 estimators for both the power spectrum and wavelet invariants on the following gabor atoms of increas ing frequency f 1 x e 5 x 2 cos 8 x f 2 x e 5 x 2 cos 16 x f 3 x e 5 x 2 cos 32 x these functions satisfy f real h where ph 5 e 2 10 for 8 16 32 and thus exhibit the behavior described in remark 4 4 simulation results are shown in figure 4 the horizontal axis shows log 2 m while the vertical axis shows log 2 error for each value of m the error was calculated for 10 independent simulations and then averaged the unbiasing procedure of propositions 4 1 and 4 2 requires knowledge of the moments of the dilation distribution but in practice these are unknown thus the first two even moments of the dilation distribution 2 c 4 4 were estimated empirically with the fourth order estimators described in section 6 3 see definition 6 2 for the low frequency signal the 4 th order power spectrum estimator was best for both small and large dilations and is preferable due to the lower computational cost see remark 2 3 for the high frequency signal the 4 th order wavelet invariant estimator was best for large dilations and wsc k 2 and k 4 were best and equivalent for small dilations for the medium fre quency signal the higher order power spectrum estimators were best for small dilations while the higher order wavelet invariant estimators were best for large dilations thus the simulation results confirm that the wavelet invariants will have an advantage over fourier invariants when the signals are either high frequency or corrupted by large dilations we remark that one obtains nearly identical error plots with oracle knowledge of the dilation moments indicating that the empirical moment estimation procedure is highly accurate in the absencse of additive noise even for small m values 16 5 6 7 8 9 10 11 12 13 14 12 11 10 9 8 7 6 5 4 3 2 a f 1 x 0 06 5 6 7 8 9 10 11 12 13 14 12 11 10 9 8 7 6 5 4 3 2 b f 2 x 0 06 5 6 7 8 9 10 11 12 13 14 12 11 10 9 8 7 6 5 4 3 2 c f 3 x 0 06 5 6 7 8 9 10 11 12 13 14 12 11 10 9 8 7 6 5 4 3 2 d f 1 x 0 12 5 6 7 8 9 10 11 12 13 14 12 11 10 9 8 7 6 5 4 3 2 e f 2 x 0 12 5 6 7 8 9 10 11 12 13 14 12 11 10 9 8 7 6 5 4 3 2 f f 3 x 0 12 figure 4 l 2 error with standard error bars for dilation model empirical moment estimation top row shows results for small dilations 0 06 and bottom row shows results for large dilations 0 12 first second third column shows results for low medium high frequency gabor signals all plots have the same axis limits 5 noisy dilation mra model finally we consider the noisy dilation mra model model 2 where signals are randomly translated and dilated and corrupted by additive noise section 5 1 gives unbiasing results for wavelet invariants and section 5 2 reports relevant simulations 5 1 wavelet inariant results for noisy dilation mra to state proposition 5 1 as succinctly as possible we also define the following quantity m 0 2 k m e m 20 where e is defined in 15 and m is defined in 26 proposition 5 1 assume model 2 and that is k 2 admissable define the following estimator of s f s f 1 m m j 1 sy j b 2 2 2 sy j bk k k sy j k 2 where the constants bi satisfy 13 then with probability at least 1 1 t 2 s f s f k k 2 2 e k 2 tp m k 2 0 21 where e are as defined in 15 17 20 17 the following corollary is an immediate consequence of proposition 5 1 corollary 5 1 let the assumptions of proposition 5 1 hold and in addition assume i 2 e i is de creasing for i k 2 then with probability at least 1 1 t 2 s f s f k k 2 2 e k 2 f 21 tkp m k f 21 f 1 2 22 we remark that there are two components to the estimation error bounded by the right hand side of 22 the first two terms are the error due to dilation as in corollary 4 1 of proposition 4 2 and the last two terms are the error due to additive noise as given in proposition 3 2 thus the wavelet invariant rep resentation allows for a decomposition of the error of the noisy dilation mra model into the sum of the errors of the random dilation model and the additive noise model this is possible because the represen tation inherits the differentiability of the wavelet and is not possible when p ck r in which case the dilation unbiasing procedure has a more complicated effect on the additive noise a result equivalent to proposition 5 1 cannot be made for the power spectrum because the nonlinear unbiasing procedure of proposition 4 1 cannot be applied to the power spectra of signals from the noisy dilation mra corruption model since they are not differentiable in the presence of additive noise proof of proposition 5 1 since s f is a translation invariant representation we can ignore the translation factors t j m j 1 and consider the model y j f j j for notational convenience we define the following order k derivative unbiasing operator a g g b 2 2 2 d d 2 g bk k k d d k g 23 which is defined on any function of so that we can express our estimator by s f 1 m m j 1 1 2 y j 2 a 2 d 2 1 m m j 1 1 2 f j 2 f j j f j j j 2 a 2 d 2 we can thus decompose the error as follows s f s f 1 m m j 1 1 2 f j j f j j a 2 d cross term error 1 m m j 1 1 2 f j 2 a 2 d s f dilation error 1 m m j 1 1 2 j 2 a 2 d 2 additive noise error to bound the above terms we utilize the following two lemmas which are proved in appendix f lemma 5 1 let the notation and assumptions of proposition 5 1 hold and let a be the operator defined in 23 then with probability at least 1 1 t 2 1 m m j 1 1 2 j 2 a 2 d 2 2 t p k 2 p m 18 lemma 5 2 let the notation and assumptions of proposition 5 1 hold and let a be the operator defined in 23 then with probability at least 1 1 t 2 1 m m j 1 1 2 f j j f j j a 2 d tpm 0 applying proposition 4 2 to bound the dilation error lemma 5 1 to bound the additive noise error and lemma 5 2 to bound the cross term error gives 21 5 2 simulation results for noisy dilation mra we once again consider the gabor atoms of varying frequency introduced in section 4 4 and compare the l 2 error of estimating the power spectrum by 1 averaging the power spectra of the noisy signals and applying additive noise unbiasing this is the zero order power spectrum method ps k 0 defined in proposition 3 1 and 2 by approximating the wavelet invariants by the estimators given in proposition 5 1 for k 0 2 4 and then applying the optimization procedure described in section 6 5 we refer to these methods as wsc k i for i 0 2 4 we emphazise that for the noisy dilation mra model it is impossible to define higher order methods for the power spectrum we first consider the errors obtained given oracle knowledge of the noise moments both additive and dilation results are shown in figure 5 for all parameter combinations resulting from 2 4 2 3 giving snr 2 2 0 56 and 0 06 0 12 the horizontal axis shows log 2 m and the vertical axis shows log 2 error for each value of m the error was calculated for 10 independent simulations and then aver aged for all simulations was given a uniform distribution a challenging regime for dilations and the sample size ranged over 16 m 131 072 for the medium and high frequency signals for large enough m wsc k 2 and wsc k 4 have significantly smaller error than the order zero estimators indicat ing that the nonlinear unbiasing procedure of proposition 5 1 contributes a definitive advantage for the high frequency signal and large m the error using wsc k 4 is decreased by a factor of about 3 from the ps k 0 error for small dilations 0 06 there is not much of a difference in performance between wsc k 2 and wsc k 4 but the gap between these estimators widens for large dilations 0 12 as the fourth order correction becomes more important for the low frequency signal under small dilations ps k 0 achieves the smallest error for large m however when m is small or the dilations are large the wsc estimators have the advantage for the low frequency signal as well and wsc k 4 is once again the best estimator for large m we note that although in general recovering the power spectrum is insufficient for recovering the signal the signal can be recovered when f r and f 0 by taking the inverse fourier transform of the root power spectrum figure 6 shows the approximate signals recovered by this procedure from ps k 0 figure 6 c and wsc k 4 figure 6 b for the high frequency gabor signal f 3 x figure 6 a the wsc recovered signal is a much better approximation of the target signal the recovered power spectra are shown in figure 6 d ps k 0 is much flatter than the target power spectrum while wsc k 4 is a good approximation of both the shape and height of the target power spectrum appendix g outlines an empirical procedure for estimating the moments of in the special case when t 0 in the noisy dilation mra model i e no random translations all simulations reported in figure 5 are repeated with minor modifications with empirical additive and dilation moment estimation and the results are reported in figure 7 of appendix g appendix h contains additional simulation results for a variety of high frequency signals 19 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 a f 1 snr 2 2 0 06 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 b f 2 snr 2 2 0 06 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 c f 3 snr 2 2 0 06 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 https www overleaf com project 5 c 9 d 8 c 94 a 843 b 632 cccc 13 d 1 d f 1 snr 2 2 0 12 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 e f 2 snr 2 2 0 12 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 f f 3 snr 2 2 0 12 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 g f 1 snr 0 56 0 06 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 h f 2 snr 0 56 0 06 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 i f 3 snr 0 56 0 06 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 j f 1 snr 0 56 0 12 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 k f 2 snr 0 56 0 12 4 6 8 10 12 14 16 8 7 6 5 4 3 2 1 0 l f 3 snr 0 56 0 12 figure 5 l 2 error with standard error bars for noisy dilation mra model oracle moment estimation first second third column shows results for low medium high frequency gabor signals all plots have the same axis limits 20 3 2 1 0 1 2 3 1 0 5 0 0 5 1 1 5 a target signal 3 2 1 0 1 2 3 1 0 5 0 0 5 1 1 5 b wsc recovered 3 2 1 0 1 2 3 1 0 5 0 0 5 1 1 5 c ps recovered 15 20 25 30 35 40 45 50 0 02 0 0 02 0 04 0 06 0 08 0 1 0 12 0 14 0 16 d recovered ps figure 6 signal recovery results for f 3 x e 5 x 2 cos 32 x with m 20 000 0 12 snr 2 2 remark 5 1 one could also solve noisy dilation mra with an expectation maximization em algorithm appendix h describes how the method proposed in 22 can be extended to solve model 2 althought em algorithms provide a flexible tool for accurate parameter estimation in a variety of mra models the pri mary disadvantage is the high computational cost of each iteration each iteration costs o mn 3 while wavelet invariant estimators can be computed in o mn 2 in addition the statistical priors chosen may bias the signal reconstruction 81 and the algorithm will generally only converge to a local maximum in this article we thus explore whether it is possible to solve noisy dilation mra more efficiently and accurately by nonlinear unbiasing procedures 6 numerical implementation in this section we describe the numerical implementation of the proposed method used to generate the results reported in sections 3 4 4 and 5 2 section 6 1 describes how signals were generated and sections 6 2 and 6 3 describe empirical procedures for estimating the additive noise level and the moments of the dilation distribution finally section 6 4 discusses how the derivatives used for unbiasing were computed and section 6 5 describes the convex optimization algorithm used to recover p f from s f all simulations used a morlet wavelet constructed with 3 4 6 1 signal generation and snr all signals were defined on n 4 n 4 and then padded with zeros to obtain a signal defined on n 2 n 2 the additive noise was also defined on n 2 n 2 signals were sampled at a rate of 1 2 thus resolving frequencies in the interval 2 2 with a frequency sampling rate of 2 n we used n 25 and 5 in all experiments keeping the box size and resolution fixed for each experiment with hidden signal f the snr was calculated by snr 1 n n 2 n 2 f x 2 d x 2 6 2 empirical estimation of additive noise level the additive noise level 2 can be estimated from the mean vertical shift of the mean power spectrum 1 m m j 1 y j 2 in the tails of the distribution specifically for 2 2 2 1 2 1 we define 2 1 1 m m j 1 y j 2 21 if we choose large enough so that the target signal frequencies are essentially contained in the interval 2 1 2 1 y j 2 j 2 for and this is a robust and unbiased estimation procedure since e j 2 2 by lemma d 1 6 3 empirical moment estimation for dilation mra given the additive noise level the moments of the dilation distribution for dilation mra model 3 can be empirically estimated from the mean and variance of the random variables m y j defined by m y j 2 0 m y j 2 d 24 for integer m 0 more specifically we define the order m squared coefficient of variation by cvm var m y j e m y j 2 25 the following proposition guarantees that for m large the second and fourth moments of the dilation distribution can be recovered from cv 0 cv 1 in fact one could continue this procedure for higher m values i e cvm k 2 1 m 0 will define estimators of the first k 2 even moments of accurate up to o k 2 but for brevity we omit the general case proposition 6 1 assume model 3 and cv 0 cv 1 defined by 24 and 25 then cv 0 2 3 c 4 3 4 o 6 cv 1 4 2 25 c 4 33 4 o 6 proof since y j l j f x t j m y j 2 0 m f 1 j 2 d 2 1 j 0 m 1 j m f 2 d 1 j 1 j m 1 m f where we assume we have choosen large enough so that the target signal frequencies are essentially supported in 2 1 2 1 thus cvm e m y j 2 e m y j 2 e m y j 2 e 1 j 2 m 1 e 1 j m 1 2 1 when m 0 we have cv 0 e 1 j 2 e 1 j 1 2 1 e 1 2 3 2 4 3 5 4 o 5 e 1 2 3 4 o 5 2 1 1 3 2 5 c 4 4 o 6 1 2 c 4 4 o 6 2 1 1 3 2 5 c 4 4 o 6 1 2 2 2 c 4 1 4 o 6 1 1 3 2 5 c 4 4 o 6 1 2 2 3 2 c 4 4 o 6 1 2 3 c 4 3 4 o 6 22 when m 1 we have cv 1 e 1 j 4 e 1 j 2 2 1 e 1 4 10 2 20 3 35 4 o 5 e 1 2 3 2 4 3 5 4 o 5 2 1 1 10 2 35 c 4 4 o 6 1 3 2 5 c 4 4 o 6 2 1 1 10 2 35 c 4 4 o 6 1 6 2 9 10 c 4 4 o 6 1 1 10 2 35 c 4 4 o 6 1 6 2 27 10 c 4 4 o 6 1 4 2 25 c 4 33 4 o 6 we cannot compute cvm exactly but by replacing var e with their finite sample estimators we ob tain an approximate c v m cvm as m motivated by proposition g 1 we thus use c v 0 c v 1 to define estimators of 2 and c 4 4 definition 6 2 assume model 3 and let c v 0 c v 1 be the empirical versions of 25 define the second order estimator of 2 by 2 c v 0 define the fourth order estimators of 2 c 4 4 by the unique positive solution 2 c 4 of c v 0 2 3 c 4 3 4 c v 1 4 2 25 c 4 33 4 for noisy dilation mra model 2 estimating the dilation moments is more difficult we give a proce dure for estimating the moments in the special case t 0 in appendix g empirical moment estimation procedures which are simultaneously robust to translations dilations and additive noise is an important area of future research 6 4 derivatives all derivatives were approximated numerically using finite difference calculations a 6 th order finite dif ference approximation was used for second derivatives and a 4 th order finite difference approximation was used for fourth derivatives this procedure was done on the empirical mean for each representation not the individual signals in fact since the wavelet is known d n d n 2 could be computed analytically and sy j n computed using definition 2 2 thus error due to finite difference approximations could be avoided for wavelet invariant derivatives 6 5 optimization in this section we describe the convex optimization algorithm for computing p s f the power spectrum approximation which best matches the wavelet invariants s f since the wavelet invariants are only computed for 0 we also incorporate zero frequency information into the loss function via p f 0 an approximation of the power spectrum at frequency zero for all of the examples reported in this article the quasi newton algorithm was used to solve an unconstrained optimization problem minimizing the 23 following convex loss function loss g g 2 2 s f 2 g 0 2 p f 0 2 where 2 2 2 1 0 letting g denote the minimizer of the above loss function we then define p s f g 2 theorem 2 4 ensures that when the loss function is defined with the exact wavelet invariants s f it has a unique minimizer corresponding to p f whenever f x r the symmetry of p f ensures that s f f 2 2 and thus it is sufficient to optimize over the nonnegative frequencies and then symmetri cally extend the solution such a procedure ensures the output of the optimization algorithm is symmet ric while avoiding adding constraints to the optimization the algorithm was initialized using the mean power spectrum with additive noise unbiasing only i e ps k 0 the optimization output does depend on various numerical tolerance parameters which were held fixed for all examples remark 6 1 alternatively one can invert the representation by applying a pseudo inverse with tikhonov regularization specifically if f is the matrix defining the wavelet invariants so that sy f p y then one can define p s f f t f i 1 f t s f this procedure however requires careful selection of the hyper parameter and did not work as well as inverting via optimization in our experiments 7 conclusion this article considers a generalization of classic mra which incorporates random dilations in addition to random translations and additive noise and proposes solving the problem with a wavelet invariant representation these wavelet invariants have several desirable properties over fourier invariants which allow for the construction of unbiasing procedures which cannot be constructed for fourier invariants unbiasing the representation is critical for high frequency signals where even small diffeomorphisms cause a large perturbation after unbiasing the power spectrum of the target signal can be recovered from a convex optimization procedure several directions remain for further investigation including extending results to higher dimensions and considering rigid transformations instead of translations such extensions could be especially rele vant to image processing where variations in the size of an object can be modeled as dilations incorpo rating the effect of tomographic projection would also lead to results more directly relevant to problems such as cryo em the tools of the present article although significantly reducing the bias do not allow for a completely unbiased estimator for noisy dilation mra due to the bad scaling of certain intrinsic constants thus an important open question is whether it is possible to define unbiased estimators for noisy dilation mra using a different approach the noisy dilation mra model of this article corresponds to linear diffeomorphisms and constructing unbiasing procedures which apply to more general diffeo morphisms is also an important future direction in addition one can construct wavelet invariants which characterize higher order auto correlation functions such as the bispectrum and future work will inves tigate full signal recovery with such invariants funding this work was supported by the alfred p sloan foundation sloan fellowship fg 2016 6607 to m h the defense advanced research projects agency young faculty award d 16 ap 00117 to m h and the 24 national science foundation grant 1620216 and career award 1845856 to m h acknowledgements we would like to thank the reviewers for their detailed comments and insights which greatly improved the manuscript we would also like to thank stephanie hickey for providing useful references on flexible regions of macromolecular structures a wavelet admissibility conditions this appendix describes the wavelet admissibility conditions which are needed for the main results in this article namely propositions 4 2 and 5 1 the wavelet is k admissable if ck r and k k where k 1 2 k i 0 k i k i i p i 1 26 k 1 2 k i 0 k i k i i 2 p i 1 27 for to be k admissable it is sufficient for ck r p i to decay faster than i 1 and 2 2 d see lemma b 1 in appendix b the condition 2 2 d is slightly stronger than the classic admissability condition c 2 d 82 theorem 4 4 when is continuously differentiable 0 0 is sufficient to guarantee c but here we need 1 2 for some 0 as 0 if this condition is removed we are not guaranteed k but all results in fact still hold with k k f 21 replacing k k f 21 k f 21 2 in propositions 4 2 and 5 1 any wavelet with fast decay satisfies this stronger admissibility condition and it ensures that a smooth signal will enjoy a fast decay of wavelet invariants remark a 1 the morlet wavelet x g x e i x c is k admissable for any k since c r p has fast decay and as 0 one can also choose to be an order k 1 spline of compact support b properties of wavelet invariants this appendix establishes several important properties of wavelet invariants lemma b 1 gives sufficient conditions guaranteeing that a wavelet is k admissable lemmas 4 3 and 4 4 bound wavelet invariant derivatives lemma b 2 bounds terms which arise in the dilation unbiasing procedure of sections 4 2 and 5 lemma b 1 k admissable if ck r p i decays fast than i 1 and 2 2 d then is k admissable proof we first note that ck r guarantees p ck r since p i decays faster than i 1 and p ck r i p i l 1 r for 0 i k so k also p ck r and i p i l 1 r implies i 2 p i l 1 r for 2 i k in addition 2 p l 1 r by assumption thus to conclude k it only remains to show 1 p l 1 r since p is continuous and decays faster than 2 only the integrability around the origin needs to be verified we note that 2 2 d and p continuous implies p 1 for some 0 as 0 thus p as 0 so that 1 p 1 the function is thus integrable around the origin since 1 1 25 lemma 4 3 low frequency bound assume p cm r and f l 1 r then the quantity m s f m can be bounded uniformly over all specifically m s f m m f 21 for m defined in 26 proof let g p 2 and let g 1 g 2 utilizing definition 2 2 we obtain m s f m 1 2 f 2 m d m d m g d expanding the derivative gives m d m d m g cm 0 g cm 1 g cm 2 2 g cm m m g m cm i 1 m m i m i utilizing f f 1 and g i 1 i 1 g i one obtains m s f m m i 0 cm i 2 f 2 i g i d f 21 m i 0 cm i 2 i g i d f 21 m i 0 cm i 2 i g i d f 21 m i 0 cm i 2 i g i 1 m f 21 lemma 4 4 high frequency bound for differentiable functions assume p cm r and f l 1 r then the quantity m s f m can be bounded by m s f m m 2 f 21 for m defined in 27 proof recall from the proof of lemma 4 3 that m s f m m i 0 cm i 2 f 2 i g i d 26 where g 1 g 2 and cm i 1 m m i m i since f f 1 and g i 1 i 1 g i we obtain m s f m m i 0 cm i 2 f 2 i 2 g i d f 21 m i 0 cm i 2 i 2 g i d f 21 2 m i 0 cm i 2 i 2 g i d f 21 2 m i 0 cm i 2 i 2 g i 1 m 2 f 21 lemma b 2 assume p f c 0 r and is m admissable and let bm e m m be as defined in 13 15 26 27 then 1 2 f 2 bm m m d md m 2 d e m m where m f 21 m f 21 m 2 proof from the proof of lemma 4 3 1 2 f 2 m d md m 2 d m f 21 from the proof of lemma 4 4 1 2 f 2 m d md m 2 d m f 21 2 utilizing bm e m gives 1 2 f 2 bm m m d md m 2 d e m f 21 m f 21 m 2 the following corollary is obtained from lemma b 2 when f is a dirac delta function corollary b 1 assume is m admissable and let bm e m be as defined in 13 15 26 then 1 2 bm m m d md m 2 d e m m 27 c ps and wavelet invariant equivalence this appendix contains supporting results for demonstrating the equivalence of the power spectrum and wavelet invariants lemma 2 1 establishes that wavelet invariants uniquely determine any bandlimited l 2 function as long as the wavelet satisfies the linear independence condition 2 3 and a mild integrabil ity condition proposition 2 5 gives two criteria which are sufficient to guarantee condition 2 3 finally lemma c 1 establishes that the morlet wavelet satisfies condition 2 3 lemma 2 1 let p l 2 r be continuous and assume p p has compact support and condi tion 2 3 then p 2 d 0 0 p 0 a e proof since p is continuous there exists an 0 such that on 0 one either has p 0 p 0 or p 0 claim one must have p 0 suppose not and without loss of generality assume p 0 on 0 and that the support of 2 is contained in the interval 1 2 now choose 0 small enough so that 0 2 is supported on 2 i e 0 2 clearly there must exist a subset m 2 of positive measure such that 0 2 0 on m then 0 0 p 0 2 d 2 p 0 2 d m p 0 2 d 0 we conclude m p 0 2 d 0 but this is impossible since the integrand is strictly positive on m we thus conclude that p 0 on 0 thus it is sufficient to only consider frequencies assume p 2 d 0 for all since p p p 2 d 0 p 2 d p 2 d p 2 i 0 where i we now define 2 2 for some 0 and observe that 0 p 2 d 0 0 p 2 r 2 d 0 p 2 i 2 d 0 note 0 p 2 i 2 d 0 p 2 i p 2 i d 0 i p 1 1 2 d 1 i p 2 2 2 d 2 d i p 2 i p 1 0 1 2 2 2 d d 1 d 2 we now apply the change of variable i 1 i and let g i p 1 i we obtain 0 1 0 g 2 1 0 g 1 0 1 21 2 2 1 1 2 1 2 2 d d 1 d 2 28 28 now consider the kernel k 1 2 0 1 21 2 2 1 1 2 1 2 2 d note that k is a strictly positive definite kernel function if for any finite sequence i n i 1 in 0 1 the n by n matrix a defined by ai j k i j is strictly positive definite 83 viewing i 2 i 1 i 2 as functions of we see that ai j i j r and a is thus a gram matrix since the i are linearly independent if and only if the i 2 are linearly independent and the i 2 are linearly independent by assumption we can conclude that a and thus k are strictly positive definite now consider the corresponding integral operator on 0 1 k g 2 1 0 g 1 k 1 2 d 1 since l 1 r 2 and thus 2 are continuous and k will thus be continuous as long as it remains bounded to check boundedness we observe that k 1 2 2 k 1 1 k 2 2 84 and k 0 1 4 1 4 d 0 1 4 1 2 2 1 4 d 0 1 4 2 2 4 d 2 2 3 0 2 4 d 3 2 3 0 2 4 d 3 2 3 p 22 since has a compact support clearly p 22 and k is thus bounded on the compact interval 0 1 as long as 3 2 since k is continuous and 0 1 is compact k l 2 0 1 l 2 0 1 is a compact self adjoint operator and by mercer s theorem k is also strictly positive definite 83 since k g g 0 1 0 by 28 we conclude g 0 in l 2 0 1 thus p 1 0 for almost every 0 1 which implies p 0 for almost every since p p and p 0 on 0 p 0 for al most every r proposition 2 5 the following are sufficient to guarantee condition 2 3 i 2 has a compact support contained in the interval a b where a and b have the same sign e g complex analytic wavelets with compactly supported fourier transform ii 2 c r and there exists an n such that all derivatives of order at least n are nonzero at 0 e g the morlet wavelet 29 proof let i n i 1 be a finite sequence of distinct positive frequencies and let i 1 i 2 de note the corresponding functions of first assume i without loss of generality we assume that a b is a positive interval and that 2 0 on a a for some 0 clearly 2 2 a simple calculation shows that the support of i is contained in the interval i b i a and i 0 in a neighborhood of ia assume we have or dered the i so that 1 n 0 now suppose c 1 1 cn n 0 note 1 is the only function in the above collection with support in a neighborhood of 1 a thus we must have c 1 0 so that c 2 2 cn n 0 but now 2 is the only function in the above collection with support in a neighborhood of 2 a so we must have c 2 0 and proceeding iteratively we conclude that c 1 cn 0 thus i ni 1 is a linearly independent set and condition 2 3 holds now assume ii since d n d n 2 0 2 d n d n 2 0 2 is c r and all deriva tives of order at least n are nonzero at 0 note i ni 1 1 i 2 ni 1 are linearly in dependent if and only if i 2 ni 1 are linearly independent defining 1 this holds if and only if i 2 ni 1 g i ni 1 are linearly independent as functions of where we define g 2 assume c 1 g 1 c 2 g 2 cn g n 0 differentiating m times for n m n n 1 we obtain c 1 n 1 g n 1 cn nn g n n 0 c 1 n n 1 1 g n n 1 1 cn n n 1 n g n n 1 n 0 the above holds for all we now take the limit as 0 to obtain g n 0 n 1 c 1 n 2 c 2 nn cn 0 g n 1 0 n 11 c 1 n 12 c 2 n 1 n cn 0 g n n 1 0 n n 11 c 1 n n 12 c 2 n n 1 n cn 0 since g m 0 6 0 we obtain n 1 n n n 11 n 1 n n n 11 n n 1 n c 1 c 2 cn 0 0 0 1 1 1 n n 1 1 n 1 n a n 1 0 0 0 n 2 0 0 0 nn b c 1 c 2 cn 0 0 0 30 since a is a vandermonde matrix constructed from distinct i det a 6 0 since the i are nonzero det b 6 0 thus det ab det a det b 6 0 we conclude ab is invertible and so all ci 0 which gives condition 2 3 lemma c 1 suppose we construct a morlet wavelet with parameter that is x c 1 4 e x 2 2 e i x e 2 2 for c 1 e 2 2 e 3 2 4 1 2 then for almost all r the wavelet satisfies condition 2 3 proof the fourier transform has form c e 2 2 e 1 for some constant c depending on so that g c 2 2 e 2 e 1 2 from direct calculation or a computer algebra system cas one obtains g n 0 hn 2 hn 2 n oddhn 2 hn 2 1 n 2 n n 2 n even where hn is the n th degree physicist s hermite polynomial we have g 0 0 but for n 1 g n 0 0 only when is a root of the above polynomial since the set of roots of the polynomials g n 0 n 1 is countable if is selected at random from r it is not a root of any of these polynomials with probability 1 and g n 0 6 0 for all n thus the wavelet satisfies criterion ii of proposition 2 5 and thus the linear independence condition 2 3 d supporting results classic mra this appendix contains supporting results for section 3 the first two lemmas lemmas d 1 and lemma d 2 establish additive noise bounds for the power spectrum and are needed to prove proposition 3 1 the next two lemmas lemmas d 3 and lemma d 4 establish additive noise bounds for wavelet invari ants and are needed to prove propostion 3 2 lemma d 1 let x be a white noise processes on 12 12 with variance 2 then for all frequencies e 2 2 29 e 4 3 4 30 e 2 2 3 4 31 proof by proposition j 1 e 2 e e 1 2 1 2 e i x dbx 1 2 1 2 e i x dbx 2 1 2 1 2 d x 2 31 which shows 29 by proposition j 2 e 4 e 2 2 e 1 2 1 2 e i x dbx 2 1 2 1 2 e i x dbx 2 2 4 1 2 1 2 d x 2 4 1 2 1 2 e 2 i x d x 1 2 1 2 e 2 i x d x 2 4 4 1 2 1 2 e 2 i x d x 1 2 1 2 e 2 i x d x 3 4 which shows 30 finally by proposition j 3 we have e 2 2 e 1 2 1 2 e i x dbx 1 2 1 2 e i x dbx 1 2 1 2 e i x dbx 1 2 1 2 e i x dbx 4 1 2 1 2 e i x d x 1 2 1 2 e i x d x 4 1 2 1 2 e i x d x 1 2 1 2 e i x d x 1 2 1 2 d x 1 2 1 2 d x 4 3 1 2 1 2 d x 1 2 1 2 d x 3 4 which gives 31 lemma d 2 let x be a white noise processes on 12 12 with variance 2 then for any signal f l 1 r e p f p f 2 var p f 4 2 p f 2 4 proof since e e 0 and e 2 2 by lemma d 1 e p f e f f e f 2 f f 2 p f 2 we now control var p f note that p f 2 f 2 f f 2 2 and that e 2 e 1 2 1 2 e i x dbx 1 2 1 2 e i s dbs 1 2 1 2 e i p dbp 0 32 since even when x s p e bx 3 0 ignoring the terms with zero expectation we thus get e p f 2 e f 4 4 f 2 2 4 f 2 2 2 f 2 e f 4 6 f 2 2 4 p f 2 6 2 p f 3 4 where the last line follows from lemma d 1 thus var p f e p f 2 e p f 2 p f 2 6 2 p f 3 4 p f 2 2 4 2 p f 2 4 proposition 3 1 assume model 1 define the following estimator of p f p f 1 m m j 1 p y j 2 then with probability at least 1 1 t 2 p f p f 2 t p m f 1 11 proof let f t j x f x t j so that y j f t j j we first note since f t j e i t j f the power spectrum is translation invariant that is p f t j p f for all t j thus by lemma d 2 e p y j e p f t j j p f t j 2 p f 2 and var p y j var p f t j j 4 2 p f t j 2 4 4 2 p f 2 4 since the y j are independent var 1 m m j 1 p y j 1 m 4 2 p f 2 4 applying chebyshev s inequality to the random variable x 1 m m j 1 p y j we obtain p 1 m m j 1 p y j p f 2 t 2 p f p 2 2 p m 1 t 2 observing that p f f f 1 gives 11 lemma d 3 let x be a white noise processes on 12 12 with variance 2 then e s 2 e s 2 3 4 33 proof since e 2 2 by lemma d 1 we have e s e 22 e 1 2 22 e 1 2 2 2 d 2 2 2 d 2 22 2 since by lemma d 1 e 2 2 3 4 we also have e s 2 e 42 e 1 2 2 22 22 e 1 2 2 2 2 2 2 d d 3 4 2 2 2 2 d d 3 4 22 2 3 4 lemma d 4 let x be a white noise processes on 12 12 with variance 2 then for any signal f l 1 r e s f s f 2 var s f 4 2 s f 2 4 proof utilizing e e 0 and lemma d 3 we have e s f e f u 2 du f u 2 e u 2 du s f e s s f 2 to bound e s f 2 note that s f 2 f u 1 2 u 1 f u 1 f u 1 u 1 u 1 2 du 1 f u 2 2 u 2 f u 2 f u 2 u 2 u 2 2 du 2 34 when we take expecation any term involving one or three terms disappear so that e s f 2 e f u 1 2 f u 2 2 du 1 du 2 f u 1 2 u 2 2 du 1 du 2 u 1 f u 1 u 2 f u 2 du 1 du 2 u 1 f u 1 f u 2 u 2 du 1 du 2 f u 1 u 1 u 2 f u 2 du 1 du 2 f u 1 u 1 f u 2 u 2 du 1 du 2 u 1 2 f u 2 2 du 1 du 2 u 1 2 u 2 2 du 1 du 2 e f u 1 2 f u 2 2 du 1 du 2 6 f u 1 2 u 2 2 du 1 du 2 u 1 2 u 2 2 du 1 du 2 e s f 2 6 s f s s 2 s f 2 6 2 s f 3 4 where the last line follows from lemma d 3 thus var s f e s f 2 e s f 2 s f 2 6 2 s f 3 4 s f 2 2 4 2 s f 2 4 proposition 3 2 assume model 1 define the following estimator of s f s f 1 m m j 1 sy j 2 then with probability at least 1 1 t 2 s f s f 2 t p m f 1 12 proof let f t j x f x t j so that y j f t j j we first note that the wavelet invariants are translation invariant that is s f t j s f for all t j we now compute the mean and variance of the coefficients sy j by lemma d 4 e sy j e s f t j j s f t j 2 s f 2 35 and var sy j var s f t j j 4 2 s f t j 2 4 4 2 s f 2 4 since the y j are independent var 1 m m j 1 sy j 1 m 4 2 s f 2 4 applying chebyshev s inequality to the random variable x 1 m m j 1 sy j gives p 1 m m j 1 sy j s f 2 t 2 s f p 2 2 p m 1 t 2 by young s convolution inequality s f f 22 f 21 22 f 21 which gives 12 e supporting results dilation mra this appendix contains the technical details of the dilation unbiasing procedure which is central to propositions 4 1 4 2 and 5 1 lemma 4 1 bounds the bias and variance of the estimator and lemma 4 2 bounds the error of the estimator given m independent samples lemma 4 1 let f l 1 for some function l ck 2 0 and a random variable satisfying the assumptions of section 2 1 and let k 2 be an even integer assume there exist functions i r r r r r such that i l i i for 0 i k 2 k 2 1 k 2 r and define the following estimator of l g f b 2 2 f b 4 4 f 4 bk k f k then g satisfies eg l kr k 2 2 e k 2 var g k 2 r 2 2 where 2 0 i j k 2 i j 2 i j 2 e i j and e is the absolute constant defined in 15 proof we taylor expand f about 0 f f 0 f 0 f 0 2 2 f k 1 0 k 1 k 1 0 f k 2 t k 1 t k 1 d t r 0 36 we note e f f 0 f 0 2 2 f k 0 k ck k e r 0 which motivates an unbiasing with the first k 2 even derivatives and thus a taylor expansion of these derivatives f f 0 f 0 f k 1 0 k 1 k 1 0 f k 2 t k 1 t k 1 d t r 0 f f 0 f 3 0 f k 1 0 k 1 k 1 0 f k 2 t k 1 t k 1 d t r 2 f 4 f 4 0 f 5 0 f k 1 0 k 3 k 3 0 f k 2 t k 3 t k 3 d t r 4 f k f k 0 f k 1 0 0 f k 2 t t d t rk multiplication of the i th even derivative by bi i gives f f 0 f 0 f k 1 0 k 1 k 1 r 0 b 2 2 f b 2 2 f 0 b 2 2 f 3 0 b 2 2 f k 1 0 k 1 k 1 b 2 2 r 2 b 4 4 f 4 b 4 4 f 4 0 b 4 4 f 5 0 b 4 4 f k 1 0 k 3 k 3 b 4 4 r 4 bk k f k bk k f k 0 bk k f k 1 0 bk k rk we want an estimator that targets f 0 l we thus consider the following variable as an estimator g f b 2 2 f b 4 4 f 4 bk k f k and show that e g f 0 o k 2 for constants bi chosen according to 13 we have e f f 0 f 0 c 2 2 2 f k 0 ck k k e r 0 e b 2 2 f f 0 b 2 2 f 4 0 b 2 c 2 2 4 f k 0 b 2 ck 2 k 2 k e b 2 2 r 2 e b 4 4 f 4 f 4 0 b 4 4 f 6 0 b 4 c 2 2 6 f k 0 b 4 ck 4 k 4 k e b 4 4 r 4 e bk 2 k 2 f k 2 f k 2 0 bk 2 k 2 f k 0 bk 2 c 2 2 k e bk 2 k 2 rk 2 e bk k f k f k 0 bk k e bk k rk 37 that is e g f 0 f 0 c 2 2 b 2 2 f 4 0 c 4 4 b 2 c 2 2 b 4 4 f 6 0 c 6 6 b 2 c 4 4 b 4 c 2 2 b 6 6 f k 0 ck k b 2 ck 2 k 2 bk 2 c 2 2 bk k h 1 where h 1 e r 0 b 2 2 r 2 bk k rk since 13 guarantees that b 2 c 2 2 b 4 c 4 4 c 2 2 2 b 6 c 6 6 c 2 c 4 2 4 c 4 4 c 2 2 2 c 2 2 bk ck k b 2 ck 2 k 2 bk 2 c 2 2 the coefficients of 2 4 k vanish and we obtain e g f 0 h 1 first we bound the bias h 1 in the remainder of the proof we let b 0 1 to simplify notation so that h 1 i 0 2 k bi ri i we first obtain a bound for bi ri i note k 1 i i ri i 0 f k 2 t t k 1 i d t i 0 k 2 l k 2 1 t t k 1 i d t we observe that 1 t k 2 l k 2 1 t k 2 1 t k 2 l k 2 1 t 1 1 t k 2 k 2 1 t k 2 k 2 k 2 l k 2 1 t r k 2 1 t k 2 38 so that r k 2 1 t k 2 k 2 l k 2 1 t r k 2 1 t k 2 now assume first of all that is positive we have k 1 i i ri i r k 2 0 t k 1 i 1 t k 2 d t i r k 2 0 k 1 i 1 t k 2 d t i k 1 i r k 2 1 k 1 1 1 k 1 1 2 k 2 r k 1 i k 2 i k 2 where the last line follows since 1 1 k 1 2 2 k 1 for 0 12 a similar argument can be applied when is negative and we can conclude bi i ri 2 k 2 r k 1 k 1 i k 2 bi i k 2 i 32 which gives e bi i ri 2 k 2 r k 1 k 1 i k 2 t k 2 i bi k 2 2 k 2 k 2 i r k 1 k 2 t k 2 i k 2 i bi k 2 we thus obtain e g l h 1 r k 2 k 1 2 e k 2 i 0 2 k k 2 i r k k 2 2 e k 2 which establishes the bound on the bias we now bound the variance we note g i 0 2 k j 0 1 k 1 i bi j f i j 0 i j i i 0 2 k bi ri i ii thus var g e g 2 e g 2 e i i 2 e i ii e ii ii f 0 2 2 f 0 h 1 h 1 2 e i i f 0 2 a 2 e i ii 2 f 0 h 1 b e ii ii c and we proceed to bound each term i i f 0 2 i 0 2 k 0 2 k k 1 i j 0 k 1 s 0 bi b j f i j 0 f s 0 i j s 1 e 39 where 1 e is an indicator function indicating that i j s are not all zero we have e bi b j f i j 0 f s 0 i j s bi b j c j s i j s i j s bi b j t j t s i j s i j s e i j e s i j s i j s i j e i j s e s noting that only terms where j s is even survive expectation and letting i i j and s we obtain e i i f 0 2 i 0 2 k 0 2 k k 1 i j 0 k 1 s 0 i j 4 t i j s 4 t s 1 e 1 j s even k 1 i 0 k 1 0 c i i e i e for coefficients c i such that c 0 0 0 c i 0 if i is odd and c i k 2 thus e i i f 0 2 k 2 2 i 2 k 2 i even i e i k 2 2 next we bound e ii ii ii ii i 0 2 k 0 2 k bi b ri r i utilizing equation 32 we have bi b ri r i 22 k 4 r 2 bi b k 1 2 k 1 i k 1 k 2 2 i 2 k 4 i which gives e bi b ri r i 22 k 4 r 2 t 2 k 4 i bi b k 1 2 k 1 i k 1 k 2 2 2 k 4 r 2 k 2 i k 2 k 1 2 t k 2 i bi k 2 i t k 2 b k 2 k 2 2 2 2 k 4 r 2 k 2 i k 2 k 1 2 k 2 2 2 e 2 k 4 so that e ii ii r 2 k 1 2 k 2 2 2 e 2 k 4 i 0 2 k 0 2 k k 1 i k 2 k 2 r 2 k 2 2 2 e 2 k 4 k 2 r 2 2 40 finally we bound the cross term 2 e i ii 2 f 0 h 1 i ii i 0 2 k k 1 i j 0 0 2 k bi j f i j 0 i j b r 33 since f i j 0 i j and b r 2 k 2 r b k 1 k 1 k 2 k 2 from 32 we have bij f i j 0 i j b r 2 k 2 r bi b k 1 j k 1 i j k 2 i k 2 j so that e bij f i j 0 i j b r 2 k 2 r t k 2 j bi b k 1 j k 1 i j k 2 i j k 2 2 k 2 r k 2 k 1 t j bi j t k 2 b k 2 i j k 2 i j k 2 r k 2 k 1 e i j i j 2 e k 2 k 2 the same bound holds for the terms of f 0 h 1 which arise from i 0 j 0 in 33 so that 2 e i ii 2 f 0 h 1 i 0 2 k k 1 i j 0 e i j i j 0 2 k r k 2 k 1 2 e k 2 k 2 k k 1 i 0 i e i kr 2 e k 2 k 2 k 2 r k 1 i 0 i k 2 2 e i k 2 k 2 r 2 thus var g k 2 r 2 2 and the lemma is proved lemma 4 2 let the assumptions and notation of lemma 4 1 hold and let 1 m be independent define l 1 m m j 1 g j then with probability at least 1 1 t 2 l l kr k 2 2 e k 2 t p m proof by lemma 4 1 and the independence of the j we have l e l kr k 2 2 e k 2 var l 1 m k 2 2 41 so by chebyshev s inequality we can conclude that with probability at least 1 1 t 2 we have l e l tkr p m which gives l l l e l e l l kr k 2 2 e k 2 tkr p m f supporting results noisy dilation mra this appendix contains supporting results needed to prove proposition 5 1 which defines a wavelet in variant estimator for noisy dilation mra lemma 5 1 controls the additive noise error and lemma 5 2 controls the cross term error lemma f 1 guarantees that the dilation unbiasing procedure applied to the additive noise still has mean 2 which is needed to prove lemma 5 1 lemma 5 1 let the notation and assumptions of proposition 5 1 hold and let a be the operator defined in 23 then with probability at least 1 1 t 2 1 m m j 1 1 2 j 2 a 2 d 2 2 t p k 2 p m proof let d j 1 2 j 2 a 2 d by lemma d 1 e j 2 2 and we thus obtain e d j e 1 2 j 2 a 2 d e 1 2 j 2 2 d 1 2 j 2 b 2 2 2 d d 2 2 d 1 2 j 2 bk k k d d k 2 d 2 1 2 2 d b 2 2 2 2 d d 2 2 d bk k 2 k d d k 2 d 2 1 0 0 2 where we have used lemma f 1 to conclude m d m d m 2 d 0 for m 2 k also since a 1 an 2 n a 21 a 2 n by the cauchy schwarz inequality we obtain e d j 2 e k m 0 2 k bm m 2 j 2 m d m d m 2 d 2 42 where we let d d 0 2 denote 2 and b 0 1 by lemma d 1 we have e j 2 j 2 3 4 for all frequencies so that e bm m 2 j 2 m d m d m 2 d 2 e b 2 m 2 m 4 2 j 2 j 2 m d md m 2 m d md m 2 d d 3 4 1 2 bm m m d md m 2 d 2 3 4 2 m e 2 m where the last line follows from corollary b 1 in appendix b we thus obtain e d j 2 k m 0 2 k e bm m 2 j 2 m d m d m 2 d 2 3 k 4 m 0 2 k 2 m e 2 m i so that e d j 2 0 var d j 2 var d j e d j 2 i thus var 1 m m j 1 d j 2 i m so that by chebyshev s inequality with probability at least 1 1 t 2 1 m m j 1 d j 2 t p i p m t p 3 k m 0 2 k m e m 2 p m 2 t p k 2 p m lemma 5 2 let the notation and assumptions of proposition 5 1 hold and let a be the operator defined in 23 then with probability at least 1 1 t 2 1 m m j 1 1 2 f j j f j j a 2 d tpm 0 proof we have 1 m m j 1 1 2 f j j f j j a 2 d 1 m m j 1 y j y j where y j 1 2 f j j a 2 d 43 the random variable y j has randomness depending on both j and j note that e y j e e y j j since y j is integrable thus since e j 0 we obtain e y j j 0 which yields e y j 0 we also have var y j e y 2 j e 1 2 f j j a 2 d 2 e 1 2 f j 2 a 2 d 1 2 j 2 a 2 d e 1 2 f j 2 a 2 d e 1 2 j 2 a 2 d letting b 0 1 and applying lemma b 2 we have e 1 2 f j 2 a 2 d e m 0 2 k 1 2 f j 2 bm m m d md m 2 d e m 0 2 k e m f j 21 m f j 21 m 2 m 0 2 k e m f 21 m 4 f 21 m 2 4 m 0 2 k e m m 0 since j 12 guarantees f j 1 1 1 j f 1 2 f 1 also e 1 2 j 2 a 2 d e m 0 2 k 1 2 j 2 bm m m d md m 2 d 2 m 0 2 k 1 2 bm m m d md m 2 d 2 m 0 2 k e m m 2 where the second line follows from lemma d 1 in appendix d and the next to last line from corollary b 1 in appendix b we thus have e y j 0 var y j 2 0 and an identical argument can be applied to the y j so that by chebyshev s inequality with probability at least 1 1 t 2 1 m m j 1 y j y j 1 m m j 1 y j 1 m m j 1 y j tp 0 pm 44 lemma f 1 assume is k admissable then m d m d m 2 d 0 34 for all 1 m k proof we recall that since is k admissable 2 ck r and to simplify notation we let g 2 and g 1 g 2 we first establish that k d d k g d d k 1 d d k 1 g k 1 k 1 d d k 1 g 35 the proof is by induction when k 1 we obtain lhs of eqn 35 d d 1 g 2 g 1 g g g and rhs of eqn 35 d d g g g so the base case is established we now assume that equation 35 holds and show it also holds for k 1 replacing k by the inductive hypothesis d d k g d d 1 d d k 1 g k 1 1 d d k 1 g d d k 1 g d d 1 d d k g d d k 1 g 2 k 1 1 d d k g d d k 1 g 2 d d 1 d d k g k 1 1 d d k g d d 2 d d k 1 g k 1 2 d d k 1 g 1 d d k g by inductive hypothesis d d 1 d d k g k 1 d d k g so that k 1 d d k 1 g d d k d d k g k k d d k g thus 35 is established we now use integration by parts to show 35 implies 34 in the lemma the proof of 34 is once again by induction when k 1 we have already shown d d g g g 36 45 integration by parts gives g d g g d g d note g vanishes at since g l 1 r guarantees g l 1 r and thus g must decay faster that 1 utilizing 36 g g d 0 d d g d 0 and the base case is established we now assume k 1 d d k 1 g d 0 by integrating equation 35 we obtain k d d k g d d d k 1 d d k 1 g d k 1 k 1 d d k 1 g d 0 by induc hypo d d k 1 d d k 1 g d k 1 d d k 1 g d 0 by induc hypo k 1 d d k 1 g k 1 d d k 1 g d 0 by induc hypo 0 we are guaranteed k 1 d d k 1 g vanishes at since in the proof of lemma 4 3 we showed k 1 d d k 1 g k 1 j 0 c j j g j and j g j l 1 r implies j 1 g j vanishes at g moment estimation for noisy dilation mra in this appendix we outline a moment estimation procedure for noisy dilation mra model 2 in the special case t 0 i e signals are randomly dilated and subjected to additive noise but are not translated this procedure is a generalization of the method presented in section 6 3 given the additive noise level the moments of the dilation distribution can be empirically esti mated from the mean and variance of the random variables m y j defined by m y j 2 0 m y j d 37 for integer m 0 to account for the effect of additive noise on the above random variables we define gm 2 0 2 0 2 2 m m sin 12 d d 38 and an order m additive noise adjusted squared coefficient of variation by cvm var m y j gm e m y j 2 39 46 remark g 1 if the noisy signals are supported in n 2 n 2 instead of 12 12 38 is replaced with gm n 2 0 2 0 2 2 m m sin n 2 d d the following proposition mirrors proposition 6 1 for dilation mra its proof appears at the end of appendix g proposition g 1 assume model 2 with t 0 and cv 0 cv 1 defined by 37 38 and 39 then cv 0 2 3 c 4 3 4 o 6 cv 1 4 2 25 c 4 33 4 o 6 once again we cannot compute cvm exactly but by replacing var e with their finite sample estima tors we obtain approximations c v m which can be used to define estimators of the dilation moments definition g 2 assume model 3 with t 0 and c v 0 c v 1 the empirical counterparts of 39 define the second order estimator of 2 by 2 c v 0 define the fourth order estimators of 2 c 4 4 by the unique positive solution 2 c 4 of c v 0 2 3 c 4 3 4 c v 1 4 2 25 c 4 33 4 as m the second order moment estimator is accurate up to o 4 and the fourth order moment estimators are accurate up to o 6 however in the finite sample regime the gm appearing in 39 will be replaced with gm o 2 p m so that the estimators given in definition g 2 are subject to an error of order o 2 p m more generally the additive noise fluctuations imply that to estimate the first k 2 even moments of up to an o k 1 error will require 2 p m k 1 or m 4 2 k 1 having established an empirical moment estimation procedure for noisy dilation mra when t 0 we repeat the simulations of section 5 2 on the restricted model but estimate the additive and dilation moments empirically since accurately estimating the moments of is difficult for large we make three modifications to the oracle set up first we lower the additive noise level by a factor of 2 from the oracle simulations and consider all parameter combinations resulting from 2 5 2 4 giving snr 9 0 2 2 and 0 06 0 12 secondly we take m substantially larger than for the oracle simultions with 16 384 m 370 727 thirdly we compute wsc k 4 only for large dilations for large dilations 2 c 4 4 are approximated with fourth order estimators while for small dilations 2 is approximated with a second order estimator see definition g 2 results are shown in figure 7 and the same overall behavior observed in the oracle simulations for large m holds the additive noise level was estimated empirically as described in section 6 2 for the medium and high frequency signal wsc k 2 has substantially smaller error than both ps k 0 and wsc k 0 for the large frequency signal the error is decreased by at least a factor of 2 for large dilations and a factor of 4 for small dilations relative to both zero order estimators when wsc k 4 is defined it has a smaller error than wsc k 2 for the high frequency signal while wsc k 2 is preferable for the low and medium frequency signal we observe that for the oracle simulations wsc k 4 is preferable for all frequencies so this is most likely due to error in the moment estimation degrading the wsc k 4 es timator for the low frequency signal ps k 0 once again achieves the smallest error for small dilations while for large dilations the higher order wavelet methods appear to surpass ps k 0 for m large enough 47 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 a f 1 snr 9 0 0 06 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 b f 2 snr 9 0 0 06 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 c f 3 snr 9 0 0 06 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 d f 1 snr 9 0 0 12 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 e f 2 snr 9 0 0 12 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 f f 3 snr 9 0 0 12 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 g f 1 snr 2 2 0 06 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 h f 2 snr 2 2 0 06 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 i f 3 snr 2 2 0 06 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 j f 1 snr 2 2 0 12 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 k f 2 snr 2 2 0 12 14 14 5 15 15 5 16 16 5 17 17 5 18 8 7 5 7 6 5 6 5 5 5 4 5 4 3 5 3 l f 3 snr 2 2 0 12 figure 7 l 2 error with standard error bars for noisy dilation mra model t 0 empirical moment estimation first second third column shows results for low medium high frequency signals all plots have the same axis limits 48 proof of proposition g 1 since y j l j f j we have e m y j e 2 0 m f j j d e 2 0 m f j d e 2 0 m f 1 j d e 2 1 j 0 m 1 j m f d 1 j m f e 1 j m 1 we now compute the variance we first establish that gm e 2 0 m j d 2 0 m j d by thm 4 5 of 85 e j j e 1 2 1 2 e i t dbt 1 2 1 2 e i t dbt 2 1 2 1 2 e i t d t 2 2 sin 12 so that e 2 0 j d 2 0 j d 2 0 2 0 m me j j d d 2 0 2 0 m m 2 2 sin 12 d d gm we thus obtain m y j 2 e 2 0 m f j j d 2 0 m f j j d e 2 0 m f 1 j d 2 0 m f 1 j d 2 0 m j d 2 0 m j d e 1 j 2 m 1 m f m f gm m f 2 e 1 j 2 m 1 gm 49 thus var m y j gm e m y j 2 gm e m y j 2 m f 2 e 1 j 2 m 1 m f 2 e 1 j m 1 2 dividing by e m y j 2 gives cvm e 1 j 2 m 1 e 1 j m 1 2 1 and the remainder of the proof is identical to the proof of proposition 6 1 h additional simulations for noisy dilation mra we investiagte the l 2 error of estimating the power spectrum using ps k 0 and wsc k 0 2 4 for three additional high frequency functions f 4 x 1 175 cos 32 x 1 x 0 2 0 2 f 5 x 0 299 exp 0 04 x 2 cos 30 x 1 5 x 2 f 6 x 2 304 cos 35 x sinc 3 x the multiplicative constants were chosen so that the l 2 norms of f 4 f 5 f 6 are comparable with the l 2 norms of the gabor signals f 1 f 2 f 3 defined in section 4 4 the signal f 4 is not continuous and has com pact support with a slowly decaying oscillating fourier transform given by f 4 0 47 sinc 0 2 32 sinc 0 2 32 the signal f 5 is a linear chirp with a constantly varying instantaneous frequency the signal f 6 is slowly decaying in space with a discontinuous fourier transform of compact support given by f 6 0 384 1 38 32 1 32 38 implementation details were as described in section 6 and simulations were run with oracle moment estimation on the full model parameter values as described in section 5 2 figure 8 shows the l 2 error as for the high frequency gabor in section 5 2 wsc k 2 and wsc k 4 significantly outperformed the zero order estimators in addition for large dilations the wsc k 4 outperformed wsc k 2 on f 4 and f 6 i expectation maximization algorithm for noisy dilation mra in this appendix we discuss how the expectation maximization em algorithm proposed in 22 can be extended to solve noisy dilation mra we first summarize the em framework which differentiates between observed data y y j mj 1 latent variables s s j mj 1 and model parameters x the goal is to produce the x which maximizes the marginalized likelihood function p y x p y s x d s maximizing p y x directly is generally not tenable because enumerating the various values for s is too costly however em algorithms can be used to find local maxima of the above function by iterating be tween estimating the conditional distribution of latent variables given the current estimate of parameters 50 6 8 10 12 14 16 4 5 4 3 5 3 2 5 2 1 5 1 0 5 a f 4 snr 2 2 0 06 6 8 10 12 14 16 8 7 6 5 4 3 2 1 b f 5 snr 2 2 0 06 6 8 10 12 14 16 4 3 5 3 2 5 2 1 5 1 0 5 c f 6 snr 2 2 0 06 6 8 10 12 14 16 4 5 4 3 5 3 2 5 2 1 5 1 0 5 d f 4 snr 2 2 0 12 6 8 10 12 14 16 8 7 6 5 4 3 2 1 e f 5 snr 2 2 0 12 6 8 10 12 14 16 4 3 5 3 2 5 2 1 5 1 0 5 f f 6 snr 2 2 0 12 6 8 10 12 14 16 4 5 4 3 5 3 2 5 2 1 5 1 0 5 g f 4 snr 0 56 0 06 6 8 10 12 14 16 8 7 6 5 4 3 2 1 h f 5 snr 0 56 0 06 6 8 10 12 14 16 4 3 5 3 2 5 2 1 5 1 0 5 i f 6 snr 0 56 0 06 6 8 10 12 14 16 4 5 4 3 5 3 2 5 2 1 5 1 0 5 j f 4 snr 0 56 0 12 6 8 10 12 14 16 8 7 6 5 4 3 2 1 k f 5 snr 0 56 0 12 6 8 10 12 14 16 4 3 5 3 2 5 2 1 5 1 0 5 l f 6 snr 0 56 0 12 figure 8 l 2 error with standard error bars for noisy dilation mra model oracle moment estimation first second third column shows results for f 4 f 5 f 6 all plots for the same signal have the same axis limits 51 e step and estimating parameters given the current estimate of the conditional distribution of latent variables m step specifically the iterative procedure updates xk the current estimate of x by q x xk es y xk log p y s x e step 40 xk 1 arg max x q x xk m step 41 since under certain conditions log p y x improves at least as much as q at each iteration 41 the algorithm converges to a local maximum of p y x this framework can be applied to noisy dilation mra and explicit formulas for both the e step and m step can be derived assume for simplicity that signals have been discretized to have length n and that the translation distribution t and dilation distribution are unkown and also discrete with n possible values t n 1 q nq 1 respectively letting x f t denote the parameters s j t j j denote the latent nuisance variables and px denote conditioning on x the likelihood function has form p y s x px y s px s m j 1 1 2 2 n 2 exp 1 2 2 l j tt j f y j 22 t t j j thus up to a constant the log likelihood has form log p y s x m j 1 1 2 2 l j tt j f y j 22 m j 1 log t t j m j 1 log j 42 given the current estimate xk f k kt k of parameters the e step is performed by first computing the conditional distribution of the latent variables w q j k p t j t j q xk c j k exp 1 2 2 l j tt j f k y j 22 kt t k q 43 where c j k is a normalizing constant so that q w q j k 1 these weights are then used to compute q that is by combining 40 42 and 43 q f t f k kt k m j 1 n 1 n q 1 w q j k 1 2 2 l j tt j f y j 22 log t t log q 44 up to a constant the m step is then computed by f k 1 k 1 t k 1 arg max f t q f t f k kt k 45 since f t all appear in distinct sums in 44 performing the maximization in 45 is straightforward since l j tt j f y j 22 11 q f t 1 l 1 y j 22 it is easy to check that f k 1 1 c m j 1 n 1 n q 1 w q j k 1 q t 1 l 1 y j c m j 1 n 1 n q 1 w q j k 1 q 46 using lemma 15 in 22 one can also obtain closed form expressions for the updates to kt k k 1 t t w k w k for w k j q w q j k k 1 q v q k q v q k for v q k j w q j k 52 note when a discrete signal defined on some fixed grid is dilated its dilation is defined on a different grid thus computing 43 and 46 will involve off grid interpolation a subtlety not arising in classic mra and this interpolation may contribute additional error we also note that one can always force the translation distribution to be uniform by retranslating the signals uniformly and in this case all sums over in this section could be eliminated this would improve the computational complexity of the al gorithm but may be disadvantageous in terms of sample complexity as in classic mra a uniform trans lation distribution requires a larger sample size for accurate estimation than an aperiodic translation distribution 22 j supporting results stochastic calculus this appendix contains several stochastic calculus results which are used to control the statistics of the additive noise proposition j 1 is a simple generalization of thm 4 5 of 85 proposition j 2 controls the second moment of the stochastic quantity in proposition j 1 and is in fact a special case of proposition j 3 both propositions j 2 and j 3 are proved with standard techniques from stochastic calculus and for brevity we omit the proofs proposition j 1 assume t 0 f t 2 d t t 0 f t 2 d t and let bt be a brownian motion with vari ance 2 then e t 0 f t dbt t 0 f t dbt 2 t 0 f t f t d t proposition j 2 let f t be a bounded and continuous complex deterministic function on 0 t and let bt be a brownian motion with variance 2 then for a fixed nonrandom time t we have e t 0 f t dbt 2 t 0 f t dbt 2 2 4 t 0 f t 2 d t 2 4 t 0 f t 2 d t t 0 f t 2 d t corollary j 1 when f t is real the above reduces to e t 0 f t dbt 4 3 4 t 0 f t 2 d t 2 proposition j 3 let f t g t be bounded and continuous complex deterministic functions on 0 t and let bt be a brownian motion with variance 2 then for a fixed nonrandom time t we have e t 0 f t dbt t 0 f t dbt t 0 g t dbt t 0 g t dbt 4 t 0 f t g t d t t 0 f t g t d t t 0 f t g t d t t 0 f t g t d t t 0 f t 2 d t t 0 g t 2 d t references 1 douglas l theobald and phillip a steindel optimal simultaneous superpositioning of multiple structures with missing data bioinformatics 28 15 1972 1979 2012 2 robert diamond on the multiple simultaneous superposition of molecular structures by rigid body transformations protein science 1 10 1279 1287 1992 3 sjors hw scheres mikel valle rafael nu ez carlos os sorzano roberto marabini gabor t her man and jose maria carazo maximum likelihood multi reference refinement for electron mi croscopy images journal of molecular biology 348 1 139 149 2005 53 4 brian m sadler and georgios b giannakis shift and rotation invariant object reconstruction using the bispectrum josa a 9 1 57 69 1992 5 wooram park charles r midgett dean r madden and gregory s chirikjian a stochastic kine matic model of class averaging in single particle electron microscopy the international journal of robotics research 30 6 730 754 2011 6 wooram park and gregory s chirikjian an assembly automation approach to alignment of noncir cular projections in electron microscopy ieee transactions on automation science and engineer ing 11 3 668 679 2014 7 richard m leggett darren heavens mario caccamo matthew d clark and robert p davey nanook multi reference alignment analysis of nanopore sequencing data quality and error pro files bioinformatics 32 1 142 144 2015 8 j portegies zwart ren van der heiden sjoerd gelsema and frans groen fast translation invariant classification of hrr range profiles in a zero phase representation iee proceedings radar sonar and navigation 150 6 411 418 2003 9 roberto gil pita manuel rosa zurera p jarabo amores and francisco l pez ferreras using mul tilayer perceptrons to align high range resolution radar signals in international conference on arti ficial neural networks pages 911 916 springer 2005 10 benjamin sonday amit singer and ioannis g kevrekidis noisy dynamic simulations in the pres ence of symmetry data alignment and model reduction computers mathematics with applica tions 65 10 1535 1557 2013 11 hassan foroosh josiane b zerubia and marc berthod extension of phase correlation to subpixel registration ieee transactions on image processing 11 3 188 200 2002 12 lisa gottesfeld brown a survey of image registration techniques acm computing surveys csur 24 4 325 376 1992 13 dirk robinson sina farsiu and peyman milanfar optimal registration of aliased images using variable projection with applications to super resolution the computer journal 52 1 31 42 2007 14 alberto bartesaghi alan merk soojay banerjee doreen matthies xiongwu wu jacqueline ls milne and sriram subramaniam 2 2 resolution cryo em structure of galactosidase in complex with a cell permeant inhibitor science 348 6239 1147 1151 2015 15 devika sirohi zhenguo chen lei sun thomas klose theodore c pierson michael g rossmann and richard j kuhn the 3 8 resolution cryo em structure of zika virus science 352 6284 467 470 2016 16 tamir bendory nicolas boumal chao ma zhizhen zhao and amit singer bispectrum inversion with application to multireference alignment ieee transactions on signal processing 66 4 1037 1050 2017 17 joachim frank three dimensional electron microscopy of macromolecular assemblies visualization of biological molecules in their native state oxford university press 2006 18 afonso bandeira philippe rigollet and jonathan weed optimal rates of estimation for multi reference alignment arxiv preprint at arxiv 1702 08546 2017 54 19 amelia perry jonathan weed afonso bandeira philippe rigollet and amit singer the sample complexity of multi reference alignment siam journal on mathematics of data science 1 3 497 517 2017 20 afonso s bandeira ben blum smith joe kileel amelia perry jonathan weed and alexander s wein estimation under group actions recovering orbits from invariants arxiv preprint arxiv 1712 10163 2017 21 alexander spence wein statistical estimation in the presence of group actions phd thesis mas sachusetts institute of technology 2018 22 emmanuel abbe tamir bendory william leeb jo o m pereira nir sharon and amit singer mul tireference alignment is easier with an aperiodic translation distribution ieee transactions on in formation theory 65 6 3565 3584 2018 23 nir sharon joe kileel yuehaw khoo boris landa and amit singer method of moments for 3 d sin gle particle ab initio modeling with non uniform distribution of viewing angles inverse problems 36 4 044003 2020 24 cos sorzano jr bilbao castro y shkolnisky m alcorlo r melero g caffarena fern ndez m li g xu r marabini and jm carazo a clustering approach to multireference alignment of single particle projections in electron microscopy journal of structural biology 171 2 197 206 2010 25 chao ma tamir bendory nicolas boumal fred sigworth and amit singer heterogeneous multiref erence alignment for images with application to 2 d classification in single particle reconstruction ieee transactions on image processing 29 1699 1710 2019 26 nicolas boumal tamir bendory roy r lederman and amit singer heterogeneous multireference alignment a single pass approach in 2018 52 nd annual conference on information sciences and systems ciss pages 1 6 ieee 2018 27 boris landa and yoel shkolnisky multi reference factor analysis low rank covariance estimation under unknown translations arxiv preprint arxiv 1906 00211 2019 28 amit singer angular synchronization by eigenvectors and semidefinite programming applied and computational harmonic analysis 30 1 20 36 2011 29 nicolas boumal nonconvex phase synchronization siam journal on optimization 26 4 2355 2377 2016 30 amelia perry alexander s wein afonso s bandeira and ankur moitra message passing algorithms for synchronization problems over compact groups communications on pure and applied mathe matics 71 11 2275 2322 2018 31 yuxin chen and emmanuel j cand s the projected power method an efficient algorithm for joint alignment from pairwise differences communications on pure and applied mathematics 71 8 1648 1714 2018 32 afonso s bandeira nicolas boumal and amit singer tightness of the maximum likelihood semidefinite relaxation for angular synchronization mathematical programming 163 1 2 145 167 2017 55 33 yiqiao zhong and nicolas boumal near optimal bounds for phase synchronization siam journal on optimization 28 2 989 1016 2018 34 afonso s bandeira synchronization problems and alignment topics in mathematics of data sci ence lecture notes massachusetts institute of technology 2015 35 afonso bandeira yutong chen roy r lederman and amit singer non unique games over compact groups and orientation estimation in cryo em inverse problems 2020 36 afonso s bandeira moses charikar amit singer and andy zhu multireference alignment using semidefinite programming in proceedings of the 5 th conference on innovations in theoretical com puter science pages 459 470 acm 2014 37 yuxin chen leonidas j guibas and qi xing huang near optimal joint object matching via convex relaxation in proceedings of the 31 st international conference on machine learning volume 32 of proceedings of machine learning research pages 100 108 2014 38 afonso s bandeira nicolas boumal and vladislav voroninski on the low rank approach for semidefinite programs arising in synchronization and community detection in conference on learning theory pages 361 382 2016 39 lars peter hansen large sample properties of generalized method of moments estimators econo metrica journal of the econometric society pages 1029 1054 1982 40 zvi kam the reconstruction of structure from electron micrographs of randomly oriented particles in electron microscopy at molecular dimensions pages 270 277 springer 1980 41 arthur p dempster nan m laird and donald b rubin maximum likelihood from incomplete data via the em algorithm journal of the royal statistical society series b methodological 39 1 1 22 1977 42 nicha c dvornek fred j sigworth and hemant d tagare subspaceem a fast maximum a posteriori algorithm for cryo em single particle reconstruction journal of structural biology 190 2 200 214 2015 43 ali punjani john l rubinstein david j fleet and marcus a brubaker cryosparc algorithms for rapid unsupervised cryo em structure determination nature methods 14 3 290 2017 44 wb collis pr white and jk hammond higher order spectra the bispectrum and trispectrum mechanical systems and signal processing 12 3 375 394 1998 45 martina palamini anselmo canciani and federico forneris identifying and visualizing macro molecular flexibility in structural biology frontiers in molecular biosciences 3 47 2016 46 wendell a lim the modular logic of signaling proteins building allosteric switches from simple binding domains current opinion in structural biology 12 1 61 68 2002 47 diana ekman sa k bj rklund johannes frey sk tt and arne elofsson multi domain proteins in the three kingdoms of life orphan domains and other unassigned regions journal of molecular biology 348 1 231 243 2005 48 michael levitt nature of the protein universe proceedings of the national academy of sciences 106 27 11079 11084 2009 56 49 federico forneris jin wu and piet gros the modular serine proteases of the complement cascade current opinion in structural biology 22 3 333 341 2012 50 gregory d bowman and michael g poirier post translational modifications of histones that influ ence nucleosome dynamics chemical reviews 115 6 2274 2295 2015 51 renee desjarlais and peter j tummino role of histone modifying enzymes and their complexes in regulation of chromatin biology biochemistry 55 11 1584 1599 2016 52 robert k mcginty and song tan recognition of the nucleosome by chromatin factors and enzymes current opinion in structural biology 37 54 61 2016 53 seth a villarreal and phoebe l stewart cryoem and image sorting for flexible protein dna com plexes journal of structural biology 187 1 76 83 2014 54 niels fischer piotr neumann andrey l konevega lars v bock ralf ficner marina v rodnina and holger stark structure of the e coli ribosome ef tu complex at 3 resolution by c s corrected cryo em nature 520 7548 567 570 2015 55 xiao chen bai eeson rajendra guanghui yang yigong shi and sjors hw scheres sampling the conformational space of the catalytic subunit of human secretase elife 4 e 11182 2015 56 rafael fernandez leiro julian conrad sjors hw scheres and meindert h lamers cryo em struc tures of the e coli replicative dna polymerase reveal its dynamic interactions with the dna sliding clamp exonuclease and elife 4 e 11134 2015 57 alan merk alberto bartesaghi soojay banerjee veronica falconieri prashant rao mindy i davis rajan pragani matthew b boxer lesley a earl jacqueline ls milne et al breaking cryo em resolu tion barriers to facilitate drug discovery cell 165 7 1698 1707 2016 58 harold omer and bruno torr sani estimation of frequency modulations on wideband signals applications to audio signal analysis arxiv preprint arxiv 1305 3095 2013 59 harold omer and bruno torr sani time frequency and time scale analysis of deformed stationary processes with application to non stationary sound modeling applied and computational har monic analysis 43 1 1 22 2017 60 adrien meynard and bruno torr sani spectral analysis for nonstationary audio ieee acm trans actions on audio speech and language processing 26 12 2371 2380 2018 61 maureen clerc and st phane mallat the texture gradient equation for recovering shape from tex ture ieee transactions on pattern analysis and machine intelligence 24 4 536 549 2002 62 maureen clerc and st phane mallat estimating deformations of stationary processes the annals of statistics 31 6 1772 1821 2003 63 vinod chandran and stephen l elgar position rotation and scale invariant recognition of images using higher order spectra in icassp 92 ieee international conference on acoustics speech and signal processing volume 5 pages 213 216 ieee 1992 64 l capodiferro r cusani g jacovitti and m vascotto a correlation based technique for shift scale and rotation independent object identification in icassp 87 ieee international conference on acoustics speech and signal processing volume 12 pages 221 224 ieee 1987 57 65 michail k tsatsanis and georgios b giannakis translation rotation and scaling invariant object and texture classification using polyspectra in advanced signal processing algorithms architec tures and implementations volume 1348 pages 103 115 international society for optics and pho tonics 1990 66 kazuhiro hotta taketoshi mishima and takio kurita scale invariant face detection and classifi cation method using shift invariant features extracted from log polar image ieice transactions on information and systems 84 7 867 878 2001 67 daniel martinec and tomas pajdla robust rotation and translation estimation in multiview recon struction in 2007 ieee conference on computer vision and pattern recognition pages 1 8 ieee 2007 68 st phane mallat group invariant scattering communications on pure and applied mathematics 65 10 1331 1398 october 2012 69 michael eickenberg georgios exarchakis matthew hirn and st phane mallat solid harmonic wavelet scattering predicting quantum molecular energy from invariant descriptors of 3 d elec tronic densities in advances in neural information processing systems 30 nips 2017 pages 6540 6549 2017 70 michael eickenberg georgios exarchakis matthew hirn st phane mallat and louis thiry solid harmonic wavelet scattering for predictions of molecule properties journal of chemical physics 148 241732 2018 71 matthew hirn st phane mallat and nicolas poilvert wavelet scattering regression of quantum chemical energies multiscale modeling and simulation 15 2 827 863 2017 arxiv 1605 04654 72 joan bruna and st phane mallat multiscale sparse microcanonical models mathematical statistics and learning 1 3 4 257 315 2018 73 feng gao guy wolf and matthew hirn geometric scattering for graph data analysis in proceed ings of the 36 th international conference on machine learning pmlr volume 97 pages 2122 2131 2019 74 tamir bendory nicolas boumal william leeb eitan levin and amit singer multi target detection with application to cryo electron microscopy inverse problems 2019 75 amit singer mathematics for cryo electron microscopy in proceedings of the international congress of mathematicians volume 4 pages 4013 4032 rio de janeiro 2018 76 scott hudson and demetri psaltis correlation filters for aircraft identification from radar range profiles ieee transactions on aerospace and electronic systems 29 3 741 748 1993 77 yariv aizenbud boris landa and yoel shkolnisky rank one multi reference factor analysis arxiv preprint arxiv 1905 12442 2019 78 wenchang sun phaseless sampling and linear reconstruction of functions in spline spaces arxiv preprint arxiv 1709 04779 2017 79 cheng cheng junzheng jiang and qiyu sun phaseless sampling and reconstruction of real valued signals in shift invariant spaces journal of fourier analysis and applications pages 1 34 2017 58 80 jorge buescu and ac paix o eigenvalue distribution of positive definite kernels on unbounded domains integral equations and operator theory 57 1 19 41 2007 81 tamir bendory alberto bartesaghi and amit singer single particle cryo electron microscopy mathematical theory computational challenges and opportunities ieee signal processing mag azine pages 58 76 march 2020 82 st phane mallat a wavelet tour of signal processing third edition the sparse way academic press 3 rd edition 2008 83 joab winkler and mahesan niranjan uncertainty in geometric computations number 704 springer science business media 2002 84 jorge buescu ac paixao f garcia and i lourtie positive definiteness integral equations and fourier transforms the journal of integral equations and applications pages 33 52 2004 85 fima c klebaner introduction to stochastic calculus with applications world scientific publishing company 2012 59 1 introduction 1 1 notation 2 mra models and the method of invariants 2 1 mra data models 2 2 method of invariants 2 2 1 motivation and related work 2 2 2 wavelet invariants 3 unbiasing for classic mra 4 unbiasing for dilation mra 4 1 power spectrum results for dilation mra 4 2 wavelet invariant results for dilation mra 4 3 comparison 4 4 simulation results for dilation mra 5 noisy dilation mra model 5 1 wavelet inariant results for noisy dilation mra 5 2 simulation results for noisy dilation mra 6 numerical implementation 6 1 signal generation and snr 6 2 empirical estimation of additive noise level 6 3 empirical moment estimation for dilation mra 6 4 derivatives 6 5 optimization 7 conclusion a wavelet admissibility conditions b properties of wavelet invariants c ps and wavelet invariant equivalence d supporting results classic mra e supporting results dilation mra f supporting results noisy dilation mra g moment estimation for noisy dilation mra h additional simulations for noisy dilation mra i expectation maximization algorithm for noisy dilation mra j supporting results stochastic calculus