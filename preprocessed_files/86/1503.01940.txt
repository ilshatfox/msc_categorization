space time models based on random fields with local interactions dionissios t hristopulos and ivi c tsantili geostatistics laboratory school of mineral resources engineering technical university of crete chania 73100 greece september 19 2018 abstract the analysis of space time data from complex real life phenomena re quires the use of flexible and physically motivated covariance functions in most cases it is not possible to explicitly solve the equations of motion for the fields or the respective covariance functions in the statistical litera ture covariance functions are often based on mathematical constructions we propose deriving space time covariance functions by solving effective equations of motion which can be used as statistical representations of systems with diffusive behavior in particular we propose using the linear response theory to formulate space time covariance functions based on an equilibrium effective hamiltonian the effective space time dynamics are then generated by a stochastic perturbation around the equilibrium point of the classical field hamiltonian leading to an associated langevin equa tion we employ a hamiltonian which extends the classical gaussian field theory by including a curvature term and leads to a diffusive langevin equation finally we derive new forms of space time covariance functions keywords fluctuation dissipation theorem interpolation simulation space time system maximum entropy 1 introduction covariance functions play a significant role in the analysis of space time data with geostatistical and machine learning methods 46 45 7 in inverse mod elling 48 and in data assimilation 34 thus there is active interest in ap plications of space time data analysis and the development of new covariance this manuscript is a preprint of an article submitted for consideration in interna tional journal of modern physics b c 2015 copyright world scientific publishing company http www worldscientific com worldscinet ijmpb dionisi mred tuc gr corresponding author itsantili isc tuc gr 1 ar x iv 1 50 3 01 94 0 v 1 st at m e 6 m ar 2 01 5 models 7 1 space time covariance functions commonly used are straight forward extensions of purely spatial models e g exponential gaussian and constructions based on linear mixtures 39 more complex models are generated using mathematical arguments e g permissibility conditions 40 and simpli fying assumptions such as separability of space and time components without clear physical motivation for the functional form or the parameters several au thors have proposed more realistic non separable covariance models 8 36 9 simple space time covariance models are determined by the variance and con stant correlation length and correlation time in purely spatial cases richer parametric families such as the whittle mate rn covariance model 15 20 or the spartan covariance functions 25 24 27 offer more flexibility the former is derived from a fractional stochastic partial differential equation driven by white noise 53 38 the latter is obtained from a gaussian field theory with a curvature term which also leads to a fourth order stochastic partial differential equation 26 27 there is a long history of ideas from physics that find applications in in formation theory and data analysis including the maximum entropy formalism developed by jaynes 32 more recently the bayesian field theory 37 and machine learning applications of the variational approximation 22 the con nection between statistical physics and space time statistics on the other hand has not been duly appreciated albeit the former can provide useful models for the analysis of space time data in statistical physics the literature on space time fields and correlation functions is extensive 14 for example the gaussian model of classical field theory is equivalent to a gaussian random field with a specific covariance function 35 43 a formal difference between random fields in statistical field theories and those in spatial statistics is that the former are defined by means of local inter actions whereas the latter are defined by means of covariance matrices 5 6 both approaches are formally equivalent provided that the covariance function of the local interaction model can be explicitly expressed the interaction based formalism has several advantages for parameter estimation interpolation and simulation which derive from the sparseness of the inverse covariance ma trix in the local interaction representation 28 50 spartan spatial random fields ssrfs are based on the local interaction framework in the static time independent case ssrfs admit explicit relations for the covariance function in one two and three dimensions 25 24 11 10 27 a similar framework was independently proposed by farmer 12 more recently covariance functions similar to ssrf were derived for meteorological applications from polynomials of the diffusion operator 58 56 in statistical physics a coarse grained hamiltonian determines the relative probabilities of different field configurations for near equilibrium systems ex cursions from equilibrium leading to dynamic fluctuations follow by perturbing the system with noise the dynamic response of the system is determined by a stochastic partial differential equation also known as langevin equation which can be derived in the framework of linear response theory 18 the correlation functions are shown to obey the fluctuation dissipation theorem which connects 2 them to respective susceptibility functions 42 in physics this approach has been applied to study dynamic critical phenomena 23 47 the physical insight provided by the the fluctuation dissipation theorem is that the fluctuations of the unperturbed system contain information about the response to external perturbations that drive the system away from equilibrium this formalism to our knowledge has not been applied to generate space time covariance functions our goal in this paper is to show that effective hamiltonians with local interactions which are successfully used in spatial data analysis can be extended to space time random fields this contribution is part of an ongoing effort to transfer ideas from statistical physics to space time data analysis 25 26 10 24 28 27 using the theory of linear response we show that the local interaction framework leads to explicit forms for new space time covariance functions the remainder of the paper is structured as follows in section 2 we present mathematical background on gaussian random fields section 3 reviews local interaction random fields and demonstrates that the so called spartan spatial random field model is derived from the principle of maximum entropy section 4 briefly presents linear response theory focusing on the calculation of correlation functions in section 5 we use linear response theory to derive equations of motion for space time ssrf covariances and we obtain an explicit equation for the ssrf spectral density section 6 gives a standard derivation of space time covariances from langevin equations this leads to a general equation for the space time covariance function of fields driven by colored noise and recaptures the results of the previous section in the ssrf case with gaussian white noise in section 7 we present explicit equations for ssrf space time covariance functions finally we present our conclusions in section 8 2 mathematical preliminaries in the following we focus on gaussian space time random fields these can be used to model more complicated distributions in the bayesian framework of gaussian random processes 45 a space time random field strf x s t r where s t rd r and is defined as a mapping from the probability space a p into the space of real numbers so that for each fixed coordinate s t x s t is a measurable function of 5 an strf involves by definition many possible states indexed by 5 55 in the following we drop the state index for simplicity instead we use the symbol for the cyclical frequency in fourier transforms the states realizations of the strf are denoted by the real valued scalar functions x s t in the following x s t denotes a functional of the strf x s t that takes unique values for each realization x s t the expectation over the ensemble of strf states is denoted by the angle brackets hence the covariance function is given by cx s t s t x s t x s t x s t x s t 1 3 an strf is called statistically stationary in the weak sense or simply sta tionary for brevity if its expectation is constant and its covariance function depends purely on the spatial and temporal lags r and respectively for simplicity since we aim to calculate space time covariance functions we assume a zero mean strf i e x s t 0 the strf variance will be denoted by 2 furthermore a stationary random field is called statistically isotropic if its covariance function depends only on the euclidean distance but not the direction vector in the following we focus on statistically isotropic strfs in the spectral domain we use the wavevector k to denote the spatial fre quency and to denote the cyclic frequency with respect to time for a given function x s t with space and time dependence we will use x k t to denote the spatial i e with respect to the space variable fourier transform and x k the full fourier transform with respect to both space and time the pairs of the direct and inverse fourier transforms respectively are defined as follows x k t fs x k t rd ds e k r x s t 2 a x s t f 1 k x s t 1 2 d rd dk e k r x k t 2 b x k fs t x k rd ds dt e k r t x s t 2 c x s t f 1 k x s t 1 2 d 1 rd dk d e k r t x k 2 d 3 local interaction random fields time independent random fields represent the long time i e equilibrium con figurations of dynamic variables they also model quenched randomness which characterizes the structure of geological media and is a key factor for subsurface physical processes 5 static random fields can be defined in terms of a pseudo energy functional h x s which assigns different energy levels and subsequently different probabilities to different configurations x s in the following we will assume that the energy functional takes real non negative values the most probable configuration of the spatial random field minimizes h x s the joint probability density function pdf of the equilibrium spatial random field x s is determined from the functional h x s the joint pdf for the realization state x s is proportional to exp h x s i e feq x s 1 z e h x s where the partition function z is given by the following functional inte gral 17 13 z dx s e h x s 4 the functional integral is the continuum limit of the discrete representation dx s limn n i 1 dxi where the vector x 1 xn t represents a dis cretization of the continuum state x s at n points note that whereas z may diverge for n the srf statistical moments are nonetheless well defined for example the covariance is given by the following functional integral x s 1 x s 2 1 z dx s x s 1 x s 2 e h x s 3 in statistical mechanics the h x s for a given system is obtained from kinetic and potential energy terms that reflect the motion and interactions of microscopic constituents in the case of macroscopic random fields x s t the dynamics may not be fully known or solvable then h x s represents an effective functional that incorporates fictitious interactions defined by means of derivatives of the field realizations hence h x s may represent a sufficiently flexible heuristic functional and not a first principles hamiltonian 3 1 maximum entropy formulation of spartan spatial ran dom fields based on the concept of the effective energy functional the spartan spatial random field model was proposed 25 24 28 27 this model is an extension of the classical gaussian field theory 35 which incorporates a square curvature term the respective energy functional is given by hfgc x s 1 2 0 d rd ds x s 2 1 2 x s 2 4 2 x s 2 4 in the above 0 represents a scale coefficient 1 a rigidity coefficient and a characteristic length stands for the gradient and 2 for the laplace differential operator the energy functionalhfgc x s generates gaussian zero mean stationary random fields as in classical field theory a frequency cutoff is required for differentiability of the field states 59 in the absence of such a cutoff the high frequency contributions lead to random fields that are mean square continuous but non differentiable in d 2 3 24 explicit expressions for the covariance functions in d 1 2 3 at the limit of infinite cutoff are derived in 24 27 the use of 4 in spatial data analysis requires the estimation of the coefficients 0 1 and from the data the pdf with energy functional 4 can be derived using the principle of maximum entropy 32 the main idea underlying maximum entropy is that the pdf is determined by maximizing the entropy of the system given constraints imposed by the data furthermore it is assumed that the data constraints are equal to the respective expectations over the pdf 5 let us define the integrals si x s i 0 1 2 by s 0 x s dsx 2 s 5 a s 1 x s ds x s 2 5 b s 2 x s ds 2 x s 2 5 c in addition we assume that the expectations si x s can be estimated from the data if we possess only one realization e g x s the above assump tion requires that the system is ergodic with respect to the constraints i e si x s si x s then the maximum entropy pdf conditional on these constraints is given by feq x s e 0 s 0 x s 1 s 1 x s 2 s 2 x s 6 the constant normalizes the pdf i e z exp whereas the constants i i 0 1 2 are in principle obtained by solving the system of the three equations si x s si x s note that 6 is equivalent to 4 if 0 1 2 0 d 1 1 2 d 2 0 and 2 4 d 2 0 for data sampled on discrete supports the si x s are replaced by dis cretized estimators s i x that involve the sample values x t x 1 x n for example on a regular grid the derivatives are replaced by respective finite differences which thus implement the high frequency cutoff 25 on irregular grids estimators can be constructed using kernel functions 10 51 then the estimation of the model parameters is reduced to the solution of the following moment equations s 0 x dx 1 dxn s 0 x e 0 s 0 x 1 s 1 x 2 s 2 x 7 a s 1 x dx 1 dxn s 1 x e 0 s 0 x 1 s 1 x 2 s 2 x 7 b s 2 x dx 1 dxn s 2 x e 0 s 0 x 1 s 1 x 2 s 2 x 7 c 4 dynamic correlations if a perturbation drives the system away from the equilibrium and the deviation is small the equilibrium fluctuations determine the non equilibrium response this idea is exploited in statistical mechanics by means of the linear response theory 23 4 1 susceptibility function the theory of linear response focuses on small perturbations of the field x s t around the equilibrium state which are caused by an external field h s t if we 6 define by 0 the expectation over the equilibrium distribution and by the non equilibrium expectation the response of the system to the external field can be expressed as follows in terms of the susceptibility function s s t t and the following convolution equation x s t x s t 0 t dt rd ds s s t t h s t 8 for large perturbations the response should also include nonlinear terms since the difference x s t x s t 0 x s t corresponds to the expectation of the non equilibrium fluctuation eq 8 implies that the suscep tibility is given by the following functional derivative s s t t lim h s t 0 x s t h s t 9 in the above h s t represents the functional derivative which is defined by means of h s t h s t s s t t the limit h s t 0 is taken in order to ensure that nonlinear terms vanish let x k and h k represent the fourier transforms of the strf fluc tuation and the external field which are given by 2 the fourier transform of the susceptibility function is then given by the following limit k lim h 0 x k h k 10 the susceptibility function is used in physical applications to describe the system s response to measurable external fields e g electric or magnetic fields in the analysis of spatial data however the external field does not necessarily represent a physical reality hence the notion of susceptibility has not found wide applicability nevertheless we suggest that there are potential applications of the susceptibility concept since the analysis of spatial fields often involves auxiliary variables 52 which essentially represent external fields for example the elevation is an auxiliary variable that has significant impact on rainfall thus it makes sense to consider the susceptibility of the rainfall field to the elevation of a particular site 4 2 langevin equations within the framework of linear response theory the strf dynamics is derived from the equilibrium energy functional and the noise field that drives deviations from the equilibrium by means of the following langevin equation 31 18 x s t t h x s x s x s x s t s t 11 7 where is a diffusion coefficient x s denotes the functional derivative with respect to the field state and s t is the noise field the latter is typically gaussian white noise with s t 0 and variance equal to d i e s t s t d s s t t 12 equation 11 links the rate of change of the field state x s t to an equilibrium restoring velocity that depends on h x s and a random velocity given by the noise term for example ifh x s is given by the ginzburg landau effective ac tion then 11 is known as the time dependent ginzburg landau equation 35 p 192 in the following we will denote the restoring velocity for a given random field state by v x s h x s x s 13 and v x s t will denote the respective functional of the random field x s t 4 3 fokker planck equation the pdf of the strf x s t that is governed by the langevin equation 11 is the solution of the following fokker planck equation 18 f x s t t rd ds x s t v x s t fx x s t d 2 fx x s t x s t 14 the equilibrium time independent pdf is the asymptotic limit as t of the solution of the above fokker planck equation feq x s exp 2 h x s d 15 the fokker planck equation may not admit an explicit solution however for many applications in spatial data analysis it is sufficient to know the co variance of the random field since the fluctuations often follow the gaussian law whereas in other cases the data can be transformed by means of nonlinear transformations to approximately fit the gaussian law 52 4 4 equation of motion for the covariance to obtain the equation of motion eom for the covariance function we follow the approach described in 42 pp 120 121 first we assume that t t without loss of generality we use the covariance definition 1 we replace the time derivative of x s t with 11 and then replace x s t with the random fields x s t these steps lead to the following equation cx s t s t t v x s t s t x s t 16 8 the right hand side of the above equation involves the term s t x s t the principle of causality however implies that the noise at time t can not in fluence the field at the earlier time t hence noise field cross correlation is dropped and we obtain the following eom for the covariance cx s t s t t v x s t x s t 17 let us now assume that t t then since we can not reason that causality causes the noise field cross correlation to vanish the eom for the covariance will be given by cx s t s t t v x s t x s t s t x s t 18 moreover from 17 the partial derivative of the covariance with respect to t will be given by c s t s t t v x s t x s t 19 next we subtract each side of the equation for cx s t s t t from the respective side of 18 for cx s t s t t at this point we use the stationarity property i e that the covariance is a function only of the lag t t which implies cx s t s t t cx s t s t t these operations lead to the following equation for the covariance rate 2 cx s t s t t v x s t x s t v x s t x s t s t x s t 20 using time and space translation invariance the first two averages on the left hand side cancel each other combining equations 17 18 and 20 we obtain c s t s t t sign t t v x s t x s t 21 4 5 the fluctuation dissipation theorem the fluctuation dissipation theorem links the covariance and the susceptibility functions 23 for t t from 20 it is straightforward that 2 cx s t s t t s t x s t 22 9 the term in the right hand side of can be evaluated by means of the furutsu novikov theorem 16 44 the latter states that if s t is a gaussian process and x s t is a function of x s t then the following identity holds x s t s t ds dt x s t s t s t s t 23 in the present case x s t x s t we use the definition of the sus ceptibility function 9 as a response to the noise field and we take into account the noise covariance 12 then the time derivative of the covariance function is related to the susceptibility function via 2 cx s t s t t d s t s t 24 furthermore for statistically stationary and homogeneous conditions the above equation becomes 2 cx r d r 25 5 ssrf based space time covariance functions below we derive a partial differential equation for the space time covariance function based on the equation of motion 17 we consider a slightly modified form of the spartan energy functional 4 in which the curvature term is mul tiplied by the coefficient 0 in the following we assume an infinite spectral cutoff for the spatial frequency wavenumber we assume that d 2 in line with the relaxation model a of hohenberg and halperin eq 4 2 p 445 in 23 it can then be shown using the properties of functional derivatives and ignoring boundary effects 26 that the spartan energy functional is associated with the following restoring velocity v x s t d 2 d 0 1 1 2 2 4 4 x s t 26 in light of the above restoring velocity and 17 the stationary covariance function is given by the solution of the following equation of motion cx r d sign 1 1 2 2 s 4 4 s cx r 27 where d d 2 d 0 is the combined diffusion coefficient we define by c k the fourier transform of the covariance function over the spatial lag vector this is given by the following d dimensional integral c k fr c k rd dr e k r c r 28 10 the function c k is the spectral density of the covariance at time lag expressing the equation of motion 27 in fourier space we obtain the following spectral counterpart c k d sign 1 1 k 2 2 k 4 4 c k 29 where k k the first order ordinary differential equation 29 admits the following exponentially damped time evolution of the fourier modes c k c k 0 e d 1 1 k 2 2 k 4 4 30 where c k 0 is the covariance spectral density at zero time lag let us assume statistical isotropy of the spectral density at zero time lag i e c k 0 c k 0 then based on the spectral representation the space time covariance function is given in real space by the following one dimensional integral 55 c r r 1 d 2 e d 2 d 2 0 dk c k 0 kd 2 jd 2 1 kr e d 1 k 2 2 k 4 4 31 where jd 2 1 x is the bessel function of the first kind and of order d 2 1 given that the covariance function is stationary the expression 31 also holds for t at zero lag therefore c r 0 should be identical to the spatial covariance function that corresponds to the static energy functional 4 by setting 0 in 31 it follows that the above constraint is satisfied if c k 0 is c k 0 0 d 1 1 k 2 k 4 32 which represents the ssrf spectral density given by 25 slightly modified by the presence of according to bochner s theorem 4 32 is a permissible spectral density if i c k 0 0 and ii dk c k 0 these conditions are trivially satisfied if 1 0 0 and d 3 the space time spectral density s k is defined as the fourier transform of the space time covariance function in the spatial temporal frequency domain i e s k fr c k d rd dr e k r c r 33 the spectral density s k can also be expressed by means of the spectral density of the spatial fluctuations at time lag which was obtained in 30 as follows s k d e c k c k 0 d e e d 1 1 k 2 2 k 4 4 34 11 a b figure 1 space time spectral densities for d 1 a and d 3 b and for 1 1 0 1 3 d 0 5 m 1 12 using the isotropic c k 0 given by 32 and taking into account that the integrand in 34 is even s k is expressed in terms of the following cosine fourier transform s k 2 0 1 1 k 2 2 k 4 4 0 d cos e d 1 1 k 2 2 k 4 4 35 for 1 0 and d 0 the following analytic expression for the the ssrf space time spectrum is obtained using the identity eq 1 4 1 p 14 in 41 eq 1 4 1 p 14 s k 2 0 d d 2 1 1 k 2 2 k 4 4 2 2 36 the above is a permissible spectral density function of the form s k a k 2 where k is an eighth order polynomial this model is more flexible than the one described by the second order mate rn spectral density commonly used in geostatistics in which the respective polynomial k is given by k k 2 2 4 33 in figure 1 the spectral density 36 is plotted for d 1 and d 3 for 1 the spectral density 36 could by used in meteorological modelling as space time extension of purely spatial spectral densities derived by polynomials of the diffusion operator 57 6 covariance function from langevin equation in this section we obtain space time covariances from the equation that governs the motion of the strf realizations based on 11 and 26 the following langevin equation governs the time evolution of the state x s t x s t t v x s t s t 37 where v x s t is the restoring velocity as defined by 13 and s t is the stochastic velocity we assume a bilinear equilibrium energy functional of the form h x s rd ds rd ds x s l s s x s where l s s is the inverse spatial covariance operator defined by means of the convolution integral 54 rd ds 1 l s s 1 c s 1 s s s 13 note that l s s rd 7 r is a real valued and symmetric function i e l s s l s s the restoring velocity is given by v x s t rd ds 1 l s s 1 x s 1 t the langevin equation corresponding to 37 for the spatial fourier modes of the strf is x k t t l k x k t k t where l k r is the inverse spatial covariance operator in fourier space if l is a linear combination of even order derivative operators then l k respectively is a polynomial in k 2 the temporal evolution of the fourier modes is given by the solution of the above ordinary differential equation i e by x k t x k 0 e l k t t 0 dt e l k t t k t 38 the strf spatial spectral density is given by c k t k t x k t x k t c it follows from the above that the temporal evolution of c k t k t is deter mined by the integral equation x k t x k t c e l k t e l k t x k 0 x k 0 c 39 t 0 dt 1 t 0 dt 2 e l k t t 1 e l k t t 2 k t 1 k t 2 where x k 0 x k 0 c is the initial condition at zero time lag if we assume a correlated stochastic velocity with spatial spectral density k t 1 k t 2 2 d 2 d k k c k t 1 t 2 we obtain the following integral equation for the temporal evolution of c k t k t c k t k t e l k t l k t c k 0 k 0 40 2 dd min t t 0 dt 1 e l k t t 1 l k t t 1 k k c k setting t t in 40 we obtain c k t k t e l k l k t c k 0 k 0 41 2 dd k k c k l k l k 1 e l k l k t 14 due to stationary it holds that c k t k t c k t k t for all t and t hence we obtain the following relation for the spatial spectral density at zero time lag c k 0 k 0 lim t c k t k t 2 dd k k c k l k l k 42 combining 40 and 42 the temporal evolution of the spatial spectral density is given by the following exponential relation c k t k t c k 0 k 0 e t t l k t t t t l k t t 43 finally in light of 43 and by invoking the reflection symmetry l k l k we obtain the following equation for the evolution of the space time covariance c s t s t rd dk 2 d rd dk 2 d e k s k s c k t k t 44 d 2 rd dk 2 d e k s s e l k t t c k l k equation 44 holds in general for colored noise and for general l k for the ssrf case the inverse spatial covariance operator l k is given by 27 l k d 2 0 d 1 1 k 2 2 k 4 4 assuming that the stochastic velocity is gaussian white noise i e c k 1 the ssrf covariance c r is given by c r rd dk 2 d e k r 0 d 1 1 k 2 2 k 4 4 e d 2 0 d 1 1 k 2 2 k 4 4 45 based on the above and the spectral representation of isotropic random fields which transforms the multidimensional integral into a one dimensional inte gral 55 we recover 31 derived above 7 explicit space time covariance functions equation 31 is the general result for the space time covariance function ob tained in the framework of linear response theory from the equilibrium local interaction energy functional 4 we use the following integral identity for the spectral density 0 d 1 1 k 2 2 k 4 4 0 d e 1 1 k 2 k 4 0 d 46 15 the above is based on 1 a 0 d e a for a 0 the above leads to a space time covariance function which is given by c r r 1 d 2 e d 2 d 2 0 d 0 dk kd 2 jd 2 1 kr e a k 47 a a k d 1 k 2 2 k 4 4 1 1 k 2 k 4 0 d 47 b we can thus express the space time covariance function in terms of the following double integral c r r 1 d 2 e d 2 d 2 0 d q 48 q 0 dk kd 2 jd 2 1 kr e a k 49 7 1 covariance for the zero curvature model we investigate the space time covariance 47 with 0 in this case the function a k is given by a k 0 d d 1 2 1 2 0 d k 2 50 then the spectral integral 49 can be analytically performed using eq 11 4 28 p 486 2 0 dk e a 2 k 2 k 1 j bk 2 2 a 1 b 2 a 1 f 1 2 1 b 2 4 a 2 51 in the above the 1 f 1 a 1 a 2 z also known as m a 1 a 2 z is the conflu ent hypergeometric function defined by eq 13 1 2 p 504 2 as follows m a 1 a 2 z n 0 a 1 n zn a 2 n n where a 1 n is the rising factorial a 1 n a 1 a 1 1 a 1 n 1 a 0 1 1 we apply the above definition with a 2 d 1 2 1 2 0 d d 2 1 d 2 1 and b r to the integral in 51 based on these replacements 49 and 50 we evaluate the function q as follows q e 0 d 2 ad 2 1 r 2 a d 2 1 1 f 1 d 2 d 2 r 2 4 a 2 52 16 further using the definitions for the hypergeometric function it follows for a 1 a 2 d 2 that m d 2 d 2 z exp z in light of this identity and the function q is given by q rd 2 1 2 d 2 ad e r 2 4 a 2 0 d 53 hence the expression 53 for q and 48 lead to the following univariate integral for the space time covariance function c r e d 4 d 2 0 d e r 2 4 1 2 0 1 2 d 2 54 a where 0 1 0 d 1 d 1 2 2 1 2 0 d 54 b equations 31 and 54 both involve univariate integrals the latter how ever involves a non negative decreasing function of whereas the former in volves the integration of the oscillating bessel function jd 2 1 kr which is more difficult to evaluate numerically especially for large lags 7 1 1 the case of zero spatial lag for r 0 the covariance function 54 is given by the integral c 0 e d 4 2 d 2 0 d e 0 1 2 d 2 55 the integral can be performed using integral tables and more precisely eq 3 362 2 p 362 19 for d 1 eq 3 352 4 p 358 19 for d 2 and eq 3 369 p 363 19 for d 3 which lead to the following expressions c 0 0 2 1 1 erfc d 0 4 1 ei d 2 0 e d d 4 1 3 2 2 0 4 1 3 2 erfc d 56 in the above ei x is the exponential integral function defined by ei x x dt e t t and erfc x is the complementary error function defined by erfc x 2 x dt e t 2 the expansion of ei x around zero is given by ei x ln x k 1 xk k where is the euler mascheroni constant in light of the above and 56 it follows that the time covariance has a singularity at 0 for d 2 3 17 7 1 2 the case of zero time lag for 0 it follows that 1 0 and the covariance function 54 is given by the following integral c r 0 1 4 2 d 2 0 d e r 2 4 2 0 d 2 d 2 0 4 2 d 2 0 0 dy e 2 4 y y yd 2 57 where y 0 and r 0 2 r 1 this integral can be evaluated using the identity 3 471 12 p 385 19 which leads to c r 0 2 d 2 0 4 1 d 2 r 1 1 d 2 kd 2 1 r 1 58 where kd 2 1 is the modified bessel function of the second kind of order d 2 1 for d 1 the covariance function depends on k 1 2 k 1 2 for d 2 it depends on k 0 whereas for d 3 the function k 1 2 is involved in both d 1 and d 3 the behavior of the bessel function near zero is k 1 2 x 1 2 2 2 x 1 2 d 1 3 ln x 2 d 2 hence in light of 58 the spatial covariance has a singularity at r 0 in d 2 3 in agreement with the limit of the time covariance as well this is not surprising since the model described above is identical to the gaussian field theory which is known to have a singular behavior at the origin if a finite cutoff is not used 43 p 227 7 1 3 explicit covariances for general lags for d 1 3 0 it follows from 31 that the corresponding covariances are given by the equations c r e d 0 1 0 dk cos kr 1 1 2 k 2 e d 1 k 2 2 59 and c r e d 0 2 2 1 r 0 dk k sin kr 1 1 2 k 2 e d 1 k 2 2 60 the above integrals can be evaluated analytically for 1 0 applying the identities eq 1 4 15 p 15 41 and eq 2 4 26 p 74 41 the following explicit formulas are derived for the one and three dimensional covariances 18 a b figure 2 space time covariances for a d 1 and b d 3 in both cases 1 1 0 1 3 d 1 in a the minimum lag in both space and time is equal to the floating point relative accuracy whereas in b it is equal to 0 1 to avoid the singularity at 0 0 a b figure 3 space time covariances for d 1 0 1 3 d 1 a covari ances for zero space lag and different 1 are shown b covariances for r 3 and different 1 19 a b figure 4 space time covariances for d 1 0 1 3 d 1 a spatial dependence at 0 b spatial dependence at 3 c r 0 4 1 e r 1 erfc d r 2 d 1 61 e r 1 erfc d r 2 d 1 and c r 0 8 1 r e r 1 erfc d r 2 d 1 62 e r 1 erfc d r 2 d 1 the covariance function 61 is equivalent to a model derived by heine start ing from the general form of a second order stochastic partial differential equa tion 21 33 our result however is expressed in terms of the parameters 0 1 d that can be easily identified with properties of the strf and in clude the ssrf parameters of spatial random fields in particular 0 is an overall scale coefficient that determines the amplitude of the fluctuations and has units x 2 1 is a dimensionless rigidity coefficient that suppresses large gra dients is a characteristic length and d is a characteristic inverse time we also derive the covariance function 62 which is valid in three spatial dimen sions note that the presence of 1 in addition to implies that the correlation length is a function of both parameters 30 in both d 1 and d 3 for r 0 and 0 the purely temporal and purely spatial covariance models respec tively 56 and 58 are recovered from 61 and 62 in agreement with the 20 zero lag analysis the singularity at r 0 and 0 is present for d 3 in 62 this singularity which denotes that the strf has infinite variance is known in gaussian field theory as well as in statistical modelling 33 we discuss a remedy for this problem in the next section in figure 2 we plot the covariance functions 61 and 62 for d 1 and d 3 respectively for d 3 the minimum lags used are equal to 0 1 to avoid the zero lag singularity figures 3 and 4 demonstrate the dependence of the covariance function 61 in d 1 versus the spatial time lag under constant time space lag for different values of the rigidity coefficient 1 note that at the larger lag distances r 3 and 3 the covariance function is smooth at the origin i e for 0 and r 0 respectively in contrast with the non differentiable peak at r 0 0 7 2 small approximation in the following we assume that 1 so that the curvature term in 47 is present but multiplied with a small coefficient this small perturbation how ever is sufficient to tame the singularity at the origin zero lag of the covariance function effectively by reducing the impact of large frequency fluctuations we use the spectral representation 47 for the covariance function the exponential e a k in this case is expressed as follows e a k e 0 u 2 k 2 v k 4 where the coefficients v and u 2 are defined by means of the following relations and the constant coefficients given by 54 b v 4 d 0 u 2 1 2 d 0 63 the exponential component exp v k 4 can be approximated using the taylor expansion truncated at an even order 2 m as follows exp v k 4 2 m m 0 1 m v k 4 m m the even truncation order ensure that the approximation is non negative the divergence of the expansion for large k is controlled by the exponential exp u k 2 for 1 0 therefore the truncated spectral density corresponds to a permissi ble covariance function the resulting expansion of the covariance function 47 is given by the following series of integrals c r r 1 d 2 e d 2 d 2 2 m m 0 m m 0 d vmqm 64 qm e 0 0 dk kd 2 4 m jd 2 1 kr e u 2 k 2 65 21 the integral over k in qm can be evaluated using 51 which leads to qm e 0 u 4 m d r 2 d 2 1 d 2 2 m d 2 1 f 1 2 m d 2 d 2 r 2 4 u 2 66 based on the two equations above the space time covariance function be comes c r 2 e d 4 d 2 2 m m 0 m m d 2 2 m d 2 rm r 67 rm r 0 d e 0 vm u 4 m d 1 f 1 2 m d 2 d 2 r 2 4 u 2 68 in the above the coefficients v and u 2 are defined in 63 whereas the coefficients 0 1 2 are defined in 54 b 7 3 numerical solutions for general values of and 1 the presence of the parameter in the general space time model 31 eliminates the observed singularities at the origin for 0 for 0 and negative values of the rigidity coefficient 1 i e for 2 1 0 the covariance function develops oscillations based on 31 the space time covariances for 6 0 in d 1 3 are given by the following one dimensional integrals c r e d 0 0 dk cos kr 1 1 k 2 2 k 4 4 e d 1 k 2 2 k 4 4 69 c r e d 0 3 2 2 1 0 dk k 2 sinc kr 1 1 k 2 2 k 4 4 e d 1 k 2 2 k 4 4 70 the above integrals were evaluated in mathematica using the nintegrate function with high working precision the spectral integrals were truncated using a finite spectral cutoff i e kc 100 in figures 5 and 6 we plot the spatial dependence of the covariance functions 69 and 70 for d 1 and d 3 respectively plots correspond to different values of and two different time lags in all cases the correlation length drops with increasing moreover it is evident in fig 6 that in the d 3 model has finite values at the origin for 0 figure 7 displays how the covariance function 61 varies in d 1 with r for constant and three negative values of 1 in all cases the covariances obtained exhibit oscillations such functions find applications in hydrology and in wave phenomena 27 in d 3 for negative values of 1 oscillating covariances are obtained by 70 in this case however the negative hole of the oscillations is reduced 22 a 0 2 4 6 8 10 12 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 r c hr 0 l 1 0 2 0 b 0 2 4 6 8 10 12 0 00 0 05 0 10 0 15 0 20 0 25 r c hr 3 l 1 0 2 0 figure 5 space time covariances for d 1 0 1 1 0 5 3 d 1 a spatial dependence at 0 b spatial dependence at 3 a 0 2 4 6 8 0 00 0 05 0 10 0 15 0 20 0 25 0 30 r c hr 0 l 1 0 2 0 b 0 2 4 6 8 0 00 0 05 0 10 0 15 0 20 r c hr 3 l 1 0 2 0 figure 6 space time covariances for d 3 1 0 5 0 1 3 d 1 a spatial dependence at 0 b spatial dependence at 3 a 0 5 10 15 0 2 0 0 0 2 0 4 0 6 0 8 r c hr 0 l 1 5 1 0 5 b 0 5 10 15 0 2 0 0 0 2 0 4 0 6 r c hr 3 l 1 5 1 0 5 figure 7 oscillating space time covariances for d 1 1 3 d 1 a spatial dependence at 0 b spatial dependence at 3 23 8 conclusions the analysis of spatiotemporal data and statistical mechanics have followed to a large extent separate paths in spite of the conceptual overlaps between the two fields the connection between statistical mechanics and geostatistics has been investigated in a series of papers 25 26 24 28 29 27 herein we demonstrate that space time covariance functions for the analysis of spatiotemporal data sets can be obtained using ideas from statistical mechanics such as field theory maximum entropy and linear response theory we show that a gaussian field model with an energy functional to which a curvature term is added can be derived from the principle of maximum en tropy using suitable data based constraints the spatial covariance functions obtained from this energy functional incorporate interactions between the sample locations and they offer increased flexibility due to a richer paramet ric structure 28 30 the equilibrium spatial model is herein extended to the space time domain by means of the covariance equation of motion or the associated langevin equation for the realizations both of which are obtained within the framework of the relaxation approximation in linear response theory the covariance equation of motion provides explicit formulas for the temporal evolution of the spectral density it is also shown that the associated covariance functions in real space involve integrals that can be analytically computed in different approximation regimes the obtained solutions provide new types of non separable space time correlation functions without using simplifying but unrealistic assumptions in contrast with purely statistical models the strf model parameters introduced in this paper correspond to distinct properties of the random field for future investigations flexible representations such as the karhunen loe ve expansion can be used in combination with the langevin equations to obtain compact expressions for space time covariance models the general for mulation for construction of space time covariances based on concepts of statisti cal mechanics can be extended to incorporate more general models described by non linear generalized langevin equations and colored or non gaussian driving noises 3 49 acknowledgment the research presented in this manuscript was funded by the project sparta 1591 development of space time random fields based on local interaction models and applications in the processing of spatiotemporal datasets the project sparta is implemented under the aristeia action of the opera tional programme education and lifelong learning and is co funded by the european social fund and national resources 24 references 1 in e porcu j montero and m schlather editors advances and chal lenges in space time modelling of natural events lecture notes in statis tics springer berlin heidelberg 2012 2 m abramowitz and i a stegun handbook of mathematical functions with formulas graphs and mathematical tables dover new york 9 th dover printing edition 1964 3 g a athanassoulis i c tsantili and z g kapelonis two time response excitation moment equations for a cubic half oscillator under gaussian and cubic gaussian colored excitation part 1 the monostable case arxiv preprint arxiv 1304 2195 2013 4 s bochner lectures on fourier integrals princeton university press princeton nj 1959 5 g christakos random field models in earth sciences academic press san diego 1992 6 n cressie spatial statistics john wiley and sons new york 1993 7 n cressie and c l wikle statistics for spatio temporal data john wiley and sons new york 2011 8 s de iaco d myers and d posa nonseparable space time covariance models some parameteric families mathematical geology 34 1 23 42 2002 9 s de iaco d posa and d myers characteristics of some classes of space time covariance functions journal of statistical planning and inference 143 11 2002 2015 2013 10 s n elogne d hristopulos and e varouchakis an application of spar tan spatial random fields in environmental mapping focus on automatic mapping capabilities serra 22 5 633 646 2008 11 s n elogne and d t hristopulos geostatistical applications of spartan spatial random fields in a soares m j pereira and r dimitrakopou los editors geoenv vi geostatistics for environmental applications vol ume 15 of quantitative geology and geostatistics pages 477 488 springer berlin gemany 2008 12 c l farmer bayesian field theory applied to scattered data interpolation and inverse problems in a iske and j levesley editors algorithms for approximation pages 147 166 springer verlag heidelberg 2007 13 r p feynman and a r hibbs quantum mechanics and path integrals mcgraw hill new york 1965 25 14 d forster hydrodynamic fluctuations broken symmetry and correlation functions addison wesley redwood city calif 1990 15 m fuentes l chen j m davis and g m lackmann modeling and predicting complex spacetime structures and patterns of coastal wind fields environmetrics 16 5 449 464 2005 16 k furutsu on the statistical theory of electromagnetic waves in a fluctu ating medium journal of research of the national institute of standards and technology 67 d 3 303 323 1963 17 i m gel fand and a m yaglom integration in functional spaces and its applications in quantum physics journal of mathematical physics 1 1 48 69 1960 18 n goldenfeld lectures on phase transitions and the renormalization group frontiers in physics 85 addison wesley 1992 19 i s gradshteyn and i m ryzhik tables of integrals series and products academic press new york 5 th edition 1994 20 p guttorp and t gneiting studies in the history of probability and statistics xlix on the matern correlation family biometrika 93 4 989 995 2006 21 v heine models for two dimensional stationary stochastic processes biometrika 42 1 2 170 178 1955 22 m d hoffman d m blei c wang and j paisley stochastic variational inference the journal of machine learning research 14 1 1303 1347 2013 23 p c hohenberg and b i halperin theory of dynamic critical phenomena review of modern physics 49 435 479 1977 24 d hristopulos and s elogne analytic properties and covariance functions of a new class of generalized gibbs random fields ieee transactions on information theory 53 12 4667 4679 2007 25 d t hristopulos spartan gibbs random field models for geostatistical ap plications siam journal of scientific computing 24 6 2125 2162 2003 26 d t hristopulos spatial random field models inspired from statistical physics with applications in the geosciences physica a statistical me chanics and its applications 365 1 211 216 2006 27 d t hristopulos covariance functions motivated by spatial random field models with local interactions stochastic environmental research and risk assessment 29 739 754 2015 26 28 d t hristopulos and s n elogne computationally efficient spatial in terpolators based on spartan spatial random fields ieee transactions on signal processing 57 9 3475 3487 2009 29 d t hristopulos and e porcu multivariate spartan spatial random field models probabilistic engineering mechanics 37 84 92 2014 30 d t hristopulos and m z ukovic relationships between correlation lengths and integral scales for covariance models with more than two parameters stochastic environmental research and risk assessment 25 1 11 19 2011 31 c itzykson and j m drouffe statistical field theory volume 1 cambridge university press new york 1989 32 e t jaynes information theory and statistical mechanics physical re view 106 4 620 630 1957 33 r h jones and y zhang models for continuous stationary space time processes in modelling longitudinal and spatially correlated data pages 289 298 springer 1997 34 e kalnay atmospheric modeling data assimilation and predictability cambridge cambridge 2003 35 m kardar statistical physics of fields cambridge university press 2007 36 a kolovos g christakos d hristopulos and m l serre methods for generating non separable spatiotemporal covariance models with potential environmental applications advances in water resources 27 8 815 830 2004 37 j c lemm bayesian field theory johns hopkins university press baltimore 2005 38 s c lim and l p teo generalized whittle mate rn random field as a model of correlated fluctuations journal of physics a mathematical and theoretical 42 105202 2009 39 c ma linear combinations of space time covariance functions and vari ograms ieee transactions on signal processing 53 3 857 864 2005 40 c ma recent developments on the construction of spatio temporal co variance models stochastic environmental research and risk assessment 22 1 s 39 s 47 2008 41 w magnus h bateman a erde lyi f oberhettinger and f tricomi tables of integral transforms mcgraw hill 1954 27 42 u m b marconi a puglisi l rondonic and a vulpiani fluctua tion dissipation response theory in statistical physics physics reports 461 4 111 195 2008 43 g mussardo statistical field theory oxford univ press 2010 44 e a novikov functionals and the random force method in turbulence theory sov phys jetp 20 5 1290 1294 1965 45 c e rasmussen and c k i williams gaussian processes for machine learning mit press massachusetts institute of technology 2006 46 m l stein spacetime covariance functions journal of the american statistical association 100 469 310 321 2005 47 j swift and p c hohenberg hydrodynamic fluctuations at the convective instability physical review a 15 1 319 1977 48 a tarantola inverse problem theory and methods for model parameter estimation siam philadelphia 2005 49 i s c tsantili two time response excitation theory for non linear stochastic dynamical systems phd thesis national technical university of athens 2013 50 m z ukovic and d t hristopulos environmental time series interpo lation based on spartan random processes atmospheric environment 42 33 7669 7678 2008 51 m z ukovic and d t hristopulos the method of normalized correlations a fast parameter estimation method for random processes and isotropic random fields that focuses on short range dependence technometrics 51 2 173 185 2009 52 h wackernagel multivariate geostatistics springer verlag berlin 3 rd edition 2003 53 p whittle on stationary processes in the plane biometrika 41 3 4 434 449 1954 54 q xu representations of inverse covariances by differential operators advances in atmospheric sciences 22 2 181 198 2005 55 a m yaglom correlation theory of stationary and related random functions i springer verlag new york 1987 56 m yaremchuk and a sentchev multi scale correlation functions associ ated with polynomials of the diffusion operator quarterly journal of the royal meteorological society 138 668 1948 1953 2012 28 57 m yaremchuk and a sentchev multi scale correlation functions associ ated with polynomials of the diffusion operator quarterly journal of the royal meteorological society 138 668 1948 1953 2012 58 m yaremchuk and s smith on the correlation functions associated with polynomials of the diffusion operator quarterly journal of the royal me teorological society 137 660 1927 1932 2011 59 j zinn justin quantum field theory and critical phenomena oxford univ press oxford 4 th edition 2004 29 1 introduction 2 mathematical preliminaries 3 local interaction random fields 3 1 maximum entropy formulation of spartan spatial random fields 4 dynamic correlations 4 1 susceptibility function 4 2 langevin equations 4 3 fokker planck equation 4 4 equation of motion for the covariance 4 5 the fluctuation dissipation theorem 5 ssrf based space time covariance functions 6 covariance function from langevin equation 7 explicit space time covariance functions 7 1 covariance for the zero curvature model 7 1 1 the case of zero spatial lag 7 1 2 the case of zero time lag 7 1 3 explicit covariances for general lags 7 2 small approximation 7 3 numerical solutions for general values of and 1 8 conclusions