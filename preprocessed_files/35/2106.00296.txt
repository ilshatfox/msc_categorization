ar x iv 2 10 6 00 29 6 v 2 m at h a p 7 j an 2 02 2 a separation lemma on sub lattices w m wang abstract we prove that bourgain s separation lemma lemma 20 14 b 2 holds at fixed frequencies and their neighborhoods on sub lattices sub modules of the dual lattice associated with a quasi periodic fourier series in two di mensions and by extension holds on the affine spaces previously bour gain s lemma was not deterministic and is valid only for a set of frequencies of positive measure the new separation lemma generalizes classical lattice partition type results to the hyperbolic lorentzian setting with signature 1 1 1 and could be of independent interest combined with the method in w 2 this should lead to the existence of quasi periodic solutions to the nonlinear klein gordon equation with the usual polynomial nonlinear term up 1 1 introduction and the new separation lemma we consider the nonlinear klein gordon equation nlkg on the d torus t d 0 2 d 1 1 2 u t 2 u u up 1 0 where is the laplacian u d i 1 2 u x 2 i p n and is arbitrary considered as a function on rd u is periodic satisfying u x u x 2 j for all j zd we are interested in solutions which depend quasi periodically periodic with several frequencies on time in the form of a convergent series 1 2 u t x n j zb zd a n j ei n t j x where b corresponds to the number of base frequencies in time is the usual scalar product and rb is the frequency it is convenient to think of u as defined on the torus tb td series of the form 1 2 form a closed set under multiplication so up 1 is also of this form keywords and phrases prime decomposition quasi periodic fourier series sub lattice sub module affine space nonlinear pde 1 http arxiv org abs 2106 00296 v 2 2 w m wang below we write zb d for zb zd seen as the dual lattice to tb td to simplify language we will often say that zb d is the lattice or module our goal in this paper is to derive geometric properties of 1 2 under the action of the linear operator 1 3 l 2 t 2 1 the linear operator l is separable define the wave operator d 1 4 d 1 its spectrum d j 2 1 j zd by using the fourier series in 1 2 and setting t 0 in d 2 the spectrum is degenerate and the spacing of non equal eigenvalues tends to zero operating on the full quasi periodic fourier series 1 2 l leads to a diagonal matrix p on zb d with matrix elements 1 5 p n j p n j n j n 2 j 2 1 n j zb d where for simplicity j 2 stands for j 2 the set of n j such that p n j 1 plays an essential role in solving 1 1 in particular since p 0 solves the linear equation 1 6 2 u t 2 u u 0 we shall start from the linear solutions denote linear solutions by u 0 and let 1 7 u 0 t x b k 1 ake i j 2 k 1 t jk x where jk zd 0 k 1 2 b be such a solution we may write u 0 in the form 1 2 u 0 t x b k 1 ake i j 2 k 1 t jk x b k 1 a ek jk ei ek 0 t jk x where ek k 1 2 b are the canonical basis of z b a ek jk ak and 0 j 2 k 1 bk 1 jk 6 0 3 we are interested in small solutions to 1 1 it is convenient to add 1 to the nonlinear term and write the nlkg as 1 8 2 u t 2 u u up 1 0 we seek u close to u 0 from the structure of the equations 1 7 and 1 8 the sub lattice u zb d generated by the set ek jk bk 1 plays a special role we call it the sub module generated by u 0 writing the left side of 1 8 as f u this is also in view of the functional derivative f u 2 t 2 1 p 1 up which plays a central role in the nonlinear analysis cf w 2 w 1 remark in the process of solving 1 8 0 is replaced by which is contin uously being modulated but it does not change the dual lattice zb d nor the sub lattice sub module u zb d lemma 1 1 on the sub module sub lattice u zb d generated by the set ek jk bk 1 if u and 0 then 0 proof this follows from the property of the generating set ek jk bk 1 let b k 1 ckek if 0 then ck 0 for k 1 2 b so b k 1 ckjk 0 remark the converse is generally not true since in general b d 1 1 the new separation lemma denote by k the set of primes 6 1 that occur in odd powers in the prime decomposition of j 2 k 1 jk 6 0 k 1 2 b assume that k 6 k 1 2 b and k 6 k for k 6 k let s be the set of j 1 j 2 jb zd such that is satisfied and s the set of j 1 j 2 jb zd used in w 2 i e such that 1 j 21 1 j 2 2 1 j 2 b 1 and square free then we have s s 4 w m wang recall that s has positive density from lx so s has at least positive density as well our main result is the following new separation lemma let d 2 and u 0 t x b k 1 ake i j 2 k 1 t jk x be a solution to the linear equation 1 6 assume that is satisfied let 0 1 and b 1 be an integer set 0 rb with 1 there exists a set a 0 a in whose complement is of measure less than such that on a the following holds let r and set x n h zb 2 let u zb 2 be the sub module generated by u 0 consider a sequence a subset xk k 0 u zb 2 satisfying 1 9 xi xi 1 b 1 i assume that for all i 1 i 1 10 ni 2 h 2 i 1 1 and that there exists b 1 such that 1 11 maxm z 2 k hk m 0 k b there exists b 0 0 such that if b b 0 then there exists c 1 and 1 12 bb c for all fixed we note that the lemma holds at 0 and the separation property is stable near 0 this refines bourgain s separation lemma lemma 20 14 b 2 which uses as parameters in two dimensions the new lemma generalizes the classical lattice partition type results to the hyperbolic lorentzian setting with signature 1 1 1 at irrational square root frequencies and is essential to the proof of quasi periodic solutions to 1 1 corollary the new separation lemma holds on the affine spaces u of the module zb 2 for all zb 2 i e the conclusion of the lemma holds with u replacing u for all this is because the proof of the lemma relies only on the differences xi xi 1 i 1 2 5 1 2 the role of separation lemmas we note that the new separation lemma is asymptotic it is applicable for large b this is also the case for lemma 20 14 b 2 chap 20 b 2 deals with parameter dependent wave equa tions and asymptotic properties are sufficient for a proof of quasi periodic solu tions this is also the case in chap 19 for the parameter dependent nonlinear schro dinger equations nls for a fixed equation such as 1 1 however this is not enough we need precise non asymptotic separation properties as well this is provided by lemma 5 2 w 2 which is a separation lemma at small scales valid in arbitrary dimensions d cf the reformulation of lemma 5 2 in sect 2 3 the lack of a separation lemma at large scales was the only reason why in w 2 we were not able to deal with polynomial nonlinearity we expect that the combination of the new separation lemma with lemma 5 2 w 2 will now lead to a proof of quasi periodic solutions to the nlkg in 1 1 remark that this approach is analogous to that used in w 1 for the fixed nls note that quasi periodic solutions to nls are known from the works w 1 pp cf also the earlier related works b 1 b 2 ek but the corresponding problem for nlkg in higher dimensions is significantly more difficult due to the shrinking gaps and the degenerate spectra in particular number theory seeps into the arguments the new lemma proves a separation property on a hyperbolic lorentzian lattice of signature 1 1 1 since most of the lattice partition type results are in the elliptic parabolic setting we believe the lemma is of independent interest aside from its applications to the nlkg in 1 1 so we present it separately this is also because it seems to be a good occasion to elucidate some of the algebraic and geometric structures underlying the approach developed in w 1 w 2 see also the review paper w 3 this paper is self contained the proofs are mostly algebraic and elementary and can be read independently without prior knowledge of nlkg 1 3 ideas of the proof as mentioned above most of the lattice partition type results are on euclidean lattice for example the separated cluster structure of the n 1 n 2 nd zd on the hypersphere n 21 n 2 2 n 2 d r the positive definite signature 1 1 1 played a key role lorentzian lattice deprives us of positivity however in its place one may try to impose certain non zero conditions on quadratic forms given rb for zb d define the operators t from rb d r 1 d to be t t 6 w m wang note that t t 2 2 and is of a form similar to the left side in 2 23 in d 2 for example given two vectors 0 6 6 zb 2 dim 2 one may define the following 2 2 matrix t t t t t t t t t assume or 6 0 lemma 20 23 b 2 proves that dett has a lower bound on a large set of 0 1 b similarly for the 1 1 determinants when dim 1 more generally lemma 20 23 b 2 proves lower bounds on the absolute values of all such determinants on a large set of 0 1 b in arbitrary dimensions d one may view t as an analogue of a gram matrix in the lorentzian setting the lower bounds permit proof of the separation lemma lemma 20 14 b 2 1 4 the new idea for fixed frequencies and their neighborhoods the proof of the new separation lemma hinges on proving lower bounds on dett the obvious difficulty is that unlike in lemma 20 23 b 2 0 is fixed and will not budge however we observe that det t is of the form d det t a k k bkk k k where a bkk z there is no quartic in term due to the wedge product so assume holds d 0 if and only if a bkk 0 for all pairs k and k k k for example when k k 1 2 this leads to two equations and when k k 1 2 3 4 equations in two dimensions this suffices to make variable reductions to reach a contradiction on the sub module u using lemma 1 1 so d 6 0 the result in schm 1 on simultaneous diophantine approximations then gives the desired lower bound subsequently a simple argument gives also a lower bound in the neighborhood of 0 cf the linear case in lemma 5 3 w 2 in three dimensions and above the above strategy to prove d 6 0 meets a difficulty namely there are more unknowns than equations when the have small support for example when d 3 for with less than 6 non zero components for with larger support the same proof works similarly for d 3 we prove the new separation lemma in the next section and conclude by trans lating the separation lemma at small scales lemma 5 2 w 2 into the present language 7 2 proof of the new separation lemma given rb for zb d define the operators t from rb d r 1 d as mentioned before 2 1 t t let 0 k j 2 k 1 for k 1 2 b and assume is satisfied below we specialize to d 2 2 1 non zero generalized gram determinants at 0 lemma 2 1 for 0 6 u zb 2 when 0 2 2 t t 2 2 6 0 and 2 3 t t 2 2 6 0 proof eq 2 2 clearly holds for non zero when 6 0 and when 0 using 6 0 and the rational independence of k k 1 2 b set d t t if has two or more non zero components d contains one or more irrational terms using the rational independence of 1 k k k k k k 1 2 b gives d 6 0 if has only one non zero component without loss say 1 then on the sub module 1 j 1 so d 21 2 1 21 j 21 21 6 0 we proceed to the 2 2 matrices lemma 2 2 assume zb 2 dim 2 and dim 1 when 0 the 2 2 matrices 2 4 t t t t t t t t t and 2 5 t t t t t t t t t satisfy 2 6 det t 6 0 and 2 7 det t 6 0 8 w m wang proof if or 0 without loss one may assume 0 then since 6 0 det t 2 2 6 0 using the rational independence of 1 and k k k k k k 1 2 b if 6 0 and 6 0 and dim 1 then since dim 1 c c 6 0 so c so c using the rational independence of 1 and k k 1 2 b this contradicts dim 2 so det t 6 0 we now prove 2 7 if or 0 then the same argument as for t shows det t 6 0 if 6 0 and 6 0 then c c 6 0 using this to compute the determinant we obtain det t 2 c 2 so det t 0 if and only if c so c contradicting dim 2 so 2 7 holds remark note that the above lemma holds on zb 2 and not just on the sub module u in fact this lemma with obvious modifications i e the s span d dimensions while the s d 1 dimensions holds in any dimension d we now come to the crux of the matter the lemma whose proof uses d 2 main lemma assume u zb 2 dim 2 and dim 2 when 0 the 2 2 matrices as defined in 2 4 and 2 5 satisfy 2 8 det t 6 0 and 2 9 det t 6 0 9 proof since dim 2 2 8 is obviously true we only need to prove 2 9 given zb we call supp the set in i i 1 2 b such that i 6 0 without loss there are two cases a supp 6 supp and b supp supp case a direct computation gives 2 10 det t 2 2 2 2 2 2 2 2 if 6 0 then clearly contains a square root term not in 2 or 2 so 2 9 holds if 0 supp or supp 2 without loss assume supp 2 then 2 contains a square root not in 2 so 2 9 holds finally if supp 1 and supp 1 then without loss one may assume 1 0 0 0 1 6 0 and 0 2 0 0 2 6 0 using this in 2 10 gives det t 21 2 2 j 21 j 2 2 j 2 1 j 2 2 6 0 we now proceed to case b it is further divided into three subcases case b 1 supp 1 in this case c so c by using lemma 1 1 which contradicts dim 2 so 2 9 holds case b 2 supp 2 without loss one may write 1 2 0 0 1 6 0 2 6 0 and 1 2 0 0 2 6 0 we compute the terms that enter in the matrix t write b i 1 iji j x 1 2 10 w m wang and y 1 2 we have 2 11 2 2 2 j 2 22 1 x 2 2 xj 1 j 2 2 x 1 2 and 2 12 j j 2 2 1 xy x y j 1 j 2 x y 1 2 write a j 1 j 2 and 1 2 if det t 0 then 2 13 1 x 2 2 ax 2 x 1 y 2 2 ay 2 y 1 xy x y a x y 2 equate the irrational part gives y 1 x 2 2 ax x 1 y 2 2 ay 1 xy x y a x y which yields a x y 2 0 if a 6 0 then x y i e 1 2 1 2 so c and c using lemma 1 1 which contradicts dim 2 if a 0 equate the rational part of 2 13 gives 1 x 2 2 ax 1 y 2 2 ay 4 xy 2 1 x 2 1 y 2 4 xy 2 1 xy x y a 2 x y 2 2 1 xy 2 x y 2 2 this leads to 2 1 x y 2 0 since 2 21 2 2 j 2 1 1 j 2 2 1 1 this gives again x y which is a contradiction this concludes the proof of 2 9 for case b 2 case b 3 supp 3 we start from i supp 3 11 without loss one may write 1 2 3 0 0 1 6 0 2 6 0 3 6 0 and 1 2 3 0 0 3 6 0 write 2 14 g g g g g g is a positive definite euclidean metric denote the inverse by g 1 which again is a positive definite euclidean metric denote its matrix elements by g g g and g let d det t det g then simple computation gives d g 21 2 1 2 2 2 2 2 3 2 3 2 1 2 1 2 2 2 3 2 3 2 3 1 3 1 g 1 2 21 2 2 22 3 2 23 2 1 2 1 2 2 2 3 2 3 2 3 1 3 1 2 g 1 1 21 2 2 22 3 3 23 1 2 1 2 1 2 2 3 2 3 2 3 3 1 3 1 3 1 1 if d 0 the irrational part of the equation gives the following system of three equations 2 15 1 2 g 1 2 g 1 2 1 2 g 0 2 3 g 2 3 g 2 3 2 3 g 0 3 1 g 3 1 g 3 1 3 1 g 0 ia g 6 0 viewing g g g as the variables x y and z say then x y z 0 is a solution denote the coefficient matrix of the system by v then there are non zero solutions if and only if detv 0 this leads to the existence of and 6 0 such that 1 2 2 3 3 1 1 2 2 3 3 1 1 2 1 2 2 3 2 3 3 1 3 1 which leads to either 2 16 1 3 1 3 12 w m wang or 2 17 2 3 2 3 if 1 0 and 2 0 this is a contradiction else substituting 2 16 in the third equation in 2 15 leads to 23 g 3 2 g 2 3 3 2 g v g 1 v 0 where v 3 3 6 0 since g 1 is a positive definite metric as mentioned earlier below 2 14 this is a contradiction or else substituting 2 17 in the second equation in 2 15 leads to the same contradiction with v 2 2 6 0 so det t 6 0 ib g 0 one may assume supp supp 3 otherwise clearly it is a contradic tion subsequently one deduces from 2 15 that 1 1 2 2 3 3 so c which yields c from lemma 1 1 which contradicts dim 2 so again det t 6 0 ii supp 3 clearly without loss one may again write 1 2 3 4 b 1 6 0 2 6 0 3 6 0 4 6 0 and 1 2 3 4 b 3 6 0 the linear system obtained from the irrational part of the equation contains 2 15 as a sub system when g 6 0 the same argument applies and leads to det t 6 0 when g 0 if supp supp it is a clear contradiction otherwise it leads to 1 1 2 2 3 3 4 4 and the same conclusion holds this finishes the proof 13 2 2 proof of the new separation lemma a proof of lower bounds on det t and det t at i the 2 2 case we begin with t we have d det t 2 2 2 2 2 p 0 p 1 0 2 p 2 p p where p 2 is a quadratic polynomial in with integer coefficients and p 1 linear and p b 4 further 2 p 2 2 k 2 k k 2 k 1 2 b so there exists k such that 2 p 2 2 k 6 0 otherwise it contradicts with dim 2 on the sub module u there fore 2 18 2 p 2 2 k 2 for some k from lemmas 2 1 2 2 and the main lemma p 6 0 assume and n n 1 b the simultaneous diophantine approximation result from schm 1 see pp 151 155 schm 2 then gives that p 1 n 0 clearly p n 4 so for n such that n 4 1 n 2 d 1 n 1 n 2 1 2 n at scale n the number of quadratic polynomials in from d are bounded above by 2 19 n 4 b c 2 b b 1 n 4 b 2 14 w m wang set 2 20 q 4 2 4 2 b 2 1 if 2 21 n 4 1 n 2 then d 1 n q holds at all scales n away from a set in of measure less than 1 0 by summing over n and using 2 18 2 19 and 2 21 similar arguments yields the same bound for the t ii the 1 1 case d 2 2 0 2 2 2 0 2 2 since has at least one non zero component say 1 then 2 d 21 2 2 21 2 2 so we obtain the bounds on det t and likewise det t as in the 2 2 case b proof of the new separation lemma the lower bounds in i and ii put us in the same setting as that of lemma 20 14 b 2 and the proof there is directly applicable in fact it is the same so let us sketch the idea of the proof instead let i 0 1 2 using the condition 1 11 the number of elements in the set i can be bounded in terms of the diameter max i k i k i since i k t i k t the idea is to bound t by its projection onto an appropriate basis now the restriction to the hyperbolic tube ni 2 h 2 i 1 1 entails an upper bound t i t i m where i i i 1 using the lower bound on det t and the upper bound m then leads to an upper bound t m 15 provided the t i form a basis consequently max i k m achieving this basis yields dimension reduction from d 1 d to d 1 1 the upper bound m depends on d 1 the lower bound on det t and the number of i needed so that t i form a basis when d 1 is reduced to d 1 1 this number is 1 which concludes the proof 2 3 about lemma 5 2 w 2 in w 2 we proved a separation lemma on the characteristic n 0 2 h 2 1 0 valid in arbitrary dimensions d it needs however the additional condition if b d 1 any d vectors in the set jk bk 1 are linearly independent for all k k 1 2 b define the set jk jk jk k 1 b k 6 k any d vectors in jk are linearly independent if b d there is no condition for the benefit of a direct comparison with the new separation lemma we rephrase it below small scale separation lemma assume that and are satisfied let r and set x n h zb d let u zb d be the sub module generated by u 0 consider a sequence a subset xk k 0 u zb d satisfying 2 22 0 6 ni ni 1 b k 1 mkek b k 1 mk p assume that for all i 0 i 2 23 ni 0 2 h 2 i 1 0 then 2 24 4 b for all fixed remark 2 3 note that in spite of the name at 0 the lemma is valid for all scales by perturbation it maybe used at small scales for 0 1 hence its name 16 w m wang references b 1 j bourgain quasi periodic solutions of hamiltonian perturbations of 2 d linear schro dinger equations ann of math 148 363 439 1998 b 2 j bourgain green s function estimates for lattice schro dinger operators and applications ann of math stud 158 2005 princeton university press princeton nj ek l h eliasson s e kuksin kam for the nonlinear schro dinger equa tion ann of math 172 2 371 435 2010 lx k lapkova s y xiao density of power free values of polynomials mathematika 65 4 1038 1050 2019 pp c procesi m procesi a kam algorithm for the resonant non linear schro dinger equation adv in math 272 399 470 2015 schm 1 w schmidt norm form equations ann of math 96 526 551 1972 schm 2 w schmidt diophantine approximations lecture notes math 785 1980 springer w 1 w m wang energy supercritical nonlinear schro dinger equations quasi periodic solutions duke math j 165 no 6 1129 1192 2016 w 2 w m wang quasi periodic solutions to a nonlinear klein gordon equa tion with a decaying nonlinear term arxiv 1609 00309 52 pp 2021 w 3 w m wang semi algebraic sets method in pde and mathematical physics j math phys special issue on celebrating the work of jean bourgain 62 021506 2021 cnrs and de partement de mathe matique cergy paris universite 95302 cergy pontoise cedex france email address wei min wang math cnrs fr 1 introduction and the new separation lemma 1 1 the new separation lemma 1 2 the role of separation lemmas 1 3 ideas of the proof 1 4 the new idea for fixed frequencies and their neighborhoods 2 proof of the new separation lemma 2 1 non zero generalized gram determinants at 0 2 2 proof of the new separation lemma 2 3 about lemma 5 2 w 2 references