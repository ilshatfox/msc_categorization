ar x iv 1 90 4 02 04 1 v 1 m at h g n 3 a pr 2 01 9 loop homology of bi secondary structures andrei c buraa b qijun hec christian m reidysc d adepartment of mathematics virginia tech 225 stanger street blacksburg va 24061 1026 bbiocomplexity institute of virginia tech 1015 life sciences circle blacksburg va 24061 cbiocomplexity institute and initiative university of virginia 995 research park boulevard charlottesville va 22911 ddepartment of mathematics university of virginia 141 cabell dr charlottesville va 22903 abstract in this paper we compute the loop homology of bi secondary structures bi secondary structures were introduced by haslinger and stadler and are pairs of rna secondary structures i e diagrams having non crossing arcs in the upper half plane a bi secondary structure is represented by drawing its respective secondary structures in the upper and lower half plane an rna secondary structure has a loop decomposition where a loop corresponds to a boundary component regarding the secondary structure as an orientable fatgraph the loop decomposition of secondary structures facilitates the computation of its free energy and any two loops intersect either trivially or in exactly two ver tices in bi secondary structures the intersection of loops is more complex and is of importance in current algorithmic work in bio informatics and evolutionary optimization we shall construct a simplicial complex capturing the intersec tions of loops and compute its homology we prove that only the zeroth and second homology groups are nontrivial and furthermore show that the second homology group is free finally we provide evidence that the generators of the second homology group have a bio physical interpretation they correspond to pairs of mutually exclusive substructures keywords rna bi secondary structure loop nerve simplicial homology 1 introduction rna sequences are single stranded nucleic acids that in difference to dna can form a plethora of structural conformations over the last several decades researchers have discovered an increasing number of important roles for rna 1 the folded structure of rna is critically important to its function 2 and has corresponding author email addresses anbur 12 vt edu andrei c bura qhe 196 gmail com qijun he duck santafe edu christian m reidys preprint submitted to discrete mathematics april 4 2019 http arxiv org abs 1904 02041 v 1 been extensively studied at the coarse grained level of base pairing interactions this leads to the notion of rna secondary structures 3 that represent par ticular contact matrices and do not take into account the embedding in 3 space 4 the thermodynamic stability of a secondary structure is characterized by its free energy and is computed by summing the energy contribution of its loops 5 6 prediction of the minimum free energy i e the most stable secondary structure for a given sequence is an important problem at the most basic bio logical level 7 the first mfe folding algorithms for rna secondary structures are due to 8 4 9 waterman studied the loop decomposition and the recursive construc tion of secondary structures and derived the first dynamic programming dp folding routines for secondary structures 10 the dp routine facilitates poly nomial time folding algorithms 11 12 13 and partition function calculation 14 in 15 haslinger and stadler extended the notion of secondary structures to bi secondary structures in order to study pseudoknotted structures rna structures exhibiting cross serial interactions 16 bi secondary structures play furthermore a central role for studying sequences that can realize two often times mutually exclusive conformations in the context of evolutionary transi tions 17 and in the study of rna riboswitches i e sequences that exhibit two stable configurations 18 the partition function of structures w r t a fixed sequence has a dual the partition function of sequences compatible with a fixed structure 19 partition function and boltzmann sampling have a variety of applications in sequence design 20 21 extracting structural semantics 22 and to analyze mutational robustness 23 rna structures viewed as abstract diagrams or trees have been studied in enumerative combinatorics 10 24 25 15 algebraic combinatorics 26 matrix models 27 28 and topology 29 30 31 in 24 a bijection between linear trees and secondary structures was con structed this facilitated beautiful explicit formulae for the number of sec ondary structures on n vertices having exactly k arcs jin et al 26 enumerate k non crossing rna structures based on the bijection given by chen et al 32 between k non crossing partial matchings and walks in zk 1 which remain in the interior of the weyl chamber c 0 the bijection between oscillating tableaux and matchings originated from stanley 33 and was generalized by sundaram 34 penner and waterman connected rna structures with topology by studying the space of rna secondary structures they proved that the geometrical re alizations of the associated complex of secondary structures is a sphere 35 in 29 bon et al presented a topological classification of secondary structures based on matrix models in the course of computing the euler characteristics of the moduli space of a curve 36 harer and zagier computed the generating function of the num ber of linear chord diagrams of genus g with n chords based on this line of work andersen et al 28 enumerated the number of chord diagrams of fixed 2 genus with specified numbers of backbones and chords such an enumeration of chord diagrams provides the number of secondary structures of a given genus as well as the number of cells in riemann s moduli spaces for bordered surfaces this was done by using hermitian matrix model techniques and topological recursions along the lines of 37 employing an augmented version of the topo logical recursion on unicellular maps of chapuy 38 huang et al 31 derived explicit expressions for the coefficients of the generating polynomial of topolog ical shapes of rna structures and the generating function of rna structures of genus g this lead to uniform sampling algorithms for structures of fixed topological genus as well as a natural way to resolve crossings in pseudoknotted structures 39 bi secondary structures emerge naturally in the context of evolutionary tran sitions since they are closely connected to sets of sequences that are simultane ously compatible with two structures 40 this paper is motivated by the dy namical programming dp routine of huang 41 that is based on sub problems associated with sets of loops the sub problems were constructed incrementally by adding one loop at a time where subsequently added nucleotides affect the energy calculation if they appear in multiple loops this naturally leads one to consider intersections of loops and eventually to introduce the nerve of loops as a simplicial complex in this paper we study the homology of bi secondary structures 15 we show that for any bi secondary structure r we have only two nontrivial ho mology groups h 0 r and h 2 r the key to establish h 1 r 0 is to es tablish in lemma 6 the existence of certain spanning sub 1 skeleta whose existence follows from an inductive argument over the arcs of one of the sec ondary structures these skeleta give rise to specific trees which in turn allow one to systematically process elements of ker 1 we show that h 0 r z and h 2 r r k 1 z introducing the rank of h 2 r as a new invariant of the bi secondary structures we show that h 2 r is free by showing that it is a subgroup of a free group whose freeness in turn is a consequence of lemma 4 which guarantees the existence of exposed faces of 3 simplices we then discuss the new invariant observing that all rna riboswitch sequences in data bases exhibit rank h 2 r 1 seldomly assumed by random secondary structure pairs and provide an outlook on future work 2 some basic facts we shall begin by defining loops in an rna secondary structure and then present results on its loop decomposition an rna diagram s over n is a vertex labeled graph whose vertices are drawn on the horizontal axis and labeled by n 1 n an arc i j is an ordered pair of vertices which represents the base pairing between the i th and j th nucleotides in the rna structure furthermore each vertex can be paired with at most one other vertex and the arc that connects them is drawn in the upper half plane we introduce two formal vertices associated with positions 3 0 and n 1 respectively closing any diagram by the arc 0 n 1 called the rainbow the set 0 n 1 is called the diagram s backbone see figure 1 let s be an rna diagram over n two arcs i j and p q are called crossing if and only if i p j q s is called a secondary structure if it does not contain any crossing arcs the arcs of s can be endowed with a partial order as follows k l s i j i k l j we denote this by s s and call it the arc poset of s finally an interval i j on the backbone is the set of vertices i i 1 j 1 j let s be a secondary structure over n a loop s in s is a subset of vertices represented as a disjoint union of a sequence of contiguous blocks on the back bone of s s k i 1 ai bi such that a 1 bk and bi ai 1 for 1 i k 1 are arcs and such that any other interval vertices are unpaired let s denote the unique maximal arc a 1 bk of the loop in this paper we shall identify a secondary structure with its set of loops let s be a secondary structure over n and s k i 1 ai bi a loop in s then 1 each unpaired vertex is contained in exactly one loop 2 a 1 bk is maximal w r t s among all arcs contained in s i e there is a bijection between arcs and loops mapping each loop to its maximal arc 3 the hasse diagram of the s arc poset is a rooted tree tr s having the rainbow arc as root 4 each non rainbow arc appears in exactly two loops r 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 x 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 s r figure 1 lhs a secondary structure s and a distinguished loop s 4 5 11 14 18 19 r is the rainbow arc and s x rhs s represented as a planar rna molecule proposition 1 let s s and s be three distinct loops in a secondary structure s then 1 s s s 2 s s 6 implies s s 2 proof vertices of s are either paired or unpaired in the latter case they are contained in exactly one loop in the former by construction they are endpoints of arcs and contained in exactly two distinct loops hence no vertex can be contained in three distinct loops in case of s s 6 the loops intersect in the endpoints of exactly one arc which is maximal for exactly of of them whence s s 2 in this section we introduce bi secondary structures and their nerves to this end we introduce the nerve over a finite collection of sets 4 let x x 0 x 1 xm be a collection of finite sets we call y xi 0 xid x a d simplex of x iff d k 0 xik 6 we set y d k 0 xik and refer to y y 6 0 as the weight of y let kd x be the set of all d simplices of x then the nerve of x is k x d 0 kd x 2 x a d simplex y k x is called a d face of y if d d and y y by construction k x is an abstract simplicial complex let s be a secondary structure over n the geometric realization of k s the nerve over the set of loops of s is a tree by means of the correspondence between arcs and loops this tree of loops is isomorphic to tr s definition 1 given two secondary structures s and t over n we refer to the pair r s t as a bi secondary structure let s t be the loop set of r and k r d 0 kd r its nerve of loops we represent the diagram of a bi secondary structure r s t with the arcs of s in the upper half plane while the arcs of t reside in the lower half plane let r s t be a bi secondary structure with loop nerve k r a 1 simplex y ri 0 ri 1 k 1 r is called pure if ri 0 and ri 1 are loops in the same secondary structure and mixed otherwise suppose y is a pure 1 simplex in k r then by proposition 1 we have y 2 see figure 2 s 1 t 1 2 b c figure 2 lhs a bi secondary structure r s t rhs the geometric realization of its loop nerve k r the 1 simplices c 1 and 1 2 are mixed and pure respectively lemma 1 let r s t be a bi secondary structure with nerve k r for any y k 2 r exactly one of its three 1 faces is pure the other two being mixed furthermore we have y 2 proof let y r 0 r 1 r 2 k 2 r be a 2 simplex of k r by proposition 1 i 0 1 2 r i 6 implies that not all three loops can be from the same structure w l o g suppose r 0 r 1 s and r 2 t certainly z r 0 r 1 is a pure 1 face of y and two other 1 faces of y are by construction mixed since they contain r 3 t for any 1 face z of y we have y z and proposition 1 guarantees z 2 whence the lemma 5 lemma 2 let r s t be a bi secondary structure with nerve k r and let y r 0 r 1 r 2 r 3 k 3 r be a 3 simplex then we have a y s 0 s 1 t 0 t 1 where s 0 s 1 s and t 0 t 1 t b y has exactly two pure 1 faces s 0 s 1 and t 0 t 1 c y 2 proof any 2 simplex in the loop nerve is of the form s t t or t s s and y has the 2 faces r 0 r 1 r 2 r 1 r 2 r 3 r 0 r 2 r 3 and r 0 r 1 r 3 in view of the 2 simplex r 0 r 1 r 2 we can w l o g set s 0 r 0 s 1 r 1 and t 0 r 2 the 2 simplex r 0 r 1 r 3 then implies that r 3 is a t loop whence we can set t 1 r 3 and a follows assertion b follows immediately from a finally c follows from 3 i 0 ri s 0 s 1 and s 0 s 1 2 lemma 3 let r s t be a bi secondary structure and let k r be its loop nerve then any pure 1 simplex p appears as the 1 face of at most two distinct 3 simplices proof w l o g we may assume p s 0 s 1 for some s 0 s 1 s if p is a 1 face of a 3 simplex y then by lemma 2 y s 0 s 1 t 0 t 1 for some t 0 t 1 t for any such 3 simplex we have y s 0 s 1 where s 0 s 1 x y similarly t 0 t 1 a b and y a b in the case of a b x y s 0 s 1 is contained exclusively in the 3 simplex s 0 s 1 t 0 t 1 otherwise we obtain two 3 simplices yx s 0 s 1 t x 0 t x 1 and yy s 0 s 1 t y 0 t y 1 and in view of x y tx 0 t x 1 x and x y t y 0 t y 1 y both yx and yy contain p see figure 3 s 0 x s 1 t 1 t 0 y a b s 0 x s 1 t 1 t 0 y a b s 0 x s 1 t 1 t 0 y a b figure 3 lhs the case a b x y center the case of yx s 0 s 1 t x 0 tx 1 rhs the case of yy s 0 s 1 t y 0 t y 1 definition 2 let k x d 0 kd x be an abstract simplicial complex and let y kd x be a d simplex let y be a d 1 face of y we say y is y exposed if and only if no other d simplices of k contain y as a d 1 face lemma 4 let r s t be a bi secondary structure with loop nerve k r then any y k 3 r contains at least two y exposed 2 faces proof by lemma 2 any 3 simplex y is of the form y s 0 s 1 t 0 t 1 and has exactly two pure 1 faces p 1 s 0 s 1 and p 2 t 0 t 1 we shall use p 1 to construct at least one specific exposed 2 face of y for p 1 w 1 s 0 s 1 t 0 and w 2 s 0 s 1 t 1 are the only two distinct 2 faces that contain p 1 as a pure 1 face in k r y is the unique 3 simplex that contains both w 1 and w 2 as 2 faces it thus remains to show that there cannot exist two distinct 3 simplices y 1 and y 2 having w 1 and w 2 as a 2 face respectively if this were the case 6 y y 1 y 2 were by construction three distinct 3 simplices having p 1 as a pure 1 face which in view of lemma 3 is impossible thus either w 1 or w 2 is exposed in y we can argue analogously for p 2 and the lemma follows 3 homology in this section we consider the chain complex over the loop nerve k r and compute its homology we will show that only the second homology group h 2 r is nontrivial and that h 2 r is free this produces a new invariant for bi secondary structures that provides insight into rna riboswitch sequences i e where a single sequence switches depending on context between mutually exclusive structures suppose we are given a bi secondary structure r s t and let t t and s s be the posets of arcs on the secondary structures t and s respec tively s and t allow us to endow r with the poset structure r r t t s s where r t s and r is given by r 1 r r 2 r 1 r 2 t and r 1 t r 2 r 1 r 2 s and r 1 s r 2 r 1 s r 2 t let us next choose a linear extension of r r r to which we refer to as the simplicial order of the loop nerve any d simplex y kd r becomes then the unique d tuple y r 0 r 1 rd where r 0 r 1 rd let r s t be a bi secondary structure with loop nerve k r let cd r be the simplicial chain group of dimension d of k r let y r 0 r 1 rd cd r and d cd r cd 1 r be the boundary map given by d y d i 0 1 i r 0 ri 1 ri 1 rd let furthermore hd r ker d im d 1 be the d th homology group of the loop nerve of r in the following we shall show theorem 1 the loop nerve of a bi secondary structure r has only the fol lowing nontrivial homology groups h 0 r z h 2 r r k 1 z let us begin proving theorem 1 by first noting lemma 5 h 0 r z 7 proof by construction the 1 skeleton of k r contains the two rooted trees associated to s and t respectively their respective root loops are connected by a 1 simplex as both rainbows share the vertices 0 and n 1 thus any loop is path connected to a rainbow loop implying that any loop is modulo boundaries equivalent to a rainbow loop hence the assertion follows let t t be a loop we set s t s s s t k 1 r t t t t t t t t t s t t t t t t t t k 1 r the sets of s and t neighbors of t respectively let r t s t t t and let gr t be the vertex induced sub graph of the 1 skeleton in the geometric realization of k r whose vertices are the loops in r t by construction gr t does not contain the loop t as a vertex let r s t be a bi secondary structure with loop nerve k r and let t t be a loop a connected spanning sub graph g t gr t in which each edge satisfies ra rb g t ra rb t k 2 r is called a t graph and we refer to its edges as t edges theorem 2 let r s t be a bi secondary structure and k r be its loop nerve then h 1 r 0 proof we shall inductively build t arc by arc from bottom to top and from left to right for the induction basis assume t then by construction k r k s and the geometric realization of its nerve is a tree with edges between loops p q s whenever p directly covers q w r t s hence h 1 r 0 and the induction basis is established for the induction step the induction hypothesis stipulates h 1 s t 0 we shall show that h 1 r 0 where r s t and t is obtained from t by adding the arc t the maximal arc of the newly added loop t we have the following scenario c 2 r c 1 r c 0 r 0 c 2 r oo c 1 r oo c 0 r oo 0 1 where the vertical and horizontal maps are the natural embeddings and bound ary homomorphisms respectively claim 1 ker r 1 ker r 1 im r 2 to prove the claim we consider 0 c 1 r 0 ei k 1 r niei ej r t r r t njej 8 distinguishing any edges that contain t in the second term the idea is to now process the edges containing t in a systematic way to this end we first claim claim 2 let r s t be a bi secondary structure with nerve k r and let t be a t loop then there exists a t graph g t we shall give the proof of claim 2 by means of lemma 6 below given a t graph any of its vertices can be employed as the root of a spanning g t sub tree and we select the maximum g t vertex as root let a t denote this rooted tree any vertex r r t appearing in an edge r t occurs in a t and any two a t neighbors r 1 r 2 are in the boundary of the 2 simplex r 1 r 2 t we examine now all r t vertices in the following systematic way starting with a t leaves pick r 0 and its unique immediate a t ancestor r 1 we then have either case 1 r 0 r 1 then r 0 r 1 is a simplex and using that r 0 r 1 is a t edge we are guaranteed that r 0 r 1 t is a 2 simplex and 2 r 0 r 1 t r 1 t r 0 t r 0 r 1 we have a closer look at the sum of simplices n 0 r 0 t n 1 r 1 t n 0 r 0 t n 1 r 1 t n 0 r 0 t n 1 r 1 t n 0 r 0 r 1 n 0 r 1 t n 0 r 1 t r 0 t r 0 r 1 n 0 n 1 r 1 t n 0 r 0 r 1 n 0 2 r 0 r 1 t n 0 n 1 r 1 t n 0 r 0 r 1 this produces on the rhs a boundary a new term r 0 r 1 c 1 r a modified coefficient for the simplex r 1 t and the term r 0 t has become part of a boundary case 2 r 1 r 0 here r 1 r 0 is a simplex and 2 r 1 r 0 t r 0 t r 1 t r 1 r 0 furthermore n 0 r 0 t n 1 r 1 t n 0 r 0 t n 1 r 1 t n 0 r 0 r 1 n 0 r 1 t n 0 r 0 t r 1 t r 0 r 1 n 0 n 1 r 1 t n 0 r 0 r 1 n 0 2 r 1 r 0 t n 0 n 1 r 1 t n 0 r 0 r 1 on the rhs we again have a boundary a new term r 0 r 1 c 1 r a modified coefficient for the simplex r 1 t and the term r 0 t has become part of a boundary iterating this procedure we step by step transform simplices r t into boundaries working along the tree a t from the leaves to the root this finally produces the following expression for 0 0 0 nk rk t k 9 where 0 im r 2 i e 0 is a boundary rk is the root of a t and k c 1 r at this point we cannot proceed transforming rk t into a boundary and shall argue as follows suppose 0 ker r 1 then r 1 0 r 1 0 nkt nkrk r 1 k since 0 im r 2 we certainly have r 1 0 0 by construction of the t graph g t the 0 simplex t does not appear in r 1 k from which we conclude nk 0 as a result we have nkrk 0 and since r 1 k r 1 k we have 0 r 1 0 r 1 k and as a result k ker r 1 the induction hypothesis guarantees h 1 r 0 i e ker r 1 im r 2 hence k im r 2 which in view of diagram 1 implies 0 im r 2 and we have proved ker r 1 im r 2 it remains to show the proof of claim 2 to this end let r r be a loop with r a b and denote b r b r a and e r e r b let s k i 1 ai bi be a loop in a given secondary structure s we refer to the intervals g 0 s 0 a 1 gi s bi ai 1 for 1 i k 1 and gk s bk n 1 as the gaps of the loop s we call g 0 s and gk s exterior gaps and the rest interior gaps claim 2 now follows from lemma 6 let r s t be a bi secondary structure with loop nerve k r and let t t be a loop then there exists a t graph g t proof let s t and t t be the s and t neighbors of t respectively we prove the lemma by induction on n the number of non rainbow arcs in s to this end let us first consider the induction base case n 0 as there are no arcs other than the rainbow r we have s t r by construction b r g 0 t and e r gk t the exterior t gaps we make the ansatz g t star r r t r t t t t by construction star r is a connected spanning sub graph of gr t further more t t t we have b r b t b t e t e t e r hence r t t b t e t 6 and as a result r t t k 2 r t thus any edge r t e r r t t t t is a t edge and star r is a t graph establishing the induction basis see figure 4 let next s denote a secondary structure having n 1 0 arcs by induction hypothesis for any such bi secondary structure r s t and t t a t graph exists we will denote such a graph by g t 10 gap s r r t star r gap figure 4 lhs s t r rhs g t star r we shall prove the existence of a t graph as follows first we identify and then remove a distinguished non rainbow arc x s this gives us the bi secondary structure r s t for which the induction hypothesis applies i e a t graph g t exists we then reinsert the arc x and inspect how to obtain g t from g t let expt s be the set of non rainbow s arcs x having at least one t exposed endpoint i e either b x or e x are contained in t case 1 expt s 6 gap s 1 x 1 x 2 e x 1 s 2 t s 2 s 2 s 1 g t g t figure 5 lhs x 1 expt s rhs the effect of reintroducing x 1 passing from g t to g t select x 1 expt s let s 1 s t be the loop such that x 1 s 1 and let x 2 be the arc that directly covers x 1 w r t s let s 2 s be the loop such that s 2 x 2 w l o g we may assume that e x 1 t clearly s 2 s t since e s 1 s 2 t see figure 5 x 1 removal produces the secondary structure s and r s t for which the induction hypothesis applies let s 2 s be such that s 2 x 2 then s 2 s t since in absence of x 1 e x 1 s 2 t hence s 2 is a vertex in g t r t e reinserting x 1 into r splits s 2 into the two s loops s 1 and s 2 see figure 5 we make the ansatz g t r t s 2 s 1 s 2 e where e e s 2 r r r t s 1 s 2 s 1 r r r t s 1 s 2 s 1 r t 6 s 2 r r r t s 1 s 2 s 2 r t 6 11 since s 2 s 1 s 2 as sets and r t s 2 r t s 1 s 2 we have r r t r s 2 e r r t s 2 r s 1 e or r s 2 e accordingly any r t vertex connected in g t to s 2 is when considered in r t connected to either s 1 or s 2 in view of e x 1 s 1 s 2 t we can conclude that s 1 and s 2 are connected by a t edge this guarantees that g t is a connected spanning sub graph of gr t case 2 expt s having no arcs with exposed endpoints for any loop s s there exist t gaps containing b s and e s suppose first there exists an arc x having both endpoints in the same gap see figure 6 the associated loop s having s x is not contained in s t upon inspection s t s t and g t g t hence the induction hypothesis directly implies the existence of g t s x t s figure 6 the case where b x and e x are contained in the same t gap it thus remains to discuss s arcs whose endpoints belong to distinct t gaps see figure 7 we shall distinguish the following two scenarios a s s t r 6 where r is the rainbow arc we shall show that the removal of an arc x s s s s t r will not affect g t aside from relabeling of a single vertex since s 1 s t we have s 2 s t if and only if s 2 s t in this case we set g t g t and the assertion is directly implied by the induction hypothesis in case of s 2 s t g t is obtained from g t by relabeling s 2 to s 2 exhibiting no other changes see figure 7 g t r t s 2 s 2 e where e e s 2 r e r r t s 2 r r r t s 2 r e and g t is consequently a t graph b s s t r where r is the rainbow arc we then have either s s t or s s t r in the latter case we select x to be an arc corresponding to a loop s 1 that is immediately covered by r let s 2 r since r s t we make the ansatz g t r t s 2 s 1 e 12 gap t gap s 1 x 1 x 2 s 2 gap gap s 2 g t s 2 g t figure 7 lhs all s arcs having their endpoints in distinct t gaps rhs a s 2 s t g t is obtained by a relabelling of g t where e e s 2 r e r r t s 1 r r r t s 2 r e accordingly g t is obtained from g t by relabeling s 2 by s 1 and g t is a t graph see figure 8 it remains to analyze s s t i e all s arcs are contained in s t where we recall we reduced the analysis to arcs whose endpoints belong to different t gaps s 2 g t s 1 g t s 2 s 2 s 1 g t g t t figure 8 lhs the case s s t r rhs the case s s t suppose now all s loops are contained in s t consider the set of all min imal arcs of s w r t s we claim there exists one such minimal arc call it s 1 such that its immediate cover w r t s call it s 2 is such that s 2 con tains at least one of the endpoints of one of the t gaps that contain one of the endpoints of s 1 to show this we observe that if all t gaps would have their endpoints inside loops corresponding to s minimal arcs then at least one arc that immediately covers such minimal arcs would not correspond to a loop in s t hence there must be a loop s 1 with s 1 minimal w r t s and an arc s 2 that immediately covers s 1 such that s 2 contains one of the endpoints of a gap that contains b s 1 or e s 1 let us denote this gap by h w l o g we can assume e s 1 h see figure 9 then the minimality of s 1 guarantees that s 1 contains the other endpoint of the gap h we shall now remove x 1 s 1 we consider the loop t associated to h and note that s 1 t t 6 as well as s 2 t t 6 accordingly t connects s 1 s 2 in r t by means of t edges see figure 8 and we immediately obtain that g t r t s 2 s 1 s 2 e 13 t s 1 x 1 x 2 s 2 h e h figure 9 x 1 s 1 is minimal w r t s where e e s 2 r e r r t s 1 r r r t s 1 r t 6 s 2 r r r t s 2 r t 6 is a t graph for r t this concludes the proof of the induction step and the lemma follows next we compute h 2 r theorem 3 for any bi secondary structure r s t with loop nerve k r we have h 2 r k i 1 z i e h 2 r is free of finite rank proof claim 1 im 3 c 3 r i e im 3 is a free abelian group and freely generated by p 3 yi yi is a 3 simplex claim 1 is a consequence of two facts a c 4 r 0 and b h 3 r 0 both of which we prove below it is obtained as follows c 4 r 0 guarantees im 4 0 which in view of 0 h 3 r ker 3 im 4 implies ker 3 0 this in turn implies that 3 is an embedding i e im 3 c 3 r whence im 3 is a free abelian group p certainly generates im 3 and a z linear combination j j 3 yj 3 j jyj 0 means that j jyj ker 3 since the latter is trivial we arrive at j jyj 0 which implies j 0 for any j appearing in this sum this shows that the p elements are z linear independent let yi k 3 r 0 i k denote the generators of c 3 r lemma 4 guarantees that each 3 simplex y has at least two y exposed 2 faces hence to 14 each generator yi k 3 r there correspond at least two generators of the free group c 2 r that appear as terms only in the image 3 yi let us write 3 yi u i uu i c i cc i distinguishing exposed signed and covered signed 2 faces of yi i e we consider the sign induced by the boundary map to be part of uu i and cc i respec tively in particular for any u i there exists an unique r such that we have either uu i zr or uu i zr where zr is a generator of c 2 r claim 2 c 2 r im 3 is free we consider c 2 r c 2 r im 3 as a z module and suppose x is a torsion element of order n in c 2 r then we can represent x as x r rzr im 3 where w l o g we assume that all r 6 0 since x is a torsion element we have nx 0 in c 2 r i e n r rzr k i 1 i 3 yi i 1 i u i uu i i 1 i c i cc i where r i z are unique nonzero integer coefficients clearly each unique signed 2 face uu i of the rhs corresponds to a unique generator zr uu i and hence irrespective of the particular choice of the u i and the sign of uu i we obtain for any i of the sum on the rhs n r uu i i only depending on the index i this is an equation in z and hence implies i 0 mod n accordingly we derive r rzr k i 1 i n 3 yi which means x im 3 since i n z i e x 0 by transposition we have proved that x 6 0 in c 2 r implies for any n n nx 6 0 in c 2 r whence c 2 r is free and claim 2 is proved as a result ker 2 im 3 is as a subgroup of the free group c 2 r itself free and the theorem is proved it remains to show cd r 0 for d 4 and h 3 r 0 lemma 7 let r s t be a bi secondary structure with loop nerve k r and let d 4 then kd r cd r 0 and hd r 0 15 proof for any y ri 0 rid kd r for some d 4 we have y d k 0 rik 6 since d 4 y 5 whence at least three loops r 0 r 1 r 2 y are contained in the same secondary structure which is a contradiction to propo sition 1 which stipulates that three loops of one secondary structure intersect only trivially next we show that h 3 r 0 theorem 4 let r s t be a bi secondary structure with loop nerve k r then h 3 r 0 proof consider x yi k 3 r niyi c 3 r ker 3 then 3 x yi k 3 r ni 3 yi i ni u i uu i i ni c i cc i where the uu i and cc i are the signed exposed and covered 2 faces of yi respectively since we have at least two unique exposed 2 faces and by assump tion 3 x 0 we conclude that for any i of x yi k 3 r niyi we have ni 0 therefore x 0 and ker 3 contains no nontrivial elements whence h 3 r 0 4 discussion in the previous section we showed that h 2 r is non trivial and free leading to a novel observable for the pair of secondary structures s t namely the rank of h 2 r s t r h 2 r we shall see that the generators of r h 2 r represent key information about the switching sequence 42 a segment of the sequence that engages w r t each respective structure in a distinct mutually exclusive fashion it is well known from experimental work that native riboswitch pairs ncr nas exhibit two distinct mutually exclusive stable secondary structures 43 we analyzed all nine riboswitch sequences contained in the swispot database 44 and observed that r h 2 r 1 in figure 10 we illustrate the connection between a h 2 r generator and pairs of mutually exclusive substructures the ranks r h 2 r for uniformly sampled structures pairs are displayed in figure 11 showing that 6 7 of the uniform random pairs exhibit r h 2 r 1 as for future work the complexity analysis and optimal scheduling problems arising from the work of huang 41 suggest to consider a graded version of the homologies developed here let t 1 be an integer and r s t be a 16 t s figure 10 h 2 r generators and mutually exclusive structure pairs the two helices boxed are mutually exclusive while the two substructures shaded are not the former two together with the two rainbows correspond to a generator of h 2 r 0 5 10 15 20 25 0 1 2 3 4 5 6 7 8 9 10 rankdistribution random figure 11 r h 2 r for uniformly random structure pairs r h 2 r x axis and the relative frequencies y axis 17 bi secondary structure we set kt d r y kd r y t the set of d simplices of weight at least t we define ctd r to be the free abelian group generated by kt d r i e the chain group of rank d and weight at least t it is easy to see then that cd r c 1 d r for all d 0 and that c t 1 d r ctd r for all t 1 and all d 0 we can naturally define boundary operators for these groups in terms of restrictions of our original boundary maps as t d ctd r c t d 1 r with t d d ctd r as such we obtain a t parametric sequence of nerves kt r t 1 each of which gives rise to its t labelled homology sequence tracking the persistence of homology group generators across the newly obtained homological t spectrum gives rise to a more granular analysis of the structure of the complete nerve 45 this analysis represents a version of persistent homology pioneered by edelsbrunner and by gunnar carlson 46 47 48 and is of central importance for designing an optimal loop removal schedule in 41 we extend the homology analysis to planar interaction structures 49 due to the fact that the physical 5 3 distance for rna strands is in general very small 50 the formation of an interaction structure is connected to the align ment of two discs each representing the respective circular backbone that is interpreting the two circles corresponding to two interacting secondary struc tures s 1 s 2 to be d 0 1 the boundaries of unit disks in c these bound aries contain distinguished points that correspond to the paired vertices in the secondary structures the connection between interaction structure and disc alignment leads one to consider one disc being acted upon by mo bius transforms this action is well defined since the mo bius maps of the disc map the boundary to itself and being holomorphic cannot introduce crossings different align ments are then captured by these automorphisms and give rise to a spectrum of homologies as introduced in this paper 5 declarations of interest none 6 acknowledgments we gratefully acknowledge the comments from fenix huang many thanks to thomas li ricky chen and reza rezazadegan for discussions references references 1 j e darnell rna life s indispensable molecule cold spring harbor lab oratory press new york 2011 18 2 r w holley j apgar g a everett j t madison m marquisee s h merrill j r penswick a zamir structure of a ribonucleic acid science 1965 1462 1465 3 d thirumalai n lee s a woodson d klimov early events in rna folding annual review of physical chemistry 52 1 2001 751 762 4 j r fresco b m alberts p doty et al some molecular details of the secondary structure of ribonucleic acid nature 188 1960 98 101 5 j gralla d m crothers free energy of imperfect nucleic acid helices ii small hairpin loops journal of molecular biology 73 4 1973 497 511 6 d h turner d h mathews nndb the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure nucleic acids research 38 suppl 1 2009 d 280 d 282 7 j m pipas j e mcmahon method for predicting rna secondary struc ture proceedings of the national academy of sciences 72 6 1975 2017 2021 8 c delisi d m crothers prediction of rna secondary structure proceed ings of the national academy of sciences 68 11 1971 2682 2685 9 i tinoco o c uhlenbeck m d levine estimation of secondary struc ture in ribonucleic acids nature 230 5293 1971 362 10 m s waterman secondary structure of single stranded nucleic acids adv math suppl studies 1 1978 167 212 11 r nussinov a b jacobson fast algorithm for predicting the secondary structure of single stranded rna proceedings of the national academy of sciences 77 11 1980 6309 6313 12 m s waterman t f smith rapid dynamic programming algorithms for rna secondary structure advances in applied mathematics 7 4 1986 455 464 13 m zuker d sankoff rna secondary structures and their prediction bul letin of mathematical biology 46 4 1984 591 621 14 j s mccaskill the equilibrium partition function and base pair binding probabilities for rna secondary structure biopolymers original research on biomolecules 29 6 7 1990 1105 1119 15 c haslinger p f stadler rna structures with pseudo knots graph theoretical combinatorial and statistical properties bulletin of mathe matical biology 61 3 1999 437 467 19 16 m taufer a licon r araiza d mireles f van batenburg a p gultyaev m y leung pseudobase an extension of pseudobase for easy searching formatting and visualization of pseudoknots nucleic acids research 37 suppl 1 2008 d 127 d 135 17 c m reidys random induced subgraphs of generalizedn cubes advances in applied mathematics 19 3 1997 360 377 18 c flamm i l hofacker s maurer stroh p f stadler m zehl design of multistable rna molecules rna 7 2 2001 254 265 19 a busch r backofen info rna a fast approach to inverse rna folding bioinformatics 22 15 2006 1823 1831 20 a levin m lis y ponty c w o donnell s devadas b berger j waldispu hl a global sampling approach to designing and reengineer ing rna secondary structures nucleic acids research 40 20 2012 10041 10052 21 c barrett q he f w huang c m reidys an efficient dual sampling algorithm with hamming distance filtration journal of computational bi ology 25 11 2018 1179 1192 22 c barrett f w huang c m reidys sequence structure relations of biopolymers bioinformatics 33 3 2017 382 389 23 q he f w huang c barrett c m reidys genetic robustness of let 7 mirna sequence structure pairs arxiv preprint arxiv 1801 05056 24 w r schmitt m s waterman linear trees and rna secondary structure discrete applied mathematics 51 3 1994 317 323 25 i l hofacker p schuster p f stadler combinatorics of rna secondary structures discrete applied mathematics 88 1 3 1998 207 237 26 e y jin j qin c m reidys combinatorics of rna structures with pseudoknots bulletin of mathematical biology 70 1 2008 45 67 27 h orland a zee rna folding and large n matrix theory nuclear physics b 620 3 2002 456 476 28 j e andersen l o chekhov r penner c m reidys p su lkowski topological recursion for chord diagrams rna complexes and cells in mod uli spaces nuclear physics b 866 3 2013 414 443 29 m bon g vernizzi h orland a zee topological classification of rna structures journal of molecular biology 379 4 2008 900 911 30 j e andersen r c penner c m reidys m s waterman topolog ical classification and enumeration of rna structures by genus journal of mathematical biology 67 5 2013 1261 1278 20 31 f w huang c m reidys shapes of topological rna structures mathe matical biosciences 270 2015 57 65 32 w chen e deng r du r stanley c yan crossings and nestings of matchings and partitions transactions of the american mathematical society 359 4 2007 1555 1575 33 r p stanley enumerative combinatorics wadsworth publ co belmont ca 34 s sundaram the cauchy identity for sp 2 n 35 r penner m s waterman spaces of rna secondary structures advances in mathematics 101 1 1993 31 49 36 j harer d zagier the euler characteristic of the moduli space of curves inventiones mathematicae 85 3 1986 457 485 37 j ambj rn l chekhov c f kristjansen y makeenko matrix model calculations beyond the spherical limit nuclear physics b 404 1 2 1993 127 172 38 g chapuy a new combinatorial identity for unicellular maps via a direct bijective approach advances in applied mathematics 47 4 2011 874 893 39 f w huang c m reidys topological language for rna mathematical biosciences 282 2016 109 120 40 c m reidys neutral networks of rna secondary structures 41 f w huang personal communication 42 r r breaker riboswitches and the rna world cold spring harbor per spectives in biology 4 2 2012 a 003566 43 a serganov e nudler a decade of riboswitches cell 152 1 2 2013 17 24 44 m barsacchi e m novoa m kellis a bechini swispot modeling ri boswitches by spotting out switching sequences bioinformatics 32 21 2016 3252 3259 45 a zomorodian g carlsson computing persistent homology discrete computational geometry 33 2 2005 249 274 46 h edelsbrunner d letscher a zomorodian topological persistence and simplification discrete computational geometry 28 4 2002 511 533 47 g carlsson topology and data bull amer math soc 46 2009 255 308 21 48 g carlsson a zomorodian a collins l j guibas persistence barcodes for shapes international journal of shape modeling 11 02 2005 149 187 49 j e andersen f w huang r c penner c m reidys topology of rna rna interaction structures journal of computational biology 19 7 2012 928 943 50 a m yoffe p prinsen w m gelbart a ben shaul the ends of a large rna molecule are necessarily close nucleic acids research 39 1 2010 292 299 22 1 introduction 2 some basic facts 3 homology 4 discussion 5 declarations of interest 6 acknowledgments