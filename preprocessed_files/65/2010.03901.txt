two dimensional fourier continuation and applications oscar p bruno and jagabandhu paul computing and mathematical sciences caltech pasadena ca 91125 abstract this paper presents a two dimensional fourier continuation method 2 d fc for construction of bi periodic extensions of smooth non periodic functions defined over general two dimensional smooth domains the approach can be directly generalized to domains of any given dimensionality and even to non smooth domains but such generalizations are not considered here the 2 d fc extensions are produced in a two step procedure in the first step the one dimensional fourier continuation method is applied along a discrete set of outward boundary normal directions to produce along such directions continuations that vanish outside a narrow interval beyond the boundary thus the first step of the algorithm produces blending to zero along normals for the given function values in the second step the extended function values are evaluated on an underlying cartesian grid by means of an efficient high order boundary normal interpolation scheme a fourier continuation expansion of the given func tion can then be obtained by a direct application of the two dimensional fast fourier transform fft algorithms of arbitrarily high order of accuracy can be obtained by this method the usefulness and performance of the proposed two dimensional fourier continuation method are illustrated with appli cations to the poisson equation and the time domain wave equation within a bounded domain as part of these examples the novel fourier forwarding solver is introduced which propagating plane waves as they would in free space and relying on certain boundary corrections can solve the time domain wave equation and other hyperbolic partial differential equations within general domains at computing costs that grow sublinearly with the size of the spatial discretization keywords two dimensional fourier continuation poisson equation wave equation fc solver fourier forwarding fft 1 introduction this paper presents a two dimensional fourier continuation method 2 d fc for construction of bi periodic extensions of smooth non periodic functions defined over general two dimensional smooth domains the approach can be directly generalized to domains of any given dimensionality and even to non smooth domains but such generalizations are not considered here the usefulness and performance of the proposed two dimensional fourier continuation method are illustrated with applications to the poisson equation and the time domain wave equation within a bounded domain as part of these examples the novel fourier forwarding solver is introduced which propagating plane waves as they would in free space and relying on certain boundary corrections can solve the time domain wave equation and other constant coefficient hyperbolic partial differential equations within general domains at computing costs that grow sublinearly with the size of the spatial discretization the periodic extension problem has actively been considered in the recent literature in view in par ticular of its applicability to the solution of various types of partial differential equations pde 1 3 4 6 8 13 16 20 23 the contributions 3 4 8 20 in particular utilize the fourier continuation fc method in one dimension in conjunction with dimensional splitting for the treatment of multidimensional 1 ar x iv 2 01 0 03 90 1 v 2 m at h n a 1 5 o ct 2 02 0 pde problems the dimensional splitting is also used in 11 to produce fourier extensions to rectangular domains in two dimensions where the fourier continuation is effected by separately applying the one dimensional fc gram method 3 4 8 first to the columns and then to the rows of a given data matrix of function values the method does assume that the given smooth function is known on a rectangular region containing the domain for which the continuation is sought the approach to periodic function extension presented in 6 23 is based on the solution of a high order pde where the extension shares the values and normal derivatives along the domain boundary reference 13 in turn presents a function extension method based on use of radial basis functions in that approach overlapping circular partitions or patches are placed along the physical boundary of the domain and a local extension is defined on each patch by means of radial basis functions rbfs a second layer of patches is placed outside the first on which the local values are set to vanish the zero patches are used in conjunction with a partition of unity function to blend the local extensions into a global counterpart the choice of functions used to build up the partition of unity determines the regularity of the extended function the 2 d fc extensions proposed in this paper are produced in a two step procedure in the first step the one dimensional fourier continuation method 4 is applied along a discrete set of outward boundary normal directions to produce along such directions continuations that vanish outside a narrow interval beyond the boundary thus the first step of the algorithm produces blending to zero along normals for the given function values in the second step the extended function values are evaluated on an underlying cartesian grid by means of an efficient high order boundary normal interpolation scheme a fourier continuation expansion of the given function can then be obtained by a direct application of the two dimensional fft algorithm algorithms of arbitrarily high order of accuracy can be obtained by this method since the continuation along normals procedure is a fixed cost operation the cost of the method grows only linearly with the size of the boundary discretization as mentioned above this paper demonstrates the usefulness of the proposed general domain 2 d fc technique via applications to both the poisson problem for the laplace equation and the time domain wave equation in the poisson case the 2 d fc method is utilized to obtain a particular solution for a given right hand side the boundary conditions are then made to match the prescribed boundary data by adding a solution of the laplace equation which is produced by means of boundary integral methods the fourier forwarding approach in turn uses the 2 d fc method to solve the spatio temporal pde in the interior of the domain and it then corrects the solution values near the boundary by means of a classical time stepping solver the overall procedure which utilizes large time steps for the interior solver and small cfl constrained time steps for the near boundary solver runs in computing times that grow sublinearly with the size of the spatial discretization mesh it is interesting to note that the primary continuation device in the 2 d fc method namely continuation along normals to the domain boundary is a one dimensional procedure this one dimensional continuation procedure can be utilized in a generalization of the method to n dimensional domains with n 2 this is in contrast with other extension methods mentioned above for example the rbf based extension method 13 requires solution of boundary problems of increasing dimensionality as the spatial dimension grows which given the method s reliance on dense matrix linear algebra for the local extension process could have a significant impact on computing costs similar comments apply to pde based extension methods such as 23 the proposed 2 d fc algorithm performs favorably in the context of existing related approaches spe cific comparisons with results presented in 13 are provided in section 4 1 1 for a poisson problem con sidered in that reference the recent contribution 12 in turn presents an fft based high order solver for the poisson problem for rectangular domains namely cartesian products of one dimensional intervals in either two or three dimensional space the present 2 d fc based poisson solver achieves for general domains a similar performance similar accuracy and computing time to that demonstrated in 12 tables 3 and 4 under the cartesian domain assumption 2 this paper is organized as follows after a brief review of the 1 d fc method presented in section 2 the proposed 2 d fc method is introduced in section 3 the two main applications considered namely solution of the poisson and fourier forwarding for the wave equation are presented in sections 4 1 and 4 2 finally our conclusions are presented in section 5 a demonstration of the 1 d fc method the continuation values are computed as the sum of the blended to zero rightward and leftward extensions b inset of figure 1 a c numbers e of leftward and rightward extra ze roes figure 1 illustration of the 1 d fc procedure figure 1 a depicts the fourier continuation of the non periodic function 0 1 r given by x exp sin 5 4 x 2 7 cos 2 x sin 2 5 x 1 figure 1 b presents a close up of the right continuation region 1 d 1 k b subsequently figure 1 c illustrates the use of a number e of extra zeroes in the blending to zero process to yield a continuation mesh containing fft friendly numbers products of powers small prime numbers of point values 2 background 1 d blending to zero fc algorithm this section presents a brief review of the one dimensional fourier continuation 1 d fc method 3 4 with an emphasis on one of its key components the blending to zero procedure which is employed in the normal direction continuation portion of the proposed two dimensional fourier continuation 2 d fc approach presented in section 3 2 1 1 d fc algorithm outline given the vector d 0 n 1 t of values of a smooth function 0 1 c on the equispaced grid d xj jk 0 j n 1 of step size k 1 n 1 the 1 d fc method 3 4 of order d with e g 4 d 12 produces at first an n c dimensional vector c of discrete continuation function 3 values including the n given function values over an extended interval 0 b b 1 to do this the algorithm utilizes the d dimensional vectors 0 d 1 t and r n d n 1 t of values of the function on the left and right matching point setsd x 0 xd 1 anddr xn d xn 1 respectively each one of which is contained in a small subinterval of length d 1 k near the corresponding endpoint of the containing interval 0 1 in order to obtain the c necessary continuation values the 1 d fc method blends and r to zero see section 2 2 towards the left and right respectively resulting in two zero blending vectors of length c the sum of these two vectors is then utilized as a rightward discrete continuation to the set dc xj 1 jk 1 j c of points in the interval 1 b as described in section 2 3 as indicated in that section the overall 1 d fc procedure is then completed via an application of the fft algorithm to the n c dimensional vector c cf equation 2 7 below of smoothly periodic discrete continued function values the following two subsections describe the blending to zero and 1 d fc approaches respectively 2 2 blending to zero algorithm in our description of the order d blending to zero algorithm 4 we only present details for the rightward blending to zero technique since the leftward blending to zero problem can easily be reduced to the right ward problem thus given the column vector fd f 0 fd 1 t of values of a complex valued function f on the set d x 0 x 1 xd 1 the rightward blending to zero approach starts by producing a poly nomial interpolant for f over the interval x 0 xd 1 relying on the gram polynomial basis gd g 0 x g 1 x gd 1 x 2 1 for this interval the functions gj x j 0 d 1 are the polynomials with real coefficients that are obtained as the gram schmidt orthogonalization procedure is applied in order of increasing degree to the polynomials in the set 1 x x 2 xd 1 with respect to the discrete scalar product g h d 1 j 0 g xj h xj discrete values of the gram polynomials on the set d can be computed on the basis of the qr factoriza tion 14 p qr of the matrix p xij 1 0 i j d 1 2 2 note that the jth column of q contains the values of the jth gram polynomial on the set d following 4 we obtain the necessary qr factorization by applying the stabilized gram schmidt orthogonalization method to the matrix p in order to closely approximate each one of the gram polynomials in gd throughout the continuous interval 0 d 1 k containing d by corresponding trigonometric polynomials as described below we use a certain oversampled matching method according to this method the polynomials in gd are oversampled to an equispaced set of discretization points with stepsize k nos containing nos d 1 1 points where nos denotes the oversampling factor and where the oversampled values are used as part of a certain singular value decomposition svd matching procedure described in what follows note that the aforementioned oversampled values on the refined grid dos x j jk nos 0 j nos d 1 coincide with the columns of the matrix qos p osr 1 2 3 where p os is the vandermonde matrix of size nos d 1 1 d corresponding to the oversampled discretization dos and where r is the upper triangular matrix in equation 2 2 4 the aforementioned svd matching procedure which is one of the crucial steps in the fc approach 4 produces a band limited fourier series of the form gcj x m m m ajme 2 imx d 2 c z 1 k 2 4 for each polynomial gj gd 0 j d 1 where c is the number of blending to zero values to be produced and z being the number of zero matching points the fourier coefficients are selected so as to match in the least square sense both the oversampled polynomial values over the interval 0 d 1 k and identically zero values on an equally fine discretization of the zero matching interval d c k d c z 1 k of length z 1 k the coefficients in 2 4 are taken to equal the solution a of the minimization problem min a a m am t bosa qjos 0 2 2 5 where bos is a matrix whose entries are values of 2 4 at all points in the set dos as well as all the set of k nos spaced points in the zero matching interval mentioned above which in particular contains the endpoints d c k and d c z 1 k the minimizing fourier coefficients a are then found via an svd based 14 least squares approach once the coefficients a have been obtained the resulting fourier expansions 2 4 are used to produce a certain continuation matrix a cc d whose columns equal the values of the expression 2 4 at the c unrefined k discretization points in the interval dk d c 1 k cf remark 2 2 below the desired vector f r of rightward blending to zero function values at the c continuation points in the interval dk d c 1 k is then given by the expression f r aqtf 2 6 2 3 1 d fc algorithm as outlined in section 2 1 the 1 d fc algorithm requires use of a certain rightward resp leftward blending to zero vector rr resp for a given matching point vector r resp in view of equation 2 6 we define rr aq t r to obtain the leftward extension in turn we first introduce the order reversion matrix re ce e e n by re g 0 g 1 ge 2 ge 1 t ge 1 ge 2 g 1 g 0 t and we then define rcaq trd a vector c containing both the n given values in the vector 0 1 n 1 t as well as the c continuation function values is constructed by appending the sum r r at the end of the vector so that we obtain cj j for 0 j n 1 rr j n for n j n c 1 2 7 following the various stages of the construction of the vector c it is easy to check that up to numerical error this vector contains point values of a smoothly periodic function defined over the interval 0 b an application of the fft algorithm to this vector therefore provides the desired continuation function in the form of a trigonometric polynomial c x n c 2 n c 2 c e 2 i x b 2 8 5 which closely approximates in the interval 0 1 in fact as demonstrated in previous publications including 3 4 for sufficiently smooth functions the corresponding 1 d fc approximants converge to with order o kd so that as expected the number d of points used in the blending to zero procedures determines the convergence rate of the algorithm as discussed in these publications further in view of its spectral character the 1 d fc approach enjoys excellent dispersion characteristics as well the 2 d fc algorithm introduced in the following section also relies on the one dimensional blending to zero procedure described in section 2 2 and its convergence in that case is once again of the order o kd it is important to note that for a given order d the matrices a and q can be computed once and permanently stored on disc for use whenever an application of the blending to zero algorithm is required as these matrices do not depend on the point spacing k a graphical demonstration of various elements of the 1 d fc procedure is presented in figure 1 remark 2 1 extra vanishing values the 1 d fc implementations 3 4 allow for an additional number e 0 of identically zero extra function values to be added on a unrefined k discretization of the interval d c k d c e 1 k as illustrated in figure 1 c to obtain a desired overall number of discrete function values including the given function values and the continuation values produced such as e g a power of two or a product of powers of small prime numbers for which the subsequent application of the fast fourier transform is particularly well suited the corresponding use of extra vanishing values for the 2 d continuation problem is mentioned in remark 3 2 remark 2 2 blending to zero on a refined grid as indicated above in the present section the two dimensional fourier continuation procedure introduced in section 3 utilizes the 1 d blending to zero strategy described above in this section to extend a function given on a two dimensional domain along the normal direction to the continuation values obtained at all normals are then utilized to obtain the continuation function on the cartesian grid by interpolation as detailed in section 3 4 in order to prevent accuracy loss in the 2 d interpolation step we have found it necessary to use 1 d normal direction grids finer than the grids inherent in the blending to zero process itself to easily provide the necessary fine grid values a modified fine grid continuation matrix ar ccr d is constructed where cr c denotes the number of fine grid points utilized the modified continuation matrix ar can be built on the basis of the minimizing coefficients a in 2 5 the corresponding columns of the fine grid continuation matrix ar are obtained by evaluating 2 4 on the given fine grid points in the interval d 1 k d c 1 k the necessary blending to zero function values at the cr fine grid points are given by arqt d 3 two dimensional fourier continuation method this section presents the proposed volumetric fourier continuation method on two dimensional domains r 2 with a smooth boundary some elements of which are illustrated in figure 2 let a smooth function f c be given we assume that values of f are known on a certain uniform cartesian grid within as well as a grid of points on the boundary the 2 d fc algorithm first produces one dimensional blending to zero values for the function f along directions normal to the boundary yielding continuation values on a certain two dimensional tangential normal curvilinear grid around as detailed in sections 3 1 and 3 2 and illustrated in figure 2 these continuation values which are produced on the basis of the corresponding blending to zero procedure presented in section 2 2 in the context of the 1 d fc method are then interpolated onto a cartesian grid around the domain boundary to produce a two dimensional blending to zero continuation of the function f the necessary interpolation from the curvilinear grid to the cartesian grid is accomplished by first efficiently obtaining the foot of the normal that passes through a given cartesian grid point r x y exterior to and near the boundary section 3 3 and then using a local two dimensional interpolation procedure to produce the corresponding continuation value at the point r section 3 4 once the interpolated values have been obtained throughout the cartesian mesh 6 around the desired two dimensional fourier continuation function f c x y nx 2 nx 2 1 ny 2 m ny 2 1 f c me 2 i x lx my ly 3 1 where lx and ly denotes the period in the x and y directions respectively is obtained by means of a 2 d fft following the algorithmic prescriptions presented in sections 3 1 through 3 4 a summary of the overall 2 d fc approach is presented in section 3 5 3 1 two dimensional tangential normal curvilinear grid the necessary curvilinear grids around can be produced on the basis of a smooth parametrization r q x y 0 2 3 2 of the boundary in view of their intended application blending to zero along the normal direction in accordance with section 2 2 the curvilinear grids are introduced within interior and exterior strips v and v illustrated in figure 2 given by v q n 0 2 and 0 d 1 k 1 v q n 0 2 and 0 ck 1 3 3 where n nx ny denotes the unit normal to the boundary at q and where d c and k 1 denote respectively the number of matching points the number of blending to zero points and the stepsize used in the present application of the 1 d blending to zero procedure described in section 2 2 using in addition the uniform discretization ib p pk 2 0 p b k 2 2 b 3 4 of the interval 0 2 we then construct a curvilinear two dimensional discretization v b d rp q rp q q p n p q d 1 k 1 0 p b and 0 q d 1 3 5 v b cr sp q sp q q p n p qk 1 nr 0 p b and 0 q cr 3 6 within v and v respectively for the given stepsize k 1 where cr cnr for certain integer refinement factor nr note that the points in v b d for q d 1 and the points in v b cr for q 0 coincide and that they lie on here the constants d c and nr are independent of b the continuation function is constructed so as to vanish at all points sp q v b cr with q cr let now r a 0 a 1 b 0 b 1 denote the smallest closed rectangle containing v and consider the equispaced cartesian grid of stepsize h h zi j xi yj xi a 0 ih yj b 0 jh 0 i nx 0 j ny 3 7 on r where the two dimensional continuation function values are to be computed we note that the size of the rectangle r along with the strips v and v decrease as the stepsize k 2 is decreased 3 2 computation of fc values on v b cr a continuation of the function f to the exterior of is obtained via application of the blending to zero procedure presented in section 2 2 cf remark 2 2 along each one of the normal directions inherent in the definition of the set v b cr for given p the d equidistant points sp q v b d 0 q d 1 which 7 figure 2 geometrical constructions underlying the 2 d fc procedure with reference to the various regions defined in sec tion 3 1 are indicated by the solid circles in figure 3 constitute a set dp of matching points that are used to effect the blending to zero procedure per the prescriptions presented in section 2 2 to obtain the desired continuation function values it is necessary to first obtain the vector fdp of the values of the function f or suitable approximations thereof on the set dp in the proposed method the needed function values fdp are computed on the basis of a two step polynomial interpolation scheme using polynomials of a certain degree m 1 as briefly described in what follows with reference to the right image of figure 3 and considering first the case nx p ny p the algorithm initially interpolates vertically the function values at m open circle cartesian points selected as indicated in the figure onto the points of intersection shown as red stars of the normal line and the vertical cartesian grid lines for intersection red star points close enough to the boundary boundary function values at boundary points shown as squares in the figure are utilized in the one dimensional interpolation process as well once the red star function values are acquired the function value at the matching solid black point is effected by interpolation from the m red star point values previously obtained on the basis of a polynomial of degree m 1 the case nx p ny p is treated similarly substituting the initial interpolation along vertical cartesian lines by interpolation along horizontal cartesian lines the algorithm then proceeds in an entirely analogous fashion figure 3 interpolation scheme for evaluation of fdp in the case nx p ny p left black solid circles indicate the matching points that define the set dp right known function values at the cartesian points denoted by the empty circles and in some cases at the point of intersection represented by an empty square of the vertical grid lines with are used to interpolate the matching function values at the red star intersection points of the normal with the vertical grid lines the function values at the red points are then used to obtain by interpolation the function values at the matching points 8 3 3 proximity map as described below in section 3 4 the 2 d fc algorithm interpolates the fourier continuation values on v b cr onto the cartesian mesh h the interpolation algorithm used in that section relies on a certain proximity map p h v v b cr which associates a curvilinear grid point sp q p zi j v b cr in the proximity of each given cartesian grid point zi j the proximity function we use is obtained by first associating to each curvilinear discretization point sp q the nearest cartesian point a procedure that results in a set p 0 h v v b cr of pairs of points one in the cartesian grid and the other in the curvilinear grid the initial set p 0 can easily be obtained by using the integer part floor b c and the ceil d e operators the set p 0 is then modified by removing multiple associations for a given cartesian point and if necessary by adding a next nearest curvilinear neighbor to cartesian points that previously remained un associated the resulting set p defines the desired function 3 4 fc values on the cartesian grid once fourier continuation values on v b cr have been obtained per the procedure presented in section 3 2 the two dimensional fc scheme can be completed by a interpolation onto the set h v of outer cartesian grid points and b subsequent evaluation of the corresponding fourier coefficients in equa tion equation 3 1 by means of an fft note that since the continuation function f c is a smooth function which vanishes outside v this function can be viewed as the restriction of a smooth and bi periodic function with periodicity rectangle r whose fourier series approximates f c and therefore f accurately the efficiency of the interpolation scheme is of the utmost importance in this context since interpolation to a relatively large set h v of cartesian points is necessary an accurate and efficient interpolation strategy is obtained by combining two one dimensional local interpolation procedures based on nearby normal directions the first interpolation procedure produces the parameter value of the foot of the normal to passing through a given cartesian point the second procedure then approximates the contin uation function value utilizing the parameter value just mentioned and the continuation function values at the points in v b cr around the given cartesian point a detailed description of the combined interpola tion methodology is presented in what follows specifically we describe the strategy we use to interpolate the continuation function onto each point q zi j h v and to do this we first obtain the foot f q of this point using the proximity map p described in section 3 3 the algorithm utilizes the curvilinear discretization point sp q p zi j v b cr as well as the corresponding boundary discretization parameter value p according to equation 3 6 the point q p equals the foot of the normal passing through sp q q p f sp q the algorithm then seeks approximation of the foot f q and the corresponding parame ter value q via a preliminary interpolation step as indicated in what follows the foot f q and the corresponding parameter value q are then used by the algorithm to produce the desired interpolated continuation value at q in order to obtain f q the algorithm uses the m boundary parameter values in the set s p p k p k 1 p p 1 p kr ib 3 8 around p where kr k 1 m and where kr k if m is odd and kr k 1 if m is even parameter values k with negative values of k which may arise in equation 3 8 are interpreted by periodicity k b k the algorithm then utilizes the line l q passing through q that is orthogonal to the normal vector n p see left image in figure 4 together with the parametrization trq of l q where the parameter represents the signed distance of the points on l q from the point q clearly then tr q 0 q each point of intersection of l q with the normals n j j s p on the other hand equals tr q j where j denotes the signed distance between q and the corresponding intersection point thus defining the 9 function t where t gives the parameter value of the foot of the normal through the point trq we clearly have j t j p k j p kr 3 9 it follows that a 1 d interpolation procedure on the function t can be used to obtain the desired approximation of the value q t 0 of the parameter corresponding to the foot of the point q zi j f q q q q t 0 once we have the corresponding foot parameter value q for the given cartesian point q the distance q of the point q to the boundary is easily computed let s q ib be a set of m boundary parameter values similar to the set s p defined in 3 8 but with s q re centered around q in order to obtain the continuation function value at the point q using the continuation function values on v b cr we employ a local two dimensional polynomial interpolation scheme based on the set s q and the distance q as indicated in what follows and illustrated in the right image of figure 4 first the continuation values are obtained at each point marked by blue asterisks in the figure at a distance q from the boundary along the normal grid lines in v b cr that correspond to boundary parameter values in the set s q each one of these values is obtained via one dimensional interpolation of the continuation function values on v b cr along the corresponding normal grid line in v b cr the desired continuation value at the point q then is obtained via a final one dimensional degree m 1 interpolation step based on the parameter set s q and values at the blue asterisk points just obtained finally by applying the two dimensional fft to figure 4 interpolation schemes utilized to obtain the continuation function values on h v on the basis of the continuation values on v b cr left evaluation of the boundary parameter value for the foot of the normal line passing through q depicted as a finely dotted line passing through that point the left image also displays the set of red star interpolation points along the dashed orange line l q right interpolation of continuation values from the curvilinear mesh to a point q on the cartesian mesh the continuation function values computed above we then obtain the desired fourier series expression in 3 1 for the continuation function remark 3 1 function values on i for definiteness in this paper we have assumed that the bound ary data is provided in the form of values of the given function which corresponds to the the dirichlet boundary data in the pde context but the approach is also applicable in cases for which the boundary data is given as the normal derivative of the function neumann boundary data or even a combination of function and normal derivative values robin data by relying on a slightly modified blending to zero procedure of the type presented in 4 ii if no boundary data available the two dimensional fourier 10 continuation method can still be utilized on the basis of interior data only albeit with a certain reduction in accuracy near the boundary remark 3 2 extra vanishing values in 2 d as in the 1 d case prior to the fft procedure the grid h can be enlarged with vanishing function values assigned to the added discretization points to obtain a discretization containing a number of discretization points equal to a power of two or a product of powers of small prime numbers along each cartesian direction which leads to specially fast evaluations by means of the fast fourier transform figure 5 numerical errors in log log scale left graph and computing times required right graph in the 2 d fc approxima tion of the function f in 3 10 in the setting of example 3 1 the interpolating polynomial degree m d 3 was used in all cases the integer n equals the number of spatial grid points used over the diameter of the disc times reported correspond to averages over 10 runs 3 5 summary of the 2 d fc procedure this section presents a summary of the 2 d fc procedure described in the sections 3 1 through 3 4 for a function f given on a uniform cartesian gridh within the domain of definition whereh is a cartesian mesh over the rectangle r containing both and the near boundary outer region v see section 3 1 and in particular figure 2 the construction of the continuation function f c for the given function f relies on use of three main parameters associated with the 1 d blending to zero approach presented in section 2 namely d number of points in the set d c number of unrefined discrete continuation points and nos oversampling factor for the 1 d blending to zero fc procedure together with the parameters nr refinement factor for the discrete continuation points remark 2 2 and section 3 1 and m 1 degree of the interpolating polynomials sections 3 2 and 3 4 additionally the 2 d fc procedure utilizes the precomputed matrices ar and q which with reference to section 2 2 are obtained as per the description provided in remark 2 2 using the aforementioned parameters and matrices the algorithm proceeds in two main steps namely step a a geometrical setup precomputation procedure comprising points 1 through 4 below and step b a cartesian evaluation procedure comprising points 5 through 7 below part a only concerns geometry and for a given domain and configuration could be produced once and used for evaluation of fourier continuations for many different functions as is often necessary in practice the full 2 d fc algorithm thus proceeds according to the following seven steps 11 1 discretize the boundary using a smooth parametrization q x y 0 2 of and the uniform discretization ib 0 0 1 b 1 2 of the interval 0 2 section 3 1 2 using the discretization ib construct two curvilinear meshes v b d and v b cr in the near boundary regions v within and v outside respectively equations 3 5 and 3 6 note that the discrete boundary points q j with j ib are common to both v b d and v b cr 3 determine the set h v of cartesian grid points and construct the proximity map p h v v b cr section 3 3 4 for all q h v obtain the the parameter value q 0 1 of the foot f q of the normal through q section 3 4 and the left image in figure 4 5 for each normal grid line inherent in v b d and v b cr given by the discretization ib compute the blending to zero function values along that normal section 3 2 6 for all the points q h v obtain the continuation function value at q by local 2 d interpolation section 3 4 and the right image in figure 4 7 apply the two dimensional fft once to the continuation function values to obtain the desired fourier series in 3 1 3 6 2 d fc approximation numerical results this section demonstrates the accuracy and efficiency of the proposed 2 d fc method use of the 2 d fc method requires selection of specific values for each one of the following parameters all of which are introduced in sections 2 and 3 d number of points in the boundary section section 2 2 c number of continuation points section 2 2 z number of zero matching points section 2 2 nos oversampling factor used in the oversampled matching procedure section 2 2 nr refinement factor along the normal directions in v b cr remark 2 2 r the smallest rectangle containing v section 3 n nx ny number of points in the uniform spatial grid h section 3 b number of points in the boundary discretization section 3 m 1 interpolating polynomial degree sections 3 2 and 3 4 all the errors reported in this section were computed on a cartesian grid of step size h 2 within in all of the numerical examples considered in this article the parameter selections were made in accordance with remark 3 3 the computer system used in turn is described in remark 3 4 remark 3 3 parameter selections for a given step size h in the two dimensional cartesian grid h the normal and the boundary step sizes k 1 and k 2 section 3 were taken to coincide with h k 1 k 2 h the parameter values c 27 nos 20 z 12 and nr 6 were used in the evaluation of the matrices ar and q see section 2 2 and remark 2 2 and finally with exception of the interpolation degree experiments presented in example 3 2 table 2 and example 4 2 table 3 the interpolating polynomial degree m 1 d 2 was used for the various matching point numbers d considered remark 3 4 computer system all of the numerical results reported in this paper were run on a single core of a 3 40 ghz intel core i 7 6700 processor with 15 4 gb of 2133 mhz memory example 3 1 performance and efficiency of the 2 d fc method in our first example we consider a problem of fc approximation of the function f r given by f x y sin 5 x sin 5 y 3 10 12 h n b tp tf tv th rel err 2 10 2 100 313 2 1 10 3 2 6 10 3 1 7 10 3 6 5 10 3 4 7 10 4 d 41 10 2 200 628 4 2 10 3 5 2 10 3 3 8 10 3 1 2 10 2 2 7 10 55 10 3 400 1250 1 0 10 3 1 2 10 2 1 0 10 4 2 5 10 2 1 8 10 6 2 10 2 100 313 2 1 10 3 2 9 10 3 2 2 10 3 9 0 10 3 1 4 10 4 d 51 10 2 200 628 5 9 10 3 6 9 10 3 5 8 10 3 1 9 10 2 4 3 10 65 10 3 400 1250 1 1 10 2 1 3 10 2 1 2 10 2 3 1 10 2 1 4 10 7 2 10 2 100 313 2 2 10 3 3 9 10 3 4 2 10 3 2 6 10 2 4 1 10 5 d 101 10 2 200 628 4 3 10 3 6 6 10 3 8 8 10 3 4 7 10 2 1 6 10 7 table 1 times in sec required by the various tasks in the 2 d fc algorithm in the setting of example 3 1 the times reported were calculated as time averages over 10 runs the integer n equals the number of spatial grid points used over the diameter of the disc on the unit disc x y r 2 x 2 y 2 1 the left graph in figure 5 displays the relative and 2 errors in log log scale obtained from 2 d fc approximations of the function f for three different values of polynomial degree d defined in section 3 2 namely d 4 d 5 and d 10 demonstrating the respective fourth fifth and tenth orders of convergence expected higher rates of convergence which are useful in some cases can be achieved by using higher values of d as demonstrated in the context of the poisson solver in section 4 1 1 the corresponding computing costs including geometrical setup cost as well as the cartesian evaluation cost are presented in the right graph of figure 5 the geometrical setup cost combines the setup time for the grids section 3 1 v b d v b cr and h the time tp required for construction of the proximity map p section 3 3 and the time tf required for evaluation of the foot of the normal for all points in h v section 3 4 the cartesian evaluation time in turn equals the sum of the time tv required for evaluation of the f c values on the curvilinear grid v and time th required for subsequent interpolation onto the cartesian grid h table 1 reports additional details concerning computing times required by various tasks associated with the geometrical setup and cartesian evaluation for this example including the times tp tf tv and th the cartesian interpolation time th dominates the overall cartesian evaluation step cf table 1 in all of these cases we see that the computation time grows linearly with 1 h also the slope of the cartesian evaluation cost depends on the degree d whereas the geometrical setup cost which remains similar in all the cases considered in this example depends mainly on b and the refinement factor nr remark 3 5 use of higher degree gram polynomials comparison of the various accuracy and timing values reported in figure 5 suggests that use of lower 2 d fc degrees such as d 4 or d 5 may provide the highest efficiency for approximation accuracies up to single precision example 3 2 interpolation degree m 1 for a given 2 d fc order d our next example concerns the approximation of the trigonometric function f x 6 y 6 sin 10 x sin 10 y 3 11 defined over the kite shaped domain contained within the curve given by x cos 0 35 cos 2 0 35 y 0 7 sin for 0 2 a convergence study for this test case is presented in table 2 for the values d 4 and d 5 and with m d 1 m d 2 and m d 3 clearly the selections m d 2 and m d 3 provide similar accuracy in most of the 2 d fc approximation cases considered the value m d 3 which yields somewhat better interpolation accuracy for larger step sizes e g h 10 2 and which as illustrated in table 3 gives rise to some improvements for all step sizes in the poisson problem applications considered in section 4 1 was used in all of the numerical experiments presented in 13 this article except for the cases specifically designed to test the dependence of the accuracy on variations of the parameter m m d 1 m d 2 m d 3 h nx ny abs err order abs err order abs err order 1 10 2 297 197 1 8 10 3 1 4 10 3 9 2 10 4 d 4 5 10 3 537 337 2 0 10 4 3 2 9 0 10 5 3 9 3 1 10 5 4 9 2 5 10 3 1017 617 1 0 10 5 4 3 4 6 10 6 4 3 2 3 10 6 3 8 1 25 10 3 1977 1177 6 2 10 7 4 0 1 4 10 7 5 0 1 4 10 7 4 0 6 25 10 4 3897 2297 3 4 10 8 4 2 9 0 10 9 4 0 9 0 10 9 4 0 1 10 2 297 197 4 4 10 3 2 3 10 3 2 5 10 4 d 5 5 10 3 537 337 3 3 10 4 3 7 4 2 10 5 5 8 1 5 10 5 4 1 2 5 10 3 1017 617 1 8 10 5 4 2 4 3 10 7 6 6 2 6 10 7 5 8 1 25 10 3 1977 1177 4 1 10 7 5 4 6 4 10 9 6 1 4 1 10 9 6 0 6 25 10 4 3897 2297 1 2 10 8 5 0 1 3 10 10 5 6 1 3 10 10 5 0 table 2 convergence table for the 2 d fc method in the setting of example 3 2 for both d 4 and d 5 we observe the expected fourth and fifth orders of convergence respectively for all the three choices of m namely m d 1 m d 2 and m d 3 the value m d 3 leads to somewhat improved accuracy example 3 3 graphical illustration of the 2 d fc method figure 6 demonstrates the 2 d fc extension method for the function defined by f x y 4 1 x 2 y 2 sin 2 5 x 0 5 cos 2 y 0 5 over the kite shaped domain considered in example 3 2 both the original function and its extension are presented in figure 6 figure 6 demonstration of the 2 d fc procedure continuation of an oscillatory function defined on a kite shaped domain as detailed in example 3 3 the left and right images display the original and 2 d fc function values respectively the blue curve in the left image indicates the boundary of the kite shaped domain note the narrowness of the region wherein the transition to zero takes place 14 4 applications of the 2 d fc method the 2 d fc method introduced in section 3 can be used to facilitate spectral treatment in cases for which iterated use of the 1 d fourier expansions does not suffice but for which use of full 2 d fourier expansions is beneficial sections 4 1 and 4 2 briefly describe two such cases one concerning solution of the poisson problem via fourier expansions and the other the solution of the wave equation via a novel fourier forwarding ff technique a few numerical examples are presented illustrating the character of the resulting numerical solvers 4 1 application example i poisson problem in this section we present a 2 d fc based method for the solution of the 2 d dirichlet poisson problem u x y f x y x y u x y g x y x y 4 1 the corresponding problem under neumann or robin boundary conditions can be treated similarly only a brief sketch is presented here as an illustration of the 2 d fc approach a complete description of the method including a detailed geometrical treatment needed for reliable evaluation of the solution near boundaries is presented in 10 the proposed poisson solver obtains the solution u within the prescribed tolerance as a sum u up v 4 2 of a particular solution up produced by means of the 2 d fc method which satisfies the poisson equa tion u f but which generically does not satisfy the boundary conditions and a solution v of the homogeneous problem produced by means of a boundary integral equation which satisfies the dirichlet boundary value problem for laplace s equation v x y 0 x y v x y ghom x y x y 4 3 where ghom x y g x y up x y 4 4 a particular solution up for the problem 4 1 can easily be obtained from the 2 d fc expansion f c x y of the right hand function f x y equation 3 1 in view of the diagonal character of the laplace operator in fourier space we thus obtain up x y f c 0 0 x 2 y 2 4 nx 2 nx 2 1 ny 2 m ny 2 1 b me 2 i x lx my ly 4 5 where b m 0 if m 0 0 f c m 2 lx 2 2 m ly 2 if m 6 0 0 4 6 where one of a variety of possible selections was made for the constant laplacian term in view the asymptotically small factors that relate the fourier coefficients b m to the original fc coefficients f c m it can be shown 10 that as illustrated in section 4 1 1 the rate of convergence in the overall numerical 2 d fc based solution u is of o hd 2 if a 2 d fc algorithm of o hd is utilized to compute the particular 15 solution up provided a sufficiently accurate method is subsequently used for evaluation of the homogeneous solution values up r of the particular solution at points r on the boundary are required as an input via 4 4 in the boundary value problem 4 3 for the laplace solution v it is therefore necessary to utilize an efficient method for evaluation of up at points r that are not part of the cartesian mesh h the straightforward procedure based on direct addition of all terms in 4 5 for each discretization point on does not match the optimal o n log n cost asymptotics enjoyed by all the other elements of the algorithm and is therefore avoided instead the proposed algorithm first obtains the values of the right hand side of 4 5 for all r h via a direct application of the fft algorithm and then using these values it produces the values for r via iterated one dimensional interpolation as described in 21 sec 3 6 1 in order to match the overall order d 2 accuracy of the overall poisson solution one dimensional polynomial interpolants of degree mp 1 d 2 cf example 4 2 are used in this context for both the x and y interpolation directions the numerical solution of the laplace equation in 4 3 in turn can be obtained rapidly and efficiently on the basis of the boundary integral method see e g 18 relying on the boundary parametrization 3 2 the proposed algorithm incorporates an integral equation with a smooth kernel together with the simple and effective nystr m algorithm presented in 18 sec 12 2 based on trapezoidal rule quadrature this algorithm results in highly accurate solutions in view of the periodicity and smoothness of the solution and the kernel the approach yields super algebraically small errors provided the boundary and right hand side ghom are both smooth the associated linear system is solved by means of the iterative linear algebra solver gmres 22 note that the integrand exhibits a near singular behavior for evaluation points that are near the boundary but that are not on in order to address this difficulty the proposed method uses a scheme some elements of which were introduced in 2 7 which based on local mesh refinement and subsequent interpolation using polynomial of degree mp 1 successfully resolves this difficulty a detailed description of this and other aspects concerning the 2 d fc based poisson solver is presented in the forthcoming contribution 10 once the particular and homogeneous solutions up and v have been obtained the solution u of the poisson problem is given by 4 2 the numerical convergence rate of the solution produced by the algorithm is mainly determined by the order d of the 2 d fc algorithm used in all the method is fast and highly accurate a few illustrations including accuracy and timing comparisons with leading solvers are presented in the following section 4 1 1 numerical illustrations for the poisson problem the numerical illustrations presented in this section utilize the 2 d fc parameter selections presented in remark 3 3 with various choices of the order parameter d in addition the size of the uniform boundary discretization used by the trapezoidal rule based nystr m method is taken for simplicity to equal nx but of course in view of the super algebraic convergence of the trapezoidal rule quadrature a smaller discretization size could have been used without sacrificing accuracy the 2 and errors reported in this section were computed over the cartesian grid h unless indicated otherwise the first poisson solver example concerns a simple problem previously considered in 13 example 4 1 high order 2 d fc based poisson solution we consider the poisson problem 4 1 in the domain x y r 2 x 2 y 2 1 with f sin 2 x sin 2 y the left portion of figure 7 presents the numerical errors in the solutions produced by the 2 d fc based poisson solvers for d 4 d 6 and d 8 for f sin 2 x sin 2 y the observed rates of convergence for all the three cases match the expected increased rates of convergence as discussed in section 4 1 that is rates convergence of orders 6 8 and 10 respectively this problem was also considered in 13 comparison of the results presented in 13 fig 8 and those on the left graph in figure 7 suggests the 2 d fc based poisson solver performs favorably for high accuracies for instance a number n 100 of spatial grid points over the diameter of 16 that is to say nx 154 grid points over one length of the rectangular computational domain provides as shown in the figure 7 an 2 error 1 4 10 12 whereas in 13 fig 8 a similar discretization provides 2 errors close to 10 9 the 10 12 error is achieved in that reference at a number of approximately 275 points in spatial discretization points in each spatial direction for a different test case in this problem setting we now take f sin 5 x sin 5 y a function that was also used for the convergence study of the 2 d fc algorithm as presented in example 3 1 and we report on the right graph in figure 7 the numerical errors in the solution produced by the solvers for higher values of d namely d 10 and d 12 once again the expected convergence rates in this case of orders 12 and 14 respectively are observed in practice figure 7 numerical solution errors in log log scale resulting from use of the 2 d fc based poisson solver over the unit disc example 4 1 left graph solution errors for 2 d fc methods of orders d 4 d 6 and d 8 for the function f sin 2 x sin 2 y right graph solution errors with d 10 and d 12 for the function f sin 5 x sin 5 y the parameter n denotes the number of spatial grid points used over the diameter of the disc a total of nx ny n 2 c points c 27 were used over each dimension of the periodic square r as discussed in the text a convergence rate of order d 2 results from use of a 2 d fc approximation of order d m mp d 1 m mp d 2 m mp d 3 h nx ny rel err 2 order rel err 2 order rel err 2 order 4 10 2 117 93 6 0 10 6 7 5 10 7 4 1 10 7 2 10 2 177 127 1 7 10 7 5 1 1 0 10 8 6 2 6 3 10 9 6 0 1 10 2 297 197 5 2 10 9 5 0 1 5 10 10 6 1 8 7 10 11 6 2 5 10 3 537 337 1 6 10 10 5 1 2 6 10 12 5 9 1 2 10 12 6 2 4 10 3 657 407 5 2 10 11 4 9 6 8 10 13 6 0 3 0 10 13 6 2 table 3 convergence of the 2 d fc based solution of the poisson problem described in example 4 2 example 4 2 poisson solution interpolation degree mp 1 once again we consider the prob lem 4 1 over a kite shaped domain as in example 3 2 with f sin 2 x sin 2 y the errors in the solutions produced by the 2 d fc based poisson solver and the corresponding convergence rates for d 4 and three different values of mp m namely mp d 1 mp d 2 and mp d 3 are presented 17 in table 3 the observed rates of convergence formp d 2 andmp d 3 show the increased d 2 6 th order convergence rate whereas the selection mp d 1 5 shows a fifth order convergence as the overall error in the poisson solution is dominated by the error associated with the order five interpolation process the valuemp d 3 is utilized for all poisson problem numerical results presented in this paper example 4 3 highly oscillatory poisson problem here we consider the problem 4 1 over the kite shaped domain considered in example 3 2 with the highly oscillatory right hand side f sin 40 x sin 40 y in this example where we have used d 10 for the 2 d fc particular solution algorithm the overall con vergence rate as reported in table 4 is close to the expected convergence rate of order d 2 in order to avoid near singular integration problems which arise under the fine discretizations considered in this example as the numerical solution is evaluated at points very near the boundary here we report the error at all the cartesian points within the computational domain that are at a greater distance from than 0 2 near boundary evaluation algorithms capable of evaluating the solution at points arbitrarily close to are presented in 10 h nx ny rel err order rel err 2 order 5 10 3 537 337 9 3 10 4 3 4 10 4 2 5 10 3 1017 617 6 0 10 8 13 9 1 7 10 8 14 3 1 25 10 3 1977 1177 5 8 10 12 13 3 1 6 10 12 13 4 table 4 interior errors in the numerical solutions produced by the 2 d fc based poisson solver of order d 10 in the setting of example 4 3 errors are computed over points lying at a distance 0 2 from the domain boundary see example 4 3 a scaling error even better than the expected order d 2 12 was observed in this case 4 2 application example ii fourier forwarding ff method for wave propagation problems this section presents the 2 d fc based fourier forwarding method ff for the solution of the wave equation and other constant coefficient hyperbolic problems only a brief sketch of the ff approach for demonstration purposes is presented here a detailed account of this methodology including a variety of techniques designed for treatment of boundary conditions and with application to linear hyperbolic systems including e g treatment of propagation in anisotropic media is presented in the forthcoming contribution 9 in what follows attention is restricted to the initial boundary value problem for the wave equation in 2 d namely utt c 2 uxx uyy for x y t r 4 7 with initial conditions u x y t t 0 f x y and ut x y t t 0 g x y for x y and with appro priate boundary conditions on in order to obtain a solution of this problem the ff method 1 exploits the fact also used in 15 24 in the context of bi periodic problems that the solution of the wave equation in all of r 2 with the initial data u r 0 aei r and ut r 0 bei r is itself given in closed form as a combination of two time domain plane waves and 2 constructs auxiliary solutions ufc x y t tj of the form ufc x y t tj nx 2 nx 2 1 ny 2 m ny 2 1 a m t tj e 2 i x lx my ly 4 8 of equation 4 7 utilizing the 2 d fc algorithm on certain initial solution values at various times tj j t j 0 n with a large time step value t that is selected so as to optimize the overall computational 18 cost of the ff algorithm and for an arbitrary user prescribed positive integer n in view of the limited domain of dependence of solutions of the wave equation 17 the auxiliary solution ufc x y t tj for tj t tj 1 provides a valid numerical approximation of the solution u x y t over a certain subset t r x y dist r c t away from the boundary of the domain to compute the solution ub x y t tj on the region t adjacent to the physical boundary the ff method uses a classical time stepping scheme with spatial derivatives obtained by means of the 1 d fc method and using a typically much smaller time step t which should be small enough so to ensure stability as dictated by the cfl condition and to yield an accuracy level consistent with that inherent in the 2 d fc approximation used in what follows we discuss the evaluation of the solution u x y t ufc x y t t 0 for x y t t t 0 t 1 ub x y t t 0 for x y t t t 0 t 1 4 9 for the time interval t 0 0 t t 1 t a similar procedure can be used to evaluate inductively the solution at all other time intervals tj t tj 1 for notational simplicity the argument t 0 is suppressed in what follows in order to obtain the auxiliary solution ufc x y t the method utilizes the cartesian grid h equa tion 3 7 together with the 2 d fc expansions f x y nx 2 nx 2 1 ny 2 m ny 2 1 f c me 2 i x lx my ly g x y nx 2 nx 2 1 ny 2 m ny 2 1 g c me 2 i x lx my ly 4 10 cf equation 3 1 of the initial data f x y and g x y note that while f and g are obtained from the given initial conditions in the present case j 0 they are produced from the numerical values of the solution u x y t t tj and its time derivative ut x y t t tj in the case j 0 clearly provided the functions a m t in 4 8 satisfy the equations a m t ma m t 0 a m t t 0 f c m a m t t t 0 g c m 4 11 for nx 2 1 nx 2 and ny 2 1 m ny 2 where m 2 c 2 lx 2 m ly 2 the function ufc x y t satisfies 4 7 as well as the initial conditions ufc x y t t 0 f x y and ufc x y t t t 0 g x y for x y r 2 substituting the explicit solutions a m t f c m tg c m for m 0 0 f c m cos mt g c m m sin mt for m 6 0 0 4 12 of the ode 4 11 into 4 8 the solution ufc x y t for x y r 2 is obtained an application of the two dimensional spatial inverse fft over the cartesian grid h to the coefficients a m t 1 then yields per the discussion above concerning domains of dependence a numerical approximation of the solution u x y t for t 0 t t 1 and for all x y h t note that the accuracy of the auxiliary solution in its domain of validity t at time t t 0 t t 1 is only limited by the accuracy of the underlying 2 d fc approximation of the functions f and g by the fc expansions f and g throughout respectively to obtain the near boundary solution ub x y t on the other hand the method uses a classical explicit time stepping scheme in a certain open set b t adjacent to the boundary in the proposed near boundary evaluation algorithm which is based on use of the small time step t on a cartesian grid on 19 b various time stepping schemes including the adams bashforth 19 and the taylor series 5 methods can be utilized the required spatial derivatives in turn are computed with spectral accuracy and without dispersion by means of the 1 d fc method section 2 2 cf also 4 8 in the present j 0 case the initial values for ub are obtained from the initial conditions f x y and g x y for subsequent time intervals the solution process for ub is simply continued forward in time no additional initial values are needed for ub at the start of the time intervals tj tj 1 for j 0 boundary conditions for ub must be enforced at all boundary points in h t including those near and those near t the boundary condition at cartesian points near is enforced with high order accuracy as proposed in 5 on the basis of a certain interpolation procedure which utilizes the given boundary values on as well as previously obtained solution values on interior points of h the corresponding boundary condition at cartesian points near t on the other hand are produced for efficiency by means of a special procedure 9 which avoids a full evaluation of the fc expansion for ufc at each small t time interval and each boundary point and which constructs and use instead solutions similar to 4 8 without imposition of boundary conditions but over some small square regions contained in and centered at points on the interior boundary of t combining the 2 d fc forwarded solution ufc and the near boundary solution ub according to 4 9 the desired ff numerical approximation of the solution u throughout the cartesian set h is thus obtained up to time t t repeating this procedure as many times as necessary the solution can be advanced up to t n t for arbitrarily large values of n and thus up to an arbitrary final time t in view of the fact that auxiliary solutions ufc x y t need to be computed only once per large time step t a significant improvement in the asymptotic global computational cost per small time step t results over the cost required by classical finite difference and finite element spatial discretizations indeed calling the thickness of the boundary region t letting nc h 0 and assuming the cartesian mesh h contains a total of o n discretization points it follows that t contains a total of o nnc grid points as shown in 9 the optimum value of nc is o n 1 4 so that the computational cost per time step of the overall ff algorithm is o n 3 4 logn operations as shown in that contribution further owing to a certain large multiplicative constant in front of the asymptotic cost estimate for the time stepping portion in the boundary region t large increases in n are necessary for the optimal nc value to increase by one or a few units thus in the numerical examples considered in the present paper for all of which we have n 4 106 the value of nc is set to a constant this selection leads to an overall cost estimate of approximately o n operations for the cases considered in this paper as the asymptotically large o n logn fft cost incurred by the algorithm has in fact a limited impact in such cases a detailed discussion in this regard is presented in 9 the performance of the resulting fourier forwarding method for a number of test cases is demonstrated in section 4 2 1 below figure 8 accuracies and computing times in seconds for the problem considered in example 4 4 left graph maximum absolute errors at time t 2 for various wavelengths right graph computing times required for each small t time step fifteen points per wavelength and nc 6 points across the boundary region were used for this numerical experiment 4 2 1 numerical examples for the fourier forwarding method two examples presented in this section demonstrate the character of the ff method the numerical examples presented in this section were produced using fourier continuations of order d 4 for both the 20 1 d fc for time stepping in the boundary region and the 2 d fc for interior fc forwarding algorithms in both the cases the 2 d fc parameter selections were made in accordance with remark 3 3 and the simulations were run in the computer described in remark 3 4 for time stepping in the boundary region we have utilized second order taylor series method with the cfl number 0 125 example 4 4 accuracy and efficiency of the ff method in this example we demonstrate the accuracy in the wave equation solution obtained via the ff method as well as other properties namely dispersionlessness and sublinear computing costs enjoyed by the ff algorithm section 4 2 via the method of manufactured solutions here we consider the wave equation 4 7 with the initial and dirichlet boundary conditions taken such a way that the exact solution is given by u x y t cos 2 x t 3 cos y t 4 13 on the unit disc x y r 2 x 2 y 2 1 a fixed fifteen spatial points per wavelength and a fixed number nc 6 of points across the boundary region nch have been utilized for this numerical experiment in left graph of figure 8 we report the maximum absolute error computed over all the cartesian grid points within of the solution produced by the ff method at time t 2 the required computational times for each small t time step for various spatial frequencies cf 4 13 are reported in right graph of figure 8 as discussed at the end of section 4 2 we have observed an o n 1 2 logn growth in the computational time as the size n of the spatial discretization grows figure 9 fourier forwarding method applied to an interior domain wave propagation problem described in example 4 5 the solution is shown from top left to bottom right after 100 500 2050 2750 3200 and 4300 timesteps example 4 5 interior domain wave scattering for an interior domain graphical demonstration of the ff method we consider the wave equation problem with boundary condition u cos s exp s 2 2 g t 4 14 where s t r r 0 r r 0 and g t 0 for t 0 1 exp 2 0 exp t 0 t t t 0 1 0 for t t 0 1 for t t 0 4 15 21 with r 0 1 1 0 72 t 0 0 05 and 20 the pde domain is the interior of the kite shaped curve considered in example 3 2 a fixed number nc 8 of points across the boundary region and slightly over 20 points per wavelength have been utilized in this numerical experiment vanishing initial values of u and ut at t 0 were used note that both the imposed boundary values 4 14 vanish for t t 0 0 for clear visibility a version of the computed solution values at certain selected times scaled by the maximum value at that specific point in time are displayed in the left portion of figure 9 the scaling values range approximately between 1 and 3 and they are nearly equal to 1 for the first four images all three in the upper row and the leftmost image in the lower row 5 conclusions this paper introduced a novel two dimensional fourier continuation 2 d fc method for bi periodic extension of functions defined on arbitrary smooth two dimensional domains applications to the poisson and wave equation problem including the development of the fourier forwarding method have resulted in numerical pde solvers of high orders of accuracy and most importantly of extremely low numerical dispersion extensions of these methodologies to problems in higher dimensions and to problems on non smooth domains are left for future work acknowledgments this work was supported by nsf and darpa through contracts dms 1714169 and hr 00111720035 and by the nsseff vannevar bush fellowship under contract number n 00014 16 1 2808 references 1 b adcock d huybrechs and j mart n vaquero on the numerical stability of fourier extensions foundations of computational mathematics 14 2014 p 635 687 2 e akhmetgaliyev o p bruno and n nigam a boundary integral algorithm for the laplace dirichlet neumann mixed eigenvalue problem journal of computational physics 298 2015 pp 1 28 3 n albin and o p bruno a spectral fc solver for the compressible navier stokes equations in general domains i explicit time stepping journal of computational physics 230 2011 pp 6248 6270 4 f amlani and o p bruno an fc based spectral solver for elastodynamic problems in general three dimensional domains journal of computational physics 307 2016 pp 333 354 5 d appel and n a peterson a fourth order accurate embedded boundary method for the wave equation siam journal of scientific computing 34 2012 pp 2982 3008 6 t askham and a j cerfon an adaptive fast multipole accelerated poisson solver for complex geometries journal of computational physics 344 2017 pp 1 22 7 o p bruno and b delourme rapidly convergent two dimensional quasi periodic green function throughout the spectrum including wood anomalies journal of computational physics 262 2014 p 262 290 8 o p bruno and m lyon high order unconditionally stable fc ad solvers for general smooth domains i basic elements journal of computational physics 229 2010 pp 2009 2033 22 9 o p bruno and j paul 2 d fc based fourier forwarding wave equation solver in preparation 10 2 d fc based poisson solver in preparation 11 k t elgindy a high order embedded domain method combining a predictor corrector fourier continuation gram method with an integral fourier pseudospectral collocation method for solving linear partial differential equations in complex domains journal of computational and applied math ematics 361 2019 pp 372 395 12 h feng and s zhao fft based high order central difference schemes for three dimensional pois son s equation with various types of boundary conditions journal of computational physics 410 2020 p 109391 13 f fryklund e lehto and a k tornberg partition of unity extension of functions on complex domains journal of computational physics 375 2018 pp 57 79 14 g h golub and c f v loan matrix computations matrix computations johns hopkins university press 2012 15 i haber r lee h klein and j boris advances in electromagnetic simulation techniques in proc sixth conf on num sim plasmas berkeley ca 1973 pp 46 48 16 d huybrechs on the fourier extension of nonperiodic functions siam journal on numerical analysis 47 2010 p 4326 4355 17 f john partial differential equations applied mathematical sciences 1982 18 r kress linear integral equations applied mathematical sciences springer science and business media third ed 2014 19 r j leveque finite difference methods for ordinary and partial differential equations society for industrial and applied mathematics 2007 20 m lyon and o p bruno high order unconditionally stable fc ad solvers for general smooth domains ii elliptic parabolic and hyperbolic pdes theoretical considerations journal of computa tional physics 229 2010 pp 3358 3381 21 w h press s a teukolsky w t vetterling and b p flannery numerical recipes 3 rd edition the art of scientific computing cambridge university press usa 3 ed 2007 22 y saad iterative methods for sparse linear systems society for industrial and applied mathemat ics second ed 2003 23 d b stein r d guy and b thomases immersed boundary smooth extension a high order method for solving pde on arbitrary smooth domains using fourier spectral methods journal of computational physics 304 2016 pp 252 274 24 j l vay i haber and b b godfrey a domain decomposition method for pseudo spectral electromagnetic simulations of plasmas journal of computational physics 243 2013 pp 260 268 23 1 introduction 2 background 1 d blending to zero fc algorithm 2 1 1 d fc algorithm outline 2 2 blending to zero algorithm 2 3 1 d fc algorithm 3 two dimensional fourier continuation method 3 1 two dimensional tangential normal curvilinear grid 3 2 computation of fc values on v b cr 3 3 proximity map 3 4 fc values on the cartesian grid 3 5 summary of the 2 d fc procedure 3 6 2 d fc approximation numerical results 4 applications of the 2 d fc method 4 1 application example i poisson problem 4 1 1 numerical illustrations for the poisson problem 4 2 application example ii fourier forwarding ff method for wave propagation problems 4 2 1 numerical examples for the fourier forwarding method 5 conclusions