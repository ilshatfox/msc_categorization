branching structures emerging from a continuous optimal transport model enrico facca franco cardin mario putti abstract recently a dynamic monge kantorovich formulation of the pde based l 1 optimal transport problem was presented the model considers a diffusion equation enforcing the balance of the transported masses with a time varying conductivity that evolves proportionally to the transported flux in this paper we present an extension of this model that considers a time deriva tive of the conductivity that grows as a power law of the transport flux with exponent 0 a sub linear growth 0 1 penalizes the flux inten sity and promotes distributed transport with equilibrium solutions that are reminiscent of congested transport problems on the contrary a super linear growth 1 favors flux intensity and promotes concentrated transport leading to the emergence of steady state singular and fractal like config urations that resemble those of branched transport problems we derive a numerical discretization of the proposed model that is accurate efficient and robust for a wide range of scenarios for 1 the numerical model is able to reproduce highly irregular and fractal like formations without any a priory structural assumption optimal transport problems congested branched ramified transport p laplacian monge kantorovich formulation numerical solution 2000 49 k 20 49 m 25 49 m 29 35 j 70 65 n 30 1 introduction in this paper we propose and analyze theoretically and numerically an exten sion of the dynamic monge kantorovich dmk optimal transport ot model recently presented in facca et al 12 the dmk can be summarized as fol lows consider an open bounded connected and convex domain in rd with smooth boundary given two non negative rate densities f and f such that f dx f dx consider f f f we want to find the pair u 0 7 r r that solves t x u t x f x 1 a t x t x u t x t x 1 b 0 x 0 x 0 1 c completed with zero neumann boundary conditions here denotes derivative with respect to time hereafter we omit the dependence from x and kept only the time dependence we will use this convention whenever no confusion arises in facca et al 12 it is conjectured that the solution pair t u t as function of time converges for t towards u where is the ot density and u is a kantorovich potential associated to f and f the pair u solves the monge kantorovich mk partial differential equations introduced in evans and gangbo 11 local existence and uniqueness of t u t for t 0 0 with 0 0 depending on the initial data was proved under the hypotheses that 0 is ho lder continuous and f l however well posedness and full regularity of the solution as well as its convergence towards the solution of the mk equations 1 ar x iv 1 81 1 12 69 1 v 2 m at h n a 8 m ay 2 02 0 2 enrico facca franco cardin mario putti are still open issues the conjecture is strongly supported by convincing numer ical results reported in facca et al 12 13 additionally a lyapunov candidate functional for the dynamics is given by l 1 2 uf 2 dx 1 2 dx where uf indicates the weak solution of the elliptic equation eq 1 a for a given f it is possible to prove that l decreases along the t trajectory and the ot density is its unique minimizer 13 the extension we propose in this paper suggested by the discrete counterpart reported in tero et al 22 modifies the dynamics of t by introducing a power law of the transport flux t u t with exponent 0 the proposed model can be described as the problem of finding the pair t u t such that t u t f 2 a t t u t t 2 b 0 0 x 0 2 c completed with zero neumann boundary conditions assuming well posedness of the above system we claim that as in the case 1 the solution pair t u t converges toward an equilibrium configuration u as t moreover we claim that this equilibrium point should be related to congested 0 1 and branched 1 ot problems in fact intuitively a sub linear growth should penalize flux intensity i e the transport density and promote distributed trans port correspondingly the equilibrium solutions should be reminiscent of con gested transport problem ctp a branch of ot theory that studies realloca tion problems where mass concentration is penalized and finds applications in e g crowd motion and urban traffic see e g 7 9 21 on the other hand a super linear growth should favor flux intensity and promote concentrated transport leading to the emergence of singular and fractal like configurations that resemble the structures typical of branched transport problem btp branched trans port is an area of ot that studies reallocation problems where mass concentration is encouraged along the transport paths favoring economy of scale this is a common strategy that can be easily assumed to be a fundamental mechanism in the development of many natural systems such as e g tree branches and roots blood vessels river networks etc 1 2 19 note that any homogeneous positive function can replace the power law thus non linearly modulating the mixing of the different behaviors we are interested in the simpler case of the power law as a model problem that incorporates all the interesting responses the above claims are supported by extensive numerical experiments on a num ber of different two dimensional test cases and by some partial results and heuristic justifications among the latter we are able to derive a lyapunov candidate func tional l given by l ef m 3 a ef 1 2 uf 2 dx m 1 2 ln dx if 2 1 2 2 2 dx otherwise 3 b similarly to the case 1 l decreases in time along the t trajectory thus it is natural to investigate if the lyapunov candidate functional admits a minimum which is the natural limit candidate for our dynamics intuitively such minimum provides a trade off between the transport cost measured by the term ef and branching structures emerging from a continuous optimal transport model 3 the infrastructure cost measured by the termm for 0 1 the second term is convex penalizing the concentration of the support of as prescribed by the ctp on the other hand for 1 2 m is concave favoring the concentration of on narrow supports for the case 0 1 we claim that the pair t u t converges at long times toward up p 2 up with p 2 1 where up is the solution of the p poisson equation with forcing term f up p 2 up f this conjecture is supported by the fact that for q 2 minimization of l is equivalent to the following variational problem 4 inf v lq d v q q dx v f that is a classical formulation of the ctp the equivalence between problem eq 4 for q 1 2 and the solution of the p poisson equation with p conjugate to q is a well known result 10 the equivalence for 1 q 1 has been proved in facca et al 12 analogously to the case 1 studied in 12 13 this new formulation of the p poisson equation leads to robust and accurate numerical discretization schemes providing an unconventional yet very efficient approach at least with respect to the classical augmented lagrangian strategy usually adopted for the numerical solution of the p poisson equation 3 4 14 the case 1 is mostly addressed by numerical experimentation a number of two dimensional tests suggest a connection between the steady state equilibrium solution u of the proposed model and solutions of the btp in particular our reference formulation is that one introduced by xia 26 in this formulation eq 4 is rewritten in the case 0 q 1 where the integral must be reinterpreted appro priately thus we now look for a vector valued measure v solving for 0 q 1 the following minization problem 5 inf v m d dv dh 1 q dh 1 v f dx where dh 1 denote the hausdorff measure of dimension 1 see 21 23 for the de tailed definition although in our case we are still not able to exactly identify the relations with the reference btp formal calculations backed up by several nu merical results suggest strong connections with the functionals minimized in more classical bt problems more precisely we are not able to rigorously consider the singular measures typically arising in bt transport but the numerical results are convincingly leading to structures that closely resemble the bt transport solutions notwithstanding some evident numerical inaccuracies in approximating these singular structures and computational difficulties encountered in the solution of the highly ill posed linear systems arising from the discretization of the elliptic equa tion long time numerical solutions seem to invariably reach a state of equilibrium correspondingly depending on the source term the spatial distributions of the ap proximated transport density h seem to converge to fractal like or low dimensional structures these singular configurations are shown to be sensitive to initial condi tions probably corresponding to local minima of a non convex lyapunov candidate functional being the sum of a convex and a concave functional ef and m on the other hand all the numerical experiments presented in this paper show how the supports of h have the structure of an acyclic graph connecting the supports of f and f the absence of loops is a fundamental characteristic of the solution 4 enrico facca franco cardin mario putti of the btp never imposed a priori in our model that seems to suggest yet an other relationship between the long time numerical solution of dmk and the bt transport solution only sparse examples in the literature addressing the numerical solution of the bt problem exist both in the discrete 24 and in the continuous settings 17 in this last work the authors introduce a relaxed functional converging to the min imizer of problem in eq 4 as 0 a conjugate gradient algorithm combined with finite difference spatial discretizations is used to find sequence of approximated minimizer this approach has been showed to able to solve the btp in simple prob lem settings but still it suffers of the main problems we are facing in our approach e g parameters tuning convergence to local minima in conclusion of this introduction we would like to remark the similarities be tween the model proposed in our paper and the revisited version of the pp model presented in the discrete setting in 16 and in a continuous setting in the model of 15 where the modulating exponent is moved from the flux to the decay term of eq 2 in a recent analysis 8 studies a model that is similar to our proposed dynamics under special conditions and connects it to discrete optimization prob lems addressing ctp and btp moreover our work seems to be related to the work in 25 on the discrete p laplace with p 0 in this paper we want to highlight the optimization capabilities of the model that despite the above mentioned limitations seems to be well suited for the solution of optimal branched and congested transport problems without imposing any a priory graph topology this is particularly relevant in the case of btp where the topology of the optimal solution is actually the main unknown our results show that the relaxation introduced by the time dependency in our extended dmk allows a relatively easy numerical formulation that is efficient and robust 2 lyapunov candidate functional and its minimization the local existence result obtained in 12 could be extended to the case 1 but numerical simulations and theoretical considerations suggest that the assump tion of ho lder continuity of needs to be relaxed in this case any existence result seem out of reach at this time however being mostly concerned with the asymp totic behavior of t u t solution of eq 2 in this work we assume existence and uniqueness of a solution pair for all t 0 and present the formal deriva tion of the lyapunov candidate functional for all 0 as given by the following proposition proposition 1 assume that there exists t 0 such that eq 2 admits a solu tion pair t u t with c 1 regularity in time for t 0 t then the lyapunov candidate functional l given in eq 3 is strictly decreasing along the t trajec tories for all 0 and its lie derivative is given by 6 d dt l t 1 2 t u t 1 t u t 2 1 t 2 dx proof the proof is based on the equality d dt ef t 1 2 t uf t 2 dx branching structures emerging from a continuous optimal transport model 5 proved in 12 under the assumption of existence and uniqueness of the solution pair t u t as a consequence we can write d dt l t d dt ef t m t 1 2 t uf t 2 2 1 t dx substituting t defined by eq 2 b in the previous equation using for simplicity u t in place of uf t and rearranging terms we can write d dt l t 1 2 t u t t u t 2 2 1 t dx 1 2 t u t 1 t u t 2 1 t 2 dx which shows that the derivative of l along the t trajectories is strictly negative since t is always strictly greater than zero when starting from a positive initial condition 0 0 the same computations holds also for the case 2 from eq 6 we can formally deduce that the derivative of l is equal to zero only when evaluated at the pair u solution of 7 u f u 1 on 0 when 6 1 it is worth pointing out that these last equations coincide with those we would obtain by imposing t 0 in eq 2 b moreover eq 7 immediately suggests a link between the large time equilibrium state of eq 2 and the p poisson equation up p 2 up f if the following relation between the exponents and p holds p 2 1 however since we are not able to provide rigorous proofs for all values of 0 we analyze separately the cases 0 1 and 1 which as it will be seen later are related to the congested and branched transport problems respectively 2 1 case 0 1 in this instance we are able to show that the minimum of the lyapunov candidate functional l is related to the solution of a p poisson equation as stated in the following proposition proposition 2 let r r 2 q q 2 0 1 l be defined as in eq 3 and lr be the space of non negative functions in l r given f f l 2 with equal mass then 8 inf lr l inf v lq d v q q dx v f moreover the functional l admits a unique minimizer lr given by up p 2 where up is the weak solution of the p poisson equation 9 up p 2 up f with p the conjugate exponent of q i e p 2 1 6 enrico facca franco cardin mario putti proof we start the proof recalling the following variational characterization of the energy functional ef for a general non negative measure 6 ef sup w 1 p f dx 2 2 dx 10 inf w l 2 d w 2 2 dx w f where w 1 p is the classical sobolev space and with some abuse of notation l 2 v v 2 dx note that in the above result the divergence constraint is considered in the sense of distributions then we can rewrite l as l inf w l 2 d w w f lr 11 where w 1 2 w 2 dx 1 2 2 2 dx for any pair w lr l 2 d and for q 1 2 we use young inequality with conjugate exponents 2 q to obtain w q dx w q q 2 q 2 dx q 2 w 2 dx 2 q 2 q 2 2 2 q dx since q 2 q 2 which yields the relation q q 2 dividing by q we can rewrite the previous inequality as 12 w 2 2 dx 1 2 w 2 dx 1 2 2 2 dx w which holds for all lr and all w l 2 d now we take the infimum on both sides of the previous equation over the divergence constrained w l 2 d and use characterization eq 11 to obtain inf w l 2 d w 2 2 dx w f l lr taking the infimum over all lr yields 13 inf lr inf w l 2 d w 2 2 dx w f inf lr l according to the relationship between the solution of the p poisson equation and ctp we have that for any q 1 the optimal vector field is given by 10 ex 2 2 chap ter 4 argmin v lq d v q q dx v f v up p 2 up branching structures emerging from a continuous optimal transport model 7 where p is the conjugate exponent of q now for q 2 and thus p 2 1 and using eq 13 we obtain up p 2 dx v 2 2 dx infv l 2 d v 2 2 dx v f 14 inf lr inf w l 2 d w 2 2 dx w f inf lr l l ef m we can compute the term ef as follows by eq 10 the following chain of inequalities is obtained fup up 2 2 dx sup w 1 p f 2 2 dx ef inf w l 2 d w 2 2 dx w f up 2 2 dx noting that fup dx up p dx holds since up is the weak solution of eq 9 using up p 2 we obtain ef up p 2 dx using this equality in eq 14 and noting that p p 2 2 we obtain l ef m up p 2 dx thus all the inequalities in eq 14 are actually equalities and we can conclude that is a minimum which is unique since the functional l is strictly convex this last assertion follows from the observation that ef is convex being the supre mum of functionals that are linear with respect to andm is strictly convex for 0 1 remark 1 the assumption f f l 2 can be relaxed whenever f dx is well defined for all w 1 p propositions 1 and 2 suggest the formulation of the following conjecture for the case 0 1 conjecture 1 for 0 1 and for any initial data 0 the pair t u t solution of the extended dynamic monge kantorovich equations eq 2 converges to the pair up p 2 up where up is the solution of the p poisson equation with 15 p 2 1 remark 2 we want to emphasize two remarkable facts regarding conjecture 1 for 1 the exponent of the p laplacian tends to infinity p coherently with the fact that the mk equations are the limit of the p poisson problem as already shown e g in 11 at the same time the exponent q 2 tends to 1 in agreement with the equivalence between the mk equations and beckmann problem when 0 then t 1 and u t converges to the solution of a classical poisson problem p 2 thus it is possible to include also the value 0 in conjecture 1 8 enrico facca franco cardin mario putti 2 2 case 1 in this section we discuss our attempts to extend the argu ments presented in the previous section to the bt problem we are particularly interested in understanding if the functional l t which by proposition 1 is decreasing in time admits a minimum as t and that this minimum is actually attained at however in this case the lyapunov candidate functional is strongly non convex suggesting that several local minima exist as indicated also by the nu merical results reported in the next section that show strong dependence upon the initial data 0 mostly formal calculations and several numerical experiments con sistently point towards the existence of a strong connection between btp and the proposed formulation but we are not able to exactly identify the btp equivalent to the minimization of l in fact the first part of the proof of proposition 2 remains valid at least for the case 1 2 in which the exponent q remains positive indeed from eq 14 the following sequence of inequalities is derived inf v lq d v q q dx v f inf w w q q dx w l 2 l 2 d w f inf lr l this optimization problem resembles the btp formulation in eq 5 however we have to highlight an important difference between the two problems the formula tion in 23 uses integrals computed with respect to a hausdorff measure that well adapts to the singular structures arising in bt our computations on the other hand are made always with respect to the lebesgue measure indicating that re lation q 2 does not hold moreover for 2 l is not well defined for attaining zero on some regions of while we expect that the asymptotic will be zero on large portions of the domain these two elements suggest that a proper re formulation of the lyapunov candidate functional is required for 1 one possible strategy to reconcile our inability to address singular measures is inspired by the modica mortola approach effectively used in 17 20 the main idea is to introduce a parameter 0 in eq 12 and use young inequality with as parameter in order to weight differently the energy and mass terms ef and m in l intuitively should be raised to a suitable power that allows the different energy and mass components to scale correctly the main difficulty lies in the identification of the proper scaling power but this identification is at the moment still elusive despite these difficulties together with some not completely understood theoreti cal issues we present in the next section numerical simulations that suggest that sys tem eq 2 admits a steady state equilibrium u where the supports of the nu merical solutions h seem to approximate the typically singular low dimensional formations emerging in bt problems and the vector field v u solve the btp as formulated in 23 3 numerical solution of the extended dmk equations in this section we report several two dimensional numerical tests in support of our conjectures in particular we try to approximate explicitly the steady state solution of eq 2 and look at the qualitative behavior of the equilibrium configurations for t in the ctp 0 1 and btp 1 cases for 0 1 we test conjecture 1 comparing our results with an exact solution up of the p poisson equation for the case 1 several experiments point to the existence of a connection between the large time solution of our model and btp solutions for branching structures emerging from a continuous optimal transport model 9 different values of and varying types of source terms f and f including two largely different test cases employing distributed and a point sources our dynamics invariably converges to an equilibrium point in correspondence of which always displays branching singular structures 3 1 the numerical approach the discretization method is based on the fi nite element approach described in 12 13 eq 2 b is projected into a piecewise constant finite dimensional space defined on a triangulation th of the domain rd the elliptic equation in eq 2 a is discretized using linear conforming galerkin finite elements defined on a mesh th 2 obtained by uniform refinement of th approach called p 1 h 2 p 0 h we choose this spatial discretization method for its robustness and stability as shown in 13 accordingly the approxi mate pair h uh can be written as uh t x n i 1 ui t i x i p 1 th 2 h t x m k 1 k t k x k p 0 th where p 1 th 2 and p 0 th are piecewise linear conforming and piecewise constant fem spaces respectively the time discretization of the projected system is ob tained by means of forward euler time stepping denoting with k and uk the vectors collecting the values of h on the triangles and of uh on the nodes at the k th time step the following sequence of linear systems needs to be solved a k uk b 16 a k 1 k tk b u k k k 16 b where a k is the stiffness matrix associated to k and b u k is the matrix defining the norm of the gradient of uh t k x raised to the power the time stepping is initiated from 0 obtained by projecting the initial data 0 on the p 0 th space the above system is then iterated until the norm of the relative variation between two consecutive h solutions is smaller than the tolerance t i e var kh k 1 h kh l 2 tk kh l 2 t when this occurs we assume that the equilibrium configuration has been reached at each time step the linear system in eq 16 a is solved via preconditioned conjugate gradient pcg with an ad hoc preconditioning strategy this pre conditioner developed and discussed in details in 5 exploits the time stepping sequence to devise an efficient and robust deflation strategy whereby partial eigen pairs are evaluated to improve the spectral properties of the preconditioned linear system this approach is fundamental to achieve convergence of the iterations in particular for the case 1 remark 3 it is natural to impose a lower bound on h say 10 10 to bound from below the smallest eigenvalue of the stiffness matrix in the fem formulation and limit its condition number this was indeed our first attempt however we quickly realized that our approach is not influenced by this lower bound in fact the solution of the linear system at each time step is the same and requires exactly the same number of pcg iterations irrespectively of the presence of the lower bound also the dynamics of h and of the corresponding l for 0 2 are not affected 10 enrico facca franco cardin mario putti f 0 572 f 2 866 f 0 0 h h 2 h 4 h 8 5 10 3 10 2 5 10 2 err h 0 25 err h h 0 775 0 5 err h h 0 881 0 75 err h h 0 925 1 0 err h h 0 981 figure 1 left panel spatial distribution of the forcing term f x y f r the mesh points lie on the concentric circles that form the boundary of the supports of f and f center panel the spatial distribution of f and f right panel fem exper imental convergence for 0 25 0 5 0 75 1 0 the legend above the figure reports the experimental convergence rates for each value of by the lower bound on the other hand in the case 2 the lower bound influences the value of the lyapunov candidate functional which tends to as 0 3 2 numerical experiments 3 2 1 case 0 1 in this series of tests we compare the long time limit of h denoted with h against up p 2 where up is the solution of the p poisson equation for which an explicit formula is known and p 2 1 as given by eq 15 of conjecture 1 we consider a two dimensional example taken from 3 where the radially symmetric forcing term is given by f x y f r with r x 2 y 2 and f 0 1 7 r under these assumptions the exact solution of the p poisson equation is up x y u r 1 r sign z t z t 1 p 1 dt z r 1 r r 0 tf t dt according to the relation between p and we can write the following explicit formula for 17 x y z r p 2 p 1 z r note that this is well defined also for 1 a value corresponding to the case p this optimal density corresponds to the ot density solution of the mk equations a problem already considered within our setting in facca et al 12 13 in our numerical experiments we take f as a piecewise constant function posi tive in the interval 0 1 3 zero in 1 3 2 3 and negative in 2 3 1 the value of f on the positive and the negative parts is given by two constants c 1 and c 2 that are calculated to maintain orthogonality up to machine precision of the right hand side b of the linear system eq 16 a with respect to the constant vectors this tuning corrects for quadrature errors and is necessary to provide accurate approxi mations of the integrals and a priori exclude errors and inaccuracies introduced by the piecewise representations of the circles the mesh th and the forcing term f are shown in figure 1 branching structures emerging from a continuous optimal transport model 11 100 101 102 103 10 7 10 5 10 3 10 1 t var h 0 25 h h 2 h 4 h 8 100 101 102 103 10 2 10 1 100 t err h h h 2 h 4 h 8 100 101 102 103 t 0 50 h h 2 h 4 h 8 100 101 102 103 t h h 2 h 4 h 8 100 101 102 103 t 0 75 h h 2 h 4 h 8 100 101 102 103 t h h 2 h 4 h 8 100 101 102 103 10 7 10 5 10 3 10 1 var h 1 00 h h 2 h 4 h 8 100 101 102 103 10 2 10 1 100 t err h h h 2 h 4 h 8 figure 2 log log plots of var h t upper panels and err h t lower panels vs time the columns refer from left to right to the results obtained with 0 25 0 5 0 75 1 0 10 1 100 101 102 103 10 1 100 101 102 103 104 105 t l h 0 25 10 20 30 10 1 100 101 102 103 t 0 50 10 20 30 10 1 100 101 102 103 t 0 75 10 20 30 10 1 100 101 102 103 10 1 100 101 102 103 104 105 t l h 1 00 10 20 30 figure 3 time behavior of the lyapunov candidate functional l h t for 0 25 0 5 0 75 1 0 from left to right starting from three different initial data 0 we report the results only for the coarser mesh as they do not seem to depend on mesh resolution the numerical experiments consist in testing the existence of a steady state h for different values of 0 25 0 5 0 75 1 0 and evaluating the error with respect to the candidate exact solution err l 2 l 2 we solve the extended dmk equations on a sequence of uniformly refined grids and evaluate the experimental convergence rate by means of err h the sequence is built by uniform refinement of the initial unstructured mesh th characterized by 5191 nodes and 10179 triangles we generate it using python package meshpy con vergence in time is tested by looking at the evolution of var h t and err h t steady state is considered achieved when t 5 10 7 the experimental convergence rates are shown in figure 1 right panel and vary in the range m 0 775 0 981 for 0 25 1 respectively thus displaying optimal convergence of the spatial discretization figure 2 shows the log log plot of the time variation var h t top row and the relative error err h t bottom row as a function of time for the same values of from the first set of plots we can see that as time increases the variation tends towards zero as power law with a rate that is independent of the mesh level and decreases as the power increases in other words for any tested mesh the smaller the faster the equi librium configuration is reached the case 1 shows the slowest convergence towards steady state and some influence of the mesh resolution appears this is an evident signal of the difficulty of the mk problem the relative error figure 2 lower row stagnates at a relatively small time reaching values that decrease at a constant factor with the mesh level coherently with the experimental convergence 12 enrico facca franco cardin mario putti rates previously calculated note that for all practical purposes the time toler ance t could be increased to much bigger values without affecting the err h quantity that remains essentially stationary in all simulations after t 10 i e when var h t 10 3 10 4 however for reasons of numerical testing all our simulations are continued until the indicated tolerance t is achieved to conclude our exploration of this case we look at the time evolution of the lyapunov candidate functional l h t starting from three different initial data 0 i i 1 2 3 figure 3 shows the numerical results obtained for the uniform initial condition 01 1 and for the 0 2 3 distributions reported later in the left panel of figure 9 in all simulations l h t decreases monotonically and always attains the same minimum value independently of the initial conditions for all the starting points the value of l h t becomes numerically stationary before t 10 however its value continues to decrease but at progressively lower rates overall these results provide convincing support of the correctness of conjecture 1 3 2 2 case 1 in this section we discuss our numerical results related to ram ified transport by looking at some qualitative features that the solutions emerging from our proposed model share with more classical bt solutions reported e g in xia 26 we explore the numerical features of the discretization algorithm and its ro bustness by varying the exponent the mesh size parameter h and the initial conditions 0 we look at the time convergence of the solution towards an equilib rium point and at the behavior of the lyapunov candidate functional l as t all these results are critically assessed and are here submitted in support of our conjecture on the connection between the asymptotic configuration of our dynamics and the solution of the btp to this aim we consider three different test cases tc 1 tc 2 and tc 3 defined on the same domain 0 1 0 1 and characterized by varying the forcing function in tc 1 f and f are two constant functions with equal value and supports in the rectangular areas 1 8 3 8 1 4 3 4 and 5 8 7 8 1 4 3 4 respectively tc 2 considers f formed by 50 dirac source points randomly distributed in the region 0 1 0 9 0 1 0 9 while the sink term f is a single dirac mass located at 0 05 0 05 with intensity that balances f tc 3 simulates one dirac source transporting towards two dirac sinks yielding f 0 5 0 1 and f 0 5 0 4 0 9 0 5 0 6 0 9 for this last case the exact solution of eq 5 is known as a function of the exponent q and will be considered as reference solution however as already noticed in section 2 2 we do not possess the exact relationship between the exponent of our dmk approach and q of the standard bt formulation and thus only a qualitative comparison is meaningful sensitivity to initial data is tested for all three tcs by employing the same 0 i i 1 2 3 used in the previous example in addition for tc 3 we use initial data concentrated along the reference solution to verify that the dynamics will not move the solution away from a true initial guess we report the results for differ ent values of 1 1 1 5 2 0 3 0 in this case of ramified transport we expect h to concentrate on supports that tend to become progressively singular with respect to the lebesgue measure as the mesh is refined intuitively the numerical transport density should tend towards zero outside these supports while it remains positive and may grow indefinitely within these singular sets this behavior is magnified as grows correspondingly the ill conditioning of the linear system in eq 16 a grows signaled by the large increase of the condition number of the system matrix a well beyond the possibilities of current linear system solvers this phenomenon is intensified as increases for this reason we do not address values of larger than 3 for the considered simulations convergence of the conjugate gradient method is branching structures emerging from a continuous optimal transport model 13 100 101 102 103 10 7 10 5 10 3 10 1 t var h h h 2 h 4 h 8 100 101 102 103 10 7 10 5 10 3 10 1 t var h h h 2 h 4 h 8 figure 4 case 1 5 0 1 time evolution of var h t on successive mesh refinements for tc 1 left and tc 2 right achieved only when using the ad hoc preconditioner based on spectral information quickly described at the end of section 3 1 developed and thoroughly tested in 5 we experimentally test the numerical spatial convergence of the simulator by solving the same problem on successive refinements of an initial triangulation th for tc 1 we use an initial grid of 1615 nodes and 3100 triangles aligned with the supports of f and f while for tc 2 the initial mesh is characterized by 1661 nodes and 3192 triangles the 51 points where the f is concentrated coincide with grid nodes again for all practical purposes the value t 5 10 7 is more than enough to reach the equilibrium configuration we discuss the numerical behavior of the model by running simulations with 1 5 as a representative example we look at convergence towards equilibrium spatial experimental convergence behavior of the lyapunov candidate functional and sensitivity to initial conditions for all these tests the behavior of the numerical solution and the convergence properties of the discretization approach are similar also for the other tested values of in all the numerical simulations we experimented strong and sudden variations of h since the term kh b u k k k in eq 16 b can rapidly increase by several orders of magnitude this effect is amplified for larger values of to preserve the stability of the forward euler scheme we use a time step tk whose size is tuned according to term kh convergence towards equilibrium we first start our discussion by looking at the time evolution of var h t with uniform initial data 0 1 for both tc 1 and tc 2 figure 4 the behavior is globally decreasing but not monotone unlike the case 1 after a reasonably smooth initial transient the time evolution of var h t presents oscillations with a frequency that increases at increasing refinement levels despite this irregular behavior in both tcs all simulations seem to converge towards an equilibrium configuration h u h for all values of and for every grid and initial data 0 considered thus supporting our conjecture that the proposed dynamics converge towards a steady state the spatial distributions of the limit equilibrium configurations h are shown in figures 5 and 6 for 1 5 and 0 1 at successive grid refinements looking at the transient not shown here we observe supports of h defined as the union of all triangles in th where h is above a minimal threshold of 10 10 that initially coincide with but then as time progresses tend to create singular structures where h self organizes in narrow channels connecting the supports of f and f these emerging networks present a hierarchical structure in which channels with higher flow capacity determined by the values of h repetitively branch into sub channels until the whole support of f is covered the connection between disjoint f supports is ensured by the formation of a limited number of concentrated channels 14 enrico facca franco cardin mario putti th th 2 th 4 th 8 figure 5 tc 1 numerical approximation h for 1 5 and 0 1 logarithmic color scale the supports of f and f are contoured in black four successive mesh levels are shown the dotted rectangle in the lower central channel indicate the zoom window displayed in figure 7 the color scale is limited at the minimum threshold of 10 10 these emerging structures seem to approach a singular one dimensional tree like network where loops are absent notwithstanding the evident difficulty of comparing h at different refinement levels an underlying limit network is clearly appearing for all tested values of grid level or initial data 0 in particular for tc 1 we see in figure 5 that inside the supports of f h forms branching structures with seemingly fractal features in the region outside the supports of f h concentrates on a series of connected triangles that create a tight channel with high conductivity linking the source and the sink regions these effects persists at each refinement level and the support of h seems to approximate a one dimensional network in tc 2 we clearly perceive another phenomenon whereby several branches in the h tree depart from the expected rectilinear behavior we attribute this occurrence to a problem of mesh alignment of the numerical solution presumably to be ascribed to the extreme spatial irregularity of h we will discuss this difficulty later on however we are positively surprised by the capabilities of our numerical scheme to reproduce albeit with inaccuracies these singular structures a final remark on the emerging structure concerns the occurrence of topological changes between the singular h spatial distributions at different mesh refinement levels this is mostly apparent in tc 2 where we have highlighted with dotted circles substantial changes in the network topology as h decreases this phenomenon is an indication of the sensitivity to initial conditions of our bt model and correspondingly to the presence in the lyapunov candidate functional of several local minima to which our dynamics is attracted this sensitivity will be analyzed in a later section branching structures emerging from a continuous optimal transport model 15 th th 2 th 4 th 8 figure 6 tc 2 numerical approximation h for 1 5 loga rithmic color scale the initial data 0 is uniformly equal to 1 on the entire domain the small black circles indicate the approximate position of the dirac masses four successive mesh refinement lev els are shown in the bottom panels we have indicated with dashed circles the location of topological changes between two successively refined network structures the color scale is limited at the mini mum threshold of 10 10 figure 7 tc 1 behavior of h in the zoomed areas located in the central channels identified as dotted ovals in figure 5 logarithmic color scale the left panel reports the superposition of h for triangulations th and th 2 while the right panel superimposes th 4 and th 8 only the triangles where h is above the threshold 10 10 are shown experimental convergence of spatial discretization convergence with respect to h of these irregular structures is not easily verified to better appreciate the differ ences between two successive mesh levels we look at a magnification of the solution of tc 1 in the middle of one of the two channels connecting the source and the sink areas where h reaches its maximum the zoomed areas are identified in figure 5 with dotted ovals as seen in figure 7 this ideally low dimensional structure is ap proximated at each refinement level by a sequence of triangles mostly connected only at nodes the width of the cross section of these channels is always formed by one triangle and thus decreases linearly with h as the triangles are refined the total flux remains constant since the mass to be transferred from f to f is the same correspondingly h always achieves its maximum in the triangles forming the central channels with values that increase as the mesh is refined at finer 16 enrico facca franco cardin mario putti 10 1 100 101 102 103 10 1 100 t l h h h 2 h 4 h 8 10 1 100 101 102 103 10 1 t ef h h h 2 h 4 h 8 10 1 100 101 102 103 10 1 100 t m h h h 2 h 4 h 8 10 1 100 101 102 103 10 1 100 t r h dx h h 2 h 4 h 8 10 1 100 101 102 103 100 101 t h h 2 h 4 h 8 10 1 100 101 102 103 100 101 t h h 2 h 4 h 8 10 1 100 101 102 103 100 t h h 2 h 4 h 8 10 1 100 101 102 103 101 102 t h h 2 h 4 h 8 figure 8 time evolution of l h t ef h t m h t and h t dx left to right for tc 1 top and tc 2 bottom for all grid refinement levels in the case 1 5 0 1 levels the spatial distribution of h becomes more irregular especially within the supports of f as shown in figure 5 displaying sudden jumps of several orders of magnitude notwithstanding these irregularities the solution seems to converge towards some limit structure supporting our conjecture that the equilibrium at t is reached by our dynamics as a consequence the condition number of the matrix a h of the fem lin ear system eq 16 a increases drastically leading in some extreme cases to non convergence of the pcg solver as mentioned before the spectral preconditioner we use 5 is developed to particularly address these problems however this strat egy requires the construction of the incomplete cholesky factorization with partial fill in of the spd a h in eq 16 a which in radical occurrences of highly refined meshes and large typically in our experience for 3 may not exist and cannot be calculated in these cases we abort the simulation behavior of the lyapunov candidate functional we conjecture that the converged numerical solutions actually correspond to local minima for l thus we look at the time evolution of the lyapunov candidate functional l h t and its constituents ef h t m h t and h t figure 8 shows the time evolution of these components at the different refinement levels using 1 5 and 0 1 as starting data all the plots show an initial common behavior followed by a distinct pattern as a function of h intuitively higher resolutions allow better exploration of the state space and thus better asymptotic optimality possibly leading to varying structures it is interesting to note that the behavior for both tc 1 and tc 2 is consistent inasmuch as lower h leads to lower values of l moreover differences of the equilibrium l value at consecutive mesh levels remain constant corresponding to the constant ratio between subsequent h parameters these numerical simulations support the statements in proposition 1 on the decrease in time of the l h t note that similar results are obtained for all powers initial data 0 and for both forcing terms considered the presence of local minima is typically accompanied by sensitivity to initial conditions indeed unlike the case 1 we observe this dependence which in our cases clearly influences the asymptotic value l h sensitivity to initial conditions in this paragraph the above mentioned dependence upon the initial condition 0 is explored by running both tc 1 and tc 2 starting from different spatial patterns while the case 01 1 is shown in the previous branching structures emerging from a continuous optimal transport model 17 l 0 116 l 0 119 l 0 825 l 0 710 figure 9 spatial distribution of initial data 0 i for i 2 3 left panel and the corresponding asymptotic state h for tc 1 center and tc 2 right for the finest mesh and 1 5 the value of the lyapunov candidate functional l is displayed on the box under the color scale the color scale is limited at the minimum threshold of 10 10 table 1 values of the lyapunov candidate functional l h for 1 5 in test cases tc 1 and tc 2 for different initial conditions ic tc 1 tc 2 ic tc 1 tc 2 ic tc 1 tc 2 01 0 116 0 722 0 2 0 116 0 825 0 3 0 119 0 710 sections in figure 9 we report the h behavior obtained on the finest grid and for 1 5 starting from 02 and 0 3 whose spatial distributions is shown in the left column in the case of 02 where initial data attain their minimum value of 0 01 at the center of the square the supports of the equilibrium configurations of both tc 1 and tc 2 seem to avoid altogether regions of lower initial density on the other hand an oscillatory starting configuration leads to added aggregating and distributive areas in the supports of f and f for tc 1 this leads to the formation an additional central channel connecting f and f in tc 2 the resulting tree seems closer to the one obtained with uniform ics 01 rather than to the case of central penalization 02 this sensitivity to initial conditions suggests that the separate network patterns noted in figure 6 are a result of both better resolution and different time step size sequences hinting at the presence of local minima from which the dynamics is not able to evade indeed the value of l h summarized in table 1 in the case of three central channels tc 3 is larger than in the other two cases on the other hand for tc 2 similar l values are achieved for 01 and 03 with 0 2 being higher note that the fact that 0 3 results in a smaller value of l with respect to the 01 solution can be intuitively justified by observing from the spatial patterns shown in figures 6 and 9 that the checkerboard initial condition promotes connections between nodes that are more straight with respect to case of uniform ic these results seem to indicate a rather flat optimization horizon with a number of similar minima towards which our dynamics leans as a function of the initial conditions sensitivity to this paragraph explores the sensitivity of the proposed model to the power 1 1 1 5 2 3 figures 10 and 11 report h obtained for the different 18 enrico facca franco cardin mario putti 1 1 1 5 2 0 3 0 figure 10 behavior of the spatial distribution of for tc 1 for different values of the color scale starts from 10 4 but the white regions indicate where attains the minimum threshold value of 10 10 1 1 1 5 2 0 3 0 figure 11 behavior of the spatial distribution of for tc 2 for different values of the color scales start from different ini tial values but the white regions indicate where attains the minimum threshold value of 10 10 values of on the finest grid using uniform initial data 01 for tc 1 and tc 2 respectively looking at tc 1 for increasing values of the proposed dynamics tends to create networks that seem to increasingly promote concentration channels characterized by larger transport density seem to be sparser and the source and sink areas are connected by fewer singular structures in fact the number of central channels created at the equilibrium varies from three for 1 1 to one for 3 with the final configuration showing no branching points in the central channel in the tc 2 case a number of topological changes in the emerging networks are clearly noticed in the sequence moreover inaccuracies emerge in the form of curve shaped branching structures emerging from a continuous optimal transport model 19 1 1 1 5 2 0 3 0 01 02 04 y shape 0 9 05 steiner figure 12 spatial distribution of h for tc 3 starting form dif ferent initial data as identify by different colors the green and blue curves are obtained using 01 and 0 2 respectively the red and the black curves report the solutions obtained by using an initial distribution concentrated along the y shaped known solu tion of the standard branched transport problem for q 0 9 0 the different panels show the equilibrium configurations of h for 1 1 1 5 2 0 3 0 additionally each color is represented with two different intensities to show the solutions obtained with two different meshes of the same size but different node distribution the color scale is limited at the minimum threshold of 10 10 connections between branching points approximating the expected straight lines these inaccuracies grow as increases and are clearly visible already for 2 0 we argue that they are caused by the combined effects of grid alignment and the dependence upon the initial data leading to a configuration possibly related to a local minimum of the lyapunov candidate functional for both test cases we note branching angles that increase with as observed in the bt theory of xia 23 for decreasing values of q analogously for tc 2 the branching points move progressively away from the source nodes at increasing these results suggest that must increase as q decreases test case 3 tc 3 is designed to address two fundamental questions arising from the results of tc 1 and tc 2 first we would like to explore the influence on h of the grid geometry and of the initial data 0 then we would like to acquire some intuition on a possible relationship q in addition to the above observation that it must be a decreasing function in this test case the optimal vector field v solution of eq 4 is supported on a y shaped graph that branches at a point with coordinates 0 5 c q with c q a function that grows from 0 1 for q 1 0 to 0 8422 for q 0 0 26 note that the latter value of q corresponds to steiner problem for which the path branches at constant angles equal to 2 3 figure 12 shows a num ber of simulation results for different values of different initial conditions and different meshes each curve in a panel displays the large time solution obtained 20 enrico facca franco cardin mario putti with initial condition specified by the color codes in the top legend in particular the green and blue curves correspond to 01 and 0 2 respectively the initial condi tions identified with 04 and 0 5 red and gray respectively are the projection on th of the bt y shaped transport path for q 0 9 and q 0 for each initial guess we show two numerical solutions obtained from simulations run with two different triangulations of the same size but varying nodal distribution identified with the same color but different intensity the results reported in figure 12 suggests that the choice of the initial data 0 has a much stronger influence on the steady state configuration h than the triangulation th used in the discretization of eq 2 in fact we note that independently on the initial data 0 or the power the sup ports of h reported in figure 12 with darker and lighter colors clearly concentrate on the same limit structure which is only marginally influenced by the topological constraint imposed a priori by the graph associated with the triangulation on the other hand we clearly notice that the supports of h tend to concentrate on regions where 0 is larger a behavior already observed in tc 1 and tc 2 for 0 0 4 0 5 the dynamics is not able to drive h away from the strongly pre imposed paths for 0 0 2 h distributes on two separate branches concentrating on regions with initially higher conductivities such behavior is more pronounced as grows for the case 0 0 1 where the initial data is uniformly distributed and there is no a priori bias the support of h forms a y like shape with a bifurcation point at 0 c with c that is gradually increasing with however we note how the point 0 c does not quite reach the bifurcation point 0 c q of the reference solution for q 0 9 even for the largest value 3 0 unfortunately the only conclusion that can be deduced from this and the other test cases not reported here is the already mentioned decreasing behavior of q the strong dependence of our dynamics on the initial data does not allow a more accurate characterization of this relation 4 conclusions and discussion we have presented and discussed an extension of the dmk model where the transient equation for is modulated by a power law of the transport flux with exponent 0 the original dmk model introduced in 12 is a subset of the version discussed in this paper when 1 we conjecture that for 0 1 the long time limit of the extended dmk model is equivalent to a p poisson equation for p 2 1 and conse quently it is equivalent to the ctp theoretical and numerical evidence support our claims and show that the extended dmk represents a new dynamic formula tion of the p poisson equation and can be proposed as a relaxation for the efficient numerical solution of p laplacian in the case 1 we claim a link between the steady state solution u of our extended dmk model and solutions of btps in this case the complex solutions emerging from our dynamics remind of singular distributions typical of branched transport problems however when comparing both theoretically and numerically our btp with the more classical btp studied e g in oudet and santambrogio 17 pegon et al 18 santambrogio 20 xia 23 25 26 differences arise in primis we need to acknowledge that our formulation being based on the fem approach is based on densities that can be approximated with the lebesgue measure next we are not able to formulate an exact relationship between the equilibrium configurations u and the more classical solutions of btp on the other hand several numerical examples strengthen our confidence that our approach leads to interesting solutions that are promising in the quest for numerical solutions branching structures emerging from a continuous optimal transport model 21 of btps indeed our approach seems to be efficient and robust enough to produce trusty results at least for distributed sources acknowledgments this work was partially funded by the the unipd sid 2016 project approxima tion and discretization of pdes on manifolds for environmental modeling and by the eu h 2020 project geoessential essential variables workflows for resource efficiency and environmental management project of the european network for observing our changing planet era planet ga 689443 references 1 j r banavar a maritan and a rinaldo size and form in efficient trans portation networks nature 399 6732 130 132 may 1999 2 j r banavar t j cooke a rinaldo and a maritan form function and evolution of living organisms proc nat acad sci 111 9 3332 3337 mar 2014 3 j w barrett and w liu finite element approximation of the p laplacian math comp 61 204 523 537 1993 4 j d benamou and g carlier augmented lagrangian methods for transport optimization mean field games and degenerate elliptic equations j opt theory appl 167 1 1 26 2015 5 l bergamaschi e facca a mart nez calomardo and m putti spectral preconditioners for the efficient numerical solution of a continuous branched transport model j comput appl math submitted 2017 6 g bouchitte g buttazzo and p seppecher shape optimization solutions via monge kantorovich equation c r math acad sci paris 324 10 1185 1191 1997 7 l brasco and m petrache a continuous model of transportation revisited journal of mathematical sciences united states 196 2 119 137 2014 issn 15738795 doi 10 1007 s 10958 013 1644 7 8 m burger j haskovec p markowich and h ranetbauer a mesoscopic model of biological transportation networks arxiv e prints may 2018 9 g buttazzo c jimenez and e oudet an optimization problem for mass transportation with congested dynamics siam j control optim 48 3 1961 1976 2009 issn 03630129 10 i ekeland and r te mam convex analysis and variational problems clas sics in applied mathematics society for industrial and applied mathematics 1999 isbn 9780898714500 11 l c evans and w gangbo differential equations methods for the monge kantorovich mass transfer problem volume 653 american mathematical soc 1999 12 e facca f cardin and m putti towards a stationary monge kantorovich dynamics the physarum polycephalum experience siam j appl math 78 2 651 676 2018 13 e facca s daneri f cardin and m putti numerical solution of monge kantorovich equations via a dynamic formulation siam j sci comput submitted 2018 14 r glowinski and a marroco sur l approximation par e le ments finis d ordre un et la re solution par pe nalisation dualite d une classe de proble mes de dirichlet non line aires revue franc aise d automatique informatique recherche ope rationnelle analyse nume rique 9 r 2 41 76 1975 22 enrico facca franco cardin mario putti 15 j haskovec p markowich and b perthame mathematical analysis of a pde system for biological network formation communications in partial differen tial equations 40 5 918 956 2015 doi 10 1080 03605302 2014 968792 url https doi org 10 1080 03605302 2014 968792 16 d hu and d cai adaptation and optimization of biological transport net works phys rev lett 111 138701 sep 2013 doi 10 1103 physrevlett 111 138701 url https link aps org doi 10 1103 physrevlett 111 138701 17 e oudet and f santambrogio a modica mortola approximation for branched transport and applications arch rational mech anal 201 1 115 142 2011 18 p pegon f santambrogio and q xia a fractal shape optimization problem in branched transport j math pure appl 2018 in print 19 a rinaldo r rigon j r banavar a maritan and i rodriguez iturbe evolution and selection of river networks statics dynamics and complexity proc nat acad sci 111 7 2417 2424 feb 2014 20 f santambrogio a modica mortola approximation for branched transport c r math acad sci paris 348 15 941 945 2010 21 f santambrogio optimal transport for applied mathematicians birka user ny 2015 22 a tero r kobayashi and t nakagaki a mathematical model for adaptive transport network in path finding by true slime mold j theor biol 244 4 553 564 feb 2007 23 q xia optimal paths related to transport problems comm cont math 5 02 251 279 2003 24 q xia notice of retraction numerical simulation of optimal transport paths in computer modeling and simulation 2010 iccms 10 second international conference on volume 1 pages 521 525 ieee 2010 25 q xia on landscape functions associated with transport paths discr cont dyn sys 34 4 1683 1700 2014 26 q xia motivations ideas and applications of ramified optimal transportation esaim math model num 49 6 1791 1832 2015 centro ennio de giorgi scuola normale superiore piazza dei cavalieri 7 pisa italy enrico facca sns it deparment of mathematics tullio levi civita university of padua via trieste 62 padova italy cardin putti math unipd it https doi org 10 1080 03605302 2014 968792 https link aps org doi 10 1103 physrevlett 111 138701 https link aps org doi 10 1103 physrevlett 111 138701 1 introduction 2 lyapunov candidate functional and its minimization 2 1 case 0 1 2 2 case 1 3 numerical solution of the extended dmk equations 3 1 the numerical approach 3 2 numerical experiments 4 conclusions and discussion acknowledgments references