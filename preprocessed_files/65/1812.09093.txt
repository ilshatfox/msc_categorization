entropy stable discontinuous galerkin schemes on moving meshes with summation by parts property for hyperbolic conservation laws gero schnu cke nico krais thomas bolemann and gregor j gassner december 24 2018 abstract is work is focused on the entropy analysis of a semi discrete nodal discontinuous galerkin spectral element method dgsem on moving meshes for hyperbolic conservation laws e dgsem is constructed with a local tensor product lagrange polynomial basis computed from legendre gauss loba o lgl points furthermore the collocation of interpolation and quadrature nodes is used in the spatial discretization is approach leads to discrete derivative approximations in space that are summation by parts sbp operators on a static mesh the sbp property and suitable two point ux functions which satisfy the entropy condition from tadmor allow to mimic results from the continuous entropy analysis on the discrete level in this paper tadmor s condition is extended to the moving mesh framework based on the moving mesh entropy condition entropy conservative two point ux functions for the homogeneous shallow water equations and the compressible euler equations are constructed furthermore it will be proven that the semi discrete moving mesh dgsem is an entropy conservative scheme when a two point ux function which satis es the moving mesh entropy condition is applied in the split form dg framework is proof does not require any exactness of quadrature in the spatial integrals of the variational form nevertheless entropy conservation is not su cient to tame discontinuities in the numerical solution and thus the entropy conservative moving mesh dgsem is modi ed by adding numerical dissipation matrices to the entropy conservative uxes en the method becomes entropy stable such that the discrete mathematical entropy is bounded at any time by its initial and boundary data when the boundary conditions are speci ed appropriately besides the entropy stability the time discretization of the moving mesh dgsem will be investigated and it will be proven that the moving mesh dgsem satis es the free stream preservation property for an arbitrary s stage runge ku a method e theoretical properties of the moving mesh dgsem will be validated by numerical experiments for the com pressible euler equations keywords discontinuous galerkin summation by parts moving meshes entropy stability free stream preser vation department for mathematics and computer science university of cologne email gschnuec math uni koeln de institute of aerodynamics and gas dynamics iag university of stu gart email krais iag uni stu gart de department for mathematics and computer science university of cologne institute of aerodynamics and gas dynamics iag university of stu gart email bolemann iag uni stu gart de department for mathematics and computer science university of cologne email ggassner math uni koeln de center for data and simulation science cds university of cologne url www cds uni koeln de 1 ar x iv 1 81 2 09 09 3 v 1 m at h n a 2 1 d ec 2 01 8 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 1 introduction a lot of applications in engineering and physics require the approximation of conservation laws on time dependent domains e g domains with moving boundaries for instance moving mesh discontinuous galerkin dg methods have been investigated in 4 24 43 50 51 in particular moving mesh discontinuous galerkin spectral element methods dgsem have been constructed and analyzed in 38 47 63 in the literature there are also moving mesh methods with the capability to change the connectivity of the mesh e g with nite volume fv methods 44 55 and with a dg method 59 in general moving mesh methods are well suited to preserve motion related properties like the galilean invariance ese properties are necessary to describe physical processes like the formation of disc galaxies 45 a common way to approximate conservation laws on time dependent domains is to use the arbitrary lagrangian eulerian ale approach 17 in this approach the conservation law is transformed from the time dependent domain onto a time independent reference domain e motion of the mesh on the physical domain is part of the transfor mation us the grid velocity eld appears as a new quantity in the equation on the reference domain on the one hand the ale transformation simpli es the discretization since a static mesh can be used in the reference domain on the other hand the new quantities in the equation on the reference domain complicate the discrete stability anal ysis even in the linear case 38 more precisely the appearance of the grid velocity eld leads to a non conservative equation on the continuous level the geometric quantities and the grid velocity eld satisfy an additional balance law is balance law is o en referred to as geometric conservation law gcl 18 30 41 42 46 e gcl allows to write the transformed equation in conservation form however on the discrete level a numerical scheme does not necessarily satisfy a discrete gcl d gcl farhat et al 18 30 41 proved that the absence of this property has a critical e ect on the accuracy and stability of a moving mesh method in particular the preservation of constant states is no longer guaranteed in this work moving mesh dgsem to solve non linear symmetrizable and hyperbolic systems of conservation laws are investigated it is well known that symmetrizable systems are equipped with an entropy entropy ux pair 29 48 for scalar conservation laws entropy admissible criteria provide the unique physical relevant weak solution 15 40 for systems of conservation laws entropy admissible criteria are not enough to ensure well posedness 12 nevertheless the entropy is an essential quantity to analyze systems of conservation laws in particular for gas dynamics a possible mathematical entropy is the scaled negative thermodynamic entropy which shows that the mathematical model correctly captures the second law of thermodynamics 1 e entropy is conserved for smooth solutions of a conservation law and decays for discontinuous solutions 31 57 erefore it is desirable to construct numerical schemes for conservation laws which re ect the properties of the entropy on the discrete level tadmor 56 developed a discrete entropy criterion to construct a speci c class of two point ux functions for low order fv methods fv methods with these class of two point ux functions preserve entropy on the discrete level moreover these fv methods can be modi ed by adding dissipation to the numerical uxes such that the entropy is decreasing for all times erefore two point uxes with tadmor s discrete entropy condition are called entropy conservative uxes fisher and carpenter 21 proved that low order entropy conservative uxes can be used to construct high order schemes when the derivative approximations in space are summation by parts sbp operators a sbp operator provides a discrete analogue of the integration by parts for mula 20 25 39 it is worth to mention that the derivative matrix in the dgsem provides a sbp operator if the tensor product lagrange polynomial basis is computed from legendre gauss loba o lgl points and interpola tion and quadrature are collocated gassner et al 26 27 showed that split forms of the partial di erential equations can be discretely recovered when speci c choices of numerical volume uxes in the ux form volume integral of fisher and carpenter are chosen us the following restrictions need to be satis ed to construct entropy stable 2 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes dgsem 1 e derivative matrix satis es the sbp property 2 ere are two point ux functions with tadmor s discrete entropy condition that can be extended to high order in a split form dg framework is methodology has been used in the construction of high order entropy stable dgsem on quadrilateral hexahedral elements e g 3 26 60 or on triangular tetrahedral elements e g 6 11 14 all these methods are provably en tropy stable and the semi discrete entropy analysis for them is based merely on the properties of the spb operators and the assumption that the time integration is exact e exactness of quadrature in the spatial integrals of the variational form is not necessary up to now the methodology to construct entropy stable dgsem has been developed for static meshes e focus of this work is the construction of entropy stable moving mesh dgsem e remainder of the paper is organized as follows in section 2 the ale transformation is presented for one dimensional systems of conservation laws e continuous entropy analysis for the conservation law on the reference domain is given in the subsection 2 1 en in subsection 2 2 a moving mesh fv scheme is constructed and a natural extension of tadmor s discrete entropy condition for the ale framework is presented e capability of the moving mesh fv scheme to preserve constant states is investigated in the subsection 2 3 e ale transformation and continuous entropy analysis is presented in the subsections 3 1 3 2 and 3 3 e framework for the spectral element discretization with the spb operator is given in the subsection 3 4 and the dg split form framework is presented in the subsection 3 5 e moving mesh dgsem is nally presented in the subsection 3 5 a discrete entropy analysis for the moving mesh dgsem is given in the subsections 3 6 and 3 7 furthermore in subsection 3 8 it is proven that the moving mesh dgsem satis es the free stream preservation property in section 4 numerical examples with the compressible euler equations are presented to validate our theoretical ndings 2 basic concepts for 1 d conservations laws in the ale framework in this section we discuss the ale transformation for the one dimensional symmetrizable system u t f x 0 2 1 e system consists of p equations is de ned on a time dependent interval a t b t and is equipped with suitable boundary conditions e time dependent interval has continuous di erentiable boundary functions and can be mapped on the reference interval 1 1 by a time dependent a ne linear mapping x t e mapping provides the quantities j t t and t d dt t 2 2 where is the grid velocity e chain rule and 2 2 provide j du dt j u t u j u t j du dt u 2 3 hence by applying the chain rule and rearranging terms the conservation law 2 1 becomes j du dt f u 2 4 on the reference element e product rule allows to write the equation 2 4 as j du dt g u 2 5 3 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes where g f u e equations 2 4 and 2 5 are not desirable for a numerical discretization since the equations are not in conservation form and a source term appears e discretization of equations with source terms provides additional numerical problems since the preservation of certain states is not guaranteed 9 28 60 nevertheless schwarz s theorem on the symmetry of second derivatives provides dj dt d dt d dt 2 6 e equation 2 6 is typically referred to as the gcl us equation 2 1 can be wri en on the reference interval as the conservation law dju dt g 0 2 7 2 1 entropy analysis in one dimension e well known results by godunov 29 and mock 48 state that a system of conservation laws is symmetrizable if and only if it is equipped with a strictly convex entropy function hence it exists an entropy entropy ux pair s fs for the system 2 1 en the entropy variables are de ned by w s u 2 8 and the entropy ux satis es wt f x fs x wt f fs 2 9 us the chain rule provides wt dju dt jwt du dt dj dt wtu djs dt dj dt wtu s djs dt wtu s 2 10 where we used the gcl 2 6 in the last step likewise the chain rule and equation 2 9 give wt g wt f wt u wtu fs s wtu fs s wtu s 2 11 for smooth solutions of the conservation law 2 1 the equations 2 10 2 11 provide the entropy balance law on the reference element 0 wt dju dt wt g djs dt fs s 2 12 next we integrate the equation 2 12 over the reference element 1 1 apply the fundamental theorem of calculus and rearrange terms is provides the identity d dt 1 1 js d fs s 1 1 2 13 4 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes e equation 2 13 describes the temporal evolution of the total entropy and holds merely for smooth solutions of the conservation law 2 1 nevertheless for discontinuous solutions we obtain the inequality d dt 1 1 js d fs s 1 1 2 14 a numerical method which satis es a discrete analogue of the equation 2 13 is called entropy conservative and a method which satis es a discrete analogue of the equation 2 14 is called entropy stable approximation on the discrete level it is not easy to mimic the chain rule we focus on sbp operators that allow to recover the integration by parts formula on the discrete level 20 25 39 us as an alternative we re write 2 11 in such a way that the product rule can be used w t g 2 15 where wtu s and wt f fs are the entropy potential and the entropy ux potential functions 57 2 2 discrete entropy conservation for moving mesh fv methods next we consider a fv discretization of the problem 2 1 we divide the domain a t b t in k non overlapping time dependent elements ik t xk t xk 1 t k 1 k each interval ik t is mapped onto the ref erence interval 1 1 by an a ne linear mapping e approximation for the element mean value of the exact solution u in the element ik t is denoted by uk t and the approximation for j in the element ik t is denoted by jk e gcl 2 6 needs to be satis ed on the discrete level us the equation 2 6 is also discretized en the semi discrete moving mesh fv scheme is given by djk dt k 1 2 k 1 2 2 16 a d jkuk dt g k 1 2 g k 1 2 2 16 b e numerical ux functions k 1 2 and g k 1 2 in 2 16 satisfy k 1 2 1 2 l k 1 2 r k 1 2 and g k 1 2 g l k 1 2 r k 1 2 uk uk 1 2 17 where l k 1 2 is the approximation of the grid velocity from the le side in the cell interface point xk 1 and rk 1 2 is the approximation from the right side moreover the ux function g needs to satisfy the consistence condition g l r u u f u 1 2 l r u 2 18 in the fv context a discrete analogue of the equation 2 15 is given by wk 1 wk t g k 1 2 k 1 k k 1 2 k 1 k 2 19 k w t k uk s uk k w t k f uk f s uk 2 20 for all k 1 k 1 we note that for 0 static mesh special case the equation 2 19 becomes tadmor s discrete entropy condition for entropy conservative numerical ux functions 56 e following property of the fv method 2 16 is proven in appendix d 1 eorem 2 1 suppose the ux function g satis es the condition 2 19 en the semi discrete moving mesh fv 2 16 scheme is entropy consistent such that d dt k k 1 jks uk wtkg k 1 2 k k 1 2 k wt 1 g 1 2 1 1 2 1 2 21 5 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes e equation 2 21 is a discrete analogue of the identity 2 13 erefore in the context of the ale framework the condition 2 19 can be seen as a natural extension of tadmor s discrete entropy condition finally we remark that a ux with the property 2 19 can be constructed from an entropy consistent ux for fv methods on static meshes remark 2 2 if a two point ux function f for static meshes with the tadmor condition wk 1 wk t f k 1 2 k 1 k k 1 k 1 2 22 and a state function u with the property wk 1 wk t u k 1 2 k 1 k k 1 k 1 2 23 are available a ux function g with the entropy condition 2 19 can be constructed by g k 1 2 f k 1 2 k 1 2 u k 1 2 2 24 state functions u with the property 2 23 have been constructed by friedrich et al 23 for the shallow water compressible euler and ideal magnetohydrodynamic mhd equations and are needed for the construction of fully discrete entropy stable space time dgsem methods 2 3 free stream preservation for moving mesh fv methods e geometric and metric terms are time dependent in a moving mesh approximation us it is a priori not clear if the common used time discretization strategies like runge ku a rk methods e g 5 provide a meaningful approximation for these terms in particular it is not clear if the semi discrete gcl 2 16 a stays true a er the time discretization a simple test to check if the discretization of the geometric and metric terms is reasonable is the free stream preservation test e capability of the numerical scheme to preserve solutions with constant states is investigated in this test in the following the time discretization of the semi discrete moving mesh fv scheme 2 16 is analyzed we divide the interval 0 t in discrete time levels tn e step size of the time discretization is t e fv solutions uk jk and the numerical uxes k 1 2 g k 1 2 are approximated in the time levels tn e g uk tn unk us the moving mesh forward euler fv discretization is given by jn 1 k j n k t n k 1 2 n k 1 2 2 25 a jkuk n 1 jnku n k t g n k 1 2 g n k 1 2 2 25 b un 1 k jkuk n 1 jn 1 k 2 25 c e last step is necessary to decouple the solution uk from the metric term jk however it is also possible to write 2 25 in an equivalent form without the step 2 25 c erefore we apply the d gcl 2 25 a and realize jnku n k jn 1 k t n k 1 2 n k 1 2 unk 2 26 en we plug 2 26 in 2 25 b and obtain jn 1 k j n k t n k 1 2 n k 1 2 2 27 a un 1 k u n k t jn 1 k g n k 1 2 n k 1 2 unk g n k 1 2 n k 1 2 unk 2 27 b 6 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes we note that the equation 2 27 b matches the structure of the one dimensional moving mesh fv method from fazio and leveque 19 next we analyze the forward euler moving mesh fv scheme with respect to the free stream preservation property for a solution unk c c 1 cp t with constant components ci rp i 1 p it follows by 2 18 un 1 k c t jn 1 k g n k 1 2 n k 1 2 c g n k 1 2 n k 1 2 c c t jn 1 k f c n k 1 2 c n k 1 2 c f c n k 1 2 c n k 1 2 c c 2 28 us the forward euler moving mesh fv method satis es the free stream preservation property in the same way the semi discrete moving mesh fv scheme 2 16 can be discretized by an explicit s stage rk method with the characteristic coe cients a s 1 b s 1 c s 1 is provides the fully discrete moving mesh rk fv method for 1 s j k j n k t 1 1 a n k 1 2 n k 1 2 2 29 a u k u n k t j k 1 1 a g n k 1 2 n k 1 2 u k g n k 1 2 n k 1 2 u k 2 29 b jn 1 k j n k t s j 1 b n k 1 2 n k 1 2 2 29 c un 1 k u n k t jn 1 k s 1 b g n k 1 2 n k 1 2 u k g n k 1 2 n k 1 2 u k 2 29 d where l n k 1 2 l k 1 2 tn c t r n k 1 2 r k 1 2 tn c t and n k 1 2 1 2 l n k 1 2 r n k 1 2 2 30 g n k 1 2 g l n k 1 2 r n k 1 2 u k u k 2 31 e free stream preservation property for the moving mesh rk fv method 2 29 can be proven by the same calculation as in 2 28 in particular the following statement can be proven by exactly the same arguments as for the forward euler step eorem 2 3 let unk c c 1 cp t rp be the solution of the fully discrete fv 2 29 scheme at time level tn furthermore the numerical ux g satis es 2 18 en the constant states ci i 1 p are preserved in each runge ku a stage 2 29 b in particular the solution of the fully discrete fv method at time level tn 1 is un 1 k c 3 entropy stable dgsem on moving meshes in section 2 an entropy conservative rst order moving mesh fv method has been introduced e main goal of this work is the construction of an entropy stable high order moving mesh dgsem on static meshes it is possible to construct high order entropy stable dgsem if the derivative matrix is an sbp operator and entropy conservative two point ux functions are available is methodology has been used in the construction of high order entropy 7 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes stable dgsem on quadrilateral hexahedral elements e g 3 26 60 in this section it will be shown that similar ideas can be used to construct high order entropy stable moving mesh dgsem when there are two point ux functions with the property 2 19 available for the low order fv method 2 16 e construction of the entropy stable moving mesh dgsem will be presented for an arbitrary symmetrizable and hyperbolic system of conservation laws u t 3 i 1 fi xi 0 3 1 on a time dependent domain t r 3 e vector of conserved variables is u and fi i 1 2 3 are the physical ux vectors e state vectors are of size p depending on the number of equations in the system under consideration and the conservation law is subjected to appropriate initial and boundary conditions e block vector nomenclature in 27 simpli es the analysis of the system 3 1 on curved elements us we translate the conservation law 3 1 in block vector notation a block vector is highlighted by the double arrow f f 1 f 2 f 3 3 2 e dot product of two block vectors is given by f g 3 i 1 fti gi 3 3 furthermore the dot product of a vector v in the three dimensional space and a block vector is de ned by v f 3 i 1 vifi 3 4 we note that the dot product 3 3 is a scalar quantity and the dot product 3 4 is a vector in a p dimensional space where the number p corresponds to the number of conserved variables in the conservation law 3 1 e interaction between a vector v and the conserved variables is de ned as the block vector v u v 1 u v 2 u v 3 u 3 5 us in particular the spatial gradient of the conserved variables is de ned by xu u x 1 u x 2 u x 3 3 6 e gradient of a vector valued function g g 1 g 2 g 3 t is a second order tensor wri en in matrix form as x g g 1 x 1 g 1 x 2 g 1 x 3 g 2 x 1 g 2 x 2 g 2 x 3 g 3 x 1 g 3 x 2 g 3 x 3 3 7 e dot product 3 3 and the spatial gradient 3 6 are used to de ne the divergence of a block vector ux as x f 3 i 1 fi xi 3 8 8 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes moreover for a vector valued function g and the conserved variables we have the product rule x g u x g u g xu 3 9 with respect to the dot products 3 3 and 3 4 ese notations allow to write the conservation law 3 1 in the compact form u t x f 0 3 10 3 1 building blocks of the ale transformation for hexahedral curved meshes in order to set up the moving mesh dgsem in the section 3 5 we make for all t 0 t the assumptions a 1 for a xed numberk n the physical domain t can be subdivided intok time dependent non overlapping and conforming hexahedral elements e t 1 k ese elements can have curved faces a 2 e time dependent elements e t are mapped into the spatial computational domain e 1 1 3 with a bijective isoparametric trans nite mapping winters constructed in his phd thesis 64 a mapping for this set up like in 64 it is assumed that the curved faces satisfy for all t 0 t 1 1 3 t 6 1 3 t 2 1 3 t 6 1 3 t 3 1 2 t 6 2 1 t 1 1 3 t 4 1 3 t 2 1 3 t 4 1 3 t 3 1 2 t 4 2 1 t 1 1 1 t 3 1 1 t 2 1 1 t 3 1 1 t 5 1 2 t 6 2 1 t 1 1 1 t 5 1 1 t 2 1 1 t 5 1 1 t 5 1 2 t 4 2 1 t 3 11 e location of the curved faces is sketched in figure 3 1 e curved faces of an element e t are approximated x 1 x 2 x 3 x 4 x 5 x 6 x 7 x 8 1 1 3 t 2 1 3 t 3 1 2 t 5 1 2 t 4 2 3 t 6 2 3 t x 1 x 2 x 3 1 2 3 t figure 3 1 le the reference element e 1 1 3 and on the right a general hexahedral element e t with the curved faces 1 1 3 t 2 1 3 t 3 1 2 t 4 2 3 t 5 1 2 t and 6 2 3 t e mapping t connects e and e t as interpolation polynomials up to degree n such that in i t n j k 0 i j k t j k i 1 2 3 4 5 6 3 12 where j n j 0 k n k 0 are the lagrange polynomials associated with the interpolation points j n j 0 and k n k 0 9 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes a 3 e determinant j of the jacobian matrix satis es j det 0 t 0 t 3 13 mesh curving techniques are discussed by hindenlang et al 32 and methodologies to construct a moving mesh with the properties a 1 a 3 are given in the literature e g the book of huang and russell 33 chapter 6 chapter 7 e mapping 1 2 3 t provides the grid velocity eld 1 2 3 t d 1 dt d 2 dt d 3 dt t d dt 3 14 it is desirable that the grid velocity is continuous since the mesh should be conforming and watertight at each time level e next statement provides conditions on the element boundaries to guarantee that the grid velocity becomes continuous lemma 3 1 let e 1 t and e 2 t be two neighboring elements which share one of the faces 11 22 13 25 14 26 21 12 23 15 24 16 3 15 where li l 1 2 and i 1 2 3 4 5 6 are the faces of the element el t furthermore suppose that the faces li t are continuously di erentiable in the time interval 0 t en the grid velocity eld is continuous in the points which belong to the face that the elements share in appendix a the lemma 3 1 is proven in two dimensions e three dimensional proof can be done by the same argumentation 3 2 transformation of the conservation law onto a reference element in the following we show that the system 3 10 can be transformed from a time dependent element e t onto the reference element e e mapping 1 2 3 t provides the covariant basis vectors ai i i 1 2 3 3 16 and the volume weighted contravariant vectors jai aj ak i j k cyclic 3 17 ereby is 1 2 3 t a vector in the reference elemente 1 1 3 e covariant and the volume weighted contravariant vectors represent the jacobian matrix and its adjoint matrix a 1 a 2 a 3 adj j a 1 t j a 2 t j a 3 t 3 18 furthermore the contravariant vectors satisfy the metric identities 3 i 1 j ai i 0 3 19 in particular the covariant and the contravariant vectors allow to transform di erential operators on the time independent reference element e on the reference element the gradient of a function f is given by xf 1 j 3 i 1 j ai f i 1 j adj t f 3 20 10 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes and the divergence of a vector valued function g is given by x g 1 j 3 i 1 i j ai g 1 j g 3 21 where we used the contravariant ux g j a 1 g j a 2 g j a 3 g adj g 3 22 in 27 the following block matrix has been introduced to combine the transformations 3 20 and 3 21 with the block vector notation m adj t ip ja 11 ip ja 21 ip ja 31 ip ja 12 ip ja 22 ip ja 32 ip ja 13 ip ja 23 ip ja 33 ip 3 23 where is the kronecker product the matrix ip is the p p identity matrix and jaij is the component of j a i in the j th cartesian coordinate direction e transformation of the gradient becomes xu 1 j m u 3 24 we note that for a vector valued function g the following identity holds g xu 1 j g m u 1 j g u 3 25 moreover by applying the metric identities 3 19 the transformation of the divergence can be wri en as x f 1 j mt f 3 26 hence the contravariant block vector ux is given by f j a 1 f j a 2 f j a 3 f mt f 3 27 since the elements ek t k k 1 are time dependent the time evolution of the quantity j needs to be analyzed us we apply jacobi s formula cf e g bellman 2 and obtain by 3 14 3 18 dj dt tr adj d dt 3 i 1 j ai d ai dt 3 i 1 j ai i 3 28 where tr denotes the trace of a matrix e metric identities 3 19 allow to write the equation 3 28 in conservation form dj dt 3 i 1 i j ai 3 29 e equation 3 29 is the gcl in three dimensions e chain rule formula and the identity 3 25 provide du dt u t 1 j u 3 30 next we plug the gcl 3 29 into equation 3 30 apply the product rule 3 9 and rearrange is provides the equation j u t d ju dt u 3 31 11 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes finally we combine the identities 3 26 and 3 31 to write the the conservation law 3 10 in the following form d ju dt g 0 3 32 where g g 1 g 2 g 3 f 1 1 u f 2 2 u f 3 3 u f u 3 33 e formulation 3 32 is the representation of the system 3 10 on the time independent reference element e for a time dependent element e t 3 3 entropy analysis in three dimensions e system 3 1 is assumed to be symmetrizable us in particular it is equipped with entropy entropy ux pairs s fsi i 1 2 3 cf godunov 29 and mock 48 e strictly convex function s is the entropy function e entropy function s provides the entropy variables w s u 3 34 and it follows by the chain rule s t wt u t s xi wt u xi i 1 2 3 3 35 e entropy ux functions and the ux functions in the conservation law are related and satisfy wt fi xi fsi xi i 1 2 3 3 36 e identities 3 25 and 3 35 give wt u jwt xu j xs s 3 37 hence we obtain with the identity 3 30 and the chain rule jwt du dt j s t s j ds dt 3 38 erefore the product rule provides the identity wt d ju dt j ds dt dj dt wtu d js dt dj dt wtu s d js dt wtu s 3 39 where we used the gcl 3 29 in the last step next we apply the relation 3 36 for the entropy ux functions and obtain wt gi xi x fsi is vi xi wtu s i 1 2 3 3 40 by the same arguments as in the one dimensional computation 2 11 next we apply the vector notation fs fs 1 f s 2 f s 3 t en 3 40 and the transformation formulas for the gradient and divergence in the section 3 2 give wt g fs s wtu s 3 41 12 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes finally the identities 3 39 and 3 41 provide the balance law 0 wt d ju dt g d js dt fs s 3 42 we integrate the equation 3 42 over the domain e 0 t and obtain d dt e js d e fs s t n ds 3 43 for discontinuous solutions the equation 3 43 is not satis ed but it holds the inequality d dt e js d e fs s t n ds 3 44 3 4 buidling blocks for the spectral element approximation e spectral element approximation based on a nodal approach with lagrange basis functions given by j n i 0 j 6 i i j i j 0 n 3 45 where the nodal points i n i 0 are the lgl points we note that 0 1 and n 1 e lagrange basis functions satisfy the cardinal property i j ji 3 46 where ji is the kronecker delta on the reference element e 1 1 3 the solution and uxes of the system 3 32 are approximated by tensor product lagrange polynomials of degree n e g u 1 2 3 t u 1 2 3 t n i j k 0 uijk t i 1 j 2 k 3 3 47 in the following polynomial approximations are highlighted by capital le ers e g u is an approximation for the state vector u and fl l 1 2 3 are approximations for the uxes fl l 1 2 3 e determinant j of the jacobian matrix is also approximated by tensor product lagrange polynomials j 1 2 3 t j 1 2 3 t n i j k 0 jijk t i 1 j 2 k 3 3 48 in particular the interpolation operator for a function g is given by in g 1 2 3 n i j k 0 gijk i 1 j 2 k 3 3 49 where gijk g 1 i 2 j 3 k and 1 i n i 0 2 i n i 0 3 i n i 0 are sets of lgl points derivatives are approximated by exact di erentiation of the polynomial interpolants in general we have in g 6 in 1 g cf e g 7 37 as di erentiation and interpolation only commute if there are no discretization errors however the contravariant coordinate vectors need to be discretized in such a way that the metric identities 3 19 are satis ed on the discrete level too kopriva 36 introduced the conservative curl form that computes j a x in m 1 2 3 1 2 3 cyclic 3 50 to approximate the metric terms here 1 2 3 t represents the mapping from the element to the reference element and x i is the unit vector in the i th cartesian coordinate direction e representation 3 50 ensures that 3 1 in ja 0 1 2 3 3 51 13 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes we note that in the lgl points 1 i 2 j 3 k i j k 0 n the equation 3 51 gives n m 0 dim ja 1 mjk djm ja 2 imk dkm ja 3 ijm 0 1 2 3 3 52 integrals are approximated by a tensor product extension of a 2 n 1 accurate lgl quadrature formula hence interpolation and quadrature nodes are collocated in one spatial dimension the lgl quadrature formula is given by 1 1 g d n i 0 ig i n i 0 igi 3 53 where i i 0 n are the quadrature weights and i i 0 n are the lgl quadrature points e formula 3 53 motivates the de nition of the inner product notation f g n n i 0 n j 0 n k 0 i j kf t ijkgijk n i j k 0 ijkf t ijkgijk 3 54 for two functions f and g we note that the inner product 3 54 satis es in g n g n p n e rp 3 55 furthermore for a block vector f and test functions pn e rp we de ne the discrete surface integral e n t f n ds n j k 0 j k tnjk f 1 njk t 0 jk f 1 0 jk n i k 0 i k tink f 2 ink t i 0 k f 2 i 0 k n i j 0 i j tijn f 3 ijn t ij 0 f 3 ij 0 3 56 where n is the unit outward normal at the faces of the reference element e e spectral element approximation with lgl points for interpolation and quadrature provides a sbp operator q md with the mass matrixm and the derivative matrix d e mass matrix and the derivative matrix are given by mij i ij dij j i i j 0 n 3 57 a sbp operator satis es the property q qt b 3 58 where b diag 1 0 0 1 a sbp operator provides a discrete analogue of the integration by parts formula 20 25 39 3 5 e semi discrete discontinuous galerkin method now we apply the notation introduced in section 3 4 and construct a moving mesh dgsem like for the moving mesh fv scheme 2 16 we discretize the equations 3 29 and 3 32 simultaneous in this way it is ensured that the gcl 3 29 is satis ed on the discrete level 38 47 63 first we replace the solution u by 3 47 the jacobian j by 3 48 and approximate the uxes by the interpolation operator 3 49 next we multiply the gcl 3 29 with test functions pn e the equation 3 32 with pn e rp integrate the resulting equations and use 14 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes integration by parts to separate boundary and volume contributions e volume integrals in the variational form are approximated with the lgl quadrature en we insert numerical surface uxes and g at the spatial element interfaces a erwards we use the sbp property 3 58 for the volume contribution to get the standard dgsem in strong form dj dt n in n e n n n ds p n e 3 59 a d ju dt n in g n e n t g n g n ds pn e rp 3 59 b where we used the inner product notation 3 54 and the notation 3 56 for the discrete surface integral e approximation of and the nonlinear ux g by the interpolation operator 3 49 causes aliasing errors in the standard strong form e aliasing errors cannot be bounded and the errors are independent of the choice of the numerical surface ux in gassner 25 a detailed explanation and analysis of the aliasing problem is given fur thermore a speci c reformulation of the volume integrals by using the skew symmetry strategy has been developed to x the aliasing problem is approach has been enhanced and generalized by gassner et al in 27 26 with a technique developed for high order nite di erence fd schemes cf fisher and carpenter 21 e generalized approach is called split form dg framework here we proceed similar as in 27 and replace the interpolation oper ators in the discrete volume integrals by derivative projection operators e interpolation operator in the discrete equation for the gcl 3 29 is replaced by dn ijk n m 0 2 dim i m jk j a 1 i m jk 2 djm i j m k j a 2 i j m k 2 dkm ij k m j a 3 ij k m 3 60 with the volume averages of the metric terms e g i m jk 1 2 ijk mjk 3 61 e derivative projection operator in the discrete equation for 3 32 is computed as in 27 us the operator is given by dn g ecijk n m 0 2 dim gec ijk mjk uijk umjk j a 1 i m jk 2 djm gec ijk imk uijk uimk j a 2 i j m k 2 dkm gec ijk ijm uijk uijm j a 3 ij k m 3 62 e ux gec is consistent and symmetric such that e g gec ijk mjk u u f u v i m jku 3 63 and gec ijk mjk uijk umjk gec mjk ijk umjk uijk 3 64 for i j k m 0 n furthermore the ux functions gecl l 1 2 3 satisfy in the lgl points the moving mesh fv entropy condition 2 19 more precisely for i j k m 0 n the following discrete entropy conditions are 15 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes satis ed w t i m jkg ec l ijk mjk uijk umjk l i m jk l i m jk i m jk w ti j m kg ec l ijk imk uijk uimk l i j m k l i j m k i j m k w tij k m g ec l ijk ijm uijk uijm l ij k m l ij k m ij k m 3 65 e quantities and l are polynomial approximations which satisfy in the lgl points ijk w u t ijk uijk sijk l ijk w u t ijk fl ijk f s l ijk l 1 2 3 3 66 where wijk sijk and f sl ijk are the nodal values of the polynomials w in w u s in s u f sl i n fsl u l 1 2 3 3 67 here s represents an entropy for the system 3 1 with the corresponding entropy ux functions fsl l 1 2 3 and entropy variables w furthermore the volume jumps in 3 65 are e g i m jk ijk mjk 3 68 in the appendices b and c ux functions with these properties are presented for the shallow water and euler equations finally for each element e t the semi discrete moving mesh dgsem can be wri en in the following form dj dt n dn n e n n n ds p n e 3 69 a d ju dt n dn g ec n e n t g n g n ds pn e rp 3 69 b we note that the equation 3 69 a is the d gcl for the moving mesh spectral element dg discretization e unit outward facing normal vector and surface element on the element side are constructed from the element metrics by n 1 s 3 l 1 j al n l s 3 l 1 j al n l 3 70 us the quantity n in 3 69 a and the ux g n in 3 69 b are de ned by n s n 3 l 1 n l jal 1 1 ja l 2 2 ja l 3 3 3 71 g n s n g 3 l 1 n l jal 1 g 1 ja l 2 g 2 ja l 3 g 3 m g n 3 72 to de ne the numerical surface uxes in 3 69 a and 3 69 b we introduce notation for states at the lgl nodes along an interface between two spatial elements to be a primary and complement the notation with a secondary to denote the value at the lgl nodes on the opposite side en the orientated jump and the arithmetic mean at the interfaces are de ned by and 1 2 3 73 when applied to vectors the average and jump operators are evaluated separately for each vector component en the normal vector n is de ned unique to point from the to the side is notation allows to compute the contravariant surface numerical uxes in 3 69 a as n s n 1 v 1 n 2 v 2 n 3 v 3 3 74 16 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes e contravariant surface numerical uxes in 3 69 b are given by g n s n 1 g ec 1 n 2 g ec 2 n 3 g ec 3 3 75 where the cartesian uxes gecl l 1 2 3 satisfy 3 63 3 64 3 65 we note that these uxes are the baseline choices without interface dissipation to get a baseline scheme that is entropy conservative remark 3 2 e discrete volume weighted contravariant vectors j a 1 2 3 do not dependent on the solution j of 3 69 a since these vectors are computed by the conservative curl form 3 50 us the discrete metric identities 3 51 are satis ed and the normal computation 3 70 is watertight is means the normal vector and the surface element are continuous across element interfaces 3 6 discrete entropy conservation for the semi discrete method e spatial integral of the entropy is bounded in time on the continuous level us it is desirable that a numerical method is stable in the sense that a discrete version of this integral is bounded in time too in the context of the moving mesh semi discrete dgsem 3 69 we are interested to nd an upper bound for the quantity s k k 1 s u j n k k 1 in s u j n k k 1 s j n 3 76 where we used the property 3 55 of the inner product 3 54 and the notation 3 67 next we prove the following statement for the semi discrete moving mesh dgsem eorem 3 3 suppose the ux functions gec in the derivative projection operator 3 62 and the numerical surface uxes g n are computed by cartesian uxes g ec l l 1 2 3 with the properties 3 63 3 64 3 65 en the semi discrete moving mesh dgsem 3 69 satis es the discrete entropy equation ds dt boundary faces e n n n w t g n ds 3 77 where s is given by 3 76 as well as l l 1 2 3 are polynomials with nodal values 3 66 and n s n with 1 2 3 t proof we proceed similar as in the continuous entropy analysis use the polynomial approximation in w u w as test function in the equation 3 69 b and obtain d ju dt w n dn g ec w n e n wt g n g n ds 3 78 first we consider the le hand side in the equation 3 78 we obtain by the chain rule j du dt w n w u t u t j n w u t u 1 n t s u j n s u 1 n d dt s u j n 3 79 where we used the identity in w u w and the property 3 55 of the inner product 3 54 since we assume time continuity for our semi discrete analysis we apply the product rule in time and obtain by 3 79 d ju dt w n ds u dt j n dj dt w u t u n d dt s u j n dj dt w u t u s u n 3 80 17 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes next the notations in 3 66 3 67 and the property 3 55 of the inner product 3 54 give d ju dt w n d dt s u j n dj dt w u t u s u n d dt s j n dj dt n d dt s j n dn n e n n n ds 3 81 where we used in the last step the d gcl 3 69 a with the test function we note that the quantity is de ned as a polynomial with the nodal values 3 66 in the appendix d 2 the following equation is proven dn g ec w n e n f sn n s ds dn n 3 82 where f sn s n f s with f s f s 1 f s 2 f s 3 t here the polynomials f sl l 1 2 3 are given by 3 67 moreover we obtain by 3 71 and 3 72 wt g n g n f sn n s 3 l 1 s nl wtfl f sl s nl wtu s wt g n n n wt g n 3 83 next we plug the equations 3 81 3 82 3 83 in 3 78 and rearrange is results in the equation d dt s j n e n wt g n g n f sn n s n n ds e n n n w t g n ds 3 84 en we sum the equation 3 84 over all elements and use that the normal computation 3 70 is watertight is provides the equation ds dt boundary faces e n n n w t g n ds interior faces e n n n w t g n ds 3 85 since the numerical surface uxes g n are computed by cartesian uxes g ec l l 1 2 3 with the properties 3 65 it follows n n w t g n 3 l 1 s nl l l w tg l 0 3 86 hence we obtain the equation ds dt boundary faces e n n n w t g n ds 3 87 is completes the proof of eorem 3 3 remark 3 4 e boundary contribution in 3 77 becomes zero in the case of periodic boundary conditions in this case the entropy is conserved 18 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 3 7 discrete entropy stability for the semi discrete method entropy conservation can be merely expected when a reversible process is described by a system of pdes in general conservation laws are describing irreversible processes with discontinuous solutions hence it cannot be expected that the entropy conservative moving mesh dgsem provides a physical meaningful discretization for the system 3 1 however the entropy conservative ux can be augmented by an arti cial dissipation term in the literature there are di erent strategies to add dissipation to an entropy conservative ux here dissipa tion is added via a matrix operator is approach for instance has been used in the context of gas dynamics by chandrashekar 8 or winters et al 62 e conservative variables u can be wri en in dependence of the entropy variables w di erentiation of the con servative variables u u w provides the symmetric positive de nite matrix u w since the system 3 1 is assumed to be symmetrizable cf e g 31 us it follows by a taylor expansion up to rst order u u w w o w 2 3 88 where the jump operator is de ned by 3 73 at the interfaces furthermore the system 3 1 is hyperbolic us the ux jacobian matrices fl u l 1 2 3 are diagonalizable and have real eigenvalues li u p i 1 r e corre sponding right eigenvector matrices are rl according to the eigenvector scaling theorem cf barth 1 eorem 4 there are symmetric block diagonal scaling matrices tl with fl u r l l u r 1 l u w r l r tl r l rl tl l 1 2 3 3 89 where l u diag l 1 u l p u e ux jacobian matrices gl u fl u lip have the real eigenvalues li u l p i 1 and the same right eigenvectors as the ux jacobian fl u we note that ip is the p p identity matrix hence it follows gl u r l l u r 1 l l u diag l 1 u l l p u l l 1 2 3 3 90 furthermore we obtain by 3 89 gl w gl u u w r l l u r tl l 1 2 3 3 91 e equation 3 91 motivates the de nition of the following matrix dissipation operators hl r l l r tl r l r l t l l 1 2 3 3 92 where the matrices r l t l depend on the averaged values of the states u u and they are consistent with the right eigenvector matrix rl and the scaling matrix tl e matrix l depends on the values li u l p i 1 and li u l p i 1 e matrixhl needs to be a symmetric positive de nite matrix erefore the matrix l has to be choosen carefully examples of matrices which lead to a symmetric positive de nite dissipation matrix are ismail roe type dissipation 34 l roe diag l 1 u l lp u l l 1 2 3 3 93 or rusanov type dissipation l rus max max 1 i p li u l max 1 i p li u l ip l 1 2 3 3 94 e rusanov type dissipation is known to be quite dissipative and leads to smearing of shocks and contact discon tinuities e roe type dissipation is more accurate in the reproduction of the characteristic pro le of shocks or 19 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes contact discontinuities but in the regime of strong shock fronts the roe type dissipation fails in the stabilization of the numerical method erefore a convex combination of roe and rusanov type dissipation is a natural choice 8 e dissipation operator 3 92 is used to modify the cartesian numerical surface ux as follows gesl g ec l 1 2 hl w l 1 2 3 3 95 where the cartesian uxes gecl l 1 2 3 satisfy 3 63 3 64 3 65 e contravariant surface numerical uxes g esn are computed by 3 75 e numerical uxes g esn do not generate an entropy conservative scheme but the result in eorem 3 3 can be used to prove that the moving mesh dgsem becomes entropy stable such that the discrete mathematical entropy is bounded at any time by its initial data when the numerical uxes g esn are used corollary 3 5 suppose the ux functions gec in the derivative projection operator 3 62 are computed by carte sian uxes gecl l 1 2 3 with the properties 3 63 3 64 3 65 and the numerical surface uxes g n g es n are computed by the cartesian uxes gesl l 1 2 3 given by 3 95 en the semi discrete moving mesh dgsem 3 69 satis es the discrete entropy inequality ds dt boundary faces e n n n w t g esn ds 3 96 proof we proceed as in the proof of eorem 3 3 and obtain the equation ds dt boundary faces e n n n w t g esn ds interior faces e n n n w t g esn ds 3 97 since the numerical surface uxes g esn are computed by the cartesian uxes 3 95 and the uxes g ec l l 1 2 3 satisfy 3 65 it follows n n w t g esn 3 l 1 s nl l l w tgecl 1 2 w thl w 1 2 3 l 1 s nl w thl w 3 98 since the matrices hl l 1 2 3 are symmetric positive de nite and the outward normal vectors of the curved elements are positive oriented the equation 3 98 provides interior faces e n n n w t g esn ds 0 3 99 hence we obtain the inequality ds dt boundary faces e n n n w t g esn ds 3 100 20 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 3 8 free stream preservation of the moving mesh dgsem in this section we check the discretization of the geometric and metric terms in time since dg methods with the forward euler discretization are unstable 10 16 we investigate directly the discretization by an explicit rk method with s 2 stages and the characteristic coe cients a s 1 b s 1 c s 1 it is worth to mention that a courant lewy friedrichs cfl restriction is necessary when an explicit s stage rk method is used in the dg framework in order to present the rk discretization of the semi discrete dgsem 3 69 it is bene cial to write the method in the equivalent nodal representation is representation is for all i j k 0 n given by djijk dt v ijk 3 101 a d jijkuijk dt g ijk uijk 3 101 b where the right hand sides are given by v ijk dn ijk 1 i j k e n i j k n n ds 3 102 g ijk uijk dn g ecijk 1 i j k e n i j k g n g n ds 3 103 with the tensorial lagrange polynomials i j k given by 3 45 next as in the section 2 3 the interval 0 t is divided in time levels tn e step size of the time discretization is t e dgsem solutions the uxes and the grid velocity eld are approximated in the time levels tn e g u tn un en the rk discretization of the semi discrete dgsem is similar to the rk discretization of the semi discrete moving mesh fv scheme 2 16 us the moving mesh split form rk dgsem is given by for 1 s j ijk j n ijk t 1 1 a v n ijk 3 104 a u ijk u n ijk t j ijk 1 1 a g n ijk u ijk v n ijk unij 3 104 b jn 1 ijk j n ijk t s 1 b v n ijk 3 104 c un 1 ijk u n ijk t j n 1 ijk s 1 b g n ijk u ijk v n ijk unijk 3 104 d where n ijk 1 i 2 j 3 k t n c t and 1 i n i 0 2 i n i 0 3 i n i 0 are sets of lgl points next we prove that the fully discrete split form rk dgsem 3 104 satis es the free stream preservation property eorem 3 6 suppose the solution of the fully discrete split form rk dgsem 3 104 is given by unijk c c 1 cp t rp for all elements e tn 1 k and the numerical uxes satisfy 3 63 en the constant states cl l 1 p are preserved in each runge ku a stage 3 104 b in particular the solution of the fully discrete dgsem method at time level tn 1 is un 1 ijk c proof let 1 s be an arbitrary xed index we are interested to investigate the th rk stage hence without loss of generality we can assume that u c for all 0 1 en since the ux gec satis es 21 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 3 63 it follows dn g ecijk 2 n m 0 dim j a 1 i m jk f c 2 n m 0 djm j a 2 i j m k f c 2 n m 0 dkm j a 3 ij k m f c dn n ijk c 3 105 furthermore since the metric terms are computed by the conservative curl form 3 50 we obtain 2 n m 0 dim j a 1 i m jk djm j a 2 i j m k dkm j a 3 ij k m n m 0 dim j a 1 mjk djm j a 2 imk dkm j a 3 ijm 0 3 106 here we used the split form lemma from gassner et al 26 lemma 1 in the rst step and in the second step we used the identity 3 52 for the discrete metric identities us it follows that dn g ecijk d n n ijk c 3 107 similar since the ux g satis es 3 63 it follows that g n g n 3 l 1 s nl fl c n l c s n f c n c s n n n c n n n n c 3 108 us the equations 3 107 and 3 108 give g n ijk c dn n ijk 1 i j k e n i j k n n n n ds c v n ijk c 3 109 hence the solution of the rk stage 3 104 b is given by u ijk c t j ijk 1 1 a g n ijk c v n ijk c c 3 110 since the parameter was arbitrary chosen it follows u ijk for all 1 s in particular it follows un 1 ijk c t jn 1 ijk s 1 b g n ijk c v n ijk c c 3 111 is completes the proof of eorem 3 6 4 numerical results e numerical computations in this section are performed with the open source code flexi 1 and the three dimensional high order meshes for the simulations are generated with the open source tool hopr 2 1 www flexi project org 2 www hopr project org 22 www flexi project org www hopr project org g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes we present tests on three dimensional moving hexahedral curved meshes for the compressible euler equations based on these tests we will evaluate the theoretical ndings of the previous sections e three dimensional com pressible euler equations are given by u t f 0 4 1 e state vector and the components of the block vector ux f are given by u u 1 u 2 u 3 e f 1 u 1 u 21 p u 1 u 2 u 1 u 3 e p u 1 f 2 u 2 u 1 u 2 u 22 p u 2 u 3 e p u 2 f 3 u 3 u 1 u 3 u 2 u 3 u 23 p e p u 3 4 2 where the conserved variables are the density the momentum u u 1 u 2 u 3 t and the total energy e in order to close the system we assume an ideal gas such that the pressure is de ned as p 1 e 2 u 2 4 3 where is the adiabatic exponent we choose 1 4 in the following experiments e system 4 1 is investigated in the domain xmin xmax 3 at initial time t 0 the domain is divided in k non overlapping and conforming cartesian hexahedral elements e 0 1 k for each element e 0 1 k the temporal distribution of a grid point x 0 x 1 0 x 2 0 x 3 0 t e 0 4 4 is given by x t x 0 0 05 l sin 2 t sin 2 l x 1 0 sin 2 l x 2 0 sin 2 l x 3 0 4 5 where l xmax xmin in figure 4 2 we show a slice through a three dimensional mesh with k 163 elements at initial time and at its maximal distortion figure 4 2 a slice through a three dimensional mesh with k 163 elements at initial time le and at its maximal distortion right furthermore the ve stage fourth order low storage explicit rk method from kennedy carpenter and lewis 35 is used for the time integration in the numerical experiments e cfl restriction is computed as in 13 t min 1 k h tn ccfl 2 n 1 max 4 6 23 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes where h tn is the minimum element size of e tn ccfl 0 1 and max is the largest advective wave speed at the current time level traveling in either the x 1 x 2 x 3 direction 4 1 experimental convergence rates in this section we verify the high order approximation of the moving dgsem 3 69 for this purpose we investigate the domain 1 1 3 and apply the method of manufactured solutions us we assume a solution of the form u x t x t u 1 x t u 2 x t u 3 x t e x t 2 0 1 sin x 1 x 2 x 3 2 0 3 t 2 0 1 sin x 1 x 2 x 3 2 0 3 t 2 0 1 sin x 1 x 2 x 3 2 0 3 t 2 0 1 sin x 1 x 2 x 3 2 0 3 t 2 0 1 sin x 1 x 2 x 3 2 0 3 t 2 4 7 we plug solution 4 7 into the euler system and compute the residual using a computer algebra system is term is used as a source term in our convergence tests we note that this term is handled and discretized as a solution independent part in the numerical computation we run the convergence test with periodic boundary conditions furthermore the moving mesh dgsem 3 69 is applied with the ux function in appendix c 1 as volume and surface ux in addition the surface ux is stabilized by the dissipation operator in appendix c 3 besides using the grid point distribution given in 4 5 we also compute static reference solutions by se ing the grid velocity to zero in this case the moving mesh dgsem 3 69 degenerates to the split form dgsem for static meshes 26 27 in table 4 1 we listed the experimental order of convergence eoc and l 2 errors for the conserved variables that we obtain for polynomials with odd degree n 3 on a static mesh top and on a moving mesh bo om e convergence rates on the moving mesh are not as good as on a static mesh which can be justi ed by the high distortion in the mesh from the grid point distribution formula 4 5 however with an increasing number of elements the same convergence rates as on a static mesh are almost reached moreover the experimental order of convergence eoc and l 2 errors for the conserved variables that we obtain for polynomials with even degreen 4 are listed in the table 4 2 we observe a similar behavior as for the odd degreen 3 is indicate the high order approximation properties of the moving mesh dgsem k l 2 eoc l 2 u 1 eoc u 1 l 2 u 2 eoc u 2 l 2 u 3 eoc u 3 l 2 e eoc e 23 2 84 e 02 2 74 e 02 2 74 e 02 2 74 e 02 5 47 e 02 43 5 54 e 03 2 36 5 43 e 03 2 34 5 43 e 03 2 34 5 43 e 03 2 34 1 03 e 03 2 40 83 4 35 e 05 6 99 4 28 e 05 6 99 4 28 e 05 6 99 4 28 e 05 6 99 1 06 e 04 6 61 163 2 10 e 06 4 37 2 07 e 06 4 37 2 08 e 06 4 37 2 07 e 06 4 37 5 33 e 06 4 31 323 1 26 e 07 4 06 1 24 e 07 4 06 1 24 e 07 4 06 1 24 e 07 4 06 3 19 e 07 4 06 643 7 82 e 09 4 01 7 67 e 09 4 01 7 67 e 09 4 01 7 67 e 09 4 01 1 97 e 08 4 01 23 4 16 e 02 3 73 e 02 3 73 e 02 3 73 e 02 5 61 e 02 43 3 77 e 03 3 46 3 52 e 03 3 41 3 52 e 03 3 41 3 52 e 03 3 41 6 06 e 03 3 21 83 1 99 e 04 4 25 1 75 e 04 4 33 1 75 e 04 4 33 1 75 e 04 4 33 3 24 e 04 4 23 163 5 37 e 06 5 21 4 91 e 06 5 16 4 91 e 06 5 16 4 91 e 06 5 16 1 20 e 05 4 75 323 2 18 e 07 4 62 2 07 e 07 4 57 2 07 e 07 4 57 2 07 e 07 4 57 5 83 e 07 4 36 643 1 45 e 08 3 92 1 34 e 08 3 95 1 34 e 08 3 95 1 34 e 08 3 95 3 95 e 08 3 88 table 4 1 experimental order of convergence eoc and l 2 errors at time t 5 for the euler manufactured solution test 4 7 e moving mesh dgsem is used with n 3 on a static mesh top and on a moving mesh bo om with the grid point distribution 4 5 24 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes k l 2 eoc l 2 u 1 eoc u 1 l 2 u 2 eoc u 2 l 2 u 3 eoc u 3 l 2 e eoc e 23 6 99 e 03 6 64 e 03 6 64 e 03 6 64 e 03 1 16 e 02 43 4 02 e 04 4 12 3 97 e 04 4 06 3 97 e 04 4 06 3 97 e 04 4 06 7 96 e 04 3 87 83 4 50 e 06 6 48 4 50 e 06 6 47 4 50 e 06 6 47 4 50 e 06 6 47 1 16 e 05 6 10 163 1 37 e 07 5 04 1 38 e 07 5 02 1 38 e 07 5 02 1 38 e 07 5 02 3 66 e 07 4 98 323 4 33 e 09 4 98 4 40 e 09 4 97 4 40 e 09 4 97 4 40 e 09 4 97 1 16 e 08 4 97 643 1 36 e 10 4 99 1 38 e 10 4 99 1 38 e 10 4 99 1 38 e 10 4 99 3 66 e 10 4 99 23 1 02 e 02 9 06 e 03 9 06 e 03 9 06 e 03 1 45 e 02 43 4 53 e 04 4 50 4 13 e 04 4 46 4 13 e 04 4 46 4 13 e 04 4 46 7 18 e 04 4 33 83 1 10 e 05 5 37 1 02 e 05 5 35 1 02 e 05 5 35 1 02 e 05 5 35 1 86 e 05 5 27 163 1 91 e 07 5 85 1 72 e 07 5 88 1 72 e 07 5 88 1 72 e 07 5 88 3 81 e 07 5 61 323 7 28 e 09 4 71 6 33 e 09 4 77 6 33 e 09 4 77 6 33 e 09 4 77 1 38 e 08 4 78 643 2 79 e 10 4 71 2 38 e 10 4 74 2 38 e 10 4 74 2 38 e 10 4 74 5 40 e 10 4 68 table 4 2 experimental order of convergence eoc and l 2 errors at time t 5 for the euler manufactured solution test 4 7 e moving mesh dgsem is used with n 4 on a static mesh top and on a moving mesh bo om with the grid point distribution 4 5 4 2 entropy analysis validation e three dimensional euler equations 4 1 are equipped with the entropy entropy ux pairs s 1 fsl ul 1 l 1 2 3 4 8 where log p we are interested in the behavior of the discrete entropy conservation error s t s t s 0 4 9 where s is computed by 3 76 we investigate the inviscid taylor green vortex tgv test case 53 in the domain 0 2 3 e inviscid tgv can be a challenging test case regarding the robustness of a numerical scheme partly because the dynamics produce arbitrarily small scales e ow eld is thus by design under resolved which makes it a suitable test case to investigate the entropy conservation properties of the scheme e tgv evolves from the initial data 1 u sin x 1 cos x 2 cos x 3 cos x 1 sin x 2 cos x 3 0 t p p 0 1 16 cos 2 x 1 cos 2 x 2 cos 2 x 3 2 4 10 to render the simulation close to incompressible the mach numberm 0 1 p 0 is set to 0 1 by adjusting the pressure correspondingly we run the simulation withk 163 elements and periodic boundary conditions e nal time is chosen to be t 13 furthermore we apply the ux function in appendix c 1 to compute the derivative projection operator 3 62 in figure 4 3 we present a log log plot of the entropy conservation error for n 3 4 we note that the ux in appendix c 1 was used as surface ux without a dissipation term in these computations rendering the semi discrete discretization fully entropy conserving as expected we observe the reduction of the remaining entropy conservation error according to the order of the rk method for decreasing cfl numbers in figure 4 4 the temporal evolution of the entropy conservation errors s t is given e cfl number is set to ccfl 0 125 and polynomial degrees n 3 and n 4 are used we observe that the entropy conservation error s t is constant in time dashed line when the ux in appendix c 1 is used without a dissipation term is indicates the entropy conservation in the tvg test case on the other hand the entropy conservation error s t is decreasing in time solid line when the surface ux is stabilized by the dissipation term in appendix c 3 us the moving 25 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 10 1 100 10 12 10 11 10 10 10 9 10 8 10 7 10 6 10 5 10 4 cfl e rr or s t n 3 n 4 4 th order reference slope figure 4 3 log log plot of the entropy conservation errors s t for the euler equations with initial data 4 10 e errors are given at time t 13 for polynomials with degree n 3 solid line and n 4 do ed line on a curved moving mesh with k 163 elements mesh dgsem is an entropy stable scheme in this test case ese observations agree with the results in eorem 3 3 and corollary 3 5 4 3 free stream preservation validation we consider the euler equations 4 1 on the domain 0 2 3 with the initial data u x t x t u 1 x t u 2 x t u 3 x t e x t 1 0 3 0 0 17 4 11 e entropy stable dgsem is applied with the ux function in appendix c 1 as volume and surface ux as well as the dissipation operator in appendix c 3 to stabilize the surface ux we apply k 163 elements the formula 4 5 to describe the displacement of the mesh points and periodic boundary conditions are used in the simulation furthermore the nal time is set to t 20 in table 4 11 we present the l errors between the initial data 4 11 and the numerical solution at time t 20 for polynomials of degree n 3 top n 4 bo om and di erent cfl numbers ccfl we observe that the errors are close to zero and vary slightly for the di erent cfl numbers ese results indicate the compliance of the free stream preservation property 26 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 0 2 4 6 8 10 12 14 0 0010 0 0008 0 0006 0 0004 0 0002 0 0000 0 0002 time t e rr or s t tgv test case with n 3 no surface dissipation surface dissipation 0 2 4 6 8 10 12 14 0 0010 0 0008 0 0006 0 0004 0 0002 0 0000 0 0002 time t e rr or s t tgv test case with n 4 no surface dissipation surface dissipation figure 4 4 temporal evolution of the entropy conservation errors s t for the euler equations with initial data 4 10 e ux in appendix c 1 is used as surface ux without dissipation solid line and with the dissipation term in appendix c 3 dashed line ccfl l l u 1 l u 2 l u 3 l e 0 95 2 47 e 14 1 40 e 12 4 46 e 12 4 48 e 12 1 33 e 12 0 5 2 47 e 14 1 40 e 12 4 46 e 12 4 48 e 12 1 33 e 12 0 25 2 70 e 14 1 40 e 12 4 46 e 12 4 48 e 12 1 36 e 12 0 125 3 10 e 14 1 40 e 12 4 46 e 12 4 48 e 12 1 43 e 12 0 0625 3 78 e 14 1 40 e 12 4 46 e 12 4 48 e 12 1 56 e 12 0 95 2 07 e 14 1 24 e 12 5 28 e 12 5 21 e 12 1 12 e 12 0 5 2 49 e 14 1 24 e 12 5 28 e 12 5 21 e 12 1 30 e 12 0 25 2 81 e 14 1 24 e 12 5 28 e 12 5 21 e 12 1 34 e 12 0 125 3 32 e 14 1 24 e 12 5 28 e 12 5 21 e 12 1 40 e 12 0 0625 4 24 e 14 1 24 e 12 5 28 e 12 5 21 e 12 1 59 e 12 table 4 3 free stream preservation test for n 3 top and n 4 bo om e l errors measure the di erence between the initial data 4 11 and the numerical solution at time t 20 for di erent constants ccfl 4 4 robustness test as has been stated in section 4 2 and noted in literature 49 61 the inviscid tgv is a notoriously challenging test case for the stability of a high order discretization while for lower polynomial degrees calculations may be possible high order simulations are known to crash even if aliasing reducing methods like polynomial dealiasing are used 49 us we use the tgv test case 4 10 to demonstrate the increased robustness of the entropy stable moving mesh dgsem to do so we run the simulation up to t 13 using a polynomial degree of n 7 on three di erent meshes employing k 1 143 k 2 193 and k 3 263 elements ese cases correspond to the most restrictive simulatons from 49 again the point distribution given in 4 5 is used we use the ux function in appendix c 1 as volume and surface ux and stabilize the surface ux by the dissipation operator in appendix c 3 using the entropy stable moving dgsem we were able to run all simulations until nal time is shows that the consistent dissipation operators in combination with the entropy conservative volume uxes can lead to superior 27 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes stability properties 5 conclusions in this work a moving mesh dgsem to solve non linear conservation laws has been constructed and analyzed e semi discrete method is provably entropy stable and the free stream preservation property is satis ed for each explicit s stage runge ku a method we started the paper with a view on the ale transformation for one dimensional conservation laws and con structed a moving mesh fv method e condition 2 19 to construct entropy conservative two point uxes in the ale framework has been presented is condition can be seen as an extension of tadmor s discrete entropy condi tion 56 in the ale framework it is remarkable that an entropy conservative moving mesh ux can be constructed directly from an entropy conservative static mesh ux when a numerical state function with the property 2 23 is available is approach has been used in the appendix to construct entropy conservative uxes for the shallow water and euler equations en the moving mesh dgsem has been presented for three dimensional conservation laws e derivatives in space are approximated with high order derivative matrices which are sbp operators furthermore the split form dg framework 26 27 has been used to avoid aliasing in the discretization of the volume integrals in addition two point ux functions with the generalized entropy condition 2 19 are used in the split form dg framework ese modules in the spatial discretization are the basis to prove that the moving mesh dgsem is an entropy stable scheme it is worth to mention that the discrete entropy analysis requires merely the assumption that the time derivatives can be evaluated exactly operations like the integration by parts formula are mimicked by the spb operators on the discrete level e three dimensional euler equations have been considered to verify the proven properties of the moving mesh dgsem in our numerical experiments we presented convergence tests for smooth test problems to verify that the split form dg framework provides also on a moving mesh a high order accurate approximation furthermore the numerical robustness tests in the section 4 4 emphasize the relevance of the entropy stable dgsem since the method was able to run the challenging inviscid tgv test case until nal time acknowledgement gero schnu cke and gregor gassner are supported by the european research council erc under the european union s eights framework program horizon 2020 with the research project extreme erc grant agreement no 714487 e authors gratefully acknowledge the support and the computing time on hazel hen provided by the hlrs through the project hpcdg references 1 t j barth numerical methods for gasdynamic systems on unstructured meshes in an introduction to recent developments in theory and numerics for conservation laws springer berlin heidelberg 1999 s 195 285 2 r bellman introduction to matrix analysis volume 19 of classics in applied mathematics siam philadelphia pa 2 nd edition 1987 28 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 3 m bohm a r winters g j gassner d derigs f hindenlang and j saur an entropy stable nodal discontin uous galerkin method for the resistive mhd equations part i eory and numerical veri cation j comput phys 2018 doi org 10 1016 j jcp 2018 06 027 4 w boscheri and m dumbser arbitrary lagrangian eulerian discontinuous galerkin schemes with a posteriori subcell nite volume limiting on moving unstructured meshes j comput phys 346 2017 449 479 5 j c butcher e numerical analysis of ordinary di erential equations runge ku a and general linear methods wiley chichester 1987 6 j chan on discretely entropy conservative and entropy stable discontinuous galerkin methods j comput phys 362 2018 346 374 7 c canuto m y hussaini a arteroni and t a zang spectral methods fundamentals in single domains springer verlag 2006 8 p chandrashekar kinetic energy preserving and entropy stable nite volume schemes for compressible euler and navier stokes equations commun comput phys 14 2013 1252 1286 9 p chandrashekar and m zenk well balanced nodal discontinuous galerkin method for euler equations with gravity j sci comput 71 2017 1062 1093 10 g chavent and b cockburn e local projection p 0 p 1 discontinuous galerkin finite element method for scalar conservation laws esaim math model num m 2 an 23 1989 565 592 11 t chen and c w shu entropy stable high order discontinuous galerkin methods with suitable quadrature rules for hyperbolic conservation laws j comput phys 345 2017 427 461 12 e chiodaroli c de lellis and o kreml global ill posedness of the isentropic system of gas dynamics com mun pur appl math 68 2015 1157 1190 13 b cockburn and c w shu runge ku a discontinuous galerkin methods for convection dominated problems j sci comput 16 2001 173 261 14 j crean j e hicken d c del rey ferna ndez d w zingg and m h carpenter entropy stable summation by parts discretization of the euler equations on general curved elements j comput phys 356 2018 410 438 15 r j di perna convergence of approximate solutions to conservation laws arch ration mech an 82 1983 27 70 16 d a di pietro and a ern mathematical aspects of discontinuous galerkin methods vol 69 springer science business media 2011 17 j donea a huerta j p ponthot and a rodr guez ferran in encyclopedia of computational mechanics e stein r de borst and t j r hughes eds volume 1 fundamentals chapter 14 arbitrary lagrangian eulerian methods wiley 2004 18 c farhat p geuzaine and c grandmont e discrete geometric conservation law and the nonlinear stability of ale schemes for the solution of flow problems on moving grids j comput phys 174 2001 669 694 19 r fazio and r j leveque moving mesh methods for one dimensional hyperbolic problems using clawpack comput math appl 45 2003 273 298 29 doi org 10 1016 j jcp 2018 06 027 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 20 d c del rey ferna ndez j e hicken and d w zingg review of summation by parts operators with simulta neous approximation terms for the numerical solution of partial di erential equations comput fluids 2014 171 196 21 t c fisher and m h carpenter high order entropy stable nite di erence schemes for nonlinear conservation laws finite domains j comput phys 252 2013 518 557 22 u s fjordholm s mishra and e tadmor well balanced and energy stable schemes for the shallow water equations with discontinuous topography j comput phys 230 2011 5587 5609 23 l friedrich g schnu cke a r winters d c del rey ferna ndez g j gassner and m h carpenter en tropy stable space time discontinuous galerkin schemes with summation by parts property for hyperbolic conservation laws 2018 arxiv preprint arxiv 1808 08218 24 p fu g schnu cke and y xia arbitrary lagrangian eulerian discontinuous galerkin method for conservation laws on moving simplex meshes math comput 2018 available via https doi org 10 1090 mcom 3417 cited december 24 2018 25 g j gassner a skew symmetric discontinuous galerkin spectral element discretization and its relation to sbp sat nite di erence methods siam j sci comput 35 2013 a 1233 a 1253 26 g j gassner a r winters and d a kopriva split form nodal discontinuous galerkin schemes with summation by parts property for the compressible euler equations j comput phys 327 2016 39 66 27 g j gassner a r winters f j hindenlang and d a kopriva e br 1 scheme is stable for the compressible navier stokes equations j sci comput 77 2018 1 47 28 g j gassner a r winters and d a kopriva a well balanced and entropy conservative discontinuous galerkin spectral element method for the shallow water equations appl math comput 272 2016 291 308 29 s k godunov an interesting class of quasilinear systems dokl acad nauk sssr vol 139 1961 521 523 30 h guillard and c farhat on the signi cance of the geometric conservation law for ow computations on moving meshes comput method appl m 190 2000 1467 1482 31 a harten on the symmetric form of systems of conservation laws with entropy j comput phys 49 1983 151 164 32 f j hindenlang t bolemann and c d munz mesh curving techniques for high order discontinuous galerkin simulations in idihom industrialization of high order methods a top down approach springer cham 2015 133 152 33 w huang and r d russell adaptive moving mesh methods vol 174 springer science business media 2010 34 f ismail and p l roe a ordable entropy consistent euler ux functions ii entropy production at shocks j comput phys 228 2009 5410 5436 35 c a kennedy m h carpenter and r m lewis low storage explicit runge ku a schemes for the compress ible navier stokes equations appl numer math 35 2000 177 219 36 d a kopriva metric identities and the discontinuous spectral element method on curvilinear meshes j sci comout 26 2006 301 327 30 http arxiv org abs 1808 08218 https doi org 10 1090 mcom 3417 https doi org 10 1090 mcom 3417 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 37 d a kopriva implementing spectral methods for partial di erential equations algorithms for scientists and engineers springer science business media 2009 38 d a kopriva a r winters m bohm and g j gassner a provably stable discontinuous galerkin spectral element approximation for moving hexahedral meshes comput fluids 139 2016 148 160 39 h o kreiss and j oliger comparison of accurate methods for the integration of hyperbolic equations tellus 24 1972 199 215 40 s n kruz kov first order quasilinear equations in several independent variables math ussr sb 10 1970 217 243 41 m lesoinne and c farhat geometric conservation laws for ow problems with moving boundaries and de formable meshes and their impact on aeroelastic computations comput method appl m 134 1996 71 90 42 c k lombard and p d omas geometric conservation law and its application to ow computations on moving grids aiaa j 17 1979 1030 1037 43 i lomtev r m kirby and g e karniadakis a discontinuous galerkin ale method for compressible viscous flows in moving domains j comput phys 155 1999 128 159 44 r loube re p h maire m shashkov j breil and s galera reale a reconnection based arbitrary lagrangian eulerian method j comput phys 229 2010 4724 4761 45 f marinacci r pakmor and v springel e formation of disc galaxies in high resolution moving mesh cos mological simulations mon on not r astron soc 437 2013 1750 1775 46 d j mavriplis and z yang construction of the discrete geometric conservation law for high order time accurate simulations on dynamic meshes j comput phys 213 2006 557 573 47 c a a minoli and d a kopriva discontinuous galerkin spectral element approximations on moving meshes j comput phys 230 2011 1876 1902 48 m s mock systems of conservation laws of mixed type j di er equations 37 1980 70 88 49 r c moura g mengaldo j peiro and s j sherwin on the eddy resolving capability of high order discon tinuous galerkin approaches to implicit les under resolved dns of euler turbulence j comput phys 330 2017 615 623 50 v t nguyen an arbitrary lagrangian eulerian discontinuous galerkin method for simulations of ows over variable geometries j fluid struct 26 2010 312 329 51 p o persson j bonet j peraire discontinuous galerkin solution of the navier stokes equations on de formable domains comput method appl m 198 2009 1585 1595 52 h ranocha generalised summation by parts operators and entropy stability of numerical methods for hy perbolic balance laws cuvillier verlag 2018 53 c w shu w s don d go lieb o schilling and l jameson numerical convergence study of nearly incom pressible inviscid taylor green vortex ow j sci comput 24 2005 1 27 54 l shunn and f ham method of manufactured solutions applied to variable density ow solvers annual re search briefs 2007 center for turbulence research 2007 155 168 31 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes 55 v springel e pur si muove galilean invariant cosmological hydrodynamical simulations on a moving mesh mon on not r astron soc 401 2010 791 851 56 tadmor eitan e numerical viscosity of entropy stable schemes for systems of conservation laws i math comput 49 1987 91 103 57 e tadmor entropy stability theory for di erence approximations of nonlinear conservation laws and related time dependent problems acta numer 12 2003 451 512 58 e f toro riemann solvers and numerical methods for uid dynamics a practical introduction springer science business media 2013 59 l wang and p o persson high order discontinuous galerkin simulations on moving domains using ale for mulations and local remeshing and projections 53 rd aiaa aerospace sciences meeting aiaa scitech forum aiaa 2015 0820 available via https dx doi org 10 2514 6 2015 0820 cited december 24 2018 60 n wintermeyer a r winters g j gassner and d a kopriva an entropy stable nodal discontinuous galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontin uous bathymetry j comput phys 340 2017 200 242 61 a r winters r c moura g mengaldo g j gassner s walch j peiro s j sherwin a comparative study on polynomial dealiasing and split form discontinuous galerkin schemes for under resolved turbulence com putations j comput phys 372 2018 1 21 62 a r winters d derigs g j gassner and s walch a uniquely de ned entropy stable matrix dissipation operator for high mach number ideal mhd and compressible euler simulations j comput phys 332 2017 274 289 63 a r winters and d a kopriva ale dgsem approximation of wave re ection and transmission from a mov ing medium j comput phys 263 2014 233 267 64 a r winters discontinuous galerkin spectral element approximations for the re ection and transmission of waves from moving material interfaces diss e florida state university 2014 a proof for lemma 3 1 in this section we prove lemma 3 1 for the sake of simplicity we present merely the proof in two dimensions e three dimensional proof can be done by the same argumentation e two dimensional bijective isoparametric trans nite mapping can be computed as in kopriva 37 chapter 6 equation 6 18 e mapping is for all 1 2 t e given by 1 2 t 1 2 1 1 in 4 2 t 1 1 in 2 2 t 1 2 1 2 in 1 1 t 1 2 in 3 1 t 1 4 1 1 1 2 in 1 1 t 1 2 in 3 1 t 1 4 1 1 1 2 in 1 1 t 1 2 in 3 1 t a 1 32 https dx doi org 10 2514 6 2015 0820 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes x 1 x 2 ek t 1 1 t 2 2 t 3 1 t 4 2 t 1 2 t 1 2 figure a 1 le the reference element e 1 1 2 and on the right a general quadrilateral element ek t with the curved faces 1 1 t 2 2 t 3 1 t and 4 2 t e mapping 1 2 t connects e and ek t it is worth to mention that the mapping 1 2 t matches with the boundary faces in the interpolation points e location of the curved faces 1 1 t 2 2 t 3 1 t and 4 2 t is sketched in figure a 1 in the following e 1 t and e 2 t are two neighboring elements which share the same boundary face without lost of generality the elements share the face 13 21 as it is illustrated in figure a 2 en for the elements el t e 1 t 11 1 t 12 2 t 13 1 t 14 2 t e 2 t 21 1 t 23 1 t 22 2 t 24 2 t x 1 x 2 figure a 2 two elements e 1 t and e 2 t of a conforming mesh sharing the same curved boundary do ed curve l 1 2 the grid velocity eld is given by l 1 2 t 1 2 1 1 in d dt l 4 2 t 1 1 in d dt l 2 2 t 1 2 1 2 in d dt l 1 1 t 1 2 in d dt l 3 1 t 1 4 1 1 1 2 in d dt l 1 1 t 1 2 in d dt l 3 1 t 1 4 1 1 1 2 in d dt l 1 1 t 1 2 in d dt l 3 1 t a 2 since it holds the identity d dt in li in d dt li l 1 2 and i 1 2 3 4 a 3 furthermore since for l 1 2 and i 1 2 3 4 the faces li t are continuously di erentiable in the time 33 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes interval 0 t it holds in d dt 14 1 t in d dt 13 1 t in d dt 12 1 t in d dt 13 1 t a 4 in d dt 24 1 t in d dt 21 1 t in d dt 22 1 t in d dt 21 1 t a 5 d dt 13 j t d dt 21 j t j 0 n a 6 where j n j 0 are interpolation points for the element e 1 t the points along the interface with e 2 t are mapped in the set 1 1 1 hence the grid velocity becomes 1 1 t in d dt 13 t 1 1 a 7 by a 4 on the opposite for the element e 2 t the points along the interface with e 1 t are mapped in the set 1 1 1 and we obtain 2 1 t in d dt 21 t 1 1 a 8 by a 5 us we obtain 1 1 t 2 1 t by a 6 is proves that the grid velocity is continuous in the interface points of the two neighboring elements b entropy stable moving mesh shallow water uxes in this section we apply the methodology in remark 2 2 to construct two entropy conservative moving mesh uxes for the shallow water equations e homogeneous shallow water equations without bo om topography are given by u t f 0 b 1 e state vector and the components of the block vector ux f are de ned as u h hu 1 hu 2 f 1 hu 1 hu 21 g 2 h 2 hu 1 u 2 f 2 hu 2 hu 1 u 2 hu 22 g 2 h 2 b 2 where the conserved states are the water height and the discharge h u hu 1 hu 2 t e quantity g is the gravita tional constant e shallow water equations are equipped with the entropy entropy ux pairs s 1 2 h u 2 1 2 gh 2 fsl 1 2 hul u 2 gh 2 ul l 1 2 b 3 e entropy variables are w gh 1 2 u 2 u 1 u 2 t b 4 e entropy functionals are given by wtu s 1 2 gh 2 l w t fl fsl 1 2 gh 2 ul l 1 2 b 5 34 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes b 1 entropy conservative shallow water ux based on the ux in 60 friedrich et al 23 appendix a equation a 4 constructed the following state function u h h u 1 h u 2 b 6 e state function b 6 is consistent with the shallow water state symmetric and satis es w tu 1 2 g h 2 b 7 in addition an entropy conservative numerical ux for the shallow water equations has been constructed by win termeyer winters gassner kopriva wgwk 60 e ux is given by fec wgwk 1 hu 1 hu 1 u 1 g h 2 12 h 2 hu 1 u 2 fec wgwk 2 hu 2 hu 2 u 1 hu 2 u 2 g h 2 12 h 2 b 8 e ux b 8 is consistent symmetric and satis es w tfec wgwkl 1 2 g h 2 ul l l 1 2 b 9 e state function b 6 and the ux b 8 are used to construct the ux gec wgwk 1 f ec wgwk 1 1 u hu 1 h 1 hu 1 u 1 h u 1 1 g h 2 12 h 2 hu 1 u 2 h u 2 1 b 10 a and gec wgwk 2 f ec wgwk 2 2 u hu 2 h 2 hu 2 u 1 h u 1 2 hu 2 u 2 h u 2 2 g h 2 12 h 2 b 10 b e ux functions b 10 a b 10 b are consistent with g 1 g 2 symmetric and it follows by b 7 and b 9 w tgec wgwkl w tfec wgwkl l w tu l l l 1 2 b 11 b 2 entropy conservative shallow water ux based on the ux in 22 fjordholm mishra tadmor fmt constructed a further entropy conservative numerical ux for the shallow water equations in 22 is ux is given by fec fmt 1 h u 1 h u 1 2 g 2 h 2 h u 1 u 2 fec fmt 2 h u 2 h u 1 u 2 h u 2 2 g 2 h 2 b 12 e state function b 6 and the ux b 12 are used to construct the ux gec fmt 1 h u 1 1 h u 1 1 u 1 12 h 2 h u 1 1 u 2 gec fmt 2 h u 2 2 h u 2 2 u 1 h u 2 2 u 2 12 h 2 b 13 e ux functions b 13 are consistent with g 1 g 2 symmetric and satisfy b 11 35 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes b 3 matrix dissipation term for the shallow water ux in the section 3 7 it has been shown that the matrix dissipation operators to stabilize the entropy conservative moving mesh ux are basically the same as on a static mesh us we use the shallow water uxes from the previous appendices b 1 and b 2 with the dissipation operators from wintermeyer et al 60 in the following the matrices to construct the entropy stable dissipation operators 3 92 are listed e scaling matrix for the right eigenvalues is given by t diag 1 2 g h 1 2 g b 14 in both directions erefore we apply the following discrete scaling matrix t diag 1 2 g h 1 2 g b 15 e average components of the other matrices to compute the dissipation term in the x 1 direction are r 1 1 0 1 u 1 g h 0 u 1 g h u 2 1 u 2 b 16 1 diag u 1 1 g h u 1 1 u 1 1 g h b 17 in the x 2 direction the components are given by r 2 1 0 1 u 1 1 u 1 u 2 g h 0 u 2 g h b 18 2 diag u 2 2 g h u 2 2 u 2 2 g h b 19 c entropy stable moving mesh euler uxes we present entropy stable cartesian uxes gecl l 1 2 3 for the compressible euler equations 4 1 equipped with the entropy entropy ux pairs 4 8 en the entropy variables are given by w 1 u 2 2 u 1 2 u 2 2 u 3 2 t with 2 p c 1 and the entropy functionals are given by wtu s l wt fl fsl ul l 1 2 3 c 2 c 1 entropy conservative euler ux based on the ux in 8 in the following the logarithmic mean log will be used for two positive states a and a the logarithmic mean is de ned by a log a log a if a 6 a a if a a c 3 36 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes a numerically stable procedure to compute the logarithmic mean c 3 is provided by ismail and roe 34 appendix b friedrich et al 23 eorem 3 constructed the following state function u log log u 1 log u 2 log u 3 log 2 1 log 1 2 log u 2 c 4 where u 2 2 u 1 2 u 2 2 u 3 2 u 21 u 2 2 u 2 3 c 5 e state function c 4 is consistent symmetric and it holds w tu c 6 furthermore chandrashekar constructed in 8 a kinetic energy preserving and entropy conservative kepec nu merical ux function for the compressible euler equations in the x 1 direction chandrashekar s kepec ux is given by fec ch 1 log u 1 log u 1 2 2 log u 1 u 2 log u 1 u 3 log u 1 2 1 log 1 2 log u 1 u 2 u 1 2 c 7 e ux c 7 is consistent with f 1 and symmetric in particular chandrashekar proved that w tfec ch 1 u 1 1 c 8 e state function c 4 and the ux function c 7 are used to construct the ux gec ch 1 f ec ch 1 1 u log u 1 1 log u 1 1 u 1 2 log u 1 1 u 2 log u 1 1 u 3 log u 1 1 2 1 log 1 2 log u 1 1 u 2 u 1 2 c 9 e ux c 9 is consistent with g 1 f 1 1 u symmetric and it follows w tgec ch 1 w tfec ch 1 1 w tu 1 1 c 10 by c 6 and c 8 in the same way the x 2 direction and the x 3 direction of chandrashekar s kepec ux can be used to construct gec ch 2 log u 2 2 log u 1 u 2 2 log u 2 u 2 2 2 log u 2 2 u 3 log u 2 2 2 1 log 1 2 log u 2 2 u 2 u 2 2 c 11 37 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes and gec ch 3 log u 3 3 log u 1 u 3 3 log u 2 u 3 3 log u 3 u 3 3 2 log u 3 3 2 1 log 1 2 log u 3 3 u 2 u 3 2 c 12 e uxes c 11 c 12 are consistent with g 2 f 2 2 u g 3 f 3 3 u symmetric and satisfy w tgec ch 2 w tfec ch 2 2 w tu 2 2 c 13 w tgec ch 3 w tfec ch 3 3 w tu 3 3 c 14 c 2 entropy conservative euler ux based on the ux in 52 ranocha constructed in his phd thesis 52 another kepec numerical ux for the compressible euler equations we proceed as in the appendix c 1 and use the state c 4 and ranocha s ux to construct the following two point ux functions gec r 1 log u 1 1 log u 1 1 u 1 p log u 1 1 u 2 log u 1 1 u 3 log 2 1 log 1 2 log u 1 1 u 2 2 p u 1 pu 1 c 15 a gec r 2 log u 2 2 log u 1 u 2 2 log u 2 u 2 2 p log u 2 2 u 3 log 2 1 log 1 2 log u 2 2 u 2 2 p u 2 pu 2 c 15 b and gec r 3 log u 3 3 log u 1 u 3 3 log u 2 u 3 3 log u 3 u 3 3 p log 2 1 log 1 2 log u 3 3 u 2 2 p u 3 pu 3 c 15 c e ux functions c 15 are consistent with g 1 g 2 g 3 symmetric and satisfy w tgec rl l l l 1 2 3 c 16 c 3 matrix dissipation term for the euler ux we will use the euler uxes from the previous appendices c 1 and c 2 with the dissipation operators form winters et al 62 in the following the matrices to construct the entropy stable dissipation operators 3 92 are listed e average components of the dissipation term in the x 1 direction are given by r 1 1 1 0 0 1 u 1 c u 1 0 0 u 1 c u 2 u 2 1 0 u 2 u 3 u 3 0 1 u 3 h u 1 c 12 u 2 u 2 u 3 h u 1 c c 17 38 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes t 1 diag log 2 1 log 2 2 log 2 c 18 1 diag u 1 1 c u 1 1 u 1 1 u 1 1 u 1 1 c c 19 where c 2 log h 2 1 log 1 2 u 2 c 20 in the x 2 direction the components are given by r 2 1 0 1 0 1 u 1 1 u 1 0 u 1 u 2 c 0 u 2 0 u 2 c u 3 0 u 3 1 u 3 h u 2 c u 1 12 u 2 u 3 h u 2 c c 21 t 2 diag log 2 2 1 log 2 log 2 c 22 2 diag u 2 2 c u 2 2 u 2 2 u 2 2 u 2 2 c c 23 and in the x 3 direction the components are given by r 3 1 0 0 1 1 u 1 1 0 u 1 u 1 u 2 0 1 u 2 u 2 u 3 c 0 0 u 3 u 3 c h u 3 c u 1 u 2 12 u 2 h u 3 c c 24 t 3 diag log 2 2 2 1 log log 2 c 25 3 diag u 3 3 c u 3 3 u 3 3 u 3 3 u 3 3 c c 26 d proofs of entropy conservation for advection terms in this section we apply the sbp formula or abel transformation k k 1 ak bk 1 bk akbk 1 a 1 b 1 k 1 k 1 ak 1 bk 1 bk d 1 for two sequences ak k k 1 and bk k 1 k 1 furthermore we apply the following identities which result from the properties of the sbp operator q n i j 0 qij a i j b i j n i j 0 qijaibj anbn a 0 b 0 d 2 n i j 0 qij a i j b i j c i j n i j 0 2 qijai b i j c i j anbncn a 0 b 0 c 0 d 3 where a ni 0 b n i 0 and c n i 0 are generic nodal values ese identities can be proven in a similar way as the discrete split forms in lemma 1 in 26 us we skip a proof in this paper 39 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes d 1 proof for eorem 2 1 we multiply the equation 2 16 b by the discrete entropy variables wk and sum over all elements ik t k k 1 wtk djkuk dt k k 1 wtk g k 1 2 g k 1 2 d 4 e same arguments as in the computation of 2 10 provide the identity wtk djkuk dt jk d dt sk uk djk dt wtk uk d dt jksk uk djk dt k d dt jksk uk k 1 2 k 1 2 k d 5 where we used the d gcl 2 16 a in the last step next we sum the equation d 5 over all elements ik t and obtain k k 1 wtk djkuk dt d dt k k 1 jksk uk k k 1 k 1 2 k 1 2 k d 6 by the entropy condition 2 19 and the sbp formula d 1 follows k k 1 wtk g k 1 2 g k 1 2 wtkg k 1 2 wt 1 g 1 2 k 1 k 1 wk 1 wk t g k 1 2 wtkg k 1 2 wt 1 g 1 2 k 1 k 1 k 1 k k 1 k 1 k 1 2 k 1 k d 7 e rst sum in the last line is a telescope sum and it follows k 1 k 1 k 1 k k 1 d 8 to evaluate the second sum we use again the sbp formula d 1 and obtain k 1 k 1 k 1 2 k 1 k k 1 k 1 k 1 2 k 1 k k k 1 k 1 2 k 1 2 k k k 1 k 1 2 k 1 2 k k 1 2 k 1 2 1 k k 1 k 1 2 k 1 2 k d 9 next we plug the equations d 8 d 9 in d 7 and obtain k k 1 wtk g k 1 2 g k 1 2 k k 1 k 1 2 k 1 2 k wtkg k 1 2 k k 1 2 k wt 1 g 1 2 1 1 2 1 d 10 finally we plug the equations d 6 and d 10 in d 4 and obtain d dt k k 1 jks uk wtkg k 1 2 k k 1 2 k wt 1 g 1 2 1 1 2 1 d 11 40 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes d 2 proof for equation 3 82 e ux gec satis es the symmetry property 3 64 and the sbp property 3 58 provides 2 idim 2 qim qim qmi bim i m 0 n d 12 us we obtain dn g ec w n n j k 0 j k n i m k 0 qim w t i m j gec ijk mjk uijk umjk j a 1 i m jk n j k 0 j k n i m 0 bimwtijk gec ijk mjk uijk umjk j a 1 i m jk n i k 0 i k n j m 0 qjm w ti j m k gec ijk imk uijk uimk j a 2 i j m k n i k 0 i k n j m 0 bjmwtijk gec ijk imk uijk uimk j a 2 i j m k n i j 0 i j n j m 0 qkm w tij k m gec ijk ijm uijk uijm j a 3 ij k m n i j 0 i j n j m 0 bkmwtijk gec ijk ijm uijk uijm j a 3 ij k m d 13 by the same calculation as in 23 appendix c 1 equations c 4 and c 5 or 27 appendix b 3 equation b 31 to evaluate the uxes gec at the element interfaces we apply the consistence condition 3 63 such that e g gec njk njk unjk unjk f unjk n n jkunjk gnjk j k 0 n d 14 is provides the identity n j k 0 j k n i m 0 bimwtijk gec ijk mjk uijk umjk j a 1 i m jk n i k 0 i k n j m 0 bjmwtijk gec ijk imk uijk uimk j a 2 i j m k n i j 0 i j n k m 0 bkmwtijk gec ijk ijm uijk uijm j a 3 ij k m n j k 0 j k wtnjk gnjk j a 1 njk wt 0 jk g 0 jk j a 1 0 jk n i k 0 i k wtink gink j a 2 ink wti 0 k gi 0 k j a 2 i 0 k n i j 0 i j wtijn gijn j a 3 ijn wtij 0 gij 0 j a 3 ij 0 e n wt g n ds d 15 41 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes next we investigate the rst sum on the right hand side in the equation d 13 since the uxes gecl l 1 2 3 satisfy the entropy condition 3 65 follows n j k 0 j k n i m 0 qim w t i m jk gec ijk mjk uijk umjk j a 1 i m jk n j k 0 j k n i m 0 qim w t i m jkg ec 1 ijk mjk uijk umjk ja 1 1 i m jk n j k 0 j k n i m 0 qim w t i m jkg ec 2 ijk mjk uijk umjk ja 1 2 i m jk n j k 0 j k n i m 0 qim w t i m jkg ec 3 ijk mjk uijk umjk ja 1 3 i m jk n j k 0 j k n i m 0 qim 1 i m jk 1 i m jk i m jk ja 11 i m jk n j k 0 j k n i m 0 qim 2 i m jk 2 i m jk i m jk ja 12 i m jk n j k 0 j k n i m 0 qim 3 i m jk 3 i m jk i m jk ja 13 i m jk d 16 for l 1 2 3 the spb properties d 2 and d 3 provide n j k 0 j k n i m 0 qim l i m jk l i m jk i m jk ja 1 l i m jk n j k 0 j k l njk l njk njk ja 1 l njk l 0 jk l 0 jk 0 jk ja 1 l 0 jk n i j k 0 i j k l ijk n m 0 dim ja 1 l mjk n i j k 0 i j k ijk n m 0 2 dim l i m jk ja 1 l i m jk d 17 hence we obtain the identity n j k 0 j k n i m 0 qim w t i m jk gec ijk mjk uijk umjk j a 1 i m jk n j k 0 j k njk njk njk j a 1 njk 0 jk 0 jk 0 jk j a 1 0 jk n i j k 0 i j k ijk n m 0 dim j a 1 mjk n i j k 0 i j k ijk n m 0 2 dim i m jk j a 1 i m jk d 18 42 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes by the same computation the third sum on the right hand side in the equation d 13 becomes n i k 0 i k n j m 0 qjm w ti j m k gec ijk imk uijk uimk j a 2 i j m k n i k 0 i k ink ink ink j a 2 ink i 0 k i 0 k i 0 k j a 2 i 0 k n i j k 0 i j k ijk n m 0 djm j a 2 imk n i j k 0 i j k ijk n m 0 2 djm i j m k j a 2 i j m k d 19 and the sum next to last on the right hand side in the equation d 13 becomes n i j 0 i j n k m 0 qkm w tij k m gec ijk ijm uijk uijm j a 3 ij k m n i j 0 i j ijn ijn ijn j a 3 ijn ij 0 ij 0 ij 0 j a 3 ij 0 n i j k 0 i j k ijk n m 0 dkm j a 3 ijm n i j k 0 i j k ijk n m 0 2 dkm ij k m j a 3 ij k m d 20 e de nition of the derivative projection operator 3 60 in the d gcl 3 69 a provides n i j k 0 i j k ijk n m 0 2 dim i m jk j a 1 i m jk n i j k 0 i j k ijk n m 0 2 djm i j m k j a 2 i j m k n i j k 0 i j k ijk n m 0 2 dkm ij k m j a 3 ij k m n i j k 0 i j k ijk dn ijk dn n d 21 next we plug the equations d 15 d 18 d 19 d 20 in the equation d 13 and apply the identity d 21 is results in the identity dn g ec w n e n wt g n n ds dn n n i j k 0 i j k ijk n m 0 dim j a 1 mjk djm j a 2 imk dkm j a 3 ijm d 22 43 g schnu cke n krais t bolemann and g j gassner entropy stable dg schemes on moving meshes e de nition of the contravariant vector ux functions 3 22 and contravariant block vector ux functions 3 27 provide the equality wt g n n 3 l r 1 jarl wtgl l l n r 3 l r 1 jarl f s l ls n r s n f s s f sn n s d 23 erefore the equation d 22 simpli es to dn g ec w n e n f sn n s ds dn n d 24 since the discrete volume weighted contravariant vectors j a 1 2 3 are computed by the conservative curl form 3 50 and the discrete metric identities 3 52 are satis ed in the lgl points 44 1 introduction 2 basic concepts for 1 d conservations laws in the ale framework 2 1 entropy analysis in one dimension 2 2 discrete entropy conservation for moving mesh fv methods 2 3 free stream preservation for moving mesh fv methods 3 entropy stable dgsem on moving meshes 3 1 building blocks of the ale transformation for hexahedral curved meshes 3 2 transformation of the conservation law onto a reference element 3 3 entropy analysis in three dimensions 3 4 buidling blocks for the spectral element approximation 3 5 the semi discrete discontinuous galerkin method 3 6 discrete entropy conservation for the semi discrete method 3 7 discrete entropy stability for the semi discrete method 3 8 free stream preservation of the moving mesh dgsem 4 numerical results 4 1 experimental convergence rates 4 2 entropy analysis validation 4 3 free stream preservation validation 4 4 robustness test 5 conclusions a proof for lemma 3 1 b entropy stable moving mesh shallow water fluxes b 1 entropy conservative shallow water flux based on the flux in wintermeyer 2017 b 2 entropy conservative shallow water flux based on the flux in fjordholm 2011 b 3 matrix dissipation term for the shallow water flux c entropy stable moving mesh euler fluxes c 1 entropy conservative euler flux based on the flux in chandrashekar 2013 c 2 entropy conservative euler flux based on the flux in ranocha 2018 c 3 matrix dissipation term for the euler flux d proofs of entropy conservation for advection terms d 1 proof for theorem 2 1 d 2 proof for equation 3 82