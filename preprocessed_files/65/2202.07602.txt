accelerating the convergence of dynamic iteration method with restricted additive schwarz splitting for the solution of rlc circuits accelerating the convergence of dynamic iteration method with restricted additive schwarz splitting for the solution of rlc circuits he le na shourick a b damien tromeur dervout b laurent che dot a asupergrid institute 23 rue cyprian 69200 villeurbanne france helena shourick laurent chedot supergrid institute com binstitut camille jordan universite de lyon umr 5208 cnrs u lyon 1 villeurbanne france damien tromeur dervout univ lyon 1 fr abstract the dynamic iteration method with a restricted additive schwarz splitting is investigated to co simulate linear differential algebraic equations system coming from rlc electrical circuit with linear components we show the pure linear convergence or divergence of the method with respect to the linear operator be longing to the restricted additive schwarz interface it allows us to accelerate it toward the true solution with the aitken s technique for accelerating convergence this provides a dynamic iteration method less sensitive to the splitting numerical examples with convergent and divergent splitting show the efficiency of the proposed approach we also test it on a linear rlc circuit combining different types of circuit model ing transient stability model and electro magnetic transient model with overlapping partitions finally some results for a weakly nonlinear differential algebraic equations system are also provided keywords co simulation dynamic iteration restricted additive schwarz aitken s convergence acceleration 2010 msc 65 65 b 05 65 l 80 65 m 55 68 u 20 1 introduction since the pioneering work of lelarasme al 1 that analyze in time domain large scale problems arising from the modeling of integrated circuits waveform relaxation methods wr 2 also known as dynamic iteration methods a term first introduced by miekkala and nevanlinna 3 eq 2 2 and generally used in publications 4 5 6 7 8 arouses more and more interest with this work was supported by a grant overseen by the french national research agency anr as part of the in vestissements d avenir program ane ite 002 01 1 ar x iv 2 20 2 07 60 2 v 1 m at h n a 1 5 f eb 2 02 2 https orcid org https orcid org 0000 0002 0118 8100 https orcid org h shourick et al 1 16 2 the development of parallel computers 9 and more generally in the co simulation framework 7 10 in such methods applied to ordinary differential equations ode systems or to differential algebraic equations dae systems the system is decomposed into several subsystems with many internal variables and few external variables for initial value problems with linear odes the method consists in carrying out some splitting of the linear operator a m n 3 such as jacobi relaxed jacobi gauss seidel or sor nevertheless this fixed point process must be contractant to converge the analysis of the convergence of the method using the laplace trans form says that the convergence occurs when the spectral radius max r i i m 1 n 1 3 eq 2 13 for initial value problems with linear dae systems bx ax f like those aris ing in rlc circuits miekkala 4 theorem 2 extented her previous convergence analysis result with the splitting of b mb nb and a ma na max r i mb ma 1 i nb na 1 reichel al combined the waveform sor with the multistep integration method and showed that the sor relaxation optimal parameter is dependent on fourier frequencies 9 eq 19 jiang and wing determined the expressions of the spectrum and pseudospectrum of the waveform re laxation operators for linear differential algebraic equations systems which occur especially in circuit simulation 11 eqs 3 4 and jiang extended these results to a general class of non linear differential algebraic equations 12 of index one these extended resuts generalize the expressions of lumsdaine and wu 13 several techniques to precondition the fixed point prob lem were proposed by arnold gunther 14 hout has established convergence results that are relevant in applications to nonlinear nonautonomous stiff initial value problems 15 some convergence acceleration techniques for the wr have been proposed some waveform successive overrelaxation sor techniques have been proposed by janssen and vandewalle 16 to accelerate the standard waveform method leimkuhler proposed to accelerate the wr by solving the defect equations with a larger timestep or by using a recursive procedure based on a succession of increasing timesteps 17 lumdaisne wu proposed to accelerate the wr by krylov subspace techniques wgmres 18 to solve time dependent problems botchev al 19 compared wr krylov with krylov s methods combined with the shift and invert sai technique to obtain parallelism in time ladics 20 combined the wr with convergent numeri cal methods to solve semi linear pdes he showed the effect of applying time windows recent developments in the dynamic iteration method for the co simulation of electrical circuits have been carried out by bartel al 21 6 and by ali al 22 gausling al 23 analyzed the contraction and the rate of convergence of the co simulation process for a test circuit subjected to uncertainties on the parameters of its components morever the rate of convergence or diver gence of the dynamic iteration depends on the interface coupling 24 pade and tischendorf 25 presented topological criteria for the coupling of networks which are easy to check and which are sufficient to ensure the convergence of the wr which is related to the dae index in this paper we focus on dynamic iteration for linear dae as in 11 with a perspective of ac celerating domain decomposition garbey and tromeur dervout developed the aitken schwarz domain decomposition 26 using the pure linear convergence of schwarz type method to accel erate their convergence with the aitken s technique for accelerating convergence for pde prob lems tromeur dervout 27 28 developed a completely algebraic formulation of this aitken s technique for accelerating convergence as a fonction of the trace of the schwarz s iterations on the domain decomposition interface shourick al developed heterogenous schwarz domain decomposition accelerated by the aitken s technique for accelerating convergence for the co simulation of electromagnetic transient and transient stability 29 we want to demonstrate with such a technique that we can acceleterate the dynamic iteration to obtain the solution whatever 2 h shourick et al 1 16 3 its convergence or its divergence and therefore without topological criteria on the coupling as in 25 or 24 the outline of this paper is as follows section 2 focuses on dynamic iteration for linear daes for which the splitting of linear operators follows a restrictive additive schwarz ras domain decomposition section 3 details the error operator of the dynamic iteration associated with the ras domain decomposition and the acceleration of the convergence with aitken s technique using the pure linear convergence i e the error operator does not depend on the iteration we present numerical results in section 5 with examples of linear daes of index one and two as well as with heterogeneous modeling using electromagnetic transient modeling and transient stability modeling with overlap we conclude in section 6 2 dynamic iteration for linear dae let us consider the linear dae x t ax t by t b 1 t x 0 x 0 cx t dy t b 2 t t 0 t 1 where x t rn 1 and y t rn 2 for all t 0 t d is a n 2 n 2 nonsingular matrix a is an n 1 n 1 matrix b is an n 1 n 2 matrix c is an n 2 n 1 matrix b 1 t rn 1 and b 2 t rn 2 are known input functions and x 0 rn 1 is a consistent initial value let n n 1 n 2 let us write the dynamic iteration in the context of a ras domain decomposition first we define the matrix a a b c d corresponding to the linear operator of the dae and we define z t x t y t t b t b 1 t b 2 t t and id in 1 0 n 1 n 2 0 n 2 n 1 0 n 2 n 2 then we can rewrite eq 1 as id z t az t b t x 0 x 0 t 0 t 2 by adapting the notations of 30 we consider the matrix a rn n having a non zero pattern and the associated graph g w f where the set of vertices w 1 n represents the n unknowns and the set of edges f i j ai j 6 0 represents the pairs of vertices that are coupled by a non zero element in a then we assume that a graph partitioning was applied and that resulted in n non overlapping subsets w 0 i whose union is w let w p i be the p overlap partition of w obtained by including all the vertices immediately neighboring the vertices of w p 1 i let w p i e w p 1 i w p i then let r p i r ni n rpi e r ni e n and r 0 i r ni n respectively be the operator which restricts x rn to the components of x belonging to w pi w p i e and w 0 i respectively and the operator r 0 i r ni n puts 0 to the unknowns belonging to w pi w 0 i we define the operators ai r p i ar pt i and ei r p i ar pt i e the vectors zi r p i z bi r p i b and zi e r p i ez we also introduce r p d i r ni 1 n 1 and rp ai r ni 2 n 2 respectively r p di r ni 1 n 1 r 0 ai r ni 2 n 2 rp di e r nie 1 n 1 and rp ai e r nie 2 n 2 which separate the differential and the al gebraic variables belonging to w pi respectively w 0 i and w p i e i e r p i rp di 0 ni 1 n 2 0 ni 2 n 1 r p a i 3 h shourick et al 1 16 4 respectively r 0 i r 0 di 0 ni 1 n 2 0 ni 2 n 1 r 0 a i and rpi e rp di e 0 nie 1 n 2 0 nie 2 n 1 r p a i e and ii d ini 1 0 ni 1 ni 2 0 ni 2 ni 1 0 ni 2 ni 2 definition 1 the dynamic iteration k 1 with the ras splitting is written locally for the w pi partition as ii d z i k 1 t aiz k 1 i t bi t eiz k i e t t 0 t xi 0 r p d i x 0 3 and by separating the differential and algebraic variables belonging to the partition w pi x k 1 i t aix k 1 i t biy k 1 i t bi d t e d i dx k ie t e a i dy k ie t cix k 1 i t diy k 1 i t bi a t e d i ax k ie t e a i ay k ie t xi 0 r p d i x 0 t 0 t 4 where ai bi ci di rp di 0 ni 1 n 2 0 ni 2 n 1 r p a i a rp di t 0 n 1 ni 2 0 n 2 ni 1 r p a i t 5 edi d e a i d edi a e a i a rp di 0 ni 1 n 2 0 ni 2 n 1 r p a i a rp di e t 0 n 1 nie 2 0 n 2 nie 1 r p a i e t 6 proposition 1 the dynamic iteration with the ras splitting is written globally as x k 1 t ad 1 x k 1 t bd 1 y k 1 t bd t ad 2 x k t bd 2 y k t ca 1 x k 1 t da 1 y k 1 t ba t ca 2 x k t da 2 y k t x k 1 0 x 0 t 0 t 7 with ad 1 n 1 i 0 r 0 di air p d i a d 2 n 1 i 0 r 0 di e d i dr p d ie b d t n 1 i 0 r 0 di r p d i b t bd 1 n 1 i 0 r 0 di bir p a i b d 2 n 1 i 0 r 0 di e a i dr p a ie ca 1 n 1 i 0 r 0 ai cir p d i c a 2 n 1 i 0 r 0 ai e d i ar p d ie da 1 n 1 i 0 r 0 ai dir p a i d a 2 n 1 i 0 r 0 ai e a i ar p a ie b a t n 1 i 0 r 0 di r p a i b t proof the sum of the contribution of each partition with n 1 i 0 r 0 d i and the definitions of xi yi xi e yi e give the result 4 h shourick et al 1 16 5 3 dynamic iteration error operator and acceleration we are in the formalism of the dynamic iteration with a general splitting by adapting the results 11 eq 3 and 4 to our notations we have theorem 1 jiang wing 11 the dynamic iteration with ras splitting applied to a linear dae system has an error operator r which does not depend on the iteration number such as z k r z k 1 8 r r 1 r 2 da 1 1 cd 2 c d 1 r 1 d a 1 1 da 2 c d 1 r 2 9 with r 1 u t t 0 e s 1 t s ad 2 b d 1 d a 1 1 ca 2 u s ds u l 2 0 t cn 1 10 r 2 v t t 0 e s 1 t s bd 2 b d 1 d a 1 1 da 2 v s ds v l 2 0 t cn 2 11 s 1 a d 1 b d 1 d a 1 1 ca 1 t 1 t 2 t 12 1 t e s 1 tx 0 t 0 e s 1 t s bd 1 t b d 1 d a 1 1 ba 2 t ds 13 2 t da 1 1 cd 1 1 t b a 2 t 14 the interest of eqs 8 9 is to show the pure linear convergence of the di and the pos sibility of accelerating the convergence to the true solution z with the aitken s technique for accelerating convergence if 1 is not an eigen value of r as follows z i r 1 z 1 r z 0 15 we present now the discrete counterpart of the di with ras splitting and its aitken s technique for accelerating convergence involving the interface solution of the ras we use a backward euler for time discretization other backward differences formula bdf schemes would give similar results with more complicated formula a d 1 x n 1 k 1 b d 1 y n 1 k 1 b n 1 d a d 2 x n 1 k b d 2 y n 1 k ca 1 x n 1 k 1 da 1 y n 1 k 1 bn 1 a ca 2 x n 1 k da 2 y n 1 k x 0 k 1 x 0 16 with a d 1 i t a d 1 b d 1 t b d 1 a d 2 t a d 2 b d 2 t b d 2 b n 1 d xn t bn 1 d with xn xn k 1 or xn xn depending on the implementation strategy used in section 4 locally it is written with x 0 k 1 i r p d i x 0 xn 1 k 1 i yn 1 k 1 i z n 1 k 1 i a i b i ci di 1 a 1 i b n 1 i d bn 1 i a b n 1 i e di d e a i d edi a e a i a e i xn 1 k i e yn 1 k i e z n 1 k i e 17 5 h shourick et al 1 16 6 by defining m 1 ras de f n 1 i 0 r 0 t i a 1 i r p i and adding the contribution of each partition w p i the ras can be seen as a richardson s process n 1 i 0 r 0 ti r p i z n 1 k 1 n 1 i 0 r 0 ti a 1 i r p i b n 1 n 1 i 0 r 0 ti a 1 i r p i a r pt i e r p i ez n 1 k 18 zn 1 k 1 m 1 rasb n 1 m 1 rasa z n 1 k zn 1 k zn 1 k m 1 ras b n 1 a zn 1 k 19 the richardson s process 19 is deduced from 18 see 31 theorem 3 7 by using the prop erty rpi a r p i a r pt i r p i r pt i e r p i e the restriction of 19 to the interface w p 0 e w p n 1 e of size n n 1 i 0 ni e by setting r r p 0 e r p n 1 e t rn n and using the property rpti e r p i er t r r pt i e r p i e can be written as r z n 1 k 1 z n 1 k 1 r i m 1 rasa rt p r z n 1 k z n 1 k r m 1 rasb n 1 cn 1 20 the pure linear convergence of the ras at the interface given by zn 1 k zn 1 p zn 1 k 1 zn 1 the error operator p does not depend on the iteration k allows to apply the aitken s technique for accelerating convergence to obtain the true solution zn 1 on the interface zn 1 i p 1 zn 1 k pzn 1 k 1 and thus after another local resolution the true so lution zn 1 let us note that one can accelerate the convergence toward the solution for an iterative convergent or divergent method the only need is that 1 is not one of the eigen values of p considering ek zn 1 k zn 1 k 1 k 1 the operator p rn n can be computed algebraically after n 1 iterations as p ek 1 e 2 ek e 1 1 let us notice the sparse structure of the operator p in the two partitions case as we will have in the numerical examples defining ei the restriction of the error e to the partition w p i e leads to write the di with ras splitting as e 0 e 1 k 1 0 p 0 p 1 0 e 0 e 1 k 21 using the properties of n 1 i 0 r 0 i and r p i e pi is given by p 0 r p 0 ea 1 0 r p 0 a r pt 1 e 22 p 1 r p 1 ea 1 1 r p 1 a r pt 0 e 23 6 h shourick et al 1 16 7 4 strategies for dynamic iteration 4 1 sequential time steps strategy in the sequential time step strategy we apply the aitken s technique for accelerating conver gence after n 1 di iterations for the first regular time step in order to numerically build the p operator then if we use the same time step size for the following time steps we can perform the aitken s convergence acceleration technique after one di iteration 4 2 pipelined time steps strategy in the pipelined time step strategy we perform several time steps per di iteration then after n 1 we can compute the p operator associated with a time step and we can build the p operator error associated with these several time steps given in 24 z 1 k 1 z 2 k 1 zm 1 k 1 zm k 1 z k 1 p i p i p i p p z 1 k z 2 k zm 1 k zm k z k z 0 c 1 c 2 cm 1 cm c 24 this pipelined time steps strategy has also a pure linear convergence divergence and can also be accelerated by the aitken s technique for accelerating convergence 5 numerical results for di with the ras splitting firstly we test our method on the rlc examples of 25 that they use to illustrate their convergence criteria for the wr gauss seidel the first example converges and the second an index 2 dae diverges we will see that the convergence or divergence of the method depends on the time step chosen for the di with the ras splitting finally we apply the aitken s technique for accelerating convergence on the convergent and divergent cases it shows the possibility of the method to obtain the true solution even in the divergent cases 5 1 first example of 25 the first rlc circuit example satisfies the criteria of 25 to ensure the convergence for the wr gauss seidel method the circuit splitting is as follows 7 h shourick et al 1 16 8 n 1 nr n 3 n 2 l 1 l 2 c ev ei g e 1 e 2 l 1 di 1 dt 0 er 0 e 1 e 3 ev t zsi 5 0 g e 1 e 2 i 2 0 e 2 er l 2 di 3 dt 0 c de 3 dt de 2 dt i 4 0 ei t i 6 0 i 1 i 2 i 3 i 4 0 i 1 i 2 i 5 0 i 5 i 4 i 6 0 to adapt this circuit to the formalism of eq 1 it is necessary to define new variables which are the combination of variables whose derivatives are combined in the same equation and to add the corresponding algebraic combination to the equations of the system here c dv 1 dt i 4 0 and v 1 e 3 e 2 where v 1 is part of x and e 3 e 2 are part of y the interface values are e 1 and e 2 for the first partition and i 1 for the second partition the error operator p and it s eigen values are calculated following eq 22 and 23 p 0 tl 1 t l 1 l 2 t l 2 c t 2 l 2 g t 1 c t g 0 0 0 0 0 1 0 2 i t l 1 c t g 3 i t l 1 c t g the method diverges if p 1 l 1 c g and l 2 are fixed so the convergence of the method depends on t for t 0 de f l 1 g l 1 g 2 4 l 1 c 2 we have p 1 the method converges with choosing a t 0 t 0 stagnates if t t 0 and diverges otherwise figure 1 left gives the convergence behavior of log 10 z 2 k zre f with respect to the ras iterations for one time step for the three time step value cases while figure 1 right gives the e 3 behavior with respect to the time with the monolithic reference and the di with the ras splitting with the aitken s acceleration 5 2 second example of 25 for this second example the criteria of 25 cannot ensure the convergence for the wr gauss seidel method the circuit splitting is as follows the interface values are e 1 and er for the first partition and i 1 for the second partition the error operator p and it s eigen values are calculated following eq 22 and 23 p 0 tl 1 t l 1 l 2 c t 2 l 2 g t 1 c t g 0 0 0 0 0 1 0 2 i l 2 l 1 t l 1 c t g 3 i l 2 l 1 t l 1 c t g 8 h shourick et al 1 16 9 0 0 02 0 04 0 06 0 08 0 1 6 4 2 0 2 4 6 e 3 ras reference solution figure 1 first example with l 1 0 4 l 2 0 5 c 1 10 6 g 2 10 3 left di with the ras splitting convergence behavior log 10 z 2 k zre f with respect to the ras iterations and right comparison between the di with the ras splitting with the aitken s technique for accelerating convergence and the dae monolithic reference for the e 3 variable with t 1 2 10 3 n 1 nr n 3 n 2 l 1 l 2 c ev ei g er 0 e 1 e 3 ev t zsi 5 0 e 1 er l 1 di 1 dt 0 g e 1 e 2 i 2 0 e 2 er l 2 di 3 dt 0 c de 3 dt de 2 dt i 4 0 ei t i 6 0 i 1 i 6 i 3 0 i 3 i 2 i 4 0 i 5 i 4 i 6 0 the same way as for the first example the method diverges if p 1 so if l 2 l 1 the meth ode diverges l 1 c g and l 2 are fixed the way as l 2 l 1 so the convergence of the method depends on t for t 0 de f l 1 l 2 g l 2 l 1 2 g 2 4 l 1 l 2 c 2 we have p 1 the method converges with choosing a t 0 t 0 stagnates if t t 0 and diverges otherwise figure 2 left gives the convergence behavior of log 10 z 2 k zre f with respect to the ras iterations for one time step for the three time step value cases and the aitken s technique for accelerating convergence after four ras iterates plus one more local solving with l 2 l 1 it shows that in both cases convergent or divergent the aitken s acceleration reaches the monolithic reference solution figure 2 right gives the convergence behavior of log 10 z 2 k zre f with respect to the ras iterations and the aitken s technique for accelerating convergence after four ras iterates plus one more local solving with l 2 l 1 in the two time step cases the ras diverges but the aitken s acceleration succeeds to reach the monolithic reference solution figure 3 gives the e 3 behavior with respect to the time with the monolithic reference solu 9 h shourick et al 1 16 10 4 1 e 04 4 5 e 04 4 5 e 04 accelerated 4 1 e 04 accelerated 4 0 e 04 4 5 e 04 4 5 e 04 accelerated 4 0 e 04 accelerated figure 2 second example di with the ras splitting convergence behavior log 10 z 2 k zre f with respect to the ras iterations and the aitken s technique for accelerating convergence after four ras iterates plus one more local solving with c 1 10 6 g 2 10 3 and right l 1 0 4 l 2 0 3 left l 1 0 5 l 2 0 7 tion and the di with the ras splitting and with the aitken s acceleration for c 1 10 6 g 2 10 3 l 1 0 5 l 2 0 7 0 0 02 0 04 0 06 0 08 0 1 6 4 2 0 2 4 6 e 3 ddm ent figure 3 second example comparison between the di with the ras splitting with the aitken s technique for accel erating convergence and the dae monolithic reference for the e 3 variable with t 4 510 4 and for c 1 10 6 g 2 10 3 l 1 0 5 l 2 0 7 5 3 di with ras splitting with heterogeneous modeling secondly we apply the method to the co simulation of an rlc circuit split into two different types of modeling electromagnetic transient emt a very precise model requiring very small time steps and a dynamic phasor ts model less precise but allowing the use of larger time steps the numerical example is the rlc circuit of figure 4 an overlap is defined and the emt equations from w 11 are changed in ts equations and solved for the 1 1 and 0 dynamic phasor modes the values to be exchanged are i 12 v 2 from the emt to the ts side and i 56 v 6 from the ts side to the emt one 10 h shourick et al 1 16 11 w 10 w 1 1 2 3 4 5 7 6 1 c 1 c 2 r 1 r 2 e cos t l 1 l 2 i 12 v 2 i 56 v 6 v 1 0 v 2 v 1 e zsi 12 0 v 3 v 2 l 1 di 23 dt 0 v 4 v 3 r 1 i 34 0 i 67 i 71 0 c 1 dv 5 dt dv 4 dt i 45 0 v 6 v 5 r 2 i 56 0 v 7 v 6 l 2 di 67 dt 0 c 2 dv 1 dt dv 7 dt i 71 0 i 12 i 23 0 i 23 i 34 0 i 34 i 45 0 i 45 i 56 0 i 56 i 67 0 figure 4 linear rlc circuit and its associated emt modeling dae system with w 00 v 2 i 12 v 3 i 34 i 45 i 56 v 6 i 71 and w 01 v 1 i 23 v 4 v 5 i 67 v 7 l 1 l 2 0 7 c 1 c 2 1 10 6 r 1 r 2 77 zs 1 10 6 2 50 e 5 the two main difficulties to carry out the co simulation reside in the difference in the repre sentations of the variables and the time step difference we choose tts m temt m n and the interface values are exchanged at each ts time step for ts modeling the variables are assumed to oscillate with a specific angular frequency 0 2 t where t is the period and its selected harmonics dynamic phasor modes taken from a subset i 1 0 1 z t k i zk t exp ik 0 t z x y 25 introducing 25 into 1 leads after simplification i e orthogonality of the functions exp ik 0 t with respect to the dot product f g 1 t t t t f z g z dz to another dae system that takes into account the differential property of the dynamic phasors the number of ts variables is then multiplied by the number of harmonics chosen and the number of equations must be multiplied accordingly let s take back the 17 equation it must be adapted to the subdomain solved with the ts or with the emt modeling first the subdomain solved with ts for the n 1 time step and the k 1 ras iteration xn 1 k 1 ts yn 1 k 1 ts z n 1 k 1 ts a ts b ts cts dts 1 a 1 ts b n 1 ts d bn 1 ts a b n 1 ts e dts d e a ts d edts a e a ts a e ts fmod xn 1 k emt e y n 1 k emt e z n 1 k emt e fmod represents a readjusted fft and a choice of mods corresponding to those retained for the ts simulation zn 1 k emt e is a history of values computed by the emt subsystem during the previous 11 h shourick et al 1 16 12 0 0 01 0 02 0 03 0 04 0 05 0 06 time t secondes 6 4 2 0 2 4 6 i 3 4 a m p e re 10 4 i 34 heterogeneous emt ts ras splitting monolithic emt ras ts ras emt 0 0 01 0 02 0 03 0 04 0 05 0 06 time t secondes 6 4 2 0 2 4 6 8 v 3 vo lt v 3 heterogeneous emt ts ras splitting monolithic emt ras ts ras emt 0 018 0 019 0 02 0 021 0 022 0 023 0 024 time t secondes 3 3 5 4 4 5 5 5 5 6 6 5 v 3 vo lt v 3 heterogeneous emt ts ras splitting monolithic emt ras ts ras emt figure 5 comparison of the behavior with respect to time of the variables i 34 top left and v 3 bottom left the figures on the right are their zoom on the disturbances computed using the heterogeneous emt ts ras splitting with the aitken s technique for accelerating convergence tts 2 10 3 and temt 2 10 5 the reference is the monolithic emt an amplitude perturbation on the voltage source starting at t 0 02 s and ending at t 0 021 s therefor lasting less than one tts is applied parameters are l 1 0 07 c 1 1 e 5 r 1 7 l 2 0 07 c 2 1 e 7 r 2 7 zs 0 000001 ras iteration completed by some of the last values from the previous time steps if t tts this history is the size of a period and ends at the instant corresponding to the n 1 time step zn 1 k emt z n 1 j k emt z n k emt z n 1 k emt secondly we perform the simulation for w 10 solved with emt for each intermediate time step the equation 17 is adapted to the subdomain solved it gives for an intermediate time step m 1 xm 1 k 1 emt ym 1 k 1 emt z m 1 k 1 emt a emt b emt cemt demt 1 a 1 emt b m 1 emt d bm 1 emt a b m 1 emt e demt d e a emt d edemt a e a emt a e emt r m 1 mod xn 1 k ts e yn 1 k ts e z n 1 k ts e zn 1 k ts e are the values computed by the ts side at the n 1 time step and r m 1 mod an operator which recombine the ts modes and estimate their values for the m 1 time step 12 h shourick et al 1 16 13 fmod and rmod are linear operators so the di with the ras splitting convergence divergence always remains purely linear and so we can apply the aitken s technique for accelerating con vergence since the history zn 1 k emt can be very large the resulting error matrix would be very cumbersome to invert therefore the acceleration is only performed on the interface values com puted by the ts side then the converged ts interface values are used to resolve the emt side locally and after the ts side locally figure 5 compares the emt monolithic reference values for the variables v 3 and i 34 with the emt ts heterogeneous ras splitting where a perturbation on the source voltage that starts at t 0 02 s and ends at t 0 021 s is applied the ras ddm succeeds in capturing part of the perturbation on the v 3 it shows a good agreement between the monolithic and the emt ts heterogeneous ras for the variable v 3 the variable i 34 in the emt ddm part captures certain oscillations due to the perturbation these results show that emt ts heterogeneous ras splitting can capture disturbances that last less than one ts time step and therefore would not have been captured by a monolithic ts model figure 6 left heterogeneous emt ts ras convergence error for the ts boundary for the time step t 0 02 and its aitken s acceleration applied on the ts partition interface with tts 2 10 3 and temt 2 10 5 and with parameters l 1 0 07 c 1 1 e 6 r 1 7 l 2 0 07 c 2 1 e 6 r 2 7 zs 0 000001 figure 6 shows the purely linear divergence of the di with the ras splitting and its ac celeration for the ts partition interface during the time step t 0 02 for tts 2 10 3 and temt 2 10 5 with parameters l 1 0 07 c 1 1 e 6 r 1 7 l 2 0 07 c 2 1 e 6 r 2 7 zs 0 000001 chosen to have di with divergence 13 h shourick et al 1 16 14 5 4 non linear case we now consider the problem 1 but with at least one non linear element we rewrite it in its discrete form with linearizing it at each time step xn 1 k 1 i yn 1 k 1 i z n 1 k 1 i a n 1 i b n 1 i cn 1 i d n 1 i 1 a n 1 i 1 b n 1 i d bn 1 i a b n 1 i e n 1 di d e n 1 a i d en 1 di a e n 1 a i a e n 1 i xn 1 k ie yn 1 k ie zn 1 ki e following the same steps as in section 3 the error between two iterations can be rewritten as e 1 e 2 n 1 k 1 0 p 1 p 2 0 n 1 e 1 e 2 n k the pn 1 error operator depends on the time step and so needs to be computed again for each time step however the error operator does not depend on the ras iteration k and so for each time step the convergence divergence is purely linear and can be accelerated toward the true solution using the aitken s technique for accelerating convergence let us take again the numerical example 2 and replace g by a function of i 2 the current which crosses the associated component g 1 g 0 i 2 although this is non relevant from a physical point of view we chose to take very large in order to increase the non linearity n 1 25 250 pn 1 0816 i 1 0807 i 1 0814 i table 1 variations of the maximum eigenvalue of the error operator pn according to the time step n 1 25 250 for the second numerical example with non linear g with l 1 0 6 l 2 0 7 c 1 10 6 g 0 10 2000 t 2 10 4 table 1 gives the maximum eigenvalue of p 1 p 25 and p 250 it shows that the di with the ras splitting diverges for these time steps but with small variations in the maximum eigenvalue from one time step to another figure 7 shows identical behavior of e 2 e 3 i 3 with respect to time between the monolithic refer ence dashed red curve and the di with the ras splitting with the aitken s acceleration black curve 6 conclusion we formulated the dynamic iteration method with the restricted additive schwarz splitting as an iterative process involving the interface unknowns coming from the partitioning of the dif ferential algebraic system of equations its pure linear convergence or divergence in the context of linear dae system allows us to accelerate the convergence toward the true solution with the aitken s technique for accelerating convergence we numerically built the error operator asso ciated with the interface from the ras iterations only once if we use fixed time step we also showed that the method can be used with heterogenous partition in the modeling such as emt and ts modeling some extension of the method to solve nonlinear problems can also be applied by considering the linearization of the problem for each time step 14 h shourick et al 1 16 15 figure 7 second numerical example with non linear g with l 1 0 6 l 2 0 7 c 1 10 6 g 0 10 2000 t 2 10 4 comparison between the di with the ras splitting with the aitken s technique for accelerating con vergence and the dae monolithic reference for e 2 e 3 i 3 and right variations of the maximum eigen value of the error operator p according to the time step references 1 e lelarasmee a ruehli a vincentelli the waveform relaxation method for time domain analysis of large scale integrated circuits ieee transactions on computer aided design of integrated circuits and systems 1 1982 131 145 doi 10 1109 tcad 1982 1270004 2 a lumsdaine j white accelerating wave form relaxation methods with application to parallel semiconductor device simulation numer funct anal optim 16 3 4 1995 395 414 doi 10 1080 01630569508816625 3 u miekkala o nevanlinna convergence of dynamic iteration methods for initial value problems siam journal on scientific and statistical computing 8 4 1987 459 482 doi 10 1137 0908046 4 u miekkala dynamic iteration methods applied to linear dae systems j comput appl math 25 2 1989 133 151 doi 10 1016 0377 0427 89 90044 7 5 m arnold constraint partitioning in dynamic iteration methods z angew math mech 81 3 2001 s 735 s 738 doi 10 1002 zamm 200108115143 6 a bartel m brunk m guenther s schoeps dynamic iteration for coupled problems of electrical circuits and distributed devices siam j sci comput 35 2 2013 b 315 b 335 doi 10 1137 120867111 7 a bartel m guenther pdaes in refined electrical network modeling siam review 60 1 2018 56 91 doi 10 1137 17 m 1113643 8 m guenther a bartel b jacob t reis dynamic iteration schemes and port hamiltonian formulation in coupled differential algebraic equation circuit simulation int j circuit theory appl 49 2 2021 430 452 doi 10 1002 cta 2870 9 m reichelt j white j allen optimal convolution sor acceleration of wave form relaxation with application to parallelsimulation of semiconductor devices siam j sci comput 16 5 1995 1137 1158 doi 10 1137 0916066 10 s schoeps h de gersem a bartel higher order cosimulation of field circuit coupled problems ieee trans actions in magnetics 48 2 2012 535 538 doi 10 1109 tmag 2011 2174039 11 y jiang o wing a note on the spectra and pseudospectra of waveform relaxation operators for linear differential algebraic equations siam journal on numerical analysis 38 1 2000 186 201 doi 10 1137 s 0036142997327063 15 https doi org 10 1109 tcad 1982 1270004 https doi org 10 1080 01630569508816625 https doi org 10 1137 0908046 https doi org 10 1016 0377 0427 89 90044 7 https doi org 10 1002 zamm 200108115143 https doi org 10 1137 120867111 https doi org 10 1137 17 m 1113643 https doi org 10 1002 cta 2870 https doi org 10 1002 cta 2870 https doi org 10 1137 0916066 https doi org 10 1137 0916066 https doi org 10 1109 tmag 2011 2174039 https doi org 10 1137 s 0036142997327063 https doi org 10 1137 s 0036142997327063 h shourick et al 1 16 16 12 y jiang a general approach to waveform relaxation solutions of nonlinear differential algebraic equations the continuous time and discrete time cases ieee transaction on circuits and systems i 51 9 2004 1770 1780 doi 10 1109 tcsi 2004 834503 13 a lumsdaine d wu spectra and pseudospectra of waveform relaxation operators siam j sci comput 18 1 1997 286 304 doi 10 1137 s 106482759528778 x 14 m arnold m gunther preconditioned dynamic iteration for coupled differential algebraic systems bit 41 1 2001 1 25 doi 10 1023 a 1021909032551 15 k hout on the convergence of wave form relaxation methods for stiff nonlinear ordinary differential equations applied numerical mathematics 18 1 3 1995 175 190 doi 10 1016 0168 9274 95 00052 v 16 j janssen s vandewalle on sor waveform relaxation methods siam journal on numerical analysis 34 6 1997 2456 2481 doi 10 1137 s 0036142995294292 17 b leimkuhler timestep acceleration of waveform relaxation siam journal on numerical analysis 35 1 1998 31 50 doi 10 1137 s 003614299528002 x 18 a lumsdaine d wu krylov subspace acceleration of waveform relaxation siam journal on numerical analysis 41 1 2003 90 111 doi 10 1137 s 0036142996313142 19 m a botchev i v oseledets e e tyrtyshnikov iterative across time solution of linear differential equations krylov subspace versus waveform relaxation comput math appl 67 12 2014 2088 2098 doi 10 1016 j camwa 2014 03 002 20 t ladics error analysis of waveform relaxation method for semi linear partial differential equations j comput appl math 285 2015 15 31 doi 10 1016 j cam 2015 02 003 21 a bartel m brunk s schoeps on the convergence rate of dynamic iteration for coupled problems with multiple subsystems j comput appl math 262 2014 14 24 doi 10 1016 j cam 2013 07 031 22 g ali a bartel m brunk s schoeps a convergent iteration scheme for semiconductor circuit coupled problems in michielsen b and poirier jr ed scientific computing in electrical engineering scee 2010 vol 16 of mathematics in industry cham 2012 pp 233 242 doi 10 1007 978 3 642 22453 9 25 23 k gausling a bartel density estimation techniques in cosimulation using spectral and kernel methods in langer u and amrhein w and zulehner w ed scientific computing in engineering scee 2016 vol 28 of mathematics in industry cham 2018 pp 81 89 doi 10 1007 978 3 319 75538 0 8 24 k gausling a bartel coupling interfaces and their impact in field circuit co simulation ieee trans magn 52 3 mar 2016 doi 10 1109 tmag 2015 2471181 25 j pade c tischendorf waveform relaxation a convergence criterion for differential algebraic equations numer algorithmsnumer algorithms 81 4 si 2019 1327 1342 doi 10 1007 s 11075 018 0645 5 26 m garbey d tromeur dervout on some aitken like acceleration of the schwarz method internat j numer methods fluids 40 12 2002 1493 1513 doi 10 1002 fld 407 27 d tromeur dervout meshfree adaptative aitken schwarz domain decomposition with application to darcy flow in topping bhv and ivanyi p ed parallel distributed and grid computing for engineering vol 21 of cset series saxe coburg publications 2009 pp 217 250 doi 10 4203 csets 21 11 28 d tromeur dervout approximating the trace of iterative solutions at the interfaces with nonuniform fourier transform and singular value decomposition for cost effectively accelerating the convergence of schwarz domain decomposition esaim proc 42 2013 34 60 doi 10 1051 proc 201342004 29 h shourick d tromeur dervout l che dot aitken schwarz heterogeneous domain decomposition for emt ts simulation in s brenner e chung a klawonn f kwok j xu j zou eds domain decomposition methods in science and engineering xxvi lecture notes in computational sciences and engineering springer 2022 to appear 30 x c cai m sarkis a restricted additive schwarz preconditioner for general sparse linear systems siam j sci comput 21 2 1999 792 797 doi 10 1137 s 106482759732678 x 31 m j gander schwarz methods over the course of time electronic transactions on numerical analysis 2008 228 255 url http eudml org doc 130616 16 https doi org 10 1109 tcsi 2004 834503 https doi org 10 1137 s 106482759528778 x https doi org 10 1023 a 1021909032551 https doi org 10 1016 0168 9274 95 00052 v https doi org 10 1137 s 0036142995294292 https doi org 10 1137 s 003614299528002 x https doi org 10 1137 s 0036142996313142 https doi org 10 1016 j camwa 2014 03 002 https doi org 10 1016 j camwa 2014 03 002 https doi org 10 1016 j cam 2015 02 003 https doi org 10 1016 j cam 2013 07 031 https doi org 10 1007 978 3 642 22453 9 25 https doi org 10 1007 978 3 319 75538 0 8 https doi org 10 1109 tmag 2015 2471181 https doi org 10 1007 s 11075 018 0645 5 https doi org 10 1002 fld 407 https doi org 10 4203 csets 21 11 https doi org 10 1051 proc 201342004 https doi org 10 1137 s 106482759732678 x http eudml org doc 130616 http eudml org doc 130616 1 introduction 2 dynamic iteration for linear dae 3 dynamic iteration error operator and acceleration 4 strategies for dynamic iteration 4 1 sequential time steps strategy 4 2 pipelined time steps strategy 5 numerical results for di with the ras splitting 5 1 first example of padetischendorfwrcvgcriterionnumalgo 2019 5 2 second example of padetischendorfwrcvgcriterionnumalgo 2019 5 3 di with ras splitting with heterogeneous modeling 5 4 non linear case 6 conclusion