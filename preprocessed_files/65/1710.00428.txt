effective methods for solving band sles after parabolic nonlinear pdes milena veneva 1 and alexander ayriyan 1 1 joint institute for nuclear research laboratory of information technologies joliot curie 6 141980 dubna moscow region russia abstract a class of models of heat transfer processes in a multilayer domain is considered the governing equation is a nonlinear heat transfer equation with different temperature dependent densities and thermal coefficients in each layer homogeneous neumann boundary conditions and ideal con tact ones are applied a finite difference scheme on a special uneven mesh with a second order approximation in the case of a piecewise constant spatial step is built this discretization leads to a pentadiagonal system of linear equations sles with a matrix which is neither diagonally dominant nor positive definite two different methods for solving such a sle are developed diagonal dominantization and symbolic algorithms 1 introduction and mathematical model in this note we focus on solving pentadiagonal pd and tridiagonal td systems of linear alge braic equations sles which are obtained after the discretization of parabolic nonlinear partial differential equations pdes using finite difference methods fdm of second order approxima tion such a problem was solved in 1 there a finite difference scheme of first order approximation was built that leads to a td sle with a diagonally dominant coefficient matrix the system was solved using the thomas method 2 the following nonlinear model of a cylindrical multilayer structure is considered m u cmv u u t 1 r r r m u u r n 1 z m u u z m u 1 u r 0 r rmin rmax 2 m u u r r rm i 0 m 1 u u r r rm i 0 and u r rm i 0 u r rm i 0 3 where r z t 0 m index of the subdomain equation 1 represents the conservation of heat inside a multilayer structure it is an energy equation with conduction heat transfer where the densities the specific heat capacities and the thermal conductivities depend on the temperature for instance in the two dimensional case eq 1 could be defined in a domain similar to the one shown in fig 1 homogeneous neumann boundary conditions 2 are applied on the outer boundaries in the radial direction the ideal contact conditions 3 model the heat flux on the inner boundaries in the radial direction where rmi denotes the point of discontinuity the numerical algorithms for solving the multidimensional governing equation ge using fdm e g adi algorithms 3 ask for a repeated sle solution milena p veneva gmail com ayriyan jinr ru 1 ar x iv 1 71 0 00 42 8 v 2 m at h n a 1 0 f eb 2 01 8 figure 1 example of a rectangular domain in cylindrical coordinates a longitudinal section of a multilayer cylinder where the thermal coefficients are different in all the subdomains and they have a discontinuity of the first kind at the borders in between the subdomains 2 discretization of the problem focusing on the radial term of the ge with the assumption that the other terms will be moved to the right hand side rhs we consider the following special mesh with grid points on the inner boundaries r t r tk k ht k n 0 r 0 rmin ri 1 ri hi 1 i 0 n 2 a finite difference scheme with a second order approximation has the following form three point stencils are taken for the ge and the outer boundary conditions bc and five point stencil for the inner bc i c vi u i ui 1 ri 1 i ri 1 2 i 1 2 u i 1 u i hi 1 ri 1 2 i 1 2 u i u i 1 hi i 4 h 2 2 h 1 h 2 u 0 h 1 h 2 2 u 1 h 21 u 2 h 1 h 2 h 1 h 2 0 5 mi hi 1 2 hi hi 1 u i hi hi 1 2 u i 1 h 2 i u i 2 hi hi 1 hi hi 1 6 m 1 i hi 2 2 hi 1 hi 2 u i hi 1 hi 2 2 u i 1 h 2 i 1 u i 2 hi 1 hi 2 hi 1 hi 2 hn 2 2 hn 1 hn 2 u n 1 hn 1 hn 2 2 u n 2 h 2 n 1 u n 3 hn 1 hn 2 hn 1 hn 2 0 7 where i 1 2 u i u i 1 2 i hi 1 hi 2 ri 1 2 ri ri 1 2 the matrix form of the considered system is a u u where a is a pd sparse matrix which does not have any special properties e g diagonally dominance or positive definiteness in order to preserve the band structure of the matrix we cannot use the gaussian elimination with pivoting within this we could obtain division by zero at some point of the procedure which is going to make our algorithm unstable for that reason we alter the initial pd matrix by adding the minimum values to the diagonal elements so as to transform the matrix into a weakly diagonally dominant one add u u p u where add a p p diag 2 h 21 i j pi j 2 h 2 n 1 where pi i 2 mi hi hi 1 hi hi 1 2 m 1 i hi 1 hi 2 hi 1 hi 2 the gaussian elimination with pivoting the procedure we use to transform the pd matrix into a td one does not preserve the diagonal dominance of the matrix the use of the gaussian elimination to the initial matrix a not add yields a transformed matrix a then the diagonal dominantization method is used in order to transform the obtained td matrix a into a diagonally 2 dominant one to that purpose the nondiagonal elements are added to the diagonal ones a dd u u p u where a dd a p p diag a 0 1 i j p i j a n 2 n 1 where p i i 1 1 a i i 3 numerical and symbolic algorithms two different approaches for solving the sle are considered numerical and symbolic the com plexity of all the suggested numerical algorithms is o n since it is unknown what stands behind the symbolic library evaluating the complexity of the symbolic algorithms is a very complicated task numerical algorithms two different numerical algorithms are applied to the system with a pd matrix both of them are based on lu decomposition the first one 4 is intended for a dense pd matrix in the case of the considered problem the matrix is sparse for that reason a modified algorithm is built the main idea is that after the mesh was defined the indexes of the discontinuity points are known since these indexes coincide with those of the matrix rows which are not sparse we can reference them to the algorithm and conduct the full calculation only for them for the rest of the rows the algorithm is reduced to a problem similar to solving a system with td matrix this way the complexity of the algorithm is decreased but at the cost of additional n 2 check ups for the non sparse rows in the case of the td matrix the system is solved using the thomas method symbolic algorithms the symbolic algorithm in the case of a pd matrix is also based on lu decomposition 4 for the td matrix a symbolic version of thomas method is created as it is known thomas method is not suitable for nondiagonally dominant matrices 2 in order to cope with this problem in the case of a zero quotient of two subsequent leading principal minors a symbolic zero is assigned instead and the calculations are continued at the end of the algorithm this symbolic zero is substituted with zero the same approach is suggested in 5 4 implementation and results all the numerical algorithms are implemented using c the matrix needs to be nonsingular and diagonally dominant so as the methods to be stable two symbolic algorithms are implemented using the ginac library version 1 7 2 6 of c the symbolic algorithms require the matrix to be nonsingular only in table 1 one can find the wall clock time results from the conducted experiments since the largest supported precision in the ginac library is double during all the experiments double data type is used the notation is as follows npdm stands for numerical pd method mnpdm modified numerical pd method spdm symbolic pd method ntdm numerical td method stdm symbolic td method the achieved accuracy is summarized using infinity norm on the penultimate row of the table one can find the complexity of all the considered methods on the last row the characteristics of the computer which is used are described the number of considered discontinuity points is k 11 5 discussion and conclusions a nonlinear heat transfer equation in a multilayer domain was considered the suggested dis cretization scheme always has a first order approximation in the case of piecewise constant ther mal conductivities or when i 1 2 i 1 2 o hi the order of approximation is going to be second focusing on the radial term a sle with a pd matrix was obtained then applying gaussian elimination a td matrix was derived for both these matrices a diagonal dominanti zation procedure was suggested this approach ensures the stability of the suggested methods a modified version of the numerical method for solving a sle with a pd matrix was built since the complexity of this method is lower than the complexity of the general algorithm usually k n better computational time was achieved the fastest numerical algorithm was found to come from the thomas method all the experiments gave an accuracy of an order of magnitude of 10 16 as 3 table 1 results from solving sle wall clock time s n npdm mnpdm spdm ntdm stdm 103 0 000036 0 000034 0 088669 0 000021 0 043690 104 0 000403 0 000373 8 467241 0 000245 2 971745 105 0 004709 0 003916 3547 020851 0 002416 799 533587 108 3 159357 2 682258 1 652945 max n y y 2 22 10 16 2 22 10 16 0 2 22 10 16 0 complexity 19 n 29 13 n 7 k 14 9 n 2 os fedora 25 processor intel core i 7 6700 3 40 ghz compiler gcc 6 3 1 o 0 a next step symbolic algorithms were used they do not require the matrices to be of a special form and are exact however they are not comparable with the numerical algorithms with respect to the required time in the case of a numerical solving of the heat equation when one needs to solve the sle many times on the other hand these symbolic methods are not as restrictive as the numerical ones when it comes to the matrix properties another upside of the symbolic algorithms is that in the case of a piecewise linear equation they do not add nonlinearity to the rhs of the system and hence there is no need of iterations for the time step to be executed in future the approach suggested in this note will be investigated in detail acknowledgements the authors want to express their gratitude to the summer student program at jinr and j n bu a jr jinr a ayriyan thanks the jinr grant no 17 602 01 references 1 a ayriyan j bu a jr e donets h grigorian and j pribi applied thermal engineering 94 151 158 2016 2 nicholas j higham accuracy and stability of numerical algorithms siam 2002 680 3 a a samarskii the theory of difference schemes taylor francis inc new york 2001 788 4 s s askar and a a karawia mathematical problems in engineering 2015 9 2015 5 m el mikkawy applied mathematics 3 342 345 2012 6 c bauer a frink and r kreckel j of symb comp 33 1 12 2002 4 1 introduction and mathematical model 2 discretization of the problem 3 numerical and symbolic algorithms 4 implementation and results 5 discussion and conclusions