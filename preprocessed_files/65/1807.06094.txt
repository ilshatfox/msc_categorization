stability and convergence of the string method for computing minimum energy paths brian van koten and mitchell luskin abstract we analyze the convergence of the string method of e ren and vanden eijnden 6 to a minimum energy path under some assumptions relating to the critical points on the minimum energy path we show that the string method initialized in a neighborhood of the minimum energy path converges to an arbitrarily small neighborhood of the minimum energy path as the number of images is increased 1 introduction many systems in chemistry materials science and physics pass through sequences of metastable states undergoing transitions between states very rarely often the best way to understand these systems is to catalog the states together with the rates and most probable mechanisms of the transitions however when transitions are rare events the cost of calculating rates and mechanisms by di rect simulation may be prohibitive a less costly alternative is to compute minimum energy paths meps connecting metastable states under some conditions one may interpret a mep as a representative transition mechanism 2 section 1 3 and given a mep one may estimate transition rates using approximations such as harmonic transition state theory 1 8 21 several algorithms exist for computing meps in cluding the nudged elastic band method 10 and the string method 4 6 see 9 17 for surveys we analyze the simplified and improved string method 6 giving the first proof of convergence of a practical algorithm for computing meps a mep is a path connecting two local minima of the potential energy v whose tangent is everywhere parallel to v except at critical points where v 0 cf equation 2 1 in the simplest case a mep follows a steepest ascent trajectory from one local minimum up to a saddle point and then a steepest descent trajectory down to the other local minimum see figure 1 each local minimum corresponds to a metastable state and a mep yields information about transitions between the states which it connects in particular harmonic transition state theory provides approximations expressing transition rates in terms of v and d 2 v evaluated at saddle points and local minima 1 8 21 the relevant saddle for a given transition between metastable states is the highest energy point on a mep connecting those states meps also yield insight into transition mechanisms suppose that the system evolves under the overdamped langevin dynamics dxt v xt dt 2 1 dbt with inverse temperature this is perhaps the simplest model of a metastable system where thermal fluctuations drive transitions if v has exactly two minima and one saddle then the unique mep minimizes the wentzell friedlin action so trajectories passing between neighborhoods of the minima typically lie close to the mep when is large 2 section 1 3 that is the mep is representative of typical transitions between the metastable states bvk was supported by the nsf rtg computational and applied mathematics in statistical science award number 1547396 this material is based upon work partly supported by the u s department of energy office of science grant de sc 0012733 part of this research was also performed while the author was a simons participant at the nsf supported institute for pure and applied mathematics ipam and acknowledges support from the simons foundation 1 ar x iv 1 80 7 06 09 4 v 2 m at h n a 1 0 a ug 2 01 8 many algorithms have been proposed to compute meps 4 6 7 10 20 several of these including the string method 4 6 and the nudged elastic band method 10 discretize the gradient descent dynamics on curves gddc under gddc each point of a curve evolves independently by gradient descent for v cf equation 2 3 any mep is a fixed point of gddc this is because meps consist of heteroclinic paths and stationary points of the gradient descent and these sets are always invariant moreover under some conditions one can show that trajectories of gddc converge to meps see 2 corollary 4 and theorem 3 12 below these observations suggest that to calculate meps one might try to simulate gddc until convergence however the results of 2 do not imply convergence of any discretization of gddc we present the first convergence analysis of a practical discretized method for calculating meps our analysis assumes that the mep passes alternately through local minima and saddles of index one as depicted in figure 1 and that no degenerate critical points or critical points of higher index lie on the mep 1 under these condi tions we show in theorem 4 6 that the mep can be calculated to arbitrary precision using the simplified and improved string method 6 we allow only minima and in dex one saddle points along the mep since when saddles of index two or higher are present gddc need not converge to a path 2 in that case we do not expect dis cretizations of gddc to converge either moreover in most applications only saddles of index one are relevant we discuss these issues at length in remark 3 2 our convergence analysis relies on new stability results for gddc in particular we show that any mep alternating between minima and saddles of index one is uniformly and asymptotically stable under gddc cf theorem 3 12 previous work was concerned primarily with limit sets of trajectories of gddc or with global convergence to a mep 2 cf remark 3 15 as far as we are aware theorem 3 12 is the first result on local stability of individual meps we do not address variations of the string method combining gradient descent dynamics with sampling such as the string method in collective variables 14 the on the fly string method 15 or the finite temperature string method 5 neither do we address the nudged elastic band method 10 or methods combining gradient descent dynamics with minimum mode following such as the climbing image nudged elastic band method 11 however we hope that our results will facilitate the analysis of these and similar methods in future work 2 minimum energy paths and the string method the string method is a numerical algorithm for computing minimum energy paths let rd be the state space of the system let v rd r be a potential energy let m m rd be local minima of v a minimum energy path mep connecting m to m is a path a b rd so that a m b m and 2 1 v v 0 for all a b except those so that is a critical point of v we allow kinks in a mep at critical points so need not exist when is a critical point and in that case the left hand side of 2 1 is undefined at equation 2 1 implies that either v 0 or v therefore meps are composed of 1 a saddle point s of index m is a critical point of the potential energy v where the hessian d 2 v s is invertible and has exactly m negative eigenvalues a degenerate critical point is one where the hessian is singular 2 m 1 m 2 m 3 mk s 1 s 2 sk 1 local minimum saddle heteroclinic h 2 heteroclinic h 2 fig 1 a minimum energy path mep consists of a sequence of heteroclinic trajectories of the gradient flow connecting critical points we assume in our analysis that the mep passes alternately through local minima m 1 m 2 mk and saddle points s 1 s 2 sk 1 as pictured however in general meps may contain maxima higher index saddles or degenerate critical points moreover saddles of index one may be connected directly by heteroclinics without a minimum in between as in figure 2 we denote the heteroclinics connecting mi with si 1 and si by h i and h i respectively the arrow on each heteroclinic points in the gradient descent direction heteroclinics of the gradient descent dynamics 2 2 x v x connecting m to m through a sequence of intermediate critical points of v see figure 1 in our analysis we generally prefer to treat meps as curves instead of paths even though they are called paths a curve is a set of the form a b parametrized by some continuous path a b rd each curve admits parametrization by many different paths several methods for finding meps including the string method 4 6 and nudged elastic band method 10 are based on discretizations of the gradient descent dynamics on curves gddc under gddc every point of a curve evolves independently by gradient descent to be precise let st rd rd be the flow for 2 2 that is for t 0 and x rd define st x z t for z the solution of the initial value problem z v z and z 0 x let 0 be a curve under gddc 0 evolves by 2 3 t st 0 for t 0 any mep is a fixed point of gddc this is because meps consist of stationary points and heteroclinics and these sets are always invariant under the flow how ever no parametrization of a mep is invariant under the dynamics t st corresponding to gddc as t increases points on the heteroclinics fall towards the minima so t spends more and more time near minima undergoing increasingly abrupt transitions through the saddle points moreover under some conditions one can show that trajectories of gddc converge to meps cf theorem 3 12 and 2 thus to calculate meps one might try to simulate the gddc until convergence both the string method and nudged elastic band method adopt this strategy we now introduce one particular variant of the string method called the simplified and improved string method 6 our first task is to define a finite dimensional family of paths connecting the local minima m and m for n n we let sn 1 x rd n 1 x 0 m xn m 3 we call components xi of x sn 1 images and we call x sn 1 a string of n 1 images connecting m with m by convention we index all strings of n 1 images by 0 1 n for x sn 1 we define the length x rn 1 and normalized length x rn 1 of x by x i i k 1 xk xk 1 and x i x i x n respectively we define m x max i 1 n 1 xi xi 1 to be the string spacing an interpolant is an operator i which interpolates the images of a string to form a continuous path from m to m that is for rn 1 with i i 1 and x sn 1 i x 0 n rd is a continuous path with i x i xi for all i 0 1 n standard examples include the linear and cubic spline interpolants the linear inter polant is defined piecewise by the formula 2 4 i x i 1 i 1 i xi i i 1 i xi 1 for i i 1 for x sn 1 we let ix denote the curve parametrized by the path i x x the novel difficulty in discretizing gddc is that when the images xi evolve by gradient descent they fall away from the saddle converging to local minima to counteract this effect one must periodically equalize the spacing between images we call this procedure reparametrization of the string the reparametrization operator used in the simplified and improved string method is an easily computed analogue of parametrization by arc length for strings given y sn 1 and an interpolant i we define r sn 1 sn 1 by r y i i y y i n for i 0 n we show in lemma 4 3 that if i is the linear interpolant then as long as y n n h the reparametrized string has m r y h thus the reparametrization operator moves the images close together if they are initially far apart finally to evolve strings by gradient descent we require a numerical integrator for the gradient flow we let s t denote this integrator one might take s t to be a euler s method for example we will analyze the following version of the string method pick h 0 k 1 and t 0 as the notation suggests h and t are the spatial and temporal discretization parameters of the string method let x 0 sn 1 be an initial guess for a string following the minimum energy path assume that m x 0 h the simplified and improved string method iterates advancing the string by the nu merical gradient flow s t and reparametrizing the string when the distance between 4 images exceeds kh to be precise suppose that for some n n a string xn has been computed to compute xn 1 first let y sn 1 with yi s t x n i next check whether m y kh if so let xn 1 y if not then check whether y n n h if y n n h let xn 1 r y as explained above if i is the linear interpolant then as long as y n n h the reinterpolated string has m xn 1 h if y n n h then more images must be added to the string to guarantee m xn 1 h let n y n h and define xn 1 rd n 1 by xn 1 i i y y i n for i 0 n for efficiency it may also be desirable to reduce the number of points on the string if xn n n falls below a certain threshold but we do not consider this possibility 3 local stability of minimum energy paths our goal in this section is to analyze the local stability of minimum energy paths under the gddc providing a basis for a numerical analysis of the string method throughout the rest of this work we restrict our attention to a single minimum energy path denoted m and satisfying the following conditions assumption 3 1 m is a minimum energy path passing through the local minima m 1 mk and the saddles s 1 sk 1 as illustrated in figure 1 the critical points m 1 mk and s 1 sk 1 are distinct and isolated no other critical points lie on m each of the saddles has morse index one i e for all i 1 k 1 d 2 v si has one negative eigenvalue and all its other eigenvalues are positive each local minimum is linearly stable i e d 2 v mi is positive definite no two of the saddles s 1 sk 1 are connected by a single heteroclinic along m without a minimum in between that is m passes through minima and saddles alternately m does not intersect itself so it is homeomorphic to an interval remark 3 2 we restrict our attention to meps passing through critical points of index less than or equal to one for two reasons first the gddc may not converge to a mep if the initial curve lies near a saddle of index two or higher 2 in that case we cannot expect the string method to converge either second in most applications only saddles of index one are relevant typically one is most interested in the lowest energy saddle separating two minima m and m to be precise define the communication height between m and m to be h m m min c m m max z v z where c m m is the set of continuous curves connecting m with m in general the maximizer z of the energy along any minimizing curve is a critical point of v in fact if the hessian d 2 v is continuous and invertible at z then z is a saddle 5 m 1 s 1 s 2 m 2 m 3 wu s 1 w s s 2 wu s 2 fig 2 the solid black curve depicts a mep which connects two saddles of index one directly without passing through a local minimum in between here the unstable manifold wu s 1 at the saddle s 1 is contained within the stable manifold w s s 2 at s 2 the mep might follow either of the two heteroclinics lying on wu s 2 leading to the two minima m 2 and m 3 the arrows on each heteroclinic point in the gradient descent direction of index one 16 there do exist molecular systems for which the communication height is attained at a critical point z where d 2 v z is degenerate or where v is not twice continuously differentiable 22 23 however these systems seem to be rare in practice given the lowest energy saddle z one can estimate the rate of transitions from m to m using transition state theory 1 8 21 although we assume that m alternates between minima and saddles it is possible for a single heteroclinic to connect two saddles of index one with no local minimum in between this occurs when the unstable manifold of the higher energy saddle under gradient descent lies within the stable manifold of the lower energy saddle see 24 for examples of molecular systems with meps of this type these meps are not in general stable under gddc for example consider the mep depicted in solid black in figure 2 the limit sets under gddc of small perturbations of this curve may include both the solid black and the dashed heteroclinics in addition to our assumptions on the mep m we impose the following assump tions on v assumption 3 3 the potential v rd r is three times continuously differ entiable the gradient v is globally lipschitz with constant l 0 in the euclidean norm that is v x v y l x y where denotes the euclidean norm the third derivatives of v are bounded i e there exists c 3 0 so that 3 1 sup x rd 3 v xi xj xk x c 3 for all i j k 1 d before we can discuss stability of gddc we require a metric to measure discrep ancies between curves we choose the hausdorff distance 6 definition 3 4 for compact sets x y rd let d x y sup x x inf y y x y be the one sided distance from x to y now define the hausdorff distance dh x y between sets x and y to be dh x y max d x y d y x our proof of convergence relies on the construction of a lyapunov function for m in hausdorff distance we give a precise definition of lyapunov function below following the definitions given in 19 25 for dynamical systems on rd definition 3 5 let b rd be a set containing m and let c m 1 mk b denote the set of all continuous curves connecting m 1 and m 2 and contained in b we say that w is a lyapunov function for m on b if w w 0 for some forward invariant set w c m 1 mk b and the following statements hold 1 there exists a constant c 0 such that for any w 3 2 w st e ctw for all t 0 2 for any w 3 3 w w dh 3 there exists a strictly increasing continuous function 0 0 with 0 0 such that 3 4 dh m w dh m by 19 theorem 2 7 6 an equilibrium point of a dynamical system on rd has a lyapunov function if and only if it is uniformly and asymptotically stable such re sults are useful in control theory where they are called converse lyapunov theorems we will generalize this result to prove the existence of a lyapunov function for m first we give the appropriate definitions of uniform and asymptotic stability definition 3 6 uniform stability we say that m is uniformly stable in haus dorff distance if and only if for every 0 there exists a 0 so that for c m 1 mk dh m implies dh m st for all t 0 definition 3 7 asymptotic stability with uniform convergence let b be a compact set with m b rd and let c m 1 mk b we say that m is asymptotically stable on b with uniform convergence if for any 0 there exists a time t b independent of so that dh m st for all t t b in general asymptotic stability with uniform convergence is stronger than asymp totic stability usually one defines a point x rm to be asymptotically stable on a set u rm under a flow rt rm r rm if and only if it is uniformly stable and y u implies limt rty x our definition additionally requires that the convergence of rty to x be uniform over all y u when the set u is compact asymptotic stability with uniform convergence follows from asymptotic stability but in our case the set c m 1 mk b is not compact in the hausdorff distance even if b rd is compact our proofs of asymptotic and uniform stability require the following lemma re lating the hausdorff distance between a curve and m to a one sided distance 7 lemma 3 8 for every 0 there exists an 0 such that if c m 1 mk with d m then d m hence dh m proof we present only a sketch of the proof here the details appear in ap pendix a the existence of a tubular neighborhood of m would suffice given a tubular neighborhood u of radius any path c m 1 mk u would pass through every normal disk in the neighborhood by the intermediate value theorem thus for any x on m there would be a point y on lying in the normal disk centered at x with y x this would prove the result since for small enough d m would imply u unfortunately m may not have a tubular neighborhood since m may not be differentiable at the local minima mi in appendix a we develop an argument based on an analogue of a tubular neighborhood consisting of balls surrounding the minima connected by tubes where m must be smooth by lemma 3 8 to prove uniform and asymptotic stability in hausdorff distance under gddc it suffices to prove the analogous properties for m under the gradient flow st in a one sided distance see lemma 3 10 and lemma 3 11 lemma 3 9 is our first step in proving these stability results lemma 3 9 for any point p m and any 0 there exists an open set u p containing p so that x u p implies d st x m for all t 0 proof we distinguish three cases p may be a local minimum it may lie on a heteroclinic or it may be a saddle suppose that p is a local minimum since we assume that each local minimum is linearly stable there exists some 0 so that x b p implies st x b p for all t 0 thus we may take u p b p now suppose that p lies on the heteroclinic connecting the minimum m with the saddle s let 0 be small enough that x b m implies st x b m for all t 0 we have lim t st p m so t p inf t 0 st p b 2 m is finite recall that we assume v is lipschitz with constant l and define 3 5 p 2 exp t p l if x b p p then for all t t p st p st x exp lt p exp lt p p 2 therefore since st p m d st x m when 0 t t p moreover st p x m st p x st p p st p p m so st x b m for all t t p hence d st x m for t t p thus we may take u p b p p when p lies on a heteroclinic finally suppose that p si is the saddle point lying between the local minima mi and mi 1 let lt be the flow for v d 2 v p v and let v 1 be the eigenvector cor responding to the unique negative eigenvalue of d 2 v p by the hartman grobman 8 theorem there exists an open ball br 0 rd and a homeomorphism br 0 rd so that st y lt y for all y br 0 and t 0 so that lt y br 0 see figure 3 for an illustration of the mapping and the relations between the various neighborhoods defined below choose 0 r let b be the open cube inscribed in b 0 with edges parallel to the eigenvectors of d 2 v p we observe that rv 1 b is a subset of m in addition rv 1 b x 1 x 2 where y 1 x 1 lies on the heteroclinic connecting p with mi and y 2 x 2 lies on the heteroclinic connecting p with mi 1 since is uniformly continuous on b there exists 0 such that for all x y b 3 6 x y implies x y min y 1 y 2 here y 1 and y 2 are defined as in 3 5 above now let m x b x projv 1 x we claim that u p m has the desired property to see this observe that ltx projv 1 ltx decreases with t since rv 1 is the unstable subspace of d 2 v p in particular if x m then 3 7 ltx projv 1 ltx for all t 0 now let y u p and write x 1 y for any t 0 such that st y u p we have d st y m st y st projv 1 x lt x lt projv 1 x min y 1 y 2 the first inequality follows since projv 1 x m and the second to last follows from 3 6 and 3 7 we must now show that d st y m for all t 0 not merely t such that st y u p if y lies on the stable manifold w s p of p then st y u p for all t 0 so suppose that y w s p in that case we claim that the trajectory st y passes through either b y 1 y 1 or b y 2 y 2 as it exits u p to see this we observe that by 3 7 the trajectory ltx passes through either b x 1 or b x 2 as it leaves m that is for t 0 the unique time such that ltx m we have ltx b x 1 b x 2 therefore by 3 6 st y ltx b y 1 y 1 b y 2 y 2 it follows that d st y m for all t t thus in fact d st y m for all t 0 uniform stability of m under gradient descent in a one sided distance is an im mediate corollary of lemma 3 9 lemma 3 10 for every 0 there exists a 0 so that d x m implies d st x m for all t 0 9 x 1 y 1 y 2 m x 2 rv 1 v 1 w s si 0 si mep u si rv 1 b x 1 b y 1 y 1 fig 3 an illustration of the use of the hartman grobman theorem in the proof of lemma 3 9 proof let u p be defined as in lemma 3 9 the open set u p mu p contains m and x u implies d st x m for all t 0 now for any x m define r x sup 0 b x u the function r x is lower semicontinuous and m is compact so r x attains a mini mum on m we have 0 since u is open moreover d x m implies x u so d st x m for all t 0 as desired lemma 3 9 also implies asymptotic stability of m under gradient descent in a one sided distance lemma 3 11 there exist an open set b with m b and a function t 0 0 so that for any 0 and x b d st x m whenever t t proof for each p m let u 1 p be the set constructed in the proof of lemma 3 9 with 1 define u p m 1 mk s 1 sk 1 u 1 p we claim that for some time t sufficiently large the set 3 8 b tt 0 s t u contains m to see this we observe that t 0 s t u is an open cover of m the sets s t u are open since u is open and the flow st is a diffeomorphism moreover these sets cover m since they contain the stationary points and for each p m the trajectory st p converges to a stationary point therefore since m is compact it follows that b contains m for some finite t 0 now fix 0 let b be an bounded open subset of b with m b and such that b the closure of b is contained in b by lemma 3 10 there exists an open neighborhood v of m so that x v implies d st x m for all t 0 for any 10 x b define t x inf t 0 st x v observe that t x is finite since when x b st x u and so the trajectory st x converges to one of the stationary points we claim that t x is upper semi continuous as a function of x on b by definition of t x for any 0 there exists 0 so that st x x v moreover since v is open and st x is continuous there exists some 0 small enough that st x b x v thus for any y b x t y t x t x and so t x is upper semicontinuous therefore t x attains a maximum t on the compact set b hence d st x m whenever t t which completes the proof finally by lemma 3 8 uniform and asymptotic stability for gradient descent imply the analogous stability properties in hausdorff distance for the dynamics on curves theorem 3 12 m is uniformly stable in the hausdorff distance under the gradi ent descent dynamics on curves moreover m is asymptotically stable with uniform convergence on b for some compact set b containing an open neighborhood of m proof we prove only uniform stability the proof of asymptotic stability is sim ilar let 0 by lemma 3 8 there exists 0 so that d m implies dh m moreover by lemma 3 10 there exists 0 so that d m implies d st m for all t 0 therefore if c m 1 mk and dh m we have dh st m for all t 0 thus m is uniformly stable in hausdorff distance under gddc our stability results guarantee the existence of a lyapunov function we begin by constructing an appropriate domain b for this lyapunov function the key property of this domain is forward invariance i e that x b implies st x b for all t 0 lemma 3 13 for some 0 there exists a compact forward invariant set b containing an open neighborhood of m proof by lemma 3 10 for any 0 there exists a 0 so that d x m implies d st x m for all t 0 define n m p mb p and b 0 s n m we have b n m moreover b n m so b is bounded 11 to see that b is forward invariant let x b we must show that for any t 0 stx is a limit point of 0 s n m we first observe that by definition for any 0 there is some x 0 s n m with x x therefore for any 0 stx stx exp tl exp tl x x exp tl thus since stx exp tl 0 s n m stx is a limit point as desired we now construct a lyapunov function for m in hausdorff distance theorem 3 14 let b be a compact forward invariant set containing an open neighborhood of m assume that m is asymptotically stable with uniform convergence on b there exists a lyapunov function v c m 1 mk b 0 for m proof we adapt the proof of 19 theorem 1 7 6 details appear in appendix b remark 3 15 previous work has analyzed convergence of trajectories of gddc to meps 2 it is known that if the limit set of a trajectory is a mep then the trajectory converges to that mep 2 theorem 3 this is the case if there are finitely many criti cal points of the potential v and all are minima or saddles of index one 2 corollary 4 or if both the potential and the initial curve are piecewise analytic 2 corollary 7 however we are not aware of any results other than our theorem 3 12 regarding the local asymptotic and uniform stability of individual meps it is these local stabil ity results which imply that a given mep can be computed using a discretization of gddc 4 convergence of the string method our main result in this section is theorem 4 6 which implies that any mep m passing alternately through minima and saddles of index one may be approximated to arbitrary accuracy by the string method the proof uses the existence of a lyapunov function to show that discretization errors in the string method do not accumulate thus the string method follows the gddc converging to a neighborhood of m over long times for convenience we analyze only the simplified and improved string method with the linear interpolant assumption 4 1 assume that i is the linear interpolant defined in 2 4 we also place consistency and stability assumptions on the numerical integrator assumption 4 2 for some q 2 and d 0 we have 4 1 s t x s t x d tq for all x rd in addition 4 2 s n t x s n t y exp ln t x y we note that all commonly used integrators satisfy 4 1 with q 2 and many integrators satisfy 4 2 see 19 in particular for euler s method s t x s t y x y t v x v y 1 tl x y 12 therefore since 1 tl exp tl s n t x s n t y 1 tl n x y exp ln t x y we now estimate the error introduced when reparametrizing the string lemma 4 3 let x sn 1 we have dh ix irx m x 2 proof first we observe that for any x sn 1 we have m rx m x to see this let s ix a b denote the arc length along ix between a and b we have rxi rxi 1 s ix rxi rxi 1 x n k 1 i 0 xi 1 xi n m x now let y irx and suppose that y is between rxi and rxi 1 we have min rxi y rxi 1 y 1 2 rxi rxi 1 m rx 2 m x 2 therefore since rxi ix and rxi 1 ix d irx ix m x 2 now let y ix and suppose that y i x x for some i n i 1 n we have min rxi y rxi 1 y 1 2 s ix rxi rxi 1 m x 2 so d ix irx kh 2 we conclude that dh ix irx m x 2 we now show that reparametrization occurs only after each image has been ad vanced at least by a certain time 0 this is crucial for the numerical analysis since the upper bound on reparametrization error in lemma 4 3 does not have a factor involving the time step t this upper bound suffices because we do not consider whether the string method approximates gddc in the limit as t 0 instead we are interested only in the convergence of strings to m over long times lemma 4 4 let x sn 1 define log k l we have m s n t x km x for all 0 n t proof by 4 2 we have s n t xi 1 s n t xi exp ln t xi 1 xi exp l m x km x for all i 1 k finally we estimate the error resulting from evolving only the images xi by gra dient descent in each step not the entire interpolated curve ix 13 lemma 4 5 let x sn 1 and let be defined as in lemma 4 4 there exists a constant c 0 depending only on v and so that dh s tix is tx cm x 2 t for all 0 t proof let x sn 1 fix 0 1 and i 0 n let x 1 xi xi 1 write y xi 1 xi for any z rd define z to be the derivative in direction z so for example zst x d d 0 st x z since v is twice continuously differentiable the flow st x is also twice continu ously differentiable as a function of t x by 3 theorem 1 3 therefore by taylor s theorem for some x and x in the convex hull of xi xi 1 we have s t xi s t x ys t x 1 2 2 2 ys t x and s t xi 1 s t x 1 ys t x 1 2 1 2 2 ys t x it follows that 1 s txi s txi 1 s t x 1 2 sup z rd 2 y y s t z y 2 1 2 sup z rd 2 ws t z m x 2 4 3 where we define w y y st x solves the gradient descent initial value problem d dt st x v st x s 0 x x differentiating this initial value problem twice with respect to x yields 4 4 d dt 2 wst x t a t 2 wst x 2 ws 0 x 0 where t q d m 1 3 v xq x xm st x wst x wst x m for q 1 d and a t q 2 v xq x st x for q 1 d 14 here wst x and 2 wst x denote the th coordinate components of wst x and 2 wst x respectively since 2 ws 0 x 0 we have 2 wst x c x t for any fixed x rd however it is not immediately clear that this estimate holds with a constant independent of x to prove this observe that since v is lipschitz with constant l we have sup t 0 a t 2 sup z rd 2 v xq x z 2 l where 2 is the operator norm induced by euclidean distance moreover st is lipschitz with constant exp lt so wst x exp lt w exp lt by assumption 3 3 3 v xq x xm st x c 3 thus t dc 3 exp 2 lt it then follows from 4 4 that 2 wst x t 0 s ds t 0 a s 2 2 wss x ds dc 3 2 l exp 2 lt 1 l t 0 2 wss x ds therefore by gro nwall s inequality 2 wst x dc 3 2 l exp 2 lt 1 exp lt 4 5 finally by 4 3 and 4 5 we have 1 s txi s txi 1 s t x dc 3 2 l exp 2 l t 1 exp l m x 2 dc 2 exp 3 l m x 2 t dc 2 k 3 m x 2 t for all t this proves the result since every point y is tx takes the form y 1 s txi s txi 1 for some i 0 n and 0 1 and every point z s tix takes the form z s t 1 xj xj 1 for some j 0 n and 0 1 15 we now prove our convergence result for the simplified and improved string method we note that some aspects of the proof were inspired by a result concerning the persistence of attractors of odes under discretization see 12 and 19 theo rem 7 5 1 theorem 4 6 there exist h 0 0 r 0 0 n 0 0 and a function e 0 h 0 0 0 with lim h t 0 e h t 0 such that if dh ix 0 m r 0 and h h 0 then dh ix n m e h t for all n n 0 proof first one must show that there exist h 0 0 r 0 0 and tmax 0 so that if h h 0 t tmax and dh ix 0 m r 0 then ix belongs to the domain w of w for all 0 we prove this in appendix c once it is established that the entire trajectory of the string method lies in the domain of w the result follows from a variation of parameters formula involving w by the contraction property 3 2 and lipschitz property 3 3 of the lyapunov function we have w ix 1 w s tix w ix 1 w s tix exp c t w ix dh ix 1 s tix exp c t w ix dh ix 1 is tx 4 6 dh is tx is tx dh is tx s tix exp c t w ix r t c 4 7 where we define r dh ix 1 is tx t dh is tx is tx and c dh is tx s tix the term r is associated with reparametrization t is the truncation error of the numerical integrator and c is associated with commuting evolution by s t and interpolation by induction using 4 7 we have the variation of parameters formula w ix exp c t w ix 0 1 j 0 exp c j 1 t rj tj cj 4 8 assumption 4 2 implies t d tq since when i is the linear interpolant dh ix iy max i 0 n 1 xi yi 16 for any x y sn 1 moreover by lemma 4 5 c c kh 2 t therefore 1 j 0 exp c j 1 t tj cj d tq c kh 2 t 1 exp c t 1 exp c t d t q 1 c kh 2 1 exp c t c d t q 1 c kh 2 c 4 9 the second inequality above follows since x 7 1 exp cx is a concave fucntion with the tangent line x 7 cx at x 0 so 1 exp c t c t the term r is zero unless reparametrization occurs in the 1 st step of the string method let ri be the step in which the i th reparametrization occurs by lemma 4 4 ri t i when reparametrization does occur in the 1 st step we have m x kh but m x 1 kh however since s t is lipschitz with constant exp l t m x 1 exp l t kh therefore by lemma 4 3 r exp l t kh 2 thus we have 1 j 0 exp c j 1 t rj j 0 exp c j 1 t rj exp l t kh 2 i 1 exp ci tri exp l t kh 2 i 1 exp ci t t exp l t kh 2 1 1 exp c 4 10 we conclude that w ix exp c t w ix 0 exp l t kh 2 1 exp c d tq 1 c kh 2 c exp c t r 0 exp l t kh 2 1 exp c d tq 1 c kh 2 c 17 mi mi 1 i i 1 ti si b mi h i h i 1 fig 4 a depiction of the neighborhoods constructed in the proof of lemma 3 8 the bold black line represents m the arrows point in the direction of gradient descent along the heteroclinics h i and h i connecting si to mi and mi 1 the blue dashed balls are b 2 mi and b 2 mi 1 the second inequality above follows from the lipschitz property of w 3 3 and w m 0 using that dh ix 0 m r 0 therefore for some n 0 0 depending only on r 0 n 0 implies w ix exp l t kh 1 exp c 2 d tq 1 c kh 2 c thus for n 0 dh ix m 1 exp l t kh 1 exp c 2 d tq 1 c kh 2 c e h t by 3 4 and the monotonicity of we observe that since 0 0 and is strictly increasing lim h t 0 e h t 0 which concludes the proof appendix a proof of lemma 3 8 proof we adapt the argument based on tubular neighborhoods outlined after the statement of lemma 3 8 to allow for kinks at the minima we devise an analogue of a tubular neighborhood consisting of tubes where m is smooth connected by balls surrounding the minima as in figure 4 let 0 since each minimum mi is linearly stable there exists i 0 so that x b i mi implies stx mi is strictly decreasing with t let min 6 mini 1 k i 2 observe that the balls b 2 mi are disjoint since the basins of attraction of the minima mi under the gradient flow are disjoint 18 let h i be the heteroclinic connecting mi with si and h i 1 the heteroclinic connecting si with mi 1 as in figure 1 we claim that for any i 1 k 1 the curve segment mi h i h i 1 b 2 mi b 2 mi 1 is a c 2 embedded submanifold of rd to prove this observe that in an open neigh borhood of the the saddle point si mi coincides with the local unstable manifold of si since v c 3 by the invariant manifold theorem 18 theorem 5 2 the local unstable manifold is a c 2 embedded submanifold of rd now since mi lies on the pair of heteroclinics h i and h i 1 for some time t 0 the whole of mi is contained in the image under st of the part coinciding with the local unstable manifold the flow map st is a diffeomorphism and since v c 3 we have st c 2 by 3 theorem 1 3 thus mi is a c 2 embedded submanifold it follows by 13 theorem 10 19 that mi has a tubular neighborhood the statement of 13 theorem 10 19 assumes a c embedded submanifold however the proof requires only a c 2 embedded submanifold in particular for any radius i 0 small enough there exist an open neighborhood ti with mi ti and a continuous retraction ri ti mi such that x ri x i for all i 1 k 1 let 0 i be small enough that a tubular neighborhood exists since the closures of the curve segments mi are disjoint we may assume that the tubular neighborhoods ti are disjoint reducing i if necessary moreover we may assume that ti b 2 mk 6 only for k i i 1 since m does not intersect itself it is homeomorphic to an interval that is there exists a continuous bijection 0 1 m with continuous inverse 1 m 0 1 here we equip m with the subspace topology inherited from rd we may assume that for some 0 1 2 k 1 i mi for each i 1 k 1 define i sup 0 1 b 2 mi and let k 1 similarly for i 2 k define i 1 inf 0 1 b 2 mi 1 and let 1 0 we claim that a 1 b 2 mi iff i i to prove a 1 observe that by continuity of i b 2 mi in fact since st x mi is strictly decreasing on b 2 mi the heteroclinic trajectory h i in tersects b 2 mi only at i if we had mi 2 for some i i the intermediate value theorem would imply the existence of a second distinct point of intersection between h i and b 2 mi since is a bijection therefore i i b 2 mi a similar argument involving the heteroclinic h i shows i i b 2 mi and a 1 follows 19 we will now construct an analogue of the retraction ri for the entire mep m for convenience instead of mapping onto m will take values in 0 1 the domain of the parametrization of m we handle kinks at minima by letting take a constant value on a ball surrounding each minimum we begin by defining for each i 1 k 1 the three continuous functions p i b mi r by p i x i pi ti r by pi x min i 1 max i 1 ri x and p i 1 b mi 1 r by p i 1 x i 1 these functions will be the constituent parts of our retraction we claim that p i pi and p i agree where their domains intersect to verify this it will suffice to show that 1 ri x i for x b mi ti and 1 ri x i 1 for x b mi 1 ti let x b mi ti then ri x mi ri x x x mi i 2 and so ri x b 2 mi therefore 1 ri x i by a 1 similarly x b mi 1 ti implies 1 ri x i 1 thus the three functions agree on the intersections of their domains therefore since the domains are open they define a single continuous function i on ui b mi ti b mi 1 we now patch together the functions i to construct our retraction first define i ui 0 1 by i x i x i j 2 j j the functions i are continuous have open domains and agree on the intersections of their domains in fact for i 1 k 1 the functions i and i 1 both take the value i 1 i 1 j 2 j j on b mi 1 ui ui 1 the domains ui and uj do not intersect if i j 2 therefore the functions i define a single continuous function on u k 1 i 1 ui since u is open and m is compact there exists some 0 so that d x m implies x u we claim that the conclusion of the lemma holds for this to see 20 this let c m 1 mk with d m we have m 1 1 and mk k k 1 j 1 j j therefore by the intermediate value theorem a 2 1 k k 1 j 1 j j now let x m by a 2 there exists some y so that y x to complete the proof we will show that x y we distinguish two cases either x 6 mi for any i 1 k or else x mi for some i 1 k in the first case y lies in a tube ti for some i and x ri y therefore x y i in the second case we have y x mi we claim that for any z u a 3 z mi implies z b 3 mi if so then x y x mi y mi 3 3 to prove a 3 we observe that if z mi then z ui ui 1 suppose that z ui on the one hand if z b mi then a 3 holds trivially on the other hand if z b mi then z ti in that case since z mi 1 ri z i i so by a 1 ri z b 2 mi therefore z mi z ri z ri z mi 2 3 this concludes the proof of a 3 hence the proof of lemma 3 8 appendix b proof of theorem 3 14 proof let b rd be a compact forward invariant set containing m we will construct a lyapunov function for m defined on the set c m 1 m 2 b define gk 0 0 by gk x max 0 x 1 k let c 0 for any c m 1 m 2 b define vk sup 0 exp c gk dh s m we note that vk is finite since asymptotic stability on b implies gk s 0 for sufficiently large we will use the functions vk for k 1 to construct a lyapunov function 21 first we observe that vk has the contraction property 3 2 of a lyapunov func tion since vk st sup 0 exp c gk dh st m exp ct sup 0 exp c t gk dh st m exp ct sup t exp c gk dh s m exp ct vk b 1 we now find a lipschitz constant for vk m is asymptotically stable with uniform convergence on b and so for each k n there exists t 1 k so that for any c m 1 m 2 b dh st m 1 k whenever t 1 k t therefore for any c m 1 m 2 b we have vk vk sup 0 exp c gk dh s m gk dh s m sup 0 t 1 k exp c gk dh s m gk dh s m sup 0 t 1 k exp c dh s m dh s m sup 0 t 1 k exp c dh s s sup 0 t 1 k exp c exp l dh exp l c t 1 k dh it follows that b 2 lk exp l c t 1 k is a lipschitz constant for vk we claim that v c m 1 m 2 b 0 defined by v k 1 l 1 k vk 2 k is a lyapunov function for m on b to see that the sum defining v converges we observe that 0 vk vk m lkdh m lkdh m which implies b 3 v dh m the contraction property 3 2 and lipschitz bound 3 3 in the definition of lyapunov function follow from b 1 and b 2 respectively the upper bound in property 3 4 follows from b 3 22 thus it remains only to show the lower bound in 3 4 that is we must show dh m v for some continuous strictly increasing function with 0 0 to see this observe that if dh m 1 then v 1 22 l 2 g 2 dh m 1 22 l 2 dh m 1 2 1 22 exp c l t 1 2 1 2 dh m similarly if 1 k 1 dh m 1 k then v 1 2 k 1 exp c l t 1 k 1 1 k 1 dh m appendix c statement and proof of lemma c 1 lemma c 1 there exist r 0 0 h 0 0 and tmax 0 such that if dh ix 0 m r 0 m x 0 h 0 and t t 0 then ix w for all 0 proof for r 0 let n r c m 1 m 2 dh m r by construction the domain w of w contains n r 1 for some r 1 0 let r 0 r 1 2 and define m w w r 0 we claim n r 0 m n r 1 w to prove this we observe that by 3 3 and 3 4 x x for all x 0 therefore r 0 r 1 2 so n r 0 n r 1 w having established that n r 0 lies in the domain w of w inequality 3 3 implies that n r 0 m finally if m then dh m r 0 by 3 4 thus dh m 1 r 0 r 1 2 r 1 by monotonicity of hence m n r 1 we will show that for some h 0 0 and tmax 0 if ix 0 m m x 0 h h 0 and t tmax then ix m for all 0 first we prove that if ix m with m x kh and m s tx kh then ix 1 m that is if ix m and 23 reparametrization does not occur in the 1 st step of the string method then ix 1 m to see this observe that dh s tix m w s tix e c tw ix e c tr 0 and so dh s tix m 1 e c tr 0 1 r 0 r 1 2 therefore for h 0 and tmax small enough that c 1 dtqmax c kh 0 2 t r 1 2 we have dh ix 1 m dh is tx m dh is tx is tx dh is tx s tix dh s tixn m d tq c kh 2 t r 1 2 r 1 by assumption 4 1 and lemma 4 5 thus ix 1 n r 1 w having shown that ix 1 lies in the domain of w the argument leading to in equality 4 7 yields w ix 1 exp c t w ix d tq c kh 2 t c 2 exp c t r 0 d tq c kh 2 t r 0 whenever c 3 dtqmax c kh 0 2 t 1 exp c t r 0 2 this second condition on h 0 and tmax is stronger than the first c 1 so we conclude that ix 1 m if c 3 holds now suppose that ix m and m x h suppose that the first reparametriza tion after step occurs at step r 1 for some r 0 by the the previous paragraph ix q m for q 1 r therefore inequality c 2 yields w ix q exp c t w ix q 1 d tq c kh 2 t for q 1 r it follows by 3 3 and c 3 that the variation of parameters for mula 4 8 holds up to step r using lemma 4 4 and this variation of parameters formula we have w ix r exp cr t w ix d t q c kh 2 t 1 exp cr t 1 exp c t exp c r 0 1 exp c r 0 2 1 exp c r 0 2 24 reparametrization occurs at the r 1 st step therefore m s tx r kh however since s t has lipschitz constant exp l t and m x r kh m s tx r exp l t kh by assumption 4 2 lemma 4 3 and lemma 4 5 we then have dh ix 1 s tix dh irs tx s tix exp l t kh d tq c kh 2 t therefore by arguments similar to those in the previous paragraph if c 4 exp l t kh 0 d t q c kh 2 t 1 exp c r 0 2 then ix r 1 w and w ix r 1 exp c t w ix r k h d tq c kh 2 t 1 exp c r 0 2 1 exp c r 0 2 r 0 thus ix r 1 m let h 0 and tmax satisfy c 3 and c 4 we have seen that if ix m m x h 0 and t tmax then the trajectory of the string method remains in m until after the first reparametrization say at step r when the reparametrization occurs we have ixr m and m xr h therefore by induction if ix 0 m and m x 0 h then ix m for all 0 acknowledgement we would like to thank eric vanden eijnden for discus sions that motivated this work references 1 n berglund kramers law validity derivations and generalisations markov processes and related fields 19 2013 pp 459 490 2 m cameron r v kohn and e vanden eijnden the string method as a dynamical system journal of nonlinear science 21 2011 pp 193 230 3 c c chicone ordinary differential equations with applications texts in applied mathemat ics springer new york 2 nd ed 2006 4 w e w ren and e vanden eijnden string method for the study of rare events phys rev b 66 2002 p 052301 5 w e w ren and e vanden eijnden finite temperature string method for the study of rare events the journal of physical chemistry b 109 2005 pp 6688 6693 6 w e w ren and e vanden eijnden simplified and improved string method for computing the minimum energy paths in barrier crossing events the journal of chemical physics 126 2007 164103 pp 7 s fischer and m karplus conjugate peak refinement an algorithm for finding reaction paths and accurate transition states in systems with many degrees of freedom chemical physics letters 194 1992 pp 252 261 8 p ha nggi p talkner and m borkovec reaction rate theory fifty years after kramers reviews of modern physics 62 1990 pp 251 341 9 g henkelman g jhannesson and h jnsson methods for finding saddle points and mini mum energy paths in theoretical methods in condensed phase chemistry springer 2002 pp 269 302 10 g henkelman and h jo nsson improved tangent estimate in the nudged elastic band method for finding minimum energy paths and saddle points the journal of chemical physics 113 2000 pp 9978 9985 25 11 g henkelman b p uberuaga and h jo nsson a climbing image nudged elastic band method for finding saddle points and minimum energy paths the journal of chemical physics 113 2000 pp 9901 9904 12 p kloeden and j lorenz stable attracting sets in dynamical systems and in their one step discretizations siam journal on numerical analysis 23 1986 pp 986 995 13 j m lee introduction to smooth manifolds vol 218 of graduate texts in mathematics springer new york first ed 2002 14 l maragliano a fischer e vanden eijnden and g ciccotti string method in col lective variables minimum free energy paths and isocommittor surfaces the journal of chemical physics 125 2006 p 024106 15 l maragliano and e vanden eijnden on the fly string method for minimum free energy paths calculation chemical physics letters 446 2007 pp 182 190 16 j n murrell and k j laidler symmetries of activated complexes transactions of the faraday society 64 1968 p 371 17 d sheppard r terrell and g henkelman optimization methods for finding minimum energy paths the journal of chemical physics 128 2008 p 134106 18 m shub global stability of dynamical systems springer verlag new york 1987 with the collaboration of albert fathi and re mi langevin translated from the french by joseph christy 19 a stuart and a humphries dynamical systems and numerical analysis cambridge mono graphs on applied and computational mathematics cambridge university press new york 1 st pbk ed 1998 20 a ulitsky and r elber a new technique to calculate steepest descent paths in flexible polyatomic systems the journal of chemical physics 92 1990 pp 1510 1511 21 g h vineyard frequency factors and isotope effects in solid state rate processes journal of physics and chemistry of solids 3 1957 pp 121 127 22 d j wales basins of attraction for stationary points on a potential energy surface j chem soc faraday trans 88 1992 p 12 23 d j wales limitations of the murrell laidler theorem j chem soc faraday trans 88 1992 pp 543 544 24 d j wales energy landscapes cambridge molecular science series cambridge university press cambridge uk new york 2003 25 t yoshizawa stability theory by liapunov s second method publications of the mathematical society of japan mathematical society of japan tokyo 1966 26 1 introduction 2 minimum energy paths and the string method 3 local stability of minimum energy paths 4 convergence of the string method appendix a proof of lemma appendix b proof of theorem appendix c statement and proof of lemma acknowledgement references