ar x iv 1 20 9 26 39 v 8 m at h o c 1 5 ju n 20 14 a multi dimensional stochastic singular control problem via dynkin game and dirichlet form yipeng yang abstract the traditional difficulty about stochastic singular control is to characterize the regularities of the value function and the optimal control policy in this paper a multi dimensional singular control problem is considered we found the optimal value function and the optimal control policy of this problem via dynkin game whose solution is given by the saddle point of the cost function the existence and uniqueness of the solution to this dynkin game are proved through an associated variational inequality problem involving dirichlet form as a consequence the properties of the value function of this dynkin game implies the smoothness of the value function of the stochastic singular control problem in this way we are able to show the existence of a classical solution to this multi dimensional singular control problem which was traditionally solved in the sense of viscosity solutions and this enables the application of the verification theorem to prove optimality 1 key words dynkin game dirichlet form multi dimensional diffusion stochastic singular control ams subject classifications 49 j 40 60 g 40 60 h 30 93 e 20 1 introduction and problem formulation the characterization of the reg ularities of value function and optimal policy in stochastic singular control remains a big challenge in stochastic control theory especially the higher dimensional case see e g 19 the traditional approach is to use the viscosity solution technique see 4 3 2 which usually yields a less regular solution another approach to solve singular control problems and characterize the regularity of value functions is through variational inequalities and optimal stopping or dynkin game see e g karatzas and zamfirescu 14 guo and tomecek 9 in 12 karatzas and shreve studied the con nection between optimal stopping and singular stochastic control of one dimensional brownian motion and showed that the region of inaction in the control problem is the optimal continuation region for the stopping problem in 1 the authors established and exploited the duality between the myopic investor s problem optimal stopping and the social planning problem stochastic singular control where an integral form and change of variable formula were also presented on this connection ma 16 dealt with a one dimensional stochastic singular control problem where the drift term is assumed to be linear and the diffusion term is assumed to be smooth and he showed that the value function is convex and c 2 and the controlled process is a reflected diffusion over an interval guo and tomecek 10 solved a one dimensional singular control problem via a switching problem 9 and showed using the smooth fit prop erty 18 that under some conditions the value function is continuously differentiable c 1 it is found that 6 through the approach via game theory and optimal stopping it is possible to show the existence of a smooth solution the connection is the following given a symmetric markov process on a locally compact separable metric space it is well known that the solution of an optimal stopping problem admits its quasi continuous version of the solution to a variational inequality problem involving department of mathematics university of missouri columbia columbia missouri 65211 yangyip missouri edu 1 the idea of this paper was proposed by dr michael taksar dr taksar passed away in february 2012 however his contributions should always be remembered 1 http arxiv org abs 1209 2639 v 8 dirichlet form e g see nagai 17 zabczyk 22 extended this result to a zero sum game dynkin game in the one dimensional case the integrated form of the value function of the dynkin game was identified to be the solution of an associated stochastic singular control problem e g see taksar 20 fukushima and taksar 6 where a more general one dimensional diffusion is assumed as a result the classical smooth solution c 2 can be obtained for this singular control problem this paper extends the work by fukushima and taksar 6 to multi dimensional stochastic singular control problem there are many difficulties in this extension in the one dimensional singular control problem each point in the space has a positive capacity 6 hence the nonexistence of the proper exceptional set however this is no longer the case in multi dimensional singular control problem we overcome this difficulty using the absolute continuity of the transition function of the underlying process 7 under some conditions the optimal control policy of the one dimensional case is proved to be the reflection of the diffusion at two boundary points but the form of the optimal control policy and the conditions on the regularity of the value function in multi dimensional case are much more complicated for instance in the two dimensional case the boundary of the continuation region can have various for mats e g bounded curves unbounded curves singular points disconnected curves line segments etc the difficulty in characterizing the continuation region is due to the fact that its boundary is a free boundary and this paper investigates such issues in this paper we are concerned with a multi dimensional diffusion on rn dxt xt dt xt dbt 1 1 where xt x 1 t xnt 1 n 11 1 m n 1 nm bt b 1 t bmt in which i i xt and i j i j xt 1 i n 1 j m are continuous functions of x 1 t x 2 t x n 1 t and bt is m dimensional brownian motion with m n thus we are given a system f ft x t px where f is a measurable space x x is a mapping of into c rn ft xs s t and t is a shift operator in such that xs t xs t here px x r n is a family of measures under which xt t 0 is an n dimensional diffusion with initial state x we assume that and satisfy the usual lipschitz growth condition a control policy is defined as a pair a 1 t a 2 t s of ft adapted processes which are right continuous and nondecreasing in t and we assume a 1 0 a 2 0 are nonnegative denote s the set of all admissible policies whose detailed definition will be given in section 4 given a policy s a 1 t a 2 t s we define the following controlled process dx 1 t 1 dt 11 db 1 t 1 mdbmt dxnt ndt n 1 db 1 t nmdbmt da 1 t da 2 t x 0 x with the cost function ks x ex 0 e th xt dt 0 e t f 1 xt da 1 t f 2 xt da 2 t 1 2 2 f 1 x f 2 x 0 x r n here we assume that a 1 t a 2 t is the minimal decomposition of a bounded variation process into a difference of two increasing processes remark 1 1 a natural question is that why the control only applies on one dimension the difficulty arises in the step where the value function of the zero sum game is integrated in one dimension to obtain the value function of the singular control problem if the control were applied to multi dimensions no result so far is know on the choice of the direction of integration this represents a traditional difficulty in multi dimensional singular control problem interested readers are referred to 19 for a result on two dimensional singular control problem there are two types of costs associated with the process xt for each policy s the first one is the holding cost h xt accumulated along time the second one is the control cost associated with the processes a 1 t a 2 t and this cost increases only when a 1 t a 2 t increase one looks for a control policy s that minimizes ks x i e w x min s s ks x 1 3 as an application of this model a decision maker observes the expenses of a company under a multi factor situation but only has control over one factor yet she still wants to minimize the total expected cost analogously by studying the associated maximization problem i e taking the negative of min this model can be used to find the optimal investment policy where an investor observes the prices of several assets in a portfolio and manages the portfolio by adjusting one of them notice that every time there is a control action it yields a certain associated cost e g the transaction cost the rest of this paper is organized as follows we first introduce some preliminaries on dirichlet form and a variational inequality problem in section 2 in section 3 we identify conditions for the value function as well as the optimal policy of the associated dynkin game the integrated form of the value function of this dynkin game is shown in section 4 to be the value of a multi dimensional singular control problem and the optimal control policy is also determined consequently in the appendix we shall correct an error found in the paper by fukushima and taksar 6 2 dirichlet form and a variational inequality problem let d be a locally compact separable metric space m be an everywhere dense positive radon measure on d and l 2 d m denotes the l 2 space on d we assume that the dirichlet form e f on l 2 d m is regular in the sense that f c 0 d is e 1 dense in f and is uniformly dense in c 0 d where the e 1 norm is defined as follows u e 1 e u u d u x 2 m dx 1 2 analogously we define e u v as e u v e u v u v 0 where u v d u x v x m dx for this dirichlet form there exists an associated hunt process m xt px on d see 5 such that 3 ptf x exf xt x d is a version of ttf for all f c 0 d where tt is the l 2 semigroup associated with the dirichlet form e f furthermore the l 2 resolvent g 0 associated with this dirichlet form satisfies g f f e g f u f u f l 2 d m u f 2 1 and the resolvent r 0 of the hunt process m given by r f x ex 0 e tf xt dt x d is a quasi continuous modification of g f for any borel function f l 2 d m for 0 a measurable function f on d is called excessive if f x 0 and e tptf x f x as t 0 for any x d a function f f is said to be an potential if e f g 0 for any g f with g 0 for any potential f f define f x limt 0 ptf x then f f m a e and f is excessive see section 3 in 7 f is called the excessive regularization of f furthermore any excessive function is finely continuous see theorem a 2 7 in 5 as related literature nagai 17 considered an optimal stopping problem and showed that there exist a quasi continuous function w f which solves the variational inequality w g e w u w 0 u f with u g and a properly exceptional set n such that for all x d n w x sup ex e g x ex e g x where g is a quasi continuous function in f and inf t 0 w xt g xt moreover w is the smallest potential dominating the function g m a e zabczyk 22 then extended this result to the solution of the zero sum game dynkin game by showing that there exist a quasi continuous function v x f which solves the variational inequality g v h m a e e v u v 0 u f g u h m a e 2 2 and a properly exceptional set n such that for all x d n v x sup inf jx inf sup jx 2 3 for any stopping times and where jx ex e i g x i h x 2 4 and g h m a e are quasi continuous functions in f 4 in these works there always existed an exceptional set n fukushima and menda 7 showed that if the transition function of m satisfies an absolute continuity condi tion i e pt x m 2 5 for all t 0 and x d and g h satisfy the following separability condition there exist finite excessive functions v 1 v 2 f such that for all x d g x v 1 x v 2 x h x 2 6 then zabczyk s result still holds and there does not exist the exceptional set n in what follows we shall introduce a version of theorem 2 in 7 where we used f 1 f 2 in places of g h respectively for the convenience of later use let f 1 f 2 f be finely continuous functions such that for all x d f 1 x f 2 x f 1 x x f 2 x x 2 7 where are some finite excessive functions and f 1 f 2 are assumed to satisfy the following separability condition f 1 x v 1 x v 2 x f 2 x 2 8 we further define the set k u f f 1 u f 2 m a e 2 9 considering the variational inequality problem v k e v u v 0 u k 2 10 we have theorem 2 1 assume conditions 2 5 2 7 and 2 8 there exists a fi nite finely continuous function v satisfying the variational inequality 2 10 and the identity v x sup inf jx inf sup jx x d where range over all stopping times and jx ex e i f 1 x i f 2 x 2 11 moreover the pair defined by inf t 0 v xt f 2 xt inf t 0 v xt f 1 xt is the saddle point of the game in the sense that jx jx jx x d for all stopping times for a given functionh l 2 d m one looks for a solution v k to the following variational inequality problem e v u v h u v u k 2 12 5 then we have the following proposition proposition 2 2 there exists a unique finite finely continuous function v k which solves 2 12 proof the proof is essentially identical to the proof of proposition 2 1 in 6 and is omitted here we assume further the following separability condition assumption 2 1 there exist finite excessive functions v 1 v 2 f such that for all x d f 1 x g h x v 1 x v 2 x f 2 x g h x 2 13 then the following result holds theorem 2 3 for any function h l 2 d m and any f 1 f 2 f such that f 1 x g h x and f 2 x g h x are finely continuous and bounded by some finite excessive functions respectively assuming 2 5 2 13 we put jx ex 0 e th xt dt 2 14 ex e i f 1 x i f 2 x for any stopping times then the solution of 2 12 admits a finite finely contin uous value function of the game v x inf sup jx sup inf jx x d 2 15 furthermore if we let e 1 x d v x f 1 x e 2 x d v x f 2 x then the hitting times e 2 e 1 is the saddle point of the game jx jx jx 2 16 for any x d and any stopping times in particular v x jx x d 2 17 e 1 is the set of points where v f 1 and e 2 is the set of points where v f 2 so and in theorem 2 3 can be defined in the same way as in theorem 2 1 the proof of theorem 2 3 is identical to theorem 2 1 in 6 3 the dynkin game and its value function two players p 1 and p 2 observe a multi dimensional underlying process xt in 1 1 with accumulated income discounted at present time equalling 0 e th xt dt for any stopping time if p 1 stops the game at time he pays p 2 the amount of the accumulated income plus the amount f 2 x which after been discounted equals e f 2 x if the process is stopped by p 2 at time he receives from p 1 the accumulated income less the amount f 1 x which after been discounted equals e f 1 x p 1 tries to minimize his payment while p 2 tries to maximize his income let be two stopping times the value of this game is thus given by v x inf sup jx x r n 3 1 6 where jx is given by 2 14 on r n for the diffusion 1 1 define its infinitesimal generator l as l n i 1 i xi n i j 1 aij 2 xi xj 3 2 where aij a 1 2 t we assume that a is non degenerate define the measure m dx x dx where x satisfies the following condition a b 3 3 where bi ai i 1 2 n in b notice that when and a are constants x reduces to x exp a 1 x it can be seen that the absolute continuity condition 2 5 is satisfied remark 3 1 we are unable to solve the case with a general multidimensional diffusion even in the case of one dimensional diffusion conditions on and should be made see appendix for the generator l its associated dirichlet form e f densely embedded in l 2 rn m is then given by e u v rn u x a v x m dx u v f 3 4 where f u l 2 rn m u is continuous rn u x t u x m dx for given functionsh f 1 f 2 satisfying the conditions of theorem 2 3 and noticing that xt is a non degenerate ito diffusion we can conclude that v x in eq 3 1 is finite and continuous and it solves 2 12 furthermore if we let e 1 x r n v x f 1 x e 2 x r n v x f 2 x 3 5 then the hitting times e 2 e 1 is the saddle point of the game jx jx v x jx 3 6 for any x rn and any stopping times in the next section we shall give conditions on h f 1 f 2 and characterize the regularities of v x and the form of the optimal control policy 3 1 optimal stopping regions in the one dimensional case if the functions are defined over a bounded interval a lot of properties are automatically satisfied 6 but in multi dimensional case this is much harder it is obvious that the conditions on h f 1 f 2 are critical on the form of optimal control policy for example if h 0 and f 1 x 0 f 2 x x then no party would ever stop the game and there is no optimal control assumption 3 1 f 1 f 2 f are smooth functions m f 1 x 0 f 2 x m x r n where m is a constant and h l 2 rn m is everywhere continuous and the separability condition 2 13 holds h x xn is strictly increasing in xn f 1 x xn is nondecreasing in xn f 2 x xn is nonincreasing in xn further 7 more l f 1 x xn h x xn is strictly increasing in xn and l f 2 x xn h x xn is strictly decreasing in xn the hyper curves a x b x such that l f 1 x a x h x a x 0 l f 2 x b x h x b x 0 with a x b x x rn 1 are assumed to be bounded and uniformly lipschitz continuous then it is easy to see that proposition 3 1 assume assumption 3 1 for any x xn with xn a x l f 1 x xn h x xn 0 and for any x xn with xn a x l f 1 x xn h x xn 0 similarly for any x xn with xn b x l f 2 x xn h x xn 0 and for any x xn with xn b x l f 2 x xn h x xn 0 define the set e x rn f 1 x v x f 2 x 3 7 since p 2 would stop the game once v x f 1 x and the instant payoff is f 1 x while p 1 would stop the game once v x f 2 x and the instant payoff is f 2 x we could write rn as a partition r n e 1 e e 2 where e 1 e 2 were given in 3 5 proposition 3 2 assume assumption 3 1 for each x e 1 l f 1 x h x 0 and for each x e 2 l f 2 x h x 0 proof we only give proof to the first half we know at the point x e 1 it must be true that v x f 1 x and it is optimal for p 2 to stop the game immediately suppose l f 1 x h x 0 x e 1 then by the smoothness of f 1 and the continuity of h we can find a small ball br x containing the point x such that for each y br x l f 1 y h y 0 8 consider a policy for p 2 to stop the game at the first exit time of br x denoted br then by dynkin s formula the payoff would be jx ex br 0 e th xt dt ex e br f 1 x br ex br 0 e th xt dt f 1 x ex br 0 e t l f 1 xt dt f 1 x ex br 0 e t l f 1 xt h xt dt f 1 x this is a contradiction since p 2 tries to maximize his payoff but we assumed that the optimal policy at x was to stop the game immediately corollary 3 3 assume assumption 3 1 if x x xn e 1 then for any point x y with y xn l f 1 x y h x y 0 if x x xn e 2 then for any point x y with y xn l f 2 x y h x y 0 furthermore e 1 r n 1 a and e 2 r n 1 b proof this can be easily seen from proposition 3 2 and the conditions on f 1 f 2 h given in assumption 3 1 further noticing the conditions on the curves a x and b x x rn 1 we have the following corollary 3 4 assume assumption 3 1 e rn 1 a b and hence e is not empty furthermore the value of this game v is bounded by m where m is given in assumption 3 1 take any point x x xn e 1 and denote a the hitting time to the curve a notice that the diffusion 1 1 is a conservative process by the given conditions and also by noticing the conditions given on a it can be concluded that ex e a goes to zero as xn goes to similarly ex e b x x xn e 2 goes to zero as xn goes to assumption 3 2 there exist functions a x b x x rn 1 that are uniformly bounded and such that for any x rn 1 a ex a 0 e th xt dt e am f 1 x and for any x rn 1 b ex b 0 e th xt dt e bm f 2 x proposition 3 5 assume assumptions 3 1 and 3 2 then a x a x and b x b x x rn 1 furthermore on rn 1 a player p 2 would stop the game immediately and v f 1 and on r n 1 b player p 1 would stop the game immediately and v f 2 9 proof suppose there is a point x x xn with a x xn a x then by dynkin s formula ex a t 0 e th xt dt e a t m ex a t 0 e th xt dt e a t f 1 x a t f 1 x ex a t 0 e t l f 1 xt h xt dt f 1 x by proposition 3 1 taking t we get a contradiction now suppose x rn 1 a for any stopping time for player p 2 the payoff will be ex 0 e th xt dt ex e f 1 x ex 0 e th xt dt ex e f 1 x px a ex 0 e th xt dt ex e f 1 x px a when a the following quantity ex t a 0 e th xt dt ex e t a f 1 x t a f 1 x ex t a 0 e t l f 1 xt h xt dt is less than f 1 x t 0 by proposition 3 1 when a ex 0 e th xt dt ex e f 1 x ex a 0 e th xt dt e am because m is the bound of the payoff of each player hence by assumption 3 2 ex 0 e th xt dt ex e f 1 x f 1 x as a summary if x rn 1 a then for any stopping policy of p 2 the expected payoff is less than f 1 x and the optimal strategy is to stop the game immediately the other half of this proposition can be proved in a similar way by the properties of a or b we can choose a bounded and continuous curve below a or a bounded and continuous curve above b which also has the properties as given in assumption 3 2 without loss of generality we assume a and b are bounded and continuous 10 now it is easy to see that rn 1 a e 1 and r n 1 b e 2 since the functions v f 1 f 2 are all continuous the boundary of e consists of continuous curves let e 1 be the largest connected region in e 1 containing the set r n 1 a and e 2 be the largest connected region in e 2 containing the set r n 1 b then obviously v x f 1 x x e 1 and v x f 2 x x e 2 furthermore e 1 has a continuous boundary curve a that is bounded by a and a e 2 has a continuous boundary curve b that is bounded by b and b proposition 3 6 e 1 e 2 are simply connected regions proof it suffices to prove that e 1 is simply connected suppose there is a point x 0 such that v x 0 f 1 x 0 and the boundary dx 0 of the largest connected region containing x 0 as well as the points x with v x f 1 x belongs to e 1 i e dx 0 e 1 then for any x dx 0 v x f 1 x and for any x dx 0 l f 1 x h x 0 consider any stopping strategy for player p 2 with the reward ex 0 0 e th xt dt e f 1 x f 1 x 0 ex 0 0 e t l f 1 xt h xt dt f 1 x 0 3 8 since dx 0 a s where dx 0 is the first hitting time to dx 0 and on dx 0 it is known that the game should be stopped by p 2 with the payoff f 1 but this is a contradiction since we have assumed that v x 0 f 1 x 0 therefore there is no hole in e 1 proposition 3 7 if there is any point x xn with xn a x such that v x xn f 1 x xn then the connected region containing this point with v f 1 is connected to the region rn 1 a b a similar result holds on the curve b proof suppose not then the boundary of the connected region containing x xn with v f 1 is contained in r n 1 a for any stopping strategy for player p 2 the process is stopped before it hits the curve a the expected payoff is less than or equal to f 1 x xn because in this region l f 1 h 0 and this contradicts the assumption v x xn f 1 x xn now it is clear that the region e is connected recall that e 1 e 2 are the first hitting times to the sets e 1 e 2 respectively and they are finite a s we can rewrite v as v x ex 0 e th xt dt i e f 1 x i e f 2 x but at this point we still can not tell that e is simply connected let u be any connected region such that rn 1 a b u and u rn 1 a b define u the first exit time of this region then obviously u is finite a s define the function fu x ex u 0 e th xt dt e ur x u x u 3 9 where r x u f 1 x u if x u r n 1 a a and r x u f 2 x u if x u r n 1 b b 11 we put an assumption jointly on the process xt and the functions f 1 f 2 h con sider any point x 0 xn u with xn a x 0 define the cone c x 0 xn x y xn y a x y xn x x 0 y xn 2 where 0 1 is a constant construct the new connected region u u c x 0 xn and define the function f u similarly as in 3 9 assumption 3 3 for any point x 0 xn u with xn a x 0 fu x 0 xn fu x 0 xn similarly if we consider any point x 0 xn u with xn b x 0 we may define the cone c x 0 xn x y xn y b x xn y x x 0 y xn 2 where 0 1 is a constant construct the new connected region u u c x 0 xn and define the function f u similarly as in 3 9 then we put the following assumption assumption 3 4 for any point x 0 xn u with xn b x 0 fu x 0 xn fu x 0 xn remark 3 2 in the case of one dimensional diffusion assumptions 3 1 and 3 2 are sufficient to imply that e the continuation region is an interval but in the multidimensional case more conditions are needed to guarantee a regular property proposition 3 8 under assumptions 3 3 3 4 the continuation region e is simply connected furthermore the lower and upper boundaries of e in xn are uniformly lipschitz functions of x rn 1 proof we have shown that e is connected for any point x xn e with xn a x we consider the new continuation regione c x xn and have fe c x xn x xn v x xn by assumption 3 3 since in the region below the curve a only player p 2 wants to stop the game who wants to maximize his payoff the new continuation re gion e c x xn is certainly better than e if not identical and this is a contradiction since e is assumed to be optimal thus e c x xn e since this holds for any point x xn e with xn a x we know that the region in e below the curve a is simply connected and the lower boundary of e is uniformly lipshcitz continuous the second half is proved in a similar manner now we can claim that e 1 e 1 e 2 e 2 in what follows we shall still use a as the upper boundary in xn of the set e 1 also the lower boundary of e and b as the lower boundary in xn of the set e 2 also the upper boundary of e and they are uniformly lipschitz continuous and bounded curves we notice that the curve a in assumption 3 1 is not necessarily identical to the curve a and the curve b is not necessarily identical to the curve b either figure 3 1 illustrates the continuation region e in a two dimensional case 3 2 regularities of the value function proposition 3 9 assuming assumptions 3 1 3 2 3 3 and 3 4 if the curves a a x b b x are smooth then v is smooth on rn 1 a b and v x lv x h x x rn 1 a b 3 10 v x lv x h x x rn 1 a 3 11 v x lv x h x x rn 1 b 3 12 12 a b a b b a fig 3 1 the continuation region between two curves a t b t remark 3 3 it is still not clear under what conditions the free boundary curves are smooth but it is reasonable to believe that any condition on this should involve jointly the underlying process and all the reward functions of this problem proof we notice that v is h harmonic on rn 1 a b which by 5 implies the validation of the following equation e v u h u u c 1 1 0 r n 1 a b 3 13 the continuity of h implies that v is smooth on the same region and an integration by parts yields 3 10 on this region the rest of the proof follows from the fact that v x f 1 x x r n 1 a and v x f 2 x x b in what follows we will characterize the regularity of v on the boundary curves let uv denote the one sided directional derivative along a unit vector u r n defined in the following manner uv x lim 0 v x u v x by proposition 3 9 it can be seen that uv x is well defined at any point x in any direction u and uv x is continuous if x is not on the curves a or b then obviously uv x uv x the following proposition will characterize the property of uv x when x is on a or b proposition 3 10 assuming assumptions 3 1 3 2 3 3 and 3 4 if the curves a x b x are smooth then uv x a x uf 1 x a x uv x b x uf 2 x b x x r n 1 u rn proof step 1 pick any point x 0 a x 0 on the curve a and any unit vector u r n simi lar result can be derived for the curve b and construct a ball b x 0 a x 0 centered at this point with radius and such that for any point x xn 13 b x 0 a x 0 we have a x xn b x this can be easily done under as sumptions 3 1 and 3 2 also by the smoothness and lipschitz property of the curve a we can choose small so that all the points x 0 a x 0 u 0 are either on the curve a below the curve a or above the curve a in the first two cases since we have showed that v f 1 the result automat ically holds now we assume x 0 a x 0 u 0 are above the curve a then it has been shown that v x 0 a x 0 u f 1 x 0 a x 0 u hence uv x 0 a x 0 uf 1 x 0 a x 0 assume the equality does not hold then there is 0 such that uv x 0 a x 0 uf 1 x 0 a x 0 by the continuity of uv and the lipschitz property of a we can construct a cone cu containing u such that v cu the points x 0 a x 0 v 0 are above the curve a and vv x 0 a x 0 vf 1 x 0 a x 0 2 step 2 define a the first exit time from b x 0 a x 0 firstly by the fact that xt is uniformly elliptic we have e x 0 a x 0 a o where o is a small quantity satisfying lim 0 o 0 see e g 6 13 further we notice that 1 e x 0 a x 0 e a e x 0 a x 0 a 0 e tdt e x 0 a x 0 a o step 3 recall that player p 2 would stop the game at the point x 0 a x 0 immedi ately and the payoff is f 1 x 0 a x 0 consider the region b x 0 a x 0 it is shown that play p 1 would not stop the game in this region since a a where t is the shift operator we get a a where a a therefore by 3 6 f 1 x 0 a x 0 v x 0 a x 0 j x 0 a x 0 e x 0 a x 0 a 0 e th xt dt e x 0 a x 0 e a v x a 3 14 by assumption 3 1 it is obvious that h is bounded on b x 0 a x 0 i e there exists u 0 such that h x u x b x 0 a x 0 then we have 0 e x 0 a x 0 a 0 e th xt dt ue x 0 a x 0 a 0 e tdt u 1 e x 0 a x 0 e a o the other part e x 0 a x 0 e a v x a e x 0 a x 0 1 a o a v x a e x 0 a x 0 v x a e x 0 a x 0 a o a v x a since v is also bounded and e x 0 a x 0 a o we get e x 0 a x 0 e a v x a e x 0 a x 0 v x a o 14 step 4 by dynkin s formula e x 0 a x 0 f 1 x a f 1 x 0 a x 0 e x 0 a x 0 a 0 l f 1 xt dt since the function f 1 is bounded on b x 0 a x 0 and e x 0 a x 0 a o we get e x 0 a x 0 f 1 x a f 1 x 0 a x 0 o 3 15 on the other hand for each point y b x 0 a x 0 i e the boundary of b x 0 a x 0 and by the smoothness of f 1 f 1 y f 1 x 0 a x 0 v f 1 x 0 a x 0 o so e x 0 a x 0 f 1 x a f 1 x 0 a x 0 v f 1 x 0 a x 0 p x 0 a x 0 dy o 3 16 where p x 0 a x 0 dy is the probability density function of the exit distribu tion by comparing 3 15 with 3 16 we get v f 1 x 0 a x 0 p x 0 a x 0 dy o step 5 on the boundary of b x 0 a x 0 v y f 1 y since v is smooth a e v y v x 0 a x 0 vv x 0 a x 0 o and e x 0 a x 0 v x a 3 17 v x 0 a x 0 vv x 0 a x 0 p x 0 a x 0 dy o f 1 x 0 a x 0 vv x 0 a x 0 p x 0 a x 0 dy o f 1 x 0 a x 0 v f 1 x 0 a x 0 p x 0 a x 0 dy cu b x 0 a x 0 2 p x 0 a x 0 dy o in view of the conclusion of step 1 and cu b x 0 a x 0 is the part of b x 0 a x 0 in the cone cu substitute in 3 14 the results from steps 3 and 4 we get f 1 x 0 a x 0 v x 0 a x 0 f 1 x 0 a x 0 cu b x 0 a x 0 2 p x 0 a x 0 dy o since xt is uniformly elliptic cu b x 0 a x 0 p x 0 a x 0 dy as 0 where 0 1 is a constant by choosing small we get f 1 x 0 a x 0 v x 0 a x 0 f 1 x 0 a x 0 4 o 3 18 if is sufficiently small the part 4 o 0 and we get a contradiction 15 now the proof is complete as a summary we have the following theorem theorem 3 11 assuming assumptions 3 1 3 2 3 3 and 3 4 if the curves a x b x are smooth then f 1 x v x f 2 x x r n 1 a b v x f 1 x x r n 1 a v x f 2 x x r n 1 b uv x a x uf 1 x a x uv x b x uf 2 x b x x r n 1 where u is any directional vector furthermore v is c 1 1 1 on rn c 2 2 on rn 1 a b rn 1 a rn 1 b and v x lv x h x x rn 1 a b v x lv x h x x rn 1 a v x lv x h x x rn 1 b where l is given in 3 2 4 the multi dimensional stochastic singular control problem define h x w x x rn as follows h x y y a x h x u du c x 4 1 w x y y a x v x u du x rn 1 y r 4 2 where c x is a function of x such that lim y a x w x y lw x y h x y 0 then h x y and w x y satisfy the following theorem 4 1 assuming assumptions 3 1 3 2 3 3 and 3 4 if the curves a x b x are smooth then w is c 2 2 on rn and w x lw x h x x rn 1 a b w x lw x h x x rn 1 a rn 1 b f 1 x xn w x f 2 x x r n 1 a b xn w x f 1 x x r n 1 a xn w x f 2 x x r n 1 b and 2 xn xk w x a x f 1 xk x a x 2 xn xk w x b x f 2 xk x b x x rn 1 1 k n 16 we first need a lemma lemma 4 2 assuming assumptions 3 1 3 2 3 3 and 3 4 and that the curves a x b x being smooth the function w x lw x is continuous proof this result obviously holds for x rn 1 a rn 1 a b rn 1 b on the curves a x and b x w is twice continuously differentiable along the xn direction by 4 2 the only term that seems not to be continuous in this function is lw x which involves the first and second derivative with respect to each variable denote xkw the directional derivative along xk 1 k n 1 then by 4 2 we have the following xkw x y y a x xkv x u du v x a x xk a x notice that v is c 1 1 1 on rn so xkw x y xkw x is continuous in x now consider 2 w x 2 k x y y a x 2 v x 2 k x u du 2 xkv x a x xk a x xnv x a x xk a x 2 v x a x 2 a x 2 k x because the two curves a x and b x have zero lebesgue measure and the functions xkv xk a and 2 a x 2 k are all continuous we conclude that 2 w x 2 k is continuous 1 k n 1 the continuity of 2 w xi xj i 6 j can be proved in a similar manner combined with previous argument that 2 w x 2 n is continuous this lemma is proved remark 4 1 since l w is continuous and the functions v and h are continuous too we know that the function h x in 4 1 is continuous hence the continuity of c x in 4 1 proof proof of theorem 4 1 for fixed x consider the function u y w x y lw x y h x y with u y v x y lv x y h x y and we know u a x 0 notice that u y 0 for a x y b x u y 0 for y a x u y 0 for y b x and by lemma 4 2 the function u y is continuous it can be seen that w x y lw x y h x y for y a x or y b x the rest of the proof is obvious the result of theorem 4 1 gives conditions to the solution of the stochastic sin gular control problem 1 2 and 1 3 see e g 20 where the holding cost h is given in 4 1 and the boundary penalty costs f 1 f 2 are given in assumption 3 1 we call a quadruplet s s xt a 1 t a 2 t s a 1 t a 2 t for simplicity admissible policy if the following conditions are satisfied assumption 4 1 17 1 s is a compact region given in the form rn 1 where x x are continuous functions of x rn 1 with x x 2 there is a filtered measurable space ft t 0 subject to usual conditions and a probability measure px x s on it such that xt t 0 is an ft adapted process and a 1 t a 2 t t 0 are ft adapted right continuous processes with bounded variation such that ex 0 e tda 1 t ex 0 e tda 2 t x s 4 3 and a 1 t a 2 t is the minimal decomposition of a bounded variation process into a difference of two increasing processes 3 there are ft adapted independent brownian motions b 1 t bmt m n starting at the origin under px for any x s such that the following controlled diffusion xt x 1 t xnt dx 1 t 1 dt 11 db 1 t 1 mdbmt 4 4 dxnt ndt n 1 db 1 t nmdbmt da 1 t da 2 t x 0 x holds px a s x s furthermore we assume px xt s t 0 1 x s remark 4 2 the probability space with the filtration ft is not fixed a priori it is part of an admissible policy the filtration ft is assumed to be right continuous and f 0 is assumed to contain every px negligible set for any x s proposition 4 3 both a 1 t and a 2 t are nontrivial in the sense that for any t 0 px a i t a i 0 t 0 t 0 x s i 1 2 proof if both a 1 t and a 2 t are trivial xt will hit every open region of positive lebesgue measure in rn with positive probability but this is a contradiction since xt is concentrated on s if either a 1 t or a 2 t is trivial xt can not be concentrated on s which again is a contradiction define the following notations a i t a i t a i t t 0 i 1 2 xt xt xt t 0 w xt w xt w xt t 0 then due to the fact that a 1 t a 2 t are the minimal decomposition of a bounded variation process into a difference of two increasing processes a 1 t a 2 t 0 t 0 by convention we let b 1 t bnt 0 a 1 t a 2 t 0 t 0 18 so that a i 0 a i 0 i 1 2 x 0 x px a s x s notice that the integrals in 4 3 involve the possible jumps at time 0 so that they are the sum of the integrals over 0 as well as a i 0 i 1 2 in particular the jump only happens to the xn coordinate in what follows we use a i c t i 1 2 to denote the continuous part of the processes a i t i 1 2 theorem 4 4 assuming assumptions 3 1 3 2 3 3 3 4 4 1 and that the curves a x b x being smooth let ks x be given by the following ks x ex 0 e th xt dt 4 5 ex 0 e t f 1 xt da 1 c t f 2 xt da 2 c t ex 0 t e t x nt a 1 t x nt f 1 xt dy x nt x nt a 2 t f 2 xt dy then 1 for any admissible policy s w x ks x x r n 2 w x ks x x r n if and only if s rn 1 a b where a x b x are given in theorem 4 1 the process xt is the reflecting diffusion on s and s a 1 t a 2 t where a 1 t increases only when xt is on the boundary x a x and a 2 t increases only when xt is on the boundary x b x x rn 1 remark 4 3 the cost function consists of several parts the first integral in 4 5 is the holding cost the second integral is a control cost associated with the increment of controls a i t i 1 2 in the continuous part the last integral is a control cost associated with the jumps in a i t i 1 2 or equivalently jumps in xt we further extend ks x outside the region r n 1 for two continuous functions x x x rn 1 as the following ks x ks x x x xn f 1 x u du x x xn r n 1 4 6 ks x ks x x xn x f 2 x u du x x xn r n 1 4 7 and we are looking for an admissible control s such that w x inf s s ks x x r n 4 8 where s is the set of all admissible control policies proof proof of theorem 4 4 19 1 consider the diffusion given in 4 4 with x s applying the generalized ito formula to e tw xt see 11 yields e tw xt w x t 0 e sw xs ds t 0 e slw xs ds t 0 e s w xs xs dbs 4 9 t 0 e s xn w xs da 1 c s da 2 c s 0 s t e s w xs using the following identity w x 0 s t e s w xs w x 0 0 s t e s w xs and taking expectation of both sides of 4 9 with respect to px and let t we get the following w x ex 0 e t l w xt dt 4 10 ex 0 e t xn w xt da 1 c t da 2 c t ex 0 t e t w xt therefore ks x w x 4 11 ex 0 e t h xt l w xt dt ex 0 e t f 1 xt xn w xt da 1 c t ex 0 e t f 2 xt xn w xt da 2 c t ex 0 t e t w xt ex 0 t e t x nt a 1 t x nt f 1 xt dy x nt x nt a 2 t f 2 xt dy by theorem 4 1 the first three integrands in 4 11 are all nonnegative for the process xt staying in the region s define the sets t 0 a 1 t 0 t 0 a 2 t 0 20 then rewrite the last two expectations of 4 11 as ex t e t x nt a 1 t x nt xn w xt f 1 xt dy ex t e t x nt x nt a 2 t xn w xt f 2 xt dy by theorem 4 1 this quantity is nonnegative and this shows ks x w x x s due to the extension 4 6 we proved ks x w x x r n 2 if s rn 1 a b and the process xt is the reflecting diffusion on s then by theorem 4 1 the first integral in 4 11 is obviously zero as to the second and third integrals in 4 11 because da 1 t da 2 t are zero whenever xt is in rn 1 a b while at the boundary where a 1 t a 2 t increases the integrands are zero these two integrals are zero too the last two expectations are also zero due to this construction hence w x ks x x s on the other hand supposew x ks x x s then all the expectations in 4 11 must be zero assume s rn 1 and at least one of the inequalities is true x 6 g 1 x x 6 g 2 x then due to the continuity of these four functions we know that the sum of the first three integrals in 4 11 is positive by theorem 4 1 and because the sum of the last two expectations in 4 11 is nonnegative it can be seen thatw x ks x therefore in order to have w x ks x s must be the region r n 1 a b again by theorem 4 1 we see that the processes xt and a i t i 1 2 must all be continuous in order to eliminate the last two expectations in 4 11 which implies a i t a i c t i 1 2 when x a x x b x therefore xt a 1 t a 2 t must be the reflecting diffusion on r n 1 a b remark 4 4 the possible jumps a i t i 1 2 only happen at time zero when the process xt starts at a point outside the region r n 1 a b the control brings it back to this region immediately and after that the process will be a continuous reflected diffusion the confirmation of the last assertion is shown below if we let 0 0 0 1 t then the reflected diffusion can be written as dxt xt dt xt dbt da 1 t da 2 t t 0 4 12 where a 1 t increases only at the boundary a and a 2 t increases only at the boundary b we notice that the reflection only happens to the last component of the process since the two curves a and b are smooth and uniformly lipschitz if we let n x be the inward normal for x at the boundary then we can show that there exist positive constants 1 2 such that x x a x n x 1 x x b x n x 2 by a localization technique and theorem 4 3 in 15 it can be shown that there exists a solution xt a 1 t a 2 t to the reflected diffusion 4 12 this problem is called the skorohod problem 21 concluding remarks in this paper we studied a multi dimensional stochastic singular control problem via dynkin game and dirichlet form the value function of the dynkin game satisfies a variational inequality problem and the integrated form of this value function turns out to be the value function of the singular control problem by characterizing the regularities of the value function of the dynkin game and its integrated version we showed the existence of a classical solution to the hamilton jacobi bellman equation associated with this multi dimensional singular control problem and this kind of problems were traditionally solved through viscosity solutions we also proved that under some conditions the optimal control policy is given by two curves and the controlled process is the reflected diffusion between these two curves unlike the one dimensional singular control problem where under some conditions the boundary of the optimal continuation region are given by two points 6 it is much more difficult to characterize the boundaries of the continuation region in the multi dimensional singular control problem this paper investigates some conditions on the regularity of value function and the form of optimal singular control policies of multi dimensional diffusion and it provides a basis for the search of further conditions and further regularities in this realm appendix in this appendix we shall correct an error found in the paper 6 in the paper dynkin games via dirichlet forms and singular control of one dimensional diffusion 6 the authors tried to show the existences of a smooth value function and an optimal policy to a one dimensional stochastic singular control prob lem via dynkin game and dirichlet form the value function v x of a dynkin game is known to exist 22 which is the solution of a variational inequality problem in volving dirichlet form the integration of v x turns out to be a smooth optimal return function w x for a stochastic singular control problem thus the traditional technique of viscosity solution is avoided in their paper the underlying process is a generalized one dimensional diffusion process given by dxt xt dt xt dwt in which wt is a wiener process it is found that a different diffusion process should be considered in the proofs and as a result the main theorem of this paper should be amended in their paper the infinitesimal generator is defined as see page 693 eq 4 1 in 6 lu x d dm d ds u x x u x 1 2 x 2 u x 4 13 where ds x s x dx dm x m x dx and see eq 4 2 in 6 s x exp x 0 2 y y 2 dy m x 2 x 2 exp x 0 2 y y 2 dy 4 14 the value function w x of the stochastic singular control problem is assumed to satisfy the following pde see eq 3 23 on page 693 in 6 w x d dm d ds w x h x 4 15 or equivalently w x x w x 1 2 x 2 w x h x 4 16 22 where see eq 3 21 and eq 3 22 in 6 h x x 0 h y s y dy c 4 17 and w x x a v y s y dy 1 f 1 a m a h a 4 18 then in the proof of theorem 3 2 on page 693 in 6 the authors constructed the function u x w x d dm d ds w x h x 4 19 and claimed that 1 s x u x v x d ds d dm v x h x 4 20 this is equivalent to u x w x x w x 1 2 x 2 w x h x 4 21 and 1 s x u x v x x v x 1 2 x 2 v x h x 4 22 however by a careful examination it can be seen that the above proposition is not true in general the reason here is that x and x are both functions of x and when taking the derivative of u x the product rule has to be applied the details are shown below by the definition of w x in 4 18 h x in 4 17 and s x in 4 14 in 6 we get w x v x s x h x h x s x s x s x 2 x x 2 hence w x v x s x v x s x 2 x x 2 w x v x s x 2 v x s x 2 x x 2 v x s 4 x 2 x 4 v x s x 2 x x 2 4 x x 3 x now if we take the derivative of u x in 4 21 we get u x v x s x x v x s x x v x s x x v x s x 2 x x 2 23 x x v x s x x x v x s x 2 x x 2 1 2 x 2 v x s x 2 v x s x 2 x x 2 v x s 4 x 2 x 4 v x s x 2 x x 2 4 x x 3 x h x s x after simplifying this expression and comparing it with 4 22 we should have the following 0 x x v x 2 x v x 4 23 which does not hold in general the following condition should be added to make it hold 2 x x x 4 24 a second concern of this paper might be more profound the dirichlet form in this paper is defined as see eq 3 3 on page 686 in 6 e u v a a u x v x 1 m x dx u v f 4 25 where f h 1 a a dx u l 2 a a dx u is absolutely continuous u l 2 a a dx the authors claimed that this dirichlet form e f is regular on l 2 a a ds and the associated underlying process is a reflecting barrier diffusion on a a with infinitesimal generator d ds d dm i e the generator l given in 4 13 the correspondence is given by see corollary 1 3 1 on page 21 of 5 e u v lu v u d l v f 4 26 where d l is the domain of l since the underlying process is a reflecting barrier diffusion on a a d l is given by see page 22 of 5 d l u f u is absolutely continuous u l 2 a a dx u a u a 0 now we try the integration by parts on 4 25 and get e u v a a u x v x x 2 2 exp x 0 2 y y 2 dy dx a a x 2 2 u x x x u x x u x v x exp x 0 2 y y 2 dy dx once again when the condition 4 24 holds we get x 2 2 u x x x u x x u x x 2 2 u x x u x lu x 24 and 4 26 holds as a conclusion if the condition 4 24 is added then all the results in that paper still hold but for a very particular ito diffusion in the following we give another way to amend the results of that paper which makes the theorems more general if we just simply consider the diffusion dxt xt dt xt dwt 4 27 where x x x x and define the infinitesimal generator l u x x u x 1 2 x 2 u x while the dirichlet form is still defined as in 4 25 and s x m x are still given in 4 14 then we get e u v l u v that means the underlying process associated with the dirichlet form 4 25 should be 4 27 with this in mind we can examine again the results of that paper 6 results in section 2 are classical on variational inequalities and optimal stopping in section 3 the part d ds d dm whenever it appears before theorem 3 2 should be replace by l let the functions h x w x still be defined as in eqn 3 21 3 22 in that paper respectively then theorem 3 2 holds intact but in the proof of this theorem after setting u x w x d dm d ds w x h x w x x w x 1 2 x 2 w x h x and taking the derivative of both sides we should get 1 s x u x v x x x x v x 1 2 x 2 v x h x v x l v x h x since theorem 3 1 has been amended the rest of the proof of theorem 3 2 just follows section 4 of that paper is about a verification theorem and the results there still hold it might be interesting to notice that when is a constant we get x x and e u v a a u x v x 2 2 exp x 0 2 y 2 dy dx 4 28 acknowledgments in memory of dr michael taksar references 25 1 f m baldursson and i karatzas irreversible investment and industry equilibrium finance and stochastics 1 1997 pp 69 89 2 b bassan and c ceci optimal stopping problems with discontinous reward regularity of the value function and viscosity solutions stochastics and stochastics reports 72 1 2 2002 pp 55 77 3 e bayraktar and m s rbu stochastic perron s method and verification without smoothness using viscosity comparison the linear case proc amer math soc 140 10 2012 pp 3645 3654 4 w h fleming and h m soner controlled markov processes and viscosity solutions springer 2 nd edition 2006 5 m fukushima y oshima and m takeda dirichlet forms and symmetric markov processes 2 nd edn walter de gruyter berlin new york 2011 6 m fukushima and m taksar dynkin games via dirichlet forms and singular control of one dimensional diffusion siam j control optim 41 3 2002 pp 682 699 7 m fukushima and k menda refined solutions of optimal stopping games for symmetric markov processes technology reports of kansai university 48 2006 pp 101 110 8 p v gapeev and h r lerche on the structure of discounted optimal stopping problems for one dimensional diffusions stochastics 83 4 6 2011 pp 537 554 9 x guo and p tomecek connections between singular control and optimal switching siam j control optim 47 1 2008 pp 421 443 10 x guo and p tomecek a class of singular control problems and the smooth fit principle siam j control optim 47 6 2009 pp 3076 3099 11 m harrison and m taksar instantaneous control of brownian motion math oper res 8 1983 pp 439 453 12 i karatzas and s e shreve connections between optimal stopping and singular stochastic control ii reflected follower problems siam j control optim 23 3 1985 pp 433 451 13 i karatzas and s e shreve brownian motion and stochastic calculus 2 nd ed springer 1991 14 i karatzas and i m zamfirescu game approach to the optimal stopping problem stochastics 77 5 2005 pp 401 435 15 p l lions and a s sznitman stochastic differential equations with reflecting boundary con ditions communications on pure and applied mathematics vol xxxvii 1984 pp 511 537 16 j ma on the principle of smooth fit for a class of singular stochastic control problems for diffusions siam j control optim 30 4 1992 pp 975 999 17 h nagai on an optimal stopping problem and a variational inequality j math soc japan 30 1978 pp 303 312 18 h pham on the smooth fit property for one dimensional optimal switching problem in s eminaire de probabilit es xl lecture notes in math 1899 springer berlin 2007 pp 187 199 19 h m soner and s e shreve regularity of the value function for a two dimensional singular stochastic control problem siam j control and optimization 27 4 1989 pp 876 907 20 m taksar average optimal singular control and a related stopping problem math oper res 10 1985 pp 63 81 21 m i taksar skorohod problems with nonsmooth boundary conditions journal of computa tional and applied mathematics 40 1992 pp 233 251 22 j zabczyk stopping games for symmetric markov processes probab math statist 4 2 1984 pp 185 196 26