1 synchronization of frequency modulated multi agent systems zhiyong chen abstract oscillation synchronization phenomenon is widely observed in natural systems through frequency modulated signals especially in bio logical neural networks frequency modulation is also one of most widely used technologies in engineering however due to the technical difficulty oscillations are always simplified as unmodulated sinusoidal like waves in studying the synchronization mechanism in the bulky literature over the decades it lacks mathematical principles especially systems and control theories for frequency modulated multi agent systems this paper aims to bring a new formulation of synchronization of frequency modulated multi agent systems it develops new tools to solve the synchronization problem by addressing three issues including frequency observation in nonlinear frequency modulated oscillators subject to network influence frequency consensus via network interaction subject to observation error and a well placed small gain condition among them the architecture of the paper consists of a novel problem formulation rigorous theoretical development and numerical verification index terms multi agent systems oscillators synchronization fre quency modulation networked systems i introduction frequency modulated signals extensively exist in natural network systems such as neural circuits neuroscientists are interested in modeling nervous systems from simple neural networks to even the human brain one of the basic areas is to study the neural network models for rhythmic body movements during animal locomotion such spinal neural networks are called central pattern generators cpgs that as oscillator circuits can generate coordinated signals for rhythmic body movements it has been well understood that most neurons use action potentials aps brief and uniform pulses of electrical activity to transmit information the strength at which an innervated muscle is flexed depends solely on the firing rate the average number of aps per unit time a rate code 1 in other words the transmitted signals are frequency modulated for example the frequency modulated signals recorded in a real cpg network are shown in fig 1 for the dorsal ventral swimmer tritonia a genus of sea slugs fig 1 a real frequency modulated cpg model the neural circuit and swim motor patters for the dorsal ventral swimmer tritonia left the tritonia swim cpg consists of three neuron types dsi c 2 and vsi right simultaneous intracellular micro electrode recordings show that two contralateral dsis fire bursts of aps in phase with each other and slightly ahead of the two c 2 s vsi not recorded here fires aps in the inter burst interval courtesy of pnas 2 the author is with the school of engineering the university of newcastle callaghan nsw 2308 australia tel 61 2 4921 6352 fax 61 2 4921 6993 email zhiyong chen newcastle edu au frequency modulation fm is also one of most widely used technologies in engineering the conventional fm is the encoding of information in a carrier wave by varying the instantaneous frequency of the wave it has a long history with applications in telecom munications radio broadcasting signal processing and computing 3 4 5 for instance in radio transmission fm compared with an equal power amplitude modulation signal has the advantage of a larger signal to noise ratio and therefore rejects radio frequency interference inspired by the aforementioned biological cpgs discov ered in animal locomotion engineers have applied artificial cpgs as oscillator circuits in robotics 6 7 8 such artificial cpgs can generate frequency modulated signals resembling the firing bursts of aps to control robotic locomotion however it lacks mathematical principles especially systems and control theories for frequency modulated multi agent systems a multi agent system mas refers to a group of multiple dynamic entities called agents that share information or tasks to accomplish a common objective the agents in an mas can be circuits au tonomous vehicles robots power plants in electrical grid and other dynamic entities a cpg network in its dynamic formulation is a typical mas where each ganglion circuit group of neurons is re garded as an agent and they generate patterned signals through inter agent coordination in real biological cpgs the signals of burst firing are frequency modulated 9 10 11 however the mathematical principles for such cpgs have yet to be studied in terms of their coordinated behaviors the research was mainly conducted based simplified unmodulated cpg models for example the signals of burst firing are approximately represented by unmodulated sinusoidal like waves when the adaptivity property of cpg circuits was studied for hirudo verbena a species of leech such an unmodulated leech cpg model was used in 12 13 and many other references to significantly reduce model complexity as there exists no systems and control theory for frequency modulated mass over the past two decades abundant researchers have extensively studied mass and achieved numerous outcomes across the disci plines of biology statistical physics computer sciences sociology management sciences and systems and control engineering they have established many systems and control theories and engineer ing tools for various engineering tasks formulated as consensus rendezvous swarm flocking formation etc the early work on control of mass focused on the so called consensus problem where a networked set of agents intends to merge to a common state see e g 14 15 16 for simple linear homogenous mass a major technical question was to understand the influence of network topology on collaborative behaviors the research has been widely extended to deal with more general homogeneous mass in literature e g 17 18 19 for continuous time systems and 20 21 22 23 for discrete time systems this line of research has also quickly spread to many other related problems such as synchronization formation flocking swarming and rendezvous 24 25 26 it is well known that the collective property in particular consensus is closely related to the eigenvalue distributions of the so called laplacian matrix which in turn is crucially influenced by the network topology it is fair to say that the existing control strategies for analysis and control of linear ho mogeneous mass are mature using basic laplacian matrix properties ar x iv 2 10 8 06 71 9 v 1 m at h o c 1 5 a ug 2 02 1 2 in graph theory the mature solutions to various control problems for homogenous mass rely on the prerequisite that all the agents share share common dynamics so they mainly focus on trajectory synchronization in the recent decade researchers have put more efforts on synchro nization of complicated heterogeneous mass where the major challenge arises from the lack of common dynamics to deal with this challenge the work in 27 28 assumes a common virtual exosystem that defines a trajectory on which all agents synchronize to researchers also studied the problem using different concepts of homogenization in e g 29 30 some other relevant techniques can be found in 31 32 etc when researchers turned to nonlinear mass they first applied the linear techniques to deal with nonlinearities under certain constraints on the growth rates such as a globally lipschitz like condition see e g 33 34 the early research on nonlinear collective dynamic behaviors was also found on synchronization of simply coupled nonlinear systems the complexity is not from network but individual nonlinear characteristics typical examples include synchronization of master slave chaotic systems 35 kuramoto models 36 and coupled harmonic oscillators 37 etc synchronization of general nonlinear heterogeneous mass is the state of the art of this field this problem was studied in 38 39 40 using a generalized output regulation framework where the agents converge to various design of specified reference models in a leader following setting the problem was formulated as a coopera tive output regulation problem in e g 41 where agents achieve synchronization on a trajectory that is assigned by one or more leaders when the leader s system dynamics are unknown to some agents adaptive schemes were developed in e g 42 43 44 these design approaches for heterogeneous mass can be illustrated as reference consensus agent reference regulation where the synchronized behavior is determined by the specified reference model dynamics called virtual exosystem exosystem homogeneous model internal model reference model or leader etc rather than inherent agent dynamics on the contrary to adopt inherent agent dynamics rather than the specified common dynamics people studied the so called dynamics consensus synchronization problem as the prerequisite for trajectory synchronization for example the authors of 45 46 proposed the concept of emergent dynamics which is an average of the units drifts an mas reaches dynamic consensus if the agents trajectories converge to the one generated by the emergent dynamics however synchronization errors exist in these works due to the heterogeneity between unit dynamics and emergent dynamics which may be diminished by increasing the interconnection gain the idea was also applied on andronov hopf oscillators 47 and stuart landau oscillators 48 a more recent result on dynamics synchronization was developed in 49 50 in a new formulation of autonomous synchronization the result ensures that both the synchronized agent dynamics and the synchronized states are not specified a priori but autonomously determined by the inherent properties and the initial states of agents in all the references discussed in the above survey of mass the final target of synchronization is on agent trajectories it can be achieved either through direct exchange of trajectory information via network homogeneous mass or indirectly through consen sus of specified or autonomous reference models plus regulation of agent trajectories to references heterogeneous mass a key stumbling block in generalizing the existing mas control techniques to frequency modulated mass is that the techniques require direct or indirect exchange and coordination of unmodulated values of agent trajectories in time domain however for frequency modulated mass the target is not determined by the instantaneous values of agent trajectories the main contribution of this paper is the first attempt to establish a framework for synchronization of frequency modulated mass there is rare systems and control theory analysis or controller synthesis available for frequency modulated mass the technical challenges lie in the fact that the frequency information is hidden from the instantaneous agent values observed or transmitted in a network analysis and control of frequency modulated mass relies on an effective distributed frequency demodulation theory which is still an open topic technically we will first develop a new method to construct a frequency observer of a nonlinear system especially subject to an external input representing synchronization error none of the existing observer design methods is applicable in this scenario moreover the gain from the external input to the observation error should be made arbitrarily small secondly we will design a frequency synchronization approach assuming the frequency observers work with appropriate observation errors as the two ac tions occur concurrently we will also ensure a deliberately formulated small gain condition the complete framework is established by an explicit controller architecture with rigorous mathematical proofs and demonstrated by numerical simulation the rest of the paper is organized as follows the problem of synchronization of a frequency modulated mas is formulated in section ii a frequency observer for a nonlinear frequency modulated oscillator subject to network influence is designed in section iii then a frequency consensus algorithm is established via network interaction subject to observation errors in section iv based on the techniques for frequency observation and frequency consensus and examination of a small gain condition the overall solution to the synchronization problem is proposed in section v the effectiveness of the approach is verified in section vi the paper is finally concluded in section vii ii problem formulation this paper is concerned about a network of frequency modulated oscillators or called agents of the following dynamics i s i b i i e i c x i f xi i fo xi i 1 n 1 where i rp is the state of the oscillator i the information to be transmitted over a network is e i modulated by a nonlinear carrier represented by the xi dynamics in particular the information e i is added on the top of the carrier s base frequency c to form the frequency i r of the carrier then the actual transmitted signal over the network becomes xi rq the matrices s b and e are constant of appropriate dimensions the vector functions f and fo are continuously differentiable and specified a priori in particular the function f satisfies f xi 6 0 for any xi 6 0 so that i is effectively encoded in the signal xi the objective is to design the input i to each agent such that the states achieve synchronization in the sense of lim t i t j t 0 i j 1 n 2 or equivalently in terms of the frequencies lim t i t j t 0 i j 1 n 3 the design of i relies on the received signals through a network associated with the network we define a graph g v e a where v 1 2 n indicates the vertex set e v v the edge 3 set and a rn n the associated adjacency matrix whose i j entry is aij for i j v aij 0 if and only if i j e and otherwise aij 0 the set of neighbors of i is denoted as ni j i j e let the i j entry of the laplacian matrix l rn n be lij t where lii t n j 1 aij t and lij t aij t for i 6 j i j v if the oscillator states i i v were available for transmission synchronization can be easily achieved by a controller of the form i m j ni aij i j i v 4 with a certain network connectivity condition for a properly designed matrix m however in the present scenario j is not available for agent i the controller under consideration is modified to i m j ni aij i ij 5 i j o xj j ni i v 6 where ij is the estimated value of j by agent i the notation o xj is not necessarily a static function but represents the output of a dynamic system whose input is xj the functionality of o xj is to estimate the frequency j and the oscillator state j using the received signal xj in this sense o xj is called a frequency observer the specific design of o xj for each agent is elaborated as follows motivated by the dynamics 1 i j s i j xj x i j i j i j e i j c x i j f x i j i j fo xj xj x i j j ni i v 7 with x ij 0 xj 0 for some functions and now the afore mentioned synchronization problem can be solved in a framework of three steps step 1 observer design let ij i j j j ni i v be the estimation errors they can be put in a compact cumulative form of i j ni aij i j and col 1 n also let col 1 n as the system 1 is non autonomous with an external input i the observer 7 is designed such that lim sup t t lim sup t t for some gain step 2 perturbed consensus the control input i to each agent is designed such that consensus is achieved with the estimation errors regarded as external perturbation in the sense of lim sup t t lim sup t t for some gain step 3 small gain condition the two gains and must satisfy a small gain condition to ensure the final target of synchro nization in terms of 2 which puts an extra constraint on the design in the above two steps the framework of these three steps will be developed in the subsequent three sections respectively the technical challenges in the development are summarized as follows i it requires a new method to construct a frequency observer of a nonlinear system especially subject to an external input none of the existing observer design methods is applicable in this scenario moreover the gain from the external input to the observation error can be made arbitrarily small ii to decouple the complexity of the overall system we first consider step 1 and step 2 separately in particular step 1 can be achieved under the assumption that t is bounded and similarly step 2 can be achieved under the assumption that t is bounded it is a technical difficulty to ensure both assumptions can be satisfied concurrently in the closed loop system through a certain intercon nection on satisfaction of these bounded assumptions the proposed controller must also ensure a small gain condition which requires deep understanding the coupling structure in the system dynamics iii among the agents the communicated state is the modulated signal xi however the target of the control strategy is synchroniza tion of the state i in fact synchronization of the instantaneous values of xi is not needed in this framework so the existing synchronization methods for nonlinear systems using a reference model or an internal model do not apply in the present setting iii design of a frequency observer in this section we study a frequency observer for a frequency modulated oscillator to simplify the notation we omit the subscripts and superscripts in this section by focusing on an individual scenario more specially we consider the model s b e c x f x fo x 8 and the corresponding observer s x x e c x f x fo x x x 9 with x 0 x 0 the following notations are used throughout the paper for a symmetric real matrix p let max p and min p be the maximum and minimum eigenvalues of p respectively and let p max p min p lemma 3 1 consider the dynamics 8 and the observer 9 with a constant c 0 and a time varying signal t satisfying t b t 0 for a constant b suppose the frequency modulated signal x t is bounded i e x t t 0 for some constants 0 for any constants bo 0 if there exist matrices ko and p p t 0 such that p s koe s koe tp i pb p o 10 for o 8 then there exist control functions and such that lim sup t t t lim sup t t 11 for 0 0 bo 12 proof for the convenience of presentation denote the observation errors and x x x with the relationship e the error dynamics can be written as s x x b x f x f x x x f x e f x f x x x pick a matrix function k x ko f t x f x 2 13 it will be proved later that f x t 0 t 0 to validate the definition of k direct calculation shows that k x f x ko f t x f x 2 f x ko 4 then one has s k x f x e s koe s where s s koe is hurwitz with 10 that can be rewritten as ps s t p i 8 pb p 14 we introduce a new variable k x x 15 that gives s x x b k x f x e f x f x x x k x x s k x f x e x x b s k x f x e k x f x e k x f x e x x b s k x f x f x e x x b where x x k x x x k x f x f x k x x x x x x x s k x x k x f x f x ek x x and k x x ko f x 2 iq 2 f x f t x f x 4 f x x f x fo x x x t it is noted that along the trajectory of 9 k x k x x x k x x the dynamics can be further simplified as follows s k x f x f x e b 16 next noting e e ek x x the x dynamics can be rewritten as x f x e x 17 where x x x f x ek x x f x f x and is to be specified later as f is continuously differentiable there exist positive numbers 0 such that see lemma 11 1 of 51 f x x f x e x f x e x x 2 also we define positive numbers bx bk 0 as bx arg max b 2 8 pk x x x 1 x x b 18 and bk max x x bx k x x 19 from the above definition one has bx 2 for x x bx one has 2 x x 2 so bk is finite according to the definition of the function k then let satisfy the following conditions p b 2 o 8 2 b 2 p 4 b 2 x 2 2 20 b 2 k 4 2 2 21 1 4 min p min p 2 2 22 the remaining analysis will be on the interconnected system com posed of 16 and 17 next we will prove x t bx t 0 23 if 23 does not hold there exists a finite t 0 such that x t bx t 0 t and x t bx because x 0 0 and x t is a continuous function of t a contradiction will be derived below first for the system 16 pick a lyapunov function candidate v 1 tp 2 whose time derivative satisfies v 1 2 2 tpk x x f x f x e 2 tpb 2 2 pk x x x 2 1 4 2 4 pb 2 2 for t 0 t one has x t bx and hence 8 pk x x x 1 therefore v 1 2 1 4 2 1 4 2 4 pb 2 2 1 2 2 4 pb 2 2 24 and v 1 1 max p v 1 4 pb 2 2 25 from 25 the comparison principle gives v 1 t v 1 0 4 pb 2 t 0 exp 1 max p t 2 d v 1 0 4 pb 2 b 2 t 0 exp 1 max p t d v 1 0 4 pb 2 b 2 max p 1 exp 1 max p t v 1 0 4 pb 2 b 2 max p max p 0 2 2 4 pb 2 b 2 max p from the above calculation one has min p t 2 2 v 1 t max p 0 2 2 4 pb 2 b 2 max p and then t 2 p 0 2 8 pb 2 b 2 p 26 by 12 and the fact 0 0 k x 0 x 0 0 26 implies t 2 p b 2 o 8 pb 2 b 2 p 27 5 secondly for the system 17 pick a lyapunov function candidate v 2 x x 2 2 whose time derivative satisfies v 2 x x 2 x tf x e x 2 x 2 2 x 2 1 4 2 2 2 2 v 2 x 1 4 2 28 it is noted that 2 2 0 from 20 or 21 applying the comparison principle again gives v 2 x t v 2 x 0 1 4 t 0 exp 2 2 2 t 2 d p b 2 o 8 pb 2 b 2 p 4 t 0 exp 2 2 2 t d p b 2 o 8 pb 2 b 2 p 8 2 2 1 exp 2 2 2 t p b 2 o 8 pb 2 b 2 p 8 2 2 where 27 is used in the above calculation by 20 one has x t 2 2 v 2 x t p b 2 o 8 2 b 2 p 4 2 2 b 2 x for t 0 t it is a contradiction with x t bx from the above argument one has 23 proved also k x t bk x t 6 0 f x t 6 0 24 and 28 hold for all t 0 the definition of k in 13 is thus validated next as 21 is equivalent to 1 4 2 2 1 bk 28 implies that the x system 17 is input to state stable viewing x as the state and as the input and particularly see theorem 2 7 of 51 lim sup t x t 1 bk lim sup t t and the following inequalities hold lim sup t k x t x t bk lim sup t x t lim sup t t 29 for v 2 x min p x 2 2 a variant of 28 is written as follows v 2 x min p x 2 min p x tf x e min p x 2 min p x min p 2 min p 2 2 x 2 1 4 2 30 it is ready to construct the composite lyapunov function v x v 1 v 2 x that satisfies min p col x 2 2 v x max p 2 2 min p x 2 2 max p col x 2 2 using 24 and 30 the derivative of v x satisfies v x 1 4 2 min p 2 min p 2 2 x 2 4 pb 2 2 1 4 col x 2 4 pb 2 2 noting min p 2 min p 2 2 1 4 according to 22 as a result the x system composed of 16 and 17 is input to state stable viewing x as the state and as the input in particular one has lim sup t col t x t 2 lim sup t t 31 as 14 is equivalent to 2 max p 4 pb 2 min p 4 4 pb p finally using 15 29 and 31 the following conclusion is verified lim sup t t lim sup t t lim sup t k x t x t 2 lim sup t t 2 lim sup t col t x t lim sup t t which is 11 the proof is thus completed remark 3 1 design of a state observer for estimating the internal state of a given system is an important topic in control theory for example there are many practical applications of a luenberger observer and a kalman filter researchers have also studied many nonlinear observer design methods the observer in 52 is based on the observer error linearization approach an extended luenberger observer was designed in 53 using the technique of linearization and transformation into a nonlinear observer canonical form high gain observers were studied in many references e g 54 55 for nonlinear systems in canonical observability form neither the approach based on linearization nor a canonical form does not apply in the present paper due to the special structure of the system under consideration however the new approach takes advantage of the interconnection structure between the and x subsystems and derives a lyapunov function based argument in addition an arbitrarily specified gain from an external input to the estimation error further complicates the problem remark 3 2 the gain from to the estimation error is characterized in the lemma by an appropriately designed observer it is noted that the influence of could be completely removed by compensation in the observer 9 such as s b x x however such compensation is not applicable when the observer is used for network synchronization in this paper consider the observer 7 of agent i to estimate the frequency of agent j the only signal agent i is able to access is the state xj not the input j of agent j remark 3 3 it is assumed that the frequency modulated signal x t is bounded i e x t t 0 in the lemma it is a reasonable assumption for a persistently exciting oscillator for example for an oscillator x 0 t t 0 x 6 one has x t x 0 t 0 that is bounded no matter how t varies because d x t 2 dt 2 x t x 2 x t 0 t t 0 x 0 oscillation is also typically generated as a stable limit cycle which is a closed trajectory and bounded to close this section we discuss the existence of the solution to 10 for a special case corollary 3 1 for s 0 0 0 e 1 0 b 1 1 and any constant o 0 there exist matrices ko and p p t 0 such that 10 is satisfied proof for a positive let ko b eb sb eb then s s koe s be eb sbe eb s i be eb be eb 0 we can solve the equation in 10 as p 1 2 1 1 1 2 which has two eigenvalues and and hence is hurwitz the characteristic equation of p is det po i 2 1 2 0 which implies p 1 p max p min p min p max p 2 2 2 2 and hence p 2 2 2 2 it is noted that pb 1 then pb 2 p 2 2 2 2 2 2 2 2 2 2 o for max 1 2 2 2 2 2 o the proof is thus completed iv perturbed consensus consider the i dynamics of the system 1 that is i s i b i i v 32 if the state i could be directly transferred over the network without frequency modulation the synchronization target 2 can be easily achieved through the ideal controller 4 however with frequency modulation the controller takes the form 5 where the estimated state ij rather than j is available for the design the controller 5 can be rewritten as the ideal controller 4 subject to perturbation i e the estimation error i m j ni aij i j m j ni aij i j i v 33 for i j ni aij i j the system composed of 32 and 33 becomes i s i bm j ni aij i j bm i i v 34 for the convenience of presentation let col 1 n and col 1 n let r 1 rn be the left and right eigenvectors corresponding to the eigenvalue zero of the laplacian matrix l and satisfying rt 1 1 there exist matrices w r n 1 n and u rn n 1 such that t rt w t 1 1 u 35 w 1 0 and rtu 0 then tlt 1 0 0 0 h 36 where h wlu 37 is called an h matrix associated with l it is well known that under assumption 1 given below all the eigenvalues of h have positive real parts assumption 1 the directed graph g contains a spanning tree now the main result about perturbed consensus is given in the following lemma lemma 4 1 consider the system 32 with 33 under assump tion 1 if m is selected such that a in 1 s h bm 38 is hurwitz then lim sup t t lim sup t t 39 for some constant and any bounded t proof the the system composed of 32 and 33 i e 34 can be put in a compact form in s l bm in bm 40 we introduce the following coordinate transformation t ip t 1 ip 41 in the new coordinate the system 40 is equivalent to in s tlt 1 bm t bm that is s r t bm a w bm 42 as a is hurwitz there exists q q t 0 as the solution to the lyapunov equation qa a t q 2 i 43 the derivative of the function v t q 44 along the trajectories of 42 is v 2 2 2 tq w bm 2 q w bm 2 2 45 7 it implies that the system 42 is input to state stable viewing as the state and as the input in particular lim sup t t lim sup t t 46 for q q w bm 47 next from the relationship l m lt 1 m lu m one has lim sup t l m t lu m lim sup t t lu m lim sup t t finally 33 can be put in the following compact form l m in m 48 that gives lim sup t t lu m lim sup t t in m lim sup t t m lu 1 lim sup t t the proof is thus complete for m lu 1 remark 4 1 under assumption 1 let i i 2 n be the eigenvalues of h that have positive real parts if s b is stabilizable let g gt 0 be the solution to the following algebraic riccati equation s t g gs gbbtg i 0 49 for some 0 mini 2 n i and 0 let the controller gain matrix be m btg 2 then all the eigenvalues of s ibm have strictly negative real parts and hence a in 38 is hurwitz remark 4 2 the concept of perturbed consensus was originally proposed in 40 to deal with synchronization of heterogeneous nonlinear mass using output communication where the perturba tion represents some trajectory regulation error in this reference perturbed consensus is formulated as a constant gain from the perturbation to the consensus error 1 o for some agreed trajectory o in this paper to facilitate the subsequent analysis of the overall system perturbed consensus is formulated in terms of a gain from the perturbation to i e 39 in lemma 4 1 perturbed consensus is achieved under the assumption that the perturbation t is always bounded for t 0 which will be ensured when the overall system is considered in the following section v synchronization of a frequency modulated mas with the frequency observers and the controllers for perturbed consensus proposed in the previous two sections it is ready to obtain the result of synchronization of a frequency modulated mas using a small gain based argument the result is stated in the following theorem theorem 5 1 consider the dynamics 1 the controller 5 and the observer 7 with a constant c 0 under assumption 1 suppose the frequency modulated signal x t is bounded i e x t t 0 for some constants 0 let m be selected such that a in 38 is hurwitz and defined as 47 pick any 0 1 a m lu 1 50 if there exist matrices ko and p p t 0 satisfying 10 for o min 8 8 n then for any constants bo b 0 there exist control functions and such that synchronization is achieve in the sense of 2 for any initial state of the closed loop system satisfying w ip 0 b ij 0 j 0 bo j ni i v 51 proof for the matrix q in 43 we first define two quantities a i liu m q b liu m a 1 m ai 1 p bo bxbk 0 and b i 1 liu m a 1 m ai 1 8 pb p where bx and bk are defined in 18 and 19 li and ai are the i th rows of l and a respectively by 10 one has 8 n pb p 52 noting a 1 n a and using 50 and 52 one has liu m a 1 m ai 1 8 pb p a 1 m lu 1 8 pb p a m lu 1 8 n pb p 1 and hence bi 0 now it is ready to pick b ai bi 0 and hence b p b 2 o 8 pb 2 b 2 p bxbk next we will prove that the signals t and i t are bounded first it is noted that ij 0 bo b assume there exists a finite t 0 such that ij t b t t and ij t b 53 a contradiction is derived below by the assumption one has i t j ni aij ij t j ni aijb ai 1 b 54 and hence t a 1 b 55 which shows that t is bounded for t 0 t using 44 and 45 gives v v max q q w bm 2 2 8 as a result for t 0 t v t v 0 q w bm 2 a 1 2 b 2 max q and t 2 max q 0 2 min q q w bm 2 a 1 2 b 2 max q min q q 0 2 a 1 2 b 2 2 then we use the facts li ip lit 1 ip liu ip and i li m m i 56 and have the following calculation for t 0 t i t li m t m i t liu m t m i t liu m q 0 2 a 1 2 b 2 2 m ai 1 b liu m q b liu m a 1 m ai 1 b and hence i t liu m q b liu m a 1 m ai 1 p b 2 o 8 pb 2 b 2 p bxbk liu m q b liu m a 1 m ai 1 p bo 8 pb p b bxbk a i 1 b i b b denote b maxi 1 n ai 1 bi b b one has i t b t 0 t using the similar development of 27 gives t 2 p b 2 o 8 pb 2 b 2 p 57 moreover using 19 and 23 gives ij t t k x t x t p b 2 o 8 pb 2 b 2 p bxbk b for t 0 t it contradicts with the assumption 53 using the proof by contradiction one has ij t b t a 1 b i t b t 0 58 finally lemmas 3 1 and 4 1 can be applied to complete the proof using a small gain argument on one hand by lemma 3 1 lim sup t ij t lim sup t j t j ni for i j ni aij i j one has lim sup t i t j ni aij lim sup t j t and hence lim sup t t a lim sup t t 59 on the other hand by lemma 4 1 lim sup t t lim sup t t 60 for m lu 1 that satisfies the small gain condition a 1 putting 59 and 60 together gives lim sup t t a lim sup t t 61 it concludes that lim t t 0 using the same approach one has lim t t 0 finally by 46 one has lim t t 0 and lim t t 1 ip t lim t u ip t 0 which implies 2 the proof is thus completed remark 5 1 the functions and used in the observer 7 can be explicitly designed accordingly lemma 3 1 from the proof it is noted that the functions depend on the function f and the parameters s e b and b also it is noted from the proof of theorem 5 1 that b further depends on l b and bo therefore the two functions and can be uniform for all the agents as shown in 7 as the constants b and bo to characterize of the initial states of the closed loop system can be arbitrarily selected the synchronization problem in the theorem is solved in a semi global sense remark 5 2 the state of the dynamics 1 of agent i is i xi where xi is accessible by the neighbored agents via network but i is not synchronization of the agents in terms of the full state trajectories i t xi t obviously implies frequency synchronization 2 for i it is worth mentioning that the mechanism of frequency synchroniza tion developed in this paper does not follow the traditional idea of synchronization of full state trajectories used in most existing works in particular the difference between the trajectories of two agents does not approach zero that is limt xi t xj t does not necessarily exist or is not equal to zero even when 2 is guaranteed vi numerical examples we consider a network of n 6 frequency modulated oscillators of the form 1 with s 0 0 1 0 1 0 b 1 1 e 4 5 0 and f xi 0 1 1 0 xi fo xi 0 c 3 in this example the modulated signals xi t are frequency varying sinusoids the target is to synchronize the frequencies of the signals generated by the oscillators not the instantaneous values of the signals the network topology is illustrated in fig 2 9 fig 2 illustration of the network topology of six oscillators agents where the weight associated with each edge arrowed line is positive in particular the following function k x ko x t x 2 0 1 1 0 ko 1 80 1 76 with k x x ko iq 2 f x f t x x 2 0 1 1 0 f x x x t is used to construct the functions and of the frequency observers the parameter 10 is used for the simulation it is noted that a higher value of gives faster convergence of the frequency observers for aij 1 i j e the control gain matrix m 0 01 1 0 5 representing weak coupling among the oscillators is used in the controller using the observer controller proposed in the paper the synchronization performance of the oscillators is discussed below in the figures we only demonstrate the trajectories of three oscillators denoted as osc 1 osc 3 and osc 5 corresponding to the nodes 1 3 and 5 in fig 2 respectively the other three oscillators have similar profiles and thus omitted the profile of the frequency modulated signals xi t only the first component xi 1 t for concise presentation is shown in fig 3 frequency synchronization can be observed in this figure as expected while synchronization of the signals in oscillation phase and ampli tudes is not needed frequency synchronization can also be exhibited in fig 4 in an explicit illustration it is noted that frequencies i t in this figure are not directly measured or transmitted via the network the effectiveness of the proposed frequency observer is verified in fig 5 according to the topology the frequency of osc 1 is observed by agent 3 that of osc 3 is observed by agents 2 4 5 separately and that of osc 5 by agent 4 the convergence of the observed frequencies in dashed curves to the real values solid curves can be achieved by all the observers next we examine the robustness of synchronization of frequency modulated oscillators with respect to noise in the transmitted signals via the network the result is shown in fig 6 using the synchroniza tion error 1 t 3 t as an example the top graph shows a perfect synchronization behavior without any noticeable error in the scale of 0 01 the relative and absolute error tolerances in matlab simulation are 10 4 and 10 8 respectively the middle graph shows the result for the unmodulated controller 4 with transmission noise i e i m j ni aij i j nij i v where the level of noise nij on j transmitted from j to i is 1 of the magnitude of the transmitted signals in this case 0 50 100 150 200 250 300 350 1 0 1 o s c 1 0 50 100 150 200 250 300 350 1 0 1 o s c 3 0 50 100 150 200 250 300 350 time s 1 0 1 o s c 5 fig 3 profile of the frequency modulated signals xi 1 t the first element of the state vector xi t for i 1 3 5 0 50 100 150 200 250 300 350 0 2 4 6 o s c 1 0 50 100 150 200 250 300 350 0 2 4 6 o s c 3 0 50 100 150 200 250 300 350 time s 0 2 4 6 o s c 5 fig 4 profile of the frequencies i t for i 1 3 5 fig 5 profile of the observed frequencies ij t j ni dashed curves vs the real frequencies j t solid curves for j 1 3 5 the synchronization error induced by the noise can ben obviously observed finally we apply the same level of noise on the frequency modulated controller 7 i e i j s i j xj n i j x i j i j i j e i j c x i j f x i j i j fo xj n i j xj n i j x i j j ni the result in the bottom graph exhibits that the synchronization error using frequency modulation is significantly less than that in the unmodulated case the error is noticeable with more details when it is amplified to the scale of 10 4 the comparison in fig 6 verifies the robustness of frequency modulated mass in mitigating the influence of network noise next we consider another example of a network of hindmarsh rose oscillators which are a class of low dimensional hodgkin 10 0 50 100 150 200 250 0 01 0 0 01 0 50 100 150 200 250 0 01 0 0 01 0 50 100 150 200 250 time s 0 01 0 0 01 180 190 200 5 0 5 10 4 fig 6 profile of the synchronization error 1 t 3 t in three cases top graph noise free middle graph unmodulated synchronization with noise and bottom graph frequency modulated synchronization with noise huxley model of neuronal activity they can characterize the spiking bursting behavior of the membrane potential observed in experiments the dynamics are of the form 1 with s 0 0 005 0 005 0 b 1 1 e 0 4 0 and xi viwi zi f xi 2 5 v 2 i wi 1 0 fo xi 3 v 2 i v 3 i wi zi 0 0 005 4 vi 1 5 zi c 0 9 the variable vi t represents the membrane potential of a neuron wi t is the spiking variable that represents the transport rate of sodium and potassium ions through fast ion channels and zi t is the adaptation current that increases at every spike and leads to a decrease in the firing rate the signal i t is encoded as the firing rate of the membrane potential the network topology is the same one in fig 2 the non sinusoidal signals xi t of this class of oscillators consist of bursts and spikes of varying firing rates the synchronization target is not the instantaneous signals but their firing rates the results discussed in the first example can be observed in this example as well as a comparison the membrane potentials of the individual oscillators without synchronization control i e i 0 are plotted in fig 7 with the synchronization controller proposed in this paper frequency synchronization of membrane potentials is plotted in fig 8 and synchronization of firing rates of spikes in fig 9 once synchronized the firing rates of spikes are generally less than those of individual oscillators because the variations of the firing rates are averaged it is also noted that the signals in terms of the instantaneous values are not necessarily synchronized the convergence of the observed firing rates to the real values is shown in fig 10 the results well demonstrate the similar phenomenon observed in real neural circuits vii conclusions in this paper we have established a framework for synchronization of frequency modulated multi agent systems for the first time the framework includes a frequency observer subject to an external input and a distributed synchronization controller based on the observer using the small gain argument we have verified the effectiveness of the design using rigorous theoretical proofs and extensive numerical simulation it is interesting to further extend the framework to study 0 200 400 600 800 1000 1200 1400 1600 1800 2000 2 0 2 o s c 1 0 200 400 600 800 1000 1200 1400 1600 1800 2000 2 0 2 o s c 3 0 200 400 600 800 1000 1200 1400 1600 1800 2000 time ms 1 0 1 2 o s c 5 fig 7 profile of the membrane potentials vi t of individual hindmarsh rose oscillators without synchronization for i 1 3 5 more complicated models especially from real biological neural networks the research for unmodulated multi agent systems has experienced rapid development in the recent decade which can be further developed for frequency modulated multi agent systems using the framework in this paper the robust synchronization mechanism using frequency modulated signals has the potentials in revealing the similar phenomenon in real systems and gaining deep understanding of how neuronal circuits generate extremely robust and adaptive oscillatory behaviors in animal locomotion it is expected that the research along this direction is also beneficial for building artificial frequency modulated multi agent systems with more engineering applications references 1 w gerstner a k kreiter h markram and a v herz neural codes firing rates and beyond proceedings of the national academy of sciences vol 94 no 24 pp 12 740 12 741 1997 2 j m newcomb a sakurai j l lillvis c a gunaratne and p s katz homology and homoplasy of swimming behaviors and neural circuits in the nudipleura mollusca gastropoda opisthobranchia pro ceedings of the national academy of sciences vol 109 no supplement 1 pp 10 669 10 676 2012 3 j saeedi and k faez synthetic aperture radar imaging using nonlinear frequency modulation signal ieee transactions on aerospace and electronic systems vol 52 no 1 pp 99 110 2016 4 h j choi and j h jung enhanced power line communication strategy for dc microgrids using switching frequency modulation of power converters ieee transactions on power electronics vol 32 no 6 pp 4140 4144 2017 5 z wang y wang and l xu parameter estimation of hybrid linear frequency modulation sinusoidal frequency modulation signal ieee signal processing letters vol 24 no 8 pp 1238 1241 2017 6 m a lewis f tenore and r etienne cummings cpg design using inhibitory networks in proceedings of the 2005 ieee international conference on robotics and automation ieee 2005 pp 3682 3687 7 a j ijspeert a crespi d ryczko and j m cabelguen from swimming to walking with a salamander robot driven by a spinal cord model science vol 315 no 5817 pp 1416 1420 2007 8 a spaeth m tebyani d haussler and m teodorescu spiking neural state machine for gait frequency entrainment in a flexible modular robot plos one vol 15 no 10 p e 0240267 2020 9 e o olivares e j izquierdo and r d beer potential role of a ventral nerve cord central pattern generator in forward and backward locomotion in caenorhabditis elegans network neuroscience vol 2 no 3 pp 323 343 2018 10 l hachoumi and k t sillar developmental stage dependent switch ing in the neuromodulation of vertebrate locomotor central pattern generator networks developmental neurobiology vol 80 no 1 2 pp 42 57 2020 11 w friesen and c hocker functional analyses of the leech swim oscillator j neurophysiol vol 86 pp 824 835 2001 11 fig 8 profile of the membrane potentials vi t of hindmarsh rose oscillators for i 1 3 5 0 200 400 600 800 1000 1200 1400 1600 1800 2000 0 5 1 1 5 o s c 1 0 200 400 600 800 1000 1200 1400 1600 1800 2000 0 5 1 1 5 o s c 3 0 200 400 600 800 1000 1200 1400 1600 1800 2000 time ms 0 5 1 1 5 o s c 5 fig 9 profile of the firing rates i t of hindmarsh rose oscillators for i 1 3 5 0 0 5 1 1 5 2 2 5 3 3 5 4 4 5 5 5 0 5 10 o s c 1 0 0 5 1 1 5 2 2 5 3 3 5 4 4 5 5 0 0 5 1 1 5 o s c 3 0 0 5 1 1 5 2 2 5 3 3 5 4 4 5 5 time ms 1 1 1 1 2 o s c 5 fig 10 profile of the observed firing rates ij t j ni dashed curves vs the real firing rates j t solid curves of hindmarsh rose oscillators for j 1 3 5 12 z chen m zheng w o friesen and t iwasaki multivariable harmonic balance analysis of neuronal oscillator for leech swimming journal of computational neuroscience vol 25 pp 583 606 2008 13 t iwasaki j chen and w o friesen biological clockwork un derlying adaptive rhythmic movements proceedings of the national academy of sciences vol 111 no 3 pp 978 983 2014 14 a jadbabaie j lin and a s morse coordination of groups of mobile agents using nearest neighbor rules ieee transactions on automatic control vol 48 no 6 pp 988 1001 2003 15 r olfati saber and r murray consensus problems in networks of agents with switching topology and time delays ieee transactions on automatic control vol 49 no 9 pp 1520 1533 2004 16 w ren and r w beard consensus seeking in multiagents systems under dynamically changing interaction topologies ieee transactions on automatic control vol 50 no 5 pp 655 661 2005 17 l scardovi and r sepulchre synchronization in networks of identical linear systems automatica vol 45 no 11 pp 2557 2562 2009 18 s e tuna lqr based coupling gain for synchronization of linear systems arxiv preprint arxiv 0801 3390 2008 19 j seo h shim and j back consensus of high order linear systems using dynamic output feedback compensator low gain approach automatica vol 45 no 11 pp 2659 2664 2009 20 s e tuna synchronizing linear systems via partial state coupling automatica vol 44 no 8 pp 2179 2184 2008 21 k you and l xie network topology and communication data rate for consensusability of discrete time multi agent systems ieee transac tions on automatic control vol 56 no 10 pp 2262 2275 2011 22 k hengster movric k you f l lewis and l xie synchronization of discrete time multi agent systems on graphs using riccati design automatica vol 49 no 2 pp 414 423 2013 23 a a stoorvogel a saberi m zhang and z liu solvability con ditions and design for synchronization of discrete time multiagent sys tems international journal of robust and nonlinear control vol 28 no 4 pp 1381 1401 2018 24 s knorn z chen and r h middleton overview collective control of multiagent systems ieee transactions on control of network systems vol 3 no 4 pp 334 347 dec 2016 25 h modares b kiumarsi f l lewis f ferrese and a davoudi resilient and robust synchronization of multiagent systems under attacks on sensors and actuators ieee transactions on cybernetics vol 50 no 3 pp 1240 1250 2019 26 g jing and l wang multiagent flocking with angle based formation shape control ieee transactions on automatic control vol 65 no 2 pp 817 823 2019 27 p wieland r sepulchre and f allg wer an internal model principle is necessary and sufficient for linear output synchronization automat ica vol 47 no 5 pp 1068 1074 2011 28 h kim h shim and j h seo output consensus of heterogeneous uncertain linear multi agent systems ieee transactions on automatic control vol 56 no 1 pp 200 206 2011 29 t yang a saberi a a stoorvogel and h f grip output syn chronization for heterogeneous networks of introspective right invertible agents international journal of robust and nonlinear control vol 24 no 13 pp 1821 1844 2014 30 l zhu and z chen robust homogenization and consensus of nonlinear multi agent systems systems and control letters vol 65 pp 50 55 2014 31 j lunze synchronization of heterogeneous agents ieee transactions on automatic control vol 57 no 11 pp 2885 2890 2012 32 h grip a saberi and a stoorvogel on the existence of virtual exosystems for synchronized linear networks automatica vol 49 no 10 pp 3145 3148 2013 33 w yu g chen and m cao consensus in directed networks of agents with nonlinear dynamics ieee transactions on automatic control vol 56 no 6 pp 1436 1441 2011 34 h su g chen x wang and z lin adaptive second order consensus of networked mobile agents with nonlinear dynamics automatica vol 47 no 2 pp 368 375 2011 35 l pecora and t carroll synchronization in chaotic systems physical review letters vol 64 no 8 p 821 1990 36 n chopra and m spong on exponential synchronization of kuramoto oscillators ieee transactions on automatic control vol 54 no 2 pp 353 357 2009 37 h su x wang and z lin synchronization of coupled harmonic oscillators in a dynamic proximity network automatica vol 45 no 10 pp 2286 2291 2009 38 a isidori l marconi and g casadei robust output synchronization of a network of heterogeneous nonlinear agents via nonlinear regulation theory ieee transactions on automatic control vol 59 no 10 pp 2680 2691 2014 39 x chen and z chen robust perturbed output regulation and synchro nization of nonlinear heterogeneous multiagents ieee transactions on cybernetics vol 46 no 12 pp 3111 3122 2015 40 l zhu z chen and r middleton a general framework for robust output synchronization of heterogeneous nonlinear networked systems ieee transactions on automatic control vol 61 no 8 pp 2092 2107 2016 41 y su and j huang cooperative global robust output regulation for nonlinear uncertain multi agent systems in lower triangular form ieee transactions on automatic control vol 60 no 9 pp 2378 2389 2015 42 h cai f l lewis g hu and j huang the adaptive distributed observer approach to the cooperative output regulation of linear multi agent systems automatica vol 75 pp 299 305 2017 12 43 j huang the cooperative output regulation problem of discrete time linear multi agent systems by the adaptive distributed observer ieee transactions on automatic control vol 62 no 4 pp 1979 1984 2017 44 y yan and z chen cooperative output regulation of linear discrete time time delay multi agent systems by adaptive distributed observers neurocomputing vol 331 pp 33 39 2019 45 e panteley a stability theory perspective to synchronization of het erogeneous networks drsc dissertation university paris sud orsay france 2015 46 e panteley and a lor a synchronization and dynamic consensus of heterogeneous networked systems ieee transactions on automatic control vol 62 no 8 pp 3758 3773 2017 47 m maghenem e panteley and a loria singular perturbations based analysis of synchronization in heterogeneous networks a case study in 2016 ieee 55 th conference on decision and control cdc 2016 pp 2581 2586 48 e panteley a loria and a el ati practical dynamic consensus of stuart landau oscillators over heterogeneous networks international journal of control vol 93 no 2 pp 261 273 2020 49 y yan z chen and r middleton autonomous synchronization of heterogeneous multi agent systems ieee transactions on control of network systems 2020 doi 10 1109 tcns 2020 3042593 50 z hu z chen and h t zhang necessary and sufficient conditions for asymptotic decoupling of stable modes in ltv systems ieee trans actions on automatic control 2020 doi 10 1109 tac 2020 3030854 51 z chen and j huang stabilization and regulation of nonlinear systems springer 2005 52 x h xia and w b gao nonlinear observer design by observer error linearization siam journal on control and optimization vol 27 no 1 pp 199 216 1989 53 m zeitz the extended luenberger observer for nonlinear systems systems and control letters vol 9 no 2 pp 149 156 1987 54 h k khalil and l praly high gain observers in nonlinear feedback control international journal of robust and nonlinear control vol 24 no 6 pp 993 1015 2014 55 d astolfi and l marconi a high gain nonlinear observer with limited gain power ieee transactions on automatic control vol 60 no 11 pp 3059 3064 2015