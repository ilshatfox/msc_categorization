ar x iv 1 20 7 31 20 v 1 m at h o c 1 2 ju l 20 12 optimal disturbance rejection and robustness for infinite dimensional ltv systems seddik m djouadi abstract in this paper we consider the optimal disturbance rejection problem for possibly infinite dimensional linear time varying ltv systems using a framework based on operator algebras of classes of bounded linear operators this approach does not assume any state space repre sentation and views ltv systems as causal operators after reducing the problem to a shortest distance minimization in a space of bounded linear operators duality theory is applied to show existence of optimal solutions which satisfy a time varying allpass or flatness condition un der mild assumptions the optimal tv controller is shown to be essentially unique next the concept of m ideals of operators is used to show that the computation of time varying tv controllers reduces to a search over compact tv youla parameters this involves the norm of a tv compact hankel operator defined on the space of causal trace class 2 operators and its maximal vectors moreover an operator identity to compute the optimal tv youla parameter is provided these results are generalized to the mixed sensitivity problem for tv systems as well where it is shown that the optimum is equal to the operator induced of a tv mixed hankel toeplitz the final outcome of the approach developed here is that it leads to two tractable finite dimensional convex optimizations producing estimates to the optimum within desired tolerances and a method to compute optimal time varying controllers s m djouadi is with the electrical engineering computer science department university of tennessee knoxville tn 37996 2100 djouadi eecs utk edu 1 http arxiv org abs 1207 3120 v 1 mathematical preliminaries and notation b e f denotes the space of bounded linear operators from a banach space e to a banach space f endowed with the operator norm a sup x e x 1 ax a b e f 2 denotes the usual hilbert space of square summable sequences with the standard standard norm x 22 j 0 xj 2 x x 0 x 1 x 2 2 and inner product x y i y ixi y y 0 y 1 y 2 2 pk the usual truncation operator for some integer k which sets all outputs after time k to zero i e pkx x 0 x 1 x 2 xk 0 0 an operator a b 2 2 is said to be causal if it satisfies the operator equation pkapk pka k positive integers and strictly causal if it satisfies pk 1 apk pk 1 a k positive integers 1 a partial isometry is an operator a on a hilbert space which preserves the norm i e au u for all vectors u in the orthogonal complement of the null space of a 6 a bounded linear functional f on a banach space e is a real or complex valued linear map such that there exists c 0 with f x c x e x e where f x denotes the 2 image of x under f and e is the norm on e the dual pace of e denoted e is the space of bounded linear functionals on e under the norm f e supx e x e f x note that e is itself a banach space 6 a sequence xn in e is said to converge weakly to x e if f xn f x 0 f e a sequence fn e is said to converge in the weak topology to f e if fn x f x 0 x e a sequence of operators tn b e f converges to an operator t b e f in the operator topology if tn t 0 it is said to converge in the strong operator topology sot if tnx tx f 0 x e k denotes the space of compact operators in b e f an operator t b e f is compact if there exists a sequence of finite rank i e with finite dimensional ranges operators tn b e f such that t tn 0 as n 6 the subscript c denotes the restriction of a subspace of operators to its intersection with causal see 33 11 for the definition operators stands for the adjoint of an operator or the dual space of a banach space depending on the context denotes the orthogonal complement the symbol denotes the closed linear span and the intersection denotes convergence in the weak topology 6 9 right and left hand sides are abbreviated as rhs and lhs respectively 1 introduction there have been numerous attempts in the literature to generalize ideas about robust control theory 44 46 to time varying tv systems for e g 12 13 11 37 10 36 39 40 34 and references therein in 12 13 and more recently 11 the authors studied the optimal weighted sensitivity minimization problem the two block problem and the model matching problem for ltv systems using inner outer factorization for positive operators they obtained abstract solutions involving the computation of norms of certain operators which is difficult since these are infinite dimen sional problems moreover no indication on how to compute optimal linear time varying ltv controllers is provided the operator theoretic methods in 12 13 11 are difficult to implement and do not provide algorithms which even compute approximately tv controllers in 4 a state space extension of the nehari theorem to a time varying system theoretic setting is developed with parametrization of suboptimal solutions in 40 the authors rely on state space techniques which lead to algorithms based on infinite dimensional operator inequalities these methods lead 3 to suboptimal controllers but are difficult to solve and are restricted to finite dimensional systems moreover they do not allow the degree of suboptimality to be estimated an extension of these results to uncertain systems is reported in 41 relying on uniform stability concepts in 8 both the sensitivity minimization problem in the presence of plant uncertainty and robust stability for ltv systems in the induced norm is considered however their methods could not be extended to the case of systems operating on finite energy signals we believe that it is important to point to the fact that the lack of calculation of the degree of suboptimality in these methods can result in arbitrary poor overall closed loop performance this fact is explored in 18 where the authors although in the linear time invariant lti case studied a two arc counter example that shows that in the limit suboptimal controllers can lead to arbitrary poor performance in the presence of plant uncertainty it seems that this counter example has not yet received enough attention analysis of time varying control strategies for optimal disturbance rejection for known time invariant plants has been studied in 16 2 a robust version of these problems was considered in 15 7 in different induced norm topologies all these references showed that for time invariant nominal plants and weighting functions time varying control laws offer no advantage over time invariant ones in the book 35 the authors consider various interpolation problems in the stationary lti and nonstationary ltv cases in particular nevanlinna pick hermite fejer sarason and nudelman interpolations and nehari extension problems are studied in the tv case the unit disk is replaced by the set of diagonal matrices such as the weighted shift with spectral radius less than 1 the interpolation condition is replaced by an identity involving diagonal matrices two methods are used to solve these problems a method based on the reduction to the time invariant interpolation case but with operator valued functions and another method based on a tv commutant lifting theorem developed by the authors of the book the solutions for these problems are provided in terms of infinite dimensional operator identities in this paper we are interested in optimal disturbance rejection for possibly infinite dimensional i e systems with an infinite number of states ltv systems these systems have been used as mod els in computational linear algebra and in a variety of computational and communication networks as described in the excellent book 17 this allows variable number of states which is predominant in networks which can switch on or off certain parts of the system 17 and infinite number of 4 states as in distributed parameter systems we study questions such as existence and uniqueness of optimal ltv controllers under specific conditions what is the corresponding notion for the hankel operator which solves the optimal h problem what does allpass mean for ltv systems is the optimal youla parameter compact and if so under what conditions is it possible to compute op timal ltv controllers within desired accuracy note that compactness is important since it allows approximations by finite rank operators matrices and therefore makes the problem amenable to numerical computation using inner outer factorizations as defined in 3 11 with respect of the nest algebra of lower triangular causal bounded linear operators defined on 2 we show that the problem reduces to a distance minimization between a special operator and the nest algebra the inner outer factoriza tion used here holds under weaker assumptions than 12 13 and in fact as pointed in 3 p 180 is different from the factorization for positive operators used there duality structure and predual formulation of the problem showing existence of optimal ltv controllers is provided the optimum is shown to satisfy a tv allpass condition quantified in the form of a partial isometry of an op erator therefore generalizing the flatness or allpass condition 48 24 25 the optimal controller and the corresponding dual operator are shown to be essentially unique under mild assumptions with the use of m ideals of operators it is shown that the computation of time varying tv con trollers reduces to a search over compact tv youla parameters furthermore the optimum is shown to be equal to the norm of a compact time varying hankel operator defined on the space of causal hilbert schmidt operators the latter is a natural analogous to the hankel operator used in the lti case an operator equation to compute the optimal tv youla parameter is also derived the results obtained here lead to a pair of dual finite dimensional convex optimizations which approach the real optimal disturbance rejection performance from both directions not only producing esti mates within desired tolerances but allowing the computation of optimal time varying controllers the numerical computation involve solving a semi definite programming problem and a search over lower triangular matrices the results are generalized to the mixed sensitivity problem for tv systems as well where it is shown that the optimum is equal to the operator induced of a tv mixed hankel toeplitz operator generalizing analogous results known to hold in the lti case 45 38 24 our approach is purely input output and does not use any state space realization therefore the results derived here apply to infinite dimensional ltv systems i e tv systems with an infinite 5 number of state variables although the theory is developed for causal stable system it can be extended in a straightforward fashion to the unstable case using coprime factorization techniques for ltv systems discussed in 13 11 the framework developed can also be applied to other performance indexes such as the optimal tv robust disturbance attenuation problem considered in 18 19 20 for continuous ltv systems subject to time varying unstructured uncertainty the problem was considered in 5 where it is shown that for causal ltv systems it is equivalent to finding the smallest fixed point of a two disc type optimization problem under tv feedback control laws for the discrete version of the same problem the duality structure of the problem and a solu tion based on a new bilinear map was provided in terms of an infinite dimensional identity in 23 a related problem involving the computation of the gap metric for ltv systems has been consid ered in 22 in particular the computation of the gap metric for tv systems using a time varying generalization of normalized coprime factorization as an iterative scheme involving the norm of an operator with a tv hankel plus toeplitz structure is provided the duality structure is character ized by computing the preannihilator and exploiting the particular structure of the problem part of the results presented here were announced in 31 21 without proofs the rest of the paper is organized as follows section 2 contains the problem formulation the duality structure of the problem is worked out in section 3 in section 4 the optimal solution is shown to satisfy a tv allpass property section 5 shows that under mild assumptions the tv opti mal q parameter is compact section 6 discusses the uniqueness of the optimal solution in section 7 a solution based on a tv hankel operator is derived together with an extremal identity for the optimum section 8 presents a numerical solution based on duality theory a generalization to the tv mixed sensitivity problem is carried out in section 9 section 10 contains concluding remarks 2 problem formulation in this paper we consider the problem of optimizing performance for causal linear time varying systems the standard block diagram for the optimal disturbance attenuation problem that is considered here is represented in fig 1 where u represents the control inputs y the measured outputs z is the controlled output w the exogenous perturbations p denotes a causal stable linear time varying plant and k denotes a time varying controller the closed loop transmission from w to z is denoted by tzw using the standard youla parametrization of all stabilizing controllers the 6 p k w u z y figure 1 block diagram for disturbance attenuation closed loop operator tzw can be written as 11 tzw t 1 t 2 qt 3 2 where t 1 t 2 and t 3 are stable causal time varying operators that is t 1 t 2 and t 3 bc 2 2 in this paper we assume without loss of generality that p is stable the youla parameter q k i pk 1 is then an operator belonging to bc 2 2 and is related univocally to the controller k 33 note that q is allowed to be time varying if p is unstable it suffices to use the coprime factorization techniques in 39 11 which lead to similar results the magnitude of the signals w and z is measured in the 2 norm two problems are considered here optimal disturbance rejection which and the mixed sensitivity problem for ltv systems which includes a robustness problem in the gap metric studied in 11 36 note that for the latter problem p is assumed to be unstable and we have to use coprime factorizations the performance index can be written in the following form inf tzw k being robustly stabilizing linear time varying controller inf q bc 2 2 t 1 t 2 qt 3 3 the performance index 3 will be transformed into a distance minimization between a certain operator and a subspace to be specified shortly to this end define a nest n as a family of closed subspaces of the hilbert space 2 containing 0 and 2 which is closed under intersection and closed span let qn i pn for n 1 0 1 where p 1 0 and p i then q n is a projection and we can associate to it the following nest n q n 2 n 1 0 1 the 7 triangular or nest algebra t n is the set of all operators t such that tn n for every element n in n that is t n a b 2 2 pna i pn 0 n 4 note that the banach space bc 2 2 is identical to the nest algebra t n define n n n n n n n n n n 5 where n n means n n and n n means n n the subspaces n n are called the atoms of n since in our case the atoms of n span 2 then n is said to be atomic 3 following 3 we introduce inner outer factorizations for the operators in t n as follows an operator a in t n is called outer if the range projection denoted p ra ra being the range of a and p the orthogonal projection onto ra commutes with n and an is dense in the intersection n ra for every n n a partial isometry u is called inner in t n if u u commutes with n 1 3 11 in our case a t n bc 2 2 is outer if p commutes with each q n and aq n 2 is dense in q n 2 a 2 u bc 2 2 is inner if u is a partial isometry and u u commutes with every q n applying these notions to the time varying operator t 2 bc 2 2 we get t 2 t 2 it 2 o where t 2 i and t 2 o are inner outer operators in bc 2 2 respectively similarly outer inner factorization can be defined and the operator t 3 t 3 ot 3 i where t 3 i bc 2 2 is inner t 3 o bc 2 2 is outer the performance index in 3 can then be written as inf q bc 2 2 t 1 t 2 it 2 oqt 3 ot 3 i 6 following classical robust control theory 24 25 46 assume a 1 that t 2 o and t 3 o are invertible both in bc 2 2 assumption a 1 can be somewhat relaxed by assuming instead that the outer operators t 2 o and t 3 o are bounded below see lemma 1 p 220 assumption a 1 guarantees that the map q t 2 obc 2 2 t 3 co is bijective in the time invariant case this assumption means essentially that the outer factor of the plant p is invertible 25 under this assumption t 2 i becomes an isometry and t 3 i a co isometry in which case t 2 it 2 i i and t 3 it 3 i i by absorbing the operators t 2 o and t 3 co into the free operator q expression 6 is 8 then equivalent to inf q bc 2 2 t 2 it 1 t 3 ci q 7 expression 7 is the distance from the operator t 2 it 1 t 3 ci b 2 2 to the nest algebra bc 2 2 in the next section we study the distance minimization problem 7 in the context of m ideals and the operator algebra setting discussed above 3 duality let x ba a banach space and x its dual space i e the space of bounded linear functionals defined on x for a subset j of x the annihilator of j in x is denoted j and is defined by 9 j x f 0 f j i e j is the set of bounded linear functionals on x which vanish on j similarly if k is a subset of x then the preannihilator of k in x is denoted k and is defined by k x x x 0 k the existence of a preannihilator implies that the following identity holds 9 min y k x y sup k k k 1 x k 8 where denotes the duality product let us apply these results to the problem given in 7 by putting x b 2 2 x t 2 it 1 t 3 ci b 2 2 j bc 2 2 9 introduce the class of compact operators on 2 called the trace class or schatten 1 class denoted c 1 such that if i is a basis of 2 and t c 1 then i t i i moreover the sum i t i i is independent of the choice of the basis 14 3 the operator t t t being the adjoint operator of t is positive i e tx x 0 x 2 and x 6 0 and compact and has a unique positive square root denoted t t 1 2 the trace class norm is defined as 14 3 t 1 tr t t 1 2 i t t 1 2 i i 10 9 where tr denotes the trace we identify b 2 2 with the dual space of c 1 c 1 under trace duality 14 that is every operator a in b 2 2 induces a bounded linear functional on c 1 as follows a c 1 is defined by a t tr at and we write b 2 2 c 1 to express that b 2 2 is isometrically isomorphic to c 1 every trace class operator t in turn induces a bounded linear functional on b 2 2 namely t a tr at for all a in b 2 2 to compute the preannihilator of bc 2 2 define the subspace s of c 1 by s t c 1 i q n tq n 1 0 for all n 11 in the following lemma we show that s is the preannihilator of bc 2 2 lemma 1 the preannihilator of bc 2 2 in c 1 bc 2 2 is isometrically isomorphic to s proof by lemma 16 2 in 3 the preannihilator of t n is given by t bc 2 2 if and only t belongs to the subspace t c 1 p n tp n 0 for all n in n where p n denotes the orthogonal projection on n likewise for p n p n the complemen tary projection of p n that is p n i p n in our casen is atomic and for any n n there exists n such thatn q n 1 2 i e p n q n 1 the immediate predecessor of n n is then given by q n 2 i e n q n 2 the orthogonal com plement of n is then 2 q n 2 so p n i q n therefore s t c 1 i q n tq n 1 0 n is isometrically isomorphic to the preannihilator of bc 2 2 and the lemma is proved the existence of a predual c 1 and a preannihilator s implies the following theorem which is a consequence of theorem 2 in 9 chapter 5 8 theorem 1 under assumption a 1 there exists at least one optimal qo in bc 2 2 achieving 10 optimal performance in 7 moreover the following identities hold inf q bc 2 2 t 2 it 1 t 3 ci q t 2 it 1 t 3 ci qo sup t s t 1 1 tr tt 2 it 1 t 3 ci 12 theorem 1 not only shows the existence of an optimal ltv controller but plays an important role in its computation by reducing the problem to primal and dual of finite dimensional convex optimizations under a certain condition in the next section it is shown that the supremum in 12 is achieved theorem 1 also leads to a solution based on a hankel type operator which parallels the hankel operator known in the h control theory 4 tv allpass property of the optimum the dual space of b 2 2 b 2 2 is given by the space b 2 2 c 1 1 k where k is the annihilator of k the space of compact operators on 2 and the symbol 1 means that if c 1 1 k then has a unique decomposition as follows 14 o t o t 13 where o k and t is induced by the operator t c 1 i e t a tr at a b 2 2 banach space duality states that 9 inf y j x y max j 1 x 14 in our case j bc 2 2 since b 2 2 contains c 1 as a subspace then bc 2 2 contains the preannihilator s i e the following expression for the annihilator of j j is deduced j bc 2 2 s 1 k bc 2 2 15 a result in 3 asserts that if a linear functional belongs to the annihilator j and decomposes as o t where o k bc 2 2 and t s then both o bc 2 2 and t 11 bc 2 2 as well we have then the following 31 min q bc 2 2 t 2 it 1 t 3 ci q max o k bc t s o t 1 1 o t 2 it 1 t 3 ci tr tt 2 it 1 t 3 ci 16 if opt opt o topt achieves the maximum in the rhs of 16 and qo the minimum on the lhs then the alignment condition in the dual is immediately deduced from 16 opt o t 2 it 1 t 3 ci tr toptt 2 it 1 t 3 ci t 2 it 1 t 3 ci qo opt o topt 1 17 assume further that a 2 t 2 it 1 t 3 ci is a compact operator this is the case for example if t 1 is compact then opt o t 2 it 1 t 3 ci 0 and the maximum in 16 is achieved on s that is the supre mum in 12 becomes a maximum compact operators include for example systems with impulse responses that have measurable and square integrable kernels it is instructive to note that in the lti case assumption a 2 is the analogue of the assump tion that t 2 it 1 t 3 ci is the sum of two parts one part continuous on the unit circle and the other in h in which case the optimum is allpass 24 18 we would like to find the allpass equivalent for the optimum in the linear time varying case this may be formulated by noting that flatness or allpass condition in the lti case means that the modulus of the optimum t 2 it 1 t 3 ci qo ei is constant at almost all frequencies equal to in terms of operator theory note that the optimum viewed as a multiplication operator acting on l 2 or h 2 changes the norm of any function in l 2 or h 2 by multiplying it by a constant that is the operator achieves its norm at every f l 2 of unit l 2 norm this interpretation is generalized to the ltv case in the following theorem which part of it first appeared in 31 without a proof in fact the optimal cost 3 is shown to be a partial isometry theorem 2 under assumptions a 1 and a 2 there exists at least one optimal linear time varying qo bc 2 2 that satisfies the following i the duality expression t 2 it 1 t 3 ci qo tr tot 2 it 1 t 3 ci max n i q n t 2 it 1 t 3 ciq n 18 12 holds where to is some operator in s and to 1 1 ii and if oo infq k t 2 it 1 t 3 ci q i e when the causality constraint is removed the following operator t 2 it 1 t 3 ci qo t 2 it 1 t 3 ci qo 19 is a partial isometry that is the optimum is an isometry on the range space of the operator to in i this is the time varying counterpart of flatness note the condition oo is sharp in the sense that if it does not hold there exist t 2 it 1 t 3 ci and qo such that t 2 it 1 t 3 ci qo t 2 it 1 t 3 ci qo is not a partial isometry proof i identity 18 is implied by the previous argument that the supremum in 12 is achieved by some to in s with trace class norm equal to 1 combining this result with corollary 16 8 in 3 see also 1 which asserts that t 2 it 1 t 3 ci qo sup n i q n t 2 it 1 t 3 ciq n 20 shows in fact that the supremum w r t n is achieved proving that 18 holds ii the operator t o to is self adjoint and compact and therefore admits a spectral representation t o to j j j j where j form an orthonormal basis for 2 consisting of eigenvectors of t o to and j are its necessarily positive real eigenvalues 14 it follows that j t o to j j tr t o to 1 2 j j to 1 21 where we used the fact that t o to j j j 6 0 let the polar decomposition of to be to u t o to 1 2 where u is an isometry on the set j and t o to 1 2 the square root of t o to now j being the non zero singular values of to are also the eigenvectors of t o to 1 2 it follows that for j 6 0 we have 1 j to j 1 j u t o to 1 2 j 1 j u j j u j 22 13 so u j is an orthonormal set which spans the range of to call j u j then to can be written as to j j j j and to 1 j j 1 23 tr t 2 it 1 t 3 ci qo to j j j t 2 it 1 t 3 ci qo j by definition of the trace j j j 2 t 2 it 1 t 3 ci qo j 2 j j t 2 it 1 t 3 ci qo j 2 24 j j t 2 it 1 t 3 ci qo to 1 t 2 it 1 t 3 ci qo 25 where the first inequality in 24 follows from the cauchy schwartz inequality the second from a standard property of the induced norm and the fact that j and j are orthonormal sets hence equality must hold throughout yielding t 2 it 1 t 3 ci qo j 2 t 2 it 1 t 3 ci qo j 2 26 for each j that is t 2 it 1 t 3 ci qo attains its norm on each j it must then attain its norm every where on the span of j so that t 2 it 1 t 3 ci qo t 2 it 1 t 3 ci qo is an isometry on the range of to note that if condition oo does not hold it is straightforward to find a counter example such that the optimal is not a partital isometry choose for example t 2 it 1 t 3 ci to be a strict upper triangular which is not a partial isometry then an optimal qo is the zero matrix the optimum is equal to t 2 it 1 t 3 ci which does not correspond to a partial isometry identity 19 represents the allpass condition in the time varying case since it corresponds to the allpass or flatness condition in the time invariant case for the standard optimal h problem in the next section we show that the search over q can be restricted to compact operators this is achieved by introducing a banach space notion known as m ideals 3 5 m ideals and compact youla tv parameters in this section we show that the optimal tv q is compact this will allow approximations by finite rank operators to any desired accuracy and consequently bring in finite dimensional convex 14 optimizations to carry out the computations in order to achieve our objective we rely on the concept of m ideals which is discussed next following 3 we say that a closed subspace m of a banach space b is an m ideal if there exists a linear projection b m from the dual space of b b onto the annihilator of m m in b such that for all b b we have b b b b 27 in this casem is called an l summand of b the range n of i is a complementary subspace of m and b m 1 n a basic property of m ideals is that they are proximinal that is for every b b there is an mo in m such that infm m b m b mo under assumption a 2 we generalize lemma 1 6 in 32 to causal ltv systems i e the space bc 2 2 recall that lemma 1 6 states that if f is a function continuous on the unit circle i e f c then inf g h f g inf g a f g 28 where a is the disk algebra i e the space of analytic and continuous function on the unit disk a h c that is it suffices to restrict the search to functions in a to generalize 28 to causal ltv systems put b k m bc 2 2 and show that for b k we have inf m bc 2 2 b m inf m bc 2 2 k b m 29 by theorem 3 11 in 3 bc 2 2 k is weak dense in bc 2 2 by theorem 11 6 and corollary 11 7 in 3 bc 2 2 k is anm ideal inbc 2 2 and the quotient map q 1 bc 2 2 bc 2 2 k 7 bc 2 2 k bc 2 2 is isometric likewise the quotient map q 2 k bc 2 2 k 7 bc 2 2 k bc 2 2 is isometric and the identity 29 holds in our case under assumption a 2 b t 2 it 1 t 3 ci k and m q yields inf q bc 2 2 t 2 it 1 t 3 ci q inf q bc 2 2 k t 2 it 1 t 3 ci q t 2 it 1 t 3 ci qo for some optimal qo bc 2 2 k that is under a 2 the optimal q is compact and thus it suffices to restrict the search in 30 to causal and compact parameters q now we turn our attention to studying questions regarding the uniqueness of the optimal solution 15 6 on the uniqueness of the optimal tv controller in this section under assumptions a 1 a 2 and oo we prove that the optimal tv controller is essentially unique since there is an one to one onto correspondence between optimal controllers and youla parameters it suffices to show that the latter is essentially unique suppose by way of contradiction that there are two optimal compact youla parameters q 1 and q 2 such that t 2 it 1 t 3 ci q 1 t 2 it 1 t 3 ci q 2 30 and t 2 it 1 t 3 ci q 1 and t 2 it 1 t 3 ci q 1 are both isometries on the range of to where to is the optimal dual operator in theorem 2 in this case any convex combination of q 1 and q 2 is also optimal since t 2 it 1 t 3 ci q 1 1 q 2 0 1 and t 2 it 1 t 3 ci 1 t 2 it 1 t 3 ci q 1 1 q 2 t 2 it 1 t 3 ci q 1 1 t 2 it 1 t 3 ci q 2 31 implying that t 2 it 1 t 3 ci q 1 1 q 2 0 1 32 in particular for q q 1 q 2 2 let t 2 it 1 t 3 ci q and note that q 1 q 2 2 33 by the parallelogram law we have for all x 2 q 1 q 2 2 tox 2 2 q 1 q 2 2 tox 2 2 2 tox 22 2 q 1 q 2 2 tox 2 2 34 since each of the operators and q 1 q 2 2 is an isometry on the range of to we have q 1 q 2 2 tox 2 tox 2 tox 2 which implies that q 1 q 2 2 tox 0 x 2 that is we have necessarily q 1 q 2 showing uniqueness on the range of to 16 next we show that the operator to in the dual maximization is unique to see this again suppose that there exists another operator t o such that t 2 it 1 t 3 ci qo tr t 2 it 1 t 3 ci qo to tr t 2 it 1 t 3 ci qo t o 35 by the proof of theorem 2 there exist orthonormal sequences i and j such that to j j j j to 1 j j 1 36 moreover since t 2 it 1 t 3 ci qo to j j t 2 it 1 t 3 ci qo j we have then tr t 2 it 1 t 3 ci qo to j j j t 2 it 1 t 3 ci qo j and t 2 it 1 t 3 ci qo yields j t 2 it 1 t 3 ci qo j j that is t 2 it 1 t 3 ci qo j j j the latter shows that t 2 it 1 t 3 ci qo to t o to 1 2 similarly t 2 it 1 t 3 ci qo t o t o t o 1 2 now suppose that r to t o 6 0 r s i e r is strictly causal then to 1 r t o 1 t o 1 1 and tr t 2 it 1 t 3 ci qo t o r tr t 2 it 1 t 3 ci qo t o therefore t o 1 t o r 1 tr t 2 it 1 t 3 ci qo t o and then t 2 it 1 t 3 ci qo r t 2 it 1 t 3 ci qo t o r t 2 it 1 t 3 ci qo t o 37 t o r t o r 1 2 t ot o 1 2 38 showing that t 2 it 1 t 3 ci qo r is self adjoint but t 2 it 1 t 3 ci qo r is strictly causal that is belongs to s likewise for its adjoint t 2 it 1 t 3 ci qo r s this implies that t 2 it 1 t 3 ci qo r t 2 it 1 t 3 ci qo r s 39 since bc 2 2 is the annihilator of s it follows that tr t 2 it 1 t 3 ci qo r t 2 it 1 t 3 ci qo r 0 40 17 thus t 2 it 1 t 3 ci qo r 0 and from 38 we have t o r t o r 1 2 t ot o 1 2 since t 2 it 1 t 3 ci qo is an isometry on the ranges of t o and to t o r we have for every x 2 t o r x 2 t 2 it 1 t 3 ci qo t o r x 2 41 t 2 it 1 t 3 ci qo t ox 2 t ox 2 42 in the same manner we get t o r x 2 t ox 2 next apply the parallelogram law to get the equality t o r x 22 t o r x 22 2 t ox 22 2 rx 22 from which we deduce that rx 2 0 for all x 2 that is we must have r 0 and then to t o showing uniqueness of to in the next section we relate our problem to an ltv operator analogous to the hankel opera tor which is known to solve the standard optimal h control problem 24 46 7 triangular projections and hankel forms let c 2 denote the class of compact operators on 2 called the hilbert schmidt or schatten 2 class 14 3 under the norm a 2 tr a a 1 2 a c 2 43 define the space a 2 c 2 bc 2 2 then a 2 is the space of causal hilbert schmidt operators the orthogonal projection p of c 2 onto a 2 is the lower triangular truncation and is analogous to the standard positive riesz projection for functions on the unit circle following 30 an operator x in b 2 2 determines a hankel operator hx on a 2 if hxa i p xa for a a 2 44 in the sequel we show that is equal to the norm of a particular ltv hankel operator to this end we need first to characterize all atoms denoted n of bc 2 2 as n q n 1 q n n 0 1 2 write c for the set of operators a bc 2 2 for which na n 0 n 0 1 2 and let c 2 c 2 c in 30 29 it is shown that any operator a in bc 2 2 c 1 admits a riesz 18 factorization that is there exist operators a 1 and a 2 in a 2 such that a factorizes as a a 1 a 2 and a 1 a 1 2 a 2 2 45 a hankel form b associated to a bounded linear operator b b 2 2 is defined by 30 29 a 1 a 2 b tr a 1 ba 2 a 1 a 2 a 2 46 since any operator in the preannihilator s belongs also to bc 2 2 c 1 then any a s factorizes as in 45 and if a 1 1 as on the rhs of 12 a s the operators a 1 and a 2 both in a 2 can be chosen such that a 1 2 1 a 2 2 1 and na 1 n 0 n 0 1 2 that is a 1 c 2 29 now write p for the orthogonal projection with rangea 2 c introducing the notation b 1 b 2 tr b 2 b 1 and the hankel form associated to b t 2 it 1 t 3 ci we have by a result in 29 a 1 a 2 b tr ba 2 a 1 a 1 ba 2 p a 1 ba 2 a 1 p ba 2 a 1 h ba 2 47 where hb is the hankel operator i p bp associated with b t 2 it 1 t 3 ci the hankel operator hb belongs to the banach space of bounded linear operators on c 2 furthermore we have ht 2 it 1 t 3 ci sup a 2 2 1 a 2 c 2 hba 2 2 sup a 2 2 1 a 2 c 2 a 1 2 1 a 1 c 2 a 1 h ba 2 48 we have then the following theorem which relates the optimal performance to the induced norm of the hankel operator ht 2 it 1 t 3 ci the theorem was announced in 31 without a proof theorem 3 under assumptions a 1 and a 2 the following hold ht 2 it 1 t 3 ci i p t 2 it 1 t 3 cip 49 19 proof since by the previous discussion any operator t s can be factored as t a 1 a 2 where a 1 c 2 a 2 a 2 a 1 2 a 2 2 1 and t 1 a 1 2 a 2 2 the duality identity 12 yields sup t s t 1 1 tr tt 2 it 1 t 3 ci sup a 2 2 1 a 2 a 2 a 1 2 1 a 1 c 2 tr t 2 it 1 t 3 cia 2 a 1 ht 2 it 1 t 3 ci by 48 by theorem 2 1 29 the hankel operator is a compact operator if and only if b belongs to the space bc 2 2 k it follows in our case that under assumption a 2 ht 2 it 1 t 3 ci is a compact operator on a 2 a basic property of compact operators on hilbert spaces is that they have maximizing vectors that is there exists an a a 2 a 2 1 such that ht 2 it 1 t 3 ci ht 2 it 1 t 3 cia 2 that is a a achieves the norm of ht 2 it 1 t 3 ci we can then deduce from 12 an expression for the optimal tv youla parameter qo as follows ht 2 it 1 t 3 ci ht 2 it 1 t 3 cia 2 ht 2 it 1 t 3 ci qoa 2 i p t 2 it 1 t 3 cia qoa 2 t 2 it 1 t 3 cia qoa 2 t 2 it 1 t 3 ci qo a 2 t 2 it 1 t 3 ci qo ht 2 it 1 t 3 ci all terms must be equal and then i p t 2 it 1 t 3 cia qoa 2 t 2 it 1 t 3 cia qoa 2 50 since t 2 it 1 t 3 cia qoa i p t 2 it 1 t 3 cia qoa p t 2 it 1 t 3 cia qoa and p t 2 it 1 t 3 cia qoa 0 the tv optimal qo can then be computed from the following operator identity qoa t 2 it 1 t 3 cia ht 2 it 1 t 3 cia 51 the upshot of these methods is that they lead to the computation of within desired tolerances by solving two finite dimensional convex optimizations 20 8 numerical computation of the optimal solution in this section a numerical solution based on duality theory is developed if en n 0 1 2 is the standard orthonormal basis in 2 x then q n 2 is the linear span of ek k n 1 n 2 the matrix representation of a bc 2 2 w r t this basis is lower triangular note pn i q n i as n in the strong operator topology sot if we restrict the minimization in 12 over q bc 2 2 to the span of en n 0 1 2 n that is pn 2 2 n this yields a finite dimensional convex optimization problem in lower triangular matrices qn of dimension n that is qn q 11 0 0 q 21 q 22 0 qn 1 qn 2 qn 3 qnn 52 and the optimization n inf qn bc pn 2 pn 2 t 2 it 1 t 3 ci qn 53 where t 2 it 1 t 3 ci qn t 11 q 11 t 12 t 13 t 1 n t 1 n 1 t 21 q 21 t 22 q 22 t 23 t 2 n t 2 n 1 t 31 q 31 t 32 q 32 t 33 q 33 t 3 n t 3 n 1 tn 1 qn 1 tn 2 qn 2 tn 3 qn 3 tnn qnn tn n 1 t n 1 1 t n 1 2 t n 1 3 t n 1 n t n 1 n 1 54 where tij are fixed and correspond to the entries of t 2 it 1 t 3 ci andqij are variable the optimization n overestimates but n and results in upper bounds and suboptimal tv parameters qn o and control laws since q is restricted to a proper subspace of bc 2 2 by arveson distance formula 1 the minimization 53 is equal to n max 1 n n i q n t 2 it 1 t 3 ci q n 55 21 the degree of suboptimality can be computed explicitly as follows applying the same argument to the dual optimization on the rhs of 12 by restricting s to the finite dimensional subspace sn tn c 1 pn 2 pn 2 i q n tn q n 1 0 for all 0 n n 1 56 in fact with respect to the canonical basis ei i 0 1 for pn 2 the subspace sn is nothing but the space of n n strictly lower triangular matrices the dual optimization becomes n sup tn sn tn 1 1 tr tn t 2 it 1 t 3 ci n 57 where t 2 it 1 t 3 ci n is the restriction of the operator t 2 it 1 t 3 ci to pn 2 the supremum in 57 is in fact a maximum since 57 is a maximization of a continuous linear functional over a compact set the optimization 57 is a finite variable constrained convex optimization in the strictly lowers entries of tn which yields lower bounds for since the dual optimization involves a supremum rather than an infimum i e n and suboptimal tn o the optimization problem 57 is in fact a semi definite programming problem sdp since tn 1 1 if and only if there exist matrices y z rn n such that 42 43 y tn t tn z 0 try trz 2 58 the optimization 57 becomes then supremum tr tn t 2 it 1 t 3 ci n 59 subject to 58 pntn i pn 1 0 n 0 1 n 1 where pn is the n n truncation matrix having as its first n columns the standards basis vectors ei i 1 2 n and the remaining columns as n 1 zero vectors that is pn e 1 e 2 en 0 0 22 under assumption a 2 t 2 it 1 t 3 ci and the optimal qo are compact and by a compactness argument we have that qn o qo in the operator topology i e qo qn o 0 as n likewise tn o to as n 0 in the trace class topology since pn i as n in the sot it is straightforward to show that these upper and lower bounds n and n converge to the optimum as n these optimizations estimate within known tolerance and compute the corresponding ltv operators qn which in turn allow the computation of ltv controllers k through the youla parametrization solving such problems are then applications of finite variable convex programming techniques note the size of the truncations depends on the degree of accuracy desired however the size required for a particular accuracy can be exactly estimated by looking at the difference between the optimization 55 and the dual optimization 57 for periodic systems 40 say of period q it suffices to take the first q vectors en qn 1 of the standard basis i e n q in this case and for finite horizon problems the finite dimensional convex optimizations yield exactly the optimal corresponding tv youla parameter qo and hence the optimal tv controller 9 the mixed sensitivity problem for ltv systems the mixed sensitivity problem for stable plants 44 46 involves the sensitivity operator t 1 w 0 the complementary sensitivity operator t 2 w v p and t 3 i which are all assumed to belong to bc 2 2 2 and is given by the optimization o inf q bc 2 2 w 0 w v pq 60 where stands for the operator norm in b 2 2 2 given by b sup x 2 1 x 2 b 1 x 22 b 2 x 22 1 2 b b 1 b 2 61 the optimization problem 60 can be expressed as a distance problem from the operator t 1 to the subspace s t 2 p bc 2 2 of b 2 2 2 to ensure closedness of s we assume that w w v v 0 i e w w v v as an operator acting on 2 is a positive operator then there exists an outer spectral factorization 1 bc 2 2 23 invertible in bc 2 2 such that 1 1 w w v v 1 11 consequently 1 p as a bounded linear operator in bc 2 2 has an inner outer factorization u 1 g where u 1 is inner and g an outer operator defined on 2 3 next we assume a 3 g is invertible so u 1 is unitary and the operator g and its inverse g 1 bc 2 2 a 3 is satisfied when for e g the outer factor of the plant is invertible let r t 2 1 1 u 1 assumption a 3 implies that the operator r r b 2 2 has a bounded inverse this ensures closedness of s according to arveson corollary 2 1 the self adjoint operator r r has a spectral factorization of the form r r where 1 bc 2 2 define r 2 r 1 then r 2 r 2 i and s has the equivalent representation s r 2 bc 2 2 after absorbing into the free parameter q the optimization problem 60 is then equivalent to o inf q bc 2 2 t 1 r 2 q 62 to solve the tv optimization 62 it suffices to apply the duality results of section 3 the latter yields the predual space of b 2 2 2 under trace duality as the banach space isometrically isomorphic to c 1 b b 1 b 2 bi c 1 63 under the norm b 211 tr b 1 b 1 b 2 b 2 1 2 64 the preannihilator s of s is characterized in the following lemma lemma 2 the preannihilator s can be computed as s r 2 s i r 2 r 2 c 1 65 where denotes the direct sum of two subspaces proof to show 65 notice that tr t 0 t in s for b 2 2 2 is equivalent to i rr 0 and r a for some a bc 2 2 this implies that a r by taking the adjoints we get r 2 a s 24 the following lemma is a consequence of 8 lemma 3 under assumption a 3 there exists at least one optimal tv operator qo bc 2 2 s t o t 1 r 2 qo sup s s s 11 1 trt 1 s 66 note that lemma yields 3 not only shows existence of an optimal tv controller k through the youla parameter qo under assumption a 3 but also leads to two dual finite variable convex programming problems using the same argument as in section 8 which solutions yield the optimal qo within desired tolerance a tv allpass property holds also for the tv mixed sensitivity problem under the assumption that t 1 is a compact operator in bc 2 2 2 and o oo where oo infq k t 1 r 2 q i e when the causality condition of q is removed this generalizes the allpass property of section 4 and is summarized in the following lemma lemma 4 if t 1 is a compact operator and o oo then the optimal mixed sensitivity operator t 1 r 2 qo o is a partial isometry from 2 onto 2 2 the condition o oo is sharp in the sense that if it does not hold there exists t 1 and r 2 such that the optimum is not allpass proof the proof is similar to the proof of theorem 1 by working in the predual maximization the details are omitted if o oo does not hold take for example v 1 and w 1 z 2 in which case qo 0 showing that the optimum is not allpass lemma 4 is the tv version of the same notion known to hold in the lti case as shown earlier in 27 using broadband theory and 47 next we show that the mixed sensitivity optimization is equal to the norm of a certain tv hankel topelitz operator in order to do this we use a standard trick in 11 since r 2 r 21 r 22 is an 25 isometry so is u r 2 i r 2 r 2 thus o inf q bc 2 2 u t 1 r 2 q inf q bc 2 2 r 21 w q i r 21 r 21 w r 22 r 21 w call i r 21 r 21 w r 22 r 21 w by analogy with the tv hankel operator defined in section 7 we define the tv toeplitz operator t associated to as t a p a for a a 2 67 the following theorem solves the problem in terms of a tv mixed hankel toeplitz operator theorem 4 under assumption a 3 the following holds 2 o h r 21 whr 21 w t 68 where hr 21 w is the hankel operator associated to r 21 w i e hr 21 wa i p r 21 wa for a a 2 proof to prove 68 define the following operator a 2 a 2 r 2 a 2 w 0 69 where is the orthogonal projection from a 2 a 2 into the orthogonal complement of a 2 a 2 a 2 r 2 a 2 the orthogonal projection can be shown to be given explicitly by 23 i r 2 pr 2 70 it follows from the commutant lifting theorem for nest algebra theorem 20 22 3 that o inf q bc 2 2 t 1 r 2 q 71 26 since u is an isometry and thus preserves norms operator pre composition with u and using the explicit expression 70 of straightforward computations show that o hr 21 w t and therefore 68 holds theorem 4 generalizes the solution of the mixed sensitivity problem in terms of a mixed hankel toeplitz operator in the lti case 27 45 47 to the tv case this result also applies to solve the robustness problem of feedback systems in the gap metric 38 in the tv case as outlined in 11 36 since the latter was shown in 11 to be equivalent to a special version of the mixed sensitivity problem 60 10 conclusion the optimal disturbance rejection problem for ltv systems involves solving a shortest distance minimization problem in the space of bounded linear operators dual and predual representations show existence of optimal tv controllers through the youla parametrization under specific con ditions the optimal solution is compact and satisfies a time varying allpass or flatness condition the proposed approach leads naturally to a numerical solution based on finite variable convex programming which involves solving a sdp problem for the predual and a search over lower trian gular matrices for the dual problem moreover a solution based on a tv compact hankel operator is proposed the latter leads to an operator identity for the optimal tv youla parameter qo a generalization to the mixed sensitivity problem is carried out that draws certain analogies with the lti case future work includes investigation of the numerical solutions by semi define programming and find ing efficient algorithms to take advantage of the special structure lower triangular of qo to solve numerically the dual problem references 1 arveson w interpolation problems in nest algebras journal of functional analysis 4 1975 pp 67 71 2 chapellat h dahleh m analysis of time varying control strategies for optimal disturbance rejection and ro bustness ieee transactions on automatic control 37 1992 1734 1746 3 davidson k r nest algebras longman scientific technical uk 1988 4 g tadmor and m verma factorization and the nehari theorem in time varying systems math control signals systems math of control signals and systems no 5 pp 419 452 1992 27 5 djouadi s m optimal robust disturbance attenuation for continuous time varying systems international journal of robust and non linear control vol 13 2003 1181 1193 6 douglas r g banach algebra techniques in operator theory academic press ny 1972 7 khammash m dahleh m time varying control and the robust performance of systems with structured norm bounded perturbations proceedings of the ieee conference on decision and control brighton uk 1991 8 khammash m j b pearson j b performance robustness of discrete time systems with structured uncertainty ieee transactions on automatic control 36 1991 398 412 9 luenberger d g optimization by vector space methods john wiley ny 1968 10 a ichikawa quadratic games and h type problems for time varying systems int j control vol 54 pp 1249 1271 1991 11 feintuch a robust control theory in hilbert space springer verlag vol 130 1998 12 feintuch a francis b a uniformly optimal control of linear time varying systems systems control letters vol 5 1984 67 71 13 feintuch a francis b a uniformly optimal control of linear feedback systems systems control letters vol 21 1985 563 574 14 schatten r norm ideals of completely continuous operators springer verlag berlin gottingen heidelberg 1960 15 shamma j s robust stability with time varying structured uncertainty proceedings of the ieee conference on decision and control 3163 3168 1992 16 shamma j s dahleh m a time varying versus time invariant compensation for rejection of persistent bounded disturbances and robust stabilization ieee transactions on automatic control 36 1991 838 847 17 p dewilde a j van der veen time varying systems and computations springer verlag 1998 18 zames g owen j g duality theory for mimo robust disturbance rejection ieee transactions on automatic control 38 1993 743 752 19 s m djouadi mimo disturbance and plant uncertainty attenuation by feedback ieee transactions on automatic control vol 49 no 12 pp 2099 2112 december 2004 20 s m djouadi operator theoretic approach to the optimal two disk problem ieee transactions on auto matic control vol 49 no 10 pp 1607 1622 october 2004 21 s m djouadi disturbance rejection and robustness for ltv systems proceedings of the american control conference pp 3648 2653 6080 june 14 26 2006 22 s m djouadi and y li on the computation of the gap metric for ltv systems systems control letters 56 pp 753 758 2007 28 23 s m djouadi and c d charalambous time varying optimal disturbance minimization in presence of plant uncertainty siam j control optimization vol 48 no 5 pp 3354 3367 2010 24 francis b a doyle j c linear control theory with an h optimality criterion siam j control and opti mization vol 25 1987 815 844 25 francis b a a course in h control theory springer verlag 1987 26 zhou k doyle j c glover k robust and optimal control prentice hall 1996 27 m verma and e jonckheere l compensation with mixed sensitivity as a broadband matching problem systems control letters vol 4 pp 125 129 1984 28 holmes r scranton b ward j approximation from the space of compact operators and other m ideals duke math journal vol 42 1975 259 269 29 power s commutators with the triangular projection and hankel forms on nest algebras j london math soc vol 2 32 1985 272 282 30 power s c factorization in analytic operator algebras j func anal vol 67 1986 413 432 31 s m djouadi and c d charalambous on optimal performance for linear time varying systems proc of the ieee 43 th conference on decision and control paradise island bahamas pp 875 880 december 14 17 2004 32 garnett j b bounded analtytic functions academic press 1981 33 feintuch a saeks r system theory a hilbert space approach academic press n y 1982 34 peters m a and iglesias p a minimum entropy control for time varying systems boston birkhuser 1997 35 c foias a e frazho i gohberg and m a kaashoek metric constrained interpolation commutant lifting and systems birkhuser 1998 36 foias c georgiou t and smith m c robust stability of feedback systems a geometric approach using the gap metric siam j control and optimization vol 31 no 6 pp 1518 1537 1993 37 ravi r nagpal k m and khargonekar p p h control of linear time varying systems a state space approach siam j control and optimization vol 29 no 6 pp 1394 1413 1991 38 t t georgiou and m c smith robust stabilization in the gap metric controller design for distributed plants ieee trans on automatic control vol 37 no 8 pp 1133 1143 1992 39 dale w n and smith m c stabilizability and existence of system representation for discrete time varying systems siam j control and optimization vol 31 no 6 pp 1538 1557 1993 40 dullerud g e and lall s a new approach for analysis and synthesis of time varying systems ieee trans on automatic control vol 44 issue 8 pp 1486 1497 1999 41 c pirie and g e dullerud robust controller synthesis for uncerttain time varying systems siam j control optimization vol 40 no 4 pp 13121331 2002 29 42 m fazel h hindi and s p boyd a rank minimization heuristic with application to minimum order system approximation proceedings american control conference volume 6 pages 4734 4739 june 2001 43 l vandenberghe and s boyd semidefinite programming siam review 38 1 49 95 march 1996 44 j c doyle b a francis and a r tannenbaum feedback control theory macmillan ny 1990 45 c foias h ozbay and a r tannenbaum robust control of infinite dimensional systems springer verlag berlin heidelberg new york 1996 46 zhou k and doyle j c essentials of robust control prentice hall 1998 47 djouadi s m and birdwell j d duality theory of the optimal two block h problem int j robust nonlinear control vol 18 pp 13021316 2008 48 g zames and b a francis feedback minimax sensitivity and optimal robustness ieee trans on automatic control vol 46 issue 5 pp 585 601 may 1983 30 1 introduction 2 problem formulation 3 duality 4 tv allpass property of the optimum 5 m ideals and compact youla tv parameters 6 on the uniqueness of the optimal tv controller 7 triangular projections and hankel forms 8 numerical computation of the optimal solution 9 the mixed sensitivity problem for ltv systems 10 conclusion