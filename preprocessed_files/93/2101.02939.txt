this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible abstract in this paper a novel machine learning derived control performance assessment cpa classification system is proposed it is dedicated for a wide class of pid based control industrial loops with processes exhibiting dynamical properties close to second order plus delay time sopdt the proposed concept is very general and easy to configure to distinguish between acceptable and poor closed loop performance this approach allows for determining the best but also robust and practically achievable closed loop performance based on very popular and intuitive closed loop quality factors training set can be automatically derived off line using a number of different diverse control performance indices cpis used as discriminative features of the assessed control system the proposed extended set of cpis is discussed with comprehensive performance assessment of different machine learning based classification methods and practical application of the suggested solution as a result a general purpose cpa system is derived that can be immediately applied in practice without any preliminary or additional learning stage during normal closed loop operation it is verified by practical application to assess the control system for a laboratory heat exchange and distribution setup index terms control performance assessment pid control machine learning pattern classification diagnostic analysis practical validation i introduction n modern industrial control systems high control performance of low level controllers is crucial for efficient process operation 1 this high performance is usually ensured by proper design 2 3 and tuning 4 of the this work was financed in part by the grant from sut subsidy for maintaining and developing the research potential in 2021 j czeczot p nowak t klopot and by bkm grant bkm 723 rau 3 2020 p grelewicz and co financed by the european union through the european social fund grant powr 03 02 00 00 i 029 p grelewicz calculations were done with the use of geconii infrastructure poig 02 03 01 24 099 corresponding author j czeczot p grelewicz j czeczot p nowak and t klopot are with silesian university of technology faculty of automatic control electronics and computer science department of automatic control and robotics gliwice 44100 poland e mail jacek czeczot polsl pl t t khuat and b gabrys are with university of technology sydney faculty of engineering and it advanced analytics institute new south wales 2007 australia controllers e g using virtual commissioning approaches 5 6 however it is reported by practitioners that the quality of the control usually degrades over time due to fluctuations of process dynamics e g resulting from slow fouling slow decrease in accuracy of sensors and actuators or periodical modifications in production operating conditions 7 the latter can result from unpredictable changes in a source of raw materials periodical variations of major process disturbances etc this category also includes cases when controllers that operate the process were not properly tuned at the stage of commissioning and resulting production losses are not visible and evident these facts are confirmed in the literature where the performance of over 60 of control loops has been observed to be poor 8 and in the vast majority of cases such a poor performance has resulted from a bad tuning of the controllers 9 thus periodical control performance assessment cpa becomes more and more important it can be considered as inessential part of fault detection systems that play a very important role in modern industry 10 and whose application is necessary to meet the requirements of industry 4 0 in terms of preserving the best process efficiency 11 12 poor control performance must be detected and appropriate actions e g appropriate controller retuning must be taken which is not easy when hundreds or even thousands of closed loops simultaneously operate on the process comparing the actual performance of a control system with its reference performance is the fundamental principle underpinning various cpa algorithms for a wide range of applications the proposed procedure should therefore give explicit assessment if the control performance is satisfactory or poor by assessing how close it is to the desired reference performance many cpa algorithms have been developed over last decades based on more or less complex mathematical and statistical approaches and they have gained popularity in both academia 13 14 and industry 15 16 apart from general approaches some dedicated solutions were also reported in 17 authors derive cpa method that is an important part of iterative learning control ilc algorithm for control of batch processes dedicated cpa methods can be also applied for the design of fault tolerant control an example of such application for the fault tolerant control of singular systems was reported in 18 application of machine learning to performance assessment for a class of pid based control systems patryk grelewicz thanh tung khuat member ieee jacek czeczot pawel nowak tomasz klopot and bogdan gabrys senior member ieee i this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible the first group of cpa methods is based on performing a comparison between the current control performance and the best observed so far in terms of the variance of manipulating and process variables 19 22 these methods are based on normalized indices and their interpretation is clear however there is no explicit classification if the control performance is acceptable or not and how much this performance can be improved additionally results depend strongly on stochastic characteristics of the process disturbances that in practice are often unknown and time varying thus these cpa algorithms can be used for monitoring a degradation in the control performance but not for its absolute assessment they require a long learning time to get reliable information about the so far the best performance which is not readily and easily available thus they require an initial stage of collecting process data and then they can detect degradation compared to the so far the best performance but they fail when this detected best performance is far from the best achievable performance the second group of methods is based on deriving and using general control performance indices cpis that can be calculated for certain deterministic properties of a control system like a set point tracking and or disturbance rejection based on time responses different cpis can be proposed such as settling time maximum overshoot absolute square error etc 7 and it has already been shown that there exists a correlation between their values and the variance based performance measures 23 an application of these cpis has been suggested for quantitative comparison between different controllers and or different tunings and a list of different cpis is very long however they focus on very limited properties of closed loop response and there is a lack of general rules regarding the way of using them for an explicit cpa additionally there are no general reference values of cpis and these reference values are case dependent and must be adjusted accordingly for each new case thus when cpis are used for cpa problems this approach has the same limitations as the algorithms described in the above paragraph in terms of the initial learning time and detecting the difference between so far the best performance and the best achievable performance the motivation for this research was to derive a general purpose cpa and in this paper it is tackled by proposing a machine learning derived cpa classification system so far in the vast majority of cases ml methods are used for developing performance assessment systems but only for explicit technological process e g for smelting process of electro fused magnesium furnace 24 more general approach can be found in 25 where the application of the knn method to evaluate the performance of pid control system is demonstrated multi class svm has been proposed in 26 where based on time response data the acf coefficient and statistical features are calculated indicating potential problems with control system proposed cpa is much more general even if its application is limited to conventional pid based control loops working on a broad class of processes exhibiting dynamical properties close to second order delay time sopdt in industrial practice this limitation is not very strong because pid controllers are still the most frequently used in low level control loops and the vast majority of industrial processes can be accurately approximated by sopdt dynamics the proposed cpa system is based on the predefined reference disturbance rejection response of control system subject to sopdt parameters and reference pid tuning the acceptable deviation of this response is defined and a training dataset is generated by systematically simulating and recording acceptable and not acceptable disturbance rejection responses together with a set of related cpis calculated from these responses once generated this training dataset is used to train machine learning ml based classifiers to find accurate mapping between the cpis and the class label i e if the quality of control is acceptable or not as part of the analysis of the feasibility and accuracy of such a mapping and its usefulness in control settings a comprehensive comparative analysis of a wide range of ml based classification algorithms and an assessment of useful discriminative information contained in the proposed set of cpis have also been performed a simulation based validation shows applicability of the proposed cpa procedure to the pid based closed loop systems with processes exhibiting different dynamical properties finally practical cloud based implementation of this system for plc based control loop is presented and experimental results show practical applicability of the proposed concept and its implementation the major novelty of this paper results from introducing the general concept of a machine learning based cpa system for a wide class of industrial control loops easy to configure off line to distinguish between acceptable and poor closed loop performance by determining the best but also robust and practically achievable closed loop performance based on very popular and intuitive closed loop quality factors as a result this system can be immediately applied in practice without any preliminary or additional learning stage during normal closed loop operation the rest of this paper is organized as follows section ii presents the statement of the problem the design of the cpa system is discussed in section iii with a detailed analysis of an ml approach for the classification of a control performance presented in section iv both simulation studies and a practical verification are summarized in section v finally section vi concludes the paper the main body of the paper is also complemented with the supplemental materials that present more implementation and validation results details for better clarity section viii of supplemental material includes the list of used abbreviations table s ix and symbols table s x ii statement of the problem this study concentrates on the design of possibly the most general cpa system dedicated to classifying the control performance of closed loop systems with a conventional pid controller shown in fig 1 the control goal is defined to keep this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible the process output y at a set point sp by minimizing the control error e sp y with an efficient rejection of external disturbances the concept of a cpa system is also shown in fig 1 it is based on a direct assessment of the load disturbance rejection occurring as a result of a closed loop system excitation with a step change of an artificially introduced load disturbance d this procedure can be enabled manually on demand of a user or applied periodically by a supervisory control system on a predefined schedule when the cpa procedure is enabled the system monitors the process output to detect a steady state and then the load disturbing step change d is applied to the closed loop system and the resulting response of the process output is collected until this disturbance is fully rejected and a new steady state is detected then the disturbing d is canceled and the control system returns to its normal operation while the cpa system computes certain features of the collected response and classifies whether the control performance is acceptable ok or not acceptable nok pid process steady state detection d generation process model identification simulation cpis calculation classification d cpis features sp y decision ok nok cpa initialization d cpa system fig 1 pid based closed loop system with schematic diagram of designed cpa system the proposed cpa system concentrates on assessing the disturbance rejection because in a process automation vast majority of control systems are designed to provide effective disturbance rejection for a constant or rarely changed setpoint sp note that the concept of the proposed cpa procedure is similar to the self tuning procedure widely applied for practical tuning of industrial pid controllers based on a built in autotuning functionalities the assessment should be based on the purposely and carefully selected set of features of d rejection response these features should represent quantitative measures of the difference between predefined reference and current closed loop disturbance rejection responses while a range of machine learning methods can be applied to compare the predefined reference with the current closed loop response they require generating or collecting of appropriate representative training data which is not a trivial task additionally the cpa system should be effectively trained off line so the assessment is possible without the necessity of any additional training for the target closed loop system this procedure should not require any experience or expertise from the process operators so the explicit assessment is essential it is also assumed that the suggested cpa system should be designed for an on line assessment of the closed loop control systems consisting of a conventional pid controller that operates processes exhibiting possibly a wide range of dynamical properties iii design of cpa system general concept of the suggested cpa system requires solving many practical difficulties a steady state detection and d generation practical steady state detection is an important issue and it is required in many practical situations e g for an appropriate initialization of an autotuning procedure or for a signal based process modelling many approaches have been proposed for this purpose and the most practically useful methods are r statistics based method proposed in 27 and a simple but effective increment count method icm proposed in 28 in this work the latter method is used for a steady state detection the amplitude of d should be adjusted to ensure a tradeoff between a sufficient process excitation and preventing from its inadmissible disturbing in practice this is a case dependent value which must be selected based on the process dynamics and technological limitations b definition of reference disturbance rejection response the fundamental concept of the proposed cpa system for pid based control systems comes down to the comparison between the so called reference disturbance rejection response and the current one obtained after enabling cpa procedure thus to ensure as high as possible generality of the cpa system the reference disturbance rejection response must be predefined off line and used for generating training datasets for a pid based control system the reference response depends on the pid tunings and parameters of the process dynamics thus to ensure such high level of generality it is required to assume the most general model of the process possible that ensures the trade off between modeling accuracy and simplicity then the reference pid tunings that ensure reference disturbance rejection response for a given process must be defined for modeling it is assumed that the process can be precisely approximated by sopdt dynamics with the following parameters gain k time constants 1 2 and delay time 0 this assumption does not cause a very significant limitation as the majority of the industrial processes are self regulating and stable at the same time contrary to very popular fopdt first order delay time approximation sopdt model provides more precise approximation of higher order process dynamics sopdt model parameters can be easily computed from the process step response 28 but also from the closed loop rejection of intentionally applied load this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible disturbance d when current pid tunings and d amplitude are known in practice sopdt time constants 1 2 and delay time 0 can take positive but unlimited values and process gain can be also unlimited thus appropriate scaling is suggested based on 29 and when this is performed the sopdt approximation is described by normalized unitary gain and two relative dynamical parameters l 1 0 1 0 and l 2 2 1 both parameters l 1 and l 2 are limited between the values of 0 to 1 regardless of the values of the real sopdt parameters additionally the proposed cpa system is derived for sopdt processes with additionally limited values of l 1 0 1 0 6 and l 2 0 1 1 0 these limitations include processes for which application of pid controller is practically justified for l 1 0 6 delay time is dominant and more advanced control strategies are suggested at the same time for l 1 l 2 0 1 a conventional pi controller can be easily tuned and applied for a given sopdt process defined by unitary gain and l 1 l 2 parameters the reference disturbance rejection response can be determined by adjusting the reference pid tunings gain kr integral constant ti and derivative constant td note that the designed reference response should be not only achievable for a pid controller operating on a given process but also the corresponding reference pid tunings should preserve practical requirements defined for the control system such as its robustness the so called reference tuning is always relative and case dependent and in this work it is based on integral absolute error iae calculated for a disturbance rejection after exciting closed loop system with d for a fixed sopdt process parameters l 1 l 2 and constant d iae value depends only on the pid tunings and can be calculated by simulation as 0 1 where tmax denotes transient time after applying d then based on eq 1 the following three dimensional and constrained optimization problem can be defined 2 5 60 o 2 where am and m denote the gain and phase margins respectively and are defined to ensure desirable robustness of the closed loop and consequently to prevent too aggressive tuning this approach is widely used for deriving tuning rules for various control algorithms e g 30 and numerical solving of eq 2 allows for deriving iae based optimal tunings with desired robustness that in this work is considered as reference pid tunings kr ref ti ref td ref defining limiting gain and phase margins as am 2 5 and 60 o makes this tuning rather conservative but also acceptable from a practical viewpoint because it ensures relatively high closed loop robustness note that it is used only as an example in this work one can apply different pid tuning methods for deriving the desired reference tunings and reference disturbance rejection responses starting with popular experimental methods and ending with advanced optimization based methods c control performance indices cpis as a set of cpa features in this work it is assumed that the proposed cpa is based only on the values of the selected cpis computed from the rejection response to the applied disturbance step change d there are many well known cpis such as settling time maximum overshoot or integral indices in practice they are mainly used for two purposes the first one is to design control systems or derive tuning rules in this case these indicators represent technological requirements or constraints the second purpose of using cpis is for a comparison of the performance of different control systems in this work the additional application of cpis is proposed to assess whether a given load disturbance rejection trajectory is sufficiently similar to a reference trajectory it is easy to see that using a single cpi is not sufficient to illustrate this issue four load disturbance rejection responses for differently tuned examples of pid controllers with the same sopdt process denoted as cs 1 cs 2 cs 3 cs 4 are presented in fig 2 cs 1 is assumed as the reference trajectory characterizing the desired closed loop performance cs 1 cs 2 and cs 3 provide the same settling time cs 1 and cs 4 provide the same maximum peak however all these disturbance responses have distinctly different shapes and characteristics this is due to the fact that a single cpi is able to capture only very limited properties of the dynamic response as a result a single cpi cannot give correct cpa but the key features of load disturbance rejection responses can be captured by a number of different complementary cpis the question arises how many indicators are needed to completely capture the key features of the response of the system and what should they be as part of the investigation we have therefore decided to define and evaluate a wide range cpis many of which are novel and not previously used in the literature in order to ensure that no important information will be omitted in order to systematize cpis selection process the load disturbance rejection response see fig 2 is divided into three stages a dynamical behavior at the first stage starting from the moment of applying d to the moment when the maximum peak appears depends rather on the process dynamics delay time and initial action of the pid controller the behavior at the second stage characterizes the effectiveness of dumping the maximum peak finally at the third stage it can be seen how the closed loop system is driven to a steady state thus intuitively the proposed and selected cpis should capture the key features of each distinct stage of the load disturbance rejection and the key features of the whole response it is worth noting that this is an informal classification that only facilitates the creation of the cpis list and many other classifications can also be applied this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible fig 2 illustrative examples of responses of four differently tuned control systems to a step change of the load disturbance following the above logic as a guidance in this work 30 different cpis have been identified proposed and ultimately selected for further evaluation their complete list is shown in table s i in supplemental material jointly with the graphical clarification of the meaning of some of them in fig s 1 twelve of the considered cpis highlighted with grey color are very popular and commonly used by practitioners i e maximum peak f 1 undershoot f 3 their ratio f 5 settling time f 7 various integral indices f 8 f 11 decay ratio f 15 f 16 and finally minimal and maximal values of response derivative f 28 f 29 cpis f 1 f 28 and f 29 describe the impact of initial controller action on the closed loop rejection response the first overshoot after applying step change of d and rate of output signal change cpis f 3 f 5 f 15 and f 16 focus on how the output signal varies after reaching the maximum peak and it attempts to quantify the aggressiveness level of the control action cpis f 7 f 11 assess the overall closed loop transient time in correlation with the behavior of the control error e the other 18 cpis are novel and their introduction is intended to capture much more nuanced dynamic characteristics of the assessed load disturbance rejection responses hence these indices were mostly selected to complement the first 12 cpis thus the popular cpis f 1 f 3 and f 5 were respectively extended by f 2 f 4 and f 6 to capture time domain features they indicate the moments when overshoot and undershoot appear and their ratio is also captured the absolute integral error index f 8 was extended resulting in f 12 f 14 which are calculated according to different parts of dynamical response described by the sign of the control error e these cpis jointly with other suggested integral indices f 18 f 20 give more accurate information about overall properties of the response and its parts for positive and negative values of control error e settling time f 7 was extended into f 17 f 24 f 27 where more key moments of response in time domain are detected the exceptions are indicators f 21 f 23 which were introduced to fully describe the first peak of the time response they give information about the initial controller action f 21 and how effectively the first peak is dumped f 22 the following sections show that these features have serious impact on the performance of the whole cpa system all considered cpis therefore define features of the assessed control system and they are computed from the applied disturbance rejection step response the proposed list of cpis was analyzed and some preliminary conclusions can be drawn the proposed cpis do not require high computational and memory resources for calculations however the derivative based indices can be problematic to calculate in the presence of measurement noise for real process data in this case some additional filtering should be provided some indicators do not provide a straightforward assessment for example a long settling time can indicate too conservatively tuned control system with sluggish response or on the contrary too aggressive tuning with oscillatory character see fig 2 some of these cpis are not independent e g control system with a long maximum peak time f 2 will probably also have a long rise time f 21 in addition many cpis are computed as ratios of other cpis so one can expect the correlation between them e g f 5 f 14 f 15 f 23 however it is worth emphasizing that these ratio based cpis are invariant for process parameters which is promising in terms of their potential robustness without a need for scaling of the closed loop response subject to process dynamics based on this analysis preliminary intuitive selection of cpis could be made for their suitability for the defined cpa problem however at this stage it was decided to use all of them the possibility of potential reducing the number of indicators in order to avoid redundant information will be presented later in this paper iv machine learning approach to classification models the cpa problem defined in section ii is proposed to be tackled and solved by designing a binary classifier based on a supervised machine learning ml approach the use of a binary classifier ensures the explicit assessment of the control performance i e if the control performance is satisfactory ok then the dynamic response is expected to be similar to its reference or poor nok where the dynamic behavior is different this concept is based on the thesis that a sufficiently large number of different cpis defined in section iii c and capturing diverse but key features of the dynamical load disturbance rejection response can provide consistent and useful information for such classification a generation of training and validation datasets the basis for deriving any classifier using machine learning approaches is the accessibility to training and validation datasets in this case it is assumed that after off line training the designed classifier should be ready for immediate application to operating pid based control systems for their cpa thus the stage of on line training based on continuous observations of the behavior of control system under consideration is intentionally omitted off line training should this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible result in a properly designed classifier that does not require any additional training based on new process data each time when the cpa procedure is enabled load disturbance rejection response of the closed loop system in the presence of the applied d step change is collected and this data is used for sopdt process modeling thus even if process dynamics varies subject to different reasons at a given moment the cpa is made for a pid controller with given tunings and for an instantaneous sopdt approximation of a given process such an approach requires careful generation of both training and validation datasets the basis for this generation is the reference load disturbance rejection trajectories computed by optimization 2 for a large and representative set of different sopdt processes defined by l 1 l 2 dynamical parameters in the assumed ranges for this purpose the assumed ranges of l 1 0 1 0 6 l 2 0 1 1 0 variability were covered by a mesh of equidistant points with l 1 l 2 0 1 so the boundary and internal points of this mesh represent 60 evenly distributed sopdt processes for each of them reference pid tunings were derived by solving optimization problem 2 then based on the spline interpolation between reference pid tunings determined for neighboring mesh points interpolated reference pid tunings were calculated for any combination of l 1 l 2 within the assumed ranges this approach is considered to be sufficiently accurate and it allows for an approximate derivation of the reference pid tunings for each considered sopdt process however if a higher interpolation accuracy is required this mesh can be denser and the procedure can be easily repeated the control performance of a given control system should be assessed as ok when its disturbance rejection response is similar to the reference one that is why more different responses of this closed loop system that are close to the reference response should be generated covering the acceptable region of satisfactory control performance for this purpose reference pid tunings of any considered control system can be modified and corresponding disturbance rejection response can be computed by simulation the modification was made by multiplying each reference pid tuning parameter kr ref ti ref td ref by a random numbers a 1 a 2 and a 3 1 2 3 3 with a normal distribution n 1 0 0225 depending on a degree of this modification one can obtain a control system of acceptable ok or not acceptable nok control performance that can be included in the training and validation datasets for each response all 30 suggested cpis are computed and their values form a feature vector representing the description of the response of the considered control system i e they form a sample for the ml algorithms subject to control performance the binary labelling of each sample as ok or nok is based on two criteria 1 10 acceptable deviation from the gain and phase margin computed for the control system under consideration comparing to am ref m ref values characterizing the benchmark control system for corresponding l 1 l 2 2 predefined normalized distance edist between disturbance rejection responses for the control system under consideration elab and reference eref for given l 1 l 2 4 the control system under consideration is labelled ok if its gain and phase margin fall within the assumed range and edist 0 1 otherwise it is labelled as nok this edist threshold was adjusted experimentally based on preliminary studies which ensures that almost 96 of the control systems that meet this threshold also meet required gain and phase margins however this value can be increased if greater deviation from reference response is acceptable as ok the training dataset was generated by selecting 60 000 control systems samples determined for random values of pairs l 1 l 2 within their assumed ranges and randomly modified reference pid tunings 3 it was ensured that for this training dataset a half of the samples had to be selected from those labelled ok and the other half from the nok class an example of the training dataset with the separation between ok and nok ranges is graphically presented in fig 3 where green dots represent ok cases and red dots are nok for clarity am norm and m norm respectively denote normalized distances of gain and phase margins and thus their acceptable deviations are transformed into 1 1 range fig 3 graphical representation of exemplary training dataset ok and nok performance is marked with green and red colors respectively green box represents assumed range of ok performance the validation dataset was generated in the same way as training dataset though completely independently for other random combinations of values of l 1 and l 2 within their ranges but only 10 000 samples control systems for this dataset were selected it was also ensured that a half was selected from those labelled ok and the other half from nok a feature vector for each sample was computed in the same way as for the training dataset and its labelling was also based on the same procedure this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible b performance assessment of classification models fig 4 classification accuracy for considered classifiers obtained for validation dataset comparison between using popular 12 cpis features and all 30 considered cpis features both for training and validation fig 5 accuracy of tree based learning models on the validation dataset using only top k of the most important features based on the training and validation datasets with 30 cpi features derived as described above the classification performance of various machine learning algorithms for the considered cpa problem was assessed different types of classifiers were selected ranging from the simple to complex but interpretable models such as gaussian na ve bayes gnb 31 linear discriminant analysis lda 32 k nearest neighbors knn 33 decision tree dt 34 and general fuzzy min max neural network trained by an online learning algorithm onln gfmm 35 or an agglomerative learning algorithm agglo 2 36 to less transparent but powerful classifiers including kernel based methods such as support vector machines svm 37 and tree based ensembles such as light gradient boosted machine light gbm 38 extreme gradient boosting xgboost 39 adaptive boosting adaboost 40 extremely randomized trees extra trees 41 and random forest rf 42 apart from gnb and lda hyper parameters of the other models were tuned using random search with the maximum of 100 iterations and 5 fold cross validation to find the best settings in given ranges as shown in table s ii in the supplemental material fig 4 shows the classification accuracy for these classifiers on the validation dataset note that nine models achieved over 91 accuracy and the best model i e svm can achieve more than 96 accuracy this figure additionally shows a comparison with the case when training and validation is based only on 12 most popular cpis features note that in vast majority of the cases the classification accuracy drops significantly which clearly justifies extending the cpis list to the 30 suggested features as will also be illustrated and discussed later a suitable combination of a subset of newly introduced and some of the well known cpis provides the best and most robust discriminative performance for different classifiers it can be seen that simple linear classifiers like gnb or lda cannot reach 80 accuracy on the considered validation dataset the best performances were observed for other non linear models these results indicate the decision boundary between samples of ok and nok classes are of significantly non linear nature and cannot be effectively captured by linear decision boundaries of gnb or lda as a result non linear classifiers were found to be the most appropriate for the cpa classification problem it can be also noted that the use of complex but interpretable models such as dt agglo 2 or knn can result in quite good and competitive classification results compared to the other black box complex models such as svm or tree based ensemble models however the best performance was usually achieved by using powerful non linear classifier such as svm or non linear kernel and boosted ensemble classifiers i e light gbm adaboost and xgboost although the classification accuracy of fuzzy based models such as onln gfmm and agglo 2 was lower than svm or tree based ensemble models a strong argument for the use of these models is that their membership functions can be used to assess how close or far away from the acceptable and non acceptable control performance boundary each of the classified samples is this information can be useful to assess the effectiveness of cpa algorithms for monitoring the degradation of controllers in a dynamically changing environment and decide right times to retune the controllers this opens an interesting research direction for future studies for the tree based models one of their interesting characteristics is the ability to extract individual cpis importance scores given these importance scores for each tree based model the same classifiers were trained using only the top k of the most important features with k ranging from 1 to all 30 features feature ranking and classification performance of classifiers on subsets of the most important features are given in table s iv in the supplemental material fig 5 summarizes the accuracy of these tree based models on different subsets of the top k of important features it can be observed that the accuracy of tree based learners using from 8 to 15 of the most important features can achieve nearly equal or even better performance on the validation set compared to the case of using all 30 cpis this result poses a question of the optimal subset of cpis which can be used in practice to attain the best classification performance of cpa systems instead of employing all of the proposed features this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible while noting that substantially smaller set of features can be effectively used as highlighted in table s iv in the supplemental material the subsets may be different for different classifiers identifying a robust minimal subset of discriminative features i e cpis is out the scope of the current study and will be analyzed in more details in the future research nevertheless to provide further insights of what such reduced set of the cpis may entail we will now analyze the top 10 cpis with which the adaboost the best performing algorithm in fig 5 algorithm obtained the best classification performance see table s iv in supplemental material these 10 cpis are a mixture of more traditional indices and a number of the proposed in this study cpis as we can see top two of them f 30 and f 23 are the newly proposed ones and jointly with f 1 f 28 and f 29 they mainly describe the properties of the first peak of the closed loop disturbance rejection response while f 17 directly indicates the moment of time when this first peak appears partially f 3 and f 20 also relate to the first peak but they mainly inform about the properties of undershoot that may appear in some cases f 9 and f 14 refer to the entire shape of the closed loop rejection response by quantifying integral square or absolute error and ratio of periods of time when control error has a negative and positive value once again note that these properties are not sufficiently described by a single cpi for example rising and falling of the first peak are described by f 23 and f 30 but even if by intuition they seem to be highly correlated they both have a strong impact on classification accuracy because the order in table s iv indicate their greatest importance it is also worth noting that a large group of cpis is calculated as a ratio between other cpi f 14 f 20 f 23 f 30 even if f 30 is a ratio between f 28 and f 29 with the greatest importance both f 28 and f 29 also play an important role in the construction of cpa classifier because they supplement the ratio based f 30 summarizing it seems that the properties shape rising and falling times etc of the first peak of the disturbance rejection response jointly with the description of the potential undershoot play the most important role in assessing the control performance in the next section the effectiveness of learning models on simulation based and real process data is further assessed and discussed v simulation validation of cpa system this section presents the results of the cpa performance based on svm classifier selected due to its highest accuracy amongst all evaluated classifiers as reported in the previous section a validation for sopdt processes simulation based validation of the proposed cpa system was made for the selected svm classifier but the classification accuracy obtained for the other classifiers for the simulation data is also shown in table s v in the supplemental material simulation based validation was divided into two stages at the first stage initial validation was carried out by simulating the control systems with two different fixed sopdt process respectively defined by l 1 0 4 l 2 0 5 and l 1 0 3 l 2 0 9 for each process the testing dataset was generated by applying 35 different pid tunings based on fopdt approximation of the process step response and arbitrarily selected from 43 thus both testing datasets consist of 35 samples each sample representing a different pid tuning method for the same sopdt process fig 6 left confusion matrix obtained for svm classifier and test dataset right graphical presentation of testing dataset according to gain and phase margins and edist sopdt l 1 0 4 l 2 0 5 fig 7 comparison of reference response thick black plot with testing control systems classified as ok green upper plots and nok red lower plots sopdt l 1 0 4 l 2 0 5 fig 6 shows the classification accuracy for the testing dataset representing sopdt with l 1 0 4 l 2 0 5 which for this case is perfect i e 100 fig 7 shows the disturbance rejection responses for each sample from this testing dataset note that those classified as ok are very similar to the reference response of the control system with the considered sopdt process at the same time responses classified as nok are far from it and some of them are surely not acceptable in practice for the second testing dataset representing sopdt process with l 1 0 3 l 2 0 9 one set of pid tunings leads to unstable behavior the classification accuracy shown in fig 8 is still very high but not perfect one control system was this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible misclassified as nok while in accordance with the labelling methodology described in section iv a it should be classified as ok fig 9 shows its disturbance rejection response however graphical representation of this testing dataset shows that the misclassified sample is very close to the border of nok region it is obvious that in practice the accuracy of classifiers will not be perfect especially when testing samples are relatively close to the border between ok and nok classes to further distinguish between the cases close to the decision boundaries and provide additional information beyond the class labels the membership functions of gfmm classifiers can be used and will further be explored in the follow up studies fig 8 left confusion matrix obtained for svm classifier and test dataset right graphical presentation of testing dataset according to gain and phase margins and edist sopdt l 1 0 3 l 2 0 9 fig 9 comparison of reference response thick black plot with testing control system misclassified as nok red plot sopdt l 1 0 3 l 2 0 9 b comparison with existing methods the suggested cpa system was compared with other existing cpa methods based on disturbance rejection response data the performance can be assessed with r index 44 idle index 45 area index 46 and load disturbance rejection performance ldr index 47 these indices are more general than individual cpis and they can be applied for more precise assessment of control performance based on their values shown in table s vi in supplemental material assessing procedure was similar to one applied for the testing of the suggested cpa system based on the generated simulation datasets for l 1 0 4 l 2 0 5 and l 1 0 3 l 2 0 9 cpa indices selected for comparison were calculated and the results are presented in supplemental material in tables s vii and s viii they are color coded according to table s vi where ok and nok assessment is highlighted with green and red colors respectively for better clarity the results are also presented in graphical form in fig s 4 one can notice that the application of cpa indices selected for this comparison do not ensure distinguishing between ok and nok samples thus it is not possible to correctly assess the control performance based on individual cpa indices in 48 authors suggest application of both idle index and area index for more precise assessment however even focusing on all of the selected indices without any systematic framework does not ensure proper assessment one can notice that for l 1 0 4 l 2 0 5 there are several process responses no 16 27 28 and 29 which are assessed as ok by all of the cpa methods selected for comparison but based on criteria chosen for deriving proposed cpa system the performance is poor nok these process responses are presented in fig s 3 and their dynamic behavior is different from predefined reference additionally one can notice even oscillatory behavior which is not acceptable from practical viewpoint the suggested cpa system was also compared with harris index 49 which is a more complex method for cpa harris index requires stochastic type disturbance and for this purpose several steps of load disturbance with different amplitude were applied to the assessed control systems for l 1 0 4 l 2 0 5 and l 1 0 3 l 2 0 9 with selected tunings note that in this case much more aggressive excitation must be applied to the closed loop system comparing to a single step change of load disturbance required for the suggested cpa system the results of the assessment with harris index are also presented in supplemental material in tables s vii and s viii harris index is normalized from 0 worse performance to 1 best performance and it compares the performance of actual control system with the performance which can be achieved for the minimum variance controller however in practice the minimum variance controller is not applicable thus it is impossible to reach unitary value of harris index it is not clear what value of harris index is achievable for pid based closed loop system so in practice its reference value is unknown thus the explicit assessment based on harris index can be a challenging task due to its ambiguity c validation for higher order processes the second stage of simulation based validation was carried out for two processes whose dynamical properties are significantly different from sopdt and their sopdt approximation was used only for cpa their dynamical properties are given by transfer functions taken from 50 with an additional supplementation of g 2 s with scalable delay time term 1 1 1 5 a 2 1 1 1 1 2 1 3 5 b both transfer functions 5 can be parameterized by adjusting the value of and table i shows the selected processes considered for the validation of the cpa system note that the precise selection of allows to obtain processes whose sopdt approximations quite evenly cover the this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible assumed range of l 1 l 2 table i selected processes used for cpa validation process acronym transfer function l 1 l 2 fig no in suppl mat p 1 g 1 3 0 27 1 0 s 5 p 2 g 1 4 0 41 1 0 s 6 p 3 g 2 0 25 0 24 0 28 s 7 p 4 g 2 0 3 0 28 0 33 s 8 p 5 g 2 0 4 0 37 0 5 s 9 p 6 g 2 0 5 0 49 1 0 s 10 p 7 g 2 0 6 0 53 1 0 s 11 last column shown numbers of figures showing results for corresponding processes in section vi in supplemental material for each process 20 different sets of pid tunings were selected representing 20 different control systems samples some of them were based on well known tuning methods 40 while the others were adjusted by the trial and error method to obtain the possibly highest control performance then for each set of the pid tunings and each process the same cpa system designed as described above was applied it was operated with the applied load disturbance d 1 detailed results of this stage of validation are presented in section vi in the supplemental material for each considered process p 1 p 7 it can be seen that sopdt model provides more precise approximation of dynamical properties in comparison with more popular fopdt model this observation additionally justifies the choice of sopdt modelling as more precise and general one can also note that for processes p 3 p 7 that are based on dynamics given by eq 5 b the reference disturbance rejection response of the real process is very close to the one obtained for the closed loop system with corresponding sopdt approximation for processes p 1 p 2 that are based on dynamics given by eq 5 a this similarity is lower but the shapes and major properties are still preserved when it comes to cpa results obtained for the suggested system one can see that the accuracy of classification is very high for each process rejection responses classified as ok are close to corresponding reference rejection trajectory while those classified as nok significantly deviate from it once again due to accuracy of sopdt approximation for processes p 3 p 7 responses classified as ok are very close to their reference for processes p 1 p 2 responses classified as ok are more different than their reference but still these differences are acceptable compared to cases of rejection responses classified as nok at the same time even if these differences are more noticeable in comparison with processes p 3 p 7 responses classified as ok form their own similar shape and in this sense they form their own reference slightly different from those obtained for sopdt approximations but still acceptable from the practical viewpoint vi experimental validation to further evaluate and strengthen the argument in support of the proposed approach an experimental validation was performed based on the part of laboratory heat exchange and distribution plant shown in fig 10 experiments were carried out for the electric flow heater with adjustable heating power ph within the range 0 100 of maximal power 12 kw the water flows through the heater with the flow rate f and temperature is measured at the heater inlet tin and outlet tout the control goal is defined to ensure that tout tsp temperature setpoint by manipulating heating power manipulating variable this process exhibits higher above second order dynamics with significant delay time so its dynamical properties are different from sopdt used for the training of the cpa system t heating unit f t fc tc v tout tin f tsp fsp fig 10 the overview left and simplified diagram right of laboratory setup fig 11 comparison of reference responses thick black plots with testing control systems classified as ok green upper plots and nok red lower plots obtained from laboratory setup details of the practical cloud based implementation of the proposed cpa system in the application to cpa of a pid controller implemented in siemens s 7 1500 plc and operating the process are presented in section vii in the supplemental material this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible for constant flow rate f 3 5 l min similarly to the second stage of simulation based validation 20 different sets of pid tunings were selected to represent 20 different control systems samples then for each set of the pid tunings a laboratory setup was operated and the cpa procedure was executed it was operated with the applied load disturbance d ph 10 the classification for 20 collected experimental rejection disturbance step responses are shown in fig 11 for the visualized measurement data one can see a presence of the quantization resulting from limited sensor resolution note that in this case corresponding reference responses are slightly different for each cpa experiment it results from the fact that in practice it is impossible to obtain the same results even in the same conditions thus for each cpa experiment sopdt approximation of the real disturbance rejection step response is slightly different the results show very high classification accuracy for the selected svm model in the application to cpa of the real process exhibiting dynamics more complex than sopdt rejection responses classified as ok are close to the corresponding reference rejection trajectories while those classified as nok are significantly different and not acceptable in practice vii conclusions this paper introduces the concept of machine learning ml based cpa system and investigates its application to assess the performance of pid based control loops operating processes that exhibit dynamics close to sopdt the proposed concept is based on fusion of up to 30 individual diverse cpis computed from the disturbance rejection step response of the assessed control system these cpis are used as input features to the ml based classification system a comparative analysis of a wide range of different machine learning algorithms is presented and important conclusions are drawn in terms of potential reduction of a number of features required for an accurate classification set of the considered cpi features consists of 12 very popular cpis and 18 additional ones specifically proposed for this study the classification accuracy and feature importance analysis showed that in general these additional features provide more effective discriminative representation of properties of the assessed control systems thus the results indicated that a relatively small subset of them can be used for an accurate assessment of the control performance if a load disturbance step change required for their calculation can be applied the proposed cpa system partially falls within the category of data driven implementation of active fault detection systems 51 52 with model based and signal based approach from that perspective the considered degradation of control performance does not fall into the category of faults that require fast service replacement activities and its bad influence can be compensated only by periodical retuning of operating controller however the proposed cpa system can be included as a part of more complex fault detection isolation and identification system that can suggest further actions e g replacement of a sensor or actuator when the controller retuning is no longer sufficient thus the application of the proposed cpa system allows not only for improvement in the control performance by periodical controller retuning but it can also postpone the moment of replacing the partially worn out parts the proposed approach requires identification of sopdt process parameters from the closed loop disturbance rejection response thus it allows also for adding the functionality of retuning the pid controller this possibility is beyond the scope of this work but readers should note that once sopdt process approximation is known it can be used for suggesting the pid controller tunings that provide the desirable control performance promising results show that this concept can be extended to other classes of control systems which are based on different even advanced controllers operating processes exhibiting different even more complex dynamics at the same time the proposed framework itself is general and flexible which is shown by clock diagram presented in section iii in supplemental material after redefining some initial assumptions this approach can be reconfigured to current needs and used for off line designed of a new cpa system the proposed approach with some indicated extensions forming our future research directions can be also applied for the assessment of tracking properties of the operating control systems the included example of practical implementation shows potential applicability and easy transferability of the proposed cpa system into the industrial practice references 1 z yuan b chen g sin and r gani state of the art of progress in the optimization based simultaneous design and control for chemical processes aiche journal vol 58 no 6 pp 1640 1659 2012 2 t klopot p skupin p grelewicz and j czeczot practical plc based implementation of adaptive dynamic matrix controller for energy efficient control of heat sources ieee trans ind electron vol 0046 no c pp 1 1 2020 doi 10 1109 tie 2020 2987272 3 p nowak k stebel t klopot j czeczot m fratczak and p laszczyk flexible function block for industrial applications of active disturbance rejection controller archives of control science 28 3 2018 349 400 4 t klopot p skupin m metzger and p grelewicz tuning strategy for dynamic matrix control with reduced horizons isa trans mar 2018 doi 10 1016 j isatra 2018 03 003 5 m fratczak p nowak t klopot j czeczot s bysko and b opilski virtual commissioning for the control of the continuous industrial processes case study 2015 20 th international conference on methods and models in automation and robotics mmar pp 1032 1037 mi dzyzdroje poland 6 p grelewicz p nowak m fratczak t klopot practical verification of the advanced control algorithms based on the virtual commissioning methodology a case study in proc 23 rd international conference on methods and models in automation and robotics mmar miedzyzdroje poland 2018 pp 217 222 7 m jelali control performance management in industrial automation assessment diagnosis and improvement of control loop performance springer verlag london 2013 8 t samad and a annaswamy the impact of control technology 2 nd edition 2014 this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible 9 p van overschee and b de moor rapid the end of heuristic pid tuning ifac proc vol vol 33 no 4 pp 595 600 2000 doi 10 1016 s 1474 6670 17 38308 8 10 l zhang j lin and r karim sliding window based fault detection from high dimensional data streams in ieee transactions on systems man and cybernetics systems vol 47 no 2 pp 289 303 feb 2017 doi 10 1109 tsmc 2016 2585566 11 w caesarendra t wijaya b k pappachan and t tjahjowidodo adaptation to industry 4 0 using machine learning and cloud computing to improve the conventional method of deburring in aerospace manufacturing industry proc 2019 int conf inf commun technol syst icts 2019 pp 120 124 2019 doi 10 1109 icts 2019 8850990 12 s k panda a blome l wisniewski and a meyer iot retrofitting approach for the food industry ieee int conf emerg technol fact autom etfa vol 2019 september pp 1639 1642 2019 doi 10 1109 etfa 2019 8869093 13 c zhan s li and y yang improved process monitoring based on global local manifold analysis and statistical local approach for industrial process j process control vol 75 pp 107 119 2019 doi 10 1016 j jprocont 2018 12 016 14 f shahni w yu and b young rapid estimation of pid minimum variance isa trans vol 86 pp 227 237 2019 doi 10 1016 j isatra 2018 10 047 15 k d starr h petersen and m bauer control loop performance monitoring abb s experience over two decades ifac papersonline vol 49 no 7 pp 526 532 2016 doi 10 1016 j ifacol 2016 07 396 16 l desborough and r miller increasing customer value of industrial control performance monitoring honeywell s experience aiche symp ser vol 98 jan 2002 17 y wang h zhang s wei d zhou and b huang control performance assessment for ilc controlled batch processes in a 2 d system framework in ieee transactions on systems man and cybernetics systems vol 48 no 9 pp 1493 1504 sept 2018 doi 10 1109 tsmc 2017 2672563 18 d liu y yang l li and s x ding control performance based fault tolerant control strategy for singular systems in ieee transactions on systems man and cybernetics systems vol 50 no 7 pp 2398 2407 july 2020 doi 10 1109 tsmc 2018 2815002 19 t j harris assessment of control loop performance can j chem eng vol 67 no 5 pp 856 861 oct 1989 doi 10 1002 cjce 5450670519 20 m j grimble controller performance benchmarking and tuning using generalised minimum variance control automatica vol 38 no 12 pp 2111 2119 2002 doi 10 1016 s 0005 1098 02 00141 3 21 b s ko and t f edgar pid control performance assessment the single loop case aiche j vol 50 no 6 pp 1211 1218 2004 doi 10 1002 aic 10104 22 z liu h y su l xie and y gu improved lqg benchmark for control performance assessment on armax model process vol 8 no part 1 ifac 2012 23 p grelewicz p nowak j czeczot and m fratczak corelation between conventional and data driven control performance assessment indices for heating process in proceedings of the 2019 22 nd international conference on process control pc 2019 2019 pp 86 90 doi 10 1109 pc 2019 8815041 24 k bu y liu and f wang operating performance assessment based on multi source heterogeneous information with deep learning for smelting process of electro fused magnesium furnace isa trans 2021 doi https doi org 10 1016 j isatra 2021 10 024 25 m xu and p wang evidential knn based performance monitoring method for pid control system in 2020 5 th international conference on mechanical control and computer engineering icmcce 2020 pp 597 601 doi 10 1109 icmcce 51767 2020 00134 26 n pillay and p govender multi class svms for automatic performance classification of closed loop controllers control eng appl informatics 2017 27 songling cao and r russell rhinehart an efficient method for on line identification of steady state j process control vol 5 no 6 pp 363 374 1995 28 p grelewicz p nowak j czeczot and j musial increment count method and its plc based implementation for autotuning of reduced order adrc with smith predictor ieee transactions on industrial electronics doi 10 1109 tie 2020 3045696 29 z gao scaling and bandwidth parameterization based controller tuning in proceedings of the american control conference 2003 vol 6 pp 4989 4996 doi 10 1109 acc 2003 1242516 30 p nowak j czeczot and t klopot robust tuning of a first order reduced active disturbance rejection controller control eng pract 2018 doi 10 1016 j conengprac 2018 02 001 31 h zhang the optimality of naive bayes in proc of the 17 th international florida artificial intelligence research society conference 2004 p 562 567 32 j ye least squares linear discriminant analysis in proc of the 24 th international conference on machine learning 2007 pp 1087 1093 33 n s altman an introduction to kernel and nearest neighbor nonparametric regression the american statistician vol 46 no 3 pp 175 185 1992 34 l breiman j friedman r olshen and c stone classification and regression trees wadsworth belmont ca 1984 35 b gabrys and a bargiela general fuzzy min max neural network for clustering and classification ieee transactions on neural networks vol 11 no 3 pp 769 783 2000 36 b gabrys agglomerative learning algorithms for general fuzzy minmax neural network journal of vlsi signal processing systems for signal image and video technology vol 32 no 1 pp 67 82 2002 37 j a suykens and j vandewalle least squares support vector machine classifiers neural processing letters vol 9 no 3 pp 293 300 1999 38 g ke q meng t finley t wang w chen w ma q ye and t y liu lightgbm a highly efficient gradient boosting decision tree in advances in neural information processing systems 30 2017 pp 3146 3154 39 t chen and c guestrin xgboost a scalable tree boosting system in proc of the 22 nd acm sigkdd international conference on knowledge discovery and data mining 2016 pp 785 794 40 y freund and r e schapire a decision theoretic generalization of on line learning and an application to boosting journal of computer and system sciences vol 55 no 1 pp 119 139 1997 41 p geurts d ernst and l wehenkel extremely randomized trees machine learning 63 1 3 42 2006 42 l breiman random forests machine learning vol 45 no 1 pp 5 32 2001 43 a o dwyer handbook of pi and pid controller tuning rules imperial college press 2009 44 t i salsbury a practical method for assessing the performance of control loops subject to random load changes j process control 2005 doi 10 1016 j jprocont 2004 08 004 45 t h gglund automatic detection of sluggish control loops control eng pract 1999 doi 10 1016 s 0967 0661 99 00116 1 46 a visioli method for proportional integral controller tuning assessment in industrial and engineering chemistry research 2006 doi 10 1021 ie 0508482 47 m veronesi and a visioli performance assessment and retuning of pid controllers for load disturbance rejection vol 2 ifac 2012 48 a visioli method for proportional integral controller tuning assessment in industrial and engineering chemistry research 2006 vol 45 no 8 pp 2741 2747 doi 10 1021 ie 0508482 49 t j harris assessment of control loop performance can j chem eng vol 67 no 5 pp 856 861 oct 1989 doi 10 1002 cjce 5450670519 50 k j str m and t h gglund benchmark systems for pid control in proc of ifac workshop pid 00 terrasa pp 181 182 2000 51 z gao c cecati and s x ding a survey of fault diagnosis and fault tolerant techniques part i fault diagnosis with model based and signal based approaches ieee transactions on industrial electronics vol 62 no 6 pp 3757 3767 2015 52 z gao c cecati and s x ding a survey of fault diagnosis and fault tolerant techniques part ii fault diagnosis with knowledge based and hybrid active approaches ieee transactions on industrial electronics vol 62 no 6 pp 3768 3774 2015 this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible i complete list of used control performance indices cpis the complete list of used cpis with their short descriptions is presented in table s i the most popular cpis that are frequently used as control performance measures are highlighted with grey colour while the other cpis are defined specifically for this work table s i the complete list of cpis control performance index short description acronym maxpeak maximum value of dynamic system response f 1 maxpeaktime the moment when the maximum peak occurs f 2 minpeak minimum value of dynamic system response absolute value f 3 minpeaktime the moment when the minimum peak occurs f 4 mintomax the ratio of minimum and maximum peak f 5 maxtomintime the difference of time when maximum and minimum peaks occur f 6 settlingtime the moment when the response of system is within the range of 1 of its steady state 0 01 f 7 iae integral absolute error f 8 ise integral square error 2 f 9 itae integral time absolute error f 10 it 2 ae integral time square absolute error 2 2 f 11 iaepos integral absolute error calculated for positive values of system response 0 f 12 iaeneg integral absolute error calculated for negative values of system response 0 f 13 iaenegtopos ratio of iaeneg and iaepos f 14 decayratio ratio of maximum peak to second positive peak 2 f 15 decayratiotime the difference between time when maximum and second peaks appeared 2 f 16 peaksettlingtime difference between settlingtime and maxpeaktime f 17 timepos the total amount of time when the response of the system is positive 0 f 18 timeneg the total amount of time when the response of the system is negative 0 f 19 timenegtopos the ratio of timeneg and timepos f 20 risingtime rising time of the maximum peak calculated as a time of reaching from 5 to 95 of maxpeak f 21 fallingtime falling time of the maximum peak calculated as a time of reaching from 95 to 5 of maxpeak f 22 risingtofallingtime ratio of risingtime and fallingtime f 23 25 distrejected the moment when the response of system is within the range of 25 of maxpeak e 25 maxpeak f 24 50 distrejected the moment when the response of system is within the range of 50 of maxpeak e 50 maxpeak f 25 75 distrejected the moment when the response of system is within the range of 75 of maxpeak e 75 maxpeak f 26 zerocrossingtime the first moment when the response of the system crosses the zero value f 27 maxdiff maximum value of the derivative of the dynamic response f 28 mindiff minimum value of the derivative of the dynamic response absolute value f 29 diffmaxtomin ratio of maxdiff and mindiff f 30 supplemental material for the paper application of machine learning to performance assessment for a class of pid based control systems patryk grelewicz thanh tung khuat member ieee jacek czeczot pawel nowak tomasz klopot and bogdan gabrys senior member ieee this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible fig s 1 graphical interpretation of a set of chosen cpis maxpeak maxpeaktime minpeak minpeaktime 2 ndpeak for calculating decayratio 2 ndpeaktime for calculating decayratiotime risingtime fallingtime 25 distrejected 50 distrejected 75 distrejected zerocrossingtime this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible ii hyperparameter optimization the parameters of studied classification methods were obtained using a hyperparameter optimization approach described in the main manuscript the results are presented in table s ii including the considered range and optimal value of each hyperparameter table s ii hyperparameter optimization results for studied classification algorithms classification algorithm parameter range optimal value decision trees max depth 4 20 19 min samples per leaf 4 30 4 light gbm max depth 4 20 20 min samples per leaf 4 30 12 sampling rate 0 3 0 4 0 5 0 6 0 7 0 4 features used 20 30 40 50 60 70 70 learning rate 0 025 0 05 0 1 0 2 0 3 0 3 no of estimators 30 50 70 100 150 200 200 xgboost max depth 4 20 8 sampling rate 0 3 0 4 0 5 0 6 0 7 0 7 features used 20 30 40 50 60 70 70 learning rate 0 025 0 05 0 1 0 2 0 3 0 2 gamma 0 0 1 0 2 0 3 0 4 1 1 5 2 1 no of estimators 30 50 70 100 150 200 200 extra trees max depth 4 20 20 min samples per leaf 4 30 6 features used 20 30 40 50 60 70 40 sampling rate 0 3 0 4 0 5 0 6 0 7 0 7 no of estimators 30 50 70 100 150 200 50 random forest max depth 4 20 20 min samples per leaf 4 30 6 features used 20 30 40 50 60 70 40 sampling rate 0 3 0 4 0 5 0 6 0 7 0 7 no of estimators 30 50 70 100 150 200 50 adaboost max depth 4 20 11 min samples per leaf 4 30 12 no of estimators 30 50 70 100 150 200 150 learning rate 0 001 0 01 0 1 0 2 0 5 1 0 1 support vector machines kernel rbf sigmoid linear rbf gamma 2 15 2 13 2 3 8 c 2 5 2 3 2 15 512 k nearest neighbour k 1 3 29 5 onln gfmm maximum hyperbox size 0 1 0 15 0 55 0 6 0 1 agglo 2 maximum hyperbox size 0 1 0 15 0 55 0 6 0 4 this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible iii block diagram of suggested cpa system block diagram representing the stages of deriving the proposed cpa system is presented in fig s 2 note the generality of the suggested procedure resulting from its configurability at different stages in this paper example and practically justified configuring parameters are proposed nut there is a possibility of using different process models different criteria of assessment and different set of features for the same procedure reference tunings generation based on simulation definition of process model and its normalized parameters in this paper sopdt model with l 1 0 1 0 6 l 2 0 1 1 0 closed loop response simulation with randomly modified reference tunings reference pid tunings for considered processes simulated closed loop responses cpis calculation ok nok assessment formation of training dataset cpis features assessment label classifier training and validation cpis vector ok nok assessment training dataset classifier predefined critera in this paper see eq 2 cpis set in this paper see table s i acceptable deviation from reference tunings in this paper see eq 3 selected classifiers predefined criteria in this paper ok if deviation of am and m less than 10 and edist 0 1 implementation fig s 2 block diagram of general approach to deriving suggested cpa system this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible iv possibility of feature reduction to check the possibility of feature reduction correlation coefficients table s iii and feature importance for tree based models table s iv were calculated the highly correlated groups of indices were colour coded in table s iii and table s iv one can notice that the most important features in the vast majority of cases are the representatives of obtained colour coded groups what is more the classification accuracy does not increase when the number of features is higher than approximately 10 fig 5 in the main paper these results suggest that the number of effective cpis can be reduced without any significant drop in classification accuracy this issue will be studied in the future as with a small number of relatively easily computable features the overall computational complexity decreases and a type of the cpa system proposed in this work can be implemented directly in plc as a ready to use general purpose function block table s iii correlation coefficients calculated for each pair of cpi f 1 f 2 f 3 f 4 f 5 f 6 f 7 f 8 f 9 f 1 0 f 1 1 f 1 2 f 1 3 f 1 4 f 1 5 f 1 6 f 1 7 f 1 8 f 1 9 f 2 0 f 2 1 f 2 2 f 2 3 f 2 4 f 2 5 f 2 6 f 2 7 f 2 8 f 2 9 f 3 0 f 1 1 000 0 902 0 641 0 863 0 790 0 779 0 725 0 946 0 931 0 875 0 810 0 948 0 341 0 789 0 712 0 550 0 389 0 703 0 530 0 176 0 828 0 767 0 736 0 863 0 873 0 885 0 882 0 415 0 807 0 823 f 2 1 000 0 468 0 937 0 620 0 832 0 890 0 986 0 951 0 972 0 940 0 986 0 172 0 624 0 548 0 451 0 585 0 873 0 768 0 032 0 985 0 888 0 901 0 994 0 997 0 999 0 954 0 016 0 485 0 829 f 3 1 000 0 566 0 925 0 592 0 119 0 496 0 433 0 394 0 326 0 508 0 894 0 936 0 877 0 362 0 255 0 344 0 089 0 538 0 428 0 498 0 219 0 417 0 423 0 443 0 600 0 513 0 772 0 675 f 4 1 000 0 692 0 973 0 852 0 899 0 820 0 835 0 772 0 900 0 258 0 693 0 623 0 532 0 580 0 936 0 607 0 277 0 948 0 934 0 807 0 938 0 935 0 936 0 996 0 006 0 509 0 915 f 5 1 000 0 692 0 330 0 651 0 586 0 543 0 470 0 659 0 684 0 999 0 978 0 488 0 033 0 452 0 154 0 357 0 569 0 666 0 307 0 581 0 578 0 594 0 718 0 551 0 846 0 785 f 6 1 000 0 769 0 779 0 677 0 688 0 608 0 781 0 298 0 691 0 630 0 549 0 538 0 913 0 459 0 419 0 859 0 901 0 690 0 837 0 829 0 830 0 955 0 020 0 490 0 909 f 7 1 000 0 847 0 806 0 840 0 813 0 841 0 200 0 327 0 272 0 402 0 890 0 893 0 832 0 048 0 906 0 837 0 848 0 915 0 910 0 902 0 843 0 206 0 236 0 697 f 8 1 000 0 986 0 981 0 947 1 000 0 203 0 654 0 575 0 453 0 522 0 801 0 726 0 017 0 942 0 826 0 881 0 965 0 974 0 980 0 920 0 159 0 584 0 792 f 9 1 000 0 981 0 955 0 985 0 158 0 591 0 509 0 408 0 484 0 714 0 721 0 068 0 887 0 728 0 878 0 921 0 936 0 943 0 845 0 212 0 581 0 694 f 10 1 000 0 991 0 980 0 133 0 550 0 471 0 341 0 524 0 767 0 787 0 102 0 934 0 776 0 904 0 956 0 966 0 969 0 864 0 067 0 458 0 700 f 11 1 000 0 945 0 091 0 478 0 403 0 257 0 507 0 723 0 811 0 180 0 908 0 729 0 890 0 928 0 939 0 940 0 806 0 013 0 373 0 629 f 12 1 000 0 217 0 663 0 582 0 453 0 512 0 800 0 718 0 026 0 942 0 826 0 878 0 964 0 973 0 979 0 922 0 165 0 591 0 795 f 13 1 000 0 704 0 627 0 090 0 527 0 073 0 394 0 600 0 139 0 159 0 030 0 107 0 123 0 146 0 303 0 450 0 579 0 395 f 14 1 000 0 974 0 478 0 041 0 454 0 152 0 363 0 574 0 665 0 317 0 585 0 583 0 599 0 721 0 543 0 840 0 783 f 15 1 000 0 469 0 063 0 364 0 143 0 250 0 503 0 625 0 219 0 517 0 509 0 523 0 645 0 535 0 785 0 724 f 16 1 000 0 265 0 434 0 288 0 175 0 434 0 524 0 331 0 447 0 440 0 443 0 511 0 167 0 475 0 588 f 17 1 000 0 717 0 715 0 117 0 629 0 603 0 609 0 635 0 624 0 607 0 548 0 382 0 064 0 413 f 18 1 000 0 649 0 303 0 920 0 892 0 816 0 897 0 890 0 884 0 925 0 256 0 267 0 823 f 19 1 000 0 502 0 787 0 712 0 728 0 811 0 799 0 785 0 614 0 329 0 005 0 478 f 20 1 000 0 045 0 126 0 023 0 001 0 009 0 020 0 265 0 216 0 390 0 343 f 21 1 000 0 924 0 898 0 994 0 992 0 989 0 959 0 136 0 366 0 842 f 22 1 000 0 679 0 914 0 897 0 892 0 937 0 105 0 396 0 903 f 23 1 000 0 893 0 908 0 908 0 814 0 207 0 245 0 649 f 24 1 000 0 999 0 997 0 950 0 064 0 415 0 829 f 25 1 000 0 999 0 948 0 046 0 429 0 818 f 26 1 000 0 951 0 022 0 451 0 822 f 27 1 000 0 021 0 533 0 920 f 28 1 000 0 823 0 057 f 29 1 000 0 600 f 30 1 000 this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible table s iv the rank of cpi features and accuracy of tree based models on the validation dataset using top k of the most important features rank decision tree random forest extra trees light gbm xgboost adaboost feature accuracy feature accuracy feature accuracy feature accuracy feature accuracy feature accuracy 1 f 23 73 70 f 23 74 36 f 23 74 76 f 30 64 28 f 13 70 36 f 30 63 61 2 f 3 78 50 f 30 81 06 f 30 81 5 f 23 77 99 f 3 72 45 f 23 78 82 3 f 30 84 98 f 3 88 19 f 3 86 15 f 29 86 f 22 75 36 f 29 84 95 4 f 22 89 23 f 13 89 72 f 22 88 38 f 1 88 78 f 17 80 42 f 1 93 18 5 f 29 90 92 f 17 90 93 f 17 90 36 f 28 93 31 f 23 86 87 f 20 95 14 6 f 28 90 63 f 22 91 65 f 19 89 77 f 9 93 35 f 30 90 74 f 9 94 92 7 f 1 91 99 f 15 92 28 f 14 89 72 f 20 94 2 f 5 92 89 f 28 94 88 8 f 19 91 48 f 29 93 26 f 20 91 23 f 22 94 35 f 12 93 52 f 3 95 55 9 f 15 91 96 f 19 92 98 f 13 90 61 f 3 95 04 f 26 93 94 f 14 95 69 10 f 13 92 09 f 28 93 14 f 29 92 15 f 14 95 17 f 15 94 4 f 17 95 72 11 f 5 91 76 f 5 93 24 f 5 92 17 f 5 95 17 f 29 95 1 f 19 95 58 12 f 9 91 83 f 20 93 25 f 6 91 78 f 19 95 11 f 1 95 1 f 5 95 68 13 f 20 91 93 f 1 93 76 f 4 91 89 f 15 95 3 f 20 95 08 f 15 95 64 14 f 17 91 64 f 16 93 74 f 1 92 04 f 16 95 39 f 14 95 33 f 13 95 66 15 f 14 91 67 f 14 93 55 f 27 92 49 f 6 95 35 f 19 95 37 f 12 95 56 16 f 16 91 81 f 9 93 79 f 16 92 38 f 2 95 46 f 2 95 43 f 18 95 51 17 f 24 91 81 f 8 93 65 f 28 92 33 f 17 95 2 f 8 95 33 f 22 95 71 18 f 11 91 64 f 12 93 69 f 9 92 67 f 18 95 17 f 16 95 29 f 16 95 82 19 f 12 91 65 f 6 93 75 f 15 92 51 f 12 95 34 f 28 95 41 f 8 95 53 20 f 6 91 47 f 7 93 71 f 2 92 62 f 13 95 18 f 6 95 38 f 6 95 69 21 f 18 91 44 f 2 93 65 f 8 92 81 f 8 95 06 f 9 95 25 f 27 95 65 22 f 8 91 52 f 26 93 64 f 18 92 49 f 26 95 06 f 10 95 47 f 4 95 63 23 f 25 91 49 f 10 93 66 f 10 92 72 f 7 95 23 f 21 95 3 f 7 95 58 24 f 21 91 73 f 18 93 59 f 26 92 53 f 21 94 84 f 25 95 34 f 11 95 55 25 f 7 91 61 f 24 93 6 f 12 92 94 f 27 95 43 f 27 95 42 f 24 95 41 26 f 10 91 54 f 25 93 6 f 24 92 54 f 11 95 23 f 18 95 17 f 25 95 55 27 f 2 91 6 f 27 93 47 f 7 92 63 f 24 95 48 f 7 95 12 f 10 95 43 28 f 4 91 52 f 21 93 61 f 21 92 58 f 25 95 24 f 24 95 38 f 2 95 52 29 f 26 91 49 f 11 93 51 f 25 92 72 f 4 95 13 f 11 95 23 f 21 95 69 30 f 27 91 54 f 4 93 7 f 11 92 85 f 10 95 23 f 4 95 26 f 26 95 48 v classification accuracy for simulation datasets and comparison with other cpa methods the studied classifiers were tested on two simulation based sets for l 1 0 4 l 2 0 5 and l 1 0 3 l 2 0 9 the obtained accuracies are generally very high and similar to the results obtained for the validation dataset fig 4 in the main paper table s v classification accuracy for simulation datasets classification algorithm simulation dataset l 1 0 4 l 2 0 5 simulation dataset l 1 0 3 l 2 0 9 confusion matrix accuracy confusion matrix accuracy decision trees 3 0 0 32 100 1 1 2 30 91 17 gaussian na ve bayes 2 1 3 29 88 57 1 1 5 27 82 35 linear discriminant analysis 1 2 3 29 85 71 1 1 1 31 94 11 light gbm 3 0 1 31 97 14 1 1 0 32 97 05 xgboost 3 0 1 31 97 14 1 1 0 32 97 05 extra tree 2 1 0 32 97 14 1 1 1 31 94 11 random forest 3 0 0 32 100 1 1 0 32 97 05 adaboost 3 0 0 32 100 1 1 0 32 97 05 support vector machine 3 0 0 32 100 1 1 0 32 97 05 k nearest neighbour 3 0 1 31 97 14 1 1 0 32 97 05 onln gfmm 3 0 1 31 97 14 1 1 1 31 94 11 agglo 2 2 1 0 32 97 14 1 1 0 32 97 05 generated simulation datasets were used for assessment by other well known cpa methods r index idle index area index load disturbance rejection performance ldr index and finally harris index the expected assessment results obtained by r this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible index idle index area index and ldr index based on indices values are presented in table s vi the calculated indices are presented in table s vii for l 1 0 4 l 2 0 5 and table s viii for l 1 0 3 l 2 0 9 simulation sets where score expert is the expected assessment based on criteria suggested for generating training dataset for classification algorithm and score svm is the output of suggested svm based cpa classifier the results of assessment are also colour coded based on table s vi where ok is highlighted with green and nok with red colour for better clarity the results are also presented in graphical form in fig s 4 table s vi assessment based on chosen cpa methods r index idle index area index and lrp index r index idle index area index lrp index nok oscillatory 1 0 nok sluggish 1 0 nok sluggish 1 0 nok 1 4 ok 0 5 ok nok oscillatory 1 0 ok 0 5 ok 1 0 nok sluggish 0 0 nok oscillatory 0 0 nok 0 6 table s vii results of assessment of simulation based set l 1 0 4 l 2 0 5 number of response score expert score svm r index idle index area index lrp index harris index 1 ok ok 0 6270 0 1939 1 0000 0 9887 0 3871 2 nok nok 0 5342 0 6137 0 2740 1 1142 0 3767 3 nok nok 0 3147 0 8930 1 0000 0 6107 0 4650 4 nok nok 0 4462 0 6386 0 6642 0 9179 0 4429 5 nok nok 0 5301 0 1070 1 0000 0 6856 0 3742 6 nok nok 0 4820 0 1329 1 0000 0 8692 0 4328 7 nok nok 0 6383 0 7357 0 4337 1 2327 0 3649 8 nok nok 0 3403 0 7884 0 0872 0 7650 0 4613 9 nok nok 0 2313 0 8772 1 0000 0 5100 0 5009 10 nok nok 1 0690 0 4078 0 1180 0 1339 0 0329 11 nok nok 0 9147 0 6850 0 4050 1 3557 0 3552 12 nok nok 0 4462 0 6386 0 6642 0 9179 0 4429 13 nok nok 0 4379 0 1609 0 6630 0 9179 0 4471 14 nok nok 0 4355 0 1929 1 0000 0 7915 0 4462 15 nok nok 1 0494 0 6838 0 1124 0 6052 0 1742 16 nok nok 0 4937 0 7260 0 3717 1 1246 0 3749 17 nok nok 0 9086 0 8995 0 3734 1 1001 0 3160 18 nok nok 0 1959 0 1500 0 2548 0 4301 0 4384 19 nok nok 0 9472 0 6311 0 6057 1 4707 0 3411 20 nok nok 0 9246 0 6128 0 8035 1 3816 0 3294 21 nok nok 1 0352 0 6692 0 4962 1 3538 0 2849 22 nok nok 1 0208 0 6713 0 5252 1 3639 0 2860 23 nok nok 0 4554 0 8496 0 0518 0 8383 0 4256 24 nok nok 0 4467 0 8626 0 0153 0 8171 0 4278 25 ok ok 0 5878 0 1430 0 6564 0 9554 0 3938 26 nok nok 0 5049 0 8188 1 0000 0 8451 0 4099 27 nok nok 0 5658 0 0262 0 5255 1 0327 0 4055 28 nok nok 0 6176 0 1033 0 4705 1 0622 0 4084 29 nok nok 0 4086 0 2740 0 5649 0 9235 0 4510 30 nok nok 0 6576 0 6575 0 5248 1 2462 0 3826 31 nok nok 0 5083 0 1647 0 0177 0 8810 0 4185 32 nok nok 0 6269 0 6490 0 4588 1 2396 0 3962 33 nok nok 0 5287 0 6664 0 3074 0 9263 0 4096 34 nok nok 0 4567 0 3150 1 0000 0 4865 0 3590 35 ok ok 0 6012 0 6574 0 6598 0 9449 0 3804 fig s 3 process responses classified as nok by suggested criteria expert and ok by well known cpa methods r index idle index area index lrp index this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible table s viii results of assessment of simulation based set l 1 0 3 l 2 0 9 number of response score expert score svm r index idle index area index lrp index harris index 1 ok ok 0 5564 0 3342 1 0000 0 9480 0 0632 2 nok nok 0 5452 0 4309 0 6530 1 2876 0 0762 3 nok nok 0 4469 0 8697 1 0000 0 6439 0 0562 4 nok nok 0 5761 0 4196 0 8982 0 9679 0 0597 5 nok nok 0 5807 0 1245 1 0000 0 5419 0 0431 6 nok nok 0 4487 0 8836 1 0000 0 6629 0 0581 7 nok nok 0 6380 0 0386 0 7204 1 1844 0 0603 8 nok nok 0 4374 0 8596 0 4473 0 8065 0 0650 9 nok nok 0 3185 0 8895 1 0000 0 5377 0 0655 10 nok nok 0 8151 0 5854 0 7924 1 5144 0 0618 11 nok nok 0 5761 0 4196 0 8982 0 9679 0 0597 12 ok nok 0 5638 0 1041 0 9153 0 9679 0 0610 13 nok nok 0 5907 0 2695 1 0000 0 7664 0 0525 14 nok nok 0 5100 0 6416 0 4977 1 3877 0 0772 15 nok nok 0 4191 0 8592 0 2641 0 7031 0 0600 16 nok nok 0 4369 0 8116 0 3438 0 7031 0 0566 17 nok nok 0 2460 0 3929 1 0000 0 4205 0 0682 18 nok nok 0 8555 0 8055 0 8662 1 2802 0 0517 19 nok nok 0 8346 0 8716 0 8545 1 1781 0 0488 20 nok nok 0 9194 0 8441 0 8137 1 3401 0 0511 21 nok nok 0 9224 0 8046 0 8174 1 3444 0 0514 22 nok nok 0 4275 0 8580 0 0375 0 6380 0 0566 23 nok nok 0 4141 0 8624 1 0000 0 6095 0 0566 24 nok nok 0 5613 0 8012 0 7716 0 7111 0 0493 25 nok nok 0 4979 0 8528 0 0097 0 6292 0 0507 26 nok nok 0 5161 0 8494 0 6189 0 7714 0 0559 27 nok nok 0 5946 0 4869 1 0000 0 8774 0 0556 28 nok nok 0 3504 0 8927 0 0716 0 6902 0 0714 29 nok nok 0 5251 0 7878 0 7306 0 9491 0 0623 30 nok nok 0 4769 0 8548 0 0406 0 6482 0 0532 31 nok nok 0 5032 0 7324 0 7265 0 9491 0 0650 32 nok nok 0 5027 0 8475 0 4358 0 7030 0 0533 33 nok nok 0 5263 0 1553 1 0000 0 3727 0 0382 34 nok nok 0 5712 0 7623 0 7224 0 7171 0 0480 fig s 4 graphical representation of calculated performance indices r index idle index area index lrp index and harris index for ok and nok samples for simulation sets l 1 0 4 l 2 0 5 left plot and l 1 0 3 l 2 0 9 right plot this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible vi selected results of simulation based validation in this section the results of the simulation based validation of the suggested cpa system based on processes given by the transfer functions 5 and presented in table i in the main paper are presented for each process p 1 p 7 figures present the accuracy of modelling by fopdt and sopdt approximations comparison of reference disturbance responses for a real process and its sopdt approximation and a comparison of the reference response with responses classified as ok and nok process p 1 fig s 5 upper row left modelling accuracy for fopdt and sopdt approximations upper row right load disturbance rejection responses for the reference pid tunings computed based on the sopdt approximation middle row classification results for the closed loop system with sopdt process representing an approximation of a real process lower row classification results for the closed loop system with a real process for the middle and lower rows green colour denotes responses classified as ok and red colour those classified as nok this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible process p 2 fig s 6 upper row left modelling accuracy for fopdt and sopdt approximations upper row right load disturbance rejection responses for the reference pid tunings computed based on the sopdt approximation middle row classification results for the closed loop system with sopdt process representing an approximation of a real process lower row classification results for the closed loop system with a real process for the middle and lower rows green colour denotes responses classified as ok and red colour those classified as nok this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible process p 3 fig s 7 upper row left modelling accuracy for fopdt and sopdt approximations upper row right load disturbance rejection responses for the reference pid tunings computed based on the sopdt approximation middle row classification results for the closed loop system with sopdt process representing an approximation of a real process lower row classification results for the closed loop system with a real process for the middle and lower rows green colour denotes responses classified as ok and red colour those classified as nok this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible process p 4 fig s 8 upper row left modelling accuracy for fopdt and sopdt approximations upper row right load disturbance rejection responses for the reference pid tunings computed based on the sopdt approximation middle row classification results for the closed loop system with sopdt process representing an approximation of a real process lower row classification results for the closed loop system with a real process for the middle and lower rows green colour denotes responses classified as ok and red colour those classified as nok this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible process p 5 fig s 9 upper row left modelling accuracy for fopdt and sopdt approximations upper row right load disturbance rejection responses for the reference pid tunings computed based on the sopdt approximation middle row classification results for the closed loop system with sopdt process representing an approximation of a real process lower row classification results for the closed loop system with a real process for the middle and lower rows green colour denotes responses classified as ok and red colour those classified as nok this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible process p 6 fig s 10 upper row left modelling accuracy for fopdt and sopdt approximations upper row right load disturbance rejection responses for the reference pid tunings computed based on the sopdt approximation middle row classification results for the closed loop system with sopdt process representing an approximation of a real process lower row classification results for the closed loop system with a real process for the middle and lower rows green colour denotes responses classified as ok and red colour those classified as nok this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible process p 7 fig s 11 upper row left modelling accuracy for fopdt and sopdt approximations upper row right load disturbance rejection responses for the reference pid tunings computed based on the sopdt approximation middle row classification results for the closed loop system with sopdt process representing an approximation of a real process lower row classification results for the closed loop system with a real process for the middle and lower rows green colour denotes responses classified as ok and red colour those classified as nok this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible vii details of the cloud based practical implementation the example of the practical implementation of the cpa system is intended to assess the current control performance of the pid controller implemented in siemens s 7 1500 programmable logic controller plc during its normal operation this verification can be performed periodically or upon user request to prevent a significant drop in control performance due to slowly varying fluctuations in process dynamics in order to prevent plc from excessive computing load required for cpa functionality only necessary calculations have been implemented directly in the control program in plc in the form of dedicated function block controlperformanceassessment its application jointly with standard pid compact function block accessible in tia portal is shown in fig s 12 when cpa procedure is enabled initializecpa input is set and controlperformanceassessment function block waits for the steady state that is detected using icm method 1 once the steady state has been detected a load disturbance step change is applied to the process and its amplitude is adjusted to 10 of the range of manipulating variable stored in the structure connected to the pid compactconfig input then closed loop disturbance rejection response data is collected with sampling time defined by samplingtime input until the steady state is detected once again by icm method after a transient resulting from the process excitation for monitoring both steady and transient states are respectively indicated at the outputs steadystate and transientstate the collected data is stored in plc s data memory and when this procedure is completed the data is sent to opc server jointly with current pid tunings connected to the input pid compactctrlparams using a secured opc ua protocol fig s 12 siemens s 7 1500 plc based implementation of controlperformanceassessment function block in control program process model identification normalization closed loop response simulation cpis calculation classification of control performance secured connection sopdt model cpis vector opc ua decision on control performance ok nok database plc based control system fig s 13 architecture of cloud based implementation of cpa system and its opc ua connection to plc based control system this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible fig s 14 user interface of exemplary client application for cpa system fig s 13 shows a cloud based architecture of the considered cpa system the data collected in plc is sent to database and based on this data sopdt process parameters are identified by nonlinear optimization procedure nelder mead simplex algorithm to minimize modelling error then based on identified sopdt process parameters and the pid tunings a disturbance rejection response is reconstructed by simulation to minimize the influence of measurement noise finally after computing l 1 l 2 parameters and appropriate scaling cpis are computed for this simulated response as a vector of its features this is followed by the control performance classification as ok or nok which is sent to opc server and then to plc it can be also stored in a database and visualized in hmi or scada system the use of a standard open protocol opc ua results in full flexibility when it comes to the implementation of client applications an example of the client user interface application implemented in matlab is presented in fig s 14 it provides all essential functionalities such as connection to opc ua server initializing cpa procedure sopdt model identification and additionally calculating new pid tunings based on previously identified sopdt process parameters if the performance was classified as nok in cases of uncertain assessment the user can additionally assess the control performance using the graphical visualization window representing the rejection step response collected from the process by visual comparison with reference rejection response of the assessed control system this work has been submitted to the ieee trans on systems man and cybernetics systems for possible publication copyright may be transferred without notice after which this version may no longer be accessible viii list of most important abbreviations and symbols table s ix list of most important abbreviations abbreviation definition cpa control performance assessment sopdt second order plus delay time cpis control performance indices ml machine learning pid proportional derivative integral fopdt first order plus delay time iae integral absolute error icm increment count method ldr index load disturbance rejection performance index gnb gaussian na ve bayes lda linear discriminant analysis knn k nearest neighbours dt decision tree gfmm general fuzzy min max neural network svm support vector machine light gbm light gradient boosted machine xgboost extreme gradient boosting adaboost adaptive boosting extra trees extremely randomized trees rf random forest onln gfmm online learning algorithm for gfmm training agglo 2 agglomerative learning algorithm for gfmm training plc programmable logic controller table s x list of most important symbols symbols definition e control error sp setpoint y process variable d step change of load disturbance k process gain 1 2 time constants 0 delay time l 1 l 2 normalized dynamical parameters kr controller gain pid parameter ti integral constant pid parameter td derivative constant pid parameter tmax transient time od closed loop response am gain margin m phase margin kr ref ti ref td ref reference pid tunings a 1 a 2 a 3 randomly generated numbers n normal distribution kr lab ti lab td lab modified pid tunings eref reference disturbance rejection response elab considered disturbance rejection response edist normalized distance between disturbance rejection responses of the control system under consideration elab and reference eref higher order transfer function parameter ph power of the electric flow heater tin inlet temperature tout output temperature tsp temperature setpoint f flow rate references 1 p grelewicz p nowak j czeczot and j musial increment count method and its plc based implementation for autotuning of reduced order adrc with smith predictor ieee transactions on industrial electronics doi 10 1109 tie 2020 3045696