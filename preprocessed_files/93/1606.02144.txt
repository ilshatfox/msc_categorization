on board monitoring of 2 d spatially resolved temperatures in cylindrical lithium ion batteries part i low order thermal modelling robert r richardson shi zhao and david a howey 1 department of engineering science university of oxford oxford uk abstract estimating the temperature distribution within li ion batteries during operation is critical for safety and control pur poses although existing control oriented thermal models such as thermal equivalent circuits tec are computa tionally efficient they only predict average temperatures and are unable to predict the spatially resolved temperature distribution throughout the cell we present a low order 2 d thermal model of a cylindrical battery based on a cheby shev spectral galerkin sg method capable of predicting the full temperature distribution with a similar efficiency to a tec the model accounts for transient heat generation anisotropic heat conduction and non homogeneous convection boundary conditions the accuracy of the model is validated through comparison with finite element simulations which show that the 2 d temperature field r z of a large format 64 mm diameter cell can be accurately modelled with as few as 4 states furthermore the performance of the model for a range of biot numbers is investigated via frequency analysis for larger cells or highly transient thermal dynamics the model order can be increased for improved accu racy the incorporation of this model in a state estimation scheme with experimental validation against thermocouple measurements is presented in the companion contribution part ii keywords lithium ion battery thermal model spectral methods low order modelling temperature estimation highlights derivation and validation of low order 2 d thermal model for cylindrical cells efficient numerical implementation based on cheb shev spectral galerkin method includes anisotropic heat conduction and inhomoge neous convection boundary conditions applicable to various battery cooling configurations such as side or end cooling suitable for use in a state estimator with surface tem perature or eis measurements 1 introduction lithium ion batteries generate heat due to electrochem ical processes which results in internal temperature gradi ents during operation in a typical usage scenario such as a standard vehicle drive cycle cells may experience tem perature differences between surface and core of 20 c or more 1 and during a rapid overheating event this dis crepancy can be as large as 40 50 c 2 high battery 1 e mail robert richardson shi zhao david howey eng ox ac uk temperatures could trigger thermal runaway resulting in fires venting and electrolyte leakage while such incidents are rare 3 consequences include costly recalls and poten tial endangerment of human life consequently transient thermal modelling of batteries during operation is an es sential requirement for battery management systems to ensure safe and optimal performance in this study we present and validate a low order ther mal model of a cylindrical battery cell capable of captur ing 2 d thermal dynamics the model is based on the spectral galerkin method achieving high accuracy with minimal computational requirements making it suitable for online applications the remainder of this paper is or ganised as follows in section 2 the alternative numerical methods for low order thermal modelling are discussed in section 3 a gentle introduction to galerkin spectral meth ods is provided by means of a toy problem a 1 d heat equation in cartesian coordinates in section 4 the full 2 d thermal model is presented and in section 5 the results of the model are validated through comparison with high fidelity finite element fe simulations matlab code to simulate the presented model is available online 2 2 www github com robert richardson spectral thermal model 2 d preprint submitted to journal of power sources june 8 2016 ar x iv 1 60 6 02 14 4 v 1 cs s y 6 j un 2 01 6 2 low order thermal modelling lumped parameter thermal equivalent circuit tec models are perhaps the most popular approach for effi cient thermal modelling these methods have been used extensively for low order and control oriented modelling of battery cells and packs 1 4 5 6 7 8 9 10 their main advantage is that they are simple to implement how ever they are unable to predict the full temperature field throughout the domain of interest their outputs merely consist of nodal values representing average temperatures this is a particular limitation when comparison with tem perature measurements at discrete locations is necessary for state or parameter estimation moreover since the parameters of the model have no physical meaning they require parameterization using experimental data for any given set of parameters and operating conditions on the other hand tec models with parameters that can be di rectly calculated from physical properties have been used extensively in thermal modelling of electric machines and other applications 11 12 13 however these are known to have poor performance for large biot numbers whilst increasing the number of elements to improve accuracy comes at the expense of increased computational complex ity 14 15 physics based models instead solve the underlying dif fusion partial differential equation pde governing the heat transfer they are generally applicable to a broad range of problems and can predict the full temperature field throughout the domain of interest several studies have presented 2 d or 3 d thermal simulations of battery cells 16 17 18 19 however the solution is typically obtained using computationally intensive numerical meth ods such as finite difference methods fdm or finite element methods fem and so their potential for ap plication in control systems is limited analytical solu tions have also been developed 20 21 however these are inappropriate for on line applications since time domain solutions rely on computationally intensive integral trans forms to reduce the computational burden of physics based models low order approaches have been proposed using techniques such as balanced truncation 22 23 and poly nomial approximation pa 24 25 26 27 however these methods are only suited to 1 d problems involving infinite or semi infinite domains or symmetric boundary conditions 28 this may be acceptable for cases in which thermal gradients arise predominantly in one direction such as in air cooling of small form factor e g 18650 or 26650 cylindrical cells however large form factor cells have a greater propensity for thermal gradients in multi ple directions recent studies have used 45 ah cylindrical cells with a diameter of 64 mm and height of 198 mm 29 such dimensions give rise to much larger biot numbers and hence more significant thermal gradients moreover certain cooling configurations such as end cooling via cool ing plates are more likely to give rise to axial variations these systems also introduce additional complexities such as the potential for each surface of the cell to be in contact with a different cooling fluid with a different free stream temperature and or convection coefficient fig 1 a shows a case with forced convection via a liquid coolant at the base of the cell and natural convection to the air at the other surfaces fig 1 b shows another scenario in which unequal cooling of multiple cells can result in 2 d thermal dynamics as heat is transferred axially through the tabs from one cell to a neighbouring cell consequently there is a clear need for low order thermal models capable of capturing 2 d thermal dynamics t h forced coolant c t hforced air a t hnatural air a a b figure 1 battery cooling configurations resulting in 2 d thermal dynamics a plate cooling b unequal cooling with intercell heat transfer spectral methods are an alternative numerical method for solving pdes in which the spatial discretization is carried out using global rather than local approximating functions 30 31 in general fdm and fem methods are suitable for complex geometries whereas spectral methods provide greater computational efficiency at the expense of model flexibility and the assumption of a smooth solution spectral methods are a type of weighted residual method a group of approximation techniques in which the solution errors are minimized in a certain way and they are clas sified according to the minimization technique employed the most common techniques are spectral collocation and spectral galerkin in a collocation method the solution is obtained by interpolating an approximating function at a set of domain nodes whereas in a galerkin method the solution is obtained by forcing the residual of an integral multiplied by a test function to zero spectral methods have been used in previous studies for low order battery modelling 32 33 34 35 and recently they have even been applied to 2 dimensional problems 36 however to the authors knowledge no study has applied a galerkin method to 2 d battery thermal prob lems this is perhaps due to the complexity of accounting for non homogeneous boundary conditions in particular convection boundary conditions using a galerkin method one of the advantages of the galerkin method is that the basis functions implicitly satisfy the boundary conditions and so it possible to have very low order models with sat isfactory accuracy in this paper we present a 2 d model of a cylindri 2 cal cell based on a chebyshev spectral galerkin sg method the model accounts for transient heat genera tion anisotropic heat conduction and non homogeneous convection boundary conditions with different convection coefficients and external temperatures at each surface this generality makes it suitable for simulating various battery cooling configurations such as those discussed pre viously the treatement of the non homogeneous bound ary conditions is achieved by an efficient boundary lift ing algorithm adapted from a recently developed bound ary lifting algorithm for elliptic problems 37 since the underlying basis functions implicitly satisfy the boundary conditions there is no need for additional equations to im pose the boundary conditions as a result accurate models can be generated using as a few as two basis functions in each direction and thus 22 4 states the accuracy can be improved arbitrarily by increasing the number of basis functions in either dimension 3 toy problem firstly we introduce sg methods by means of a simple example a 1 d heat equation in cartesian coordinates on the domain x 1 1 with non homogeneous boundary conditions governing equation the governing equation is given by cp t t k 2 t x 2 q 0 1 where t is time x 1 1 is the position coordinate and k is the thermal conductivity the convection boundary conditions are given by a t b x t er at x 1 2 a t b x t el at x 1 3 where a h k b 1 4 a h k b 1 5 er a t el a t 6 where h is the convection coefficient and t is the external temperature for simplicity the convection coefficient and external temperature at each boundary are assumed to be the same finite sum approximation the starting point of the sg method is to approximate the solution t of eq 1 by a finite sum t n n 0 an n x t 7 where an are unknown solution coefficients and n are the trial or basis functions which must satisfy the robin boundary conditions of eq 3 basis functions in principle any jacobi polynomial may be used for the basis functions however for this example chebyshev functions were used since they can be conveniently defined such that they adhere to any of a broad class of bound ary conditions 30 suitable basis functions are found as follows we denote by cn the nth degree chebyshev poly nomial of the first kind and then let n x nn 0 be a basis function such that n cn x ncn 1 x ncn 2 x 8 where n and n are defined according to the formula in lemma 4 3 of 30 such that they adhere to the boundary conditions n 4 n 1 a b a b detn 9 and n 2 a a n 2 n 1 2 a b a b 2 b b n 2 n 1 2 detn 10 where detn 2 a a n 1 2 n 2 2 a b a b 2 b b n 1 2 n 2 2 11 from this point on n are considered known functions residual equation substituting eq 7 for t into eq 1 leads to the resid ual r cp t t k 2 t x 2 q 6 0 12 the principle of the sg method is to force an integral of the residual to zero by requiring 1 1 cp t t k 2 t x 2 q dx 0 13 where is a test function substituting eq 7 for t and n for into eq 13 we have cp 1 1 0 ndx 1 1 n ndx d dt a 0 d dt an k 1 1 0 x ndx 1 1 n x ndx a 0 an q 1 1 ndx 0 14 3 state space equation with n 0 1 n the above n 1 equations repre senting the spatial discretisation can be written in compact form as ex ax bu 15 where x a 0 an 16 u q t 17 and e i j cp 1 1 i jdx 18 a i j k 1 1 2 j x 2 idx 19 b i 1 1 1 idx 20 b i 2 0 21 letting the outputs of the system be the temperature at the left and right boundaries t x 1 and t x 1 we have y cx du 22 where y tx 1 tx 1 t 23 c 1 j 0 x 1 n x 1 24 c 2 j 0 x 1 n x 1 25 d 0 1 0 1 26 as we shall see the actual 2 d problem of interest presented in the following section is more complex than the above problem for the following reasons i it in volves cylindrical rather than cartesian coordinates ii the physical domain is not necessarily in the range 1 1 and must be scaled accordingly and iii it is 2 d which renders the homogenisation step of the non homogeneous boundary conditions non trivial however the solution processes in both cases are equivalent 4 thermal model 4 1 overview we now describe the full 2 d sg model a step by step procedure is given as follows in section 4 2 the 2 d thermal problem is defined in section 4 3 the model is scaled from the physical coordinates to a coordinate sys tem suitable for implementation of the sg algorithm in section 4 4 the scaled model is decomposed into a homo geneous problem and a time invariant boundary lifting function section 4 5 presents the solution to the homo geneous problem using the sg method and section 4 6 presents the calculation of the boundary lifting function finally section 4 7 presents the overall solution to the original problem which combines the solutions obtained from sections 4 5 and 4 6 the overall procedure ulti mately generates a state space model the resulting model can then be solved efficiently online 4 2 model definition the model consists of the transient energy conservation equation in cylindrical coordinates heat generation is as sumed to be uniform in space but time dependant but as we show in part ii of this paper the error introduced by this assumption is modest the multi layer structure of the battery is treated as a homogeneous solid with anisotropic thermal conductivity in the radial and axial directions the temperature variation in the azimuthal direction is neglected convective heat transfer is as sumed to occur at the outside surfaces and the properties of the heat transfer fluid i e the heat transfer coefficient and the fluid free stream temperature may be different for each surface see figure 2 r r out r in h t r z q t htt t b hb t r hr t l hl z figure 2 schematic of cylindrical cell geometry for the thermal model showing different convection coefficients and or external tem peratures at each surface the resulting model is governed by the following 2 d boundary value problem 28 cp t t kr 2 t r 2 kr r t r kz 2 t z 2 q 27 where t is time and r and z are the position coordinates in the radial and axial directions respectively the functions t r z t and q t are the temperature distribution and volumetric heat generation rate respectively the param eters and cp are the density and specific heat capacity respectively and kr and kz are the anisotropic thermal conductivities in the r and z directions the boundary 4 conditions are given by t r hr kr t tt at r rout 28 a t r hl kr t tb at r rin 28 b t z ht kz t tr at z h 28 c t z hb kz t tl at z 0 28 d where t t b r and l are the free stream tem peratures of the heat transfer fluid at the top bottom right and left surfaces 3 and h t b r and l are the corresponding convection coefficients 4 3 change of scale in order to exploit the properties of the polynomial basis functions it is necessary to scale from the original physi cal domain r z where r rin rout z 0 h to the spectral domain r z where r 1 1 z 1 1 we define the spectral coordinates by r 2 r rin rout rin 1 s t r r rin 1 r r rout 1 29 a z 2 z h 1 s t z z 0 1 z z h 1 29 b rearranging 29 a and 29 b the original coordinates are given by r 1 r rin 30 a z z 1 30 b where and are scaling factors defined by 2 rout rin and 2 h substituting 30 a and 30 b into the original eq 27 we obtain the governing equation in the spectral domain cp t t 2 kr 2 t r 2 2 kr 1 rin r t r 2 kz 2 t z 2 q 31 with the boundary conditions a t b r t et at r 1 32 a a t b r t eb at r 1 32 b c t d z t er at z 1 32 c c t d z t el at z 1 32 d 3 note that although we have prescribed constant w r t the spa tial variable external temperatures at each side the model is also capable of handling spatially dependant temperatures e g tr z or tt r however since the external temperatures would rarely be known with such a high fidelity in a real application we chose constant values for the sake of simplicity where a hr kr b a hl kr b c ht kz d c hb kz d et a tt eb a tb er c tr el c tl 33 4 4 homogenization of the boundary conditions next the problem with non homogeneous boundary conditions is transformed into a problem with homoge neous boundary conditions using a boundary lifting algo rithm as follows we set t t te 34 where te r z is an arbitrary function satisfying the orig inal boundary conditions see later and t r z t is an auxiliary function satisfying the modified problem cp t t 2 kr 2 t r 2 2 kr 1 rin r t r 2 kz 2 t z 2 q 35 subject to the homogeneous boundary conditions a t b t r t 0 36 a c t d t z t 0 36 b where q q 2 kr 2 te r 2 2 kr 1 rin r te r 2 kz 2 te z 2 37 the boundary lifting is similar to that in 37 except that here we apply it to cylindrical coordinates and neglect the corner component of the lifting since we are assuming constant external temperatures 4 5 chebyshev galerkin approximation now we would like to solve the modified problem 35 using the galerkin method the first step is to multiply the equation by a test function and integrate over the entire domain 1 rin r cp t t 2 kr 2 t r 2 2 kr 1 rin r t r 2 kz 2 t z 2 1 rin r q 38 where f denotes the integral of f weighted by throughout the domain r z f 1 1 1 1 f r z r z dr dz 39 5 note the inclusion of the r terms as defined in 30 a on each side of eq 38 to account for cylindrical coordinates the second step is to approximate the solution t r z t with a finite number of functions t n k 0 n j 0 xkj r k r a b z j z c d 40 where xkj are unknown solution coefficients and r k and z j are the basis functions which must satisfy the homo geneous boundary conditions 36 a and 36 b respectively for simplicity the same number of basis functions n are chosen for the radial and axial directions but it should be noted that different values could be chosen if one dimen sion required greater resolution than the other suitable basis functions can be found as follows first we find basis functions in the radial and axial directions separately each of these is obtained in a similar manner to that of the toy problem eqs 8 11 we denote by ck the kth degree chebyshev polynomial of the first kind and then let r k r a b n k 0 be a basis in the radial direction such that r k ck r r kck 1 r r kck 2 r 41 where r k a b and r k a b are defined as before such that they adhere to the boundary conditions in the radial direction similarly we let z j z c d n j 0 be a basis in the axial direction such that z j cj z z jcj 1 z z jcj 2 z 42 where z j c d and z j c d adhere to the boundary conditions in the axial direction as mentioned previously the choice of basis function is not limited to chebyshev polynomials in general various jacobi polynomials may work equally well in this case we verified that almost identical results were obtained using legendre polynomials 4 6 boundary lifting function we now wish to determine the boundary lifting function te r z recall that te r z must satisfy the original non homogeneous boundary conditions 32 a such that when subtracted from the actual temperature t eq 34 the resulting auxiliary function t satisfies the homogeneous boundary conditions hence the aim of this section is to derive a function which is constant with respect to time and satisfies the non homogeneous boundary conditions since this cannot be achieved exactly the boundary con ditions must instead be satisfied in a weak sense i e the solution converges as more basis functions are included to begin we adopt a similar approach to 37 by assuming a form of the solution as follows te n k 0 dikz d ii k z 2 r k n j 0 diiij r d iv j r 2 z j 43 the conditions at the vertical and horizontal sides are de fined as follows for the right side we have c te d te z er at z 1 44 where denotes weakly satisfying conditions substitut ing 43 in 44 gives n k 0 dik c z d d ii k c z 2 2 d z r k n k 0 r diiij r 2 divj c z j d z j z er 45 substituting for z 1 and noting that the term c z j d z j z is equal to zero since the basis func tions by definition satisfy the homogeneous boundary con ditions eq 45 simplifies to n k 0 dik c d d ii k c 2 d r k er 46 the weak boundary condition can now be replaced by the appropriate integral equation n k 0 dik c d d ii k c 2 d r k r i r er r i r 47 where f g r denotes the integral f g r 1 1 1 r rin f r g r dr 48 through a similar process for the left top and bottom sides we find that n k 0 dik c d d ii k c 2 d r k r i r el r i r 49 n j 0 diiij a b d iv j a 2 b z j z i z et z i z 50 n j 0 diiij a b d iv j a 2 b z j z i z eb z i z 51 where f g z denotes the integral f g z 1 1 f z g z dz 52 6 equations 47 and 49 and equations 50 and 51 form two linear systems which can be each solved for the corre sponding d vectors di k 4 er k 2 el k 1 k 4 k 2 k 3 prl 1 srl 53 a dii k 1 el k 3 er k 1 k 4 k 2 k 3 prl 1 srl 53 b diii j 4 et j 2 eb j 1 j 4 j 2 j 3 ptb 1 stb 53 c div j 1 eb j 3 et j 1 j 4 j 2 j 3 ptb 1 stb 53 d where d d 0 d 1 d 2 t i ii iii and iv are vectors of unknown expansion coefficient s s 0 s 1 s n t rl and tb are vectors of known source terms and k 1 c d j 1 a b k 2 c 2 d j 2 a 2 b k 3 d c j 3 b a k 4 c 2 d j 4 a 2 b 54 the p matrix for the right and left edges is defined as prl prli k i k 0 1 n where prli k 1 1 1 r rin r i r kdr 55 a and that for top and bottom sides as ptb ptbi j i j 0 1 n where ptbi j 1 1 z i z jdz 55 b lastly the source terms are defined as s s i i 0 1 n rl and tb where srli 1 1 1 r rin r idr 56 a stbi 1 1 z i dz 56 b thus an explicit expression for the unknown expansion coefficients d is obtained and so the boundary lifting function te can be considered known at this stage 4 7 solution algorithm finally we present the solution algorithm to the mod ified problem equation 35 can be expressed in state space form as follows ex ax bu 57 where x x 00 x 10 xn 0 x 01 x 11 xn 1 x 0 n xnn t 58 and u q t 1 t the system matrices are defined as follows first let us denote the column vector r 0 z 0 r 1 z 0 r n z 0 r 0 z 1 r 1 z 1 r n z 1 r 0 z n r n z n t 59 and take i where i is the ith element of the vector then e i j cp 1 r rin j i 60 where e i j denotes the element in the ith row and jth column of the matrix e a i j 61 1 r rin 2 kr 2 j r 2 2 kz 2 j z 2 kr j r i 62 for i j 0 1 n and b i 1 1 r rin i 63 b i 2 1 r rin 2 kr 2 te r 2 2 kz 2 te z 2 kr te r i for i 0 1 n the complete solution to the original non homogeneous problem is then given by t r z t t r z t te r z 64 we choose as outputs the temperatures at the bottom centre left centre top centre and right centre locations i e t 1 t r 1 z 0 t 2 t r 0 z 1 t 3 t r 1 z 0 and t 4 t r 0 z 1 see figure 3 thus the outputs are given by y cx te 65 where y t 1 t 2 t 3 t 4 t te te 1 te 2 te 3 te 4 t and c c 1 j j r 1 z 0 c 2 j j r 0 z 1 c 3 j j r 1 z 0 c 4 j j r 0 z 1 66 7 for j 0 1 n note that the mean temperature t may also included as an output t is used in part ii of this paper for com puting the overall cell electrochemical impedance hence an additional row is appended to the c matrix c 5 j 1 h 2 r 2 out r 2 in h 0 rout rin r j r z drdz 67 for j 0 1 n which in the scaled coordinates becomes c 5 j 1 1 1 1 1 1 r rin j r z dr dz 68 an additional element must also be included in the bound ary lifting function te 5 1 h 2 r 2 out r 2 in h 0 rout rin rte r z drdz 69 which in the scaled domain becomes te 5 1 1 1 1 1 1 r rin te r z dr dz 70 with these equations the mean temperature is computed as the fifth output the frequency domain response of the above linear sys tem h s is calculated by h s c si a 1 b 71 where s j is the laplace variable and i is the identity matrix the above algorithm was implemented both numeri cally using clenshaw curtis quadrature and analytically using the matlab symbolic maths toolbox the numeri cal implementation allows the state matrices to be gener ated more efficiently than the symbolic approach although the resulting state space model is identical and therefore equally efficient in each case 5 results and discussion to validate the sg model the results were compared with high fidelity fem simulations implemented using the matlab partial differential equation toolbox to ensure the accuracy of the fem solution a fine mesh consisting of 3 760 elements was used the time step for both the sg and fem models was set at 1 s the thermo physical parameters chosen for the model validation are shown in table 1 the dimensions were chosen to match those of the large format lithium ion cell employed in 29 and the remaining thermal parameters were chosen based on typical properties of lithium iron phosphate cells 22 38 25 table 1 thermophysical properties for model validation parameter symbol value inner radius rin 4 mm outer radius rout 32 mm height h 198 mm density 2 118 kg m 3 specific heat capacity cp 765 j kg 1 k 1 radial thermal conductivity kr 0 66 w mk 1 axial thermal conductivity kz 66 w mk 1 5 1 time domain time domain simulations were carried out using two dif ferent cooling scenarios as shown in table 2 case 1 rep resents forced convection air cooling with equal temper atures and convection coefficients at each of the external sides case 2 represents forced convection liquid cooling at the left end of the cell for instance via a cooling plate 39 and mild forced convection to the ambient air at the remaining faces thus the temperature at the left face is set to 3 c and a large convection coefficient typical of forced cooling via water or glycol is applied whereas the remaining faces are exposed to a small convection coeffi cient at 18 c this case was chosen to highlight the ability of the model to account for different external temperatures and or convection coefficients at each side note that the convection coefficient at the bottom side the inner radius of the jelly roll was set to zero in both cases since negligi ble cooling occurs here in a typical thermal management system however a non zero value could easily be applied if it were required table 2 convection coefficients for the two cooling scenarios case 1 case 2 h w m 2 t c h w m 2 t c left 100 18 400 3 right 100 18 30 18 top 100 18 30 18 bottom 0 18 0 18 to ensure highly transient conditions with large inter nal temperature gradients pulsed power load profiles with large heat generation rates but relatively short durations were applied the load profiles and resulting temperature distributions for the two cases are compared against the corresponding fem solutions in figures 4 and 5 the lo cations of the model outputs are shown in figure 3 the results show that the sg method with ns 4 states i e 2 basis functions in each of the radial and axial direc tions is capable of accurately capturing the temperatures in both cases slightly greater accuracy is achieved using ns 9 states 3 basis functions in each direction in case 1 the temperatures t 1 and t 3 i e the first and third model outputs from eq 65 are plotted see fig 8 r 9 m 0 02 0 0 02 fem 9 n 9 93760 r 9 m 0 02 0 0 02 sg 9 n 9 925 z 9 m 0 0 05 0 1 0 15 r 9 m 0 02 0 0 02 sg 9 n 9 94 temperature 9 c 25 30 35 40 45 time 9 910509 s t e m p e ra tu re 9 c 15 20 25 30 35 40 45 50 55 60 65 1409 s 10509 s 17509 s fem 9 n 9 93760 sg 9 n 9 94 sg 9 n 9 925 air 1200 1250 1300 46 47 48 49 time 9 s 0 500 1000 1500 2000 2500 3000 3500 q 9 w m 3 0 50 t 1 t 3 r 9 m 0 01 0 02 0 03 t e m p e ra tu re 9 c 18 20 22 24 t 9 91409 s r 9 m 0 01 0 02 0 03 20 30 40 50 t 9 910509 s r 9 m 0 01 0 02 0 03 15 20 25 30 t 9 917509 s a b c figure 4 comparison of sg vs fem results for case 1 forced air convection a evolution of temperatures t 1 core and t 3 outer surface with pulsed load profile shown in subplot b temperature distribution along the centre line z h 2 of the cell at denoted times ro m z 0 02 0 0 02 femo no o 3760 z ro m z 0 02 0 0 02 sgo no o 25 z zo mz 0 0 05 0 1 0 15 ro m z 0 02 0 0 02 sgo no o 4 z temperatureo cz 45 50 55 60 65 timeo o 240 os t e m p e ra tu re o c z 0 20 40 60 80 100 120 60 os 240 os 800 os femo no o 3760 z sgo no o 4 z sgo no o 25 z air coolant 190 200 210 220 230 69 70 71 timeo sz 0 200 400 600 800 1000 1200 1400 1600 1800 2000 q o w m 3 z 0 500 1000 t 2 t 4 ro mz 0 01 0 02 0 03 t e m p e ra tu re o c z 20 20 5 21 to o 60 os ro mz 0 01 0 02 0 03 55 60 65 70 to o 240 os ro mz 0 01 0 02 0 03 25 30 35 to o 800 os a b c figure 5 comparison of sg vs fem results for case 2 end plate liquid cooling a evolution of temperatures t 2 and t 4 with pulsed load profile shown in subplot b temperature distribution along the centre line z h 2 of the cell at denoted times ure 4 a since the temperature gradient is primarily in the radial direction in this case in case 2 the temperatures t 2 and t 4 were plotted since a large gradient occurs in the axial direction in this case plots of t r z h 2 are shown in part b of these figures in each case the first two sub plots show the distribution at instances of highly transient dynamics i e just after a load is applied or re moved which is more difficult to capture accurately for a 9 t 4 t 2 t r z t 1 t 3 t r z h 2 figure 3 schematic of cell showing the model outputs displayed in figures 4 and 5 low order thermal model although the results are still in good agreement in both cases the third sub plot in each case shows the solution at a later time when the problem is dominated by slow thermal dynamics and the sg and fem solutions are in nearly perfect agreement at these times the full 2 d contour plots are shown in part c of each figure again the solution is plotted at an instant with transient dynamics to demonstrate the ability of the low order model to accurately simulate the temperature field under these conditions the sg model is in good agreement with the fem solution although the advan tage of increasing the number of model states is apparent in figure 5 c as the result using ns 9 states is in better agreement with that of the fem solution than the result with ns 4 states lastly we note that the model with 4 states is of a similar order to an equivalent circuit thermal model and so could be applied with similar computational efficiency moreover a similar order model implemented using a spectral collocation method would not give results as ac curate as those presented in this section since in the sg method the boundary conditions are implicitly satisfied by the basis functions whereas additional equations are required to enforce the boundary conditions in the collo cation case 5 2 frequency domain in this section we compare the frequency response of the low order sg models against a baseline solution ob tained by using an sg model with a large number of states ns 225 specifically we examine the impact of changes in heat generation on t 1 given by the trans fer function h s t 1 s q s this is calculated using eq 65 using only the rows and columns of the b and c matrices corresponding to the heat generation input and t 1 output the parameters chosen are the same as those in case 1 of the previous section however a variety of different biot numbers bi h rout rin kr are obtained by varying the magnitude of the convection coefficients on each side convection coefficients of h 10 50 100 500 wm 2 are chosen resulting in biot numbers of bi 0 42 2 10 4 20 and 21 02 respectively the size of the model is m a g n itu d e s 6 d b 8 50 0 bis s 4 20 frequencys 6 hz 8 10 4 10 3 10 2 10 1 100 a b so lu te se rr o rs 6 d b 8 0 1 2 3 50 0 bis s 2 10 10 4 10 3 10 2 10 1 100 0 1 2 50 0 bis s 21 02 frequencys 6 hz 8 10 4 10 3 10 2 10 1 100 0 2 4 m a g n itu d e s 6 d b 8 50 0 bis s 0 42 sgs 6 ns s 18 sgs 6 ns s 48 sgs 6 ns s 98 sgs 6 ns s 258 baselines 6 sg sns s 2258 10 4 10 3 10 2 10 1 100 a b so lu te se rr o rs 6 d b 8 0 0 2 0 4 0 6 0 8 a c b d figure 6 frequency response t 1 s q s of the sg method with different model orders for a range of biot number conditions as indi cated a large order ns 225 sg method is used as the baseline solution varied by increasing the number of basis functions in both the radial and axial directions models with 1 2 3 and 5 basis functions in each direction are chosen resulting in ns 1 4 9 and 25 states respectively figures 6 a d show the magnitude of the frequency response in the range f 1 10 4 to 1 100 for each of the four biot numbers along with the error of the low order models relative to the high fidelity solution these plots show that as the model order i e the number of states is increased the magnitude of the error is reduced moreover for all cases there is a critical frequency at which the error becomes non negligible and this critical frequency increases as the model order is increased we also note that the error increases as i the biot number increases and ii the perturbation frequency increases these trends are as expected thus if a particular appli cation involves larger biot numbers or higher frequencies for instance due to larger cells more aggressive drive cy cles or higher performance cooling the model order could be increased accordingly to achieve a required accuracy 6 conclusions computationally efficient thermal models are necessary for control oriented applications the model presented in this paper is of a similar order to a thermal equivalent circuit tec model and so could be applied with sim ilar computational efficiency but has much greater spa tial resolution it could therefore provide greater accuracy than a tec if used as part of a state estimation scheme 10 morevover although we have presented here a model for a cylindrical cell it can easily be modified to apply to 2 d simulation of prismatic cells however it is difficult to ap ply the sg method to more involved problems due to the complexity of it s implementation hence for configura tions involving several cells or non uniform cooling tecs may remain favourable due to their relative simplicity in the companion contribution 40 the model is incor porated into a state estimation scheme and the predicted temperatures at four locations one internal and three on the cell surface are validated experimentally against ther mocouple measurements acknowledgements this work was funded by a nui travelling scholarship a uk epsrc doctoral training award the foley bejar scholarship from balliol college university of oxford and the rcuk energy programmes s stable net project ref ep l 014343 1 nomenclature a b c d e system matrices ai polynomial coefficients cp specific heat capacity j kg 1 k 1 ck kth deg chebyshev poly of 1 1 st kind h convection coefficient w m 2 h cell height h s system transfer function i identity matrix j imaginary number kr radial thermal conductivity w m 1 k 1 kz axial thermal conductivity w m 1 k 1 q volumetric heat generation w ns number of model states r radial coordinate m r scaled radial coordinate m rin inner radius m rout outer radius m s laplace variable t temperature k t auxiliary temperature function k te boundary lifting function k t time s x system state y system output z axial coordinate m z scaled axial coordinate m abbreviations bvp boundary value problem fdm finite difference method fem finite element method pa polynomial approximation pde partial differential equation sg spectral galerkin tec thermal equivalent circuit greek test function density kg m 3 azimuthal coordinate basis function vector of basis functions frequency subscripts b bottom edge l left edge r right edge t top edge ambient condition appendix a matlab code for the model described in this pa per is available online at www github com robert richardson spectral thermal model 2 d references references 1 c forgez d vinh do g friedrich m morcrette c dela court thermal modeling of a cylindrical lifepo 4 graphite lithium ion battery journal of power sources 195 9 2010 2961 2968 doi 10 1016 j jpowsour 2009 10 105 url http linkinghub elsevier com retrieve pii s 037877530901982 x 2 n s spinner c t love s l rose pehrsson s g tuttle expanding the operational limits of the single point impedance diagnostic for internal temperature monitoring of lithium ion batteries electrochimica actadoi 10 1016 j electacta 2015 06 003 url http linkinghub elsevier com retrieve pii s 0013468615013602 3 q wang p ping x zhao g chu j sun c chen thermal runaway caused fire and explosion of lithium ion battery journal of power sources 208 2012 210 224 doi 10 1016 j jpowsour 2012 02 038 url http linkinghub elsevier com retrieve pii s 0378775312003989 4 x li f he l ma thermal management of cylindrical bat teries investigated using wind tunnel testing and computational fluid dynamics simulation journal of power sources 238 2013 395 402 doi 10 1016 j jpowsour 2013 04 073 url http linkinghub elsevier com retrieve pii s 037877531300671 x 5 x lin h e perez j b siegel a g stefanopoulou y ding m p castanier parameterization and observability analysis of scalable battery clusters for onboard thermal management in les rencontres scientifiques difp energies nouvelles no december 2011 11 http linkinghub elsevier com retrieve pii s 037877530901982 x http linkinghub elsevier com retrieve pii s 037877530901982 x http dx doi org 10 1016 j jpowsour 2009 10 105 http linkinghub elsevier com retrieve pii s 037877530901982 x http linkinghub elsevier com retrieve pii s 037877530901982 x http linkinghub elsevier com retrieve pii s 0013468615013602 http linkinghub elsevier com retrieve pii s 0013468615013602 http linkinghub elsevier com retrieve pii s 0013468615013602 http dx doi org 10 1016 j electacta 2015 06 003 http linkinghub elsevier com retrieve pii s 0013468615013602 http linkinghub elsevier com retrieve pii s 0013468615013602 http linkinghub elsevier com retrieve pii s 0378775312003989 http linkinghub elsevier com retrieve pii s 0378775312003989 http dx doi org 10 1016 j jpowsour 2012 02 038 http linkinghub elsevier com retrieve pii s 0378775312003989 http linkinghub elsevier com retrieve pii s 0378775312003989 http linkinghub elsevier com retrieve pii s 037877531300671 x http linkinghub elsevier com retrieve pii s 037877531300671 x http linkinghub elsevier com retrieve pii s 037877531300671 x http dx doi org 10 1016 j jpowsour 2013 04 073 http linkinghub elsevier com retrieve pii s 037877531300671 x http linkinghub elsevier com retrieve pii s 037877531300671 x 6 x lin h e perez s mohan j b siegel a g stefanopoulou y ding m p castanier a lumped parameter electro thermal model for cylindrical batteries journal of power sources 257 2014 1 11 doi 10 1016 j jpowsour 2014 01 097 url http linkinghub elsevier com retrieve pii s 0378775314001244 7 r mahamud advanced battery thermal management for electrical drive vehicles using reciprocating cooling flow and spatial resolution lumped capacitance thermal model ph d thesis university of nevada 2011 8 n damay c forgez m p bichat g friedrich a ospina thermal modeling and experimental validation of a large pris matic li ion battery iecon 2013 39 th annual conference of the ieee industrial electronics society 2013 4694 4699 doi 10 1109 iecon 2013 6699893 url http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 6699893 9 h dai l zhu j zhu x wei z sun adaptive kalman filtering based internal temperature estimation with an equivalent electrical network thermal model for hard cased batteries journal of power sources 293 2015 351 365 doi 10 1016 j jpowsour 2015 05 087 url http linkinghub elsevier com retrieve pii s 0378775315009891 10 f he l ma thermal management of batteries employing active temperature control and reciprocating cooling flow international journal of heat and mass transfer 83 2015 164 172 doi 10 1016 j ijheatmasstransfer 2014 11 079 url http linkinghub elsevier com retrieve pii s 0017931014010783 11 p mellor d roberts d turner lumped parameter thermal model for electrical machines of tefc design in iee proceedings b electric power applications vol 138 iet 1991 pp 205 218 12 r wrobel p h mellor a general cuboidal element for three dimensional thermal modelling ieee transactions on magnetics 46 8 2010 3197 3200 doi 10 1109 tmag 2010 2043928 url http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 5512838 13 n simpson r wrobel p h mellor a general arc segment ele ment for three dimensional thermal modeling magnetics ieee transactions on 50 2 2014 265 268 14 f qi a stippich m guettler m neubert r w de doncker methodical considerations for setting up space resolved lumped parameter thermal models for electrical machines in electrical machines and systems icems 2014 17 th international con ference on ieee 2014 pp 651 657 15 n simpson r wrobel p h mellor an accurate mesh based equivalent circuit approach to thermal modeling magnetics ieee transactions on 50 2 2014 269 272 16 g h kim a pesaran r spotnitz a three dimensional ther mal abuse model for lithium ion cells journal of power sources 170 2 2007 476 489 doi 10 1016 j jpowsour 2007 04 018 17 a a pesaran battery thermal models for hybrid vehicle simulations journal of power sources 110 2 2002 377 382 doi 10 1016 s 0378 7753 02 00200 8 url http linkinghub elsevier com retrieve pii s 0378775302002008 18 w b gu c y wang thermal electrochemical modeling of battery systems journal of the electrochemical society 147 8 2000 2910 doi 10 1149 1 1393625 19 v srinivasan c y wang analysis of electrochemical and thermal behavior of li ion cells journal of the electrochem ical society 150 1 2003 a 98 doi 10 1149 1 1526512 20 k shah s drake d wetz j ostanek s miller j heinzel a jain an experimentally validated transient thermal model for cylindrical li ion cells journal of power sources 271 2014 262 268 doi 10 1016 j jpowsour 2014 07 118 url http linkinghub elsevier com retrieve pii s 0378775314011720 21 k shah a jain modeling of steady state and transient ther mal performance of a li ion cell with an axial fluidic channel for cooling international journal of energy research 39 4 2015 573 584 22 m muratori n ma m canova y guezennec a model order reduction method for the temperature estimation in a cylindrical li ion battery cell asme 2010 dynamic sys tems and control conference volume 1 2010 633 640 doi 10 1115 dscc 2010 4200 23 m muratori m canova y guezennec g rizzoni e politec nico v lambruschini a reduced order model for the ther mal dynamics of li ion battery cells in 6 th ifac symposium advances in automotive control munich germany 2010 pp 10 15 24 y kim j b siegel a g stefanopoulou a computationally efficient thermal model of cylindrical battery cells for the estimation of radially distributed temperatures in american control conference acc 2013 washington dc 2013 pp 698 703 url http ieeexplore ieee org xpls abs all jsp arnumber 6579917 25 y kim s mohan s member j b siegel a g ste fanopoulou y ding the estimation of temperature distri bution in cylindrical battery cells under unknown cooling conditions ieee transactions on control system technology 2014 1 10 26 r r richardson p t ireland d a howey battery internal temperature estimation by combined impedance and surface temperature measurement journal of power sources 265 2014 254 261 doi 10 1016 j jpowsour 2014 04 129 url http linkinghub elsevier com retrieve pii s 0378775314006302 27 r r richardson d a howey sensorless battery internal temperature estimation using a kalman filter with impedance measurement ieee transactions on sustainable energy 6 4 url http ieeexplore ieee org xpls abs all jsp arnumber 7097077 tag 1 28 d w hahn m n ozisik heat conduction john wiley sons 2012 29 v roscher m schneider p durdaut n sassano s pereguda e mense k r riemschneider synchronisation using wireless trigger broadcast for impedance spectroscopy of battery cells in sensors applications symposium sas 2015 ieee ieee 2015 pp 1 6 30 j shen t tang l l wang spectral methods algorithms analysis and applications springer 2011 31 l n trefethen spectral methods in matlab vol 10 siam 2000 32 v r subramanian v d diwakar d tapriyal efficient macro micro scale coupled modeling of batteries journal of the electrochemical society 152 10 2005 a 2002 doi 10 1149 1 2032427 url http jes ecsdl org cgi doi 10 1149 1 2032427 33 p w c northrop v ramadesigan s de v r subramanian coordinate transformation orthogonal collocation model re formulation and simulation of electrochemical thermal behav ior of lithium ion battery stacks journal of the electrochem ical society 158 12 2011 a 1461 doi 10 1149 2 058112 jes url http jes ecsdl org cgi doi 10 1149 2 058112 jes 34 l cai r e white lithium ion cell modeling using orthogonal collocation on finite elements journal of power sources 217 2012 248 255 doi 10 1016 j jpowsour 2012 06 043 url http linkinghub elsevier com retrieve pii s 0378775312010439 35 a bizeray s zhao s duncan d howey lithium ion bat tery thermal electrochemical model based state estimation us ing orthogonal collocation and a modified extended kalman fil ter journal of power sources 296 2015 400 412 36 p w c northrop m pathak d rife s de s san thanagopalan v r subramanian efficient simulation and 12 http linkinghub elsevier com retrieve pii s 0378775314001244 http linkinghub elsevier com retrieve pii s 0378775314001244 http dx doi org 10 1016 j jpowsour 2014 01 097 http linkinghub elsevier com retrieve pii s 0378775314001244 http linkinghub elsevier com retrieve pii s 0378775314001244 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 6699893 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 6699893 http dx doi org 10 1109 iecon 2013 6699893 http dx doi org 10 1109 iecon 2013 6699893 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 6699893 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 6699893 http linkinghub elsevier com retrieve pii s 0378775315009891 http linkinghub elsevier com retrieve pii s 0378775315009891 http linkinghub elsevier com retrieve pii s 0378775315009891 http linkinghub elsevier com retrieve pii s 0378775315009891 http dx doi org 10 1016 j jpowsour 2015 05 087 http linkinghub elsevier com retrieve pii s 0378775315009891 http linkinghub elsevier com retrieve pii s 0378775315009891 http linkinghub elsevier com retrieve pii s 0017931014010783 http linkinghub elsevier com retrieve pii s 0017931014010783 http dx doi org 10 1016 j ijheatmasstransfer 2014 11 079 http linkinghub elsevier com retrieve pii s 0017931014010783 http linkinghub elsevier com retrieve pii s 0017931014010783 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 5512838 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 5512838 http dx doi org 10 1109 tmag 2010 2043928 http dx doi org 10 1109 tmag 2010 2043928 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 5512838 http ieeexplore ieee org lpdocs epic 03 wrapper htm arnumber 5512838 http dx doi org 10 1016 j jpowsour 2007 04 018 http dx doi org 10 1016 j jpowsour 2007 04 018 http linkinghub elsevier com retrieve pii s 0378775302002008 http linkinghub elsevier com retrieve pii s 0378775302002008 http dx doi org 10 1016 s 0378 7753 02 00200 8 http linkinghub elsevier com retrieve pii s 0378775302002008 http linkinghub elsevier com retrieve pii s 0378775302002008 http dx doi org 10 1149 1 1393625 http dx doi org 10 1149 1 1526512 http linkinghub elsevier com retrieve pii s 0378775314011720 http linkinghub elsevier com retrieve pii s 0378775314011720 http dx doi org 10 1016 j jpowsour 2014 07 118 http linkinghub elsevier com retrieve pii s 0378775314011720 http linkinghub elsevier com retrieve pii s 0378775314011720 http dx doi org 10 1115 dscc 2010 4200 http dx doi org 10 1115 dscc 2010 4200 http ieeexplore ieee org xpls abs all jsp arnumber 6579917 http ieeexplore ieee org xpls abs all jsp arnumber 6579917 http ieeexplore ieee org xpls abs all jsp arnumber 6579917 http ieeexplore ieee org xpls abs all jsp arnumber 6579917 http ieeexplore ieee org xpls abs all jsp arnumber 6579917 http linkinghub elsevier com retrieve pii s 0378775314006302 http linkinghub elsevier com retrieve pii s 0378775314006302 http linkinghub elsevier com retrieve pii s 0378775314006302 http dx doi org 10 1016 j jpowsour 2014 04 129 http linkinghub elsevier com retrieve pii s 0378775314006302 http linkinghub elsevier com retrieve pii s 0378775314006302 http ieeexplore ieee org xpls abs all jsp arnumber 7097077 tag 1 http ieeexplore ieee org xpls abs all jsp arnumber 7097077 tag 1 http ieeexplore ieee org xpls abs all jsp arnumber 7097077 tag 1 http ieeexplore ieee org xpls abs all jsp arnumber 7097077 tag 1 http ieeexplore ieee org xpls abs all jsp arnumber 7097077 tag 1 http jes ecsdl org cgi doi 10 1149 1 2032427 http jes ecsdl org cgi doi 10 1149 1 2032427 http dx doi org 10 1149 1 2032427 http dx doi org 10 1149 1 2032427 http jes ecsdl org cgi doi 10 1149 1 2032427 http jes ecsdl org cgi doi 10 1149 2 058112 jes http jes ecsdl org cgi doi 10 1149 2 058112 jes http jes ecsdl org cgi doi 10 1149 2 058112 jes http dx doi org 10 1149 2 058112 jes http jes ecsdl org cgi doi 10 1149 2 058112 jes http linkinghub elsevier com retrieve pii s 0378775312010439 http linkinghub elsevier com retrieve pii s 0378775312010439 http dx doi org 10 1016 j jpowsour 2012 06 043 http linkinghub elsevier com retrieve pii s 0378775312010439 http linkinghub elsevier com retrieve pii s 0378775312010439 http jes ecsdl org cgi doi 10 1149 2 0341506 jes model reformulation of two dimensional electrochemical thermal behavior of lithium ion batteries journal of the elec trochemical society 162 6 2015 a 940 a 951 doi 10 1149 2 0341506 jes url http jes ecsdl org cgi doi 10 1149 2 0341506 jes 37 e h doha a h bhrawy an efficient direct solver for mul tidimensional elliptic robin boundary value problems using a legendre spectral galerkin method computers and mathemat ics with applications 64 4 2012 558 571 doi 10 1016 j camwa 2011 12 050 url http dx doi org 10 1016 j camwa 2011 12 050 38 m fleckenstein s fischer o bohlen b ba ker thermal impedance spectroscopy a method for the thermal characteri zation of high power battery cells journal of power sources 223 2013 259 267 39 a jarrett i y kim design optimization of electric vehicle battery cooling plates for thermal performance journal of power sources 196 23 2011 10359 10368 doi 10 1016 j jpowsour 2011 06 090 url http linkinghub elsevier com retrieve pii s 0378775311013279 40 r r richardson s zhao d a howey on board monitoring of 2 d spatially resolved temperatures in cylindrical lithium ion batteries part ii state estimation via impedance based temperature sensing arxiv preprint 2016 13 http jes ecsdl org cgi doi 10 1149 2 0341506 jes http jes ecsdl org cgi doi 10 1149 2 0341506 jes http dx doi org 10 1149 2 0341506 jes http dx doi org 10 1149 2 0341506 jes http jes ecsdl org cgi doi 10 1149 2 0341506 jes http dx doi org 10 1016 j camwa 2011 12 050 http dx doi org 10 1016 j camwa 2011 12 050 http dx doi org 10 1016 j camwa 2011 12 050 http dx doi org 10 1016 j camwa 2011 12 050 http dx doi org 10 1016 j camwa 2011 12 050 http dx doi org 10 1016 j camwa 2011 12 050 http linkinghub elsevier com retrieve pii s 0378775311013279 http linkinghub elsevier com retrieve pii s 0378775311013279 http dx doi org 10 1016 j jpowsour 2011 06 090 http linkinghub elsevier com retrieve pii s 0378775311013279 http linkinghub elsevier com retrieve pii s 0378775311013279 1 introduction 2 low order thermal modelling 3 toy problem 4 thermal model 4 1 overview 4 2 model definition 4 3 change of scale 4 4 homogenization of the boundary conditions 4 5 chebyshev galerkin approximation 4 6 boundary lifting function 4 7 solution algorithm 5 results and discussion 5 1 time domain 5 2 frequency domain 6 conclusions