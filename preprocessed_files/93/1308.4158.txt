1 model reduction near periodic orbits of hybrid dynamical systems samuel a burden shai revzen and s shankar sastry abstract we show that near periodic orbits a class of hybrid models can be reduced to or approximated by smooth continuous time dynamical systems specifically near an exponentially stable periodic orbit undergoing isolated transitions in a hybrid dynamical system nearby executions generically contract superexponentially to a constant dimensional subsystem under a non degeneracy condition on the rank deficiency of the associated poincare map the contraction occurs in finite time regardless of the stability properties of the orbit hybrid transitions may be removed from the resulting subsystem via a topological quotient that admits a smooth structure to yield an equivalent smooth dynamical system we demonstrate reduction of a high dimensional underactuated mechanical model for terrestrial locomotion assess structural stability of deadbeat controllers for rhythmic locomotion and manipulation and derive a normal form for the stability basin of a hybrid oscillator these applications illustrate the utility of our theoretical results for synthesis and analysis of feedback control laws for rhythmic hybrid behavior i introduction rhythmic phenomena are pervasive appearing in physical situations as diverse as legged locomotion 1 dexterous manipulation 2 gene regulation 3 and electrical power generation 4 the most natural dynamical models for these systems are piecewise defined or discontinuous owing to intermittent changes in the mechanical contact state of a locomotor or manipulator or to rapid switches in protein synthesis or constraint activation in a gene or power network such hybrid systems generally exhibit dynamical behaviors that are distinct from those of smooth systems 5 restricting our attention to the dynamics near periodic orbits in hybrid dynamical systems we demonstrate that a class of hybrid models for rhythmic phenomena reduce to classical smooth dynamical systems although the results of this paper do not depend on the phenomenology of the physical system under investigation a principal application domain for this work is terrestrial locomotion numerous architectures have been proposed to explain how animals control their limbs for steady state locomotion most posit a principle of coordination synergy symmetry or synchronization and there is a surfeit of neurophysio logical data to support these hypotheses 6 10 taken together the empirical evidence suggests that the large number of degrees of freedom dof available to a locomotor can collapse during regular motion to a low dimensional dynamical attractor a template embedded within a higher dimensional model an anchor that respects the locomotor s physiology 1 11 we provide a mathematical framework to model this empirically observed dimensionality reduction in the deterministic setting a stable hybrid periodic orbit provides a natural abstraction for the dynamics of steady state legged loco motion this widely adopted approach has generated models of bipedal 12 15 and multi legged 16 18 locomotion as well as control theoretic techniques for composition 19 coordination 20 and stabilization 21 23 in certain cases it has been possible to embed a low dimensional abstraction in a higher dimensional model 24 25 applying these techniques to establish existence of a reduced order subsystem imposes stringent assumptions on the dynamics of locomotion that are difficult to verify for any particular locomotor in contrast the results of this paper imply that hybrid dynamical systems generically s a burden and s s sastry are with the department of electrical engineering and computer sciences university of california berkeley ca usa sburden sastry eecs berkeley edu s revzen is with the department of electrical engineering and computer science university of michigan ann arbor mi usa shrevzen eecs umich edu ar x iv 1 30 8 41 58 v 4 m at h d s 7 j an 2 01 5 2 exhibit dimension reduction near periodic orbits solely due to the interaction of the discrete time switching dynamics with the continuous time flow under the hypothesis that iterates of the poincare map associated with a periodic orbit in a hybrid dynamical system are eventually constant rank we construct a constant dimensional invariant subsystem that attracts all nearby trajectories in finite time regardless of the stability properties of the orbit this appears as theorem 1 of section iii c below assuming instead that the periodic orbit under investigation is exponentially stable we show in theorem 2 of section iii d that trajectories generically contract superexponentially to a subsystem whose dimension is determined by rank properties of the linearized poincare map at a single point the resulting subsystems possess a special structure that we exploit in theorem 3 to construct a topological quotient that removes the hybrid transitions and admits the structure of a smooth manifold yielding an equivalent smooth dynamical system in section iv we apply these results to reduce the complexity of hybrid models for mechanical systems and analyze rhythmic hybrid control systems the example in section iv a demonstrates that reduction can occur spontaneously in mechanical systems undergoing plastic impacts in section iv b we prove that a family of 3 2 n dof multi leg models provably reduce to a common 3 dof mechanical system independent of the number of limbs n n this demonstrates model reduction in the mechanical component of the class of neuromechanical models considered in 1 18 as further applications we assess structural stability of deadbeat controllers for rhythmic locomotion and manipulation in section iv c and derive a normal form for the stability basin of a hybrid oscillator in section iv d ii preliminaries we assume familiarity with differential topology and geometry 26 27 and summarize notation and terminology in this section for completeness if x is a banach space we let b x x denote the open ball of radius 0 centered at x x for x rn we may emphasize the dimension n by writing bn 0 r n for the open ball a subset of a topological space is precompact if it is open and its closure is compact a neighborhood of a point x x in a topological space x is a connected open subset u x containing x the disjoint union of a collection of sets sj j j is denoted j j sj j j sj j a set we endow with the natural piecewise defined topology if d d is an equivalence relation on the topological space d then we let d denote the corresponding set of equivalence classes there is a natural quotient projection d d sending x d to its equivalence class x d and we endow d with the unique finest topology making continuous 27 appendix a any map r g d defined over a subset g d determines an equivalence relation x y d d x r 1 y y r 1 x or x y to be explicit that the equivalence relation is determined by r we denote the quotient space as d d g r r g a cr n dimensional manifold m with boundary m is an n dimensional topological manifold covered by an atlas of cr coordinate charts u a where u m is open u h n is a homeomorphism and hn y 1 yn rn yn 0 is the upper half space we write dimm n the charts are cr in the sense that 1 is a c r diffeomorphism over u u for all pairs a for which u u 6 if r we say m is smooth the boundary m m contains those points that are mapped to the plane y 1 yn rn yn 0 in some chart a map p m n is cr if m and n are cr manifolds and for every x m there is a pair of charts u v with x u m and p x v n such that the coordinate representation p p 1 is a cr map between subsets of hn we let cr m n denote the normed vector space of cr maps between m and n endowed with the uniform cr norm 26 chapter 2 each x m has an associated tangent space txm and the disjoint union of the tangent spaces is the tangent bundle tm x m txm note that any element in tm may be regarded as a pair x 3 where x m and txm and tm is naturally a smooth 2 n dimensional manifold we let t m denote the set of smooth vector fields on m i e smooth maps f m tm for which f x x for some txm and all x m it is a fundamental result that any f t m determines an ordinary differential equation in every chart on the manifold that may be solved globally to obtain a maximal flow f m where f r m is the maximal flow domain 27 theorem 17 8 if p m n is a smooth map between smooth manifolds then at each x m there is an associated linear map dp x txm tp x n called the pushforward globally the pushforward is a smooth map dp tm tn in coordinates it is the familiar jacobian matrix if m x y is a product manifold the pushforward naturally decomposes as dp dxp dyp corresponding to derivatives taken with respect to x and y respectively the rank of a smooth map p m n at a point x m is rankdp x if rankdp x r for all x m we simply write rankdp r if p is furthermore a homeomorphism onto its image then p is a smooth embedding and the image p m is a smooth embedded submanifold in this case the difference dimn dimp m is called the codimension of p m and any smooth vector field f t m may be pushed forward to a unique smooth vector field dp f t p m a vector field f t m is inward pointing at x m if for any coordinate chart u with x u the n th coordinate of d f is positive and outward pointing if it is negative iii hybrid dynamical systems we describe a class of hybrid systems useful for modeling physical phenomena in section iii a then restrict our attention to the behavior of such systems near periodic orbits in section iii b it was shown in 28 that the poincare map associated with a periodic orbit of a hybrid system is generally not full rank we explore the geometric consequences of this rank loss under a non degeneracy condition on this rank loss we demonstrate in section iii c that the hybrid system possesses an invariant hybrid subsystem to which all nearby trajectories contract in finite time regardless of the stability properties of the orbit in section iii d we show that the invariance and contraction of the subsystem hold approximately for any exponentially stable hybrid periodic orbit using tools from differential topology we remove hybrid transitions from the resulting reduced order subsystems in section iii e to yield a continuous time dynamical system that governs the behavior of the hybrid system near its periodic orbit a hybrid differential geometry for our purposes it is expedient to define hybrid dynamical systems over a finite disjoint union m j jmj where mj is a connected manifold with boundary for each j j we endow m with the natural piecewise defined topology and smooth structure we refer to such spaces as smooth hybrid manifolds note that the dimensions of the constituent manifolds are not required to be equal several differential geometric constructions naturally generalize to such spaces we prepend the modifier hybrid to make it clear when this generalization is invoked for instance the hybrid tangent bundle tm is the disjoint union of the tangent bundles tmj and the hybrid boundary m is the disjoint union of the boundaries mj let m j jmj and n ln be two hybrid manifolds note that if a map r m n is continuous then for each j j there exists l such that r mj n and hence r mj mj n using this observation there is a natural definition of differentiability for continuous maps between hybrid manifolds namely a map r m n is called smooth if r is continuous and r mj mj n is smooth for each j j in this case the pushforward dr tm tn is the smooth map defined piecewise as dr tmj d r mj for each j j a smooth map f m tm is called a vector field if for all x m there exists v txm such that f x x v with these preliminaries established we define the class of hybrid systems considered in this paper this is a specialization of hybrid automata 5 that emphasizes the differential geometric character of hybrid phenomena definition 1 a hybrid dynamical system is specified by a tuple h d f g r where 4 d j j dj is a smooth hybrid manifold f d td is a smooth vector field g d is an open subset of d r g d is a smooth map as in 5 we call r the reset map and g the guard when we wish to be explicit about the order of smoothness we will say h is cr if d f and r are cr as a manifold vector field and map respectively for some r n roughly speaking an execution of a hybrid dynamical system is determined from an initial condition in d by following the continuous time dynamics determined by the vector field f until the trajectory reaches the guard g at which point the reset map r is applied to obtain a new initial condition definition 2 an execution of a hybrid dynamical system h d f g r is a right continuous function x t d over an interval t r such that 1 if x is continuous at t t then x is differentiable at t and d dt x t f x t 2 if x is discontinuous at t t then the limit x t lim s t x s exists x t g and r x t x t if f is tangent to g at x g there is a possible ambiguity in determining a trajectory from x since one may either follow the flow of f on d or apply the reset map to obtain a new initial condition y r x assumption 1 f is outward pointing on g remark 1 the use of time invariant vector fields and reset maps in definition 1 is without loss of generality in the following sense suppose d is a hybrid manifold g d is open and f r d td r r g d define a time varying vector field and reset map respectively define d r d g r g and let f d td r g d be defined in the obvious way then h d f g r is a hybrid dynamical system in the form of definition 1 b hybrid periodic orbits and hybrid poincare maps in this paper we are principally concerned with periodic executions of hybrid dynamical systems which are nonequilibrium trajectories that intersect themselves definition 3 an execution t d is periodic if there exists s t 0 such that s t and s s 1 if there is no smaller positive number such that 1 holds then is called the period of and we will say is a periodic orbit remark 2 the domain t of a periodic orbit may be taken to be the entire real line t r without loss of generality in the sequel we conflate the execution r d with its image r d motivated by the applications in section iv we restrict our attention to periodic orbits undergoing isolated discrete transitions i e a finite number of discrete transitions that occur at distinct time instants assumption 2 undergoes isolated discrete transitions in addition to excluding zeno periodic orbits 29 from our analysis this assumption enables us to construct poincare maps see 30 31 for the classical case associated with a poincare map p u is defined over an open subset u of an embedded codimension 1 submanifold d that intersects the periodic orbit at one point by tracing an execution from x u forward in time until 5 it intersects at p x the submanifold is referred to as a poincare section it is known that this procedure yields a map that is well defined and smooth near the fixed point p 13 28 32 33 unlike the classical case poincare maps in hybrid systems need not be full rank a straightforward application of sylvester s inequality 34 appendix a 5 3 shows that the rank of the poincare map is bounded above by the minimum dimension of all hybrid domains more precise bounds are pursued elsewhere 28 but the following proposition will suffice for the applications in section iv proposition 1 if p u is a poincare map associated with a periodic orbit then x u rankdp x minj j dimdj 1 it is a standard result for continuous time dynamical systems that the eigenvalues of the linearization of the poincare map at its fixed point commonly called floquet multipliers do not depend on the choice of poincare section 31 section 1 5 this generalizes to the hybrid setting in the sense that there exist similarity transformations relating the non nilpotent portion of the jordan forms for linearizations of poincare maps defined over different sections note that since proposition 1 implies that zero eigenvalues will generally have different algebraic multiplicity for linearized poincare maps obtained from sections located in hybrid domains with different dimensions we do not expect the nilpotent jordan blocks for these linear maps to bear any relation to one another these observations are summarized in the following lemma lemma 1 if p u p u are poincare maps associated with a periodic orbit with fixed points p p then specdp 0 specdp 0 moreover with j a 0 0 n j a 0 0 n denoting the jordan canonical forms of dp and dp where 0 6 speca spec a and n n are nilpotent we conclude that a is similar to a proof the periodic orbit undergoes a finite number of transitions k n so we may index the corresponding sequence of domains as 1 d 1 dk without loss of generality assume the dj s are distinct 2 and let j g dj be the exit point of in dj we wish to construct the poincare map pj associated with the periodic orbit over a neighborhood of j in g for j 1 k let j fj dj be the maximal flow of f dj on dj uj dj be a neighborhood of r j 1 over which lemma 2 from appendix a a 1 may be applied between r j 1 dj and g dj to obtain a time to impact map j uj r gj g dj be defined as gj r 1 uj 1 j gj gj 1 be defined by j x j 1 j 1 r x r x the poincare map defined over gj is obtained formally by iterating the s around the cycle pj j 1 1 k j 2 the neighborhood j gj of j over which this map is well defined is determined by pulling gj backward around the cycle j 1 j 1 k 1 1 1 j 1 gj and similarly for any iterate of pj note that pj j j is a fixed point of pj by construction without loss of generality we assume 3 g so that p pj and p pi for some i j 1 k refer to fig 1 for an illustration 1 we regard subscripts modulo k so that dk d 0 2 otherwise we can find bj kj 1 such that bj dj is open k j 1 bj contains and bi bj if i 6 j then proceed on d k j 1 bj 3 otherwise we may introduce fictitious guards and or near and repeat the construction 6 dj x f dj x r g dj r j 1 j uj gj j pj dj 1 x f dj 1 x g dj 1 j 1 gj 1 pj x x fig 1 illustration of constructions used in proofs of lemma 1 theorem 1 and theorem 2 for each j j the periodic orbit intersects the guard in domain dj at j g dj a neighborhood uj dj of r j 1 flows via the vector field f dj to reach a neighborhood gj g dj of j obtained via gj r 1 uj 1 the neighborhood j gj of j is chosen sufficiently small to ensure executions initialized in j return to gj via the poincare map pj j gj after one cycle we proceed by showing that given a chain of generalized eigenvectors associated with a non zero eigenvalue of dpj j for some j 1 k we can construct a chain of generalized eigenvectors associated with dpi i with the same eigenvalue for each i 1 k fix j 1 k and specdpj j with 6 0 suppose x j m 1 is a chain of generalized eigenvectors associated with i e dpj j xmj x m j and for all 1 m 1 x j dpj j i x 1 j 3 for all 1 m define x j 1 d j j x j and note d j j dpj j dpj 1 j 1 d j j by 2 combining this observation with 3 yields dpj 1 j 1 x m j 1 dpj 1 j 1 d j j x m j d j j dpj j x m j d j j x m j x m j 1 so that specdpj 1 j 1 and for all 1 m 1 x j 1 d j j x j d j j dpj j i x 1 j dpj 1 j 1 d j j d j j x 1 j dpj 1 j 1 i x 1 j 1 note that x j 1 m 1 must be linearly independent since they map to the linearly independent collection x j m 1 through the composition of linear maps d j 1 j 1 d j 1 j 1 therefore we conclude x j 1 m 1 is a chain of generalized eigenvectors for dpj 1 j 1 associated with proceeding induc tively for any i 1 k we obtain a corresponding chain for dpi i since the subspace associated with a maximal chain of generalized eigenvectors for a linear map is invariant under the linear map it follows that the non nilpotent jordan blocks of dpj j must be in one to one correspondence with those of dpi i for any i 1 k c exact reduction when iterates of the poincare map associated with a periodic orbit of a hybrid dynamical system have constant rank executions initialized nearby converge in finite time to a constant dimensional subsystem theorem 1 exact reduction let be a periodic orbit that undergoes isolated transitions in a hybrid dynamical system h d f g r p u a poincare map for m minj dimdj and suppose 7 there exists a neighborhood v u of u and r n such that rankdpm x r for all x v then there exists an r 1 dimensional hybrid embedded submanifold m d and a hybrid open set w d for which m w and trajectories starting in w contract to m in finite time proof we begin in step i by applying lemma 4 from appendix a b 1 to construct an r dimensional submanifold s of the poincare section that is invariant under the poincare map p subsequently in ii we flow s forward in time for one cycle i e until it returns to to obtain for each j j an r 1 dimensional submanifold mj dj that contains dj and is invariant under f finally in iii for each j j we construct an open set wj dj containing dj so that the collection m j jmj attracts all trajectories initialized in the hybrid open set w j jwj in finite time i applying lemma 4 from appendix a b 1 to p there is a neighborhood v u of u such that s pm v is an r dimensional embedded submanifold of u p s maps s diffeomorphically onto p s and p s s is an open subset of s without loss of generality we assume u g d 1 and the periodic orbit passes through each domain once per cycle for notational convenience for each j j we will let j 1 j denote the subsequent domain visited by i e we identify j with an additive monoid of integers modulo j set 1 g d 1 let u 2 d 2 be a neighborhood of r 1 over which lemma 2 from appendix a a 1 may be applied to construct a time to impact map 2 u 2 r let g 1 r 1 u 2 be a neighborhood of 1 in g d 1 and let 1 f 1 d 1 the maximal flow of f d 1 on d 1 proceed inductively forward around the cycle to construct for each j j the exit point j g dj time to impact map j uj r over a neighborhood uj dj containing r j 1 a neighborhood gj r 1 uj 1 g dj containing j and the maximal flow j fj dj of f dj on dj refer to fig 1 for an illustration of this construction ii by flowing s forward through one cycle for each j j we will construct a submanifold mj dj that is diffeomorphic to 0 1 rr observe that since p s is a diffeomorphism with s 1 s g 1 we have that the restriction r s 1 is a diffeomorphism onto its image and f r s 1 is nowhere tangent to r s 1 let m 2 d 2 be the embedded submanifold obtained by flowing r s 1 to g d 2 and let s 2 m 2 g 2 observe that s 2 is diffeomorphic to s 1 m 2 is diffeomorphic to 0 1 s 2 and f d 2 is tangent to m 2 proceed inductively forward around the cycle to construct for each j j an embedded submanifold sj gj diffeomorphic to s 1 and a submanifold mj dj diffeomorphic to 0 1 sj such that f dj is tangent to mj note that s 1 is diffeomorphic to the r dimensional manifold rr so dimmj r 1 for each j j the subsystem m j jmj d contains is invariant under the continuous flow by construction and is invariant under the reset map in the sense that r 1 m m g m is open iii finally let w 1 1 j r v d 1 be the open set that flows into v where s p m v was defined in step i let w j 1 j r 1 w 1 d j be the open set that flows into w 1 where j denotes the number of elements in j proceed inductively backward around the cycle to construct for each j j an open set wj dj that flows into s in finite time then the hybrid open set w j jwj d contains and all executions initialized in w flow into s m in finite time since m is invariant under the continuous dynamics f m is tangent to m and the discrete dynamics r g m m it determines a subsystem that governs the stability of in h corollary 1 h m m f m g m r g m is a hybrid dynamical system with periodic orbit corollary 2 the periodic orbit is lyapunov resp asymptotically exponentially stable in h if and only if is lyapunov resp asymptotically exponentially stable in h m when the rank at the fixed point p achieves the upper bound stipulated by proposition 1 the following corollary ensures that dpm is constant rank and hence theorem 1 may be applied this is important since it is possible to compute a lower bound for rankdpm via numerical simulation 35 corollary 3 if rankdpm minj j dimdj 1 m 1 then there exists an open set v u containing such that rankdpm x m 1 for all x v thus the hypotheses of theorem 1 are satisfied with r m 1 8 if the poincare map attains the same constant rank r for two subsequent iterates it is not necessary to continue up to iterate m minj dimdj before checking the hypotheses of theorem 1 corollary 4 if there exists a neighborhood w u of and k r n such that rank dp k x r for all x w and rank dp k 1 rank dp k then there exists a neighborhood v w of such that rank dpm x r for all x v thus the hypotheses of theorem 1 are satisfied with r rank dp k the choice of poincare section in theorem 1 is irrelevant in the sense that the poincare map p u defined over any other poincare section will be constant rank in a neighborhood v u of its fixed point as the following corollary shows this follows directly from lemma 4 in 33 corollary 5 under the hypotheses of theorem 1 if p u is any other poincare map for with fixed point p then there exists an open subset v u containing such that rankdp m x r for all x v thus the hypotheses of theorem 1 are satisfied for p with r rank dp m d approximate reduction restricting our attention to exponentially stable periodic orbits we find that a hybrid system generically contracts superexponentially to a constant dimensional subsystem near a periodic orbit theorem 2 approximate reduction let be an exponentially stable periodic orbit undergoing isolated transitions in a hybrid dynamical system h d f g r p u a poincare map for with fixed point m minj dimdj and r rankdpm then there exists an r 1 dimensional hybrid embedded submanifold m d such that for any 0 there exists a hybrid open set w d for which m w and the distance from trajectories starting in w to m contracts by each cycle proof we begin with an overview of the proof strategy first i for each j j we construct a poincare map pj over a poincare section j g dj and apply lemma 5 from appendix a b 2 to obtain a change of coordinates in which pj splits into two components a linear map that only depends on the first r coordinates and a nonlinear map whose linearization is nilpotent at the fixed point of pj second ii for each j j we construct an r dimensional submanifold sj j such that r sj is a diffeomorphism near the fixed point of pj we subsequently flow the image r sj forward until it impacts the guard to construct an r 1 dimensional submanifold mj 1 dj 1 that contains dj 1 and is invariant under f third iii for each j j we apply lemma 6 from appendix a b 3 to construct a distance metric on an open set wj dj containing dj with respect to which executions contract superexponentially toward mj i without loss of generality we assume u g d 1 the periodic orbit passes through each domain once per cycle as in the proof of theorem 1 for each j j we will let j 1 j denote the subsequent domain visited by i e we identify j with an additive monoid of integers modulo j for each j j let pj uj j be a poincare map for defined over uj j g dj and let j g dj be the exit point of in dj refer to fig 1 for an illustration of this construction lemma 1 implies that rankdpmj j r for all j j applying lemma 5 from appendix a b 2 implies that for each j j there exists an open set vj uj containing j and a c 1 diffeomorphism j vj rnj 1 where nj dimdj such that j j 0 and the coordinate representation p j j pj 1 j of pj has the form p j zj j ajzj sj zj j where zj rr j rnj 1 r aj rr r is invertible sj 0 0 0 and d jsj 0 0 is nilpotent for each j j let j vj g be a smooth map defined as follows given x vj write zx x j x rr rnj r 1 and let j x 1 j zx 0 ii fix j j and let nj 1 j r r 0 vj an r dimensional embedded submanifold tangent to the non nilpotent eigendirections of dpmj j observe that dr g nj j has rank r dimnj hence by the inverse function theorem 27 theorem 7 10 there is a neighborhood sj nj containing j such that r sj sj d is a diffeomorphism onto its image r sj dj 1 furthermore since rankdpmj j r the vector field is transverse to r sj at j i e f r j 6 tr j r sj and we assume sj was chosen 9 small enough so that f is transverse along all of r sj let mj 1 dj 1 be the embedded submanifold obtained by flowing r sj forward to g note that mj 1 is diffeomorphic to 0 1 rr observe that m j jmj is invariant under the continuous flow i e f m is tangent to m and approximately invariant under the reset map in the sense that dr g m is tangent to m on for all j j and t j g m we have dr g m j tr j m observe that r j g mj g mj mj 1 is a diffeomorphism onto its image iii fix 0 and apply the construction in the proof of lemma 6 from appendix a b 3 to obtain a radius 0 and for each j j a norm j r nj 1 r such that the nonlinearity p j zj j ajzj 0 contracts exponentially fast with rate on b nj 1 0 r nj 1 as measured by j for each j j define v j 1 j b nj 1 0 g dj let j fj dj denote the maximal flow of f dj on dj and let w j 1 j r v j dj be the open set of points that flow into v j since j is the flow of a smooth vector field transverse to v j any x w j can be written uniquely as x j tx vx for some tx 0 and vx v j using this representation we endow w j with a distance metric d j w j w j r by defining d j x y tx ty j vx j vy j observe that the exponential contraction of p j at rate in j to j mj g implies exponential contraction of executions initialized in w j at rate to m in d j finally let w j jw j and m m w define a smooth hybrid map g w g piecewise for each j j by observing that g w j vj and letting x j x for all x g w j corollary 6 letting m m w the collection h m m f m g m r g m is a c 1 hybrid dynamical system with periodic orbit where g w g is the smooth hybrid map constructed in the proof of theorem 2 although the submanifold m d is invariant under the continuous dynamics of h in the sense that f m is tangent to m the reset map must be modified to ensure m is invariant under the discrete dynamics however since dr g m d r g m the map does not affect r to first order remark 3 we emphasize that hypothesis on the rank of the poincare map p u in theorem 2 rankdpm r at the point is weaker than the hypothesis in theorem 1 rankdpm x r for all x in an open set v u in particular approximating the rank over an uncountably infinite set typically involves estimates on higher order derivatives of pm if the rank is constant for two subsequent iterates of the linearized poincare map then the rank is constant for all subsequent iterates including iterate m minj dimdj corollary 7 if there exist k n such that rank dp k rank dp k 1 then rank dpm rank dp k thus the hypotheses of theorem 2 are satisfied with r rank dp k e smoothing the subsystems yielded by theorems 1 and 2 on exact and approximate reduction share important properties the constituent manifolds have the same dimension the reset map is a hybrid diffeomorphism between disjoint portions of the boundary and the vector field points inward along the range of the reset map under these conditions we can globally smooth the hybrid transitions using techniques from differential topology to obtain a single continuous time dynamical system executions of the hybrid sub system are preserved as integral curves of the continuous time system this provides a smooth n dimensional generalization of the hybrifold construction in 36 the phase space constructed in 37 to analyze mechanical impact as well as the change of coordinates constructed in 38 3 1 1 to simplify analysis of juggling theorem 3 smoothing let h m f g r be a hybrid dynamical system with m j jmj suppose dimmj n for all j j r g m m g r g r is a hybrid diffeomorphism onto 10 d 2 d 1 x f d 1 x x f d 2 x g d 1 g d 2 r g d 1 r g d 2 m 2 m 1 a h d f g r m 1 x f m 1 x x f m 2 x g m 1 g m 2 r g m 1 r g m 2 m 2 m 1 b h m m f m g m r g m m x f x m m g m r r g m c m f fig 2 a applying theorem 1 exact reduction to a hybrid dynamical system h d f g r containing a periodic orbit with associated poincare map p u yields an invariant subsystem m j j mj nearby trajectories contract to m in finite time b the subsystem may be extracted to yield a hybrid dynamical system h m c the hybrid system h m may subsequently be smoothed via theorem 3 smoothing to yield a continuous time dynamical system m f application of theorem 3 to the subsystem from theorem 2 approximate reduction is illustrated by replacing h m with h m its image and f is inward pointing along r g then the topological quotient m m g r r g may be endowed with the structure of a smooth manifold such that 1 the quotient projection m m restricts to a smooth embedding mj mj m for each j j 2 there is a smooth vector field f t m such that any execution x t m of h descends to an integral curve of f on m via m m t t d dt x t f x t proof let s g mi be a connected component in some domain i j and let k j be the index for which r s mk the hypotheses of this theorem together with assumption 1 ensure lemma 3 from appendix a a 2 may be applied to attach mi to mk to yield a new smooth manifold m ik the hybrid system defined over the domain m ik mj j j i k and guard g s satisfies the hypotheses of this theorem hence we may inductively attach domains on each connected component that remains in g s this yields a smooth manifold m and vector field f t m with the required properties remark 4 as illustrated in fig 2 theorem 3 is applicable to the subsystems h m h m that emerge as a consequence of the corollaries to theorems 1 and 2 respectively thus a class of hybrid models for periodic phenomena may be reduced exactly or approximately to smooth dynamical systems iv applications the theorems of section iii apply directly to autonomous hybrid dynamical systems in section iv a we demonstrate that reduction to a smooth subsystem can occur spontaneously in a mechanical sys tem undergoing intermittent impacts the results are also applicable to systems with control inputs in section iv b we synthesize a state feedback control law that reduces a family of multi leg models for lateral plane locomotion to a common low dimensional subsystem and in section iv c we analyze the structural stability of event triggered deadbeat control laws for locomotion finally the reduction of hybrid dynamics to a smooth subsystem provides a route through which tools from classical dynamical systems theory can be generalized to the hybrid setting in section iv d we extend a normal form for limit cycles a spontaneous reduction in a vertical hopper in this section we apply theorem 1 exact reduction to the vertical hopper example shown in fig 3 this system evolves through an aerial mode and a ground mode in the aerial mode the lower mass 11 m b x t y t k a g fig 3 schematic of vertical hopper two masses m and constrained to move vertically above a ground plane in a gravitational field with magnitude g are connected by a linear spring with stiffness k and nominal length the lower mass experiences viscous drag proportional to velocity with constant b when it is in the air and impacts plastically with the ground i e it is not permitted to penetrate the ground and its velocity is instantaneously set to zero whenever a collision occurs when the lower mass is in contact with the ground the spring stiffness is multiplied by a constant a 1 moves freely at or above the ground height transition to the ground mode occurs when the lower mass reaches the ground height with negative velocity where it undergoes a perfectly plastic impact i e its velocity is instantaneously set to zero in the ground mode the lower mass remains stationary transition to the aerial mode occurs when the aerial mode force allows the mass to lift off we now formulate this model in the hybrid dynamical system framework of definition 1 the aerial mode da see fig 3 for notation consists of y y x x da tr tr 0 and the vector field f da is given by y k y x g mx k y x bx mg the boundary da y y x x da x 0 contains the states where the lower mass has just impacted the ground and a hybrid transition occurs on the subset ga y y 0 x da x 0 of the boundary da where the lower mass has negative velocity the state is reinitialized in the ground mode via r ga ga dg defined by r ga y y 0 x y y in the ground mode dg y y tr k y mg the boundary consists of the set of configurations where the force in the aerial mode allows the lower mass to lift off dg y y dg k y mg and the vector field f dg is given by y ak y g a hybrid transition occurs when the forces balance and will instantaneously increase to pull the mass off the ground gg y y dg y t 0 and the state is reset via r gg gg da defined by r gg y y y y 0 0 this defines a hybrid dynamical system d f g r where d da dg f t d g ga gg r g d with parameters m k b a g 1 3 10 5 2 2 2 numerical simulations suggest the vertical hopper possesses a stable periodic orbit y y x x to which nearby trajectories y y x x converge asymptotically choosing a poincare section in the ground domain dg at mid stance y y y 0 dg we find numerically 4 that the hopper possesses a stable periodic orbit that intersects the poincare section at where y y 0 94 0 00 using finite differences we determine that the linearization dp of the associated scalar valued poincare map p has eigenvalue specdp 0 57 at the fixed point p the rank of the poincare map p attains the upper bound of proposition 1 hence corollary 3 implies the rank hypothesis of theorem 1 exact reduction is satisfied thus the dynamics of the hopper collapse to a one degree of freedom mechanical system after a single hop geometrically the portion of the reduced subsystem in each domain is diffeomorphic to 0 1 r algebraically the constraint that activates when the lower mass impacts the 4 for numerical simulations we use a recently developed algorithm 35 with step size h 1 10 2 and relaxation parameter 1 10 10 12 m j x y hk k xk yk mk k a polyped with n 4 legs leg k annotated v m j x y h b lateral leg spring lls 17 fig 4 lateral plane models for locomotion described in section iv b ground transfers to the aerial mode where no such physical constraint exists the lower mass state x x is uniquely determined by the upper mass state y y for all future times b reducing a 3 2 n dof polyped to a 3 dof lls a primary motivation for the present work is analysis of legged locomotion several approaches have been proposed for embedding lower dimensional dynamics in legged robot systems notably hybrid zero dynamics 21 and active embedding 25 complementing these engineering approaches and predating them the templates and anchors hypotheses tah 11 conjectures that animal locomotion behaviors arise through reduction of the anchor dynamics governing the nervous system and body 1 to lower dimensional template dynamics that encode a specific behavior 16 17 one well studied template is the lateral leg spring lls 17 model for sprawled posture running which has been shown to match how cockroaches run and begin to recover from perturbations 39 higher dimensional neuromechanical variants of the model have been shown to reduce states associated with the nervous system 1 in this section we focus on reduction in the mechanical dynamics of limbs specifically we synthesize a state feedback control law under which the underactuated lateral plane polyped illustrated in fig 4 a exactly reduces to the lateral leg spring lls 17 model in fig 4 b with n limbs the polyped possesses 3 2 n degrees of freedom dof the lls has 3 dof this example serves a dual purpose first it demonstrates how our theoretical results can be applied to reduce an arbitrary number of dof in a locomotion model second it suggests a mechanism that legged robot controllers could exploit to anchor a desired template before we proceed with describing the reduction procedure in detail we give an overview of the approach and the connection with theorem 1 we begin in section iv b 1 by describing the dynamics of the lls template and polyped anchor then in section iv b 2 we construct a smooth state feedback law that ensures that trajectories of the polyped body exactly match those of the lls we accomplish this by simply ensuring the net wrench 40 comprised of generalized forces and torques acting on the polyped body matches that of the lls for all time subsequently in section iv b 3 we modify the feedback law to further ensure the states associated with the polyped s limbs reduce after a single stride via theorem 1 finally in section iv b 5 we discuss the effect of perturbations on the closed loop reduced order system 1 dynamics of lateral leg spring lls and n leg polyped the lls is an energy conserving lateral plane model for locomotion comprised of a massless leg spring with elastic potential v affixed at hip position h to an inertial body with two translational x y and one rotational dof the system is 13 initialized at the start of a stride by orienting the leg at a fixed angle with respect to the body at rest length and touching the foot down such that the leg will instantaneously contract the step ends once the leg extends to its rest length by touching the foot down on the opposite side of the body subsequent steps are defined inductively in certain parameter regimes the model possesses a periodic running gait 17 the underactuated hybrid control system illustrated in fig 4 a extends neuromechanical models pre viously proposed to study multi legged locomotion 1 18 by introducing masses into n 4 feet connected by massless limbs affixed at hip locations hk n k 1 on the inertial body we assume that each foot can attach or detach from the substrate at any time and the transition from swing to stance entails a plastic impact that annihilates the kinetic energy in a foot we assume that each limb k is fully actuated for simplicity we assume the inputs act along the cartesian coordinates and do not saturate so that any k k r 2 is feasible at any limb configuration we let q 0 x y q 0 r 2 s 1 denote the position and orientation of the body and for each k 1 n we let qk xk yk qk r 2 denote the position of the k th foot the configuration space of the polyped is the n 1 fold product n k 0 qk the n leg polyped s dynamics thus have the form mq 0 n k 1 k k 0 adgk mkq k k k 4 where m diag m m j r 3 3 is the mass distribution of the body and adgk r 3 3 transforms a wrench applied at the k th hip to an equivalent wrench applied at the body center of mass 40 5 1 2 embedding lls in polyped for any subset k 1 n of limbs let k k k k 0 adgk t q 0 5 denote the net wrench 40 on the body resulting from actuating legs in k then so long as no two hips are coincident and k 2 any desired wrench may be imposed on the body by appropriate choice of inputs to the limbs in k regardless of whether k contains limbs in stance or swing in the next section we describe a limb coordination procedure that ensures there will be a subset of stance limbs that can impose the lls s wrench and cancel the reaction wrench from actuating other limbs at any time 3 reducing polyped to lls we construct a smooth state feedback control law yielding a closed loop poincare map pa ua a for the polyped that splits as pa ut un t n such that pa z pt z pn z 6 where pt ut t is a poincare map for the lls and pn ut n is a smooth map in the form 6 it is clear that since pt is a diffeomorphism near the fixed point pt all iterates of pa have constant rank equal to rank dpt dim t near and therefore theorem 1 applies partition the n 4 limbs into swing stance ensuring swing stance 2 initialize at the beginning of a step at time t with lls and polyped body state q 0 t q 0 t and polyped limb states qk t q k t n k 1 by attaching stance limbs and detaching swing limbs from the ground note that the termination time for the lls step depends smoothly on the initial condition q 0 t q 0 t for each k swing choosing constant inputs k k 2 2 x y r q k qk t q k t 7 ensures that the limb will reach a fixed location q k in the body frame of reference at time for each k stance choose inputs k k to cancel the reaction wrench from the swing limbs and impose the lls acceleration on the polyped body at time t exchange the stance and swing limb sets and proceed as with the previous step from the new initial condition after two steps it is clear that the positions and velocities of the polyped s n limbs are uniquely determined by the body initial condition q 0 t q 0 t therefore the polyped s poincare map has the form of 6 so theorem 1 implies the polyped anchor reduces exactly to the lls template after a single stride 14 4 qualitative description of reduction the active embedding described in section iv b 2 ensures the polyped body motion is always identical to that of the lls regardless of the state of the limbs the limb posture control in section iv b 3 guarantees the limb states are determined by the lls body state after two steps and furthermore synchronizes touchdown and liftoff events with those of the lls 5 effect of perturbations and parameter variations the qualitative description in the preceding section makes it clear that following a sufficiently small perturbation or parameter variation the closed loop polyped will continue to track and ultimately reduce to an lls that experiences the corresponding disturbance note that this conclusion requires that the polyped maintains the same control architecture exploited above to obtain the product decomposition in 6 in particular the controller must maintain observability of the full state and controllability of the limbs we study the effect of more general perturbations in the next section c deadbeat control of rhythmic hybrid systems generalizing the example from the previous section we now consider a system wherein a finitely parameterized control input updates when an execution passes through a distinguished subset of state space this form of control in rhythmic hybrid systems dates back at least to raibert s hoppers 41 and koditschek s jugglers 2 and has recently received renewed interest 14 22 24 25 42 44 we model this with a hybrid system h d f g r whose vector field and reset map depend on a control input that takes values in a smooth boundaryless manifold the value of the control input may be updated whenever an execution passes through the guard g but it does not change in response to the continuous flow suppose for some that h possesses a periodic orbit let p u be a poincare map associated with where u g and let in this section we study deadbeat control of the discrete time nonlinear control system xi 1 p xi i 8 and the discrete time linear control system obtained by linearizing p about the fixed point p xi 1 dxp xi d p i 9 the control architecture we present is well known for linear and nonlinear maps arising in locomotion 22 the novelty of this section lies in the connection to exact and approximate reduction via theorems 1 and 2 1 exact reduction over one cycle as studied in 22 an application of the implicit function theo rem 27 theorem 7 8 shows that if rankd p dim then there exists a neighborhood v u of and a smooth feedback law v such that for all x v we have p x x i e is a deadbeat control law for 8 since is smooth the closed loop poincare map p v defined by p x p x x satisfies the hypotheses of theorem 1 exact reduction with rank r 0 so the invariant subsystem yielded by the theorem is simply the periodic orbit in practice it may be desirable to reduce fewer than dim coordinates if there exists a smooth function h rd that satisfies h p 0 and rank d h p d then the preceding construction yields a closed loop system that reduces via theorem 1 to the embedded d dimensional submanifold h 1 0 near 2 exact reduction over multiple cycles if rank d p dim as noted in 22 it may be possible to construct a deadbeat control law by applying inputs over multiple cycles specifically let p 0 p and for each n define p u by p x 1 p p 1 x 1 1 10 for all x 1 u where u u is a neighborhood of sufficiently small to ensure 10 is well defined then if there exists k n such that rank d 1 k pk dim 11 15 the construction from the previous paragraph yields a smooth k step feedback law k vk k such that the closed loop hybrid system reduces via theorem 1 to the periodic orbit after k cycles we conclude this section by noting that 22 contains an example that performs exact reduction after two cycles and for which reduction in fewer cycles is impossible 3 approximate reduction since 11 is equivalent to controllability 34 chapter 8 d 5 of the linear control system 9 it is worthwhile to consider the linear control problem any stabilizable subspace s 34 chapter 8 d 7 of 9 can be rendered attracting in a finite number of steps k n with linear state feedback i xi where is a fixed matrix 45 applying this linear feedback law to the nonlinear system 8 yields a closed loop poincare map p such that the rangespace of the k th iterate of its linearization dxp k is contained in s therefore theorem 2 approximate reduction yields an invariant hybrid subsystem tangent to s on that attracts nearby trajectories superexponentially thus although feedback laws for the nonlinear control system 8 constructed above can be computed using the procedure described in 22 to achieve exact reduction to the target subsystem if approximate reduction suffices then one may simply apply the linear deadbeat controller computed for 9 4 structural stability of deadbeat control suppose the preceding development is applied to a model that differs from that used to construct the feedback law c v we study the structural stabil ity 31 section 1 7 of attracting invariant sets arising in this class of systems by applying the theorems of section iii if the models differ by a small smooth deformation as would occur if there was a small perturbation in model parameters one interpretation of this change is that some b c v is applied to the model for which is deadbeat where 0 bounds the error for all 0 sufficiently small yields a perturbed closed loop poincare map p v possessing a unique fixed point v and is an exponentially stable fixed point of the perturbed system we conclude by noting that it is possible for the structure of the hybrid dynamics to constrain the achievable perturbations for instance if one domain of the hybrid system has lower dimension than that in which the poincare map is constructed then zero is always a floquet multiplier regardless of the applied feedback in this case theorem 2 approximate reduction implies the existence of a proper submanifold of the poincare section to which trajectories contract superexponentially in the presence of any sufficiently small smooth perturbation to the closed loop dynamics d hybrid floquet coordinates when a hybrid system reduces to a smooth dynamical system near a periodic orbit via theorem 1 exact reduction we can generalize the floquet normal form 46 49 using theorem 3 smoothing broadly this demonstrates how the theorems of section iii can be applied to generalize constructions from classical dynamical systems theory to the hybrid setting more concretely this provides a theoretical framework that justifies application of the empirical approach developed in 48 49 to estimate low dimensional invariant dynamics in data collected from physical locomotors consider a hybrid dynamical system h d f g r with periodic orbit that satisfies the hypotheses of theorem 1 let m d be the r 1 dimensional invariant hybrid subsystem yielded by the theorem and w d a hybrid open set containing that contracts to m in finite time let m f denote the smooth dynamical system obtained by applying theorem 3 under a genericity condition 5 there exists a neighborhood u m of and a smooth chart u rr s 1 such that the coordinate representation of the vector field has the form d f d 1 z z a z 2 12 where z rr and s 1 in these coordinates each s 1 determines an embedded submanifold n rr rr s 1 that is mapped to itself after flowing forward in time by for this reason 5 either the periodic orbit is exponentially stable or it is hyperbolic and the associated floquet multipliers do not satisfy any diophantine equation 31 chapter 3 3 16 the submanifolds n are referred to as isochrons 47 each x n may be assigned the phase s 1 if is stable then as t the trajectory initialized at x will asymptotically converge to the trajectory initialized at 0 the isochrons may be pulled back to any precompact hybrid open set v w containing in the original hybrid system as follows the proof of theorem 1 implies there exists a finite time t such that every execution initialized in v is defined over the time interval 0 t and reaches m before time t without loss of generality we take this time to be a multiple k of the period of for some k n let v m denote the map that flows an initial condition x v forward by t time units and then applies the quotient projection m m obtained from theorem 3 to yield the point x m then the constructions in the proof of theorem 1 imply that is a smooth map in the sense defined in section iii a i e it is continuous and v dj is smooth for each j j now for any s 1 the set n 1 u is mapped into n after k units of time we thus refer to n d as a hybrid isochron we conclude by noting that n will generally not be a smooth hybrid submanifold v discussion generically for an exponentially stable periodic orbit in a hybrid dynamical system nearby trajectories contract superexponentially to a subsystem containing the orbit under a non degeneracy condition on the rank of any poincare map associated with the orbit this contraction occurs in finite time regardless of the stability of the orbit hybrid transitions may be removed from the resulting subsystem yielding an equivalent smooth dynamical system thus the dynamics near stable hybrid periodic orbits are generally obtained by extending the behavior of a smooth system in transverse coordinates that decay superexpo nentially although the applications presented in section iv focused on terrestrial locomotion 1 we emphasize that the results in section iii do not depend on the phenomenology of the physical system under investigation and are hence equally suited to study rhythmic hybrid control systems appearing in robotic manipulation 2 biochemistry 3 and electrical systems 4 in addition to providing a canonical form for the dynamics near hybrid periodic orbits the results of this paper suggest a mechanism by which a many legged locomotor or a multi fingered manipu lator may collapse a large number of mechanical degrees of freedom to produce a low dimensional coordinated motion this provides a link between disparate lines of research formal analysis of hybrid periodic orbits design of robots for rhythmic locomotion and manipulation tasks and scientific probing of neuromechanical control architectures in humans and animals our theoretical results show that hybrid models of rhythmic phenomena generically reduce dimensionality and our applications demonstrate that this reduction may be deliberately designed into an engineered system we furthermore speculate that evolution may have exploited this reduction in developing its spectacularly dexterous agents support this research was supported in part by an nsf graduate research fellowship to s a burden aro young investigator award 61770 to s revzen and army research laboratory cooperative agreements w 911 nf 08 2 0004 and w 911 nf 10 2 0016 the views and conclusions contained in this document are those of the authors and should not be interpreted as representing the official policies either expressed or implied of the army research laboratory or the u s government the u s government is authorized to reproduce and distribute for government purposes notwithstanding any copyright notation herein acknowledgments we thank john hauser for correcting an error in an earlier version of this manuscript and sam coogan john guckenheimer ram vasudevan and the three anonymous reviewers for their invaluable feedback 17 appendix a smooth dynamical systems we constructed hybrid systems using switching maps defined on boundaries of smooth dynamical systems the behavior of such systems can be studied by alternately applying flows and maps thus in this section we collect results that provide canonical forms for the behavior of flows and maps near periodic orbits and fixed points respectively the first develops a canonical form for the flow to a section in a continuous time system the second provides a technique to smoothly attach continuous time systems along their boundaries the third and fourth establish a canonical form for submanifolds that are invariant and approximately invariant respectively near fixed points in discrete time dynamical systems the fifth provides an estimate of the error in the invariance approximation a continuous time dynamical systems definition 4 a continuous time dynamical system is a pair m f where m is a smooth manifold with boundary m f is a smooth vector field on m i e f t m 1 time to impact when a trajectory passes transversely through an embedded submanifold the time required for nearby trajectories to pass through the manifold depends smoothly on the initial condition 30 chapter 11 2 this provides the prototype used in the proofs of theorems 1 and 2 for the dynamics near the portion of a hybrid periodic orbit in one domain of a hybrid system lemma 2 let m f be a smooth dynamical system f m the maximal flow associated with f and g m a smooth codimension 1 embedded submanifold if there exists x m and t fx such that t x g and f t x 6 t t x g then there is a neighborhood u m containing x and a smooth map u r so that x t and y y g for all y u is called the time to impact map proof near t x g is the zero section of a constant rank map h m r where dh t x 6 0 define g f r by g s y h s y then since f is transverse to g at t x g t t x dh f t x 6 0 by the implicit function theorem see theorem 7 8 in 27 there exists a neighborhood u of x and a smooth map u r so that x t and g y y 0 for all y u i e y y g remark 5 this lemma is applicable when g m 2 smoothing flows two continuous time dynamical systems can be smoothly attached to one another along their boundaries to obtain a new continuous time system 26 theorem 8 2 1 distinct hybrid domains were attached to one another using this construction in section iii lemma 3 suppose m 1 f 1 m 2 f 2 are n dimensional continuous time dynamical systems there exists a diffeomorphism r m 1 m 2 f 1 is outward pointing along m 1 and f 2 is inward pointing along m 2 then the topological quotient m m 1 m 2 m 1 r m 2 can be endowed with the structure of a smooth manifold such that for j 1 2 1 the quotient projections j mj m are smooth embeddings and 2 there is a smooth vector field f t m that restricts to d j fj on mj m proof let j fj mj be the maximal flow associated with fj on mj then there is a neighborhood u j fj of 0 mj on which the flow is defined and with uj u j r mj transversality of fj along mj implies j uj mj is an embedding which is the identity on 0 mj since f 1 18 is outward pointing and f 2 is inward pointing the neighborhoods are one sided and without loss of generality we may assume for j 1 2 that there exist continuous positive functions j mj 0 such that u 1 1 x 0 x m 1 and u 2 0 2 x x m 2 therefore u u 1 u 2 m 1 m 2 inherits a smooth structure from its product structure i e the fibers ux 1 x 2 x x are smooth curves for x m 1 and both 0 m 1 u and 0 1 m 2 u are smooth embeddings let u rn denote the chart note in addition that by construction the constant vector field t t uj pushes forward to fj j uj mj t j uj mj since d j t fj we construct the smooth structure on m m 1 m 2 m 1 m 2 by covering m with interior charts from the mj s together with u note that since j uj uj mj is a smooth embedding the interior charts on mj are smoothly compatible with the product chart on u and the natural quotient projections j mj m are smooth embeddings finally d 1 f 1 d 2 f 2 along 1 m 1 by construction whence the vector field f t m which restricts to fj on mj j 1 2 is well defined and smooth remark 6 the smooth structure constructed in lemma 3 is unique up to diffeomorphism 26 theorem 2 1 in chapter 8 b discrete time dynamical systems definition 5 a discrete time dynamical system is a pair p where is a smooth manifold without boundary p is a smooth endomorphism of i e p in studying hybrid dynamical systems we encounter smooth maps p that are noninvertible viewing iteration of p as determining a discrete time dynamical system we wish to study the behavior of these iterates near a fixed point p note that if p has constant rank equal to k n dim then its image p is an embedded k dimensional submanifold near by the rank theorem 27 theorem 7 13 with an eye toward model reduction one might hope that the composition p p p is also constant rank but this is not generally true 6 in this section we provide three results that introduce regularity into iterates of a noninvertible map p on an n dimensional manifold near a fixed point p if the rank of dp is strictly bounded above by m n and if pm the m th iterate of p has constant rank equal to r n near the fixed point then p reduces to a diffeomorphism over an r dimensional invariant submanifold after m iterations this result is given in section a b 1 even if dpm is not constant rank as long as is exponentially stable then p can be approximated by a diffeomorphism on a submanifold whose dimension equals rank dpm this is the subject of section a b 2 a bound on the error in this approximation is provided in section a b 3 1 exact reduction if the rank of p is strictly bounded above by m n and the derivative of the m th iterate of p has constant rank near a fixed point then the range of p is locally an embedded submanifold and p restricts to a diffeomorphism over that submanifold this originally appeared without proof as lemma 3 in 33 lemma 4 let p be an n dimensional discrete time dynamical system with p for some suppose the rank of p is strictly bounded above by m n and there exists a neighborhood w of such that rank dpm x r for all x w then there is a neighborhood v containing such that pm v is an r dimensional embedded submanifold near and there is a neighborhood u pm v containing that p maps diffeomorphically onto p u pm v in the proof of lemma 4 we make use of a fact from linear algebra obtained by passing to the jordan canonical form 6 consider the map p r 2 r 2 defined by p x y x 2 x 19 proposition 2 if a rn n and ranka m then rank a 2 m rank am proof of lemma 4 by the rank theorem 27 theorem 7 13 there is a neighborhood v of for which s pm v is an r dimensional embedded submanifold and by proposition 2 we have rank dpm s rankd pm pm rankdpm therefore dpm s t s t s is a bijection so by the inverse function theorem 27 theorem 7 10 there is a neighborhood w s containing so that pm w s and pm w w pm w is a diffeomorphism we now show that w is invariant under p in a neighborhood of by continuity of p there is a neighborhood l v containing for which p l v and pm l w the set u pm l is a neighborhood of in s further we have p u p pm l pm p l s the restriction pm u u pm u is a diffeomorphism since u w whence p u is a diffeomorphism onto its image p u s 2 approximate reduction now suppose that iterates of p are not constant rank but p is exponentially stable meaning that the spectral radius dp max specdp satisfies dp 1 we show that p may be approximated by a diffeomorphism defined on a submanifold whose dimension equals the number of non zero eigenvalues of dp the technical result we desire was originally established by hartman 50 7 we apply hartman s theorem to construct a c 1 change of coordinates that exactly linearizes all eigendirections corresponding to non zero eigenvalues of dp lemma 5 let p be an n dimensional discrete time dynamical system suppose p is an exponentially stable fixed point and let r be the number of non zero eigenvalues of dp then there is a neighborhood u of and a c 1 diffeomorphism u rn such that 0 and the coordinate representation p p 1 of p has the form p z az n z where z rr rn r a rr r is invertible n u rn r is c 1 n 0 0 0 and d n 0 0 is nilpotent proof let u 0 0 be a smooth chart for with u 0 and 0 0 we begin by verifying that the hypotheses of theorem 4 from appendix b are satisfied for the map p 0 0 u 0 rn defined by p 0 0 p 10 let specdp 0 0 be the eigenvalue with largest magnitude and n its algebraic multiplicity applying the linear change of coordinates that puts dp 0 0 into jordan canonical form we assume dp 0 0 a 0 0 b where b r and specb now in the notation of theorem 4 p 0 x y ax x x y by y x y where x rn y r and x y are smooth and x 0 0 0 y 0 0 0 note that m 0 there is no z coordinate at this step because x and y are smooth on the neighborhood u 0 of the origin their derivatives are uniformly lipschitz and ho lder continuous on a precompact open subset of u 0 7 the statement in 50 only considered invertible contractions however as noted in 51 the proof in 50 of the result we require does not make use of invertibility and the conclusion is still valid if zero is an eigenvalue of the linearization for details we refer to 52 20 theorem 4 implies there exists a neighborhood u 1 rn of the origin and a c 1 diffeomorphism 1 u 1 rn for which the map p 1 1 u 1 rn defined by p 1 1 p 0 11 has the form after reversing the order of the coordinates p 1 z 1 1 a 1 z 1 n 1 z 1 1 where z 1 rr 1 r 1 0 1 rn r 1 and a 1 rr 1 r 1 is invertible observe that the map p 1 satisfies the hypotheses of theorem 4 therefore we may inductively apply the theorem to construct a sequence of coordinate charts uk k k k 1 and corresponding maps pk k k 1 such that for all k 1 k pk zk k akzk nk zk k where zk rrk k rn rk ak rrk rk is invertible and rk rk 1 note that r 0 0 the sequence terminates at a finite k with rk r rankdp n therefore in the c 1 chart u given by k 0 and u 1 rn the coordinate representation p p 1 of p has the form p z az n z where z rr rn r and a rr r is invertible since a is invertible and rankdp n r d n 0 0 is nilpotent 3 superstability finally we recall that if all eigenvalues of the linearization of a map at a fixed point are zero a so called superstable fixed point 28 then the map contracts superexponentially 8 this is a straightforward consequence of ostrowski s theorem 53 8 1 7 lemma 6 let p rn rn be a c 1 map with p 0 0 specdp 0 0 then for every 0 and norm rn r there exists c 0 such that x b 0 k n p k x c k x the proof of lemma 6 relies on the following elementary fact regarding induced norms 53 1 3 6 proposition 3 1 3 6 in 53 given 0 and a rn n there exists a norm rn r such that a i a where i r n n r is the operator norm induced by and a is the spectral radius of a proof of lemma 6 given 0 choose the norm rn r obtained by applying proposition 3 to dp 0 so that dp 0 i 1 2 since dp is continuous there exists a 0 such that x b 0 dp x dp 0 i 1 2 whence we find for x that dp x i dp x dp 0 dp 0 i dp x dp 0 i dp 0 i combined with 8 1 4 in 53 a generalization of the mean value theorem to vector valued functions we find for all x b 0 p x sup s 0 1 dp sx i x x iterating for all k n and x we have p k x k x since all norms on finite dimensional vector spaces are equivalent the desired result follows immediately remark 7 let p be an n dimensional discrete time dynamical system that satisfies the hypotheses of lemma 5 near p then p has a coordinate representation p z az n z in a 8 the map need not be nilpotent simply because its linearization is consider the map p r r defined by p x x 2 21 neighborhood of where a is an invertible matrix n 0 0 0 and specd n 0 0 0 therefore given 0 we can apply lemma 6 to the nonlinearity p z az 0 0 n z to find c 0 such that for all z b 0 and k n p k z akz 0 c k z we conclude that p is arbitrarily well approximated near by a diffeomorphism on a submanifold whose dimension equals rankdp n appendix b c 1 linearization the technical result we desire was originally established by hartman in the course of proving that an invertible contraction is c 1 conjugate to its linearization 9 the original statement in 50 only considered invertible contractions however as noted in 51 the proof in 50 of the result we require does not make use of invertibility and the conclusion is still valid if zero is an eigenvalue of the linearization for details we refer the reader to 52 which also contains a generalization to hyperbolic periodic orbits whose eigenvalues satisfy genericity conditions theorem 4 induction assertion in 50 let u rn be a neighborhood of the origin and p u rn a c 1 map of the form p x y z ax x x y z by y x y z cz such that dp 0 a 0 00 b 0 0 0 c where 1 x rk y r z rm and k m n 2 a rk k b r and c rm m 3 x rn rk and y rn r are c 1 4 dxx dyx dxy and dyy are uniformly lipschitz continuous in x y 5 dzx and dzy are uniformly ho lder continuous in z suppose all the eigenvalues of b have the same magnitude that the eigenvalues of a have smaller magnitude and those of c have larger magnitude than those of b and all eigenvalues of dp 0 lie inside the unit disc b specb b a speca b specb c specc 0 a b c 1 then there is a neighborhood of the origin v rn and a c 1 diffeomorphism v rn of the form x y z x x z y y x y z z for which d 0 i and for all u v w v we have p 1 u v w au u u v w bv cw where 1 u v rk is c 1 2 duu is uniformly lipschitz continuous in u v w 9 readers may be more familiar with the hartman grobman theorem see 31 theorem 1 4 1 or 54 theorem 7 8 which states that the phase portrait near an exponentially stable fixed point of a discrete time dynamical system is topologically conjugate to its linearization 22 3 dvu and dwu are uniformly lipschitz continuous in u 4 dvu and dwu are uniformly ho lder continuous in v w remark 8 theorem 4 may be applied inductively to exactly linearize all eigendirections corresponding to non zero eigenvalues via a c 1 change of coordinates this is the content of lemma 5 in section a b 2 references 1 p holmes r j full d e koditschek and j m guckenheimer the dynamics of legged locomotion models analyses and challenges siam review vol 48 no 2 pp 207 304 2006 2 m buehler d e koditschek and p j kindlmann planning and control of robotic juggling and catching tasks the international journal of robotics research vol 13 no 2 pp 101 118 1994 3 l glass and j s pasternack stable oscillations in mathematical models of biological control systems journal of mathematical biology vol 6 no 3 pp 207 223 1978 4 i a hiskens and p b reddy switching induced stable limit cycles nonlinear dynamics vol 50 no 3 pp 575 585 2007 5 j lygeros k h johansson s n simic j zhang and s s sastry dynamical properties of hybrid automata ieee transactions on automatic control vol 48 no 1 pp 2 17 2003 6 s grillner neurobiological bases of rhythmic motor acts in vertebrates science vol 228 pp 143 149 1985 7 a cohen p j holmes and r h rand the nature of coupling between segmental oscillators of the lamprey spinal generator for locomotion a model journal of mathematical biology vol 13 pp 345 369 1982 8 m golubitsky i stewart p l buono and j j collins symmetry in locomotor central pattern generators and animal gaits nature vol 401 no 6754 pp 693 695 1999 9 l h ting and j m macpherson a limited set of muscle synergies for force control during a postural task journal of neurophysiology vol 93 no 1 pp 609 613 2005 10 c li t zhang and d i goldman a terradynamics of legged locomotion on granular media science vol 339 no 6126 pp 1408 1412 2013 11 r j full and d e koditschek templates and anchors neuromechanical hypotheses of legged locomotion on land journal of experimental biology vol 202 pp 3325 3332 1999 12 t mcgeer passive dynamic walking international journal of robotics research vol 9 no 2 p 62 1990 13 j w grizzle g abba and f plestan asymptotically stable walking for biped robots analysis via systems with impulse effects ieee transactions on automatic control vol 46 no 1 pp 51 64 2002 14 a seyfarth h geyer and h herr swing leg retraction a simple control model for stable running journal of experimental biology vol 206 no 15 pp 2547 2555 2003 15 s collins a ruina r tedrake and m wisse efficient bipedal robots based on passive dynamic walkers science vol 307 no 5712 pp 1082 1085 2005 16 r m ghigliazza r altendorfer p holmes and d e koditschek a simply stabilized running model siam journal on applied dynamical systems vol 2 no 2 pp 187 218 2003 17 j schmitt and p holmes mechanical models for insect locomotion dynamics and stability in the horizontal plane i theory biological cybernetics vol 83 no 6 pp 501 515 2000 18 r kukillaya j proctor and p holmes neuromechanical models for insect locomotion stability maneuverability and proprioceptive feedback chaos an interdisciplinary journal of nonlinear science vol 19 no 2 p 026107 2009 19 e klavins and d e koditschek phase regulation of decentralized cyclic robotic systems international journal of robotics research vol 21 no 3 p 257 2002 20 g haynes a rizzi and d e koditschek multistable phase regulation for robust steady and transitional legged gaits the international journal of robotics research vol 31 no 14 pp 1712 1738 2012 21 e r westervelt j w grizzle and d e koditschek hybrid zero dynamics of planar biped walkers ieee transactions on automatic control vol 48 no 1 pp 42 56 2003 22 s carver n cowan and j m guckenheimer lateral stability of the spring mass hopper suggests a two step control strategy for running chaos vol 19 p 026106 2009 23 a shiriaev l freidovich and s gusev transverse linearization for controlled mechanical systems with several passive degrees of freedom ieee transactions on automatic control vol 55 no 4 pp 893 906 2010 24 i poulakakis and j w grizzle the spring loaded inverted pendulum as the hybrid zero dynamics of an asymmetric hopper ieee transactions on automatic control vol 54 no 8 pp 1779 1793 2009 25 m m ankaral and u saranl control of underactuated planar pronking through an embedded spring mass hopper template autonomous robots vol 30 no 2 pp 217 231 2011 26 m hirsch differential topology springer 1976 27 j lee introduction to smooth manifolds springer verlag 2002 28 e wendel and a ames rank deficiency and superstability of hybrid systems nonlinear analysis hybrid systems vol 6 no 2 pp 787 805 2012 29 y or and a d ames stability and completion of zeno equilibria in lagrangian hybrid systems ieee transactions on automatic control vol 56 no 6 pp 1322 1336 2011 30 m hirsch and s smale differential equations dynamical systems and linear algebra academic press 1974 31 j m guckenheimer and p holmes nonlinear oscillations dynamical systems and bifurcations of vector fields springer 1983 23 32 m a aizerman and f r gantmacher determination of stability by linear approximation of a periodic solution of a system of differential equations with discontinuous right hand sides the quarterly journal of mechanics and applied mathematics vol 11 no 4 pp 385 398 1958 33 s a burden s revzen and s s sastry dimension reduction near periodic orbits of hybrid systems in proceedings of the 50 th ieee conference on decision and control 2011 pp 6116 6121 34 f callier and c desoer linear system theory springer 1991 35 s a burden h gonzalez r vasudevan r bajcsy and s s sastry metrization and simulation of controlled hybrid systems arxiv e print 1302 4402 2013 36 s n simic k h johansson j lygeros and s s sastry towards a geometric theory of hybrid systems dynamics of continuous discrete and impulsive systems vol 12 no 5 6 pp 649 687 2005 37 m schatzman uniqueness and continuous dependence on data for one dimensional impact problems mathematical and computer modelling vol 28 no 4 8 pp 1 18 1998 38 a de neuromechanical control of paddle juggling master s thesis the johns hopkins university 2010 39 d l jindrich and r j full dynamic stabilization of rapid hexapedal locomotion journal of experimental biology vol 205 no 18 pp 2803 2823 2002 40 r m murray z li and s s sastry a mathematical introduction to robotic manipulation crc press 1994 41 m h raibert legged robots communications of the acm vol 29 no 6 pp 499 514 1986 42 c d remy optimal exploitation of natural dynamics in legged locomotion ph d dissertation eth zurich 2011 43 j seipel and p holmes a simple model for clock actuated legged locomotion regular and chaotic dynamics vol 12 no 5 pp 502 520 2007 44 k sreenath h w park i poulakakis and j w grizzle embedding active force control within the compliant hybrid zero dynamics to achieve stable fast running on mabel the international journal of robotics research vol 32 no 3 pp 324 345 2013 45 j o reilly the discrete linear time invariant time optimal control problem an overview automatica vol 17 no 2 pp 363 370 1981 46 g floquet sur les e quations diffe rentielles line aires a coefficients pe riodiques annales scientifiques de le cole normale supe rieure se r vol 2 p 12 1883 47 j m guckenheimer isochrons and phaseless sets journal of mathematical biology vol 1 no 3 pp 259 273 1975 48 s revzen neuromechanical control architectures of arthopod locomotion ph d dissertation university of california at berkeley 2009 49 s revzen and j m guckenheimer finding the dimension of slow dynamics in a rhythmic system journal of the royal society interface vol 9 no 70 pp 957 971 2011 50 p hartman on local homeomorphisms of euclidean spaces bolet n de la sociedad matema ticas de mexicana vol 5 no 2 pp 220 241 1960 51 b aulbach and b m garay partial linearization for noninvertible mappings zeitschrift fu r angewandte mathematik und physik zamp vol 45 pp 505 542 1994 52 b abbaci on a theorem of philip hartman comptes rendus mathematique vol 339 no 11 pp 781 786 2004 53 j ortega numerical analysis a second course society for industrial mathematics 1990 vol 3 54 s s sastry nonlinear systems analysis stability and control springer 1999 i introduction ii preliminaries iii hybrid dynamical systems iii a hybrid differential geometry iii b hybrid periodic orbits and hybrid poincar maps iii c exact reduction iii d approximate reduction iii e smoothing iv applications iv a spontaneous reduction in a vertical hopper iv b reducing a 3 2 n dof polyped to a 3 dof lls iv b 1 dynamics of lateral leg spring lls and n leg polyped iv b 2 embedding lls in polyped iv b 3 reducing polyped to lls iv b 4 qualitative description of reduction iv b 5 effect of perturbations and parameter variations iv c deadbeat control of rhythmic hybrid systems iv c 1 exact reduction over one cycle iv c 2 exact reduction over multiple cycles iv c 3 approximate reduction iv c 4 structural stability of deadbeat control iv d hybrid floquet coordinates v discussion appendix a smooth dynamical systems a a continuous time dynamical systems a a 1 time to impact a a 2 smoothing flows a b discrete time dynamical systems a b 1 exact reduction a b 2 approximate reduction a b 3 superstability appendix b c 1 linearization references