on the cartesian product of well orderings isa vialard february 16 2022 abstract the width of a well partial ordering wpo is the ordinal rank of the set of its antichains ordered by inclusion we compute the width of wpos obtained as cartesian products of finitely many well orderings 1 introduction for a finite poset and more generally a finite quasi order qo there are intuitive notions of dimension that play a paramount role in combi natorics and algorithmics its cardinal but also its height the cardinal of its longest chain and its width the cardinal of its longest antichain i e sequence of incomparable elements with some provisions these dimensions can be extended to infinite posets if a qo is well founded or wf we can define its height as the rank of the tree of strictly decreasing sequences if a qo is fac it only has finite antichain we can define its width as the rank of the trees of antichains if a qo is both wf and fac then it is called a well quasi order wqo hig 52 it has a height a width and also a maximal order type djp 77 defined as the rank of the trees of bad sequences a sequence x 0 x 1 x 2 is good if there are some positions i j such that xi xj and bad otherwise wqos can alternatively be defined as qos that do not have infinite bad sequences there is a rich theory of wqos mil 85 ssw 20 where these dimen sions which we call ordinal invariants are used to measure complexity de jongh and parikh djp 77 and schmidt sch 79 initiated the universite paris saclay ens paris saclay cnrs lmf gif sur yvette france 1 ar x iv 2 20 2 07 48 7 v 1 cs l o 1 5 f eb 2 02 2 study of the maximal order type for use in proof theory kr z and thomas kt 90 later introduced the width for infinitary combina torics blass and gurevich bg 08 then contributed to the study of invariants for program verification the maximal order type was also applied in bfhr 13 for expressiveness results in the study of well structured transition systems wsts i e sys tems whose set of configurations is a wqo some upper bound results on complexity rely on the length of controlled bad sequences of con figurations hss 14 hss 12 i e on the maximal order type of the underlying wqo in sch 19 schmitz refined this technique with con trolled antichains whose length depends on the width instead a recent article by dzamonja et al dss 20 shows that we do not always know how to compute the width of wqos even in the apparently simple case of a cartesian product this problem is unfortunate since the cartesian product is the most common and basic data structure in mathematics and computer science however one subproblem the special case of the width of the cartesian product of two linear well founded orders i e two ordinals was solved by abraham abr 87 35 years ago this article develops a method to compute the width of the cartesian product of n ordinals for any n n as explained in section 2 4 the method of residuals used in abr 87 relies on specificities of the case n 2 which are lost in case n 3 and beyond our method consequently develops a more general game theoretical approach 1 1 outline of the article section 2 introduces definitions notations and recalls known results mostly following dss 20 section 3 proves intermediary results on lower bounds on the width that lay the ground for future proofs the following three sections gradually progress toward our main result in section 4 we compute the width of the product of indecom posable ordinals section 5 uses the previous result to compute the width of the product of infinite ordinals section 6 eventually extends this result by adding finite ordinals to the product in section 7 we leverage our main result to compute the width of the cartesian product of more general wqos for completeness section 8 recalls classic results for the cartesian product of finite ordinals 2 2 preliminaries we assume familiarity with basics of order theory see e g fra 86 2 1 the measure of wqos for any wqo a a we often write just a when the order is un derstood we write inco a resp dec a and bad a for the tree of non empty antichains resp strictly decreasing sequences bad se quences in a ordered by initial segment if s x 1 xn and t x 1 xn y s y then t is a child of s observe that since a is a wqo so fac and wf the trees inco a dec a and bad a do not have infinite branches they are well founded however they can be infinitely branching one can ascribe a rank to any node of a well founded tree t from bottom to top let x t a node if s is a leaf then r s 0 else r s sup r t 1 t is a son of s the rank of t is defined as the image of t through r i e r t sups t r s 1 since t can be infinitely branching its rank is a possibly infinite ordinal for a more general definition of the rank of any well founded partial order set see section 2 2 of dss 20 definition 2 1 the width w a the height h a and the maxi mal order type o a are respectively the rank of inco a dec a and bad a together they are called the ordinal invariants of a example 2 2 for any ordinal 0 with order o h and w 1 remark 2 3 the trees inco a dec a and bad a are more pre cisely forests since they have multiple roots all one element sequences since an antichain is a bad sequence inco a is a subtree of bad a hence lemma 2 4 for all wqo a w a o a remark 2 5 the maximal order type o a was historically defined as the maximal linearisation of a djp 77 i e a linear order an ordinal a such that a the height h a can similarly be defined as the longest chain of a nonetheless definition 2 1 allow us to include the width as a third natural invariant 3 when computing ordinal invariants we frequently want to compare a wqo to one of its substructures or augmentations let a a b b be two wqos a is an augmentation of b if the sets a b are equal and b a we denote it by a aug b a is a substructure of b if the set a is a subset of b and a b a we denote it by a st b we use the notation a b when a is isomorphic to b i e when there is a bijection between a and b that preserves the order we often abuse terminology and say that a is a substructure resp an augmentation when a is isomorphic to a substructure resp an augmentation example 2 6 for any ordinals st example 2 7 for any n n n aug n where n is the antichain with n elements we define the disjoint sum t lexicographic sum cartesian prod uct and direct product as in dss 20 example 2 8 for any wqos a b atb aug a b and a b aug a b observe that for two wqosa andb ifa st b then inco a dec a and bad a are respectively subtrees of inco b dec b and bad b similarly if a aug b then all antichains or bad sequences of a are an tichains or bad sequences of b however strictly decreasing sequences of b are strictly decreasing in a whenever a and b are partial orders therefore lemma 2 9 for all wqos a b if a st b then a b for w o h if a aug b then a b for w o if furthermore a b are wpos h a h b 2 2 residual characterization for a quasi order a x a and a relation symbol 6 6 we define the residual of a at x as a x y a y x 4 we can generalize this notion to subsets y a a y x y a x if y a y a a residual can be seen as a substructure of a thus it is a wqo with its own ordinal invariants smaller than or equal to the ordinal invariants of a see lemma 2 9 for instance n 2 0 1 and n 2 in figure 1 you can see the residuals of n 2 at x 4 6 in colors n 2 x in blue n 2 x in green and n 2 x in red the union of the red and blue parts is n 2 6 x the union of the red and green parts is n 26 x 4 6 figure 1 n 2 residuals by colors residuals are essential in the computation of invariants given w a sup x a w a x 1 1 h a sup x a h a x 1 2 o a sup x a o a 6 x 1 3 these formulas can be seen as a reformulation of tree rank compu tation see section 2 3 of dss 20 and the references therein we can use them to recursively compute the invariants of a this is called the method of residuals 5 example 2 10 for all x n 2 n 2 x is finite and contains arbitrarily many elements see figure 1 therefore h n 2 remark 2 11 in djp 77 where o x is defined as the maximal lin earisation of x equation 3 is an essential theorem since it allows to prove that this definition of the maximal order type is equivalent to its characterization as the rank of bad x 2 3 state of the art the state of the art on ordinal invariants can be found in dss 20 here are some useful results lemma 2 12 lemma 4 1 from dss 20 let pi i be an indexed family of wqos then i pi the lexicographic sum along the ordinal see definition in dss 20 is a wqo and w i pi supi w pi lemma 2 13 lemma 4 2 from dss 20 let a b be wqos then atb is a wqo and w atb w a w b where is the natural addition on ordinals from lemma 2 13 we can deduce the following result lemma 2 14 let a be a wqo and n n then w a n w a n where is the natural multiplication on ordinals proof observe that a n at ta the disjoint sum of n copies of a therefore w a n w a w a w a n the maximal order type and the height of a cartesian product a b are functional in the maximal order type of a and b and their height respectively lemma 2 15 theorem 3 5 of djp 77 let a b be wqos then a b is a wqo and o a b o a o b lemma 2 16 lemma 4 6 of dss 20 see abr 87 for the proof let a b be wqos then h a b sup 1 h a h b however the width of a b is not functional in any of the invariants of a and b 6 a 1 a 2 h h h figure 2 two wqos a 1 and a 2 with the same invariants such that w a 1 6 w a 2 example 2 17 let h n n observe that w h o h h h let a 1 h h and a 2 h see figure 2 with the method of residuals one can see that a 1 and a 2 have the same invariants w a 1 w a 2 and o a 1 o a 2 h a 1 h a 2 2 however w a 1 2 2 6 w a 2 2 2 4 cartesian product of two ordinals abraham abr 87 used the method of residuals to compute the width of the cartesian product of two ordinals let us recall the main steps of his proof let be two ordinals according to the method of residuals w sup x 1 x 2 w x 1 x 2 1 4 fix x 1 x 2 then for any y 1 y 2 x 1 x 2 y 1 y 2 iff x 1 y 1 and x 2 y 2 or x 1 y 1 and x 2 y 2 thus the residual x 1 x 2 is a disjoint union see figure 3 x 1 x 2 x 1 x 2 t x 1 x 2 observe that x 1 is isomorphic to x 1 and x 1 to x 1 1 the same reasoning applies to x 2 and x 2 using lemma 2 13 we 7 x 1 x 2 x 1 x 1 x 2 x 2 figure 3 residual of at x 1 x 2 as a disjoint union can rewrite equation 4 as w sup x 1 x 2 w x 1 x 2 w x 1 x 2 1 this is how w is computed in abr 87 here are the main results the successor and limit cases are dealt with separately lemma 2 18 lemma 3 2 of abr 87 if is infinite then w 1 w 1 if is finite then the equality holds iff 1 any ordinal can be written in cantor normal form as a where the symbol is used to point out a that could be replaced by a similarly can be written in cantor normal form without multiplicities i 0 l i with 0 l we will use the latter in section 5 theorem 2 19 theorem 3 4 of abr 87 for any ordinals a and b w w w with a simple change of variables this becomes w w w if are limit ordinals with 1 1 1 now let us try to use the method of residuals for the product of n 2 ordinals 1 n let x 1 n and x y x then 8 x x 1 xn y y 1 yn iff there exist i j 1 n such that xi yi and xj yj with some work we can express the residual x x as the union of subsets of the form i i 1 xi i i 2 xi i 6 i 1 i 2 xi with i 1 i 2 1 n disjoint and non empty however unlike the case n 2 this union of subsets is not a disjoint union of wqos take for instance n 3 and the subsets x 1 x 2 x 3 and x 1 x 2 x 3 see fig 4 they can have comparable elements we could say that the residual is an augmentation of a disjoint union but this method can only give us an upper bound on w x 1 2 3 x 1 x 2 x 3 x 1 x 2 x 3 x 1 x 2 x 3 figure 4 two parts of the residual of 1 2 3 at x 1 x 2 x 3 that have comparable elements we need a method that will allow us to look further than the first element of the antichain for this we extend the method of residuals with a game theoretical point of view 2 5 games definition 2 20 gx is a game for two players let s call them antoine for antichain and odile for ordinal with the following rules each configuration of the game is a pair y with y an antichain of x and the game begins in either odile or antoine begins at odile s turn she moves from configuration y to y with 9 at antoine s turn he moves from configuration y to y x with x x y the first player who cannot play loses this game is a specific case of the games defined in bg 08 and dss 20 since x is fac and is wf the players cannot play forever so the game terminates lemma 2 21 bg 08 dss 20 w x iff odile has a winning strategy when antoine begins w x iff antoine has a winning strategy when odile begins intuitively one can see this game as playing along a branch of inco a each time antoine plays y y x he moves from node y to its child y x odile has a winning strategy when she can play r y antoine has a winning strategy when he can play y such that r y to prove w x we only need to exhibit two winning strategies one for each player depending on who begins 3 how to prove lower bounds 3 1 combining strategies here we introduce a method to combine several winning strategies for antoine in order to prove lower bounds on the width of complex wqos we denote a b with a and b two subsets of a wqo when for any a a b b a b in this wqo we say a 1 am is an incomparable family of subsets of a when ai aj for any i 6 j observe that for an incomparable family we have a st iai thus w a iw ai however we can do almost as well with a weaker condition on the ais we say a 1 am is a quasi incomparable family of subsets of a if for any i 1 m for every finite set y a 1 ai 1 there exists a i ai isomorphic to ai such that a i y note that this notion is sensitive to the way we number the ais lemma 3 1 how to combine winning strategies for antoine let a 1 am be a quasi incomparable family of subsets of a then w a w am w a 1 10 proof let us note i for w ai for any i 1 m antoine has a winning strategy si on gai i when odile begins we want to combine those si into a winning strategy for antoine on ga m 1 when odile begins intuitively the game is played in m phases odile goes through the sum m 1 from right to left which means that at the j th phase she is decreasing the term j while antoine plays his strategies sj on a j the subset of aj incomparable to the antichain built by antoine during phases 1 to j 1 as the subsets a i are only isomorphic to the ais on which the strategies are defined we have to remember to shift the sis more formally assume that odile has selected some ordinal and antoine has selected an antichain y a 1 ak now can be written in a unique way as m k 1 with k for some k 1 m the game is in phase k our invariant during phase k y a 1 ak by definition of a quasi incomparable family there exists a k ak isomorphic to ak such that a k y ak the antichain y ak comes from the strategy sk played on a k now it is odile s turn and she selects some we know is either above or strictly below m k 1 if m j 1 then we move to the jth phase of the game by definition of a quasi incomparable family there exists a j aj isomorphic to aj such that a j y we follow the strategy sj on a j which selects some x a j since a j y y y x is still an antichain if m k 1 for some then we can keep applying the strategy sk on a k which selects some x y a k since a k y ak y y x is still an antichain 3 2 lower bound for self residual wqos definition 3 2 self residual let a be a wqo a is self residual if for any x a a 6 x contains an isomorphic copy of a let us illustrate this notion with an example an ordinal is said to be indecomposable or additive principal if for any all indecomposable ordinals are of the form 11 then for all infinite indecomposable ordinal for any x 6 x x 1 because x 1 and by definition of indecomposable therefore is self residual the notion of self residual is compatible with cartesian product if a and b are self residual wqos then a b is self residual in particular a cartesian product of n infinite indecomposable ordinal is self residual if a is self residual then for all finite y a a 6 y contains an isomorphic copy of a by induction on the size of y here is an application of lemma 3 1 that will be useful in section 4 lemma 3 3 let a b be two wqos such that a is self residual and k n then w a b k w a b k proof let b 1 bk be disjoint copies of b then b k is isomorphic to the lexicographic sum bk b 1 we claim that a bi i 1 n is a quasi incomparable family of subsets of a b k fix j 1 k and y a b 1 a bj 1 finite figure 5 illustrates the case j 3 let y a def a a a b y b b k we want to find a subset of c a bj isomorphic to a bj such that c y since a is self residual a 6 y a contains an isomorphic copy of a hence a 6 y a bj a bj since for any a b a 6 y a bj a b y a a a and b b k b so a b a b a a 6 y a a b 1 b 2 b 3 bk y a b figure 5 all elements a b of a 6 y a bk b 3 are incomparable to y a b 2 b 1 12 therefore a bi i 1 n is a quasi incomparable family so according to lemma 5 2 w a 1 i k bi 1 i k w a bi w a b k when w a b is a finite multiple of an indecomposable we have the other side of the equality a b k aug a b k so w a b k w a b k w a b k therefore w a b k w a b k 3 3 lower bound for transferable wqos a wqo a is transferable if w a 6 y w a for any finite y a observe that it is a weaker condition than self residuality lemma 3 4 a self residual wqo is transferable proof let a be a self residual wqo i e for any x a a 6 x contains an isomorphic copy of a thus by induction on the size of y a 6 y contains an isomorphic copy of a therefore w a 6 y w a so a is transferable transferability is used in dss 20 to prove a lower bound lemma 3 5 theorem 4 16 of dss 20 suppose that a is a transfer able wqo and is an ordinal then w a w a from this lemma we can deduce a more general version of itself which we will use in section 4 lemma 3 6 suppose that a is a transferable wqo and b any wqo then w a b w a o b proof observe that b aug o b therefore w a b w a o b w a o b combined with the method of residuals lemma 3 6 allows us to compute the width of simple examples we note a n def a a the cartesian product of n copies of a wqo a proposition 3 7 w n n 1 for n 1 13 proof case n 1 w 1 if n 1 w n w o n 1 n 1 according to lemma 3 6 let us prove the upper bound by induction on n initialized in n 1 assume w n n 1 for some n let m m 0 mn be any element of n 1 m m 1 mn and k the cardinal of n m then n 1 m aug m 0 n m t m 0 n m t m 0 n m aug m 0 n t k t n m therefore by induction hypothesis w n 1 m n 1 m 0 k with n 1 thus by the method of residuals w n 1 sup m w n 1 m 1 n proposition 3 8 w n n for n 2 proof the case n 2 is an application of theorem 2 19 if n 2 w n o n n according to lemma 2 4 w n w o n 2 2 n 2 n according to lemmas 2 15 and 3 6 4 product of indecomposable ordinals we want to compute w 1 n for 1 n 0 we recall this result from abr 87 for n 2 lemma 4 1 let 1 2 0 then w 1 2 with 1 1 1 2 1 observe that for any ordinal 0 1 iff is infinite thus can be simplified depending on the finiteness or infiniteness of 1 and 2 if 1 2 are finite then 1 2 1 14 if 1 is infinite and 2 finite then 1 2 1 if 1 2 are infinite then 1 2 we can simplify the statement of lemma 4 1 if we order 1 2 without loss of generality which gives us w 1 2 1 2 1 theorem 4 2 let x 1 n with n 2 and 1 n 0 then w x with 1 2 n 1 i e if 1 n are finite then 1 n 1 if 1 is infinite and 2 n are finite then 1 2 n 1 if 1 k are infinite with k 2 then 1 n proof case n 2 is treated in abr 87 assume that n 2 let k 0 n be such that 1 k are infinite and k 1 n are finite inside both the proofs of the lower bound and upper bound the cases k 0 k 1 2 k n and k n will be treated separately when necessary we prove the lower bound with lemma 3 6 for any ordinal 0 is principal additive so self residual therefore 1 j is self residual for all j n hence transferable if k 0 w x w 1 2 o 3 n 1 2 1 3 n 1 n 1 if k 1 w x w 1 2 o 3 n 1 2 1 3 n 1 2 n 1 if 2 k n then w x w 1 k o k 1 n 1 k k 1 n 1 n by induction on n if k n then we cannot use lemma 3 6 it would give a instead of a so we proceed by induction on 1 n with the cartesian product ordering we already know that w n n for any n 2 from proposition 3 8 let i such that i has the smallest last exponent i e i i and 1 n 1 i n the ordinal can either be null a successor or a limit ordinal 15 if 0 then x st 1 i k n for any k and i is infinite since 1 i 1 i n is self residual then according to lemma 3 3 w x w 1 i n k 1 i n k by induction hypothesis so w x 1 n otherwise if 1 is a successor then x st 1 i k n now i k is either infinite or finite case where i 0 and 1 in the first case we call on our induction hypothesis in the second case we are in the situation where more than two exponents are infinite but not all of them which we already treated in both cases we get w x 1 i k n 1 i n k so w x 1 n if supi i is a limit then we reason as in the successor case with i i instead of i k now for the upper bound in the case k 2 we already know from lemma 2 4 that w x o x 1 n when k 1 we prove the upper bound by induction on 1 n using the methods of residuals we already know from proposition 3 7 that w n n 1 let x x for all i 1 n there exists 0 i i and mi n such that xi i mi i the residual x x is included in an augmentation of a disjoint sum of terms of the form i i xi i 6 i xi with i 1 n i 6 hence w x x i w i i xi i 6 i xi i w i i i mi i 6 i i i w i i i i 6 i i i i mi i w i i i i 6 i i m 16 by induction hypothesis w i i i i 6 i i for some 1 2 n 1 therefore w x 1 2 n 1 theorem 4 2 can be extended to all ordinals i 0 theorem 4 3 let x 1 n with n 1 and 1 n 0 be n ordinals if 2 n 0 then w x 1 otherwise w x 1 2 n 1 proof let k n such that 1 k 0 k 1 n if k 0 or 1 then x 1 so w x 1 otherwise k 2 and x 1 k so according to theorem 4 2 w x 1 2 k 1 1 2 n 1 an immediate corollary of theorem 4 2 which will be useful later is corollary 4 4 monotonicity let 1 i n 0 be n ordinals and let i i for some i n then w 1 n w 1 i n proof the function 1 n 7 1 2 n 1 is strictly increasing because the natural sum is strictly increasing and the left subtraction the only kind of subtraction defined for ordinals is also strictly increasing in its left argument 5 product of infinite ordinals in this section we extend the width of the product of indecomposable ordinals theorem 4 3 to the width of the product of infinite ordinals theorem 5 1 let x 1 n be a cartesian product of n infinite ordinals each i is written in cantor normal form without multiplicities as i j li i j with i 0 i li 1 for i 1 n 17 we partition x into slices for any s s 1 s n sl x def l 1 ln we define the slice xs as xs def i 1 n xs i with xs i def j s i i j j s i i j by abuse of language we also call s a slice observe that as a substructure of x xs is isomorphic to i 1 n i si therefore we know how to compute w xs thanks to theorem 4 3 we say s sl x is grounded if there exists k 1 n such that s k 0 let gr x def s sl x k 1 n s k 0 the set of grounded slices 3 3 2 1 xs xt 3 2 figure 6 slices and grounded slices x 3 3 2 1 xs and xt for s 1 0 2 t 1 2 0 are both grounded we compute w x by slices theorem 5 1 w x s gr x w xs first we prove the upper bound w x s gr x w xs 18 proof of the upper bound of theorem 5 1 for any two s t sl x we write s t iff for all i 1 n s i t i observe that for any s t for any x xs x xt we have x x x for any i 1 n i s i i t i so xs st xt therefore w xs w xt we define a surjective function g sl x gr x which associates with any slice a grounded slice g s i def s i k with k min i 1 n s i this surjection has interesting properties if s is grounded then g s s otherwise g s s thus w xs w xg s for any s 6 t sl x such that g s g t s t or s t therefore for any s gr x the union of all the xs such that g s s is a lexicographic sum in x thus x can be expressed as an augmentation of the disjoint sum of lexicographic sums of xs gathered by the image of s through g x aug s gr x s g 1 s xs which implies according to lemmas 2 13 and 2 12 w x s gr x max s g 1 s w xs s gr x w xs we need to introduce a few notations before proving the lower bound of theorem 5 1 let y be a finite set of elements of x we define a function shift which outputs a subset of x shift xs y def i 1 n shift xs i y with shift xs i y def y i i 0 if s i 0 xs i otherwise 19 where we define y i as the max of the i th components of elements of y which are less than i 0 y i def max y i y y y i i 0 if y i y y y i i 0 then let y i 1 3 3 2 1 y shift xs y y 3 figure 7 shift xs y for s 1 1 0 is incomparable to y lemma 5 2 shift xs is isomorphic to xs proof for any i 1 n shift xs i is isomorphic to xs i if s i 0 then shift xs i xs i otherwise s i 0 and shift xs i y i i 0 i 0 y i since i is infinite i 0 is infinite inde composable therefore i 0 y i i 0 xs i proof of the lower bound of theorem 5 1 proof idea the notion of quasi incomparable family is dependent on the order of the subsets thus we will order the grounded slices in such a way that xs s gr x is a quasi incomparable family of subsets of x and that lemma 3 1 returns the expected result we first define the order according to theorem 4 3 w xs can be written under the form w xs s therefore we can order all the grounded slices as s 1 sl where l li li 1 in such a way that for any i j si sj then s gr x w xs w xsl w xsl 1 w xs 1 20 since there are some slices s 6 t such that s t we can refine our ordering of the slices for any i j either si sj or si sj and k 1 n si k k 1 n sj k from now on we write i for si and xi for xsi now we will show that xs 1 xsl form a quasi incomparable fam ily of subsets of x fix k 1 l and y xs 1 xsk 1 a finite set then we define x sk xsk as shift xsk y according to lemma 5 2 x sk is indeed isomorphic to xsk now we will show x sk y for any elements y y it is suffi cient to find i 1 i 2 1 n such that the i 1 th component of y is below shift xsk i 1 and the i 2 th component of y is above shift xsk i 2 for any j k sj is grounded hence there exists i 1 1 n such that sj i 1 0 if sk i 1 0 then all elements xsj i 1 are below xsk i 1 otherwise if sk i 1 0 then shift xsk i 1 y i 1 i 1 0 and the i 1 th component of all elements of y xsj is below y i 1 we claim that there exists i 2 such that sj i 2 sk i 2 which means that all elements of xsj i 2 are above xsk i 2 since j k we know j k if j k then i 1 n sj i i 1 n sk i so there exists i 2 such that sj i 2 sk i 2 otherwise j k assume for the sake of contradiction that for all i 1 n sj i sk i then i sj i i sk i thus theorem 4 4 leads us to a contradiction j k it follows that x sk y xj for any j k we know y xs 1 xsk 1 so x sk y therefore xsj j 1 l is a quasi incomparable family hence according to lemma 3 1 w x w xsl w xs 1 s gr x w xs 21 5 1 alternative expressions for w x our formula to compute w x is expressed for ordinals written in nor mal form without multiplicities however there are two other ways to write ordinals in normal form which are more commonly used i j li i j this is the one we used until now j l i i j ai j in developed normal form i ai i in short normal form when we go from the normal form without multiplicities to the developed normal form it allows us to regroup several slices s sl x into one slice t sl x def l 1 l n we denote gr x as the grounded slices of sl x we define f as the function from sl x to sl x such that f s t if i s i i t i for any i 1 n let xt def i 1 n i t i then f s t xs xt therefore for every t there exists at n such that s gr x f s t w xs w xt at note this can be replaced by the usual product we want to compute at s gr x f s t first observe that s sl x f s t i 1 n ai t i if f s t and s gr x then t gr x this implies that s is amongst the slices that are null in at least one of the i where t is null hence at t i 0 ai 0 t i 0 ai 0 1 ti 0 ai t i and w x t gr x w xt at to go from developed normal form to short normal form we can regroup together all slices t in meta slices mi sl x indexed by 22 i 1 n such that t mi if for all i 1 n i i t i 0 note that m contains no grounded slices let xi i i i i i 6 i observe that contrary to xs and xt xi is not a product of indecomposable ordinals our goal is to express w x as a natural sum of w xi w x i 6 t mi gr x w xt at i 6 t mi gr x w xt ti 0 ai t i i i ai 0 i i ai 0 1 i 6 w xi li with li i i ai i i ai 1 therefore we know three ways to express the width of a cartesian product of n infinite ordinals depending on the normal form in which they are written theorem 5 3 cartesian product of infinite ordinals w x s gr x w xs t gr x w xt t i 0 ai 0 t i 0 ai 0 1 ti 0 ai t i i 1 n i 6 w xi i i ai i i ai 1 6 combining finite and infinite ordinals theorem 6 1 for x a cartesian product of infinite ordinals and k 1 km n w x k 1 km w x k 1 km 23 proof x k 1 km aug x k 1 km so by lemma 2 14 we get the bound w x k 1 km w x k 1 km to prove the other direction first observe that x k 1 km aug x k 1 km therefore we only need to prove that w x k w x k for any k n we will adapt the proof of the lower bound of theorem 5 1 keeping in mind the notations shift sl x gr x let z def x k for all s sl x for all r k we define the slice zrs def xs r let s 1 sl be the grounded slices of x ordered as in the proof of the lower bound of theorem 5 1 as before xsi i 1 l is a quasi incomparable family of subsets of x and w xsl w xs 1 s gr x w xs for any j q k r k l with q l r k let zj def zk 1 rsq 1 it boils down to ordering all the slices zrs for s gr x and r k such that z 0 z k l 1 z k 1 s 1 zk 2 s 1 z 0 s 1 zk 1 s 2 z 0 sl x xsq 1 and x sq 1 zj and z j 0 k 1 k 1 r figure 8 xsq 1 in green x sq 1 in dashed green zj in blue z j in dashed blue for j k q r let us prove that zj j l k is a quasi incomparable family of subsets of z fix some j k q r let y z 0 zj 1 a finite set 24 let y x x x x r y we define z j def x sq 1 k 1 r where x sq 1 shift xsq 1 y x again it is sufficient to prove that for all h j z j y zh let h k q r with r k either q q or q q and r r if q q follow the same reasoning as in the proof of the lower bound of theorem 5 1 to show that x sq 1 y x xsq 1 if q q and r r then k 1 r k 1 r so all elements of zh are above all the elements of zj in the last component since sq 1 is grounded there exists i such that sq 1 i 0 and the ith component of every elements of y zh is below y i so below the i th component of elements of z j thus z j y zh for any h j so z j y therefore zj j l k forms a quasi incomparable family of subsets of z so according to lemma 3 1 w z w z l k 1 w z 0 observe that for any j k q r zj xq 1 and w zj w xq 1 is indecomposable so w zk q w z k q 1 w z k q k 1 w xq 1 k therefore w z w xsl k w xs 1 k w x k 7 applications 7 1 when width coincides with maximal order type in view of w n o n proposion 3 8 one wonders if more generally w x catches up with o x for instance when the is are large enough it turns out that we can exactly characterize the cartesian products x such that w x and o x coincide theorem 7 1 let z 1 n k 1 km with n 0 1 n and 0 k 1 km now w z o z iff there exist i 1 n such that i is infinite indecomposable and j 1 6 j 2 1 n such that the cantor normal forms of j 1 and j 2 only have infinite exponents i e j 1 and j 2 are exactly divisible by 25 note that i can be equal to j 1 or j 2 for instance in case n 2 proof according to theorem 6 1 w z w x k 1 km where x 1 n as before and o z o x k 1 km according to lemma 2 15 therefore w z o z iff w x o x assume w x o x we express o x in a form that allow us to compare it easily to w x o x i 1 n i according to lemma 2 15 s sl x i 1 n i s i by distributivity s sl x o xs and w x s gr x w xs according to theorem 5 1 according to lemma 2 4 for every slice s sl x 0 w xs o xs moreover gr x sl x therefore w x o x if and only if gr x sl x and w xs o xs for any s sl x gr x sl x implies that there are no ungrounded slices i e there exists i 1 n such that li 1 thus there exists i such that i is indecomposable according to theorem 4 2 w xs o xs is true iff there exist j 1 6 j 2 such that j 1 s j 1 and j 2 s j 2 are both infinite in partic ular for the top slice s j 7 lj 1 there exist j 1 6 j 2 such that j 1 lj 1 1 and j 2 lj 2 1 are both infinite and therefore all exponents of j 1 and j 2 are infinite the above proof makes it clear that the necessary conditions are sufficient 7 2 measuring elementary wqos let the family of elementary wqos be the smallest family of wqos that contains and is closed by disjoint sum cartesian product and building 26 finite sequences as defined in ss 11 the maximal order type and height of any elementary wqo are already well known see lemmas 2 15 and 2 16 for the cartesian product dss 20 for the disjoint sum sch 79 for finite sequences here we will show how to compute their width remark 7 2 this family contains which is isomorphic to the sin gleton 1 and which is isomorphic to since it is closed by disjoint sum it contains also k modulo isomorphism for all k n we can easily compute the width of a disjoint sum of wqos a b w atb w a w b according to lemma 2 13 moreover observe that the cartesian product distributes over the disjoint sum a b t c a b t a c therefore we can restrict our study of the width to elementary wqos of the form a 1 a n with a 1 an elementary wqos let a be a wqo then the poset a also written a of finite sequences on a ordered by embedding is a wqo when a is hig 52 recall from sch 79 and dss 20 lemma 7 3 o a w a o a 1 if o a is finite o a 1 if o a n with and n finite o a otherwise we write that in the simpler form o a o a remark 7 4 if a 6 then a is transferable proof for any u a for any a a a 6 u contains uav v a which is isomorphic to a therefore a is self residual hence trans ferable remark 7 5 by lemma 7 3 if o a 1 then o a verifies the two conditions described in theorem 7 1 o a is infinite indecomposable and its normal form only have infinite exponents this property of a will prove useful thanks to the following the orem which generalises theorem 7 1 to the cartesian products of n wqos 27 theorem 7 6 let a 1 an be a family of wqos if there exist i j 1 6 j 2 1 n such that o ai is infinite indecomposable and o aj 1 and o aj 2 only have infinite exponents then w a 1 an o a 1 o an proof according to lemma 2 4 w a 1 an o a 1 o an since ai aug o ai for any i a 1 an aug o a 1 o an thus w a 1 an w o a 1 o an o o a 1 o an according to theorem 7 1 o a 1 o an let x a 1 a n with n 2 and ai 6 elementary for all i n let s compute w x if there exist i 6 j 1 n such that o ai 1 and o aj 1 then the conditions of theorem 7 6 are fulfilled and w x o x otherwise if there exists i 1 n such that o ai 1 and for all j 6 i o aj 1 i e aj 1 and a j then x a i n 1 and w x o x lemma 2 4 gives us the upper bound and since a i is transferable w x n w x o n according to lemma 3 6 o x n according to lemma 7 3 o x o n o x n which we know how to compute with lemma 2 15 otherwise ai 1 for all i 1 n hence x n according to proposition 3 7 w n n 1 for all n 1 therefore we can measure any elementary wqos for all ordinal in variants 28 8 product of finite ordinals in the case of the cartesian product of finite ordinals we have a finite poset thus its width coincide with the length of its largest antichain for the sake of completeness we recall a classic result that characterize its width let k 1 kn 0 be n finite ordinals and p 1 pn distinct prime numbers observe that x def k 1 kn is isomorphic to the poset of the divisors of pk 1 11 pkn 1 n ordered by divisibility therefore according to theorem 1 of dbvetk 51 theorem 8 1 one maximal antichain of x is a m 1 mn x mi 1 2 ki 1 therefore w x a for instance w 2 n m 1 mn 0 1 n mi n 2 n n 2 the nth central binomial coefficient similarly w 3 n is equal to the central trinomial coefficient defined as the largest coefficient of the polynomial 1 x x 2 n we can compute it efficiently w 3 n 0 i bn 2 c n i n i i this leads to a slightly different characterization of w x which can be deduced from theorem 8 1 corollary 8 2 for x k 1 kn a cartesian product of finite ordinals w x is equal to the central coefficient of the polynomial pk 1 pkn where pki x 1 x xki 1 proof the central coefficient of pk 1 pkn is the coefficient of xb ki 1 2 c 29 9 conclusion following kt 90 and dss 20 we consider the width of wqos our work addresses the issue of computing the width of the cartesian prod uct of known wqos more specifically of n ordinals extending abr 87 which solved the case n 2 together theorems 4 3 5 1 6 1 and 8 1 cover all the cases needed to compute the width of the cartesian product of finitely many ordinals these theorems rely on the well known method of residuals to prove upper bounds a game theoretical approach to prove lower bounds and new techniques to transfer strategies from simple wqos to more complex ones beyond the cartesian product of linear orders our result can be used to compute the width of a generic family of elementary wqos the techniques developed here can help target other open questions on wqo width for example how to compute the width of the powerset or the set of multisets over known wqos aknowledgements the research described in this article started with my master intern ship supervized by ph schnoebelen it has also benefited from nu merous discussions and suggestions from m dzamonja s halfon and s schmitz references abr 87 u abraham a note on dilworth s theorem in the infinite case order 4 2 107 125 1987 bfhr 13 r bonnet a finkel s haddad and f rosa velardo ordinal theory for expressiveness of well structured tran sition systems information and computation 224 1 22 2013 bg 08 a blass and y gurevich program termination and well partial orderings acm trans computational logic 9 3 1 26 2008 30 dbvetk 51 n g de bruijn c van ebbenhorst tengbergen and d kruyswijk on the set of divisors of a number nieuw archief voor wiskunde serie 2 23 191 193 1951 djp 77 d h j de jongh and r parikh well partial orderings and hierarchies indag math 39 3 195 207 1977 dss 20 mirna dz amonja sylvain schmitz and philippe schnoe belen on ordinal invariants in well quasi orders and finite antichain orders in p schuster m seisenberger and a weiermann editors well quasi orders in com putation logic language and reasoning volume 53 of trends in logic chapter 2 pages 29 54 springer 2020 fra 86 r fra sse theory of relations volume 118 of studies in logic and the foundations of mathematics elsevier science 1986 hig 52 g higman ordering by divisibility in abstract algebras proc london math soc 3 2 7 326 336 1952 hss 12 s haddad s schmitz and ph schnoebelen the ordinal recursive complexity of timed arc petri nets data nets and other enriched nets in proc 27 th ieee symp logic in computer science lics 2012 dubrovnik croatia june 2012 pages 355 364 ieee comp soc press 2012 hss 14 ch haase s schmitz and ph schnoebelen the power of priority channel systems logical methods in comp science 10 4 4 2014 kt 90 i kr z and r thomas ordinal types in ramsey the ory and well partial ordering theory in j nes etr il and v ro dl editors mathematics of ramsey theory vol ume 5 of algorithms and combinatorics pages 57 95 springer 1990 mil 85 e c milner basic wqo and bqo theory in i ri val editor graphs and order volume 147 of nato asi series c pages 487 502 d reidel publishing 1985 31 sch 79 d schmidt well partial orderings and their maximal order types habilitationsschrift heidelberg 1979 sch 19 sylvain schmitz the parametric complexity of lossy counter machines in proc 46 th int coll automata languages and programming icalp 2019 patras greece july 2019 volume 132 of leibniz international proceedings in informatics pages 129 1 129 15 leibniz zentrum fu r informatik 2019 ss 11 s schmitz and ph schnoebelen multiply recursive up per bounds with higman s lemma in proc 38 th int coll automata languages and programming icalp 2011 zu rich switzerland july 2011 volume 6756 of lecture notes in computer science pages 441 452 springer 2011 ssw 20 p schuster m seisenberger and a weiermann editors well quasi orders in computation logic language and reasoning volume 53 of trends in logic springer 2020 32 1 introduction 1 1 outline of the article 2 preliminaries 2 1 the measure of wqos 2 2 residual characterization 2 3 state of the art 2 4 cartesian product of two ordinals 2 5 games 3 how to prove lower bounds 3 1 combining strategies 3 2 lower bound for self residual wqos 3 3 lower bound for transferable wqos 4 product of indecomposable ordinals 5 product of infinite ordinals 5 1 alternative expressions for w x 6 combining finite and infinite ordinals 7 applications 7 1 when width coincides with maximal order type 7 2 measuring elementary wqos 8 product of finite ordinals 9 conclusion