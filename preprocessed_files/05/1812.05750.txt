ordered and convex geometric trees with linear extremal function zolta n fu redi alexandr kostochka dhruv mubayi jacques verstrae te december 12 2018 abstract the extremal functions ex n f and ex n f for ordered and convex geometric acyclic graphs f have been extensively investigated by a number of researchers basic questions are to determine when ex n f and ex n f are linear in n the latter posed by bra ka rolyi valtr in 2003 in this paper we answer both these questions for every tree f we give a forbidden subgraph characterization for a family t of ordered trees with k edges and show that ex n t k 1 n k 2 for all n k 1 when t t and ex n t n log n for t 6 t we also describe the family t of the convex geometric trees with linear tura n number and show that for every convex geometric tree f t ex n f n log log n dedicated to the memory of b gru nbaum 1 introduction an ordered graph refers to a graph whose vertex set is linearly ordered and a convex geometric or cg graph refers to a graph whose vertex set is cyclically ordered throughout this paper an n vertex ordered or cg graph will be assumed to have vertex set n 1 2 n with the natural ordering in the cg setting we use v w x to denote that w lies between v and x in the clockwise orientation for n a positive integer and f an ordered respectively cg graph let the extremal function ex n f respectively ex n f denote the maximum number of edges in an n vertex ordered respectively cg graph that does not contain f both ex n f and ex n f have been extensively studied in the literature in particular in the case where f is a forest to describe the known results we require some terminology given subsets a b of a linearly ordered set write a b to denote that a b for every a a and b b the interval chromatic number i f of an ordered graph f is the minimum k such that the vertex set of f can be partitioned into sets a 1 a 2 ak such that no edge has both endpoints in any ai we call these sets intervals or segments it is straightforward to see that if i f 2 then ex n f n 2 since an ordered complete balanced bipartite graph with interval chromatic number two does not contain f research supported by grant kh 130371 from the national research development and innovation office nkfih and by the simons foundation collaboration grant 317487 research supported in part by nsf grant dms 1600592 and by grants 18 01 00353 a and 16 01 00499 of the russian foundation for basic research research partially supported by nsf awards dms 1300138 and dms 1763317 research supported by nsf award dms 1556524 1 ar x iv 1 81 2 05 75 0 v 2 m at h c o 1 f eb 2 01 9 z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 2 1 1 ordered graphs standard results in extremal graph theory imply that if ex n f n 1 o 1 then f is acyclic this motivates the following central conjecture in the area due to pach and tardos 8 conjecture 1 1 for every forest f with i f 2 we have ex n f n log n o 1 as n conjecture 1 1 remains open in general though it was verified for all f with at most four edges by fu redi and hajnal 3 based on their work tardos 10 determined the order of magnitude of ex n f for every ordered graph f with at most four edges see corollary 4 3 in 10 in particular this verifies conjecture 1 1 for acyclic graphs with at most four edges and interval chromatic number two klazar 4 showed that the partial case of the fu redi hajnal conjecture that ex n f o n for every matching f implies the stanley wilf conjecture which was proved by marcus and tardos 7 we also point out that extremal problems for ordered forests have applications to theoretical computer science to search trees and path compression based data structures see bienstock and gyo ri 1 and pettie 9 for a survey a particularly interesting phenomenon discovered by fu redi and hajnal 3 is that the order of magnitude of the extremal function for the ordered forest 13 35 24 46 consisting of two inter lacing paths of length two is determined by the extremal theory for davenport schinzel sequences and in particular the extremal function has order of magnitude n n where n is the in verse ackermann function further progress towards the conjecture was made by kora ndi tardos tomon and weidert 5 in the equivalent reformulation of the problem in terms of forbidden 0 1 submatrices of 0 1 matrices giving a wide class of graphs f for which ex n f n 1 o 1 as n the following basic question closely related to conjecture 1 1 also has information theoretic applications see for instance 1 problem 1 2 determine which ordered forests have linear extremal functions the problem is not even solved for some forests with five edges and the above example by fu redi and hajnal of a 4 edge forest with extremal function involving the inverse ackermann function indicates that the problem is likely to be hard however it turns out that for trees the situation is simpler in this paper we resolve problem 1 2 for ordered trees and also determine the exact extremal func tion for ordered trees when the extremal function is linear this exact result is perhaps surprising since the situation in the unordered case is complicated as represented by the erdo s so s conjecture but the ordered situation has the benefit that most trees cannot have linear extremal function on the other hand the log n jump in complexity for trees with nonlinear extremal function is perhaps also interesting the description of the ordered trees with linear extremal functions is based on three forbidden subtrees which are the ordered paths p q and r shown below z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 3 figure 1 forbidden paths p q and r we are now ready to state our first main result theorem 1 3 let t be an ordered tree with k edges and i t 2 if t contains at least one of p q r then ex n t n log n as n otherwise ex n t k 1 n k 2 for all n k 1 as a corollary to theorem 1 3 if t is any ordered forest containing a path of length four with two or more crossing edges then ex n t n log n 1 2 convex geometric graphs problem 1 2 was posed by bra ka rolyi valtr 2 in the context of convex geometric graphs and remains open using our methods for ordered graphs and some modifications of constructions due to tardos we are able to determine all cg trees with linear extremal function for convenience we assume that the vertex set of any cgg we consider lies on a convex set in the plane we say that a cgg g is crossing or has a crossing if some pair of its edges intersect geometrically at a point that is not on definition 1 let p p 0 p 1 p 2 denote the family of three cg forests each comprising two copies p abcd p a b c d of a three edge path with the following properties the center edges bc p and b c p do not cross each other the pair of edges ab and cd cross at p and the pair a b and c d cross at p if b c 6 b c then p and p lie outside the region whose boundary contains the segments bc b c and while if b c b c then p and p lie on opposite sides of bc b c we allow bc and b c to share i endpoints where 0 i 2 and we denote the corresponding member of p by p i hence v p i 8 i note that p 1 and p 2 are connected while p 0 is not z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 4 figure 2 the family p given vertices a 1 at in a cyclically ordered set we write a 1 a 2 at to mean that the vertices are encountered in the order a 1 a 2 at a 1 when traversing in the clockwise direction given subsets a b of write a b to denote that there are no elements a a a and b b b such that a b a b in other words the intervals a and b appear as disjoint arcs intervals of the definition extends naturally to more than two intervals in analogy with the definition of interval chromatic number for ordered graphs the cyclic chromatic number c g of a cg graph g is the minimum k such that the vertex set of g can be partitioned into nonoverlapping intervals a 1 a 2 ak and no edge has both endpoints in any ai it is again straightforward to see that if c g 2 then ex n g n 2 consequently as we are aiming for a characterization of those g for which ex n g o n we may restrict to g with c g 2 theorem 1 4 fix k 2 and let t be a cg tree with k edges and c t 2 then either ex n t n or ex n log logn where the former holds iff t contains no crossing four edge path and no member of p it is interesting to contrast theorem 1 4 with theorem 1 3 as a general rule determining ex n f seems more difficult than determining ex n f our experience suggests that both problems exhibit similar but different behavior for example we were not able to determine ex n t exactly when it is n like in the ordered case one problematic cg tree is the double star d with k edges and maximum number of crossings it is easy to observe that ex n d ex n d o n but an exact result for ex n d seems harder to achieve perhaps this is the main impediment to obtaining an exact result in theorem 1 4 also it is not true that all k edge cg trees with linear extremal function have the same extremal function and we do not know whether every nonlinear extremal function for a cg tree grows at least as n log n 2 ordered trees in this section we prove theorem 1 3 in section 2 1 we give the constructions which show that each of the ordered paths p q r has extremal function of order at least n log n in section 2 2 we z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 5 describe the structure of the ordered trees of interval chromatic number two which do not contain p q or r then in section 2 3 we determine the extremal function for all those trees 2 1 ordered trees with nonlinear extremal function the paths p q and r are displayed in figure 1 in this section we present for each of p q and r a construction of an n vertex ordered graphs with n log n edges that does not contain p q and r respectively these results are not new and if fact tardos 10 showed that the extremal functions for p q and r are all actually of order n log n construction avoiding p we start with the simple construction that does not contain p form an ordered graph on n with edges ij such that i j 2 h for some h this graph has n log n edges it does not contain p since if v p ad ac bd where a b c d then for some h i j 2 h a d a c b d 2 i 2 j whereas max i j h implies 2 i 2 j 2 h a contradiction another was to achieve this construction is to take the graph of the k dimensional cube where we construct the graph in the usual recursive manner and n 2 k construction avoiding q bienstock and gyo ri 1 gave a construction showing ex n q n log n log logn and a simple construction giving ex n q n log n was given by fu redi and hajnal 3 the construction on 2 n vertices consists of edges between two intervals in and jn of size n for n 1 we take a single edge having the construction at stage n with intervals in and jn of size n take four intervals in i n and jn j n of length n in that order we put the preceding construction between in and jn and between i n and j n and then add a matching m consisting of an edge from the ith vertex of i to the ith vertex of j for i n if f n is the number of edges in the old construction then the new construction has 2 f n n edges we conclude f 2 n 2 f n n which implies f n 1 2 n log 2 n n it is shown in 3 that this construction does not contain p and so ex 2 n q 12 n log 2 n n for all n 1 construction avoiding r a similar type of construction avoids r for n 1 we again take a single edge and having created a construction with two intervals in and jn of length n we take four intervals in i n and jn j n of length n in that order we put the preceding construction between in and j n and between i n and jn and then add a matching m consisting of an edge from the ith vertex of i to the ith vertex of j for i n then the number of edges in the construction with 2 n vertices is f n as above and the construction does not contain r 2 2 structure of trees not containing p q or r in this section we consider trees which do not contain p q or r and describe their structure the length of an edge ij with i j n is i j edges ij and i j with i j and i j cross if i i j j or i i j j increasing trees an increasing tree is an ordered tree of interval chromatic number two with parts equal to intervals i j n described as follows a single edge is an increasing tree given an increasing tree with longest edge ij where i i and j j we create an increasing tree with z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 6 one more edge i j with i i and j j by requiring i i and j j or j j and i i note that an increasing tree has no crossing edges and the edges have a unique ordering by the increasing order of their lengths also increasing trees do not contain p q or r since they have no crossing edges z trees a z tree is an ordered tree z with interval chromatic number two say with parts equal to intervals i and j consisting of a union of an increasing tree t with longest edge ij where i i and j j together with a set sj of edges of the form hj with h i and h i and a set si of edges of the form ik with k j and k j these sets si and sj are allowed to be empty note that any two of the edges hj and ik cross an example of a z tree is below where the tree increasing tree t is shown in solid edges whereas si and sj are in dashed edges figure 3 a z tree note that the partition e t si sj of the edge set of a z tree and the edge ij is not uniquely determined by the z tree to make the partition unique take a longest path p in a z tree z whose edges are strictly increasing in length and let ij be defined to be the second to last edge of the path see figure 3 then si is the set of edges ik with k j and sj is the set of edges hj with h i the edge ij and the sets si sj are uniquely determined by z as is the increasing tree t z si sj by inspection a z tree does not contain p q or r and we now show the converse theorem 2 1 if an ordered tree of interval chromatic number two does not contain p q or r then it is a z tree proof we begin with the following observation if t is an ordered tree with i t 2 not containing p q or r then t contains no path of length four with at least one pair of crossing edges the following claim is helpful if t is an ordered tree with i t 2 containing crossing edges i j and ij where i i j j and ij 6 e t then t contains p or q or r z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 7 we first prove the claim since t is a tree there exists a path in t whose first and last edges are i j and ij if this path has length four then we have a path of length four with a crossing a contradiction therefore the path must have length three since i t 2 and i i j j i and i are not adjacent and j and j are not adjacent therefore the only possibility is that i j e t but then the edges i j i j ij form a copy of p in t a contradiction this proves the claim now we prove the theorem let z be an ordered tree with i z 2 not containing p q or r with intervals i j let xy be an edge of z such that x i and y j and y has degree 1 in z the case x j and y i is similar then z z y does not contain p q or r so z is a z tree we may write e z e t si sj where t is an increasing tree with longest edge ij with i i and j j and si ik k j and sj hj h i the edge ij is the second to last edge of a path longest p in z whose edge lengths are increasing let ik si be the last edge of the path where k j and k j the case that the last edge is hj with h i is similar case 1 the edge xy crosses an edge ab 6 ik in p where a i and b j in this case either x a b y or a x b y by the claim if x a b y then ay e z contradicting that y has degree 1 in z so a x b y and the claim gives xb e z now the path q p starting with the edges yx xb and ba and ending with the edge ik has length at least four in z and has a crossing which is a contradiction this completes case 1 case 2 the edge xy crosses no edge of p ik if x i then t xy is an increasing tree and z is therefore a z tree we conclude x i if x i then there is an edge xj sj but then the path yxjik is a path of length four in z with a crossing a contradiction we conclude x i and y j and now e z e t s i sj where s i si iy so z is a z tree 2 2 3 ordered trees with linear extremal function this section is devoted to determining the extremal function for z trees thereby completing the proof of theorem 1 3 we determine first the extremal function of increasing trees lemma 2 2 let t be an increasing tree with k edges then ex n t k 1 n k 2 for n k 1 proof observe that the longest edge in t has length at least k therefore the ordered n vertex graph g consisting of all edges ij with i j n such that 1 i j k cannot contain t and so ex n t e g k 1 i 1 n i k 1 n k 2 now we establish equality suppose g is an n vertex ordered graph that does not contain t we prove by induction on k that e g k 1 n k 2 for n k 1 for k 1 this is clear since any single edge is an increasing tree so g in that case is empty suppose t is an increasing tree with k 1 edges let uv be the longest edge of t where u v and suppose v is a leaf of t let t t uv assuming v g n remove for every i n k in v g the longest edge ij with z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 8 j i then the total number of edges removed from g is at most n k we therefore obtain an ordered graph g with at least e g e g n k edges if g contains the ordered tree t say u is mapped to i n then i n k so there exists an edge ij e g e g such that j is larger than any vertex in the embedding of t in g then adding ij we get an embedding of t uv t in g a contradiction we conclude g does not contain t so by induction e g k 1 n k 2 therefore e g k 1 n k 2 n k kn k 1 2 this completes the proof 2 this proof extends to give the extremal function for z trees in a fairly simple way lemma 2 3 let z be a z tree with k edges then for n k 1 ex n z k 1 n k 2 proof we may write z t si sj where t is an increasing tree with longest edge ij with i j and si consists of edges ik with k j and sj consists of edges hj with h i suppose e t a sj b and si c we construct an n vertex ordered graph g with no copy of z as follows the vertex set of g is n whereas the edge set consists of ea xy 1 y x a eb xy x b and ec xy y n c let f a b c ea eb ec a calculation shows f a b c k 1 n k 2 furthermore ea eb ec does not contain a copy of z since t has a edges ij has length at least a so ij 6 ea if ij eb then i b however z has b vertices preceding i namely the vertices in sj so this is not possible similarly if ij ec then j n c but since z has the c vertices in si after j this too is impossible therefore g does not contain z and we have ex n z k 1 n k 2 we now prove ex n z f a b c by induction on si c if c 0 then lemma 2 2 proves the required equality if c 1 then we observe f a b c f a b c 1 n k 1 let g be an n vertex ordered graph not containing z following the notation above with ij the longest edge of t z for each vertex g b g n a c 1 delete the longest edge gh e g with h g the number of edges deleted is n a b c 1 n k 1 if this new graph g contains z z ij where j is the last vertex of z then g contains z we observe b i n a c 1 and so there is a longest edge ij e g e g which can be added to z to get z therefore g does not contain z and by induction e g f a b c 1 which implies e g e g n k 1 f a b c 1 n k 1 f a b c this completes the proof 2 3 convex geometric trees in this section we prove theorem 1 4 we denote a crossing four edge path by the shorter notation crossing p 4 in section 3 1 we give the constructions which show that each p i and each crossing p 4 has extremal function of order at least n log n log n in section 3 2 we describe the structure of the cg trees t with c t 2 which contain neither a crossing p 4 nor any p i then in section 3 3 we show that these trees have linear extremal function z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 9 3 1 convex geometric trees with nonlinear extremal function we begin by noting that bra ka rolyi valtr 2 proved that ex n p i n log n actually they proved this only for p 0 but exactly the same proof both upper and lower bounds works for p 1 and p 2 as well in order to present our constructions that avoid crossing p 4 s we need a theorem of tardos 11 the setup of his theorem is as follows we are given a bipartite graph g a b e with a proper edge coloring c with d colors in which the colors are linearly ordered a walk e 1 e 2 e 3 e 4 is called fast if c e 2 c e 3 c e 4 c e 1 a walk e 1 e 2 e 3 e 4 is called slow if it starts in b c e 2 c e 3 c e 4 and c e 2 c e 1 c e 4 theorem 3 1 tardos 11 p 549 let g a b e be a bipartite graph with a proper edge coloring with d colors there exists a subgraph g a b e of g without slow walks and with e log d 480 d e similarly there exists a subgraph g a b e of g without fast walks and with e log d 480 d e we are now ready to present our constructions for theorem 1 4 construction let v 1 vn be in clockwise order on and form the vertex set v of our con struction fn where n 2 k the edge set of fn consists of k 1 matchings m 1 mk 1 each of size n 4 for each 1 j k 1 mj v 2 i 1 v 2 i 2 2 j i n 4 let v 1 v 1 v 3 vn 1 and v 2 v 2 v 4 vn for every edge e vivj in fn if j i then j is the left end if j i and right end otherwise note that i e fn k 1 n 4 log 2 n 1 n 4 ii the left ends of all edges are in v 1 and all right ends are in v 2 iii fn does not contain a path vi 1 vi 2 vi 3 vi 4 such that i 2 i 4 i 1 i 3 case iii is referred to by tardos 11 as a heavy path we consider m 1 mk 1 as color classes of an edge coloring c of fn in which the colors are ordered according to their indices by theorem 3 1 fn contains subgraphs fn 1 fn 2 and fn 3 such that p 1 fn j log k 1 480 k 1 e fn log k 1 1920 n for each 1 j 3 p 2 fn 1 does not contain fast walks p 3 fn 2 does not contain slow walks starting in v 1 p 4 fn 3 does not contain slow walks starting in v 2 we also will use the cg graph fn 0 with the same vertex set v and e fn 0 vivj 1 i n 2 n 2 1 j n 2 definition 2 we denote by l the cg three edge path with interval chromatic number greater than two in other words l is the 3 edge cg path xyzu such that x y z u in the cyclic ordering z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 10 remark the cg graph fn 0 does not contain l definition 3 a path p x 1 x 2 xs in a cgg is a zigzag if it has no crossing and for every 2 j s 2 the sets x 1 xj 1 and xj 2 xs are on different sides of the chord xjxj 1 alternatively p has no crossing and c p 2 perles see 6 p 292 proved that ex n p o n for any zigzag path p our main result is that the construction presented above contains no copy of a crossing p 4 theorem 3 2 for every four edge path p in a cgg apart from the zigzag path ex n p n log logn moreover p is not contained in one of fn j for 0 j 3 proof since each fn j has at least n log k n log logn edges it suffices to show that for each crossing four edge path p there is a j for which p 6 fn j every type of a cgg four edge path corresponds to a cyclic permutation of 5 so we need to consider 4 24 types of them by the remark above it is enough to consider the types with cyclic chromatic number 2 suppose such a path i e with cyclic chromatic number 2 and distinct from a zigzag path p abcdf can be embedded into fn 1 suppose that for x a b c d f x is mapped onto vix assume ic is odd the proof for even ic will be symmetric by the structure of fn ib ic and id ic so by symmetry we may suppose ic id ib 1 again by the structure of fn ib ia if id ia ib then the cyclic chromatic number of the path a b c d is 3 a contradiction the situation ic ia id impossible because the lengths of the edges are of the form 2 j 1 so the only possibility is ia ic id ib once again by the structure of fn id if if ic if id then p is a zigzag path contradicting our choice if if ia then id if ib ia since otherwise 2 id if ib ia and 2 ib ic ib ia a contradiction but in this case fn 1 contains the fast walk fdcba contradicting p 2 thus ia if ic this means we need to consider only cyclical structure 1 5 3 4 2 and when we switch from the case of odd ic to the even 5 1 3 2 4 case 1 1 5 3 4 2 we claim that fn 2 does not contain it indeed suppose it does if ic is odd then repeating the above argument we come to ia if ic but this means fn 2 contains the slow walk fdcba contradicting p 3 thus assume ic is even then by the structure of fn id ic and ib ic say id ib ic then by the cyclic structure of our path ib if ic this is impossible since 2 if id ic id and 2 ic ib ic id case 2 5 1 3 2 4 we claim that fn 3 does not contain this path the proof is symmetric to case 1 2 3 2 structure of trees avoiding p and a crossing p 4 we need the definitions of increasing trees and z trees in the cg setting z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 11 convex geometric increasing trees a cg increasing tree is a cg tree of cyclic chromatic number two obtained as follows start with an ordered increasing tree with vertex set n and view the linear ordering of the vertices as a cyclic ordering n n 1 2 1 note that a cg increasing tree has no crossing edges and the edges have a unique ordering by the increasing order of their lengths when viewed in terms of the natural linear order on n convex geometric z trees a cg z tree is a cg tree z with cyclic chromatic number two obtained from a z tree with ordered vertex set n and intervals i j n by viewing the linear ordering of the vertices as a cyclic ordering n n 1 2 1 note that z is a union of a cg increasing tree t with longest edge ij where i i and j j together with a set sj of edges of the form hj with h i and i h and a set si of edges of the form ik with k j and k j see figure 4 viewed as a cyclic ordering these sets si and sj are allowed to be empty note that any two of the edges hj and ik cross see figure 3 for an example our main structural result is the following theorem 3 3 let t be a cg tree with c t 2 that contains no crossing p 4 and no member of p then t is a cg z tree proof suppose we have an embedding of t in a circle we will simultaneously refer to t as well as to the geometric properties of its embedding say that an edge e is heavy if both its endpoints have a neighbor on the same side of e since we have no l see definition 2 this means that every heavy edge e gives rise to a crossing three edge path with central edge e case 1 there is a heavy edge e i j suppose j is a neighbor of i and i is a neighbor of j such that both i and j are on the same side of e assume by symmetry that j and i lie on the arc j i of taken clockwise then i i j j otherwise we obtain l this shows that all such neighbors of j lie clockwise of all such neighbors of i in j i and we obtain a double star as shown below moreover each of these neighbors j i has degree one otherwise we obtain a crossing p 4 figure 4 hence to grow t further we must consider neighbors of i or j on the arc i j of which omits j and i see figure 4 we now claim that on the arc i j the tree t is an increasing tree and moreover there is no edge that crosses e i j this will complete the proof in this case first observe that i and j cannot both have neighbors in i j otherwise we get l as before or p 2 as shown below z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 12 figure 5 so we may assume by symmetry that only j has neighbors in i j if j 1 j 2 jr are the neighbors of j in i j in increasing clockwise order then only jr can have degree at least two otherwise we get a copy of l or p 1 furthermore all neighbors of jr are in the segment jr j otherwise we have l or a crossing p 4 we now continue in this way if jr has neighbors k 1 k 2 km j in increasing clockwise order in jr j then only k 1 can have degree at least two otherwise we have a copy of l or p 0 or a crossing p 4 furthermore all neighbors of k 1 are in the segment jr k 1 otherwise we obtain l or a crossing p 4 we continue this process till we exhaust all of t case 2 there is no heavy edge in this case we claim the stronger statement that t is cg increasing tree start by choosing any edge e i j and consider the neighbors of i or of j in the arc i j traversed clockwise as usual since e is not heavy at most one of i j has neighbors in i j say j then using the fact that there is no heavy edge we proceed as in the previous paragraph until we have exhausted all vertices of t in i j then we repeat this argument in the arc j i to show that t is a cg increasing tree 2 3 3 convex geometric trees with linear extremal function we are now in a position to complete the proof of theorem 1 4 proof of theorem 1 4 by theorems 3 2 and 3 3 it suffices to show that every cg z tree z with k 2 edges satisfies ex n z 2 k 1 n we will prove this by induction on k with the case k 2 being trivial for the induction step suppose that z is a cg z tree with k 2 edges and g is an n vertex cg graph with more than 2 k 1 n edges let us first do the case when z is a double star with edge set si sj in this case we view as a linearly ordered set and use the fact that ex n z ex n z k 1 n where the bound ex n z k 1 n follows from lemma 2 3 with z viewed as the appropriate ordered double star we now assume that z has a leaf x incident to some shortest edge outside si sj and let z z v in figure 3 this corresponds to deleting the lowest solid edge let g be the cg graph obtained from g by deleting for each vertex v v g the two shortest edges incident to v one in each direction we delete at most 2 n edges so g has more than 2 k 2 n edges and hence by induction g contains a copy of z we then extend this copy of z to a copy of z in g using one of the edges that was deleted in forming g 2 z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 13 acknowledgement this research was partly conducted during aim squares structured quar tet research ensembles workshops and we gratefully acknowledge the support of aim references 1 d bienstock e gyo ri an extremal problem on sparse 0 1 matrices siam j discrete math 4 1991 17 27 2 p brass gy ka rolyi p valtr a tura n type extremal theory of convex geometric graphs in b aronov et al eds discrete and computational geometry the goodmanpollack festscrift springer berlin 2003 277 302 3 z fu redi p hajnal davenport schinzel theory of matrices discrete math 103 1992 233 251 4 m klazar the fu redi hajnal conjecture implies the stanley wilf conjecture in d krob a a mikhalev a v mikhalev eds formal power series and algebraic combinatorics springer berlin 2000 250 255 5 d kora ndi g tardos i tomon c weidert on the tura n number of ordered forests https arxiv org abs 1711 07723 6 w moser and j pach recent developments in combinatorial geometry in new trends in discrete and computational geometry j pach ed springer new york 1993 281 302 7 a marcus g tardos excluded permutation matrices and the stanley wilf conjecture j combin theory ser a 107 2004 153 160 8 j pach g tardos forbidden patterns and unit distances computational geometry scg 05 1 9 acm new york 2005 9 s pettie degrees of nonlinearity in forbidden 0 1 matrix problems discrete mathematics 311 2011 2396 2410 10 g tardos on 0 1 matrices and small excluded submatrices journal of combinatorial theory series a volume 111 2005 266 288 11 g tardos construction of locally plane graphs with many edges in thirty essays on geo metric graph theory j pach ed springer new york 2013 541 562 z fu redi a kostochka d mubayi j verstrae te ordered and geometric trees 14 zolta n fu redi alfre d re nyi institute of mathematics hungarian academy of sciences rea ltanoda utca 13 15 h 1053 budapest hungary e mail zfuredi gmail com alexandr kostochka university of illinois at urbana champaign urbana il 61801 and sobolev institute of mathematics novosibirsk 630090 russia e mail kostochk math uiuc edu dhruv mubayi department of mathematics statistics and computer science university of illinois at chicago chicago il 60607 e mail mubayi uic edu jacques verstrae te department of mathematics university of california at san diego 9500 gilman drive la jolla california 92093 0112 usa e mail jverstra math ucsd edu 1 introduction 1 1 ordered graphs 1 2 convex geometric graphs 2 ordered trees 2 1 ordered trees with nonlinear extremal function 2 2 structure of trees not containing p q or r 2 3 ordered trees with linear extremal function 3 convex geometric trees 3 1 convex geometric trees with nonlinear extremal function 3 2 structure of trees avoiding p and a crossing p 4 3 3 convex geometric trees with linear extremal function