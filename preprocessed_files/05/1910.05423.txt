ar x iv 1 91 0 05 42 3 v 1 m at h c o 1 1 o ct 2 01 9 refined counting of core partitions into d distinct parts hannah e burson simone sisneros thiry armin straub october 6 2019 abstract using a combinatorial bijection with certain abaci diagrams nath and sellers have enu merated s ms 1 core partitions into distinct parts we generalize their result in several directions by including the number of parts of these partitions by considering d distinct par titions and by allowing more general s ms r core partitions as an application of our approach we obtain the average and maximum number of parts of these core partitions 1 introduction if 1 2 r 1 where the parts i are integers then 1 2 r is an integer partition of 1 r its number of parts is n r excellent introductions to partitions include 3 and 4 a partition is d distinct if its parts differ by at least d in the case d 1 these are precisely partitions into distinct parts the young diagram of a partition is a left justified array of square cells where the first row contains 1 cells the second row 2 cells and so on the hook assigned to each cell u consists of the cell u itself as well as all cells below u and to the right of u the length of a hook is the number of cells it contains a partition is said to be t core if there is no hook in its young diagram that has length t for an introduction to this notion we refer to for instance 5 more generally is said to be t 1 t 2 tm core if is ti core for all i 1 2 m in this paper we are concerned with counting certain core partitions this line of inquiry has received increasing interest since anderson 2 proved that the number of s t core partitions is 1 s t s t s 1 if s and t are coprime otherwise there are infinitely many such partitions it remains an open problem to similarly enumerate s t core partitions into distinct parts towards that problem it was shown in 18 that s ms 1 core partitions into distinct parts are counted by fibonacci like numbers this count was generalized by nath and sellers 13 to also include s ms 1 core partitions following 13 s ms 1 core partitions refer to s ms 1 core or s ms 1 core partitions university of illinois at urbana champaign email hburso 2 illinois edu university of illinois at urbana champaign email thiry 2 illinois edu university of south alabama email straub southalabama edu 1 http arxiv org abs 1910 05423 v 1 theorem 1 1 let m s 1 the number c s m of s ms 1 core partitions into distinct parts is characterized by c s m c s 1 m mc s 2 m for s 3 with the initial conditions c 1 m 1 c 2 m m and c 2 m m 1 in the case m 1 the numbers c s 1 fs are the familiar fibonacci numbers this special case was predicted by amdeberhan 1 and also independently proved by xiong 19 nath and sellers 13 proved the case of s ms 1 core partitions of theorem 1 1 combi natorially by viewing the partitions as certain abaci this correspondence will be introduced in section 2 building on their combinatorial approach our main result extends theorem 1 1 in various directions a we keep track of the number of parts of the involved partitions b we consider partitions into d distinct parts which in the case d 1 are partitions into distinct parts c we allow s ms r core partitions for certain integers r and d we consider s core partitions with maximum hook length ms r for all m r z to that end let cds m r be the set of s ms r core partitions into d distinct parts we denote with c d s m r q cd s m r qn 2 the generating polynomial for the number of parts of the partitions in cds m r if d is omitted in the notation it is implicit that d 1 observe that c s m cs m 1 1 theorem 1 2 let d m r 1 write fs q c d s m r q if s d 1 and r d then fs q fs 1 q q q 2 qm fs d 1 q if r 1 then the same conclusion holds provided that s 2 if d 1 and s 2 d 1 if d 1 we provide initial conditions which specialize to the ones in theorem 1 1 in lemma 3 6 in light of lemma 2 4 we prove theorem 1 2 as a special case of our theorems 3 1 and 3 2 as well as lemma 3 3 in the case r 1 and s 2 d 2 and lemma 3 5 in the case r 1 and d 1 on certain abaci in fact it follows from theorem 3 1 that the condition r d can be dropped if c d s m r q is modified to be the generating polynomial of parts of s core partitions into d distinct parts with largest hook of length less than ms r additionally in theorem 3 2 we provide an extension to negative values r 1 theorem 1 2 unifies several results in the recent literature as indicated the special cases d r q 1 1 1 result in theorem 1 1 by straub 18 and nath and sellers 13 more gen erally the case d r 1 1 has been established by paramonov 15 who notes that the approach applies to the case d r 1 1 as well in the cases m q 1 1 we obtain results on d distinct partitions by sahin 16 which were generalized by kravitz 12 who also considers the case m 1 2 in theorems 3 1 and 3 2 we show that the enumeration in theorem 1 2 extends naturally to s core abaci of bounded height in section 2 we review the combinatorial correspondence between core partitions and abaci and prove several preliminary results let us note for instance that nath and sellers 13 prove the case d r q 1 1 1 in a combinatorial manner and then use an algebraic argument based on generating functions to deduce the case d r q 1 1 1 at the end of section 2 we demonstrate that this algebraic argument can be replaced and naturally generalized by a combinatorial observation on abaci section 3 is concerned with enumerating s core abaci of bounded height in particular by looking at s core abaci of bounded height we provide a proof of theorem 1 2 we include applications of our approach in section 4 by determining the maximum number of parts of certain core partitions and by enumerating core partitions with maximal initial gaps as another application we indicate in section 5 how to determine the average number of parts and likewise higher moments of the core partitions studied here 2 preliminaries and s core abaci in this section we introduce abaci and discuss their relation to core partitions it is then shown in the next section that theorem 1 2 on enumerating s ms r core partitions is an instance of and more naturally expressed as a more general result on s core abaci of bounded height an s abacus is an array consisting of s columns labelled 0 1 2 s 1 and some number of rows labelled 0 1 2 where each entry is either occupied by a bead or unoccupied a spacer the entry in row i and column j is said to be in position is j placing a set of nonnegative integers a 1 a 2 on an s abacus means to construct the s abacus with beads precisely in the positions a 1 a 2 the s abacus corresponding to a partition is obtained by placing the set of its first column hook lengths on an s abacus consequently the number of parts of equals the number of beads of the corresponding abacus a we write n a for the number of beads in a we say that an s abacus a has spacing d if it corresponds to a partition with parts that differ by at least d equivalently the positions of beads in a differ by more than d in the sequel an s core abacus refers to an s abacus corresponding to an s core partition by 13 lemma 7 which is equivalent to 19 lemma 2 1 these are characterized as follows lemma 2 1 13 lemma 7 an s abacus corresponds to an s core partition if and only if the first column is empty and no spacers occur below a bead example 2 2 the partition 7 5 4 2 1 has first column hook lengths 1 3 6 8 11 its 5 abacus and 7 abacus are in light of lemma 2 1 we see that is not a 7 core partition because there is one bead with a spacer below it but is a 5 core partition because the first column is empty and no spacers occur below a bead because has distinct parts both abaci have spacing 1 let ads m be the set of s core abaci with at most m rows and spacing d throughout m 1 and d 1 more generally for integers r possibly negative let ads m r denote the set of s core 3 abaci with spacing d such that the maximum position is strictly less than ms r note that by definition ads m a d s m 0 since the first column of an s core abacus is necessarily empty we also have ads m a d s m 1 in the sequel if d 1 we may omit d in the notation that is as m a 1 s m and as m r a 1 s m r recall that n a is the number of beads in the abacus a let a d s m r q a ads m r qn a 3 be the generating polynomial for the number of beads in the abaci in ads m r as for a d s m r we drop d and r from the notation if d 1 or r 0 respectively note that ad 0 m r q 1 representing the empty abacus since it is natural and convenient for certain results we set ads m r q 0 for s 0 using the correspondence with abaci we can easily show the following result which in the case d 1 was proved in 18 lemma 2 2 and 19 lemma 3 2 and which is equivalent to 12 lemma 2 5 lemma 2 3 if 1 r d then every s s r core partition into d distinct parts has maximum hook length s r proof let a be the s abacus of an s s r core partition into d distinct parts we need to show that all beads of a recall that these correspond to the first column hook lengths of are in positions with labels s r assume for the sake of contradiction that a has a bead in position x s r by lemma 2 1 because is an s core partition there must also be a bead in position x s likewise because is a s r core partition there must be a bead in position x s r however x s x s r r d which contradicts the requirement that positions of beads in a differ by more than d by construction the abaci in ads m r correspond to s core partitions into d distinct parts with largest hook ms r equivalently these are s ms r ms r 1 core partitions into d distinct parts note that by lemma 2 3 applied with d r 1 a t t 1 core partition into distinct parts has largest hook less than t if r d this simplifies as follows lemma 2 4 if 1 r d or if r 1 then the abaci in ads m r are in 1 1 correspondence with s ms r core partitions into d distinct parts proof we need to show that s ms r core partitions into d distinct parts have maximum hook length ms r in the case 1 r d applying lemma 2 3 with ms in place of s we find that every s ms r core partition into d distinct parts indeed has maximum hook length ms r finally consider the case r 0 note that every s ms r core partition is ms r ms core hence if d r then lemma 2 3 shows that every s ms r core partition into d distinct parts has maximum hook length ms if r 1 it follows that the maximum hook length is ms 1 example 2 5 lemma 2 4 does not generally hold for other values of r for instance consider the case r 2 and s m 6 1 the partition 4 1 is s ms r 6 4 core and 3 distinct however its maximum hook length is 5 ms r 4 lemma 2 6 let s d 1 removing the last d 1 columns not all empty from an s core abacus with spacing d results in an s d 1 core abacus with spacing d 4 proof in light of lemma 2 1 the result is clearly an s d 1 core abacus it remains to observe that the reduced abacus has spacing d for that it suffices to check that in the reduced abacus each bead in the first row is followed by d empty positions since the initial abacus had spacing d we need only consider the last such bead in the initial abacus this bead was followed by d 1 d spacers then a bead in the last d 1 columns followed by another d 2 d spacers after removal of the last d 1 columns it is therefore followed by d 1 d 2 d d spacers example 2 7 we note that this result is not true for removing the first d 1 columns this is illustrated for instance with d 2 by the 5 core abacus with beads in positions 1 4 9 nath and sellers 13 prove theorem 1 1 by a combinatorial argument for s ms 1 core partitions they then deduce the case of s ms 1 core partitions by proving the q 1 case of the relation as m 1 q as 1 m q q q 2 qm 1 as 2 m q 4 using an algebraic argument based on generating functions note that by theorem 3 1 the relation 4 is equivalent to as m 1 q as m q q m as 2 m q our next result provides a simple combinatorial proof of this identity and further generalizes it to as m r q for any r 1 for the case s r in 5 it is understood that a d s m r q 0 if s 0 lemma 2 8 let m r 1 if s r then as m q as m r q q m r k 1 as k 1 m q ak 1 m 1 q 5 proof suppose s r observe that as m q as m r q consists of those s core abaci with spacing d 1 which have m rows and last bead in position ms k for k 1 2 r fix one of these values for k corresponding to one of the last r columns that column always contains m beads contributing qm to 5 the k 1 columns after that column form an abacus in ak 1 m 1 while the first s k 1 columns form an abacus in as k 1 m the one remaining column is the empty column preceding the column with m beads if s r the same argument still applies but k r is not possible since a 1 m q 0 the summand corresponding to k r is zero so that equation 5 still holds 3 s core abaci of bounded height as introduced in section 2 ads m r is the set of s core abaci with spacing d such that the maximum position is less than ms r recall that n a is the number of beads in a as a consequence of lemma 2 4 if 1 r d or if r 1 then c d s m r q a d s m r q 6 where cds m r q defined in 2 is the generating polynomial for the number of parts of s ms r core partitions into d distinct parts in particular theorem 1 2 on core partitions is contained in the following result on abaci 5 theorem 3 1 let d m 1 r 0 and write fs q a d s m r q if s d 1 and s r then fs q fs 1 q q q 2 qm fs d 1 q 7 we note that in the case d 1 the condition s d 1 may be dropped because 7 trivially holds for s 1 and s 2 with the understanding that fs q 0 if s 0 proof by definition fs q is the generating polynomial for s core abaci with spacing at least d which consist of m 1 rows such that the top row has beads only in the first r positions let g be the size of the gap between the last bead in the first row and the first bead in the second row or g if there are no beads in the second row by assumption g d there are two disjoint possibilities for such abaci depending on whether g d and the last column is empty case a or not case b a suppose that g d and that the last column is empty since r s 1 by removing the last column we see that these abaci are in bijective correspondence with abaci in ads 1 m r the generating polynomial for the latter is fs 1 q b suppose that g d or that the last column is non empty in that case exactly one of the last d 1 columns contains beads we must again consider two cases based on whether the last bead that is the bead in the highest position is located in the last d 1 columns of the m 1 st row case b ii or not case b i we note that if s r d 1 then we are necessarily in case b i i suppose the last bead is not located in the last d 1 columns of the m 1 th row that is its position is m 1 s d 1 consider the abaci obtained by removing the last d 1 columns exactly one of which contains beads 1 2 m many by lemma 2 6 the resulting abaci are in ads d 1 m r with no bead in the m 2 nd row to see that this correspondence is m to 1 consider an abacus a in ads d 1 m r with no bead in the m 2 nd row we need to show that there are exactly m ways in which a could have been obtained from a case b i abacus b ads m r by deleting the last d 1 columns let h 1 be the number of empty positions at the beginning of the second row of a if h d then the last d h columns of b must have been empty and the column before that non empty with m choices for the number of beads if h d then the last column of b must have been non empty again with m choices for the number of beads in either case the remaining of the last d 1 columns of b must be empty by construction each of the m possibilities for b indeed are case b i abaci from ads m r ii we now are left with abaci in which the last bead is located in the last d 1 columns of the m 1 st row equivalently the unique non empty column among the last d 1 has m 1 beads since s r this cannot be the last column consequently g d in particular there is a bead in the second row of the first non empty column increase the number of beads in that first non empty column to m 2 thereby adding 1 2 m beads and remove the last d 1 columns thereby removing m 1 beads this process removes 1 2 m beads by lemma 2 6 the resulting abaci are in ads d 1 m r with a bead in the m 2 nd row to see that this correspondence is m to 1 consider an abacus a in ads d 1 m r with a bead in the m 2 nd row we need to show that there are exactly m ways in which 6 a could have been obtained from a case b ii abacus b ads m r as in case b i let h 1 be the number of empty positions at the beginning of the second row of a note that column h 1 of a contains m 2 beads we necessarily have h d so that the last d h columns of b must have been empty and the column before that must have contained m 1 beads in order to obtain a from b column h 1 of b must have contained 2 3 m 1 beads for a total of m choices for b theorem 3 1 has the following analog for abaci in ads m r where r is negative because of lemma 2 4 the case r 1 is of particular interest as those abaci correspond to s ms 1 core partitions into d distinct parts as such theorem 3 2 together with lemma 3 3 proves the part of theorem 1 2 concerned with these partitions theorem 3 2 let d m 1 r 0 and write fs q a d s m r q if s 2 d r then fs q fs 1 q q q 2 qm fs d 1 q 8 it appears that the bound s 2 d r is sharp for large r specifically r d 1 and d 2 for small r the bound can be improved to s 2 d 1 we give a direct combinatorial proof in the spirit of theorem 3 1 of this fact in theorem 3 4 based on numerical evidence the optimal lower bounds on s appear to be s 2 d r if r d 1 and d 2 1 if r d 1 and d 2 r 1 if d 1 we prove the remaining case d 1 in lemma 3 5 proof of theorem 3 2 let us prove the claim that 8 holds for all s 2 d r fix r 1 and suppose for the purposes of induction that this claim is true for r replaced with 1 2 r 1 in the following we are going to show that the claim holds for r as well along the way we also show that 8 holds for r 1 and all s 2 d 2 comments and adjustments for that case are included in square brackets since 8 is proved for r 1 and s 2 d 2 in lemma 3 3 below this completes the proof of theorem 3 2 suppose that s 2 d r if r 1 then s 2 d 2 in the following let t be such that t s d 1 we intend to rewrite each of the terms ft q in 8 note that the condition s 2 d r translates into t d r 1 while for r 1 the condition s 2 d 2 translates into t d 1 by construction for any integer t 0 we have a d t m r q a d t m 1 t r q 9 since t r and t d 1 we may apply theorem 3 1 to the right hand side of 9 to obtain a d t m r q a d t 1 m 1 t r q q q 2 qm 1 adt d 1 m 1 t r q adt 1 m 1 r q q q 2 qm 1 adt d 1 m d 1 r q for the second equality we applied 9 in reverse to both summands on the other hand we have a d t m d 1 r q a d t 1 m d 1 r q q q 2 qm adt d 1 m d 1 r q 7 as a consequence of theorem 3 1 if d 1 r 0 or the induction hypothesis since if d 1 r 0 then the condition t 2 d r d 1 d r 1 is satisfied if r 1 then no induction hypothesis is required because we will always be in the case d 1 r 0 comparing the previous two equations we conclude that for t s d 1 a d t m r q a d t 1 m 1 r q q m a d t d 1 m d 1 r q adt m d 1 r q a d t 1 m d 1 r q 10 let gt q be any one of the four terms on the right hand side of 10 as above after checking that the conditions are satisfied it follows from either theorem 3 1 or the induction hypothesis that for the special case t s gs q gs 1 q q q 2 qm gs d 1 q 11 which then shows that the same relation holds for fs q a d s m r q thus establishing the claimed relation 8 let us illustrate the details of checking 11 at the example of gs q a d s d 1 m d 1 r q which is the most restrictive of the four cases in that case if d 1 r 0 then theorem 3 1 applies to show 11 because the condition s d 1 d 1 that is s 2 d 2 follows from the assumption that s 2 d r whereas in the case r 1 we are assuming s 2 d 2 to begin with on the other hand if d 1 r 0 this does not happen when r 1 then the induction hypothesis applies to show 11 because the assumed condition s 2 d r implies the necessary condition s d 1 2 d r d 1 we now complete the proof of theorem 3 2 by showing that in the case r 1 8 holds for s 2 d 2 lemma 3 3 let d m 1 and write fs q a d s m 1 q if s 2 d 2 then 8 holds proof we need to show that a d 2 d 2 m 1 q a d 2 d 1 m 1 q q q 2 qm add 1 m 1 q 12 because each abacus in add 1 m 1 has at most one column of beads a d d 1 m 1 q 1 q q 2 qm 1 d 1 q q 2 qm 1 d 1 q 1 q qm 1 13 on the other hand abaci in ad 2 d 2 m 1 and a d 2 d 1 m 1 have at most two columns of beads appending an empty column to each abacus in ad 2 d 1 m 1 yields an abacus in a d 2 d 2 m 1 the abaci in ad 2 d 2 m 1 not obtained in this fashion fall into three groups i those for which the last column is not empty and hence contains 1 2 m 1 many beads the generating polynomial for these abaci is q q 2 qm 1 1 q q 2 qm d 1 q based on whether there is no second column of beads contributing the 1 in the second factor or there is a column of beads including position d contributing q q 2 qm or there is a single bead in positions 1 2 d 1 contributing d 1 q 8 ii those for which the last column is empty and there is a gap of exactly d spaces between the last bead in the first row and the first bead in the second row since there are d 1 possibilities for the location of the first column of beads which contains 2 3 m many beads each of which determines the location of the second column containing 1 2 m beads the generating polynomial for these abaci is d 1 q 2 q 3 qm q q 2 qm iii those for which the second to last column contains m beads and to avoid double counting there are more than d spaces following the last bead in the first row the generating polynomial for these abaci is qm 1 d 1 q because in addition to the column of m beads there can only be a single bead in positions 1 2 d 1 adding these three generating polynomials we have shown that a d 2 d 2 m 1 q a d 2 d 1 m 1 q q 1 d 1 q 1 q q m 1 2 together with 13 this proves 12 the bound s 2 d r in theorem 3 2 can be improved to s 2 d 1 in the case of small r specifically r d 1 we give a direct combinatorial proof for that improved bound which empirically is best possible theorem 3 4 let m 1 1 r d 1 and write fs q a d s m r q if s 2 d 1 then fs q fs 1 q q q 2 qm fs d 1 q 14 proof our proof is a variation of the proof of theorem 3 1 by definition fs q is the generating polynomial for s core abaci with spacing at least d between beads which consist of m rows such that the top row has no beads in the last r positions as in the proof of theorem 3 1 let g be the size of the gap between the last bead in the first row and the first bead in the second row there are two disjoint possibilities for such abaci a suppose that g d with the last column empty and no bead in the final allowed position that is no bead in position ms r 1 by removing the last column we see that these abaci are in bijective correspondence with abaci in ads 1 m r b suppose the conditions of a are not satisfied we distinguish the following cases i suppose that the last d 1 columns are empty this can only happen if r d 1 and if there is a bead in the highest allowed position that is column s r 1 has m beads we then remove the last d 1 columns as well as the m beads from column s r 1 and obtain an abacus in ads d 1 m r ii otherwise there is precisely one non empty column among the last d 1 columns suppose additionally that one of the r columns s d r s d 2 s d 1 say column j contains m beads equivalently removing the last d 1 columns does not result in an abacus in ads d 1 m r in that case the one non empty column among 9 the last d 1 must be one of the last r and as such contains b m beads we then remove the last d 1 columns and reduce the number of beads in column j by m b the resulting abacus is in ads d 1 m r and has precisely m fewer beads iii otherwise we remove the last d 1 columns and by lemma 2 6 obtain an abacus in ads d 1 m r fix an abacus a ads d 1 m r to complete the proof we need to show that a is obtained through the described process from m case b abaci b ads m r with 1 2 m additional beads let h 1 be the number of empty positions at the beginning of the second row of a if h d then let k s d h otherwise let k s we can construct b from a by adding d 1 empty columns and then filling column k with b beads where 1 b m note that if h d then g d for b while otherwise b has a non empty last column it remains to similarly construct an abacus b from a by adding d 1 columns and m beads for that we distinguish three cases if column k is not among the last r columns of b then it can also be filled with m beads otherwise if one of the last r columns of a contains c 1 beads then we add m c beads to the corresponding column of b and c beads to column k of b otherwise we add m beads to column s r 1 of b in each case we check that abacus b corresponds to case b and results in abacus a by the process described for case b we further provide a quick proof that theorem 3 2 in the case d 1 continues to hold for all s r 1 which empirically is best possible lemma 3 5 let m r 1 and write fs q as m r q if s r 1 then 8 holds proof by lemma 2 8 for s r as m r q as m q q m r k 1 as k 1 m q ak 1 m 1 q let gs q be any one of the terms as m q or as k 1 m q for k 1 2 r on the right hand side to prove our claim it suffices to show that for s r 2 gs q gs 1 q q q 2 qm gs 2 q this follows from theorem 3 1 with r 0 recalling that for d 1 the condition s d 1 may be dropped we close this section by showing that theorem 3 1 can be used to compute ads m r q for any choice of the parameters that is for any s m d 1 and any integers r first note that if 0 ms r s then ads m r q a d ms r 1 0 q if ms r 0 then a d s m r q 1 second if ms r s we can write ms r m s r where m 1 and 0 r s by definition a d s m r q a d s m r q 10 these observations reduce the general case to the case s r 0 in light of theorem 3 1 the following initial conditions therefore suffice to recursively determine ads m r q for any choice of the parameters in the following we use the notation x max 0 x lemma 3 6 let d m 1 and r be any integer for s 1 2 d a d s m r q 1 min s 1 ms r 1 q for the case s d 1 write r sr r 0 with 0 r 0 d if m r 0 then add 1 m r q 1 if m r 0 then a d d 1 m r q 1 d q q 2 qm r r 0 1 qm r 1 proof the case s 1 2 d is an immediate consequence of the fact that the corresponding abaci can have at most one bead in the case s d 1 we can have a full column of beads in any of the s 1 d columns after the first and there can be no bead in a second column note that add 1 m r a d d 1 m r r 0 since the case m r 0 is trivial suppose m r 0 each of the last d columns can accomodate m r many beads additionally any of the r 0 1 columns 1 2 3 r 0 1 can accomodate an additional bead in the m r 1 st row example 3 7 in the case d 1 we find that a 1 m r q 1 and a 2 m r q 1 q q 2 qm r 2 15 in the cases r 1 q 1 these specialize to the initial conditions in theorem 1 1 example 3 8 recall from 6 that in the case d r 1 1 we have as m r q cs m r q for instance for s m 4 3 we have ms 1 11 and the 4 11 core partitions into distinct parts are 1 2 3 2 1 4 1 5 2 6 3 3 2 1 5 2 1 7 4 1 8 5 2 4 3 2 1 6 3 2 1 5 4 3 2 1 there are c 4 3 1 1 15 such partitions and the generating polynomial for the number of parts in these partitions is c 4 3 1 q 1 3 q 4 q 2 4 q 3 2 q 4 q 5 1 q q 2 1 2 q q 2 q 3 we note that such a factorization always exists for the polynomials cs m 1 q indeed for s 2 we claim that cs m 1 q is divisible by 1 q q 2 qm 1 this is true for c 2 m 1 q by 15 and the claim follows inductively from theorem 1 2 example 3 9 continuing the previous example in the special case m 2 we conclude from theorem 1 2 that cs 2 1 q 1 q s 1 16 in particular the number of s 2 s 1 core partitions into k distinct parts is s 1 k less generally as observed in 18 there are 2 s 1 many s 2 s 1 core partitions into distinct parts 11 remark 3 10 example 3 9 suggests that there is a natural correspondence of compositions of s and s 2 s 1 core partitions into distinct parts indeed let us briefly describe a bijection between compositions of s into k parts and s 2 s 1 core partitions into k 1 distinct parts given a partition the corresponding composition 1 2 k of s is defined as follows consider the s abacus of and let 1 0 be the number of empty columns before the first bead then we define j 1 for j 1 2 k 1 depending on the location of the jth bead in the abacus a if the jth bead is the only bead in its columns then j 1 is 1 more than the number of empty columns following that bead b if the jth bead is the first of two beads in its columns then j 1 1 c if the jth bead is the second of two beads in its columns then j 1 is the number of empty columns following that bead note that the size 1 k of the resulting composition is exactly s the number of columns in the s abacus of we leave it to the interested reader to confirm that this correspondence is indeed a bijection 4 maximum number of parts and partitions with maximal initial gaps the correspondence with abaci makes certain properties of s core abaci conveniently accessible for instance we can readily deduce the maximum number of parts of the s core partitions featured in theorem 1 2 lemma 4 1 let mds m r be the maximum number of parts of s ms r core partitions into d distinct parts let d m 1 if 1 r d and s 1 then mds m r s d 1 m 0 if r 1 and s 0 1 mod d 1 1 otherwise 17 likewise if r 1 and s 2 then mds m 1 s d 1 m 1 if d 1 and s 0 mod 2 0 otherwise if s 0 1 2 mod d 1 1 otherwise proof observe that by definition mds m r deg c d s m r q the claim could therefore be deduced inductively from theorem 1 2 together with the initial conditions in lemma 3 6 instead in lemma 4 2 we provide a combinatorial argument that explicitly constructs a par tition with the maximum number of parts or equivalently the corresponding s core abacus the second part of our claim the case r 1 follows from using mds m 1 m d s m 1 s 1 in lemma 4 2 note that by lemma 2 4 the definition of mds m r in lemma 4 2 agrees with the definition in lemma 4 1 if 1 r d or if r 1 12 lemma 4 2 let mds m r be the maximum number of beads of an abacus in a d s m r let d m 1 if s r 1 then 17 holds if s r 1 then mds m r s d 1 m r 2 d 1 1 18 proof since the maximum number of beads is always achieved by an abacus with a bead in position 1 we assume in the sequel that there is a bead in position 1 since there are s 2 further positions in the first row the maximum number of beads in the first row of an abacus in ads m r is 1 s 2 d 1 19 observe that each of the m 1 subsequent rows can be filled with up to s d 1 many beads note that 19 either equals s d 1 or exceeds it by 1 the former case happens precisely if s 0 1 modulo d 1 this proves 17 in the case r 1 in the case that 19 equals s d 1 the m 1 st row may be filled with 1 bead in position ms 1 plus an additional r 2 d 1 beads in the case that 19 exceeds s d 1 by 1 then the second column is empty except for a bead in the first row the m 1 st row may be filled with r 2 d 1 beads in either case we find that the maximum total number of beads is 18 for comparison let us consider ms t the maximum number of parts of an s t core partition without any restriction on its parts equivalently ms t is the largest part of an s t core parti tion the following is a corollary of sylvester s theorem on the frobenius problem we refer to 7 chapter 1 for a beautiful exposition lemma 4 3 for coprime s t 1 we have ms t 1 2 s 1 t 1 proof as discussed in section 2 we can identify partitions with the set a of their first column hook lengths these are precisely the positions of beads in the corresponding abaci note that a is the number of parts of by lemma 2 1 is s core if and only if s h a implies that h s a it follows that if is s 1 sn core then a is a subset of the set f s 1 sn of positive integers which cannot be written as a nonnegative linear combination of s 1 sn moreover the set f s 1 sn itself corresponds to a s 1 sn core partition it was shown by sylvester 7 theorem 1 3 that f s t s 1 t 1 2 proving our claim it is considerably more difficult to obtain the maximum size of core partitions in this direction we only mention the following well known result of olsson and stanton 14 theorem 4 4 suppose s and t are coprime the maximum size of an s t core partition is s 2 1 t 2 1 24 20 13 recall that cds m r is the set of s ms r core partitions into d distinct parts the enumerations in theorem 1 2 are based on a recursive description in s with m as well as r and d fixed note that cs m r cs m 1 r in the remainder of this section we observe another way in which cs m r is naturally embedded in cs m 1 r we say that the initial gap of an integer partition 1 2 with 1 2 is the difference 1 2 of the first and second part if a partition is s core then all the gaps between the parts of are strictly less than s we say that a s 1 s 2 core partition has maximal initial gap if has initial gap min s 1 s 2 1 let gds m r be the set of partitions c d s m r with maximal initial gap together with the empty partition in other words gds m r consists of those c d s m r such that if has a first part 1 then it has a second part 2 and 1 2 s 1 lemma 4 5 let s m 1 if 1 r d or r 1 then there is a natural 1 1 correspondence between s ms r core partitions into d distinct parts with maximal initial gap and s m 1 s r core partitions into d distinct parts proof the claimed bijective correspondence gds m r c d s m 1 r is given by the map 1 2 3 7 2 3 with the understanding that the empty partition is sent to itself corollary 4 6 in particular if 1 r d or r 1 we get an enumeration of s ms r core partitions into d distinct parts with maximal initial gap from theorem 1 2 example 4 7 the number of s 3 s 1 core partitions into k distinct parts with maximal initial gap is s 1 k 1 this follows from the bijective correspondence between g 1 s 3 1 and c 1 s 2 1 indeed for the latter as noted in 16 the generating polynomial for the number of parts of s 2 s 1 core partitions into distinct parts is cs 2 1 q 1 q s 1 it was this example that initially motivated the present paper 5 average number of parts in this section we indicate that our results on the enumeration of certain s t core partitions can be used to obtain explicit formulas for the averge number of parts of these partitions determining the average size of core partitions has received considerable attention in recent years in particular johnson 11 proved the following result which had been experimentally observed and conjectured by armstrong 5 conjecture 2 6 and which should be compared with 20 theorem 5 1 suppose s and t are coprime the average size of an s t core partition is s 1 t 1 s t 1 24 21 the case s t s s 1 had been established by stanley and zanello 17 on the other hand employing results by ford mai and sze 9 on self conjugate core partitions chen huang and wang 8 showed that the average size of a self conjugate s t core partitions is also given by 21 14 xiong 19 proved the following result for s s 1 core partitions into distinct parts which had been conjectured by amdeberhan 1 theorem 5 2 the total sum of the sizes of s s 1 core partitions into distinct parts is i j k s 1 i j k 1 f ifjfk 22 note that the total sum 22 divided by the number fs 1 of such partitions gives the average size of s s 1 core partitions into distinct parts also note that by general properties of constant recursive sequences the convolution sum 22 of fibonacci numbers can expressed in the simpler but possibly less illuminating form 1 50 5 s 7 sfs 1 6 s 1 fs this result was generalized by zaleski 22 to higher moments of the sizes of s s 1 core partitions into distinct parts in subsequent work zaleski 23 also considered moments of the sizes of s ms 1 core partition into distinct parts for recent results on the largest sizes of s ms 1 core partitions into distinct parts we refer to 20 as in theorem 1 2 let fs q c d s m r q denote the generating polynomial for the number of parts of s ms r core partitions into d distinct parts clearly ns fs 1 is the number of these partitions on the other hand note that ps f s 1 is the total number of parts of these partitions we therefore obtain the following result as a consequence of theorem 1 2 corollary 5 3 suppose the conditions of theorem 1 2 hold then ps the total sum of the numbers of parts of s ms r core partitions into d distinct parts satisfies ps ps 1 mps d 1 m 1 2 ns d 1 note that ps ns is the average number of parts of these partitions since the ns are constant recursive by theorem 1 2 it follows that the ps are constant recursive as well we illustrate this in the particularly pleasing cases of s s 1 core partitions into distinct parts in which case ns fs 1 as well as s 2 s 1 core partitions into distinct parts in which case ns 2 s 1 as noted in example 3 9 corollary 5 4 the total sum of the numbers of parts of s s 1 core partitions into distinct parts is i j s i j 1 f ifj 1 5 2 sfs 1 s 1 fs 23 observe the surprising similarity of 23 with 22 the total sum of the sizes of s s 1 core partitions into distinct parts corollary 5 5 the total sum of the numbers of parts of s 2 s 1 core partitions into distinct parts is s 1 2 s 2 the number of these partitions is 2 s 1 likewise the higher moments for the number of parts of s ms r core partitions into d distinct parts can be obtained from higher derivatives of the generating polynomial fs q c d s m r q 15 6 conclusion under certain restrictions on s and t we have determined the generating polynomials fs t q for s t core partitions into d distinct parts where q keeps track of the number of parts it would be desirable but appears difficult to prove enumeration results for general s and t it would also be desirable but again appears difficult to be able to incorporate the sizes of the partitions in the generating polynomials more generally it is natural to ask whether we can include additional statistics besides the number of parts to the enumeration results for core partitions see for instance the final section of 15 for a discussion of including the bounce statistic on s ms 1 core partitions the natural question whether anderson s 2 result 1 that the number of s t core partitions is given by the generalized catalan numbers can be similarly extended to keep track of additional statistics like the number of parts leads to intriguing and surprisingly difficult open problems for instance it is an open problem proposed by dennis stanton see 5 to find a statistic stat on s t core partitions such that for coprime s and t qstat 1 s t q s t s q 24 where the sum is over all s t core partitions and where the right hand side are the usual q analogs interestingly armstrong hanusa and jones 5 conjecture 2 8 provide a conjectural candidate for such a statistic which is the sum of n the number of parts of plus a second nonnegative statistic m the skew length of anderson established 1 by exhibiting a bi jection between the set of s t core partitions and the set of s t dyck paths lattice paths from one corner of a s t rectangle to the opposite corner which stay above the diagonal connecting these corners in particular statistics on core partitions can be obtained from statistics on dyck paths as an indication that proving 24 a q analog of anderson s enumeration 1 is a difficult problem we mention that even the nonnegativity of the coefficients of the generalized q catalan numbers on the right hand side of 24 is nontrivial and that no elementary proof is known on the other hand in the words of 5 the conjecture that 24 holds for stat n m is just a shadow from the more general subject of q t catalan combinatorics below we will use the letter x in place of t a particularly appealing general conjecture is that qn xm qm xn 25 where both sums are over s t core partitions for coprime s and t here the left hand side defines the q x catalan numbers for more details and further references we refer to 5 as well as 10 where special cases of the symmetry 25 are proved as noted in example 3 9 it follows from cs 2 1 q 1 q s 1 that the number of s 2 s 1 core partitions into k distinct parts is s 1 k less generally as observed in 18 there are 2 s 1 many s 2 s 1 core partitions into distinct parts on the other hand yan qin jin zhou 21 zaleski zeilberger 24 baek nam yu 6 and paramonov 15 show that for odd s the number of s s 2 core partitions into distinct parts is 2 s 1 as well in our notation 2 cs 1 2 1 2 s 1 26 16 it would be interesting to determine an explicit formula for cs 1 2 q cn s q n a q analog of 26 and thus obtain the number of such partitions into k parts limited numerical data suggests that cn s for s n is a polynomial in s of degree n acknowledgements we thank huan xiong for sending a preprint of 20 and for mentioning zaleski s conjectures 23 on the moments of the size of an n dn 1 core partition into distinct parts references 1 t amdeberhan theorems problems and conjectures preprint july 2015 arxiv 1207 4045 updated version available at http math tulane edu tamdeberhan conjectures html 2 j anderson partitions which are simultaneously t 1 and t 2 core discrete mathematics 248 1 3 237 243 apr 2002 3 g e andrews the theory of partitions addison wesley 1976 4 g e andrews and k eriksson integer partitions cambridge university press 2004 5 d armstrong c r h hanusa and b c jones results and conjectures on simultaneous core partitions european journal of combinatorics 41 205 220 oct 2014 6 j baek h nam and m yu a bijective proof of amdeberhan s conjecture on the number of s s 2 core partitions with distinct parts discrete mathematics 341 5 1294 1300 2018 7 m beck and s robins computing the continuous discretely integer point enumeration in polyhedra springer new york 2007 8 w chen h huang and l wang average size of a self conjugate s t core partition proceedings of the american mathematical society 144 4 1391 1399 2016 9 b ford h mai and l sze self conjugate simultaneous p and q core partitions and blocks of an journal of number theory 129 4 858 865 apr 2009 10 e gorsky and m mazin compactified jacobians and q t catalan numbers ii journal of algebraic combinatorics 39 1 153 186 2014 11 p johnson lattice points and simultaneous core partitions the electronic journal of com binatorics 25 3 p 3 47 19 p 2018 12 n kravitz on the number of simultaneous core partitions with d distinct parts discrete mathematics 342 12 2019 13 r nath and j a sellers abaci structures of s ms 1 core partitions the electronic journal of combinatorics 24 1 p 1 5 20 p 2017 14 j b olsson and d stanton block inclusions and cores of partitions aequationes mathemat icae 74 1 2 90 110 sept 2007 17 http arxiv org abs 1207 4045 http math tulane edu tamdeberhan conjectures html 15 k paramonov cores with distinct parts and bigraded fibonacci numbers discrete mathe matics 341 4 875 888 2018 16 m sahin core partitions with d distinct parts australasian journal of combinatorics 72 1 19 28 2018 17 r p stanley and f zanello the catalan case of armstrong s conjecture on simultaneous core partitions siam journal on discrete mathematics 29 1 658 666 jan 2015 18 a straub core partitions into distinct parts and an analog of euler s theorem european journal of combinatorics 57 40 49 2016 19 h xiong core partitions with distinct parts the electronic journal of combinatorics 25 1 p 1 57 10 p 2018 20 h xiong on the largest sizes of certain simultaneous core partitions with distinct parts european journal of combinatorics 71 33 42 june 2018 21 s h f yan g qin z jin and r d p zhou on 2 k 1 2 k 3 core partitions with distinct parts discrete mathematics 340 6 1191 1202 2017 22 a zaleski explicit expressions for the moments of the size of an s s 1 core partition with distinct parts advances in applied mathematics 84 1 7 mar 2017 23 a zaleski explicit expressions for the moments of the size of an n dn 1 core partition with distinct parts integers 19 a 26 11 p 2019 24 a zaleski and d zeilberger explicit expressions for the expectation variance and higher moments of the size of a 2 n 1 2 n 3 core partition with distinct parts journal of difference equations and applications 23 7 1241 1254 2017 18 1 introduction 2 preliminaries and s core abaci 3 s core abaci of bounded height 4 maximum number of parts and partitions with maximal initial gaps 5 average number of parts 6 conclusion