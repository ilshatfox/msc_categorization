distinct angle problems and variants henry l fleischmann hongyi b hu faye jackson steven j miller eyvindur a palsson ethan pesikoff and charles wolf abstract the erdo s distinct distance problem is a ubiquitous problem in discrete geometry less well known is erdo s distinct angle problem the problem of finding the minimum number of distinct angles between n non collinear points in the plane the standard problem is already well understood however it admits many of the same variants as the distinct distance problem many of which are unstudied we provide upper and lower bounds on a broad class of distinct angle problems we show that the number of distinct angles formed by n points in general position is o nlog 2 7 providing the first non trivial bound for this quantity we introduce a new class of asymptotically optimal point configurations with no four cocircular points then we analyze the sensitivity of asymptotically optimal point sets to perturbation yielding a much broader class of asymptotically optimal configurations in higher dimensions we show that a variant of lenz s construction admits fewer distinct angles than the optimal configurations in two dimensions we also show that the minimum size of a maximal subset of n points in general position admitting only unique angles is n 1 5 and o nlog 2 7 3 we also provide bounds on the partite variants of the standard distinct angle problem contents 1 introduction 2 1 1 background 2 1 2 summary of results and methods 2 2 erdo s angle problems 4 2 1 unrestricted point sets 4 2 2 no three collinear points 5 2 3 restricting cocircularity 5 2 4 general position no three points on a line nor four on a circle 7 3 the robustness of efficient point configurations 9 4 the pinned angle problem 11 5 partite sets 12 6 maximal subsets of points with distinct angles 14 6 1 definitions and upper bounds 14 6 2 a probabilistic lower bound on maximal distinct angle subsets in general position 14 7 higher dimensions lenz s construction 17 8 future work 20 references 21 date august 30 2021 2020 mathematics subject classification 52 c 10 primary 52 c 35 secondary 52 c 30 52 b 15 52 b 11 key words and phrases erdo s problems discrete geometry angles restricted point configurations maximal subsets this work was supported by nsf grant 1947438 and williams college e a palsson was supported in part by simons foun dation grant 360560 1 ar x iv 2 10 8 12 01 5 v 1 m at h c o 2 6 a ug 2 02 1 1 introduction 1 1 background in 1946 erdo s published a paper titled on sets of distances of n point introducing the problem of finding asymptotic bounds on the minimum number of distinct distances among sets of n points in the plane 8 this simply stated problem proved to be surprisingly challenging and is now known as the erdo s distance problem indeed the original question was only finally resolved by guth and katz in 2015 16 over time many variations of the problem were introduced restricting the point sets studying subsets with no repeated distances and many other quantities we study variations of a related problem introduced by erdo s and purdy 15 what isa n the minimum number of distinct angles formed by n not all collinear points on the plane unlike in the distance setting an extra restriction of non collinearity is required to prevent the degenerate case of at most two angles when this problem was proposed the regular n gon was conjectured to be optimal yielding n 2 angles and a lower bound of n 2 2 angles was proven for point sets without three collinear points since then the problem and all other analogues of distinct distance problems with angles have gone untouched we study this problem of distinct angles in many of the settings originally considered for distinct distances providing exact or asymptotic bounds depending on the problem we summarize our results below 1 2 summary of results and methods note that throughout unlike erdo s we do not count angles of 0 or to avoid some degenerate behaviors this is consistent with the current literature on related repeated angle questions see for example 21 1 2 1 erdo s angle problems we begin with the most natural extension of the erdo s distance problems to angles what is the least number of distinct angles determined by n not all collinear points in the plane given that the known low angle constructions contain obvious structures such as many points on a line or on a circle it is natural to also consider the problem over restricted point sets our main results in this section are summarized in the following we provide a construction of a polygon projected onto a line yielding a point configuration with no four points on a circle admitting n 2 distinct angles the same as the conjectured optimal regular n gon we also provide a point configuration in general position admitting less than cnlog 2 7 for some constant c the first nontrivial bound for this problem the configuration relies on enumerating classes of triangle equivalent up to edge translation and then projecting onto a generic plane while 14 and 11 also use a projection onto a generic plane for the distance problem analogue the properties of orthogonal projections are much more convenient for distances attempting to directly apply their results fails in a dramatic fashion due to additional complexity added by angles in addition for completeness we provide a known upper bound on a n of n 2 from the regular n gon conjectured by erdo s and purdy to be the optimal configuration and a lower bound of n 6 by partial progress towards the weak dirac conjecture of erdo s and dirac we also consider similar problems on restricted point sets as in the distance setting under a restriction forbidding three points on a line we provide bounds on the restricted quantity ano 3 l n these were known by erdo s 1 2 2 the robustness of efficient point configurations having identified efficient point configurations in the polygon and the projected polygon we ask how resilient they are to perturbation erdo s investigated a similar question for distances in 9 we prove combinatorially the surprising result that both the polygon defines 1 o nk angles with k points perturbed so long as they all remain on the circle and we prove an analogous result for the projected polygon consequently if any constant number of points in a regular polygon are moved to random positions on the circle the construction still defines o n angles an optimal 1 we write f o g if there exists constant c such that f n cg n for sufficient large n conversely we write f g if g o f lastly we write f g if f o g and f g 2 number asymptotically even though moving even one point off the circle experimentally gives a super linear number of distinct angles in that vein we provide conjectures about the number of angles in several perturbed optimal configurations in which points may no longer lie exactly on a circle or line 1 2 3 the pinned angle problem we subsequently examine the angle equivalent of a prominent erdo s distance problem namely given n points what is the minimum number of distances determined between one pinned point and the rest in the worst case this problem remains open in the distance setting for convex configurations of points and is conjectured to be bn 2 c by erdos in 8 an upper bound of bn 2 c is obtained by considering the regular n gon and the current best lower bound of 13 36 1 22701 n o 1 is obtained by nivasch pach pinchasi and zerbib 7 denoting the analogous angular quantity allowing any configuration of points as a n with the pinned point as the center point of the angles we bound it between n 6 and n 2 using related a n proofs this in turn also provides an upper bound on a n the sum of the number of distinct angles determined by each point 1 2 4 partite sets given a partite set the question of distances determined between the two sets has been studied by elekes 6 in the unrestricted setting but remains unsolved in general we ask the analogous question in the angular setting how many angles are defined by a k partite set where each point is in a distinct set we provide low angle configurations in the unrestricted case establish linear lower and upper bounds on partite sets without three collinear points and completely solve the problem in a particular case 1 2 5 maximal subsets of points with distinct angles one prominent variation of the erdo s distance prob lem asks what is minimum maximal subset of n points such that no distance is repeated none of the numerous variants in the distance setting have been fully resolved although a number of upper and lower bounds have been proven by a variety of authors for a complete picture of these problems in the distance setting see 1 3 18 12 15 we ask the analogous question for angles we upper bound this configuration in general showingr n a n 1 3 then we employ a probabilistic method similar to that in 3 to show a lower bound of n 1 5 1 2 6 higher dimensions lenz s construction the construction consists of multiple unit circles each in a disjoint pair of dimensions we show that just as it has been for repeated angle problems in higher dimen sions and the unit distance problem lenz s construction also provides a good upper bound of 2 d 2 n de 2 onad n the least number of distinct angles defined by n points in d dimensions see page 499 of 1 this construction demonstrates that for a fixed number of points increasing the dimension decreases the upper bound on the number of distinct angles dramatically this behavior aligns with the behavior in the distance setting with the integer lattice we also provide a higher dimensional upper bound for the maximal subset question variant lower bound upper bound a n n 6 n 2 ano 3 l n n 2 2 n 2 ano 4 c n n 6 n 2 agen n n o n log 2 7 a n n 6 n 2 a n n 6 n 1 3 n 6 rgen n n 1 5 o nlog 2 7 3 ad n 2 2 d 2 n de 2 table 1 summary of results 3 we provide a tabular summary of our results in this section for convenience each parameter is described informally in table 1 but formally defined in its respective section we note several other miscellaneous bounds over the course of the paper but do not include them here because we only provide an upper or lower bound or they do not fit nicely into the structure of the table these include variants of angle sum bounds in section 4 partite set bounds in section 5 and maximal subset bounds in non general position in section 6 to name a few 2 erdo s angle problems 2 1 unrestricted point sets we begin by considering the most broad non trivial version of the distinct angles problem this is the version of the problem originally posed by erdo s 15 definition 2 1 for a point set p r 2 let a p denote the number of distinct angles in 0 determined by points in p then let a n min p n a p where p is not all collinear we begin by showing a n n with explicit upper and lower bounds first we give an upper bound using the regular polygon lemma 2 2 a n n 2 proof consider the point configuration given by the vertices of an n sided regular polygon upon inscribing the polygon in a circle notice that distinct angles are in bijection to the arclengths on the circle we may fix a point as the central point of our angles by the symmetry of the polygon there are then exactly n 2 possible arc lengths subtending angles with this central point remark 2 3 when n is odd we may alternatively use an n 1 gon with an extra point in the center adding the center point to an even regular polygon does not increase the number of nonzero angles defined and so if n 2 m 1 we achieve a slightly better bound a 2 m 1 2 m 2 we now use progress on the weak dirac conjecture to provide a lower bound on a n in 1961 based on a stronger conjecture of dirac s erdo s conjectured in 10 the following conjecture 2 4 weak dirac conjecture every set p of n non collinear points in the plane contains a point incident to at least dn 2 e lines of l p where l p is the set of lines formed by points while the weak dirac conjecture is open significant progress has been made let n be the largest proven lower bound proven for the weak dirac conjecture i e every set p of n points not on a line in the plane contains a point incident to at least n lines of l p then we have the following theorem 2 5 for n 3 a n n 1 2 n 6 proof fix a set p of n non collinear points in the plane let p p be incident to at least n lines of l p fix another point q note that for any fixed nonzero angle there are exactly two possible lines where r must lie on for qpr since p is incident to n 1 lines without q p is the center angle of at least n 1 2 distinct angles therefore a n n 1 2 we have n dn 3 e 1 from 17 as such we have a n n 6 as desired notably this argument is known see conjecture 10 in 6 2 of 1 but is included for completeness 4 2 2 no three collinear points given that any collinear point set defines at most two angles it is intu itively clear why restricting the number of collinear points might result in interesting behavior we briefly consider such point sets in this section definition 2 6 let ano 3 l n min p na p where p contains no collinear triples note that the regular n gon contains no collinear triples and so as with a n we have an upper bound of ano 3 l n n 2 the usual stipulation on this bound holds see remark 2 3 our restrictions on the point set allow for a stronger lower bound this bound was known by erdo s but is included for completeness lemma 2 7 for n 3 ano 3 l n n 22 proof fix a point p p as no three points are on a line p determines n 1 distinct lines with each of the other points the result follows by fixing another point q and repeating the argument for theorem 2 5 we can easily generalize this restriction to no k points on a line however the lower bound given by repeating this argument with k 4 points on a line is always weaker than that in theorem 2 5 moreover in those cases the regular polygon remains an upper bound 2 3 restricting cocircularity since the regular polygon construction requires many points on a circle it is natural to wonder how the bounds change when we require that no four points lie on a circle this setting is not specifically studied in the context of distances but merits special attention for angles given the seeming optimality of the regular n gon we provide the following definition definition 2 8 let ano 4 c n min p na p where p contains no co circular quadruples we then have the following lemma lemma 2 9 for n 3 ano 4 c n n 2 proof consider the vertices of a regular n gon fix a vertex p then if n is even there is a vertex q directly opposite p in that case let be the line perpendicular to pq if n is odd there are instead two vertices of minimal distance from p in that case let instead be the line those two vertices then for each vertex r other than p in the regular n gon project r onto at the intersection of pr and this is the stereographic projection of the points onto via p let the n 1 projected points on and p define the projected polygon configuration p note that p contains no four cocircular points figure 1 we can now count the number of angles in this configuration let n the angle subtended by an arc between consecutive points in a regular n gon note that the angles formed in the case of p being the center of the angle are exactly the n 2 angles of a regular n gon i i n for 1 i n 2 next we count angles of the form pqiqj where qi and qj lie on line we do not consider when all three points are on as that forms degenerate angles we may assume that qi and qj are both on the same half of the line by the reflectional symmetry of the configuration we consider two cases i j or i j suppose first that n is even then there will be a point q 0 at the center of the line first we count angles with i j notice that pqiqj pqiq 0 the other two angles in 4 pqiq 0 are i and 2 so pqiqj 2 i n n 2 i for 1 i n 2 2 since n is even these are integer multiples of moreover since 1 n 2 i n 2 angles of this form are already accounted for in the angles with center p next we examine the case of i j then 0 i n 2 1 except for the angle with center at q 0 which has value 2 accounted for already 5 figure 1 projecting regular polygons onto a line in case 1 all these angles are the supplements of angles i j that is pqiqj pqiq 0 thus we achieve angles of n 2 i n 2 i n where 1 i n 2 2 all these angles are also accounted for in the case of angles with p as the center so when n is even we have n 2 distinct angles now suppose n is odd in this case there will not be point q 0 opposite p and on but we introduce one that is not in the configuration for later convenience as before we first count angles with i j there is a special angle that we will add to this count namely pq 1 q 1 then in effect we are considering angles pqiq 0 for i 0 as in the odd case each of these angles is in the triangle 4 pq 0 qi whose other angles are 2 and i 2 for 1 i n 1 2 then pqiqj 2 i n 2 n dn 2 e i n this is an integer multiple of n and further 1 dn 2 e i n 2 thus all these angles are already accounted for in case 1 next we examine the case of i j then 1 i n 3 2 all these angles are the supplements of angles i j that is apipj apip 0 thus we achieve angles of dn 2 e i n 2 i n where 1 i n 1 2 all these angles are also accounted for in case 1 and so when n is odd we have n 2 distinct angles therefore this configuration determines exactly n 2 angles remark 2 10 the projected polygon construction and the regular polygon both give n 2 angles for n points the former contains collinear points but no four points on a circle while the latter contains the opposite 6 additionally there are infinitely many such one point off the line configurations yielding cn angles for some c fix n 1 fix some p and some line space the remaining n 1 points on such that rps for consecutive r and s on this configuration forms at most 3 n angles in general we revisit this in section 3 note that theorem 2 5 provides a lower bound of n 6 distinct angles here as well 2 4 general position no three points on a line nor four on a circle now that we have illustrated con structions determining o n angles that forbid either three points on a line or four points points on a circle we consider configurations that forbid both erdo s and others have investigated this problem extensively in the distance setting while the best known lower bound in the distance setting is trivially n the best known upper bound is n 2 o logn from 11 in this section we provide a nontrivial upper bound on this quantity definition 2 11 let agen n min p n a p where p is in general position we use a construction inspired by the projective construction in theorem 1 of 14 to provide an upper bound we take higher dimensional hypercubes and project their points down to a generic plane unlike with distances we have very little control over the triangles in the projection as such we proceed by very careful combinatorics let qd be the d dimensional hypercube with vertices of the form p x 1 x 2 xd and xi 0 or 1 for each i for any 2 dimensional plane in rd let t be the orthogonal projection of the points in qd onto it is possible to choose satisfying the followingl conditions 1 t p 1 t p 2 if and only if p 1 p 2 and 2 p t qd is in general position in addition since orthogonal projections are self adjoint and idempotent we have p 1 p 2 p 3 p 4 d t p 1 t p 2 d t p 3 t p 4 2 1 by the following computation t p 1 p 2 t p 1 p 2 p 1 p 2 t t p 1 p 2 p 3 p 4 t p 1 p 2 t p 3 p 4 p 1 p 2 t t p 3 p 4 p 3 p 4 t p 3 p 4 t p 3 p 4 unfortunately t does not preserve the distance between points in qd that is d p 1 p 2 d p 3 p 4 6 d t p 1 t p 2 d t p 3 t p 4 this means two congruent triangles in qd need not be congruent after projection however by 2 1 and sss congruence two congruent triangles with equal difference vector edges remain congruent after projec tion this inspires the following definition definition 2 12 given a triangle with vertices inqdd define the equivalence class qd as the set of all triangles congruent to whose vertices lie in qd and edges correspond to individually translated copies of the edges of it suffices to characterize the equivalence classes of translated congruent triangles in qd to bound the number of angles in p we do so in the following lemma 7 lemma 2 13 the number of equivalence classes of triangles in qd is 7 d 3 d 1 2 12 proof we begin by counting the number of unordered triples of distinct binary k tuples such that no coor dinate of the triple is fixed for all three by fixed we mean equal among all three k tuples let ak denote the number of such triples at each coordinate in the triple of k tuples the possible values for each of the triples are 0 or 1 since no coordinate of the triples is fixed each coordinate must either have exactly one 1 or one 0 among the three k tuples there are then 3 2 k ways to choose whether there will be one 1 or one 0 and the choice of tuple for that singleton for each of the k coordinates this imposes an ordering which we divide out at the end now note that although it is impossible to repeat a k tuple thrice since no coordinate is fixed we overcount instances with a repeated k tuple a k tuple can be chosen to repeat twice in 2 k ways and the choice of repeated k tuple forces the choice of the third k tuple such triples can be ordered in 3 ways after subtracting off such pairs the remaining triples are all distinct and thus can be ordered in 3 ways we have ak 6 k 3 2 k 6 now we use ak to count tk the number of triangles in qd with exactly k unfixed coordinates as there are d k ways to choose the unfixed coordinates ak ways to choose the values in those unfixed coordinates and 2 d k ways to choose the values of the fixed coordinates we get tk 6 k 3 2 k 6 d k 2 d k d k 6 k 2 d k 3 2 d 6 finally we prove that all triangles in the same equivalence class have the same number of fixed coor dinates we also prove that the size of the equivalence class of triangles with a given number of fixed coordinates is constant first observe that given a triangle in qd we may get an equivalent triangle by flipping any combination of its fixed coordinates from 0 to 1 or vice versa thereby translating each vertex of the triangle by the same amount moreover if a coordinate is not fixed then any translation to a equivalent triangle cannot be nonzero in that coordinate as it would then lead to some point having a coordinate that is both nonzero and not one the only other way to achieve an equivalent triangle is to translate the edges individually keeping the difference vectors corresponding to them identical but altering their relative orientations this can happen in at most one way moreover flipping each coordinate of each of the three points yields a congruent triangle composed of the same difference vectors by flipping we mean changing from 0 to 1 and vice versa this follows from the observation that if a coordinate in a difference vector is 0 the subtracted coordinates must be equal and remain equal under swapping each coordinate if a coordinate is 1 or 1 it will swap sign but still be the same vector thus we have that the size of the equivalence class of each triangle with k unfixed points in a qd is exactly 2 d k 1 moreover all triangles in the equivalence class have exactly k unfixed points 8 putting this all together we have that the number of equivalence classes of triangles in qd is d k 1 d k 6 k 2 d k 3 2 d 6 2 d k 1 d k 1 d k 6 k 12 2 k 2 1 12 d k 1 d k 6 k 3 d k 1 d k 2 k 7 d 12 1 12 3 d 4 1 4 7 d 3 d 1 2 12 the above follows from standard binomial formula identities since triangles in the same equivalence class are congruent under the projection from qd to a specially chosen generic plane lemma 2 13 provides an upper bound ofo 7 d distinct angles on point configurations in general position with 2 d points to establish this result for n not a power of two pick the least d such that n 2 d and apply the upper bound to a subset of n vertices in qd this proves the following theorem theorem 2 14 agen n o nlog 2 7 3 the robustness of efficient point configurations before we consider several variants of this problem we discuss a very natural question how far can point sets stray from our best constructions regular polygons and projected polygons while still being near optimal in the distance setting a point set is called near optimal if it admits o n log n angles like the n n integer lattice erdo s asked if such sets have lattice like structure containing n 1 2 points on a line the question has gone unsolved even after replacing 1 2 by any 0 for some partial results related to this problem see 24 23 and 22 in which the authors bound the number of points on various algebraic curves in near optimal point sets formally we have the following definition definition 3 1 let p 1 p 2 r 2 be a sequence of point configurations with pn n then pn is near optimal if a pn o n for example the sequence of point configurations of regular n gons is near optimal perhaps surprisingly these configurations are reasonably robust to point perturbation we begin by studying points on a circle in a way reminiscent of a regular n gon proposition 3 2 for a fixed k 0 let skn be the collection of n points on a circle with n k points forming a regular n k gon and the remaining k placed arbitrarily then max p skn a p nk proof fix a configuration p skn since points in p lie on a circle all its angles are incident angles thus the number of distinct angles is bounded by the number of distinct arc lengths we divide the set of arcs into three cases suppose an arc is the minor one formed between p q p we then have the following cases 1 both p q are on the polygon there are at most n k 2 distinct arc lengths of this form 2 neither of p q are on the polygon then they are among the k arbitrarily placed points there are at most 2 k 2 k 2 k distinct arc lengths of this form 3 we have p is on the polygon and q is not there are at most 2 n k k 2 nk 2 k 2 distinct arc lengths of this form 9 then in total p determines at most 2 nk k 2 n 2 k 2 angles since k n this quantity is o nk we show that this bound is tight choose the k points to be placed at multiples of 2 between n k 1 n k 2 and 2 such that all arcs formed with the added point are iteratively not admitted among the points in the configuration then there are n k 2 arcs between the point at n k 1 n k 2 and the other non zero polygonal points moving clockwise about the circle notably they can be extended by 1 to k arcs by the choice of these arcs for any length rational arc chosen all the extensions by 1 to k arcs are distinct thus at least n k 2 k nk distinct angles are formed as the ends of the arc can be used as the end points of an angle with 0 as the center from this it follows that such configurations are near optimal for any k constant in n we now discuss a related more challenging problem let t kn be the collection of n point configurations having n k points on a circle and no circle containing more denote by t n the maximum quantity k n 2 satisfying min p t kn a p n what can be said about the value of t n we restrict k to n k n in order to avoid cases that reduce to configurations with a negligible number of points on a circle consider a new point at the center of a regular n gon when n is even the new point generates no new angles see remark 2 3 when n is odd it generates exactly dn 2 e additional angles to see this say n 2 m 1 one new angle of 4 m 2 m 1 is from the angle whose center is at the new point and the ends at the original n gon another n more angles of i n 2 n for 1 i n are from those with the new point as an end point they are equivalent to the original arcs on the n gon with half of the 2 n arc cut out thus t n 1 we conjecture this bound to be tight and this point in the center is the only way to achieve it conjecture 3 3 t n 1 the aforementioned optimal point configuration the projected polygon has n 1 points be on a line to what extent can we perturb this configuration while remaining near optimal proposition 3 4 for a fixed k 0 let lkn be the collection of planar n point configurations with with n k including the off line point in the projected polygon construction from lemma 2 9 and the remaining k placed on the line arbitrarily then max p lkn a p nk proof we may divide the possible angles into four cases observe an angle pqr in the following cases 1 say q is the point off the line and p r are both projected points then the number of such angles is bounded by the number of angles in the projected polygon construction n k 2 2 say q is the point off the line and neither of p r are projected points then the number of angles in this case is bounded by k 2 k 2 k 2 3 say q is the point off the line p is a projected point and r is not without loss of generality then the number of such angles is this bounded by n k 1 k 4 say q is on the line then all nontrivial pqr have one leg along the line and the other at the point off the line thus for each q on the line there are at most two possible angles and they are supplementary amongst themselves then the number of these angles is bounded by 2 n 1 then in total we o nk distinct angles formed now we show this bound is tight choose the k points to be placed following the rightmost point on the line such that the angles they form with the point off the line as the center are all unique we can do this 10 iteratively by the infinitude of the real line then by construction there are at least k i 1 n k i 1 k n k k 2 nk distinct angles in the configuration counting only angles centered at the point off the line from this if follows that such configurations are near optimal for any k constant in n now we consider the quantity analogous to t n letmkn be the collection of all n point configurations having n k points on a line and no lines containing more denote by m n the maximum k satisfying min p mkn a p n what can be said about the value of m n it is immediate that m n 1 by the projected polygon in addition from remark 2 10 there are many other near optimal configurations inmkn consider a new point that is the original point off the line reflected over the line it generates o n additional angles thus m n 2 we conjecture this bound to be tight and the only pair of points to achieve this are those symmetric about the line conjecture 3 5 m n 2 4 the pinned angle problem we now pivot to a variant originally considered in the context of distinct distance problems among n points in the plane in the worst case what is the maximum number of distinct angles centered at some pinned point for example see corollary 6 in 19 for the original problem for distances definition 4 1 for a point set p and a point p in it letap p denote the number of distinct angles in 0 formed in p with p as the center then let a n min p n max p p ap p where p is a not all collinear planar point set theorem 4 2 we have a n n proof regular polygons give an upper bound of n 2 let n be the current best lower bound on the weak dirac conjecture see conjecture 2 4 using the same logic as theorem 2 5 this gives a lower bound of n 1 2 this is at least n 6 completing the proof this use of the weak dirac conjecture is known see conjecture 10 section 6 2 in 1 a related classical question for distinct distances is determining the average number of distinct distances admitted by a pinned point we present its analogy for angles here definition 4 3 let a n min p n p p ap p where p is a not all collinear planar point set theorem 4 4 we have a n 3 n 6 proof the construction from lemma 2 9 has one point off the line as the center of n 2 distinct angles all the points on the line apart from the endpoints are the center of exactly two non degenerate angles these contribute another 2 n 4 to the sum hence a n 3 n 6 we also have the following for a n this quantity forbidding three collinear points 11 theorem 4 5 we have a n n 2 proof since no three points are on a line we can repeatedly remove points and apply the bound from theorem 2 5 this gives n i c i 6 n 2 to get the upper bound use the fact that every point of a regular n gon is the center of exactly n 2 distinct angles 5 partite sets another well known variant of the distinct distances problem is that of distances between points in partite sets see 6 for example we introduce a similar problem for angles we make heavy use of the best lower bound of the weak dirac conjecture on n points n in this section as a reminder from 17 we have n dn 3 e definition 5 1 given bipartite p q r 2 denote by a p q the number of distinct angles in 0 whose central vertex lies in a different set than its two end points where p q is not all collinear let a m n min p m q n a p q for simplicity assume m n we begin by providing upper bounds on both unrestricted and restricted point sets lemma 5 2 we have a m n m proof we utilize the projected polygon construction from lemma 2 9 assign the point off the line q to be in q and the m leftmost points on the line in p notably the points in p do not cross the center point of the points on the line now the angles of the form p 1 qp 2 the angles with center in q form the angles i n m for 1 i m 1 let r be the rightmost point on the line from lemma 2 9 we have two cases for the the angles of the form qpir if n m is even they form the angles 2 j n m for n m 2 j n m 2 2 or for n m j 1 and these angles form an angle of 2 for pi the orthogonal projection of q onto the line in the case n m odd the angles qpir are 2 j n m 2 n m for n m 1 2 j n m 1 2 namely these angles are computed by completing the angles of the right triangle containing q pi and the orthogonal projection of q substituting the ranges of the angles for both we find that the only angles in the configuration are l n m for 1 l m implying the result note that this result implies that no unrestricted lower bound in terms of n m can exist next we provide an upper bound on the case of no three collinear points in p or q lemma 5 3 we have ano 3 l m n n 2 proof let p form a subset of the vertices of a regular n gon of sizem andq the vertices of a regular n gon both inscribed in the same circle the bipartite angles formed in this configuration are all incident angles subtended by arcs of the size subtending angles in a regular n gon thus the distinct angles formed in this configuration are a subset of the angles of a regular n gon implying the result from lemma 2 2 now we provide a lower bound in the restricted case of no three collinear points within sets p or q 12 lemma 5 4 we have ano 3 l m n b n 1 2 c proof fix a point p p to be a center point and a q q to be a non center point by the argument in lemma 2 7 since no three points are collinear at most 2 of each of the remaining n 1 points in q can form the same angle with pq with center p however one other point in the q can be collinear to p and q not contributing any angle yielding d n 2 2 e b n 1 2 c corollary 5 5 we have ano 3 l m n m n 2 1 2 this allows us to completely solve this problem in the case of m 1 lemma 5 6 we have ano 3 l 1 n b n 1 2 c proof let q be the vertices of a regular n gon inscribe these vertices in a circle let the singular point p in the other set be the center of the circle then the number of angles of the form q 1 pq 2 for q 1 q 2 q is n 2 1 for n even and n 1 2 for n odd by counting subtending arclengths this yields a 1 n b n 1 2 c combining with lemma 5 4 we achieve the desired result we now consider k partite sets definition 5 7 let n k i 1 ri let a r 1 r 2 rk denote the minimum number of distinct angles determined by point sets in r 2 of respective sizes r 1 rk with each of the following stipulations 1 each angle is formed by three points in distinct sets 2 r 1 r 2 rk and k 3 and 3 not all points are collinear we begin with upper bounds on unrestricted and restricted point sets lemma 5 8 we have a r 1 r 2 rk 2 n r 1 1 proof let s n r 1 we follow a similar proof to lemma 5 2 let the n points be in an n point projected regular polygon configuration let the point off the line p be in the r 1 set let the leftmost rk points be in the rk set the next leftmost in the rk 1 set and so on with the remaining rightmost points on the line in the r 1 set note that all angles must include p the angles i n for 1 i s 1 are exactly those formed by angles with p as the center we assume without loss of generality that s is at most n 2 as from lemma 2 9 there are n 2 total angles in the configuration from the proof of lemma 5 2 the angles centered at p and the acute angles centered at some point in an ri set for i 1 overlap completely yielding s 1 angles note that the rightmost center point has no endpoint for an angle opening to the right thus the minus one moreover since we may assume s n 2 all of s 1 supplemental angles are obtuse thus they do not overlap at all yielding the desired bound of 2 s 2 angles as before we are unable to provide a lower bound only in terms of n as from the above there are configurations with large r 1 which exhibit very few distinct angles we next provide an upper bound on a r 1 r 2 rk in the restricted case of no three points on a line lemma 5 9 we have ano 3 l r 1 r 2 rk n max 2 rk 1 proof place the n points as the vertices of a regular n gon assign the first r 1 to the first partite set the next r 2 to the second and so on continuing about the circle circumscribing the polygon clockwise then since all points are on a circle the angles in the configuration each correspond exactly to the arc subtending them but by construction the arcs subtending angles may contain at most n max 3 rk 2 points as such the distinct angles in this configuration are exactly i n for 1 i n max 2 rk 1 this implies the desired bound 13 if we forbid three points on a line within each of constituent sets we have a stronger bound than lemma 5 4 for rk 1 and rk small lemma 5 10 ano 3 l r 1 r 2 rk d n rk 1 rk 2 e proof fix a point in the rk set and a point in rk 1 set now since there are no three collinear points the points in the other sets make each angle with these points at most twice thus ano 3 l r 1 r 2 rk dn rk 1 rk 2 e 6 maximal subsets of points with distinct angles 6 1 definitions and upper bounds another variant of the erdo s distinct distance problem is the follow ing given n points in a plane how many points must we remove so that the remaining points determine no repeated distances this problem has been studied extensively in the context of distances with varying restrictions on the points set 3 16 18 12 we study an analogous problem for angles proving the first nontrivial lower and upper bounds definition 6 1 for a point set p let r p be the maximum size of q p such that q determines no repeated angle then let r n min p n r p where the minimum is taken over non collinear point sets p of n points in general configurations with a low number of angles provide a reasonable upper bound for r n lemma 6 2 let p r 2 be a planar point configuration of n points with no three collinear points then r p 2 a p 1 3 proof fix p r 2 a planar point configuration of n points with no three collinear points then the subsets of the point configuration determine at most a p distinct angles moreover as there are no three collinear points in p any subset s of p admits 3 s 3 not necessarily distinct angles thus if a subset s has no repeated angles it must be that 3 s 3 a p this implies s 2 a p 1 3 using lemma 2 2 and theorem 2 14 we get the following bounds corollary 6 3 we have r n rno 3 l n o n 1 3 rno 4 c n rgen n o n log 2 7 3 remark 6 4 notably lemma 6 2 does not provide an especially strong bound for rno 4 c n since the construction from lemma 2 9 has n 1 points on a line and removing the point off the line thus yields a subset with all trivially distinct angles 6 2 a probabilistic lower bound on maximal distinct angle subsets in general position now we provide a lower bound on rgen n the proof is in many ways reminiscent of charalambides proof of this for distances see proposition 2 1 in 3 to proceed we define and bound several quantities 14 definition 6 5 for a point set p let q 3 p p q r p 3 p q r distinct pqr qrp q 4 p p q r s p 4 p q r s distinct pqr pqs pqr rsp pqr qrs or pqs qrs q 5 p p q r s t p 5 p q r s t distinct pqr sqt pqr qst pqr rst q 6 p p q r s t u p q r s t u distinct pqr stu remark 6 6 q 3 p is the collection of pairs of equal angles overlapping at all three points it is also the collection of isosceles triangles over counting up to a factor of 3 q 4 p is the collection of pairs of equal angles overlapping at two points the first case is when the angles share a central point and one endpoint the second case is when they share both endpoints the third case is when their center points are endpoints for the other angle and since that gives two points overlapping the other two endpoints do not overlap the fourth and final case is when the endpoints of one angle are the center and an endpoint of the other see figure 2 or figure 2 four point repeated angle configurations q 5 p is the collection of pairs of equal angles overlapping at one point the first case is when the angles share a central point the second case is when the center of one angle is an endpoint of the other the third case is when an endpoint of one angle is also an endpoint of the other see figure 3 q 6 p is the collection of pairs of equal angles without overlaps these cases are all encompassing as for each number of repeated points it involves some matching of angle endpoints centers to angle endpoints centers these cases are an exhaustive list of such matchings for that which follows we assume the point configuration is in general position in the plane that is no three points in the configuration are on a line and no four are on a circle the argument fails without restricting to sets with no four points on a circle as remarked afterward definition 6 7 for each 3 i 6 let qi n max p n qi p where p is a planar point set in general position 15 figure 3 five point repeated angle configurations lemma 6 8 we have q 3 n o n 7 3 pach and sharir show the number of isosceles triangles in the plane is o n 7 3 21 we count such triangles twice in q 3 n if the triple forms an isosceles triangle and thrice if it forms an equilateral triangle this makes no difference asymptotically lemma 6 9 we have q 4 n o n 3 proof let p be n points in general position we show that there are at most cn 3 quadruples in each case of q 4 p for some constant c implying the desired bound in each of the cases below we use the same naming convention as in definition 6 5 our case numbering also correspond to those in figure 2 fix p q and r which may be done in less than n 3 ways case 1 we count the number of ways to choose s such that pqs pqr since is determined by p q and r then s must be on a ray from q forming angle with qp there are at most two such rays with one being qr since the points are in general position s cannot be on qr on the other ray there are at most one such point s so there are at most n 3 quadruples in this case case 2 let c be the circle determined by the three points and c be its reflection across the segment pr let be the perpendicular bisector of segment pr we show that any point s forming psr has to lie on the outer perimeter of the figure c c first assume point s lies in the same half space as q with respect to the line pr and the same half space as r with respect to let s be the point projected onto c projected from s along ps by comparing the triangles 4 psr and 4 ps r we have that ps r psr iff prs prs therefore it must be that s s the previous argument can be performed when s is on the other side of by projecting along rs instead however in either of these cases s c which violates the restriction of no four points on a circle that is the second diagram in case 2 of figure 2 is impossible given our restrictions this argument can be repeated when s is on the other side of pr but instead on circle c since there are already two points on this circle there is most one choice for s in this case hence there are at most n 3 quadruples in this case case 3 we choose s such that qrs since is determined by p q and r s must be on a ray from r forming angle with qr there are at most two such rays each such ray contains at most two point yielding at most two options for s so there are at most 2 n 3 quadruples in this case 16 case 4 this case is extremely similar to cases 1 and 3 we choose s such that sqr pqr as before there are at most two lines which intersect qr at q at an angle of each line contains at most one additional point in p yielding an upper bound of 2 n 3 quadruplets in this case since each four cases can occur in at most cn 3 ways for c 2 then q 4 n o n 3 as desired remark 6 10 if four points on a circle is allowed then we instead get q 4 n n 4 crippling the proof this can be achieved with a regular n gon fix two of its vertices as the overlapping endpoints they partition the vertices of the polygon into major and minor arcs with the major one having least n 2 2 vertices then any choice of two vertices from the major arc will yield a configuration as in case 2 thus there are n 4 such configurations in this case as such forbidding four points on a circle is necessary lemma 6 11 we have q 5 n o n 4 proof let p be n points in general position as in lemma 6 9 we show that each case of q 5 p occurs at most cn 4 times for constant c implying the desired bound case 1 fix p q r and s done in less than n 4 ways as in lemma 6 9 there are at most two choices for t yielding at most 2 n 4 options for this case case 2 this follows exactly as case 1 yielding a bound of at most 2 n 4 options for this case case 3 this follows exactly as cases 1 and 2 yielding a bound of at most 2 n 4 options for this case the above casework implies the result lemma 6 12 we have q 6 n o n 5 proof fix n points in general configuration and from it points p q r s and t in less than n 5 ways there are then exactly two ways to choose u so that pqr stu then u must lie on one of two lines containing t since there are no three collinear points there are at most two choices of u the result follows theorem 6 13 we have rgen n n 1 5 proof let p r 2 be a point set of size n and let q p be a set in which each element of q is chosen independently and uniformly from p with probability p the probability p will be specified below each occurrence of some configuration from 6 i 3 qi inq generates a repeated angle letq q be the points remaining after one point from each configuration is removed indeed q is free of repeated angles and q rgen p taking expectations we obtain e q e q 6 i 3 e qi pn 6 i 3 piqi n using lemmas 6 8 6 12 there exist some constant c 1 such that for all n n for some n we get e q np c p 3 n 7 3 p 4 n 3 p 5 n 4 p 6 n 5 setting p c 1 n 4 5 for n n we have e q c 1 n 1 5 c 2 n 1 15 c 3 n 1 5 c 4 c 5 n 1 5 n 1 5 by the first moment method there exists a subset of size n 1 5 without repeated angles 7 higher dimensions lenz s construction in general the minimum number of distinct angles among n points in rd should decrease as lower dimensional spaces can be embedded in higher dimensional ones in this section we provide a construction that demonstrates that this is indeed the case 17 definition 7 1 let ad n be the minimum number of distinct angles on three points determined by n non collinear points in d dimensional space in dimension d for d 4 lenz gives a construction for a low upper bound on ad 2 n as described in 13 construct a unit regular n gon centered at the origin in the x 1 x 2 plane and another unit regular n gon centered at the origin in the x 3 x 4 plane this is lenz s construction now we upper bound the number of distinct angles in this configuration from lemma 2 7 there are n 2 distinct angles between points in the same n gon there are then two other cases to consider we may assume without loss of generality the points lie in four dimensions as the extra dimensions make no difference in the computation let the three points be 1 x cos sin 0 0 2 y cos sin 0 0 3 z 0 0 sin cos where 2 i n 0 i n 1 and 6 case 1 the endpoints are in the same polygon in this case z is the center of the angle we compute xzy using arccos x z y z x z y z 7 1 for the computations that follow here is a useful trigonometric identity cos 1 2 cos 1 cos 2 sin 1 sin 2 7 2 now for convenience x z cos sin sin cos y z cos sin sin cos substituting we have x z y z cos cos sin sin sin 2 cos 2 1 cos where the second step follows from applying equation 7 2 similarly we have x z y z 2 7 3 substituting into 7 1 we have arccos 1 cos 2 we know 2 k n for nonzero n 1 k n 1 since cosine is an even and periodic with 2 the image of cos are exactly cos 2 k n for 1 k dn 1 2 e because arccosine is injective on 1 1 it yields exactly dn 1 2 e values of case 2 the endpoints are in different polygons here we may assume x is the center of the angle we compute yxz using arccos y x z x y x z x 7 4 again for convenience y x cos cos sin sin 0 0 z x cos sin sin cos 18 substituting y x z x cos cos cos 2 sin sin sin 2 1 cos where the last step is another application of equation 7 2 as before z x 2 however we also have y x cos 2 cos 2 2 cos cos sin 2 sin 2 2 sin cos 2 2 cos 2 1 cos now substituting into equation 7 4 we have arccos 1 cos 2 as in case 1 we have n 1 2 possible values for cos now since in both cases arccosine is injective on the domain these are duplicate angles if and only if 1 cos 1 cos since both sides are non negative we may square both sides thus we have a duplicate angle if and only if we have a solution to cos cos 3 0 so cos must equal zero since we are only considering 2 k n for 1 k n 1 2 this occurs only for k n 4 hence we overcount between these two cases exactly once if and only if 4 n as a result of these computations we have the following lemma lemma 7 2 the number of distinct angles in lenz s construction with 2 n points is at most 2 n 4 if 4 n and at most 2 n 3 otherwise we can extend lenz s construction to get even better bounds on the minimum number of distinct angles in higher dimensions in dimension d 6 we may now have three unit regular n gons in disjoint pairs of coordinates crucially adding the third n gon adds at most one angle formed by points on three different polygons as the distance between points is 2 three points always yield an equilateral triangle and an angle of 3 if the dimension allows you may then add even more n gons in disjoint coordinates after the third the additional ones do not add any additional distinct angles since subsets of the vertices of n gons have a subset of the angles you can make point sets of any size using lenz like constructions theorem 7 3 fix d 2 for n d 1 we have that 2 ad n n 2 d 2 3 7 5 2 n 2 3 d 4 5 7 6 2 n bd 2 c 2 d 6 7 7 for 3 n d 1 we have ad n 1 7 8 19 proof the lower bound of 2 for 7 5 7 6 7 7 follows from the fact that the d dimensional simplex has exactly d 1 vertices and it is the largest point configuration in d dimensional space with all points equidistant as such in each of these cases there are at least two distances between the points and thus more than one distinct angle now note that n bd 2 c 3 if n d 1 7 6 and 7 7 then follow from lemma 7 2 and the above discussion of generalized lenz s constructions in fact in special cases for d 6 we get a slightly lower bound for nbd 2 c a multiple of 3 or 4 we may reduce the bound by 1 and 2 if a multiple of 12 for 7 6 we also may reduce the bound by 1 if n 2 is a multiple of 4 for 7 5 for d 2 or 3 this follows from lemma 2 7 by using a regular n gon for 7 8 note that for n d 1 we can arrange the points to form the vertices of a d dimensional regular simplex yielding all points equidistant from one another this means all angles are 3 as they are the angle of an equilateral triangle we can take any subset of the vertices of such a simplex to get the same result crucially this construction implies that no uniform lower bound greater than 4 for a fixed n and varying d can exist from this we can also give an upper bound on the higher dimensional version of the quantity r n from definition 6 1 definition 7 4 let rd p be the maximum size of any q p rd such that q defines no angle twice over the set of all n non collinear points define rd n min p n rd p we again make use of a variation of lenz s construction to provide an upper bound proposition 7 5 we have rd n 2 n bd 2 c 4 1 3 proof we use the variation of lenz s construction from lemma 7 2 distribute the points as evenly as possible amongst the largest possible regular polygons in disjoint pairs of dimensions as normal note that there cannot be points on three different circles as they form an equilateral triangle also note that there cannot be two points on one circle and one on another as that forms an isosceles triangle as such we may apply lemma 6 2 to the largest polygon to achieve our desired bound remark 7 6 for n d 1 2 there is a two distance set of that many points see lemma 3 1 of 20 thus in such sets all but two points must be removed yielding rd n 2 for n d 1 2 8 future work future research may take distinct angles problems in a number of new directions 1 we have shown that n 6 a n n 2 further we have identified two non collinear point configurations which define exactly n 2 angles the regular n gon and its projection onto the line whether these are in fact the optimal configurations is open though they are conjectured to be so and even if they are there may be others which also define n 2 angles note that we have observed that excluding angles of 0 and one may add a point to the center of an even sided regular polygon without adding any angles see remark 2 3 this does not contradict erdo s initial conjecture in 15 as he included 0 angles 2 prove conjecture 3 3 and conjecture 3 5 regarding optimal point configurations 3 one may similarly improve our bounds onano 3 n ano 4 c andagen in general position an optimal construction has yet to be conjectured 20 4 the question of distinct angles in higher dimensional space has yet to be explored deeply and one may generalize any of our bounded quantities to the general setting further research may also investigate higher analogues of angles like three dimensional solid angles 5 we bounded rgen n the size of the largest distinct angle subset of an n point configuration al ternatively by viewing the point configuration as a complete graph on n vertices we may define rgen n as the number of vertices in the largest complete distinct angle sub graph instead of re moving vertices one might ask about removing edges until all angles left are distinct references 1 p brass w moser and j pach research problems in discrete geometry springer science business media 2006 2 j h conway h t croft p erdo s and m j t guy on the distribution of values of angles determined by coplanar points j london math soc 19 2 1979 137 143 3 m charalambides a note on distinct distance subsets journal of geometry 104 2013 439 442 4 h t croft some geometrical thoughts ii math gaz 51 1967 125 129 5 g a dirac collinearity properties of sets of points quart j math oxford ser 2 2 1951 221 227 6 g elekes circle grids and bipartite graphs of distances combinatorica 15 1995 167 174 7 g nivasch j pach r pinchasi and s zerbib the number of distinct distances from a vertex of a convex polygon the journal of computation geometry 4 2013 1 12 8 p erdo s on sets of distances of n points the american mathematical monthly 53 5 1946 248 250 9 p erdo s on some metric and combinatorial geometric problems discrete math 60 1986 147 153 10 p erdo s some unsolved problems magyar tud akad mat kut int k zl 6 1961 221 254 11 p erdo s z f redi j pach and i ruzsa the grid revisited discrete mathematics 111 1 3 1993 189 196 12 p erdo s r k guy distinct distances between lattice points elemente math 25 1970 121 123 13 p erdo s on sets of distances of n points in euclidean space magyar tud akad mat kut int k zl 5 1960 165 169 14 p erdo s d hickerson and j pach a problem of leo moser about repeated distances on the sphere american mathematical monthly 96 1989 569 575 15 p erdo s g purdy extremal problems in combinatorial geometry handbook of combinatorics vol 1 r l graham et al eds elsevier 1995 809 874 16 l guth and n katz on the erdo s distinct distances problem in the plane annals of mathematics 181 1 2015 155 190 17 z han a note on the weak dirac conjecture electronic journal of combinatorics 24 1 2017 p 1 63 18 h lefmann and t thiele point sets with distinct distances combinatorica 15 1995 279 408 19 n h katz and g tardos a new entropy inequality for the erdo s distance problem towards a theory of geometric graphs contemporary mathematics 342 2004 119 124 20 p lisone k new maximal two distance sets journal of combinatorial theory series a 77 2 1997 318 338 21 j pach and m sharir repeated angles in the plane and related problems journal of combinatorial theory series a 59 1 1992 12 22 22 j pach and f de zeeuw distinct distances on algebraic curves in the plane proc 30 th amc symp on computational geometry 2014 549 557 23 o e raz o roche newton and m sharir sets with few distinct distances do not have heavy lines discrete math 338 2015 1484 1492 24 sheffer j zahl and f de zeeuw few distinct distances implies no heavy lines or circles combinatorica 36 2016 349 364 email address henryfl school edu department of mathematics university of michigan ann arbor 48109 email address hongyih andrew cmu edu department of mathematical sciences carnegie mellon university pittsburgh 15213 email address alephnil umich edu department of mathematics university of michigan ann arbor 48109 email address sjm 1 williams edu steven miller mc 96 aya yale edu department of mathematics and statistics williams college williamstown ma 01267 email address palsson vt edu 21 mailto henryfl umich edu mailto hongyih andrew cmu edu mailto alephnil umich edu mailto sjm 1 williams edu steven miller mc 96 aya yale edu mailto palsson vt edu department of mathematics virginia tech blacksburg va 24061 email address ethan pesikoff yale edu department of mathematics yale university new haven ct 06511 email address charles wolf rochester edu department of mathematics rochester ny 14627 22 mailto ethan pesikoff yale edu mailto charles wolf rochester edu 1 introduction 1 1 background 1 2 summary of results and methods 2 erdos angle problems 2 1 unrestricted point sets 2 2 no three collinear points 2 3 restricting cocircularity 2 4 general position no three points on a line nor four on a circle 3 the robustness of efficient point configurations 4 the pinned angle problem 5 partite sets 6 maximal subsets of points with distinct angles 6 1 definitions and upper bounds 6 2 a probabilistic lower bound on maximal distinct angle subsets in general position 7 higher dimensions lenz s construction 8 future work references