structural routability of n pairs information networks girish n nair abstract information does not generally behave like a conservative fluid flow in communication networks with multiple sources and sinks however it is often con ceptually and practically useful to be able to associate separate data streams with each source sink pair with only routing and no coding performed at the network nodes this raises the question of whether there is a nontrivial class of network topologies for which achievability is always equivalent to routability for any com bination of source signals and positive channel capacities this chapter considers possibly cyclic directed errorless networks with n source sink pairs and mutually independent source signals the concept of downward dominance is introduced and it is shown that if the network topology is downward dominated then the achiev ability of a given combination of source signals and channel capacities implies the existence of a feasible multicommodity flow 1 introduction in an n pairs or multiple unicast communication network n source signals must be conveyed to their corresponding sinks without exceeding any channel capacities until quite recently the belief was that this was possible iff there existed a rout ing solution i e if every symbol generated by a source could be carried without modification over channels and through network nodes until it reached the sink girish n nair dept electrical and electronic engineering university of melbourne vic 3010 australia e mail gnair unimelb edu au published in information and control in networks eds g como b bernhardsson a rantzer lecture notes in control and information sciences v 40 springer pp 215 239 2014 this work was supported by australian research council grant dp 110102401 a preliminary ver sion was presented in 14 1 ar x iv 1 10 8 62 60 v 4 cs i t 1 1 ja n 20 14 gnair unimelb edu au 2 g n nair structural routability of n pairs information networks at a macroscopic level this is equivalent to presuming the existence of a feasible multicommodity flow 12 however in 15 2 an example was constructed of a 2 pairs communication network that did not admit a routing solution but became admissible if nodes could perform modulo 2 arithmetic on incoming bits this counter intuitive result started the field of network coding in which nodes are permitted to not just route incoming symbols but also to perform causal functions on them so as to better exploit the network structure and the available channel capacities it is now known that the capacity regions for n pairs networks are not generally given by feasible multicommodity flows in 1 n pairs networks were constructed with coding capacity much larger than the routing capacity other related work in cludes 9 in which a necessary and sufficient condition for broadcasting correlated sources over erroneous channels was found and 13 in which linear network cod ing was shown to achieve capacity for a multicast network notwithstanding the power of network codes routing multicommodity flow so lutions are appealing in several respects most obviously they are simpler because network nodes are not required to perform extra mathematical operations on arriving bits in addition because different data streams are not hashed together by means of some function there is arguably less potential for cross talk between different source sink pairs arising for instance from nonidealities during implementation in the physical layer for similar reasons routing may be preferred over network cod ing if security and privacy are important furthermore being able to treat informa tion as a conservative fluid flow could potentially provide a simple basis to analyse communication requirements in areas outside traditional multiterminal information theory e g networked feedback control and multi agent coordination consensus problems see e g 3 these considerations raise the natural questions of whether there is a general class of network topologies on which achievability is always equivalent to the exis tence of a feasible multicommodity flow this chapter aims to answer this questions for possibly cyclic directed errorless networks with n source sink pairs and mu tually independent source signals where the goal is to reconstruct source signals perfectly at their respective sinks the structural concept of downward dominance def 4 4 is introduced and the main result thm 4 1 is that if the network topol ogy is downward dominated then the existence of an achievable combination of source signals and channel capacities always implies the existence of a feasible multicommodity flow the proof relies on the iterative construction of an entropically feasible multi commodity flow def 5 2 as downward dominance inheres solely in the topology of the network this result suits situations where channels switches transceivers and interfaces are expensive to set up and difficult to move or where channel capac ities and source signal statistics are unknown on these structures information can always be treated like a flow of conservative immiscible fluids downward dominance is a more general condition than the notion of triangular isability that was introduced in the conference version 14 of this chapter while it is not generally easy to verify in arbitrary n pairs networks lemmas 4 1 and 4 2 g n nair structural routability of n pairs information networks 3 give simpler sufficient conditions for it to hold several examples are then provided in sect 6 to illustrate the applicability of theorem 4 1 to various example networks both cyclic and acyclic including but not confined to the directed cycles and lines studied in 11 10 although downward dominance is sufficient to guarantee that routing can always achieve the full coding capacity of a network it is not necessary and the important question of finding a more general or even tight structural condition remains open in the concluding section e potential directions for future work are outlined 1 1 notation and basic terminology for convenience the basic notation and terminology used in this chapter are de scribed below the set of nonnegative integers i e whole numbers is denoted by w the set of positive integers i e natural numbers by n and the set of positive reals by r 0 a contiguous set i i 1 j of integers is denoted i j other sets are usually written in boldface type random variables rv s are written in upper case and their realisations are indi cated in corresponding lower case the set operation a b denotes a bc a discrete time random signal or process f k k 0 is denoted f and the finite sequence f k tk s is denoted f s t given a subscripted rv or signal fj with j belonging to a countable set j fj denotes the tuple fj j j arranged according to the order on j the entropy of a discrete valued rv e is denoted h e 0 and the conditional entropy of e given another rv f is h e f h e f h f the mutual information between rv s e and f is denoted i e f h e h e f 0 and the conditional mutual information between rv s e and f given g is denoted i e f g h e g h e f g if e and f are random processes and e is discrete valued then the entropy rates of e and the conditional entropy rate of e given past and present f are respec tively defined as h e lim t h e 0 t t 1 h e lim t h e 0 t t 1 h e f lim t h e 0 t f 0 t t 1 if e f and g are random processes then the mutual information rates of e and f and the conditional mutual information rate of e and f given past and present g are respectively defined as 4 g n nair structural routability of n pairs information networks i e f lim t i e 0 t f 0 t t 1 i e f lim t i e 0 t f 0 t t 1 i e f g lim t i e 0 t f 0 t g 0 t t 1 a directed graph digraph v a consists of a set v of vertices and a set a of arcs that each represent a directed link between a particular pair of vertices the initial vertex of an arc is called its tail and the terminal vertex its head a walk in a digraph is an alternating sequence 1 1 2 2 k k 1 k 0 of vertices and arcs beginning and ending in vertices s t each arc l connects the vertex l to l 1 each vertex j and arc l in the sequence is said to be in the walk with a minor abuse of notation this is denoted j a path is a walk with no loops i e it passes through no vertex more than once including the initial one an undirected path is an alternating sequence 1 1 2 2 k k 1 k 0 of vertices and arcs beginning and ending in vertices s t no vertex is repeated and each arc l connects the vertex l to l 1 or l 1 to l a cycle is a walk in which the initial and final vertices are identical but every other vertex occurs once a subpath of a path 1 1 2 2 k k 1 is a segment l l l 1 j of it where 1 l j k 1 a vertex is said to be reachable from another vertex denoted if a path leading from to equivalently it is said that can reach the same terminology and notation apply with analogous meaning for pairs of arcs as well as mixed pairs of arcs and vertices e g given an arc means that there is a path from the vertex to the tail of similarly a vertex or arc set w is said to be reachable from another set u denoted u w if there is an element of w that is reachable from an element of u equivalently it is said that u can reach w for any vertex set u v arcs u a is the set of arcs with tails in u the notation out u in u represents the set of arcs in a that have tails resp heads in a vertex set u v and heads tails v u if out u in u consists of a single arc this arc is denoted out u in u when u is a singleton the braces are omitted 2 problem formulation a network of unidirectional point to point channels may be modelled using a di graph v a where the vertex set v represents information sources sinks re peaters routers etc and the arc set a indicates the directions of any channels be tween nodes as usual with digraphs it is assumed that no arc leaves and enters the g n nair structural routability of n pairs information networks 5 same vertex and that at most one arc leads from the first to the second element of any given ordered pair of vertices in other words every arc in a may be uniquely identified with a tuple v 2 with 6 2 it is also assumed that the digraph is connected i e there is an undirected path between any distinct pair of vertices in an n pairs information network the locations of sources and sinks are respec tively represented by disjoint sets s 1 n and t 1 n of distinct vertices in v with each source i aiming to communicate to exactly one sink i it is assumed that i i let p denote the sequence i i n i 1 of source sink pairs arranged in a specified order without loss of generality it is assumed that ev ery source sink has no in coming resp out going arcs and exactly one out going in coming arc 3 the boundary v of the network is the set s t of source and sink vertices and its interior is intv v v each channel in the network can transfer bits errorlessly up to a maximum av erage rate as specified by a positive arc capacity c r 0 in some situations it may be natural to assign infinite capacity to certain arcs 4 and the set of all such arcs is denoted a a in particular the arcs leaving sources are by convention as signed infinite capacity the set of finite capacity arcs is written af a a with associated arc capacity vector c c af r af 0 the structure of the n pairs information network is defined as the tuple v af a p the communication signals in the network are represented by a vector s s a of discrete valued random processes called arc signals in particular the arc signals leaving sources and entering sinks respectively represent the exogeneous inputs to and outputs from the network for convenience the input signal sout i generated by the i th source i s is called xi and the output signal sin i entering the i th sink i t is called yi it is assumed throughout this chapter that the signals x 1 xn are mutually independent processes with strictly positive entropy rates h xi 0 the arc signal vector s is assumed to have the following property definition 2 1 setwise causality and signal graphs an arc signal vector s is called setwise causal on a structure v af a p if all arc signals leaving ver tices in any internal vertex set u intv are causally determined by those entering u from outside it that is u intv an operator gu s t sarcs u t gu t sin u 0 t t w 1 where arcs u a denotes the set of arcs leaving vertices of u the tuple s is then called a signal graph 2 such digraphs are sometimes called simple 3 if a source or sink were actually connected to multiple nodes in the network it would be rep resented in the digraph by an auxiliary vertex connected by an arc of infinite capacity with a multiply connected vertex 4 for instance when a single network node is represented as two virtual vertices connected by an arc of unbounded capacity 6 g n nair structural routability of n pairs information networks remark setwise causality is a strengthened version of the basic concept of well posedness 16 in feedback control theory in a well posed feedback system the current values of all internal and output signals are uniquely determined by the past and present values of external inputs 5 setwise causality essentially imposes an analogous condition on any subcollection of nodes and associated signals treated as a system in acyclic digraphs i e in which every walk is a path it is equivalent to causality at every internal vertex however feedback signals may be present in cyclic digraphs in which case vertex wise causality cannot guarantee 1 without further assumptions e g a positive time delay at every vertex in the n pairs network problem studied here the objective is for each sink to per fectly reconstruct each source signal block by block using only causal operations and without exceeding any arc capacities this leads to the following definition definition 2 2 achievability consider an n pairs information network with struc ture source signal vector x and arc capacity vector c r af 0 the tuple x c is called achievable if a setwise causal arc signal vector s def 2 1 and a positive integer m n s t sout i xi i 1 n 2 yi km 1 xi k 1 m km 1 k n i 1 n 3 h s c af 4 such an s is called a solution to the n pairs information network problem x c the arc capacity vector c is called achievable on x and x c is called achiev able on remarks this differs from standard definitions of network coding solutions in several minor respects for instance in 2 7 11 5 and most of 10 the inequal ities 4 are replaced by bounds either on the cardinalities of channel alphabets or on block coding rates over a period of time in addition in previous formulations the sinks typically must reconstruct the source signal either perfectly and instanta neously 7 5 10 which corresponds to setting m 1 in 3 or else with arbitrarily small probability of decoding error over blocks of sufficiently large length m 2 11 in this work bounds are imposed directly on entropies as in sec viii of 10 in order to focus on the information theoretic aspects of the problem errorless re construction is demanded so as to enable the graphical characterisation of informa tional dominance from 10 to be used with very minor changes however perfect reconstruction is not required instantaneously in 3 but only in blocks of length m this allows a solution s to be interpreted operationally in terms of variable bit rate codes 6 5 in the linear time invariant context of 16 this is equivalent to the corresponding transfer func tions being well defined and proper 6 in other words if s solves x c then there exist variable bit rate codes for each arc that yield errorless block by block reconstruction of the source signals at their sinks with expected bit g n nair structural routability of n pairs information networks 7 finally it is conjectured that the results in this paper also apply if 3 is relaxed so that yi is causally determined by xi with h yi 0 as mentioned in the introduction it was once thought that a network was achiev able 7 iff it admitted a routing solution in the present context this is equivalent to presuming the existence of an x c feasible multicommodity flow i e of a non negative tuple f f j a j 1 n r a n 0 of bit rates on each arc associated with every source sink pair s t n j 1 f j c af capacity bound 5 fin j j fout j j h x j j 1 n supply equals demand 6 in f j out f j conservation of flow 7 for any j 1 n and v j j via an explicit counter example the article 2 showed that this intuitive notion was incorrect i e that although the ex istence of a feasible multicommodity flow is sufficient for achievability it is not generally necessary this laid the foundations for network coding in which nodes are permitted to not just route incoming bits but also to perform functions on them nonetheless routing multicommodity flow solutions have certain virtues as dis cussed in sect 1 this chapter poses the question is there a general class of n pairs information network structures in which the achievability of x c is equivalent to the existence of an x c feasible multicommodity flow f 5 7 any n pairs information network structure can support x c feasible multi commodity flows if the arc capacities are sufficiently larger than the source entropy rates provided each sink is reachable from its source however there are exam ples of structures on which an x c feasible multicommodity flow does not exist if arc capacities are reduced even though x c is still achievable see sect 6 the aim of this chapter is to isolate certain structural properties that ensure routability over all achievable combinations of x c such properties would inhere solely in suiting situations in which channels switches transceivers and inter faces are expensive to set up and difficult to move and or where channel capacities and source signal statistics are variable or unknown rates at worst negligibly larger than arc capacities conversely if there exists a distributed entropy coding scheme that achieves perfect reconstruction of source signals at their sinks in blocks of length m and with expected bit rates no larger than the arc capacities then this yields a solution s as defined above however these operational interpretations will not be used in this article 7 ignoring differences in the definition of achievability 8 g n nair structural routability of n pairs information networks 3 preliminary notions before proceeding several existing graph theoretic notions are needed throughout this section v a p v af a p is the structure of an n pairs information network as described in sect 2 and s is its setwise causal signal graph def 2 1 with source and sink signal vectors x and y first some largely familiar concepts are revisited a path in an n pairs informa tion network that goes from a source i to its sink i is called an i path the set of all i paths is called an i bundle i e the set of all acyclic walks via which information can be routed from i to i given a set j 1 n the set of all i paths with i j is called a j bundle not the same as the set of j j paths which contains it let vj aj denote the subgraph formed by all the vertices and arcs in the j bundle in particular vi ai is the subgraph formed by the i bundle a vertex set u vi such that i u and i u is called an i cut the following concepts are adapted from 10 with minor changes in terminol ogy definition 3 1 indirect i walks based on 10 an indirect i walk ii walk is an alternating sequence 1 1 j 1 j 1 j of forward and reverse oriented paths in the n pairs structure such that 1 1 begins with the i th source vertex i 2 both and end with the same vertex 1 j 1 3 both and 1 begin from the same source vertex 1 j 1 4 j ends with the sink vertex i and 5 every arc and vertex in can reach i an ii walk is said to bypass an arc set c if no arc in lies in c remarks note that the fifth condition above is equivalent to the requirement that each joint vertex reaches i 1 j 1 an ii walk as defined above is in the terminology of 10 an indirect walk from out i to in i in a subgraph g 0 i similarly an ii walk that bypasses c is an indirect walk from out i to in i in a subgraph g c i if such a bypass exists then yi is not always fully determined by sc even if all i paths go through c see fig 3 and defs 10 11 in 10 indirect i walks are related to the concept of fd separation 11 in particular if sc fd separates xi and yi for any setwise causal s def 2 1 then all ii walk s pass through c that is an ii walk that bypasses c corresponds to an undirected path between xi and yi in a functional dependence subgraph gxi sc yi constructed according to the procedure in 11 however the converse is not generally true i e ii separation is a less stringent requirement this is because paths connecting xi and yi in gxi sc yi do not have to satisfy an analogue of the fifth condition which arises from the requirement that g n nair structural routability of n pairs information networks 9 each sink reproduce its source signal with perfect fidelity for this to be possible it turns out that each joint vertex in an ii walk must be able to reach i put another way requiring sc to fd separate xi and yi is equivalent to requiring that a c be an i cut and b for each j 6 i either all j i paths if any bypass c or all pass through it under ii separation a must still hold but b is relaxed a source j can have a path to i that bypasses c as well as another that passes through c provided that is not the last leg of an ii walk that bypasses c definition 3 2 structural dominance based on 10 for any arc set b a in an n pairs network sdom b is the smallest arc set c a that satisfies the conditions below 1 c b 2 out i c iff in i c 3 if a is downstream from c i e all paths from sources to the tail of pass through c then c 4 if all indirect i walks def 3 1 pass through c then out i in i c the arcs in sdom b are said to be structurally dominated by b remarks note that sdom b is the smallest such arc set in the sense of being contained by every c a that satisfies criteria 1 4 as noted in 8 pp 199 200 sdom b can be constructed by setting c b letting t a b 6 0 be the set of arcs to be tested and then following this greedy algorithm i pick any arc t ii if satisfies any of the conditions 2 4 in def 3 2 update c c and then t a c else keep c the same and update t t iii if t 0 then exit else go to step i the final set c is then sdom b however the following lemma gives two quicker conditions for guaranteeing that a specific arc lies in sdom b lemma 3 1 based on 10 1 if an arc a is downstream from b then sdom b 2 if all indirect i walks def 3 1 pass through b then out i in i sdom b proof if either of these criteria hold then the relevant arcs out i in i must lie inside any arc set c that satisfies the 1 st to 4 th conditions in def 3 2 as sdom b is such a set the lemma follows ut the significance of structural dominance arises from the following result theorem 3 1 informational dominance based on 10 consider any arc a and arc set b a in an n pairs network with structure if sdom b def 10 g n nair structural routability of n pairs information networks 3 2 then for any setwise causal arc signal vector s def 2 1 and positive integer m n that satisfy 2 and 3 a function such that s 0 km k sb 0 km k n 8 conversely if for any setwise causal s that meets 2 3 with block length m there is a function ensuring that 8 holds then sdom b remarks the property specified in 8 is a version of the concept of informa tional dominance introduced in the important of this result lies in giving this functional concept a purely structural characterisation the proof follows similar lines as that of theorem 10 in 10 and is omitted minor differences are that m is not constrained to be 1 here and that cyclic networks are handled using the notion of setwise causality def 2 1 rather than by introducing channel delays and then unwrapping the network over time to yield an infinite directed acyclic graph 4 main result the main result of this paper is presented in this section in order to do so several nonstandard graph theoretic notions are needed throughout this section v a p v af a p is the structure of an n pairs information network as described in sect 2 and s is its setwise causal signal graph def 2 1 with source and sink signal vectors x and y definition 4 1 j disjointness given an index set j 1 n an arc set b a is j disjoint if each path in the j bundle passes through at most one arc in b if j i for some i 1 n then b is called i disjoint remarks it is easy to see that empty and singleton arc sets are automatically j disjoint that every b a is 0 disjoint and that every subset of a j disjoint set inherits its j disjointness with a little effort it can also be shown that j disjoint arc sets satisfy the augmentation property thus j disjoint sets form a finite matroid on a structural dominance def 3 2 and 1 i disjointness are next used to define nested families of arc sets with certain structural properties these properties are needed later to inductively extract entropically feasible multicommodity flows def 5 2 first for any arc set e a and h 1 n define the source augmented set e h e out jh 1 h 1 n jh 1 j 1 h 1 e a j 0 9 that is e is augmented by those source arcs that either have indices greater than h or that have indices less than h but no source sink paths going through e g n nair structural routability of n pairs information networks 11 definition 4 2 i downward dominated sets for each i 1 n the family di consists of all arc sets e a such that 1 e is 1 i disjoint def 4 1 and 2 for each h 1 i either the h bundle does not touch e i e e ah 0 or else the source augmented arc set e h 9 structurally dominates the source arc out h def 3 2 every member set of di is called i downward dominated remark clearly every di set is also in di 1 the next concept describes a class of i cuts that have a special structure definition 4 3 viable i cuts given an index i 1 n an i cut u vi is called viable under the following conditions 1 every arc leaving u in the i bundle is finite capacity i e out u ai af 2 there is an i path that leaves u without re entering 3 each arc in out u ai lies in an i path that either exits u without re entering or else lies in the 1 i 1 bundle 4 every vertex u lies on an undirected path from i to such that a all vertices before on are in u and b every reverse oriented arc in i e pointing from to i lies on an i path that does not re enter u remark viable i cuts correspond to possible min cuts in a residual capacitated digraph that is used to prove the main result of this chapter thm 4 1 further investigation of these min cuts may yield other structural properties to add to the list above however this is left for future work definition 4 4 downward dominance a structure is called downward domi nated if for each i 2 n and viable i cut u def 4 3 the set oi out u ai of outgoing arcs in the i bundle satisfies the following two conditions 1 oi di 1 def 4 2 and 2 the source augmented arc set oi i 9 structurally dominates the source arc out i def 3 2 remarks note that 1 pair structures are automatically downward dominated since the conditions above become empty a sequence of simpler and progressively more restrictive sufficient conditions for downward dominance can be found by exploiting lemma 3 1 12 g n nair structural routability of n pairs information networks lemma 4 1 simpler condition 1 suppose that for each i 2 n and viable i cut u vi def 4 3 the arc set oi out u ai af satisfies the following conditions 1 oi is 1 i 1 disjoint def 4 1 and 2 for each index h 1 i for which there is a h path that passes through oi i e oi ah 6 0 all indirect h walks def 3 1 pass through the source augmented arc set oi h 9 then is downward dominated def 4 4 proof follows immediately from applying lemma 3 1 to defs 4 2 and 3 2 ut lemma 4 2 simpler condition 2 suppose that for each i 2 n and viable i cut u vi def 4 3 the arc set oi out u ai af satisfies the following conditions 1 oi is 1 i 1 disjoint def 4 1 2 for every h 1 i and s 1 h such that oi ah and oi as 6 0 all paths from s to h pass through oi then is downward dominated def 4 4 proof let oi ah 6 0 for some h 1 i it is asserted that all indirect h walks def 3 1 must pass through oi h to see this suppose in contradiction that there is an indirect h walk that does not pass through oi h o i out jh 1 h 1 n where jh 1 j 1 h 1 oi a j 0 let s be the last source vertex in and let be the subpath from s to h clearly s jh 1 h 1 n in addition s 6 h since otherwise reduces to a path from h to h which by the second condition above must pass through oi oi h thus s 1 h 1 jh 1 i e oi as 6 0 by the second condition above all s h paths must then pass through oi as is such a path the indirect h walk of which it is a part passes through oi oi h yielding a contradiction the result then follows from lemma 4 1 ut lemma 4 3 simpler condition 3 suppose that for each i 2 n and every viable i cut u vi def 4 3 there is exactly arc in oi out u ai af furthermore suppose that for each h 1 i and s 1 h such that oi ah and oi as 6 0 all paths from s to h pass through oi or none of them do then is downward dominated def 4 4 proof observe that oi consists of a single arc thus the first condition of lemma 4 2 is trivially satisfied to show that its second condition is also met suppose that oi ah oi as 6 0 for some h 1 i s 1 h thus is on both an s path and a h path let 1 be the subpath of the s path from s to the tail of and 2 the subpath of the h path from the head of to h then the concatenation 1 2 is a s h path that passes through oi by the all or nothing condition above all s h paths then pass through oi the result then follows from lemma 4 2 ut g n nair structural routability of n pairs information networks 13 the main result of this chapter can now be stated theorem 4 1 downward dominance structural routability if there is an ordering of the source sink pairs in an n pairs network so that the structure is downward dominated def 4 4 then the achievability of x c def 2 2 implies the existence of an x c feasible multicommodity flow 5 7 conversely if x is stationary and there exists an x c feasible multicommodity flow with 5 holding in strict form then x c is achievable 5 remarks this result defines a non trivial class of directed network structures for which achievability is essentially equivalent to the existence of a feasible mul ticommodity flow on these structures information can indeed be treated like an incompressible immiscible fluid flow the proof of thm 4 1 is given in the next section in sect 6 several network examples are discussed to illustrate the applicability of thm 4 1 5 proof of theorem 4 1 in both the proofs of necessity and sufficiency use will be made of the fact that i 1 n any single commodity flow q from i to i in the structure can be decomposed into a superposition of i path flows and cycle flows see e g 4 thm 3 3 1 that is if 1 i pi i are the distinct i paths and 1 g the distinct cycles then numbers u 1 i up i 0 and w 1 i wg i 0 s t q 1 k pi k i 3 uk i 1 l g l 3 wl i 10 if wl i 0 for all l 1 g then the flow q is called acyclic the proof of sufficiency in sect 5 2 is relatively straightforward given an x c feasible multicommodity flow f 5 7 on the decomposition 10 is used di rectly to devise a routing solution s the proof of necessity in sect 5 1 is more difficult and involves induction using the following building blocks definition 5 1 j flow given an index set j 1 n a nonnegative tuple f f j a j j r a j 0 is called a j flow on the structure if j j and v j j in f j out f j j flow conservation 11 as a convention the 0 flow is defined as the empty sequence 14 g n nair structural routability of n pairs information networks remark a j flow is a possibly infeasible multicommmodity flow with source sink pairs j j j j if each j flow fa j is acyclic j j then f is called an acyclic j flow the next concept is central to the proof of necessity it defines a class of feasible 1 i flows that obey certain information theoretic bounds when only the signals x j j 1 i need to be communicated definition 5 2 entropic feasibility given i 1 n and a solution s to x c def 2 2 a 1 i flow f r a i 0 def 5 1 is called entropically feasible if it satis fies the following conditions i on every arc af i j 1 f j c 12 ii on any i downward dominated arc set b def 4 2 b j 1 i f j h sb xji i 1 n 13 where ji j 1 i b a j 0 iii on arcs entering sinks and leaving sources fin j j fout j j h x j j 1 i 14 remarks note that the 0 flow is entropically feasible since the condition 14 disappears and 13 is trivially satisfied due to a zero left hand side lhs the proof of necessity in the next section proceeds by constructing an entropi cally feasible 1 n flow on c s which automatically gives the desired x c feasible multicommodity flow 5 7 5 1 necessity proof for theorem 4 1 let the arc signal vector s be a solution def 2 2 to the n pairs information net work problem x c an entropically feasible 1 n flow def 5 2 f n will be constructed using upward induction let be downward dominated def 4 4 and suppose that f i 1 f j a j 1 i 1 r a i 1 0 is an entropically feasible acyclic 1 i 1 flow for some i 1 n noting that the 0 flow f 0 is entropically feasible an i flow f i a r a 0 will be constructed in such a way that f i r a i 0 will be an entropically feasible acyclic 1 i flow on any arc a let g n nair structural routability of n pairs information networks 15 r c i 1 j 1 f j if af if a a af 15 be the residual capacity after subtracting the relevant components of f i 1 note that r 12 0 since f i 1 is an entropically feasible 1 i 1 flow the next step is to find an acyclic i flow def 5 1 q r a 0 from i i that is a the residual capacity on each arc and b h xi on the arc entering i there are two mutually exclusive cases to consider 5 1 1 1 st case an i path with no finite capacity arcs denote this i path by e noting that r e by the 2 nd line of 15 set the i path flows as uk h xi if k e 0 otherwise k 1 p 16 and the cycle flows equal to zero in the decomposition 10 dropping the i subscripts so that q 10 1 k p k 3 uk a 17 evidently q is acyclic and meets the residual capacity constraint on all arcs in a furthermore since every i path passes through the single arc entering i qin i 17 1 k p uk 16 ue h xi 18 satisfying the conditional information constraint 5 1 2 2 nd case every i path has one or more finite capacity arcs observe first that for any arc set b a 16 g n nair structural routability of n pairs information networks b c 4 b h s b lim t h s 0 t t 1 lim t 1 t 1 b h s 0 t lim t h sb 0 t t 1 h sb 19 h sb xji 1 i 1 n 20 lim t h sb 0 t xji 1 i 1 n 0 t h sb 0 t xji 1 i n 0 t t 1 h sb 0 t xji 1 i n 0 t t 1 lim t i sb 0 t xi 0 t xji 1 i 1 n 0 t t 1 h sb 0 t xji 1 i n 0 t t 1 i xi sb xji 1 i 1 n h sb xji 1 i n i xi sb xji 1 i 1 n h sb xji 1 i n 21 where 19 is due to the subadditivity of joint entropy 20 holds because condi tioning cannot increase entropy and 21 arises from the mutual independence of x 1 xn now consider the residual capacitated digraph vi ai rai formed by the i bundle 8 let q be an acyclic maximal flow on it under the constraints 0 q r ai 22 by the min cut max flow theorem see e g 4 thm 3 5 3 an i cut u vi consisting of every vertex vi for which an undirected path in vi ai from i to s t forward slack every forward oriented arc in i e pointing from i to has q r and backward flow every backward oriented arc in pointing from to i has q 0 as a consequence of this 8 here arcs are permitted to have r 0 g n nair structural routability of n pairs information networks 17 q r oi out u ai 23 q 0 ii in u ai 24 note also that since the cyclic flow components w 1 w j in 10 are zero q 1 k p k 3 uk ai 25 the i cut u evidently depends on the residual capacity vector r however the following purely structural statements may be made about it 1 every arc in oi lies in af i e is finite capacity otherwise q 23 r 15 im plying by 25 that uk on some i path k which is impossible since every i path in this case travels over at least one finite capacity arc 2 every arc oi is in an i path that exits u without re entering or else is in the 1 i 1 bundle to see this suppose that every i path k passing through re enters u evidently it must then pass through some arc ii by 24 q 0 implying by virtue of 25 and nonnegativity that uk 0 from 23 and 25 this implies that r 0 as c 0 it must then hold that f j 0 for some j 1 i 1 as the j flow f j a is acyclic by construction must then lie on a j path by 10 3 there must be an i path that leaves u without re entering to see this suppose in contradiction that every i path re enters u by the preceding argument all i paths must then have associated acyclic flow components uk 0 pick any i path and let be the last vertex in u that it traverses before leaving u without further re entry let denote its subpath from i by the definition of u there is an undirected path from i to such that all forward oriented arcs in it are slack and all backward oriented arcs carry strictly positive q flow note also that all vertices before in must also lie in u by construction from 25 any backward arc in would have to carry an i path flow component uk 0 which would be a contradiction consequently all the arcs in must be forward oriented i e is a directed path in u from i the concatenation of with then yields an i path that leaves u exactly once a contradiction 4 finally by construction of u every vertex in it must lie on an undirected path from i to such that a every vertex before in is also in u since the subpath from i to auto matically satisfies the defining forward slack and backward flow properties and b every reverse oriented arc in lies on an i path that does not re enter u since such arcs must by definition carry positive q flow and i paths that re enter u carry zero q flow in other words u is a viable i cut def 4 3 by downward dominance def 4 4 oi out ji 1 i 1 n structurally dominates out i def 3 2 and o i is a di 1 set def 4 2 using i flow conservation 18 g n nair structural routability of n pairs information networks qin i oi q ii q 23 24 oi r 15 oi c oi j 1 i 1 f j 21 i xi soi xji 1 i 1 n h soi xji 1 i n b j 1 i 1 f j 13 i xi soi xji 1 i 1 n 26 as out i sdom oi out ji 1 i 1 n it follows that xi 0 km 1 is a function of soi 0 km 1 and xji 1 i 1 n 0 km 1 consequently k n i xi 0 km 1 soi 0 km 1 xji 1 i 1 n 0 km 1 h xi 0 km 1 as entropy and mutual information are monotonic a sandwich argument with k then yields that the rhs of 26 is just h xi so that qin i i xi soi xji 1 i 1 n h xi 27 as desired 5 1 3 construction of f i in both cases for both cases above let f i h xi qin i v q vq a 28 where v 0 1 by 27 clearly fa i is still an acyclic i flow since it just a scaled version of q furthermore i j 1 f j 28 vq i 1 j 1 f j 27 q i 1 j 1 f j 15 c the next step is to verify that f i fa 1 i satisfies the remaining conditions 13 14 for an entropically feasible 1 i flow first 13 is checked let e be any arc set in di def 4 2 if e ai 0 then g n nair structural routability of n pairs information networks 19 e j 1 i f j e j 1 i 1 f j 13 h se xji 1 i n h se xji i 1 n since e di 1 automatically and where the last equality follows because ji 1 i ji else if e ai 6 0 write e j 1 i f j e f i e j 1 i 1 f j 29 and bound each sum on the rhs as follows first note that since e di 1 e j 1 i 1 f j 13 h se xji 1 i n 30 then write e f i 28 e vq 25 17 v e 1 k p k 3 uk v 1 k p uk e k 1 v 1 k p uk qin i 28 h xi 31 where the inequality arises because the i path flows u 1 up 0 and each i path k transits over at most one arc in e as out i sdom e out ji 1 i 1 n the same arguments that lead to the equality in 27 show that h xi i xi se xji 1 i 1 n substituting this into 31 and then combining with 29 and 30 yields e j 1 i f j i xi se xji 1 i 1 n h se xji 1 i n 20 21 h se xji 1 i 1 n h se xji i 1 n 32 since ji ji 1 in this case this confirms that f i satisfies 13 as f i 1 is an entropi cally feasible 1 i 1 flow 14 is satisfied j 1 i 1 using flow conservation fout i i fin i i 28 vqin i h xi verifying 14 when j i thus f i is an entropically feasible 1 i flow by induction f n is an entropically feasible 1 n flow giving the desired x c feasible multicommodity flow 5 7 20 g n nair structural routability of n pairs information networks 5 2 sufficiency of multicommodity flows the converse part of thm 4 1 is easier to establish since it is not difficult to see that the existence of a feasible multicommodity flow implies achievability thus only the key steps are provided below suppose f is an x c feasible multicommodity flow 5 7 on an n pair net work structure with x stationary and further suppose that 5 is satisfied strictly in the decomposition 10 for each i flow fa i no cycle flow can enter any sink since it has no departing arcs consequently the cycle flows may be taken to be zero in 10 without violating 5 7 yielding f i 1 k pi k i 3 uk i 33 where 1 i pi i are the i paths and u 1 i upi i 0 the i path flows in partic ular h xi 6 fout i fin i i pi k 1 uk i 34 for an arbitrary 0 divide the time axis w into epochs of sufficiently long duration m n such that j n i 1 n h xi j 1 m jm 1 m h xi 0 m 1 m h xi 35 where the first equality arises from stationarity next use huffman coding 6 to losslessly encode each source block xi j 1 m jm 1 j n into binary code words zi j of variable length li j where e li j h xi 0 m 1 1 35 mh xi m 1 36 then partition the bits of zi j into p consecutive sub blocks zi j k k 1 pi of length li j k uk i h xi li j this is always possible since pi k 1 li j k 34 li j padding the last sub blocks with zeros if necessary transmit and route each sub block zi j k along the k th i path k i on every arc a apart from those leaving sources let the arc signal be s t 0 when t mod m 6 m 1 and by s t zi j k i 1 n k 1 pi k i 3 when t jm 1 j n 9 the arc signals leaving sources are set to the respective source signals to satisfy 2 clearly s is setwise causal def 2 1 since every arc signal is constructed by routing blocks along acyclic paths in addition af 9 if an arc is not on any i path then its arc signal may be taken to be 0 g n nair structural routability of n pairs information networks 21 h s 1 m h zi j k i 1 n k 1 pi k i 3 i 1 n k 1 pi k i 3 h zi j k m 37 i 1 n k 1 pi k i 3 e li j k m 38 i 1 n k 1 pi k i 3 1 m uk i mh xi e li j o 1 m i 1 n k 1 pi k i 3 uk i mh xi m 1 mh xi i 1 n k 1 pi k i 3 uk i o o 1 m 33 i 1 n f i o o 1 m f o o 1 m c for sufficiently small and m sufficiently large in the above the bound 37 is due to the subadditivity of entropy and 38 is due to the fact that the expected number of bits needed to uniquely specify the value of a random variable is never less than its entropy furthermore yi jm 1 zi j k pi k 1 zi j xi j 1 m jm 1 consequently s is a solution to the n pairs information network problem x c establishing achievability def 2 2 6 examples in this section several examples are given to illustrate the applicability of thm 4 1 however to begin with a well known counterexample is discussed to avoid cluttering the figures in this section arcs leading out of sources and into sinks are not explicitly depicted 6 1 butterfly network the first example a 2 pairs butterfly network is adapted from 15 11 and depicted in fig 1 for this network it is well known that routing does not achieve coding capacity and it is a useful exercise to verify that it is not downward dominated 22 g n nair structural routability of n pairs information networks 1 2 1 2 fig 1 butterfly network consider the viable 2 cut having the set o 2 of outgoing arcs in the 2 bundle clearly both are downstream of o 2 o 2 2 so c sdom o 2 no other arcs are downstream of c furthermore the indirect 2 walk concisely represented by does not pass through and neither does the indirect 1 walk thus c is the smallest set satisfying all the conditions of def 3 2 i e c sdom o 2 as c does not include any source or sink arcs this network is not downward dominated def 4 4 and thm 4 1 does not apply 6 2 examples that satisfy lemma 4 3 any network where there is at most one directed path from any vertex to any other automatically satisfies the conditions of lemma 4 3 and is therefore dowward dominant and structurally routable thm 4 1 this includes in the first instance both directed lines and directed cycles agreeing with results in 11 10 it also covers more complicated structures for instance directed trees fig 2 and directed cycles arranged in a line or tree structure via one or more gateway nodes fig 3 in all these networks routing achieves coding capacity regardless of where sources and sinks are placed in networks where there there are vertex pairs with two or more connecting paths downward dominance will still hold by virtue of lemma 4 3 if there is at most one path between each pair of source and sink vertices or at least from each s to each h where 1 s h n examples include directed versions of the undirected okamura seymour network fig 4 g n nair structural routability of n pairs information networks 23 fig 2 a directed tree sources and sinks may be attached to any of the nodes depicted fig 3 a tree of directed cycles sources and sinks may be attached to any of the nodes depicted 6 3 examples that satisfy lemma 4 2 now consider the acyclic 2 pairs network in fig 5 observe that there is one 1 path concisely represented by the arc sequence but two 2 paths and hence lemma 4 3 cannot be applied neither would it become applicable if the indices 1 24 g n nair structural routability of n pairs information networks 31 12 4 23 23 fig 4 a directed version of the okamura seymour network only one path exists from any source to any sink and 2 were relabelled 2 and 1 respectively to see this consider the viable 2 cut with o 2 clearly a 2 o 2 and a 1 o 2 6 0 since the 1 path and 2 path both pass through o 2 however the path from 1 to 1 does not in this instance lemma 4 2 can be applied the possible viable 2 cuts have sets o 2 of outgoing arcs in the 2 bundle equal to either or in the first case o 2 has no intersection with any arcs in the 1 bundle and all 2 paths obviously pass through it in the second case all paths from s to h 1 s h 2 pass through o 2 this the requirements of the lemma are met and the network is downward dominant another example of the use of lemma 4 2 is the the cyclic 2 pairs network of fig 6 observe that there is one 1 path and two 2 paths and the possible viable 2 cuts have sets o 2 of outgoing arcs in the 2 bundle equal to either or in the second case o 2 has no intersection with any arc in the 1 bundle and all 2 paths obviously pass through it in the first case o 2 intersects all 2 paths and a 1 path and it can be seen that all from s to h 1 s h 2 pass through o 2 this the requirements of the lemma are met and the network is downward dominant 7 conclusion this chapter examined the routability of possibly cyclic n pairs information net works from a structural perspective the concept of downward dominance was in g n nair structural routability of n pairs information networks 25 2 2 1 1 fig 5 an acyclic network covered by lemma 4 2 2 1 1 1 2 fig 6 a cyclic network covered by lemma 4 2 troduced and it was shown that for networks with downward dominated structures routability and achievability are equivalent i e a given combination of source sig nals demand rates and channel capacities is achievable iff the network supports a feasible multicommodity flow 26 g n nair structural routability of n pairs information networks downward dominance is a conservative structural condition and future work will focus on trying to relax it the inductive nature of the proof of necessity here re quires it directly so any generalisation may need a very different analysis technique acknowledgements the author acknowledges discussions on the decentralised control version of this problem with prof rob evans at the university of melbourne he is also indebted to the anonymous isit 11 reviewer who pointed out an error in the original version of 14 references 1 adler m harvey n j a jain k kleinberg r lehman a r on the capacity of informa tion networks in proc 17 th annual acm siam symp discrete algorithms pp 241 50 miami usa 2006 2 ahlswede r cai n li s w r yeung r w network information flow ieee trans info the 46 4 1204 16 2000 3 antsaklis p baillieul j eds special issue on the technology of networked control sys tems in proc ieee vol 95 ieee 2007 4 bang jensen j gutin g digraphs theory algorithms and applications springer 2007 5 cannons j dougherty r freiling c zeger k network routing capacity ieee trans info the 52 3 777 788 2006 6 cover t m thomas j a elements of information theory wiley 1991 7 dougherty r freiling c zeger k insufficiency of linear coding in network information flow ieee trans info the 51 8 2745 59 2005 8 fragouli c soljanin e network coding applications now publishers 2008 9 han t s multicasting multiple correlated sources to multiple sinks over a noisy channel network ieee trans info the 57 1 4 13 2011 10 harvey n j a kleinberg r lehman a r on the capacity of information networks ieee trans info the 52 6 2345 64 2006 11 kramer g savari s a edge cut bounds on network coding rates jour network and syst management 14 1 49 67 2006 12 leighton t rao s multicommodity max flow min cut theorems and their use in designing approximation algorithms jour acm 46 6 787 832 1999 13 li s y r yeung r w cai n linear network coding ieee trans info the 49 2 371 81 2003 14 nair g n when is n pairs information a multicommodity flow in ieee int symp info theory proc pp 169 73 st petersburg russia 2011 15 yeung r w multilevel diversity coding with distortion ieee trans info the 41 2 412 22 1995 16 zhou k doyle j glover k robust and optimal control prentice hall usa 1996 structural routability ofn pairs information networks girish n nair 1 introduction 1 1 notation and basic terminology 2 problem formulation 3 preliminary notions 4 main result 5 proof of theorem 4 1 5 1 necessity proof for theorem 4 1 5 2 sufficiency of multicommodity flows 6 examples 6 1 butterfly network 6 2 examples that satisfy lemma 4 3 6 3 examples that satisfy lemma 4 2 7 conclusion references