order forcing in neural codes r amzi jeffs caitlin lienkaemper and nora youngs abstract convex neural codes are subsets of the boolean lattice that record the inter section patterns of convex sets in euclidean space much work in recent years has focused on finding combinatorial criteria on codes that can be used to classify whether or not a code is convex in this paper we introduce order forcing a combinatorial tool which recognizes when certain regions in a realization of a code must appear along a line segment between other regions we use order forcing to construct novel examples of non convex codes and to expand existing families of examples we also construct a family of codes which shows that a dimension bound of cruz giusti itskov and kronholm referred to as monotonicity of open convexity is tight in all dimensions 1 introduction a combinatorial neural code or simply neural code is a subset of the boolean lattice 2 n where n 1 2 n a neural code is called convex if it records the intersection pattern of a collection of convex sets in rd more specifically a code c 2 n is open convex if there exists a collection of convex open sets u u 1 un in rd such that c i ui j uj 6 the region i ui j uj is called the atom of in u and is denoted a u the collection u is called an open realization of c and the smallest dimension d in which one can find an open realization is called the open embedding dimension of c denoted odim c analogously one may consider closed convex sets to obtain notions of closed convex codes closed realizations and closed embedding dimension the study of convex codes is motivated by the problem in neuroscience of characterizing which patterns of neural activity can arise from neurons with approximately convex receptive fields such as hippocampal place cells 4 18 further the task of characterizing convex codes is mathematically interesting in its own right explaining why certain codes are not convex has required the development of new and interesting theorems in discrete geometry 11 12 and has connections to established mathematical theories such as that of oriented matroids 16 there is a sizeable body of work on determining combinatorial criteria that can detect whether or not a code is convex in addition to above cited works see 1 3 5 7 9 13 15 17 but a complete characterization of convexity remains elusive in this paper we introduce a combinatorial concept that we call order forcing see defini tion 2 10 order forcing provides an elementary connection between the combinatorics of a code and the geometric arrangement of atoms in its open or closed realizations as described in theorem 1 1 below theorem 1 1 let 1 2 k be an order forced sequence of codewords in a code c 2 n let u u 1 un be a closed or open convex realization of c and let x au 1 and 1 ar x iv 2 01 1 03 57 2 v 2 m at h c o 1 7 d ec 2 02 0 order forcing in neural codes 2 y au k then the line segment xy must pass through the atoms of 1 2 k in this order we prove theorem 1 1 in section 2 and also provide several basic examples of order forcing another important class of codes is those which can be realized using a good covers a good cover is a collection of sets u 1 un in rd all open or all closed such that i ui is either empty or contractible for all nonempty n every convex realization is also a good cover but not every good cover code is convex previous examples of non convex good cover codes have required technical geometric results to describe see 2 12 14 17 in section 3 we use order forcing to describe new good cover codes that are not convex we generalize a minimally non convex code from 13 based on sunflowers of convex open sets to a family ln n 0 of minimally non convex good cover codes proposition 3 5 we build a good cover code r that is neither open nor closed convex by using order forcing to guarantee that two disjoint sets would cross one another in a convex realization of r proposition 3 6 this example is notable in that it relies on the order that codewords appear along line segments rather than just certain codewords being between one another we build a good cover code t that is neither open nor closed convex by using order forcing to guarantee a non convex twisting in every realization of t proposition 3 7 these examples illustrate the utility of order forcing the codes t and r have the advan tage that they require only elementary geometric techniques i e order forcing to analyze the codes t and r are also the first natural examples we know of of good cover codes which are neither open nor closed convex in the sense that they are not the disjoint union of a code which is open but not closed convex and a code which is closed but open convex in section 4 we build on results of 3 using tools from 12 to prove that adding a non maximal codeword to a code may increase its open embedding dimension no matter what value the open embedding dimension has more precisely we describe for every d 1 a code pd such that odim pd d and odim pd d 1 for some new non maximal codeword this shows that a monotonicity bound described in 3 is tight for the family of codes pd d 1 the techniques used in section 4 hint at potential generalizations of order forcing which we discuss in section 5 along with other open questions 2 order forcing when we constrain ourselves to realizations that use only open or only closed convex regions ui we restrict not only which codes may be realized but how regions in these realizations can be arranged in particular when we move along continuous paths through realizations composed of open or closed sets ui we are limited in the transitions we can make from one atom to the next lemma 2 1 suppose c 2 n is a neural code with a good cover realization u and let and be codewords of c if there are points p au and p au and a continuous path from p to p that is contained in a u au that is if the atoms are adjacent in the realization then either or order forcing in neural codes 3 proof let p be the image of a continuous path from p to p with p au au suppose for contradiction that 6 and 6 then there exist elements i and j but then ui p and uj p partition p every point in p is in exactly one of au or au and thus in exactly one of ui or uj since our good cover consists of sets that are all open or all closed the sets ui p and uj p are both relatively open or both relatively closed in p this contradicts the fact that p is connected so or as desired thus as we move continuously through any good cover realization of a code we are moving along edges in the following graph gc definition 2 2 let c 2 n be a neural code the codeword containment graph of c is the graph gc whose vertices are codewords of c with edges when either or note that this graph is also defined in 1 example 2 3 consider the code c 1235 1245 1256 125 13 14 15 the graph gc for this code is shown in figure 1 figure 1 the codeword containment graph gc for the code in example 2 3 lemma 2 1 implies that any continuous path from one codeword region to another code word region in an open or closed realization of the code c must correspond to a walk in the graph gc for straight line paths within a convex realization this walk must respect convexity a property we call feasibility see lemma 2 6 definition 2 4 let c be a neural code and gc its codeword containment graph a walk v 1 v 2 vk in gc is called feasible if vi vj vm for all 1 i m j k in general if there exists a feasible walk then by removing portions of the walk between repeated vertices we can obtain a feasible path this does not however mean that there is a corresponding straight line path in the realization which would follow precisely this sequence of codewords for example one could form a closed realization of the code 1 2 3 in which u 2 is a hyperplane and u 1 and u 3 are contained in its positive and negative side respectively then any straight line from the atom of 1 to the atom of 3 must pass through the atom of 2 but the path 1 3 is a feasible path in gc regardless example 2 5 example 2 3 continued consider the codewords 13 and 14 in c from the code in example 2 3 there are many walks however not all are feasi ble for example the walk 13 1235 15 1245 14 would not be feasible however the walk order forcing in neural codes 4 13 1235 125 1275 125 1245 is a feasible walk this walk contains the feasible path 13 1235 125 1245 14 which in this case is the unique feasible path lemma 2 6 suppose c 2 n is a neural code with a convex realization u u 1 un and let and be codewords of c if there are points p au and p au then the sequence of atoms along the line p p forms a feasible walk in gc proof select points p au and p au and let the sequence of atoms along the line be given by 1 2 by lemma 2 1 if we cross directly from a u i to au i 1 along the path xy then either i i 1 or i 1 i thus i i 1 is an edge of gc thus 1 is a walk in gc to check feasibility we need to show that for all i j k i k j we can choose points xi xj and xj in this order along p p such that xi au i xj a u j xk au k since u 1 un is a convex realization and intersections of convex sets are convex u i k is a convex set by the definition of a convex set the line segment xixk is contained in u i k thus xj u i k so i k j thus 1 is a feasible walk the idea of feasibility gives us a new tool for finding possible obstructions to convexity in any convex realization of a code straight line paths between points in the same set ui must correspond to feasible walks in the graph and so codes where feasible walks are rare or nonexistent can force us into contradictions to that end we define a few particular restrictions we will encounter definition 2 7 let c be a neural code and gc its codeword containment graph we say a vertex v of gc is forced between vertices and if every feasible path passes through v example 2 8 example 2 3 continued in the codeword containment graph gc we see that 1245 is forced between 14 and 15 there are many possible feasible paths from 14 to 15 for example 14 1245 15 or 14 1245 125 15 or 14 1245 125 1235 15 but all these paths must use 1245 in cases where there are multiple codewords forced between two vertices of our graph we often find that these vertices are also forced into a particular order a situation we call order forcing definition 2 9 let c be a neural code and gc its corresponding graph a sequence of codewords 1 k is order forced if every feasible 1 k path contains these codewords as a subsequence definition 2 10 let c be a neural code and gc its corresponding graph a feasible path 1 k is strongly order forced if 1 k is the unique feasible 1 k walk in gc example 2 11 consider the code c 2456 123 145 437 467 45 46 47 1 2 3 in this code the sequence 145 45 2456 46 467 47 473 is strongly order forced in order to have a path in gc from 145 to 437 which is feasible we can certainly only use codewords which contain 4 if we restrict to the portion of gc which contains 4 we have that this subgraph is a path with endpoints 145 and 437 thus there is a unique path from 145 to 437 and we can check that this path is feasible order forcing in neural codes 5 proof of theorem 1 1 let 1 k be an order forced sequence in a code c let u u 1 un be a closed or open convex realization of c let x au 1 and y a u k and let xy be the line segment from x to y let 1 1 2 k be the sequence of atoms along xy by lemma 2 6 we have that 1 is a feasible walk from 1 to k in gc since every feasible walk from 1 to k contains a feasible path from 1 to k and every feasible path from 1 to k contains 1 2 k as a subsequence this suffices to prove theorem 1 1 the situation where a codeword v is forced between and is a special case of order forcing and in this case we obtain the following result once we know that a sequence is order forced in a code c we are often able to obtain several instances of order forcing corollary 2 12 let c 2 n and suppose u u 1 un is a closed or open convex realization of a code c if v c is forced between and then for any x au and y au the line segment xy must pass through the atom of v in the following example we illustrate the value of these ideas by showing a proof that a relatively small code is open convex but not closed convex example 2 13 in 3 the authors provide an example of a code which is open convex but not closed convex this example in particular the proof that it has no closed convex realization is an instance of order forcing though it was not described by that name in 3 a slightly smaller example of a similar code which is closed convex but not open convex appears as code c 15 in 9 in this example we give a proof of this result which resembles the proof in 3 lemma 2 9 but is written to make the use of order forcing explicit the code c 123 234 345 145 125 12 23 34 45 15 has an open convex realization but does not have a closed convex realization to see that an open convex realization exists we exhibit one in figure 2 figure 2 a realization of c using open sets the regions u 1 u 5 are open half discs to show that no closed convex realization may exist we proceed by contradiction suppose that for some d 1 there exists a closed convex realization u 1 u 5 of c in rd select points p 125 u 125 and p 345 u 345 since both points are within the convex set u 5 the line segment l 1 from p 125 to p 345 is contained within u 5 thus it cannot pass through u 123 order forcing in neural codes 6 note that u 123 is a closed set as 123 is a maximal codeword pick a point p 123 u 123 which minimizes the distance to the set l 1 this is possible as these sets are disjoint and l 1 is compact now consider the line segment l 2 from p 125 to p 123 note that l 2 u 12 in this code 12 is forced between 125 and 123 so by corollary 2 12 there exists a point p 12 between p 125 and p 123 along this line which is in a u 12 likewise if we consider the line segment l 3 from p 123 to p 345 the order forced sequence 123 23 234 34 345 implies there is a point p 234 u 234 on l 3 which is between p 123 and p 345 finally consider the line segment l 4 between p 12 and p 234 l 4 must pass through u 123 somewhere between these points because 123 is forced between 12 and 234 select a point q 123 on this line and within u 123 then q 123 will be closer to l 1 than p 123 a contradiction 3 new examples of non convex codes in this section we demonstrate the power of order forcing by using order forcing to con struct a new infinite family of minimally non convex codes and two new non convex codes 3 1 stretching sunflowers early examples of good cover codes which are not convex come from a result about sunflowers of convex open sets described further in section 4 the d 2 case of this theorem was used as a lemma to give the first example of a non convex good cover code in 17 theorem 3 1 in this section we give a new infinite family of non convex codes generalizing this code in order to produce further examples of non convex codes we need a notion of what it means for a new code to be genuinely different from an old one for instance it is easy to produce new non convex codes by relabeling neurons or by adding more neurons in some trivial way a notion of minors for codes gives a partial answer to this problem minors were introduced in 13 via a partial order on all appropriate equivalence classes of codes though were only called minors beginning in 11 this framework has been further developed in 12 16 we define minors and related notions below definition 3 1 let c 2 n be a code a trunk in c is a set of the form tkc c c c or the empty set a morphism is a function between codes such that the preimage of a trunk is again a trunk definition 3 2 a code c is a minor of d written c d if there is a surjective morphism f d c the poset of all codes partially ordered via minors is denoted pcode the main relevance of minors in our context is the following see 11 section 9 for details proposition 3 3 suppose that d is a minor of c then odim d odim c and cdim d cdim c as a result open respectively closed convexity is preserved when replacing a code by a minor we may therefore define a notion of minimal non convexity for open or closed convex codes we say that a code c is minimally non convex when it is not open convex but all of its proper minors are open convex for instance 13 theorem 5 10 gives a minimally non convex good cover code c 0 3456 123 145 256 45 56 1 2 3 order forcing in neural codes 7 this code is a proper minor of the first non convex good cover code which is described in 17 theorem 3 1 in this subsection we introduce a family of codes ln n 0 which generalize c 0 to an infinite family of minimally non convex codes geometrically each of these codes is only a small modification of the code c 0 and has the same basic obstruction to convexity this lies in contrast to 12 theorem 4 2 which generalizes the non convex code c 0 in 13 theorem 5 10 to an infinite family of minimally non convex codes by using higher dimensional versions of the sunflower theorem thus the family ln n 0 demonstrates that the intuition that each minimally non convex code should result from a new obstruction to convexity does not hold u 1 u 2 u 3 u 4 u 5 u 6 u 7 123 31 2 145 245645 46 467 47 347 figure 3 l 1 2456 123 145 437 467 45 46 47 1 2 3 definition 3 4 for n 0 define the code ln 1 2 3 123 145 45 2456 46 467 47 478 4 n 6 34 n 6 for instance l 1 2456 123 145 437 467 45 46 47 1 2 3 a good cover realiza tion of l 1 is given in figure 3 notice below that l 0 is equal to c 0 under the permutation of the neurons 2 3 and 4 5 thus the family ln generalizes c 0 even though each ln is minimally non convex the non convexity of l 0 directly implies the non convexity of each ln for n 0 proposition 3 5 for n 0 the code ln is a good cover code but is minimally non convex proof we first show that ln is non convex by induction on n the base case that l 0 is non convex is proven by 13 theorem 5 10 since l 0 is permutation equivalent to c 0 now we show that if ln 1 is not convex then neither is ln we do this by proving the contra positive in any convex realization of ln we can merge the sets un 5 and un 6 in a convex realization of ln to produce a convex realization of ln 1 that is if u 1 un 5 un 6 is a convex realization of ln then v 1 vn 5 is a convex realization of ln 1 where v 1 u 1 vn 4 un 4 vn 5 un 5 un 6 this gives us two things to check first we must check that code v 1 vn 5 ln 1 if is a codeword of ln code u 1 un 6 which does not contain the neuron n 6 order forcing in neural codes 8 then is still a codeword of code v 1 vn 5 the three codewords of ln which contain n 6 are 4 n 5 n 6 4 n 6 and 34 n 6 if we pick a point p in the atom of 4 n 5 n 6 or 4 n 6 with respect to u 1 un it is now in the atom of 4 n 5 if we pick a point in the atom of 34 n 6 with respect to u 1 un 6 it is in the atom of 34 n 5 with respect to v 1 vn 6 next we must check that v 5 un 5 un 6 is convex that is we must check that for each pair of points x y un 5 un 6 the line segment from x to y is contained in un 5 un 6 without loss of generality let x un 5 un 6 y un 6 un 5 the point x must be contained in the atom of 4 n 5 or 4 n 5 n 4 if n 1 4 n 5 n 4 replaces with 24 n 5 n 4 the point y must be contained in the atom of 4 n 6 or 34 n 6 in all of these cases the only feasible path from x to y in gln includes only codewords containing n 5 or n 6 4 n 5 4 n 5 n 6 4 n 6 34 n 6 thus the line segment from x to y is contained in un 6 un 6 see figure 4 for an illustration of this argument to show that ln is minimally nonconvex we must show that all codes covered by ln in the poset pcode are convex we give a proof of this in appendix a construction a 1 our proof uses ideas similar to the idea of a rigid structure in section 4 of 1 in particular our argument that un 5 un 6 must be convex is essentially an open convex version of a rigid structure which is a subset of neurons whose union must be convex in any closed convex realization of a code 3 2 simple proofs of nonconvexity in this section we give two new examples of good cover codes which are neither open nor closed convex the proofs that these codes are not convex depend only on order forcing and elementary geometric arguments below we use lowercase letters for neurons where it would be cumbersome to use only integers proposition 3 6 the code r 12 ab 13 ace 14 ch 23 bgd 24 dj 35 ef 36 fg 46 hi 45 ij 1 a 1 c 2 b 2 d 3 e 3 f 3 g 4 i 4 h 4 j 5 6 is a good cover code but is neither open nor closed convex proof we first show that if r is convex then it has a convex realization in the plane we then show that it does not choose points p 12 au 12 ab p 14 a u 14 ch and p 24 a u 24 dj we will use order forcing to show that each atom of any realization of r must have nonempty intersection with a conv p 12 p 14 p 24 so that ui a i 1 6 a h is a convex realization of r in aff p 12 p 14 p 24 r 2 first notice the following order forced sequences 1 the only feasible path from 12 ab to 14 ch is 12 ab 1 a 13 ace 1 c 14 ch 2 the only feasible path from 12 ab to 24 dj is 12 ab 2 b 23 bdg 2 d 24 dj order forcing in neural codes 9 u 1 u 2 u 3 u 4 u 5 u 6 un 6 un 5 v 1 v 2 v 3 v 4 v 5 v 6 vn 5 p q figure 4 a sketch of the proof of proposition 3 5 since the union of un 5 and un 6 is forced to be convex we can use a realization of ln to construct a realization of ln 1 3 the only feasible path from 14 ch to 24 djis 14 ch 4 h 46 hi 45 ij 4 j 24 dj 4 the only feasible path from 13 ace to 23 bgd is 13 ace 3 e 35 ef 3 f 36 fg 3 g 23 bgd 5 the only feasible path from 35 ef to 45 ij is 35 ef 5 45 ij 6 the only feasible path from 36 fg to 46 hi is 36 fg 6 46 hi now by theorem 1 1 and order forcings 1 2 and 4 the atoms corresponding to code words 12 ab 1 a 13 ace 1 c 14 ch 2 b 23 bdg 2 d 24 dj 4 h 46 hi 45 ij 4 j have nonempty intersection with a thus we can pick p 13 a au 13 ace p 23 a au 23 bdg p 45 a au 45 ij and p 46 a au 46 hi applying order forcing 3 to p 13 and p 23 we deduce order forcing in neural codes 10 u 1 u 2 u 3 u 4 u 5 u 6 12 ab 1 a 2 b 13 ace 3 e 35 ef 3 f 36 fg 3 g 23 bgd 5 6 1 c 14 ch 4 h 46 hi 4 i 45 ij 4 j 24 dj 2 d figure 5 a good cover realization of the non convex coder in r 3 the open sets ua ub uc ud ue uf ug uh ui uj are not shown instead maximal order forced codewords are noted with vertices and sets of order forced vertices are indicated with dashed lines that the atoms corresponding to codewords 3 e 35 ef 3 f 36 fg 3 g have nonempty intersection with a thus we can pick p 35 a au 35 ef and p 36 a a u 36 fg finally applying order forcings 5 and 6 we deduce that the atoms corresponding to codewords 5 6 have nonempty intersection with a this accounts for all codewords of r next we show that r cannot have a realization in the plane note that by applying an appropriate affine transformation we can assume that p 12 is above p 14 and p 24 with p 14 to the left of p 24 as pictured in figure 5 then by order forcings 3 and 4 p 35 must be to the left of p 36 while p 45 must be to the right of p 46 this implies the line segments p 35 p 45 and p 36 p 46 must intersect but if p p 35 p 45 p 36 p 46 then p u 5 u 6 but since u 5 and u 6 must be disjoint in any realization of r this is not possible proposition 3 7 the code t 14 a 15 ab 16 bg 25 c 24 cd 26 dgh 34 e 35 ef 36 fh 1 a 1 b 2 c 2 d 3 e 3 f 6 g 6 h 4 5 is a good cover code but is neither closed nor open convex order forcing in neural codes 11 u 1 u 2 u 3 u 4 u 5 u 6 14 a 1 a 15 ab 1 b 16 bg 4 5 25 c 2 c 24 cd 2 d 26 dgh 6 g 34 e 3 e 35 ef 3 f 36 fh 6 h 5 4 figure 6 a good cover realization of the code t 14 a 15 ab 16 bg 25 c 24 cd 26 dgh 34 e 35 ef 36 fh 1 a 1 b 2 c 2 d 3 e 3 f 6 g 6 h 4 5 in r 3 the sets u 1 u 6 are highlighted with various colors while ua uh are not highlighted proof suppose to the contrary that t has a convex realization u 1 u 6 ua uh since the sets u 4 and u 5 must be disjoint convex sets which are either both open or both closed there exists a hyperplane h separating them in particular if u 4 and u 5 are both open then by the open set version of the hyperplane separation theorem there is a hyperplane strictly separates them that is h separates rn into open half spaces h and h with u 4 h and u 5 h this also holds if u 4 and u 5 are both closed in this case then without loss of generality we can choose both sets to be compact thus by the compact set version of the separating hyperplane theorem there exists a hyperplane h strictly separating them we will use order forcing to exhibit a line segment which crosses h twice a contradiction we show that the triples of codewords corresponding to marked points in figure 6 are order forced more specifically we have that 1 the only feasible path from 14 a to 16 bg is 14 a 1 a 15 ab 1 b 16 bg 2 the only feasible path from 25 c to 26 dgh is 25 c 2 c 24 cd 2 d 26 dgh 3 the only feasible path from 34 e to 36 fh is 34 e 3 e 35 ef 3 f 36 fh order forcing in neural codes 12 4 the only feasible path from 16 bg to 36 fh is 16 bg 6 g 26 dgh 6 h 36 fh choose points p 14 u 14 a p 16 u 16 bg p 25 u 25 c p 34 u 34 e and p 36 u 36 fh define line segments l 1 p 14 p 16 and l 3 p 34 p 36 notice that by order forcing 1 we may choose p 15 l 1 u 15 ab similarly by order forcing 3 we may choose p 35 l 3 u 35 ef by ordering forcing 4 we may choose a point p 26 u 26 dgh on the line segment p 16 p 36 lastly order forcing 2 allows us to choose a point p 24 u 24 cd on the line segment l 2 p 25 p 26 since each of l 1 and l 3 can only cross h once the fact that p 14 and p 34 are contained in u 4 and thus in h implies that the points p 16 and p 36 are contained in h likewise the fact that l 2 crosses h only once and p 25 is contained in u 5 and thus in h implies that the point p 26 is contained in h thus the line from p 16 to p 36 crosses h twice a contradiction note that both of these codes can be used to generate infinite families of non convex codes using the same trick we use to produce ln from l 0 the codes t and r do not lie above any previously known non convex codes in pcode and in fact are minimally non convex this can be checked by exhaustive search of the codes that they cover in pcode as described in definition a 2 4 strict monotonicity of convexity in all dimensions in this section we turn our attention to a result of 3 which states that open convexity is a monotone property of codes in the following sense adding non maximal codewords to an open convex code preserves its convexity in fact 3 proved that adding non maximal codewords cannot increase the open embedding dimension of a code by more than one surprisingly the same results do not hold for codes that can be realized by closed convex sets 7 we now formally state this monotonicity result theorem 4 1 theorem 1 3 in 3 let c d be codes with the same maximal codewords then odim d odim c 1 a natural question arises under what circumstances is the 1 term above necessary that is when does adding a non maximal codeword strictly increase the open embedding dimension of a code the authors in 3 give an example for which odim c 1 and odim d 2 but do not study the possible gap between odim c and odim d for codes with larger embedding dimensions in the remainder of this section we will show that for any d 1 there are codes c d with the same maximal codewords such that odim c d and odim d d 1 in other words we will show that odim c may strictly increase when a non maximal codeword is added to c no matter the value of odim c our approach to proving this result is similar to order forcing in particular we leverage a result about sunflowers of convex open sets theorem 4 6 to show that a certain atom must appear between other atoms in every realization of a code this points towards the potential to generalize the order forcing framework in the future from examining line segments to examining convex hulls of more than two points see question 5 1 this is particularly promising because our results in this section allow us to determine the exact open embedding order forcing in neural codes 13 dimension of certain codes which is more refined information than whether or not they are convex our primary tool will be the following family of codes below we make use of neurons decorated by an overline to simplify our notation in particular when n we let i i and the neurons in are distinct from those in definition 4 2 let d 1 the d th prism code denoted pd is the code on neurons 1 2 d 1 1 2 d 2 which has the following codewords i all subsets of 1 2 d 1 i i for each i between 1 and d 1 ii 1 2 d 2 observe that pd is intersection complete and has d 2 maximal codewords we start by characterizing the open embedding dimension of pd proposition 4 3 odim pd d proof note that every d subset of d 1 appears in some codeword of pd but d 1 does not appear in any codeword this implies that the receptive fields of the neurons 1 2 d 1 in any realization of pd will have a nerve that is the boundary of a d simplex this can only occur in dimension d or higher see 19 section 1 2 or 6 for further details and so odim pd d to prove that odim pd d we must exhibit a realization of pd in rd this is done in in appendix a with construction a 3 when d 2 this construction is shown in example 4 4 below example 4 4 figure 7 shows a realization of p 2 123 123 123 1234 12 13 23 12 13 21 23 31 32 1 2 3 1 2 3 in r 2 as given by the proof of proposition 4 3 the shaved off regions arise at the rounded corners realizing the codewords 12 13 and 23 observe that we could not modify this realization to add the codeword 4 since any extension of v 4 outside the central triangle would overlap v 1 v 2 or v 3 we will formalize this observation in theorem 4 7 to prove our monotonicity result we apply a recent geometric result on sunflowers of convex open sets introduced below definition 4 5 let u u 1 un be a collection of convex open sets in rd we say that u is a sunflower if ui uj k n uk 6 for all i 6 j equivalently u is a sunflower if code u contains the codeword n and all other codewords contain no more than one neuron when u is a sunflower the ui are called petals and k n ui is called the center of the sunflower theorem 4 6 corollary 2 1 in 12 let u u 1 ud 1 be a sunflower in rd and for i d 1 choose pi ui then conv p 1 pd 1 contains a point in the center of u roughly theorem 4 6 says that the petals of a sunflower u are rigid in the sense that not too many can point in the same direction this result is relevant to our family of codes pd because the receptive fields of neurons 1 d 2 in a realization of pd will always form a sunflower theorem 4 7 let d 1 then odim pd d 2 d 1 that is adding a non maximal codeword to pd may increase its open embedding dimension order forcing in neural codes 14 figure 7 a realization of p 2 in r 2 proof let c pd d 2 by theorem 4 1 and proposition 4 3 we know that odim c d 1 it remains to show that there is no realization of c in rd suppose for contradiction that there exists a realization u 1 ud 1 v 1 vd 2 of c in rd where ui corresponds to the neuron i and vi corresponds to the neuron i since the only codeword in c containing i and j for i 6 j is 1 d 2 the sets v 1 vd 2 must form a sunflower in rd call its center v and for each i between 1 and d 1 choose a point pi in the intersection vi j 6 i uj since the region vi j 6 i uj is open we may assume that the pi are in general position so that their convex hull is a d simplex theorem 4 6 tells us that conv p 1 pd 1 contains a point in v in fact we claim that this convex hull contains the entirety of v if not then v would have to cross one of the facets of the simplex conv p 1 pd 1 since we are working in rd by choice of pi each of these facets is contained in some uj since v is disjoint from all uj it cannot cross any of these facets thus v is contained in conv p 1 pd 1 since d 2 is a codeword in c we may choose a point p vd 2 v and examine a generic line segment l from p to a point in v let h be a hyperplane supporting v at the point where l crosses the boundary of v observe that h separates p from v and moreover no pi may lie on the same side of h as p otherwise vi and vd 2 would meet outside of v order forcing in neural codes 15 violating the definition of a sunflower thus h separates p from all pi and p lies outside conv p 1 pd 1 since v is contained in conv p 1 pd 1 the line l crosses the boundary of this simplex since l is contained in vd 2 this implies that vd 2 intersects some ui but the only codewords of c containing d 2 are d 2 and 1 2 d 2 so this is a contradiction thus c is not convex in rd and the result follows 5 conclusion and open questions past work constructing non convex codes has used notions that are similar to but distinct from order forcing for example sunflower theorems such as 12 theorem 1 1 and 11 theorem 1 11 were used to show that the convex hull of points sampled from certain atoms in a convex realization must intersect another atom likewise 14 used collapses of simplicial complexes to prove that in certain codes the convex hull of appropriately chosen points must intersect certain atoms order forcing brings a new perspective to this general approach not only must certain atoms appear but they must appear in a certain arrangement i e in a particular order along a line segment the order of points on a line may be generalized to higher dimensions by examining the order type of a point configuration 10 we thus ask the following question 5 1 does there exist a general result connecting the combinatorial structure of a code c to the order type of points chosen from certain atoms in any convex realization of c can such a result be formulated so that the connections between convex codes and sunflower theorems 11 12 convex union representable complexes 14 or oriented matroids 16 are special cases a cleanly formulated answer to question 5 1 would allow us to create fundamentally new families of non convex codes to connect the combinatorics of order forcing with the geometry of convex realizations we examined straight line segments between different atoms one could try to replace convex realizations by good cover realizations and straight lines by continuous paths which leads to the following question question 5 2 if c is a good cover code are there feasible paths between all pairs of codewords in c our examples have used order forcing to prove that codes are not convex however even if a code is convex one might hope to use order forcing to bound its open or closed embedding dimension question 5 3 can one use order forcing to provide new lower bounds on the open or closed embedding dimension of codes morphisms and minors of codes have played a role in characterizing minimal obstructions to convexity contextualizing results and systematizing the study of convex codes 11 13 it would be interesting to phrase our results in this framework question 5 4 how does order forcing interact with code morphisms and minors if f c d is a morphism and 1 2 k is an order forced sequence in c under what conditions is f 1 f 2 f k order forced in d similarly if f is surjective and 1 2 k is order forced in d when can we find 1 k order forced in c with f i i i e when can we pull back an order forced sequence order forcing in neural codes 16 work in 16 used minors of codes to tie the study of convex codes to the study of oriented matroids in particular showing that non convex codes come in two types those that are minors of non representable oriented matroid codes and those that are not minors of any oriented matroid code concretely it would be useful to understand which of these classes our codes t and r fall into question 5 5 are the codes t and r from section 3 minors of oriented matroid codes 6 acknowledgements the authors are grateful to anne shiu for detailed comments on an earlier draft cl and ny are grateful to isabella novik for inviting them on a research visit to the university of washington where this project began cl was supported by the nsf dge 1255832 raj was supported by the nsf dge 1761124 appendix a constructions of various realizations construction a 1 in order to check that ln is minimally non convex for all n we must show that all codes covered by ln in pcode are convex for this we need the following characterization from 12 of the covering relations in pcode definition a 2 definition 3 9 of 12 let c 2 n be a code let i n and let n i consider the morphism fi c 2 defined by f c c i c c c i c the i th covered code of c is the image of c under fi and is denoted c i importantly if a code d is covered by c in pcode then d must be one of the covered codes described above thus to prove that a non convex code c is minimally non convex it suffices to prove that all of its covered codes are convex a useful geometric interpretation of covered codes is as follows suppose that u u 1 un is a possibly not convex realization of c then we may obtain a realiza tion of c i by deleting ui from u and adding sets uj ui uj for all j 6 i in some cases there may be distinct neurons j k such that uj uk in this cases one of the neurons j k is redundant and we can remove it from the code without discarding geometric information more generally a neuron j is redundant to a set n j if tkc j tkc and a neuron is trivial if it does not appear in any codeword 13 a code is reduced if it does not have any trivial or redundant neurons theorem 1 4 of 13 states that a code is always isomorphic to a reduced code thus convexity of the reduced code is equivalent to convexity of the original code thus we can clean up c i by removing all trivial or redundant neurons in what follows we give realizations for reduced versions of all codes mentioned thus to show that ln is minimal for all n we need to construct realizations for each covered code l i n in figure 8 we construct realizations of l 1 n l 2 n and l 3 n in r 2 in figure 9 we construct a realization of l 4 n in r 3 finally in figure 10 we construct a convex realization of l 7 n in r 3 an analogous process can be used to construct convex realizations of l 8 n l n 6 n order forcing in neural codes 17 u 4 u 5 u 6 un 6 un 5 u 2 u 4 u 3 u 2 u 1 u 3 u 4 u 5 u 6 un 6 un 5 u 1 u 4 u 1 u 4 u 5 u 6 un 6 un 5 u 2 u 3 u 4 figure 8 convex realizations in r 2 of the codes l 1 n l 2 n l 3 n construction a 3 the code pd of definition 4 2 has an open convex realization in rd proof first choose points p 1 pd where pi ei in rd also choose pd 1 1 the vector whose entries are all 1 for i d 1 define fi to be the facet conv pj j 6 i of the d simplex conv p 1 pd 1 and let ui to be the minkowski sum of fi with a small ball of radius choose a small d simplex with center of mass at the origin and facet normal vectors equal to the various pi and let v denote its interior for i d 1 define vi to be minkowski sum of v with a ray in the direction of pi lastly define vd 2 to be equal to v observe that we may choose v small enough that its closure is contained in the interior of conv p 1 pd 1 we may then choose small enough that the various ui do not intersect order forcing in neural codes 18 u 1 u 2 u 3 u 4 u 5 u 6 u 8 un 5 un 6 u 7 figure 9 a convex realization in r 3 of the code l 7 n an analogous con struction can be used to construct convex realizations for l 5 n l 6 n and l 8 n l n 6 n in r 3 v let d denote the code arising from this realization we claim that d has the same maximal codewords as pd and that d pd let us first determine the maximal codewords that arise in d one maximal codeword is 1 d 2 which arises only inside v the codeword 1 2 d 1 i i arises in a small neighborhood of the point pi and it is maximal since this neighborhood can be separated from ui and all vj with j 6 i by a hyperplane with normal vector equal to pi this shows that the maximal codewords of pd arise as maximal codewords in d we must argue that no other maximal codewords arise clearly the only maximal code word containing d 2 is 1 d 2 since v vd 2 is disjoint from all ui the other possibilities are a maximal codeword that contains d 1 or a maximal codeword that con tains i i for some i d 1 the former is impossible since we have chosen small enough that various ui do not intersect v and thus do not all meet at a single point the latter is impossible because vi and ui are separated by a hyperplane parallel to fi thus the maximal codewords arising in d are exactly those in pd we next show that the non maximal codewords in d are codewords in pd first let us consider the codewords ofd that do not contain any i d 1 by construction the various vi only overlap inside v and so the only codewords of this type ind are the singleton codewords i for i d 1 which arise near the face of v with normal vector pi and vd 2 v so order forcing in neural codes 19 u 1 u 2 u 3 u 4 u 5 u 6 u 6 u 8 u 8 un 5 un 6 figure 10 a convex realization in r 3 of the code l 7 n an analogous con struction can be used to construct convex realizations for l 5 n l 6 n and l 8 n l n 6 n in r 3 d 2 does not arise as a singleton codeword any other codeword of d contains a neuron i d 1 and is thus contained in some maximal codeword 1 2 d 1 i i but pd contains all subsets of 1 2 d 1 i i and so we conclude that d pd we now modify our realization u 1 ud 1 v 1 vd 2 to obtain a realization of pd by applying techniques of 3 section 5 4 since we are working in rd we may choose an open ball b whose boundary contains every pi let us replace every set in our realization by its intersection with b the resulting code is still contained in pd and since b contains the interior of conv p 1 pd 1 it still has the same maximal codewords as pd moreover the regions in our realization corresponding to the maximal codewords 1 2 d 1 i i now have closures which intersect the boundary b of b in a relatively open subset of b in the proof technique of 3 lemma 5 7 implies that we may repeatedly shave off pieces of our sets near this region to add the desired non maximal codewords contained in 1 2 d 1 i i obtaining a realization of pd in rd order forcing in neural codes 20 references 1 patrick chan katherine johnston joseph lent alexander ruys de perez and anne shiu nondegen erate neural codes and obstructions to closed convexity arxiv preprint arxiv 2011 04565 2020 2 aaron chen florian frick and anne shiu neural codes decidability and a new local obstruction to convexity siam journal on applied algebra and geometry 3 2019 no 1 44 66 available at https doi org 10 1137 18 m 1186563 3 joshua cruz chad giusti vladimir itskov and bill kronholm on open and closed convex codes discrete computational geometry 61 2016 247 270 4 carina curto and vladimir itskov cell groups reveal structure of stimulus space plos computational biology 4 2008 e 1000205 5 carina curto vladimir itskov alan veliz cuba and nora youngs the neural ring an algebraic tool for analyzing the intrinsic structure of neural codes bulletin of mathematical biology 75 2013 no 9 1571 1611 mr 3105524 6 carina curto and ramo n vera the leray dimension of a convex code arxiv e prints 1612 07797 2016 available at 1612 07797 7 brianna gambacini r amzi jeffs sam macdonald and anne shiu non monotonicity of closed con vexity in neural codes arxiv e prints 1912 00963 2020 available at 1912 00963 8 chad giusti and vladimir itskov a no go theorem for one layer feedforward networks neural compu tation 26 2014 no 11 2527 2540 mr 3243436 9 sarah ayman goldrup and kaitlyn phillipson classification of open and closed convex codes on five neurons advances in applied mathematics 112 2020 101948 10 jacob e goodman and richard pollack the complexity of point configurations discrete applied math ematics 31 1991 no 2 167 180 11 r amzi jeffs embedding dimension phenomena in intersection complete codes arxiv e prints 2019 sep arxiv 1909 13406 available at 1909 13406 12 r amzi jeffs sunflowers of convex open sets advances in applied mathematics 111 2019 101935 13 r amzi jeffs morphisms of neural codes siam journal on applied algebra and geometry 4 2020 99 122 14 r amzi jeffs and isabella novik convex union representability and convex codes international mathe matics research notices 2019 available at http oup prod sis lan imrn advance article pdf doi 10 1093 imrn rnz 055 28260199 rnz 055 pdf to appear 15 r amzi jeffs mohamed omar natchanon suaysom aleina wachtel and nora youngs sparse neural codes and convexity involve a journal of mathematics 12 2015 no 5 737 754 16 alexander kunin caitlin lienkaemper and zvi rosen oriented matroids and combinatorial neural codes arxiv preprint arxiv 2002 03542 2020 17 caitlin lienkaemper anne shiu and zev woodstock obstructions to convexity in neural codes ad vances in applied mathematics 85 2017 31 59 mr 3595298 18 john o keefe and jonathan dostrovsky the hippocampus as a spatial map preliminary evidence from unit activity in the freely moving rat brain research 1971 171 175 19 martin tancer intersection patterns of convex sets via simplicial complexes a survey thirty essays on geometric graph theory 2013 pp 521 540 mr 3205172 https doi org 10 1137 18 m 1186563 1612 07797 1912 00963 1909 13406 http oup prod sis lan imrn advance article pdf doi 10 1093 imrn rnz 055 28260199 rnz 055 pdf http oup prod sis lan imrn advance article pdf doi 10 1093 imrn rnz 055 28260199 rnz 055 pdf 1 introduction 2 order forcing 3 new examples of non convex codes 3 1 stretching sunflowers 3 2 simple proofs of nonconvexity 4 strict monotonicity of convexity in all dimensions 5 conclusion and open questions 6 acknowledgements appendix a constructions of various realizations references