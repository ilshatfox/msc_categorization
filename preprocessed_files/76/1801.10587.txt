pressureless euler alignment system with control giacomo albi 1 young pil choi 2 and axel stefan ha ck 3 abstract we study a non local hydrodynamic system with control first we character ize the control dynamics as a sub optimal approximation to the optimal control problem constrained to the evolution of the pressureless euler alignment system we then discuss the critical thresholds that leading to global regularity or finite time blow up of strong solutions in one and two dimensions finally we propose a finite volume scheme for nu merical solutions of the controlled system several numerical simulations are shown to validate the theoretical and computational results of the paper 1 introduction over the last decades there has been a vigorous development of literature in applied mathematics and physics describing collective behaviors of multi agent systems 28 24 towards modeling phenomena in biology such as cell aggregation and motility 12 41 coordinated animal motion 17 7 5 or coordinated human 22 42 6 the standard viewpoint of these branches of mathematical modeling of multi agent sys tems is that the dynamics are based on the free interaction of the agents to describe their self organization in terms of the formation of complex macroscopic patterns on the other hand most recently researchers started to investigate those systems from the perspective of constrained interactions in particular to study control mechanisms capable of enforcing desired global behaviors hence control problems in multi agent system have been developed in several directions in the mathematical community indeed the solution to the control of collective behaviors has been studied in the microscopic setting for example in 8 13 10 where however direct numerical solution can be challenging due to the high dimensionality and non linearities of such systems therefore there has been a large effort in the derivation of mesoscopic and macroscopic approximation which represents a first step towards the reduction of the problem complexity and the development of new numerical strategies 40 18 25 32 in particular optimal control problem for kinetic equations has been studied in 4 14 2 3 27 and macroscopic models in 21 33 moreover systems where multiple scales are coupled have been investigated in 1 22 9 1 department of computer science university of verona str le grazie 15 verona it 37131 italy 2 department of mathematics and institute of applied mathematics inha university incheon 402 751 republic of korea 3 department of mathematics igpm rwth aachen university templergraben 55 aachen de 52062 germany e mail addresses giacomo albi univr it ypchoi inha ac kr haeck igpm rtwh aachen de date february 1 2018 key words and phrases self organization hydrodynamic models finite volume methods critical thresh olds instantaneous control 1 ar x iv 1 80 1 10 58 7 v 1 m at h a p 3 1 ja n 20 18 2 g albi y p choi and a s ha ck concerning that several studies have been carried out to derive consistent kinetic ap proximation of microscopic optimal control problems for example via mean field equations 27 26 9 or boltzmann type models 3 40 2 on the other hand consistent and rigor ous derivation of macroscopic models for microscopic and mean field control problems are still missing for general and it poses extremely challenging problems due to difficulties in determining asymptotic equilibrium states however several studies have been proposed for hydrodynamic models of self organized system coupled to an optimal control problem where the most common applications are in traffic flow or crowd motion models 23 33 36 in the current work we focus on euler type system for the velocity alignment behaviors this type of model has been recently investigated in several papers 16 15 43 and it is referred to pressureless euler alignment system where the non local interaction process is inspired by microscopic multi agent systems such as cucker smale and motsch tadmor models 24 38 thus we consider the evolution of density x r and velocity field u x rn both defined in rn and whose dynamics are described by following system t x u 0 x rn t 0 tu u xu rn x y u y u x y dy 1 1 where the right hand side of the velocity equations account for the non local alignment force with a positive communication function and a control term rn whose action aims to enforce certain desired behavior typically for velocity alignment dynamics controls are used to enforce global convergence towards a flocking state where the velocity field exhibits an uniform direction u this is usaully to prevent situations where the communication rate is weak and the initial state is not well prepared 24 30 for these applications we can define the control as a solution of an optimal control problem defined by the constrained minimization of functionals of the following type arg min j u t 0 rn x u 2 dxdt 1 2 with a specific target cost to be specified according to applications where 2 is a quadratic regularization term penalizing the control action with a parameter 0 in our study we will focus mainly on enforcing a global desired velocity field requiring x u u x u 2 macroscopic models such as 1 1 also require additional investigations to ensure the existence of solutions it is well known that solutions to the pressureless euler type system may develop a singularity such as a shock no matter how smooth the initial data are for that reason it is natural to take into account the measure valued solutions for the global regularity however our main system 1 1 includes a nonlocal dissipation and this allows us to have global in time strong solutions under smallness assumptions on the initial data 31 see also 20 for the isothermal euler alignment system it is also even obtained a sharp critical threshold for the system 1 1 without control i e 0 that leading to global regularity or finite time blow up of strong solutions 16 in one dimension in particular other interactions forces attractive or repulsive forces are also considered in 16 for two dimensional case the critical thresholds are investigated in 43 we refer to 15 for the recent survey on attractive repulsive hydrodynamic models for collective behaviors pressureless euler alignment system with control 3 the paper is structured as follows in section 2 we discuss our modelling setting and we derive the control term as an instantaneous feedback control from a particular optimal control problem section 3 provides critical thresholds results for the pressureless euler alignment system with control we give a sharp estimate for the one dimensional case and for the two dimensional case we show novel bounds for the global existence of solutions section 4 is devoted to the discretization of model 1 1 in one and two dimensions we employ a finite volume type scheme for both cases finally several numerical tests validate our theoretical findings and explore further features of the model 2 control of macroscopic alignment systems we consider the controlled pressureless euler alignment system defined as follows t x u 0 x rn t 0 tu u xu rn x y u y u x y dy 2 1 with compactly supported initial density and uniformly bounded initial velocity x t u x t t 0 0 x u 0 x for x rn 2 2 here u rn and w 1 c 1 rn is a communication weight satisfying 0 x x and x y for x y 2 3 note that the cucker smale model s communication weight function satisfies the condition 2 3 finally we want to define the control rn in such way that it leads system 2 1 towards a preferred direction hence we consider the following functional min j u t 0 rn u x s u 2 x s 2 dxds 2 4 which has to be minimized in order to find a control field t rn rn such that the velocity of the system u x t is steered toward the reference u rn with a quadratic convex penalization of parameter 0 following standard adjoint calculus for infinite dimensional system e g we introduce the functions p q l 2 which act as lagrangian multipliers associated respectively to the density and velocity u hence we can derive the adjoint system of equations for the optimal control problem associated to 2 4 and constrained to evolution of 2 1 which reads as follows tp u xp rn x y u y u x q y dy tq u x q l q u rn x y y q x x q y dy 2 u u xp 2 5 where the operator l is explicitly given by l q u k n j 1 qk juj qj kuj k 1 n 2 6 4 g albi y p choi and a s ha ck this system is complemented with zero value terminal conditions p x t 0 and q x t 0 and the additional condition for the control x t 1 2 q x t 2 7 thus solutions u of the optimal control problem have to satisfy the optimality conditions system defined by 2 1 2 5 and 2 7 in general the numerical solution of this system is computationally very heavy in particular for large time predictions or high dimensional applications in what follows we will show a reduction technique which approximates the solution of the full optimal control problem deriving a sub optimal control characterized as an instantaneous controller 3 34 2 1 instantaneous feedback control we approximate the optimal control problem 2 1 2 4 by minimizing a discretized functional over a set of sequential time sub intervals this strategy can be interpreted as a model predictive control applied to the pressureless euler alignment system 37 29 consider the semi implicit discrete functional for 2 4 restricted to the time frame t t h with the time step parameter h as follows jh rn u x t h u x 2 h h x t 2 dx 2 8 where the penalization term h will be scaled later according to discretization parameter h the functional 2 8 is constrained to the evolution of the forward dynamics for the mass and velocity x t h x t h x u o h u x t h u x t h u xu rn x y u y t u x t y t dy h x t o h 2 9 in order to compute a minimizer for the reduced functional 2 8 it is enough to compute the vanishing points of the jacobian d jh i e 0 d hjh lim 0 jh h h jh h 2 10 pressureless euler alignment system with control 5 where h is an admissible variation of the control h such that h h l 2 thus we compute the variations of the discrete 2 8 with respect to h d hjh h d h rn u x t h u x 2 h h x t 2 dx 2 h rn u x t h u x x t dx 2 h rn h x t h x t dx 2 h rn u x u x t x t dx 2 h rn h x t h x t dx 2 h 2 rn u xu rn x y u y t u x t y t dy h x t dx 2 h 2 rn h x t h x t dx where we substituted the expression for u x t h and we neglected terms of order o h 2 finally we have d hjh h 2 rn h h 2 h x t h u x u x o h 2 h x t dx where the term o h 2 includes the additional contribution from the discretization of the velocity term thus we can conclude that for every test function the optimal one step control is given by h x t h h h 2 u x u x t o h 2 h h 2 2 11 hence assuming the penalization parameter is scaled as h h in the limit h 0 we retrieve the instantaneous control x t 1 u x u x t 2 12 which acts as a relaxation towards the desired velocity field u x in what follows we will assume that the control in 2 1 is defined as the instantaneous control 2 12 remark 2 1 note that another choice for a possible functional might require the mini mization of the momenta u rather than the full velocity field u this can be expressed by defining for example the functional j u t 0 rn u x t u x 2 x t 2 x t dxdt 2 13 where we are intereseted in minimizing the l 2 distance between u and the reference u only on the density following the instantaneous control approach we can define a discrete func tional jh equivalent to 2 8 and by imposing d jh 0 we have that the instantaneous minimizers are characterized by the following relations h x t h h 2 x u u x u x t o h 2 2 14 thus in the limit for h 0 it restitutes the same control as in 2 12 but whose existence is defined only on the support of the density x t 6 g albi y p choi and a s ha ck 3 critical thresholds for the controlled system 2 1 in this section we study the critical thresholds for pressureless euler alignment system 2 1 with instantaneous control defined in 2 12 in one and two dimensions which char acterizes the initial configurations for the global in time regularity and finite time blow up of solutions for the one dimensional case by using the fact that our control is a type of linear damping we follow the strategy proposed in 16 which gives a sharp critical thresh old estimate for the two dimensional case inspired by 43 we use the large time behavior estimate of solutions to control differences of the velocities for investigating the subcritical region in both cases we consider uniform reference velocity u then we begin by providing some preliminary results for the system 2 1 2 2 lemma 3 1 let u be a global strong solution to the system 2 1 2 3 then we have d dt rn x t dx 0 d dt rn u x t dx 0 d dt rn u 2 x t dx rn rn x y u x t u y t 2 x t y t dxdy 2 rn u u x t u x t x t dx for t 0 proof a straightforward computation together with using the symmetry assumption of yields the desired results we next provide support estimates of the strong solutions to the system 2 1 for this we introduce extremal functions s t sup x y x y supp t and v t sup u x t u y t x y supp t lemma 3 2 let t 0 and u be a strong solution to the system 2 1 2 3 in 0 t then we have d dt s t v t d dt v t 0 l 1 s t v t 1 v t 3 1 for t 0 t in particular this gives s t d and v t v 0 3 2 for all t 0 t where d is a positive constant given by d s 0 v 0 proof by using the almost same argument as in 43 we can obtain the differential inequal ities 3 1 from that we get v t v 0 e t and subsequently this yields s t s 0 t 0 v s ds s 0 v 0 1 e t d pressureless euler alignment system with control 7 3 1 one dimensional case in this section we study the critical thresholds for the system 2 1 in one dimension t x u 0 x r t 0 tu u xu r x y u y u x y dy 1 u u 3 3 differentiating the momentum equation in 3 3 with respect to x together with setting v xu gives t u x v tv u xv v 2 u r x x y y dy r x y t y dy v r x y y dy 1 v 3 4 where we used the symmetry assumption on to get r x x y u y u x y dy u x r x x y y dy r x y t y dy we next define the characteristic flow x t by d dt x t u x t t with x 0 x and rewrite the system 3 4 along that characteristic flow as t x t t x t t v x t t t v x t t x t t v 2 x t t v x t t x t t 1 v x t t set d v 1 then we finally have the following differential equations of d v d v v 1 d d 1 3 5 from the above equations we easily get the blow up estimates of solutions and the uniform boundedness of solutions in time we provide the details of that in the proposition below even though it can be obtained by using almost same argument as in 16 proposition 3 1 consider the system 3 5 then we have i if d 0 0 then d and in finite time ii if d 0 0 then d t 0 for all t 0 iii if d 0 0 then d t t 1 as t proof set d then we can easily find d d 2 1 2 v v 1 dv 0 thus we get t 0 for all t 0 since the proof of ii is almost trivial we only deal with i and iii 8 g albi y p choi and a s ha ck i it is clear to have that if d 0 0 then d t 0 for all t 0 then it follows from 3 5 2 that d d 2 and this gives d t d 0 t d 0 hence d t will be blow up until t d 0 furthermore since t 0 d t with 0 0 we also find until t d 0 iii note that if d t 0 t 1 then d t 0 thus d t is increasing up to t 1 on the other hand if d t t 1 then d t is decreasing up to t 1 remark 3 1 we do not need to have the large time behavior estimate obtained in lemma 3 2 as a direct consequence of proposition 3 1 we have the following complete description of the critical thresholds for the system 3 3 theorem 3 1 consider the one dimensional pressureless euler equations with the align ment force for velocities 3 3 and the control then we have supercritical region if there exists an x such that xu 0 x 0 x 1 then the solution blows up in a finite time subcritical region if xu 0 x 0 x 1 for all x r then the system has a global strong solution u c r l r c r w 1 proof since l l 0 l 1 all results are obtained from proposition 3 1 remark 3 2 it follows from theorem 3 1 that the parameter the strength of control plays an important role in determining the regions for sup and sub critical regions if we consider a strong control i e is large enough then the subcritical region is larger on the other hand if is small enough i e a weak control is taken into account then the subcritical region is smaller 3 2 two dimensional case in this part we study the critical thresholds for the system 2 1 in two dimensions for this we employ the refined estimate in 16 together with the idea used in 43 which provides slightly better results compared to 43 more precisely we are concerned with the system t x u 0 x r 2 t 0 tu u xu r 2 x y u y u x y dy 1 u u 3 6 taking x to the system 3 6 2 and setting m 1 u 1 2 u 1 1 u 2 2 u 2 yield that m satisfies tm u x m m 2 1 m f pressureless euler alignment system with control 9 where f is given by f fij 1 i j 2 with fij r 2 j x y ui y ui x y dy set v 1 u 1 2 u 2 q 1 u 1 2 u 2 r 2 u 1 and s 1 u 2 then we find that v v 2 2 2 r 2 x x y y u y dy u r 2 x x y y dy v 1 v v 1 v here is a spectral gap 2 1 where i i 1 2 are two eigenvalues of the matrix xu given by 1 1 2 v 2 1 2 v q 2 4 rs thus if we again set d v 1 then d satisfies d v 2 2 2 v 1 v 1 2 d 1 d 1 2 2 3 7 we also obtain that q qd r 2 1 x y u 1 y u 1 x 2 x y u 2 y u 2 x y dy q 11 q 22 r rd r 2 2 x y u 1 y u 1 x y dy q 12 s sd r 2 1 x y u 2 y u 2 x y dy q 21 3 8 we next set q max 1 i j 2 qij then it easily follows from the fact 3 2 that q x l 0 l 1 v 0 q we now loosely follow the argument in 43 lemma 4 4 to have the uniform boundedness of t in time lemma 3 3 let q r s be the strong solutions to the system 3 8 with the initial data q 0 r 0 s 0 suppose that d t 2 q max q 0 2 r 0 2 s 0 for t 0 t then q r s remain bounded max q t 2 r t 2 s t max q 0 2 r 0 2 s 0 for t 0 t thus the spectral gap t 2 max q 0 2 r 0 2 s 0 is bounded for t 0 t then we are now ready to provide the initial configurations for the global regularity of solutions 10 g albi y p choi and a s ha ck proposition 3 2 suppose that d 0 l 1 1 1 max q 0 2 r 0 2 s 0 4 q 2 2 max q 0 2 r 0 2 s 0 4 where d is the positive constant appeared in lemma 3 2 if d 0 2 q max q 0 2 r 0 2 s 0 then we have d t 2 q max q 0 2 r 0 2 s 0 for t 0 t and subsequently we have max q t 2 r t 2 s t max q 0 2 r 0 2 s 0 for t 0 t proof for notational simplicity we denote by 0 max q 0 2 r 0 2 s 0 note that by lemma 3 3 t 2 0 as long as d t 2 q 0 on the other hand if t 2 0 then it follows from 3 7 that d 1 2 d 2 1 2 2 2 1 2 d 2 1 2 d 0 l 1 1 2 20 1 2 d c 0 d c 0 where c 0 is a positive constant given by c 0 d 0 l 1 1 2 2 20 on the other hand we find c 0 2 q 0 and this gives that d t 0 if d 0 2 q 0 c 0 this completes the proof we next investigate the initial configurations for finite time blow up of solutions proposition 3 3 consider the system 3 7 suppose that min r 0 s 0 q l 0 l 1 1 and d 0 l 0 l 1 1 then d in finite time proof set t t 0 r 0 and s 0 for 0 t it is clear from the continuity of the functions r t s t and the assumption that t 6 thus we can set t sup t we then claim t 2 d 0 l 0 l 1 1 let us assume that the above claim is not correct i e t 2 d 0 l 0 l 1 1 and we have either lim t t r t 0 or lim t t s t 0 3 9 on the other hand it follows from 3 7 that for t t d 1 2 d l 0 l 1 1 d l 0 l 1 1 pressureless euler alignment system with control 11 this and using the continuity argument with the assumption d 0 l 0 l 1 1 imply d 1 2 d l 0 l 1 1 2 for t 0 t thus we obtain d l 0 l 1 1 1 d 0 1 t 2 for t 0 t 3 10 where d 0 d 0 l 0 l 1 1 0 this together with 3 8 yields r rd q 12 r l 0 l 1 1 1 d 0 1 t 2 q 3 11 since exp t 0 l 0 l 1 1 1 d 0 1 s 2 ds e l 0 l 1 1 te 2 ln d 0 1 t 2 ln d 0 1 e l 0 l 1 1 t d 0 1 t 2 2 d 20 e l 0 l 1 1 t we get from 3 11 that re l 0 l 1 1 t d 0 1 t 2 2 d 20 q e l 0 l 1 1 t integrating the above differential inequality in time we find re l 0 l 1 1 t d 0 1 t 2 2 d 20 r 0 q l 0 l 1 1 e l 0 l 1 1 t 1 we now take the limit t t to the above inequality to obtain 0 lim t t re l 0 l 1 1 t d 0 1 t 2 2 d 20 r 0 q l 0 l 1 1 e l 0 l 1 1 t 1 q l 0 l 1 1 e l 0 l 1 1 t 0 similarly by symmetry we can show that limt t s t 0 this is a contradiction to 3 9 thus we have r t 0 and s t 0 for t 2 d 0 l 0 l 1 1 and this further yields from 3 10 that d t until t 2 d 0 l 0 l 1 1 summarizing the above discussion we conclude the following theorem 12 g albi y p choi and a s ha ck theorem 3 2 consider the system 3 7 if the initial configurations satisfy the following d 0 l 1 1 4 x 2 l 0 2 l 1 v 20 2 max 1 u 10 2 u 2 0 2 2 u 1 0 2 1 u 2 0 4 max 1 u 10 2 u 2 0 2 2 u 1 0 2 1 u 2 0 for all x supp 0 where d is the positive constant appeared in lemma 3 2 and d 0 2 x l 0 l 1 v 0 max 1 u 10 2 u 2 0 2 2 u 1 0 2 1 u 2 0 then xu x t remains uniformly bounded for all x t supp t on the other hand if there exists an x such that min 2 u 10 x 1 u 2 0 x x l 0 l 1 v 0 l 0 l 1 1 and d 0 x l 0 l 1 1 then there is a finite time blow up of solutions such that infx supp t x u x t in finite time 4 numerical experiments in this section we will present numerical solutions to the pressureless euler alignment system 2 1 in one and two space dimensions in order to discretize such system we will employ a finite volume approach based on kurganov tadmor scheme 35 among the sev eral works on numerical solutions for pressureless euler type system we refer to 11 19 44 for further insights 4 1 numerical scheme we introduce the following notation w u f w u u u 2 0 4 1 a g w 0 x y u y u x y dy t 4 1 b note that u and consist of scalar quantities in the one dimensional case and the tensor product in 4 1 a becomes the inner product employing 4 1 a and 4 1 b we can rewrite 2 1 as follows tw x f w g w 4 2 thus 4 2 renders a one or two dimensional conservation law with the source termg w in two spatial dimensions we get from 4 1 a that tw x f 1 w y f 2 w g w 4 3 where y is the second space dimension f 1 u 1 u 21 2 u 1 u 2 2 f 2 u 2 u 1 u 2 2 u 22 2 with u u 1 u 2 we will use a finite volume scheme to calculate an approximated solution of the macro scopic system 2 1 the discretization will consist of uniform cells ci j with its center pressureless euler alignment system with control 13 located at xi yj the x diameter of x 0 and the y diameter of y 0 a possible semi discrete scheme for the two dimensional case reads d dt wi j 1 x f 1 i 1 2 j t f 1 i 1 2 j t 1 y f 2 i j 1 2 t f 2 i j 1 2 t g i j t i j t 4 4 where the numerical fluxe f 1 i 1 2 j t is the one in x direction of the cell i j through the interfaces located at xi 1 2 and analog for the y direction fluxes f 2 i j 1 2 t as the scheme to evaluate the numerical fluxes f 1 i 1 2 j t and f 2 i j 1 2 t we will use the genuinely mul tidimensional kurganov tadmor central scheme as suggested in 35 we therefore have f 1 i 1 2 j a i 1 2 j f wen 1 i 1 j f wes 1 i 1 j 2 a i 1 2 j a i 1 2 j a i 1 2 j f wwn 1 i j f wws 1 i j 2 a i 1 2 j a i 1 2 j a i 1 2 j a i 1 2 j 2 a i 1 2 j a i 1 2 j wwni j wwsi j weni 1 j wesi 1 j 4 5 and f 2 i j 1 2 b i j 1 2 f wwn 2 i j 1 f wen 2 i j 1 2 b i j 1 2 b i j 1 2 b i j 1 2 f wws 2 i j f wes 2 i j 2 b i j 1 2 b i j 1 2 b i j 1 2 b i j 1 2 2 b i j 1 2 b i j 1 2 wwsi j wesi j wwni 1 j weni 1 j 4 6 as second order accurate approximations here a is the largest lowest respectively char acteristic speed at the denoted interface of f 1 and b is defined similarly with respect to the y flux f 2 we denote by w en wwn wes wws the interpolation of the linear re construction of the cell vertex values generated by the slope reconstruction gathered by a muscl scheme for remaining open questions on those numerical fluxes we again refer to 35 the spatial second order approximation of the numerical fluxes associated to g w and comes for free since we do finite volume we employ a midpoint rule here however we cannot simply merge the numerical fluxes of the source term to a classical finite volume scheme as indicated in 4 4 this is due to the fact that for small control parameters the control term will render the associated terms to be stiff for that reason we rewrite 4 4 in the following way tw f w 1 r w 4 7 where we collect the non stiff terms by f w xf 1 w yf 2 w g w 4 8 and r w 0 u 1 u 2 t 0 u 1 u 1 u 2 u 2 t 4 9 14 g albi y p choi and a s ha ck 0 0 0 1 1 0 1 2 1 2 0 1 1 2 1 2 1 2 1 1 2 figure 1 butcher tableaus of second order ssp imex runge kutta scheme left explicit integrator of f right implicit integrator of 1 r from this decomposition it is trivial to see that we can apply an imex runge kutta scheme as presented in 39 for the following numerical experiments we implemented a second order strong stability preserving ssp scheme with the associated butcher tableaus implicit and explicit inte grators as displayed in figure 1 by plugging together the kurganov tadmor central scheme and the second order ssp imex for the time integrations we end up to have established a globally second order scheme that solves the two dimensional case of 2 1 remark 4 1 one dimensional scheme for the one dimensional case we do not have a flux in y direction hence we set f 2 zero as well as u 2 0 in doing so we already almost recovered the corresponding one dimensional scheme note that the time integration is formulated independently form the space dimension the only left task at hand is the numerical flux f 1 in 4 5 we use the trapezoid rule in y direction along the cell s interface located at xi 1 2 to evaluate the flux across those boundaries an alternative numerical flux at interface i 1 2 j introduced in 35 as well reads as follows fi 1 2 j a i 1 2 j f wei 1 j a i 1 2 j f wwi j a i 1 2 j a i 1 2 j a i 1 2 j a i 1 2 j a i 1 2 j a i 1 2 j wwi j w e i 1 j 4 10 where we and ww are the one dimensional linear reconstructions of the interface values of w again we refer to 35 for more details 4 2 numerical experiments in one dimension we implemented the 1 d case of 2 1 following the scheme introduced in section 4 1 we set as computational domain x l l with l 1 and the time frame is set to 0 tf tf 3 the initial data is defined as follows 0 x 2 l 3 l 6 x l 6 2 l 3 x u 0 x sin x l 4 11 and periodic boundary conditions we consider a communication function in 2 3 of the cucker smale type x 1 x 4 12 with 1 and 10 the spatial discretization is set such that we have an uniform grid with x 0 01 and as the flux limiter we chose minmod for the imex scheme with t x cfl 1 we set the cfl condition to cfl 0 95 in figure 2 we present the uncontrolled case x t 0 to gain an understanding of the varying influence of the control pressureless euler alignment system with control 15 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 figure 2 test 1 d uncontrolled case evolution from left side to right side of system 2 1 without control in the time interval 0 3 test 1 d homogeneous desired state for the controlled cases we consider first a homoge neous case desired state such that x t 1 u u x t 4 13 for varying values of the parameter 0 1 1 10 and different desired states u in figure 3 we apply the same initial condition as above 4 11 and instantaneous control 4 13 with desired homogeneous velocity u 0 if we compare figure 2 and figure 3 we see that in case of the control parameter 10 the control has almost no effect for 1 however we observe a significant quicker diminishing of the velocity u approaches u than the alignment of the uncontrolled case in figure 2 this yields to a not completed clustering of mass at the origin for 0 1 we observe that the dynamics of the cucker smale come to a halt almost instantly hence the control is enforced stronger than in the other two cases in figure 4 we display the same setting as in figure 3 but with desired velocity u 0 5 differently from the previous cases we observe that once the desidered velocity is reached the mass is transported in the right side direction inhomogeneous desired state let us consider the same scenario as 4 11 but where we apply an inhomogeneous desired state control namely u x sin x l in figure 5 we display the associated evolutions where for different intensity of the instan taneous control i e smaller values of the two intial densities which are initially pushed toward the center of the domain change direction and merge at boundary of the periodic domain 4 3 numerical experiments in two dimensions we now investigate the two dimen sional case of the euler alignment dynamics 2 1 with cucker smale type of interactions 4 12 and for different choice of the control for the numerical scheme we set all parameters analog to the case in one dimension in section 4 2 the only difference is that we lowered the resolution to 64 64 cells of the special domain x y l l l l l 1 therefore we have x y 0 03125 for all cases we will give a comparison of the uncontrolled case x t 0 with the corresponding controlled cases 16 g albi y p choi and a s ha ck 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 figure 3 test 1 d homogeneous desired state from top to bottom evolution of system 2 1 with 10 1 0 1 and u 0 remark 4 2 2 d graphical representation in all following 2 d plots we will represent the density and the momenta u and occasionally the velocity field u in particular we display the momenta vector u by black quiver plot of varying orientation and length corresponding the values of the vector at a given position we will plot the 2 norm of this field as a contour plot in this way we give the reader an immediate insight of the absolute magnitude of the underlying vector field rather than a relative information on this in a second step we will drop the presentation of the velocity field u and refer to the initial data since we are only interested in the support of and its the evolution pressureless euler alignment system with control 17 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 figure 4 test 1 d homogeneous desired state from top to bottom evolution of system 2 1 with 10 1 0 1 and u 0 5 test 2 d uncontrolled symmetric heaps we consider an initial symmetric scenario by set ting first the quantities 0 x y max exp 10 x 1 2 2 10 y 1 2 2 1 5 0 and then definining the initial density and velocity as follows 0 x y 0 x y x y u 0 x y 2 h x 1 2 h y 1 t 4 14 where h denotes the heaviside function note that we expect an alignment at velocity 0 0 t due to the symmetry in figure 6 we show the evolution up to t 5 reporting in the first row of the plots the density in the second row the velocity u and in the last row 18 g albi y p choi and a s ha ck 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 1 0 5 0 0 5 1 1 0 5 0 0 5 1 1 5 2 figure 5 test 1 d inhomogeneous desired state from top to bottom evolution of system 2 1 with 10 1 0 1 and u sin x l the momenta u indeed we observe alignment toward zero velocity since the magnitude of the velocity u 2 shrink to zero whereas the density concentrates in zero test 2 d asymmetric heaps we consider the previous example where the initial data 4 14 accounts now at time zero a biased density as follows 0 x y x y 2 x y u 0 x y 2 h x 1 2 h y 1 t 4 15 for comparison we first consider the uncontrolled case in figure 7 we observe that the mass at the initial velocity 1 1 t assigns a larger momentum to the cluster at the bottom left this larger momentum dominates the cucker smale dynamics and hence the resulting alignment of the global mass distribution follows this larger initial momentum see the momenta at t 1 furthermore we see that the initial velocity field has an influence at pressureless euler alignment system with control 19 1 0 1 1 0 1 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 1 0 1 1 0 1 0 20 40 60 80 100 1 0 1 1 0 1 0 20 40 60 80 100 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 1 1 1 0 1 1 0 1 1 2 3 4 5 6 7 8 9 10 11 10 4 1 0 1 1 0 1 0 5 1 1 5 2 2 5 3 3 5 4 4 5 5 5 5 10 12 figure 6 test 2 d uncontrolled symmetric heaps alignment in the two dimensional case for initial data 4 14 evolution of the density is reported in the first row whereas the second row shows the velocity u whereas the corresponding momenta u is reported x 0 or y 0 if the support of is transported to this area the mass is accelerated and clusters in the center 0 0 t on the other hand we study the action of the control for different values of and desired velocity field u x y 0 0 t we show the evolution in figure 8 the evolution of density and momenta where we observe in the first column that in case of a control parameter 10 the evolution is similar as in figure 7 but with less high concentration at the center since by the chosen desired velocity is u 0 0 t and hence is a damping term in the second column for 1 we have an even less concentrated profile and lower momenta that in the previous case in case of 0 1 we do almost see no evolution at all and almost no remaining momenta 20 g albi y p choi and a s ha ck 1 0 1 1 0 1 0 0 5 1 1 5 1 0 1 1 0 1 0 10 20 30 40 50 60 70 1 0 1 1 0 1 0 50 100 150 200 250 300 1 0 1 1 0 1 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 1 8 2 2 2 1 0 1 1 0 1 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 1 8 1 0 1 1 0 1 1 2 3 4 5 6 7 figure 7 test 2 d uncontrolled asymmetric heaps uncontrolled case to initial data 4 15 the vector field of the momenta and velocities r 2 is displayed as a quiver plot density as contour plot test 2 d reorientation we consider an aligned flock and we want to use the control func tion in order to invert its direction hence we define the following initial data 0 x y 1 u 0 x y 1 1 t 4 16 with desired velocity field u x y 1 1 t in figure 9 we report the evolution of the system where we display the quiver plots of the momenta and we overlap its representation with the 2 norm of the velocity field u x y we see that the momenta field changes the direction after some time depending on the control parameter however the new transport direction does not instantly assume the full speed in the new direction 1 1 t the additional information on the magnitude of the velocity field shows that at time t 10 for 10 the 2 norm of the velocity field is u 0 3737 whereas for 0 1 the 2 norm approaches the expected value of 2 test 2 d birdcage the following case models a flock that is caught in a cage by the control u to this purpose we suggest the following initial data 0 x y 1 u 0 x y 1 1 t 4 17 with the exerted desired velocity u x y 2 h x 1 2 h y 1 t 1 l 5 l 5 x 1 l 5 l 5 y 4 18 that is displayed in figure 10 in figure 10 we observe that for a control parameter 10 we do almost not catch any mass at the attractive center of the control u 4 17 and the initial velocity remains dominating by decreasing the value of we observe how successively more mass gathers in the center square pressureless euler alignment system with control 21 1 0 1 1 0 1 0 10 20 30 40 50 60 1 0 1 1 0 1 0 5 10 15 20 25 1 0 1 1 0 1 0 0 2 0 4 0 6 0 8 1 1 2 1 4 1 0 1 1 0 1 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 1 0 1 1 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 0 9 1 1 1 1 2 1 0 1 1 0 1 0 005 0 01 0 015 0 02 0 025 0 03 figure 8 test 2 d controlled asymmetric heaps controlled case to initial data 4 15 with u 0 0 t first row show the evolution of the density at time t 0 4 for 10 1 0 1 respectively from left to right bottom line shows the evolution of the momenta u test 2 d scarecrow in this case we want to model a flock that is suddenly repelled from a center position to model the sudden commotion in the flock we set uniform density 0 1 overall domain and an initial velocity u 0 in milling state as follows u 0 x y cos sin t where arg x is the argument i e the angle of the associated polar coordinates of the vector x y the scarecrow action of the the control is modelled by using the following desired velocity u x y 2 x y t x y 2 x 2 y 2 1 10 0 0 t elsewhere figure 11 displays the initial data u 0 and the desired velocity u in the first row then in the second and third rows are reported the evolution of the mass and momenta respectively for different choices of we observe that the control ensures the abstinence of mass at the center for lower and for longer evolutions test 2 d blow up phenomena we want observe numerically 2 d blow up phenomena for the limit case of uncontrolled dynamics and compare it with the strong control case 22 g albi y p choi and a s ha ck 1 0 1 1 0 1 1 14505310616815 1 1450531061682 1 14505310616825 1 1450531061683 1 14505310616835 1 1450531061684 1 0 1 1 0 1 0 373732995 0 373733 0 373733005 0 37373301 0 373733015 0 37373302 0 373733025 0 37373303 0 373733035 0 37373304 0 373733045 1 0 1 1 0 1 1 4172943419725 1 41729434197255 1 4172943419726 1 41729434197265 1 4172943419727 1 41729434197275 1 0 1 1 0 1 1 41421356237295 1 414213562373 1 41421356237305 1 4142135623731 1 41421356237315 1 4142135623732 1 41421356237325 figure 9 test 2 d reorientation controlled case to initial data 4 16 with u 1 1 t only the evolution of momenta for different is dis played 1 hence we set a new initial data as follows 0 x y max exp 2 x 2 2 y 2 1 10 0 4 19 a u 0 x y 2 h x 1 2 h y 1 t 4 19 b where in the control case we consider homogeneous desired state u 0 note that accord ing to theorem 3 2 the regularity of the solution can be controlled through the parameter in particular we expect that given the same initial data blow up does not occur when is taken small enough in figure 12 we show the final density of 4 19 for the uncon trolled case at terminal time t 0 65 and we compare it with respect to the controlled case with parameter 0 01 we do not report the velocity field since at time t 0 65 in both cases converges to numerical zero therefore the densities have already reached their steady state the uncontrolled case on the left hand side shows a blow up in finte time where all mass is clustered in one cell indeed this is as far as a finite volume method goes to resolve a dirac delta distribution to be certain that we face such a case we changed the resolution to 65 65 cells such that we have a single cell located on an neighborhood of x 0 0 t it turns out that this centered cell actually does assume the entire mass of the system hence pressureless euler alignment system with control 23 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 0 8 0 85 0 9 0 95 1 1 05 1 1 1 15 1 2 1 25 1 0 1 1 0 1 2 4 6 8 10 12 14 16 1 0 1 1 0 1 100 200 300 400 500 600 700 800 1 0 1 1 0 1 1 1 1 1 2 1 3 1 4 1 5 1 6 1 7 1 0 1 1 0 1 2 3 4 5 6 7 8 9 10 11 12 1 0 1 1 0 1 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 1 8 figure 10 test 2 d birdcage the initial velocity with the control is given in the first row followed by the evolution for different 10 1 0 1 of the density in the second row and the momenta in the last row the support of the density distribution supp at t 0 65 is entirely contained in this cell and as desired in case of a blow up see the evolution of v t in section 3 2 and remark 4 3 for different resolutions on the right hand side we represents the controlled case with 0 01 where we can easily observe that the mass does not concentrate that intensely at the center as well as that the support of the density is smeared out around zero remark 4 3 finite volume resolution in figure 13 we report rough and finer grid rep resentations for the uncontrolled case of figure 12 we observe that the value of the concentration at the central cell depends on the chosen discretization for a given dirac delta at a point x 0 we have that this here for mass is located in the central cell of a certain volume if we resolve the domain by a higher resolution than the corresponding 24 g albi y p choi and a s ha ck 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 2 3 4 5 6 1 0 1 1 0 1 0 5 1 1 5 2 2 5 3 3 5 4 4 5 1 0 1 1 0 1 1 2 3 4 5 6 7 1 0 1 1 0 1 0 5 1 1 5 2 2 5 3 3 5 4 4 5 1 0 1 1 0 1 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 1 8 2 1 0 1 1 0 1 0 1 0 15 0 2 0 25 0 3 0 35 0 4 0 45 0 5 0 55 0 6 figure 11 test 2 d scarecrow initial velocity u 0 control u and states at t 0 1 under different values of are displayed volume of the central cell will be smaller the dirac delta is still located in this central cell and still shows the same value hence the average value of the central cell will be higher for finer resolutions as verified in figure 13 for the resolutions 45 45 and 85 85 cells 5 conclusions we have studied a pressureless euler type system for the macroscopic description of particle alignment in presence of control for that hydrodynamic model we provide critical thresholds results for the global regularity and finite time breakdown of solutions both in one and two dimensional settings finally we validate our modelling and analytical results with several numerical experiments employing a finite volume scheme for the pressureless pressureless euler alignment system with control 25 0 1 2 4 1 6 8 0 10 0 1 1 0 1 2 3 4 5 6 7 8 0 1 0 1 1 0 2 0 3 0 0 4 0 1 1 0 0 05 0 1 0 15 0 2 0 25 0 3 figure 12 test 2 d blow up phenomena uncontrolled vs controlled on the left hand side the distribution in the density generated in finite time for the uncontrolled case from the initial data 4 19 on the right hand side for comparison we report the controlled case with 0 01 and u 0 in this case the support of the density is not entarely concentrated in a single cell 0 1 1 2 1 3 4 0 5 0 1 1 0 0 5 1 1 5 2 2 5 3 3 5 4 0 1 5 1 10 0 15 0 1 1 0 2 4 6 8 10 12 14 5 figure 13 blow up of the uncontrolled dynamics for different resolutions of the finite volume scheme on the left hand side grid of 45 45 cells on the right hand side finer grid with 85 85 cells we observe that the value of the accumulated mass in the central cell increases for a finer discretization euler alignment model further perspectives are the investigation of different non local interaction operators such as attraction or repulsion forces whereas also singularity are included at the numerical level challenging problems arising in this study are the solution of the full optimal control problem 2 1 2 4 and the development of high order schemes acknowledgments g a acknowledges the support by gncs indam fundings y p c is supported by national research foundation of korea nrf grant funded by the korea government 26 g albi y p choi and a s ha ck msip nos 2017 r 1 c 1 b 2012918 and 2017 r 1 a 4 a 1014735 and posco science fellow ship of posco tj park foundation a s h acknowledges the support by daad miur fundings references 1 g albi m bongini e cristiani and d kalise invisible control of self organizing agents leaving unknown environments to appear in siam j app math 2 g albi y p choi m fornasier and d kalise mean field control hierarchy appl math optim 76 1 93 135 2017 3 g albi m herty and l pareschi kinetic description of optimal control problems and applications to opinion consensus commun math sci 13 6 1407 1429 2015 4 g albi l pareschi and m zanella boltzmann type control of opinion consensus through leaders phil trans r soc a 372 20140138 1 18 2014 5 m ballerini n cabibbo r candelier a cavagna e cisbani l giardina l lecomte a orlandi g parisi a procaccini m viale and v zdravkovic interaction ruling animal collective behavior depends on topological rather than metric distance evidence from a field study pnas 105 4 1232 1237 2008 6 n bellomo and c dogbe on the modeling of traffic and crowds a survey of models speculations and perspectives siam rev 53 3 409 463 2011 7 n bellomo and j soler on the mathematical theory of the dynamics of swarms viewed as complex systems math models methods appl sci 22 suppl 1 1140006 29 2012 8 m bongini m fornasier and d kalise un conditional consensus emergence under perturbed and decentralized feedback controls discrete contin dyn syst ser a 35 9 4071 4094 2015 9 m bongini m fornasier f rossi and f solombrino mean field pontryagin maximum principle submitted 2015 10 a borz and s wongkaew modeling and control through leadership of a refined flocking system math models methods appl sci 25 2 255 282 2015 11 f bouchut on zero pressure gas dynamics in advances in kinetic theory and computing volume 22 of ser adv math appl sci pages 171 190 world sci publ river edge nj 1994 12 s camazine j deneubourg n franks j sneyd g theraulaz and e bonabeau self organization in biological systems princeton university press 2003 13 m caponigro m fornasier b piccoli and e tre lat sparse stabilization and optimal control of the cucker smale model math control relat fields 3 447 466 2013 14 m caponigro b piccoli f rossi and e tre lat mean field sparse jurdjevic quinn control math models methods appl sci 27 7 1223 1253 2017 15 j a carrillo y p choi and s p perez a review on attractive repulsive hydrodynamics for consensus in collective behavior in active particles vol 1 advances in theory models and applications model simul sci eng technol pages 259 298 birkha user springer cham 2017 16 j a carrillo y p choi e tadmor and c tan critical thresholds in 1 d euler equations with non local forces math models methods appl sci 26 1 185 206 2016 17 j a carrillo m r d orsogna and v panferov double milling in self propelled swarms from kinetic theory kinet relat models 2 2 363 378 2009 18 j a carrillo m fornasier g toscani and f vecil particle kinetic and hydrodynamic models of swarming boston ma birkha user 2010 19 a chertock a kurganov and y rykov a new sticky particle method for pressureless gas dynamics siam j numer anal 45 6 2408 2441 2007 20 y p choi the global cauchy problem for compressible euler equations with a nonlocal dissipation preprint arxiv 1801 04683 2018 21 r m colombo and n pogodaev on the control of moving sets positive and negative confinement results siam j control optim 51 1 380 401 2013 22 e cristiani b piccoli and a tosin multiscale modeling of granular flows with application to crowd dynamics multiscale model simul 9 1 155 182 2011 23 e cristiani b piccoli and a tosin multiscale modeling of pedestrian dynamics volume 12 of ms a modeling simulation and applications springer cham 2014 http arxiv org abs 1801 04683 pressureless euler alignment system with control 27 24 f cucker and s smale emergent behavior in flocks ieee trans automat control 52 5 852 862 2007 25 g dimarco and s motsch self alignment driven by jump processes macroscopic limit and numerical investigation math models methods appl sci 26 7 1385 1410 2016 26 m fornasier b piccoli and f rossi mean field sparse optimal control phil trans r soc a 372 2028 20130400 2014 27 m fornasier and f solombrino mean field optimal control esaim control optim calc var 20 4 1123 1152 2014 28 g gre goire and h chate onset of collective and cohesive motion phy rev lett 92 2004 29 l gru ne and j pannek nonlinear model predictive control communications and control engineering series springer london 2011 theory and algorithms 30 s y ha t ha and j h kim emergent behavior of a cucker smale type particle model with non linear velocity couplings ieee trans automat control 55 7 1679 1683 2010 31 s y ha m j kang and b kwon a hydrodynamic model for the interaction of cucker smale particles and incompressible fluid math models methods appl sci 24 11 2311 2359 2014 32 s y ha and e tadmor from particle to kinetic and hydrodynamic descriptions of flocking kinet relat models 1 3 415 435 2008 33 m herty a kurganov and d kurochkin numerical method for optimal control problems governed by nonlinear hyperbolic systems of pdes commun math sci 13 1 15 48 2015 34 m hinze instantaneous closed loop control of the navier stokes system siam j control optim 44 2 564 583 2005 35 a kurganov and e tadmor solution of two dimensional riemann problems for gas dynamics without riemann problem solvers numer methods partial differential equations 18 5 584 608 2002 36 b maury a roudneff chupin f santambrogio and j venel handling congestion in crowd motion modeling netw heterog media 6 3 485 519 2011 37 d q mayne j b rawlings c v rao and p o m scokaert constrained model predictive control stability and optimality automatica j ifac 36 6 789 814 2000 38 s motsch and e tadmor heterophilious dynamics enhances consensus siam rev 56 4 577 621 2014 39 l pareschi and g russo implicit explicit runge kutta schemes and applications to hyperbolic systems with relaxation j sci comput 25 1 2 129 155 2005 40 l pareschi and g toscani interacting multi agent systems kinetic equations monte carlo methods oxford university press usa 2013 41 b perthame transport equations in biology basel birkha user 2007 42 m b short m r d orsogna v b pasour g e tita p j brantingham a l bertozzi and l b chayes a statistical model of criminal behavior math models methods appl sci 18 suppl 1249 1267 2008 43 e tadmor and c tan critical thresholds in flocking hydrodynamics with non local alignment philos trans r soc lond ser a math phys eng sci 372 2028 20130401 22 2014 44 y yang d wei and c w shu discontinuous galerkin method for krause s consensus models and pressureless euler equations j comput phys 252 109 127 2013 1 introduction 2 control of macroscopic alignment systems 2 1 instantaneous feedback control 3 critical thresholds for the controlled system 3 1 one dimensional case 3 2 two dimensional case 4 numerical experiments 4 1 numerical scheme 4 2 numerical experiments in one dimension 4 3 numerical experiments in two dimensions 5 conclusions acknowledgments references