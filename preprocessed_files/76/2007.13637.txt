optimal mixing in transport networks optimal mixing in transport networks numerical optimization and analysis cassidy mentus and marcus roper abstract many foraging microorganisms rely upon cellular transport networks to deliver nu trients fluid and organelles between different parts of the organism networked organisms ranging from filamentous fungi to slime molds demonstrate a remarkable ability to mix or disperse mole cules and organelles in their transport media here we introduce mathematical tools to analyze the structure of energy efficient transport networks that maximize mixing and sending signals originating from and arriving at each node we define two types of entropy on flows to quantify mixing and develop numerical algorithms to optimize the combination of entropy and energy on networks given constraints on the amount of available material we present an in depth exploration of optimal single source sink networks on finite triangular grids a fundamental setting for optimal transport networks in the plane using numerical simulations and rigorous proofs we show that if the constraint on conductances is strict the optimal networks are paths of every possible length if the constraint is relaxed our algorithm produces loopy networks that fan out at the source and pour back into a single path that flows to the sink taken together our results expand the class of optimal transportation networks that can be compared with real biological data and highlight how real network morpholo gies may be shaped by tradeoffs between transport efficiency and the need to mix the transported matter key words transport network biological network murray s law fluid flow advection dissi pation entropy mixing optimization ams subject classifications 49 q 10 90 c 26 92 c 15 92 c 99 94 c 15 1 introduction work by murray in the 1920 s 20 first probed the idea that vessels in biological transportation networks may optimize knowable target functions murray hypothesized that blood vessels may have optimal radii are set by tradeoffs between the need to minimize friction within the vessel which favors large vessels and the energetic cost of maintaining the vessel which penalizes large vessels the scalings and geometric relationships that he derived from this trade off have found some experimental support for the blood networks of animals 29 and water transport networks of plants 18 more recent theoretical work has extended the analysis of single vessels or branch points to whole networks of vessels in which the sources and sinks are prescribed but the network is given many choices for how to connect these points 7 11 added damage or fluctuations in source and sink strengths 14 10 or developed models for how feedbacks between flows and network growth allow such optimal networks to be grown 12 22 hundreds of thousands of species of microorganisms including slime molds water molds and fungi rely on internal transportation networks these networks have similar functions they continuously grow as the organism claims territory or searches for hosts or resources within the network nutrients fluid and cellular matter including nuclei and other organelles are transported from sites of production or uptake to sites of utilization minimization of friction in conjunction with robustness to damage appears to underlie features of some of the foraging networks made for example by wood rotting basidiomycete fungi 6 and slime molds 28 however organisms build submitted to the editors on december 8 2020 funding this work was funded by the national science foundation under grant no dms 1351860 dept of mathematics university of california los angeles ca 90095 cas sidy mentus gmail com mroper math ucla edu www marcusroper org 1 ar x iv 2 00 7 13 63 7 v 2 nl in a o 5 d ec 2 02 0 mailto cassidy mentus gmail com mailto cassidy mentus gmail com mailto mroper math ucla edu www marcusroper org 2 c mentus and m roper networks with a tremendous diversity of morphologies that can not be explained by friction minimization alone do these morphologies emerge from other physical principles besides minimizing friction from constraints on the pathways used to grow the network or from neutral differences in network morphology that do not affect the organism s fitness we start from the position that to understand the extent of the role that optimization plays in determining the structure of networks we must first understand what the optimal network is for a given target function this approach previously guided us to develop gradient descent methods for optimizing networks for arbitrary differentiable functions 9 in this work we focus on a quantity with many points of non differentiability the amount of mixing occurring within the network this quantity which is given two different quantifications below is non differentiable in the conductances of the network at any point where the flow in an edge goes to 0 since the optimization of the network requires searching over possible topologies for flow i e reversing the directions of flow on edges we develop here a new numerical optimization method that is adapted to deal with this pervasive non differentiability why are might real networks seek to maximize mixing three kinds of mixing seem to be relevant to network forming microorganisms 1 in fungal networks cellular growth occurs at the periphery of the network through the continuous extension of hyphae at their tips and in fast growing fungi such as the model organism neurospora crassa growth requires the continuous supply of nuclei and other organelles to the edge of the mycelium 16 within n crassa nuclei often take tortuous and multidirectional paths toward the tips and the network is known to be organized so that pairs of nuclei that start close together within the mycelium are unlikely to be delivered to the same site of growth at the periphery potentially to stop deleterious mutations accumulating in one region of the fungus 24 2 recent experiments in the dung fungus coprinopsis cinerea show large swathes of the network responding to the external threat of predatory nematode worms when nematode grazing is detected in one part of the fungal network a suite of defense chemicals is expressed not just at the site of grazing but spreading in multiple directions through the network 21 spreading out nematoxin production may prepare other parts of the network for further attacks or enable the cost of labor to be spread through the network 23 3 plasmodial slime molds such as physarum polycephalum live in heterogeneous environments containing patches of nutrients 4 the network remodels globally when it discovers a new nutrient source and it is thought that individual tubes in the network respond to a cue carried within the flow carried within the network 5 a global response to this cue requires that it be dispersed through the entire network we model the signals within the network as being passively transported by the flows in section 2 we define an entropy of mixing of the transported signals in a flow network in section 3 we describe a numerical method for choosing the conductances within the network and in section 4 we show simulation results a highlight result is that for small values of the parameter which represents the penalty of dividing one edge into two the optimal networks become a set of paths linking source and sink we prove why paths are favored and analytically expose the set of possible path optima in section 5 2 mathematical model and mixing entropies optimal mixing in transport networks 3 fig 1 conductance network ij with each node and edge conductance labeled the source is at node 1 the bottom left corner and the sink is at node 25 the top right corner 2 1 movement of signals through a flow network our mathematical model for the biological transportation network consists of a network graph with nodes vertices n enumerated 1 2 n and edges e the nodes are arranged on a regular triangular lattice so that each vertex in the interior is linked by equal length edges to 6 neighbors we write n i for the set of neighbors of i the conductance of the edge i j is denoted by ij fluid protoplasm is continually pushed through the network by pressure differences between the nodes in our model the ultimate origin of these pressure differences are flows into and out of the network via diametrically opposite nodes signals are carried along by this bulk flow of fluid definition 2 1 the rate of fluid entering or exiting the network at i n is the boundary flow at node i and is denoted qi boundary flow qi 0 corresponds to fluid entering the network through node i i e the node is a source and qi 0 corresponds to fluid exiting the network at node i i e the node is a sink the total volume of fluid contained in the network is constant so total inflows and outflows must be balanced iqi 0 the boundary flows in turn engender flows qij on the edges flows must also be balanced on each node in the network a fact that is known as kirchhoff s first law of circuits definition 2 2 a flow is called compatible with regards to the boundary flows qi if j n i qij qi for all i n for any set of boundary flows there are typically multiple compatible flows on the network the flow we are interested in called the physical flow is the unique compatible flow that minimizes the dissipation definition 2 3 for a conductance network ij the dissipation d from flows qij is the rate at which work must be done to maintain the fluid flows on all edges of the network d qij ij q 2 ij ij the flow that minimizes the dissipation can be derived from kirchhoff s first and 4 c mentus and m roper second laws 8 which introduce a pressure variable that is defined on each node in the network proposition 2 4 kirchoff s second law for circuits let ij be a connected conductance network with nodes n and edges e let q be boundary flows such that iqi 0 let qij be the physical flows of this network then there exists pi r called the pressure at node i such that qij ij pi pj we can compute the pressures by defining a vector of pressures p pi i n a vector of boundary flows q qi i n and the network laplacian a n n matrix with entries 2 1 ij ij if i 6 j j ij if i j then conservation of mass at each node proposition 2 4 is equivalent to solving 2 2 p q so long as every connected component of a physical network has one node with a defined pressure the pressures are uniquely solvable otherwise they are solvable up to a single additive constant per connected component 8 when the conductance network is connected and the pressure at node i is known pi p we add p to qi and construct the invertible matrix by adding 1 to ii we now consider the mixing produced by the flows within the network our flow network model contains all of the scenarios for mixing described in section 1 the signals passing through the network could represent genetically diverse nuclei scenario 1 or chemical cues scenarios 2 and 3 our model does not need to represent the entire network it could represent the portion of network that supplies a single hyphal tip this supply network would be linked to supply networks for other tips and acquires signals randomly at each node from these other networks 1 signals are made up of blobs either molecules or organelles we compile a list of the nodes visited by each signal blob call the t th node visited by a signal xt then xt is a random walk with transition probability 2 3 tij p xt 1 j xt i qij k n i qik 0 qik qi 1 qi 0 that is the flow of signal from i to j is simply proportional to the total flow along the edge i j effectively we assume that signal is uniformly dispersed in the flowing protoplasm ignoring any physical effects such as diffusion 17 that move signals independently of flows when the signal reaches a sink node it may exit the modeled network with the exit probability proportional to qi so j tij 1 a signal introduced at node i travels along the network following the flow at each node with multiple possible outward flows the signal chooses one outflow probabilis tically signals therefore perform a type of random walk down the pressure gradient there are two senses in which signals may be considered to mix on the network 1 given the node i at which it originates we are interested in the number of nodes that the signal visits before exiting the network 2 alternately given a node j we are interested in the number of different sites of origin that signals passing through j may 1 signals can be transferred between supply networks without flow between them since motor protein trafficking of nuclei or diffusion of chemical cues provide alternate transport mechanisms optimal mixing in transport networks 5 have to quantify either form of diversity we must focus on the probability that a signal originating at node i ever visits a node j defined by 2 4 pij p xt j for some t 0 x 0 i the entries of pij from a n n matrix to calculate this matrix from the transition probabilities t note that the probability of getting from i to j by following exactly n edges is tn ij hence p n 1 n 0 t n note that tn 0 because a signal can visit at most n nodes before exiting the network and signals can not visit the same node twice alternatively by summing the geometric progression 2 5 p i t 1 where i is the n n identity matrix 2 2 defining mixing entropies we define two types of information entropy on the flows qij the first is a measure of the accumulation of signals at every node in the network and the second represents the dispersal of signals throughout the network we call the two entropies respectively total receiver entropy or total mixing entropy and total sender entropy let fi be the total flow through node i i e fi j n i qij 0 qij qi 1 qi 0 the rate at which fluid flows from i to j is then q ij pijfi we refer to this as the flow from i to j we assume that the rate at which a signal is produced at a node is proportional to the total flow through that node this assumption certainly makes sense if our signal consists of new nuclei that are generated by divisions within the protoplasm since the flow through a node will be proportional to the rate at which nuclei pass through it for other signal production scenarios such as when the signal is produced in response to predation we can arrive at this assumption if we assume that product of the new signal is rate limited by a component that is contained within the protoplasm so signal production rate is proportional to rate of protoplasm cleared through the node in unit time under this assumption the relative proportions of signals received at node j from upstream nodes i are the same as the relative proportions of q ij in our model each site in the network can send signals to other sites in the network and any point in the network may potentially receive signals from any other point we cannot tell ahead of time which nodes will provide the useful signals so we consider all nodes as possible sources of signals we also make no assumption about sites where diversity needs to be maximized this is in contrast to 24 in which genetic diversity was considered only at hyphal tips so we consider all of the possible nodes that signals can reach within the network when computing the mixing entropy to compute the entropy of the distribution of signals arriving at i we define the probability distribution on up stream nodes of i 2 6 pi j q ji ni where ni j q ji 0 q ji effectively forming a new matrix from q ij in which all columns are normalized to sum to 1 we may define the local receiver entropy at node i as the shannon information entropy of pi h pi j pi j log pi j we consider the total flow through i as a measure of the importance of the node 13 in our model the diversity of signals is more important at high traffic nodes than at low traffic nodes this principle is useful mathematically since it ensures that rearrangements 6 c mentus and m roper of very low conductance edges don t greatly affect the overall mixing associated with a network at the same time the weighting is intended to reflect the relative biological importance of nodes within the network a node with high flow supplies a greater volume of cytoplasm to the rest of the network so it is more important that all of the signals whether cues or nucleotypes are present at the node hence the total receiver entropy is 2 7 h i fih pi similar to 27 h represents the conditional entropy associated with choosing a re ceiving node at random with probability proportional to fi and then conditioned on our choice of node i we chose a sending node at random via the distribution pi 2 3 set restrictions of the entropy our proofs in section 5 often require that we partition n into subsets of nodes it is convenient to be able to evaluate the contributions of each subset to the total network entropy we define restricted entropies for subsets f n as follows for all i f define pfi j q ji k f q ki if j f and pfi j 0 otherwise definition 2 5 the local negative mixing entropy restricted to f is defined to be 2 8 h pfi j f q ji 0 pfi j log pfi j and the total mixing entropy restricted to f is 2 9 hf i f fih pfi 2 4 sending entropy on flows it may also be important for the network to spread out signals to as many downstream nodes as possible we define an entropy for the places that can be reached by a new signal originating at a node within the network specifically instead of taking the mass distribution of incoming flows and normalizing them to a probability distribution we use the out going flows that is we define the probability distribution of nodes that can be reached by a signal introduced at node i 2 10 p i j q ij j q ij 0 q ij this is equivalent to normalizing the matrix q so that all rows sum to 1 we define the local sending entropy at node i to be the shannon information entropy 25 of the distribution p i 2 11 h p i j p i j log p i j and we define the total sending entropy of the entire network to be the weighted sum of the node entropies 2 12 h i fih p i optimal mixing in transport networks 7 2 5 equivalence of receiving and sending entropies although the en tropies h and h offer alternate representations of the mixing that occurs within the network they are linked by an equivalence principle theorem 2 6 let qij be a flow network compatible with boundary flows qi let q ij and q i be the flow network and boundary flows obtained from qij and qi by re versing the flows i e q ij qij and q i qi then h qij h q ij proof notice that reversing the flows doesn t affect the flow strengths of nodes within the network because fi j qij 0 qij qi 1 qi 0 j qij 0 qij qi 1 qi 0 2 13 j q ij 0 q ij q i 1 q i 0 2 14 the equivalence principle boils down to proving the statement q ij q ji where q ij is the flow from node i to node j in the flow reversed network we derive this equality by comparing the probability of a signal path xt t 0 1 t under the flow qij with the probability of the reversed path x t xt t t 0 1 t under the reversed flow q ij since qij q ij it follows that tijfi t jifj and so t ji fi fj tij we multiply the probability of the path xt by the strength of the starting node fx 0 to obtain fx 0 t 1 t 0 txtxt 1 and rewrite via a telescoping product 2 15 fx 0 t 1 t 0 txtxt 1 fxt t t 0 fxt fxt 1 txtxt 1 fxt t t 0 t xt 1 xt fxt t t 0 t x tx t 1 for any nodes i and j in the network we can sum over the probability of all possible paths i to j in the regular network and j to i in the flow reversed network to obtain q ij fipij fjp ji q ji hence the distributions p i j for the flow network qij are equal to the distributions pi j for the network q ij so h i qij hi q ij leading to the required result the physical flow on the network see proposition 2 4 can be reversed by reversing the sources and sinks in the network that is replacing a source with inflow qi by a sink with outflow qi and conversely in the cases that we will analyze in this paper the sources and sinks are matched in number and strength e g a single source and single sink at opposite corners of a square grid network so a network that optimizes receiving entropy can be transformed into a network that optimizes sending entropy simply by rotating the source into the sink and conversely for this reason we do not have to develop separate results for the two entropies we focus on analyzing the receiving entropy which we refer to simply as mixing entropy henceforth 2 6 mathematical formulation of the optimization problem building and using flow networks requires energy investment an organism s optimal network will reflect tradeoffs between mixing effectiveness and the cost of the network the cost has two components each edge in the network must be built and maintained and the fluid transported within the network dissipates energy due to friction the two cost components play slightly different roles in our optimization we incorporate the first cost via a holonomic constraint and the second via a penalty murray 20 posited that the cost of a maintaining a vessel is either proportional to its volume or surface area since all of the vessels in our networks have the same 8 c mentus and m roper length and the hagen poiseuille law states that conductance is proportional to the fourth power of the radius these scenarios correspond respectively to the cost of an edge being proportional to 1 2 ij or to 1 4 ij we constrain the cost the total material available to the network requiring ij c where 0 1 is a constant whose effect on network morphology will be explored 7 9 2 to incorporate the cost of dissipation in our optimization we formulate it as a minimization problem 2 16 find arg min ij h ij cd ij ij 0 i j e ij c we refer to as the mixing dissipation cost abbreviated cmd since the set of allowed conductances is compact we know that the minimizer exists the constant c represents the relative priority to the network of minimizing dissipation over maximizing mixing along with it is one of the main parameters that we explore in this work we stretch our notation to refer to the minimum value of for a given value of c as c lemma 2 7 the minimal mixing dissipation cost is a concave function of c that is for c 1 c 2 0 tc 1 1 t c 2 t c 1 1 t c 2 for all 0 t 1 proof set c 3 tc 1 1 t c 2 and let i be a minimizer of h cid i 1 2 3 then th 1 tc 1 d 1 1 t h 2 1 t c 2 d 2 th 3 tc 1 d 3 1 t h 3 1 t c 2 d 3 h 3 tc 1 1 t c 2 d 3 2 17 to finish formulating the optimization problem we restrict the set of network topologies that we are searching over let g be an unweighted undirected network with nodes n and edges e choosing e allows us to constrain e g the maximum degree of the nodes in our optimal network our optimal network is restricted to be a subnetwork of g we refer to g as the ambient network for the purposes of this study we will assume that the network is planar this assumption is almost certainly true for slime mold networks but is less valid in fungal networks where hyphae often crossover without connecting to each other in this paper we restrict to regular triangular networks in which all of the edges in the ambient network have the same length we do not think that our results are sensitive to the choice of regular ambient network we have for example reproduced all of the results discussed in this paper with square grid ambient networks 19 2 7 invariance of optima to changing the material investment in the network solutions of our optimization problem depend upon the value of c ij however as c is increased from 0 to the same sequences of optimal networks are found independent of c for suppose that ij is a conductance network that solves eq 2 16 with ij c then rescaling ij c c 1 ij produces a new network with ij c the flows are unaltered in this network so h ij h ij however dissipation is changed d ij c c 1 d so the new network minimizes optimal mixing in transport networks 9 in eq 2 16 for the new dissipation weighting c c c 1 c sweeping through all values c 0 with ij c we generate in one to one correspondence all optimal networks for c 0 with ij c the choice of the value for c is therefore arbitrary 3 numerical optimization chang and roper 9 optimized networks for gen eral differentiable functions using gradient descent however the mixing entropy that we seek to optimize here is non differentiable wherever the flow through an edge is equal to 0 it is necessary that the optimization algorithm be able to navigate through such points because as conductances are updated to maximize mixing entropy it is often necessary to reverse the direction of flow on one or more edges in fig 2 we show a contour map of varying two edge conductances within a network the original network is shown at top right and networks with reversed flow bottom and left the landscape is tiled into watersheds each watershed represents the set of entropies that can be attained by varying the conductances without reversing the direction of flow on any edge between the watersheds are ridgelines and crossing a ridgeline reverses the direction of flow on one or more edges within a watershed gradient descent can move the network toward the local optimum for the watershed but deteriorates if the local optimum is on the ridgeline even differentiable functions like dissipation produce landscapes with many lo cal optima accordingly in 14 simulated annealing and diffusive rearrangements of conductances were implemented to prevent networks from being trapped at unfavor able local optima we follow a similar approach by augmenting a gradient based search that is constrained to remain within a single watershed with a perturbation method that is designed to provide the network with alternate routes to explore and by intentional search over adjacent watersheds we describe the three parts and their integration below 3 1 part 1 of the optimization algorithm gradient based local search we perform a gradient based search via matlab s implementation of the interior point method in fmincon only edges with conductances larger than 10 4 at the initial state are optimized with smaller conductances treated as constant so that the dimension of the search space is not unnecessarily large to ensure the search is not challenged to cross the ridges that divide different flow topologies we enforce the sign of flow in each edge via a set of non linear constraints on the conductances although fmincon is capable of calculating the derivative of numerically within a watershed we accelerate the algorithm by computing the gradient analytically using lagrange multipliers to encode all of the relationships between conductance flow transition probabilities and mixing entropy we rewrite the array ij as e entry vector the function from eqn 2 16 that we are seeking to optimize is built up from ij via a chain of dependencies 3 1 ij 7 pi z fi z tij 7 pij z q ij 7 nj z h where a single arrow 7 represents a function of the immediately preceding variable and z represents a function of more than one of the variables to the left all of the relationships between variables are described in section 2 although it is possible to carry derivatives through this list of compositions the overhead from isolating and using several derivatives of arrayed functions with respect to arrayed variables makes the gradient computation forbiddingly slow 19 instead we follow a similar approach to 8 and use lagrange multipliers to enforce all of the functional relationships that 10 c mentus and m roper fig 2 landscape of the mixing entropy original network is shown at top right we systematically perturb the two conductances 8 12 and 5 9 at some critical perturbation of the conductances the flows q 8 11 and q 6 9 are respectively reversed reversed flows are circled in the network plots the landscape of mixing entropy middle has ridge lines where the flow is reversed are embodied in eq 3 1 eq 3 1 then becomes a road map for the order in which we solve for each of the lagrange multipliers in our system the constrained version of eq 2 16 omitting the dissipation becomes i n fi j q ji 0 q ji ni log q ji ni i n i ni j q ji 0 q ji i j n ij q ij fipij ij n ij ij pij l n tilplj i j n i ij tij qij 1 qij 0 fi 3 2 i n i fi j n i qij 1 qij 0 qi 1 qi 0 i i qi j n i ij pi pj for our gradient descent we make use of the derivative ab ab 1 qab 0 pa pb fa ba 1 qba 0 pb pa fb a pa pb 1 qab 0 b pb pa 1 qba 0 a b pa pb c pa pb 2 3 3 optimal mixing in transport networks 11 in which we have made use of the derivatives compiled in appendix a to calculate the derivative of the dissipation our working algorithm uses the above gradients along with two further trans formations first we require that all conductances be non negative we ensure this by representing our network in terms of log conductances defined by ij exp ij additionally we want to ensure that the total material investment in the network remains constant i e to ensure ij c in 8 this constraint was added via an additional lagrange multiplier but this method guaranteed that the constraint is satisfied only at leading order in the step size hence here we simply rescale the conductances ij 7 c i j ij 1 ij after each perturbation both transformations need to be considered when calculating the derivatives for the rescaling we get ij c 1 ab cd c 1 cd 1 ab ij ab 1 ij cd 3 4 to turn derivatives with respect to ij into derivatives with respect to ij we pre multiply them by ab ij ai bj ij 3 2 part 2 of the optimization algorithm redistributing material similar to dissipation minimizing networks 14 our optimization algorithm has many local optima in which source and sink are sparsely connected to find the true global optimum our algorithm includes a step for redistributing material within the net work in a way that presents the algorithm with a range of paths of different lengths between source and sink however although 14 previously redistributed material by diffusing it on the graph we found this method tends to short circuit the net work by introducing much shorter paths between source and sink the appearance of these paths is catastrophic for the optimization algorithm since they are attracting local optima but far from the global optima 19 since our algorithm does not send conductances exactly to zero we define a threshold conductance c and say that an edge as well as the vertices that it connects is in the support of the network if its conductance exceeds c in practice we found that a value c 2 10 2 worked for all of the simulations shown in this paper we redistribute material using a network growth step which adds spurs of material from the network s support our algorithm takes the form of a set of operators growup right ij where up right in the subscript can be replaced with the up left down left or down right to denote the direction in which material is added growth in the up right direction adds edges that link nodes in the support to nodes not in the support that are upwards and right of them each step of the growth algorithm concatenates growth in two non parallel directions in practice we did not find it necessary to include right or left growth we will describe the up right growth step other growth steps can be derived from this step by symmetry 1 first locate up right edges in the triangle grid for which the top right node is outside of the support of the network and the bottom left node is inside the support 2 add positive conductance to each of these edges to form a new network up right fig 3 b each new edge is assigned conductance equal to the av erage conductance of the edges from the support adjacent to its bottom left node in the set of bottom left nodes identified in 1 3 in up right locate the nodes which are top right nodes of edges in the support call this set the top right nodes fig 3 c 12 c mentus and m roper a b c d e fig 3 sequence of steps performed to construct up right from an initial network shown in a b blue edges are added up rightwards from a bottom node in the support of the network to a top node outside of the support of the network c we identify top right nodes blue circles whose bottom left edges have non zero conductance following the first step d add leftwards orange and down rightwards green edges if they complete triangles with edges in the current support e our optimization scheme applies the up right growth algorithm twice 4 for every top right node i if i is the apex of a triangle whose base and up right edge lie in the support of up right complete this triangle with an up left edge whose conductance is the arithmetic mean of the other two edges for every top right node i that is the left vertex of an inverted triangle whose up left and up right edges lie in the support of up right complete the triangle with a horizontal edge whose conductance is the arithmetic mean of the other two edges fig 3 d 3 3 part 3 of the optimization algorithm changing flow directions part 1 of our optimization algorithm can reliably locate local optima while respecting the directions of flow on every edge i e the flow topology to find the true global op timum we search systematically over adjacent topologies to do this we take one edge within the network and find the smallest increase and decrease in the conductance of the edge that will change the direction of flow in at least one other edge within the network to find the smallest change in conductance we use the sherman morrison formula 26 which allows us to calculate an explicit expression for the conductance change necessary to reverse the flow in any edge of the network eq b 4 given a causal edge a b eq b 4 enables us to compute a set of perturbations tabuv to ab to reverse the flow on any edge u v we filter these perturbations to keep only perturbations in which ab is not allowed to become too small in practice a threshold of 10 3 gives good results to prevent this part of the algorithm getting stuck en gineering and then re engineering flow reversals on edges that already have very low conductance this method was used to find the set of flow changes shown in fig 2 3 4 synthesis of parts initialization and termination we initialize the algorithm by assigning each edge within the ambient network an u 0 1 conductance and then scaling all conductances to ensure ij c a single step of the algorithm consists of running all three of its parts sequentially part 1 locates a locally optimal network that respects the flow directions given to it while the random choice of growth directions in part 2 and of causal conductances in part 3 stochastically alters the topology of the network we compare the local optima arrived at the end of consecutive part 1 s if the new local optimum has a lower value of than the old we keep it otherwise we revert to the old optimum our descent step uses the matlab optimization function fmincon using the interior point algorithm with 1000 max iterations with flow directions constrained on optimal mixing in transport networks 13 all edges with non negligible conductance see below and with analytically computed derivative our growth step requires first picking a single direction in which to grow the network up left up right down left or down right to ensure that every direction is sampled we sequentially step through a permutation of all 4 growth directions choosing a new permutation every 4 steps we then count the number of times that during a successful step decreased by less than 10 2 when this count reaches 4 we terminate the algorithm otherwise we allow the algorithm to run for 50 iterations usually the stopping criterion is reached in fewer than 15 steps we tested that our algorithm reliably i e in more than half of runs located the theoretically obtained optimal network when c 0 05 our algorithm constrains all conductances to be be positive through the use of the coordinate transformation ij exp ij in practice the local optima located by our algorithm use only a subset of the edges in the ambient network we disregard edges with small conductances in practice any edges with conductance less than 2 10 4 specifically the directions of flow on these edges are not considered when constraining flow directions in part 1 or when determining the perturbations that cause flows to switch in part 3 after the algorithm terminates we perform a final filtering step to deal with the fact that our gradient search is somewhat slow at removing edges from the network or redistributing material between high conductance edges to filter we set all edges with conductance 10 3 to 10 9 re scale all edges so that the material cost of the network stays the same and then run our gradient search with 10000 max iterations most of our simulations involve sweeps over c values see section 4 typically involving 100 200 replicate networks whose c values are close enough that we expect them to be topologically equivalent we can further boost coverage since any local optimum discovered by our algorithm at c c can be compared with local optima for different values of c by tracing the line h cd we form the envelope of these straight lines fig 6 at any value of c we identify the network that produces the straight line on which c c lies as the global optimal network for that value of c 4 results from numerical optimization 4 1 optimal networks are paths for small values of we first studied the effect of fixing the value of c and constructing optimal networks over a range of values for we found that at each value of c the number of loops in the path increased with cf dissipation minimizing networks which form loops only when 1 11 7 at physiologically relevant values of 0 45 0 5 the globally optimal networks are simple loopless paths linking source to sink 4 2 length of optimal networks increases with c we noticed that in fig 4 changing c changes the number of edges in the network to investigate the effect of c more systematically we performed a numerical sweep of c values holding 0 45 fixed all of the optimal networks were simple paths as c increases the globally optimal network systematically explored all path lengths from n 2 1 a path that visits every node exactly once to 2 n 1 the shortest path linking source to sink fig 6 shows the complete c trace including for the networks included in fig 5 the numerically obtained c is piecewise linear with slope discontinuities at each c value where the length of the optimal network increases by one 5 optimal path networks our numerical results from section 4 highlight three properties of optimal networks that they are simple paths at small and mod 14 c mentus and m roper fig 4 numerically computed optimal networks on a 5 5 triangular grid for three different values of c rows and four different values of columns at sufficiently small values of in particular for 0 45 at each assayed value of c optimal networks are all paths from source to sink increasing progressively adds loops to the network increasing c increases the number of nodes visited by the network fig 5 selected optimal networks for 0 45 on a 5 5 triangular grid for increasing values of c values given above each panel are all paths with decreasing lengths every possible length of path between 24 and 9 edges is obtained the networks shown are the magenta points in figure 6 erate values of that the path length decreases as c increases and that for small values of c the simple path visits every vertex in the network in this section we will rigorously state and prove theorems justifying these properties we will first prove separate results for mixing and for dissipation we will show that the optimal network for mixing that is without considering the cost of dissipa optimal mixing in transport networks 15 fig 6 optimal mixing dissipation costs for networks on 5 5 grid with 0 45 and k 24 the c domain is divided into subintervals 01 c 25 24 cm 1 m cm m 1 for m 9 10 24 and c 10 9 7 cm n is defined in section 5 and 100 locally optimal networks are generated within each subinterval global optima are derived is described in section 3 4 selected globally optimal networks magenta points are plotted in fig 5 tion is a tour a path that visits every node in the network from source to sink then given only the flows on a network we bound its dissipation second we will consider optimization among path i e loopless networks showing that as the cost of dissipation is increased the length of the optimal path network decreases mono tonically in length in steps of 1 from the tour to a geodesic shortest path finally we show that among all networks over many different values for the dissipation pen alty factor c the optimal network is a path for all sufficiently small we start by introducing a notation for paths of different lengths assuming that conductances are uniform i e the same on each edge within the path which is favored for minimizing dissipation definition 5 1 say that a path from source to sink has length m if it visits exactly m nodes we use the notation m to denote any uniform conductance path of length m further we call n the path that visits every node in the ambient network a tour 5 1 the optimal network for mixing is a tour theorem 5 2 suppose that qij is a flow network with node set n and n n then the maximum possible total mixing entropy is log n and this maximum is attained only for a path that visits all n nodes exactly once the intuitive interpretation of this result is that all of the nodes in the network can be ordered by their pressures pi signals from node i can reach node j only if pi pj an optimal mixing configuration is one in which signals from node i reach all downstream j with probability 1 which requires that the downstream network is a path that visits each downstream node in turn proof let x xt t 0 be the random walk on the flow network defined in section 2 let vk n be the set of nodes v that receive signals from exactly k nodes that 16 c mentus and m roper is vk u n v pvu 0 k for a subset of nodes s n we say that x hits s if for some t z 0 xt s let k 1 such that vk is non empty let u 6 v vk a signal x can not visit more than one node in vk for if x hits both v 1 and v 2 vk and wlog pv 1 pv 2 then for any u n with puv 1 0 we must also have puv 2 0 so u puv 2 0 u puv 2 0 which is impossible since v 1 v 2 vk implies both of these sets contain k elements let v vk then h pv log k because there are exactly k nodes u with q uv 0 this inequality together with v vk fk 1 gives us the lower bound on h 5 1 i n fih pi n k 1 v vk fvhv n k 1 log k log n we show that the only network with n nodes attaining the maximal entropy is a path for the path labeling the nodes 1 2 n in the order in which they are visited from source to sink we find for 1 i j n q ij 1 therefore the probability distribution of signals pi is the uniform distribution on i atoms and has entropy hi log i hence h n i 1 fihi log n conversely if qij 6 n then there must be at least one k 1 2 n such that vk in this case h differs from log n by at least log k corollary 5 3 let qij be a flow network on nodes n and 6 f n with f m then hf log m to deduce the corollary we treat the probabilities pfi in the same fashion as we treated the probabilities pi in the proof of theorem 5 2 5 2 dissipation in a network can be bounded given the flows on the network the dissipation d for a network is a function both of its conductances ij and its flows qij however we can bound the dissipation based on the qij alone given only the constraint that ij ij c theorem 5 4 murray s law let qij be a network of flows then if ij ij c the smallest possible dissipation in the network is ij q 2 1 ij 1 1 c 1 this theorem is equivalent to murray s law 8 it is based on assigning each edge the conductance that minimizes the overall network dissipation proof fixing flows we minimize the total dissipation over conductances obeying the building constraint ij c that is we minimize the overall function 5 2 d ij ij q 2 ij ij ij ij c where the lagrange multiplier maximizes the dissipation and we restrict to edges on which qij 6 0 the minimization of d is performed on a compact set ij 0 and ij ij c so the minimum certainly exists since d whenever ij 0 so the optimal value of d occurs at an interior point within this set so at the minimum point 5 3 0 d ab q 2 ab 2 ab 1 ab optimal mixing in transport networks 17 solving this equation yields ab q 2 1 ab murray s law and we find our constant of proportionality by imposing the constraint ab ab c 5 4 ab c 1 q 2 1 ab ij q 2 1 ij 1 substituting for ab in the dissipation yields the required inequality 5 3 strong nodes and path like networks our main results will concern networks that are close to paths for example path networks that have low conductance excursions adjoined to some of the path nodes how much do these additions affect the network s mixing entropy thinking more generally we consider networks in which some edges are strong and others are weak we will define strong and weak and bound the contribution of the weak nodes to the network entropy definition 5 5 let 1 2 n be a labelling of the nodes in the network g in decreasing order of total flow fi that is f 1 f 2 fn select 0 1 which will be referred to as the dominance factor let k min i fi fi 1 the nodes 1 2 k are referred to as the strong nodes above dominance factor denoted f theorem 5 6 let 0 and let qij be a flow network on an ambient network g with nodes n then there exists 0 depending only on g such that h hf in addition may be chosen such that for each node i f the nodes adjacent to the largest magnitude in flow at i and the largest magnitude out flow at i are also strong nodes that is if u v n i are such that qui maxj n i qji and qiv maxj n i qij then u v f proof let 0 be a dominance factor and for shorthand take f f to be the strong nodes in n over dominance factor by the triangle inequality we bound the difference 5 5 h hf i f fi hi hf i i 6 f fihi first we bound the first sum on the right hand side a sum over the absolute difference between the different mixing entropies let i f and j 6 f then 5 6 pi j q ji k 6 f q ki k f q ki fi fi pf i is obtained by omitting fewer than n n states from pi each with probability less than and then renormalizing to give a new probability distribution since entropy is uniformly continuous on the simplex n i 1 pi 1 pi 0 we can choose so that hi hfi 2 n so i f fi hi hfi 2 we now bound the magnitude of the second term on the right hand side hf i is an entropy of a random variable taking on less than n n values therefore hfi logn the total flow through each node fi for all i 6 f hence we have 5 7 i 6 f fihi i 6 f logn n logn 18 c mentus and m roper and so we can choose so that the second term is bounded by 2 to complete the proof note that the magnitudes of the largest in and out flows are fi deg i fi k where k is the largest degree of a node in g thus so long as 1 k the nodes connected to the largest in and out flows of degree i have total flows 1 k fi fi meaning they are also strong nodes we refer to the network formed by linking the nodes f up using the edges carrying the maximum inflow and outflow at each node as the strong network and re use notation by using f to represent the strong network 5 4 optimization of over paths anticipating our proof in section 6 that optimal networks are paths for sufficiently small we start by restricting our op timization to paths when restricted to path networks c minm h m cd m i e is the lower envelope of straight lines we first ask if c is varied does the sequence of minimizing paths always recapitulate fig 5 i e start with a tour at vanishingly small c and end at large finite c with a geodesic with the intermediate states being paths whose length increases by 1 at finite and predictable c values we can rationalize this sequence as follows for a uniform conductance path of length m each edge carries flow 1 and has conductance c m 1 1 so the total dissipation is d m c 1 m 1 1 1 which increases monotonically in m increasing c increases the relative strength of dissipation to mixing in mixing favors tours and more generally paths that visit as many nodes as possible while dissipation favors shorter paths at each c the optimal path length emerges from the balance of these two competing effects two paths of different lengths m and n give rise to straight lines c 7 h m cd m and c 7 h n cd n with different slopes denote the point of inter section between the lines by cm n 5 8 k 1 cm n log n log m n 1 1 1 m 1 1 1 log n 1 log m 1 n 1 1 1 m 1 1 1 lemma 5 7 the point of intersection cm n is monotonic decreasing in both m and n for m n 2 proof let xm m 1 1 1 then 5 9 cm n log 2 x 1 n log 2 x 1 m xn xm so cm n is the slope of the secant from xm f xm to xn f xn where f x log 2 x 1 n since f is an increasing function we need to show it is concave in order to show that these secant slopes decrease as either xn or xm increases given f log u x where u x 2 x 1 we have that 5 10 f x u x u x u x 2 u x 2 to show that f is concave we then need that u u u 2 0 to compute these derivatives recall d dx 0 where 0 is the digamma function the trigamma function 1 is defined to be 0 and so d 2 dx 2 20 1 pulling these results optimal mixing in transport networks 19 together we obtain 5 11 u u u 2 1 1 2 x 2 1 1 x 1 0 2 let z x 1 2 then z is an increasing function of x and visa versa since all of the other multipicative terms in the expression u u u 2 are positive we only need to show that 1 x 1 0 is negative for all z x 1 n 2 n 1 2 3 we have 1 x 1 0 1 x 1 0 1 z 1 z 2 0 z 1 z 1 z 2 1 z z 2 log z z 2 1 2 z 2 log z 1 z 2 here we made use of the inequalities 15 0 z log z 1 z and 1 z 1 z 1 z 2 15 for all z 0 the last line is 0 for all z 3 proving the lemma theorem 5 8 when is optimized among paths on a triangular ambient grid with n nodes and c is increased from 0 the optimal path decreases in length by 1 at predictable values of c cn n 1 cn 1 n 2 cn 2 n 3 that is n for c cn n 1 n 1 for cn n 1 c cn 1 n 2 n 2 for cn 1 n 2 c cn 2 n 3 and so on proof the theorem follows directly from the monotonicity property proven in lemma 5 7 we have already shown that the tour n is the optimal path at c 0 as c is increased the line n intersects with all lines m for m n at cn m because of monotonicity the smallest of these points of intersection is cn n 1 thus n is the optimal path for c cn n 1 n 1 intersects with all lines m for m n at cn 1 m the first point of intersection is cn 1 n 2 so n 1 is replaced by n 2 and in turn by n 3 and so on 6 all optimal networks are paths for sufficiently small now we prove that for cm 1 m c cm m 1 networks with a unit source sink pair optimizing h cd are approximately paths of length m in the limit as 0 our proof works for any subinterval of cm 1 m cm m 1 the parameter 0 1 represents the fraction of cm 1 m cm m 1 covered by the subinterval we can also represent the subinterval by cm 1 m c cm 1 m where 12 1 cm 1 m cm 1 m theorem 6 1 let g be an ambient network with a single unit flow source and sink let m be a possible length of a path in g connecting the source to the sink let 0 1 we claim that there exists 0 and 0 such that if 0 and f is the network of strong nodes such that hf h provided by by theorem 5 6 and the material cost exponent then for any cm 1 m c cm m 1 the network f is a path of length m proof we can simplify the calculations in our proof by appealing to the result from section 2 7 that the sequence of optimizers is identical as c is varied for any value of c accordingly we consider the special case c m 1 for this choice of material cost c d n m 1 1 n 1 1 1 then the computation of on paths is is drastically simplified 6 1 d n 0 if n m m 1 if n m if n m 20 c mentus and m roper log m 1 logm log m 1 cm m 1 cm m 1 cm 1 m m 1 m 1 m c fig 7 against c loci for the simple paths m 1 dotted black m dashed black m solid gray in the limit as 0 the loci of m 1 m m 1 are shown in fig 7 define as above for the fixed material cost c m 1 let be such that we can choose with m m 1 for all cm 1 m c cm m 1 and let qij be a flow on g with the specified source and sink according to theorem 5 6 we can define 0 a dominance factor and f a network of strong nodes such that h f h qij f has no leaf nodes except potentially the source and the sink suppose f contains n nodes then by euler s topological formula it must contain n 1 f edges where f is the number of faces in the network given the constraints on f f 0 if and only if f is a path hence h f log n each edge must carry at minimum flow n 1 f accordingly the dissipation in the network can be bounded below by d n 2 n 1 f n 1 f m 1 1 by theorem 5 4 d n as 0 if n f m since networks with bounded dissipation exist the optimal network must have n f m we can then compare the strong network with m 1 and m if n m 1 by corollary 5 3 f h f log n log m 1 lim 0 m 1 this implies that qij m and so qij is in fact sub optimal therefore n m since n f m f 0 i e f is a path of length m by choice of f can approximate f arbitrarily closely in since our convergence result can be made uniform in over the interval cm 1 m c cm m 1 it follows that f converges to some path m as 0 except possibly at the points cm m 1 our proof method does not provide us with a way to prove convergence at these points but based on our numerical simulations we think it is likely that as 0 there are simply two optima m and m 1 with indistinguishable values at these crossover c values 7 discussion we introduced and analyzed theoretically and by numerical sim ulations two measures of mixing quality on networks one measuring the diversity of places within a network that may be reached by cues originating within that network sender entropy and the other reflecting the diversity of cues that are received at each point within the network receiver entropy happily we were able to show that sender entropy for a network is equivalent to the receiver entropy on the same net work if flows are reversed allowing us to focus on optimizing just one kind of entropy optimal mixing in transport networks 21 within this paper the mixing entropy quantifies the diversity of signals which may include cues genotypes and nutrients present at each point within the network it is important to determine which type of mixing an network may be prioritizing before comparing it to theoretical calculations importantly while at small optimizing either entropy will produce identical networks at biologically relevant values of which type of mixing is most important to the network influences important features of its organization such as the placement of loops we proved that in the single source single sink geometry the optimal networks converge to simple paths joining source to sink with the path length determined by the different priorities that the network gives to mixing which favors long paths and to dissipation which favors short paths intriguingly our numerical simulations suggest that there is a finite value of which for our 5 5 ambient grids is approximately 0 45 at which optimal networks transition from loopy structures to simple path see fig 4 however it is hard to guarantee that the network does not contain weak edges that do not show up in fig 5 our optimization algorithm enforces positivity of conductance on all edges only to filter low conductance edges at the end accordingly it is not readily able to distinguish between small but finite conductances that vanish only as 0 and a bifurcation that removes edges at a finite value of so we must be cautious about interpreting the disappearance of loops at finite as evidence of a phase transition in the network analogous to the disappearance of loops at 1 for dissipation minimizing networks 7 we have narrowly focused on the case where there is only one source and one sink within the network allowing us to rigorously validate our numerical results however our numerical optimization method is equally applicable to networks with multiple sources and sinks and it is possible to explore for example the conditions under which a network that is transporting material from a pair of sources to a pair of sinks will determine to maintain two separate flows or bring these flows together 19 in particular determining whether real network forming organisms such as fungi and slime molds have mixing optimizing networks will require that we properly model the locations of the sources and sinks that drive their flows it is equally important when comparing optimal mixing networks with real biolog ical networks to pin down the value of for these networks on theoretical grounds we expect real biological networks in which vessels are simple tubes to operate in a range of from 1 4 when the cost of network upkeep is proportional to the surface area of its vessels to 1 2 when upkeep is proportional to vessel volume although direct measurement of is impossible the branching hierarchies of xylem vessels in plants and some levels of cellular tubes in the slime mold physarum poly cephalum obey murray s law theorem 5 4 18 1 specifically if q 1 2 then 1 2 will be conserved between different levels of a hierarchical network for sim ple tubes we may assume the hagen poiseuille law that the conductance of a vessel and its radius a are related by a 4 it follows that a 2 2 is conserved in p polycephalum r is conserved across different levels of the hierarchy with a range of values between 2 5 3 3 1 corresponding to 0 27 0 65 values are similar for plants but determining from vessel radii is complicated by the fact that the xylem vessels like the cords of mycorrhizal fungal networks are constituted of many smaller tubes suppose these tubes have radius a but individually obey the hagen poiseuille law then a 2 a 2 the total number of tubes at the same level in the hierarchy is reported to increase by a factor f 1 2 moving from larger to smaller tubes 18 accordingly since a decreases by a factor of 2 1 when one tube 22 c mentus and m roper splits into two then a a 1 2 2 log 2 f and so 1 2 2 2 log 2 f we therefore estimate that the plants in 18 have values ranging from 0 8 for fraxinus pensylvanica f 1 2 2 2 up to 1 4 for campsis radicans f 1 4 3 so slime molds span the value of 0 5 at which our calculations show loops being eliminated from the optimal network while plant networks sit high above this value the optimal networks shown in figure 4 for 0 5 qualitatively resemble the real structures of migrating slime mold networks in which densely interconnected fans of tubes are linked together by sparsely connected or even loopless networks see e g fig 1 in 3 in future work we plan to analyze the optimal loopy networks found by our algorithm to determine why optimal mixing requires fans loopy regions don t appear throughout the network but are located only near the source as well as to understand how the tradeoffs between mixing and dissipation can be used to predict the size of the fan relative to the total length of the network that real network forming organisms do not form tours may result from their values being too high however even at low values of networks face other tradeoffs such as resistance to damage and or the need to minimize dissipation when the sources and sinks fluctuate in strength 14 an additional property that must be highlighted for organisms such as fungi and slime molds that have indeterminate growth is that organisms need to maintain their mixing while growth pushes sources and sinks ever further apart a tour can be extended indefinitely to include to an ever increasing number of nodes by extending it node by node however this model of growth ex tends the network only by adding a single edge at a time restricting growth to a single growing tip and is an inefficient strategy for a fungus or other foraging organ ism that must compete for space and resources with other organisms the type of network formed by a network is also shaped by the constraints on how it must form this network fast foraging may favor growth in multiple directions simultaneously facilitated by the organism having multiple growing tips thus optimization prin ciples such as those developed in this paper only achieve true biological relevance when linked to a set of rules that a growing organism can follow to attain the optima such rules have been only recently elucidated for dissipation minimizing networks see e g 12 leaving unmet the challenge of constructing rules to achieve more complex objectives including mixing acknowledgments we thank karen alim eleni katifori and sebastien roch for many useful discussions at a sequence of square meetings hosted by the american institute for mathematics where the idea for this project was developed appendix a computation of derivatives of to differentiate we compute the all of intermediate variables appearing in eq 3 1 i e pi qij fi tij pij q ij and ni the pressures pi are first obtained by solving eqn 2 2 using the matlab function mldivide we then solve a chain of equations to obtain the lagrange multipliers ni 0 q ab 0 pab 0 tab 0 fa 0 pa 0 a 1 first a 2 na i q ia n 2 a log q ia na q ia n 2 a a 0 optimal mixing in transport networks 23 second a 3 q ab fb nb log q ab nb fb nb b ab 0 third a 4 pab ab i ibtia abfa 0 so a 5 ab i ibtia ab fa fourth a 6 tab j n ajpbj ab 0 fifth a 7 fa j q ja 0 q ja na log q ja na j n ajpaj j n i aj qaj 1 qaj 0 f 2 a a 0 sixth to calculate pa we make use of the results pa qai ai and pa qia ia thus pa j aj a j i n a a ai 1 qai 0 i ai 1 qia 0 i n a ai ai 1 qai 0 fa ia ai 1 qia 0 fi 0 a 8 thus solving for the lagrange multipliers i requires solving a poisson equation on the network similar to eqn 2 2 appendix b finding adjacent flow topologies we assume that the network of non zero conductances has a single connected com ponent because although very small conductances are treated as negligible throughout our algorithm they remain large enough to keep the laplacian rank complete we take the inverse of the version of the laplacian defined in section 2 1 for the initial network we compute the directions of flow on each edge within the network edges with low flows are ignored the set of networks with the same directions of flow constitutes one of the watersheds shown in fig 2 we systematically vary one conductance ab within the network to find an adjacent watershed i e a flow net work in which some subset of the non negligible flows have been reversed we find the threshold values for ab at which one or more flow directions are reversed by appealing to the sherman morrison formula 26 we thank eleni katifori for bringing the s m formula to our attention specifically if the conductance in edge a b is increased to ab t then the laplacian for the new network becomes b 1 ij ij t ea eb ea eb t 24 c mentus and m roper then the sherman morrison formula yields 1 ij ij t ea eb ea eb t 1 1 ij 1 ij t ea eb ea eb t 1 ij 1 ea eb t 1 ij t ea eb b 2 given another edge u v we wish to find a perturbation to ab such that the flow along u v is reversed let ri be the i th row of 1 ij and dij be the i j entry of ij then the pressure drop is given by b 3 p u p v ru rv q t dau dav dbu dbv ra rb q 1 t daa dab dba dbb therefore the pressure drop is a monotonic function of t so the the zero of this equation is where the pressure reverses setting the left side to 0 we get the value t tabuv at which flow reversal occurs b 4 tabuv pu pv dau dav dbu dbv pa pb daa dab dba dbb pu pv references 1 d akita i kunita m d fricker s kuroda k sato and t nakagaki experimental models for murray s law journal of physics d applied physics 50 2016 p 024001 2 d akita i kunita m d fricker s kuroda k sato and t nakagaki experimental models for murray s law journal of physics d applied physics 50 2017 p 024001 3 k alim fluid flows shaping organism morphology philosophical transactions of the royal society b biological sciences 373 2018 p 20170112 4 k alim n andrew and a pringle physarum current biology 23 2013 pp r 1082 r 1083 5 k alim n andrew a pringle and m p brenner mechanism of signal propagation in physarum polycephalum proceedings of the national academy of sciences 114 2017 pp 5136 5141 6 d p bebber j hynes p r darrah l boddy and m d fricker biological solutions to transport network design proceedings of the royal society b biological sciences 274 2007 pp 2307 2315 7 s bohn and m o magnasco structure scaling and phase transition in the optimal trans port network physical review letters 98 2007 p 088702 8 s s chang and m roper minimal transport networks with general boundary conditions siam journal on applied mathematics 78 2018 pp 1511 1535 9 s s chang and m roper microvascular networks with uniform flow journal of theoretical biology 462 2019 pp 48 64 10 f corson fluctuations and redundancy in optimal transport networks physical review let ters 104 2010 p 048703 11 m durand structure of optimal transport networks subject to a global constraint physical review letters 98 2007 p 088701 12 d hu and d cai adaptation and optimization of biological transport networks physical review letters 111 2013 p 138701 13 j izsak parameter dependence of correlation between the shannon index and members of parametric diversity index family ecological indicators 7 2007 pp 181 194 14 e katifori g j szo llo si and m o magnasco damage and fluctuations induce loops in optimal transport networks physical review letters 104 2010 p 048704 15 a laforgia and p natalini exponential gamma and polygamma functions simple proofs of classical and new inequalities journal of mathematical analysis and applications 407 2013 pp 495 504 16 r r lew how does a hypha grow the biophysics of pressurized growth in fungi nature reviews microbiology 9 2011 p 509 optimal mixing in transport networks 25 17 s marbach k alim n andrew a pringle and m p brenner pruning to increase taylor dispersion in physarum polycephalum networks physical review letters 117 2016 p 178103 18 k a mcculloh j s sperry and f r adler water transport in plants obeys murray s law nature 421 2003 pp 939 942 19 c mentus information theoretic and statistical models for spatial transportation networks total mixing entropy on optimal fluid flow networks and time dependent stochastic block models phd thesis ucla 2019 20 c d murray the physiological principle of minimum work applied to the angle of branching of arteries the journal of general physiology 9 1926 p 835 21 d f plaza s s schmieder a lipzen e lindquist and m ku nzler identification of a novel nematotoxic protein by challenging the model mushroom coprinopsis cinerea with a fungivorous nematode g 3 genes genomes genetics 6 2016 pp 87 98 22 h ronellenfitsch and e katifori global optimization local adaptation and the role of growth in distribution networks physical review letters 117 2016 p 138301 23 m roper c ellison j w taylor and n l glass nuclear and genome dynamics in multinucleate ascomycete fungi current biology 21 2011 pp r 786 r 793 24 m roper a simonin p c hickey a leeder and n l glass nuclear dynamics in a fungal chimera proceedings of the national academy of sciences 110 2013 pp 12875 12880 25 c e shannon a mathematical theory of communication bell system technical journal 27 1948 pp 379 423 26 j sherman and w j morrison adjustment of an inverse matrix corresponding to a change in one element of a given matrix the annals of mathematical statistics 21 1950 pp 124 127 27 t tanyimboh and a templeman calculating maximum entropy flows in networks journal of the operational research society 44 1993 pp 383 396 28 a tero s takagi t saigusa k ito d p bebber m d fricker k yumiki r kobayashi and t nakagaki rules for biologically inspired adaptive network de sign science 327 2010 pp 439 442 29 m zamir s wrigley and b langille arterial bifurcations in the cardiovascular system of a rat the journal of general physiology 81 1983 pp 325 335 1 introduction 2 mathematical model and mixing entropies 2 1 movement of signals through a flow network 2 2 defining mixing entropies 2 3 set restrictions of the entropy 2 4 sending entropy on flows 2 5 equivalence of receiving and sending entropies 2 6 mathematical formulation of the optimization problem 2 7 invariance of optima to changing the material investment in the network 3 numerical optimization 3 1 part 1 of the optimization algorithm gradient based local search 3 2 part 2 of the optimization algorithm redistributing material 3 3 part 3 of the optimization algorithm changing flow directions 3 4 synthesis of parts initialization and termination 4 results from numerical optimization 4 1 optimal networks are paths for small values of 4 2 length of optimal networks increases with c 5 optimal path networks 5 1 the optimal network for mixing is a tour 5 2 dissipation in a network can be bounded given the flows on the network 5 3 strong nodes and path like networks 5 4 optimization of over paths 6 all optimal networks are paths for sufficiently small 7 discussion appendix a computation of derivatives of appendix b finding adjacent flow topologies references