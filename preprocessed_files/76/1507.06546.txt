a multilayer shallow model for dry granular flows with the i rheology application to granular collapse on erodible beds e d ferna ndez nieto j garres d az a mangeney g narbona reina abstract in this work we present a multilayer shallow model to approximate the navier stokes equations with hydrostatic pressure and the i rheology the main advantages of this approximation are i the low cost associated with the numerical treatment of the free surface of the modelled flows ii exact conservation of mass and iii the ability to compute 3 d profiles of the velocities in the directions along and normal to the slope the derivation of the model follows 14 and introduces a dimensional analysis based on the shallow flow hypothesis the proposed first order multilayer model fully satisfies a dissipative energy equation a comparison with an analytical solution with a non constant normal profile of the downslope velocity demonstrates the accuracy of the numerical model finally by comparing the numerical results with experimental data we show that the proposed multilayer model with the i rheology reproduces qualitatively the effect of the erodible bed on granular flow dynamics and deposits such as the increase of runout distance with increasing thickness of the erodible bed we show that the use of a constant friction coefficient in the multilayer model leads to the opposite behaviour this multilayer model captures the different normal profiles of the downslope velocity during the different phases of the flow acceleration stopping etc including the presence of static and flowing zones within the granular column contents 1 introduction 2 2 the 3 d initial system 4 2 1 closures 5 2 1 1 rheology 5 2 1 2 boundary and kinematic conditions 6 2 2 dimensional analysis 7 dpto matema tica aplicada i ets arquitectura universidad de sevilla avda reina mercedes s n 41012 sevilla spain edofer us es imus dpto matema tica aplicada i ets arquitectura universidad de sevilla avda reina mercedes s n 41012 sevilla spain jgarres us es institut de physique du globe de paris equipe sismologie university paris diderot sorbonne paris cite paris france mangeney ipgp fr ange team cerema inria lab j louis lions paris france dpto matema tica aplicada i ets arquitectura universidad de sevilla avda reina mercedes s n 41012 sevilla spain gnarbona us es 1 ar x iv 1 50 7 06 54 6 v 1 m at h ph 2 3 ju l 20 15 3 a multilayer approach 8 3 1 weak solution with discontinuities 10 3 2 stress tensor approximation 12 3 3 vertical velocity 13 4 weak solution of the first order model 14 4 1 pressure 14 4 2 a particular weak solution 14 4 3 final model 22 4 4 energy associated with the final model 24 5 numerical tests 27 5 1 analytical solution 28 5 2 comparison with laboratory experiments 29 5 2 1 deposit profiles 32 5 2 2 effect of the erodible bed 33 5 2 3 flow dynamics and velocity profiles 36 6 conclusion 38 1 introduction granular flows have been widely studied in recent years because of their importance in industrial processes and geophysical flows such as avalanches debris or rock avalanches landslides etc in particular numerical modelling of geophysical granular flows provides a unique tool for hazard assessment the behaviour of real geophysical flows is very complex due to topography effects heterogene ity of the material involved presence of fluid phases fragmentation etc 11 one of the major issues is to quantify erosion deposition processes that play a key role in geophysical flow dynamics but are very difficult to measure in the field laboratory experiments of granular flows are very useful to test flow models on simple configurations where detailed measurements can be performed even if some physical processes may differ between the large and small scale these experiments may help in defining appropriate rheological laws to describe the behaviour of granular materials recent experiments by mangeney et al 24 and farin et al 13 on granular column collapse have quantified how the dynamics and deposits of dry granular flows change in the presence of an erodi ble bed they showed a significant increase of the runout distance i e maximum distance reached by the deposit and flow duration with increasing thickness of the erodible bed this strong effect of bed entrainment was observed only for flows on slopes higher than a critical angle of about 16 for glass beads the question remains as to whether this behaviour can be reproduced by granular flow models understanding the rheological behaviour of granular material is a major challenge in par ticular a key issue is to describe the transition between flow fluid like and no flow solid like behaviour granular flows have been described by viscoplastic laws and especially by the so called i rheology introduced by jop et al 20 it specifies that the friction coefficient is variable and depends on the inertial number i that is related to the pressure and strain rate lagre e et al 21 implemented it in a full navier stokes solver gerris by defining a viscosity from the i rheology they validated the model with a 2 d analytical solution and compared it to 2 d discrete element simulations of granular collapses over horizontal rigid beds and with other rheologies staron et 2 al 32 and 33 applied this model to granular flows in a silo using an augmented lagrangian method combined with finite element discretisation to solve the 2 d full navier stokes equations ionescu et al 18 showed that this rheology reproduces quantitatively laboratory experiments of granular collapses over horizontal and inclined planes by interpreting the i rheology as a vis coplastic flow with a drucker prager yield stress criterion and a viscosity depending on the pressure and strain rate they showed that using a constant or variable viscosity only slightly changes the results when simulating granular column collapses of small aspect ratio in 10 chauchat and me dale implemented the i rheology in a three dimensional numerical model with a finite ele ment method combined with the newton raphson algorithm with a regularisation technique the numerical model was validated by an analytical solution for a dry granular vertical chute flow and a dry granular flow over an inclined plane and by laboratory experiments previously chauchat and me dale 9 simulated the bed load transport problem in 2 d and 3 d with a two phase model that considers a drucker prager rheology for the granular phase lusso et al 23 used a finite element method to simulate a 2 d viscoplastic flow considering a drucker prager yield stress criterion and a constant viscosity they obtained similar results taking into account either a regularisation method or the augmented lagrangian algorithm by comparing the simulated normal velocity profiles and the time change of the position of the static flowing interface with laboratory experiments of 13 they concluded that a pressure and rate dependent viscosity can be important to study flows over an erodible bed similar conclusion is presented in 22 after comparing the normal velocity profiles and the position of the static flowing interface during the stopping phase of granular flows over erodible beds calculated with a simplified thin layer but not depth averaged viscoplastic model with those measured in laboratory experiments because of the high computational cost of solving the full 3 d navier stokes equations in par ticular in a geophysical context granular flows have often been simulated using depth averaged shallow models the shallow or thin layer approximation the thickness of the flow is assumed to be small compared to its downslope extension associated with depth averaging leads to conservation laws like the saint venant equations these approximations have been applied to granular flows by savage and hutter 31 by assuming a coulomb friction law where the shear stress at the bottom is proportional to the normal stress with a constant friction coefficient however this model does not reproduce the increase in runout distance observed with increasing thickness of the erodible bed the analytical solution deduced in 12 proves that this system leads to the opposite effect the question is as to whether this opposite behaviour between the experiments and simulations is due to the thin layer approximation and or depth averaging process or to the rheological law implemented in the model i e constant friction coefficient gray and edwards 16 introduced the i rheology in a depth averaged model by adding a viscous term however in depth averaged models only the mean velocity over the whole thickness of the flow is calculated i e the whole granular column is either flowing or at rest granular collapse experiments and simulations have shown on the contrary that the velocity of the grains near the free surface is higher than that of the grains located near the bottom during the stopping phase and when erosion deposition processes occur static zones may develop near the bottom and propagate upwards the resulting normal gradient of the downslope velocity is a significant term in the strain rate and therefore strongly influences the i coefficient to take into account the change of the velocity field in the direction normal to the topography we present here a multilayer shallow model that we have developed with the i rheology this model consists of subdividing the domain into several layers in the normal direction and applying the thin layer approximation within each layer as a result a velocity is calculated for each layer providing a normal velocity profile multilayer models were introduced by audusse 1 and extended by audusse et al 4 a different multilayer model which takes into account the exchange of mass 3 and momentum between the layers has since been derived by audusse et al 3 5 and sainte marie 30 a new procedure to obtain a multilayer model has been introduced by ferna ndez nieto et al 14 several differences appear between this multilayer model and the ones deduced by audusse et al first in 14 the multilayer model is derived from the variational formulation of navier stokes equations with hydrostatic pressure by considering a discontinuous profile of the solution at the interfaces of a vertical partition of the domain this procedure proves that the solution of this multilayer model is a particular weak solution of the navier stokes system moreover the mass and momentum transfer terms at the interfaces of the normal partition are deduced from the jump conditions verified by the weak solutions of the navier stokes system in addition the definition of the vertical velocity profile is easily obtained using the mass jump condition combined with the incompressibility condition by comparing this model with granular flow experiments on erodible beds 24 13 we eval uate 1 if the model with the i rheology gives a reasonable approximation of the flow dynamics and deposits of real granular flows 2 if it reproduces the increase in runout distance observed for increasing thickness of the erodible bed above a critical slope angle c 12 o 16 o and 3 how the multilayer approach improves the results compared to the classical depth averaged saint venant model i e monolayer model the paper is organised as follows in section 2 we introduce the i rheology and the associated viscosity as well as a dimensional analysis of the 3 d navier stokes equations in section 3 we present the multilayer approach following 14 to derive a 3 d multilayer model for dry granular flows up to first order when considering the thin layer or shallow approximation the final i rheology multilayer shallow model msm is deduced in section 4 in section 5 we validate our model using the 2 d analytical solution presented in 21 and compare our results with those of laboratory experiments done by mangeney et al 24 we show that the i rheology can reproduce qualitatively the increase in runout distance of granular flows over erodible beds as opposed to the constant friction model and that the multilayer approach significantly improves results compared to the monolayer i e saint venant model 2 the 3 d initial system we consider the space variables x z r r 3 where x x 1 x 2 r 2 corresponds to the horizontal and z r to the vertical variable the velocity u r 3 with horizontal and vertical components uh w the density r that is assumed to be known and gravity g r we set x 1 x 2 z the usual differential operator in the space variables and x x 1 x 2 the reduced operator to the horizontal variable the 3 dimensional navier stokes equations are written as u 0 t u u u g 1 where g 0 g r 3 and pi t 2 4 is the stress tensor with p r the pressure i is the identity tensor and t the deviatoric tensor given by t d u t th txz txz tzz where r denotes the viscosity and d u is the strain rate tensor d u u u dh uh z uh xw z uh xw 2 zw 3 where dh uh x uh x uh with these definitions system 1 can be developed as x uh zw 0 t uh x uh uh z uhw xp x dh uh z z uh xw tw uh xw w zw zp g x z uh xw 2 z zw 4 in the following subsection the rheology and boundary conditions are presented in subsection 2 2 a dimensional analysis of the system is performed 2 1 closures 2 1 1 rheology we consider the so called i rheology see 20 which is defined by i p d u 5 where d d d 2 the usual second invariant of a tensor d the friction coefficient i depends on the inertial number i ds d u p s 6 where ds is the particle diameter and s the particle density the solid volume fraction denoted by s is assumed to be constant leading to an apparent flow density s s 7 the variable friction coefficient is written i s 2 s i 0 i i where i 0 is a constant value and 2 s are constant parameters note that when the shear rate is equal to zero i is reduced to s and for high values of i converges to 2 the i rheology includes a drucker prager plasticity criterion that is the material flows when t i p 5 note that the i rheology can equivalently be written as a decomposition of the deviatoric stress in a sum of a plastic term and a rate dependent viscous term see 18 t sp d d d if d 6 0 t sp if d 0 with a viscosity defined as 2 s p i 0 ds p s d here we investigate the rheology defined by a variable friction i and a constant friction s note that assuming s i e 0 is different than taking k with k a non zero constant as in 18 the model that considers a viscosity defined by 5 presents a discontinuity when d u 0 to avoid this singularity there are several ways to proceed one of them is to apply a duality method such as augmented lagrangian methods 15 or bermu dez moreno algorithm 7 another option is to use a regularisation of d u which is cheaper computationally however it does not give an exact solution contrary to duality methods in this work we take into consideration two kinds of regularisations of d u first we use the regularisation proposed in 21 which consist in bounding the viscosity by m 250 gh 3 pa s considering instead of 5 i p max d u i p m 8 in this way we obtain m if d u is close to zero we used this regularisation in the simulation of the granular flow experiments however as explained in section 5 1 we cannot consider this regularisation in the simulation of the analytical solution for which we take into account the regularisation introduced in 6 i p d u 2 2 where 0 is a small parameter 2 1 2 boundary and kinematic conditions at the free surface zb h we consider the usual kinematic condition th u nh 0 9 with nh x zb h 1 1 x zb h 2 the downward unit normal vector to the free surface we also assume a normal stress balance p ps 10 with ps the surface pressure at the bottom z zb we consider the no penetration condition u nb 0 11 6 where nb xzb 1 1 xzb 2 is the downward unit normal vector to the bottom we also consider a coulomb type fiction law involving the variable friction coefficient i nb nb nb nb i p uh uh 0 12 2 2 dimensional analysis in this subsection we carry out a dimensional analysis of the system 3 12 we consider a shallow domain by assuming that the ratio h l between the characteristic height h and the characteristic length l is small we define the dimensionless variables denoted with the tilde symbol as follows x z t lx hz l u t uh w u u h uw h hh 0 p 0 u 2 p ps 0 u 2 p s 0 lu m 0 lu m let us also denote d u dh u h 1 zu h xw 1 zu h xw 2 zw 13 and the froude number fr u gh then the system of equations 4 can be re written using this change of variables as tildes have been dropped for simplicity x uh zw 0 t uh x uh uh z uhw xp x dh uh z 1 2 z uh xw 2 tw uh xw w zw zp 1 fr 2 x z uh 2 xw 2 z zw 14 we also write the boundary and kinematic conditions using dimensionless variables at the free surface t zb h uh z zb h x zb h w z zb h 0 p ps at the bottom uh xzb w z uh i p uh uh o 2 15 7 in addition we assume an asymptotic regime in the rheology for the friction coefficient i namely i 0 i consequently 0 i p max d u i p m 0 16 3 a multilayer approach zb x z x h x t h 1 x t h x t z z 1 2 z z 1 2 z z 1 2 z zn 1 2 hn x t figure 1 sketch of the multilayer division of the fluid domain we apply the multilayer approach proposed in 14 using the same notation we denote the fluid domain f t and its projection if t on the horizontal plane for a positive t 0 t i e if t x r 2 x z f t this approach considers a vertical partition of the domain in n n layers with preset thick nesses h t x see figure 1 note that n 1 h h these layers are separated by n 1 inter faces 1 2 t which are described by the equations z z 1 2 t x for 0 1 n x if t where zb z 1 2 and zs zn 1 2 are the bottom b and free surface s respectively we assume that these interfaces are smooth enough note that z 1 2 zb 1 h for 1 n and h z 1 2 z 1 2 denoting t the subdomain between 1 2 and 1 2 and t the lateral vertical bound 8 ary for a positive t 0 t we obtain t x z x if t and z 1 2 z z 1 2 t 1 2 t 1 2 t t with t x z x if t and z 1 2 z z 1 2 remark 1 we need to introduce a specific notation 1 for two tensors a and b of sizes n m and n p we denote by a b the concatenation of a and b which is a tensor of size n m p 2 for a function f and for 0 1 n we set f 1 2 f t 1 2 t and f 1 2 f 1 t 1 2 t note that if the function f is continuous f 1 2 f 1 2 t f 1 2 f 1 2 3 for a given time t we denote nt 1 2 tz 1 2 xz 1 2 1 1 xz 1 2 2 tz 1 2 2 and n 1 2 xz 1 2 1 1 xz 1 2 2 the space time unit normal vector and the space unit normal vector to the interface 1 2 t outward to the layer t for 0 n for convenience we write the set of equations 14 in matricial notation before applying the multilayer approach first we focus on the equations of momentum we multiply the horizontal momentum equation by which gives t uh x uh uh z uhw xp x dh uh z 1 z uh xw 2 tw uh xw w zw zp 1 fr 2 x z uh 2 xw 2 z zw note that the terms involving the stress tensor without divergence operator are dh uh 1 z uh xw z uh 2 xw 2 zw d u i 2 0 0 1 where d u is defined by 13 and i 2 is the two dimensional identity matrix we introduce the notation u uh w f 0 1 fr 2 with 1 fr 2 gh u 2 e i 2 0 0 1 9 with this notation we can write the momentum equation as follows t u u u pe f d u e and we obtain the set of equations 14 in matricial notation u 0 t u u u 1 e 1 f 17 where now pi d u in subsections 3 1 and 3 2 we define the weak solutions for our system and the process to cal culate the vertical velocities is presented in subsection 3 3 3 1 weak solution with discontinuities following 14 we look for a weak solution u p of 4 we assume that the velocity u the pressure p and the density are smooth in each t but may be discontinuous across the interfaces 1 2 for 1 n 1 then the following conditions must hold i u p is a standard weak solution of 17 in each layer t ii u p satisfies the normal flux jump conditions at 1 2 t for 0 n for the mass and momentum laws mass conservation law u 1 2 t nt 1 2 0 18 momentum conservation law u u u 1 e 1 2 t nt 1 2 0 19 where a b 1 2 t denotes the jump of the pair a b across 1 2 t a b 1 2 t a b 1 t a b t 1 2 t we consider a particular family of velocity functions by assuming that the thickness of each layer is small enough to make the horizontal velocities independent of the vertical variable z from this and the incompressibility condition in each layer we obtain that vertical velocities are linear in z and may be discontinuous that is u t u uh w 10 where uh and w are the horizontal and vertical velocities respectively on layer and the particular family satisfies z uh 0 zw d t x 20 for some smooth function d t x note that u h 1 2 t x u h 1 2 t x uh t x let us denote g 1 2 tz 1 2 uh 1 xz 1 2 w 1 2 g 1 2 tz 1 2 uh xz 1 2 w 1 2 21 then u satisfies the jump conditions for the mass conservation law 18 if both coincide in this case we set g 1 2 g 1 2 g 1 2 22 note that g 1 2 is the normal mass flux at the interface 1 2 t moreover using 22 the momentum conservation jump conditions 19 can be written in terms of the normal mass flux as 1 e 1 2 t xz 1 2 1 u u u 1 2 t tz 1 2 xz 1 2 1 23 also by 22 u u u 1 2 t uh uh uh uhw w uhw w 2 1 2 t i 2 0 0 uh uh uh uhw w uhw w 2 1 2 t b u u u 1 2 t with b e 1 using 22 we deduce u u u 1 2 t tz 1 2 xz 1 2 1 g 1 2 u 1 2 t therefore u u u 1 2 t tz 1 2 xz 1 2 1 b u u u 1 2 t tz 1 2 xz 1 2 1 g 1 2 b u 1 2 t 11 finally we obtain from the previous equality and from 23 the momentum jump condition 1 e 1 2 t n 1 2 g 1 2 1 xz 1 2 2 b u 12 t 24 3 2 stress tensor approximation for 1 n 1 the total stress is written 1 2 p 1 2 i t 1 2 where p 1 2 p 1 2 p 1 2 is the pressure and t 1 2 are approximations of d u at 1 2 by the momentum jump condition 19 rewritten as 24 t 1 2 must satisfy 1 1 2 1 2 e n 1 2 1 t 1 2 t 1 2 e n 1 2 g 1 2 1 xz 1 2 2 b u 12 t 25 moreover by consistency we consider the following condition 1 2 t 1 2 t 1 2 t 1 2 26 where t 1 2 d 1 2 26 is an approximation of d u 1 2 concretely we set d 1 2 dh u h 12 u h 12 2 d 1 2 xz d 1 2 xz 2 qv 1 2 26 where d 1 2 xz x w 12 w 12 2 1 qh 1 2 and qh 1 2 qv 1 2 is defined as follows we approximate the second order derivatives in z using a mixed formulation because of the possible vertical discontinuous profile we set an additional auxiliary unknown q that satisfies q z u 0 with q qh qv 12 and to approximate q we approximate u by u a p 1 z interpolation such that u z 1 2 z 1 2 z 1 2 u then q 1 2 qh 1 2 qv 1 2 is an approximation of q u at 1 2 finally we multiply equation 25 by 2 and multiply scalarly 26 by vector e n 1 2 then we get a linear system whose unknowns are t 1 2 e n 1 2 as a result we obtain t 1 2 e n 1 2 t 1 2 e n 1 2 1 2 g 1 2 1 xz 1 2 2 b u 12 t 27 where t 1 2 is defined by 26 26 3 3 vertical velocity let us recall the velocity structure requirements set in equations 20 this makes the vertical velocity linear in z in each layer concretely if u is a solution of system 17 in t the vertical velocity can be recovered by integrating the continuity equation between z 1 2 and z z 1 2 z 1 2 w t x z w 1 2 t x z z 1 2 x uh t x for 1 n moreover from conditions 22 at the interfaces we obtain the relation w 1 2 uh 1 uh xz 1 2 w 1 2 28 we therefore use the horizontal velocities deduced from the model to compute the vertical veloci ties in the layers following the algorithm from the mass transfer g 1 2 which is given as data we obtain w 1 2 using condition 22 at the bottom w 1 2 uh 1 xzb tzb g 1 2 then for 1 n and z z 1 2 z 1 2 we set w t x z w 1 2 t x z z 1 2 x uh t x w 1 2 uh 1 uh xz 1 2 w 1 2 29 where w 1 2 w 1 2 t w 1 2 h x uh 13 in this way the velocity vector u is the piecewise smooth function such that u t x z t u t x z for 1 n where u t x z uh t x w 1 2 t x z z 1 2 x uh t x 30 and w 1 2 t x is computed using 29 4 weak solution of the first order model in this section we derive the model of order 4 1 pressure using the vertical momentum equation in 14 we can deduce an expression for the pressure we write this equation up to order 2 for each layer zp 1 fr 2 x z uh z 2 zw taking into account the requirements z uh 0 see 20 and 0 see 16 we get zp 1 fr 2 z 2 0 zw then we obtain the hydrostatic pressure framework up to order in each layer zp 1 fr 2 now by the continuity of the dynamic pressure see 14 we can deduce that p z ps fr 2 zb h z 31 where ps is the pressure at the free surface 4 2 a particular weak solution noting that u is a weak solution of the system 17 in t let us consider the weak formulation of 17 in t for 1 n assuming u l 2 0 t h 1 t 3 t u l 2 0 t l 2 t 3 and p l 2 0 t l 2 t then a weak solution in t should satisfy 0 t u d 1 t f v d t t u v d t u u v d 1 t p e v d 1 t t e v d 32 14 for all l 2 t and for all v h 1 t 3 we consider unknowns velocities and pressures that satisfy 20 and the system 32 for test functions such that z 0 and v t x z vh t x z zb v t x v if t 0 33 where vh and v t x are smooth functions that do not depend on z we will now develop 32 in order to obtain the mass and momentum conservation equations that satisfy the weak solution for this family of test functions for each layer mass conservation let t x a scalar test function and u a weak solution of 32 from the mass conservation equation we get 0 t u d if t t x z 1 2 z 1 2 x uh zw dz dx if t t x z 1 2 z 1 2 x uh dz w 1 2 w 1 2 dx for all 1 n using leibnitz s rule z 1 2 z 1 2 x uh dz x z 12 z 1 2 uh dz u h 1 2 xz 1 2 u h 1 2 xz 1 2 and this leads to if t t x x h uh uh xz 1 2 w 1 2 uh xz 1 2 w 1 2 dx 0 taking into account 22 and th tz 1 2 tz 1 2 we obtain the equation if t t x th x h uh g 1 2 g 1 2 dx 0 for all t l 2 if t thus we get the mass conservation law for each layer th x h uh g 1 2 g 1 2 1 n 34 where gn 1 2 and g 1 2 stand for the mass exchange with the free surface and the bottom respec tively and both should be given data 15 momentum conservation first we develop the variational formulation of momentum equation taking into account that t p e v d t p e vd 1 2 t p 1 2 e v n 1 2 d 1 2 t p 1 2 e v n 1 2 d t t e v d t t e v d 1 2 t t 1 2 e v n 1 2 d 1 2 t t 1 2 e v n 1 2 d now we can write the momentum equation as 1 t f v d t t u v d t u u v d 1 t p e v d 1 t t e v d 1 1 2 t p 1 2 e t 1 2 e n 1 2 v d 1 1 2 t p 1 2 e t 1 2 e n 1 2 v d 35 let v h 1 be a test function satisfying 33 we develop the momentum equation in 35 by integrating with respect to the variable z and by identifying the horizontal and vertical component of the vector test function v in addition taking into account the hydrostatic pres sure framework we can leave out the equation corresponding to the vertical component this is equivalent to considering the vector test function where the vertical component vanishes i e v vh t x 0 therefore the horizontal momentum equation reads for a weak solution u and 16 for all 1 n 1 t f vh 0 d t t uh w vh 0 d t uh w uh w vh 0 d 1 t p e vh 0 d 1 t t e vh 0 d 1 1 2 t p 1 2 e t 1 2 e n 1 2 vh 0 d 1 1 2 t p 1 2 e t 1 2 e n 1 2 vh 0 d 36 we develop each term of this equation taking into account that z uh z vh v if t 0 t t uh vh d if t z 1 2 z 1 2 t uh vh dzdx if t h t uh vh dx t uh x uh vh d if t h uh x uh vhdx t p x vh d if t z 1 2 z 1 2 p dz x vh dx if t x z 1 2 z 1 2 p dz vhdx if t z 1 2 z 1 2 p dz vh nd if t z 1 2 z 1 2 xp dz p dz dx z 1 2 z 1 2 vhdx moreover z 1 2 z 1 2 xp dz z 1 2 z 1 2 x ps fr 2 zb h z dz z 1 2 z 1 2 xps fr 2 x zb h dz h xps fr 2 h x zb h 17 then we continue the computation of 3 we obtain if t h xps fr 2 h x zb h p 1 2 xz 1 2 p 1 2 xz 1 2 vhdx if t h xps fr 2 h x zb h vhdx if t p 1 2 n 1 2 vh 0 1 xz 1 2 2 dx if t p 1 2 n 1 2 vh 0 1 xz 1 2 2 dx t th x vh d if t z 1 2 z 1 2 th x vh dz dx if t z 1 2 z 1 2 th dz x vhdx if t x z 1 2 z 1 2 th dz vhdx if t z 1 2 z 1 2 th dz vh nd if t x z 1 2 z 1 2 th dz vhdx because z uh 0 we obtain that d u is independent of z up to order since d u dh uh 0 0 2 zw then from 16 we get z 1 2 z 1 2 th dz z 1 2 z 1 2 0 dh uh dz o therefore we can neglect the term x z 12 z 1 2 th dz which corresponds to the horizontal diffusion since we are interested in the first order model 1 2 t p 1 2 e t 1 2 e n 1 2 vh 0 d if t p 1 2 e t 1 2 e n 1 2 vh 0 1 xz 1 2 2 dx 18 introducing these calculations in 36 and taking into account that f 0 1 fr 2 we obtain if t h t uh h uh x uh h xps fr 2 h x zb h vh dx if t p 1 2 n 1 2 vh 0 1 xz 1 2 2 p 1 2 n 1 2 vh 0 1 xz 1 2 2 dx 1 if t p 1 2 e t 1 2 e n 1 2 vh 0 1 xz 1 2 2 p 1 2 e t 1 2 e n 1 2 vh 0 1 xz 1 2 2 dx 0 note that 1 p 1 2 e n 1 2 vh 0 p 1 2 n 1 2 vh 0 then if t h t uh h uh x uh h xps fr 2 h x zb h vh dx if t 1 t 1 2 e n 1 2 vh 0 1 xz 1 2 2 1 t 1 2 e n 1 2 vh 0 1 xz 1 2 2 dx 0 moreover t 1 2 e n 1 2 vh 0 1 xz 1 2 2 t h 12 t xz 12 t xz 1 2 t zz 1 2 xz 12 1 vh 0 t h 1 2 xz 1 2 t xz 1 2 vh therefore if t h t uh h uh x uh h xps fr 2 h x zb h t h 1 2 xz 1 2 1 t xz 1 2 t h 1 2 xz 1 2 1 t xz 1 2 vhdx 0 and this yields for each layer 1 n the momentum equation 19 h t uh h uh x uh h xps fr 2 h x zb h t h 1 2 xz 1 2 1 t xz 1 2 t h 1 2 xz 1 2 1 t xz 1 2 0 remark 2 observe that t h 1 2 xz 1 2 1 t xz 1 2 1 t 1 2 e n 1 2 1 xz 1 2 2 h where h denotes the first component now by 27 we obtain 1 t 1 2 e n 1 2 1 xz 1 2 2 h 1 t 1 2 e n 1 2 1 xz 1 2 2 1 2 g 1 2 b u 1 2 t h t h 1 2 xz 1 2 1 t xz 1 2 1 2 g 1 2 uh 1 uh and analogously 1 t 1 2 e n 1 2 1 xz 1 2 2 h t h 1 2 xz 1 2 1 t xz 1 2 1 2 g 1 2 uh uh 1 remark 2 allows us to re write the momentum equation h t uh h uh x uh h xps fr 2 h x zb h t h 1 2 xz 1 2 1 t xz 1 2 t h 1 2 xz 1 2 1 t xz 1 2 1 2 g 1 2 uh 1 uh 1 2 g 1 2 uh uh 1 by combining the previous equation with 34 we get t h uh x h uh uh h xps fr 2 h x zb h t h 1 2 xz 1 2 1 t xz 1 2 t h 1 2 xz 1 2 1 t xz 1 2 1 2 g 1 2 uh 1 uh 1 2 g 1 2 uh uh 1 20 note that t h 1 2 xz 1 2 1 t xz 1 2 1 t 1 2 e n 1 2 1 xz 1 2 2 h 0 d 1 2 e n 1 2 h 1 xz 1 2 2 0 1 2 dh u h 12 u h 12 2 xz 1 2 0 1 2 x w 1 2 w 1 2 2 1 0 1 2 qh 1 2 1 0 1 2 qh 1 2 o we define k 1 2 1 0 1 2 qh 1 2 37 where 0 1 2 is a first order approximation of at z z 1 2 we obtain 0 1 2 i 1 2 p 1 2 max qh 1 2 i 1 2 p 1 2 m 38 with p 1 2 ps fr 2 n 1 h i 1 2 ds qh 1 2 p 1 2 s 39 these expressions of 1 2 and i 1 2 are obtained from definitions 8 and 6 respectively by considering the hydrostatic pressure approximation 31 with the definition of 7 and with the following first order approximation of d u at z z 1 2 d u z z 1 2 qh 1 2 40 by re writing the momentum equation again we obtain up to order t h uh x h uh uh h xps fr 2 h x zb h k 1 2 k 1 2 1 2 g 1 2 uh 1 uh 1 2 g 1 2 uh uh 1 41 the horizontal momentum conservation laws for 1 n 21 remark 3 we must impose friction at the bottom 1 2 with 1 we can translate 15 into the notation of the multilayer approach giving w 1 2 0 1 1 2 qh 1 2 i p 1 2 u h 1 2 u h 1 2 therefore to impose the friction condition we should change definition 37 of k 1 2 taking into account that u h 1 2 uh 1 then we obtain k 1 2 1 01 2 qh 1 2 i 0 p 1 2 uh 1 uh 1 42 4 3 final model we have obtained the dimensionless final system given by 21 22 34 and 37 42 the last step is to return to the original variables taking into account subsection 2 2 we obtain the final multilayer system for 1 n th x h uh g 1 2 g 1 2 t h uh x h uh uh h xps gh x zb h k 1 2 k 1 2 1 2 g 1 2 uh 1 uh 1 2 g 1 2 uh uh 1 43 where g 1 2 tz 1 2 uh 1 xz 1 2 w 1 2 tz 1 2 uh xz 1 2 w 1 2 k 1 2 1 2 qh 1 2 1 2 d 1 2 n 1 2 h 1 xz 1 2 2 and k 1 2 i gh uh 1 uh 1 44 system 43 must be closed by setting the vertical partition of the domain for this we can write the thickness of the pre set layer based on the total height that is we set h l h where 22 l is a positive constant for 1 n and n 1 l 1 note that g 1 2 can be written by summing the mass equations from 1 to as g 1 2 g 1 2 1 th x h uh 45 moreover for the special case n and assuming no mass transfer with the atmosphere i e gn 1 2 0 the above equation leads to th x h n 1 l uh g 1 2 by introducing this in 45 we obtain g 1 2 g 1 2 1 l x h uh n 1 x l h uh g 1 2 46 let us define l l 1 l and 1 l l where is the standard kronecker symbol that is 1 l 1 l l if l 1 l l otherwise for 1 n then we can write the mass transfer 46 in the interface 1 2 as g 1 2 1 l g 1 2 n 1 x h uh 47 for 1 n next considering qh h uh and after some straightforward calculations the final system 23 43 44 is re written for 1 n as th x n 1 l qh g 1 2 t qh x qh qh h x g h 2 2 psh ps xh n 1 1 2 hl qh qh 1 1 qh 1 qh x qh 1 2 hl qh 1 qh 1 l qh qh 1 1 l 1 g 1 2 gh xzb 1 l k 1 2 k 1 2 4 4 energy associated with the final model in this section we study the energy balance of the obtained system 43 44 theorem 1 denoting the energy of the layer 1 n for the system 43 44 by e h uh 2 2 ps g zb h 2 the following dissipative energy inequality is satisfied t n 1 e x n 1 uh e gh h 2 h t ps gzb gh uh 1 i uh n 2 hn n 1 2 n 1 1 uh 1 u 2 h 1 2 1 2 g 1 2 ps g zb h proof firstly we multiply the momentum equation for each layer by uh and use the mass equation to simplify the convective terms secondly we sum up the obtained equation for layers 1 to n and then we obtain that the global system has a dissipative energy balance now we write the momentum conservation equation in terms of the velocity using the continuity equation h t uh x uh h uh h xps gh x zb h k 1 2 k 1 2 1 2 g 1 2 uh 1 uh 1 2 g 1 2 uh uh 1 48 multiplying 48 by uh we obtain 24 h uh t uh x uh h uh uh h uh x ps g zb h uh k 1 2 k 1 2 1 2 g 1 2 uh 1 uh uh 2 1 2 g 1 2 uh 2 uh uh 1 this gives x uh h uh uh x uh 2 2 h uh x uh 2 2 h uh uh 2 2 x h uh which can be re written as h uh t uh x uh 2 2 h uh uh 2 2 x h uh h uh x ps g zb h uh k 1 2 k 1 2 1 2 g 1 2 uh 1 uh uh 2 1 2 g 1 2 uh 2 uh uh 1 49 let us consider the mass conservation equation multiplied by uh 2 2 ps g zb h uh 2 2 th uh 2 2 x h uh ps g zb h th ps g zb h x h uh uh 2 2 g 1 2 g 1 2 ps g zb h g 1 2 g 1 2 50 summing 49 and 50 we obtain the equation t uh 2 2 h x uh 2 2 h uh ps g zb h th x h ps g zb h uh uh k 1 2 k 1 2 g 1 2 uh 1 uh 2 ps g zb h g 1 2 uh uh 1 2 ps g zb h we can reformulate this as 25 t h uh 2 2 ps g zb h h tps gh tzb gh th x h uh 2 2 ps g zb h uh u k 1 2 k 1 2 g 1 2 uh 1 uh 2 ps g zb h g 1 2 uh uh 1 2 ps g zb h note that gh th gh t h 2 gh t h 2 g t h h 2 gh t h 2 gh t h 2 then t h uh 2 2 ps g zb h 2 g 2 h th h th h tps gh tzb x h uh 2 2 ps g zb h 2 uh gh h 2 uh u k 1 2 k 1 2 g 1 2 uh 1 uh 2 ps g zb h g 1 2 uh uh 1 2 ps g zb h denoting e h uh 2 2 ps g zb h 2 we have for 1 n the following energy equality te 1 g 2 h th h th 2 x e gh h 2 uh 3 u k 1 2 k 1 2 4 h t ps gzb g 1 2 uh 1 uh 2 ps g zb h g 1 2 uh uh 1 2 ps g zb h 5 51 now we sum up 51 from 1 to n we take into account that n 1 h h gn 1 2 0 there is no transfer with the atmosphere and uh 0 uh n 1 0 velocity of the bottom and atmosphere respectively this gives term by term 26 1 t n 1 e 2 h t n 1 h n 1 h th h th h th 0 3 x n 1 uh e gh h 2 4 taking into account k 1 2 1 2 qh 1 2 and k 1 2 gh uh 1 uh 1 i when we sum all the layers we obtain gh uh 1 i uh n n 1 2 qh n 1 2 n 1 1 uh 1 u 1 2 qh 1 2 where qh 1 2 is an approximation of z uh in 1 2 we consider qh 1 2 uh 1 uh h 1 2 qh n 1 2 uh n 1 uh n hn with h 1 2 being the distance between the midpoints of layers and 1 this gives gh uh 1 i uh n 2 hn n 1 2 n 1 1 uh 1 u 2 h 1 2 1 2 which is a dissipative term 5 considering gn 1 2 0 we have g 1 2 ps g zb h finally by summarising 1 5 the proof is completed 5 numerical tests the numerical approximation is performed in 2 d downslope and normal directions we re write the model as a nonconservative hyperbolic system with source terms as in 14 then a splitting procedure is considered first we set aside the term that appears in the internal interfaces and a standard path conservative finite volume method is applied these path conservative methods were introduced in 26 to deal with the coulomb friction term we use the hydrostatic reconstruction introduced in 2 which is applied in 8 to solve the saint venant system with coulomb friction the main advantage of this reconstruction is its great stability the second step is to solve the contribution of the term in the internal interfaces which rep resents the mass and momentum exchange between layers in this step a semi implicit scheme is 27 employed taking into account the regularisation of d u mentioned in section 2 1 1 in order to avoid the singularity when d u vanishes in order to validate the multilayer shallow model denoted msm hereafter with the i rheology we compare it to 1 a 2 d analytical solution for steady uniform flows over an inclined bed and 2 laboratory experiments of granular collapses over an inclined plane covered by an erodible bed made of the same material 5 1 analytical solution let us first compare the model to the 2 d analytical solution deduced in 21 for a uniform flow over an inclined plane of slope and thickness h 0 this solution is obtained by imposing zero pressure and zero shear stress at the free surface and a no slip condition at the bottom h z x u z g figure 2 sketch of the analytical solution by denoting u and v the downslope and normal velocities p the pressure and the shear stress and by taking the rheological parameters defined in section 2 1 1 the analytical solution reads u z 2 3 d i 0 tan s tan s sgcos h 3 2 h z 3 2 u z 0 0 v 0 p z gcos h z z i p gsin h z p z h 0 z h 0 i tan for z 0 h 52 for the numerical simulation as in the analytical solution we consider a uniform flow with constant thickness h 1 m and velocity u v 0 m s 1 at the initial time t 0 s the boundary condition at the free surface and at the bottom have been set as in 52 at the right and left boundary we use open boundary conditions 28 note that at the free surface we have p 0 and d u zu i 0 d tan s tan s sgcos h z 0 as a result we cannot use the regularisation 8 since its denominator max d u i p m vanishes at the free surface in this case we use the regularisation i p d u 2 2 where 0 is a small parameter see 6 we choose the rheological parameters i 0 0 279 and s 0 363 tan 19 95 2 0 74 tan 31 8 and the particle diameter ds 4 cm with solid volume fraction s 0 62 the slope angle is taken as 0 43 rad 24 64 figure 3 shows the good agreement between the simulated and exact solutions for the profiles of the velocity pressure shear stress i and d u it also shows the downslope velocity at the free surface as a function of the slope angle these results are computed using 50 layers in the msm figure 4 shows the computing time required to simulate 50 seconds and the relative error between the computed velocity and the exact solution using a different number of layers the error is computed by u u mi 0 uex i usim i 2 m i 0 u 2 ex i 53 where uex respectively usim is the analytical respectively computed velocity and m is the number of partitions of the mesh in the horizontal direction in this case m 20 note that for slopes smaller than arctan s the surface velocity is zero because the mass does not flow the error decreases as the number of layers increases and is less than 10 for 20 layers the main error occurs near the free surface where the gradient of the horizontal velocity is large 5 2 comparison with laboratory experiments we will now use the multilayer shallow model to simulate the laboratory experiments performed in 24 the objectives are threefold 1 to evaluate if the model with the i rheology gives a reasonable approximation of the flow dynamics and deposits of real granular flows 2 to observe if it reproduces the increase in runout distance observed for increasing thickness of the erodible bed above a critical slope angle c 12 o 16 o and 3 to show how the multilayer approach improves the results compared to the classical depth averaged saint venant model i e monolayer model the variable rf denotes the runout distance i e the length of the deposit measured from the position of the front of the released material at the initial time located at x 0 tf denotes the flow time from t 0 s to the time when the material stops and hf denotes the maximum final thickness of the deposit see figure 5 29 0 2 4 6 8 10 0 0 2 0 4 0 6 0 8 1 u ms 1 p pa d u s 1 z m u analytical u msm p analytical p msm d u analytical d u msm a 0 1 2 3 4 5 0 0 2 0 4 0 6 0 8 1 pa i z m analytical p msm i analytical i msm b 20 8 21 77 22 92 24 06 25 21 26 36 0 2 4 6 8 10 12 degree u z h m s 1 analytical msm c figure 3 comparison between the analytical solution dashed and solid lines and the simulations obtained using the msm with the i rheology symbols a analytical and simulated downslope horizontal velocity u pressure p and strain rate d u b analytical and simulated shear stress and friction coefficient i c comparison between the simulated symbols and the exact dashed line horizontal velocity at the free surface as a function of the slope angle in the laboratory experiments performed in 24 subspherical glass beads of diameter ds 0 7 mm were used they were cohesionless and highly rigid the particle density s 2500 kgm 3 and volume fraction s 0 62 were estimated leading to an apparent flow density s s 1550 kgm 3 in order to use the i rheology the rheological parameters s 2 and i 0 are taken as in 18 according to the measurements made in the experiments of 24 and 29 where the effect of lateral wall friction is taken into account empirically these parameters can be obtained by fitting the curve hstop where hstop is the thickness of the deposit lying on the slope when the supply is stopped after steady uniform flow see 28 for more details as a result we take here i 0 0 279 as in 20 s tan 25 5 0 48 and s 0 74 tan 36 5 this experiment has been simulated for different slopes and thicknesses hi of the erodible bed 16 and hi 1 4 2 5 5 mm 19 and hi 1 5 2 7 5 3 mm 22 and hi 1 82 3 38 4 6 mm 23 7 and hi 1 5 2 5 5 mm note that the model does not take 30 0 20 40 60 80 100 0 5 10 15 20 25 30 35 40 t s n layers a 0 20 40 60 80 100 0 0 05 0 1 0 15 0 2 0 25 0 3 n layers u u b figure 4 a computing time as a function of the number of layers in the msm and b relative error between the computed and exact velocity for simulations over a slope of 24 63 h 0 r 0 rf x hf hi z x 0 figure 5 sketch of the initial and final state of the granular collapse a granular column with a thickness h 0 14 cm and a length r 0 20 cm is released on an inclined plane of slope the plane is covered by an erodible bed of thickness hi made of the same material when the flow stops the maximum final thickness is hf and its final extent rf into account the effect of removing the gate during the initial instants even though it has a non negligible impact on the flow dynamics as shown in 18 for instance when the gate is taken into account even with no friction along it the flow is substantially slowed down however the deposit is almost unchanged all the simulations are performed using 20 layers we compare hereafter i the constant and variable friction rheologies and ii the monolayer and multilayer approaches 31 5 2 1 deposit profiles let us compare the deposits simulated with the i rheology and with a constant friction coef ficient s for different slopes and erodible bed thicknesses hi figure 6 shows that the deposit calculated with the variable friction coefficient i is closer to the experimental deposit than the one calculated with a constant friction coefficient s the runout distance with the constant co efficient s is always too long except at 19 o and hi 5 3 mm see figure 6 d to properly reproduce the runout distance with a constant friction coefficient we need to increase its value for example with a slope 16 and an erodible bed thickness hi 2 5 mm figure 6 a we need to use the value s tan 27 3 to produce the runout observed in the laboratory experiments 20 0 20 40 60 80 100 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 120 0 2 4 6 8 distance cm h c m 0 50 100 150 200 0 2 4 6 8 distance cm h c m 0 50 100 150 200 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 120 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 120 0 2 4 6 8 distance cm h c m i msm s msm laboratory 16 h i 2 5 mm 19 h i 2 7 mm 22 h i 1 82 mm 22 h i 4 6 mm 19 h i 5 3 mm 19 h i 1 5 mm a b c d e f figure 6 deposit obtained in the experiments solid circle blue line and with the multilayer shallow model using a constant friction coefficient s dotted circle red line and a variable friction coefficient i solid cross green line for different slopes and erodible bed thicknesses hi figure 7 shows for a slope 22 and hi 1 82 mm the final deposit obtained using the constant or variable friction coefficients for both the multilayer and monolayer models the difference between the multilayer and monolayer models is stronger when using the i rheology for instance the monolayer approach changes the full deposit profiles for the i rheology while it only changes the front position for s the multilayer approach makes it possible to obtain a deposit shape which is very close to the experiments with the i rheology more generally the shape of the deposit is closer to the observations with i than with s in the multilayer shallow model 32 0 50 100 150 200 0 1 2 3 4 5 6 7 8 distance cm h c m i msm i monolayer s msm s monolayer savage hutter laboratory data i ii figure 7 deposit obtained in the experiments solid circle blue line with the multilayer shallow model using a constant friction coefficient s dotted circle red line and a variable friction coefficient i solid cross green line and with the monolayer model with s dashed red line and i solid green line for a slope 22 and an erodible bed thickness hi 1 82 mm 5 2 2 effect of the erodible bed figure 8 shows two zooms one near the front i and one near the maximum thickness of the deposit ii for 22 and different values of hi see figure 7 for the approximate location of these zooms with the variable coefficient i the runout distance rf increases as the thickness of the erodible bed hi increases see figure 8 b ii as observed in laboratory experiments on the other hand with a constant friction coefficient s figure 8 a ii the runout distance rf decreases with increasing hi note that in both cases the maximum final thickness hf decreases with increasing hi as in the experiments figure 8 a i b i figure 9 shows that the decrease in runout distance with increasing hi for constant friction s is observed for all slopes e g 0 10 16 19 22 23 7 for the s model the multi and monolayer models follow the same trend note that this nonphysical decrease in runout distance with increasing hi has been demonstrated analytically in 12 for the monolayer model moreover laboratory experiments show that when the thickness of the erodible bed increases for slopes c where c 12 16 is a critical slope the runout distance rf and the stopping time tf both increase while the maximum final thickness hf decreases note that there is no trend concerning the runout when the thickness hi is increased for slopes c 0 10 in the laboratory experiments figure 10 shows that the increase of runout distance observed in the experiments for increasing hi is qualitatively well reproduced with the i multilayer shallow model with the i multi layer shallow model the runout increase with hi is actually larger for higher slopes as observed experimentally at 16 the runout distance is almost unaffected by the thickness of the erodi ble bed while it increases by 26 9 at 22 when the thickness of the erodible bed increase from 1 82 mm to 4 6 mm note that in the i msm the increase of the runout distance appears on slopes 16 higher than c in the experiments actually it appears starting with the slope 18 when using the i monolayer model the runout distance is higher than for the multi layer shallow model whatever the slope and thickness of the erodible bed based on the values of the runout distance in these cases it is hard to discriminate which of the monolayer or multilayer models is closer to the experiments however in the i monolayer model the runout distance 33 160 180 200 220 240 0 0 5 1 1 5 distance cm h c m 100 105 110 115 120 125 0 0 5 1 1 5 distance cm h c m 20 15 h c m distance cm 20 18 16 distance cm h c m h i 1 mm h i 1 82 mm h i 3 38 mm h i 4 6 mm h i 5 mm ii ii a s b i i i figure 8 influence of the thickness of the erodible bed on the runout distance rf and on the maximum final thickness hf smaller graphs with the multilayer shallow model using a constant friction coefficient s left hand side and with a variable friction coefficient i right hand side for a slope 22 at 16 19 decreases when hi increases contrary to the experimental data for 22 and 23 7 the monolayer and multilayer i models reproduce qualitatively the increase in runout with hi note that for 0 10 c the i models predict a very slight decrease in the runout distance as a result the multilayer shallow model with the i rheology provides the results that are the closest to observations even though the effect of erosion is still much smaller than in the experiments the runout distance increases by 4 4 for a slope 22 and from 1 82 mm to 4 6 mm of thickness of the erodible bed while it increases by 26 9 in the experiments in figure 11 the final time time at which the front stops is plotted as a function of the thickness of the erodible bed for 16 o 19 o and 22 o moreover for 22 o we also plot the experimental data experimental data show that the final time increases when the thickness of the erodible bed increases in figure 11 a we can see that this is true for all the values of for the multilayer method however in figure 11 b for the monolayer model we observe that it is only true for the highest value 22 o at the same time the final time decreases when the erodible bed increases for 16 o and 19 o the advantage of the multilayer models is that we obtain a variable profile of the downslope velocity in contrast with the constant profile of the monolayer model it makes it possible to ob tain a better approximation of d u see equation 40 as a consequence this improves the approximation of the inertial number i see equations 6 and 39 which is a key number in the variable friction coefficient with i as the main advantage of the multilayer model is the improvement of the approximation of d u we present two approximations that can be made with the multilayer model first let us recall that a first order approximation corresponds to the definition 40 this approximation considers only the leading order term i e d u z z 1 2 z uh z z 1 2 qh 1 2 note that 34 0 1 2 3 4 2 2 5 3 3 5 4 h i h 0 x 10 2 r f h 0 1 2 3 4 6 6 5 7 7 5 8 8 5 9 h i h 0 x 10 2 r f h 0 1 2 3 4 8 9 10 11 12 13 14 15 16 h i h 0 x 10 2 r f h 0 1 2 3 4 21 22 23 24 25 26 27 28 h i h 0 x 10 2 r f h 0 laboratory s msm s monolayer 1 2 3 4 5 1 1 5 2 2 5 3 h i h 0 x 10 2 r f h 0 1 2 3 4 4 5 5 5 5 6 6 5 h i h 0 x 10 2 r f h 0 19 22 23 7 16 10 0 figure 9 influence of the thickness hi of the erodible bed on the final runout rf for slopes 0 10 16 19 22 23 7 observed in the experiments of 24 solid circle blue line and obtained with different simulations using the multilayer shallow model with a constant friction coefficient s with 20 layers dotted circle red line and with one layer i e the savage hutter model 31 dashed red line there is no laboratory data for 23 7 normalisation using h 0 14 cm in dimensionless form we have d u 1 2 z uh 2 4 x uh 2 2 xw z uh 2 xw 2 54 we can improve the approximation of d u at the interfaces z z 1 2 by considering the approximation taking into account second order terms in the previous equation for the numerical tests we consider the following approximation d u at the interfaces d u z z 1 2 qh 1 2 2 x uh 1 uh 2 55 note that this definition corresponds to an approximation of d u z uh 2 4 x uh 2 at z z 1 2 nevertheless in 54 the term 2 z uh xw is not taken into account although it is of the same order as 4 x uh 2 this is because when an approximation of this term is added we obtain results that are very similar to those obtained when considering 55 furthermore adding 35 0 1 2 3 4 2 2 5 3 3 5 4 h i h 0 x 10 2 r f h 0 1 2 3 4 6 6 4 6 8 7 2 h i h 0 x 10 2 r f h 0 1 2 3 4 8 9 10 11 h i h 0 x 10 2 r f h 0 1 2 3 4 10 11 12 13 14 15 h i h 0 x 10 2 r f h 0 laboratory i msm i monolayer i c msm 1 2 3 4 5 1 1 5 2 2 5 3 h i h 0 x 10 2 r f h 0 1 2 3 4 4 5 4 9 5 3 5 7 h i h 0 x 10 2 r f h 0 19 22 23 7 16 10 0 figure 10 influence of the thickness hi of the erodible bed on the final runout rf for slopes 16 19 22 23 7 observed in the experiments of 24 solid circle blue line and obtained with different simulations using the multilayer shallow model with the i rheology with 20 layers solid cross green line and with one layer solid green line and with the multilayer shallow model with the correction of d ua dashed black line normalisation using h 0 14 cm this term implies an additional computational cost since pre calculated vertical velocities are re quired note that 55 is a second order correction while we have developed a first order model that neglects other second order terms this correction however highlights the importance of sec ond order terms in granular collapses over erodible beds the model corresponding to the multilayer approximation with the i rheology will hereafter be denoted i msm when d u is approximated by 40 when d u is approximated by the correction 55 we denote the model i c msm figure 10 shows that the correction of d u corresponding to i c msm improves the simulation of both the runout extent and the influence of the erodible bed they both increase leading to a better agreement with laboratory experiments 5 2 3 flow dynamics and velocity profiles figures 12 and 13 show the time change of the granular column thickness for a slope 22 and an erodible bed of thickness hi 1 82 mm for s and i respectively for both the monolayer and multilayer models as observed for the deposit the difference between the thickness profiles simulated with the multilayer and the monolayer model is stronger for i than for s the i msm makes it possible to increase the maximum thickness of the flow and decrease the thickness 36 1 1 5 2 2 5 3 3 5 4 6 8 10 12 14 16 18 20 22 h i h 0 x 10 2 t f c 1 1 5 2 2 5 3 3 5 4 8 10 12 14 16 18 20 22 h i h 0 x 10 2 t f c 16 19 22 laboratory 22 a i msm b i monolayer figure 11 influence of the thickness hi of the erodible bed on the final time tf for slopes 16 dashed diamond red line 19 dashed cross magenta line 22 solid square green line and the values observed in the experiments of 24 for slope 22 solid circle blue line obtained using a the multilayer shallow model and b the monolayer model with the i rheology with 20 layers normalisation using c h 0 g cos and h 0 14 cm of the front this is an important result as the shape of the front may be an indicator of the flow rheology 27 19 when a constant coefficient s is used very similar profiles are obtained with the multilayer shallow model and monolayer model savage hutter model as a result the multilayer approach does not significantly improve the results when a constant friction coefficient is used note that during the initial instants the simulated mass spread faster than in the experiments this is partly due to the role of initial gate removal that is not taken into account here however this effect could not explain the strong difference between the simulation and experiments see 18 for more details the hydrostatic assumption may also be responsible for this overestimation of the spreading velocity see e g 25 figure 14 shows that the second order correction in i c msm leads to simulated deposits that are generally closer to the experimental observations than those calculated with i msm in particular the deposits at 19 and 22 with hi 4 6 mm are very well reproduced figure 14 b c d f however in some cases i msm gives better results than i c msm for example for 22 with hi 1 82 mm this is true for the overall dynamics as illustrated in figure 13 that shows the time change of the granular column thickness we can see that with i c msm the avalanche is faster and the runout is overestimated and very similar to the runout obtained with the i monolayer model as other second order terms than those included in the i c msm model are neglected it is not easy to draw a firm conclusion on the improvement of results when using second order terms the multilayer approach make it possible to obtain a normal profile of the downslope velocity figures 15 and 16 show the normal profiles of the downslope velocity obtained at different times until the mass stops for two different configurations of slopes and erodible beds in order to obtain a more accurate profile 40 layers are used in the multilayer shallow model the different kind of profiles observed in figures 15 and 16 are in good qualitative agreement with typical velocity profiles of granular flows 17 see also 22 and 23 the model predicts some sliding at the base of the flow as shown at x 0 095 m in figure 15 and at x 0 045 m in figure 16 green profiles in agreement with 18 this suggests that a friction condition at the base could be more appropriate than the no slip boundary condition suggested in some studies see 10 and 21 note that the lower layers stop before the upper layers as observed experimentally 37 20 0 20 40 60 80 100 0 5 10 15 distance cm h c m 20 0 20 40 60 80 100 120 140 0 2 4 6 8 distance cm h c m 0 50 100 150 200 0 2 4 6 8 distance cm h c m 0 50 100 150 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 0 5 10 distance cm h c m laboratory s msm s monolayer t 0 8 s t 2 56 s t 1 12 s t 0 48 st 0 16 s t 1 44 s figure 12 thickness of the granular mass at different times in the experiments solid circle blue line and with the multilayer shallow model using a constant friction coefficient s and either 20 layers dotted circle red line or one layer savage hutter model dashed red line for the slope 22 and erodible bed thickness hi 1 82 mm let us compare the averaged velocity obtained with the monolayer model to the average of the velocities over all the layers in the multilayer shallow model in figure 15 for the green profile respectively red and magenta profiles the velocity in the monolayer model is 1 01 m s respec tively 0 02 and 0 14 m s and 0 95 m s respectively 0 03 and 0 05 m s for the averaged velocity in the multilayer shallow model note that we obtain similar values for the first and second profiles for the third profile the averaged velocities strongly differ actually at this position and time the velocity profile corresponds to the stopping phase for the multilayer model but not for the monolayer model as a result the velocity obtained in the multilayer model is smaller than that obtained in the monolayer model figure 17 shows the normal profile of normal velocity for the same configuration as figure 15 note that the normal velocities are always negative and that their absolute values are greater in the upper layers 6 conclusion in this work we have proposed a multilayer shallow model for dry granular flows that considers a i rheology the multilayer approach has been applied as in 14 thus leading to a solution of the resulting model that is a particular weak solution of the full navier stokes equations a regularisation method has been used to avoid the singularity occurring when d u vanishes a dissipative energy inequality has been proved for this model which is an essential feature to guarantee that the calculated solution is physically meaningful 38 20 0 20 40 60 80 100 0 5 10 15 distance cm h c m 20 0 20 40 60 80 100 120 0 2 4 6 8 distance cm h c m 0 50 100 150 0 2 4 6 8 distance cm h c m 0 50 100 150 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 0 5 10 distance cm h c m i msm i monolayer i c msm t 1 44 s t 2 56 s t 0 8 s t 0 48 s t 1 12 s t 0 16 s figure 13 thickness of the granular mass at different times in the experiments solid circle blue line with the i multilayer shallow model using either 20 layers solid cross green line or one layer solid green line and with the correction of d ua dashed black line for the slope 22 and erodible bed thickness hi 1 82 mm the numerical solutions of this model have been compared to the 2 d analytical solutions of 2 d infinite granular layer flowing over an inclined plane proposed by 21 the multilayer shallow model gives an accurate approximation of this 2 d analytical solution by comparing the numerical results obtained with this new model to laboratory experiments we have shown that the model qualitatively and sometimes quantitatively reproduces the granular column collapses over inclined erodible beds performed in 24 the increase of the runout distance with increasing thickness of the erodible bed is only reproduced when using the multilayer shal low model with the i rheology although this increase is significantly underestimated to our knowledge this is the first time that a model has been able to reproduce this effect the increase in runout distance appears for slopes 18 whereas it is observed for slopes 16 in the laboratory experiments on the other hand when using the monolayer i rheology the increase of runout distance with the thickness of the erodible bed only occurs for slopes 21 moreover in the monolayer model for 19 the runout distance decreases as the thickness of the erodible bed increases contrary to observations as a result when using the i rheology the multilayer model significantly improves the simulated deposits at different slopes over different thicknesses of the erodible bed compared to the monolayer model in particular it changes the shape of the front this is an important result as the shape of the front may be an indicator of the flow rheology 27 19 when considering a constant friction coefficient the multilayer approach only slightly changes 39 20 0 20 40 60 80 100 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 0 2 4 6 8 distance cm h c m 0 50 100 150 0 2 4 6 8 distance cm h c m 0 50 100 150 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 0 2 4 6 8 distance cm h c m 20 0 20 40 60 80 100 0 2 4 6 8 distance cm h c m laboratory i msm i c msm 19 h i 2 7 mm 22 h i 1 82 mm 22 h i 4 6 mm 19 h i 5 3 mm 19 h i 1 5 mm 16 h i 2 5 mm c e f d b a figure 14 simulated deposits at different slopes and erodible bed thicknesses hi with the multilayer shallow model using the higher order correction of d u 55 dashed black line and without this correction solid cross green line the deposits observed in the experiments is represented by solid circle blue lines the results compared to the monolayer model even with the multilayer model the use of a con stant friction coefficient does not make it possible to reproduce the increase in runout distance with increasing thickness of the erodible bed the opposite effect is observed this confirms the analytical results of 12 obtained for the monolayer savage hutter equations an important result is that this multilayer approach allows us to obtain the normal profiles of the downslope and normal velocities these profiles qualitatively agree with the typical granular flow profiles during the developed flow and during the stopping phase 17 one of the differences between the multilayer and monolayer approaches is the accuracy of the approximation of the strain rate and consequently of the inertial number and the i friction coefficient we have seen that the i c msm model which introduces a second order correction to improve the approximation of the strain rate generally improves the results the increase in runout distance when the thickness of the erodible bed is increased is larger and therefore closer to the laboratory experiments in addition the critical slope above which the runout increases with the thickness of the bed erodible is 16 which is closer to the value observed in the experiments than the critical slope predicted by the model without the second order correction this suggests that the extension of this shallow model up to the second order could be an important contribution 40 0 2 0 0 2 0 4 0 6 0 8 1 1 2 1 4 0 0 005 0 01 0 015 0 02 0 025 0 03 0 035 0 04 0 045 0 05 x m z m 0 0 1 0 2 0 0 01 0 02 0 03 0 04 z m u m s 1 0 0 01 0 02 0 0 005 0 01 0 015 0 02 z m u m s 1 0 0 02 0 0 002 0 004 0 006 0 008 0 01 0 012 z m u m s 1 x 0 995 m t 1 5 s x 0 495 m t 1 35 s x 0 095 m t 0 15 s figure 15 normal profiles of the downslope velocity obtained with the multilayer shallow model 40 layers for 22 and hi 1 82 mm during granular collapse at different positions x 0 095 0 495 0 995 m for these positions we represent the velocity profiles for different times taken every 0 15 s blue lines the first selected profile green shows a profile at the beginning of the flow and the second red and third magenta profiles were measured during the stopping stage the final deposit is represented by the solid brown line 0 0 05 0 1 0 15 0 2 0 25 0 3 0 35 0 4 0 45 0 5 0 0 01 0 02 0 03 0 04 0 05 0 06 0 07 0 08 x m z m 0 0 05 0 1 0 0 01 0 02 0 03 0 04 0 05 u m s 1 z m 0 0 005 0 01 0 2 4 6 8 x 10 3 u m s 1 z m x 0 045 m t 0 2 s x 0 245 m t 0 4 s figure 16 normal profiles of the downslope velocity obtained with the multilayer shallow model 40 layers for 0 and hi 1 5 mm during granular collapse at different positions x 0 045 0 245 m and times taken every 0 05 s 41 0 2 0 0 2 0 4 0 6 0 8 1 1 2 1 4 0 0 005 0 01 0 015 0 02 0 025 0 03 0 035 0 04 0 045 0 05 x m z m 0 02 0 01 0 0 0 002 0 004 0 006 0 008 0 01 w m s 1 z m 0 145 0 07 0 0 0 01 0 02 0 03 0 04 w m s 1 z m 0 005 0 0 0 005 0 01 0 015 0 02 w m s 1 z m x 0 495 m t 1 4 s x 0 995 m t 1 4 s x 0 095 m t 0 2 s figure 17 normal profiles of the normal velocity obtained with the multilayer shallow model 40 layers for 22 and for hi 1 82 mm during granular collapse at different positions x 0 095 0 495 0 995 m and times taken every 0 2 s acknowledgements this research has been partially supported by the spanish government and feder through the research project mtm 2012 38383 c 02 02 by the andalusian government through the project p 11 rnm 7069 by the anr contract anr 11 bs 01 0016 landquakes the uspc peges project and the erc contract erc cg 2013 pe 10 617472 slidequakes references 1 e audusse a multilayer saint venant model derivation and numerical validation discrete contin dyn syst ser b 5 2 189 214 2005 2 e audusse f bouchut m bristeau r klein and b perthame a fast and stable well balanced scheme with hydrostatic reconstruction for shallow water flows siam journal on scientific computing 25 6 2050 2065 2004 3 e audusse m bristeau b perthame and j sainte marie a multilayer saint venant system with mass exchanges for shallow water flows derivation and numerical validation esaim mathematical modelling and numerical analysis 45 169 200 2011 4 e audusse m o bristeau and a decoene numerical simulations of 3 d free surface flows by a multilayer saint venant model international journal for numerical methods in fluids 56 3 331 350 2008 5 e audusse m o bristeau m pelanti and j sainte marie approximation of the hydrostatic navier stokes system for density stratified flows by a multilayer model kinetic interpretation and numerical solution journal of computational physics 230 9 3453 3478 2011 42 6 m bercovier and m engelman a finite element method for incompressible non newtonian flows journal of computational physics 36 3 313 326 1980 7 a bermu dez and c moreno duality methods for solving variational inequalities computers mathematics with applications 7 1 43 58 1981 8 f bouchut nonlinear stability of finite volume methods for hyperbolic conservation laws and well balanced schemes for sources springer science business media 2004 9 j chauchat and m me dale a three dimensional numerical model for incompressible two phase flow of a granular bed submitted to a laminar shearing flow computer methods in applied mechanics and engineering 199 912 439 449 2010 10 j chauchat and m me dale a three dimensional numerical model for dense granular flows based on the i rheology journal of computational physics 256 0 696 712 2014 11 r delannay a valance a mangeney o roche and p richard granular and particle laden flows from laboratory experiments to field observations journal of physics d applied physics 2015 12 g faccanoni and a mangeney exact solution for granular flows international journal for numerical and analytical methods in geomechanics 37 10 1408 1433 2013 13 m farin a mangeney and o roche fundamental changes of granular flow dynamics deposition and erosion processes at high slope angles insights from laboratory experiments journal of geophysical research earth surface 119 3 504 532 2014 14 e d ferna ndez nieto e h kone and t chaco n rebollo a multilayer method for the hy drostatic navier stokes equations a particular weak solution journal of scientific com puting 60 2 408 437 2014 15 r glowinski and p le tallec augmented lagrangian and operator splitting methods in nonlinear mechanics siam studies in applied mathematics 9 1989 16 j m n t gray and a n edwards a depth averaged i rheology for shallow granular free surface flows journal of fluid mechanics 755 503 534 2014 17 gdr midi group on dense granular flows the european physical journal e 14 4 341 365 2004 18 i r ionescu a mangeney f bouchut and r roche viscoplastic modeling of granular col umn collapse with pressure dependent rheology journal of non newtonian fluid mechanics 219 0 1 18 2015 19 d e jessop k kelfoun p labazuy a mangeney o roche j l tillier m trouillet and g thibault lidar derived morphology of the 1993 lascar pyroclastic flow deposits and implication for flow dynamics and rheology journal of volcanology and geothermal research 245 246 0 81 97 2012 20 p jop y forterre and o pouliquen a constitutive law for dense granular flows nature 441 7094 727 730 2006 21 p y lagre e l staron and s popinet the granular column collapse as a continuum validity of a two dimensional navier stokes with a i rheology journal of fluid mechanics 686 378 408 2011 22 c lusso f bouchut a ern and a mangeney a simplified model for static flowing dy namics in thin layer flows of granular materials with yield april 2015 23 c lusso a ern f bouchut a mangeney m farin and o roche two dimensional simulation by regularization of free surface viscoplastic flows with drucker prager yield stress and application to granular collapse march 2015 43 24 a mangeney o roche o hungr n mangold g faccanoni and a lucas erosion and mobility in granular collapse over sloping beds journal of geophysical research earth surface 2003 2012 115 f 3 2010 25 a mangeney castelnau f bouchut j p vilotte e lajeunesse a aubertin and m pirulli on the use of saint venant equations to simulate the spreading of a granular mass journal of geophysical research solid earth 110 b 9 2005 26 c pare s numerical methods for nonconservative hyperbolic systems a theoretical framework siam journal on numerical analysis 44 1 300 321 2006 27 o pouliquen on the shape of granular fronts down rough inclined planes physics of fluids 11 7 1999 28 o pouliquen scaling laws in granular flows down rough inclined planes physics of fluids 1994 present 11 3 542 548 1999 29 o pouliquen and y forterre friction law for dense granular flows application to the motion of a mass down a rough inclined plane journal of fluid mechanics 453 133 151 2002 30 j sainte marie vertically averaged models for the free surface non hydrostatic euler system derivation and kinetic interpretation mathematical models and methods in applied sciences 21 03 459 490 2011 31 s b savage and k hutter the motion of a finite mass of granular material down a rough incline journal of fluid mechanics 199 177 215 2 1989 32 l staron p y lagre e and s popinet the granular silo as a continuum plastic flow the hour glass vs the clepsydra physics of fluids 1994 present 24 10 2012 33 l staron p y lagre e and s popinet continuum simulation of the discharge of the granular silo a validation test for the i visco plastic flow law the european physical journal e soft matter 37 1 2014 44 1 introduction 2 the 3 d initial system 2 1 closures 2 1 1 rheology 2 1 2 boundary and kinematic conditions 2 2 dimensional analysis 3 a multilayer approach 3 1 weak solution with discontinuities 3 2 stress tensor approximation 3 3 vertical velocity 4 weak solution of the first order model 4 1 pressure 4 2 a particular weak solution 4 3 final model 4 4 energy associated with the final model 5 numerical tests 5 1 analytical solution 5 2 comparison with laboratory experiments 5 2 1 deposit profiles 5 2 2 effect of the erodible bed 5 2 3 flow dynamics and velocity profiles 6 conclusion