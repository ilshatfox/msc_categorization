finite difference time domain simulation of spacetime cloak jason cornelius 1 jinjie liu 1 and moysey brio 2 1 department of mathematical sciences delaware state university dover de 19901 2 department of mathematics the university of arizona tucson az 85721 jliu desu edu abstract in this work we present a numerical method that remedies the instabilities of the conventional fdtd approach for solving maxwell s equations in a space time dependent magneto electric medium with direct application to the simulation of the recently proposed spacetime cloak we utilize a dual grid fdtd method overlapped to the time domain to provide a stable approach for the simulation of magneto electric medium with time and space varying permittivity permeability and coupling coefficient the developed method can be applied to explore other new physical possibilities offered by spacetime cloaking metamaterials and transformation optics 2018 optical society of america ocis codes 230 3205 invisibility cloaks 000 4430 numerical approximation and analy sis 160 3918 metamaterials references and links 1 j b pendry d schurig and d r smith controlling electromagnetic fields science 312 1780 1782 2006 2 u leonhardt optical conformal mapping science 312 1777 1779 2006 3 m w mccall a favaro p kinsler and a boardman a spacetime cloak or a history editor j opt 13 024003 2011 4 p kinsler and m w mccall cloaks editors and bubbles applications of spacetime transformation theory ann phys 526 51 62 2014 5 k s yee numerical solution of initial boundary value problems involving maxwell s equations in isotropic media ieee trans antennas propag 14 302 307 1966 6 a taflove and m e brodwin numerical solution of steady state electromagnetic scattering problems using the time dependent maxwell s equations ieee trans microwave theory tech 23 623 630 1975 7 a taflove and s hagness computational electrodynamics the finite difference time domain method artech house norwood ma 2005 3 rd ed 8 f l teixeira time domain finite difference and finite element methods for maxwell equations in complex media ieee trans antennas propag 56 2150 2166 2008 9 j liu m brio y zeng a zakharian w hoyer s w koch and j v moloney generalization of the fdtd algorithm for simulations of hydrodynamic nonlinear drude model j comput phys 229 5921 5932 2010 10 a akyurtlu and d h werner bi fdtd a novel finite difference time domain formulation for modeling wave propagation in bi isotropic media ieee trans antennas propag 52 416 425 2004 11 a semichaevsky a akyurtlu d kern d h werner and m g bray novel bi fdtd approach for the analysis of chiral cylinders and spheres ieee trans antennas propag 54 925 932 2006 1 introduction in recent years transformation optics to has become one of more interesting topics in sci ence utilizing transformation optics and metamaterials spatial invisibility cloaks 1 2 have been developed a spatial cloak functions by manipulating the spatial path of electromagnetic waves within the cloaked region in such a way that waves are bent around the object being ar x iv 1 40 3 01 37 v 2 ph ys ic s op ti cs 2 4 a pr 2 01 4 cloaked transformation optics allows for a description of the medium ie material parameters needed for the construction of such devices for this particular type of cloak the implementa tion requires the use of inhomogeneous media where the inhomogeneity is due to the use of spatially dependent anisotropic permeability and permittivity within the past three years a new type of cloak has been developed 3 4 the spacetime cloak contrary to the spatial cloak a spacetime cloak functions by altering the speed of the electromagnetic wave as it propagates through the cloaked region initially the speed of the front of the wave is increased while the speed of the back of the wave is decreased this allows for a gap to occur in which an event can be carried out undetected to close the gap the back of the wave is sped up and the front is slowed down allowing the wave to continue on at its original speed the design of such a cloak can be achieved by transformation optics and it results in a magneto electric medium with time and space varying permittivity permeability and coupling coefficient due to the interesting nature of these devices simulation is desirable to this end we turn to the finite difference time domain fdtd method the fdtd method 5 7 is a very successful method for simulating electromagnetic wave propagation it has been applied to the study of various types of materials 7 8 including dielectrics linear dispersive materials nonlinear raman and kerr materials nonlinear dispersive materials 9 bi isotropic media 10 11 etc in this paper we are interested in space and time dependent magneto electric materials and their direct application to the spacetime cloak in 4 the fdtd method has been applied to simulate the spacetime cloak but the authors point out that there are some difficulties near the closing process of the spacetime cloak our numerical simulations demonstrate that there are instabilities for conventional fdtd simulation due to the temporal extrapolation of the time dependent magneto electric constitutive equations to stably solve maxwell s equations in time dependent magneto electric medium we pro pose a modified fdtd method based on the use of time overlapped grids our method uses two yee grids that are offset in time by a half time step so that collocated fields are provided in the time dependent magneto electric constitutive equations the resulting numerical update equations do not require time extrapolation therefore the instability due to time extrapolation is avoided our method is applied to simulate the spacetime cloak 2 transformation optics and spacetime cloak in this section we briefly review the derivation of the spacetime cloak using transformation optics consider the following covariant form of the maxwell s equations ampe re s law and the gauss law of electric fields m 0 dx dy dz dx 0 hz hy dy hz 0 hx dz hy hx 0 0 1 where t x y z applying a spacetime transformation from t x to and keep ing y and z coordinates unchanged we have the following covariant form of the maxwell s equation in the new coordinates m 0 d d d d 0 h h d h 0 h d h h 0 0 2 a b fig 1 a a spacetime cloak in the t x domain b free space after the transformation to the domain where m 1 m t and is the jacobian matrix i 2 represents the 2 2 identity matrix t x y z t x 0 0 t x 0 0 0 0 1 0 0 0 0 1 0 0 i 2 3 similar matrix equations are obtained for faraday s law together with the gauss law of mag netic fields we consider a spacetime cloak design similar to the spacetime cloaks proposed in 3 4 figure 1 shows a diamond shaped spacetime cloak in the t x domain and the transformed free space the original and the transformed regions are the same parallelograms centered at t 0 x 0 so we have 0 x 0 0 t 0 p tp and q tq in the parallelogram we apply the following coordinate transformation to create such spacetime cloak t 4 x xs t ts t 0 ts xs 5 where the values of xs and ts depend on the regions where t x lies in ts tp if t x lies in region i or ii tq if t x lies in region iii or iv 6 and xs x 0 t t 0 c if t x lies in region i or iv x 0 t t 0 c if t x lies in region ii or iii 7 since the transformed domain is free space we have the constitutive equations d e and b h the corresponding constitutive equations in t x domain are magneto electric ez dz by 8 hy dz by 9 where and are space and time dependent where 1 a 12 a 22 a 12 a 12 a 21 a 11 a 22 a 12 10 and a 11 a 12 a 21 a 22 1 0 1 0 11 3 the conventional fdtd method for time dependent magneto electric medium consider the following 1 1 d maxwell s equations dz t hy x 12 by t ez x 13 where the constitutive equations are given in eqs 8 and 9 for simplicity we let e ez d dz h hy and b by we note that the primary issue with simulating magneto electric media arises from the more complicated constitutive relations given in eqs 8 and 9 using the conventional fdtd method the discretized maxwell s equations the d first scheme are d n 12 i d n 12 i t x hn i 12 hn i 12 14 bn 1 i 12 bn i 12 t x e n 12 i 1 e n 12 i 15 and the constitutive relations assuming that the coupled constitutive relations respond locally in space and time become e n 12 i n 12 i d n 12 i n 12 i b n 12 i 16 hn 1 i 12 n 1 i 12 dn 1 i 12 n 1 i 12 bn 1 i 12 17 parameters and are computed analytically from eq 10 and are thus available at any point t x in the computational domain however the quantities b n 12 i in eq 16 and d n 1 i 12 in eq 17 are not computed in the discretized maxwell s eqs 14 and 15 as a result the conventional yee approach cannot be directly used in the simulation of magneto electric media one method for resolving these issues is to use time extrapolation and space interpolation to compute b n 12 i in eq 16 we have b n 12 i 3 bni b n 1 i 2 18 3 2 b n i 12 bn i 12 12 b n 1 i 12 bn 1 i 12 2 19 3 bn i 12 3 bn i 12 bn 1 i 12 bn 1 i 12 4 20 a b fig 2 computation of ez using a the time extrapolation under a conventional fdtd method and b the overlapping yee algorithm without extrapolation which is valid after the first timestep for the initial timestep we use bni as an approximation for b n 12 i similarly we compute d n 1 i i 2 in eq 17 as follows dn 1 i 12 3 d n 12 i 1 3 d n 12 i d n 12 i 1 d n 12 i 4 21 numerical simulation on spacetime cloak shows that the conventional fdtd method pre sented in this section is unstable this is primarily due to the use of time extrapolation to avoid such extrapolation we propose an overlapping yee algorithm for time dependent magneto electric media as described in the next section 4 the overlapping yee algorithm for time dependent magneto electric media rather than a single d first scheme or b first scheme we use a combination of both while computationally more expensive this produces d and b values at every half time step and spatial step within our computational domain as a result we are able to perform the required magneto electric maxwell constitutive relation updates without extrapolation figure 2 illustrates the fundamental differences between utilizing a conventional fdtd ap proach and the overlapping grid approach figure 2 a depicts that due to the coupled consti tutive relations at any given step ez has a dependence on the quantity by the dotted arrows leading to this value indicate that by must be extrapolated in time and interpolated in space from values known on the conventional fdtd grid on the other hand fig 2 b illustrates that by utilizing a dual overlapping grid approach the dependence on time extrapolation and spatial interpolation can be eliminated a new superscript notation is used to indicate the usage of two overlapping grids and to specify which grid each value of by and ez comes from all values needed to compute ez at a particular instance in time exists on one of the two grids in presenting an algorithm for the adjusted scheme we utilize the convention that n represents the time coordinate of the grid point and i represents the spatial coordinate indices of n 12 and i 12 are use to represent locations that are a half time step or spatial step from the gridpoint with this established we present an algorithm for an overlapping yee fdtd method the algorithm in 1 d case can be summarized by the following steps 1 update d n 12 i on the first yee grid and b n 12 i on the second yee grid d n 12 i d n 12 i t x hn i 12 hn i 12 b n 12 i b n 12 i t x en i 12 en i 12 2 update e n 12 i and h n 12 i e n 12 i n 12 i d n 12 i n 12 i b n 12 i h n 12 i n 12 i d n 12 i n 12 i b n 12 i 3 update bn 1 i 12 on the first yee grid and dn 1 i 12 on the second yee grid bn 1 i 12 bn i 12 t x e n 12 i 1 e n 12 i dn 1 i 12 dn i 12 t x h n 12 i 1 h n 12 i 4 update en 1 i 12 and hn 1 i 12 en 1 i 12 n 1 i 12 dn 1 i 12 n 1 i 12 bn 1 i 12 hn 1 i 12 n 1 i 12 dn 1 i 12 n 1 i 12 bn 1 i 12 we note that the extension to 2 d and 3 d should be feasible by utilizing a time collocated grid where b and e are computed at the same instance in time but not necessarily in space doing so eliminates time extrapolation in 2 d and 3 d but still uses interpolation in space 5 spacetime cloak simulation the simulation of magneto electric media has direct applications to the spacetime cloak pre sented in 3 we create a similar diamond shaped spacetime cloak using the transformation depicted in fig 1 in simulating the above cloak we utilize a 10 m by 15 f s long computa tional domain with a plane wave with 600 nm traveling in the positive x direction our spacetime cloak is 1200 nm wide and lasts 6 f s with regards to fig 1 a we have x 0 1 5 m t 0 9 f s tq 6 f s tp 12 f s 600 nm and 180 nm the computational domain is terminated by perfectly matched layer pml absorbing boundary conditions 7 due to the fast and slow phase velocities in the spacetime cloak 3 t is chosen by t x vmax where vmax is the largest wave speed computed in the cloaking region we perform the simulation 3 times with the number of spatial cells n equal to 1600 2000 and 2400 and the same number of time steps the numerical simulation results are shown in fig 3 the figures shown are contour plots of the intensity of the electric field generated by the interaction between the incident source and the spacetime cloak we compare the conventional fdtd method with time extrapolation and the proposed overlapping yee fdtd method for various spatial resolutions the result shows the bending of the electric field and consequently the electromagnetic wave in space and time a b c d e f fig 3 contour plots of the electric field intensity for spacetime cloak simulations left column the overlapping yee fdtd results with grid sizes a n 1600 c n 2000 and e n 2400 respectively right column the corresponding results using a conventional time extrapolation based fdtd method a wave enters cloaking region b wave at center of cloak c wave leaving cloaking region d wave after leaving cloak fig 4 evolution of the electric field as the wave propagates through the spacetime cloak around the cloaked event the shown simulation results verify that an extrapolation approach is unstable near the closing process of the cloaked event and the proposed overlapping fdtd approach provides stable results we now examine the behavior of the electric field as the wave propagates through the dia mond shaped space time region under the same simulation parameters as the wave enters the cloak it begins to split as the front portion of the wave speeds up and the back portion of the wave slows down this effect is made possible due to the space time dependence of the media within the cloaking region as this separation occurs it is mirrored in the electric field pro ducing a gap in the electric field the early development of this gap is shown in fig 4 a near x 1000 nm as the wave progresses through the media the cloak widens in the x direction allowing for the size of this gap to increase as time progresses the gap in the electric field as shown in fig 4 b is at a maximum at the center of the cloaking region as the wave propagates past this point the cloak shrink in the x direction begins to close due to the closing of the cloak the front of the wave begins to slow down while the back speeds up this action allows for the wave to remerge just as it exits the cloak the field behavior moments before the wave exits the cloak is shown in fig 4 c at this point a small gap near x 2200 nm still exists once the wave has propagated through the cloak region it is fully rejoined and the propagation behavior and resulting field behavior returns to that of propagation in an isotropic media as shown in fig 4 d 6 stability analysis to conduct a stability analysis we compare the distribution of eigenvalues of the conventional fdtd method to that of our overlapping grid approach with respect to the unit circle for both 1 0 5 0 0 5 1 1 0 5 0 0 5 1 a 1 0 5 0 0 5 1 1 0 5 0 0 5 1 b fig 5 distribution of the eigenvalues in the complex plane for a the overlapping yee fdtd method and b the conventional fdtd method tests we utilize similar simulation parameters as in the previous section but with a smaller mesh size of n 200 we compute the eigenvalues of the numerical update equations at a time instant when t tq tp and plot them in the complex plane the results when t 8 34 f s are shown in fig 5 as indicated in the fig 5 a all the eigenvalues of the overlapping approach lie within or on the unit circle with the ones lying on unit circle being simple eigenvalues on the other hand fig 5 b shows that some of eigenvalues near the upper and lower right corners of the conventional fdtd approach lie outside the unit circle in particular the modulus of the largest eigenvalue is 1 for the overlapping method and 1 046 for the conventional fdtd method this indicates that the overlapping yee fdtd method is stable while the conventional fdtd approach with extrapolation would experience instability 7 conclusion in conclusion we have proposed a stable fdtd method for simulation of space and time de pendent magneto electric medium based on the use of two sets of overlapping yee grids that are offset in time by a half time step additionally we have shown the direct application of this method to the simulation of the spacetime cloak the proposed method is useful in exploration of other new physical possibilities offered by metamaterials and transformation optics acknowledgments we thank dr yong zeng for invaluable discussions this work was supported in part by the us air force office of scientific research grant fa 9550 10 1 0127 us aro grant w 911 nf 11 2 0046 and nsf grant hrd 1242067 m brio was also supported by us afosr muri grant fa 9550 10 1 0561 1 introduction 2 transformation optics and spacetime cloak 3 the conventional fdtd method for time dependent magneto electric medium 4 the overlapping yee algorithm for time dependent magneto electric media 5 spacetime cloak simulation 6 stability analysis 7 conclusion