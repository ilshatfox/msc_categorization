the role of space in the exploitation of resources ar x iv 1 10 2 22 83 v 1 m at h d s 1 1 f eb 2 01 1 the role of space in the exploitation of resources y kang and n lanchier abstract in order to understand the role of space in ecological communities where each species produces a certain type of resource and has varying abilities to exploit the resources produced by its own species and by the other species we carry out a comparative study of an interacting particle system and its mean field approximation for a wide range of parameter values we show both analytically and numerically that the spatial model results in predictions that significantly differ from its nonspatial counterpart indicating that the use of the mean field approach to describe the evolution of communities in which individuals only interact locally is invalid in two species communities the disagreements between the models appear either when both species compete by producing resources that are more beneficial for their own species or when both species cooperate by producing resources that are more beneficial for the other species in particular while both species coexist if and only if they cooperate in the mean field approximation the inclusion of space in the form of local interactions may prevent coexistence even in cooperative communities introducing additional species cooperation is no longer the only mechanism that promotes coexistence we prove that in three species communities coexistence results either from a global cooperative behavior or from rock paper scissors type interactions or from a mixture of these dynamics which excludes in particular all cases in which two species compete finally and more importantly we show numerically that the inclusion of space has antagonistic effects on coexistence depending on the mechanism involved preventing coexistence in the presence of cooperation but promoting coexistence in the presence of rock paper scissors interactions although these results are partly proved analytically for both models we also provide somewhat more explicit heuristic arguments to explain the reason why the models result in different predictions 1 introduction the main objective of this article is to understand the role of space taking the form of local but also stochastic interactions in the long term behavior of ecological communities this is carried out through the comparison of analytical and numerical results for an interacting particle system and its nonspatial mean field approximation both the spatial and nonspatial models mimic the dynamics of communities in which each species produces a certain type of resource and has varying abilities to exploit the resources produced by its own species and by the other species as explained later in this paper after the rigorous mathematical description of the interacting particle system and its mean field approximation this framework can be used to model a wide variety of biological interactions such as competition mutualism allelopathy or predation in the interacting particle system individuals are located on an infinite grid and only have access to the resources produced by their nearest neighbors in contrast the mean field approximation assumes that all individuals interact globally therefore the dynamics only depend on the overall densities of species which results in a nonspatial deterministic model that consists of a system of coupled differential equations the reason for this comparative study is mainly motivated by the following key question raised in the seminal article of durrett and levin 5 about the importance of space which details should research supported in part by nsf grant dms 10 05282 ams 2000 subject classifications primary 92 d 25 60 k 35 keywords and phrases defector cooperator rock paper scissors interactions interacting particle system mean field approximation 1 http arxiv org abs 1102 2283 v 1 2 y kang and n lanchier be included in a mathematical model and which ones can be ignored the simplest approach in modeling the evolution of inherently spatial interacting populations is to assume that the system is homogeneously mixing and to use a system of ordinary differential equations which is a common approach in the life science literature at the other extreme one can use the framework of interacting particle systems in which individuals are discrete and space is treated explicitly for a wide range of parameter values we show that both approaches result in different predictions as for the sets of species that survive or coexist in the long run this indicates that at least for the type of interactions considered in this article the use of the mean field approach to model the evolution of communities in which individuals are static and interact only locally is invalid in other words local interactions cannot be ignored and should be included in the model using the terminology of game theory a species that has a higher ability respectively a lower ability than all other species to exploit the resources it produces can be seen as a defector re spectively a cooperator in the presence of only two species the spatial and nonspatial models strongly disagree when both species are defectors or both species are cooperators in particular while mutual cooperation always leads to coexistence in the mean field model the inclusion of local interactions translates into a reduction of the coexistence region past research has revealed that the inclusion of space can indeed prevent coexistence this has been proved analytically for a spa tially explicit version of the lotka volterra model introduced in 15 and the non mendelian diploid model introduced in 12 these two references and the companion paper 11 which provides rig orous proofs of the analytical results stated in this article for the interacting particle system focus on spatial and nonspatial models with only two types our approach is somewhat different first one of our main objectives is to give more explicit intuitive explanations of the reason why the inclusion of local interactions can affect drastically the long term behavior of ecological communi ties in particular heuristic arguments are provided to this extent second the emphasis here is on the three type models not only the analysis of the models in the presence of three species is somewhat more challenging but also and more importantly both the spatial and the nonspatial three type models exhibit new interesting behaviors that cannot be observed when only two species are involved for instance whereas cooperation is the only mechanism that promotes coexistence in the presence of two species we prove that there are other such mechanisms when additional species are introduced interestingly our analysis also indicates that the inclusion of local interactions has antagonistic effects on coexistence depending on the mechanism involved promoting coexistence in some situations but preventing coexistence in other situations in particular we believe that the three type spatial and nonspatial models can capture most of the important aspects of communities involving a large number of species whereas the two type models do not 2 models description in order to understand the role of local interactions and stochasticity in the dynamics of ecological communities including varying abilities to exploit resources we introduce and investigate a stochas tic spatial model and its deterministic nonspatial analog and then confront the predictions based on both models the first model is an example of interacting particle system while the second one is its mean field approximation which consists of a system of differential equations for a description of the theoretical framework of interacting particle systems along with biological motivations we refer the reader to durrett and levin 4 and neuhauser 14 for the sake of concreteness we think of both models as describing the dynamics of ecological communities with n species that we label from species 1 to species n but we point out that these models can also be seen as more general the role of space in the exploitation of resources 3 models in game theory with potential applications in population genetics economics or political sciences in the ecological context the individuals of species j has to be thought of as producing a resource that we simply call resource j the interactions either local in the spatial model or global in the nonspatial one are dictated by the n n matrix m a 1 1 a 1 2 a 1 n a 2 1 a 2 2 a 2 n an 1 an 2 an n where coefficient ai j represents the ability of an individual of species i to exploit resource j it is assumed that matrix m has only nonnegative entries and to avoid degenerated cases later that each column of the matrix has at least one positive entry we note that each row can be seen as the abilities of a given species to exploit each of the n resources and each column as the abilities of each of the n species to exploit a given resource in particular the assumption that each column of the matrix has at least one positive entry means from an ecological point of view that each of the resources can be exploited by at least one species since different species have a priori different abilities to exploit each of the resources their fitness strongly depends upon the configuration of their environment as well therefore there is a constant feedback between the set of fitnesses and the configuration of the environment which creates nontrivial dynamics the spatial model following the traditional framework of interacting particle systems we assume that space is discrete and time is continuous more precisely the spatial structure is repre sented by the d dimensional integer lattice zd while the temporal structure is represented by the variable t which is any nonnegative real number each lattice site has to be thought of as a spatial location which at any time is occupied by an individual of one of the n species this corresponds to a high density limit in which at death an individual is instantaneously replaced by the offspring of a nearby individual hence the spatial configuration of the system at time t is represented by a function t that maps the integer lattice into the set of species with t x indicating the species of the individual at site x at time t to describe the dynamics of the spatial model but also to derive its mean field approximation it is convenient to think of the spatial structure as a graph in the spatial model each lattice site is connected by an edge to each of its 2 d nearest neighbors therefore writing x y to indicate that sites x and y are nearest neighbors the integer ni x card y z d y x and t y i denotes the number of type i neighbors of site x the species at each site is updated at the arrival times of a poisson process with intensity 1 that is the times between consecutive updates at a given site are independent and exponentially distributed random variables with parameter 1 the dynamics are dictated by stochastic and local interactions meaning that the new type at each update is chosen randomly from the neighborhood in order to model the inclusion of an explicit space more precisely given that the species at site x is of type j at the time of an update the new species at this site is chosen to be species i with probability ai j ni x a 1 j n 1 x a 2 j n 2 x an j nn x 1 4 y kang and n lanchier and we assume in the event that the denominator is equal to zero that the update is canceled so the species at site x remains unchanged this probability can be interpreted as follows since the coefficient ai j represents the ability of an individual of species i to exploit resource j the numerator is simply the overall ability of the type i neighbors to exploit the resource at site x at the time of the update similarly the denominator represents the overall ability of all the neighbors to exploit the resource at site x therefore the probability in 1 is the relative ability of the type i neighbors to exploit the resource at site x which we also naturally consider as the probability of the new species at site x to be species i hence the new species at each update is chosen randomly from the local neighborhood with a selective advantage for neighbors that have a higher ability to exploit the resource present at the site to be updated finally we point out that because there are countably many lattice sites updates at different sites cannot occur simultaneously so the new type can indeed be chosen from the local neighborhood without ambiguity the mean field approximation the mean field model is naturally derived from the original interacting particle system by excluding both space and stochasticity for a discussion about the connections between interacting particle systems and their mean field approximations we refer the reader to durrett and levin 5 to motivate the definition of the mean field model we first replace the infinite lattice by a finite complete graph that is a finite graph in which each site is connected to all other sites including itself so that all sites have the same neighborhood that consists of all the vertex set describing the interactions as previously but using this universal neighborhood rather than local neighborhoods results in a nonspatial environment in which the types at different sites are independent and identically distributed random variables in particular ui t p t x i for all t 0 and i 1 2 n where x is a denominated site are probabilities that indeed no longer depend on x the mean field approximation is then defined as the deterministic system of coupled ordinary differential equations that describes the evolution of these probabilities to derive this deterministic system from the stochastic dynamics we first observe that ui t h ui t p t h x i t x 6 i p t h x 6 i t x i j 6 i p t h x i t x j j 6 i p t h x j t x i 2 moreover the probability that at the next update a type j is replaced by a type i is also the probability uj that the site chosen to be updated is of type j times the probability 1 that the new type selected is type i since in addition sites are independent and the probability of an update at site x in a very short time interval is roughly equal to the length of this interval we obtain p t h x i t x j h uj t ai j ui t a 1 j u 1 t an j un t o h 3 for h 0 small substituting 3 in 2 dividing by h and taking the limit as h 0 we get dui dt n j 1 ai j ui a 1 j u 1 an j un uj n j 1 aj i uj a 1 i u 1 an i un ui 4 for all i 1 2 n each fraction in the first sum of 4 is the relative ability of species i to exploit resource j over all the community which when different species have different abilities to the role of space in the exploitation of resources 5 exploit each of the resources strongly depends on the species distribution therefore the first sum can be seen as the overall birth rate of individuals of species i note also that the second sum is simply equal to ui so the mean field approximation reduces to the system dui dt n j 1 ai j uj a 1 j u 1 an j un 1 ui for i 1 2 n 5 the minus one term indicates that the per capita death rate of each species is equal to 1 which results from the fact that in the original stochastic process each lattice site is updated at the arrival times of a poisson process with intensity 1 the importance of space even though following the traditional terminology the mean field model is called nonspatial deterministic approximation both models in fact include space but at different levels of details in the interacting particle system the state space consists of spatial configurations of species on the lattice that can only interact with their nearest neighbors therefore space takes the form of local interactions which is referred to as explicit space the mean field model is obtained by replacing the lattice by a complete graph in particular space is again included but it now takes the form of global interactions which is referred to as implicit space the interacting particle system describes more suitably populations in which individuals are static and can only disperse their offspring over short distances whereas the mean field model is more appropriate to mimic populations in which individuals either move or have the ability to disperse their offspring over very long distances most mathematical models introduced in the life science literature that describe spatially explicit interacting populations consist however of systems of ordinary differential equations that assume that populations are well mixed the objective of this study is to prove both analytically and numerically that at least for the type of interactions considered in this article the use of the mean field approach is invalid for a wide range of parameters in the sense that both models result in different predictions before stating our results it is necessary to specify what is meant here by both models result in different predictions in the interacting particle system since the types at different lattice sites are not independent some quantities of interest are the so called spatial correlations the correlations between the types at two sites as a function of the distance between these two sites there is obviously no analog of these quantities in the mean field model since it does not include any geometrical structure also the traditional approach to compare both models is to compare the density of a given species in the mean field model with the probability of a denominated site being occupied by this species type in the interacting particle system whenever one of these two quantities converges to zero whereas the other one is bounded away from zero uniformly in time we say that both models result in different predictions in other words both models are said to result in different predictions for a given set of parameters whenever the set of species surviving in the long run differ between both models biological interactions the limiting behavior of both the interacting particle system and its mean field approximation depends upon two factors the initial distribution of species which is a spatial configuration on the lattice for the first model and an n tuple of densities that sums up to one for the second model and more importantly the matrix m that describes the type of biological interactions among species these different types of biological interactions are modeled by the relationships among the matrix coefficients which can be conveniently described by using the terminology of game theory also we say that a species is a cooperator respectively a defector if it has a lower ability respectively a better ability than all other species to exploit the resource 6 y kang and n lanchier it produces that is in the column corresponding to the resource produced by this species the smallest respectively the largest coefficient is the coefficient on the diagonal while a species can be neither a cooperator nor a defector in communities with more than two species each species is either a cooperator or a defector in its relationship with a second species which induces three types of interactions for each pair of species we call cooperation the interaction between two cooperators competition the interaction between two defectors and cheating relationship the interaction between a cooperator and a defector in which case the defector is called a cheater to understand the variety of biological interactions that can be encoded by the parameter matrix it is important to point out that even if the individuals of a certain species do not strictly speaking produce resources that are beneficial for their species or the other species their death produces nevertheless a resource available to their neighbors space in particular the matrix coefficient ai j can represent more generally the ability of species i to exploit space with whatever an individual of species j produces space with resources that are beneficial for the nearby individuals such as nutrients or at the opposite space with biochemicals that have a harmful effect on the growth of other species and reduce their ability to exploit the spatial location available in the context of allelopathic interactions focusing on interactions involving only two species when none of the species is a producer the interactions are described by the matrix in which both columns are equal this models competition for space with the common coefficient in each row representing the ability of the corresponding species to invade space the species with the better ability to exploit space is a defector while the other species is a cooperator competition for space is common in plant communities but also occurs among territorial animals such as the grey wolf canis lupus although in this case this is more symptomatic of a defensive behavior in the former context interactions among plants that spread nearby through their rhizome such as euphorbia are better captured by the interacting particle system while the mean field model describes more suitably the interactions among seed plants that can disperse over large distances through anemochory zoochory or hydrochory such as the dandelion taraxacum officinale when both species indeed produce resources and these resources are more beneficial for the other species a symbiotic relationship called mutualism both species are cooperators the coefficients off diagonal are larger than the coefficients on the diagonal mutualism is common for instance in terrestrial plants which live in association with mycorrhizal fungi with the plant providing carbon to the fungus and the fungus providing nutrients to the plant as mentioned above our models are also suited to mimic allelopathic interactions in which a so called allelopathic species produces biochemicals that have detrimental effects on the growth and reproduction of other organisms in this case and when the other species is indeed susceptible to the allelochemicals the allelopathic species is a defector since it has a better ability to invade a spatial location saturated with allelochemicals while the susceptible species can be either a defector or a cooperator depending on its relative ability to invade spatial locations void of allelochemicals allelopathic interactions are common among invasive plants such as the spotted knapweed centaurea maculosa that uses biochemicals as a defense against other plants and herbivory in predator prey systems the resource that the predator exploits is not produced by the prey it is the prey itself therefore one needs to slightly reinterpret the microscopic rules of the models a spatial location is not invaded by a nearby predator just after the prey dies but just before with the death of the prey being caused by the predator in this context the prey is always a cooperator while the predator is either a defector or a cooperator depending on its relative ability to invade empty spatial locations note however that our models do not reproduce the oscillations typical of certain predator prey systems such as the one designed in the popular huffaker s mite experiment 9 since it assumes that the predator the role of space in the exploitation of resources 7 can survive in the absence of the prey a similar choice of parameters can also be used to model some cases of facultative parasitism in which the parasite can complete its life cycle without being associated with the host provided one identifies the infected host with the parasite itself which is only valid in contexts where infected hosts are sterile the analysis of the mean field model in this article and the analysis of the interacting particle system in the companion paper 11 give a precise picture of the asymptotic properties of systems involving only two species which includes all the biological interactions mentioned in this paragraph for larger ecological communities involving n species the appropriate relationships among the matrix coefficients can be deduced by looking at the type of biological interactions that relates any two species in this case the analysis of the mean field model pays a particular attention to coexistence and gives sharp results for communities that exhibit rock paper scissors dynamics in which three species together may coexist whereas in the absence of any of these three species the other two species cannot paper covers rock scissors cut paper and rock smashes scissors such dynamics have been observed in the common side blotched lizard uta stansburiana that exhibits color polymorphisms 17 rather than including three different species the system consists of male individuals of the common side blotched lizard with three different phenotypes orange throated males yellow stripe throated males and blue throated males corresponding to three different mating strategies while evolutionary theory predicts selection of the best fit all three phenotypes coexist in nature which according to the model of sinervo and lively 17 is due to the fact that the three phenotypes interact like in the rock paper scissors game our numerical and anaytical results give a valuable insight into this type of dynamics 3 analytical results for the nonspatial deterministic model in this section we collect a number of analytical results for the mean field model we start with general lemmas that will be applied repeatedly afterwards to understand the limiting behavior of the system with two and three species respectively the first step is to identify the positive invariant sets of the mean field model for i 1 2 n i 6 we let si u 1 u 2 un r n ui 0 for i i and i i ui 1 s i u 1 u 2 un si ui 0 for i i and simply write si sn and s i s n when i 1 2 n from the fact that ui can be interpreted as a probability it should be intuitively clear that the set sn is positive invariant for the mean field model also since individuals of either type cannot appear spontaneously in the interacting particle system the same holds in the mean field model so each set si should be positive invariant these statements are made rigorous in the following lemma lemma 1 for all i 1 2 n i 6 the set si is positive invariant i e u 1 0 un 0 si implies that u 1 t un t si for all t 0 proof this directly follows from the fact that n i 1 dui dt 0 and ui t 0 whenever ui 0 0 for all i 1 2 n 8 y kang and n lanchier and by noticing that the second assertion together with the continuity of the trajectories implies that for any species i we have ui t 0 at all times t 0 this completes the proof lemma 2 for all i 1 2 n i 6 the set s i is positive invariant proof in view of lemma 1 it suffices to prove that ui t 0 whenever ui 0 0 recalling the expression of the derivatives we have dui dt n j 1 ai j uj a 1 j u 1 an j un 1 ui ui therefore we have ui t ui 0 e t 0 whenever ui 0 0 our last preliminary result indicates that if the ability of species i is strictly larger than the ability of species j to exploit resources of either type then species j is driven to extinction when starting with a positive density of each species the intuition behind this result is that the fitness of species i which is a function of the configuration of species is always strictly larger than the fitness of species j regardless of the configuration of the system lemma 3 assume that ai k aj k for all k 1 2 n then lim t uj t 0 whenever u 0 u 1 0 un 0 s n proof since s n is positive invariant according to lemma 2 we have n m 1 um t 1 and ui t 0 1 for all i 1 2 n using in addition that each column of m has at least one positive entry we obtain n m 1 am k um t 0 and min 1 m n am k n m 1 am k um t max 1 m n am k in particular defining fi j n k 1 ai k aj k uk a 1 k u 1 an k un and i j min 1 k n ai k aj k max 1 m n am k and using that ai k aj k for all k 1 2 n we get d dt ui uj ui uj fi j ui uj n k 1 ai k aj k uk max 1 m n am k ui uj i j since i j 0 it follows that lim t uj t uj 0 ui 0 lim t exp i jt 0 this completes the proof the role of space in the exploitation of resources 9 the nonspatial two type model recall that in the presence of n 2 species there are only three possible types of interactions cooperation competition and cheating interestingly the nonspatial model also exhibits exactly three types of long term behaviors which are directly connected to the type of relationship between the species more precisely we have the following results cheating implies victory of the cheater competition implies bistability and cooperation implies coexistence to prove these results we first recall that du 1 dt a 1 2 a 1 2 u 1 a 2 2 u 2 a 2 1 a 1 1 u 1 a 2 1 u 2 u 1 u 2 du 2 dt a 2 2 a 1 2 u 1 a 2 2 u 2 a 1 2 a 1 1 u 1 a 2 1 u 2 u 1 u 2 6 by invoking the positive invariance of the set s 2 we obtain u 2 1 u 1 so the model 6 can be simply reduced to the one dimensional ordinary differential equation du 1 dt a 1 2 a 1 2 u 1 a 2 2 1 u 1 a 2 1 a 1 1 u 1 a 2 1 1 u 1 u 1 1 u 1 7 by setting the right hand side of 7 equal to zero we find three solutions for u 1 namely the two trivial solutions u 1 0 and u 1 1 and the nontrivial solution u 1 a 2 1 a 1 2 a 2 2 a 1 2 a 2 1 a 1 1 a 2 1 a 1 2 a 2 2 8 to express the equilibria of 6 we also let u 2 1 u 1 a 1 2 a 2 1 a 1 1 a 1 2 a 2 1 a 1 1 a 2 1 a 1 2 a 2 2 9 and observe that e 1 2 u 1 u 2 0 1 2 if and only if a 1 1 a 2 1 and a 2 2 a 1 2 or a 1 1 a 2 1 and a 2 2 a 1 2 10 note that the first condition in 10 indicates that both species cooperate whereas the second condition indicates that they compete in conclusion the nonspatial two type model 6 always has e 1 1 0 and e 2 0 1 as its two trivial equilibria in the presence of either cooperation or competition there is a third nontrivial equilibrium given by e 1 2 u 1 u 2 we now investigate the global stability of these three equilibria in details theorem 4 global dynamics for the mean field model 6 we have 1 species 1 is a cheater if a 1 1 a 2 1 and a 1 2 a 2 2 then e 1 is globally stable e 2 is unstable and there is no interior equilibrium 2 species 2 is a cheater if a 1 1 a 2 1 and a 1 2 a 2 2 then e 1 is unstable e 2 is globally stable and there is no interior equilibrium 3 competition if a 1 1 a 2 1 and a 2 2 a 1 2 then the interior equilibrium e 1 2 is unstable whereas the trivial equilibria e 1 and e 2 are locally asymptotically stable and the system converges to e 1 whenever u 1 0 u 1 and to e 2 whenever u 1 0 u 1 10 y kang and n lanchier 4 cooperation if a 1 1 a 2 1 and a 2 2 a 1 2 then the interior equilibrium e 1 2 is globally stable whereas the trivial equilibria e 1 and e 2 are unstable proof the first two statements follow directly from lemma 3 and the fact that none of the two conditions in 10 holds to prove the last two statements we first observe that 10 holds in both cases therefore we have e 1 2 0 1 2 and the global stability of the equilibria can be determined by looking at the global stability of their analog for the system 7 now letting h u 1 a 1 2 a 1 2 u 1 a 2 2 1 u 1 a 2 1 a 1 1 u 1 a 2 1 1 u 1 u 1 1 u 1 the stability of u 1 0 1 u 1 are determined by the sign of h 0 a 1 2 a 2 2 a 2 2 h 1 a 2 1 a 1 1 a 1 1 and h u 1 a 2 1 a 1 1 a 1 2 a 2 2 a 1 2 a 1 1 a 2 1 a 2 1 a 2 2 a 1 2 a 1 1 a 2 2 a 1 2 a 2 1 2 respectively it is then straightforward to conclude that 1 when a 1 1 a 2 1 and a 2 2 a 1 2 the trivial equilibria 0 and 1 are locally stable while the nontrivial equilibrium u 1 is unstable returning to the mean field model 6 and using that the set s 2 is positive invariant we deduce that lim t u 1 t u 2 t e 1 when u 1 0 u 1 e 2 when u 1 0 u 1 2 when a 1 1 a 2 1 and a 2 2 a 1 2 the trivial equilibria 0 and 1 are unstable while the nontrivial equilibrium u 1 is stable returning to the mean field model 6 and using that s 2 is positive invariant we deduce that for any initial condition in s 2 we have lim t u 1 t u 1 and lim t u 2 t u 2 this completes the proof of the theorem note that the results of theorem 4 can simply be expressed in terms of the relative ability of each species to exploit the resource it produces defined as 1 a 1 1 a 1 1 a 2 1 and 2 a 2 2 a 1 2 a 2 2 11 since species i is a cooperator whenever i 1 2 and a defector whenever i 1 2 for a summary of the results of theorem 4 we refer the reader to the right hand picture of figure 3 where the phase diagram of the nonspatial two type model is represented in the 1 2 plane the nonspatial three type model note that in the presence of three species a species can not simply be classified as a cooperator or a defector since it can behave as a cooperator with respect to one species but as a defector with respect to another species this aspect gives rise to very rich dynamics in particular while cooperation is the only mechanism that leads to coexis tence in communities with two species there are additional mechanisms that promote coexistence the role of space in the exploitation of resources 11 when a third species is introduced in this subsection we first look at the local stability of the trivial boundary equilibria and the nontrivial boundary equilibria when they exist based on the analysis of the local stability of the boundary equilibria we conclude the subsection with general conditions for global coexistence of all three species these analytical results will be used later as a guide to perform numerical simulations of the spatial model in specific parameter regions in order to understand the role of space on the global dynamics for simplicity and to fix the ideas we state some of our results assuming that some species play particular roles in the interactions but additional results can be deduced by replacing 1 2 3 with 1 2 3 where is any of the six permutations of the group s 3 to start our analysis of the nonspatial three type model we recall that the mean field model with three species is given by dui dt fi u ai 1 u 1 a 1 1 u 1 a 2 1 u 2 a 3 1 u 3 ai 2 u 2 a 1 2 u 1 a 2 2 u 2 a 3 2 u 3 ai 3 u 3 a 1 3 u 1 a 2 3 u 2 a 3 3 u 3 1 ui gi u ui 12 where i 1 2 3 note that since the set s 3 is positive invariant the mean field model 12 can be reduced by letting u 3 1 u 1 u 2 to the following two dimensional system dui dt fi u ai 1 u 1 a 1 1 u 1 a 2 1 u 2 a 3 1 1 u 1 u 2 ai 2 u 2 a 1 2 u 1 a 2 2 u 2 a 3 2 1 u 1 u 2 ai 3 1 u 1 u 2 a 1 3 u 1 a 2 3 u 2 a 3 3 1 u 1 u 2 1 ui gi u ui 13 where i 1 2 note also that the analysis of the two type nonspatial model in the previous subsection directly gives the expression of the boundary equilibria of the three type nonspatial model as well as the conditions under which these equilibria indeed exist there are always three trivial boundary equilibria given by e 1 1 0 0 e 2 0 1 0 and e 3 0 0 1 respectively by setting the right hand side of the three equations in 12 equal to zero we find three additional solutions namely e 1 2 u 1 2 u 2 1 0 e 2 3 0 u 2 3 u 3 2 and e 3 1 u 1 3 0 u 3 1 where for all i 6 j the density u i j is given by u i j aj i ai j aj j ai j aj i ai i aj i ai j aj j according to 10 for j i 1 mod 3 the solution ei j is indeed a nontrivial boundary equilibrium in the sense that both densities u i j and u j i lie in the interval 0 1 if and only if ai i aj i and aj j ai j or ai i aj i and aj j ai j 12 y kang and n lanchier the next theorem shows the following connection between the three type and two type nonspatial models when one species say species 1 has a strictly higher ability than another species say species 3 to exploit resources of either type species 3 goes extinct and species 1 and 2 interact as described by the two type model 6 just as in the absence of type 3 theorem 5 assume that a 1 k a 3 k for all k 1 2 3 then for any initial condition taken in the positive invariant set s 3 we have the following alternative 1 species 1 is a cheater if a 1 1 a 2 1 and a 1 2 a 2 2 then the trajectory converges to e 1 2 species 2 is a cheater if a 1 1 a 2 1 and a 1 2 a 2 2 then the trajectory converges to e 2 3 competition if a 1 1 a 2 1 and a 2 2 a 1 2 then the trajectory of 12 converges to either e 1 or e 2 depending on the initial condition 4 cooperation if a 1 1 a 2 1 and a 2 2 a 1 2 then the trajectory of 12 converges to e 1 2 proof in view of lemma 3 and the fact that the set s 3 is positive invariant for any 0 there exists a time t 0 that only depends on and the initial condition such that u 3 t and u 1 t u 2 t 1 for all t t in other words any trajectory starting in s 3 is trapped after a finite time into the set s 3 u 1 u 2 u 3 0 1 3 u 1 u 2 u 3 1 and u 3 the main idea of the proof is to use the fact that after entering the set s 3 the three type system behaves similarly to the two type system 6 when the parameter is sufficiently small and then to apply theorem 4 since all four cases can be treated similarly we only provide the details of the proof for the first case by applying the chain rule we obtain d dt u 1 u 2 u 1 u 2 3 k 1 a 1 k a 2 k uk a 1 k u 1 a 2 k u 2 a 3 k u 3 u 1 u 2 2 k 1 a 1 k a 2 k uk max 1 m 3 am k a 1 3 a 2 3 u 3 a 1 3 u 1 a 2 3 u 2 a 3 3 u 3 then we distinguish two cases 1 if a 1 3 a 2 3 then lemma 3 implies that limt u 2 0 2 if a 1 3 a 2 3 then using that a 1 k 0 for all k 1 2 3 we obtain a 1 3 u 1 t a 2 3 u 2 t a 3 3 u 3 t a 1 3 u 1 t a 2 3 u 2 t 1 min a 1 3 a 2 3 for all times t t therefore we have d dt u 1 u 2 u 1 u 2 min k 1 2 a 1 k a 2 k 1 max 1 m 3 am k a 1 3 a 2 3 1 min a 1 3 a 2 3 since can be arbitrary small and a 1 k a 2 k 0 for k 1 2 we have limt u 2 0 the role of space in the exploitation of resources 13 in both cases the trajectory converges to e 1 this completes the proof to identify general conditions for tristability on the one hand and coexistence of all three species on the other hand we now look at the local stability of the trivial boundary equilibria theorem 6 local stability of e 1 we have the following alternative 1 if a 1 1 a 2 1 and a 1 1 a 3 1 then e 1 is a sink i e e 1 is locally asymptotically stable 2 if a 1 1 a 2 1 and a 1 1 a 3 1 then e 1 is a source 3 if a 2 1 a 1 1 a 3 1 or a 2 1 a 1 1 a 3 1 then e 1 is a saddle node proof the jacobian matrix of the system 12 evaluated at equilibrium e 1 is given by je 1 0 a 1 1 a 2 1 a 1 1 a 1 1 a 3 1 a 1 1 0 a 2 1 a 1 1 a 1 1 0 0 0 a 3 1 a 1 1 a 1 1 14 the eigenvalues of 14 are given by 1 0 2 a 2 1 a 1 1 a 1 1 3 a 3 1 a 1 1 a 1 1 with respective eigenspaces e 1 span 1 0 0 e 2 span 1 1 0 e 3 span 1 0 1 in particular for j 2 3 species j can invade species 1 in the invariant manifold u 1 uj 1 whenever a 1 1 aj 1 while it cannot whenever a 1 1 aj 1 the three statements follow from theorem 6 one deduces immediately a general condition under which the nonspatial three type system is tristable which is given by corollary 7 below more importantly this theorem allows to identify situations in which there is strong coexistence of all three species in terms of permanence of the system whereas any two species cannot coexist in the absence of the third one this indicates in particular that in the presence of three species coexistence is possible even in the absence of global cooperation thus the existence of additional mechanisms that promote coexistence while the number of species increases a more detailed discussion about this important result which is stated below in theorem 8 is given at the end of this section corollary 7 tristability all three trivial boundary equilibria e 1 e 2 and e 3 are simultaneously locally asymptotically stable whenever ai i aj i for all i 6 j proof this follows directly from theorem 6 numerical simulations further indicate that under the conditions of corollary 7 for almost all initial conditions i e all initial conditions excluding the ones that belong to a set with lebesgue measure zero the system 12 converges to one of the three trivial boundary equilibria the limiting behavior of the system depends on both the parameters and the initial condition 14 y kang and n lanchier theorem 8 heteroclinic cycle if the following inequalities hold a 3 1 a 1 1 a 2 1 a 1 2 a 2 2 a 3 2 a 2 3 a 3 3 a 1 3 15 then there is a heteroclinic cycle connecting e 1 e 2 e 3 e 1 moreover the heteroclinic cycle is locally asymptotically stable whenever a 1 1 a 2 1 a 3 1 2 a 2 2 a 1 2 a 3 2 2 a 3 3 a 1 3 a 2 3 2 16 while the heteroclinic cycle is repelling whenever a 1 1 a 2 1 a 3 1 2 a 2 2 a 1 2 a 3 2 2 a 3 3 a 1 3 a 2 3 2 17 which implies that the system 12 is permanent i e there exists a compact interior attractor that attracts all points in the positive invariant set s 3 proof by theorem 4 the inequalities in 15 indicate that the system 12 only has the three trivial boundary equilibria as its boundary equilibria moreover from the proof of theorem 6 we know that the transversal eigenvalue at equilibrium ei in direction uj is given by 1 uj duj dt ei gj ei aj i ai i ai i in order to obtain a heteroclinic cycle e 1 e 2 e 3 e 1 each trivial equilibrium ei must have one positive and one negative transversal eigenvalue and they must be arranged in a cyclic pattern in particular 15 is a sufficient condition for the existence of a simple heteroclinic cycle to prove the second part of the theorem we let be a heteroclinic cycle which consists of the three trivial boundary equilibria e 1 e 2 e 3 connected by heteroclinic orbits following the approach of hofbauer and sigmund 7 we define the characteristic matrix of the heteroclinic cycle as the matrix whose entry in row i and column j is the external eigenvalue gj ei this matrix is given by c 0 a 2 1 a 1 1 a 1 1 a 3 1 a 1 1 a 1 1 a 1 2 a 2 2 a 2 2 0 a 3 2 a 2 2 a 2 2 a 1 3 a 3 3 a 3 3 a 2 3 a 3 3 a 3 3 0 then defining v 1 1 1 we have c vt g 1 e 1 g 2 e 1 g 3 e 1 g 1 e 2 g 2 e 2 g 3 e 2 g 1 e 3 g 2 e 3 g 3 e 3 a 2 1 a 3 1 2 a 1 1 a 1 1 a 1 2 a 3 2 2 a 2 2 a 2 2 a 2 3 a 1 3 2 a 3 3 a 3 3 18 by theorem 17 5 1 in hofbauer and sigmund 7 the stability of the heteroclinic cycle can be determined based on the sign of the coordinates of the vector in 18 more precisely the role of space in the exploitation of resources 15 1 if all the coordinates of the vector 18 are positive then the heteroclinic cycle is repelling in this case the system 12 is permanent 2 if all the coordinates of the vector 18 are negative then the heteroclinic cycle is asymp totically stable in s 3 in this case is an attractor of the system 12 this completes the proof under the conditions in 15 there is a weak form of coexistence of the three species in the sense that none of the densities converges to zero however the trajectories may get closer and closer to the boundaries under the additional conditions in 17 there is a strong form of coexistence in the sense that the theorem guarantees that the trajectories are eventually bounded away from the boundaries the limit inferior of each of the three densities is larger than a positive constant to find general conditions under which species coexist as in the two type model due to a cooperative behavior we now look at the stability of the nontrivial boundary equilibria theorem 9 local stability of e 1 2 assume that a 1 1 a 2 1 and a 2 2 a 1 2 or a 1 1 a 2 1 and a 2 2 a 1 2 19 so that u 1 2 0 1 and u 2 1 0 1 according to theorem 4 fix 1 2 2 a 3 1 a 1 1 a 2 1 a 1 2 a 2 2 2 a 3 2 a 1 2 a 2 2 a 2 1 a 1 1 a quantity that we call the invadibility of species 3 then we have the following 1 if a 1 1 a 2 1 and a 22 a 1 2 and 1 2 0 then e 1 2 is locally asymptotically stable in particular species 3 cannot invade species 1 and 2 in their equilibrium 2 if a 1 1 a 2 1 and a 22 a 1 2 and 1 2 0 then e 1 2 is repelling in particular species 3 can invade species 1 and 2 in their equilibrium 3 if a 1 1 a 2 1 and a 22 a 1 2 and 1 2 0 then e 1 2 is a source in particular species 3 can invade species 1 and 2 in their equilibrium 4 if a 1 1 a 2 1 and a 22 a 1 2 and 1 2 0 then e 1 2 is a saddle node in particular species 3 cannot invade species 1 and 2 in their equilibrium proof recall that under the first condition in 19 the nontrivial boundary equilibrium e 1 2 is globally stable cooperation in the two dimensional manifold u 1 u 2 u 3 r u 1 u 2 0 1 and u 1 u 2 1 whereas under the second condition in 19 it is unstable competition in this manifold to have a complete picture of the local stability of e 1 2 and deduce the invadability of species 3 we look at the jacobian matrix associated with the system 12 at point e 1 2 je 1 2 f 1 u 1 e 1 2 f 1 u 2 e 1 2 f 1 u 3 e 1 2 f 2 u 1 e 1 2 f 2 u 2 e 1 2 f 2 u 3 e 1 2 f 3 u 1 e 1 2 f 3 u 2 e 1 2 f 3 u 3 e 1 2 16 y kang and n lanchier to express the coefficients of the matrix we introduce dj a 1 j u 1 a 2 j u 2 a 3 j u 3 e 1 2 a 1 j u 1 2 a 2 j u 2 1 for j 1 2 3 since e 1 2 is a boundary equilibrium g 1 e 1 2 g 2 e 1 2 0 therefore f 1 u 1 e 1 2 a 1 1 a 2 1 d 2 1 a 2 1 2 d 2 2 u 1 2 u 2 1 f 1 u 2 e 1 2 a 1 1 a 2 1 d 2 1 a 2 1 2 d 2 2 u 21 2 f 2 u 1 e 1 2 a 2 2 1 d 2 1 a 1 2 a 2 2 d 2 2 u 22 1 f 2 u 2 e 1 2 a 2 2 1 d 2 1 a 1 2 a 2 2 d 2 2 u 1 2 u 2 1 using that the third coordinate of e 1 2 is equal to zero we also have f 3 u 1 e 1 2 f 3 u 2 e 1 2 0 f 3 u 3 e 1 2 g 3 e 1 2 a 3 1 u 1 2 d 1 a 3 2 u 2 1 d 2 1 note that the determinant of the first 2 2 block of the jacobian matrix je 1 2 is given by f 1 u 1 e 1 2 f 2 u 2 e 1 2 f 1 u 2 e 1 2 f 2 u 1 e 1 2 0 while the trace of the matrix is given by f 1 u 1 e 1 2 f 2 u 2 e 1 2 a 2 1 a 1 1 a 2 1 d 2 1 a 1 2 a 2 2 a 1 2 d 2 2 u 1 2 u 2 1 from which we deduce that the eigenvalues are given by 1 0 2 a 2 1 a 1 1 a 2 1 d 2 1 a 1 2 a 2 2 a 1 2 d 2 2 u 1 2 u 2 1 and 3 a 3 1 u 1 2 d 1 a 3 2 u 2 1 d 2 1 the eigenspace associated with the eigenvalue 0 is given by span e 1 2 since the second eigenvalue only depends on the first 2 2 block of the matrix we expect that the associated eigenspace is spanned by 1 1 0 to prove this assertion with a minimum of calculation we observe that f 1 u 1 e 1 2 f 2 u 1 e 1 2 f 3 u 1 e 1 2 f 1 u 1 e 1 2 f 2 u 1 e 1 2 0 since f 1 f 2 f 3 0 it follows that 1 u 2 1 f 1 u 1 e 1 2 1 u 2 1 f 2 u 1 e 1 2 a 1 1 a 2 1 d 2 1 a 2 1 2 d 2 2 u 1 2 a 2 2 1 d 2 1 a 1 2 a 2 2 d 2 2 u 2 1 0 in particular recalling that 2 is the trace of the first 2 2 block f 1 u 1 e 1 2 f 1 u 2 e 1 2 a 1 1 a 2 1 d 2 1 a 2 1 2 d 2 2 u 1 2 a 1 1 a 2 1 d 2 1 a 2 1 2 d 2 2 u 1 2 u 2 1 a 2 2 1 d 2 1 a 1 2 a 2 2 d 2 2 u 2 1 u 1 2 2 the role of space in the exploitation of resources 17 similarly we prove that f 2 u 1 e 1 2 f 2 u 2 e 1 2 f 1 u 1 e 1 2 f 2 u 2 e 1 2 2 therefore the eigenspace associated with the eigenvalue 2 is spanned by 1 1 0 the sign of this eigenvalue thus indicates the stability of e 1 2 in the invariant manifold u 1 u 2 1 and as expected we find the same conditions as in the case n 2 given in 19 rather than computing explicitly the third eigenspace we notice that all three eigenvectors form a basis of the three dimensional euclidean space this together with the expression of the first two eigenvectors implies that the third coordinate of the eigenvector associated with the eigenvalue 3 is different from zero in particular the sign of 3 indicates whether e 1 2 is repelling or not in the direction of e 3 to study the sign of this eigenvalue we first observe that by definition of e 1 2 a 2 1 a 1 2 u 1 2 a 2 2 u 2 1 a 1 2 a 1 1 u 1 2 a 2 1 u 2 1 which allows to simplify the expression of 3 and obtain sign 3 sign 2 a 1 2 a 3 1 u 1 2 2 a 2 1 a 3 2 u 2 1 a 1 2 a 1 1 a 2 1 u 1 2 a 2 1 a 1 2 a 2 2 u 2 1 sign a 1 2 2 a 3 1 a 1 1 a 2 1 u 1 2 a 2 1 2 a 3 2 a 1 2 a 2 2 u 2 1 sign 1 2 a 1 2 a 2 1 a 1 1 a 2 1 a 1 2 a 2 2 the result then follows directly from the previous equation and theorem 4 even though the four conditions in theorem 9 are somewhat complicated to understand due to the expression of 1 2 they can be used to deduce sufficient conditions that are more meaningful from an ecological point of view since species 3 can invade species 1 and 2 in their equilibrium when species 1 and 2 cooperate and 1 2 0 or when species 1 and 2 compete and 1 2 0 we obtain that a sufficient condition for invadability is given by a 3 1 a 1 1 a 2 1 2 and a 3 2 a 1 2 a 2 2 2 in other words species 3 can invade species 1 and 2 in their equilibrium whenever its ability to exploit resource of type 1 respectively 2 is larger than the average ability of the two other species to exploit this resource the last theorem which is partly based on theorems 8 9 gives general sufficient conditions under which strong coexistence of all three species is possible in the sense that the three type system is permanent for more convenience we distinguish four cases depending on the number of nontrivial boundary equilibria we only give particular conditions but as point out above additional conditions can be deduced by replacing 1 2 3 with 1 2 3 where is any of the six permutations of the group s 3 theorem 10 coexistence let denote the set of nontrivial boundary equilibria if conditions in one of the following four cases hold then the system is permanent 0 with it suffices that conditions 15 and 17 hold 1 with e 1 2 it suffices that 1 2 0 and a 3 1 a 1 1 a 2 1 a 2 2 min a 3 2 a 1 2 a 2 3 a 3 3 a 1 3 20 18 y kang and n lanchier 2 with e 1 2 e 2 3 it suffices that min 1 2 2 3 0 and a 3 1 a 1 1 a 2 1 a 2 2 min a 3 2 a 1 2 a 3 3 min a 1 3 a 2 3 21 3 with e 1 2 e 2 3 e 3 1 it suffices that min 1 2 2 3 3 1 0 and a 1 1 min a 2 1 a 3 1 a 2 2 min a 3 2 a 1 2 a 3 3 min a 1 3 a 2 3 22 proof permanence of the system under conditions 0 is simply theorem 8 that we repeat here to have a summary of all the coexistence results since permanence can be proved similarly under the other three conditions we only focus on the last case when there are three nontrivial boundary equilibria the proof is based on an application of theorem 2 5 in hutson 10 first we introduce the function p u 1 u 2 u 3 u 1 u 2 u 3 and observe that this function is equal to zero on the boundary of s 3 and strictly positive in the interior of s 3 which makes p an average lyapunov function of the system 12 from the expression of the derivatives in 12 we then obtain 1 p dp dt 1 u 1 u 2 u 3 du 1 dt u 2 u 3 du 2 dt u 3 u 1 du 3 dt u 1 u 2 g 1 g 2 g 3 by theorem 4 the condition 22 implies that the limit sets of the boundary of s 3 consists of the six trivial and nontrivial boundary equilibria therefore in order to prove that the system is permanent it suffices to prove according to theorem 2 5 in hutson 10 that the function evaluated at each of the six boundary equilibria is positive we conclude by observing that g 1 g 2 g 3 ei aj i ak i 2 ai i ai i 0 g 1 g 2 g 3 ei j 2 ak i ai i aj i ai j aj j 2 ak j ai j aj j aj i ai i ai j aj i ai i aj j i j ai j aj i ai i aj j 0 for all i 6 j provided i j 0 and the conditions in 22 hold each of the four sets of conditions in theorem 10 which describes the local dynamics at each boundary equilibrium as well as all additional cases that can be deduced from a permutation of the three species imply that the system is permanent however the theorem does not specify whether there are indeed matrices that satisfy these conditions that might be conflicting to have a complete picture of the coexistence region of the three type nonspatial model the last step is to identify four matrices that satisfy the conditions of theorem 10 and collect all the configurations of local dynamics at the boundary that might also produce permanence of the system the four particular scenarios described in theorem 10 are illustrated in a schematic manner by the four pictures in the first row of figure 1 the second row gives the solution curves of the system when the dynamics are described by each of the following four matrices and it is straightforward to check that these matrices indeed satisfy each of the four sets of conditions of the theorem m 0 1 0 4 4 1 0 0 4 1 m 1 1 1 2 2 0 0 0 8 1 m 2 1 1 2 2 0 1 0 4 0 m 3 1 2 2 2 1 2 2 2 1 the role of space in the exploitation of resources 19 3 2 1 3 2 1 3 2 1 3 2 1 3 2 1 3 2 1 3 2 1 3 2 1 figure 1 the four possible scenarios to look for all the possible local stability at the boundary equilibria that might produce permanence of the system we first observe that whenever two species say species 1 and 2 cooperate with each other but are defectors with respect to species 3 we have a 3 1 a 1 1 a 2 1 and a 3 2 a 2 2 a 1 2 which directly implies that 1 2 0 therefore species 3 cannot invade species 1 and 2 in their equilibrium similarly when species 1 and 2 compete with each other but are cooperators with respect to species 3 we always have the condition 1 2 0 this implies that the first two pictures of figure 2 that describe the local stability of the two trivial boundary equilibria e 1 and e 2 and the nontrivial boundary equilibrium e 1 2 cannot occur using the two previous observations and the fact that it is necessary in order to have permanence of the system that none of the boundary equilibria is locally stable simple graphical methods lead to only five possible scenarios plus again the ones that can be deduced from a permutation of the three species these five scenarios are the ones depicted in the first row of figure 1 and in the last picture of figure 2 but we claim that the boundary dynamics shown in this last picture are conflicting to establish this result we observe that the local stability at the three trivial boundary equilibria leads to a 2 1 a 1 1 a 3 1 a 1 2 a 2 2 a 3 2 a 3 3 min a 1 3 a 2 3 23 to check whether e 2 3 can be a saddle node we compute 2 3 2 a 1 2 a 2 2 a 3 2 a 2 3 a 3 3 2 a 1 3 a 2 3 a 3 3 a 3 2 a 2 2 2 a 1 2 a 2 2 a 3 2 a 2 3 a 3 3 2 a 1 3 2 a 2 3 a 2 3 a 3 3 a 3 2 a 2 2 2 a 2 3 a 3 3 a 1 2 a 2 2 2 a 3 2 a 2 2 a 1 3 a 2 3 20 y kang and n lanchier 3 2 1 3 2 1 3 2 1 figure 2 impossible pictures in particular under the conditions 23 e 2 3 is a saddle node if and only if 2 3 0 which in view of the signs of the first three factors requires that a 1 3 a 2 3 we prove similarly that for the nontrivial boundary equilibrium e 3 1 to be a saddle node it is necessary that a 1 3 a 2 3 therefore the two equilibria cannot both be saddle nodes in conclusion not only the four pictures in the first row of figure 1 are possible but also they are the only ones that lead to coexistence summary of the results we conclude this section with a brief overview of the analytical results collected for the nonspatial two type and three type models the two type model in the presence of only two species a defector always outcompetes a coop erator more generally regardless of the size of the community a species that has a higher ability than all other species to exploit resources of either type outcompetes the other species due to the fact that it always has the highest fitness regardless of the global species distribution when both species compete in a defector defector relationship then the system is bistable indicating that coexistence is not possible and that the outcome of the competition strongly depends on the initial conditions in contrast two cooperators always coexist motivated by the properties of the two type model our analysis of the three type model focuses on the two extreme cases that also appear later to be the most interesting ones tristability and coexistence tristability in communities involving three species each of the three trivial boundary equilibria is locally stable if and only if all three pairs of species are in defector defector relationship numerical simulations of the nonspatial model suggest that as in the case of bistability for the two type model for almost all initial conditions one species outcompetes the other two ones coexistence and cooperation in contrast if none of the three pairs of species is in a competition relationship coexistence is possible in particular as in the two type model coexistence occurs in situations in which any two species cooperate however we point out that whereas in the two type model cooperation implies coexistence global cooperation alone does not imply coexistence of three species since additional invadability conditions are required even though we omit the details of the proof here it can be easily seen that if the cooperation between two species is significantly stronger than the cooperation between any of these two species and the third one then one of the nontrivial boundary equilibrium becomes locally stable indeed it suffices to take the matrix with zeros on the diagonal with a 1 2 a 2 1 2 and with ones elsewhere numerical simulations further indicate that the two strong cooperators outcompete the third species hence that any two species coexist in the absence of the third one does not imply coexistence of all three species coexistence of cheaters one of the most interesting aspects of the nonspatial model is that whereas in the presence of two species cooperation is the only mechanism that promotes coexistence the role of space in the exploitation of resources 21 in the presence of three species there are other such mechanisms in particular three cheaters can coexist this happens when each species is a defector with respect to a second species but a cooperator with respect to the third species a situation that we shall call rock paper scissors type relationship to draw another analogy with game theory when scissors are minoritary paper beats rock and increases its density until the environment becomes suitable enough for scissors to expand again and so on in particular that any two species cannot coexist does not imply that global coexistence is not possible in rock paper scissors relationships there is always a weak form of coexistence in the sense that none of the species is driven to extinction however the densities can be alternately arbitrarily low and as in situations in which species cooperate strong coexistence in the form of permanence of the system requires additional conditions coexistence and competition finally assuming that two species compete leads to the existence of at least one locally stable boundary equilibrium in other words whenever two species compete all three species cannot coexist in the sense that the system is not permanent there are only four boundary dynamics along with the ones deduced from a permutation of the three species that lead to strong coexistence the four dynamics depicted in the first row of figure 1 therefore coexistence can only occur when all pairs of species are either in a defector cooperator relationship or cooperator cooperator relationship and the coexistence region covers all the cases where the number of cooperative pairs ranges from zero to three regardless of the number of nontrivial boundary equilibria permanence of the system is possible in conclusion coexistence occurs either in the presence of a global cooperation or in the presence of a rock paper scissors type dynamics or dynamics that consist of a mixture of these two extreme cases 4 analytical results for the spatial stochastic model this section collects important analytical results for the two type spatial model we focus on the meaning of these results and only give an intuitive idea of the mathematical proofs for a rigorous analysis of the two type spatial model we refer the reader to lanchier 11 as previously we explore the phase diagram in the 1 2 plane where i defined in 11 measures the relative ability of species i to exploit the resource it produces therefore species i is a cooperator or a defector depending on whether the parameter i is smaller or larger than one half the one dimensional two type process to understand the one dimensional model we first initiate the process from the deterministic configuration in which all sites to the left of site 0 including site 0 are of type 1 and all the other sites are of type 2 the evolution rules imply that at the times the rightmost site of type 1 respectively leftmost site of type 2 is updated the probability that the site to be updated switches to the other type is given by a 2 1 a 1 1 a 2 1 1 1 and a 1 2 a 1 2 a 2 2 1 2 respectively since in addition all lattice sites are updated at the same rate we deduce that the interface between both types drifts to the left or to the right depending on whether 1 is smaller or larger than 2 respectively therefore when 1 2 species 2 wins which is defined for the stochastic process as the fact that any lattice site is eventually of type 2 i e lim t p t x 2 1 for all x z 24 22 y kang and n lanchier similarly when 1 2 species 1 wins standard techniques further imply that the same conclusion holds when starting from a configuration with infinitely many individuals of both types which includes all configurations in which the types at different sites are independent and identically distributed and in which both types occur with positive probability to understand the neutral case 1 2 we initiate the stochastic process from the configuration in which sites are independently of type 1 and of type 2 with the same probability we note that excluding the case 1 2 1 in which the process is static the set of interfaces defined as the random set of points in the dual lattice z 1 2 that lie between two different types evolves almost like a system of independent annihilating symmetric random walks more precisely each interface jumps one unit to the left or one unit to the right with equal probability except when two interfaces are distance one apart moreover when an interface jumps to another interface both interfaces annihilate using that symmetric random walks are recurrent in one dimension it is straightforward to conclude that the set of interfaces goes extinct this translates into a clustering of the process which is defined as the fact that the probability that two lattice sites have different types tends to 0 as time goes to infinity i e lim t p t x 6 t y 0 for all x y z 25 the behavior of the one dimensional process can thus be summarized as follows theorem 11 assume that d 1 then 1 excluding the static case 1 2 1 the process clusters 2 assume that 1 6 2 then type i with i max 1 2 wins we refer the reader to 11 section 2 for a rigorous proof of these two statements in contrast with the predictions based on the mean field approximation theorem 11 indicates that except in the trivial case when the process is static coexistence is never possible in one dimension even when both species cooperate strongly by providing resources that increase the fitness of the other species moreover while the mean field model exhibits bistability when both species are defectors the spatial model always has a dominant type when 1 6 2 that is a type that wins even when starting at very low density this dominant species is always the least cooperative one the most interesting behavior appears in the neutral case when the set of interfaces is roughly a collection of symmetric annihilating random walks results conjectured by erdo s and ney 6 and proved later by schwartz 16 show that such a system is site recurrent meaning that even though the set of interfaces goes extinct due to recurrent annihilations each site of the dual lattice is visited infinitely often by an interface this indicates that the type at each site alternates infinitely often thus giving the impression of coexistence however coexistence is not strictly speaking possible in the sense that there is no equilibrium in which both types are present except in the static case there are only two stationary distributions namely the ones that correspond to the configurations in which all sites are of type 1 or all sites are of type 2 the two dimensional two type process the analysis of the two dimensional process is more difficult since due to the geometry of the spatial structure it cannot be reduced to a simple analysis of the interfaces the idea is to look at key particular cases and then apply standard probabilistic techniques such as coupling argument block construction and perturbation argument to obtain additional information about the process further insight for the two dimensional process will be the role of space in the exploitation of resources 23 gained through numerical simulations however we point out that our analytical results easily extend to any dimension d 1 precisely we focus on the two dimensional two type stochastic model when the parameters are given by each of the following four matrices m 4 1 0 1 m 5 1 1 1 1 m 6 0 1 1 0 m 7 0 1 1 1 where the parameter will be typically chosen small and positive these four matrices represent key points of the phase diagram from which we can deduce using either monotonicity symmetry or perturbation arguments the behavior of the process in larger parameter regions first we assume that the local interactions are described by the matrix m 4 this case can be seen as a case where species 2 is an extreme defector as the second column indicates that this species produces resources that are exploited by its own species only hence sites of type 2 never change their type in contrast each individual of type 1 has a positive probability to change its type at each update provided it has at least one neighbor of type 2 thinking of site of type 2 as occupied and sites of type 1 as empty the process becomes a pure birth process so it is obvious that type 2 wins standard arguments allow to extend the result to a certain topological neighborhood of the parameter matrix m 4 therefore we obtain the following result theorem 12 for all 1 1 there exists 1 such that type 2 wins whenever 2 1 we refer the reader to 11 section 4 for more details about the proof by symmetry we also find a parameter region in which individuals of species 1 outcompete individuals of species 2 note that theorem 12 holds even when species 2 starts at a very low density which shows a new disagreement between spatial and nonspatial models similarly to the one dimensional process there is a parameter region in which species 2 is the dominant species for the spatial model whereas the mean field model is bistable assuming now that the dynamics are dictated by the matrix m 5 with 0 the resources are equally shared by both types so the new type at each update is simply chosen uniformly at random from the neighborhood this process is known as the voter model introduced in 1 8 there exists a duality relationship between the voter model and coalescing random walks that allows to prove that clustering occurs in the sense of 25 in one and two dimensions whereas there exists a stationary distribution in which both types coexist in higher dimensions taking 0 in the second matrix a similar duality relationship between the process and a certain system of random walks allows to show that type 2 wins this result is expected since in this case species 2 is a cheater it has a higher ability than species 1 to exploit resources of either type since this holds for arbitrarily small parameter 0 and the probability that species 2 outcompetes species 1 is nonincreasing with respect to 1 and nondecreasing with respect to 2 we obtain the following result theorem 13 assume that 1 1 2 2 then in any dimension type 2 wins we refer to section 3 in 11 for a rigorous proof of this theorem by symmetry an analogous result can be deduced by exchanging the role of species 1 and 2 in particular theorem 13 shows that in any spatial dimension if one species is a cooperator and the other species a defector which results in the presence of a cheater then the cheater is always the dominant species this agrees with the predictions based on the mean field model the analytical results obtained when the interactions are described by the last two matrices are more interesting from a biological perspective first we observe that when the parameters are 24 y kang and n lanchier given by the matrixm 6 individuals of either type change their type at each update whenever there is at least one individual of the other type in their neighborhood which in contrast with the voter model leads to dynamics that somewhat favor the local minority this corresponds to a case of extreme cooperation in which each type only provides resources to the other type this process is known as the threshold voter model for which liggett 13 has proved that coexistence occurs in any dimension d 1 relying on perturbation techniques coexistence can be extended to a certain topological neighborhood of the matrix m 6 theorem 14 if d 1 then there is 0 such that coexistence occurs when max 1 2 see section 5 in 11 for a proof of this theorem note that while theorem 14 shows that increasing the spatial dimension allows two species to coexist it also requires the cooperation to be strong enough whereas results for the mean field model indicate more generally that cooperation always leads to coexistence interestingly our next result shows that the inclusion of local interactions indeed translates into a reduction of the coexistence region before stating this result we first observe that when the interactions are dictated by the matrix m 7 the process consists of a mixture of a voter model and a threshold voter model at each update type 1 is replaced by type 2 whenever it has at least one type 2 in its neighborhood whereas type 2 is simply replaced by a type chosen uniformly at random from its neighborhood in this case there is again a duality relationship between the process and a certain system of random walks whose analysis reveals that type 2 wins moreover the techniques of the proof allow for the application of a perturbation argument so the same conclusion holds in a certain topological neighborhood of the matrix m 7 which induces the existence of a parameter region for which coexistence occurs for the mean field model but not the spatial model theorem 15 there is 0 such that type 2 wins whenever 1 and 2 1 2 the proof of this theorem can be found in 11 section 6 this result indicates that even though two species cooperate they cannot coexist in space if their relationship has too much asymmetry that is when one species cooperates much more than the other in such situation the dominant species is again the least cooperative one 5 the role of space in order to understand the role of local interactions and stochasticity we confront the analytical results obtained for the nonspatial and spatial models as well as additional numerical results pro vided in this section for the spatial model since numerical simulations of stochastic spatial models are somewhat difficult to interpret we start by devoting few lines to mention important theoreti cal results that justify the approach we have followed to draw general conclusions from particular simulation results numerical and analytical results are used to first obtain a complete picture of the differences between both models when only two species are present we note however that a complete understanding of the stochastic three type model based on simulations is out of reach due to a too large number of parameters our approach is to use the results obtained for the nonspatial model and the spatial two type model as a guide to find certain three dimensional submanifolds of the set of parameters along which interesting behaviors emerge numerical simulations along these manifolds are then performed in order to obtain three dimensional phase diagrams of the models when the set of parameters is restricted to particular subsets the role of space in the exploitation of resources 25 numerical simulations in the numerical simulations of the spatial model the population evolves on a 400 400 lattice with periodic boundary conditions that is sites on the bottom row are neighbors of those on the top row while sites on the left edge are neighbors of those on the right edge in addition the process starts from a uniform product measure meaning that the types at different sites are initially independent and of either type with probability 1 n where n denotes the total number of species so sites are equally likely to be of either type the process always halts after exactly 3 2 108 updates which corresponds to approximately 2000 units of time which is simply obtained by dividing the number of updates by the number of sites and using the fact that each site is updated in average once per unit of time the first difficulty in interpreting correctly these spatial simulations is that the stochastic process on a finite connected graph always converges to a configuration in which all sites have the same type therefore coexistence is not possible on a 400 400 lattice whereas our analytical results show that two types can coexist on the infinite lattice however rigorous research in the topic of interacting particle systems indicates that in the presence of a dominant type this type typically invades space linearly in all the directions in contrast analytical results notably about the voter model on the torus 2 show that in the absence of a dominant type the time to fixation of the process on large but finite graphs is sufficiently large that numerical simulations indeed reflect a transient behavior of the finite system that is symptomatic of the long term behavior of its infinite analog in particular it is accurate to define a dominant type as a type which is able to invade our finite lattice in less than 2000 units of time while starting from a low density the second difficulty is that the absence of a dominant type as defined above namely the simul taneous survival of at least two types up to time 2000 is not always symptomatic of coexistence for the infinite analog the reason is that as proved in 2 for the voter model in case the infinite system clusters the time to fixation of its finite analog is excessively large which gives the im pression of coexistence whereas different types cannot coexist at equilibrium even for the infinite system however spatial correlations emerge quickly enough so that properties of the configuration of the finite system at time 2000 allow to speculate about the infinite system more precisely in the absence of a dominant type the dichotomy between clustering and coexistence will be based on a quantity that we shall call clustering coefficient and that we define as the percentage of edges that connect sites of the same type note that the clustering coefficient also gives a good approxi mation of the probability that two nearest neighbors are of the same type to distinguish between clustering and coexistence we invoke a result proved in 3 about the diffusive clustering of the two dimensional voter model which roughly indicates that the clustering of the process is extremely slow and motivates the use of the voter model as a test model numerical simulations of the voter model which is obtained from our general model by choosing a matrix in which all the coefficients are equal give the values 86 and 81 for the clustering coefficient of the two type voter model and three type voter model respectively at time 2000 therefore in the absence of a dominant type we will assume that the infinite system clusters if the clustering coefficient of its finite analog is larger or equal to 86 in the presence of two types and larger or equal to 81 in the presence of three types and that the process coexists otherwise in conclusion the long term behavior of the infinite system is related to the clustering coefficient of its finite analog as follows 1 coexistence occurs when the clustering coefficient of the finite system is smaller than that of the corresponding voter model that is either 86 or 81 2 clustering occurs when the clustering coefficient of the finite system is simultaneously larger than that of the corresponding voter model and different from 100 26 y kang and n lanchier 3 existence of a dominant type occurs when the clustering coefficient is equal to 100 and we again point out that past research in the field of interacting particle systems allows to spec ulate with some confidence about the long term behavior of the infinite system based on numerical simulations and the previous classification the two type models in the presence of two species the dynamics only depends on two parameters namely the relative abilities 1 and 2 of species 1 and 2 respectively to exploit resources of their type therefore the long term behavior of the spatial and nonspatial models can be simply summarized in a two dimensional phase diagram the phase diagrams of the spatial and nonspatial models are depicted on the left hand side and right hand of figure 3 the phase diagram of the nonspatial model is completely understood analytically whereas the one of the spatial model is obtained from a combination of analytical and numerical results labels on the parameter regions surrounded with dashed lines refer to the theorems of section 4 in both diagrams the different phases are delineated with thick continuous lines and we distinguish three cases presence of a cheater in defector cooperator relationships in which case we call the defector a cheater analytical results for both the spatial and the nonspatial models indicate that the cheater outcompetes the other species see theorems 4 and 13 the intuition behind this result is that since the cheater has a better ability to exploit resources of either type its fitness is always higher than the fitness of the other species regardless of the configuration of species therefore even when starting at very low density the cheater always wins space and competition in the presence of competition which we defined as the relationship between two defectors analytical results for the nonspatial deterministic model indicate that the system is bistable see theorem 4 that is the limiting behavior depends on the combination of both the parameter values and the initial densities the parameters being fixed provided the initial density of either species exceeds some critical threshold this species outcompetes the other species in contrast analytical results for the spatial model see theorem 12 reveal the existence of parameter regions in which there is a dominant type that outcompetes the other species regardless of the initial configuration provided it starts with a positive density numerical results for the spatial model further indicate that when 1 6 2 there is a dominant type which is uniquely determined by the parameters of the system the dominant type is always the least cooperative species see the upper panel of table 1 additional simulations have been performed to check that this type indeed outcompetes the other species even when it initially occupies only 5 of the lattice sites in the neutral case the system clusters the spatial correlations become stronger and stronger and the boundaries of the clusters sharper and sharper as the common value of the relative ability of both species to exploit their own resources increases observing in addition that under neutrality the number of lattice sites of a given type in the finite system is a martingale it can be proved that the probability that this type wins is simply equal to its initial density we now give a heuristic argument of the reason why competition translates into bistability in the absence of space whereas excluding the neutral case the dominant type is uniquely determined by the parameters of the system in the presence of a spatial structure we first observe that if a species has a very high ability to exploit the resources it produces but a poor ability to exploit the other resources then in the absence of space the fitness of this species is roughly proportional to its density therefore in the presence of competition species at low density have a negative growth rate and species at high density a positive growth rate which implies bistability including space in the form of local interactions drastically modifies the long term behavior of the system due to the fact that individuals can only see their nearest neighbors rather than the whole system the role of space in the exploitation of resources 27 densities and clustering coefficient for the two type model when 1 2 1 2 densities and clustering coefficient for the two type model when 1 2 1 2 1 0 50 1 0 55 1 0 60 1 0 65 1 0 70 1 0 75 1 0 80 1 0 85 1 0 90 1 0 95 2 0 50 2 0 55 2 0 60 2 0 65 2 0 70 2 0 75 2 0 80 2 0 85 2 0 90 2 0 95 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 100 0 100 48 51 95 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 100 0 100 100 0 100 49 50 96 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 100 0 100 100 0 100 100 0 100 50 49 96 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 48 51 97 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 55 44 97 0 100 100 0 100 100 0 100 100 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 46 53 97 0 100 100 0 100 100 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 50 49 97 0 100 100 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 55 44 97 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 51 48 96 1 0 00 1 0 05 1 0 10 1 0 15 1 0 20 1 0 25 1 0 30 1 0 35 1 0 40 1 0 45 2 0 00 2 0 05 2 0 10 2 0 15 2 0 20 2 0 25 2 0 30 2 0 35 2 0 40 2 0 45 50 49 55 46 53 56 43 56 57 38 61 60 32 67 65 23 76 73 4 95 94 0 100 100 0 100 100 0 100 100 52 47 56 50 49 56 46 53 58 41 58 60 35 64 63 26 73 70 11 88 86 0 100 100 0 100 100 0 100 100 56 43 58 53 46 57 50 49 58 45 54 59 39 60 62 31 68 67 17 82 80 0 100 100 0 100 100 0 100 100 61 38 60 58 41 60 54 45 59 49 50 60 43 56 61 36 63 65 24 75 74 0 100 100 0 100 100 0 100 100 67 32 65 64 35 63 60 39 62 56 43 62 50 49 62 41 58 64 30 69 70 6 93 92 0 100 100 0 100 100 76 23 73 73 26 70 68 31 67 63 36 65 57 42 64 49 50 64 38 61 67 20 79 80 0 100 100 0 100 100 95 4 94 88 11 86 82 17 80 76 23 75 69 30 70 61 38 67 50 49 66 33 66 71 0 100 100 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 93 6 93 79 20 79 66 33 71 50 49 68 19 80 82 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 81 18 83 49 50 72 0 100 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 100 0 100 51 48 76 51 48 86 table 1 more precisely since an individual of either type can only appear next to a site already occupied by this type the parent site spatial correlations build up in such a way that the density of individuals of a given type seen by an individual of the same type is in average significantly larger in the interacting particle system than in the mean field approximation regardless of the global densities this fraction of homologous neighbors is roughly the same for both species at the interface between adjacent clusters since in addition the resources produced at a site are only available for the nearest neighbors the global densities become irrelevant in determining the fitness of each individual and interfaces expand linearly in favor of the least cooperative species regardless of its initial density this species is the dominant type space and cooperation in the presence of cooperation analytical results for the nonspatial model predict coexistence of both species see theorem 4 in contrast analytical results for the spatial model indicate that coexistence is never possible in one dimension see theorem 11 in higher dimensions coexistence becomes possible although there are regions in which coexistence occurs for the nonspatial model but not for the spatial model see theorems 14 and 15 numerical simulations of the two dimensional finite system suggest that two cooperative species coexist in the neutral case so the coexistence region of the spatial model stretches up to the point that corresponds to voter model dynamics as previously mentioned analytical results for the voter model show that this critical point is included in the coexistence region if and only if the spatial dimension is strictly larger than two there is however a wide range of parameters for which coexistence is not possible though both species cooperate see the lower panel of table 1 therefore the inclusion of space 28 y kang and n lanchier tvm static coexist cl us te ri ng type 1 12 1 1 2 1 2 1 2 2 0 1 1 2 type 2 unstable interior fixed point interior fixed point no interior fixed point no interior fixed point e 1 unstable e 1 locally stable globally stable e 2 lo ca lly sta b le e 2 u n sta b le type 2 type 1 bistability 1 1 2 1 1 coexistence vm 15 15 13 13 12 14 figure 3 phase diagrams of the spatial and nonspatial two type models translates into a reduction of the coexistence region in any spatial dimension this effect is more pronounced in low dimensions and we strongly believe that the coexistence region of the spatial model approaches the one of the nonspatial model as the dimension tends to infinity the intuition behind the fact that the inclusion of a spatial structure reduces the ability of species to coexist follows the lines of the heuristic argument introduced above in cooperative mean field systems a species at very low density turns out to be in a very favorable environment due to the high density of the other species and so a large amount of resources to exploit the smaller the density of a species the larger the fitness of this species which is a basic mechanism that leads to coexistence of both types in contrast the inclusion of local interactions translates as previously into the presence of spatial correlations that make the density of individuals of a given type seen by an individual of the other type significantly smaller in the interacting particle system than in the mean field approximation therefore in the presence of a spatial structure cooperative species cannot fully benefit from the resources produced by the other species simply because these resources are geographically out of reach under neutrality both species suffer local interactions equally so coexistence is possible but when the parameters get closer to the region where one species is a cheater individuals of the other species are unable to expand whenever they have at least one neighbor of their own type large clusters of this species tend to shrink quickly while small clusters of this species dissolve eventually due to stochasticity note also that the number of neighbors is smaller and so the fraction of neighbors of the same type larger in low dimensions hence the harmful effect of space on coexistence is more pronounced in low dimensions the three type models the analysis of the mean field approximation reveals that in the presence of three species the nonspatial model exhibits a wide variety of regimes however an alytical and numerical results for the spatial two type model indicate that the most interesting behaviors in terms of the inclusion of space emerge in parameter regions for which there is either bistability or coexistence for the mean field approximation therefore we mainly focus on the anal ogous cases for the three type models by investigating the effect of space in regions for which there is either tristability or coexistence of all three species when space is absent we note that whereas the role of space in the exploitation of resources 29 in the presence of two species cooperation is a necessary and sufficient condition for coexistence in a nonspatial universe in the presence of three species there are additional strategies that promote global coexistence for instance coexistence occurs for what we shall call rock paper scissors dy namics in which any two species cannot coexist but all three species can interestingly numerical simulations of the spatial three type model reveal that the inclusion of space does not have the same effect on coexistence depending on the strategies species follow suggesting that some of the strategies that promote coexistence are much more stable than others in the presence of two species each species is either a defector or a cooperator which results in only three types of relationship cheating competition and cooperation introducing an additional species increases significantly the number of types of relationships since a species can be a defector with respect to a second species but a cooperator with respect to the third one as in rock paper scissors dynamics in order to extend to the three type models results obtained for the two type models we first assume that any two species have the same ability to exploit resources produced by the third one so that each species is either a global defector or a global cooperator under this assumption the dynamics only depend on three parameters being described by matrices that belong to the three dimensional manifold that consists of the matrices of the form m 8 2 1 1 2 1 3 1 1 2 2 1 3 1 1 1 2 2 3 note that species i is a defector if i 1 3 and a cooperator if i 1 3 following the same approach as for the two type models and motivated by the analytical results for the nonspatial three type model we distinguish four cases depending on the number of defectors presence of a cheater in case one species is a global defector and the other two species are global cooperators so that the defector is a cheater analytical results for the nonspatial models indicate that the cheater outcompetes the other two species see theorem 5 analytical results for the spatial two type model easily extend to prove that the same holds including space in the form of local interactions the intuition is the exact same as for the two type model the ability of the cheater to exploit resources of either type is larger or equal to the ability of the other two species to exploit the same resource although the cheater has the same ability of any of the other species to exploit the resources produced by the third one since it has a better ability to exploit the resources it produces its fitness is always strictly larger than that of the other species regardless of the configuration of the system presence of two cheaters this case occurs when there are two global defectors and one global cooperator that space is present or not the altruist species is driven to extinction this can be understood based again on the same heuristic argument which indicates that regardless of the configuration of the system the cooperator always has a strictly smaller fitness than the two defectors the long term behavior is therefore similar to that of the two type models in the presence of competition in the mean field model one of the two defectors outcompetes the other one and the limiting densities depend on the combination of the parameter values and the initial densities the system is bistable see theorem 5 in the interacting particle system the dominant type is uniquely determined by the parameter values and is always the least cooperative species in case of a symmetric behavior between both defectors the community clusters space and competition similarly to the two type model the most interesting behaviors emerge when all three species compete or all three species cooperate in the presence of competition that 30 y kang and n lanchier is when all three species are global defectors the mean field model is tristable the trajectories converge to one of the three trivial equilibria in which only one species is present and the limiting densities again depend on both the parameter values and the initial densities numerical simulations of the spatial model see the upper panel of table 2 indicate that the dominant type is again the least cooperative species in case of equality additional behaviors can appear clustering of the two species that have the same highest relative ability to exploit the resources they produce or clustering of all three species in the neutral case the disagreement between both models in the presence of competition follows from the same argument as for the two type models the density of individuals of a given type seen by an individual of the same type is in average significantly larger in the interacting particle system than in the mean field approximation in such a way that global densities become irrelevant and interfaces expand linearly in favor of the species that has the largest relative ability to exploit its own resources i e the least cooperative one coexistence and cooperation recall that in the presence of three species global cooperation alone doe not imply coexistence for the nonspatial model since additional conditions about the nontrivial boundary equilibria are required see statement 3 in theorem 10 however when the dynamics are described by the matrix m 8 one has 1 2 2 a 3 1 a 1 1 a 2 1 a 1 2 a 2 2 2 a 3 2 a 1 2 a 2 2 a 2 1 a 1 1 1 3 1 1 3 2 1 3 2 1 3 1 2 1 3 1 1 3 2 and similar expressions for 2 3 and 3 1 therefore in this special case coexistence occurs in the nonspatial mean field model if and only if species cooperate in contrast in the presence of global cooperation the interacting particle system has no less than seven possible regimes that are all stable under small perturbations of the three parameters the existence of all these regimes follows heuristically from the same argument that explains the reduction of the coexistence region for the spatial two type model the density of individuals of a given type seen by an individual of the other type is in average significantly smaller in the interacting particle system than in the mean field approximation which makes species significantly more cooperative than others unable to survive in the presence of space when cooperation is strong or fair among all three species then global coexistence occurs even in the presence of space however when two species are significantly less cooperative than the third species these two species can coexist but outcompete the third one see the middle panel of table 2 similarly when a single species is significantly less cooperative than the other two species this species is the dominant type it outcompetes the other two species even when starting from a low density see the bottom panel of table 2 in conclusion the phase diagram of the nonspatial model when the set of parameters is restricted to matrices of the formm 8 can be deduced from theorems 5 and 10 and corollary 7 the unit cube representing the possible values of 1 2 and 3 is divided into eight regions which are delimited by the three two dimensional hyperplanes with equation i 1 3 in the presence of three cooperators coexistence occurs in the presence of two cooperators and one defector the defector wins in the presence of one cooperator and two defectors the system is bistable finally in the presence of three defectors the system is tristable we refer to figure 5 for the solution curves of the nonspatial model in these four cases finally the three dimensional phase diagram of the spatial model is depicted in figure 4 excluding the cube with length edge 1 3 at the bottom of the left picture the phase diagram is divided into three regions delimited by three hyperplanes that intersect along the segment line denoted by 1 that connects 1 3 1 3 1 3 and 1 1 1 along this segment line all three species cluster along the hyperplanes two of the species outcompete the third one the role of space in the exploitation of resources 31 densities and clustering coefficient when the interactions are described by the matrix m 8 with 3 0 densities and clustering coefficient when the interactions are described by the matrix m 8 with 3 8 27 1 0 27 1 1 27 1 2 27 1 3 27 1 4 27 1 5 27 1 6 27 1 7 27 1 8 27 1 9 27 2 0 27 2 1 27 2 2 27 2 3 27 2 4 27 2 5 27 2 6 27 2 7 27 2 8 27 2 9 27 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 49 50 76 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 50 49 77 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 48 51 77 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 49 50 77 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 50 49 77 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 49 50 77 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 48 51 77 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 51 48 77 0 100 0 100 51 0 48 76 52 0 47 76 49 0 50 76 48 0 51 76 49 0 50 76 50 0 49 76 50 0 49 76 50 0 49 76 32 32 34 70 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 52 47 0 85 1 0 27 1 1 27 1 2 27 1 3 27 1 4 27 1 5 27 1 6 27 1 7 27 1 8 27 1 9 27 2 0 27 2 1 27 2 2 27 2 3 27 2 4 27 2 5 27 2 6 27 2 7 27 2 8 27 2 9 27 33 33 33 47 30 39 29 48 26 47 26 51 20 58 20 57 13 73 13 69 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 39 30 29 48 36 36 26 48 33 44 22 51 28 55 16 56 24 70 4 68 7 92 0 90 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 48 25 25 51 44 33 21 51 41 41 16 53 38 51 9 57 33 66 0 67 17 82 0 80 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 58 20 20 57 55 28 16 56 52 38 8 58 49 50 0 62 40 59 0 64 26 73 0 73 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 73 13 13 69 70 24 4 68 66 33 0 67 58 41 0 64 49 50 0 64 37 62 0 68 13 86 0 85 0 100 0 100 0 100 0 100 0 100 0 100 100 0 0 100 91 8 0 90 82 17 0 80 73 26 0 73 63 36 0 68 50 49 0 66 29 70 0 74 0 100 0 100 0 100 0 100 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 86 13 0 85 69 30 0 73 50 49 0 69 13 86 0 87 0 100 0 100 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 86 13 0 87 50 49 0 72 0 100 0 100 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 49 50 0 76 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 49 50 0 86 densities and clustering coefficient when the interactions are described by the matrix m 8 with 3 19 27 1 9 27 1 11 27 1 13 27 1 15 27 1 17 27 1 19 27 1 21 27 1 23 27 1 25 27 1 27 27 3 9 27 3 11 27 3 13 27 3 15 27 3 17 27 3 19 27 3 21 27 3 23 27 3 25 27 3 27 27 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 57 42 97 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 50 49 97 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 57 42 97 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 50 49 97 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 49 50 97 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 54 0 45 97 57 0 42 97 45 0 54 97 60 0 39 97 44 0 55 97 35 27 37 95 0 100 0 100 0 100 0 100 0 100 0 100 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 51 48 0 97 0 100 0 100 0 100 0 100 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 45 54 0 97 0 100 0 100 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 51 48 0 96 0 100 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 100 0 0 100 50 49 0 68 table 2 and cluster and in the three regions delimited by the three hyperplanes there is a dominant type which is uniquely determined by the parameter values the right picture shows an enlargement of the coexistence region which is included in the cube with length edge 1 3 that corresponds to the region where all three pairs of species cooperate this picture is drawn from the simulation results of table 2 note that the spatial model exhibits seven regimes in this single cubic region the first row of figure 6 shows three snapshots of the spatial model when parameters are taken along the straight line 2 as the common value of 1 and 2 increases the system crosses three different regimes first all three species coexist then species 1 and 2 coexist but outcompete species 3 and finally not only species 3 is driven to extinction but also species 1 and 2 cluster the second row of 32 y kang and n lanchier 3 1 coex 1 3 2 2 3 2 1 2 1 2 3 2 1 1 2 2 3 1 3 3 1 1 coex 2 2 figure 4 phase diagram of the spatial three type spatial model restricted to matrices of the form m 8 3 2 1 3 2 1 3 2 1 3 2 1 figure 5 solution curves when the dynamics are described by m 8 the same figure shows three snapshots of the spatial model when parameters are taken along the straight line 1 in this neutral case cooperation allows all three species to coexist while switching to competitive relationships the system clusters as shown by the last two snapshots coexistence of cheaters recall that according to theorem 10 and the discussion following the theorem coexistence is possible in the absence of space regardless of the number of pairs of species that are in cooperative relationship or in defector cooperator relationship whereas coexistence cannot occur whenever one pair is competing after looking at the first extreme case where all pairs are in a cooperative relationship in which case the inclusion of space reduces the coexistence region we now look at the other extreme case where all three pairs are in a defector cooperator relationship that results in rock paper scissors dynamics to understand the role of space in this case we have performed numerical simulations of the spatial three type model when the local the role of space in the exploitation of resources 33 1 0 00 1 0 10 1 0 20 1 0 30 1 0 40 1 0 50 1 0 60 1 0 70 1 0 80 1 0 90 2 0 00 2 0 10 2 0 20 2 0 30 2 0 40 2 0 50 2 0 60 2 0 70 2 0 80 2 0 90 36 16 46 66 31 19 49 67 31 18 49 69 28 18 52 70 25 19 54 71 24 20 55 72 22 20 57 73 20 21 57 74 19 22 58 75 18 22 59 75 40 17 41 67 36 19 44 67 33 20 46 69 29 21 48 70 27 22 49 71 26 21 52 72 25 22 51 73 24 23 52 73 22 25 52 73 18 25 56 75 43 18 38 67 39 19 40 68 36 20 43 69 34 21 44 70 31 23 44 71 29 24 46 71 26 24 49 72 24 27 47 73 22 27 49 74 22 26 51 75 47 17 34 68 43 20 35 69 39 20 39 70 38 22 39 71 33 24 42 72 31 25 43 72 28 26 45 72 28 26 45 74 25 27 46 74 23 27 49 75 50 18 30 69 45 20 33 69 42 22 35 70 38 23 37 71 36 24 38 72 33 25 41 73 31 27 40 73 29 28 41 73 26 28 44 74 26 30 43 74 53 18 27 71 49 20 29 71 45 22 32 71 40 23 36 72 38 25 36 72 34 26 38 73 33 28 38 74 30 29 39 74 29 31 39 75 26 31 42 75 55 19 25 72 50 20 28 72 46 22 30 72 42 25 32 73 39 27 33 73 36 28 35 74 34 29 36 74 32 28 38 74 30 31 37 75 28 33 38 76 57 18 23 73 52 21 26 73 49 22 27 73 43 27 29 73 42 26 31 74 38 28 32 74 36 30 33 74 34 31 34 75 31 32 35 76 30 32 36 76 59 19 21 76 52 21 25 73 49 24 26 74 44 26 28 74 41 28 29 74 42 28 29 75 36 30 32 75 33 32 33 75 32 33 33 76 31 34 34 76 58 19 21 76 55 22 22 75 52 23 23 75 48 25 25 75 44 27 28 75 40 31 27 75 39 30 29 76 35 33 30 76 35 33 31 76 31 35 32 77 densities and clustering coefficient when the interactions are described by the matrix m 9 with 3 0 80 table 3 interactions are described by matrices of the form m 9 1 0 1 1 2 0 0 1 3 recall that according to theorem 8 when the dynamics are described by the matrix m 9 one obtains a heteroclinic cycle by taking i 1 for all i 1 2 3 recall also that under the additional conditions 16 the heteroclinic cycle is locally asymptotically stable whereas it is repelling inducing permanence of the system under the conditions 17 numerical simulations of the nonspatial model further indicate that there is a unique interior equilibrium when starting from any condition in s 3 excluding this interior equilibrium and under the assumptions 16 the trajectories get closer and closer to the boundaries of the system indicating that for large times at least one of the densities is arbitrarily close to zero whereas under the assumptions 17 the trajectories converge to the interior equilibrium in contrast numerical simulations of the spatial three type model indicate that taking i 1 for all i 1 2 3 suffices to obtain coexistence of all three species in space these simulation results are reported in table 3 where 3 0 80 note that even when both parameters 1 and 2 are strictly larger than one half in which case 16 is satisfied and so the nonspatial model is not permanent all three densities are bounded away from zero and the cluster coefficient is strictly smaller than that of the three type voter model in conclusion whereas the inclusion of local interactions reduces the coexistence region when all three pairs of species are in a cooperator cooperator relationship it increases the coexistence region when on the contrary all three pairs of species are in a defector cooperator relationship the three snapshots of the spatial model in figure 7 indicate that this also holds when starting with two species at low density we finally explain the reason why local interactions promote coexistence in the case of rock paper scissors dynamics the dynamical picture of the spatial model at equilibrium shows that small clusters keep forming very quickly but then shrink again immediately residuals of one species say paper invade nearby clusters of rocks very quickly resulting in clusters of papers which when they reach a critical size are invaded and destroyed by nearby residuals of scissors so the system exhibits local traveling waves focusing on a reasonably small piece of the lattice one sees a majority of rocks which are suddenly invaded by a wave of papers that become majoritary which themselves are suddenly invaded by a wave of scissors and so on in particular the dynamics predicted by 34 y kang and n lanchier a 1 0 04 b 1 0 25 c 1 0 80 d 1 0 25 e 1 0 50 f 1 0 75 figure 6 snapshots of the three type model at time 200 when starting from a product measure in which sites are equally likely to be of either type and when the local interactions are described by the matrix m 9 in the first row the parameters are 1 2 and 3 0 while in the second row 1 2 3 a time 40 b time 80 c time 120 figure 7 snapshots of the spatial model starting with 90 of rocks black and 5 of papers and scissors grey and white when the local interactions are described by the matrix m 9 with 1 2 3 0 80 the role of space in the exploitation of resources 35 the nonspatial model under conditions 15 16 indeed reflects the dynamics of the spatial model viewed in a small region of the lattice however due to the presence of local interactions the global densities become irrelevant and small pieces of the lattice that are far from each other are almost independent in such a way that the nonspatial dynamics are only symptomatic of what happens in small spatial regions in addition due to stochasticity there is a strong asynchrony among nearby regions so even if a region is void in one type this type can quickly reappear 6 discussion the long term behavior of ecological communities involving competitive defector defector interac tions cooperative interactions and defector cooperator interactions are difficult to predict mainly because the fitness of each individual depends on the environment which induces a constant feed back between the set fitnesses and the configuration of the community in situations where one species has a higher ability than all the other species to exploit resources of either type the fitness of the first species is always strictly larger than that of the other ones regardless of the configuration of the community excluding such situations the interacting particle system and its mean field ap proximation generally disagree this is due to the fact that the environment seen by each individual strongly differs in the presence and in the absence of a spatial structure regardless of the size of the community when all pairs of species are in a competitive relationship the mean field model predicts multistability of the system one type eventually takes over and this dominant type is determined by the combination of both the parameters of the system and the initial densities in contrast in the presence of local interactions the dominant type is uniquely determined by the parameters the reason is that regardless of the global densities the fractions of species seen from the spatial interface between two types are roughly the same for both types which results in traveling waves that expand in favor of the dominant type in the presence of only two species cooperation is the only mechanism that promotes coexistence in the absence of space coexistence occurs if and only if cooperation occurs introducing additional species has two important consequences first even in the mean field approximation global coop eration alone does not result in the coexistence of all species since a too strong cooperative behavior between two species can drive the other species to extinction in particular that any two species can coexist does not imply that species all together can coexist second there are additional mech anisms that promote coexistence rock paper scissors dynamics in which all pairs of species are in a defector cooperator relationship is an example of such a mechanism in particular that any two species cannot coexist in the absence of the other species does not imply that species all together cannot coexist another important aspect is that at least in the presence of at most three species whenever two species are in a competitive defector defector relationship global coexistence is never possible therefore the collection of mechanisms that promote coexistence when three species are present consist of global cooperative behavior rock paper scissors type dynamics and mixture of these two extreme cases the effect of local interactions in the presence of either global cooperation or rock paper scissors dynamics is probably the most interesting aspect of our study in the presence of mutual coopera tive relationships the inclusion of local interactions translates into a reduction of the coexistence region whereas in the presence of rock paper scissors dynamics the inclusion of local interactions translates into an expansion of the coexistence region the intuition behind the first statement is that the fraction of individuals of a given species seen by an individual of another species is sig nificantly smaller in the interacting particle system than in the mean field model indicating that 36 y kang and n lanchier in the presence of local interactions cooperative species cannot fully benefit from the resources produced by the other species this effect is more pronounced in low spatial dimensions finally the intuition behind the second statement is that the behavior predicted by the mean field model in the presence of rock paper scissors dynamics is only symptomatic of the local behavior of the interacting particle system seen in a fairly small region since in addition stochasticity induces a strong asynchrony among disjoint spatial regions when a species is driven to extinction locally it is quickly reintroduced from nearby regions acknowledgment the authors would like to thank an anonymous referee for important comments that helped to improve the article references 1 p clifford and a sudbury 1973 a model for spatial conflict biometrika 60 581 588 2 j t cox 1989 coalescing random walks and voter model consensus times on the torus in z d ann probab 17 1333 1366 3 j t cox and d griffeath 1986 diffusive clustering in the two dimensional voter model ann probab 14 347 370 4 r durrett and s a levin 1994 stochastic spatial models a user s guide to ecological applications philosophical transactions of the royal society of london series b 343 329 350 5 r durrett and s a levin 1994 the importance of being discrete and spatial theoret pop biol 46 363 394 6 p erdo s and p ney 1974 some problems on random intervals and annihilating particles ann probability 2 828 839 7 j hofbauer and k sigmund 1998 evolutionary games and population dynamics cambridge university press cambridge 8 r a holley and t m liggett 1975 ergodic theorems for weakly interacting systems and the voter model ann probab 3 643 663 9 c b huffaker 1958 experimental studies on predation dispersion factors and predator prey oscillations hilgardia 27 343 383 10 v hutson 1984 a theorem on average liapunov functions monatsh math 98 267 275 11 n lanchier two strategy games on the lattice preprint 12 n lanchier and c neuhauser 2009 spatially explicit non mendelian diploid model ann appl probab 19 1880 1920 13 t m liggett 1994 coexistence in threshold voter models ann probab 22 764 802 14 c neuhauser 2001 mathematical challenges in spatial ecology notices amer math soc 48 1304 1314 15 c neuhauser and s w pacala 1999 an explicitly spatial version of the lotka volterra model with interspecific competition ann appl probab 9 1226 1259 16 d schwartz 1978 on hitting probabilities for an annihilating particle model ann probability 6 398 403 17 b sinervo and c m lively 1996 the rock paper scissors game and the evolution of alternative male strategies nature 380 240 243 the role of space in the exploitation of resources 37 applied sciences and mathematics arizona state university mesa az 85212 usa school of mathematical and statistical sciences arizona state university tempe az 85287 usa 1 introduction 2 models description 3 analytical results for the nonspatial deterministic model 4 analytical results for the spatial stochastic model 5 the role of space 6 discussion references