ar x iv 1 50 8 01 24 6 v 1 m at h o c 5 a ug 2 01 5 5 c g h i 6 e or 11 m 1 inter winding distributed capacitance and guitar pickup transient response p robert kotiuga boston university dept of ece 8 saint mary s street boston ma 02215 usa abstract simple rlc circuit models of guitar pickups do not account for audible features that characterize the pickup psycho acoustic experiments reveal that any acoustically ac curate model has to reproduce the first 30 milli seconds of the transient response with extreme precision the proposed model is impractical for simple minded model reduction or brute force numerical simulations yet by focusing on modeling electromagnetic details and exposing a connection to spectral graph theory a framework for finding the transient response to sufficient accuracy is exposed index terms distributed capacitance spectral graph theory transient response i introduction the pickup model proposed in this paper has a voltage and a current associated with each turn although this involves thousands of variables the goal is to devise a model reduction strategy which accounts for the audible aspects of the transient response which characterize the tone 1 of the pickup the cut bell psycho acoustic experiments of pierre schaeffer re veal that any acoustically accurate model has to reproduce the first 30 milli seconds of the transient response with extreme precision 1 the proposed pickup model is not straightforward but has precedent in the analysis of very fast transients in multiwind ing power transformers a field with a history of detailed mathematical modeling that goes back a century 3 and where the literature on electromagnetics based state space analysis of transient oscillations backed by rigorous numerical analysis goes back at least 40 years 4 problems arising in the context of power transformers also shed light on considerations of potting pickups to suppress microphonics and of disre garding eddy currents on ferromagnetic parts unfortunately this analogy does not resolve the issues involved in modeling scatterwound pickups since the model reduction techniques made in the context of power transformers oversimplify the pickup problem for instance for the purpose of capacitance modeling the turns of transformer winding can be modeled as sheet currents 5 6 7 also unlike power transformers pickup wire is typically 42 awg so skin and proximity effects are non issues well into the mhz range the key common aspect is the neccessity of starting with an accurate 1 although the brain cannot extract much information based on less than three milli seconds of transient response due to the bandlimited nature of the hearing process it processes transient information quite thoroughly based on less than 50 milliseconds of the waveform s attack chapter 12 anamorphoses temporelles i timbres et dynamiques of schaeffer s treatise 2 summarizes this work there are pointers to earlier observations of f winckel in this regard but schaeffer seems to have provided the key experimental confirmation and the readily reproducible methodology multiconductor transmission line model 8 independent of questions pertaining to model reduction to fix ideas consider three questions which one might hope to answer in the context of analysing a pickup 1 deriving an accurate transfer function relating the mo tion of the string to the output voltage of the pickup 2 finding the input impedance of the pickup 3 find the short circuit internal resonances of the pickup the third problem is a stepping stone to answering the first two questions in this paper we do not attempt to answer the first question in full generality this is because an accurate model of pickup would involve for instance the eddy currents on the pole pieces of the pickup such eddy currents lead to wolf sound for a properly adjusted guitar string heights above pole pieces are adjusted to make it imperceptible and so we do not need to model the eddy currents similarly we do not dwell on the second problem since the input impedance only matters in the context of ensuring that the impedance of the guitar and cable as seen from the follow on stage of amplification is negligible hence in this paper we focus on the role of the of distributed capacitance in the context of the third problem this in turn will lead us to spectral graph theory 9 10 a formalization of the well studied link between nodal analysis the graph laplacian and the spectrum of the adjacency matrix of a graph ii a sketch of an idea this paper exposes the connection between the natural frequencies of the pickup and the eigenvalues of the adjacency matrix this connection can be sketched as follows consider the following linear system arising from the discretization of multi conductor transmission lines which are wrapped around to form the turns of a winding it involves square matrices of order n where n is the number of turns 2 circ x 0 1 here circ is a circulant matrix and x are state variables that is a matrix whose k 1 st row is the k th row shifted one entry right and wrapped around in general any circulant matrix is a linear combination of the first n powers of the shift matrix s in other words circ is a polynomial in s following the theory of the dft we know s is diagonalized by the unitary matrix v a vandermonde matrix of roots of unity normalized by n 1 2 and the eigenvalues of s are the nth roots of unity that is s v sv where s is the diagonal matrix of roots of unity and denotes the hermitian conjugate http arxiv org abs 1508 01246 v 1 2 5 c g h i 6 e or 11 m furthermore all powers of s are also diagonalized by v as are polynomials and analytic functions of s so circ p 1 s v p 1 s v 2 the square of the propagation matrix 2 is modeled as a polynomial in the adjacency matrix a of a graph associated to the manner in which the turns of the pickup winding were wound with the angular frequency as a parameter 2 p 2 a 3 eq 3 builds on the relationship between the laplacian of a graph where the degree of any node is independent of the node index and the nodal analysis matrix of a network having the same underlying graph in this paper the node degree is dependent on the node index at the boundary of the winding and an additional diagonal matrix will be introduced to account for the discrepancy substitute 2 and 3 into 1 to get p 2 a p 1 s x 0 or 4 p 2 a v 1 p 1 s v x 0 5 we would expect to find nontrivial solutions by setting the determinant to zero to obtain a polynomial equation in whose roots give the natural frequencies unfortunately for the model at hand all of the matrices are singular with a common null space and common null vector hence the matrix is singular for all values of in section six we will obtain the correct equation by using the decomposition in 2 to project onto the orthogonal complement of the null vector and then form the determinantal equation for the natural frequencies iii the network model consider a single coil magnetic pickup on an electric guitar placed in 3 d euclidean space with coordinates x y z such that the z axis is perpendicular to the fretboard the pickup in question is centered on the z axis with its center at z 0 from a field theoretic vantage the subtle aspect of the guitar pickup model is that each turn of the winding links a nontrivial time varying magnetic field yet one describes the electric field exterior to the conducting coil in terms of an electric scalar potential this is accomplished within the convex hull of the pickup by assuming that the time rate of change of magnetic flux perpendicular to any plane containing the z axis is negligible this assumption enables one to define an electric scalar potential for the components of the electric field lying in any plane containing the z axis 2 however the time varying magnetic flux linking the pickup coil prevents this electric scalar potential from describing the circumferential components to describe these components of the electric field within the conductor we integrate the electric field along the conductor and evaluate the value of the line integral every time 2 in principle the planarity condition in this assumption is only valid for a circular coil a more precise formulation of this assumption would involve a singular foliation of the convex hull of the pickup with the all of the leaves bordering on the z axis a precise formulation of the assumption is not required since only the existence of the scalar potential is required to formulate the network equations one passes through a given half plane whose boundary is the z axis thus let ci e dl vi v 0 6 where ci comprises the the first i turns of the winding the voltage drop around the i th turn is then given by vi vi 1 we can compile these voltages into a vector v similarly if ii is the current entering the i th winding these currents can be compiled into a vector i let n be the number of turns taking the index modulo n the equations for the short circuited pickup are given by s i v r j l i and 7 s i i j cv 8 where i is the identity matrix s is the shift matrix and the remaining impedance and admittance matrices are as one would expect if one took a length of multiconductor transmis sion line 8 and connected the end of the k th turn to the beginning of the k 1 st to preserve the cyclic symmetry we avoided grounding any node and so the capacitance matrix is necessarily singular with null vector 1 where 1 is the vector all of whose entries are 1 furthermore the matrix s i has the same null vector this approach is formalized in the method of the indefinite impedance matrix 3 iv an analog of the telegraphist s equation via simple models of r and l matrices if we multiply 7 by j c we obtain j c s i v j c r j l i 9 add and subtract j s i cv to the l h s of 9 and simplify to get a telegraphist like equation plus a commutator term j c r j l s i 2 i j cs sc v 10 had the capacitance matrix been invertible and if c and s i commuted we could hope to eliminate v using 8 we will see that if we formulate our equations in terms of voltages the current can be eliminated yielding an analog of the telegraphist equation thus avoiding these difficulties additional structure in the r l and c matrices leads to useful commutation relations this is easy to verify for the r and l matrices the commutation relations will ensure that the analog of the telegraphist s equations when formulated in terms of voltages are free of undesirable commutators the coil in a guitar pickup consists of 5 000 to 8 000 turns of copper wire typically 42 awg with a typical dc resistance of 7 5 k the matrix r is modeled as a multiple of the identity matrix and is the simplest to model if rdc is the dc resistance of the pickup and the resistance r 0 of one 3 a textbook exposition of the indefinite impedance matrix method and its relationship to cutset analysis can be found in section 3 7 of balabanian and bickart s text 11 note that for a passive network this impedance matrix has one zero eigenvalue for each connected component of the network and the remaining eigenvalues have positive real parts cefc 2014 digest 3 turn is assumed to be the average independent of the turn then r 0 is rdc divided by n hence r r 0 i and trace r rdc where r 0 rdc n 11 the inner turns of the winding are shorter than the outer ones but this is ignored in the analysis since r is a multiple of the identity matrix it commutes with any compatible matrix let m be the mutual inductance between two turns and assume this value is independent of the index of the turn let be a nonnegative constant expressing the deviation from perfect coupling the inductance matrix model we use is l m i 1 1 12 here 1 1 the outer product of the vector 1 with itself and again 1 is the vector all of whose entries are 1 since the capacitance matrix is an admittance matrix arising from nodal analysis and a ground node has not been selected it is symmetric positive semi definite with a one dimensional null space this is reflected in the fact that the row sums or column sums of any row or column add up to zero the null vector is precisely the vector 1 which occurs in the outer product in the inductance matrix in other words c 1 0 so c 1 1 0 13 and by 12 we have cl c m i 1 1 mc 14 furthermore since both l and c are symmetric the same result holds for the commuted product so that cl mc lc 15 this argument shows that l commutes with any symmetric matrix whose null space includes the vector 1 and easily extends to nonsymmetric matrices where 1 is included in both the nullspaces of the matrix and its transpose one example of such a matrix is s i and one can easily verify that s i l m s i l s i 16 from eqs 7 8 and commutation relations 15 16 we obtain s i 2 v s i r j l i s i r j m i 1 1 i r 0 j m s i i j c r 0 j m v or s i 2 j c r 0 j m v 0 17 this is a commutator free analog of the telegraphist equation v winding induces an ordering on turns adjacency and distributed capacitance matrices in order to model the inter winding capacitance matrix we introduce a directed graph gd as follows assume that the turns are ordered by the order in which they were wound so that the i th index in the matrix equation corresponds to the i th turn wound this is our definition of a preferred ordering the edges of gd correspond to neighboring turns inducing a preferred orientation on the edges of gd dictated by the order the turns were wound it follows that the edges of gd are directed from higher to lower node index associated to gd is the undirected graph gu obtained by ignoring the orientations of the edges we associate the adjacency matrix a to gu by a i j 0 if i j or no edge connects nodes i and j 1 otherwise 18 if we assume that locally the cross section of the winding appears to be a hexagonal closest packing then any row or column corresponding to a non boundary winding has exactly six nonzero off diagonal entries the existence of gd ensures that on average every node of gd corresponding to a non bounday turn has three incoming and three outgoing edges from our discussion of the winding s cross section we have the following model of the inter winding capacitiance matrix c c 0 di a b and trace c nintd nbdbav c 0 19 since trace a 0 here c 0 is the capacitance one has between two turns of enameled copper wire wound beside each other this parameter is easily deduced by conformal mapping once the diameter of the enamel coating is known the matrix b is a diagonal matrix with a relatively small percentage of nonzero diagonal entries corresponding to boundary turns the value of the nonzero entry corresponding to a given boundary node is the degree of the node minus six in 19 nint and nb are respectively the number of internal and boundary nodes d is the degree of the internal nodes assumed constant it is six but we leave it as a symbol to suggest that gu is a regular graph and dbav is the average degree of a boundary node although the incidence data of gd appears in the statement of kirchhoff s laws it is only gu which appears explicitly in the nodal equations through the appearance of a however in the case at hand the orientation information in the graph gd is implicit in the nodal equations once the preferred ordering is introduced this is because the k th edge originates on a node whose index j is less or equal to k and terminates on a node of index lower than j in this way the orientation information of gd can then be reconstructed from the sparsity pattern of a and it is in this manner that winding pattern affects the eigenvalue distribution of c through a we have seen that r l and c are a set of commuting matrices and that r l and s i are another such set to see why c and s i are not use 19 to reduce the commutator on the r h s of 10 to those between a b and s cs sc c 0 b a s s b a 20 finally substituting 11 12 14 into 10 reduces it to s i 2 j c r 0 j m i j cs sc v 21 eq 20 reveals how formulating our telegraphist equations in terms of i leads to unavoidable commutators and so we return to 17 in order to relate the natural frequencies of this model to the c matrix via the sparsity structure of the adjacency matrix if we substitute 19 into 17 we get s i 2 j c 0 r 0 j m di a b v 0 22 4 5 c g h i 6 e or 11 m or s i 2 2 di a b v 0 23 2 j c 0 r 0 j m 24 vi the tie to spectral graph theory eq 23 cannot be a conventional eigenvalue problem for 2 since it turns out that the underlying matrices are singular for all values of 2 to resolve this problem we note that the vector 1 has appeared in many contexts specifically it is the null vector of c c 0 di a b the null vector of s i and the eigenvector of s corresponding to the eigenvalue 1 one could toss out a row and column from the system as when one grounds a node in nodal analysis but a better approach is to project the system into the orthogonal complement of the vector 1 recall that the vandermonde matrix of n th roots of unity diagonalizes any circulant matrix and that the eigenvalues of the shift matrix are just the roots of unity so let v denote the hermitian conjugate of v and let n diag k n n 1 k o where k n e 2 ki n 25 the first term in 23 is a circulant matrix which is diagonal ized by the similarity transfomation of section two s i 2 v n i 2 v v n v 26 where by 25 we explicitly have n diag e 2 ki n cos 2 ki n 1 n 1 k o 27 substituting 26 into 23 we can write v nv 2 di a b v 0 28 although this is still singular for all values of 2 the similarity transformation induced by v points the way to projecting into the orthogonal complement to the vector 1 rewrite 28 as n 2 di v a b v vv 0 29 there is one row and one column which are explicitly zero and so we can now explicitly perform the projection let n 1 diag e 2 ki n cos 2 ki n 1 n 1 k 1 30 that is with k 6 0 n we restricted ourselves to the nonzero eigenvalues of s i let v pr be the n n 1 matrix consisting of the eigenvectors of s i corresponding to nonzero eigenvalues then v v vv in n but 31 vprv pr i n 1 n 1 and v prvpr proj 1 32 the determinantal equation is now expressed as det n 1 2 di n 1 n 1 vpr a b v pr 0 33 this is the definitive equation for subsequent developments however given the definition of the capacitance matrix this equation could have been written in the more intuitive form det n 1 2 c 0 vprcv pr 0 34 hence 33 reduces the problem to a modified eigenvalue problem for a diagonal perturbation of the vanishing diag onal adjacency matrix by 24 any information about the spectrum translates into information about the collection of natural frquencies since they are related to the eigenvalues through a quadratic equation the adjacency matrix eigenvalue problem is the focus of spectral graph theory and there are many ways to exploit this connection this provides precise estimates for the transient response and a framework for model reduction in the presence of eigenvalue clusters vii summary and conclusions in this paper we shed light on elusive aspects of electro magnetic modeling of electric guitar pickups specifically the ability of an expert to infer the manner in which the pickup was wound by listening psycho acoustic experiments reveal that acoustically accurate models have to reproduce the first 30 milliseconds of the transient response with extreme precision since the brain makes inferences about the pickup s tone within this timeframe conventional wisdom dictates that one could take the natural frequencies which are smallest in absolute value and perform a model reduction this however is tricky when the natural fequencies cluster the problem is difficult because the winding pattern of the pickup affects the clustering of natural frequencies in a subtle manner which is audibly discernable as the tone of the pickup yet gets lost in a simple minded model reduction scheme by exposing a connection to spectral graph theory 23 24 33 yield a framework for analyzing the attack of the transient response to sufficient detail to reveal the role of the ordering of the turns in the winding this model is insensitive to how the pickup was wound with the exception of the inter winding capacitance matrix which describes the capacitance between the turns of the winding references 1 hunter dave the guitar pickup handbook backbeat books 2008 2 pierre schaeffer traite des objets musicaux nouvelle edition editions du seuil paris 1966 3 e bjerkan high frequency modeling of power transformers stresses and diagnostics doctoral thesis ntnu trondheim 2005 4 r c degeneff a general method for determining resonances in transformer windings ieee trans vol pas 96 no 2 1977 pp 423 430 5 p i fergestad t henriksen transient oscillations in multiwinding transformers paper t 73 393 6 ieee pes summer meeting and ehv uhv conference vancouver b c canada july 15 20 1973 6 s m h hosseini m vakilian g b gharehpetian comparison of transformer detailed models for fast and very fast transient studies ieee trans power del vol 23 no 2 april 2008 pp 733 741 7 p gomez f de leon accurate and efficient computation of the inductance matrix of transformer windings for the simulation of very fast transients ieee trans power del vol 26 no 3 july 2011 pp 1423 1431 8 c r paul analysis of multiconductor transmission lines john wiley and sons inc 1994 9 r a brualdi the mutually beneficial relationship of graphs and matrices cbms series no 115 amer math soc 2011 10 f chung spectral graph theory ams 11 n balabanian and t a bickart electrical network theory john wiley and sons inc 1969 i introduction ii a sketch of an idea iii the network model iv an analog of the telegraphist s equation via simple models of r and l matrices v winding induces an ordering on turns adjacency and distributed capacitance matrices vi the tie to spectral graph theory vii summary and conclusions references