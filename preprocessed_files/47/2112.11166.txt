functional analysis jan van neerven this manuscript will be published by cambridge university press in the series cambridge stud ies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven ar x iv 2 11 2 11 16 6 v 3 m at h f a 1 a pr 2 02 2 contents preface page ix notation and conventions xi 1 banach spaces 1 1 1 banach spaces 2 1 2 bounded operators 9 1 3 finite dimensional spaces 18 1 4 compactness 21 1 5 integration in banach spaces 23 problems 28 2 the classical banach spaces 33 2 1 sequence spaces 33 2 2 spaces of continuous functions 35 2 3 spaces of integrable functions 47 2 4 spaces of measures 63 2 5 banach lattices 73 problems 76 3 hilbert spaces 87 3 1 hilbert spaces 87 3 2 orthogonal complements 92 3 3 the riesz representation theorem 95 3 4 orthonormal systems 96 3 5 examples 100 problems 106 4 duality 115 4 1 duals of the classical banach spaces 115 4 2 the hahn banach extension theorem 128 4 3 adjoint operators 137 v vi contents 4 4 the hahn banach separation theorem 142 4 5 the krein milman theorem 144 4 6 the weak and weak topologies 147 4 7 the banach alaoglu theorem 152 problems 163 5 bounded operators 171 5 1 the uniform boundedness theorem 171 5 2 the open mapping theorem 174 5 3 the closed graph theorem 176 5 4 the closed range theorem 178 5 5 the fourier transform 180 5 6 the hilbert transform 190 5 7 interpolation 192 problems 201 6 spectral theory 209 6 1 spectrum and resolvent 209 6 2 the holomorphic functional calculus 217 problems 224 7 compact operators 227 7 1 compact operators 227 7 2 the riesz schauder theorem 230 7 3 fredholm theory 234 problems 252 8 bounded operators on hilbert spaces 255 8 1 selfadjoint unitary and normal operators 255 8 2 the continuous functional calculus 266 8 3 the sz nagy dilation theorem 272 problems 277 9 the spectral theorem for bounded normal operators 281 9 1 the spectral theorem for compact normal operators 281 9 2 projection valued measures 285 9 3 the bounded functional calculus 287 9 4 the spectral theorem for bounded normal operators 293 9 5 the von neumann bicommutant theorem 301 9 6 application to orthogonal polynomials 305 problems 308 10 the spectral theorem for unbounded normal operators 311 10 1 unbounded operators 311 contents vii 10 2 unbounded selfadjoint operators 322 10 3 unbounded normal operators 326 10 4 the spectral theorem for unbounded normal operators 332 problems 344 11 boundary value problems 347 11 1 sobolev spaces 347 11 2 the poisson problem u f 372 11 3 the lax milgram theorem 385 problems 388 12 forms 399 12 1 forms 399 12 2 the friedrichs extension theorem 410 12 3 the dirichlet and neumann laplacians 411 12 4 the poisson problem revisited 415 12 5 weyl s theorem 416 problems 424 13 semigroups of linear operators 427 13 1 c 0 semigroups 427 13 2 the hille yosida theorem 439 13 3 the abstract cauchy problem 447 13 4 analytic semigroups 455 13 5 stone s theorem 473 13 6 examples 475 13 7 semigroups generated by normal operators 498 problems 500 14 trace class operators 507 14 1 hilbert schmidt operators 507 14 2 trace class operators 510 14 3 trace duality 521 14 4 the partial trace 523 14 5 trace formulas 526 problems 539 15 states and observables 543 15 1 states and observables in classical mechanics 543 15 2 states and observables in quantum mechanics 545 15 3 positive operator valued measures 561 15 4 hidden variables 574 15 5 symmetries 577 viii contents 15 6 second quantisation 598 problems 617 appendix a zorn s lemma 621 appendix b tensor products 623 appendix c topological spaces 627 appendix d metric spaces 637 appendix e measure spaces 647 appendix f integration 661 appendix g notes 671 references 691 index 701 preface this book is based on notes compiled during the many years that i have taught the course applied functional analysis in the first year of the master s programme at delft uni versity of technology for students with prior exposure to the basics of real analysis and the theory of lebesgue integration starting with the basic results of the subject covered in a typical functional analysis course the text progresses towards a treatment of several advanced topics including fredholm theory form methods boundary value problems form methods semigroup theory trace formulas and some mathematical as pects of quantum mechanics with a few exceptions in the later chapters complete and detailed proofs are given throughout this makes the text ideally suited for students wishing to enter the field great care has been taken to present the various topics in a connected and integrated way and to illustrate abstract results with concrete and sometimes nontrivial appli cations for example after introducing banach spaces and discussing some of their abstract properties a substantial chapter is devoted to the study of the classical banach spaces c k lp m with some emphasis on compactness density and approxi mation techniques the abstract material in the chapter on duality is complemented by a number of nontrivial applications such as a characterisation of translation invariant sub spaces of l 1 rd and prokhorov s theorem about weak convergence of probability mea sures the chapter on bounded operators contains a discussion of the fourier transform and the hilbert transform and includes proofs of the riesz thorin and marcinkiewicz interpolation theorems after the introduction of the laplace operator as a closable op erator in lp its closure is revisited in later chapters from different points of view as the operator arising from a suitable sesquilinear form as the operator with its natural domain and as the generator of the heat semigroup in parallel the theory of its gaussian analogue the ornstein uhlenbeck operator is developed and the connection with orthogonal polynomials and the quantum harmonic oscillator is established the chapter on semigroup theory besides developing the general theory includes a detailed treatment of some important examples such as the heat semigroup the poisson semi ix x preface group the schro dinger group and the wave group by presenting the material in this integrated manner it is hoped that the reader will appreciate functional analysis as a subject that besides having its own depth and beauty is deeply connected with other areas of mathematics and mathematical physics in order to contain this already lengthy text within reasonable bounds some choices had to be made relatively abstract subjects such as topological vector spaces banach algebras and c algebras are not covered weak topologies are introduced ad hoc the use of distributions in the treatment of weak derivatives is avoided and the theory of sobolev spaces is developed only to the extent needed for the treatment of boundary value problems form methods and semigroups the chapter on states and observables in quantum mechanics is phrased in the language of hilbert space operators a work like this makes no claim to originality and most of the results presented here belong to the core of the subject not just the statements but often their proofs too are part of the established canon most are taken from or represent minor variations of proofs in the many excellent functional analysis textbooks in print special thanks go to my students to whom i dedicate this work teaching them has always been a great source of inspiration arjan cornelissen bart van gisbergen sigur gouwens tom van groeningen sean harris sasha ivlev rik ledoux eva maque lin garazi muguruza christopher reichling floris roodenburg max sauerbrey cyn thia slotboom joop vermeulen matthijs vernooij anouk wisse and timo wortel boer pointed out many misprints and more serious errors in earlier versions of this manuscript the responsibility for any remaining ones is of course with me a list with errata will be maintained on my personal webpage i thank emiel lorist lukas mias kiwskyi and ivan yaroslavtsev for suggesting some interesting problems and francesca arici martijn caspers tom ter elst markus haase bas janssens kristin kirchner klaas landsman ben de pagter pierre portal fedor sukochev walter van suijlekom and mark veraar for helpful discussions and valuable suggestions a significant portion of this book was written in the extraordinary circumstances of the global pandemic the sudden decrease in overhead and the opportunity of work ing from home created the time and serenity needed for this project paraphrasing the epilogue of w f hermans s novel onder professoren among professors the book was written entirely in the hours otherwise spent on departmental meetings committee meetings evaluations accreditations visitations midterms reviews previews etcetera and so forth all that precious time has been spent in a very useful way by the author delft march 2022 notation and conventions we write n 0 1 2 for the set of nonnegative integers and z q r and c for the sets of integer rational real and complex numbers whenever a statement is valid both over the real and complex scalar field we use the symbolk to denote eitherr orc given a complex number z a bi with a b r we denote by z a bi its complex conjugate and by rez a and imz b its real and imaginary parts we use the symbols d and t for the open unit disc and the unit circle in the complex plane respectively the indicator function of a set a is denoted by 1 a in the context of metric and normed spaces b x r denotes the open ball with radius r centred at x the interior and closure of a set s are denoted by s and s respectively we write s s to express that s is a subset of s the complement of a set s is denoted by s when the larger ambient set of which s is a subset is understood we write x both for the absolute value of a real number x r the modulus of a complex number x c and the euclidean norm of an element x x 1 xd kd when dealing with functions f defined on some domain f we write f c on s d if f x c for all x s the null space and range of a linear operator a are denoted by n a and r a respectively when a is unbounded its domain is denoted by d a a comprehensive list of symbols is contained in the index unless explicitly otherwise stated the symbols x and y denote banach spaces and h and k hilbert spaces in order to avoid frequent repetitions in the statements of results these spaces are always thought of as being given and fixed conventions with this re gard are usually stated at the beginning of a chapter or in some cases at the beginning of a section the same pertains to the choice of scalar field in chapters 1 5 the scalar field k can be either r or c with a small number of exceptions where this is explicitly stated such as in our treatment of the hahn banach theorem the fourier transform and the hilbert transform from chapter 6 onwards spectral theory and fourier transforms are used extensively and the default choice of scalar field is c in many cases however statements not explicitly involving complex numbers or constructions involving them admit counterparts over the real scalars which can be obtained by simple complexifica tion arguments we leave it to the interested reader to check this in particular instances xi 1 banach spaces the foundations of modern analysis were laid in the early decades of the twentieth century through the work of maurice fre chet ivar fredholm david hilbert henri lebesgue frigyes riesz and many others these authors realised that it is fruitful to study linear operations in a setting of abstract spaces endowed with further structure to accommodate the notions of convergence and continuity this led to the introduction of abstract topological and metric spaces and when combined with linearity of topological vector spaces hilbert spaces and banach spaces since then these spaces have played a prominent role in all branches of analysis the main impetus came from the study of ordinary and partial differential equations where linearity is an essential ingredient as evidenced by the linearity of the main operations involved point evaluations integrals and derivatives it was discovered that many theorems known at the time such as existence and uniqueness results for ordinary differential equations and the fredholm alternative for integral equations can be conve niently abstracted into general theorems about linear operators in infinite dimensional spaces of functions a second source of inspiration was the discovery in the 1920 s by john von neumann that the at that time brand new theory of quantum mechanics can be put on a solid mathematical foundation by means of the spectral theory of selfadjoint operators on hilbert spaces it was not until the 1930 s that these two lines of mathematical thinking were brought together in the theory of banach spaces named after its creator stefan banach although this class of spaces was also discovered independently and about the same time by norbert wiener this theory provides a unified perspective on hilbert this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 1 2 banach spaces spaces and the various spaces of functions encountered in analysis including the spaces c k of continuous functions and the spaces lp of lebesgue integrable functions 1 1 banach spaces the aim of the present chapter is to introduce the class of banach spaces and dis cuss some elementary properties of these spaces the main classical examples are only briefly mentioned here a more detailed treatment is deferred to the next two chapters much of the general theory applies to both the real and complex scalar field whenever this applies the symbol k is used to denote the scalar field which is r in the case of real vector spaces and c in the case of complex vector spaces 1 1 a definition and general properties definition 1 1 norms a normed space is a pair x where x is a vector space overk and x 0 is a norm that is a mapping with the following properties i x 0 implies x 0 ii cx c x for all c k and x x iii x x 6 x x for all x x x when the norm is understood we simply write x instead of x if we wish to emphasise the role of x we write x instead of the properties ii and iii are referred to as scalar homogeneity and the triangle inequality the triangle inequality implies that every normed space is a metric space with distance function d x y x y this observation allows us to introduce metric notions such as openness closedness compactness denseness limits convergence completeness and continuity in the con text of normed spaces by carrying them over from the theory of metric spaces for instance a sequence xn n 1 in x is said to converge if there exists an element x x such that limn xn x 0 this element if it exists is unique and is called the limit of the sequence xn n 1 we then write limn xn x or simply xn x as n the triangle inequality ii implies both x x 6 x x and x x 6 x x since x x 1 x x x x by scalar homogeneity we obtain the reverse triangle inequality x x 6 x x it shows that taking norms x 7 x is a continuous operation 1 1 banach spaces 3 if limn xn x and limn x n x in x and c k is a scalar then cxn cx c xn x c xn x implies lim n cxn cx 0 likewise xn x n x x xn x x n x 6 xn x x n x implies lim n xn x n x x 0 this proves sequential continuity and hence continuity of the vector space operations throughout this work we use the notation b x 0 r x x x x 0 r for the open ball centred at x 0 x with radius r 0 and b x 0 r x x x x 0 6 r for the corresponding closed ball the open unit ball and closed unit ball are the balls bx b 0 1 x x x 1 bx b 0 1 x x x 6 1 definition 1 2 banach spaces a banach space is a complete normed space thus a banach space is a normed space x in which every cauchy sequence is con vergent that is limm n xn xm 0 implies the existence of an x x such that limn xn x 0 the following proposition gives a necessary and sufficient condition for a normed space to be a banach space we need the following terminology given a sequence xn n 1 in a normed space x the sum n 1 xn is said to be convergent with sum x x if lim n x n n 1 xn 0 the sum n 1 xn is said to be absolutely convergent if n 1 xn proposition 1 3 a normed space x is a banach space if and only if every absolutely convergent sum in x converges in x proof only if suppose that x is complete and let n 1 xn be absolutely convergent then the sequence of partial sums nj 1 x j n 1 is a cauchy sequence for if n m the triangle inequality implies n j 1 x j m j 1 x j n j m 1 x j 6 n j m 1 x j which tends to 0 as m n hence by completeness the sum n 1 xn converges 4 banach spaces if suppose that every absolutely convergent sum in x converges in x and let xn n 1 be a cauchy sequence in x we must prove that xn n 1 converges in x choose indices n 1 n 2 in such a way that xi x j 12 k for all i j nk k 1 2 the sum xn 1 k 1 xnk 1 xnk is absolutely convergent since k 1 xnk 1 xnk 6 k 1 1 2 k by assumption it converges to some x x then by cancellation x lim m xn 1 m k 1 xnk 1 xnk lim m xnm 1 and therefore the subsequence xnm m 1 is convergent with limit x to see that xn n 1 converges to x we note that xm x 6 xm xnm xnm x 0 as m the first term since we started from a cauchy sequence and the second term by what we just proved the next theorem asserts that every normed space can be completed to a banach space for the rigorous formulation of this result we need the following terminology definition 1 4 isometries a linear mapping t from a normed space x into a normed space y is said to be an isometry if it preserves norms a normed space x is isometrically contained in a normed space y if there exists an isometry from x into y theorem 1 5 completion let x be a normed space then 1 there exists a banach space x containing x isometrically as a dense subspace 2 the space x is unique up to isometry in the following sense if x is isometrically contained as a dense subspace in the banach spaces x and x then the identity mapping on x has a unique extension to an isometry from x onto x proof as a metric space x x d has a completion x x d by theorem d 6 we prove that x is a banach space in a natural way with a norm x such that d x x x x x the properties 1 and 2 then follow from the corresponding assertions for metric spaces recall that the completion x of x as a metric space is defined as the set of all equivalence classes of cauchy sequences in x declaring the cauchy sequences xn n 1 and x n n 1 to be equivalent if limn d xn x n limn xn x n 0 the space x is a vector space under the scalar multiplication c xn n 1 c xn n 1 1 1 banach spaces 5 and addition xn n 1 x n n 1 xn x n n 1 where the brackets denote the equivalence class if xn n 1 is a cauchy sequence in x the reverse triangle inequality implies that the nonnegative sequence xn n 1 is cauchy and hence convergent by the completeness of the real numbers we now define a norm on x by xn n 1 x limn xn denoting by d the metric on x given by d x x limn d xn x n where x xn n 1 and x x n n 1 it is clear that d x x x x x 1 1 b subspaces quotients and direct sums several abstract constructions enable us to create new banach spaces from given ones we take a brief look at the three most basic constructions namely passing to closed subspaces and quotients and building direct sums subspaces a subspace y of a normed space x is a normed space with respect to the norm inherited from x a subspace y of a banach space x is a banach space with respect to the norm inherited from x if and only if y is closed in x to prove the if part suppose that yn n 1 is a cauchy sequence in the closed sub space y of a banach space x then it has a limit in x by the completeness of x and this limit belongs to y by the closedness of y the proof of the only if part is equally simple and does not require x to be complete if yn n 1 is a sequence in the complete subspace y such that yn x in x then yn n 1 is a cauchy sequence in x hence also in y and therefore it has a limit y in y by the completeness of y since yn n 1 also converges to y in x it follows that y x and therefore x y quotients if y is a closed subspace of a banach space x the quotient space x y can be endowed with a norm by x inf y y x y where for brevity we write x x y for the equivalence class of x modulo y let us check that this indeed defines a norm if x 0 then there is a sequence yn n 1 in y such that x yn 1 n for all n 1 then yn ym 6 yn x x ym 1 n 1 m 6 banach spaces so yn n 1 is a cauchy sequence in x it has a limit y x since x is complete and we have y y since y is closed then x y limn x yn 0 so x y this implies that x y 0 the zero element of x y the identity c x c x is trivially verified and so is the triangle inequality to see that the normed space x y is complete we use the completeness of x and proposition 1 3 if n 1 xn and the yn y are such that xn yn 6 xn the proposition implies that n 1 yn xn converges in x say to x then for all n 1 x n n 1 xn x n n 1 xn 6 x n n 1 xn n n 1 yn x n n 1 xn yn as n the right hand side tends to 0 and therefore limn nn 1 xn x in x y direct sums a product norm on a finite cartesian product x x 1 xn of normed spaces is a norm satisfying 0 0 xn n th 0 0 xn 6 x 1 xn for all x x 1 xn x and n 1 n for instance every norm onkn assign ing norm one to the standard unit vectors induces a product norm on x by the formula x 1 xn x 1 xn 1 1 as a normed space endowed with a product norm the cartesian product will be denoted x x 1 xn and called a direct sum of x 1 xn if every xn is a banach space then the normed space x is a banach space indeed from x n n 1 0 0 xn 0 0 6 n n 1 xn 6 n x 1 2 we see that a sequence x k k 1 in x is cauchy if and only if all its coordinate sequences x k n k 1 are cauchy if the spaces xn are complete these coordinate sequences have limits xn in xn and these limits serve as the coordinates of an element x x 1 xn in x which is the limit of the sequence x k k 1 1 1 c first examples the purpose of this brief section is to present a first catalogue of banach spaces the presentation is not self contained the examples will be revisited in more detail in the next chapter where the relevant terminology is introduced and proofs are given 1 1 banach spaces 7 1 1 1 1 1 1 figure 1 1 the open unit balls of r 2 with respect to the norms 1 2 example 1 6 euclidean spaces on kd we may consider the euclidean norm a 2 d j 1 a j 2 1 2 and more generally the p norms a p d j 1 a j p 1 p 16 p as well as the supremum norm a sup 16 j 6 d a j it is not immediately obvious that the p norms are indeed norms the triangle inequal ity a b p 6 a p b p will be proved in the next chapter it is an easy matter to check that the above norms are all equivalent in the sense defined in the next section in what follows the euclidean norm of an element x kd is denoted by x instead of the more cumbersome x 2 example 1 7 sequence spaces thinking of elements of kd as finite sequences the preceding example may be generalised to infinite sequences as follows for 16 p the space p is defined as the space of all scalar sequences a ak k 1 satisfying a p k 1 ak p 1 p the mapping a 7 a p is a norm which turns p into a banach space the space of all bounded scalar sequences a ak k 1 is a banach space with respect to the norm a sup k 1 ak the space c 0 consisting of all bounded scalar sequences a ak k 1 satisfying lim k ak 0 8 banach spaces 0 5 1 1 2 3 4 5 f x x y figure 1 2 the open ball b f 1 in c 0 1 consists of all functions in c 0 1 whose graph lies inside the shaded area is a closed subspace of as such it is a banach space in its own right example 1 8 spaces of continuous functions let k be a compact topological space the space c k of all continuous functions f k k is a banach space with respect to the supremum norm f sup x k f x this norm captures the notion of uniform convergence for functions in c k we have fn f 0 if and only if limn fn f uniformly example 1 9 spaces of integrable functions let f be a measure space for 16 p the space lp consisting of all measurable functions f k such that f p f p d 1 p identifying functions that are equal almost everywhere is a banach space with respect to the norm p the space l consisting of all measurable and essentially bounded functions f k identifying functions that are equal almost everywhere is a banach space with respect to the norm given by the essential supremum f esssup f inf r 0 f 6 r almost everywhere example 1 10 spaces of measures let f be a measurable space the space 1 2 bounded operators 9 m consisting of all k valued measures of bounded variation on f is a banach space with respect to the variation norm sup a f a a a where f denotes the set of all finite collections of disjoint f measurable subsets of example 1 11 hilbert spaces a hilbert space is an inner product space h that is complete with respect to the norm h h h 1 2 examples include the spaces kd with the euclidean norm 2 and the spaces l 2 further examples will be given in later chapters 1 1 d separability most banach spaces of interest in analysis are infinite dimensional in the sense that they do not have a finite spanning set in this context the following definition is often useful definition 1 12 separability a normed space is called separable if it contains a countable set whose linear span is dense proposition 1 13 a normed space x is separable if and only if x contains a countable dense set proof the only if part is trivial to prove the if part let xn n 1 have dense span in let q be a countable dense set in k for example one could take q q if k r and q q iq if k c then the set of all q linear combinations of the xn that is all linear combinations involving coefficients from q is dense in x finite dimensional spaces the sequence spaces c 0 and p with 16 p the spaces c k with k compact metric and lp d with 1 6 p and d rd open are sepa rable the separability of c k and lp d follows from the results proved in the next chapter 1 2 bounded operators having introduced normed spaces and banach spaces we now introduce a class of linear operators acting between them which interact with the norm in a meaningful way 10 banach spaces 1 2 a definition and general properties let x and y be normed spaces definition 1 14 bounded operators a linear operator t x y is bounded if there exists a finite constant c 0 such that t x 6 c x x x here and in the rest of this work we write t x instead of the more cumbersome t x a bounded operator is a linear operator that is bounded the infimum ct of all admissible constants c in definition 1 14 is itself admissible thus ct is the least admissible constant we claim that it equals the number t sup x 61 t x to see this let c be an admissible constant in definition 1 14 that is we assume that t x 6 c x for all x x then t sup x 61 t x 6 c this being true for all admissible contants c it follows that t 6 ct the opposite inequality ct 6 t follows by observing that for all x x we have t x 6 t x which means that t an admissible constant this inequality is trivial for x 0 and for x 6 0 it follows from scalar homogeneity the linearity of t and the definition of the number t t x 1 x t x x t x x x 6 t x proposition 1 15 for a linear operator t x y the following assertions are equiv alent 1 t is bounded 2 t is continuous 3 t is continuous at some point x 0 x proof the implication 1 2 follows from t x t x t x x 6 t x x and the implication 2 3 is trivial to prove the implication 3 1 suppose that t is continuous at x 0 then there exists a 0 such that x 0 y implies t x 0 ty 1 since every x x with x is of the form x x 0 y with x 0 y take y x 0 x and t is linear it follows that x implies t x 1 by scalar homogeneity and the linearity of t we may scale both sides with a factor and obtain 1 2 bounded operators 11 that x 1 implies t x 1 from this and the continuity of x 7 x it follows that x 6 1 implies t x 6 1 that is t is bounded and t 6 1 easy manipulations involving the properties of norms and linear operators such as those used in the above proofs will henceforth be omitted the set of all bounded operators from x to y is a vector space in a natural way with respect to pointwise scalar multiplication and addition by putting ct x c t x t t x t x t x this vector space will be denoted by l x y we further write l x l x x for all t t l x y and c k we have ct c t t t 6 t t let us prove the second assertion the proof of the first is similar for all x x the triangle inequality gives t t x 6 t x t x 6 t t x and the result follows by taking the supremum over all x x with x 6 1 noting that t 0 implies t 0 it follows that t 7 t is a norm on l x y endowed with this norm l x y is a normed space if t x y and s y z are bounded then so is their composition st and we have st 6 s t indeed for all x x we have st x 6 s t x 6 s t x and the result follows by taking the supremum over all x x proposition 1 16 if y is complete then l x y is complete proof let tn n 1 be a cauchy sequence in l x y from tnx tmx 6 tn tm x we see that tnx n 1 is a cauchy sequence in y for every x x let t x denote its limit the linearity of each of the operators tn implies that the mapping t x 7 t x is linear and we have t x limn tnx 6 m x where m supn 1 tn is finite since cauchy sequences in normed spaces are bounded this shows that the linear operator t is bounded so it is an element of l x y to prove that limn tn t 0 fix 0 and let n 1 be so large that tn tm for all m n n then for m n n from tnx tmx 6 x 12 banach spaces it follows upon letting m that tnx t x 6 x this being true for all x x and n n it follows that tn t 6 for all n n the important special case y k leads to the following definition definition 1 17 the dual space of a normed space x is the banach space x l x k the elements of the dual space x are often referred to as bounded functionals or simply functionals duality is a subject in its own right which will be taken up in chapter 4 in that chapter explicit representations of duals of several classical banach spaces are given for hilbert spaces this duality takes a particularly simple form described by the riesz representation theorem to be proved in chapter 3 it often happens that a linear operator can be shown to be well defined and bounded on a dense subspace in such cases a density argument can be used to extend the operator to the whole space proposition 1 18 density argument extending operators let x be a normed space and y be a banach space and let x 0 be a dense subspace of x if t 0 x 0 y is a bounded operator there exists a unique bounded operator t x y extending t 0 the norm of this extension satisfies t t 0 proof fix x x and suppose that limn xn x with xn x 0 for all n 1 the boundedness of t 0 implies that t 0 xn t 0 xm 6 t 0 xn xm 0 as m n so t 0 xn n 1 is a cauchy sequence in y since y is complete we have t 0 xn y for some y y if also x n x the same argument shows that t 0 x n y for some possibly different y y from t 0 x n t 0 xn 6 t 0 x n xn 6 t 0 x n x x xn it follows that y y lim n t 0 x n t 0 xn 0 and therefore y y denoting the common limit y y by t x we thus obtain a well defined mapping x 7 t x it is evident that this mapping extends t 0 for if x x 0 we may take xn x and then t x limn t 0 xn t 0 x it is easily checked that t is linear to show that it is bounded with t 6 t 0 we just note that t x lim n t 0 xn 6 t 0 lim n xn t 0 x 1 2 bounded operators 13 the converse inequality t t 0 trivially holds since t extends t 0 finally if the bounded operators t and t both extend t 0 then the bounded operator t t equals 0 on the dense subspace x 0 and hence by continuity on all of x under a uniform boundedness assumption a similar density argument can be used to extend the existence of limits from a dense subspace to the whole space proposition 1 19 density argument extending convergence of operators let x be a normed space and y a banach space and let x 0 be a dense subspace of x let tn n 1 be a sequence of operators in l x y satisfying supn 1 tn if the limit limn tnx 0 exists in y for all x 0 x 0 then the limit t x limn tnx exists in y for all x x moreover the operator t x 7 t x is linear and bounded from x to y and t 6 liminf n tn proof we will show that the sequence tnx n 1 is cauchy for every x x fix arbitrary x x and 0 and choose x 0 x 0 in such a way that x x 0 m where m supn 1 tn since tnx 0 n 1 is a cauchy sequence there is an n 1 such that tnx 0 tmx 0 for all m n n then for all m n n tnx tmx 6 tnx tnx 0 tnx 0 tmx 0 tmx 0 tmx 6 m x x 0 m x 0 x 3 the sequence tnx n 1 is thus cauchy since y is complete this sequence has a limit which we denote by t x linearity of t x 7 t x is clear and boundedness along with the estimate for the norm follow from t x lim n tnx liminf n tnx 6 liminf n tn x this proposition should be compared with proposition 5 3 which provides the fol lowing partial converse if x is a banach space y is a normed space and tn n 1 is a sequence in l x y such that t x limn tnx exists in y for all x x then supn 1 tn definition 1 20 null space and range the null space of a bounded operator t l x y is the subspace n t x x t x 0 the range of t is the subspace r t t x x x 14 banach spaces by linearity both the null space n t and the range r t are subspaces by continu ity the null space of a bounded operator is closed the following result gives a useful sufficient criterion for the range of a bounded operator to be closed proposition 1 21 let x be a banach space and y be a normed space if t l x y satisfies t x c x for some c 0 and all x x then t is injective and has closed range proof injectivity is clear suppose that t xn y in y we must prove that y r t from xn xm 6 c 1 t xn t xm it follows that xn n 1 is a cauchy sequence in x and therefore converges to some x x then y limn t xn t x we conclude by introducing some terminology that will be used throughout this work in the next four definitions x and y are normed spaces definition 1 22 isomorphisms an isomorphism is a bijective operator t l x y whose inverse is bounded as well an isometric isomorphism is an isomorphism that is also isometric the spaces x and y are called isometrically isomorphic if there exists an isometric isomorphism from x to y definition 1 23 contractions a contraction is an operator t l x y satisfying t 6 1 definition 1 24 uniform boundedness a subset t of l x y is said to be uniformly bounded if it is a bounded subset of l x y i e if supt t t definition 1 25 uniform strong and weak convergence of operators a sequence tn n 1 in l x y is said to 1 converge uniformly to an operator t l x y if lim n tn t 0 2 converge strongly to an operator t l x y if lim n tnx t x 0 x x 3 converge weakly to an operator t l x y if lim n tnx t x y 0 x x y y where y is the dual of y in these situations we call t the uniform limit respectively the strong limit respectively the weak limit of the sequence tn n 1 uniform convergence implies strong convergence and strong convergence implies weak convergence but the converses generally fail for instance the projections onto the first n coordinates in p 16 p converge strongly to the identity operator but not 1 2 bounded operators 15 uniformly and the operators t n where t is the right shift in p 1 p converges weakly to the zero operator but not strongly for the case p 1 see problem 4 33 1 2 b subspaces quotients and direct sums restrictions if t is a bounded operator from a normed space x into a normed space y then the restriction of t to a subspace x 0 of x defines a bounded operator t x 0 from x 0 into y of norm t x 0 6 t quotients let y be a closed subspace of a banach space x by the definition of the quotient norm the quotient map q x 7 x y is bounded from x to x y of norm q 6 1 let z be a normed space and let t l x z be a bounded operator with the property that y is contained in the null space n t we claim that t y x y t x x x defines a well defined and bounded quotient operator t y x y z of norm t y t well definedness of t y is clear and for all x x and y y we have t x t x y 6 t x y taking the infimum over all y y gives the bound t y x y t x 6 t inf y y x y t x y hence t y is bounded and t y 6 t for the converse inequality we note that t x t y x y 6 t y x y t y inf y y x y 6 t y x direct sums if xn is a normed space and tn l xn for n 1 n then the direct sum operator t n n 1 tn x 1 xn 7 t 1 x 1 tnxn is bounded on x n n 1 xn with respect to any product norm this follows from 1 2 if the product norm is of the form 1 1 then t max 16 n 6 n tn 1 2 c first examples we revisit the examples of section 1 1 c and discuss how various natural operations used in analysis give rise to bounded operators 16 banach spaces example 1 26 matrices every m n matrix a ai j m n i j 1 defines a bounded operator in l kn km and its norm satisfies a 2 sup x 61 ax 2 sup x 61 m i 1 n j 1 ai jx j 2 6 m i 1 n j 1 ai j 2 1 3 where the last step follows from the cauchy schwarz inequality more generally every linear operator from a finite dimensional normed space x into a normed space y is bounded this will be shown in corollary 1 37 the upper bound 1 3 for the norm of a matrix a is not sharp an explicit method to determine the operator norm of a matrix is described in problem 4 14 example 1 27 point evaluations let k be a compact topological space for each x 0 k the point evaluation ex 0 f 7 f x 0 is bounded as an operator from c k into k with norm ex 0 1 boundedness with norm ex 0 6 1 follows from ex 0 f f x 0 6 sup x k f x f by considering f 1 the constant one function on k it is seen that ex 0 1 example 1 28 integration let f be a measure space the mapping i f 7 f d is bounded from l 1 to k with norm i 1 boundedness with norm i 6 1 follows from i f f d 6 f d f 1 by considering nonnegative functions it is seen that i 1 example 1 29 pointwise multipliers let f be a measure space and fix 1 6 p 6 for any m l the pointwise multiplier tm f 7 m f defines a bounded operator on lp with norm tn m indeed for almost all we have m f m f 6 m f for 16 p upon integration we obtain tm f pp m f p d 6 m p f p d m p f pp tm is bounded on lp and tm 6 m for p the analogous bound follows by taking essential suprema equality tm m is obtain by considering for 0 1 functions supported on measurable sets f f where m 1 m almost everywhere 1 2 bounded operators 17 example 1 30 integral operators let be a finite borel measure on a compact metric space k with respect to the product metric d s t s t d s t d s t k k is a compact metric space see proposition d 13 let k c k k and define for f c k the function t f k k by t f s k k s t f t d t s k using the uniform continuity of k see theorem d 12 it is easy to see that t f is a continuous function indeed given 0 choose 0 so small that d s t s t implies k s t k s t then d s s implies t f s t f s 6 k f t d t 6 k f as a result t acts as a linear operator on c k to prove boundedness we estimate t f s 6 k k s t f t d t 6 k k f taking the supremum over s k this results in t f 6 k k f it follows that t is bounded and t 6 k f for kernels k l k k the same prescription defines a bounded opera tor on l k satisfying the same estimate if one takes k l 2 k k this prescription gives a bounded operator t on l 2 k satisfying t f 2 6 k 2 f 2 1 4 indeed by the cauchy schwarz inequality its abstract version for hilbert spaces will be proved in chapter 3 and fubini s theorem we obtain k k k s t f t d t 2 d s 6 k k k s t 2 d t k f t 2 d t d s k 22 f 2 2 and the claim follows this inequality generalises the one of example 1 26 example 1 31 volterra operator for all f l 2 0 1 the cauchy schwarz inequality implies that the indefinite integral t f s s 0 f t dt s 0 1 is well defined and that t f s t f s 6 s s 1 2 f 2 for all s s 0 1 from this we infer that t f c 0 1 and by taking s 0 that t f 6 f 2 this implies that t is bounded from l 2 0 1 into c 0 1 with norm t 6 1 18 banach spaces for functions g c 0 1 the pointwise estimate g t 6 g implies 1 0 g t 2 dt 6 g 2 so g l 2 0 1 and g 2 6 g this shows that c 0 1 defines a subspace of l 2 0 1 with an inclusion mapping that is bounded of norm at most 1 composing t with this in clusion mapping the indefinite integral can be viewed as a bounded operator on l 2 0 1 of norm at most 1 interestingly this norm bound is not sharp it can be shown that the norm of this operator equals 2 this will be proved using the spectral theory of self adjoint operators in chapter 8 as this brief list of examples already shows operators occurring naturally in analysis have a tendency to be bounded this raises the natural question whether linear operators acting between banach spaces x and y are always bounded if one is willing to accept the axiom of choice the answer is negative even for separable hilbert spaces x and y k see problem 3 23 in zermelo fraenkel set theory without the axiom of choice it is consistent that every linear operator acting between banach spaces is bounded the reader is referred to the notes to chapter 3 for a further discussion of this topic 1 3 finite dimensional spaces the aim of this section is to prove that every finite dimensional normed space is a banach space this will be deduced as an easy consequence of the fact that every two norms on a finite dimensional normed space are equivalent in the sense made precise in the next definition definition 1 32 equivalent norms two norms and on a vector space x are equivalent if there exist constants 0 c 6 c such that for all x x we have c x 6 x 6 c x example 1 33 any two product norms on the product x x 1 xn of normed spaces are equivalent indeed 1 2 shows that every product norm on x is equivalent to the product norm x 1 nn 1 xn on x in the above situation we have the inclusions of open balls b x r c b x r b x r c hence if two norms on a given vector space are equivalent the resulting normed spaces have the same open sets this implies that topological notions such as openness closed ness compactness convergence and so forth are preserved under passing to an equiv alent norm 1 3 finite dimensional spaces 19 theorem 1 34 equivalence of norms in finite dimensions every two norms on a finite dimensional vector space are equivalent proof let x be a finite dimensional normed space say of dimension d and let x j dj 1 be a basis for x relative to this basis every x x admits a unique representa tion x dj 1 c jx j we may use this to define a norm 2 on x by d j 1 c jx j 2 d j 1 c j 2 1 2 the theorem follows once we have shown that the norms and 2 are equivalent let m max 16 j 6 d x j by the triangle inequality and the cauchy schwarz inequal ity for all x dj 1 c jx j we have x 6 d j 1 c j x j 6 m d j 1 c j 6 md 1 2 d j 1 c j 2 1 2 md 1 2 x 2 1 5 this gives one of the two inequalities in the definition of equivalence of norms to prove that a similar inequality holds in the opposite direction let s 2 denote the unit sphere in x 2 since c 1 cd 7 dj 1 c jx j maps the unit sphere ofk d iso metrically hence continuously onto s 2 s 2 is compact consider the identity mapping i x 7 x viewed as a mapping from s 2 to x the inequality 1 5 implies that i is bounded and therefore continuous since taking norms is continuous as well and s 2 is compact the mapping x 7 ix is continuous from s 2 to 0 and takes a minimum at some point x 0 s 2 denoting this minimum by m we claim that m 0 it is clear that m 0 reasoning by contradiction if we had m ix 0 0 then ix 0 0 in x hence x 0 0 as an element of s 2 then x 0 2 0 while at the same time x 0 2 1 because x 0 s 2 this contradiction proves the claim for any nonzero x x we have x x 2 s 2 and therefore i x x 2 m this gives the estimate m x 2 6 ix x for nonzero x x for trivial reasons it also holds for x 0 corollary 1 35 every d dimensional normed space is isomorphic to kd in particular every finite dimensional normed space is a banach space proof the first assertion has been proved in the course of the proof of theorem 1 34 and the second assertion follows from it since kd is complete corollary 1 36 every finite dimensional subspace of a normed space is closed 20 banach spaces proof by corollary 1 35 every a finite dimensional subspace of a normed space is complete and it has been shown in the first paragraph of section 1 1 b that every com plete subspace of a normed space is closed corollary 1 37 every linear operator from a finite dimensional normed space x into a normed space y is bounded proof let x j dj 1 be a basis for x if t x y is linear for x d j 1 c jx j we obtain by the cauchy schwarz inequality t x d j 1 c jt x j 6 d j 1 c j t x j 6 md 1 2 x 2 where x 2 dj 1 c j 2 1 2 as in theorem 1 34 and m max 16 n 6 d t xn by the orem 1 34 there exists a constant k 0 such that x 2 6 k x for all x x combining this with the preceding estimate we obtain t x 6 md 1 2 x 2 6 kmd 1 2 x this means that t is bounded with norm at most kmd 1 2 every bounded subset of a finite dimensional normed space x is relatively compact this follows from the corresponding result for kd and the fact that x is isomorphic to kd for some d 1 by corollary 1 35 conversely a normed space with the property that every bounded subset is relatively compact is finite dimensional theorem 1 38 finite dimensional banach spaces the unit ball of a normed space x is relatively compact if and only if x is finite dimensional the proof depends on the following lemma lemma 1 39 riesz if y is a proper closed subspace of a normed space x then for every 0 there exists a norm one vector x x with d x y 1 here d x y infy y x y is the distance from x to y proof fix any x 0 x y such x 0 exists since y is a proper subspace of x fix 0 and choose y 0 y such that x 0 y 0 6 1 d x 0 y the vector x 0 y 0 x 0 y 0 has norm one and for all y y we have x 0 y 0 x 0 y 0 y x 0 y 0 y x 0 y 0 x 0 y 0 d x 0 y 1 d x 0 y 1 1 it follows that d x 0 y 0 x 0 y 0 y 1 1 since 1 1 1 as 0 this completes the proof 1 4 compactness 21 proof of theorem 1 38 it remains to prove the only if part suppose that x is infinite dimensional and pick an arbitrary norm one vector x 1 x proceeding by induction suppose that norm one vectors x 1 xn x have been chosen such that xk x j 12 for all 1 6 j 6 k 6 n choose a norm one vector xn 1 x by applying riesz s lemma to the proper closed subspace yn span x 1 xn and 12 that yn is closed follows from corollary 1 36 then xn 1 x j 12 for all 16 j 6 n the resulting sequence xn n 1 is contained in the closed unit ball of x and satisfies x j xk 1 for all j 6 k 1 so xn n 1 has no convergent subsequence it follows that the closed unit ball of x is not compact 1 4 compactness let x be a normed space by theorem 1 38 the collections of bounded subsets of x and relatively compact subsets of x coincide if and only if x is finite dimensional thus in infinite dimensional spaces relative compactness is a stronger property than bound edness the purpose of the present section is to record some easy but useful general results on compactness that will be frequently used compactness in the spaces c k and lp will be studied in the next chapter and compact operators that is operators which map bounded sets into relatively compact sets are studied in chapter 7 by a general result in the theory of metric spaces theorem d 10 every relatively compact set in a normed space is totally bounded and the converse holds in banach spaces this fact is used in the proof of the following necessary and sufficient condition for compactness for sets a and b in a vector space v we write a b u v u a v b proposition 1 40 a subset s of a banach space x is relatively compact if and only if for all 0 there exists a relatively compact set k x such that s k b 0 proof if the existence of the sets k implies that s is totally bounded and hence relatively compact for if the balls b x 1 b xn cover k then the balls b x 1 2 b xn 2 cover s only if this is trivial take k s for all 0 the convex hull of a subset f of a vector space v is the smallest convex set in v containing f this set is denoted by co f when f is a subset of a normed space the closure of co f is denoted by co f and is referred to as the closed convex hull of f as a first application of proposition 1 40 we have the following result proposition 1 41 the closed convex hull of a compact set in a banach space is com pact 22 banach spaces proof let k be a compact subset of the banach space x for every n 1 the set con k n n 1 nxn xn k and 06 n 6 1 for all n 1 n n n 1 n 1 is contained in the image of the compact set 0 1 n kn under the continuous mapping that sends 1 n x 1 xn to n n 1 nxn let 0 be arbitrary let the open balls b 1 b m cover k and consider an element x co k say kj 1 jx j for each j 1 k let 16 m j 6 m be an index such that x j m j minm 1 m x j m then x k j 1 j m j 6 k j 1 j x j m j k j 1 j since kj 1 j m j m m 1 j m j m j m com k this implies that x com k b 0 this shows that co k com k b 0 it now follows from proposition 1 40 that co k is relatively compact the second result asserts that strong convergence implies uniform convergence on relatively compact sets proposition 1 42 let x and y be normed spaces let the operators tn l x y n 1 be uniformly bounded and let t l x y if limn tn t strongly then for all relatively compact subsets k of x we have lim n sup x k tnx t x 0 it will be shown in proposition 5 3 that if x is a banach space strong convergence tn t already implies uniform boundedness of the operators tn proof let k be a relatively compact subset of x let 0 be arbitrary and select finitely many open balls b x 1 b xk covering k choose n 1 so large that tnx j t x j for all n n and j 1 k let m supn 1 tn this number is finite by assumption fixing an arbitrary x k choose 16 j 0 6 k such that x x j 0 then for n n tnx t x 6 tnx tnx j 0 tnx j 0 t x j 0 t x j 0 t x 6 m m 2 m 1 taking the supremum over x k it follows that if n n then sup x k tnx t x 6 2 m 1 1 5 integration in banach spaces 23 since 0 was arbitrary this proves the final assertion 1 5 integration in banach spaces in a variety of circumstances some of which will be encountered in later chapters one wishes to integrate x valued functions where x is a banach space in order to have the tools available when they are needed we insert a brief discussion of the x valued counterparts of the riemann and lebesgue integrals 1 5 a the riemann integral let k be a compact metric space and let be a finite borel measure on k we will set up the riemann integral with respect to for continuous functions f k x to this end we need the following terminology a partition of k is a finite collection of pairwise disjoint borel subsets of k whose union equals k the mesh of a partition is the diameter of the largest subset in the partition proposition 1 43 riemann integral let be a finite borel measure on a compact metric space k let x be a banach space and let f k x be a continuous function there exists a unique element in x denoted by k f d with the following property for every 0 there exists a 0 such that whenever kn nn 1 is a partition of k of mesh less than and tn nn 1 is a collection of points in k with tn kn for all n 1 n then k f d n n 1 kn f tn the proof of this theorem follows the undergraduate construction of the riemann integral for continuous functions f 0 1 k step by step and is therefore omitted the element k f d is called the riemann integral of f with respect to whenever this is convenient we use the more elaborate notation k f t d t proposition 1 44 let be a finite borel measure on a compact metric space k let x be a banach space and let f k x be a continuous function then k f d 6 k f d proof for any partition kn nn 1 of k and any collection of points tn n n 1 in k with tn kn for all n 1 n we have n n 1 kn f tn 6 n n 1 kn f tn 24 banach spaces by the triangle inequality the result follows by taking the limit along any sequence of partitions whose meshes tend to zero in the special case where k 0 1 and is the lebesgue measure the usual calculus rules apply defining differentiability of an x valued function in the obvious way proposition 1 45 let x be a banach space and let f 0 1 x be a function then 1 if f is differentiable at the point t 0 0 1 then f is continuous at t 0 2 if f is differentiable on 0 1 and f 0 on 0 1 then f is constant on 0 1 3 if f is continuously differentiable on 0 1 then 1 0 f t dt f 1 f 0 proof 1 fix an arbitrary 0 the assumption implies there exists 0 such that if t 0 1 with t t 0 then f t f t 0 t t 0 f t 0 then f t f t 0 f t 0 t t 0 and continuity at t 0 follows 2 the usual calculus proof via rolle s theorem does not extend to the present setting as it uses the order structure of the real numbers fix an arbitrary 0 for each t 0 1 the assumption f t 0 implies that there exists h t 0 such that the interval it t h t t h t is contained in 0 1 and f t f s 6 t s s it fix a closed subinterval a b 0 1 the intervals it t a b cover the compact set a b and therefore this set is contained in the union of finitely many intervals it 1 itn by adding the intervals ia and ib and relabelling and perhaps discarding some of the intervals we may assume that a t 1 b tn and itn itn 1 6 for n 1 n 1 choosing sn itn itn 1 we have f tn 1 f tn 6 f tn 1 f sn f sn f tn 6 tn 1 sn sn tn tn 1 tn now let t a b say t itk then f t f a 6 f t f tk f tk f tk 1 f t 2 f t 1 6 t tk tk tk 1 t 2 t 1 t a this being true for all 0 it follows that f t f a for all t a b this proves that f is constant on every subinterval a b 0 1 and therefore on 0 1 1 5 integration in banach spaces 25 3 for the function g 0 1 x g t f t t 0 f s ds we have lim h 0 1 h g t h g t f t lim h 0 1 h t h t f s ds 0 by continuity and therefore g is continuously differentiable on 0 1 with derivative g 0 it follows from 2 that g is constant on 0 1 hence on 0 1 by continuity and then g 0 f 0 implies f t t 0 f s ds g t g 0 f 0 t 0 1 taking t 1 gives the result in chapter 4 we will sketch a different proof using duality 1 5 b the bochner integral we turn next to the more delicate problem of generalising the lebesgue integral to functions taking values in a banach space x the results of this section will be needed only in chapter 13 in what follows we fix a measure space f it is a matter of experience that if one attempts to define the measurability of a function f x by imposing that f 1 b be in f for all borel equivalently for all open subsets of x one arrives at a notion of measurability that is not very practical the problem being that it does not connect well with approximation theorems such as the dominated convergence theorem it turns out that it is better to start from the following necessary and sufficient condition for measurability in the scalar valued setting a scalar valued function is measurable if and only if it is the pointwise limit of a sequence of simple functions for a function f k and x x we define f x x by f x f x 1 6 definition 1 46 simple functions strong measurability a function f x is called simple if it is a finite linear combination of functions of the form 1 f x with f f and x x and strongly measurable if it is the pointwise limit of a sequence of simple functions a scalar valued function is strongly measurable if and only if it is measurable and for such functions we omit the adjective strongly theorem 1 47 pettis measurability theorem first version a function f x is strongly measurable if and only if f takes its values in a separable closed subspace x 0 of x and the nonnegative functions f x 0 are measurable for all x 0 x 0 a second version of this theorem will be proved in chapter 4 see theorem 4 19 26 banach spaces proof if let xn n 1 be dense in x 0 and define the functions n x 0 x 1 xn as follows for each y x 0 let k n y be the least integer 16 k 6 n such that y xk min 16 j 6 n y x j and put n y xk n y since xn n 1 is dense in x 0 we have lim n n y y 0 y x 0 now define n x by n n f we have n x 1 f x 1 min 16 j 6 n f x j and for 26 k 6 n n xk f xk min 16 j 6 n f x j min 16 j k 1 f x j in both identities the set on the right hand side is in f hence each n is simple takes values in x 0 and for all we have lim n n f lim n n f f 0 only if let fn f pointwise with each fn simple let x 0 be the closed linear span of the ranges of the functions fn then x 0 is separable and f takes its values in x 0 moreover 7 f x 0 limn fn x 0 is measurable corollary 1 48 if limn fn f pointwise with each fn strongly measurable then f is strongly measurable proof we check the conditions of the pettis measurability theorem every function fn x is the pointwise limit of a sequence of simple functions fnm x and every fnm takes at most finitely many different values it follows that f takes its values in the closed linear span of these countably many finite sets which is a separable subspace of x the measurability of the functions fn x 0 implies that f x 0 is measurable definition 1 49 simple functions a simple function f nn 1 1 fn xn is called simple if fn for all n 1 n for such functions we define f d n n 1 fn xn 1 5 integration in banach spaces 27 we leave it as a simple exercise to verify that f d is well defined in the sense that it does not depend on the representation of f as a linear combination of functions 1 fn xn with fn if f is simple the triangle inequality implies f d 6 f d 1 7 definition 1 50 bochner integral a strongly measurable function f x is said to be bochner integrable with respect to if there is a sequence of simple functions fn x such that lim n f fn d 0 1 8 in that case we define the bochner integral of f by f d lim n fn d 1 9 the nonnegative functions f fn are measurable by the pettis measurability theo rem so the integral in 1 8 is well defined the limit in 1 9 exists since the assumption together with 1 7 applied to fn fm implies that fn d n 1 is a cauchy sequence in x we leave it as another simple exercise to verify that f d is well defined in the sense that it does not depend on the sequence of approximating functions fn it is equally elementary to verify that if k is a compact metric space and f is its borel algebra then every continuous function f k x is bochner integrable with respect to and the bochner integral coincides with the riemann integral proposition 1 51 a strongly measurable function f x is bochner integrable with respect to if and only if f d in this situation we have f d 6 f d proof if let f be a strongly measurable function satisfying f d let gn be simple functions such that limn gn f pointwise and define fn 1 gn 62 f gn then each fn is simple and we have limn fn f pointwise since fn 6 2 f point wise and f d each fn is simple and by dominated convergence we obtain lim n f fn d 0 28 banach spaces only if if f is bochner integrable and the simple function g x is such that f g d 6 1 then f d 6 1 g d the final assertion follows from 1 7 by approximation problems 1 1 show that in any normed space x for all x 0 x and r 0 the following assertions hold a b x 0 r x x x x 0 r is an open set b b x 0 r x x x x 0 6 r is a closed set c b x 0 r b x 0 r that is b x 0 r is the closure of b x 0 r 1 2 let x be a normed space a show that if x y x satisfy x y with 0 x then y 6 0 and x x y y 2 b show that the constant 2 in part a is the best possible 1 3 show that a norm on the product x x 1 xn of normed spaces is a product norm if and only if x 6 x 6 x 1 for all x x 1 xn x where x max 16 n 6 n xn x 1 n n 1 xn 1 4 show that if x x 1 xn is a direct sum of normed spaces then each sum mand xn is closed as a subspace of x 1 5 prove that if t l x y is bounded then t sup x 1 t x sup x 1 t x 1 6 let x and y be normed spaces and let t l x y prove that for all x x and r 0 we have sup y b x r ty r t 1 7 let x 0 c 1 c 0 1 be the vector space of all c 1 functions f 0 1 k with compact support in 0 1 a show that x f c 0 1 f 0 f 1 0 is a banach space and that x 0 is dense in x problems 29 b show that for each f x 0 the limit limn tn f exists with respect to the norm of x and equals f where tn f t f t 1 n f t 1 n c show that there are functions f x for which the limit limn tn f does not exist in x this example shows that the uniform boundedness assumption cannot be omitted in proposition 1 19 1 8 show that if two norms and on a normed space x are equivalent then the norms of the completions of x and x are equivalent 1 9 let and be two norms on a vector space x show that the following assertions are equivalent 1 there exists a constant c 0 such that x 6 c x for all x x 2 every open set in x is open in x 3 every convergent sequence in x is convergent in x 4 every cauchy sequence in x is cauchy in x 1 10 let x be a banach space with respect to the norms and suppose that and agree on a subspace y that is dense in x with respect to both norms a show that the norms agree on all of x hint apply proposition 1 18 to the identity mapping on y viewed as a map ping from the normed space y to the normed y and as a map ping in the opposite direction b comment on the following solution to part a let x x be fixed and using density choose a sequence xn x with xn y for all n 1 then x limn xn limn xn x 1 11 provide the details to the if part of the proof of proposition 1 13 1 12 let x be a normed space a show that if x is separable then the completion of x is separable b show that if x is a banach space and y is a closed subspace of x then x is separable if and only if both y and x y are separable 1 13 determine whether the following sets are open and or closed in c 0 1 a f c 0 1 f t 0 for all t 0 1 b f c 0 1 f t 0 for all t 0 1 1 14 this problem gives an example of a bounded operator that does not attain its norm let x be the space of continuous functions f 0 1 k satisfying f 0 0 a show that x is a closed subspace of c 0 1 30 banach spaces thus with the norm inherited from c 0 1 x is a banach space b show that the operator t x k t f 1 0 f t dt is bounded and has norm t 1 c prove that t f 1 for all f x with f 6 1 1 15 this problem gives an example of a bounded operator whose range is not closed consider the linear operator t on c 0 1 given by the indefinite integral t f t t 0 f s ds t 0 1 a show that t is bounded and compute its norm b show that r t f c 1 0 1 f 0 0 and conclude that r t is a proper dense subspace of c 0 1 1 16 let x be a banach space and y be a normed space show that if t x y is a bounded operator satisfying t x c x for some c 0 and all x x then its range r t is complete and t is an isomorphism from x to r t 1 17 let x and y be finite dimensional normed spaces prove that if tn t l x y then the following assertions are equivalent 1 limn tn t uniformly 2 limn tn t strongly 3 limn tn t weakly 1 18 let 16 p a show that p is a dense subspace of c 0 b show that the inclusion mapping of p into c 0 is bounded 1 19 show that a normed space x and its completion x have the same dual that is the restriction mapping x 7 x x is an isometric isomorphism from x onto x 1 20 let x be a real vector space the product x x can be given the structure of a complex vector space by introducing a complex scalar multiplication as follows a ib x y ax by bx ay the idea is to think of the pair x y x x as x iy a check that this formula for the scalar multiplication does indeed turn x x into a complex vector space the resulting complex vector space is denoted by xc suppose now that x is a real normed space problems 31 b prove that the formula x y sup 0 2 cos x sin y defines a norm on xc which turns it into a complex normed space show that xc is a banach space if and only if x is a banach space c show that this norm on xc extends the norm of x in the sense that x 0 0 x x for all x x d show that x y x y for all x y x e show that any two norms on xc which satisfy the identities in parts c and d are equivalent 1 21 let x be a real banach space and let xc be the complex banach space constructed in problem 1 20 a show that if t is a real linear bounded operator on x then t extends to a bounded complex linear operator tc on xc by putting tc x y t x ty b show that tc t 1 22 as a variation on proposition 1 40 show that a bounded subset s of a banach space x is relatively compact if and only if for every 0 there exists a finite dimensional subspace x of x such that s x b 0 1 23 show that a subset k of a banach space x is relatively compact if and only if k is contained in the closed convex hull of a sequence xn n 1 in x satisfying limn xn 0 hint for the only if part cover k with finitely many balls of radius 3 n and let cn be the set of their centres n 1 2 let d 1 c 1 and for n 2 dn cn cn 1 cn cn cn 1 cn 1 cn cn 1 3 n 1 check that each x k can be represented as an absolutely convergent sum x n 1 dn with dn dn consider the sequence xn n 1 given by xn 2 ndn 1 24 let f be a measurable space adapting the proof of theorem 1 47 show that if f x is strongly measurable there are simple functions fn x such that fn f and fn 6 f pointwise 1 25 let k be a compact metric space let a finite borel measure on k and let x be a banach space prove that every continuous function f k x is bochner inte grable with respect to and that its bochner integral equals its riemann integral 1 26 let f be a measure space and let x 0 be a closed subspace of the banach space x let f x satisfy f x 0 for almost all show a if f is strongly measurable as an x valued function then f is strongly mea surable as an x 0 valued function 32 banach spaces b if f is bochner integrable as an x valued function then f is bochner inte grable as an x 0 valued function 1 27 let f be a measure space show that if t x y is a bounded opera tor and f x is bochner integrable with respect to then t f y is bochner integrable with respect to and t f d t f d 1 28 let f be a measure space and let f be a measurable space let be measurable and let f x be strongly measurable let 1 be the image measure of under a show that f is strongly measurable b show that f is bochner integrable with respect to if and only if f is bochner integrable with respect to and that in this situation we have f d f d 1 29 let f be a probability space prove that if f x is bochner inte grable then f d co f 2 the classical banach spaces before proceeding any further we pause to undertake a detailed study of the classical banach spaces introduced in the previous chapter 2 1 sequence spaces besides the finite dimensional spaces kd perhaps the simplest examples of banach spaces are provided by the class of sequence spaces by definition these are spaces of sequences which endowed with a suitable norm turn into banach spaces here we introduce the most important sequence spaces viz c 0 and p 16 p 6 the spaces c 0 and the space c 0 consisting of all scalar sequences a ak k 1 satisfying limk ak 0 is a banach space with respect to the supremum norm a sup k 1 ak a justification of this notation is given in the next paragraph that this is indeed a norm is left as an exercise the proof of completeness runs as follows suppose a n n 1 is a cauchy sequence in c 0 then each coordinate sequence a n k n 1 is cauchy in k and therefore has a limit which we denote by ak we wish to prove that the sequence a ak k 1 belongs to c 0 and that limn a n a 0 fix 0 and choose n so large that a n a m for all m n n choose n this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 33 34 the classical banach spaces so large that a n k for all k n then for k n ak 6 ak a n k a n k limm a m k a n k a n k 6 2 it follows that limk ak 0 so a c 0 finally for all k 1 and m n n we have a n k a m k letting m while keeping n fixed for all k 1 we obtain a n k ak 6 taking the supremum over k 1 we infer that a n a 6 for all n n and the convergence a n a in c 0 follows in the same way one proves that the space consisting of all bounded scalar se quences a ak k 1 is a banach space with respect to the supremum norm this space contains c 0 isometrically as a closed subspace the spaces p for 16 p the space p of scalar sequences a ak k 1 satisfying a p k 1 ak p 1 p is finite is a banach space with respect to the norm p that this is indeed a norm on p is nontrivial the validity of the triangle inequality a b p 6 a p b p can be proved by following the line of proof of proposition 2 19 completeness of p can be proved as in theorem 2 20 alternatively these facts can be deduced as special cases of proposition 2 19 and theorem 2 20 by taking 1 2 3 with the counting measure that is the measure which assigns mass 1 to every element of it is easy to see see problem 2 1 that 16 p 6 q 6 implies p q and a q 6 a p for all a p and that if a p for some 16 p then lim q q p a q a this justifies the notation for the supremum norm remark 2 1 in some applications it is useful to use countable index sets i other than the positive integers we then define a p i n 1 ain p 1 p where in n 1 is an enumeration of i this definition is independent of the choice of the enumeration and the space p i of all mappings a i k for which this expression is finite is again a banach space 2 2 spaces of continuous functions 35 2 2 spaces of continuous functions in this section we study some properties of the space c k of continuous functions defined on a compact topological space k 2 2 a completeness it is a standard result in any introductory course in analysis that the uniform limit of a sequence of continuous functions is continuous the following theorem recasts this result as a completeness result theorem 2 2 completeness let k be a compact topological space the space c k is a banach space with respect to the supremum norm f sup x k f x the elementary verification that this is indeed a norm is left to the reader the above supremum is finite and actually a maximum since k is compact proof suppose that fn n 1 is a cauchy sequence in c k then for each x k fn x n 1 is a cauchy sequence in k and therefore convergent to some limit in k which we denote by f x we will prove that the function f thus defined is continuous and that limn fn f 0 fix 0 and choose n 1 so large that fn fm for all m n n then in particular for all m n n and all x k we have fn x fm x passing to the limit m while keeping n fixed we obtain fn x f x 6 2 1 now fix x k arbitrary and let u k be an open set containing x such that fn x fn x whenever x u then for x u f x f x 6 f x fn x fn x fn x fn x f x 6 3 where we applied 2 1 to n n and the points x and x an argument of this type is called a 3 argument this proves the continuity of f at the point x since x k was arbitrary f is continuous and therefore belongs to c k finally since 2 1 holds for all x k it follows that fn f sup x k fn x f x 6 for all n n this proves that limn fn f 0 we give three more examples of spaces of functions that are banach spaces with respect to the supremum norm the proofs that these spaces are complete are similar to the ones for c 0 and c k and are left as an exercise 36 the classical banach spaces the space bb x of bounded borel measurable functions on a topological space x the space cb x of bounded continuous functions on a topological space x the space c 0 x of continuous functions on a locally compact topological space x which vanish at infinity the precise definitions are given in section 4 1 c 2 2 b the stone weierstrass approximation theorem the stone weierstrass theorem provides a useful density criterion for the spaces c k we begin with the more elementary weierstrass approximation theorem for k a b theorem 2 3 weierstrass approximation theorem the polynomials with coefficients in k are dense in c a b proof by translation and scaling it suffices to prove the theorem for the space c 0 1 our proof is constructive in that it produces an actual sequence of polynomials approx imating a given function let f c 0 1 be arbitrary and fixed and define the bernstein polynomials associated with f by b f n x n k 0 n k f k n xk 1 x n k x 0 1 n n we will show that limn b f n f 0 to begin with the binomial identity n k 0 n k xk 1 x n k x 1 x n 1 2 2 implies b f n x f x n k 0 n k xk 1 x n k f k n f x fix an arbitrary 0 since f is uniformly continuous there is a real number 0 1 such that f x f x whenever x x 0 1 satisfy x x fix x 0 1 and set i 06 k 6 n kn x and i 06 k 6 n k 6 i the sum over the indices k i can be estimated by k i n k xk 1 x n k f k n f x 6 n k 0 n k xk 1 x n k 2 3 while for k i we have 2 6 kn x 2 and therefore 2 k i n k xk 1 x n k f k n f x 6 k i k n x 2 n k xk 1 x n k f k n f x 6 2 f n k 0 k n x 2 n k xk 1 x n k 2 2 spaces of continuous functions 37 2 f x 1 x n 6 2 n f where in we used the binomial identity 2 2 in combination with the identities which are proved by induction on n n k 0 k n n k xk 1 x n k x n k 0 k n 2 n k xk 1 x n k n 1 n x 2 1 n x to see that n k 0 k n x 2 n k xk 1 x n k n 1 n x 2 1 n x 2 x x x 2 1 x 1 x n combining things we obtain b f n x f x 6 2 2 n f since this inequality holds for all x 0 1 and 0 it follows that b f n f 6 2 2 n f this shows that f can be approximated arbitrarily well by polynomials remark 2 4 the same argument shows that if f 0 1 k is any function which is continuous at a point x 0 0 1 then limn b f n x 0 f x 0 the proof of theorem 2 3 has an interesting connection with the law of large num bers suppose 1 2 3 are independent identically distributed random variables taking the values 0 and 1 with probability 1 p and p respectively let sn 1 n n k 1 k suppose that f 0 1 k is continuous at a point x 0 0 1 denoting expectation and probability by e and p respectively e f sn n k 0 f k n p sn k n and p sn k n n k pk 1 p n k from remark 2 4 we therefore obtain lim n e f sn lim n n k 0 n k f k n pk 1 p n k lim n b f n p f p 38 the classical banach spaces in particular we recover the weak law of large numbers which is the assertion that this convergence holds for all f c 0 1 the proof of the weierstrass theorem using bernstein polynomials offers little room for generalisation but the theorem itself does admit a far reaching generalisation theorem 2 5 stone weierstrass theorem algebra version let k be a compact haus dorff space and suppose that y is a subspace of c k with the following properties i 1 y ii g y implies g y iii g y and h y implies gh y iv y separates the points of k then y is dense in c k by definition condition iv means that for any two distinct points x y k there exists a function g y such that g x 6 g y as a preliminary observation we note that it suffices to prove the theorem for real valued functions indeed the complex version of the theorem follows from the real version as follows if g y then the real valued functions reg 12 g g and img 1 2 i g g belong to y from this it is easy to see that the real linear space yr of all real valued functions contained in y satisfies i iv again now if f u iv c k we may use the real version of the theorem with y replaced by yr to approximate u and v by functions un vn yr then the functions un ivn approximate f the real version of the theorem will be deduced from its companion where condition iii is replaced by closedness under taking pointwise absolute values theorem 2 6 stone weierstrass theorem lattice version let k be a compact haus dorff space and suppose that y is a subspace of c k with the following properties i 1 y ii g y implies g y iii g y implies g y iv y separates the points of k then y is dense in c k proof reasoning as before it suffices to prove the theorem over the real scalars for the minimum a b min a b and maximum a b max a b we have the formulas a b 1 2 a b a b a b 1 2 a b a b they imply that y is closed under taking pointwise maxima and minima 2 2 spaces of continuous functions 39 fix f c k and 0 step 1 we prove that for each x k there exists a function gx y such that gx x f x and gx f pointwise since y is a subspace containing the constant functions and separating the points of k for all y k there exists a function gxy y such that gxy x f x and gxy y f y the set uxy z k gxy z f z is open and contains both x and y since k is compact the open cover uxy y k has a finite subcover say uxyn n 1 nx the function gx gxy 1 gxynx has the required properties step 2 we prove that there exists a function g y such that f g f this implies f g 6 and concludes the proof for each x k the set ux z k f z gx z is open and contains x since k is compact the open cover ux x k has a finite subcover say uxn n 1 n the function g gx 1 gxn has the required properties proof of theorem 2 5 as has already been noted that it suffices to prove the theorem over the real scalar field let y be a subspace of c k with the properties i iv stated in theorem 2 5 if we can approximate any f c k with functions from the closure y we can also approximate with functions from y since y also satisfies the properties i iv of theorem 2 5 we may assume that y is closed the strategy of the proof is then to show under this additional closedness assumption that y satisfies the assumptions of theorem 2 6 for this we need to show that if f y then also f y fix a function g y and let 0 since k is compact the range of g is contained in some compact interval a b by theorem 2 3 there exists a polynomial p a b r such that p q where q t t is the absolute value function since y is an algebra containing the constant functions p g belongs to y and satisfies p g g c k since 0 was arbitrary and y is closed it follows that g y y remark 2 7 theorems 2 5 and 2 6 are stated for compact hausdorff spaces but the hausdorff property was not used in the proofs note however that the separation of points assumptions in these theorems already imply the hausdorff property as a first application of theorem 2 5 we have the following separability result proposition 2 8 if k is a compact metric space then c k is separable proof we must find a countable set in c k with dense span let xn n 1 be a count able dense set in k such a sequence can be realised by covering k for each integer k 1 with finitely many open balls of radius 1 k using compactness and collecting their centres we may assume that all points in this sequence are distinct for all pairs m 6 n the open balls bmn b xm 13 d xm xn and bnm b xn 1 3 d xn xm have dis joint closures the collection b bmn m 6 n is countable and has the property that whenever x y k are two distinct points they can be separated by two balls contained 40 the classical banach spaces in b with disjoint closures by urysohn s lemma proposition c 10 for any two balls b 0 bm 0 n 0 and b 1 bm 1 n 1 in b with disjoint closures there exists function f c k such that f 0 on b 0 and f 1 on b 1 the subspace y spanned by the countable set of all finite products of functions of this form and the constant one function 1 satisfies the assumptions of theorem 2 5 and is therefore dense in c k the next two examples give further illustrations of the stone weierstrass theorem example 2 9 the trigonometric polynomials that is linear combinations of the func tions en exp in n z are dense as functions in c t where t denotes the unit circle which we think of as parametrised with pi indeed they satisfy the requirements of theorem 2 5 an explicit procedure to approximate functions in c t with trigonometric polynomials is described in section 3 5 a example 2 10 let k 1 kk be compact topological spaces the linear combinations of functions of the form f x f 1 x 1 fk xk x x 1 xk k 1 kk with f j c k j for all j 1 k are dense in c k 1 kk indeed they satisfy the requirements of theorem 2 5 2 2 c the arzela ascoli compactness theorem the next theorem gives a necessary and sufficient condition for relative compactness in c k we need the following terminology a subset s c k is said to be equicontin uous at the point x k if for all 0 there exists an open set u in k such that for all x u and f s we have f x f x and equicontinuous if it is equicontinuous at every point of k the set s is said to be pointwise bounded if for all x k we have sup f s f x theorem 2 11 arzela ascoli let k be a compact topological space a subset of c k is relatively compact if and only if it is pointwise bounded and equicontinuous an equivalent way of formulating the theorem is that a subset of c k is compact if and only if it is closed pointwise bounded and equicontinuous proof if let s c k be pointwise bounded and equicontinuous and fix 0 by equicontinuity for every x k there is an open set ux in k such that f x f x for all x ux and f s by compactness finitely many of these open sets cover k say ux 1 uxk by pointwise boundedness for each j 1 k the set f x j f s is 2 2 spaces of continuous functions 41 bounded it follows that we can find c 1 cn k such that for all f s and j 1 k we have min 16 n 6 n f x j cn let n n n 1 nk 1 6 n j 6 n for all j 1 k for n n let bn f s f x j cn j for all j 1 k by what we just observed s n n bn suppose that f g bn and let x k be arbitrary then x belongs to at least one of the sets ux j then f x g x 6 f x f x j f x j g x j g x j g x 6 f x j cn j cn j g x j 4 where the last inequality holds uniformly with respect to x k it follows that f g 4 if for each n n for which bn is nonempty we pick a function fn bn and consider the open balls b fn 4 we obtain a finite cover of s with 4 balls since 0 was arbitrary this means that s is totally bounded and hence relatively compact by theorem d 10 only if suppose now that s c k is relatively compact then obviously s is uniformly bounded and hence pointwise bounded so all we need to do is to prove that s is equicontinuous to this end let x 0 k and 0 be arbitrary and fixed we can cover the compact set s with finitely many say n open balls of radius let f 1 fn be their centres using the continuity of these finitely many functions we can find an open set u containing x 0 such that f j x f j x 0 for all x u and j 1 n now consider an arbitrary f s choose j 0 1 n such that f f j 0 this is possible by the choice of the functions f 1 fn then for all x u we have f x f x 0 6 f x f j 0 x f j 0 x f j 0 x 0 f j 0 x 0 f x 0 3 this verifies the equicontinuity condition 2 2 d applications to differential equations as an interlude to the main development of the theory in this section we apply the completeness result of theorem 2 2 and the compactness result of theorem 2 11 to study the following initial value problem u t f t u t t 0 t u 0 u 0 ivp where f 0 t kd kd is continuous and u 0 kd is given 42 the classical banach spaces global existence and uniqueness a global solution is continuously differentiable function u 0 t k satisfying u 0 u 0 and u t f t u t for all t 0 t theorem 2 12 existence uniqueness picard lindelo f if f 0 t kd kd is continuous and there is a constant l 0 such that for all t 0 t and x x kd we have f t x f t x 6 l x x then ivp admits a unique global solution the condition on f is often summarised by saying that f is lipschitz continuous in its second variable uniformly with respect to its first variable the proof of theorem 2 12 is based on the following abstract fixed point theorem theorem 2 13 banach fixed point theorem let x be a complete metric space and let f x x be uniformly contractive that is there exists a constant 06 c 1 such that d f x f x 6 cd x x x x x then f has a unique fixed point that is there exists a unique element x x with the property that f x x proof if x and x are both fixed points then d x x d f x f x 6 cd x x which is only possible if d x x 0 that is if x x it follows that a fixed point if it exists is unique to prove that a fixed point exists choose an arbitrary x 0 x and define the sequence xn n 0 by xn 1 f xn for n 0 we claim that this is a cauchy sequence indeed for all n 1 we have d xn 1 xn d f xn f xn 1 6 cd xn xn 1 and therefore by induction one sees that d xn 1 xn 6 cn 1 d x 2 x 1 for all n 1 for all m n n we have d xm xn 6 d xm xm 1 d xn 1 xn 6 cm 2 cn 1 d x 2 x 1 6 k n 1 ck d x 2 x 1 cn 1 1 c d x 2 x 1 and the right hand side can be made small by taking n large this proves the claim since x was assumed to be complete the sequence xn n 1 converges in x let x be its limit then the continuity of f implies f x limn f xn limn xn 1 x which shows that x is a fixed point for f by c 0 t kd we denote the space of all continuous functions f 0 t kd endowed with the supremum norm this space is a banach space indeed suppose that 2 2 spaces of continuous functions 43 f n n 1 is a cauchy sequence in c 0 t kd then the d sequences of coordinate functions f n j n 1 are cauchy in c 0 t and therefore converge to limits f j in c 0 t this easily implies that the sequence f n n 1 converges in c 0 t k d to the function f with coordinate functions f j we will use the banach fixed point theorem to prove that the nonlinear mapping it c 0 t kd c 0 t kd defined by it u t u 0 t 0 f s u s ds t 0 t where the integral is interpreted as a kd valued riemann integral has a fixed point this will prove the theorem in view of the next lemma lemma 2 14 a function u c 0 t kd satisfies ivp for all t 0 t if and only if u is a fixed point of it proof indeed u is a fixed point of it if and only if u t u 0 t 0 f s u s ds for all t 0 t by integration this identity holds if u is a solution and conversely if the identity holds then u is continuously differentiable since the right hand side is and by differentiation we obtain that u is a solution proof of theorem 2 12 let us start with a preliminary estimate that will be refined shortly for all u v c 0 t kd and all t 0 t we have it u t it v t t 0 f s u s f s v s ds 6 t 0 l u s v s ds 6 t 0 l u v ds 6 lt u v taking the supremum over t 0 t we find that it u it v 6 lt u v if lt 1 then it is uniformly contractive and the banach fixed point theorem guaran tees the existence of a unique fixed point this proves theorem 2 12 in the special case that the smallness condition lt 1 is satisfied to get around this condition we modify the norm of c 0 t kd fix real number 0 in a moment we will see that we need l and define f sup t 0 t e t f t it is clear that this defines a norm on c 0 t kd and we have e t f 6 f 6 f this implies that a sequence in c 0 t kd is cauchy with respect to the norm if 44 the classical banach spaces and only if it is cauchy with respect to the norm and since c 0 t kd is complete with respect to the latter we conclude that c 0 t kd is a banach space with respect to the norm using this norm we redo the above computations and find it u it v sup t 0 t e t it u t it v t 6 sup t 0 t e t t 0 le se s u s v s ds 6 sup t 0 t e t u v t 0 le s ds sup t 0 t e t u v l e t 1 6 l u v hence if we choose l then it is uniformly contractive on c 0 t kd with respect to the norm now an application of the banach fixed point theorem produces a unique fixed point for it remark 2 15 theorem 2 12 remains true if we replace the interval 0 t by 0 and assume that f 0 kd kd satisfies f t x f t x 6 l x x for all t 0 and x x kd indeed the preceding argument produces a solution ut on every interval 0 t we may now define u 0 kd by setting u ut on the interval 0 t since by uniqueness we have ut us on 0 s t this is well defined the resulting function is differentiable and satisfies ivp on every interval 0 t hence on all of 0 and is therefore a global solution on 0 remark 2 16 all that has been said extends to the case where kd is replaced by a banach space x this equally pertains to the results of the next paragraph local existence as an application of theorem 2 11 we present a local existence result for differential equations with continuous right hand side in contrast to the situation in theorem 2 12 where a lipschitz continuity assumption was made we do not get uniqueness of the solution we say that the problem admits a local solution if there exists 0 6 t and a differentiable function u 0 kd satisfying u 0 u 0 and u t f t u t for all t 0 theorem 2 17 local existence peano if f 0 t kd kd is continuous then the problem ivp admits a local solution 2 2 spaces of continuous functions 45 a global solution need not always exist indeed u t 1 1 t t 0 with 0 1 is a local solution of the problem u t u t 2 t 0 1 u 0 1 but this problem does not have a global solution this follows from the fact that a local solution on a subinterval 0 if one exists is unique to see this suppose that u 1 and u 2 are two solutions on 0 both u 1 and u 2 are continuous hence bounded let us say by the constant m consider now the function y min y 2 m this function is globally lipschitz continuous on 0 r and therefore the problem u t u t t 0 u 0 1 has a unique solution on 0 say u on the other hand u 1 and u 2 are solutions on 0 because u 1 t u 1 t 2 and u 2 t u 2 t 2 for all t 0 and therefore we must have u 1 u u 2 on 0 the upshot of all this is that if a global solution exists it must be equal to 1 1 t on every subinterval 0 hence on the interval 0 1 but the function 1 1 t cannot be extended to a continuous function on 0 1 the above uniqueness proof for local solutions made use of the fact that the right hand side was locally lipschitz continuous in the second variable in a neighbourhood of the initial value in general however a local solution need not be unique indeed both u 1 t 0 and u 2 t t 3 2 are solutions of the problem u t 3 2 u t 1 3 t 0 1 u 0 0 the function t x 32 x 1 3 fails to be locally lipschitz continuous in the second vari able in a neighbourhood of the initial value 0 as a first step towards the proof of theorem 2 17 we show that the problem ivp is equivalent to an integrated version of it for the remainder of this section we assume that f is continuous lemma 2 18 a function u c 0 kd is a local solution of ivp if and only if for all t 0 we have u t u 0 t 0 f s u s ds 2 4 the function s 7 f s u s is continuous on 0 so the integral is well defined as a riemann integral with values in kd 46 the classical banach spaces proof if u c 0 kd is a local solution then for all t 0 we have u t u 0 u t u 0 t 0 u s ds t 0 f s u s ds and 2 4 holds for all t 0 conversely if u c 0 kd satisfies 2 4 for all t 0 then u is continuously differentiable on 0 using u 0 u 0 and differentiating we find u t d dt t 0 f s u s ds f t u t for all t 0 that is ivp holds now we are ready for the proof of theorem 2 17 it relies on a compactness argu ment the idea is to construct for small enough 0 t a sequence of approxi mate solutions un n 1 in c 0 kd and show its equicontinuity the definition of which extends to vector valued functions in the obvious way an appeal to the arzela ascoli theorem which extends to the vector valued case as well without change in the proof then produces a subsequence unk k 1 that converges in c 0 k d the limit u c 0 kd will be shown to solve ivp on the interval 0 proof of theorem 2 17 let m sup t x 0 t b u 0 1 f t x and min t 1 m for n 1 2 we equipartition the interval 0 using the partition points t j n jhn for j 0 2 n where hn 2 n and define inductively un 0 u 0 un t j 1 n un t j n hn f t j n u t j n j 1 2 n 2 5 for the remaining values of t 0 we define un t by piecewise linear interpolation since each un is piecewise continuously differentiable with derivatives bounded by m by an inductive argument based on 2 5 each u t j n belongs to b u 0 1 we have un t un s 6 m t s s t 0 this implies that the functions un are equicontinuous the estimate un t 6 un t un 0 un 0 6 m u 0 6 1 u 0 t 0 shows that they are also uniformly bounded by the arzela ascoli theorem some sub sequence unk k 1 converges to a limiting function u in c 0 k d since f is uniformly continuous on 0 t b u 0 1 we have limn cn 0 where cn sup t s 6 hn sup x y 6 hnm f t x f t y writing un t u 0 2 n 1 j 0 t j 1 n t j n 1 0 t s f t j n un t j n ds t 0 2 3 spaces of integrable functions 47 we see that un t u 0 t 0 f s un s ds 6 2 n 1 j 0 t j 1 n t j n 1 0 t s f t j n un t j n f s un s ds 6 cn 2 n 1 j 0 t j 1 n t j n 1 0 t s ds 6 cn 2 nhn cn the right hand side tends to 0 as n taking limits it follows that u t lim k unk t u 0 limk t 0 f s unk s ds u 0 t 0 f s u s ds and therefore u solves the integrated version of ivp on 0 by lemma 2 18 u then solves ivp on the interval 0 2 3 spaces of integrable functions let f be a measure space and fix 16 p we define l p as the set of all measurable functions f k such that f p d for such functions we set f p f p d 1 p for p we define l as the set of all measurable functions f k that are essentially bounded meaning that there is set n f of measure 0 such that f is bounded on n for such functions we define f as the essential supremum of f f esssup f inf r 0 f 6 r almost everywhere when there is no risk of confusion the measure is omitted from this notation the spaces l p are vector spaces proposition 2 19 minkowski inequality let 1 6 p 6 for all functions f g l p we have f g l p and f g p 6 f p g p 48 the classical banach spaces proof the result is trivial for p so we only consider the case 16 p by elementary calculus it is checked that for all nonnegative real numbers a and b one has a b p inf t 0 1 t 1 pap 1 t 1 pbp applying this identity to f and g with and integrating with respect to for all fixed t 0 1 we obtain f g p d 6 f g p d 6 t 1 p f p d 1 t 1 p g p d stated differently this says that f g pp 6 t 1 p f pp 1 t 1 p g pp taking the infimum over all t 0 1 gives the result in spite of this result p is not a norm on l p because f p 0 only implies that f 0 almost everywhere in order to get around this imperfection we define an equivalence relation on l p by f g f g almost everywhere the equivalence class of a function f modulo is denoted by f on the quotient space lp l p whose elements are the equivalence classes f of functions f l p we define a scalar multiplication and addition in the natural way c f c f f g f g we leave it as an exercise to check that both operations are well defined with these operations lp is a normed vector space with respect to the norm f p f p when we explicitly wish to express the dependence on f or we write lp f or lp following common practice we make no distinction between functions in l p and their equivalence classes in lp and call the latter functions as well in the same vein we will not hesitate to talk about the sets f b when b k is a borel set and f is an element of lp the rigorous interpretation is that it defines an equivalence classes of sets in f the representatives of which are obtained by selecting pointwise defined measurable representatives for f 2 3 spaces of integrable functions 49 2 3 a completeness for the remainder of this section we fix a measure space f the main result of this section is the following completeness result for the spaces lp theorem 2 20 completeness for all 16 p 6 the normed space lp is complete proof first let 1 6 p and let fn n 1 be a cauchy sequence with respect to the norm p of lp by passing to a subsequence we may assume that fn 1 fn p 6 1 2 n n 1 2 define the nonnegative measurable functions gn n 1 n 0 fn 1 fn g n 0 fn 1 fn with the convention that f 0 0 by the monotone convergence theorem gp d lim n gpn d taking pth roots and using minkowski s inequality we obtain g p lim n gn p 6 lim n n 1 n 0 fn 1 fn p n 0 fn 1 fn p 6 1 f 1 p if follows that g is finitely valued almost everywhere which means that the sum defining g converges absolutely almost everywhere as a result the sum f n 0 fn 1 fn converges on the set g on this set we have f lim n n 1 n 0 fn 1 fn lim n fn defining f to be identically zero on the null set g the resulting function f is measurable from fn p n 1 n 0 fn 1 fn p 6 n 1 n 0 fn 1 fn p 6 g p it follows f p 6 g p and hence f fn p 6 2 p 12 f fn p 6 2 p 1 f p fn p 6 2 p g p using the convexity of t 7 t p recall that a function f i r where i is an interval 50 the classical banach spaces is called convex if for all x 0 x 1 i and 0 6 6 1 we have f 1 x 0 x 1 6 1 f x 0 f x 1 from the dominated convergence theorem we conclude that lim n f fn p 0 we have proved that a subsequence of the original cauchy sequence converges to f in lp as is easily verified this implies that the original cauchy sequence converges to f as well this completes the proof for exponents 16 p it remains to establish the result for p let fn n 1 be a cauchy sequence with respect to the norm of l by passing to a subsequence we may assume that fn 1 fn 6 1 2 n n 1 2 choose null sets fn such that fn 1 fn 6 12 n for all fn defining the functions gn and g as before we note that outside the null set f n 1 fn we have uniform convergence gn g defining the function f as before this implies that fn f uniformly outside f this in turn means that fn f in l in the course of the proof we obtained the following result corollary 2 21 every convergent sequence fn n 1 in lp with 1 6 p 6 has a almost everywhere convergent subsequence fnk k 1 and this subsequence may be chosen to satisfy fnk 6 g almost everywhere for some fixed 06 g l p in the majority of applications the first part of this corollary suffices but the sec ond part is sometimes helpful in setting the stage for an application of the dominated convergence theorem remark 2 22 except when p in the setting of corollary 2 21 it need not be the case that the sequence fn n 1 itself is almost everywhere convergent to its lp limit f see problems 2 13 and 2 14 the inequality in the next result is known as ho lder s inequality for p q 2 and r 1 it reduces to a special case of the cauchy schwarz inequality see proposition 3 3 proposition 2 23 ho lder s inequality let 1 6 p q r 6 satisfy 1 p 1 q 1 r if f lp and g lq then f g lr and f g r 6 f p g q for r 1 the condition on p and q reads 1 p 1 q 1 we call such p and q conjugate exponents 2 3 spaces of integrable functions 51 proof it suffices to prove the inequality for r 1 the general case follows by applying this special case to the functions f r and g r for p 1 q and for p q 1 the first inequality follows by a direct estimate thus we may assume from now on that 1 p q the inequality is then proved in the same way as minkowski s inequality this time using the identity ab inf t 0 t pap p bq qtq remark 2 24 let 1 6 p 1 pn r 6 satisfy 1 p 1 1 pn 1 r if fn l pn for n 1 n then nn 1 fn l r and n n 1 fn r 6 n n 1 fn pn this more general version of ho lder s inequality follows from proposition 2 23 by an easy induction argument as an immediate corollary of ho lder s inequality we have the following result corollary 2 25 let 16 p q r 6 satisfy 1 p 1 q 1 r then the mapping f g 7 f g is jointly continuous from lp lq into lr in particular if 1 6 p q 6 satisfy 1 p 1 q 1 and fn f in l p then for all g lq we have lim n fngd f gd proof if fn f in lp and gn g in lq then ho lder s inequality implies that fngn fng f gn f g belong to lr and fngn f g r 6 fn f g r fn gn g r 6 fn f p g q m gn g q 0 as n where m supn 1 fn p by proposition d 8 this proves the asserted continuity a useful special case of ho lder s inequality concerns the case of a finite measure if and 16 r 6 p 6 then ho lder s inequality implies that if f lp then f lr and f r 6 1 r 1 p f p in the case of a probability measure this takes the simpler form f r 6 f p the following result provides a converse to ho lder s inequality we formulate it for 52 the classical banach spaces exponents 1 p 1 q 1 as in the proof of ho lder s inequality this implies a more general version for exponents 1 p 1 q 1 r a further variation will be given in proposition 5 14 proposition 2 26 let 1 6 p q 6 satisfy 1 p 1 q 1 let be a measure space which is assumed to be finite if p a measurable function f belongs to lp if and only if f g l 1 and f g 1 6 m g q for some constant m 0 and all g y where y is a dense subspace of lq in that case we have f p 6 m proof the only if part is immediate from ho lder s inequality to prove the if part we may assume that f is not identically 0 step 1 by assumption the mapping g 7 f g is bounded of norm at most m as a mapping from the dense subspace y of lq to l 1 hence by proposition 1 18 it admits a unique extension to a bounded operator of norm at most m from lq to l 1 denote this operator by t if gn g in lq with each gn in y then t g limn t gn limn f gn with convergence in l 1 using corollary 2 21 we may pass to a subsequence such that gnk g and f gnk t g almost everywhere and therefore t g lim n f gn f g almost everywhere this also implies that f g l 1 for all g lq and f g 1 6 m g q g lq 2 6 step 2 in this step we prove the proposition for 16 p by showing that f p d 6 mp 2 7 to this end let be a simple function satisfying 06 6 f almost everywhere say k j 1 c j 1 fj with coefficients c j k and the sets fj disjoint and of finite measure we first prove that p d 6 mp 2 8 if p d this inequality trivially holds so we may assume that p d 0 to prove 2 8 in this case set g p 1 with g 1 if p 1 then p d gd 6 f gd f g 1 6 m g q 2 9 2 3 spaces of integrable functions 53 for p 1 we have g q 1 1 and 2 8 follows from 2 9 for 1 p we have 1 q and g qq k j 1 c j p 1 q fj k j 1 c j p fj p d taking qth roots on both sides and substituting the result into 2 9 we obtain p d 6 m p d 1 q which is the same as saying that 2 8 holds now let 06 n f almost everywhere in 2 8 with each n a simple function applying the previous inequality to n the monotone convergence theorem gives 2 7 this proves that f lp and f p 6 m this completes the proof for 16 p step 3 suppose next that p and f is finite suppose for a contradic tion that f does not belong to l then for all n 1 2 the set an f n has strictly positive measure if j 1 b j with b j for all j such sets exist by finiteness then for each n there must be an index j jn such that an b jn has strictly positive and finite measure n then gn 1 n 1 an b jn belongs to l 1 and has norm one and we have f gn 1 1 n an b jn f d n n gn 1 this contradicts 2 6 remark 2 27 the argument of step 3 proves more generally that if f is a finite measure space and 16 p 6 then a measurable function f belongs to l if and only if f g lp and f g p 6 m g p for some constant m 0 and all g y where y is a dense subspace of lp in that case we have f 6 m 2 3 b approximation by mollification it is generally difficult to handle lp functions directly there are two ways of dealing with this problem by approximation it often suffices to consider functions that are easier to deal with and by interpolation one can reduce matters to exponents that are easier to deal with the present section is devoted to approximation techniques interpolation is treated in section 5 7 we begin by proving that the simple functions are dense in lp for 1 6 p recall from definition 1 49 that a simple function is a simple function supported on sets of finite measure proposition 2 28 approximation by simple functions for 16 p the simple functions are dense in lp the same result holds for l if 54 the classical banach spaces proof fix a function f lp first let 16 p by dominated convergence we have lim n 1 1 n 6 f 6 n f f in lp moreover f 1 n 1 f 1 n d 6 1 f 1 n n f p d 6 np f pp we may therefore assume that f is bounded and is a finite measure by considering real and imaginary parts separately we may also assume that f is real valued under these assumptions we have fk f in lp where fk j z 1 j 2 k 6 f j 1 2 k j 2 k are simple functions by the boundedness of f these sums have only finitely many nonzero contributions if f l with the functions fk defined above are simple and ap proximate f uniformly more interesting is the fact that if d is an open subset of rd then the vector space c c d of all compactly supported smooth functions f d k is dense in lp d for every 16 p here and in what follows the support supp f of a continuous func tion f d k is defined as the complement of the largest open set u such that f 0 on d u or equivalently as the closure of the set x d f x 6 0 proposition 2 29 approximation by compactly supported smooth functions let 16 p and let d rd be open then c c d is dense in lp d proof for f lp d we have limn f 1 b 0 n f p 0 by dominated convergence so there is no loss of generality in assuming that d is bounded also by proposition 2 28 every f lp d can be approximated by simple functions supported on d hence it suffices to prove that every simple function supported on a bounded open set d can be approximated in lp d by functions in c c d by linearity and the triangle inequality it even suffices to approximate indicator functions of the form 1 b for borel sets b d given 0 choose an open set u d and a closed set f b such that f b u and u f this is possible by the regularity of the lebesgue measure on d propo sition e 16 let c c d satisfy 06 6 1 pointwise 1 on f and 0 outside u as outlined in problem 2 9 the existence of such functions can be demonstrated by elementary calculus arguments then 1 b p lp d d u f p dx 6 u f since the choice of 0 was arbitrary this completes the proof 2 3 spaces of integrable functions 55 the corresponding result for p is wrong if d is nonempty and open then cc d the vector space of all compactly supported continuous functions f d k fails to be dense in l d indeed if d is a nonempty open set properly contained in d then f 1 d l d 12 for every f cc d whose support intersects both d and its complement the separability of the spaces c b 0 n implies corollary 2 30 let 16 p and let d rd be open then lp d is separable remark 2 31 since finite borel measures on metric spaces are regular proposition e 16 using urysohn s lemma proposition c 10 the same argument proves that if is a finite borel measure on a compact metric space k then c k is dense in lp k for all 16 p combining this observation with proposition 2 8 as a corollary we obtain that under these assumptions lp k is separable for all 16 p as an application of proposition 2 29 we prove an lp continuity result for translation proposition 2 32 continuity of translation let f lp rd with 16 p then lim h 0 f h f p 0 proof define for h rd and x rd h f x f x h that is h f is the translate of f over h clearly h f p f p first consider a function f cc rd such a function is uniformly continuous so given an 0 we may choose 0 such that x x implies f x f x hence if h then for all x rd we have h f x f x choose r 0 large enough such that the support of f is contained in the rectangle r r d if h is so small that the support of h f is also contained in r r d then h f f pp r r d f x h f x p dx 6 p r r d dx p 2 r d this proves that lim h 0 h f f p 0 for all f cc rd now let f lp rd be arbitrary since cc rd is dense in lp rd by proposition 2 29 we can find g cc rd such that f g p choose 0 so small that h implies hg g p this is possible by what we just proved then for h h f f p 6 h f hg p hg g p g f p 3 noting that h f hg p h f g p f g p we now turn to an approximation technique based on convolution it relies on a fun damental inequality known as young s inequality proposition 2 33 young let 16 p q r 6 satisfy 1 p 1 q 1 1 r and let f l p rd and g lq rd then 56 the classical banach spaces 1 for almost all x rd the function y 7 f x y g y is integrable 2 the function f g rd k defined for almost all x rd by f g x rd f x y g y dy belongs to lr rd and we have f g r 6 f p g q moreover we have f g g f in lr rd and if 1 r 1 s 1 1 t then for all h l s rd we have f g h f g h in lt rd the most important special case corresponds to the choices q 1 and r p for which the proof below simplifies considerably proof the identity 1 p 1 q 1 1 r implies 1 r r p pr r q qr 1 with r p q hence by elementary rewriting and ho lder s inequality for three functions see remark 2 24 for all x rd we have rd f x y g y dy rd f x y p g y q 1 r f x y r p r g y r q r dy 6 f x p g q 1 r r f x r p r pr r p g r q r qr r q i ii iii now i rd f x y p g y q dy 1 r ii rd f x y p dy r p pr f r p rp iii rd g y q dy r q qr g r q rq putting things together and using fubini s theorem it follows that rd f g x r dx 6 f r pp g r q p rd rd f x y p g y q dydx f r pp g r q q rd g y q rd f x y p dxdy f rp g r q this implies the first assertion as well as the second the identity f g g f follows by a change of variables and f g h f g h by fubini s theorem 2 3 spaces of integrable functions 57 proposition 2 34 approximation by mollification let f lp rd with 1 6 p let l 1 rd satisfy rd x dx 1 for 0 define x d 1 x x rd then lim 0 f f p 0 proof we proceed in three steps step 1 first assume that and f belong to cc rd since rd y dy 1 for all x rd we have f x f x rd y f x y f x dy rd y f x y f x dy taking lp rd norms on both sides and using that the lp rd valued function y 7 y f y f which is continuous by proposition 2 32 and compactly sup ported and hence supported on some large enough closed cube is riemann integrable by proposition 1 44 we obtain f f p rd y f y f dy p 6 rd y f y f p dy since f y f p 6 2 f p uniformly in and y and l 1 rd by dominated convergence it suffices to show that f y f in lp rd for each fixed y this again follows from proposition 2 32 this completes the proof for functions f and in cc rd step 2 still assuming that cc rd we next extend the result to general f lp rd fix 0 and choose g cc rd such that f g p this is possible by proposition 2 29 by young s inequality and the identity 1 1 for any 0 we have f f p 6 f g p g g p g f p 6 1 f g p g g p 6 1 g g p letting 0 the result of step 1 implies that limsup 0 f f p 6 1 1 since 0 was arbitrary this proves that lim 0 f f p 0 step 3 we now pass to the general case where l 1 rd satisfies rd x dx 1 in order to apply the result of the preceding step choose a function cc rd such 58 the classical banach spaces that 1 and rd y dy 1 such a function exists by proposition 2 29 then by young s inequality and the result of step 2 applied to f f p 6 f f p f f p 6 1 f p f f p 6 f p f f p letting 0 using the result of step 2 it follows that limsup 0 f f p 6 f p since 0 was arbitrary this proves that lim 0 f f p 0 2 3 c the fre chet kolmogorov compactness theorem in this section we prove a characterisation of relatively compact sets in lp rd it will be used in chapter 11 to prove the rellich kondrachov theorem on compact embeddings of sobolev spaces recall the notation h f for the translate of a function f over h h f x f x h theorem 2 35 fre chet kolmogorov let 16 p a subset s of lp rd is relatively compact if and only if it satisfies the following two conditions i lim h 0 sup f s h f f p 0 ii lim sup f s b 0 f x p dx 0 proof if let us begin by proving that i and ii together imply that the set s is bounded choose r 0 such that sup f s h f f p 6 1 for all h r d with h 6 r and choose r 0 such that sup f s b 0 r f x p dx 6 1 fix h rd with h r for all f s and x rd we have 1 b x r f p 6 1 b x r f h f p 1 b x r h f p 1 b x r f h f p 1 b x h r f p 6 1 1 b x h r f p hence by induction 1 b 0 r f p 6 n 1 b nh r f p choose n 1 such that nr n h 2 r then b nh r b 0 r and f p 1 b 0 r f p 1 b 0 r f p 6 n 1 b nh r f p 1 b 0 r f p 6 n 2 2 10 this proves that s is bounded 2 3 spaces of integrable functions 59 let us now prove that if s satisfies i and ii then it is relatively compact fix 0 and choose r 0 such that sup f s b 0 r f x p dx p set b b 0 r and s 1 b f f s if f s then f 1 b f p 1 b f p 2 11 and therefore s s bp 0 where bp 0 is the open ball in lp rd with radius centred at 0 choose r 0 such that sup f s h f f p 6 for all f s and h r d with h 6 r for such h 2 11 implies that for all f s we have h 1 b f 1 b f p 6 h 1 b f f p h f f p f 1 b f p 6 3 2 12 let 06 cc b 0 r satisfy rd x dx 1 and set s g g s for g s the estimate 2 12 implies g g p rd y g y g dy p 6 rd y g y g p dy b 0 r y g y g p dy 6 3 this shows that s s bp 0 3 and hence s s bp 0 s bp 0 4 if we can prove that s is relatively compact it follows from proposition 1 40 that s is relatively compact every h s is supported in b 0 r r we claim that every h s is continuous and that the set s as subset of c b 0 r r is equicontinuous and bounded let h s say h g with g s say g 1 b f with f s by uniform continuity given 0 there exists 0 1 such that for all x x rd with x x we have x x hence for all x x rd with x x h x h x 6 rd x y x y g y dy b x y x y g y dy 6 b g y dy b f y dy 6 b 1 q n 2 applying ho lder s inequality and 2 10 in the last step this proves the continuity of h 60 the classical banach spaces since the estimate is uniform with respect to h s it also proves the equicontinuity of s boundedness of s follows from the boundedness of s indeed if h g s with g s then by ho lder s inequality with 1 p 1 p 1 h x 6 rd y g x y dy 6 p g p by the arzela ascoli theorem s is relatively compact in c b 0 r r since the natural inclusion mapping from c b 0 r r into lp rd is bounded by ho lder s inequality s is relatively compact as a subset of lp rd only if if s is relatively compact in lp rd then i and ii follows from propo sition 1 42 applied to the operators f 7 h f for h 0 and f 7 1 b 0 f for respectively we have the following immediate corollary for bounded domains corollary 2 36 let 1 6 p and let d be a bounded open subset of rd a subset s of lp d is relatively compact if and only if lim h 0 sup f s h f f p 0 here we identify functions in lp d with their zero extensions in lp rd 2 3 d the lebesgue differentiation theorem by l 1 loc r d we denote the vector space of functions f rd k that are locally in tegrable that is integrable on every compact subset of rd identifying two such func tions when they are equal almost everywhere the aim of this section is to prove the lebesgue differentiation theorem which says that if f l 1 loc r d then at almost every point x rd one has lim b 3 x b 0 1 b b f y f x dy 0 the limit being taken along the balls b inrd containing x letting b denote the lebesgue measure of a measurable set b the proof of this theorem is based on the following lemma for balls b b x r in rd and real numbers 0 we set b b x r lemma 2 37 vitali covering lemma every finite collection b of open balls inrd has a subcollection b 0 of pairwise disjoint balls such that each ball b b is contained in 3 b 0 for some ball b 0 b 0 2 3 spaces of integrable functions 61 proof we proceed by induction on the number n of balls in b for n 1 the lemma is trivial for we can take b 0 b suppose the claim has been verified for every collection of n balls and let b be a collection of n 1 balls let b b b 0 where b 0 is a ball in b of minimal radius by the induction assumption there is a subcollection b 0 b of pairwise disjoint balls such that each ball b b is contained in 3 b for some ball b b 0 we now distinguish two cases case 1 if b 0 is disjoint from each ball b b 0 then the subcollection b 0 b 0 b 0 has the required properties case 2 if b 0 intersects a ball b b 0 then the radius of b is at least as large as that of b 0 from which it follows that b 0 3 b the subcollection b 0 b 0 then has the required properties for f l 1 loc r d we define the hardy littlewood maximal function m f rd 0 by m f x sup b 3 x 1 b b f y dy where the supremum is taken over all balls b containing x since the supremum in the definition of m f x can be realised by using only a fixed countable collection of balls m f is a measurable function theorem 2 38 hardy littlewood maximal theorem for all f l 1 rd and t 0 we have the weak l 1 bound t m f t 6 3 d f 1 moreover for all 1 p 6 there exists a constant cd p 0 such that for all f lp rd we have m f lp rd and m f p 6 cd p f p proof we begin with the proof of the first assertion by the definition of m f for every x m f t there exists a ball b containing x such that 1 b b f t if k m f t is a compact subset it can be covered by a finite collection b of such balls let b 0 be a disjoint subcollection of this cover provided by the vitali covering lemma then k 6 b b b 6 b b 0 3 b b b 0 3 d b 6 b b 0 3 d t b f y dy 6 3 d t f 1 this being true for all compact sets k contained in the open set m f t the first assertion follows for 1 p the second assertion follows from the first by using the integration by parts identity rd g x p dx p 0 t p 1 g t dt 2 13 62 the classical banach spaces for g lp rd as follows for any f lp rd and t 0 the function ft x 1 f t 2 f belongs to lp rd and satisfies the pointwise bound m f 6 sup b 3 x 1 b b ft y dy sup b 3 x 1 b b 1 f t 2 f y dy 6 m ft t 2 which implies m f t m ft t 2 hence by the first part of the theorem m f t 6 m ft t 2 6 2 3 d t ft 1 2 3 d t f t 2 f x dx 2 14 by 2 13 2 14 and fubini s theorem rd m f x p dx 6 p 0 t p 1 2 3 d t f t 2 f x dx dt 3 d 2 p rd f x 2 f x 0 t p 2 dt dx 3 d 2 p p 1 rd f x 2 f x p 1 dx cpd p rd f x p dx where cd p 2 3 d p p 1 1 p for p the second assertion follows trivially from the pointwise inequality m f 6 f with constant cd 1 inspection of this proof reveals that the derivation of the lp bound for m f in the second part of the theorem does not use any properties of this function other than the weak l 1 bound contained in the first part of the theorem this observation lies at the basis of the marcinkiewicz interpolation theorem in chapter 5 see theorem 5 47 as a corollary to theorem 2 38 we have the following fundamental result theorem 2 39 lebesgue differentiation theorem if f l 1 loc r d then for almost all x rd we have lim b 3 x b 0 1 b b f y f x dy 0 2 15 the correct way of interpreting this theorem is as follows for every pointwise defined locally integrable function f on rd the limit in 2 15 with f replaced by f exists for almost all x r say on a borel set rd such that rd 0 if both f 1 and f 2 are pointwise representatives the symmetric difference of corresponding sets 1 and 2 has measure 0 the set of all points x rd for which 2 15 holds is called a the set of lebesgue 2 4 spaces of measures 63 points of f as just explained this set is uniquely determined only up to a set om mea sure 0 proof a point x rd is a lebesgue point of f if and only if it is a lebesgue point of 1 u f for any bounded open set u containing x hence upon replacing f by 1 u f if necessary it suffices to prove the theorem under the stronger assumption f l 1 rd for all x rd let n f x limsup b 3 x b 0 1 b b f y f x dy we wish to prove that n f x 0 for almost all x rd for this purpose it suffices to show that n f 0 for any fixed 0 for any fixed 0 proposition 2 29 provides us with a function g cc rd such that f g 1 then n f 6 n f g ng 6 m f g f g 0 using the pointwise inequality nh x 6 mh x h x and the continuity of g which implies ng x 0 therefore by theorem 2 38 n f 6 m f g 2 f g 2 6 2 3 d f g 1 2 f g 1 6 2 3 d 1 since 0 was arbitrary it follows that n f 0 2 4 spaces of measures in this section we introduce the space m of k valued measures on a given measur able space f and discuss some of its properties from the functional analytic point of view the importance of this space resides in the fact that m is a vector space in a natural way by setting c f c f f f f f f and that it is a banach space with respect to the variation norm introduced in definition 2 42 see theorem 2 44 2 4 a the banach space m in what follows we fix a measurable space f 64 the classical banach spaces definition 2 40 k valued measures a k valued measure on f is a mapping f k with the following properties i 0 ii for all disjoint f measurable sets f 1 f 2 we have n 1 fn n 1 fn remark 2 41 an ordinary measure in the sense of definition e 3 is a real valued measure if and only if it is finite the terms real valued measure and complex valued measure are often abbreviated to real measure and complex measure definition 2 42 variation let be a k valued measure on f the variation of on the set f f is defined by f sup a ff a a a where ff denotes the set of all finite collections of pairwise disjoint f measurable subsets of f it is immediate to verify that c c for all c k and f 6 f f for all f f if takes values in 0 then proposition 2 43 if is a k valued measure then is a finite measure proof we proceed in two steps step 1 we prove that is a measure it is clear that 0 let fn n 1 be a sequence of pairwise disjoint measurable sets and let f be their union we must prove that f n 1 fn if an ffn is a finite collection of pairwise disjoint measurable subsets of fn then for every n 1 the union n n 1 an is a finite collection of pairwise disjoint measurable subsets of f and therefore n n 1 a an a 6 f taking the supremum over all an ffn it follows that n n 1 fn 6 f this being true for all n 1 we conclude that n 1 fn 6 f 2 4 spaces of measures 65 in the converse direction suppose that the measurable subsets a 1 ak of f are dis joint with fj n a j fn we have k j 1 a j 6 k j 1 n 1 fj n n 1 k j 1 fj n 6 n 1 fn taking the supremum over all finite families of pairwise disjoint measurable subsets of f we obtain f 6 n 1 fn step 2 we prove that the measure is finite that is by considering real and imaginary parts it suffices to do this in the real valued case if a finite set r 1 rn of real numbers is given then either the positive or the negative numbers in this set or both contribute at least half to the sum nn 1 rn enu merating this set or one of them as rn 1 rnk we thus have k j 1 rn j 1 2 n n 1 rn 2 16 suppose for a contradiction that some measurable set f satisfies f choose disjoint measurable subsets f 1 fn of f such that n n 1 fn 2 1 f by 2 16 the union f of a suitable subcollection of the fj satisfies f 1 2 n n 1 fj 1 f for f f f we then have f f f 1 thus if a set f f satisfies f there is a disjoint decomposition f f f with f 1 and f 1 since is a measure at least one of the numbers a and a equals we take one of them and continue applying what we just proved inductively this produces a sequence of pairwise disjoint measurable sets g 1 g 2 each of which satisfies gk 1 let g be their union since is a k valued measure we have g k 1 gk this sum cannot converge since its terms fail to converge to 0 this is the required contradiction theorem 2 44 completeness endowed with the variation norm 66 the classical banach spaces m is a banach space proof we leave it as an exercise to prove that defines a norm to prove completeness let n n 1 be a cauchy sequence in m for all f f n f m f n m f 6 n m f 6 n m proving that the sequence n f n 1 is cauchy in k let f denote its limit we wish to show that the resulting mapping f k is a k valued measure and that limn n with respect to the norm of m it is clear that limn n 0 suppose now that fm m 1 is a sequence of pairwise disjoint measurable sets and let f m 1 fm given 0 choose n 1 so large that j k for all j k n since n is countably additive we may choose n 1 so large that n f mm 1 n fm for all m n then for m n f m m 1 fm lim n n f m m 1 n fm 6 n f m m 1 n fm sup n n 1 n n m m 1 fm 6 n f m m 1 n fm sup n n 1 n n 6 2 since 0 was arbitrary this proves that m 1 fm f finally if f 1 fk are disjoint and measurable then for all m n we have k j 1 m fj lim n k j 1 n m fj 6 limsup n n m limsup n n m 6 taking the supremum over finite disjoint families of measurable sets we find that m 6 for all m n this proves the required convergence if is a complex measure on f then re f re f im f im f define real measures on f and we have re i im the next result shows that real measures allow decompositions into positive and negative parts theorem 2 45 hahn jordan decomposition if is a real measure on a measurable space f then f sup a a f a f f inf a a f a f 2 4 spaces of measures 67 are finite measures on f and the measures and are supported on disjoint sets in the sense that there exists a disjoint decomposition with f such that for all f f we have f f f f if 1 and 2 are finite measures on f such that 1 2 then for all f f we have 1 f f 2 f f the decomposition for real measures is called the jordan decompo sition the existence of a corresponding decomposition for their supports is often referred to as the hahn decomposition theorem proof we begin with the construction of the sets and let us call a set f f positive resp negative if for all a f with a f we have a 0 resp a 6 0 we use the notation f 0 resp f 6 0 to express that f f and f is positive resp negative finite and countable unions of positive sets are positive indeed suppose that the sets fn n 1 are positive set g 1 f 1 and gn fn n 1 j 1 fj for n 2 then n 1 fn n 1 gn if a f is contained in this union the countable additivity of implies a n 1 gn a 0 keeping in mind that gn a fn and fn 0 let m sup f 0 f and note m choose positive sets fn n 1 such that limn fn m by the observation just made we may assume that f 1 f 2 by the same observation n 1 fn is positive and therefore 6 m the positivity of also im plies fn 6 and therefore m limn fn 6 we have shown that m we show next that is a negative set suppose for a contradiction that this were false then contains subset a 0 f with a 0 0 if a 0 were positive then so would be a 0 but then a 0 m a 0 m contradicts the choice of m it follows that there exists a smallest integer k 1 with the property that a 0 contains a subset a 1 f with a 1 6 1 k 1 since a 0 a 1 a 0 a 1 0 we can repeat this construction to find the smallest integer k 2 with the property that a 0 a 1 contains a subset a 2 f with a 2 6 1 k 2 continuing this way we obtain a sequence of pairwise disjoint sets an n 1 all contained in a 0 such that an 6 1 kn for all n 1 we must have limn kn 0 since otherwise the union a n 1 an would satisfy a 68 the classical banach spaces let b a 0 a then b a 0 a 0 and b 0 for if we had c f with c b and c 0 then c 1 k for some integer k the existence of such a set c contradicts the maximality of the kn for large enough n the set b is positive and satisfies b m b m contradicting the choice of m we conclude that is negative we have shown that for all f f we have f 0 f 6 0 we may thus define positive measures by f f f f it is clear that since a a a 6 a a we see that f sup a a f a f 6 sup a a f a f the converse inequality trivially holds for a f implies a f hence we have equality and then a a implies f sup a a f a f sup a a f a f f the identity is proved in the same way the countable additivity of and is an immediate consequence next f f 6 f f f f in the con verse direction write f f f with f f then the positivity of f and the negativity of f imply f f f f f f f finally if 1 and 2 are finite measures such that 1 2 1 f 1 f 1 f 2 f f f the proof that 2 f f is similar 2 4 b the radon nikody m theorem if f k is integrable with respect to the measure then the k valued measure f f f d f f is absolutely continuous with respect to that is f 0 implies f 0 the following theorem provides a converse under a finiteness assumption 2 4 spaces of measures 69 theorem 2 46 radon nikody m let f be a finite measure space if the measure f k is absolutely continuous with respect to then there exists a unique g l 1 such that f f gd f f proof uniqueness being clear the proof is devoted to proving existence by consid ering real and imaginary parts separately it suffices to consider the case of real scalars then decomposing into positive and negative parts via the jordan decomposition it suffices to consider the case where is a finite nonnegative measure consider the set s f l 1 f 0 f f d 6 f for all f f then 0 s so s is nonempty let m sup f s f d for all f s we have f d 6 and therefore m 6 step 1 in this step we prove that there exists a function g s for which the supre mum in the definition of m is attained let fn n 1 be a sequence in s with the property that limn fn d m set gn f 1 fn any set f f can be written as a disjoint union of sets f n 1 f n n f such that g j f j on f n j and therefore f gn d n j 1 f n j f j d 6 n j 1 f n j f it follows that gn s the sequence gn n 1 is nondecreasing and therefore its point wise limit g limn gn is well defined as a 0 valued function by the monotone convergence theorem for all f f we have f gd lim n f gn d 6 f 2 17 and therefore g takes finite values almost everywhere and belongs to s moreover m lim n fn d 6 lim n gn d gd 6 m and therefore equality holds at all places this proves that the supremum in the definition of m is attained by the function g s step 2 under the additional assumption that is a finite measure we show next that g has the required properties to this end we must show that 0 where the finite measure is defined by f f f gd f f 70 the classical banach spaces assume for a contradiction that 0 consider the real valued measures n 1 n n 1 it is here that we use the assumption that is finite without this assumption n would not be a real valued measure for each n 1 we decompose n n with respect to n as in theorem 2 45 and set n 1 n if we had 0 then for large enough n 1 we have 06 1 n n 6 0 and therefore upon letting n we obtain 0 this contradiction proves that 0 if we had n 0 for all n 1 it would follow that n for all n 1 and therefore 0 having assumed that 0 we conclude that n 0 for some n 1 if f f is a subset of n then f 1 n f n f n f n n f 0 and therefore f 1 n f letting h g 1 n 1 n we obtain for arbitrary f f f hd f gd 1 n f n 6 f gd f n f n gd f n 6 f n f n f using 2 17 in the last inequality this proves that h s then by the definition of m m hd gd 1 n n m 1 n n since m this is only possible if n 0 by 2 17 and absolute continuity this would imply n gd 6 n 0 and therefore by the definition of and the nonnegativity of g 0 n n gd 6 0 this contradiction concludes the proof that 0 step 3 for finite measures the theorem has now been proved it remains to extend the result to the finite case again it suffices to consider the case where is a finite nonnegative measure write n 1 n where the sets n f are disjoint and satisfy n define the nonnegative function g on by g gn for n n 1 2 4 spaces of measures 71 where the nonnegative functions gn l 1 n n are given by step 2 applied to n that is f n f n gn d f n gd f f by additivity this implies f n n 1 n f n n 1 n gd f f letting n by monotone convergence we obtain f f gd f f taking f and using that is finite we see that g is integrable with respect to that is we have g l 1 the function g has the required properties an alternative proof of the radon nikody m theorem based on hilbert space meth ods is outlined in problem 3 22 example 2 47 if f k is integrable with respect to then f f f d f f defines a k valued measure and for all f f we have f f f d if f is real valued then is a real measure and f f f d to prove the first assertion let a 1 an f be disjoint subsets of f then n j 1 a j 6 n j 1 a j f d 6 f f d which gives the upper bound 6 to prove the lower bound we use proposition f 1 to choose simple functions gn k such that gn 1 f f and 0 6 gn 6 1 f f say gn nn j 1 c n j 1 a n j with a n 1 a n nn f disjoint subsets of f then f f d lim n nn j 1 c n j a n j 6 limsup n nn j 1 a n j 6 f to prove the second assertion we note that the sets f 0 and f 6 0 satisfy the requirements of the second part of theorem 2 45 and the second part of 72 the classical banach spaces the proof of the theorem shows that the decomposition is obtained from any such decomposition of for real scalars this also gives a second proof of the first assertion f f f f f f d f f d example 2 48 if is ak valued measure then is absolutely continuous with respect to its variation by the radon nikody m theorem there exists h l 1 such that f f hd f f by the result of example 2 47 f f h d f f so h 1 almost everywhere 2 4 c integration with respect to k valued measures a measurable function f is said to be integrable with respect to a k valued measure if it is integrable with respect to the function f is integrable with respect to a real measure if and only if it is integrable with respect to the measures and where is the jordan decomposition and f is integrable with respect to a complex measure if and only if f is integrable with respect to the real and imaginary parts of the integral of an integrable function f with respect to a real measure is defined by f d f d f d and the integral of an integrable function f with respect to a complex measure by f d f dre i f dim proposition 2 49 if f is integrable with respect to a k valued measure then f d 6 f d proof first let f nn 1 cn 1 fn be a simple function with the sets fn f disjoint then f d n n 1 cn fn 6 n n 1 cn fn 6 n n 1 cn fn f d the general case follows from this by observing that the simple functions are dense 2 5 banach lattices 73 in l 1 and that fn f in l 1 implies fn f d 0 for each of the measures re im a more elegant but less elementary alternative definition of the integral f d can be given with the help of the radon nikody m theorem indeed defining f d as above by the result of example 2 48 for functions f l 1 we have the identity f d f hd where d hd as in the example note that f h l 1 since h 1 almost everywhere this identity could be taken as an alternative definition for the integral f d 2 5 banach lattices over the real scalar field all banach spaces discussed in this chapter are examples of banach lattices a class of banach spaces that will be briefly discussed in this section the main result theorem 2 57 shows that any complete norm on a banach lattice x which is monotone with respect to the partial order of x is equivalent to the given norm of x let s 6 be a partially ordered set and let s be a subset of s an element x s is said to be a lower bound for s if we have x 6 x for all x s such an element is called a greatest lower bound for s if y 6 x holds for every lower bound y for s similarly an element x s is said to be an upper bound for s if we have x 6 x for all x s and such an element is called a least upper bound for s if x 6 y holds for every upper bound y for s greatest lower bounds and least upper bounds if they exist are unique definition 2 50 lattices a partially ordered set s 6 is called a lattice if every pair of elements has a greatest lower bound and a least upper bound the greatest lower bound and the least upper bound of the pair x y s in a partially ordered set s will be denoted by x y and x y respectively definition 2 51 vector lattices a vector lattice is a partially ordered real vector space v 6 with the following properties i v 6 is a lattice ii for all 06 c r and u v v we have u 6 v cu 6 cv iii for all u v w v we have u 6 v u w 6 v w 74 the classical banach spaces let v 6 be a vector lattice if u u v v v satisfy u 6 v and u 6 v then u u 6 v u and v u 6 v v thus u 6 v and u 6 v u u 6 v v by transitivity also if u 6 v then v u u v 6 v u v u and the converse inequality is obtained similarly thus u 6 v v 6 u 2 18 for v v we define v v 0 v v 0 v v v if 06 c r then cv cv and if c r then cv c v the easy proofs are left to the reader furthermore from u v 6 u v it follows that u v 6 u v 2 19 the next proposition lists some slightly less trivial identities proposition 2 52 let v 6 be a vector lattice then for all u v w v we have 1 u v u v 2 u v w u v u w 3 u v u v u v 4 v v v 5 v v v the representation of v as the difference of two positive elements in 4 is unique see problem 2 42 proof let u v w v 1 we have u 6 u v so u v 6 u by 2 18 in the same way we obtain u v 6 v if follows that u v is a lower bound for u v to prove that it is the greatest lower bound we must show that if w 6 u and w 6 v then w 6 u v this follows by noting that u 6 w and v 6 w so w is an upper bound for u v and therefore u v 6 w by 2 18 this implies w 6 u v as required 2 we have u v 6 u v w and u w 6 u v w so u v w is an upper bound for u v u w to prove that is the least upper bound we must show that if u v 6 x and u w 6 x then u v w 6 x but v 6 x u and w 6 x u imply u v 6 x u and therefore u v w 6 x as desired 3 in view of 1 we must show that u v u v u v we have u v u v 6 u v v u and similarly u v u v 6 v it follows that u v u v 6 u is a lower bound for u v to prove that it 2 5 banach lattices 75 is the greatest lower bound we must show that if w 6 u and w 6 v then w 6 u v u v or equivalently w u v 6 u v by 2 18 and 1 this in turn is equivalent to u v 6 u v w to prove this inequality we note that w 6 u implies 0 6 u w and hence v 6 u v w in the same way we obtain u 6 u v w and together these inequalities imply u v 6 u v w as desired 4 taking u 0 in 3 and using 1 we obtain v 0 v 0 v v 0 v v v 5 by 2 v v v implies v v 0 2 v 2 v 2 v it follows that v v 2 v v v 1 2 v v v definition 2 53 normed vector lattices a normed vector lattice is a triple x 6 with the following properties i the pair x is a real vector space ii the pair x 6 is vector lattice iii for all x y x we have x 6 y x 6 y in any normed vector lattice we have x x 2 20 moreover the lattice operations x 7 x x 7 x x 7 x are continuous indeed by 2 19 we have x y 6 x y and therefore by 2 20 x y 6 x y x y this gives the continuity of x 7 x the other two assertions follow from this by noting that x 12 x x and x x x as a consequence we note that the positive cone x x x x 0 is closed definition 2 54 banach lattices a banach lattice is a complete normed vector lattice the spaces c 0 p c k and lp with 16 p 6 are banach lattices with respect to their natural pointwise ordering and m is a banach lattices with respect to the ordering given by declaring 6 if and only if the measure is nonnegative the greatest lower bound and least upper bound of and are given by respectively cf problem 2 41 here is defined as in theorem 2 45 alterna tively one may use the analogues for m of the formulas appearing in theorem 4 5 76 the classical banach spaces the jordan decomposition of a real measure now becomes a special case of proposition 2 52 4 definition 2 55 let v and w be vector lattices a linear operator t v w is said to be positivity preserving if v 0 implies t v 0 if t v w positivity preserving then t v 6 t v v v 2 21 indeed from v 6 v we have t v 6 t v and from 0 6 v we have 0 t 0 6 t v combining these inequalities gives t v 6 t v in the same way we see that t v 6 t v and the claim follows theorem 2 56 let x and y be banach lattices every positivity preserving linear op erator t x y is bounded proof reasoning by contradiction suppose that t is not bounded then for all n 1 there is a norm one vector xn x such that t xn n 3 by 2 20 and 2 21 upon replacing xn by xn we may assume that xn 0 for all n 1 in view of n 1 xn n 2 the sum n 1 xn n 2 converges in x for all 16 n 6 n we have xn n 2 6 n m 1 xm m 2 and the closedness of the positive cone x implies that for all n 1 we have xn n 2 6 m 1 xm m 2 hence for all n 1 n 6 1 n 2 t xn 6 t m 1 xm m 2 this contradiction completes the proof this theorem has an interesting consequence theorem 2 57 any two norms which turn a vector lattice into a banach lattice are equivalent proof suppose the vector lattice x 6 is a banach lattice with respect to the norms and then by theorem 2 56 the identity mapping from x to x and its inverse are bounded problems 2 1 let 16 p 6 q 6 show that if a p then a r for all p 6 r 6 q and a p 6 a r lim r q a r a q hint first show that it suffices to consider sequences a an n 1 satisfying an 6 1 for all n 1 problems 77 2 2 show that c 0 and p with 16 p are separable but is not hint contains an uncountable family a i i i such that a i a i 1 for all i 6 i prove that a normed space x containing such a sequence is nonseparable 2 3 prove the completeness assertions at the end of section 2 2 a 2 4 let k be a compact metric space our aim is to prove that if fn n 1 is a sequence in c k satisfying f 1 x f 2 x 0 and limn fn x 0 for all x k then limn fn 0 uniformly on k this result known as dini s theorem provides one of the rare instances where pointwise convergence implies uniform convergence a reasoning by contradiction show that if the result is false then there exists an 0 a sequence xn n 1 in k and an x k such that limn xn x and fn xn 1 2 for all n 1 b using that also fn x 0 as n and fn xn 6 fm xn when n m show that this leads to a contradiction 2 5 find a sequence fn n 1 in cb 0 1 such that 0 6 fn 1 x 6 fn x 6 1 for all x 0 1 and n 1 and fn x 0 for all x 0 1 but fn 6 0 compare this with dini s theorem problem 2 4 2 6 let k be a compact topological space and x be a banach space prove that the space c k x of all continuous functions f k x is a banach space with respect to the supremum norm f supx k f x 2 7 let d be a bounded open subset of rd by ck d we denote the space of func tions f d k that are k times continuously differentiable on d and all of whose partial derivatives f extend continuously to d for all multi indices 1 d nd satisfying 1 d 6 k here 1 1 d d where j is the partial derivative in the jth direction prove that ck d is a banach space with respect to the norm f ck d max 6 k f 2 8 consider the vector space p 0 1 of all polynomials on 0 1 a show that t 7 n n 0 cnt n max t 7 bn 2 c k 0 c 2 kt 2 k 2 t 7 dn 2 e k 1 c 2 k 1 t 2 k 1 defines a norm on p 0 1 here byc is the greatest integer n 6 y and dye is the least integer n y b show that the functions 1 t 2 t 4 span a subspace of p 0 1 which is dense with respect to the supremum norm c conclude that two different norms on a normed space may agree on a sub space which is dense with respect to one of these norms 78 the classical banach spaces 2 9 we prove the existence of smooth functions with various properties a show that the function f r 0 defined by f x exp 1 x 2 x 0 0 x 6 0 belongs to c r b show that there exists a function f c c 0 1 such that f 0 pointwise and 1 0 f x dx 1 c show that if d rd is open and nonempty there exists a function f c c d such that f 0 pointwise and d f x dx 1 d show that if f c c rd and g rd k is continuous then the convolution f g is smooth and f g f g for every multi index nd notation is as in problem 2 7 e show that if k d rd where k is nonempty and compact and d is open then there exists a function f c c d such that 0 6 f 6 1 pointwise and f 1 on k hint let d k d and put k x d d x k 6 1 3 d x d d x k 2 3 apply part c to select a nonnegative function f c c b 0 1 3 satisfying b 0 13 f x dx 1 and apply part d to the function g x d x d d x d d x k x d 2 10 let f f c 0 1 06 f 6 1 f 0 0 f 1 1 and consider the mapping c 0 1 c 0 1 defined by f t t f t t 0 1 a show that f is bounded convex and closed in c 0 1 b show that maps a into a and satisfies f g f g for all f g f f 6 g c show that has no fixed point in f d compare this result with the banach fixed point theorem problems 79 2 11 let 16 p 6 a show that for 16 p the space lp 0 1 is the completion of c 0 1 with respect to the norm f p 1 0 f t p dt 1 p b show that c 0 1 can be identified in a natural way with a proper closed subspace of l 0 1 2 12 prove the assertion in remark 2 27 can the finiteness condition be omitted 2 13 let f be a measure space show that if fn f in l then there is a null set n such that limn sup n fn f 0 compare this with corollary 2 21 2 14 show that passing to a subsequence is necessary for corollary 2 21 to be true hint consider the unit circle t z c z 1 with its lebesgue measure let tn n m 1 1 m and consider the indicator functions of the arcs in e 2 it t tn tn 1 2 15 consider the set s f l 1 0 1 f t 0 for almost all t 0 1 a determine whether s is an open subset of l 1 0 1 b characterise the functions belonging to the closure s consider the set s f l 1 0 1 f t 0 for almost all t 0 1 c determine whether s is a closed subset of l 1 0 1 d characterise the functions belonging to the interior s 2 16 let f be a measure space and let g f be a sub algebra show that for all 1 6 p 6 the set lp g consisting of all f lp that are equal almost everywhere to a g measurable function is a closed subspace of lp 2 17 for n n and j 0 1 2 n 1 we consider the interval i j n j 2 n j 1 2 n 0 1 let 16 p and define the operators en lp 0 1 lp 0 1 n 1 by f 7 en f 2 n 1 j 0 1 i j n 1 i j n i j n f t dt f lp 0 1 a show that each en is bounded on lp 0 1 with norm en 1 b show that for all f lp 0 1 we have limn en f f in lp 0 1 hint consider what happens for functions in the linear span of the set 1 i j n 06 j 6 2 n 1 n n 80 the classical banach spaces 2 18 using young s inequality show that if f lp rd g lq rd h lr rd with 16 p q r 6 such that 1 p 1 q 1 r 2 then rd rd f x g x y h y dxdy 6 f p g q h r 2 19 write out a proof of corollary 2 30 2 20 let f be a finite measure space and let 16 p 6 prove that f p f d f f d 1 p defines an equivalent norm on lp here p is the usual norm on lp 2 21 let f be a measure space and fix 16 p q 6 a prove that lp lq is a banach space with respect to the norm f lp lq max f lp f lq b prove that lp lq g h g lp h lq is a banach space with respect to the norm f lp lq inf g lp h lq f g h g l p h lq hint for the proof of completeness use proposition 1 3 c prove that if 16 p 6 r 6 q 6 then lp lq lr lp lq and that the inclusion mappings are continuous hint write f 1 f 61 f 1 f 1 f d prove that if 1 6 p 6 r 6 q 6 and 0 6 6 1 is chosen such that 1 r 1 p q then for all f l p lq we have f r 6 f 1 p f q hint use ho lder s inequality with suitable exponents 2 22 prove lusin s theorem if d rd is open and bounded and f d k is mea surable then for every 0 there exists a function g cc d such that x d f x 6 g x hint study the proof of proposition 2 29 2 23 let f be a finite measure space let 16 p 6 and suppose that fn n 1 is a bounded sequence in lp converging to a measurable function f almost everywhere problems 81 a using fatou s lemma show that f lp and f p 6 liminfn fn p now assume that 1 p 6 b show that limn fn f in l 1 hint first show that for every 0 there exists an r 0 such that sup n 1 fn r fn d c do we have limn fn f in lp 2 24 let f be a probability space and let k r be a convex function prove jensen s inequality if a function f l 1 has the property that f is integrable then f d 6 f d hint a convex function is the pointwise supremum of all affine functions x ax b satisfying 6 pointwise 2 25 on r 0 we consider the borel measure given by b b 1 t dt b b r a show that for all b b r and s r we have b sb b b 1 where sb st t b and b 1 t 1 t b b for h l 1 r dtt and s r show that 0 h st dt t 0 h t dt t 0 h t 1 dt t fix 16 p for f lp r dtt and g l 1 r dtt we define the multiplicative convolution f g t 0 f t s g s ds s t r c show that the multiplicative convolution is well defined for almost all t r and that the following analogue of young s inequality holds f g lp r dtt 6 f lp r dtt g l 1 r dtt d show that f g g f 82 the classical banach spaces 2 26 let k 0 1 0 1 k be measurable and suppose that a esssup y 0 1 1 0 k x y dx b esssup x 0 1 1 0 k x y dy let 16 p 6 and define for f lp 0 1 tk f x 1 0 k x y f y dy x 0 1 show that tk lp 0 1 lp 0 1 is a well defined linear operator which satisfies the so called schur estimate tk f p 6 a 1 pb 1 1 p f p f lp 0 1 hint use ho lder s inequality 2 27 let f be a measure space and let x be a banach space for 16 p 6 we denote by lp x the space of all equivalence classes of strongly measurable functions f x for which 7 f belongs to lp a prove that lp x is a banach space with respect to the norm f p 7 f lp by lp x we denote the vector space obtained as the linear span in lp x of the set of all functions of the form f x cf 1 6 with f lp and x x b show that if 16 p then lp x is dense in lp x 2 28 let f be a measure space and 16 p let t be a bounded operator on lp and let x be a banach space consider the linear mapping from lp x into itself defined by t i f x t f x a show that the operator t i is well defined b prove that if t is a positive operator then t i admits a unique extension to a bounded operator on lp x and that its norm of equals the norm of t 2 29 let f and f be measure spaces and let 16 p 6 q a show that the identity mapping on linear combinations of functions of the form 1 a 1 b 1 a 1 b extends uniquely to a contraction operator from lp lq into lq lp hint use 1 7 problems 83 b deduce that if f and f are finite and f k is a measurable function then the continuous minkowski inequality holds f p d q p 1 q 6 f q d p q 1 p 2 30 let f l 1 loc r d be given a show that for all c k there exists a borel null set nc rd such that for all x nc we have lim b 3 x b 0 1 b b f y c dy f x c 2 22 b show that there exists a borel null set l rd with l 0 such that 2 22 holds all x l and c k hint consider n 1 ncn with cn n 1 a dense sequence in k a set l with the properties of part b is called a lebesgue set for f 2 31 prove the following one sided version of the lebesgue differentiation theorem for d 1 if x is a lebesgue point of f l 1 loc r then lim h 0 1 h x h x f y f x dy lim h 0 1 h x x h f y f x dy 0 2 32 show that a subset k of c 0 is relatively compact if and only if there is a y c 0 such that for all x k and n 1 we have xn 6 yn 2 33 let 1 6 p show that a bounded subset s of p is relatively compact if and only if for every 0 there exists an index n 1 such that sup x s n n xn p 6 p 2 34 let s be a nonempty set for 16 p let p s be the completion of the space of all finitely nonzero functions f s k that is functions such that f s 6 0 for at most finitely many different s s with the norm f p s s f s p 1 p where the sum extends over the finitely many s s for which f s 6 0 a show that p s can be isometrically identified with the space of all count ably nonzero functions f s k that is functions such that f s 6 0 for at most countably many different s s for which f p s s f s p 1 p is finite how should this sum be interpreted 84 the classical banach spaces b show that p s is a banach space in a natural way 2 35 show that a k valued measure is absolutely continuous with respect to a mea sure if and only if for every 0 there exists a 0 such that f whenever f f satisfies f 2 36 ak valued measure on a topological space x is said to be regular respectively radon if its variation is regular see definition e 15 respectively radon see definition e 20 prove that the sets mr x and mr x of all k valued borel measures on x that are regular respectively radon are closed subspaces of m x 2 37 a function f 0 1 k is said to be absolutely continuous if for every 0 there exists a 0 such that whenever an nn 1 and bn n n 1 are finite sequences in 0 1 satisfying n 1 bn an then n n 1 f bn f an it is said to be of bounded variation if var f n n 1 f tn f tn 1 where the supremum is taken over all finite partitions t 0 tn of 0 1 a show that a function f 0 1 k is absolutely continuous and satisfies f 0 0 if and only if there exists a function g l 1 0 1 such that f t t 0 g s ds t 0 1 and that this function g if it exists is unique hint for the only if part use the radon nikody m theorem b show that the space nbv 0 1 of functions f 0 1 k of bounded varia tion satisfying f 0 0 is a banach space with respect to the norm f nbv 0 1 sup var f c show that the space of all absolutely continuous functions f 0 1 k satisfying f 0 0 is a closed subspace of nbv 0 1 and that f nbv 0 1 g l 1 0 1 f nbv 0 1 where g l 1 0 1 is the function of part a 2 38 the disc algebra a d is the closed subspace of the banach space c d consisting of those functions that are holomorphic on d by the maximum principle f sup f ei problems 85 a show that for all f c d and z 0 d we have f z 0 1 2 i t f z z z 0 dz b show that a function f c d belongs to a d if and only if f n 0 for all n z n where f n 1 2 f ei e in d n z 2 39 let lip 0 1 be the vector space of all functions f 0 1 k for which f lip 0 1 f 0 sup 06 x y 61 x 6 y f x f y x y is finite show that lip 0 1 is a banach space with respect to the norm lip 0 1 2 40 a function f l 1 loc r d is said to have bounded mean oscillation if f bmo rd sup b 1 b b f x avb f dx is finite where the supremum is taken over all balls b in rd b is the lebesgue measure of b and avb f 1 b b f y dy is the average of f on b a show that if f and g have bounded mean oscillation then i c f has bounded mean oscillation and c f bmo rd c f bmo rd ii f g has bounded mean oscillation and f g bmo rd 6 f bmo rd g bmo rd b show that f bmo rd 0 if and only if f is almost everywhere constant c show that every f l rd has bounded mean oscillation and f bmo rd 6 2 f d show that the unbounded function x 7 log x has bounded mean oscillation e show that the quotient space bmo rd bmo rd k obtained as the quotient modulo the constant functions of the vector space bmo rd of functions with bounded mean oscillation is a banach space in a natural way 2 41 show that in a vector lattice v 6 the greatest lower bound and the least upper bound of two elements u v v satisfy u v u u v v v u and u v u v u v u v 2 42 let v be a vector lattice 86 the classical banach spaces a show that for all v v we have v v 0 and v v v b show that if v w w v satisfy v w w with w 0 and w 0 then w v and w v c show that if v w w v satisfy v w w with w 0 w 0 and w w then w v and w v 2 43 prove that if x is a normed vector lattice the lattice operations x y 7 x y and x y 7 x y are continuous from x x to x 2 44 provide the missing details to the proof outlines at the end of section 2 5 that the spaces m studied in section 2 4 are banach lattices 3 hilbert spaces arguably the most important class of banach spaces is the class of hilbert spaces these spaces play a central role in the theory and in various areas of applications some of which will be discussed in later chapters the present introductory chapter develops the basic geometric properties of hilbert spaces arising from the presence of an inner prod uct generating the norm such as the orthogonal complementation of closed subspaces the existence of orthonormal bases and the selfduality of hilbert spaces embodied by the riesz representation theorem 3 1 hilbert spaces let v be a vector space a mapping v v k is called sesquilinear if it is linear in the first variable and conjugate linear in the second variable that is v v w v w v w cv w c v w 3 1 v w w v w v w v cw c v w 3 2 for all c k and v v w w v the complex conjugation in 3 2 is of course redundant when the scalar field is real and sesquilinearity reduces to bilinearity in that case definition 3 1 inner products an inner product space is a pair h where h is a vector space and is an inner product on h h that is a sesquilinear mapping from h h to k with the following properties i x x 0 for all x h and x x 0 x 0 this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 87 88 hilbert spaces ii x y y x for all x y h the conjugation bar in ii is again redundant when the scalar field is real if ii holds then 3 1 implies 3 2 it will be used frequently without further comment that if x y 0 for all y h then x 0 indeed the hypothesis implies that x x 0 and then x 0 by the definition of an inner product when the inner product is understood we simply write h instead of h example 3 2 here are some examples of inner products i on kd an inner product is given by x y dn 1 xnyn ii on 2 an inner product is given by a b n 1 anbn iii on l 2 an inner product is given by f g f gd in order to turn inner product spaces into normed vector spaces we need the follow ing inequality its finite dimensional version has already been used in various places in chapters 1 and 2 proposition 3 3 cauchy schwarz inequality let h be a vector space and consider a sesquilinear mapping h h k with the following properties i x x 0 for all x h ii x y y x for all x y h then for all x y h we have x y 2 6 x x y y proof we may assume that y 6 0 since otherwise the inequality trivially holds fix a scalar c k then 06 x cy x cy x x x cy cy x cy cy x x c x y c x y c 2 y y x x 2 re c x y c 2 y y the choice c x y y y results in the inequality 06 x x 2 re x y 2 y y x y 2 y y x x x y 2 y y multiplying with y y gives the desired result this result is valid without assuming the nondegeneracy assumption in the second part of the defining property i of an inner product 3 1 hilbert spaces 89 proposition 3 4 every inner product space h can be made into a normed space by defining x x x 1 2 x h proof we must check that defines a norm on h it is immediate that x 0 implies x 0 and that cx c x the triangle inequality follows from the cauchy schwarz inequality x y 2 x 2 2 re x y y 2 6 x 2 2 x y y 2 x y 2 henceforth it is understood that inner product spaces are always endowed with this norm as a corollary to the cauchy schwarz inequality we record corollary 3 5 every inner product x y is jointly continuous as a function of x and y proof it suffices to show that if xn x and yn y then xn yn x y we have xn yn x y 6 xn yn xn y xn y x y xn yn y xn x y 6 xn yn y xn x y since convergent sequences are bounded the number m supn 1 xn is finite and we find xn yn x y 6 m yn y xn x y both terms on the right hand side tend to 0 as n proposition 3 6 parallelogram identity in every inner product space h the parallel ogram identity holds for all x y h we have 2 x 2 2 y 2 x y 2 x y 2 conversely if x is a normed space with the property that the parallelogram identity holds for all x y x then x is an inner product space that is there exists an inner product on x generating the norm of x in what follows we only need the first part of the proposition its converse is included for reasons of completeness and can be safely skipped upon first reading the inequality admits lp versions known as clarkson s inequalities see prob lem 5 26 proof the proof of the first part is routine x y 2 x y 2 x y x y x y x y 2 x x 2 y y 2 x 2 2 y 2 90 hilbert spaces the proof of the second assertion is quite involved and relies on finding a formula for the inner product in terms of the norm of x to get an idea what this formula might look like we first assume there is such an inner product and denote it by then using that y x x y x y 2 x y x y x x x y y x y y x 2 2 re x y y 2 and similarly x y 2 x 2 2 re x y y 2 combining the two identities we get re x y 1 4 x y 2 x y 2 3 3 if the scalar field k is real then re x y x y and the above identity expresses the inner product in terms of the norm if the scalar field k is complex by the previous identity we obtain im x y re x iy 1 4 x iy 2 x iy 2 this leads to the identity x y re x y i im x y 1 4 x y 2 x y 2 i x iy 2 i x iy 2 3 4 in an arbitrary normed space we could now try to define an inner product by 3 3 if k r respectively by 3 4 ifk c but this does not always give a norm if however the parallelogram identity holds then it does let us check this for the casek r first x x 1 4 x x 2 x x 2 x 2 0 and x x 0 implies x 0 and hence x 0 second the identity x y y x is immediate third x x y 1 4 x x y 2 x x y 2 1 4 2 x 2 2 x y 2 x x y 2 1 4 2 x 2 2 x y 2 x x y 2 1 2 x y 2 x y 2 1 4 x x y 2 x x y 2 2 x y x x y 3 1 hilbert spaces 91 this proves that x x y x x y 2 x y 3 5 taking x x in 3 5 we obtain 2 x y 2 x y now let x 0 x 1 x be arbitrary apply ing 3 5 to x 12 x 0 x 1 and x 12 x 0 x 1 gives x 0 y x 1 y 2 1 2 x 0 x 1 y which in view of the earlier identities simplifies to x 0 y x 1 y x 0 x 1 y this gives additivity in the first coordinate additivity in the second coordinate is proved similarly using this inductively for positive integers k we obtain kx y k 1 x x y k 1 x y x y k 2 x x y x y k 2 x y 2 x y x y k 1 x y k x y applying this to k 1 x we also find k 1 x y k 1 x y next let q m n with m n positive integers by what we just proved qx y m n 1 x y mn 1 x y q x y this proves homogeneity with respect to multiplication with the positive rationals for such rationals we also have qx y qx y q x y and therefore homogene ity holds for all rationals finally by the continuity of the norm the mapping q 7 qx y is continuous the mapping q 7 q x y is continuous for trivial reasons therefore the identity cx y c x y for arbitrary c r follows by approximation by rationals this completes the proof that for k r the formula for in 3 3 indeed defines an inner product we have already seen that x x x 2 so this inner product generates the norm of x for k c it can be verified in a similar manner that the formula for in 3 4 defines an inner product and that it generates the norm of x definition 3 7 hilbert spaces a hilbert space is a complete inner product space thus by definition every hilbert space is a banach space example 3 8 by the completeness results in the preceding chapter all three spaceskd 2 l 2 featuring in example 3 2 are hilbert spaces further examples of hilbert spaces will be given in the problems section 92 hilbert spaces proposition 3 9 completion let h be an inner product space on its completion h as a normed space a well defined inner product is obtained by setting x y lim n xn yn x y h whenever xn yn h satisfy x limn xn and y limn yn the norm associated with this inner product coincides with the norm of h obtained by completing h proof the proof relies on a few routine verifications some of which are left as an exercise to the reader first of all it easily follows from corollary 3 5 that x y is independent of the ap proximating sequences and agrees with their inner product in h when x y h to see that x y is indeed an inner product suppose that x x 0 and let x limn xn with each xn h then limn xn xn 0 and therefore limn xn 0 which by the con struction of the completion means that the cauchy sequence xn n 1 defines the zero element of h it follows that x limn xn 0 in h the remaining properties of an inner product follow trivially by limiting arguments finally the norm of h agrees with the norm generated by its inner product this follows again by approximation if x limn xn with each xn h then for the norm obtained via the completion procedure in the proof of theorem 1 5 we have x 2 lim n xn 2 lim n xn xn x x the first step being true from the definition of this norm the second because the norm of h is generated by its inner product and the third because the inner product is jointly continuous 3 2 orthogonal complements throughout this section we fix a hilbert space h definition 3 10 orthogonality the elements x x h are said to be orthogonal no tation x x if x x 0 two subsets a and b of h are called orthogonal if a b for all a a and b b orthogonal elements x x satisfy the pythagorean identity x x 2 x 2 x 2 as is seen by expanding the square norms in terms of inner products 3 2 orthogonal complements 93 definition 3 11 orthogonal complement the orthogonal complement of a subset a of h is the set a x h x a for all a a the orthogonal complement a of a subset a is a closed subspace of h indeed it is trivially checked that a is a vector space to prove its closedness let xn x in h with xn a then by the continuity of the inner product for all a a we obtain x a limn xn a 0 the most important result on orthogonality is certainly the fact that every closed subspace y of a hilbert space is orthogonally complemented by y this is the content of theorem 3 13 below for its proof we need the following approximation theorem for convex closed sets in hilbert space recall that a subset c of a vector space is called convex if for all x 0 x 1 c we have 1 x 0 x 1 c for all 06 6 1 theorem 3 12 best approximation let c be a nonempty convex closed subset of h then for all x h there exists a unique c c that minimises the distance from x to the points of c x c min y c x y proof let yn n 1 be a sequence in c such that lim n x yn inf y c x y d we claim that this sequence is cauchy by the parallelogram identity of proposition 3 6 applied to the vectors x ym and x yn yn ym 2 2 x yn ym 2 2 x ym 2 2 x yn 2 as m n the right hand side tends to 2 d 2 2 d 2 4 d 2 whereas from 12 ym yn c by convexity it follows that 2 x yn ym 2 4 x 12 yn ym 2 4 d 2 it follows that limsup m n yn ym 2 6 4 d 2 4 d 2 0 the limit superior is also nonnegative and therefore it equals 0 this proves the claim since h is complete we have limn yn c for some c h and since c is closed we have c c now x c limn x yn d so c minimises the distance to x both the existence and uniqueness parts of this theorem fail for general banach spaces see problems 3 5 and 3 6 94 hilbert spaces theorem 3 13 closed subspaces are orthogonally complemented if y is a closed linear subspace of h then we have an orthogonal direct sum decomposition h y y that is we have y y 0 y y h and y y proof we have already seen that y is a closed subspace if y y y then y y so y y 0 and y 0 it remains to show that y y h let x h be arbitrary and fixed we must show that x y y let y h y denote the mapping arising from theorem 3 12 that is y x is the unique element of y minimising the distance to x x y x min y y x y set y 0 y x and y 1 x y 0 then y 0 y and for all y y we have y 1 x y 0 6 x y 0 y y y x y 0 y y 1 3 6 we claim that 3 6 implies y 1 y to see this fix a nonzero y y for any c k we have by 3 6 y 1 2 6 cy y 1 2 c 2 y 2 2 re cy y 1 y 1 2 taking c y y 1 y 2 this gives 06 y y 1 2 y 2 2 y y 1 2 y 2 which is only possible if y 1 y 0 since 0 6 y y was arbitrary this shows that y 1 y this proves the claim it follows that x y 0 y 1 belongs to y y definition 3 14 orthogonal projection onto a closed subspace the projection y onto y along y given by y y y y y y y y is called the orthogonal projection onto y the pythagorean inequality implies that y 6 1 with equality if y 6 0 as was shown in the course of the proof of theorem 3 13 the projection y coincides with the mapping arising from theorem 3 12 for general closed convex sets c the distance minimising mapping of theorem 3 12 is generally nonlinear as a corollary to theorem 3 13 for closed subspaces y we get y y and more generally for any subspace y we get since y y y y 3 3 the riesz representation theorem 95 by way of example if hn nn 1 is an orthonormal sequence the orthogonal projection n in h onto the span of h 1 hn is given by nx n n 1 x hn hn as the reader will have no difficulty checking 3 3 the riesz representation theorem let h be a hilbert space as a first application of theorem 3 13 we prove the riesz rep resentation theorem which sets up a conjugate linear identification of a hilbert space h and its dual h l h k by the cauchy schwarz inequality every h h defines a bounded functional h h k by taking inner products h x x h boundedness is evident from h x x h 6 x h which shows that h 6 h from h h h h h 2 we see that also h h so that h h all bounded functionals h k arise in this way theorem 3 15 riesz representation theorem if h k is a bounded functional there exists a unique element h h such that h that is g g h g h proof if x 0 for all x h we take h 0 henceforth we shall assume that 6 0 then n 6 0 by theorem 3 13 and we can choose a norm one vector y 0 n fix an arbitrary x h with c x y 0 we have x cy 0 x c y 0 0 this means that x cy 0 n so x cy 0 y 0 and x c y 0 y 0 cy 0 y 0 y 0 x y 0 x y 0 y 0 this proves that h with h y 0 y 0 to prove uniqueness suppose that h h for h h h then h h 2 h h h h h h h h h h 0 and therefore h h proposition 3 16 for every bounded sequence xn n 1 in h there exist a subsequence xnk k 1 and an x h such that lim k h xnk h x h h 96 hilbert spaces proof let h 0 denote the closed linear span of xn n 1 and let h 0 be its orthogonal complement so that we have the orthogonal decomposition h h 0 h 0 step 1 we begin by proving that there exist a subsequence xnk k 1 and an x h 0 such that lim k h xnk h x h h 0 let y j j 1 be a sequence whose linear span y is dense in h 0 the xn n 1 sequence has a subsequence which after relabelling we may call x 1 n n 1 such that the limit y 1 limn y 1 x 1 n exists this sequence has a further subsequence which af ter relabelling we may call x 2 n n 1 such that the limit y 2 limn y 2 x 2 n ex ists note that we also have y 1 limn y 1 x 2 n continuing inductively for ev ery k 1 we obtain a subsequence x k n n 1 with the property that the limit y j limn y j x 2 n exists for j 1 k the diagonal subsequence x n n n 1 has the property that the limit y j limn y j x n n exists for all j 1 by linearity the limit y limn y x n n exists for all y y clearly y 7 y is linear and y 6 m y where m supn 1 xn this shows that is bounded as a mapping from y to k since y is dense in h 0 proposition 1 18 implies that has a unique bounded ex tension of the same norm to all of h 0 by the riesz representation theorem applied to the hilbert space h 0 there exists an x h 0 such that h h x for all h h 0 this element has the required properties for all h y we have lim n h x n n h h x for general h h 0 the same identity holds by an approximation argument using that y is dense in h 0 step 2 we now show that lim n h x n n h x h h where x n n n 1 and x h 0 are as in step 1 to this end let h h be arbitrary and write h h 0 h 0 along the orthogonal decomposition h h 0 h 0 step 1 gives limk h 0 x n n 0 h 0 x for h 0 h 0 trivially limk h 0 x n n 0 h 0 x for all h 0 h 0 this concludes the proof the argument is step 1 is known as a diagonal argument 3 4 orthonormal systems we have the following simple criterion for the convergence of a series whose terms are pairwise orthogonal 3 4 orthonormal systems 97 proposition 3 17 let xn n 1 be a sequence in h with xm xn for all m 6 n the following assertions are equivalent 1 n 1 xn converges in h 2 n 1 xn 2 in this situation n 1 xn 2 n 1 xn 2 proof let us first note that if i is any finite set of positive integers then n i xn 2 m i xm n i xn m i n i xm xn n i xn 2 since xm xn 0 if m 6 n 1 2 if n 1 xn converges in h say to x then x limn nn 1 xn in h and therefore x 2 lim n n n 1 xn 2 lim n n n 1 xn 2 it follows that n 1 xn 2 x 2 this also proves the final identity in the statement of the proposition since by definition n 1 xn x 2 1 suppose conversely that n 1 xn 2 then lim m n n m n n 1 xn m n 1 xn 2 lim m n n m n n m 1 xn 2 lim m n n m n n m 1 xn 2 0 it follows that nn 1 xn n 1 is cauchy and hence convergent as a special case of proposition 3 17 we record proposition 3 18 parseval let hn n 1 be an orthonormal sequence in h for a scalar sequence cn n 1 the following assertions are equivalent 1 n 1 cnhn converges in h 2 n 1 cn 2 in this situation the parseval identity holds n 1 cnhn 2 n 1 cn 2 98 hilbert spaces definition 3 19 orthonormal system orthonormal basis let i be a nonempty set a family hi i i in h is called an orthonormal system if hi h j i j 1 if i j 0 otherwise for all i j i with i 6 j in the case of a countable set i an orthonormal system hi i i is called an orthonormal basis if every x h can be represented as a convergent series x i i cihi 3 7 for suitable coefficients ci k the convergence of the sum 3 7 is understood in the following sense we pick an enumeration of the index set say i in n 1 and ask for convergence of the sum n 1 cinhin by parseval s theorem this sum converges if and only if n 1 cin 2 thus whether or not the sum converges is independent of the enumeration chosen to see that the sum x n 1 cinhin is independent of the enumeration let jm m 1 be another enumeration of i and set y m 1 c jmh jm then for any i i say i in jm x hi x hin cin ci c jm y h jm y hi since both x and y belong to the closed linear span of the family hi i i this implies x y this argument also shows that the coefficients ci in 3 7 are uniquely determined by x and given by ci x hi example 3 20 the standard unit vectors 0 0 1 0 n 1 with the 1 on the nth place form an orthonormal basis for 2 in section 3 5 we prove that the trigonometric system is an orthonormal basis for l 2 0 1 and the suitably normalised hermite polynomials form an orthonormal basis for l 2 r where is the standard gaussian measure on r theorem 3 21 orthonormal bases let hn n 1 be an orthonormal sequence in h the following assertions are equivalent 1 hn n 1 is a basis 2 hn n 1 has dense linear span 3 if x h satisfies x hn 0 for all n 1 then x 0 proof the equivalence 2 3 is immediate from the fact that a subspace is dense if and only if its orthogonal complement is trivial 1 2 this implication is trivial because by assumption every x h can be ap proximated by the partial sums of a series representation of the form n 1 cnhn and these partial sums belong to the linear span of hn n 1 3 4 orthonormal systems 99 2 1 suppose the linear span of hn n 1 is dense in h and fix an arbitrary x h we must prove that x admits a representation as a convergent sum n 1 cnhn for each n 1 the mapping pnx n n 1 x hn hn is a projection that maps h onto the span hn of hn nn 1 if x hn then x hn 0 for n 1 n and therefore pnx 0 it follows that the projection pn is orthogonal this implies that pn is contractive therefore with cn x hn n n 1 cn 2 pnx 2 6 x 2 this being true for all n 1 it follows that n 1 cn 2 and therefore the sum y n 1 cnhn is convergent in h by proposition 3 18 for all n 1 we have y hn cn x hn and since the span of hn n 1 is dense in h this implies x y n 1 cnhn when xn n 1 is a finite or infinite linearly independent sequence in h we may construct an orthonormal sequence hn n 1 with the property that span x 1 xk span h 1 hk k 1 as follows set h 1 x 1 x 1 suppose the orthonormal vectors h 1 hk have been chosen subject to the condition that h j span x 1 x j equals span h 1 h j for all j 1 k by linear independence the subspace hk 1 span x 1 xk 1 has dimension k 1 the orthogonal complement in hk 1 of the k dimensional subspace hk has dimension 1 and therefore we may select a norm one vector hk 1 hk 1 or thogonal to hk then hk 1 span h 1 hk 1 as desired this procedure is called gram schmidt orthogonalisation theorem 3 22 orthonormal bases and separability a hilbert space has an orthonor mal basis if and only if it is separable proof if by assumption we can find a finite or infinite sequence xn n 1 with dense span in h by passing to a subsequence we may assume that the elements of the sequence are linearly independent by gram schmidt orthogonalisation we construct an orthonormal sequence hn n 1 with the property that for all k 1 the linear span of h 1 hk equals the linear span of x 1 xk since the linear span of xn n 1 is dense in h the sequence hn n 1 is an orthonormal basis of h by theorem 3 21 only if if hn n 1 is an orthonormal basis of h its linear span is dense corollary 3 23 any two infinite dimensional separable hilbert spaces are isometri cally isomorphic 100 hilbert spaces proof suppose that the hilbert spaces h 1 and h 2 are separable and pick orthonormal bases h 1 n n 1 and h 2 n n 1 the operator u sending h 1 n to h 2 n for each n 1 is isometric by the parseval identity and has dense range in particular u is injective by proposition 1 21 u has also closed range and therefore u is surjective definition 3 24 maximal orthonormal systems a maximal orthonormal system is a family hi i i where i is a nonempty set and i hi h j i j for all i j i ii if h hi for all i i then h 0 in a separable hilbert space every maximal orthonormal system is countable and can therefore be relabelled into an orthonormal basis theorem 3 25 maximal orthonormal systems every nonzero hilbert space has a maximal orthonormal system proof partially order the set of all orthonormal systems in the nonzero hilbert space h by set inclusion by zorn s lemma theorem a 3 this set has a maximal element say hi i i where i is some index set it is clear that condition i in the above definition holds if there were a nonzero h h perpendicular to each hi after normalising h to unit length we obtain a new orthonormal system properly containing hi i i contradicting the maximality of hi i i therefore ii also holds 3 5 examples in this final section we present two nontrivial examples of orthonormal bases 3 5 a the trigonometric system in this example t denotes the unit circle in the complex plane parametrised by the interval and equipped with the normalised lebesgue measure d 2 we shall prove that the functions en exp in n z form an orthonormal basis for l 2 t that en n z is an orthonormal sequence in l 2 t is evident from e j ek 1 2 exp i j exp ik d 1 2 exp i j k d jk to prove that en n z is an orthonormal basis by theorem 3 21 it remains to be proved that the trigonometric polynomials i e the functions of the form nn n cnen are dense 3 5 examples 101 in l 2 t this can be deduced from the stone weierstrass theorem see problem 3 11 but we prefer the following argument from fourier analysis which gives explicit ap proximants and some error bounds definition 3 26 fourier coefficients the fourier coefficients of a function f l 1 t are defined as f n f en 1 2 f exp in d n z theorem 3 27 for all f c t we have lim n f 1 n n 1 n 0 n k n f k ek 0 proof fix f c t with f 1 we have f n exp in 1 2 exp in f d 1 2 exp in f d and therefore fn 1 n n 1 n 0 n k n f k exp ik 1 2 kn f d where the feje r kernel kn is defined by kn 1 n n 1 n 0 n k n exp ik 1 n sin 2 12 n sin 2 12 3 8 the right hand side identity is readily deduced from the geometric series in view of the fact that 12 kn d 1 we have fn f 1 2 kn s f f d 6 1 2 kn s f f d 3 9 fix 0 and choose 0 so small that f f for all this is possible since f is uniformly continuous then 1 2 kn f f d 6 2 kn d 3 10 and by 3 8 and the normalisation f 1 1 2 kn f f d 6 2 n 1 sin 2 12 3 11 102 hilbert spaces combining 3 9 with 3 10 and 3 11 we obtain fn f 6 1 n 2 sin 2 12 so limsupn fn f 6 since 0 was arbitrary this completes the proof this theorem implies that the trigonometric polynomials are dense in c t since this space is dense in l 2 t by proposition 2 29 it follows that the trigonometric poly nomials are dense in l 2 t therefore theorem 3 21 implies theorem 3 28 the trigonometric polynomials form an orthonormal basis in l 2 t the theory of orthonormal bases can now be applied it entails that every function f l 2 t has a unique series representation of the form f n z cnen with convergence in l 2 t and coefficients given by cn f en f n the resulting expansion f n z f n en is called the fourier series of f by parseval s identity we have 1 2 f 2 d n z f n 2 and the mapping f 7 f n n z is an isometry from l 2 t onto 2 z by translation and scaling the functions e n exp 2 in n z form an orthonormal basis for l 2 0 1 this can be used to prove corollary 3 29 euler n 1 1 n 2 2 6 proof for the function f in l 2 0 1 we have f e 0 12 and f e n 1 2 in so by parseval s identity 1 3 1 0 2 d f 2 n z f e n 2 1 2 2 2 n 1 1 2 n 2 1 4 1 2 2 n 1 1 n 2 and the result follows another proof will be given in section 14 5 f the system of functions 1 2 sin 2 n 2 cos 2 n n 1 2 3 12 3 5 examples 103 2 1 0 1 2 figure 3 1 the function f extended from 0 1 to 2 2 by odd reflections thick graph and the functions cos n 2 for n 1 2 notice that 2 2 f cos nt 2 d 0 for all n 1 because f is odd about 0 and cos n 2 is even about 0 2 1 0 1 2 figure 3 2 idem but now with the functions sin n 2 for n 1 2 this time we have 2 2 f sin n 2 d 0 if n 1 is odd because f is odd about 1 and sin n 2 is even about 1 for odd n is orthonormal in l 2 0 1 and the trigonometric functions exp 2 in n z are con tained in their linear span hence this system forms an orthonormal basis by theorem 3 21 interestingly from this we can deduce theorem 3 30 each one of the two systems 2 sin n n 1 2 3 13 and 1 2 cos n n 1 2 3 14 forms an orthonormal basis for l 2 0 1 104 hilbert spaces these bases arise naturally as the eigenvector bases of the dirichlet and neumann laplacians in l 2 0 1 respectively see example 12 23 proof given a function f l 2 0 1 we extend it to an odd function in l 2 1 1 this function is extended to a function in l 2 2 2 whose restriction to 0 2 is odd about the point 1 and whose restriction to 2 0 is odd about the point 1 if we expand the resulting function against the orthonormal basis for l 2 2 2 obtained by scaling the system 3 12 that is 1 2 1 1 2 sin n 2 1 2 cos n 2 n 1 2 then due to the symmetries introduced by the odd reflections only the coefficients corresponding to the system 3 13 with even indices can contribute but not the ones with odd indices nor do those of 3 14 contribute see figures 3 1 and 3 2 if we do the same with even extensions only the coefficients corresponding to the system 3 14 with even indices can contribute restricting the resulting expansions in l 2 2 2 to l 2 0 1 the desired expansions of f l 2 0 1 in terms of the systems 3 13 and 3 14 are obtained 3 5 b the hermite polynomials in this section we prove that the hermite polynomials form an orthonormal basis for l 2 r where is the standard gaussian measure on r this is the borel probability measure on r which is given for borel sets b r by b 1 2 b exp 1 2 x 2 dx the hermite polynomials will resurface in chapters 9 13 and 15 in connection with the spectral theorem the ornstein uhlenbeck semigroup and second quantisation re spectively definition 3 31 for n n the hermite polynomials hn r r are defined by the identity h t x exp tx 1 2 t 2 n 0 tn n hn x t x r 3 15 the first five hermite polynomials are given by h 0 x 1 h 1 x x h 2 x x 2 1 h 3 x x 3 3 x 3 5 examples 105 h 4 x x 4 6 x 2 3 by induction one shows that hn x bn 2 c k 0 1 k 2 k n k n 2 k xn 2 k n n proposition 3 32 the hermite polynomials have the following properties i hn x 1 nhn x ii hn 2 x xhn 1 x n 1 hn x iii h n 1 x n 1 hn x iv hn is a monic polynomial of order n proof property i follows from the identity h t x h t x ii from the identity h t t x x t h t x and iii from h x t x th t x assertion iv follows from ii and the fact that h 0 x 1 theorem 3 33 the sequence 1 n hn n n forms an orthonormal basis for l 2 r proof for all s t r we have h s x h t x d x 1 2 exp 1 2 s 2 t 2 s t x 1 2 x 2 dx 1 2 exp st exp 1 2 s t x 2 dx 1 2 exp st exp 1 2 y 2 dy exp st 3 16 taking derivatives m n sm tn at s t 0 on both sides of the identity in 3 16 gives hm x hn x d x m mn since m mn m n mn this shows that the sequence 1 n hn n n is orthonormal in l 2 r it remains to show that the span of the hermite functions is dense in l 2 r a quick proof is obtained by making use of the injectivity of the fourier transform which is an immediate consequence of theorem 5 21 if f l 2 r is orthogonal to every hermite polynomial then it is orthogonal to every polynomial from this it follows that for all z c f z f x ezx 1 2 x 2 dx k 0 m 0 zk k 1 m 2 mm f x xkx 2 m dx 0 in particular we have f it 0 from this we infer that the fourier transform of x 7 106 hilbert spaces f x e 1 2 x 2 vanishes identically by the injectivity of the fourier transform this implies that f x e 1 2 x 2 0 for almost all x r and therefore f x 0 for almost all x r the identity hn 2 x xhn 1 x n 1 hn x of proposition 3 32 is an example of a so called three point recurrence relation as we will see in section 9 6 orthogonal polynomials in l 2 r with a finite measure on r always satisfy a three point recurrence relation and conversely if a sequence of polynomials on r satisfies such a relation then under a mild additional assumption these polynomials are orthogonal on l 2 r for a suitable finite borel measure on r theorem 3 33 admits an extension to higher dimensions see section 15 6 3 5 c tensor bases let j be a finite borel measure on a compact metric space k j for each j 1 k and let k k 1 kk and 1 k be their products if f j n n 1 is an orthonormal basis for l 2 k j k for each j 1 k then the functions fn x f 1 n 1 x 1 f k nk xk n 1 2 k form an orthonormal basis for l 2 k orthonormality being clear in view of the orem 3 21 it remains to check that the span of the functions fn is dense this follows from the fact that c k is dense in l 2 k by the observation in remark 2 31 and the fact that functions of the form g x g 1 x 1 g k xk with g j c k j for all j 1 k are dense in c k by example 2 10 since each of the functions g j can be approximated in l 2 k j j by linear combinations of the functions f j n g can be approximated in l 2 k by linear combinations of the functions fn this is a special case of a more general construction involving tensor products of hilbert spaces see chapters 14 and 15 in particular 14 3 if h j n n 1 is an orthonor mal basis for the hilbert space h j j 1 k then the vectors hn x h 1 n 1 h k nk n 1 2 k form an orthonormal basis for the hilbert space tensor product h h 1 hk problems 3 1 show that equality x y x y for the cauchy schwarz inequality holds if and only if x and y are collinear that is both belong to some one dimensional subspace 3 2 let xn n 1 be a sequence in a hilbert space h suppose that there exists x h such that problems 107 i xn y x y for all y h ii xn x show that xn x in h 3 3 provide the missing details in the proof of proposition 3 9 3 4 a banach space x is called strictly convex if for all norm one vectors x 0 x 1 x with x 0 6 x 1 and 0 1 we have 1 x y 1 prove that every hilbert space is strictly convex 3 5 give an example of a nonempty compact convex set c in a two dimensional ba nach space x along with a vector x x such that the set c c x c min y c x y consists of more than one element 3 6 let c f c 0 1 f is real valued f 0 0 1 0 f t dt 0 a check that c is a closed and convex subset of c 0 1 let g c 0 1 be the function defined by g t t b show that for any f c we have f g 12 c show that inf f c f g 12 this shows that c contains no point minimising the distance d g c 3 7 in this problem we determine some orthogonal complements a let y f l 2 0 1 f t 0 for almost all t 0 12 show that y is a closed subspace of l 2 0 1 and find y b let y f l 2 0 1 1 0 f t dt 0 show that y is a closed subspace of l 2 0 1 and find y 3 8 let hn n 1 be a finite or infinite orthonormal sequence in a hilbert space h prove that for all x h we have bessel s inequality n 1 x hn 2 6 x 2 3 9 let e j j 1 be the sequence of standard unit vectors in 2 and let f span e 2 n 1 n 1 and let g span e 2 n 1 1 n e 2 n n 1 a give explicit expressions for the orthogonal projections pf and pg 108 hilbert spaces b show that f g 0 c show that f g is dense but not closed in 2 3 10 prove the identity 3 8 3 11 use the stone weierstrass theorem to prove that the trigonometric polynomials are dense in l 2 t 3 12 prove the following binomial identity for the hermite polynomials for all n n and x y r hn x y n k 0 n k xn khk y 3 13 prove the following formula for the hermite polynomials for all n n and x r hn x 1 2 x iy n exp 1 2 y 2 dy 3 14 define the polynomials ln n n by the generating function expansion exp tx 1 t 1 t n n tn n ln x these are the laguerre polynomials normalised so as to become monic a compute the polynomials ln for n 0 1 2 3 b show that the polynomials ln are monic have degree n and satisfy the recur rence relation ln 2 x x 2 n 3 ln 1 x n 1 2 ln x n n c prove that the sequence 1 n ln n 0 is an orthonormal basis for l 2 r e x dx 3 15 the hardy space h 2 d is the vector space of all holomorphic functions on d of the form n n cnz n with n n cn 2 a prove that h 2 d is a hilbert space with respect to the norm f h 2 d n n cn 2 1 2 let the functions en l 2 t be defined by en exp in n n b show that for all f n n cnz n h 2 d the sum f t n n cnen converges in l 2 t and that the mapping f 7 f t sets up an isometric isomorphism from h 2 d onto the closed subspace of l 2 t of all functions whose negative fourier coefficients vanish problems 109 c for holomorphic functions f d c with power series expansion f z n n cnz n and 0 r 1 define fr n n cnr nen show that for f h 2 d and 0 r 1 we have fr l 2 t and fr l 2 t 6 f t l 2 t and show that lim r 1 fr f t in l 2 t d show that a holomorphic function f d c belongs to h 2 d if and only if sup 0 r 1 fr l 2 t and that in this case we have f h 2 d f t l 2 t sup 0 r 1 fr l 2 t e show that all f h 2 d 0 r 1 and we have f r exp i 1 2 f t pr d where the poisson kernel is given by pr 1 r 2 1 2 r cos r 2 hint begin by showing that pr n z r n exp in 3 16 we continue our study of the space h 2 d a show that for all z 0 d the function kz 0 z 1 1 zz 0 belongs to h 2 d and kz 0 h 2 d 1 1 z 0 2 1 2 b show that for all f h 2 d and z 0 d we have f z 0 f kz 0 c use parts a and b to show that if fn f in h 2 d then fn f uniformly on every compact subset of d 110 hilbert spaces 3 17 the disc algebra a d is the closed subspace of the banach space c d consisting of those functions that are holomorphic on d see problem 2 38 a show that a d is dense in h 2 d see problem 3 15 for its definition b show that if f c d then we have f d h 2 d if and only if f a d c show that the restriction mapping a d c t given by f 7 f t extends to an isometry from h 2 d onto l 2 t how does it relate to prob lem 3 15 3 18 let a 2 d denote the subspace of l 2 d consisting of all square integrable holo morphic functions on d the goal of this problem is to show that a 2 d is a hilbert space with orthonormal basis en n n given by en z n 1 1 2 zn z d n n a show that en n n is an orthonormal system in l 2 d hint perform a computation in polar coordinates b show that the closed linear span y of en n n in l 2 d is contained in a 2 d hint on the one hand every f y can be written as a convergent sum f n n cnen with convergence in l 2 d explain why on the other hand for each z d the sum g z n n cn n 1 1 2 zn converges absolutely now use the fact that l 2 convergence implies pointwise almost everywhere con vergence of a subsequence to show that f z g z for almost all z d c show that if a holomorphic function f l 2 d satisfies f en 0 for all n n then f 0 hint consider the taylor expansion of f around 0 d combine the above to conclude that a 2 d is a hilbert space with orthonor mal basis en n n e how are the spaces a 2 d and h 2 d related 3 19 on c we consider the measure d c z 1 e z 2 dz where dz is the lebesgue measure on c a show that c is a probability measure satisfying c z 2 d c z 1 let a 2 c denote the complex vector space of all entire functions f c c that are square integrable with respect to c c f z 2 d c z problems 111 b show that a 2 c is a hilbert space with respect to the inner product f g c f z g z d c z c show that the functions en z zn n n n form an orthonormal basis for a 2 c 3 20 in this problem we continue our study of the hilbert space a 2 c a using the mean value theorem show that for all w c the mapping f 7 f w is continuous from a 2 c to c deduce that for all w c there exists a unique function kw a 2 c such that f w c kw z f z d c z f a 2 c w c b show that this function is given by kw z exp zw w z c c show that the orthogonal projection p in l 2 c c onto a 2 c is given by p f w c kw z f z d c z f l 2 c c w c 3 21 this problem discusses the construction and elementary properties of conditional expectations let f be a probability space and let g be a sub algebra of f let 16 p 6 and denote by lp g the subspace of lp consisting of all f lp having a g measurable pointwise defined representative a show that lp g is a closed subspace of lp b let pg denote the orthogonal projection in l 2 onto l 2 g and fix a function f l 2 prove that pg f is the unique element of l 2 g such that the following identity holds for all f l 2 and g g g f d g pg f d hint f pg f 1 g in l 2 c prove that if f l 2 satisfies f 0 almost everywhere then pg f 0 almost everywhere d prove that if f l 2 satisfies 0 6 f 6 1 almost everywhere then 0 6 pg f 6 1 almost everywhere e prove that pg f 6 pg f almost everywhere 112 hilbert spaces f prove that pg restricts to a contractive projection in l onto l g and extends to a contractive projection in l 1 onto l 1 g and that the properties described in parts b e extend to functions in these spaces here a projection is understood to be a bounded operator p satisfying p 2 p g discuss the relation of this problem with problem 2 17 h give an explicit expression for pg in each of the following two cases i 0 1 f the borel algebra the lebesgue measure and g ii 12 1 2 f the borel algebra the lebesgue measure and g b f b b i use the radon nikody m theorem theorem 2 46 to give an alternative proof of the existence of the projection pg in l 1 of part f 3 22 in this problem we outline alternative proof of the existence part of the radon nikody m theorem theorem 2 46 based on hilbert space methods let f be a finite measure space and let the k valued measure on f be abso lutely continuous with respect to we first assume that is a finite nonnegative measure a show that there exists a measurable function w l 1 such that w 0 for almost all b show that the mapping f 7 f d is bounded on l 2 where is the finite measure on f given by f f f wd conclude that there exists a unique h l 2 such that f d f hd f l 2 c show that 06 h 6 1 for almost all hint apply the identity in part b to f 1 f with f f d show that b 0 where b h 1 hint apply the identity in part b to f 1 b e show that there exists a nonnegative function g l 1 such that f f gd f f hint apply the identity in part b to the function f 1 h hn and use parts c d and the monotone convergence theorem to show that the limit g limn 1 h hn hw exists almost everywhere and belongs to l 1 this proves the radon nikody m theorem for finite nonnegative measures f deduce from this the general case problems 113 3 23 using zorn s lemma we will construct two nonequivalent hilbertian norms on 2 an indexed set vi i i where i is some index set of a vector space v is called an algebraic basis if every v v admits a unique up to permutation of the terms expansion of the form v ni 1 civki with n 1 an integer and c 1 cn scalars in k thus every v is expressed as a finite linear combination of the vi the unique ness assumption implies that the vi are linearly independent by a straightforward application of zorn s lemma partially order the set of all linearly independent subsets of v by set inclusion every vector space has an algebraic basis select an algebraic basis hi i i in 2 which contains the standard unit vectors now remove one of the vectors that have been added to the standard unit basis vectors say hi 0 and denote the resulting codimension one subspace by x a prove that x is dense in 2 define a linear mapping 2 k by 0 on x and hi 0 1 b prove that is not continuous on x we define a new norm as follows let b i i 0 i be a bijection which exists since both sets are infinite prove this for j 1 jn i i 0 and scalars c 1 cn k define n k 1 ckh jk n k 1 ckhb jk this sets up an isometry b x 2 we extend this norm to 2 by defining h chi 0 2 h 2 c 2 h x c k this defines a norm on 2 c show that 2 is a hilbert space with respect to the norm and that x is a closed subspace d prove that x is not closed in 2 with respect to the norm thus there is no analogue of corollary 1 36 for subspaces of finite codimension deduce that and are not equivalent e does this result contradict the fact that 2 and 2 are isometri cally isomorphic both being separable hilbert spaces 3 24 this problem provides an example of a linear operator on 2 which fails to be bounded we return to problem 3 23 and use the notation introduced there define the mapping 2 2 i f cixi 7 i f i 0 cixi for finite sets f i a prove that is linear satisfies 2 and has range x 114 hilbert spaces b prove that fails to be bounded 3 25 this problem assumes familiarity with the language of probability theory let bt t 0 1 be a standard brownian motion on a probability space f p for each t 0 1 let ft denote the algebra generated by the family bs s 0 t a show that if 06 s t 6 1 the increment bt bs is independent of fs let h 20 0 1 denote the subspace of l 2 0 1 consisting of all stochas tic processes t t 0 1 of the form t n 1 n 0 an 1 tn tn 1 t t 0 1 3 17 where 0 t 0 t 1 tn 1 and each an l 2 is ftn measurable for such processes we define 1 0 t dbt n 1 n 0 an btn 1 btn b show that for all h 20 0 1 we have 1 0 t dbt l 2 and 1 0 t dbt 2 l 2 2 l 2 0 1 let h 2 0 1 denote the closure of h 20 0 1 in l 2 0 1 c deduce that the mapping 7 1 0 t dbt admits a unique extension to an isom etry from h 2 0 1 into l 2 the so called ito isometry the random variable 1 0 t dbt is called the ito stochastic integral of with respect to the brownian motion bt t 0 1 4 duality the present chapter is devoted to the study of duality of banach spaces we begin by characterising the duals of various classical banach spaces and then proceed to proving the hahn banach theorems these theorems provide the existence of functionals with certain desirable properties the remainder of the chapter is concerned with application of these theorems 4 1 duals of the classical banach spaces recall that the dual of a banach space x is the banach space x l x k for x x and x x the scalar x x k is denoted by x x that is we write x x x x the hahn banach theorems guarantee an abundance of nontrivial functionals in the dual of any banach space in many concrete situations however it is possible to com pletely describe the dual space it will be our first task to do this for some classical banach spaces discussed in chapter 2 4 1 a finite dimensional spaces it is instructive to start with duality of finite dimensional spaces as we have seen every finite dimensional banach space is isomorphic to kd for some integer d 1 the dual of kd is determined as follows this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 115 116 duality every kd determines an element kd by the prescription x x d n 1 xn n x kd indeed the cauchy schwarz inequality implies x 6 x from which it fol lows that is bounded and 6 conversely every kd is of this form to see this let e 1 ed be the standard unit vectors of kd and set n en then 1 d kd and for all x x 1 xd dn 1 xnen x d n 1 xnen d n 1 xn en d n 1 xn n x x it follows that moreover 2 6 together with the inequal ity 6 it follows that in summary the correspondence establishes an isometric isomorphism kd kd 4 1 b sequence spaces the above proof scheme can easily be extended to identify the duals of the infinite dimensional sequence spaces c 0 and p we begin by proving that the dual of c 0 can be identified with 1 every 1 determines an element c 0 by the prescription x n 1 xn n x c 0 indeed x 6 sup n 1 xn n 1 n x 1 so is bounded and 6 1 conversely every c 0 is of this form to see this let en n 1 be the sequence of standard unit vectors of c 0 and set n en we claim that n 1 n to see this choose scalars cn k of modulus one such that cn n n the sequence c 1 cn 0 0 belongs to c 0 and has norm one and n n 1 n n n 1 cn n n n 1 cnen 6 since n 1 was arbitrary this establishes the claim with bound 1 6 it follows that 1 2 belongs to 1 and for all x c 0 we have x n 1 xnen n 1 xn en n 1 xn n x 4 1 duals of the classical banach spaces 117 it follows that and the preceding bounds combine to the norm equality 1 in summary the correspondence establishes an isometric isomorphism c 0 1 in much the same way one proves that the dual of p 16 p can be represented as q where 1 p 1 q 1 more precisely every element of q defines a bounded functional p of norm 6 p by the same formula as before this time using ho lder s inequality x n 1 xn n 6 x p q conversely every bounded functional is of this form to see this let en n 1 be the sequence of standard unit vectors of p and set n en we claim that n n 1 belongs to q the case p 1 and q is trivial for n 6 en n 1 so 6 therefore we only consider the case 1 p in which case also 1 q to prove that n 1 n q it obviously suffices to show that n n 1 n q 6 q n 1 4 1 fix n 1 and put x n c 1 1 q p cn n q p 0 0 where the scalars cn k are chosen in such a way that cn n n this sequence belongs to p with norm x n pp n n 1 n q since 1 p 1 q 1 implies q p 1 q n n 1 n q n n 1 cn n q p n x n 6 x n p n n 1 n q 1 p and therefore nn 1 n q 1 q 6 using once more that 1 p 1 q 1 this proves 4 1 since n 1 was arbitrary it follows that 1 2 belongs to q with norm q 6 and for all x p we have x n 1 xnen n 1 xn en n 1 xn n x it follows that and the preceding bounds combine to the norm equality q in summary the correspondence establishes an isometric isomorphism p q 16 p 1 p 1 q 1 at the end of section 4 2 we show that this result does not extend to p 118 duality 4 1 c spaces of continuous functions definition 4 1 locally compact spaces a topological space x is called locally com pact if every point x x is contained in an open set with compact closure for example the spaces kd are locally compact when x is a locally compact topological space we let c 0 x denote the space of continuous functions f x k vanishing at infinity that is for every 0 there exists a compact set k x such that f x for all x k with respect to the supremum norm c 0 x is a banach space the proof is similar to that for c 0 the space m x of k valued borel measures on x has been introduced in section 2 4 where it is was shown there that it is a banach space with respect to the variation norm x every m x determines a bounded functional c 0 x given by f k f d by proposition 2 49 it satisfies f 6 k f d 6 f and therefore 6 in what follows we assume that x is a locally compact hausdorff space a borel measure m x is said to be radon if its variation is radon see definition e 20 that is if for every borel subset b of x and all 0 there is a compact set k x and an open set u x such that k b u and u k these properties are referred to as inner regularity with compact sets and outer regularity by mr x we denote the space of all radon measures on x it follows readily from the definitions that mr x is a closed subspace of m x so it is a banach space with respect to the variation norm the next theorem identifies this space as the dual of c 0 x theorem 4 2 riesz representation theorem let x be a locally compact hausdorff space for every c 0 x there exists a unique radon measure mr x such that that is f x f d f c 0 x this measure satisfies the correspondence establishes an isometric isomorphism c 0 x mr x the representing measure is nonnegative if and only if is positivity preserving 4 1 duals of the classical banach spaces 119 in the special case of a locally compact metric space we have mr x m x by proposition e 21 and we obtain an isometric isomorphism c 0 x m x for the proof of theorem 4 2 we need the following version of urysohn s lemma proposition 4 3 let x be a locally compact hausdorff space if k u x with k compact and u open then there exists a function f cc x with support contained in u such that 06 g 6 1 pointwise on x and g 1 on k proof cover k with finitely many open sets u 1 uk each of which has compact closure then x is contained in the open set u 1 uk u and this set has compact closure using this set instead of u we may now appeal to urysohn s lemma proposi tion c 10 proof of theorem 4 2 uniqueness is immediate from the norm identity which will be proved in step 4 of the proof step 1 we begin with the case of positivity preserving functionals in this step we prove the existence of a nonnegative representing measure m x for such function als the radon property of is shown in step 2 let u denote the collection of open subsets of x for u u and f cc x we write f u if 06 f 6 1 and the support of f is a compact set contained in u define u sup f f cc x f u with the convention that 0 note that 06 u 6 x 6 let us show that is countably subadditive on u to this end suppose that f j 1 u j with u j u for all j 1 since the support of f is compact it is contained in some finite union n j 1 u j choose functions g 1 gn cc x such that g j u j for j 1 n and nj 1 g j 1 on supp f to see that such functions exist we argue as follows for every x in the compact support of f we use corollary c 9 to choose an open set ux with closure contained in j 1 u j intersecting this set with an open set containing x and with compact closure we may assume that ux has compact closure by compactness the support of f is contained in a finite union n j 1 ux j any partition of unity g j n j 1 relative to these sets see theorem c 11 has the desired properties using that f g j u j f f n j 1 g j n j 1 f g j 6 n j 1 u j 6 j 1 u j 120 duality this being true for all 06 f cc x satisfying f j 1 u j it follows that j 1 u j 6 j 1 u j as claimed in what follows we freely use the notation and terminology introduced in appendix e let 2 x 0 be the outer measure associated with through e 1 that is a inf j 1 u j a j 1 u j where u j u for all j 1 for a 2 x see lemma e 6 by the definition of an outer measure and the countable subadditivity of we have for any set a 2 x a inf u a u where u u 4 2 clearly a 0 we also note that u u for all u u that is extends this fact is used repeatedly below we claim that u is contained in the set m a 2 x q q a q a q 2 x to prove this let u u that is let u be an open subset of x by the subadditivity of outer measures we have q 6 q u q u the reverse inequality trivially holds if q so it suffices to check the inequality for q 2 x satisfying q fix an arbitrary 0 choose an open set v such that q v and v q this is possible by 4 2 let f g cc x satisfy f u v u v f respectively g v supp f v supp f g such functions f and g exist by the definition of then using the linearity of along with the facts that f g v as f and g have disjoint supports both contained in v and q u v supp f which follows from q v and supp f u q u q u 6 u v v supp f u v v supp f 6 f g 2 f g 2 6 v 2 6 q 3 4 1 duals of the classical banach spaces 121 since 0 was arbitrary this gives the desired result by theorem e 7 m is a algebra and restricts to a measure on m since u is contained in m so is u b x the borel algebra of x thus we find that the restriction of to b x is a measure since we have already seen that u u for all u u by slight abuse of notation we shall denote the measure on b x thus obtained by the bound x 6 shows that is a finite measure nonnegativity of follows from the nonnegativity of next we check that represents the functional to this end we first claim that if a b b x and g c 0 x satisfy 1 a 6 g 6 1 b then a 6 g 6 b 4 3 indeed since a is contained in the set g 1 and this set is contained in the open set g 1 we have for any 0 1 a 6 g 1 sup f f cc x f g 1 6 g 1 1 1 g using the positivity of and the fact that on the set g 1 we have f 6 1 6 g 1 pointwise since 0 1 was arbitrary it follows that a 6 g in the same way 1 b 6 1 g implies b 6 1 g x g and therefore g 6 b this proves 4 3 let 06 f c 0 x fix 0 and for 0 write f min f then f k 0 f k 1 fk there is no convergence issue here since functions in c 0 x are bounded so at most finitely many terms in this sum are nonzero from the inequalities 1 f k 1 6 f k 1 fk 6 1 f k on the one hand we obtain f k 1 6 x f k 1 fk d 6 f k while combining them with 4 3 gives f k 1 6 f k 1 fk 6 f k it follows that x f k 1 fk d f k 1 fk 6 k f 6 k 1 122 duality and consequently x f d f 6 k 0 k f 6 k 1 6 x since 0 was arbitrary this proves that x f d f as desired by the linearity of both sides this identity extends to arbitrary f c 0 x step 2 we prove next that is a radon measure outer regularity is clear from the constructions and inner regularity with compact sets will be proved in two steps i first we prove that if u is open in x then for every 0 there is a compact set k u such that u k ii we then use this to deduce the analogous result for general borel b sets in x i let u be open in x pick f cc x such that f u and x f d u and let k be its support then k u and we have k x f d u since 06 f 6 1 k but then u k ii suppose next that b is a borel set in x by outer regularity there is an open set v x such that b v and v b by what we just proved there is a compact set l x such that l v and v l using outer regularity once more choose an open set w such that v b w and w let k l w then k is compact contained in b and k l l w v w b 2 w b 3 it follows that b k 3 and the claim is proved this completes the proof of the theorem for positivity preserving functionals except for the norm identity which will be proved for general functionals in step 4 step 3 the real part of a functional c 0 x is defined for f u iv c 0 x with u v real valued by re f re u ire v it is clear that re is additive and in combination with the identities re a bi f re au bv i bu av re au bv ire bu av a bi re u ire v a bi re f we see that re is linear boundedness is clear and therefore re c 0 x the functional im c 0 x is defined similarly both re and im are real in the sense that they map real valued functions to real numbers and we have re i im 4 1 duals of the classical banach spaces 123 suppose now that c 0 x is real in analogy with the formulas for the positive and negative parts of a real measure we define for functions 06 f c 0 x f sup g g c 0 x 06 g 6 f 4 4 we claim that is the restriction of a real linear functional on c 0 x r of norm at most this will follow from theorem 4 5 this theorem implies that the dual of c 0 x is a banach lattice and gives a general formula for the positive part of func tionals in the dual of a banach lattice of which 4 4 is a special case for the reader s convenience however here we give a self contained proof of the claim it is clear that f 6 f and 06 0 6 f it is also clear that c f c f for scalars c 0 if 06 g 1 6 f 1 and 06 g 2 6 f 2 then 06 g 1 g 2 6 f 1 f 2 so f 1 f 2 g 1 g 2 g 1 g 2 taking the supremum over all admissible g 1 and g 2 gives the inequality f 1 f 2 f 1 f 2 to prove the converse inequality let 0 6 g 6 f 1 f 2 and set g 1 f 1 g and g 2 g g 1 then 06 g 1 6 f 1 and 06 g 2 6 f 2 so g g 1 g 2 6 f 1 f 2 and therefore f 1 f 2 6 f 1 f 2 this proves the additivity of on the cone of nonnegative functions in c 0 x for functions f c 0 x r we define f f f it is routine to check that is real linear on c 0 x r moreover f 6 max f f 6 max f f f this completes the proof of the claim the functional is real linear and bounded on c 0 x r and the definition of implies that is positive this gives the representation with bounded linear and positive since linear combinations of radon measures are radon these reductions make it possible to apply step 2 to obtain a radon measure mr x representing step 4 the only thing left to be shown is the norm equality this will be accomplished by invoking the radon nikody m theorem theorem 2 46 or rather the result of example 2 48 which follows from it it asserts that there exists a function h l 1 such that h 1 almost everywhere and b b hd for all borel sets b x by the usual arguments this implies x f d x f hd for all f cc x the space cc x is dense in c 0 x indeed for given f c 0 x and 0 let k be a 124 duality compact set such that f outside k and apply proposition 4 3 to obtain a function g cc x such that 0 6 g 6 1 pointwise on x and g 1 on k then f g cc x and f f g 6 as a variation on remark 2 31 the radon property of and proposition 4 3 imply that cc x is also dense in l 1 x combining these observations we obtain sup f 61 f cc x f sup f 61 f cc x x f d sup f 61 f cc x x f hd h l 1 x x and the proof is complete the duality between spaces of continuous functions and spaces of borel measures shows how elements of measure theory emerge naturally from considerations involving only linearity and topology namely from the problem of finding the continuous linear functionals of a space of continuous functions 4 1 d spaces of integrable functions let f be a measure space and let 1 6 p q 6 satisfy 1 p 1 q 1 by ho lder s inequality every function g lq defines a functional g lp by setting g f f gd f lp and we have g 6 g q if 1 6 p and the measure space is finite every func tional arises in this way theorem 4 4 dual of lp let f be a finite measure space and let 1 6 p and 1 p 1 q 1 for every l p there exists a unique g lq such that g that is f f gd f lp and it satisfies g q the correspondence g g establishes an isometric iso morphism lp lq 16 p 1 p 1 q 1 proof uniqueness is immediate from the norm identity g q the existence proof will be given in two steps 4 1 duals of the classical banach spaces 125 step 1 in this step we prove the theorem for the special case let lp be arbitrary and fixed then a 1 a a f defines a k valued measure indeed if the sets an f are disjoint then by dominated convergence limn n j 1 1 a j 1 j 1 a j in l p and therefore j 1 a j lim n n j 1 1 a j limn n j 1 a j by the boundedness of clearly is absolutely continuous with respect to by the radon nikody m theorem theorem 2 46 we have gd for some g l 1 by the definition of and linearity this means that f f gd for all simple functions f 4 5 we wish to prove that g lq with g q 6 and that the identity f f gd holds for all f lp for n 1 2 let gn g 1 n these functions are bounded and for all simple functions f we have by 4 5 f gn d f 1 ngd f 1 n 6 f 1 n p 6 f p since the simple functions are dense in lp proposition 2 26 implies that gn lq and gn q 6 this being true for all n 1 fatou s lemma implies that g lq and g q 6 now that we know this the density of the simple functions in lp and ho lder s inequality imply that 4 5 extends to arbitrary f lp this completes the proof of the theorem in the case step 2 the general finite case follows by an exhaustion argument as follows choose an increasing sequence 1 2 of sets of finite measure such that n 1 n by restriction to functions supported on n every lp restricts to a functional in lp n denoted by n of norm n 6 by the previous step n is represented by a unique function gn lq n of norm gn q 6 n 6 more over by uniqueness we see that if m 6 n then gn m gm since both represent m we can thus define a measurable function g k by setting g gn on n for n 1 this function satisfies g q supn 1 gn q 6 moreover if f l p then by the continuity of and the dominated convergence theorem f lim n 1 n f limn n f gn d lim n n f gd f gd for 1 p the finiteness assumption can be omitted see problem 4 3 126 duality 4 1 e hilbert spaces the riesz representation theorem theorem 3 15 states that every bounded functional on a hilbert space h is of the form h for some unique h h where h g g h g h moreover we have equality of norms h h the identification h h therefore provides a bijective and norm preserving correspondence h h it is important to observe that this correspondence is linear if k r but conjugate linear if k c this is a consequence of the conjugate linearity of inner products with respect to their second variable indeed from ch x x ch c x h c h x it fol lows that ch c h in contrast the correspondence x x in each of the sections 4 1 a 4 1 d is linear both when k r and k c 4 1 f banach lattices the objective of this section is to prove the following theorem theorem 4 5 with respect to the natural partial order given by x 6 y x x 6 x y for all 06 x x the dual x of a banach lattice x is a banach lattice moreover for all 0 6 x x we have x x y inf x y x y y 06 y 6 x x x y sup x y x y y 06 y 6 x a special case of the second formula has already been encountered in 4 4 for the proof of the theorem we need the following lemma if v is a vector lattice then for 06 v v we write 0 v u v 06 u 6 v lemma 4 6 decomposition property if v is a vector lattice then for all 06 v v v we have 0 v 0 v 0 v v proof let w 0 v v we must show that there exist u 0 v and u 0 v such 4 1 duals of the classical banach spaces 127 that u u w we claim that u v w and u w u have the required properties it is clear that u 0 v u 0 and u u w and by proposition 2 52 2 we have v u v w u v w v w v w v v w w v v w v 0 this proves that u 0 v proof of theorem 4 5 first note that if 06 y 6 x then also 06 x y 6 x and therefore y 6 x and x y 6 x it follows that x y x y y 6 x x y showing that the infima and suprema on the right hand sides of the formulas in the statement of the theorem are finite lemma 4 6 implies that the right hand sides are additive on the positive cone x of x to see this let x x x then inf x x y x y y y 0 x x inf x u x x u x u y u y u 0 x u 0 x inf x u x u y u 0 x inf x u x u y u 0 x the corresponding identity for the suprema is proved in the same way since the right hand sides are also homogeneous with respect to scalar multiplication by nonnegative scalars they uniquely extend to linear mappings from x to r and therefore define ele ments of x thus we may define functionals x y and x y in x by the right hand sides of the formulas in the statement of the theorem we begin by showing that the functionals x y and x y thus defined are the greatest lower bound and the least upper bound for the pair x y respectively we will present the argument for x y the proof for x y is entirely similar it is clear that for all x 0 we have x x y 6 x x this means that x y 6 x and in the same way we see that x y 6 y this shows that x y is a lower bound for the pair x y to prove that it is the greatest lower bound we must show that if z 6 x and z 6 y then z 6 x y but this is easy if 06 y 6 x then x z x y z y z 6 x y x y y and therefore for all x 0 we obtain x z 6 inf x y x y y 06 y 6 x x x y that is z 6 x y this proves that the pair x 6 is a lattice it is clear from the definition of the partial order 6 on x that if x y x satisfy x 6 y then cx 6 cy for all 0 6 c r and x z 6 y z it follows that x 6 is a vector lattice and that the identities in the statement of the theorem are satisfied 128 duality since x is complete all that remains to be shown is that x 6 y implies x 6 y the assumption is equivalent to the statement that for all x 0 we have sup x y x y x 06 y 6 x 6 sup x y y y y 06 y 6 x that is sup z x x 6 z 6 x 6 sup z y x 6 z 6 x this combined with the identity z sup x 61 x z sup x 61 sup z z x 6 z 6 x which follows from the fact that x 6 z 6 x implies z 6 x gives x 6 y as desired 4 2 the hahn banach extension theorem we now turn to one of the main pillars of functional analysis the hahn banach theo rem this is a collective name for a number of closely related results all of which assert the existence of certain nontrivial functionals with desirable properties these results come in two flavours as extension theorems asserting the extendability of functionals that are given a priori on a subspace and as separation theorems asserting that certain disjoint subsets can be separated by means of functionals the present section is concerned with hahn banach extension theorems we begin with a version for real vector spaces whose proof exploits the order structure of the real line theorem 4 7 hahn banach extension theorem for real vector spaces let v be a real vector space and let p v r be sublinear that is for all v v v and t 0 we have p v v 6 p v p v p tv t p v if w v is a subspace and w r is a linear mapping satisfying w 6 p w w w then there exists a linear mapping v r that extends and satisfies v 6 p v v v proof we may assume that w is a proper subspace of v fix w w w and v v w from w w w w 6 p w w and p w w 6 p w v p v w we 4 2 the hahn banach extension theorem 129 obtain w p w v 6 p w v w with supw w w p w v we therefore have w 6 p w v w 6 p w v w w w let w 1 denote the linear span of w and v then 1 w 1 r 1 w tv w t is linear extends and satisfies 1 w 1 6 p w 1 for all w 1 w 1 to see this note that for w w and t 0 1 w tv w t t t 1 w 6 t p t 1 w v p w tv and 1 w tv w t t t 1 w 6 t p t 1 w v p w tv while for t 0 we have 1 w w this proves that 1 w 1 6 p w 1 for all w 1 w 1 the proof can now be finished by an appeal to zorn s lemma lemma a 3 applied to all linear extensions of satisfying the inequality 6 p this result is used to give a second version of the theorem which is also valid over the complex scalars theorem 4 8 hahn banach extension theorem for vector spaces let v be a real or complex vector space and let p v 0 be a seminorm that is for all v v v and t k we have p v v 6 p v p v p tv t p v if w is a subspace of v and w k is a linear mapping satisfying w 6 p w w w then there exists a linear mapping v k that extends and satisfies v 6 p v v v proof first we consider the case k r the assumptions imply w 6 p w for all w w and therefore by theorem 4 7 the mapping w r admits a linear extension v r satisfying v 6 p v for all v v also v v 6 p v p v and therefore v 6 p v for all v v next we consider the case k c let us write re i im where re and im are the real and imaginary parts of these functions are real linear from x i ix i re ix i im ix im ix ire ix with im ix and re ix real we infer that im x re ix hence x re x ire ix 130 duality the real valued function re satisfies the assumptions of the previous theorem and thus extends to a real linear mapping v r satisfying 6 p we now define v v i iv then extends is real linear and since also iv iv i v iv i v i v i iv i v is actually complex linear finally for t c with t 1 such that t v v v t v tv tv 6 p tv t p v p v here follows from the definition of noting that tv v is nonnegative and therefore tv re tv while at the same time re tv tv by the definition of and the fact that is real valued in the setting of normed spaces from theorem 4 8 we infer the following result theorem 4 9 hahn banach extension theorem for banach spaces let x be a normed space and let y x be a subspace then every functional y y has an extension to a functional x x that satisfies x y here of course x is the norm of x as an element of x and y is the norm of y as an element of y such obvious conventions will be in place throughout the text proof given a functional y y we apply theorem 4 8 to v x w y y y y for y y and p x x y for x x remark 4 10 the proof of theorem 4 7 depends on the axiom of choice through the use of zorn s lemma if x is separable and a countable dense sequence xn n 1 is given theorem 4 9 can be proved without invoking zorn s lemma as follows revisiting the proof of theorem 4 7 starting from a functional y y one defines yn to be the span of y and x 1 xn and inductively extends y to y 1 then to y 2 and so forth on the span of the spaces yn n 1 we thus obtain a well defined functional of norm at most y since this subspace is dense by proposition 1 18 this functional uniquely extends to a functional with the same norm on all of x recall the identity x sup x 61 x x which is nothing but the definition of the operator norm of x as an element of l x k as a consequence of the hahn banach theorem we obtain the following dual expression for the norm of elements x x 4 2 the hahn banach extension theorem 131 corollary 4 11 for all x x we have x sup x 61 x x in particular if x x 0 for all x x then x 0 proof fix an arbitrary x x if x 0 the asserted identity trivially holds so we may assume that x 6 0 let y be the one dimensional subspace of x spanned by x and define y 0 y by tx y 0 t x then y 0 1 let x 0 x be a hahn banach extension provided by theorem 4 9 that is x 0 y y 0 and x 0 y 0 1 then x x y 0 x x 0 6 sup x 61 x x while trivially sup x 61 x x 6 sup x 61 x x x the next application of theorem 4 9 provides a condition for recognising proper closed subspaces corollary 4 12 if y is a proper closed subspace of a banach space x then for every x 0 x y there exists an x x such that x 0 x 6 0 and y x 0 for all y y proof fix an element x 0 x y without loss of generality we may assume that x 0 1 let x 0 denote the span of y and x 0 on x 0 we can uniquely define a lin ear scalar valued mapping by declaring y 0 for all y y and x 0 1 the idea is to prove that x 0 k is bounded once this has been shown the result follows from the hahn banach extension theorem we claim that there is a constant c 0 such that x 0 y c x 0 y y if such a constant does not exist for every n 1 one can find a yn y so that x 0 yn 1 n x 0 n 1 2 then limn x 0 yn 0 and therefore x 0 y y this contradiction proves the claim by the claim for any scalar a k and y y ax 0 y a x 0 a 1 y c a x 0 c ax 0 132 duality hence ax 0 y a a x 0 ax 0 6 1 c ax 0 y this proves that is bounded on x 0 and x 0 6 1 c definition 4 13 complemented subspaces a closed linear subspace x 0 of a normed space x is said to be complemented if there exists a closed linear subspace x 1 of x such that x 0 x 1 x x 0 x 1 0 here x 0 x 1 x 0 x 1 x 0 x 0 x 1 x 1 in this situation we have x x 0 x 1 as a direct sum in the sense discussed in section 1 1 b definition 4 14 projections a projection is an operator p l x satisfying p 2 p notice that boundedness of p is taken to be part of the definition if p is a projection then so is i p and the range r p of p equals the null space n i p this implies that r p is closed and we have a direct sum decomposition x n p r p thus we have shown the following simple result proposition 4 15 if a closed subspace x 0 of a normed space x is the range of a pro jection in x then x 0 is complemented conversely if x x 0 x 1 is a direct sum decomposition of a banach space then the natural projections associated with it are bounded this will be proved in the next chapter see proposition 5 12 we have seen in corollary 1 36 that finite dimensional subspaces are always closed as an application of the hahn banach theorem we prove next the stronger assertion that they are always complemented for later use we also include an analogue for subspaces of finite codimension which does not require the use of the hahn banach theorem a subspace x 0 of a banach space x is said to have finite codimension if there exists a finite dimensional subspace y of x such that x 0 y 0 and x 0 y x in this situation we define the codimension of x 0 to be the dimension of y and denote this number by codimx 0 the following argument shows that this number is well defined if y 0 and y 1 are subspaces with the said properties then for every y 0 y 0 there are unique x 0 x and y 1 y 1 such that y 0 x 0 y 1 the mapping y 0 7 y 1 from y 0 to y 1 is easily seen to be linear by the same procedure we obtain a well defined mapping from y 1 to y 0 and it 4 2 the hahn banach extension theorem 133 is clear that these mappings are each other s inverses hence they are isomorphisms of finite dimensional vector spaces and therefore dimy 0 dimy 1 subspaces of finite dimension are closed but subspaces of finite codimension need not be closed in problem 3 23 a dense subspace of 2 with codimension one is con structed and such subspaces cannot be closed if x 0 is a closed subspace of finite co dimension then codimx 0 dimx x 0 proposition 4 16 let y be a subspace y of a normed space x then the following assertions hold 1 if dim y then y is closed and complemented 2 if codim y and y is closed then y is complemented proof 1 let y be a finite dimensional subspace of x by corollary 1 36 y is closed to prove that y is complemented we show that y is the range of a projection in x let yn nn 1 be a basis for y then every y y admits a unique representation y n n 1 cn y yn with coefficients cn y k the mappings cn y 7 cn y are linear and since linear mappings on finite dimensional normed spaces are bounded we have cn y by the hahn banach theorem we may extend each cn to a functional x n x consider the bounded linear operator p on x defined by px n n 1 x x n yn it is clear that p maps x into y and from ym x n mn we see that pym n n 1 ym x n yn ym this shows that p maps x onto y the preceding identity applied to the element px y also shows that p 2 x p px px so p is a projection 2 let y be a closed subspace of x of finite codimension d dimx y and let 1 d be a basis for x y choose x 1 xd such that qxn n where q x x y is the quotient mapping these vectors are linearly independent so their linear span z in x has dimension d in particular z is a closed subspace of x since it is finite dimensional if x y z say x nn 1 cnxn then 0 qx n n 1 cn n and therefore cn 0 for all n 1 n by linear independence of the n so x 0 it follows that y z 0 fix an arbitrary x x and define the scalars cn k by requiring that qx nn 1 cn n and set z nn 1 cnxn and y x z then qy 0 and z z so y y and x y z y z it follows that x y z this proves that we have a direct sum decomposition x y z 134 duality we next identify the duals of closed subspaces and quotients for this purpose we need the first part of the following definition the second is included for reasons of symmetry of presentation and will be needed later definition 4 17 annihilators and pre annihilators let x be a banach space i the annihilator of a subset a x is the set a x x x x 0 x a ii the pre annihilator of a subset b x is the set b x x x x 0 x b proposition 4 18 let x be a banach space and let y be a closed subspace of x then y is a closed subspace of x and we have the following assertions 1 the mapping i x y y defined by i x y x y is well defined and induces an isometric isomorphism y x y 2 the mapping j y x y defined by jx x y x x is well defined and induces an isometric isomorphism x y y proof the easy proof that y is a closed subspace of x is left as an exercise 1 let y y be given and let x x be an extension with the same norm as provided by the hahn banach theorem if y then x and x both restrict to y this means that we obtain a well defined linear surjection from x y to y this mapping is also injective for if x y is mapped to the zero element of y then x y 0 and therefore x y so x y is the zero element of x y we must show that the resulting bijection is an isometry on the one hand x y x y inf y x 6 x y x y i x y on the other hand for all y we have i x y y sup y 61 y y sup y 61 y x 6 x and therefore taking the infimum over all y i x y 6 inf y x x y x y 2 it is clear that j is well defined fix an arbitrary x y given 0 choose 4 2 the hahn banach extension theorem 135 x 0 x such that x 0 y x y 1 and jx 6 x 0 y jx choose y 0 y such that x 0 y 0 6 1 then x 0 y jx x 0 x x 0 y 0 x 6 x 0 y 0 x 6 1 x it follows that jx x y 6 1 x since 0 was arbitrary we find that jx x y 6 x in the converse direction we have jx x y sup x y x y 61 x y jx sup x y x y 61 x x sup x 61 x x x where we used that x 6 1 implies x y x y 6 1 it follows that j is isometric to see that it is also surjective let x y be given the linear mapping x 7 x y is bounded noting that both x 7 x y and are bounded it thus defines an element x x and this functional annihilates y from x y jx x x x y it follows that jx the hahn banach theorem through corollary 4 11 offers a technique to reduce cer tain vector valued questions to their scalar valued counterparts by way of example we demonstrate this technique by reproving some calculus rules for the vector valued rie mann integral of proposition 1 45 a second example is given in problem 4 2 where the cauchy integral formula is extended to vector valued holomorphic functions second proof of proposition 1 45 parts 2 and 3 2 if f t 0 6 f t 1 for certain t 0 6 t 1 in i corollary 4 11 provides us with a functional x x such that f t 0 x 6 f t 1 x consider the scalar valued function f x t f t x obtained by ap plying x pointwise this function is continuous on 0 1 and continuously differen tiable on 0 1 with f x f x 0 therefore f x is constant by the scalar valued version of the proposition this contradicts the choice of x 3 by the scalar valued version of the proposition f 1 f 0 1 0 f t dt x f 1 x f 0 x 1 0 f t x dt 0 for all x x corollary 4 11 implies that f 1 f 0 1 0 f t dt 0 using duality we can give the following version of the pettis measurability theorem theorem 1 47 theorem 4 19 pettis measurability theorem second version a function f x is strongly measurable if and only if f takes its values in a separable closed subspace of x and is weakly measurable that is f x k is measurable for all x x 136 duality proof the only if part follows from the first version of the pettis measurability the orem and the trivial fact that strong measurability implies weak measurability for the if part choose a dense sequence xk k 1 in a closed separable subspace x 0 of x where f takes its values by the hahn banach theorem for every k 1 there is a unit vector x k x such that xk x k xk then for all k 1 we have supn 1 xk x n xk and by a simple approximation argument this implies that supn 1 x x n x for all x x 0 then for all x 0 x 0 7 f x 0 sup n 1 f x 0 x n is a measurable function now the result follows from theorem 1 47 theorem 4 19 is accompanied by the following uniqueness result proposition 4 20 let f be a measure space if f x is a strongly measur able function and for all x x we have f x 0 almost everywhere then f 0 almost everywhere in the same way one proves that if f x 0 pointwise for all x x then f 0 pointwise proof let x n n 1 be a sequence in x separating the points of a closed subspace x 0 in which f takes its values such a sequence exists by the argument in the proof of theorem 4 19 since f x n 0 outside a null set nn we conclude that f 0 on the complement of the null set n 1 nn corollary 4 11 has the interesting consequence that every banach space can be iso metrically identified with a closed subspace of the bi dual x x in a natural way more specifically given an element x x we define a mapping jx x k by jx x x x it is clear that this mapping is bounded and therefore it defines an element of the bi dual x by the corollary its norm is given by jx sup x 61 x jx sup x 61 x x x and therefore the mapping j x 7 jx is isometric it is also linear and therefore we have proved proposition 4 21 isometric embedding into the bi dual the operator j is an isometric embedding of x into x the image of x under j is closed in x this is immediate from the fact that j is 4 3 adjoint operators 137 isometric it may happen that j x is a proper subspace of x for instance the bi dual of c 0 is examples of banach spaces for which we have j x x include all hilbert spaces and the spaces p and lp for 1 p spaces with this property are called reflexive and enjoy some pleasant properties some of which will be discussed in section 4 7 b we conclude this section by filling in a detail that was left open in our treatment of the duality of p namely that the duality p h q with 1 p 1 q 1 which has been shown to hold for 16 p in section 4 1 b does not hold for p consider the closed subspace y of consisting of all convergent sequences and define y y as y y lim n yn for y yn n 1 y let x be any hahn banach extension of y we claim that there exists no z 1 such that z x x x for all x indeed let z 1 be given given 0 1 we can choose n 1 so large that n n zn consider now the sequence xn 0 0 0 1 1 1 y with n zeroes at the beginning then xn x xn y lim n xnn 1 while on the other hand z xn n 1 znx n n n n zn 6 n n zn 1 this shows that z xn 6 xn x 4 3 adjoint operators the hahn banach theorem will now be used to show that when x and y are banach spaces and t l x y is a bounded operator there exists a unique bounded operator t l y x of norm t t such that t x y x t y for all x x and y y when x and y are hilbert spaces the riesz representation theorem will be used to prove the existence of a unique bounded operator t l y x of norm t t such that t x y x t y x y x 138 duality 4 3 a the banach space adjoint let x and y be banach spaces proposition 4 22 for every bounded operator t l x y there exists a unique bounded operator t l y x such that t x y x t y x x y y 4 6 furthermore t t proof the idea is to take the left hand side of 4 6 as a definition for the operator defined by the right hand side more precisely for any given y y we may define a linear mapping t y x k by t y x t x y this mapping is bounded of norm t y 6 t y since t y x 6 t x y 6 t x y accordingly t y defines an element of x the resulting mapping t y x which maps y y to the element t y x is linear by the above estimate t is bounded of norm t 6 t it is clear from the definitions that t x y x t y for all x x and y y turning to uniqueness if s y x is an operator satisfying t x y x sy for all x x and y y then x t y x sy for all x x and y y so t y sy for all y y and so t s finally t sup y 61 t y sup y 61 sup x 61 x t y sup x 61 sup y 61 t x y sup x 61 t x t using corollary 4 11 in the penultimate step it is clear that i x ix where ix and ix are the identity operators on x and x respectively for all t 1 t 2 l x y and c 1 c 2 k we have c 1 t 1 c 2 t 2 c 1 t 1 c 2 t 2 and for all t l x y and s l y z we have s t t s definition 4 23 adjoint operator the bounded operator t is called the adjoint of t 4 3 adjoint operators 139 example 4 24 let x kn y km and let a l kn km with respect to the stan dard unit bases we may represent a as an m n matrix with coefficients ai j k with respect to the same basis and using the identification of section 4 1 a its adjoint a may be represented as the n m matrix with coefficients a ji stated differently the matrix associated with a is the transpose of the matrix associated with a example 4 25 the adjoint of the kernel operator tk on l 2 0 1 given by tk f t 1 0 k t s f s ds where we assume that k l 2 0 1 0 1 see example 1 30 is the kernel operator tk on l 2 0 1 given by tk g t 1 0 k t s g s ds with k t s k s t example 4 26 let 16 p and 1 p 1 q 1 the adjoint of the left right shift on p is the right left shift on q the adjoint of the left right translation on lp r is the right left translation on lq r as a first application we prove that the duals of isometrically isomorphic banach spaces are isometrically isomorphic in a natural way proposition 4 27 if i x y is an isometric isomorphism of the banach spaces x and y then the adjoint operator i y x is an isometric isomorphism of their duals proof if i y 0 then ix y 0 for all x x so y y 0 for all y y since i is surjective and therefore y 0 it follows that i is injective from x i 1 i x i i 1 x we see that i is surjective as well it follows that i is a bounded bijection and its inverse i 1 i 1 is bounded so i is an isomorphism if i is isometric then from i y sup x 1 x i y sup ix 1 ix y sup y 1 y y y we see that i is isometric we conclude with a simple observation about the bi adjoint operator t t identifying x with a closed subspace of x by means of the natural isometric embed ding j x x see proposition 4 21 the restriction of t to x equals t indeed denoting by j x x the natural embedding the claim follows from y t jx t y jx x t y t x y y jt x so that t jx jt x as claimed 140 duality 4 3 b the hilbert space adjoint let h and k be hilbert spaces if t l h k is a bounded operator its adjoint t l k h is a bounded operator acting in the reverse direction between their duals by the riesz representation theorem the duals h and k can be canonically identified with h and k under these identifications the adjoint of an operator t l h k can be re interpreted as an operator acting from k to h although the identifications are conjugate linear as an operator from k to h the adjoint of t is nevertheless linear this is the content of the next proposition which incidentally admits a straightforward direct proof which does not call upon the hahn banach theorem proposition 4 28 for every bounded operator t l h k there exists a unique bounded operator t l k h such that t x y x t y x h y k furthermore t t t t 1 2 proof let y k be fixed and define a mapping y t h k by x t x y from x 6 t x y 6 t x y we see that is bounded with norm at most t y hence by the riesz representation theorem there is a unique element t y h with norm t y such that x x t y combining the two identities we obtain t x y x t y we must show that the mapping t y 7 t y is linear and bounded additivity is easy and homogeneity with respect to scalar multiplication follows from x t cy t x cy c t x y c x t y x ct y which implies t cy ct y next we show that t is bounded this follows from what we already know indeed we have t y 6 t y so t is bounded of norm t 6 t writing t t from t x y y t x t y x x t y t x y it follows that t x t x for all x h and therefore t t hence by what we just 4 3 adjoint operators 141 proved applied to t t t 6 t we conclude that equality holds t t next we prove the identity t t 1 2 t clearly t t 6 t t t 2 and in the converse direction we have t t sup x 61 t t x sup x 61 sup y 61 t t x y sup y 61 sup x 61 t t x y sup y 61 sup x 61 t x ty sup x 61 t x t x sup x 61 t x 2 t 2 finally we prove uniqueness if u l k h is bounded and x uy t x y for all x h and y k then uy t y for all y k so u t by definition we have t x y x t y for all x y h symmetrically we also have t x y x ty this can be seen by noting that t x y y t x ty x x ty it is clear that i i and for all t u l h and c k we have t u t u ct ct and as we have seen in the proof of proposition 4 28 t t definition 4 29 hilbert space adjoint the bounded operator t is called the hilbert space adjoint of t the relation between the hilbert space adjoint t which is a bounded operator on h and the adjoint operator t which is a bounded operator on the dual space h is given by t h t h as elements of h where h and t h are the functionals in h associated with h and t h respectively indeed this follows from x t h t x h t x h x t h x t h here the brackets denote the duality between h and its dual h 142 duality example 4 30 here are some examples of hilbert space adjoints they should be com pared with examples 4 24 4 25 and 4 26 respectively i as in example 4 24 let a l kn km be represented as an m n matrix with coefficients ai j k viewing kn and km as finite dimensional hilbert spaces its hilbert space adjoint a may be represented as the n m matrix with co efficients a ji stated differently the matrix associated with a is the hermitian transpose of the matrix associated with a ii the hilbert space adjoint of the kernel operator tk on l 2 0 1 of example 4 25 is the kernel operator tk on l 2 0 1 given by tk g t 1 0 k t s g s ds with k t s k s t iii the adjoint of the left right shift in 2 z is the right left shift similarly the adjoint of the left right translation in l 2 r is the right left translation for later reference we state a useful decomposition result versions for banach spaces are given in proposition 5 15 and theorem 5 16 proposition 4 31 if t l h k is a bounded operator then h and k admit orthog onal decompositions h n t r t k n t r t in particular 1 t is injective if and only if t has dense range 2 t has dense range if and only if t is injective proof if x r t then t x y x t y 0 for all y k and therefore t x 0 so x n t conversely if x n t then x t y t x y 0 for all y k implies that x r t and hence x r t this proves the orthogonal decomposition for h the decomposition for k follows from it applying it to t and using that t t 4 4 the hahn banach separation theorem in what follows x is a banach space corollary 4 12 can be interpreted as a separation theorem in that it guarantees the existence of a functional separating a closed subspace from a given element not contained in it the following result provides a far reaching generalisation theorem 4 32 hahn banach separation theorem let c and d be disjoint nonempty convex sets in x with c open then there exists an x x such that the sets c x and d x are disjoint 4 4 the hahn banach separation theorem 143 proof we prove the theorem in three steps step 1 first we prove the theorem for the real scalar field and d x 0 replacing c and x 0 by c y 0 and x 0 y 0 for some fixed y 0 c we may assume without loss of generality that 0 c define the minkowski functional of c as the mapping c x 0 given by c x inf t 0 t 1 x c since c is convex open and contains 0 we have c x 1 if and only if x c we claim that c enjoys the following two properties i c x y 6 c x c y for all x y x ii c tx t c x for all t 0 to prove i fix 0 and let s t 0 be such that s 1 x c and t 1 y c with s c x and t c x then s t 1 x y s s t s 1 x t s t t 1 y is a convex combination of the elements s 1 x t 1 y c and therefore belongs to c it follows that c x y 6 s t 6 c x c y 2 since 0 was arbitrary this establishes i assertion ii is obvious we now apply theorem 4 7 to the linear span w of x 0 and the linear mapping w r given by tx 0 t for t r in view of c x 0 1 for all t 0 it satisfies tx 0 t 6 t c x 0 c tx 0 hence we may apply the theorem and obtain a linear mapping x x r extending which satisfies x x 6 c x for all x x for all x c it satisfies x x 6 c x 1 and for all x c it satisfies x x x x 6 c x c x 1 it follows that x x 1 for all x in the open set c c containing 0 this proves that x x since x 0 x 6 c x 1 for all x c and x 0 x x 0 1 this functional has the required properties step 2 in the case of complex scalars and d x 0 upon restricting scalar multipli cation to the reals step 1 provides us with a real linear mapping x r x r such that x r x 1 for all x c c and x r x 0 6 x r c then as in the proof of theorem 4 8 x x x r x ix r ix is complex linear and bounded and satisfies x x 0 6 x c by comparing real parts step 3 now we prove the general case fix arbitrary y 0 c and z 0 d and put x 0 z 0 y 0 and c c d x 0 then c is open convex and contains 0 also x 0 6 c for x 0 c would imply 0 c d which is impossible since c d by 144 duality step 2 we obtain a functional x x such that x 0 x 6 c d x 0 x which is the same as saying that 0 6 c d x or equivalently c x d x corollary 4 33 suppose xn n 1 is a sequence in x and suppose that there exists an x x such that lim n xn x x x x x then there exists a sequence yn n 1 in the convex hull of xn n 1 such that lim n yn x with convergence in norm proof denote by d the closure of the convex hull of xn n 1 our task is to prove that x d suppose that this is not the case then theorem 4 32 provides us with a functional x x separating d from a small enough open ball c around x this functional also separates xn n 1 from x in contradiction to the assumptions of the corollary 4 5 the krein milman theorem extreme points play an important role in many applications of functional analysis for instance in quantum mechanics pure states are the extreme points of the convex set of all states see chapter 15 definition 4 34 extreme points an extreme point of a convex subset c of a vector space is an element v c such that if v 1 v 0 v 1 with v 0 v 1 c and 0 1 then v 0 v 1 v stated differently extreme points are points of c which cannot be realised in a non trivial way as a convex combination of other points of c example 4 35 let c denote the set of all probability measures on a given measure space f viewing c as a closed convex subset of m the banach space ofk valued measures on f we claim that a probability measure is an extreme point of c if and only if is atomic that is whenever a a 0 a 1 with disjoint a 0 a 1 f then min a 0 a 1 0 to prove the claim suppose first that c and 1 0 1 with 0 1 c and 0 1 if 0 6 1 there is a set a f such that 0 a 6 1 a interchanging 0 and 1 if necessary we may assume that 0 6 0 a 1 a 6 1 then 1 a 0 implies a 0 and 0 a 0 implies a 0 and therefore is not atomic this proves that every atomic measure is an extreme point of c 4 5 the krein milman theorem 145 conversely if c is not atomic then there exists a set a f such that a 0 and a 0 consider the probability measures 0 1 c given by 0 b a 1 b a 1 b a 1 b a b f with a we have 0 1 and 1 0 1 so is not extreme as a special case if k is a compact hausdorff space the extreme points of the set of all borel probability measures on k are the dirac measures supported on k to see this suppose that is atomic and let s be its support that is s is the complement of the union of all open sets of measure zero if s is not a singleton then it contains two distinct points say x 0 and x 1 since k is hausdorff they are contained in disjoint open sets u 0 and u 1 by the definition of support u 0 0 and u 1 0 and is not atomic this proves that s is a singleton say s x and therefore x closed convex sets need not have any extreme points example 4 36 in l 1 0 1 the closed convex set c f l 1 0 1 f 0 f 1 1 has no extreme points indeed let f c the mapping 1 0 f 1 is continuous from 0 1 to 0 1 and satisfies 0 0 and 1 1 hence there exists 0 1 such that 12 then f 1 2 g 1 2 h where g h c are given by g 21 0 f and h 21 1 f so f is not an extreme point of c as an application of the hahn banach theorem we can prove the following result about existence of extreme points recall that the closed convex hull of a subset s of a banach space is the smallest closed convex set containing s theorem 4 37 krein milman every compact convex subset of a banach space is the closed convex hull of its extreme points proof let k be a compact convex subset of the banach space x we first prove the existence of extreme points of k and then prove that k is the closed convex hull of its extreme points a face in k is a nonempty closed convex subset f of k whose elements can only be realised as convex combinations of elements in f that is whenever x f satisfies x 1 x 0 x 1 with x 0 x 1 k and 0 1 then x 0 x 1 f we make two useful observations i x k is an extreme point of k if and only if x is a face of k ii if f is a face of k and f is a face of f then f is a face of k claim i is evident for ii if x f is given as x 1 x 0 x 1 with x 0 x 1 k 146 duality and 0 1 then x 0 x 1 f since x f and f is a face of k then x 0 x 1 f since f is a face of f step 1 let k denote the collection of faces in k this collection is nonempty for it contains k we partially order k by declaring k 1 6 k 2 if k 2 k 1 by the finite inter section property see appendix c any totally ordered subset l of k has nonempty intersection the singletons consisting of elements in this intersection are upper bounds for l hence we can apply zorn s lemma and obtain that k has a maximal element say f we claim that f is a singleton say f x by i this means that x is an extreme point of k to prove the claim assume the contrary and let x 0 x 1 f be two distinct points by the hahn banach theorem there exists an x x such that re x 0 x 6 re x 1 x let f 0 x f re x x inf y f re y x then f 0 is a proper closed subset of f which is nonempty since the compactness of f implies that the infimum is a minimum if an element x f 0 can be represented as x 1 x x with x x f and 0 1 then 1 re x x re x x inf y f re y x if x 6 f 0 then re x x infy f re y x since also re x x infy f re y x the above inequality cannot hold the same contradiction is reached if x 6 f 0 we conclude that x x f 0 and f 0 is a face of f now ii implies that f 0 is a face of k since f 0 f this contradicts the maximality of f this completes the proof of the claim that f is a singleton it follows that k has an extreme point step 2 let l denote the closed convex hull of all extreme points of k we wish to show that l k reasoning by contradiction suppose that l is a proper subset of k and fix an element x 0 k l by the hahn banach separation theorem theorem 4 32 there exists an x x such that x 0 x 6 l x multiplying x with an appropriate scalar if necessary we may assume that re x 0 x inf y l re y x as in step 1 we see that the set f x k re x x inf y k re y x is a nonempty face of k moreover step 1 applied to f shows that f has an extreme point x 1 by i and ii x 1 is also an extreme point of k on the other hand from re x 1 x inf y k re y x 6 re x 0 x inf y l re y x 4 6 the weak and weak topologies 147 we infer that x 1 6 l since l contains all extreme points of k we have arrived at a contradiction 4 6 the weak and weak topologies some of the more advanced applications of the hahn banach theorem can be conve niently formulated in terms of certain topologies generated by bounded functionals the two most important ones are the weak topology of a banach space and the weak topology of its dual 4 6 a definition and elementary properties definition 4 38 weak topologies let v and w be vector spaces and let v w k be a bilinear mapping the weak topology of v generated by w is the smallest topology on v with the property that the linear mapping v 7 v w is continuous for all w w this topology is obtained as the intersection of all topologies in v for which all linear mappings v 7 v w w w are continuous the family of topologies with this property is nonempty for it always contains the power set topology of v by necessity the weak topology must contain every set of the form uv 0 w 0 v v v v 0 w 0 noting that this set is the inverse image under the continuous mapping v 7 v w 0 of the open ball b v 0 w 0 in k we claim that coincides with the topology generated by the sets uv 0 w 0 where v 0 w 0 and range over v w and 0 respectively the observation just made im plies that in the opposite direction for every w w the inverse under w of every open ball belongs to so every w is continuous with respect to since is the smallest topology with this property we have this establishes the claim it follows from the claim that a set u v belongs to if and only if it can be written as a union of finite intersections of sets of the form uv 0 w 0 indeed the collection of sets that can be written this way is a topology which contains every set uv 0 w 0 and therefore we have by the preceding observation this means that in the converse direction the fact that topologies are closed under taking unions and finite intersections implies that every set in belongs to proposition 4 39 in the above setting a sequence vn n 1 converges to v with respect to if and only if lim n vn v w 0 w w 148 duality proof the only if part follows from the fact that if vn v with respect to then for all 0 and w w we have vn uv w for all large enough n for the if part we note that if u contains v then the observation preceding the statement of the proposition allows us to find uv 1 w 1 1 uv k w k k such that x k j 1 uv j w j j u since we assume that vn v w j 0 for j 1 k for large enough n we have vn k j 1 uv j w j j and hence vn u the duality between a banach space and its dual leads to two special cases of interest definition 4 40 the weak and weak topologies let x be a banach space i the weak topology of x is the topology induced by x ii the weak topology of x is the topology induced by x it is implicit that in i we use the bilinear mapping from x x to k given by x x 7 x x in ii we use the bilinear mapping from x x tok given by x x 7 x x for these topologies proposition 4 39 takes the following form corollary 4 41 let x be a banach space the following assertions hold 1 a sequence xn n 1 in x converges to x x with respect to the weak topology of x if and only if limn xn x x 0 for all x x 2 a sequence x n n 1 in x converges to x x with respect to the weak topology of x if and only if limn x x n x 0 for all x x convergence with respect to the weak and weak topologies will be referred to as weak convergence and weak convergence respectively the following result is imme diate from the hahn banach separation theorem proposition 4 42 closed convex sets are weakly closed every closed convex set in a banach space is closed in the weak topology the next result characterises functionals that are continuous with respect to the weak and weak topologies proposition 4 43 let x be a banach space the following assertions hold 1 a linear mapping x k is continuous with respect to the weak topology if and only if it belongs to x 2 a linear mapping x k is continuous with respect to the weak topology if and only if it belongs to x that is there exists an x x such that x x x for all x x 4 6 the weak and weak topologies 149 proof 1 by assumption 1 bk contains a weakly open set containing the origin since weakly open sets are open this set contains a ball b 0 r with r 0 this means that x and 6 1 r 2 by assumption 1 bk contains a weak open set u containing the origin since weak open sets are weakly open part 1 shows that x the set u contains a set of the form u x x x j x j 1 k for suitable 0 k 1 and x 1 xk x let x 0 denote the span of x 1 xk this space is finite dimensional and therefore closed and by proposition 4 16 it is comple mented the proof of this proposition shows that x 0 is the range of a projection 0 let 1 i 0 be the complementary projection and denote by x 1 its range viewing 0 as a bounded operator from x onto x 0 its second adjoint 0 is a bounded operator from x to x 0 the space x 0 being finite dimensional can be identified with its second dual the identification being given by the natural inclusion mapping j x 0 x 0 which is surjective in this case the details are spelled out in example 4 57 thus we may identify 0 x with an element of x 0 we will show that x x x for all x x let x r 0 r 1 be the direct sum decomposition associated with the adjoint projections 0 and 1 if x 1 r 1 then x j x 1 0 for all j 1 k so x x 1 0 this implies that cx 1 u 1 bk for all c k that is cx 1 bk for all c k and this is only possible if x 1 0 for all x x 0 x 1 r 0 r 1 x we thus obtain x x x x 0 x 0 0 0 x 0 x 0 x x we apply the second part of this proposition to prove a version of the hahn banach separation theorem for the weak topology proposition 4 44 if f is a weak closed convex subset of x and x 0 6 f then there exists an element x 0 x such that x 0 x 6 x 0 f proof suppose first that k r by definition of the weak topology there exists a weak open set u of the form u x x x j x j 1 k for suitable x 1 xk x and 0 such that x 0 u f by the hahn banach separation theorem there exists an element x 0 x separating x 0 u from f this forces x 0 to be bounded on u for otherwise the convexity and symmetry of u implies 150 duality that u x 0 r and then the set x 0 u x 0 would contain the set f x 0 contracting the choice of x 0 since x 0 is bounded on u x 0 is continuous with respect to the weak topology of x hence by proposition 4 43 it can be identified with an element x 0 x this element has the desired properties this concludes the proof in the case k r if k c we apply the result for real scalars to the real banach space xr obtained by restricting scalar multiplication to real scalars using the notation introduced in definition 4 17 we have the following characterisa tion of weak and weak closures of subspaces proposition 4 45 let x be a banach space the following assertions hold 1 for every subspace y of x we have y y weak y 2 for every subspace y of x we have y y weak proof 1 the inclusion y y weak follows from the easy observation that pre annihilators are weakly closed and the equality y weak y is a consequence of propo sition 4 42 to prove the inclusion y y let x 6 y by corollary 4 12 we can find x 0 y such that x x 0 6 0 this means that x is not in the pre annihilator of y 2 this is proved in the same way except that now we use proposition 4 44 we recall that the canonical embedding j x x is defined by x jx x x as we have seen before j is an isometry from x into x accordingly we may identify x with a closed subspace of x and bx with a closed subset of bx as a further application of proposition 4 44 we have the following density result theorem 4 46 goldstine let x be a banach space the following assertions hold 1 x is weak dense in x 2 bx is weak dense in bx proof it suffices to prove the second assertion the first follows from it by normalising elements x x to unit length arguing by contradiction suppose that x 0 bx is not contained in the weak closure f of bx then by proposition 4 44 there exists an element x 0 x such that x 0 x 0 6 x 0 f by multiplying with a scalar may assume that x 0 1 since bx is weak closed we have bx f bx it follows from this that x 0 f bk c k c 6 1 and therefore x 0 x 0 1 but this contradicts the fact that x 0 6 1 and x 0 1 closely related cf problem 4 35 is the following result 4 6 the weak and weak topologies 151 theorem 4 47 for all x x x 1 x n x and 0 there exists an x x such that x x and x x n x n x n 1 n the proof uses an elementary version of the open mapping theorem theorem 5 8 lemma 4 48 let t be a bounded operator from a normed space x onto a finite dimensional normed space y then t maps open sets to open sets proof let yn dn 1 be a basis for y and choose a sequence xn d n 1 in x such that t xn yn for n 1 d let x 0 denote the linear span of xn dn 1 the restriction t 0 t x 0 x 0 y is bounded and bijective by corollary 1 37 its inverse is bounded this implies that t 0 maps open sets to open sets now let u be open in x for every u u let ru 0 be such that bx 0 u ru u rubx 0 u then u u u u rubx 0 and therefore t u u u tu rut bx 0 is open since t bx 0 t 0 bx 0 is open proof of theorem 4 47 we prove the theorem in two steps step 1 let x 1 x n x and c 1 cn k be given in this step we prove that if there exists a constant m 0 such that for all 1 n k we have n n 1 ncn 6 m n n 1 nx n 4 7 then there exists an x x such that x m and x x n cn n 1 n consider the mapping t x 7 x x n nn 1 from x into k n we must prove that t b 0 m which by lemma 4 48 is an open subset of the finite dimensional space r t contains cn nn 1 suppose for a contradiction that this not true then t b 0 m is an open subset ofkn not containing cn nn 1 the hahn banach sep aration theorem provides us with a sequence n nn 1 k n such that n n 1 ncn 6 x n n 1 nx n x m multiplying with an appropriate scalar of modulus one it follows that also n n 1 ncn 6 x n n 1 nx n x m 152 duality by scaling the right hand side set contains the interval 0 m nn 1 nx n this contra dicts the assumption 4 7 step 2 returning to the assumptions of the lemma fix x x and x 1 x n x and set cn x n x for n 1 n for all 1 n k we have n n 1 ncn n n 1 nx n x 6 n n 1 nx n x so the assumptions of step 1 are satisfied with m x 4 7 the banach alaoglu theorem we have seen in chapter 1 that the closed unit ball of a banach space is compact if and only if the space is finite dimensional in this section we prove that the closed unit ball of every dual banach space is compact with respect to the weak topology and use this to prove that a banach space is reflexive if and only if its closed unit ball is compact with respect to the weak topology 4 7 a the theorem in preparation for the main result of this section theorem 4 51 we have the following simple result it extends proposition 3 16 to separable banach spaces proposition 4 49 let x be a separable banach space and let x n n 1 be a bounded sequence in the dual space x then there exists a subsequence x nk k 1 and an x x such that lim k x x nk x x x x proof let x j j 1 be a countable set with dense linear span x 0 in x by a diagonal argument there exists a subsequence x nk k 1 of x n n 1 such that the limit x j limk x j x nk exists for all j 1 then by linearity the limit x limk x x nk exists for all x x 0 clearly x 7 x is linear and from x 6 supk 1 x nk we see that is bounded as a mapping from x 0 to k since x 0 is dense in x proposition 1 18 implies that has a unique bounded extension of the same norm to all of x denoting this extension also by it follows from proposition 1 19 that limk x x nk x for all x x thus x has the required properties in contrast to the hilbert space case considered in proposition 3 16 the separability assumption in proposition 4 49 cannot be omitted 4 7 the banach alaoglu theorem 153 example 4 50 consider the sequence n n 1 of coordinate functionals x 7 xn on x given a subsequence nk k 1 let x be any element such that xnk 1 k for all k 1 then x nk 1 k fails to converge as k proposition 4 49 can be viewed as a sequential version of the following theorem theorem 4 51 banach alaoglu the closed unit ball of every dual banach space is compact with respect to the weak topology proof let bk a k a 6 1 and bx x x x 6 1 where x is a given banach space in the remainder of the proof we think of bx as endowed with the weak topology inherited from x by tychonov s theorem theorem c 13 the product space k x x x bk is compact with respect to the product topology denoting elements of k as k kx x x consider the mapping from bx k given by x x x x x 4 8 let r denote its range we first prove that r is a closed subset of k to this end let r r as a first step we show that r is linear in the sense that a 0 rx 0 a 1 rx 1 ra 0 x 0 a 1 x 1 for all a 0 a 1 k and x 0 x 1 x fix an arbitrary 0 by the definitions of the weak and product topologies the set u k k kx 0 rx 0 kx 1 rx 1 ka 0 x 0 a 1 x 1 ra 0 x 0 a 1 x 1 is open in k and contains r and therefore u intersects r this means that there is an x 0 bx such that x x 0 x x u that is x 0 x 0 rx 0 x 1 x 0 rx 1 a 0 x 0 a 1 x 1 x 0 ra 0 x 0 a 1 x 1 then a 0 rx 0 a 1 rx 1 ra 0 x 0 a 1 x 1 6 a 0 rx 0 a 0 x 0 x 0 a 1 rx 1 a 1 x 1 x 0 a 1 x 0 x 0 a 1 x 1 x 0 ra 0 x 0 a 1 x 1 6 a 0 b 0 since 0 was arbitrary this proves the linearity of r next we prove that r x x x x for some x x which is the same as saying that r r since we already know that r is linear we must prove that r is bounded in the sense that rx 6 c x for all x x to this end let x 0 x and 0 arguing as before from x 0 x 0 rx 0 we infer rx 0 6 x 0 x 0 6 x 0 154 duality since x 0 x and 0 were arbitrary it follows that r is bounded of norm at most 1 and thus defines an element x bx in the sense that rx x x for all x x this completes the proof that r is closed as a consequence r is compact it being a closed subset of the compact set k since the mapping defined by 4 8 is injective the inverse mapping 1 r bx is well defined we claim that this mapping is continuous since the sets vx 0 x 0 bx generate the weak topology of bx it suffices to check that their images under are open in r but these are the sets k k kx 0 x 0 x 0 r which are open in r the weak compactness of bx 1 r now follows from the compactness of r a topological space is said to be metrisable if the underlying set admits a metric whose open sets are precisely the sets of the next result shows that if x is separable then the weak topology of the unit ball of x is metrisable as a result proposition 4 49 can alternatively be deduced from theorem 4 51 by using that compactness and sequential compactness are equivalent for metric spaces proposition 4 52 if x is a separable banach space then the weak topology of the closed unit ball of x is metrisable proof let xn n 1 be a dense sequence in the closed unit ball bx of x such a sequence exists since x is separable it is easily checked that the formula d x y n 1 1 2 n xn x y 1 xn x y defines a metric d on bx and that the identity mapping ix bx weak bx d is continuous in particular ix maps compact subsets of bx weak to compact sub sets of bx d the banach alaoglu theorem asserts that bx weak is compact since closed subsets of a compact space are compact and compact sets are closed ix maps closed subsets of bx weak to closed subsets of bx d thus the continuous mapping ix has continuous inverse and the result follows 4 7 b reflexivity recall that if x is a banach space we can use the natural isometry j x x given by x jx x x to identify x with a closed subspace of x definition 4 53 reflexivity a banach space x is called reflexive if the mapping j x x is surjective the banach alaoglu theorem implies the following characterisation of reflexivity 4 7 the banach alaoglu theorem 155 theorem 4 54 reflexivity and weak compactness of the unit ball a banach space is reflexive if and only if its closed unit ball is weakly compact proof the only if part follows from the banach alaoglu theorem noting that the canonical embedding j x x maps bx onto bx and that under the identification of x and x the weak topology of x equals the weak topology of x the if part follows from goldstine s theorem theorem 4 46 indeed if bx is weakly compact then its image under the canonical embedding j is weak compact in x this follows from the observation that j is continuous as a mapping from x weak to x weak which in turn is a trivial consequence of the definitions of the weak and weak topologies it follows that bx is weak compact as a subset of the closed unit ball bx on the other hand goldstine s theorem says that bx is weak dense as a subset of bx hence we must have bx bx and this implies x x corollary 4 55 let x be a banach space the following assertions hold 1 if x is reflexive then every closed subspace of x is reflexive 2 x is reflexive if and only if x is reflexive 3 if x is isomorphic to a banach space y then x is reflexive if and only if y is reflexive proof 1 if y is a closed subspace of x the closed unit ball by is the intersection of the set bx which is weakly compact by theorem 4 54 and the set y which is weakly closed by corollary 4 12 as a result by is weakly compact and y is reflexive by another application of theorem 4 54 2 if x is reflexive the weak and weak topologies of x coincide as a result bx is weakly compact by the banach alaoglu theorem and therefore x is reflexive by theorem 4 54 if x is reflexive then x is reflexive by what we just proved and then x viewed as a closed subspace of x is reflexive by part 1 3 if i x y is an isomorphism then i x y is an isomorphism by proposition 4 27 applied twice denoting the natural isometries of x and y into their second duals by jx and jy one easily checks that i jx jy i this identity implies that jx is surjective if an only if jy is surjective part 3 can be also be deduced from theorem 4 54 we leave this as an easy exercise corollary 4 56 every bounded sequence in a reflexive banach space has a weakly convergent subsequence proof let xn n 1 be a bounded sequence in the reflexive banach space x and let y be its closed span then y is separable and y is reflexive by corollary 4 55 proceeding as in the proof of proposition 4 52 the weakly compact set by is metrisable and we may argue by sequential compactness of the resulting metric space 156 duality example 4 57 the following are examples of reflexive banach spaces finite dimensional banach spaces the spaces p with 1 p the spaces lp with 1 p hilbert spaces to prove that finite dimensional banach spaces x are reflexive we use the fact that such spaces are isomorphic to kd where d dim x the isomorphism kd kd dualises to an isomorphism kd kd and one easily checks that the composition of these isomorphisms equals the canonical embedding j kd kd in particular this embedding is surjective it follows that kd is reflexive and therefore x is reflexive by corollary 4 55 in the same way the second and third examples follow from the isometric identifica tions p q and lp lq 1 p 1 q 1 strictly speaking we have shown the identification lp lq only for finite measure spaces but for 1 p the finiteness assumption is redundant see problem 4 3 that hilbert spaces are reflexive is a consequence of the riesz representation the orem theorem 3 15 which sets up a conjugate linear identification of the dual h of a hilbert space with the hilbert space h itself applying the theorem twice and composing the identifications of h with h and h with h and again the resulting identification h with h equals the natural embedding j h h example 4 58 the spaces c 0 1 and are nonreflexive for c 0 this follows from the fact that c 0 and for 1 c 0 and 1 this follows from corollary 4 55 the spaces c k and l 1 are nonreflexive except when they are finite dimensional indeed it is easy to find closed subspaces isomorphic to c 0 or 1 respectively take the closed linear span of any sequence of norm one vectors with disjoint supports and nonreflexivity again follows from corollary 4 55 4 7 c translation invariant operators on l 1 rd in this section and the next we give two nontrivial applications of the banach alaoglu theorem or more precisely its sequential version contained in proposition 4 49 the first application is concerned with characterising the translation invariant operators on l 1 rd as the convolutions with finite borel measures it is complemented by theo rem 5 35 in the next chapter which characterises the translation invariant operators on l 2 rd as the fourier multiplier operators lemma 4 59 if g l 1 rd satisfies rd g x x dx 0 for all c c d then g 0 almost everywhere on d 4 7 the banach alaoglu theorem 157 proof without loss of generality we may assume that g is nonnegative for any open set u rd we may choose functions n c c u such that 06 n 1 u pointwise as n then by the assumption of the lemma and dominated convergence u g x dx lim n rd g x n x dx 0 dynkin s lemma lemma e 4 applied to the finite borel measure b b g x dx shows that b g x x dx 0 for all borel subsets b r d taking b x rd g x gives 06 6 almost everywhere this being true for all 0 gives the result theorem 4 60 translation invariant operators on l 1 rd if t is a bounded operator on l 1 rd commuting with every translation then t is the convolution with respect to a necessarily unique measure m rd that is for all f l 1 rd we have t f x rd f x y d y for almost all x rd moreover t 6 proof fix a function l 1 rd satisfying rd x dx 1 for 0 the mollified functions x d 1 x belong to l 1 rd and satisfy 1 1 by view ing the functions t l 1 rd as densities of finite borel measures on rd we may identify them with finite borel measures m rd by theorem 4 2 and proposition e 16 m rd can be identified with the dual of c 0 rd hence by the sequential ver sion of the banach alaoglu theorem proposition 4 49 some subsequence t n n 1 converges weak to a measure m rd then for all g c 0 rd lim n rd g y t n y dy rd g y d y applying this to the functions y 7 g x y xg y where x is translation over x upon letting n we obtain rd g y t n y x dy rd g x y t n y dy rd g x y d y by fubini s theorem a change of variables the commutation assumption and proposi tion 2 34 this implies rd g x rd f x y d y dx rd rd f x y g x dxd y rd f x rd g x y d y dx lim n rd f x rd g y t n y x dydx lim n rd f x rd g y xt n y dydx 158 duality lim n rd f x rd g y t x n y dydx lim n rd t g y rd f x n y x dxdy rd t g y f y dy rd g y t f y dy in we identified g c 0 rd with a function in l rd l 1 rd since the above identities hold for all g c 0 rd lemma 4 59 implies that rd f x y d y t f y for almost all y rd this proves that t is of the asserted form and the bound t 6 follows from the observation preceding the theorem it remains to establish uniqueness of the measure suppose that m rd satisfies f 0 for all f l 1 rd fix a function f cc rd then f x rd x f y d y 0 for almost all x rd since x 7 x f is continuous from rd to c 0 rd it follows that the preceding equality holds for all x rd since the choice of f cc rd was arbitrary we conclude that rd y d y 0 for all cc rd since cc rd is dense in c 0 rd this implies 0 4 7 d prokhorov s theorem the aim of this section is to prove a compactness result of fundamental importance in probability theory known as prokhorov s theorem for its statement we need the following terminology definition 4 61 uniform tightness a collection p of borel measures on a topological space x is called uniformly tight if for every 0 there exists a compact set k in x such that x k for all p definition 4 62 weak convergence a sequence n n 1 of borel probability mea sures on a topological space x is said to converge weakly to a borel probability measure on x if lim n x f d n x f d f cb x where cb x denotes the banach space of bounded continuous functions on x viewing borel probability measures on x as functionals in the dual space cb x weak convergence in the sense of the above definition is precisely weak convergence 4 7 the banach alaoglu theorem 159 in the sense discussed in the present chapter the terminology weak convergence is firmly established in the probability literature however theorem 4 63 prokhorov s theorem for a metric space x the following assertions hold 1 if a family p of borel probability measures on x is uniformly tight then every se quence in p contains a weakly convergent subsequence 2 if x is separable and complete then every weakly convergent sequence of borel probability measures on x is uniformly tight the proof of part 1 relies on the following lemma lemma 4 64 let f be a measurable space and let a 1 a 2 be an increasing sequence of sets in f such that j 1 a j for each j 1 let j be a measure on a j if the measures j are increasing in the sense that j ai i whenever j i then the formula b lim j j b a j defines a measure on proof if b f then for j i we have j b a j j b ai j ai b ai i b ai therefore the limit defining b exists and b sup j 1 j b a j it is clear that 0 to prove that is countably additive let b n 1 bn with disjoint measurable sets bn on the one hand b sup j 1 j b a j sup j 1 n 1 j bn a j 6 n 1 sup j 1 j bn a j n 1 bn on the other hand for each j 0 1 we have b sup j 1 j b a j j 0 b a j 0 n 1 j 0 bn a j 0 hence by monotone convergence b lim j 0 n 1 j 0 bn a j 0 n 1 lim j 0 j 0 bn a j 0 n 1 bn proof of theorem 4 63 part 1 assuming that p is uniformly tight we must prove that there is a borel probability measure on x such that n weakly choose an increasing sequence of compact sets k j x such that n k j 1 1 2 j for all j 1 and n 1 replacing x by j 1 k j we may assume that x is separable 160 duality step 1 identifying each restriction n k j with an element of c k j by a diag onal argument we find a subsequence nk k 1 such that for all j 1 the sequence nk k j k 1 is weak convergent in c k j to some borel measure j on k j this ar gument uses the sequential version of the banach alaoglu theorem proposition 4 49 and the separability of the spaces c k j proposition 2 8 note that j k j 1 k j j limk 1 k j nk k j limk nk k j 1 2 j where the brackets refer to the duality of c k j and its dual m k j step 2 we claim that if j i then j ki i to this end fix a number 0 and a function f c ki satisfying 06 f x 6 1 for all x ki using theorem c 12 we extend f to a function in c k j satisfying 06 f x 6 1 for all x k j and let fm c k j be defined by fm x 1 m d x ki f x x k j choosing m large enough say m m we may assume that k j ki fm d j since fm f on ki we find ki f d j ki f d i k j fm d j ki fm d i lim k k j fm d nk ki fm d nk 0 since 0 was arbitrary this proves that ki f d j ki f d i step 3 we apply lemma 4 64 to see that b lim j j b k j sup j 1 j b k j defines a borel measure on x 0 j 1 k j we may extend to a borel measure on all of x by extending it identically 0 outside x 0 clearly x 6 1 and x k j j k j 1 2 j this proves a couple of things at the same time namely that is a probability measure and that is tight it remains to prove that limn nk weakly for this it suffices to prove that limn x f d nk x f d for all f cb x satisfying 06 f 6 1 fixing such a func tion choose a sequence fm m 1 of simple functions satisfying 06 fm 6 1 for all m 1 and fm f uniformly as m fix j 0 so large that 2 j 0 then for m m with m as in step 2 and all j j 0 limsup k x f d x f d nk 6 2 j 1 limsup k k j f d k j f d nk 4 7 the banach alaoglu theorem 161 6 2 k j f d k j f d j 6 4 k j 0 f d k j 0 f d j 6 6 k j 0 fm d k j 0 fm d j since lim j j b k j 0 lim j j b k j 0 k j b k j 0 for all borel sets b in x and each function fm is simple upon letting j we obtain lim j k j 0 fm d j k j 0 fm d consequently limsup k x f d x f d nk 6 6 since 0 was arbitrary this proves the weak convergence for the proof of part 2 we need the following characterisation of weak convergence known as the portmanteau theorem proposition 4 65 let n n 1 and be borel probability measures on a metric space x the following assertions are equivalent 1 limn n weakly 2 for all open subsets u of x we have u 6 liminfn n u 3 for all closed subsets f of x we have limsupn n f 6 f proof 1 2 let u x be open for each k 1 let u k x u d x u 1 k since u is open we have u k 1 u k and u limk u k the functions fk x min 1 k d x u x x belong to cb x and satisfy 06 fk 6 1 fk 0 on u and fk 1 on u k for each k 1 u k 6 x fk d lim n x fk d n liminf n x fk d n 6 liminf n n u now we pass to the limit k the equivalence 2 3 follows by taking complements 162 duality it remains to prove that 2 and 3 together imply 1 let u 1 uk be open sets in x and consider a function of the form g kj 1 c j 1 u j we have using 2 x gd k j 1 c j u j 6 liminf n k j 1 c j n u j liminf n x gd n similarly for g kj 1 c j 1 u j we have using 3 limsup n x gd n 6 k j 1 c j limsup n n u j 6 k j 1 c j u j x gd let f cb x be a real valued function and choose a b r such that a f x b for all x x there are at most countably many r a b such that the set x x f x r has nonzero measure let r denote the set of these numbers r fix 0 and let t 0 tk be a partition of a b with mesh such that t 0 a tk b and t j 6 r for all j 1 k 1 put u j x x f x t j 1 t j j 1 k and g k j 1 t j 11 u j h k j 1 t j 1 u j with the above notation g x 6 f x 6 g x and f x 6 h x 6 f x whenever f x 6 t j for j 1 k 1 since x x f x t j 0 for j 1 k 1 we obtain limsup n x f d n 6 limsup n x hd n 6 x hd 6 x f d 6 2 x gd 6 2 liminf n x gd n 6 2 liminf n x f d n since 0 was arbitrary this concludes the proof for real valued functions f in the case of complex scalars the result for complex valued f follows from it by considering real and imaginary parts separately proof of theorem 4 63 part 2 since x is separable we may pick a dense sequence xn n 1 in x for every integer k 1 the open balls b xn 1 k n 1 cover x fix 0 and choose the integers nk 1 such that nk n 1 b xn 1 k 1 2 k by proposition 4 65 this implies that for all large enough j say for j j 0 we have j nk n 1 b xn 1 k 1 2 k problems 163 the set k k 1 nk n 1 b xn 1 k is closed and totally bounded the completeness of x therefore implies that k is com pact moreover for j j 0 j k 6 k 1 j nk n 1 b xn 1 k 6 k 1 j nk n 1 b xn 1 k 6 k 1 2 k problems 4 1 a bounded operator is said to be of finite rank if its range is finite dimensional show that every finite rank operator t l x y is of the form t x n n 1 x x n yn x x for certain yn y and x n x 4 2 consider an open set d c and a complex banach space x a function f d x is said to be holomorphic if for all z 0 d the limit lim z z 0 f z f z 0 z z 0 exists in x use the hahn banach theorem to prove that the cauchy theorem and the cauchy integral formula hold for holomorphic functions f d x defined on an open set d in c 1 2 i z z 0 r f z dz 0 and 1 2 i z z 0 r f z z z 0 dz f z 0 here it is assumed that z 0 d and r 0 is so small that z z 0 r is contained in d this contour is oriented counterclockwise 4 3 let 16 p q 6 satisfy 1 p 1 q 1 164 duality a prove that the identification lp lq remains true in the non finite case if 1 p hint given a functional lp there is a sequence fn n 1 in lp such that supn 1 fn the algebra generated by this sequence is finite b show by way of example that part a does not extend to p 1 4 4 prove that if x is separable then x is separable hint there is a sequence xn n 1 in x such that x supn 1 xn x for a countable dense set of functionals x in x 4 5 let x be a banach space a show that for all nonzero x x we have an isomorphism of banach spaces x n x k where n x x x x x 0 b let q x x n x denote the quotient mapping prove that if x 1 then for all x x the following identity holds qx x x hint for the inequality 6 begin by showing that for any 0 1 there must exist c k and y x such that cx y 1 and cx y x 1 4 6 let y be a proper closed subspace of x and let x 0 x y as in corollary 4 12 on the span x 0 of y and x 0 define y 0 for all y y and x 0 1 it was shown in the corollary that is bounded show that its norm is given by x 0 1 d x 0 y 4 7 let x be a banach space for a set a x and an element x x we denote by d x a infy a x y the distance from x to a a let x be a banach space let x 0 x be a proper closed subspace and let x x x 0 prove that there exists an x x with x 1 such that x x d x x 0 and x x 0 0 hint let y span x 0 x prove that the mapping x 0 y k given by x 0 x 0 tx td x x 0 x 0 x 0 t k is linear belongs to y has norm x 0 y 1 and satisfies x 0 x 0 0 apply the hahn banach theorem to extend x 0 to a functional on x problems 165 b using the result of part a show that there exists x l 0 1 such that f x 0 1 f t dt f c 0 1 but 1 0 12 x 6 0 1 1 0 12 t dt 4 8 we take a look at banach spaces containing and contained in a let x be a banach space y be a closed subspace of x and let t 0 y be a bounded operator show that there exists a bounded operator t x such that t y t 0 and t t 0 hint apply the hahn banach theorem coordinatewise b using the result of part a prove that if a closed subspace y of a banach space x is isomorphic to then y is complemented in x c show that every separable banach space x is isometrically isomorphic to a closed subspace of more precisely show that if x is a separable banach space then there exists a closed subspace y of and an isometric isomor phism t from x onto y hint use the hahn banach theorem in combination with the separability to make a clever choice of a sequence of functionals x n n 1 in x and consider the mapping t x 7 x x n n 1 4 9 find an example of a two dimensional banach space x and a functional on one of its closed one dimensional subspaces which has infinitely many extensions to a functional on x of the same norm 4 10 let y be closed subspace of a banach space x a prove that for all x x we have d x y x y y b prove that a functional y y has a unique extension to a functional in x of the same norm if and only if the annihilator y has the haar property as a closed subspace of x recall from problem 3 4 that a banach space x is called strictly convex if for all norm one vectors x 0 x 1 x with x 0 6 x 1 and 0 1 we have 1 x y 1 this problem shows that if the dual x of a banach space is strictly convex then every functional on a closed subspace of x has a unique hahn banach extension of the same norm the closed subspace y is said to have the haar property if for all x x y there exists a unique y y such that d x y x y 166 duality c prove that if x is strictly convex then every closed subspace y of x has the haar property 4 11 let y be a closed subspace of a banach space x and let i y x be the inclusion mapping show that the adjoint i x x is the restriction mapping 4 12 let h 1 and h 2 be hilbert spaces and x be a banach space suppose t 1 l h 1 x and t 2 l h 2 x are bounded operators prove that the following assertions are equivalent 1 there is a constant c 0 such that t 1 x 6 c t 2 x for all x x 2 t 1 h 1 t 2 h 2 hint begin by showing that without loss of generality we may assume that t 1 and t 2 are injective 4 13 let 16 p a let t lp 0 1 k be the linear mapping defined by t f 1 0 f s ds f lp 0 1 show that t is bounded and find an expression for t b let t lp 0 1 lp 0 1 be the linear operator defined by t f t t 0 f s ds t 0 1 f lp 0 1 show that t is bounded and find an expression for t c let t be the linear operator of part b now viewed as an operator from lp 0 1 into c 0 1 show that t is bounded and find an expression for t 4 14 this problem presents a way to evaluate the norm of a d d matrix a with com plex coefficients viewed as a bounded operator on cd a prove that all eigenvalues of a a are nonnegative real numbers and that the eigenspaces corresponding to different eigenvalues are orthogonal b conclude from proposition 4 28 and part a that a 2 max 0 is an eigenvalue of a a 4 15 let h 0 be a closed subspace of h and let i h 0 h be the inclusion mapping show that the adjoint i h h 0 is the orthogonal projection in h onto h 0 viewed as a mapping from h to h 0 4 16 let t be a bounded operator on h a show that if t is a contraction that is t 6 1 then for each x h we have t x x if and only if t x x conclude that h admits an orthogonal direct sum decomposition h n i t r i t problems 167 hint if t x x show that t x x x and deduce that t x x b let t be a contraction and define sn 1 n n 1 k 0 t k n 1 using proposition 4 31 and the result of part a prove that lim n snx x if x n i t 0 if x n i t 4 17 let k be a compact hausdorff space and let c k be an element with the following two properties i 1 1 ii f g f g for all f g c k prove that f f x for some x k hint show that as an element of m k is supported on a singleton 4 18 find the extreme points of the closed convex set c f l 1 0 1 f 0 f 1 6 1 4 19 let c be a closed convex subset of a separable banach space x prove that there exists a sequence x n n 1 of norm one elements in x and a sequence fn n 1 of closed sets in k such that c n 1 x x x x n fn hint separate c from the elements of a dense sequence in its complement c using the hahn banach separation theorem 4 20 let x and y be banach spaces prove the following assertions a a linear operator t x y is continuous with respect to the weak topologies of x and y if and only if it is bounded b a linear operator s y x is continuous with respect to the weak topolo gies of y and x if and only if it is the adjoint of a bounded operator t x y 4 21 prove that the weak topology of a banach space x coincides with the norm topol ogy if and only if x is finite dimensional 4 22 prove that c 0 c 0 1 cb d and l 1 are norm closed and weak dense in l 0 1 l d and m respectively 4 23 prove that the linear span of the dirac measures is weak dense in m r 4 24 find an example of a sequence x n n 1 in a dual banach space x with the fol lowing two properties 168 duality i there exists an x x such that limn x x n x x for all x x ii no sequence contained in the convex hull of x n n 1 converges to x with respect to the norm of x compare with corollary 4 33 4 25 prove the following converse to proposition 4 52 if the weak topology of the closed unit ball of a dual banach space x is metrisable then x is separable hint complete the details of the following argument let d be a metric which induces the weak topology of bx then bx d is a compact metric space and therefore the banach space c bx d is separable by proposition 2 8 now ob serve that x is isometrically contained in c bx d in a natural way 4 26 let x be a banach space a let x 1 xn x and c 1 cn k and a constant m 0 be given prove that the following are equivalent 1 there exists an x x such that x 6 m and xn x cn n 1 n 2 for all 1 n k we have n n 1 ncn 6 m n n 1 nxn b use the banach alaoglu theorem to extend the result of part a to infinite sequences xn n 1 and cn n 1 4 27 show that the weak topology of a weakly compact subset of a separable banach space is metrisable 4 28 using the result of the preceding problem show that if k is a weakly compact subspace of a banach space then every sequence xn n 1 contained in k has a weakly convergent subsequence 4 29 using the result of the preceding problem show that c 0 1 and l 1 0 1 are non reflexive by checking that their closed unit balls contain sequences that fail to converge weakly 4 30 as an application of the banach alaoglu theorem prove that there exist function als such that for all x xn n 1 we have i x 0 whenever x 0 ii x sx where s xn n 1 7 xn 1 n 1 is the left shift iii x limn xn whenever limn xn exists functionals with these properties are called banach limits hint consider the functionals n x 1 n n j 1 x j problems 169 4 31 let xn n 1 be the sequence in defined by xn 0 0 n times 1 1 n 1 a show that this sequence has no weakly convergent subsequence hint use the result of problem 4 30 b why doesn t this contradict the banach alaoglu theorem 4 32 let x be a separable banach space and let x 0 be a closed subspace of x isomor phic to c 0 our aim is to show that x 0 is complemented in x a use the hahn banach theorem and the definition of an isomorphism to show that there exists a bounded sequence x n n 1 in x such that for all y c 0 and n 1 we have jy x n yn where j c 0 x 0 is the isomorphism mapping c 0 onto x 0 hint consider the adjoint of the operator j 1 x 0 c 0 b suppose that x x is such that limn x x nk x x for all x x and some subsequence x nk k 1 of x nk n 1 show that x x 0 that is x 0 x 0 for all x 0 x 0 c use the banach alaoglu theorem and part b to deduce that lim n d x n x 0 0 d suppose that x n 6 r for all n 1 use proposition 4 52 and part c to con clude that there exists a sequence y n n 1 in b 0 r such that limn x x n y n 0 for all x x and x 0 y n 0 for all x 0 x 0 and all n 1 e show that the mapping p x 7 x x n y n n 1 is well defined and bounded from x into c 0 and that j p is a projection in x whose range equals x 0 4 33 show that 1 has the schur property if limn xn x weakly in 1 then limn xn x strongly in 1 4 34 let f be a probability space let fn n 1 be a bounded sequence in l 1 which is uniformly integrable that is lim r sup n 1 1 fn r f 1 0 show that fn n 1 contains a weakly convergent subsequence by completing the details of the following argument a for k 1 2 the sequence defined by f k n 1 fn k fn contains a subse quence that is weakly convergent in l 2 and hence weakly convergent in l 1 denote by f k their weak limits in l 1 b show that f k f 1 6 liminfn f k n f n 1 and the latter tends to 0 by uniform integrability c conclude that the limit limk f k f exists in l 1 and that limn fn f weakly in l 1 170 duality 4 35 deduce theorem 4 46 from theorem 4 47 4 36 prove the various identifications made in the discussion following example 4 57 4 37 prove that if y is a closed subspace of a reflexive banach space x then the quo tient space x y is reflexive 4 38 show that if x is a banach lattice then an element x x satisfies x 0 if and only if x x 0 for all x x satisfying x 0 4 39 show that if x is a banach lattice and x x satisfies x 0 then for all x x we have the following assertions a x x sup x y 06 y 6 x b x x sup x y y 6 x 4 40 under the assumptions of theorem 4 2 let mr x represent the functional c 0 x show that the measures representing and are and respectively 4 41 for 16 p consider the space p 0 1 introduced in problem 2 34 a show that there is a natural isometric isomorphism p 0 1 q 0 1 where 1 p 1 q 1 b show that the function f 0 1 p 0 1 given by f t s 1 s t 0 s 6 t has the following properties i t 7 f t g is measurable for all g q 0 1 ii t 7 f t fails to be strongly measurable 4 42 let an n 1 be a sequence of disjoint intervals of positive measure an in the interval 0 1 and define f 0 1 c 0 by f t n 1 1 an 1 an t un where un n 1 is the sequence of standard unit vectors of c 0 a show that f is strongly measurable b show that for all x c 0 1 the integral 1 0 f t x dt is well defined c show that f fails to be bochner integrable 4 43 consider the mapping f 0 1 l 0 1 given by f t 1 0 t a show that f x is measurable for all x l 0 1 hint monotone scalar valued functions are measurable b show that f fails to be bochner integrable 5 bounded operators in the first chapter bounded operators have been introduced and some of their basic properties were established this chapter treats some of their deeper properties in sec tions 5 1 5 3 we begin with three results each of which expresses a certain robustness property of the class of bounded operators the uniform boundedness theorem theorem 5 2 the open mapping theorem theorem 5 8 and the closed graph theorem theorem 5 11 completeness plays a critical role through their dependence on the baire category theorem in section 5 4 we present the fourth main result of this chapter the closed range theorem theorem 5 16 as simple as the definition of a bounded operator may seem in practice it can be quite hard to establish boundedness of a given linear operator this applies in particular to some of the most important operators in analysis such as the fourier plancherel transform and the hilbert transform their properties are studied in fair detail in sec tions 5 5 and 5 6 the final section 5 7 discusses the riesz thorin interpolation theorem theorem 5 39 and its companion the marcinkiewicz interpolation theorem theorem 5 47 5 1 the uniform boundedness theorem the proof of the uniform boundedness theorem as well as the proofs of some other results in this chapter depend on the baire category theorem this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 171 172 bounded operators 5 1 a the baire category theorem theorem 5 1 baire category theorem let x be a nonempty complete metric space let f 1 f 2 be closed subsets of x such that x n 1 fn then at least one of the sets fn has nonempty interior proof assuming that all sets fn have nonempty interior we prove the existence of an x x not contained in any one of the fn s pick an x 1 f 1 this is possible for otherwise we have f 1 x and f 1 contains open balls since f 1 is closed f 1 is open and therefore contains an open ball b x 1 r 1 by shrinking the radius a bit we may even assume that the closed ball b x 1 r 1 is contained in f 1 and moreover that 0 r 1 6 1 the ball b x 1 r 1 is not contained in f 2 and consequently the open set b x 1 r 1 f 2 is nonempty by the same reasoning as before this set contains a closed ball b x 2 r 2 with radius 0 r 2 6 1 2 continuing in this way we obtain a decreasing sequence of closed balls b x 1 r 1 b x 2 r 2 with 0 rn 6 1 n the sequence xn n 1 is a cauchy sequence and therefore has a limit x by the completeness of x it is clear that x n 1 b xn rn and therefore x 6 n 1 fn 5 1 b the uniform boundedness theorem the uniform boundedness theorem infers uniform boundedness of a family of bounded operators from their pointwise boundedness theorem 5 2 uniform boundedness theorem let ti i i be a family of bounded op erators from a banach space x into a normed space y if sup i i tix x x then sup i i ti proof for each i i the sets x x tix 6 n are closed by the continuity of the operator ti since the intersection of closed sets is closed the sets fn x x sup i i tix 6 n i i x x tix 6 n are closed moreover their union equals x by the baire category theorem at least one of them say fn 0 has nonempty interior accordingly there exist x 0 x and r 0 0 such that b x 0 r 0 fn 0 5 1 the uniform boundedness theorem 173 fix an index i i for any x x with norm x r 0 we write x x 0 x 0 x and note that both x 0 and x 0 x belong to b x 0 r 0 as a consequence tix 6 tix 0 ti x 0 x 6 n 0 n 0 2 n 0 hence for all x x with norm x 1 tix 6 2 n 0 r 0 this implies that ti 6 2 n 0 r 0 this being true for all i i we have shown that supi i ti 6 2 n 0 r 0 we continue with some typical applications proposition 5 3 let x and y be banach spaces and suppose that tn x y n 1 are bounded operators such that limn tnx t x exists for all x x then the mapping x 7 t x is linear bounded from x into y and t 6 liminf n tn proof the uniform boundedness theorem implies supn tn and therefore we can apply proposition 1 19 proposition 5 4 boundedness of bilinear mappings let x y z be normed spaces and suppose that at least one of the spaces x and y is a banach space let b x y z be linear and bounded in both variables separately then there exists a constant c 0 such that b x y 6 c x y x x y y in particular b is jointly continuous proof assume that x is a banach space if y is a banach space we interchange the roles of x and y for each y y tyx b x y defines an element of l x z since b is bounded in its first variable also for each x x we have sup y 61 tyx since b is bounded in its second variable since x is a banach space the uniform bound edness theorem shows that ty y 6 1 is uniformly bounded in l x z with m sup y 61 ty we then obtain for all y y with y 6 1 b x y tyx 6 m x by a scaling argument for the second variable this implies the claim as stated the same proof works if we assume that b is linear in the first variable conjugate linear in the second variable and bounded in both variables separately this observation will be useful in the context of hilbert spaces the following proposition and its corollary give an application of the uniform bound edness theorem to duality 174 bounded operators proposition 5 5 weakly bounded sets are bounded a subset s of a banach space x is bounded if and only if it is weakly bounded that is the set s x x x x s is bounded for all x x proof only the if part needs proof suppose that s is weakly bounded its image j s in x under the natural isometric embedding j x x see section 4 7 b is a family of bounded operators from x to k and by assumption these operators are pointwise bounded by the uniform boundedness theorem these operators are uniformly bounded in operator norm this is the same as saying that j s is a bounded subset of x since j is isometric it follows that s is bounded corollary 5 6 let x be a banach space the following assertions hold 1 if limn x x n x x for all x x then x n n 1 is bounded 2 if limn xn x x x for all x x then xn n 1 is bounded proof part 1 follows directly from the uniform boundedness theorem and part 2 is a special case of proposition 5 5 5 2 the open mapping theorem the next main theorem is the open mapping theorem among other things it implies that a bijective bounded operator between banach spaces has a bounded inverse and hence is an isomorphism its proof relies on the following lemma in which we use subscripts to tell apart open balls in x and y lemma 5 7 let x be a banach space y a normed space and let t l x y be a bounded operator if 0 r r are such that by 0 r t bx 0 r then by 0 r t bx 0 2 r as is apparent from the proof the constant 2 may be replaced by 1 for any fixed 0 proof fix an arbitrary y 0 by 0 r then y 0 t bx 0 r so we can write y 0 t x 1 y 1 with x 1 bx 0 r and y 1 12 r then 2 y 1 by 0 r so 2 y 1 t x 2 y 2 with x 2 bx 0 r and y 2 12 r 5 2 the open mapping theorem 175 then 2 y 2 by 0 r so 2 y 2 t x 3 y 3 with x 3 bx 0 r and y 3 12 r continuing this way for all n n we obtain y 0 t x 1 y 1 t x 1 1 2 t x 2 1 2 y 2 t x 1 1 2 t x 2 1 4 t x 3 1 4 y 3 t x 1 1 2 t x 2 1 4 t x 3 1 2 n t xn 1 1 2 n yn 1 clearly limn 1 2 n yn 1 0 and k 0 1 2 k xk 1 k 0 r 2 k 2 r this implies that the sum k 0 1 2 k xk 1 converges in x by the completeness of x the boundedness of t implies that the sum k 0 1 2 k t xk 1 converges in y to t k 0 1 2 k xk 1 and therefore y 0 lim n n k 0 1 2 k t xk 1 1 2 n yn 1 t k 0 1 2 k xk 1 t bx 0 2 r theorem 5 8 open mapping theorem let x and y be banach spaces if t l x y is bounded and surjective then t maps open sets to open sets proof set fn t bx 0 n the surjectivity of t implies that y n 1 fn there fore by the baire category theorem theorem 5 1 some fn 0 has nonempty interior this means that there exist y 0 y and r 0 0 such that by y 0 r 0 t bx 0 n 0 in view of t x t x we then also have by y 0 r 0 t bx 0 n 0 writing y 12 y 0 y 1 2 y 0 y it follows that by 0 r 0 12 t bx 0 n 0 1 2 t bx 0 n 0 t bx 0 n 0 now we can invoke the lemma and find by 0 r 0 t bx 0 2 n 0 let u be an open set in x we wish to prove that t u is open to this end let 176 bounded operators t x t u be given with x u we wish to prove that t u contains the open ball by t x for some 0 since u is open there is an 0 such that bx x u let 2 n 0 then t u contains t x t bx 0 t x t bx 0 2 n 0 and the latter contains the open ball t x by 0 r 0 by t x r 0 corollary 5 9 let x and y be banach spaces if t l x y is bijective then t is an isomorphism proof the fact that t maps open sets to open sets can now be reformulated as saying that t 1 1 u is open for every open set u so t 1 is continuous 5 3 the closed graph theorem let x and y be banach spaces the graph of a mapping t x y is the set g t x t x x x in x y if t is linear g t is a linear subspace of x y endowing x y with the norm x y 1 x y 5 1 turns this space into a banach space and it is easy to check that if t is bounded then g t is closed x y since all product norms on x y are equivalent see example 1 32 the particular choice of product norm made in 5 1 is immaterial definition 5 10 closed operators a linear operator t x y is closed if its graph is closed in x y theorem 5 11 closed graph theorem let x and y be banach spaces if a linear operator t x y is closed then t is bounded proof let x x y x and y x y y be given by x x y x and y x y y both mappings are bounded and of norm one by assumption z g t is a closed subspace of x y hence a banach space with respect to the inherited norm con sider the linear operator s x z given by sx x t x this operator is a bijection whose inverse s 1 is the bounded operator x by corollary 5 9 the inverse s of s 1 is bounded hence also t y s is bounded it was noted in proposition 4 15 that if a subspace x 0 of a normed space x is the range of a projection in x then x 0 is complemented in x as an application of the closed graph theorem we prove the following converse 5 3 the closed graph theorem 177 g t x y ys t figure 5 1 proof of the closed graph theorem proposition 5 12 a closed subspace of a banach space x is complemented if and only if it is the range of a projection in x proof it remains to prove the only if part let x x 0 x 1 be a direct sum decom position and consider the mapping 0 x 0 x 1 7 x 0 0 here we suggestively write x 0 x 1 for the element x 0 x 1 of x to prove its boundedness we shall prove that its graph is closed suppose that xn 0 x n 1 x 0 x 1 and x n 0 0 y 0 y 1 in x then also 0 xn 1 x n 0 x n 1 x n 0 0 x 0 x 1 y 0 y 1 x 0 y 0 x 1 y 1 in x the closedness of x 0 and x 1 in x implies that y 0 y 1 limn xn 0 0 belongs to x 0 and x 0 y 0 x 1 y 1 limn 0 xn 1 belongs to x 1 this forces y 0 x 0 and y 1 0 it follows that y 0 y 1 x 0 0 0 x 0 x 1 this proves that 0 is closed therefore by the closed graph theorem 0 is bounded in view of 20 0 we conclude that 0 is a projection its range equals x 0 as a second application we prove that if we have a direct sum decomposition x x 0 x 1 then the dual space admits a direct sum decomposition which somewhat infor mally stated is given as x x 0 x 1 proposition 5 13 let x be a banach space with direct sum decomposition x x 0 x 1 and associated projections 0 and 1 then x admits the direct sum decomposition x x 0 x 1 where x 0 and x 1 are isometrically identified with the ranges of the adjoint projections 0 and 1 in x by restriction proof the adjoint operators 0 and 1 are projections and accordingly we have the direct sum decomposition x r 0 r 1 we must prove that the restriction mappings 0 x 7 0 x x 0 and 1 x 7 1 x x 1 establish isometric isomorphisms of r 0 and r 1 onto x 0 and x 1 respectively it is clear that the restriction 0 x x 0 defines an element of x 0 and 0 x x 0 x 0 supx 0 x 0 x 0 1 x 0 0 x sup x 0 x 0 x 0 1 0 x 0 x sup x x x 1 0 x x 0 x x 178 bounded operators in the same way we have 1 x x 1 x 1 1 x x 1 this proves that the mappings 0 x 7 0 x x 0 and 1 x 7 1 x x 1 are isometric to prove their surjectivity fix j 0 1 and let x j x j be arbitrary if x x is a hahn banach extension of x j for all x j x j we have x j x j jx j x x j j and therefore x j j x x j as a final application of the closed graph theorem we prove the following variation of proposition 2 26 proposition 5 14 let 1 6 p q 6 satisfy 1 p 1 q 1 let be a measure space which is assumed to be finite if p a measurable function f belongs to lp if and only if f g l 1 for all g lq in that case we have f p sup g q 61 f g d proof the only if part is immediate from ho lder s inequality to prove the if part we may assume that f is not identically 0 using corollary 2 21 the mapping g 7 f g is easily seen to be closed as a mapping from lq to l 1 if gn g in lq and f gn h in l 1 we may pass to a subsequence such that gnk g and f gnk h almost everywhere and therefore f g limn f gn h almost everywhere by the closed graph theorem the operator g 7 f g is bounded it follows that the assumptions of proposition 2 26 are satisfied with m the norm of the operator g 7 f g this gives that g lq with bound f p 6 sup g q 61 f g d ho lder s inequality gives the opposite bound 5 4 the closed range theorem as a warm up for the main result of this section we begin with a simple application of the hahn banach theorem recall that the annihilator of a subset a of x is the set a x x x x 0 for all x a and the pre annihilator of a subset b of x is the set b x x x x 0 for all x b proposition 5 15 for any operator t l x y where x and y are banach spaces we have r t n t in particular t has dense range if and only if t is injective 5 4 the closed range theorem 179 proof if y t x r t then for all y n t we have y y x t y 0 and therefore y n t this proves r t n t the result now follows from the fact that n t is closed if x 0 6 r t y 0 by corollary 4 12 there exists a y y such that x 0 y 6 0 and y y 0 0 for all x x x t y t x y 0 and therefore y n t since x 0 y 6 0 we have x 0 6 n t in sections 7 2 and 7 3 we will encounter interesting classes of operators whose ranges are closed for such operators the closed range theorem provides a dual variant of proposition 5 15 which is considerably harder to prove we need this theorem in our discussion of duality of fredholm operators in section 7 3 theorem 5 16 closed range theorem let the operator t l x y be given where x and y are banach spaces if r t is closed then r t n t as a consequence r t is weak closed proof once we have proved the identity r t n t the weak closedness of r t follows from the general observation that annihilators are weak closed if x t y r t then for all x n t and we have x x t x y 0 this shows that x n t suppose that x n t for elements y t x r t we define y x x to see that this is well defined suppose that we also have y t x then t x x y y 0 implies x x n t and therefore x x x 0 this gives the well definedness as claimed for all z n t we have y x z x and therefore y 6 x z x by taking the infimum over all z n t we obtain y 6 d x n t x we claim that the closedness of the range of t implies the existence of a constant c 0 such that d x n t 6 c t x 5 2 taking this for granted for the moment we first show how to complete the proof from 5 2 we obtain the estimate y 6 c t x x c y x 180 bounded operators proving that is bounded as a functional defined on r t by the hahn banach theo rem we obtain an element y y extending for all x x we obtain x t y t x y t x x x so x t y r t it remains to prove 5 2 for this we note that d x n t x n t x n t 5 3 the operator t induces a well defined and bounded quotient operator t from x n t onto r t by setting t x n t t x it is clear that t is injective and surjective and since r t is closed we may apply the open mapping theorem and obtain that t maps x n t isomorphically onto r t denoting by c the norm of its inverse we obtain the desired estimate from 5 3 and x n t x n t 6 c t x n t c t x this completes the proof of 5 2 5 5 the fourier transform in the present section and the next we study two nontrivial examples of bounded op erators the fourier plancherel transform and the hilbert transform it is not an exag geration to state that at least from the point of view of the theory of partial differential equations these rank among the most important bounded operators in all of analysis 5 5 a definition and general properties definition 5 17 fourier transform the fourier transform of a function f l 1 rd is the function f rd c defined by f 1 2 d 2 rd f x exp ix dx rd 5 4 where x dj 1 x j j it is evident that f l rd and f 6 2 d 2 f 1 this shows that the oper ator f f 7 f which will be referred to as the fourier transform defines a bounded operator from l 1 rd to l rd remark 5 18 in certain situations it is useful to absorb the constant 2 d 2 into the measure denoting the resulting normalised lebesgue measure by dm x 2 d 2 dx 5 5 the fourier transform 181 one may interpret the fourier transform as the operator from l 1 rd m l rd m given by f rd f x exp ix dm x rd the advantage of this point of view is that this operator is contractive in many applica tions however working with the normalised lebesgue measure is somewhat artificial and for this reason we stick with 5 4 most of the time the dominated convergence theorem implies that for all f l 1 rd the function f is sequentially continuous hence continuous more is true the following lemma shows that f belongs to c 0 rd the space of continuous functions vanishing at infinity theorem 5 19 riemann lebesgue lemma for all f l 1 rd we have f c 0 rd proof by separation of variables one sees that lim f 0 for step functions f ni 1 ci 1 qi where n 1 ci c and qi cubes with sides parallel to the coordinate axes 16 i 6 n indeed if q dj 1 a j b j is such a cube then f 1 2 d 2 rd d j 1 1 a j b j exp ix j j dx 1 2 d 2 i d j 1 1 j exp ia j j exp ib j j 1 2 d 2 i d j 1 exp ib j j exp i b j a j j 1 j if r then at least one coordinate satisfies j 0 r d and then f 6 1 2 d 2 2 d r j 6 j 0 m j where the constants m j sup y r 0 exp i b j a j y 1 y are finite this proves that f c 0 rd as claimed since the functions of the form considered above are dense in l 1 rd by the proof of proposition 2 29 and since c 0 rd is a closed subspace of l rd by proposi tion 1 18 the fourier transform extends uniquely to a bounded operator from l 1 rd to c 0 rd identifying c 0 rd with a closed subspace of l rd this extension agrees with the fourier transform 182 bounded operators we continue with an inversion theorem for the fourier transform its proof is based on a simple lemma lemma 5 20 for 0 the fourier transform of the gaussian density g x 1 2 d 2 exp 1 2 x 2 equals g 1 2 d 2 exp 1 2 2 proof first let d 1 completing squares and using cauchy s theorem to shift the path of integration we find 1 2 1 2 r g exp ix x dx 1 2 r exp 1 2 x i 2 2 2 dx 1 2 exp 1 2 2 r i exp 1 2 z 2 dz 1 2 exp 1 2 2 r exp 1 2 z 2 dz 1 2 1 2 exp 1 2 2 the general case follows from this by separation of variables a different proof based on the picard lindelo f theorem is outlined in problem 5 19 theorem 5 21 fourier inversion theorem if f l 1 rd satisfies f l 1 rd then for almost all x rd we have the identity f x 1 2 d 2 rd f exp ix d in particular this result implies that the fourier transform is injective as a mapping from l 1 rd to l rd a more general injectivity result will be proved in theorem 5 31 proof by lemma 5 20 the gaussian function g x 2 d 2 exp 12 x 2 satisfies g x g x 1 2 d 2 rd g exp ix d 1 2 d 2 rd g exp ix d where the last identity uses that g is real valued so that taking complex conjugates leaves the expression unchanged substituting x for x we obtain g x dg 1 x 1 2 d 2 rd g exp ix d 5 5 the fourier transform 183 by proposition 2 34 and corollary 2 21 after passing to an appropriate subsequence j 0 we have g j f x f x for almost all x r d as j using the above it follows that for almost all x rd we have f x lim j 0 rd g j y f x y dy lim j 0 rd 1 2 d 2 rd g j exp iy d f x y dy lim j 0 rd exp ix 1 2 d 2 rd f x y exp i x y dy g j d lim j 0 1 2 d 2 rd g j exp ix f d 1 2 d 2 rd f exp ix d where the last step is justified by dominated convergence which can be used here since f is integrable g is bounded and g j g 0 1 pointwise as j the fourier transform of the translate h f of a function f l 1 r is given by h f 1 2 f x h exp ix dx exp ih f it follows that if f 0 0 for some 0 r then h f 0 0 for all h r therefore the linear span of the set of translates of f is contained in g l 1 r g 0 0 which is a proper closed subspace of l 1 r thus a necessary condition in order that the linear span of the set of translates of a function f l 1 r be dense in l 1 r is that f be zero free strikingly this necessary condition is also sufficient this is the content of the next theorem which will be proved by operator theoretic methods in section 13 1 b theorem 5 22 wiener s tauberian theorem if the fourier transform of a function f l 1 r is zero free then the span of the set of all translates of f is dense in l 1 r 5 5 b the plancherel theorem the fourier transform enjoys an important l 2 boundedness property theorem 5 23 plancherel preliminary version if f l 1 rd l 2 rd then f l 2 rd and f 2 f 2 proof since f l 1 rd f is bounded and 7 exp 12 2 f 2 is integrable 184 bounded operators for all 0 and rd exp 1 2 2 f 2 d rd exp 1 2 2 f f d 1 2 d 2 rd g rd f x exp ix dx rd f y exp iy dyd rd rd 1 2 d 2 rd g exp i x y d f x f y dxdy rd rd 1 2 d 2 exp 1 2 x y 2 f x f y dxdy rd f y f y dy where x d 1 x with y 2 d 2 exp 12 y 2 the change of order of integration is justified by the absolute integrability of the integrand applying propo sition 2 34 we find that lim 0 f f in l 2 rd then lim 0 rd f y f y dy rd f y f y dy f 22 on the other hand lim 0 rd exp 1 2 2 f 2 d rd f 2 d f 22 by dominated convergence this completes the proof it is of some interest to consider the vector space f 2 rd f l 1 rd l 2 rd f l 1 rd l 2 rd there is some redundancy in this definition for if f l 1 rd l 2 rd then f l 2 rd by the plancherel theorem the advantage of the above format is that it brings out the symmetry between f and f explicitly the interest of this class is explained by the following two observations lemma 5 24 the fourier transform maps f 2 rd bijectively into itself proof injectivity of f 7 f follows from the plancherel theorem and surjectivity from the fourier inversion theorem which implies if f f 2 rd then f the fourier trans form of the function 7 f in f 2 rd lemma 5 25 f 2 rd is dense in l 2 rd 5 5 the fourier transform 185 proof since c c r d is dense in l 2 rd by proposition 2 29 it suffices to show that every f c c rd belongs to f 2 rd integrating by parts for all f c c rd and multi indices nd we have f i f where 11 d d with j the partial derivative in the jth direction 1 1 d d and 1 d since fourier transforms of integrable functions are bounded this implies that 7 1 k f is bounded for every integer k 1 the desired result follows from this combining these lemmas with proposition 1 18 we obtain the following improved version of theorem 5 23 theorem 5 26 plancherel the restriction of the fourier transform to l 1 rd l 2 rd has a unique extension to an isometry from l 2 rd onto itself definition 5 27 fourier plancherel transform this isometry of l 2 rd is called the fourier plancherel transform with slight abuse of notation we denote the fourier plancherel transform again by f f 7 f it is important to realise that f is no longer given by the pointwise formula 5 4 in fact for functions f l 2 rd the integrand in 5 4 is not even integrable unless f l 1 rd l 2 rd remark 5 28 theorem 5 26 also holds with respect to the normalised lebesgue mea sure dm x 2 d 2 dx the restriction to l 1 rd m l 2 rd m of the fourier trans form as defined in remark 5 18 extends to an isometry from l 2 rd m onto itself for later use we record two further properties of the fourier plancherel transform proposition 5 29 for all f g l 2 rd we have rd f x g x dx rd f x g x dx proof for f g f 2 rd the identity follows by writing out the fourier transforms and using fubini s theorem rd f x g x dx rd 1 2 d 2 rd f x g exp ix d dx rd 1 2 d 2 rd f x g exp ix dxd rd f g d the general case follows by approximation using that f 2 rd is dense in l 2 rd by lemma 5 25 186 bounded operators the appearance of the factor 2 d 2 in the next proposition is an artefact of our convention to normalise the fourier transform with this factor but not the convolution proposition 5 30 let f l 1 rd and let g l 1 rd or g l 2 rd for almost all rd we have f g 2 d 2 f g proof if g cc rd then f g l 1 rd l 2 rd by young s inequality and by fubini s theorem and a change of variables we obtain f g 1 2 d 2 rd rd f x y g y dy exp ix dx rd 1 2 d 2 rd f x y exp i x y dx exp iy g y dy rd 1 2 d 2 rd f u exp iu du g y exp iy dy 2 d 2 f g this proves the identity for g cc rd for p 1 2 and 1 p 1 q 1 young s inequality implies that the lq function f g depends continuously on the lp norm of g since cc rd is dense in lp rd by proposition 2 29 it follows that the identity extends to arbitrary functions g lp rd from proposition 2 43 we know that if is a real or complex measure its variation is a finite measure accordingly the lebesgue integrals of bounded borel functions with respect to are well defined in particular we can define the fourier transform of a real or complex borel measure on rd by 1 2 d 2 rd exp ix d x rd from 6 1 2 d 2 rd d 1 2 d 2 where rd is the variation norm of we see that is a bounded function and it is continuous by dominated convergence thus we have cb rd and 6 2 d 2 the riemann lebesgue lemma does not extend to the present setting as is demonstrated by the identity 0 1 the fourier inversion theorem theorem 5 21 implies that the fourier transform is injective as an operator from l 1 rd to l rd more generally we have the following result 5 5 the fourier transform 187 theorem 5 31 injectivity of the fourier transform if is a real or complex borel measure on rd satisfying 0 for all rd then 0 proof to prove that 0 it suffices to show that rd f d 0 f cc rd 5 5 indeed approximating the indicator function of an open rectangle r in rd from below by functions in cc rd and using dominated convergence which can be justified by decomposing the real and imaginary parts of into their positive and negative parts using the jordan decomposition theorem 2 45 it then follows that r 0 for all such rectangles r whereupon dynkin s lemma lemma e 4 implies that 0 turning to the proof of 5 5 fix 0 1 and f cc rd we may assume that f 6 1 let r 0 be so large that the support of f is contained in a cube r r d satis fying r r d 6 by the stone weierstrass theorem theorem 2 5 there exists a linear combination p rd c of the functions of the form x 7 exp 2 ikx 2 r with rd and k z that is a trigonometric polynomial of period 2 r such that supx r r d f x p x 6 then noting that p 6 1 rd f d 6 r r d f d 0 r r d f d 6 r r d f p d r r d pd 6 rd pd r r d pd 6 rd pd 0 1 1 the equality in the last step follows from the assumption that vanishes as it implies rd pd 0 since 0 was arbitrary this proves 5 5 for later reference we mention that this theorem also admits a discrete version the proof of which is an even more direct application of the stone weierstrass theorem see problem 5 17 the fourier coefficients of a real or complex borel measure on the unit circle t are defined by n 1 2 exp in d n z theorem 5 32 injectivity of the fourier transform on the circle if is a real or complex borel measure on t satisfying n 0 for all n z then 0 188 bounded operators if is real valued it suffices to have n 0 for all n n for then n n implies that n 0 for all n z 5 5 c fourier multiplier operators the plancherel theorem provides a method for constructing nontrivial bounded opera tors on l 2 rd as follows given m l rd and f l 2 rd the function m f 7 m f belongs to l 2 rd and therefore the same is true for its inverse fourier plancherel trans form m f definition 5 33 fourier multiplier operators for functions m l rd the bounded operator on l 2 rd defined by tm f 7 m f is called the fourier multiplier operator with symbol m the operator tm is bounded of norm tm g 7 mg l l 2 rd m cf exam ple 1 29 we have the elementary properties tm 1 m 2 tm 1 tm 2 tm 1 m 2 tm 1 tm 2 fourier multipliers can be characterised by commutation properties this fact de pends on the following lemma lemma 5 34 let f be a measure space and let 1 6 p 6 for a bounded operator t on lp the following assertions are equivalent 1 t is a pointwise multiplier that is there exists a function m l such that t f m f for all f lp 2 t commutes with all pointwise multipliers that is t m m t for all l here m f f if rd with lebesgue measure and 16 p then 1 and 2 are equivalent to 3 t me me t for all rd where e x exp ix for x rd proof it is trivial that 1 implies 2 if conversely t commutes with every pointwise multiplier then for all f lp l we have t f t f 1 t m f 1 m f t 1 f t 1 mt 1 f hence for all f lp l we have mt 1 f p t f p 6 t f p 5 5 the fourier transform 189 since lp l is dense in lp this implies that pointwise multiplication by t 1 extends to a bounded operator on lp this forces t 1 l see the observation at the end of section 2 3 a setting m t 1 we obtain t mm this proves that 2 implies 1 now suppose that rd with lebesgue measure it is trivial that 2 implies 3 suppose now that 3 holds with 1 6 p fix 0 and f lp rd and choose r 0 so large that fr f p where fr f r r d if p is a linear combination of 2 r periodic trigonometric exponentials 3 implies t p fr pt fr by the stone weierstrass theorem every c r r d can be uniformly approxi mated by linear combinations pn of such trigonometric exponentials applying the pre ceding identity to pn and taking limits in lp rd we find that t fr t fr c r r d if cb rd this implies that t r fr rt fr as r we have r fr f and rt fr t f in lp rd and therefore t f t f cb rd finally if l rd we can find a sequence of functions n cb rd converging to pointwise almost everywhere and such that supn 1 n since nt f t f and n f f in lp rd we conclude that t f t f l rd this proves that 2 holds as an application we have the following characterisation of translation invariant op erators on l 2 rd theorem 5 35 translation invariant operators on l 2 rd if t is a bounded op erator on l 2 rd commuting with every translation then t is a fourier multiplier operator that is there exists a necessarily unique function m l rd such that t f f 1 mf f for all f l 2 rd proof using the notation of lemma 5 34 and letting y f x f x y easy calcula tions show that me f f and f 1 f 1 me for all rd these identities imply that the operator t ftf 1 has the property me t t me for all rd and the lemma implies that t is a pointwise multiplier this means that t is a fourier multiplier 190 bounded operators 5 6 the hilbert transform a case of special interest concerns the multiplier m isign r in order to obtain an explicit representation for the fourier multiplier operator tm we observe that m i 1 r 1 r and consider the functions n a exp a 1 r a 0 then n a x 1 2 0 exp a exp ix d 1 2 1 a ix and n a x 1 2 0 exp a exp ix d 1 2 1 a ix formally letting a 0 in view of proposition 5 30 one expects that t isign f i lim a 0 tn a f tn a f i 2 lim a 0 n a f n a f i 2 lim a 0 1 a i 1 a i f 1 f in view of proposition 5 30 this suggests the formula t isign f x 1 f x y y dy the above argument is nonrigorous and the convolution with the nonintegrable function 1 x is not even well defined as an operator acting on l 2 r the next theorem turns the above formal derivation into a rigorous argument theorem 5 36 hilbert transform as a fourier multiplier operator the fourier multi plier operator h t isign is given by h f lim 0 1 y f y y dy f l 2 r the convergence being in the sense of l 2 r proof setting h f 1 y f y y dy 5 6 the hilbert transform 191 we see that h is the operator of convolution with the integrable function x 1 x 1 x x the fourier transform of this function can be rewritten as 1 2 x 1 x exp ix dx 1 2 sign lim r i r i r exp z dz z i 2 sign lim r 3 2 1 2 exp rei exp ei d where the last step used cauchy s theorem applied to the boundary of the part of the annulus z r in the left half plane now 32 1 2 exp rei d 6 32 1 2 exp rcos d 2 1 2 0 exp rsin d 6 2 1 2 0 exp 2 r d 1 exp r r where we used that sin 2 for 0 12 as the expression on the right hand side tends to 0 as r we find i 2 sign 3 2 1 2 exp ei d as 0 the integral on the right hand side tends to for every r hence by dominated convergence lim 0 i 2 sign 2 2 r 1 3 2 1 2 exp ei d 1 2 d 0 as a result by using proposition 5 30 we obtain lim 0 h f 2 lim 0 f isign f with convergence in l 2 r therefore by the plancherel theorem and the definition of h lim 0 h f isign f h f with convergence in l 2 r definition 5 37 hilbert transform the operator h t isign is called the hilbert transform 192 bounded operators the hilbert transform has deep applications in harmonic analysis and the theory of partial differential equations it will resurface in our treatment of the poisson semigroup in chapter 13 its connection with harmonic functions is pointed out in problem 5 22 the final theorem of this section gives a characterisation of the hilbert transform in terms of commutation properties a dilation on l 2 rd is an operator of the form d f x f x x r d where 0 theorem 5 38 characterisation of the hilbert transform if t is a bounded operator on l 2 r commuting with every translation and dilation then t is a linear combination of the identity operator and the hilbert transform proof theorem 5 35 tells us that t is a fourier multiplier operator say t tm with m l r for 0 simple calculations give tmd f x td m f x and d tm f x tm f x for almost all x r it follows that tmd d tm if and only if td m tm that is if and only if m m for almost all r this is true for all 0 if and only if m is constant almost everywhere on both r and r hence m a 1 bsign for suitable a b c the result now follows from theorem 5 36 5 7 interpolation in general it can be difficult to establish lp boundedness of operators acting in spaces of measurable functions in such situations interpolation theorems may be helpful they serve to establish lp boundedness in situations where suitable boundedness properties can be established for endpoint exponents p 0 and p 1 satisfying p 0 6 p 6 p 1 in typical applications one takes p 0 1 2 and p 1 2 cf sections 5 7 b and 5 7 c 5 7 a the riesz thorin interpolation theorem theorem 5 39 riesz thorin interpolation theorem let f and f be measure spaces and let 16 p 0 p 1 q 0 q 1 6 let t 0 l p 0 lq 0 t 1 lp 1 lq 1 5 7 interpolation 193 be bounded operators which are consistent in the sense that t f t 0 f t 1 f almost surely for all f lp 0 lp 1 assume furthermore that t 0 f lq 0 6 a 0 f lp 0 f l p 0 t 1 f lq 1 6 a 1 f lp 1 f l p 1 let 0 1 and set 1 p 1 p 0 p 1 1 q 1 q 0 q 1 then the common restriction t of t 0 and t 1 to lp 0 lp 1 maps this space into lq and extends uniquely to a bounded operator t lp lq satisfying t f lq 6 a 1 0 a 1 f lp f l p we begin with a simple lemma which corresponds to the special case where the interpolated operator is the identity operator lemma 5 40 let f be a measure space let 1 6 r 0 6 r 1 6 and 0 1 and set 1 r 1 r 0 r 1 then for all f lr 0 lr 1 we have f lr f r 6 f 1 r 0 f r 1 proof write f r f 1 r f r and apply ho lder s inequality consider the open strip s z c 0 rez 1 lemma 5 41 three lines lemma suppose that f s c is a bounded continuous function holomorphic on s satisfying sup v r f iv 6 a 0 sup v r f 1 iv 6 a 1 then f is uniformly bounded on s and for all 0 1 we have sup v r f iv 6 a 1 0 a 1 proof let f satisfy the assumptions of the lemma with constants a 0 and a 1 for each 0 the function f z a z 1 0 a z 1 exp z z 1 f z satisfies the assumptions of the lemma with constants a 0 a 1 1 moreover limv f u iv 0 uniformly with respect to u 0 1 hence for large enough r we have f 6 1 on the boundary of the rectangle rez 0 1 imz 6 r the maximum modulus principle implies that 194 bounded operators f 6 1 on this rectangle and by letting r we find that f 6 1 on s the lemma now follows by letting 0 inspection of the proof reveals that the boundedness assumption on f can be relaxed it cannot be entirely dispensed with however the function f z exp exp z 1 is bounded on the lines rez 0 and rez 1 but unbounded on the line rez 12 proof of theorem 5 39 there is no loss of generality in assuming that a 0 0 and a 1 0 if p 0 p 1 then for all f l we have t f lq 0 lq 1 and therefore by lemma 5 40 t f q 6 t f 1 q 0 t f q 1 6 a 1 0 a 1 f 1 f a 1 0 a 1 f this settles that case p 0 p 1 in the rest of the proof we may therefore assume that min p 0 p 1 this assumption implies p for z s define pz qz c by the relations 1 pz 1 z p 0 z p 1 1 q z 1 z q 0 z q 1 where q 0 q 1 and qz are the conjugate exponents of q 0 q 1 and qz respectively let a c and b c be and simple functions and define for each z s the and simple functions fz lp 0 lp 1 and gz lq 0 lq 1 by fz 1 a 6 0 a p pz a a gz 1 b 6 0 b q q z b b 5 6 then t fz lq 0 lq 1 and the function f s c defined by f z t fz gz d is easily checked to be bounded and continuous on s holomorphic on s and for all v r we have f iv 6 a 0 fiv p 0 giv q 0 6 a 0 a p p 0 p b q q 0 q and similarly f 1 iv 6 a 1 a p p 1 p b q q 1 q hence by 5 6 and the three lines lemma lemma 5 41 ta bd f 6 a 1 0 a 1 a 1 p p 0 p b 1 q q 0 q a p p 1 p b q q 1 q a 1 0 a 1 a p b q taking the supremum over all simple functions b lq of norm at most one by 5 7 interpolation 195 ho lder s inequality and propositions 2 26 and 2 28 here we use the assumption p we obtain ta q 6 a 1 0 a 1 a p since the simple functions are dense in lp this proves that the restriction of t to the simple functions has a unique extension to a bounded operator t from lp into lq of norm at most a 1 0 a 1 it remains to be checked that t f t f for all f lp to this end we may assume p 0 6 p 1 selecting y 0 such that f y 0 and replacing f by y 1 f we may assume that f 1 0 write f 1 f 1 f 1 f 61 f f 0 f 1 and observe that f j lp j j 0 1 if fn f in lp with each fn simple then with obvious notation f jn f j in lp j and therefore t f j limn t f j n limn t f j n t f j in lq j as a consequence t f t f 0 t f 1 t f 0 t f 1 t f up to this point we have implicitly assumed that the scalar field is complex suppose now that the scalar field is real we may extend a bounded operator t lp lq to a bounded operator tc lp c lq c by setting tc u iv tu it v for real valued u v lp the triangle inequality implies the trivial bounds t 6 tc 6 2 t if t is a positivity preserving operator that is f 0 implies t f 0 then the identity a ib sup 0 2 acos bsin for a proof rotate the point a b r 2 to the positive x axis together with the in equality t g 6 t g for real valued g lp which follows from 2 21 implies the pointwise bound tc f tu it v sup 0 2 tu cos t v sin 6 sup 0 2 t ucos t vsin 6 t u iv t f this implies the norm bound tc 6 t and hence equality tc t with some additional work this equality can be extended to arbitrary bounded operators t and exponents 16 p 6 q by duality and the fact that tc t c this equality 196 bounded operators also holds for exponents 1 q 6 p the proof is based on the observation that for all z a bi c and 16 q we have z 1 q e a 1 b 2 q 1 q 5 7 where 1 2 are real valued standard gaussian random variables defined on some probability space with 1 and 2 independent and e denotes the expectation indeed if z 1 then a 1 b 2 is another standard gaussian random variable and e a 1 b 2 q 1 q 1 q the general case follows from this by scaling assuming 16 p 6 q from 5 7 in combination with fubini s theorem we obtain qq tc u iv q lq c e q tu it v q d e 1 tu 2 t v q d 1 tu 2 t v q lq lq t 1 u 2 v q lq lq 6 t q 1 u 2 v q lq lp 6 t q 1 u 2 v q lp lq qq t q u iv qlp c in the penultimate step we used the continuous version of ho lder s inequality problem 2 29 the riesz thorin theorem may now be extended to the case of real scalars and exponents 1 6 p 6 q as follows suppose that the assumptions of the theorem are satisfied except that all spaces are real apply the riesz thorin theorem to the complexified operators s 0 t 0 c and s 1 t 1 c we obtain bounded operators s from lp c to lq c of norm at most a 1 0 a 1 this operator maps functions in lp 0 lp 1 to functions in lq since lp 0 lp 1 is dense in lp by approximation it follows that s maps real valued functions in lp to real valued functions in lq stated differently s restricts to a bounded operator denoted t from lp to lq of norm at most a 1 0 a 1 on l p 0 lp 1 t coincides with the common restriction of t 0 and t 1 informally stated this discussion shows that the riesz thorin theorem extends with the same constant to the case of real scalars if we assume t to be positivity preserving or the exponents satisfy either 1 p j q j or 1 p j 6 q j for j 0 1 5 7 b the hausdorff young theorem this brief section and the next are devoted to some applications of the riesz thorin theorem as we have seen in section 5 5 the fourier transform is bounded from l 1 rd to l rd and its restriction to l 1 rd l 2 rd extends to an isometry from l 2 rd onto 5 7 interpolation 197 itself the fourier transform with respect to the normalised lebesgue measure dm x 2 d 2 dx defined in remark 5 18 is contractive from l 1 rd m to l rd m and its restriction to l 1 rd m l 2 rd m extends to an isometry from l 2 rd m onto itself by remark 5 28 accordingly the riesz thorin theorem implies theorem 5 42 hausdorff young let 1 6 p 6 2 and 1 p 1 q 1 the restriction to l 1 rd l 2 rd of the fourier transform has a unique extension to a bounded operator from lp rd to lq rd with respect to the normalised lebesgue measure the fourier transform has a unique extension to a contraction from lp rd m to lq rd m a similar result holds for the fourier transform on the circle see problem 5 27 5 7 c lp boundedness of the hilbert transform a second application of the riesz thorin theorem is the following theorem due to m riesz about lp boundedness of the hilbert transform theorem 5 43 riesz for all 1 p the restriction of the hilbert transform to l 2 r lp r has a unique extension to a bounded operator on lp r the proof of theorem 5 43 is based on a couple of lemmas lemma 5 44 if f c 1 c r then h f lp r for all 26 p 6 proof let i be a bounded interval containing the support of f the pointwise identity h f x 1 f x y f x y y dy 1 1 i x i x y f x y f x y y dy x r implies the bound h f x 6 1 2 i 2 f x r 5 8 as 0 we have h f h f in l 2 r by theorem 5 36 and upon passing to an almost everywhere convergent subsequence 5 8 implies that h f l r this gives the result lemma 5 45 the hilbert transform of a real valued function u l 2 r is the unique real valued function v l 2 r such that the fourier plancherel transform of u iv vanishes on r 198 bounded operators proof that the fourier transform of u ihu vanishes on r is immediate from theo rem 5 36 in the converse direction let u v l 2 r be real valued such that the fourier plancherel transform of u iv vanishes then for almost all 0 we have 0 u iv u iv u iv so v iu and v iu hence for almost all r v isign u by theorem 5 36 this proves that v hu in the next lemma we use that if c 2 c r then 2 is bounded and therefore is integrable lemma 5 46 cotlar let h be the hilbert transform on l 2 r for all real valued u c 2 c r we have hu 2 u 2 2 h uhu proof let u v c 2 c r be real valued functions by theorem 5 36 the fourier trans forms of u ihu and v ihv are integrable and vanish on r and by proposition 5 30 the same is true for the fourier transform of u hv hu v i hu hv u v i u ihu v ihv by lemma 5 45 this implies hu hv u v h u hv hu v cotlar s identity follows by taking u v proof of theorem 5 43 the proof consists of three steps first we prove the theorem for exponents p 2 n with n n by cotlar s identity then for 2 p by interpolation and finally for 1 p 2 by duality step 1 in this step we show that if h is lp bounded for some 26 p then h is l 2 p bounded the proof also gives a bound for h 2 p in terms of h p in what follows we set h p cp let u c 2 c r be real valued then hu l 2 p r by lemma 5 44 by cotlar s iden tity and ho lder s inequality hu 2 p 6 u 2 p 2 h p uhu p 6 u 2 p 2 cp u 2 p hu 2 p using the identity v 2 p v 22 p this gives hu 22 p 6 u 2 2 p 2 cp u 2 p hu 2 p 5 7 interpolation 199 or equivalently hu 2 p cp u 2 p 2 6 1 c 2 p u 2 2 p it follows that hu 2 p cp u 2 p 6 1 c 2 p u 2 p and hence hu 2 p 6 cp 1 c 2 p u 2 p by considering real and imaginary parts separately at the expense of an additional con stant 2 this inequality extends to arbitrary u c 2 c r since c 2 c r is dense in lp r it follows that the restriction of h to c 2 c r uniquely extends to a bounded operator on lp r obviously this operator extends the restriction of h to l 2 r lp r step 2 since h is l 2 bounded step 1 implies that h is l 2 n bounded for all n n the riesz thorin theorem then implies that h is lp bounded for all 26 p step 3 finally suppose that 1 p 2 and let 1 p 1 q 2 for f g c 2 c r one easily checks that r h f gdx r f hgdx and consequently r h f gdx 6 f p hg q 6 cq f p g q where cq h q since c 2 c r is dense in lq r by proposition 2 29 proposition 2 26 implies that h f lp r and h f p 6 cq f q this proves that h is lp bounded with h p 6 cq in fact we have equality here since we can also apply this argument in the opposite direction 5 7 d the marcinkiewicz interpolation theorem in this final section we prove another lp interpolation theorem the marcinkiewicz inter polation theorem it has the virtue of requiring less stringent conditions at the endpoints and the operator to be interpolated does not even need to be linear on the downside the constant obtained from the proof is rather poor the theorem elaborates on the observa tion made after the proof of the hardy littlewood maximal theorem that the proof of the lp bound essentially only depended on the weak l 1 bound by lp 0 lp 1 rd we denote the vector space of all f l 1 loc r d that admit a de composition f f 0 f 1 with f 0 lp 0 rd and f 1 lp 1 rd 200 bounded operators theorem 5 47 marcinkiewicz interpolation theorem let 1 6 p 0 p p 1 6 and suppose that t lp 0 lp 1 rd lp 0 lp 1 rd is a subadditive mapping in the sense that for all f lp 0 and g lp 1 rd we have t f g 6 t f t g almost everywhere suppose furthermore that for j 1 2 there are constants cd p j 0 depending only on d and p j such that t f t 6 cd p j t p j f p jp j f l p j rd if 1 p 1 if p 1 we replace the assumption regarding p 1 by t f 6 cd f f l rd then t maps lp rd into lp rd and t f p 6 cd p f p f lp rd where cd p is a constant independent of f a weak lq bound holds if t is lq bounded in the sense that t f q 6 cd q f q for all f lq rd proof we give the proof for 1 p 1 the case p 1 proceeds along the lines of theorem 2 38 requiring small changes that are left to the reader fixing t 0 we split f f 0 f 1 with f 0 lp 0 rd and f 1 lp 1 rd by taking f 0 1 f t 2 f f 1 1 f t 2 f from the subadditivity of t we obtain t f t t f 0 t 2 t f 1 t 2 and therefore t f t 6 t f 0 t 2 t f 1 t 2 combining the assumptions with fubini s theorem and proceeding as in the proof of theorem 2 38 after some computations we arrive at rd t f x p dx p 0 t p 1 t f t dt 6 p 0 t p 1 cd p 0 t 2 p 0 f t 2 f x p 0 dx dt p 0 t p 1 cd p 1 t 2 p 1 f t 2 f x p 1 dx dt problems 201 6 cpd p rd f x p dx where cpd p 2 p p cp 0 d p 0 p p 0 c p 1 d p 1 p 1 p problems 5 1 let xn n 1 be a sequence in a banach space x with dense linear span using baire s theorem prove that this linear span equals x if and only if dimx 5 2 using the baire category theorem prove that there exists no norm on l 1 loc r d that turns this space into a banach lattice hint use theorem 2 57 5 3 this problem outlines a proof of the uniform boundedness theorem that does not appeal to the baire category theorem suppose that ti i i is an operator family such that i supi i tix cx for all x x ii supi i ti for n 1 2 choose indices in i and vectors xn x such that 1 4 3 n tin n 1 m 1 cxm n xn 6 1 3 n tinxn 3 4 3 n tin let x n 1 xn by writing tnx n 1 m 1 tinxm tinxn m n 1 tinxm and estimating these terms prove that tinxn n for all n 1 this contradiction proves the result 5 4 let x be the linear span of the standard basis vectors of 2 and let pn 2 k denote the orthogonal projection onto the nth coordinate show that npnx 0 for all x x and npn n conclude that the completeness assumption cannot be omitted from the uniform boundedness theorem 5 5 the aim of this problem is to prove that a weakly holomorphic function is holo morphic let us start with the definitions of these notions we fix an open set d c and a complex banach space x a function f d x is said to be holomorphic if for all z 0 d the limit lim z z 0 f z f z 0 z z 0 exists in x see problem 4 2 202 bounded operators weakly holomorphic if for all z 0 d and x x the limit lim z z 0 f z f z 0 z z 0 x exists in c obviously every holomorphic function f d x is weakly holomorphic now let f d x be weakly holomorphic fix z 0 d and let r 0 be so small that the closed disc z c z z 0 6 r is contained in d a applying proposition 5 5 to the set u 1 h g f z 0 h f z 0 h f z 0 g f z 0 g g h r 2 and using the cauchy integral formula for x valued holomorphic functions see problem 4 2 prove that there is a constant m 0 such that for all g h r 2 we have f z 0 h f z 0 h f z 0 g f z 0 g 6 m h g b deduce that every weakly holomorphic function f d x is holomorphic 5 6 state and prove an analogue of proposition 5 5 for the weak topology 5 7 using the open mapping theorem show that there exists no complete norm on c 0 1 with the property that fn f 0 fn f pointwise 5 8 a sequence xn n 2 in x is called a schauder basis if for every x x admits a unique representation as a convergent sum x n 1 cnxn with cn k for all n 1 let xn n 1 be schauder basis in x and let y be the vector space of all scalar sequences c cn n 1 such that the sum n 1 cnxn converges in x a show that c y sup n 1 n n 1 cnxn defines a norm on y and that y is a banach space with respect to this norm b show that c 7 n 1 cnxn is an isomorphism from y onto x c conclude that the coordinate projections pk n 1 cnxn 7 ck are bounded and that supk 1 pk problems 203 5 9 for f l 1 and n n define the functions sn f t n n n f n exp int t where f n is the nth fourier coefficient of f that is f n 1 2 f s exp ins ds n z by the results of section 3 5 a for all f l 2 we have f lim n sn f n z f n exp in with convergence in l 2 the series on the right hand side is the fourier series of f one might express the hope that if f c is periodic then its fourier series converges to f with respect to the norm of c the aim of this problem is to prove that this is wrong in a strong sense there exists a periodic function f c which is periodic in the sense that f f and whose fourier series diverges at t 0 a show that sn f t 1 2 f s dn t s ds where the dirichlet kernel is given by dn t n n n exp int sin n 12 t sin 1 2 t b show that n dn 1 where the linear map n cper c is given by n f sn f 0 hint to prove the inequality n dn 1 approximate sign dn point wise almost everywhere by a sequence of continuous periodic functions fn of norm 6 1 set gn t fn t and use dominated convergence to obtain lim n n gn lim n 1 2 fn t dn t dt 1 2 dn t dt fill in the missing details c show that limn dn 1 hint use that sin x 6 x for all x r and then perform some careful estimates on the resulting integral d apply the uniform boundedness theorem to prove that sn f 0 6 f 0 as n for some f cper 5 10 let an n 1 be a scalar sequence with the property that the sum n 1 anbn con verges for all scalar sequences bn n 1 satisfying n 1 bn 2 204 bounded operators a show that n 1 anbn converges absolutely for all scalar sequences bn n 1 satisfying n 1 bn 2 b show that n 1 an 2 hint apply the closed graph theorem to the mapping t 2 1 defined by t bn n 1 7 anbn n 1 conclude that an n 1 defines a bounded functional on 2 5 11 consider a banach space with a direct sum decomposition x x 0 x 1 prove that the projections onto the summands define isomorphisms of banach spaces x x 0 x 1 x x 1 x 0 5 12 let x be a banach space with direct sum decomposition x x 0 x 1 show that if t 0 x 0 y and t 1 x 1 y are bounded operators then the operator t t 0 t 1 from x to y defined by t x 0 x 1 t 0 x 0 t 1 x 1 is bounded what can be said about the norm of t hint first show that x 0 x 1 x 0 x 1 is an equivalent norm on x 5 13 the aim of this problem is to prove that the set of surjective operators from a banach space x into a banach space y is open in l x y a let t l x y be a surjective operator show that there is a constant a 0 such that for all y y there exists an x x such that x 6 a y and t x y b let t l x y be a bounded operator suppose there exists a constant a 0 and 06 b 1 such that for all y y with y 6 1 there exists an x x such that x 6 a and t x y 6 b show that t is surjective hint look into the proof of lemma 5 7 c show that if t l x y is surjective and s l x y is a bounded oper ator satisfying s 1 a where a is the constant of part a then t s is surjective hint apply the first part with b a s 5 14 let x be a vector space a suppose that 1 and 2 are two norms on x each of which turns x into a banach space show that if there exists a constant c 0 such that x 1 6 c x 2 for all x x then the two norms are equivalent b find the mistake in the following proof that every two norms and turning x into a banach space are equivalent define x x x x x this is a norm which turns x into a banach space and we have x 6 x problems 205 and x 6 x hence part b implies that x and x are equivalent and that x and x are equivalent it follows that and are equivalent 5 15 let f be a measure space let 1 6 p 6 and suppose that f x is a function which has the property that the scalar valued function 7 f x belongs to lp for every x x a show that the mapping t x lp defined by x 7 f x is closed b deduce that there exists a constant c 0 such that f x lp 6 c x x x 5 16 let f be a finite measure space and let x be a banach space a let f x be a strongly measurable function show that if there is an exponent 1 p 6 such that f x lp for all x x then there exists a unique element x f x the pettis integral of f with respect to such that x f x f x d x x hint the integrals 1 f 6 n f d are well defined as bochner integrals b show that the result of part a fails for p 1 hint let an n 1 be a sequence of disjoint intervals of positive measure an in the interval 0 1 and consider the function f 0 1 c 0 defined by f t n 1 1 an 1 an t en t 0 1 where en n 1 is the sequence of standard unit vectors in c 0 5 17 write out a proof of theorem 5 32 5 18 for n 1 and f l 2 rd let fn f 1 2 d 2 n n d exp ix f x dx show that fn maps l 2 rd into itself and defines a bounded operator on l 2 rd and show that for all f l 2 rd we have the following identity for the fourier plancherel transform f f lim n fn f where the limit is taken in l 2 rd 5 19 it was shown in lemma 5 20 that for 0 the fourier transform of g x 2 d 2 exp 12 x 2 is given as g 2 d 2 exp 1 2 2 206 bounded operators give an alternative proof of this identity by completing the following steps a it suffices to prove the identity for 1 and in dimension d 1 b the function u x 2 d 2 exp 12 x 2 solves the differential equation u x xu x 0 c the fourier transform of u also satisfies the differential equation d apply the picard lindelo f theorem theorem 2 12 5 20 consider the fourier plancherel transform f f 7 f on l 2 rd a show that f 2 r where r f x f x is the reflection operator on l 2 rd b deduce that f 4 i 5 21 prove that the hilbert transform h on l 2 r satisfies h 2 i 5 22 this problem establishes a connection between the hilbert transform and the the ory of harmonic functions for real valued functions f l 2 r we define u f r 0 r u f x y py f x x r y 0 where py x 1 y x 2 y 2 x r y 0 is the poisson kernel a show that u f is harmonic that is u c 2 r 0 and u 0 b show that u f iuh f is holomorphic 5 23 let f l 1 r satisfy f 0 for almost all 0 a show that for all y 0 the function py f where py is the poisson kernel is integrable and its fourier transform belongs to l 1 r l 2 r hint compute the fourier transform of py b using fourier inversion prove that the function g x iy py f x is holomorphic on the open half plane imz x iy 0 c using proposition 2 34 show that lim y 0 g iy f l 1 r 0 somewhat informally part c states that every l 1 function whose fourier trans form vanishes on the negative half line is the boundary value in the l 1 sense of a holomorphic function on the upper half plane problems 207 d state and prove a version of part c for the disc 5 24 we use the notation introduced in problem 2 27 let f be the fourier plancherel transform on l 2 rd and let x be a banach space on the space l 2 rd x we define the linear operator f i by f i f x f f x f l 2 rd x x a show that this operator is well defined b show that if x p with 16 p 6 then f i extends to a bounded oper ator on l 2 r p if and only if p 2 hint for 16 p 2 consider the functions fn n n 0 f 2 n en 1 where en n 1 is the sequence of standard unit vectors in p and 0 6 f cc r has support in the interval for 2 p 6 use the functions fn n n 0 e in f en 1 5 25 let 16 p 6 young s inequality implies that the convolution of a function f l 1 rd with a function g lp rd belongs to lp rd and f g p 6 f 1 g p a write out the proof of this result obtained by taking r 1 in the proof of proposition 2 33 the special case of young s inequality just stated can be reformulated as saying that for every g lp rd the convolution operator cg f 7 f g is bounded from l 1 rd to lp rd with norm cg l l 1 rd lp rd 6 g p b let 1 p 1 q 1 using ho lder s inequality show that the restriction of cg to l 1 rd lq rd extends uniquely to a bounded operator from lq rd to l rd of norm cg l lq rd l rd 6 g p c use the riesz thorin interpolation theorem to obtain an alternative proof of the general form of young s inequality 5 26 let f be a measure space and let 1 6 p q satisfy 1 p 1 q 1 the aim of this problem is to use the riesz thorin interpolation theorem to derive the clarkson inequalities 208 bounded operators 1 if 16 p 6 2 then for all f g lp we have f g pp f g p p 1 p 6 21 p f pp g p p 1 p and f g qp f g q p 1 q 6 21 q f pp g p p 1 p 2 if 26 p then for all f g lp we have f g pp f g p p 1 p 6 21 q f pp g p p 1 p and f g pp f g p p 1 p 6 21 p f qp g q p 1 q let 16 r s 6 on the cartesian product lr lr we consider the norm f g r s f sr g s r 1 s a show that the resulting normed space xr s is complete on xr s we consider the operator t f g 7 f g f g its norm will be denoted by t r s b show that t 1 1 2 and t 2 2 2 c deduce the first inequality in 1 d show that for all f g l 1 we have t f g 1 6 f g 1 1 e deduce the second inequality in 1 f prove the inequalities in 2 g prove that lp is strictly convex that is f p g p 1 with f 6 g implies 12 f g p 1 5 27 state and prove an analogue of the hausdorff young theorem for the circle 5 28 write out the details of the proof of the marcinkiewicz interpolation theorem for the case p 1 6 spectral theory spectral theory is the branch of operator theory that seeks to extend the theory of eigen values to an infinite dimensional setting much of its power derives from the observa tion that away from the spectrum of a bounded operator t the operator valued function 7 t 1 is holomorphic this makes it possible to import results from the the ory of functions into operator theory for instance the fact that bounded operators on nonzero banach spaces have nonempty spectra is deduced from liouville s theorem and the cauchy integral formula can be used to introduce a functional calculus for func tions holomorphic in an open set containing the spectrum of t 6 1 spectrum and resolvent in linear algebra a complex number is said to be an eigenvalue of an n n matrix a with complex coefficients if there exists a nonzero vector x cn such that ax x the number is an eigenvalue if and only if i a fails to be invertible or equivalently if and only if det i a 0 writing out the determinant we obtain the so called characteristic polynomial in the variable which has n zeroes counting multiplicities by the main theorem of algebra our first task will be to investigate to what extent these results generalise to bounded operators acting on a banach space throughout the chapter t denotes a bounded operator acting on a complex space x we work over the complex scalars this convention will remain force throughout the rest of this work definition 6 1 resolvent and spectrum the resolvent set of an operator t l x this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 209 210 spectral theory is the set t consisting of all c for which the operator i t is boundedly invertible by which we mean that there exists a bounded operator u on x such that i t u u i t i the spectrum of t is the complement of the resolvent set of t t c t from now on we shall write t instead of i t it is customary to write r t t 1 for the resolvent operator of t at the point t by the open mapping theorem theorem 5 8 a complex number belongs to t if and only if t is a bijection on x example 6 2 the spectrum of an n n matrix with complex coefficients viewed as a bounded operator acting on cn equals its set of eigenvalues in the present setting a complex number is said to be an eigenvalue of the bounded operator t l x if t x x for some nonzero vector x x such a vector is then said to be an eigenvector the set p t of all eigenvalues of t is called the point spectrum of t if is an eigenvalue of t then t is not injective and therefore not invertible as a result eigenvalues belong to the spectrum in contrast to the finite dimensional situation however points in the spectrum need not be eigenvalues example 6 3 the right shift t on 2 given by the right shift t c 1 c 2 7 0 c 1 c 2 has no eigenvalues indeed the identity t c c can be written out as 0 c 1 c 2 c 1 c 2 if 6 0 comparison of the entries of these sequences inductively gives cn 0 for all n 1 if 0 the identity reads 0 c 1 c 2 0 0 and again we obtain cn 0 for all n 1 in both cases we find that t c c only admits the zero solution c 0 the spectrum of t equals the closed unit disc t d this can be proved directly see problem 6 4 or by the following argument based on results proved below by proposition 6 18 we have t t the adjoint operator t is readily identified as the left shift c 1 c 2 7 c 2 c 3 for each c with 1 the element 1 2 2 is an eigenvector for this operator with eigenvalue it follows that d t since by lemma 6 7 the spectrum of a bounded operator is closed this forces d t on the other hand by lemma 6 6 the fact that t is a contraction implies that t d 6 1 spectrum and resolvent 211 remark 6 4 in contrast to the case of matrices in finite dimensions the existence of a left inverse does not imply the existence of a right inverse and vice versa for example the right shift in 2 has a left inverse namely by the left shift but not a right inverse similarly the left shift in 2 has a right inverse namely the right shift but not a left inverse this is the reason for insisting on the existence of a two sided inverse in definition 6 1 if both a left inverse ul and a right inverse ur exist then necessarily ul ur and this operator is a two sided inverse if the bounded operators t and u are boundedly invertible then so is tu and tu 1 u 1 t 1 invertibility of tu by itself does not imply invertibility of t or u a counterexample is obtained by taking t and u be the left and right shift on 2 however we do have the following result lemma 6 5 the product of two commuting bounded operators is invertible if and only if each of the operators is invertible proof the if part is clear for the only if part suppose that tu ut is invertible the invertibility of tu implies that t is surjective and u is injective and likewise the invertibility of ut implies that u is surjective and t is injective it follows that both t and u are bijective and by the open mapping theorem their inverses are bounded our first main result theorem 6 11 asserts that the spectrum of a bounded operator acting on a nonzero banach space is always a nonempty compact subset of the complex plane this will be deduced from a series of lemmas lemma 6 6 neumann series if t 1 then i t is boundedly invertible and its inverse is given by the absolutely convergent series i t 1 n 0 t n as a consequence the spectrum of a bounded operator t is contained in the closed disc z c z 6 t proof the absolute convergence in l x of the series follows from n 0 t n 6 n 0 t n by the completeness of l x the series n 0 t n converges in l x the identity in the statement of the lemma is a consequence of the identities i t n n 0 t n n n 0 t n i t i t n 1 212 spectral theory valid for all n 1 upon letting n they give i t n 0 t n n 0 t n i t i which means that the bounded operator n 0 t n is a two sided inverse for i t to prove the second assertion let t l x be an arbitrary bounded operator by the first assertion for all c with t the operator t i t is boundedly invertible as an application we prove that the spectrum is always a closed subset of c lemma 6 7 the spectrum t is a closed subset of c more precisely if t then t contains the open ball with centre and radius r 1 r t if 6 r with 06 1 then r t 6 1 1 r t proof if s l x is boundedly invertible and u l x has norm u 6 r with r 1 s 1 then s 1 u 6 1 and therefore by lemma 6 6 s u s i s 1 u is boundedly invertible and s u 1 6 s 1 i s 1 u 1 s 1 n 0 s 1 u n 6 1 r n 0 n 1 r 1 1 lemma 6 8 resolvent identity for all t we have r t r t r t r t proof multiply both sides with the invertible operator t t definition 6 9 holomorphy let be an open subset of c a function f x is holomorphic if for all z 0 the limit lim z z 0 f z f z 0 z z 0 exists in x some properties of banach space valued functions have already been explored in problems 4 2 and 5 5 lemma 6 10 the function 7 r t is holomorphic on t and satisfies lim r t 0 6 1 spectrum and resolvent 213 proof continuity of the mapping 7 r t follows from the resolvent identity and the bound in lemma 6 7 to prove the holomorphy of 7 r t on t we use the resolvent identity and the continuity of 7 r t to obtain lim r t r t lim r t r t r t 2 for 2 t the neumann series gives r t 1 i 1 t 1 6 1 n 0 1 t n 6 2 1 this proves the second assertion we are ready for the first main result of this chapter theorem 6 11 non emptiness of the spectrum if t is a bounded operator on a nonzero banach space then t is a nonempty compact subset of the closed disc c 6 t proof containment in c 6 t and closedness of the spectrum have al ready been proved in lemmas 6 6 and 6 7 respectively since bounded closed subsets of c are compact this gives the compactness of t suppose for a contradiction that t then the function 7 r t is holo morphic on c by lemma 6 10 it is also bounded now we are in a position to apply liouville s theorem for all x x and x x we find that 7 r t x x is con stant its limit for is zero and therefore r t x x 0 for all t and all x x and x x by the hahn banach theorem r t x 0 for all t and all x x it follows that r t 0 for all t this implies x 0 instead of using duality to reduce matters to scalar valued functions one may note that the proof of liouville s theorem generalises mutatis mutandis to holomorphic functions with value in a banach space we have seen in lemma 6 10 that the resolvent 7 r t is holomorphic on t the next result shows that the topological boundary t t t is a natural barrier for holomorphy for this function proposition 6 12 if n in c with each n t and t then lim n r n t proof by lemma 6 7 if t then the open ball b r t 1 is con tained in t this implies the more precise assertion that for all t we have d t r t 1 that is r t 1 d t an immediate application is the following analytic continuation result 214 spectral theory corollary 6 13 if d c is a connected open set intersecting the resolvent set of a bounded operator t and if 7 r t extends holomorphically to d then d t a more substantial application of proposition 6 12 is the following result about the spectra of isometries recall that an isometry is an operator t l x y such that t x x for all x x corollary 6 14 the spectrum of an isometry is either contained in the unit circle t or else equals the closed unit disc d proof first note that an isometry t has norm t 1 so that t d by the second assertion of lemma 6 6 if t with 0 1 then using that t is an isometry for all x x we find x t r t x t r t x r t x 1 r t x and therefore r t 6 1 1 in view of proposition 6 12 this implies that for all 0 r 1 the disc c 6 r does not contain boundary points of t this being true for all 0 r 1 it follows that either the open unit disc d is contained in t or else d contains no points of t in the former case we have t d as t is closed and contained in d in the latter case we have t t this result is the best possible in the following sense both the closed unit disc and any nonempty closed subset of the unit circle can be realised as the spectrum of suitable isometries for instance the left and right shift on 2 provide examples of the former and if k t is a nonempty closed set then on c k the operator t f z z f z on l 2 t is easily verified to have spectrum equal to k we have the following continuity result for spectra proposition 6 15 lower semicontinuity of the spectrum let be an open set in the complex plane containing t then there exists a 0 such that if the bounded operator t satisfies t t then t proof in the proof of lemma 6 10 we have seen that lim r t 0 in par ticular sup 2 t r t by the continuity of 7 r t we also have sup 62 t 6 r t combining these we find that sup 6 r t denote this supremum by m if t t 1 m and 6 then from t t i r t t t we infer that t is invertible noting that i r t t t is invertible since r t t t m 1 m 1 6 1 spectrum and resolvent 215 it has already been noted that eigenvalues belong to the spectrum but that a bounded operator need not have any eigenvalues see example 6 3 we now prove a useful result that makes up for this to some extent definition 6 16 approximate eigenspectrum the number c is called an approx imate eigenvalue of the operator t if there exists a sequence xn n 1 in x with the following two properties 1 xn 1 for all n 1 2 t xn xn 0 as n in this context the sequence xn n 1 is called an approximate eigensequence for the set of all approximate eigenvalues is called the approximate point spectrum every eigenvalue is an approximate eigenvalue approximate eigenvalues belong to the spectrum for if were an approximate eigenvalue belonging to the resolvent set of t we would arrive at the contradiction 1 xn r t t xn xn 6 r t t xn xn 0 as n proposition 6 17 the boundary of t consists of approximate eigenvalues proof if t then there exists a sequence n n 1 in t converging to using proposition 6 12 and the uniform boundedness principle we find a vector x x such that r n t x the vectors xn r n t x r n t x then define an approximate eigensequence this follows from t xn xn t n n r n t x r n t x 6 x r n t x n 0 we have the following duality result proposition 6 18 the spectrum of the adjoint of a bounded operator t equals t t proof if t then t r t r t t i x ix and similarly r t t ix from which it follows that t and r t r t this proves the inclusion t t to complete the proof we show that t t applying what we just proved to 216 spectral theory t we obtain t t fix t identifying x with its natural isometric image in x see proposition 4 21 we wish to prove that the restriction of r t to x maps x into itself this restriction will be a two sided inverse for t proving that t by proposition 5 15 the range r t is dense in x moreover for all x x we have x r t t x r t t x this shows that r t maps the dense subspace r t of x into x and therefore it maps all of x into x by the boundedness of r t and the closedness of x in x the restriction of r t to x is therefore a bounded operator on x which is a left inverse to t it is also a right inverse since in x we have the identities t r t x t r t x x this proves that t is invertible with inverse r t x hence t t or equivalently t t we finish this section with an observation about relative spectra let a l x be a unital closed subalgebra that is a is a closed subspace of l x closed under taking compositions and containing the identity operator i for an operator t a we define a t as the set of all c for which the operator t boundedly invertible in a that is there exists an operator u a such that t u u t i we further set a t c a t by redoing the proofs of lemmas 6 6 and 6 7 a t is an open set and a t is a closed set contained in the closed disc of radius t and therefore a t is compact it is evident that a t t and therefore t a t the next result provides a partial converse proposition 6 19 let a l x be a unital closed subalgebra and let t a then a t t proof let a t and let n in c with each n in a t by redoing the proof of proposition 6 12 we obtain that r n t as n since t is open and the resolvent 7 r t continuous with respect to the operator norm this implies that t the example of the left shift t on x 2 z and the unital closed subalgebra a generated by the identity and the right shift shows that this result is the best possible here one has a t t t and a t d 6 2 the holomorphic functional calculus 217 6 2 the holomorphic functional calculus if f c c is an entire function and t is a bounded operator on x we may define a bounded operator f t on x as follows writing f as a convergent power series about z 0 f z n 0 f n 0 n zn we define f t n 0 f n 0 n t n this series converges absolutely in l x since the same is true for the power series of f z for every z c the mapping f 7 f t is called the entire functional calculus of t and has the following properties each of which is a consequence of the corresponding properties for scalar valued entire functions i if f z zn with n n then f t t n ii f t g t f g t iii g f t g f t this calculus may be used to define operators such as exp t sin t cos t and so forth there is a beautiful way to extend the entire functional calculus to a larger class of holomorphic functions namely by replacing power series expansions by the cauchy integral formula f z 0 1 2 i f z 0 d 6 1 here f is assumed to be a holomorphic function on an open set in the complex plane containing z 0 and is a suitable contour winding about z 0 in formally substituting t for z 0 and interpreting 1 t as r t one is led to conjecture that a holomorphic functional calculus may be defined by the formula f t 1 2 i f r t d 6 2 since 7 r t is continuous on t with respect to the operator norm of l x after parametrising the integral in 6 2 is well defined as a riemann integral with values in l x see section 1 1 in order to flesh out a set of conditions on and t to make this idea work we first take a closer look at the precise assumptions in the cauchy integral formula 6 1 these are that is an open set in the complex plane containing z 0 and is a piecewise continuously differentiable closed contour in z 0 with the following two properties 218 spectral theory i the winding number of about the point z 0 equals 1 ii the winding number of about every point in equals 0 here the winding number of about a point z is the integer number w z 0 1 2 i 1 z 0 d more generally we can admit finite unions of such contours as long as their union satisfies i and ii if 1 k is such a union we define w z 0 1 2 i k j 1 j 1 z 0 d condition ii is satisfied if 1 k is a finite union of disjoint convex sets and j is a piecewise continuously differentiable closed contour in j z 0 turning to the discussion of 6 2 we need to fix a similar set of assumptions re garding and while letting the operator t take the role of z 0 we require that is an open set in the complex plane containing t and is a piecewise continuously differentiable closed contour in t with the following two properties i the winding number of about every point z 0 t equals 1 ii the winding number of about every point in equals 0 if the conditions i and ii are met we say that is an admissible contour in for t as before we admit the possibility that is a finite union of such contours for such contours we interpret 6 2 as f t 1 2 i k j 1 j f r t d for example if t k 1 k 2 is the union of two disjoint compact sets with k j j where 1 2 is a disjoint union of open convex sets we may select contours j with winding number 1 about every point in k j and consider 1 2 as an admissible contour in for t this example is relevant for defining spectral projections where one uses the holomorphic functions f 1 1 and f 1 2 see proposition 6 25 for an open set in the complex plane we denote by h the vector space of all holomorphic functions on theorem 6 20 holomorphic functional calculus let c be an open set containing t for functions f h we define f t 1 2 i f r t d where is an admissible contour in for t the resulting operators f t are well defined and have the following properties 6 2 the holomorphic functional calculus 219 k 1 k 2 1 2 1 2 figure 6 1 the contour 1 2 around t k 1 2 in 1 2 i the operator f t is independent of the admissible contour ii for entire functions the holomorphic and entire functional calculi agree iii for f 1 with t we have f t r t iv for all f g h we have f t g t f g t v for all f h we have f t f t proof i this follows by applying the cauchy theorem to the scalar valued integrals 1 2 i f r t x x d and then using the hahn banach theorem alternatively one may extend mutatis mu tandis the proof of the cauchy theorem to functions with values in a banach space ii for fn z zn with n n we have with a circle of radius r t oriented counterclockwise fn t 1 2 i nr t d 1 2 i n 1 k 0 kt k d k 0 1 2 i n 1 k d t k t n here we first used the neumann series for r t 1 i 1 t 1 noting that t for then we interchanged integration and summation which is justi fied by the absolute convergence of the series uniformly in and finally we used 220 spectral theory that 1 2 i j d 1 j 1 0 j z 1 by linearity this proves that the holomorphic calculus agrees with the entire functional calculus for polynomials the general case follows by approximating an entire function by its power series and noting that this approximation is uniform on bounded sets iv let and be contours surrounding t in with to the interior of more precisely the outer contour should have winding number one with respect to every point on the inner contour by the resolvent identity and fubini s theorem f t g t 1 2 i 2 f g r t r t d d 1 2 i 2 f g 1 r t r t d d 1 2 i 2 f g 1 r t d d 1 2 i 2 f g 1 r t d d 1 2 i f g r t d f g t here we used that 1 2 i g 1 d 0 and 1 2 i f 1 d f iii the identity f f 1 gives via ii and iv that t f t f t t i it follows that f t r t v this follows from proposition 6 18 and the continuity of the mapping s 7 s which allows one to take adjoint under the integral sign theorem 6 21 spectral mapping theorem let c be an open set containing t for all f h we have f t f t proof we begin with the proof of the inclusion f t f t fix 6 f t our aim is to show that 6 f t let u be an open set containing the compact set f t but not then f 1 u is an open subset of containing t and 6 f the function f is holomorphic on and so is g z f z 1 by the choice of by the multiplicativity of the holomorphic functional calculus applied to h f t g t g t f t i 6 2 the holomorphic functional calculus 221 from which we infer that 6 f t turning to the converse inclusion f t f t let by the theory of functions in one complex variable we have f f z z h z for some h h so f f t t h t if t then t is noninvertible since t and h t commute lemma 6 5 implies that f f t is noninvertible and therefore f f t theorem 6 22 composition let c be an open set containing t let f h and let c be an open set containing f t then for all g h we have g f t g f t proof let be an admissible contour in for f t and let be an open subset of containing t chosen in such a way that has winding number 1 about every point of f let be an admissible contour in for t if is a point on then h f 1 defines a function in h and h t f t f t h t i it follows that f t and r f t h t 1 2 i f 1 r t d hence using fubini s theorem to justify the change of order of integration g f t 1 2 i g r f t d 1 2 i 2 g f 1 r t d d 1 2 i 2 g f 1 r t d d 1 2 i g f r t d g f t in the penultimate identity we used that 12 i g f 1 d g f by the cauchy integral formula we shall present two applications of the holomorphic calculus the first is an exact formula for the spectral radius r t sup t of a bounded operator t with the convention sup 0 to deal with the trivial case x 0 since the spectrum t is contained in the closed disc with radius t we 222 spectral theory have r t 6 t more generally by the spectral mapping theorem r t n r t n 6 t n so r t 6 t n 1 n we actually have equality theorem 6 23 gelfand for every bounded operator t we have r t inf n 1 t n 1 n lim n t n 1 n proof existence of the limit is part of the assertion set r t infn 1 t n 1 n we claim that limsupn t n 1 n 6 r t once this is proved the existence of the limit limn t n 1 n as well as its equality to infn 1 t n 1 n are immediate consequences fix 0 and choose k 1 such that t k 1 k 6 r t pick n 1 and write n ank bn with an 0 and 06 bn 6 k 1 integers then t n 6 t k an t bn so t n 1 n 6 t k an n t bn n 6 r t kan n t bn n as n we have kan n 1 and bn n 0 and find limsupn t n 1 n 6 r t since 0 was arbitrary this proves the claim we have already observed that r t 6 limn t n 1 n on the other hand if we fix 0 arbitrary and let denote a circular contour with radius r r t then t n 1 2 i nr t d implies t n 6 1 2 2 r rn sup r r t the supremum being finite in view of the continuity of 7 r t taking nth roots and passing to the limit n this implies limn t n 1 n 6 r r t since 0 was arbitrary this completes the proof as an application we have the following stability result theorem 6 24 lyapunov s stability theorem if a l x is a bounded operator with a z c rez 0 then lim t eta 0 proof since a is compact there is a 0 such that a z c rez 6 by the spectral mapping theorem theorem 6 21 this implies that ea z c z 6 e stated differently we have r ea 6 e 1 by theorem 6 23 there exists an integer n 0 1 such that en 0 a 1 set m 0 en 0 a by estimating the power series defining esa esa 6 es a for all s 0 let now t 0 and write t kn 0 r with k n and r 0 n 0 then eta ekn 0 aera 6 en 0 a ker a 6 mk 0 e n 0 a 6 2 the holomorphic functional calculus 223 since m 0 1 this gives the result with exponential rate for t implies k the interpretation of this theorem is as follows consider the initial value problem u t au t t 0 u 0 u 0 where a l x is bounded and u 0 x is given by differentiating the power series defining eta we see that this problem is solved by the function t 7 etau 0 lyapunov s theorem now gives the following sufficient spectral criterion for stability of this solution if the spectrum of a is contained in the open left half plane then limt eta 0 another interesting application of the holomorphic calculus arises when the spectrum is the disjoint union of two nonempty disjoint compact sets theorem 6 25 spectral projections suppose that t is the union of two nonempty disjoint compact sets k 1 and k 2 1 and 2 are disjoint open sets containing k 1 and k 2 respectively and let 1 and 2 be admissible contours for k 1 and k 2 in 1 and 2 respectively the operators pj 1 2 i j r t d j 1 2 are projections their ranges x 1 and x 2 are invariant under t and we have a direct sum decomposition x x 1 x 2 moreover t x j k j j 1 2 proof to see that pj is a projection we just note that pj f j t where f j 1 2 c is the holomorphic function which is 1 on j and 0 elsewhere by the multiplicativity of the holomorphic calculus pj is bounded and p 2 j f j t 2 f 2 j t f j t pj also f 1 f 2 1 implies that p 1 p 2 i we further have p 1 p 2 f 1 t f 2 t f 1 f 2 t 0 since f 1 f 2 0 and similarly p 2 p 1 0 consequently r p 1 r p 2 0 for if x p 1 x 1 p 2 x 2 then p 1 x p 1 p 2 x 2 0 and p 2 x p 2 p 1 x 1 0 and therefore x p 1 p 2 x 0 0 0 it follows that we have a direct sum decomposition x r p 1 r p 2 since t obviously commutes with pj it follows that t maps x j r pj into itself it follows that t restricts to a bounded operator tj t x j on x j let c k j we show that tj define s 1 2 i j 1 r t d 224 spectral theory where j is a contour surrounding k j in j with on the exterior writing tj tj and using that t pjx tjpjx for all x x we find tj s pjx s tj pjx 1 2 i j 1 r t tj pjxd 1 2 i j r t pjx 1 pjxd 1 2 i j r t pjxd p 2 j x pjx which shows that tj s s tj i on r pj this proves that tj we have shown that tj k j in particular this implies that t 0 t 1 next we claim that t t 1 t 2 this concludes the proof since it gives k 1 k 2 t t 1 t 2 k 1 k 2 and therefore equality holds at all steps to prove the claim it suffices to note that if 6 t 1 t 2 then t 1 t 2 and r t 1 r t 2 is a two sided inverse to t t 1 t 2 problems 6 1 prove the following improvement to lemma 6 6 if t l x is such that the sum n 0 t nx converges for all x x then i t is invertible what is its inverse 6 2 show that if t satisfy 6 r with 06 1 then r t r t 6 1 r t 6 3 prove in an elementary way by multiplying power series that ewt ezt e w z t for all complex numbers w z c 6 4 for 16 p 6 consider the right shift operator tr l p t a 1 a 2 a 3 7 0 a 1 a 2 give a direct proof of the fact see example 6 3 that t c 6 1 6 5 we compute the spectra of some multiplier operators a let m c 0 1 and define tm l c 0 1 by tm f t m t f t f c 0 1 t 0 1 show that tm coincides with the range of m problems 225 b let m l 0 1 let 16 p 6 and define tm l lp 0 1 by tm f t m t f t f lp 0 1 t 0 1 show that tm coincides with the essential range of m that is the set of all k such that for any open set u k containing the set t 0 1 m t u has positive measure hint first show that 1 m is essentially bounded if and only if is not con tained in the essential range of m 6 6 let tm be the fourier multiplier on l 2 rd with symbol m l rd a show that tm equals the essential range of m hint use the result of the preceding problem b show that if f is a holomorphic function defined on an open set containing tm then f m l rd and tf m f tm the latter being defined by the holomorphic calculus 6 7 show that every nonempty compact subset of c occurs as the spectrum of some bounded operator 6 8 show that if p q are projections on a banach space x satisfying p q 1 then dim r p dim r q admitting the possibility hint the invertibility of i p q implies pqx p i p q x px 6 9 let f be the fourier plancherel transform on l 2 rd a recalling that f 4 i see problem 5 20 apply the spectral mapping theo rem to see that f 1 i b show that f ii f i f ii f i 0 and f i f ii f i 6 0 and deduce that i f c prove that f 1 i 6 10 determine the spectrum of the hilbert transform h on l 2 rd hint use the result of problem 5 21 6 11 suppose that we have a direct sum decomposition x x 0 x 1 prove that if t l x leaves both x 0 and x 1 invariant then t t x 0 t x 1 viewing t x 0 and t x 1 as bounded operators on the banach spaces x 0 and x 1 6 12 let s and t be bounded operators on a banach space x prove that st 0 t s 0 hint use the neumann series to relate the resolvents of st and t s 6 13 prove the claims about the example below proposition 6 19 226 spectral theory 6 14 the aim of this problem is to prove chernoff s theorem if t is a bounded operator on a banach space x satisfying supn n t n m then for all n nwe have exp n t i x t nx 6 nm t x x a show that exp n t i x t nx 6 e n k 0 nk k t kx t nx 6 e nm t x x k 0 nk k 1 2 nk k 1 2 n k b show that k 0 nk k n k 2 nen c combine a b and the cauchy schwarz inequality to complete the proof 6 15 let t be a power bounded operator on a banach space x that is t is invertible and supk z t k a using the holomorphic calculus and its properties explain that we can define the bounded operators s i logt and sin ns n n b show that sin ns 12 i t n t n n n c using the spectral mapping theorem show that ns sin ns 0 we now use that if k 0 ckz k denotes the taylor series of the principal branch of arcsinz at z 0 then ck 0 for all k n and k 0 ck arcsin 1 2 d show that ns arcsin sin ns where the latter is again defined by means of the holomorphic calculus and deduce that ns 6 2 sup k z t k conclude that s 0 and t eis i 7 compact operators this chapter studies the class of compact operators by definition these are the operators that map bounded sets to relatively compact sets examples include integral operators on various banach spaces of functions over a compact domain because of this com pact operators have important applications in the theory of partial differential equations and mathematical physics after establishing some generalities we prove the riesz schauder theorem which asserts that the non zero part of the spectrum of a compact operator is discrete and consists of eigenvalues the final section of this chapter presents an introduction to the theory of fredholm operators these are the operators that are invertible modulo a compact operator and their degree of non invertibility is quantified by the so called fredholm index as an example we prove the gohberg krein noether theorem which states that a toeplitz operator with continuous zero free symbol is fredholm and its index equals the negative winding number of their symbol 7 1 compact operators let x and y be banach spaces definition 7 1 compact operators an operator t l x y is compact if it maps bounded sets to relatively compact sets since every bounded set in x is contained in a multiple of the unit ball bx x x x 1 a bounded operator is compact if and only if t bx is relatively compact this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 227 228 compact operators furthermore using that a subset of a banach space is relatively compact if and only if it is relatively sequentially compact a linear operator t is compact if t xn n 1 has a convergent subsequence for every bounded sequence xn n 1 in x the set of all compact operators is a linear subspace of l x y it is clear that ct is compact if t is compact for any scalar c k and if s and t are compact then also s t is compact for if sbx and t bx are contained in the compact sets k and l then s t bx is contained in the compact set k l this set is the image of the compact set k l under the continuous image x 1 x 2 7 x 1 x 2 from x x to x it is also a two sided ideal in l x y in the sense that if t l x y is compact and s l x x and u l y y are bounded then ut s l x y is compact indeed if c is a bounded set in x then s c is bounded in x so t s c is contained in a compact set k of y and then ut s c is contained in the compact set u k example 7 2 as an immediate corollary to theorem 1 38 the identity operator on a banach space x is compact if and only if x is finite dimensional example 7 3 a bounded operator is said to be of finite rank if its range is finite dimensional since bounded sets in finite dimensional spaces are relatively compact every finite rank operator is compact example 7 4 integral operators on c k let be a finite borel measure on compact metric space k and let k k k k be continuous then the operator t c k c k t f x k k x y f y d y f c k x k is well defined and bounded by example 1 30 let us show that t is compact let fn n 1 be a bounded sequence in c k we claim that the bounded sequence t fn n 1 is equicontinuous once we have shown this the arzela ascoli theorem theorem 2 11 implies that this sequence is relatively compact hence has a convergent subse quence this implies that t is compact to check the equicontinuity we first note that k k is compact and hence k is uni formly continuous in the sense that given any 0 we can find 0 in k such that d x x d y y implies k x y k x y then if d x x t fn x t fn x 6 k k x y k x y fn y d y 6 m k where m supn 1 fn the equicontinuity follows immediately from this the next proposition shows that the compact operators form a closed subspace in l x y this subspace will be denoted by k x y and we write k x k x x proposition 7 5 if limn tn t 0 with each tn compact then t is compact in particular uniform limits of finite rank operators are compact 7 1 compact operators 229 proof for any 0 we can choose an index n 1 such that tn t since tn bx is relatively compact and t bx tn bx b 0 the relative compactness of t bx follows from proposition 1 40 the following converse of the second assertion of proposition 7 5 holds for hilbert space operators proposition 7 6 let h and k be hilbert spaces an operator t l h k is compact if and only if it is the uniform limit of finite rank operators proof it remains to prove the only if part let t be compact say t bh k with k compact in k where bh is the open unit ball of h fix an arbitrary 0 and let b y 1 b yn be an open cover of k let y denote the linear span of y 1 yn and let p be the orthogonal projection in k onto y this projection is of finite rank and therefore pt is of finite rank for any x h of norm x 1 we have t x k so t x yn for some 16 n 6 n then noting that pyn yn and using that p 6 1 t x pt x 6 t x yn yn pt x p yn t x 6 yn t x 2 taking the supremum over all x h with x 1 we obtain t pt 6 2 example 7 7 integral operators on l 2 k let be a finite borel measure on a compact metric space k and let k k k k be square integrable then the operator t l 2 k l 2 k t f x k k x y f y d y f l 2 k x k is well defined and bounded by example 1 30 let us prove that t is compact fix 0 since c k k is dense in l 2 k k we may choose c k k such that k 2 since is uniformly continuous we can find 0 such that x y x y whenever d x x d y y starting from a finite cover of k by open balls with diameter at most 12 we can write k b 1 bn with disjoint borel sets of diameter at most 12 set k n j k 1 x j yk 1 b j bk where x j b j and yk bk are chosen arbitrarily for this function we have k 6 then k 2 6 k k 1 2 k and hence k k 2 6 k 2 k 2 1 k 7 1 the integral operator with kernel k which we denote by t is given explicitly as t n j 1 n k 1 x j yk bk 1 b j 230 compact operators this shows that t is of finite rank and therefore compact by 1 4 with k replaced by k k and 7 1 we have t t 6 k k 2 1 k since 0 was arbitrary this proves that t can be approximated in the operator norm by compact operators we conclude this section with a duality result for compact operators proposition 7 8 an operator t l x y is compact if and only if its adjoint t l y x is compact proof first we prove the only if part let t be compact and let k denote the closure of t bx by assumption k is a compact subset of y by restriction every y y determines a function in c k given by y y y y for y k moreover if y n n 1 is a bounded sequence in y the corresponding functions are uniformly bounded and equicontinuous the latter follows from x x y n 6 m x x with m supn 1 y n hence by the arzela ascoli theorem there is a subsequence y n j j 1 such that lim j k y nk y n j c k 0 then lim j k t y nk t y n j limj k sup x 61 x t y nk t y n j lim j k sup x 61 t x y nk y n j 6 limj k t y nk y n j 0 thus we have shown that t y n j 1 has a convergent subsequence it follows that t is compact to prove the if part suppose that t is compact then by what we just proved t is compact as an operator from x to y identifying x with a closed subspace of x in the natural way the restriction of t to x maps x to y and equals t since the restriction of a compact operator is compact the compactness of t implies the compactness of t 7 2 the riesz schauder theorem as we have seen in earlier examples the spectrum of a bounded operator need not contain eigenvalues this is in sharp contrast to the situation in finite dimensions where the spectra of matrices consist of eigenvalues the aim of the present section is to show that compact operators spectrally resemble matrices to some degree the main result is 7 2 the riesz schauder theorem 231 theorem 7 11 which shows that the nonzero part of the spectrum of a compact operator is discrete and consists of eigenvalues lemma 7 9 if t l x is compact then 1 n i t is finite dimensional 2 r i t is closed proof 1 let by denote the unit ball of y n i t we have ty y for all y y so the compactness of t implies that by t by is relatively compact by theorem 1 38 this implies that y is finite dimensional 2 let y n i t and consider the linear mapping s x y x defined by s x y i t x x x then s is well defined and bounded as a quotient operator we claim that there exists a constant c 0 such that s x y c x x x 7 2 if this were false we would be able to find elements xn x satisfying xn y 1 and s xn y 1 n then i t xn s xn y 0 by the compactness of t we can find a subsequence such that t xnk x 0 for some x 0 x then lim k xnk limk i t xnk t xnk 0 x 0 x 0 by the boundedness of i t i t x 0 lim k i t xnk limk s xnk y 0 and therefore x 0 n i t y the contradiction 0 x 0 y limk xnk y 1 concludes the proof of 7 2 by proposition 1 21 7 2 implies that s is injective and the range r s of s is closed finally r s r i t and therefore the range of i t is closed in order to describe the spectra of compact operators we need the following lemma lemma 7 10 let t l x be a compact operator then i t is injective if and only if i t is surjective proof we begin with the proof of the only if part we assume that i t is injective but not surjective and deduce a contradiction by assumption x 1 r i t is a proper subspace of x and by lemma 7 9 this subspace is closed it is clear that t x 1 x 1 let t 1 denote the restriction of t to x 1 this operator is compact we claim that t 1 is not surjective suppose the contrary then i t 1 is injective and 232 compact operators surjective hence invertible and since for all x x we have i t x x 1 it follows that x i t 1 1 i t x x 1 this implies that x 1 x then i t is surjective after all this contradiction proves the claim the same argument shows that x 2 r i t 1 is a proper closed subspace of x 1 it is clear that t x 2 x 2 let t 2 denote the restriction of t to x 2 continuing as above we obtain a strictly decreasing sequence of closed subspaces x 1 x 2 each of which is t invariant such that xn 1 i t xn n 1 2 by lemma 1 39 we can select vectors xn xn xn 1 of norm one such that inf y xn 1 xn y 1 2 7 3 since t is compact t xn n 1 has a convergent subsequence t xnk k 1 then for k t xnk t xn xnk t i xnk t xn 1 2 where we use 7 3 along with t i xnk xnk 1 and t xn xn xnk 1 this contra dicts the convergence of t xnk k 1 turning to the if part assume that i t is surjective if t x x for some x x then by writing an arbitrary x x as i t y we find x x y i t x 0 for all x x so x 0 this shows that i t is injective applying the preceding step to t it follows that i t is surjective as well then from the preceding argument applied to t it follows that i t is injective and hence i t is injective theorem 7 11 riesz schauder let t l x be a compact operator then 1 every nonzero t is an eigenvalue of t and the eigenspace e x x t x x is finite dimensional 2 for every r 0 the number of eigenvalues satisfying r is finite 3 if dim x then 0 t proof 1 let 0 6 t and suppose that is not an eigenvalue of t then i 1 t is injective and hence by the preceding lemma surjective it follows that i 1 t is invertible and this implies that t since t acts as a multiple of the identity on the subspace e and t is compact the identity operator on e is compact by theorem 1 38 this implies that e is finite dimensional 2 suppose there is a sequence of distinct eigenvalues n all of them satisfying n r let xn x be eigenvectors for n of norm one let yn denote the linear span of x 1 xn 1 and set y 0 0 by the distinct ness of the eigenvalues the vectors xn are linearly independent this is easily proved 7 2 the riesz schauder theorem 233 with induction on n therefore dim yn n in particular yn is a proper subspace of yn 1 for y yn say y nj 1 c jx j we have ty n j 1 c j jx j yn and n t y n j 1 c j n j x j n 1 j 1 c j n j x j yn 1 lemma 1 39 shows that for every n 1 it is possible to find a vector yn yn of norm one such that y yn 12 holds for all y yn 1 arguing as in the proof of lemma 7 10 for n m these vectors satisfy the lower bound tyn tym nyn t n yn tym n yn tym t n yn n 12 n 12 r using that tym ym yn 1 and t n yn yn 1 and therefore tyn n 1 cannot have a convergent subsequence this contradicts the compactness of t 3 if t is invertible then t 1 bx is bounded and bx t t 1 bx is relatively compact therefore x must be finite dimensional for compact normal operators on a hilbert space a more direct proof is sketched in problem 9 2 definition 7 12 the number dim e is called the geometric multiplicity of suppose now that t l x is compact and that 0 6 t then is an iso lated point of t that is for small enough r 0 we have b r t with 0 r r and b r oriented counterclockwise the spectral projection corresponding to see theorem 6 25 is given by p 1 2 i r t d by theorem 6 25 the range x p x is invariant under t and t x in particular t x is invertible this operator is also compact as an operator on x this is only possible if dim x is finite thus we have proved corollary 7 13 let t be a compact operator on a banach space x for all nonzero t the range x of the spectral projection p is finite dimensional definition 7 14 the number dim x is called the algebraic multiplicity of 234 compact operators proposition 7 15 let t l x be a compact operator then the geometric multiplic ity of every nonzero t is less than or equal to its algebraic multiplicity proof if t x x and is as before then p x 1 2 i 1 d x x this shows that the eigenspace e is contained in the range of the projection p example 7 16 jordan normal form consider a k k jordan block j 1 0 0 0 1 0 1 0 0 and its resolvent r j 1 2 k 0 1 2 2 0 0 1 if a is a matrix with a and if j is the corresponding block in the jordan normal form of a it follows that the spectral projection corresponding to is given by p 1 2 i r a d i where i is the diagonal matrix with 1 s on the diagonal entries corresponding to the jordan block j and 0 s elsewhere it follows that the algebraic multiplicity of equals k the dimension of the jordan block 7 3 fredholm theory throughout this section we let x and y be banach spaces 7 3 a the fredholm alternative from the results in the preceding section we know that if t is a compact operator on a banach space x then every nonzero t is an eigenvalue and the corresponding 7 3 fredholm theory 235 eigenspace is finite dimensional the next theorem when applied to the compact oper ator 1 t asserts that the dimension of the eigenspace is equal to the codimension of the range of t this generalises the elementary result in linear algebra that for a d d matrix a we have dimn a dimr a d theorem 7 17 fredholm alternative if t l x is compact then dimn i t codimr i t this theorem contains lemma 7 10 as a special case the proof of the theorem is based on the following geometric lemma recall that if y x then y x x x x 0 for all x y lemma 7 18 if y is a finite dimensional subspace of x then y has finite codimen sion in x and codim y dimy proof let x 1 x d be a basis of y and consider the mapping from x to k d x 7 x x 1 x x d we claim that this mapping is surjective indeed if kd is such that x 0 for all x x that is dj 1 x x j j 0 for all x x then d j 1 jx j 0 and therefore 0 by linear independence this proves the claim as a consequence there exist x j x such that x j e j the jth unit vector of kd the resulting sequence x 1 xd has the property that xi x j i j i j 1 d the vectors x j are linearly independent for if d j 1 c jx j 0 then ck d j 1 c jx j x k 0 for all k 1 d now suppose that an arbitrary x x is given and set x x dj 1 c jx j where c j x x j then x x k x x k ck 0 for all k 1 d so x y this shows that x y x 0 where x 0 is the linear span of x 1 xd if x y x 0 then we can write x dj 1 c jx j since x x 0 and we have ck d j 1 c j x j x k 0 for all k 1 d since x y it follows that x 0 thus we obtain the direct sum decomposition x y x 0 and therefore codim y dimx 0 d dim y proof of theorem 7 17 we begin by recalling that by lemma 7 9 n i t is finite dimensional and r i t is closed hence proposition 5 15 applied to i t implies that r i t n i t and therefore by lemma 7 18 which can be applied because lemma 7 9 applied to the compact operator t gives dimn i t codimr i t codim n i t dimn i t thus it remains to prove that d dimn i t dimn i t d 236 compact operators step 1 we first prove that d 6 d reasoning by contradiction suppose that d d since n i t is finite dimensional by proposition 4 16 1 we have a direct sum decomposition x n i t y for some closed subspace y of x also since r i t is closed and has finite codimen sion d by proposition 4 16 2 we have a direct sum decomposition x r i t z 7 4 for some closed subspace z of x of dimension d since d d there is an injective linear map l n i t z that is not surjective set s t l where is the projection in x onto n i t along y since l is a finite rank operator it is compact and hence also l is compact we claim that n i s 0 indeed if sx x then 0 sx x t x x r i t l x z and therefore 7 4 implies t x x 0 and l x 0 the first of these identities means that x n i t so x x and then the second of these identities takes the form lx 0 the injectivity of l then implies that x 0 this proves the claim by lemma 7 10 r i s x to arrive at a contradiction let z z r l and choose x x such that x sx z then x t x r i t l x z z z and by 7 4 this implies x t x 0 and z l x the second of these identities contra dicts our assumption that z z r l step 2 having established that d 6 d we now prove the opposite inequality d 6 d by a duality argument setting d dimn i t applying step 1 to the compact operator t gives d 6 d identifying x with a closed subspace of x t is an exten sion of t and therefore d 6 d 7 3 b application to integral equations as an application of the foregoing theory we turn to the problem of finding a function u c 0 1 solving inhomogeneous integral equations of the form u s f s 1 0 k s t u t dt s 0 1 h f here f c 0 1 is given k 0 1 0 1 k is continuous and is a nonzero scalar under a solution of this equation we understand a function u c 0 1 satisfying h f 7 3 fredholm theory 237 for all s 0 1 in order to study existence of solutions it is useful to also consider the homogeneous equation corresponding to f 0 u s 1 0 k s t u t dt s 0 1 h 0 as well as the dual homogeneous problem v s 1 0 k t s v t dt s 0 1 h 0 solutions to these problems are defined in the same way theorem 7 19 fredholm alternative for integral equations let k 0 1 0 1 k be continuous and let 6 0 be fixed then 1 if the homogeneous problem h 0 has no nonzero solution then for all f c 0 1 the inhomogeneous problem h f has a unique solution u in c 0 1 2 if the homogeneous problem h 0 has a nonzero solution then it has at most finitely many linearly independent nonzero solutions and for a given f c 0 1 the inho mogeneous problem h f has a solution if and only if 1 0 f t v t dt 0 for all v l 1 0 1 satisfying the dual homogeneous problem h 0 proof by the result of example 7 4 the operator t c 0 1 c 0 1 tu s 1 0 k s t u t dt s 0 1 is compact using this operator the above problem can be abstractly formulated as t u f if the homogeneous problem t u 0 has no nonzero solution then is not an eigenvalue since we are assuming that 6 0 it follows that 6 t by theorem 7 11 therefore t is invertible and the inhomogeneous problem t u f is uniquely solved by u t 1 f if the homogeneous problem t u 0 has a nonzero solution then is an eigen value in which case the space of solutions u equals the eigenspace corresponding to which is finite dimensional in that case the inhomogeneous problem t u f has a solution u c 0 1 if and only if f r t n t here we use propo sition 5 15 along with the fact that t has closed range stated differently problem t u f has a solution u c 0 1 if and only if f x 0 x n t 238 compact operators to make this condition more explicit we recall from section 4 1 c that the dual of c 0 1 is the space of complex borel measures on 0 1 the duality between functions and measures being given by f 1 0 f d for such measures we compute g t t g 1 0 1 0 k s t g t dt d s 1 0 g t 1 0 k s t d s dt g where the k valued measure is given by b 1 b b 1 0 k s t d s dt for borel sets b 0 1 now n t if and only if b b for all borel sets b 0 1 that is if and only if b d t b 1 0 k s t d s dt for all borel sets b 0 1 in this case is absolutely continuous with respect to the lebesgue measure dt then by the radon nikody m theorem d vdt where v l 1 0 1 satisfies v t 1 0 k s t d s 1 0 k s t v s ds for almost all t 0 1 since both sides are continuous functions of t the equality holds for all t 0 1 this means that v solves h 0 7 3 c fredholm operators let x and y be banach spaces the following definition is suggested by the fredholm alternative theorem 7 17 definition 7 20 fredholm operators a bounded operator t l x y is called a fredholm operator if it has the following properties i dimn t ii codimr t the index of such an operator is defined as ind t dimn t codimr t example 7 21 here are some examples of fredholm operators 7 3 fredholm theory 239 i if t is a compact operator then i t is fredholm with index ind t 0 this is a restatement of the fredholm alternative ii the left and right shift on p 1 6 p 6 are fredholm with indices 1 and 1 respectively iii for every zero free c t the toeplitz operator t on the hardy space h 2 d is fredholm with index ind t w where w is the winding number of this is the content of noether gohberg krein theorem in section 7 3 d where the relevant definitions can be found we begin our analysis of fredholm operators with the observation that such operators have closed range as a result codimr t equals the dimension of the quotient banach space y r t proposition 7 22 if the range of a bounded operator t l x y has finite codimen sion then it is closed proof let y 0 be a finite dimensional subspace of y such that r t y 0 0 and r t y 0 y then y 0 is closed and the bounded operator s x y 0 y defined by s x y 0 t x y 0 is surjective by the open mapping theorem s is open in particular s x y 0 0 is open clearly this set is the complement of s x 0 r t and therefore r t is closed theorem 7 23 atkinson for a bounded operator t l x y the following asser tions are equivalent 1 t is fredholm 2 there exist a bounded operator s l y x and compact operators k l x and l l y such that st i k t s i l if these equivalent conditions hold the operator s is fredholm with index ind s ind t moreover s can be chosen in such a way that k i st and l i t s are finite rank projections satisfying dim r k dim n t and dim r l codim r t proof 1 2 by propositions 4 16 and 7 22 there exist closed subspaces x 0 x and y 0 y such that codim x 0 dim y 0 and x n t x 0 y r t y 0 let p and q denote the corresponding projections in x and y onto x 0 and r t re spectively the restriction t 0 t x 0 is a bijection from x 0 onto r t injectivity and surjectivity both being clear since r t is closed the open mapping theorem implies 240 compact operators that the inverse mapping s 0 t 1 0 is bounded as an operator from r t onto x 0 define s l y x by s s 0 q then for all x x and y y we have st x s 0 qt x s 0 t x s 0 t px px x kx with k i p and t sy t s 0 qy qy y ly with l i q since i p and i q are the projections onto the finite dimensional subspaces n t and y 0 these projections are of finite rank and hence compact it also follows that dim r k dim n t and dim r l codim r t 2 1 we have n t n st and hence dim n t 6 dim n st dim n i k likewise r t r t s and hence codim r t 6 codim r t s codim r i l the finiteness of the codimension being a consequence of theorem 7 17 this completes the proof of the equivalence 1 2 it remains to prove the identity ind s ind t using the notation introduced before we have n s n s 0 q n q y 0 so dim n s dim y 0 codim r t and likewise r s r s 0 q x 0 so codim r s codim x 0 dim n t as a result ind s dim n s codim r s codim r t dim n t ind t a concise way of stating the equivalence 1 2 is by introducing the calkin alge bra l x y k x y theorem 7 23 states that an operator t l x y is fredholm if and only if its equiv alence class in l x y k x y is invertible in the sense that there exists an operator s l y x such that st i mod k x and t s i mod k y proposition 7 24 if t 1 l x y and t 2 l y z are fredholm where z is another banach space then t 2 t 1 l x z is fredholm and ind t 2 t 1 ind t 1 ind t 2 7 3 fredholm theory 241 proof let s 1 l y x and s 2 l z y be such that s 1 t 1 i k 1 t 1 s 1 i l 1 s 2 t 2 i k 2 t 2 s 2 i l 2 with k 1 k 2 l 1 l 2 compact then s 1 s 2 t 2 t 1 s 1 i k 2 t 1 i k 1 s 1 k 2 t 1 i k 3 where k 3 k 1 s 1 k 2 t 1 is compact likewise t 2 t 1 s 1 s 2 t 2 i l 1 s 2 i l 2 t 2 l 1 s 2 i l 3 where l 3 l 2 t 2 l 1 s 2 is compact hence atkinson s theorem implies that t 2 t 1 is fredholm to compute its index let x 1 y 1 y 2 z 2 be finite dimensional subspaces such that x n t 1 x 1 y r t 1 y 1 n t 2 y 2 z r t 2 z 2 we have x n t 2 t 1 if and only if x n t 1 x 1 x 1 t 1 x 1 n t 2 n t 1 t 1 x 1 1 r t 1 n t 2 since t 1 acts as an isomorphism from x 1 onto r t 1 we have dim n t 2 t 1 dim n t 1 dim r t 1 n t 2 furthermore we have dim n t 2 dim r t 1 n t 2 dim y 1 n t 2 combined with the previous identity this gives dim n t 2 t 1 dim n t 1 dim n t 2 dim y 1 n t 2 7 5 next we have z r t 2 z 2 t 2 r t 1 y 1 z 2 and therefore codim r t 2 t 1 codim r t 2 codim r t 1 dim y 1 n t 2 7 6 it follows from 7 5 and 7 6 that ind t 2 t 1 dim n t 2 t 1 codim r t 2 t 1 dim n t 1 dim n t 2 codim r t 2 codim r t 1 ind t 1 ind t 2 242 compact operators the next three propositions show that fredholmness is preserved under various oper ations proposition 7 25 if t l x y is fredholm and k k x y is compact then t k is fredholm and ind t k ind t proof if s l y x and compact operators l 1 l x and l 2 l y are such that st i l 1 and t s i l 2 then s t k i l 1 sk i m 1 with m 1 l 1 sk compact and t k s i l 2 ks i m 2 with m 2 l 2 ks compact hence t k is fredholm by atkinson s theorem moreover by proposition 7 24 and the identity for indices in atkinson s theorem 0 ind i m 1 ind s t k ind s ind t k so ind t k ind s ind t the set of fredholm operators is open in l x y proposition 7 26 dieudonne for any fredholm operator t l x y there exists a number 0 such that for all u l x y with u the operator t u is fredholm and ind t u ind t proof the proof is a variation on the proof of the openness of the set of invertible bounded operators let s l y x be such that st i k and t s i l with k l x and l l y compact then s t u i k su t u s i l us if u s 1 then i su and i us are boundedly invertible and i su 1 s t u i i su 1 k t u s i us 1 i l i us 1 where m i su 1 k and n l i us 1 are compact we deduce from this that t u is fredholm n t u n i su 1 s t u n i m and the latter is finite dimensional and likewise r t u t u s i us 1 r i n and the latter has finite codimension next by proposition 7 24 and theorem 7 17 ind i su 1 ind s ind t u ind i m 0 and ind i su 1 0 by invertibility by the identity for indices in atkinson s theorem it follows that ind t u ind s ind t 7 3 fredholm theory 243 proposition 7 27 if t l x y is fredholm then t l y x is fredholm and ind t ind t proof if s l y x is bounded and f 1 l x and f 2 l y are finite rank pro jections such that st i f 1 and t s i f 2 then s t i f 2 and t s i f 1 with f 2 and f 1 finite rank projections hence t is fredholm by atkinson s theorem we claim that dim n t codim r t 7 7 and dim n t codim r t 7 8 together these identities imply that ind t ind t we give a detailed proof of 7 8 and indicate the changes that need to be made to prove 7 7 since t is fredholm we have a direct sum decomposition x r t w 7 9 with w x a finite dimensional subspace if x 1 xk is a basis for n t by the hahn banach extension theorem we obtain x 1 x k x such that xi x j i j 16 i j 6 k 7 10 let z denote the span of x 1 x k in x we claim that r t z 0 indeed if x z say x kj 1 c jx j then xi x ci 16 i 6 k if we also have x r t say x t y then from xi n t we obtain ci xi x t xi y 0 16 i 6 k this implies x 0 and proves the claim now for any fixed x x set x k j 1 x j x x j 244 compact operators then for i 1 k xi xi x k j 1 x j x xi x j xi x xi x 0 this means that n t by theorem 5 16 this implies that r t since x z it follows that r t z x together with z r t 0 it follows that we have a direct sum decomposition x r t z 7 11 from 7 9 and 7 11 it follows that dim w dim z and dim z dim n t and dim w codim r t this completes the proof of 7 8 the proof of 7 7 proceeds along the same lines interchanging the roles of t and t we now consider a basis x 1 x k for n t and use the hahn banach theorem to obtain x 1 x k x such that x i x j i j 16 i j 6 k at this point we invoke theorem 4 47 to obtain x 1 xk x such that x j x i i j 16 i j 6 k with this analogue of 7 10 at hand the proof can be completed as before 7 3 d the noether gohberg krein theorem let d and t denote the open unit disc and unit circle in the complex plane respec tively we think of t as parametrised by and equipped with the normalised lebesgue measure d 2 the hardy space h 2 d is the hilbert space of all holomor phic functions on d of the form n n cnzn with n n cn 2 since every square summable sequence cn n n defines a convergent power series n n cnz n holomorphic on d the correspondence between a power series and its co efficient sequence sets up an isometric isomorphism between h 2 d and 2 n with respect to the norm f h 2 d n n cn 2 1 2 h 2 d is a hilbert space for n n consider the functions en l 2 t defined by en exp in 7 3 fredholm theory 245 since en n n is an orthonormal sequence in l 2 t every square summable sequence cn n n defines a convergent sum n n cnen in l 2 t denoting this sum by f its fourier coefficients are given by f n cn n 0 0 n 6 1 conversely if all negative fourier coefficients of a function f l 2 t vanish then f n n f n en as a convergent sum in l 2 t since the fourier coefficients of functions in l 2 t are square summable we obtain an isometric isomorphism between h 2 d and the closed subspace of l 2 t consisting of all functions whose negative fourier coefficients vanish in what follows we identity h 2 d with this closed subspace of l 2 t as such h 2 d is the range of the riesz projection p n z f n en 7 n n f n en in l 2 t which discards the terms in the fourier series with negative indices given a function l t we define the bounded operator m on l 2 t by point wise multiplication m f f f l 2 t when m is applied to a function f h 2 d the resulting function f generally does not belong to h 2 d but the riesz projection will take us back to h 2 d this motivates the following definition definition 7 28 toeplitz operators given a function l t the toeplitz operator with symbol is the operator t on h 2 d given by t f p f f h 2 d where p is the riesz projection every toeplitz operator t is bounded of norm t 6 p m 6 7 12 its hilbert space adjoint is given by t t this follows from t f g h 2 d f g l 2 t f g l 2 t f t g h 2 d the following theorem shows that a toeplitz operator with continuous and zero free symbol c t is fredholm and its index equals the negative of the winding number of the closed contour in c 0 parametrised by as we have seen in section 6 2 246 compact operators for piecewise c 1 functions the winding number is given analytically by the contour integral w 1 2 i dz z 1 2 t t dt for functions that are merely continuous the winding number can be defined as fol lows it is an elementary theorem in algebraic topology that there exists a unique inte ger n z such that is homotopic to the curve 7 en by definition this means that there exists a homotopy from to en that is a continuous function h 0 1 c 0 such that for all we have h 0 h 1 en setting ht h t we think of the curves ht c 0 as continuously deforming h 0 to en h 1 the winding number w of is defined to be this integer w n in particular the winding number of en equals n it is an easy consequence of cauchy s theorem that this definition agrees with the analytic definition given earlier if is piece wise c 1 theorem 7 29 noether gohberg krein if the function c t is zero free then the toeplitz operator t is fredholm on h 2 d and ind t w this theorem is remarkable as it computes an analytic quantity the index in terms of a topological one the winding number the main ingredient in the proof is the following lemma which implies that the mapping 7 t from c t to l h 2 d is multiplicative up to a compact operator lemma 7 30 for all c t the operator t t t is compact on h 2 d proof by the estimate 7 12 the weierstrass approximation theorem theorem 2 3 and the fact that uniform limits of compact operators are compact proposition 7 5 it suffices to prove the lemma for trigonometric polynomials and let mm m cmem and n n n dnen be trigonometric polynomials for j n we have t t t e j 7 3 fredholm theory 247 m m m n n n cmdnp emp ene j m m m n n n cmdnp emene j 0 since n j 0 and hence emp ene j emp en j emen j emene j in each summand by linearity and density this shows that t t t f 0 for all f in the closed linear span of e j j n this implies that t t t is a finite rank operator of rank at most n and hence compact for functions c 2 t a more precise result will be proved in section 14 5 d proof of theorem 7 29 it follows from the lemma that the mapping j c t l h 2 d k h 2 d given by j t k h 2 d is multiplicative j j j c t if is zero free then 1 defines an element of c t and j 1 j j j 1 j 1 i k h 2 d stated differently there exist compact operators k l k h 2 d such that with s t 1 we have st i k t s i l by atkinson s theorem this implies that t is fredholm it remains to compute the index to this end let w n be the winding number of and let h 0 1 c 0 be a homotopy from to en by the continuity of the mapping 7 t and dieudonne s theorem theorem 7 26 the mapping t 7 ind tht t 0 1 is locally constant and hence constant where ht s h t s since h 0 and h 1 en in particular we obtain ind t ind ten moreover from ten j n c je j p j n c je j n j n 0 c je j n 248 compact operators we see that dimn ten 0 n 0 n n 6 1 codimr ten n n 0 0 n 6 1 so that ind ten n the following result clarifies why the symbol was assumed to be zero free theorem 7 31 hartman wintner if c t is such that the toeplitz operator t is fredholm on h 2 d then is zero free proof since n t is finite dimensional and hence complemented we have a direct sum decomposition h 2 d x 0 n t denote by the projection onto n t along this decomposition the operator t restricts to an injective bounded operator from x 0 onto r t and the latter is a closed subspace of h 2 d by proposition 7 22 hence by the open mapping theorem there exists a constant c 0 such that t f 0 c f 0 f 0 x 0 for f h 2 d write f f 0 g along the above decomposition then since f c f 0 g is an equivalent norm on h 2 d t f f t f 0 g c f 0 g c f where c 0 is a constant independent of f for all g l 2 t we thus obtain t pg pg c pg c g i p g where p is the riesz projection let u l l 2 t be the bounded operator given by ug exp i g applying the preceding estimate to ung in place of g and using that un and u n are isometric for all g l 2 t we obtain u nt pung u n pung u n i p ung c g 7 13 for every trigonometric polynomial g we have u npung g in l 2 t since these polynomials are dense in l 2 t and the operators u all have norm one it follows that u npung g g l 2 t this implies that u n i p ung 0 for all g l 2 t and using that u commutes with m u nt pu ng u npm pu ng u npun m u npun g m g for all g l 2 t also ung h 0 for all g h l 2 t and therefore since is of finite rank pung 0 g l 2 t 7 3 fredholm theory 249 passing to the limit in 7 13 we obtain m g c g g l 2 t since t t is fredholm we also obtain m g m g c g g l 2 t it follows that m is invertible indeed the inequality for m gives injectivity and closed range and the inequality for m gives that m has dense range this is only possible if is zero free the inverse is then given by m 1 corollary 7 32 for all c t the norm of the toeplitz operator t is given by t proof denote by m the pointwise multiplication operator f 7 f on l 2 t we have m t if t t is invertible then t is fredholm with index zero and therefore is zero free by theorem 7 31 but then m m is invertible this argument shows that m t now the corollary follows from the inequalities sup t sup m 6 sup t 6 t 6 in the next theorem we denote by tz the toeplitz operator with symbol z z its adjoint is the toeplitz operator t z with symbol z z identifying h 2 d with 2 n by identifying the function z 7 zn with the nth unit vector en the operators tz and tz are the right and left shift on 2 n respectively with these identifications in mind the following theorem can be interpreted as giving a precise description of the closed subalgebra of 2 n generated by the right and left shift theorem 7 33 coburn let t denote the closed subalgebra in l h 2 d generated by tz and t z denoting by k the space of compact operators on h 2 d we have 1 t t k c t k k 2 the mapping t k 7 induces a multiplicative isometric isomorphism t k hc t as a consequence the representation of elements in t as the sum of a toeplitz operator and a compact operator is unique and we have the short exact sequence 0 k t c t 0 250 compact operators in the final statement we used standard terminology from algebraic topology a se quence of mappings is exact if the range of every operator in the sequence equals the null space of the next operator in the sequence in the proof as well as in later chapters we need the following notation for elements g h of a hilbert space h we denote by g h the rank one operator on h defined by g h x x h g x h the bar in this notation serves to emphasise the fact that is not a tensor product but rather its sesquilinear counterpart in the sense that for all c k and x h we have cg h c g h g ch c g h for norm one vectors h h the operator h h is the orthogonal projection onto the one dimensional subspace of h spanned by h proof the crucial observation is that for all c t and k k we have t k t 7 14 in order to prove this it suffices to show that t t k for this implies the claim via t k r t k r t t to prove the spectral inclusion we argue as follows suppose c is such that t k t k is invertible then this operator is fredholm with index 0 by dieudonne s theorem this implies that t is fredholm with index 0 it remains to prove that this implies the invertibility of t suppose now that c t is such that t has index 0 but is not invertible then t has a nontrivial null space by proposition 7 27 t t has index 0 and fails to be invertible hence also this operator has a nontrivial null space this means that there are nonzero g h h 2 d such that p g p h 0 that is g and h have only negative fourier coefficients invoking some standard results from the theory of hardy spaces see the notes this can be shown to imply 0 applying the preceding argument to it follows that if t were non invertible then but then t k k is compact and hence noninvertible contradicting our assumption this concludes the proof of 7 14 1 the inclusion is an immediate consequence of lemma 7 30 to prove the inclusion we must prove that t contains all toeplitz operators with continuous symbol and all compact operators given a function c t we use the stone weierstrass theorem to find a sequence of trigonometric polynomials pn in c t then tpn t in operator norm by lemma 7 32 since tpn pn tz we have tpn t and since t is closed this implies t t 7 3 fredholm theory 251 we prove next that t contains every compact operator let s tz for brevity where z is shorthand for the function z 7 z we have s s i and i ss p 0 the orthogonal projection onto the constant functions these identities show that both i and p 0 belong to t clearly i t k is a closed ideal in t which is closed under taking adjoints and since p 0 is compact we have p 0 i we will show that i k fix arbitrary f g h 2 d and 0 there is a polynomial p such that p s 1 f then p 0 p s i and p 0 p s 1 f sup g h 1 p 0 p s g 1 f g h sup g h 1 g p s 1 g f 1 h p s 1 f in the same way for any g h 2 d and 0 there is a polynomial q such that q s 1 g then q s 1 f g f sup h h 1 q s 1 f h h g f h h sup h h 1 q s 1 h g h h f q s 1 g f f since 0 was arbitrary and i is closed it follows that every rank one operator g f is contained in i by linearity the same is true for every finite rank operator since the finite rank operators are dense in k by proposition 7 6 it follows that k i 2 from 7 14 it follows that t k inf k k t k t together with the trivial inequality t infk k t k we conclude that t k t this shows that the mapping t k 7 is well defined and isometric clearly it is surjective and therefore it is an isometric isomorphism its multiplicativity follows from lemma 7 30 using some elementary facts from the theory of c algebras a more transparent al ternative proof of theorem 7 31 can be given as a corollary to theorem 7 33 this proof is sketched in the notes to this chapter 252 compact operators remark 7 34 identifying h 2 d with 2 n as indicated above the short exact se quence of the theorem induces a short exact sequence 0 k 2 n t 2 n c t 0 where k 2 n and t 2 n denote respectively the compact operators acting on 2 n and the closed algebra generated by the left and right shift in 2 n and is the operator induced by under the identifications made problems 7 1 give an alternative proof of proposition 7 5 by using the equivalence of compact ness and sequential compactness 7 2 let x and y be banach spaces prove that if x is infinite dimensional and t l x y is compact then there exists a sequence xn n 1 of norm one vectors in x such that limn t xn 0 in y 7 3 let mn n 1 be a bounded scalar sequence a for 1 6 p show that the multiplication operator cn n 1 7 mncn n 1 is compact on p if and only if limn mn 0 b does the same result hold for and for c 0 hint compare with problem 2 32 7 4 let 16 p q 6 a prove that the inclusion mapping p q is not compact b prove that the inclusion mapping lq 0 1 lp 0 1 is not compact hint look up khintchine s inequality for the rademacher functions fn sign sin 2 2 n 7 5 for 16 p 6 consider the bounded operator tp lp 0 1 c 0 1 tp f t t 0 f s ds t 0 1 a show that if 1 p 6 then tp is compact b is t 1 compact 7 6 for any fixed k 1 find a bounded operator t acting on a hilbert space such that t k 1 is compact but t k is not 7 7 let g c 0 1 be given show that the multiplication operator tg f 7 f g on c 0 1 is compact if and only if g 0 problems 253 7 8 let x and y be banach spaces show that an operator t l x y is compact if and only if there is a sequence x n n 1 in x such that limn x n 0 in x and t x 6 sup n 1 x x n x x hint for the if part consider t as the composition of mappings x 7 x x n n 1 7 t x and use the result of the preceding problem for the only if part use the result of problem 1 23 and the compactness of t 7 9 the aim of this problem is to show how part 1 of theorem 7 11 can be deduced from part 2 let x be a banach space and let t l x be compact a using proposition 6 17 show that every nonzero t is an eigen value b using part a and part 2 of theorem 7 11 deduce that every nonzero t is an eigenvalue 7 10 let x be a banach space show that for a bounded operator t l x the fol lowing assertions are equivalent 1 t is compact 2 exp t i is compact hint to prove the implication 2 1 show that for large enough integers k we have t exp kt i fk t where fk z z ekz 1 is holomorphic in a neighbourhood of t 7 11 let t be a compact operator on a banach space x let 0 6 t and let be its algebraic multiplicity let x p x be the range of the spectral projection associated with the point prove the following assertions a a vector x x belongs to x if and only if t kx 0 for some k 1 b for all x x we have t x 0 c if t nx 0 for all x x then n 7 12 let x be a banach space in this problem we write t for the element t k x of the calkin algebra l x k x show that the multiplication s t st is well defined on l x k x and satisfies s t l x k x 6 s l x k x t l x k x in the terminology introduced in the notes to this chapter this shows that the calkin algebra l x k x is a unital banach algebra 7 13 let x be a banach space and t l x be a bounded operator show that if t k is compact for some integer k 1 then i t is fredholm what is its index 254 compact operators 7 14 prove that the two definitions of the winding number of a piecewise c 1 curve discussed in section 7 3 agree 7 15 let l t prove the following assertions a the operator m on l 2 t defined by m f f f l 2 t maps h 2 d into itself if and only if h d that is upon identifying with a function in l 2 t whose negative fourier coefficient vanish we have l t b if l t and h t then the associated toeplitz operators satisfy t t f t f f h 2 d c if h t then the associated toeplitz operators satisfy t t f t f f h 2 d 7 16 using notation introduced in section 7 3 d prove the following uniqueness result if t t satisfies t t k t l with c t and k l k h 2 d then and k l 7 17 show that t t is fredholm if and only if t t k where c t is zero free and k k h 2 d 8 bounded operators on hilbert spaces the identification of a hilbert space h with its dual via the riesz representation theorem makes it possible to consider a bounded operator t and its adjoint simultaneously on h this leads to the important classes of selfadjoint unitary and normal operators their spectral theory is particularly rich its full power comes to bear only in the next chapter where we prove the spectral theorem for bounded normal operators the present chapter discusses the elementary theory and for normal operators t establishes a generalisa tion of the holomorphic calculus to a calculus for continuous functions on the spectrum t using this calculus we prove a number of nontrivial results such as the exis tence of a unique positive square root of a positive operator and a polar decomposition for general bounded operators in the last section we establish the celebrated sz nagy theorem on the existence of unitary dilations for hilbert space contractions 8 1 selfadjoint unitary and normal operators throughout this chapter h is a complex hilbert space the following proposition is key to several proofs in this chapter the example of rotation over 12 in r 2 shows that it fails for real hilbert spaces proposition 8 1 if t l h satisfies t x x 0 for all x h then t 0 proof for all x y h from t x y x y 0 we obtain t x y ty x 0 8 1 this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 255 256 bounded operators on hilbert spaces replacing y by iy we obtain i t x y i ty x 0 multiplying both sides with i gives t x y ty x 0 8 2 adding 8 1 and 8 2 gives t x y 0 for all x y h this implies the result the trick used in the proof is called polarisation definition 8 2 normal unitary selfadjoint and positive operators an operator t l h is called positive if t x x 0 for all x h selfadjoint if t t unitary if t t t t i normal if t t t t here t is the hilbert space adjoint of t cf section 4 3 b these classes of opera tors can be viewed as operator analogues of the positive real numbers the real numbers the complex numbers of modulus one and the real numbers the positive real numbers respectively furthermore orthogonal projections are analogous to the boolean set 0 1 a number of results support this view every positive operator is selfadjoint every selfadjoint operator is the difference of two positive operators every selfadjoint operator and every unitary operator is normal the first assertion follows from proposition 8 1 indeed if t is positive then t x x is positive and therefore t x x x t x t x x t x x that is t t x x 0 for all x x the second follows from the spectral theorem in the next chapter see problem 9 12 and the third is obvious from the definitions continuing our list every invertible operator is the composition of an invertible positive operator and a unitary operator a bounded operator is unitary if and only if it is the complex exponential of a self adjoint operator the first result and the if part of the second will be proved in the present chapter the only if part is a consequence of the spectral theorem see problem 9 13 in terms of spectra we have the following characterisations a normal operator is unitary if and only if its spectrum is contained in the unit circle a normal operator is selfadjoint if and only if its spectrum is contained in the real line a normal operator is positive if and only if its spectrum is contained in 0 a normal operator is an orthogonal projection if and only if its spectrum is contained in 0 1 8 1 selfadjoint unitary and normal operators 257 furthermore normal projections are orthogonal let us begin by proving an operator analogue of the decomposition of a complex number into real and imaginary parts proposition 8 3 for every operator t l h there exist unique selfadjoint operators a b l h such that t a ib proof the operators a 12 t t and b 12 i t t are selfadjoint and t a ib suppose we also have t a ib with a and b selfadjoint put u b b then iu iu iu and also iu i b b t a t a a a so iu a a a a iu it follows that iu iu and therefore b b this in turn implies a a a complex number satisfies z 1 if and only if there is a real number x such that z eix the operator analogue of the if part is contained in the next proposition proposition 8 4 if t l h is selfadjoint then eit is unitary proof from the expansion eit n 0 in n t n we see that eit n 0 i n n t n e it it is elementary to check that eit e it e it eit i by writing out the defining power series and multiplying them alternatively this identity follows from the multiplicativity of the entire calculus of t applied with f z exp iz and g z exp iz we have the following simple characterisation of unitary operators proposition 8 5 for an operator u l h the following assertions are equivalent 1 u is unitary 2 u is surjective and ux x for all x h 3 u is surjective and ux uy x y for all x y h proof 1 3 if u is unitary then u is invertible with inverse u 1 u and therefore u is surjective moreover ux uy x u uy x y 3 2 take x y 2 1 we have u ux x ux ux ux 2 x 2 x x for all x h and therefore u u i it follows that u is a left inverse to u the assumptions further imply that u is surjective and injective hence invertible the inverse must be equal to the left inverse which is therefore u it follows that also uu i the right shift on 2 shows that the surjectivity assumption cannot be omitted from 2 and 3 example 8 6 the left and right shifts on 2 z are unitary indeed the adjoint of the left right shift is the right left shift so in either case the adjoint equals the inverse similarly left and right translations on l 2 r are unitary 258 bounded operators on hilbert spaces example 8 7 the fourier plancherel transform on l 2 rd is unitary this follows from theorem 5 26 and proposition 8 5 projections in hilbert spaces are orthogonal if and only if they are selfadjoint proposition 8 8 for a projection p l h the following assertions are equivalent 1 p is orthogonal that is its null space and range are orthogonal 2 p is selfadjoint proof 1 2 if p is orthogonal then x px py for all x y h noting that x px n p since p x px px p 2 x px px 0 and py r p therefore x py px py x px py px py and similarly px y px py px y py px py so px y x py and p is selfadjoint 2 1 if p is a selfadjoint projection then x px py p x px y p x px y 0 since p p 2 since every element in n p is of the form x px this shows that n p r p that is the projection p is orthogonal we now turn to the study of some spectral properties of hilbert space operators from proposition 6 18 we recall that for every bounded operator t on a banach space we have t t a similar result holds for the spectrum of the hilbert space adjoint t proposition 8 9 for all t l h we have t t where the bar denotes complex conjugation proof the proof follows the lines of proposition 6 18 but is simpler because of the riesz representation theorem the idea is to prove that t if and only if t and that in this case r t r t first suppose that t then t r t t r t r t t i i in the same way it is shown that r t t i it follows that t and r t r t 8 1 selfadjoint unitary and normal operators 259 if t applying what we just proved to t gives t t and r t r t r t for unitary operators we have the following simple result proposition 8 10 if u l h is unitary then u is contained in the unit circle proof since u is an invertible isometry this follows from corollary 6 14 alternatively we can apply the spectral mapping theorem of the holomorphic cal culus which gives u u 1 u 1 since both u and u are contained in the closed unit disc u must therefore be contained in the unit circle in the converse direction a normal operator whose spectrum is contained in the unit circle is unitary the proof of this fact is harder and will be given in corollary 9 18 the next result describes the spectrum of selfadjoint operators theorem 8 11 spectrum of selfadjoint operators an operator t l h is selfad joint if and only if t x x r for all x h if t is selfadjoint on h then t sup x 61 t x x max m m and t m m m m t where m inf x 1 t x x and m sup x 1 t x x proof if t x x r then t x x x t x t x x t x x hence if t x x r for all x h then t t by proposition 8 1 applied to t t conversely if t t then t x x x t x t x x and therefore t x x r next we prove that t r to this end let i with r and 6 0 we wish to prove that t for all x h we have t x x t x x x x t x x i x x x 2 using that t x x r in the last step by proposition 1 21 this implies that t is injective and has closed range replacing by we also conclude that t is injec tive and has closed range by proposition 4 31 this implies that t t has dense range we conclude that t is both injective and surjective hence invertible and therefore t by now we have shown that t r next we show that t m m let m with 0 then by the definition of m for all x h with x 1 we have t x x t x x m x x t x x x x x x x 2 the same argument as before shows that t is both injective and surjective hence 260 bounded operators on hilbert spaces invertible and therefore t this proves that m t applying this result to t and replacing m m with m m we also obtain m t this completes the proof that t m m we prove next that t max m m this implies t sup x 61 t x x re placing t by t if necessary we may assume that m 6 m clearly we then have m sup x 1 t x x 6 t to prove the converse inequality t 6 m note that for all x h with x 1 and all 0 we have 4 t x 2 t x 1 t x x 1 t x t x 1 t x x 1 t x 6 m x 1 t x 2 m x 1 t x 2 6 m x 1 t x 2 m x 1 t x 2 2 m 2 x 2 1 2 t x 2 2 m 2 1 2 t x 2 where the first inequality follows from the definitions of m and m and the next equality uses the parallelogram identity taking 2 t x we obtain for all x h with x 1 4 t x 2 6 2 m t x t x 4 m t x it follows that t x 6 m for all x h with x 1 so t 6 m the last thing to prove is that m m t we prove this for m the result for m follows by considering t replacing t by t m we may assume that 0 m 6 m then t x x 0 for all x h and therefore m sup x 1 t x x sup x 1 t x x t choose a sequence xn n 1 of norm one vectors such that limn t xn xn m then m t xn 2 m t xn m t xn m 2 xn 2 2 m t xn xn t xn 2 6 m 2 2 m t xn xn t 2 m 2 2 m t xn xn m 2 which tends to m 2 2 m 2 m 2 0 as n this implies that m t cannot be invertible for if it was with inverse s then xn s m t xn 6 s m t xn 0 which contradicts the fact that xn 1 this proves that m t in the converse direction a normal operator whose spectrum is contained in the real line is selfadjoint this will be proved in corollary 9 18 it is an immediate consequence of theorem 8 11 that the norm of a selfadjoint op erator equals its spectral radius more generally this is true for normal operators see proposition 8 13 this equality of norm and spectral radius can sometimes be used to 8 1 selfadjoint unitary and normal operators 261 determine the norm of an operator we illustrate this by determining the norm of the volterra operator example 8 12 volterra operator from example 1 31 we recall that the volterra op erator is the operator t l l 2 0 1 given by the indefinite integral t f s s 0 f t dt f l 2 0 1 s 0 1 the operator t fails to be selfadjoint it even fails to be normal see problem 8 12 but we have t s where s l l 2 0 1 is defined by s f s 1 s 0 f t dt f l 2 0 1 s 0 1 as is immediate from the identity s f s t f 1 s this identity also implies f s g s f g 1 0 t f 1 s g s ds 1 0 t f s g 1 s ds 1 0 s 0 f t g 1 s dt ds 1 0 1 t f t g 1 s dsdt 1 0 1 t 0 f t g s dsdt 1 0 f t t g 1 t dt f sg which shows that s is selfadjoint by example 7 4 s is compact and therefore by theo rem 7 11 every nonzero s is an eigenvalue to compute the spectral radius r s we therefore have to determine the set of nonzero eigenvalues of s suppose that 6 0 is an eigenvalue of s and let f be an eigenfunction then f s 1 1 s 0 f t dt 8 3 and the right hand side is a continuous function of s it follows that f c 0 1 then the same arguments shows that in fact f c 1 0 1 and applying the same argument once more gives f c 2 0 1 differentiating 8 3 twice gives f 0 f 1 0 f s f 1 s s 0 1 2 f s f s s 0 1 the reader may check that these equations admit a solution if and only if 1 2 n for some n z and that the solutions fn s cos 2 n s are indeed eigenfunctions of s the largest eigenvalue of s therefore equals 2 we conclude that t s r s 2 262 bounded operators on hilbert spaces the remainder of this section is devoted to studying some spectral properties of nor mal operators our first aim is to prove that the spectral radius of a normal operator equals the operator norm for selfadjoint operators this has already been observed as a consequence of theorem 8 11 and for unitary operators this is an immediate conse quence of proposition 8 10 proposition 8 13 a operator t l h is normal if and only if t x t x x h if t is normal then t n t n for all n n and therefore r t t proof if t is normal then t x 2 t x t x x t t x x t t x t x t x t x 2 in the converse direction the equality implies t t t t x x 0 for all x h and therefore t t t t 0 by proposition 8 1 this proves the first assertion if t is normal then for all norm one vectors x h we have t t x 2 t t 2 x x t 2 t 2 x x t 2 x 2 and therefore since t t t 2 by proposition 4 28 t 2 t t t 2 8 4 suppose the identity t n t n has been proved for n 2 k then for all norm one vectors x h t x 2 k t kx 2 t t kx t k 1 x 6 t t kx t k 1 x t k 1 x t k 1 x 6 t k 1 t k 1 t k 1 t k 1 using 8 4 and the inductive assumption this results in the identity t k 1 6 t k 1 since the reverse inequality holds trivially we conclude that t k 1 t k 1 the final assertion follows from the spectral radius formula theorem 6 23 recall that c is called an approximate eigenvalue of t if there exists a sequence xn n 1 in x such that xn 1 for all n 1 and limn t xn xn 0 by propo sition 6 17 the boundary spectrum of any bounded operator on a banach space consists of approximate eigenvalues for normal operators on hilbert spaces more is true proposition 8 14 every point in the spectrum of a normal operator t l h is an approximate eigenvalue proof suppose c is not an approximate eigenvalue then t is injective other wise would be an eigenvalue and x t x x t x implies that also t is injective that is t has dense range let us prove that t has closed range 8 1 selfadjoint unitary and normal operators 263 let xn n 1 be a sequence in h such that limn t xn y in h then lim n sup n m n t xn xm 0 unless we have limm n xn xm 0 normalisation allows us to construct an approx imate eigensequence to arrive at a contradiction thus limm n xn xm 0 which means that xn n 1 is cauchy and therefore converges to a limit x then y t x we have shown that t is surjective since this operator is also injective it follows that t theorem 7 11 implies that every nonzero element of the spectrum of a compact oper ator is both an isolated point and an eigenvalue the final result of this section states that for normal operators on a hilbert space all isolated points in the spectrum are eigenval ues no compactness assumption is needed normality cannot be omitted the volterra operator has spectrum 0 but 0 is not an eigenvalue see problem 8 12 if t is a bounded operator on h for c we set e x x t x x thus is an eigenvalue for t if and only if e is nonzero we recall that spectral projections have been defined in theorem 6 25 theorem 8 15 isolated points are eigenvalues let t l h be a normal operator and let be an isolated point in t then is an eigenvalue for t and the spectral projection p corresponding to equals the orthogonal projection p onto e the proof uses the following simple observation lemma 8 16 let t l h if y be a closed subspace of h then 1 if y is invariant under t then y is invariant under t 2 if y is invariant under t and t then y is invariant under t and t and t y t y and t y t y as operators in l y and l y respectively in particular if t is selfadjoint respectively normal and y is invariant under t and t then t y and t y are selfadjoint respectively normal proof if y is invariant under t then for all y y and y y we have y t y ty y 0 this proves 1 the first assertion of 2 follows as well and if y is invariant under t and t then for all y y y we have y t y y t y y y ty y y t y y t y y this proves the first identity of 2 the second is proved in the same way the final assertion is an immediate consequence of 2 264 bounded operators on hilbert spaces proof of theorem 8 15 replacing t by t we may assume that 0 let p 0 denote the spectral projection corresponding to 0 and denote its range by e 0 we wish to prove that 0 is an eigenvalue for t that e 0 e 0 and that p 0 is an orthogonal projection once these facts have been proved it follows that p 0 and p 0 are orthogonal projections onto the same closed subspace of h and therefore are equal as we have seen in theorem 6 25 t maps e 0 into itself and if we denote by t 0 t e 0 the restriction of t to e 0 then t 0 0 in particular this implies that e 0 6 0 trivially every operator on 0 has empty spectrum since t is normal the formula for the spectral projection of theorem 6 25 implies t p 0 x 1 2 i t r t xd 1 2 i r t t xd p 0 t x where is a circular contour of small enough radius surrounding 0 this shows that t leaves e 0 invariant hence by lemma 8 16 the restricted operator t 0 is normal as an operator on e 0 by proposition 8 13 t 0 r t 0 0 and therefore t 0 0 this means that t x 0 t 0 x 0 0 for all x 0 e 0 so e 0 e 0 moreover since e 0 is nontrivial 0 is an eigenvalue of t for all y e 0 we have ty 0 and therefore p 0 y 1 2 i r t yd 1 2 i r t i 1 t yd 1 2 i 1 yd y with as before it follows that y r p 0 e 0 this proves the inclusion e 0 e 0 it remains to be shown that p 0 equals the orthogonal projection onto e 0 since p 0 is normal this follows from the integral formula for p 0 this is a consequence of corollary 9 18 the reader may check that no circularity is introduced the proof of this corollary does not depend on the present result corollary 8 17 the geometric and algebraic multiplicity of every nonzero element in the spectrum of a compact normal operator coincide this justifies the terminology multiplicity to denote the geometric and algebraic mul tiplicity of such a point we have the following commutation theorem for normal operators theorem 8 18 fuglede putnam rosenblum if t l h is normal and s l h is bounded and satisfies st t s then st t s proof we prove the more general result that if t 1 t 2 are normal and s is bounded such that st 1 t 2 s then st 1 t 2 s 8 1 selfadjoint unitary and normal operators 265 step 1 let v l h be an arbitrary bounded operator expanding the exponential as a power series and taking adjoints termwise we obtain exp v v exp v v exp v v 1 and therefore exp v v is unitary step 2 by induction the assumption st 1 t 2 s implies st n 1 t n 2 s for all n n and therefore sexp t 1 exp t 2 s since the normality of an operator t implies exp t t exp t exp t this identity and the result of step 1 imply exp t 2 sexp t 1 exp t 2 t 2 exp t 2 sexp t 1 exp t 2 t 2 sexp t 1 exp t 1 exp t 2 t 2 sexp t 1 t 1 since the two exponentials on the right hand side are unitary this gives exp t 2 sexp t 1 s applying this inequality to the normal operators zt 1 and zt 2 it follows that exp zt 2 sexp zt 1 s so the entire function f z exp zt 2 sexp zt 1 is bounded by liouville s theo rem it is constant so in particular exp t 2 sexp t 1 f 1 f 0 s that is sexp t 1 exp t 2 s expanding the exponentials as power series and comparing terms we obtain st 1 t 2 s we finish with an observation about relative spectra let a l h be a unital closed subalgebra that is a is a unital subalgebra of l h closed under taking adjoints for such subalgebras we have the following improvement to proposition 6 19 proposition 8 19 let a l h be a unital closed subalgebra and let t a then a t t proof by proposition 6 19 and the observation preceding it for all t a we have a t t a t first let s a be a selfadjoint operator we claim that a s r indeed if we had a s with 6 r then a s would have boundary points not belonging to r but a s s r since s is selfadjoint this proves the claim it implies that a s a s and since also a s s a s we obtain a s s suppose next that t a is invertible in l h then also t is invertible in l h and hence so is s t t moreover since a is closed under taking adjoints and com positions the operator s t t belongs to a by what we just proved a s s so t t is invertible in a but then t 1 t t 1 t belongs to a as well 266 bounded operators on hilbert spaces we have shown that if t l h and 0 t then 0 a t applying this result to t gives the inclusion t a t that is a t t 8 2 the continuous functional calculus in chapter 6 we have seen how to associate a bounded operator f t with a bounded operator t when f is holomorphic in an open neighbourhood of t here we will prove that for normal operators t acting on a hilbert space the functional calculus f 7 f t can be extended to continuous functions on t 8 2 a the continuous functional calculus for selfadjoint operators we begin with the case of selfadjoint operators theorem 8 20 continuous functional calculus for selfadjoint operators let t l h be a selfadjoint operator then there exists a unique continuous linear mapping f 7 f t from c t to l h with the following properties i if f z zn with n n then f t t n ii for all f g c t we have f g t f t g t iii for all f c t we have f t f t iv for all f c t we have f t f the operators f t are normal and f t is selfadjoint if and only if f is real valued proof for polynomials p z nn 0 cnz n we define p t nn 0 cnt n these opera tors are normal and satisfy i ii and iii moreover by the spectral mapping theorem for the holomorphic calculus p t sup p t sup p t p and therefore iv holds by the weierstrass approximation theorem the polynomials are dense in c t therefore by iv and an approximation argument the mapping p 7 p t has a unique extension to an isometry from c t into l h and ii iv again hold since normality is inherited in passing to operator norm limits the operators f t are normal property iii implies that if f is real valued then f t is selfadjoint conversely if f t is selfadjoint then f t f t by property iii and therefore f f c t 0 by property iv so f f is real valued 8 2 the continuous functional calculus 267 8 2 b the continuous functional calculus for normal operators every polynomial in the real variables x and y can be written as a polynomial in the variables z and z by substituting z x iy z x iy for example x 2 y 2 zz for polynomials p z z ki j 0 ci jz iz j and normal operators t l h we define p t t k i j 0 ci jt it j the crucial result that enables us to extend the continuous functional calculus to normal operators is the following spectral mapping theorem proposition 8 21 if t l h is normal and p is a polynomial in z and z then p t t p t proof by proposition 8 14 every t is an approximate eigenvalue of t that is there exists a sequence xn n 1 of norm one vectors such that limn t xn xn 0 then limn t xn xn 0 by proposition 8 13 this implies limn p t t xn p xn 0 so p is an approximate eigenvalue for p t t in particular p p t t this proves the inclusion for the inclusion fix an arbitrary p t t we wish to prove the exis tence of a t such that p step 1 fixing 0 we claim that there is a nonzero closed subspace y of h invariant under both t and t such that p t t i y 8 5 to prove the claim let s p t t i this operator is normal and we have 0 s let r s s arguing as above we find that 0 r consider the continuous function f 0 0 1 given by f t 1 06 t 6 2 2 1 t 26 t 6 0 t and let f r be the selfadjoint operator obtained from the continuous functional calculus for selfadjoint operators theorem 8 20 we will show that y x h f r x x has the desired properties since t commutes with r it commutes with f r and therefore y is invariant un der t by the same reasoning y is invariant under t moreover by the properties of 268 bounded operators on hilbert spaces continuous functional calculus for all y y we have ry r f r y 6 t 7 t f t c r y t 7 t f t c 0 y 6 y this implies sy 2 ry y 6 ry y 6 y 2 this gives 8 5 the claim will be proved once we have checked that y is nonzero if f 2 t 6 0 for some t 0 then 2 t 6 and therefore f t 1 by multiplicativity i f r f 2 r t 7 1 f t f 2 t c r 0 where f 2 r g r with g t f 2 t it follows that r f 2 r y but r f 2 r is nonzero since f 2 r t 7 f 2 t c r f 0 1 step 2 given 0 let y be the closed subspace of step 1 since y is nonzero we have t y 6 by theorem 6 11 pick an arbitrary t y since y is invariant under both t and t the restricted operator t y is normal as an operator in l y by lemma 8 16 and therefore is an approximate eigenvalue of t y and hence of t in particular we can find a norm one vector y y such that ty y step 3 up to this point 0 was fixed applying step 2 to a sequence n 0 we obtain nonzero closed subspaces yn of h norm one vectors yn yn and points n t such that tyn nyn 0 as n passing to a subsequence we may assume that n and then tyn yn 0 as n it follows that is an approximate eigenvalue of t with approximate eigensequence yn n 1 by the argument of the first part of the proof lim n p t t yn p yn 0 on the other hand by the inequality of step 1 applied to n we also have p t t yn yn n for every n 1 and therefore we must have p with this theorem at hand we can extend the continuous functional calculus to normal operators repeating the proof of theorem 8 20 we obtain the following result theorem 8 22 continuous functional calculus for normal operators let t l h be a normal operator then there exists a unique continuous linear mapping f 7 f t from c t to l h with the following properties i if f z zmzn with m n n then f t t mt n ii for all f g c t we have f g t f t g t 8 2 the continuous functional calculus 269 iii for all f c t we have f t f t iv for all f c t we have f t f the operators f t are normal and f t is selfadjoint if and only if f is real valued the next theorem extends proposition 8 21 to continuous functions defined on t theorem 8 23 spectral mapping theorem if t l h is normal then for all f c t we have f t f t proof the proof of the inclusion f t f t follows the lines of theorem 6 21 indeed if 6 f t the function g 1 f with f z f z is contin uous on t and by multiplicativity we obtain g t f t f t g t f g t 1 t i so f t and r f t g t this gives the stated inclusion for the converse inclusion let t be arbitrary and fixed and let f using the stone weierstrass theorem choose polynomials pn such that lim n sup z t pn z z f z 0 we may assume that pn then by proposition 8 21 pn t t also by property iv of the functional calculus limn pn t t f t 0 by lower semicontinuity proposition 6 15 this implies f t corollary 8 24 let t l h be a normal operator and let f c t then f t is positive if and only if f is nonnegative proof if f is nonnegative the spectral mapping theorem gives f t f t 0 and therefore the selfadjoint operator f t is positive by theorem 8 11 con versely if f t is positive then f t 0 by theorem 8 11 and therefore f t 0 by the spectral mapping theorem the next theorem extends proposition 6 22 to continuous functions defined on t theorem 8 25 composition let t l h be normal for all f c t and g c f t we have g f c t and g f t g f t proof the spectral mapping theorem implies that f t f t and therefore g f is well defined as an element of c t first let p z zmzn with m n n then by the properties of the continuous calculus p f t f t m f t n f m f n t p f t 270 bounded operators on hilbert spaces by linearity the this identity extends to polynomials p if g c f t is an arbitrary continuous function the identity follows by approximating g uniformly by polynomials pn via the stone weierstrass theorem to obtain pn f t g f t pn g c f t 0 as n and pn f t g f t pn f g f c t 0 as n we finally check consistency with the holomorphic calculus theorem 8 26 let t l h be normal if f h where is an open set contain ing t then f t agrees with the operator defined through the holomorphic calculus k 1 k 2 u 1 u 2 1 2 figure 8 1 proof of theorem 8 26 t k 1 k 2 1 2 proof the set is the union of at most countably many disjoint connected open sets and by compactness the set t is contained in finitely many of them hence there is no loss of generality in assuming that t k j 1 k j k j 1 j with the sets k j compact and contained in the connected open sets j which are disjoint choose bounded open sets u j such that k j u j u j j k 1 k in such a way that c k j 1 u j is the union of at most finitely many disjoint connected open sets finally let k j 1 j be an admissible contour for t in the sense described in section 6 2 with j contained in u j by runge s theorem there exists a sequence of rational functions rn such that rn f uniformly in u where u k j 1 u j the operators rn t agree in the continuous calcu lus and the holomorphic calculus because this equality holds in the case op polynomials and for resolvents and equality for rational functions follows from this by the multi plicativity of both calculi denoting by f c t and f h t the operators defined by the continuous calculus and the holomorphic calculus respectively it follows that f c t lim n rn t f h t 8 2 the continuous functional calculus 271 with convergence in operator norm the first equality is a consequence of property iv and the second follows from the estimate rn t f h t 6 1 2 rn z f z r z t dz 6 2 rn f c u sup z r z t with the length of 8 2 c applications of the continuous functional calculus we now turn to some applications of the continuous functional calculus proposition 8 27 square roots if t l h is positive there exists a unique positive operator s l h such that s 2 t henceforth this operator s will be denoted by t 1 2 proof since t is positive t is selfadjoint and its spectrum is contained in 0 by theorem 8 11 hence f t t is a well defined continuous function on t the operator s f t is positive by theorem 8 20 and it satisfies s 2 t by the properties of the continuous functional calculus it remains to prove uniqueness suppose s is another positive operator with the property that s 2 t with f t t g t t 2 and h t t we have by the properties of the continuous functional calculus and theorem 8 25 f s 2 f g s f g s h s s it follows that s f s 2 f t f s 2 s this completes the uniqueness proof definition 8 28 modulus of an operator the modulus of an operator t l h is the positive operator t t t 1 2 corollary 8 29 if t l h is normal operator then t f t where f z z proof let g z zz then f 2 g and therefore t 2 t t g t f 2 t f t 2 by the multiplicativity of the continuous functional calculus since by corol lary 8 24 the operator f t is positive the result follows by taking square roots we continue with a polar decomposition result in view of future applications we phrase it for bounded operators t l h k where h and k are hilbert spaces the modulus of such an operator is the positive operator t t t 1 2 on h an operator u l h k will be called unitary if it is isometric and surjective a partial isome try is a bounded operator v l h k for which there exists orthogonal direct sum decomposition h h 0 h 0 such that v is isometric from h 0 into k and zero on h 0 272 bounded operators on hilbert spaces theorem 8 30 polar decomposition let t l h k the following assertions hold 1 t admits a representation t u t with u a partial isometry from h to k which is isometric from r t onto r t 2 if t is invertible then t admits a unique representation t u t with u unitary from h onto k proof 1 from t x 2 t t x x t x t x t x 2 it follows that the mapping u 0 t x 7 t x viewed as a linear operator from r t onto r t is well defined and isometric and by density it extends to an isometry from r t onto r t moreover t u 0 t along the orthogonal decomposition h r t r t we now extend u 0 identically zero on r t 2 the operator t t is positive and invertible hence t t t 1 2 is invertible as well by the spectral mapping theorem set u t t 1 from u u t 1 t t t 1 t 1 t 2 t 1 i and the fact that u is invertible it follows that u u 1 and u is unitary to prove that u is unique suppose that t u t u t with both u and u unitary then t u u t u u t and since t is invertible this implies u u i multiplying both sides with u gives u u 8 3 the sz nagy dilation theorem the last section of this chapter is devoted to a proof of the celebrated sz nagy dilation theorem which asserts that every hilbert space contraction has a unitary dilation since this poses no additional difficulties we take a rather general approach starting from an arbitrary group g with unit element e definition 8 31 positive definiteness a mapping t g l h is called positive definite if for all finite choices of g 1 gn g and h 1 hn h we have n m n 1 t g 1 m gn hn hm 0 definition 8 32 representations unitary representations a mapping u g l h is called a representation of g on h if u e i and u g 1 u g 2 u g 1 g 2 for all g 1 g 2 g a unitary representation is a representation whose constituting operators are unitaries 8 3 the sz nagy dilation theorem 273 the following result connects these two notions proposition 8 33 let u g l h be a unitary representation of g on a hilbert space h let j h h be an isometric embedding of another hilbert space h into h then the function t g l h given by t g j u g j is positive definite and satisfies t e i and t g t g 1 for all g g proof the identity t e i follows from u e i and j j i and the identity u g 1 u g implies t g j u g j j u g 1 j j u g 1 j t g 1 to prove positive definiteness let g 1 gn g and h 1 hn h then n m n 1 t g 1 m gn hn hm n m n 1 u g 1 m u gn jhn jhm n n 1 u gn jhn 2 0 the next theorem establishes that conversely every positive definite function t g l h satisfying t e i and t g t g 1 for all g g arises in this way theorem 8 34 unitary dilations let t g l h be a positive definite function satisfying t e i and t g t g 1 for all g g there exist a hilbert space h an isometric embedding j h h and a unitary representation u g l h such that t g h j u g jh h h proof let v be the vector space of all functions f g h that vanish outside a finite set we claim that f 1 f 2 g g g t g 1 g f 1 g f 2 g defines a sesquilinear mapping from v v to c satisfying f 1 f 2 f 2 f 1 for all f 1 f 2 v and f f 0 for all f v sesquilinearity is clear writing fm kj 1 1 g j h m j m 1 2 allowing the possibility that some of the h i j are zero we have f 2 f 1 g g g t g 1 g f 2 g f 1 g g g g f 1 g t g 1 g f 2 g g g g k i j 1 1 gi g 1 g j g h 1 i t g 1 g h 2 j k i j 1 h 1 i t g 1 i g j h 2 j 8 6 274 bounded operators on hilbert spaces a similar computation gives f 1 f 2 k i j 1 t g 1 i g j h 1 j h 2 i 8 7 since t g t g 1 for all g g the right hand sides of 8 6 and 8 7 are equal thus proving the identity f 1 f 2 f 2 f 1 positive definiteness implies f f 0 the properties established in the claim suffice for the validity of the cauchy schwarz inequality it may happen however that f f 0 for certain nonzero functions f in v so this sesquilinear form may fail to be an inner product for this reason we consider the vector space quotient v n where n f v f f 0 let us prove that n is indeed a subspace of v it is clear that c f n for all c c and f n furthermore if f f n then f f 0 by the cauchy schwarz inequality and from this it follows that f f n on the quotient space v n the sesquilinear mapping induces the inner product f n g n f g define h to be the hilbert space completion of v n with respect to this inner product to realise h as a closed subspace of h we identify elements h h with the class modulo n of the functions fh g h given by fh 1 e h then fh 1 fh 2 g g g t g 1 g fh 1 g fh 2 g t e h 1 h 2 h 1 h 2 since t e i this implies that the mapping j h 7 fh is isometric from h into h the linear mapping u v v given by u g f g f g 1 g f v g g g is well defined and preserves inner products in particular it maps n into itself indeed if f n then by a change of variables we have u g f u g f g g g t g 1 g f g 1 g f g 1 g g g g t g 1 g 1 g 1 g f g 1 g f g 1 g g g g t g 1 g f g f g f f 0 moreover u g 1 u g 2 f f g 1 2 g 1 1 f g 1 g 2 1 u g 1 g 2 f 8 8 8 3 the sz nagy dilation theorem 275 upon passing to the quotient we obtain a well defined linear mapping denoted by u g on v n which preserves inner products therefore u g extends to an isometry from h into itself which we once again denote by u g and by passing to the quotient in 8 8 we see that u g 1 u g 2 u g 1 g 2 that is the resulting mapping u g l h is a homomorphism since each operator u g preserves inner products in order to prove that u g is unitary it suffices to prove that it is surjective and for this it suffices to prove that each u g is surjective however the latter is immediate from the definition which implies that every finitely supported h valued function on g is in the range of u g it follows that u is a representation of g on h this representation has the desired properties for all g g g and h h h we have u g fh g u g 1 e h g 1 e g 1 g h 1 g g h and consequently j u g jh h u g fh fh 1 g h 1 e h g g g 1 g g 1 e g t g 1 g h h t g h h the theorem will be applied in the following situation lemma 8 35 if t l h is a contraction the mapping s z l h defined by s n t n n 1 i n 0 t n n 6 1 is positive definite and satisfies s n s n for all n z proof since t is a contraction from i t t x x x 2 t x 2 0 it follows that i t t is a positive operator as consequence by proposition 8 27 the defect operator dt i t t 1 2 is well defined and positive and we have dt x 2 i t t 1 2 x i t t 1 2 x i t t x x x 2 t x 2 define 2 h h hn n 1 h n 1 hn 2 with respect to the inner product g h n 1 gn hn 2 h is a hilbert space com pleteness is proved in the same way as for 2 we define the operator t on 2 h by t h 7 t h 1 dt h 1 h 2 h 3 276 bounded operators on hilbert spaces clearly t h 2 2 h t h 1 2 dt h 1 2 n 2 hn 2 h 2 so t is isometric define s z l h by s n t n n 1 i n 0 t n n 6 1 where t is the hilbert space adjoint of t we make the trivial but crucial observation that s n m h h s n m jh jh h h h m n 1 where j h 2 h is defined by jh h 0 0 it follows that for all choices of h 1 hn h we have with the convention t 0 i n m n 1 s n m hn hm n m n 1 s n m jhn jhm 16 m 6 n 6 n t n mjhn jhm 16 n m 6 n t m njhn jhm 16 m 6 n 6 n t n mjhn jhm 16 n m 6 n jhn t m njhm 16 m 6 n 6 n t njhn t mjhm 16 n m 6 n t njhn t mjhm n k 1 t khk 2 0 where uses that t is an isometry and consequently t g t h g h this proves that s is positive definite the identity s n s n for n z is clear from the definition combining the lemma with the theorem we arrive at the following result theorem 8 36 sz nagy dilation theorem if t l h is a contraction then there exist a hilbert space h an isometric embedding j h h and a unitary operator u l h such that t n j unj n n in this context the operator u is said to be a unitary dilation of t as a simple exam ple the left right shift on 2 z is a unitary dilation of the left right shift on 2 problems 277 problems 8 1 prove the hellinger toeplitz theorem if t h h is a linear mapping satisfying t x y x ty x y h then t is bounded hint apply the uniform boundedness theorem to the operators tx h k given by txy t x y 8 2 give a direct proof of proposition 8 10 based on a neumann series argument for u and u 1 8 3 let t l h be selfadjoint the aim of this problem is to deduce the inclusion t r from proposition 8 10 or the preceding problem fix t a show that ei eit ei t n 1 in n t n 1 and conclude that ei eit fails to be invertible b combine this with proposition 8 10 to conclude that r 8 4 show that a projection p l h is an orthogonal projection if and only if ph 6 h h h hint the latter condition implies that p g ch 2 6 g ch 2 for all c k and g h h now consider g r p and h n p and vary c 8 5 let h 0 be a closed subspace of h and let t l h prove that if both t and t leave h 0 invariant then t h 0 is a subset of t 8 6 show that the norm of an operator t l h is given by t 2 inf 0 t t 6 i where t t 6 i means that t t is positive 8 7 let t l h be selfadjoint and let r a show that if t then t i b show that if pt p where p is an orthogonal projection with n p finite dimensional then t is compact if in addition p 6 i then 0 and t is compact 8 8 the numerical range of an operator t l h is the set w t t x x x 1 the numerical radius of t is defined by w t sup w t 278 bounded operators on hilbert spaces prove the following assertions a 12 t 6 w t 6 t hint to prove the first inequality use the identity 4 t x y t x y x y t x y x y i t x iy x iy i t x iy x iy b t is selfadjoint if and only if w t r hint consider the operator i t t c if w t for some c then t i 8 9 in this problem we prove the toeplitz hausdorff theorem which asserts that the numerical range of any operator t l h is a convex subset of c a show that for all c we have w t i w t conclude that in order to prove the toeplitz hausdorff theorem it suffices to establish that 0 1 w t implies 0 1 w t in what follows we fix an operator t l h such that 0 1 w t we prove that 0 1 w t choose norm one vectors x y h such that t x x 0 and ty y 1 b define g 0 2 c by g t e it t x y eit ty x using that g t g t for t 0 show that either there exists t 0 0 such that g t 0 0 or else there exists t 0 0 2 such that g t 0 0 set y eit 0 y c show that x and y are linearly independent define z 0 1 h and f 0 1 c by z t 1 t x ty 1 t x ty f t t z t z t these functions are well defined by part c d show that f is continuous real valued and satisfies f 0 0 and f 1 1 deduce that 0 1 w t 8 10 prove that for all t l h we have t w t hint first prove that approximate eigenvalues belong to w t then apply the toeplitz hausdorff theorem in combination with proposition 6 17 problems 279 8 11 show that if s t l h are positive operators then st 0 hint apply the result of problem 6 12 to the operators s 1 2 and s 1 2 t 8 12 consider the volterra operator t on l 2 0 1 of example 1 31 t f t t 0 f s ds f l 2 0 1 t 0 1 we sketch two proofs that t 0 a show that for all 0 6 c and g l 2 0 1 the equation t f g has a unique solution in l 2 0 1 deduce that t 0 a second proof is obtained by estimating the norm of t n b show that t n 6 1 n for all n 1 2 hint first show that t n f t t 0 tn 1 0 t 1 0 f s dsdt 1 dtn 1 t 0 f s t s tn 1 s t 2 s dt 1 dtn 2 dtn 1 ds c using theorem 6 23 conclude that t 0 d show that 0 is not an eigenvalue of t e deduce from a or c that t is not normal 8 13 let tm be a fourier multiplier operator on l 2 rd with symbol m l rd a show that tm is normal b show that if f is a continuous function on the essential range of m see prob lem 6 5 then f tm is well defined through the continuous functional cal culus and equal to the fourier multiplier tf m with symbol f m l rd c compare this result with problem 6 6 8 14 show that the rotation operator on l 2 t defined by r f e ix f ei x is unitary and find its spectrum hint distinguish the cases 2 q and 2 6 q 8 15 prove that if t l h is an isometry then there exist hilbert spaces g and k such that we have an isometric isomorphism of hilbert space h 2 g k where 2 g is the hilbert space of all square summable sequences g gn n 1 in g with norm g 2 2 g n 1 gn 2 and that along this decomposition we have t s u 280 bounded operators on hilbert spaces where s is the right shift on 2 g that is s maps the sequence g 1 g 2 to 0 g 1 g 2 and u is a unitary operator on k this decomposition is known as the wold decomposition hint for n n let hn r t n and for n 1 let gn denote the orthonormal complement of hn in hn 1 show that the spaces gn are all isometric as hilbert spaces and set k n nhn 8 16 this problem sketches an alternative proof of the sz nagy dilation theorem let t l h be a contraction and dt i t t 1 2 the associated defect operator a dilation of a bounded operator t on h is a bounded operator t on a hilbert space h containing h isometrically as a closed subspace such that t n pt nj n n where j is the inclusion mapping from h into h and p j is the orthogonal projection of h onto h viewed as a mapping from h onto h a show that t dt dt t on the hilbert space 2 h h hn n 1 h n 1 hn 2 we consider the operator s h 7 t h 1 dt h 1 h 2 h 3 b show that s is an isometry that is sh h for all h 2 h c show that t n j snj for all n n where j h 2 h is given by h 7 h 0 0 conclude that s is a dilation of t d show that a dilation of a dilation is a dilation to complete the proof of the theorem it suffices to show that every isometry has a unitary dilation accordingly in the rest of the problem we consider an isometry s on a hilbert space g e show that under these assumptions we have ds 0 on the hilbert space direct sum g g define the operator u s ds ds s s ds 0 s f show that u s 0 ds s g show that s ds dss 0 and use this to prove that u is unitary h show that u is a dilation of s hint first compute u 2 and use this for finding u 2 k and u 2 k 1 9 the spectral theorem for bounded normal operators in this chapter we show that normal operators admit a spectral representation as sums or integrals of orthogonal projections we begin by showing that every compact normal operator t admits the spectral decomposition t n 1 npn where n n 1 is the sequence of eigenvalues of t and pn n 1 is the sequence of or thogonal projections onto the corresponding eigenspaces for arbitrary bounded normal operators t the main result of this chapter the spectral theorem for bounded normal operators provides an analogous representation as an integral t t dp 9 1 the spectral theorem for compact normal operators throughout this chapter we let h be a hilbert space from linear algebra we know that normal matrices can be orthogonally diago nalised this result admits the following extension to compact normal operators on h theorem 9 1 spectral theorem for compact normal operators let t l h be a compact normal operator and let n n 1 be the finite or infinite sequence of its dis tinct eigenvalues let en n 1 be the corresponding sequence of eigenspaces and let pn n 1 be the associated sequence of orthogonal projections then this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 281 282 the spectral theorem for bounded normal operators 1 the spaces en are pairwise orthogonal and have dense linear span 2 we have t n 1 npn with convergence in the operator norm of l h proof the proof of the theorem uses the properties spectra of compact operators on banach spaces established in theorem 7 11 in the present situation where the com pact operator acts on a hilbert space the proof of this theorem can be considerably shortened see problem 9 2 1 from proposition 8 13 applied to t we see that t x x 0 if and only if t x x 0 so is an eigenvalue for t if and only if is an eigenvalue for t and the eigenspaces coincide if ym em and yn en are nonzero vectors then m ym yn tym yn ym t yn ym nyn n ym yn if m 6 n then this is possible only if ym yn 0 this gives en em for n 6 m let e n 1 en denote the closed linear span of the spaces en n 1 we wish to prove that e h suppose the contrary then e is a nonzero closed subspace of h since t en en for all n 1 we have t e e furthermore if x en then t x nx en so t en en this being true for all n 1 it follows that t e e hence by lemma 8 16 we have t e e and the restriction t of t to e is normal moreover by the very construction of e t has no eigenvalues by theorem 7 11 this implies that t 0 and since t 6 it follows that t 0 now proposition 8 13 implies that t 0 this means that every element of e is an eigenvector of t with eigenvalue 0 this contradicts the observation just made that that t has no eigenvalues and completes the proof that e h 2 let pn denote the orthogonal projection onto en then for all x h we have x n 1 pnx with convergence in h this is clear for every x en and since the span of the spaces en is dense in h and the operators n n 1 pn are orthogonal projections and hence have norm one the convergence extends to all x h by proposition 1 19 it follows that the sum n 1 t pnx converges as well with sum t x fix 0 the set n 1 n is finite by theorem 7 11 let n 1 be so large that 1 2 n fixing x h and writing xn pnx by orthogonality we have t x n n 1 npnx 2 n 1 t xn n n 1 nxn 2 n n 1 nxn 2 n n 1 n 2 xn 2 6 2 n n 1 xn 2 6 2 x 2 9 1 the spectral theorem for compact normal operators 283 taking the supremum over all x h with x 6 1 we obtain t n n 1 npn 2 6 2 this completes the proof let h an k be hilbert spaces for h h and k k we denote by k h the operator in l h k defined by h k x x h k x h if h k and h h has norm one then h h is the orthogonal projection onto the sub space spanned by h if t l h is a compact normal operator the eigenspaces cor responding to nonzero eigenvalues are finite dimensional choosing orthonormal basis for each of them from theorem 9 1 we obtain a representation t n 1 nhn hn with convergence in the operator norm where now n n 1 is the sequence of nonzero eigenvalues of t repeated according to multiplicities and hn n 1 is an associated or thonormal sequence of eigenvectors strictly speaking the spectral theorem gives con vergence of sum for blockwise summation per eigenspace but the proof of the the orem may be repeated to obtain the convergence as stated the geometric and algebraic multiplicities of the eigenvalues coincide by corollary 8 17 so we can unambiguously speak about their multiplicity theorem 9 1 allows us to deduce the following general representation theorem for compact operators acting on a hilbert space it strengthens proposition 7 6 which as serted that such operators can be approximated in operator norm by finite rank operators theorem 9 2 singular value decomposition let t l h k be a compact operator where k is another hilbert space then t admits a decomposition t n 1 nkn hn with convergence in the operator norm where n n 1 is the sequence of nonzero eigenvalues of the compact operator t t 1 2 repeated according to multiplicities and hn n 1 and kn n 1 are orthonormal sequences in h and k respectively the former consisting of eigenvectors of t t 1 2 the proof depends on the following lemma lemma 9 3 if s l h is a positive compact operator then its square root s 1 2 is compact 284 the spectral theorem for bounded normal operators proof by theorem 9 1 we have s n 1 nqn with n n 1 the nonnegative se quence of distinct nonzero eigenvalues of s and qn n 1 the sequence of orthogonal projections onto the corresponding eigenspaces fix 0 and let n 1 be so large that n 6 for all n n then for n n and x h we have by orthogonality n n n 1 2 n qnx 2 n n n n qnx 2 6 n n n qnx 2 6 x 2 this implies that the sum r n 1 1 2 n qn converges in operator norm we have r 0 and r 2 n 1 nqn s so r s 1 2 this operator is the limit in operator norm of the finite rank operators nn 1 1 2 n qn n 1 and therefore it is compact proof of theorem 9 2 by theorem 9 1 applied to t t t 1 2 which is compact by lemma 9 3 we arrive at a representation t n 1 nhn hn with convergence in the operator norm where n n 1 is the sequence of eigenvalues of t repeated according to multiplicities and the orthonormal sequence hn n 1 consists of eigenvectors of t let t u t with u an isometry from r t onto r t as in theorem 8 30 the sequence kn n 1 defined by kn uhn is orthonormal in k and t n 1 nkn hn with convergence in the operator norm as a second application of theorem 9 1 we record the following formulas for the eigenvalues of a compact positive operator theorem 9 4 min max theorem let t l h be compact and positive and let 1 2 0 be the sequence of its nonzero eigenvalues repeated according to multiplicities then for all n 1 we have n inf y h dim y n 1 sup y 1 y y ty y inf y h dim y n 1 sup y 1 y y ty where the infima are taken over all subspaces y of h of dimension n 1 proof for n 1 the only subspace y to be considered is 0 in this case both suprema are taken over all norm one vectors y h and are equal to t sup y 61 ty sup y 61 ty y 1 by theorem 8 11 here we use that t is positive in the remainder of the proof we may therefore assume that n 2 using theorem 9 1 we select an orthonormal basis h j j 1 for h such that t h j jh j for all j 1 let y h be any subspace of dimension n 1 and let hn denote 9 2 projection valued measures 285 the linear span of the vectors h 1 hn then y hn is a nonzero subspace of h so it contains a norm one vector y writing y nj 1 c jh j with n j 1 c j 2 1 we have ty y n j 1 j c j 2 n n j 1 c j 2 n this proves the inequality n 6 inf y h dim y n 1 sup y 1 y y ty y the inequality inf y h dim y n 1 sup y 1 y y ty y 6 inf y h dim y n 1 sup y 1 y y ty holds trivially to prove the inequality inf y h dim y n 1 sup y 1 y y ty 6 n let y hn 1 have norm one then y j n y h j h j and j n y h j 2 1 hence ty 2 j n j y h j h j 2 j n 2 j y h j 2 6 2 n j n y h j 2 2 n and the result follows corollary 9 5 if s t l h are compact operators satisfying 0 6 s 6 t and if 1 2 0 and 1 2 0 are their sequences of nonzero eigenvalues both repeated according to multiplicities then for all n 1 we have n 6 n 9 2 projection valued measures this section and the next deal with the preliminaries needed to state and prove the spectral theorem for bounded normal operators let f be a measurable space definition 9 6 projection valued measures a projection valued measure on a mea surable space f is a mapping p f l h that assigns to every set f f an orthogonal projection pf p f l h such that the following conditions are satisfied i p i 286 the spectral theorem for bounded normal operators ii for all x h the mapping f 7 pf x x f f defines a measure on f for x h the measure defined by ii is denoted by px thus for all f f pf x x px f 1 f dpx from px p x x x x x 2 we see that px is a finite measure we make some easy observations p 0 indeed the additivity of px applied to implies x x px px px px x x px and therefore p x x px 0 for all x h if f 1 f 2 f are disjoint then the ranges of pf 1 and pf 2 are orthogonal indeed by additivity we have pf 1 f 2 x x px f 1 f 2 px f 1 px f 2 pf 1 x x pf 2 x x for all x h so pf 1 f 2 pf 1 pf 2 by proposition 8 1 therefore pf 1 pf 2 pf 1 f 2 p 2 f 1 f 2 pf 1 pf 2 2 pf 1 pf 1 pf 2 pf 2 pf 1 pf 2 it follows that pf 1 pf 2 pf 2 pf 1 0 then pf 1 pf 2 2 pf 1 pf 2 pf 1 pf 2 pf 1 pf 1 pf 2 pf 2 pf 1 pf 2 and similarly pf 2 pf 1 2 pf 2 pf 1 adding these identities gives pf 1 pf 2 2 pf 2 pf 1 2 0 but pf 1 pf 2 2 x x pf 1 pf 2 x pf 2 pf 1 x pf 1 pf 2 x pf 1 pf 2 x pf 1 pf 2 x 2 9 3 the bounded functional calculus 287 and similarly pf 2 pf 1 2 x x pf 2 pf 1 x 2 adding we find pf 1 pf 2 x 2 pf 2 pf 1 x 2 0 this is only possible if pf 1 pf 2 x 2 pf 2 pf 1 x 2 0 since this holds for all x h we conclude that pf 2 pf 1 pf 2 pf 1 0 in particular pf 1 and pf 2 have orthogonal ranges for all f 1 f 2 f we have pf 1 f 2 pf 1 pf 2 pf 2 pf 1 in the special case of disjoint sets this has just been proved with all three expressions equal to 0 from this special case it follows that pf 1 pf 2 pf 1 f 2 pf 1 f 2 pf 2 f 1 pf 1 f 2 pf 1 f 2 pf 2 f 1 pf 1 f 2 pf 2 f 1 pf 1 f 2 pf 1 f 2 p 2 f 1 f 2 0 0 0 pf 1 f 2 reversing the roles of f 1 and f 2 gives the other identity example 9 7 if t l h is a compact normal operator theorem 9 1 implies that the mapping 7 p where p is the orthogonal projection onto the eigenspace of extends to a projection valued measure on t 9 3 the bounded functional calculus let f be a measurable space the banach space of all bounded measurable func tions f c endowed with the supremum norm f sup f is denoted by bb theorem 9 8 bounded functional calculus let p f l h be a projection valued measure there exists a unique linear mapping bb l h with the following properties i for all f f we have 1 f pf ii for all f g bb we have f g f g iii for all f bb we have f f iv for all f bb we have f 6 f v for all fn f bb if supn 1 fn and fn f pointwise on then for all x h we have fn x f x 288 the spectral theorem for bounded normal operators moreover for all x h and f bb we have f x x f dpx 9 1 and f x 2 f 2 dpx 9 2 the operators f are normal and if f is real valued respectively takes values in 0 they are selfadjoint respectively positive proof for f f we set 1 f pf which is i and extend this definition by linearity to simple functions f it is routine to verify that f is well defined for such functions and that ii and iii hold if f kj 1 c j 1 fj is a simple function with disjoint supporting sets fj f the or thogonality of the vectors pfj x gives f x 2 k j 1 c j 2 pfj x 2 6 max 16 j 6 k c j 2 x 2 f 2 x 2 it follows that f 6 f for general f bb we can find a sequence of sim ple functions fn converging to f uniformly on and satisfying fn 6 f from fn fm 6 fn fn we infer that the operators fn form a cauchy se quence in l h it follows that the limit f lim n fn exists with convergence in the operator norm and it is routine to check that the limit is independent of the choice of approximating sequence moreover f 6 limsup n fn 6 f which gives iv the general case of ii and iii now follows by approximation to prove v we first establish 9 1 and 9 2 if f kj 1 c j 1 fj is a simple function with disjoint supporting sets fj f then f x x k j 1 c j pfj x x k j 1 c jpx fj f dpx this gives 9 1 for simple functions the general case follows by approximation and dominated convergence similarly f x 2 k j 1 c j 2 pfj x 2 k j 1 c j 2 pfj x x f 2 dpx 9 3 the bounded functional calculus 289 this gives 9 2 for simple functions again the general case follows by approximation and dominated convergence property v follows from 9 2 applied to the functions fn f and dominated convergence to prove normality of f note that i and iii imply f f f f f 2 f f f f selfadjointness respectively positivity for real valued respectively nonnegative f is immediate from iii respectively 9 1 in what follows we shall write f f dp f dp for functions f bb the rigorous interpretation of these integrals is through 9 1 proposition 9 9 substitution let f and f be measurable spaces and let f be a measurable mapping if p f l h is a projection valued measure then the mapping q f l h defined by qf pf 1 f f f is a projection valued measure denoting by and the bounded functional calculi of p and q for all g bb we have g f g proof the elementary verification that q is a projection valued measure is left as an exercise for all f f and x h 1 f f dpx 1 f 1 f dpx pf 1 f x x qf x x 1 f dqx by linearity and monotone convergence it follows that for nonnegative functions g bb and x h we have g f dpx gdqx that is g f x x g x x for nonnegative g bb the result now follows from proposition 8 1 for general g bb the result follows by splitting into real and imaginary parts and considering their positive and negative parts due to the absence of a reference measure on we had to work with the banach space bb rather than with a lebesgue space l however the projection valued measure p can be used to define a lebesgue type space l p as follows 290 the spectral theorem for bounded normal operators definition 9 10 p essential boundedness a measurable function f c is said to be p essentially bounded if p f r 0 for some r 0 we define l p to be the space of all equivalence classes of p essentially bounded measurable functions identifying the functions f and g when p f 6 g 0 with respect to the norm f l p inf r 0 p f r 0 the space l p is easily checked to be a banach space for functions f l p we obtain a well defined bounded operator f the properties i and ii holds again and iv improves to the equality proposition 9 11 if p f l h is a projection valued measure then for all f l p we have f f l p proof the upper bound 6 is an immediate consequence of part ii of theorem 9 8 the lower bound is proved by observing that the definition of the p essential supremum implies that for all 0 the projection pf is nonzero where f f 1 f l p then for all x r pf f x 2 f 2 dpx 1 2 f 2 l p 1 f dpx 1 2 f 2 l p pf x 2 1 2 f 2 l p x 2 this shows that f 1 f l p since 0 was arbitrary the result fol lows from this we now turn to the special case of projection valued measures defined on the borel algebra b k of a compact subset k of the complex plane in that case we can consider the function id the properties of the operator id are summarised in the next proposition proposition 9 12 let k c be compact and let p b k l h be a projection valued measure define the bounded operator tp l h by tp id that is tp id k dp then 1 tp is normal 9 3 the bounded functional calculus 291 2 the spectrum of tp is contained in k 3 the support of p equals tp in the following sense i pk u 6 0 for all open sets u c such that tp u 6 ii pb 0 for all borel sets b k such that tp b the operator tp is selfadjoint if k r positive if k 0 unitary if k t and an orthogonal projection if k 0 1 proof let bb k l h be the bounded functional calculus associated with p and write tp t for brevity part 1 is immediate from the properties of the bounded calculus if 0 k the functions 7 0 and 7 0 1 are bounded on k and multiply to 1 in view of 1 pk i we have 0 t 0 id and property iii of the bounded calculus shows that 0 t is a two sided inverse of 0 id 1 it follows that 0 t and r 0 t 0 id 1 this proves 2 next we show that pb 0 for all borel sets b k such that t b step 1 suppose first for a contradiction that there is a borel set b k such that b t and pb 1 b t 6 0 by the additivity of p there exists a half open rectangle r 1 of sufficiently small diameter 0 such that r 1 t and pb 1 1 b 1 t 6 0 where b 1 b r 1 proceeding inductively we obtain a sequence of nested half open rectangles r 1 r 2 such that diam rn 6 2 n 1 rn t and pbn 1 bn t 6 0 for bn b rn let n 1 rn 0 and note that 0 b let xn r 1 bn t have norm one since 1 bn t is a projection we have xn 1 bn t xn and for all y h we obtain using the multiplicativity of t xn 0 xn 2 t 0 t 0 1 bn t xn xn k 0 21 bn dpxn and therefore t xn 0 xn 2 6 sup k 0 21 bn 6 diam 2 bn 6 2 2 n 2 this means that 0 is an approximate eigenvalue for t so 0 t we also have 0 b and b t this contradiction proves that pb 0 for all borel sets b k whose closure is disjoint of t step 2 now consider a general borel set b k disjoint with t the borel set b n b k d t 1 n has closure disjoint from t and consequently pb n 0 for all n 1 by what we already proved in particular we have px b n 0 for all x h and by monotone convergence it follows that px b pbx x 0 for all x x this implies pb 0 292 the spectral theorem for bounded normal operators this completes the proof of the support property i it implies that there is no loss of generality in assuming that k t assuming this in the rest of the proof we now turn to the proof of the support property ii let u c be an open set such that t u 6 and suppose for a contradic tion that p t u 0 then pb 0 for all borel sets b t u this implies that t f dp 0 for all simple functions f supported on such sets and by approximation the same is true for all bounded borel functions supported in t u in particular t 1 t u dp 0 let p t u l h be the restriction of p to t u since p t u p t u p t i p is a projection valued measure denoting t id the associated operator we have t t u dp t 1 t u dp t dp t and therefore t t t u by 2 which is absurd if k r respectively k 0 then t x x r respectively t x x 0 for all x h and therefore t is selfadjoint respectively positive if k t then t is invertible by part 2 and t k dp k 1 dp t 1 and therefore t is unitary if k 0 1 then t 0 if k 0 and t k dp p 1 if 1 k in both cases we see that t is an orthogonal projection it follows from the proposition that p restricts to a projection valued measure on tp in a natural way accordingly we have tp tp dp the spectral theorem for bounded normal operators which will be proved in section 9 4 asserts that conversely for every normal operator t l h there exists a unique projection valued measure p on t such that t tp that is t t dp this will allow us to prove converses to the four implications in the final assertion in the proposition see corollary 9 18 we have the following uniqueness result 9 4 the spectral theorem for bounded normal operators 293 proposition 9 13 uniqueness let p and p be projection valued measures on a com pact set k c and define the operators tp and tp as before if tp tp then p p proof let us write t tp tp then t id id and t id id where and are the bounded calculi associated with p and p respectively and id by the multiplicativity of the calculi t mt n idmid n id m id n id m id n idmid n it follows that p t p p for all functions p z q z z with q a polynomial in two variables and then f t f f for all f c t by approximation using the stone weierstrass theorem theorem 2 5 this means that t f dp t f dp f c t if r is an open rectangle inc and if 06 fn 1 r pointwise on k with each fn continuous on k we find that px t r t 1 r dpx lim n t fn dpx lim n t fn dp x t 1 r dp x p x t r this means that px t r p x t r for all open rectangles r by dynkin s lemma lemma e 4 this implies that px b p x b and therefore pbx x px b p x b p bx x for all x h and borel subsets b of t it follows that pb p b for all borel subsets b of t since p and p are supported on t this completes the proof 9 4 the spectral theorem for bounded normal operators we are now ready to state and prove the spectral theorem for bounded normal operators theorem 9 14 spectral theorem for bounded normal operators let t l h be a normal operator there exists a unique projection valued measure p on t such that t t dp for the proof of theorem 9 14 we need the following elementary consequence of the riesz representation theorem 294 the spectral theorem for bounded normal operators proposition 9 15 let a h h c be a sesquilinear mapping with the property that there exists a constant c 0 such that a x y 6 c x y x y h then there exists a unique operator a l h such that a x y ax y x y h moreover a 6 c where c is the boundedness constant of a proof for all y h the mapping x 7 a x y is a bounded functional on h and the riesz representation theorem gives a unique w w y h satisfying a x y x w y x h let b y 7 w w y be the resulting mapping then a x y x by x y h we claim that b h h is a bounded operator indeed if c 1 c 2 k and y 1 y 2 h for all x h we have x b c 1 y 1 c 2 y 2 a x c 1 y 1 c 2 y 2 c 1 a x y 1 c 2 a x y 2 c 1 x by 1 c 2 x by 2 x c 1 by 1 c 2 by 2 since this equality holds for all x h it follows that b is linear furthermore bx 2 bx bx bx bx a bx x 6 c bx x consequently bx 6 c x for all x h so b is bounded with b 6 c the operator a b has the required properties proof of theorem 9 14 we begin with existence for x y h consider the linear map ping x y c t c x y f f t x y where f t is given by the continuous functional calculus of t the bound f t 6 f implies that x y is bounded and x y 6 x y by the riesz representation theorem theorem 4 2 there exists a unique complex borel measure px y on t such that f t x y t f dpx y f c t 9 3 9 4 the spectral theorem for bounded normal operators 295 note that px y sup f 61 f t x y 6 x y since f t 6 f hence by proposition 9 15 for all f bb t there exists a unique bounded operator on h which we denote by f t such that f t x y t f dpx y 9 4 for all x y h for f c t x y and px px x 9 4 is consistent with 9 3 taking f and x y gives the identity in the statement of the theorem t x x t dpx except that it remains to be proved that the measures px come from a projection valued measure the remainder of the proof is devoted to showing that this is indeed the case for borel sets b t we define the bounded operator pb l h by pb 1 b t this operator is positive since 1 b is nonnegative and for all x h we have pbx x t 1 b dpx px b this identity will be used repeatedly in what follows proving that pb is a projection takes a bit of effort since we must proceed from first principles once we have established the existence of a projection valued measure p generating the measures px various steps in the argument appear as special cases of properties of the bounded functional calculus for p already established in theorem 9 8 we first assume that u is open as a subset of t that is we assume that u u t for some open set u c choose a sequence of real valued continuous functions fn c t satisfying 06 fn 1 u pointwise then for all x h pu x x t 1 u dpx lim n t fn dpx lim n fn t x x 9 5 by the monotone convergence theorem by polarisation this implies pu x y lim n fn t x y for all x y h then p 2 u x y limn fn t x pu y limn limm fn t x fm t y i lim n lim m fm t fn t x y ii lim n lim m fm fn t x y iii pu x y 296 the spectral theorem for bounded normal operators where i uses that fm is real valued implying that fm t is selfadjoint ii follows from the multiplicativity of the continuous calculus and iii follows by repeating the steps of 9 5 this proves that pu is a projection for general borel sets b t we use the outer regularity of the measure px see proposition e 16 to find for every n 1 an open set un depending on x containing b and such that un b has px measure less than 1 n then 06 pun bx x px un b 1 n it follows that pun b is a positive operator whose positive square root satisfies p 1 2 un bx 2 pun bx x 1 n by theorem 8 11 we have 0 6 pun b 6 i implies pun b 0 1 and the spectral mapping theorem theorem 8 23 implies that p 1 2 un b 0 1 another application of theorem 8 11 gives 06 p 1 2 un b 6 i and therefore p 1 2 un b 6 1 as a consequence pun bx 6 p 1 2 un b p 1 2 un bx 6 p 1 2 un b x 1 n since pb and pun commute we have p 2 b p 2 un pb pun pb pun and since pb pun pun b p 2 bx pbx 6 p 2 b p 2 un x p 2 un pun x 0 pun pb x 6 pb pun 1 pun b x 6 3 n where we used that pf sup x 61 pf x x sup x 61 px f 6 1 for borel subsets f t this being true for all n 1 we conclude that p 2 bx pbx since x h was arbitrary this proves that pb is a projection and b 7 pb is a projection valued measure uniqueness follows from proposition 9 13 example 9 16 let h l 2 0 1 the position operator x l h is defined by x f x x f x x 0 1 f l 2 0 1 we have x 0 1 and the projection valued measure of x is given by pb f 1 b f for all f l 2 0 1 and borel subsets b of 0 1 see problem 9 9 in particular 1 b x 0 for any borel null set b of 0 1 as a consequence for all l 0 1 the operator x is well defined as a bounded operator on h in fact we have x t where t f x x f x the operators x arise quite naturally as follows 9 4 the spectral theorem for bounded normal operators 297 proposition 9 17 an operator s l h commutes with the operator x that is sx xs if and only if there exists l 0 1 such that s x proof the if part being easy we concentrate on the only if part let s l h be such that sx xs to show that there exists l 0 1 such that s x a natural candidate for is the function s 1 which a priori is an element of l 2 0 1 for fn x xn with n n we have fn xn f 0 xn 1 and therefore s fn sx n 1 xns 1 xn x 7 fn x x by the weierstrass approximation theorem the polynomials are dense in c 0 1 and hence in l 2 0 1 as c 0 1 is dense in l 2 0 1 by a limiting argument we conclude that s f x 7 fn x x the boundedness of s implies the boundedness of the mul tiplier f 7 f which in turn implies that l 0 1 we are now in a position to prove the assertions made in section 8 1 corollary 9 18 let t l h be a normal operator 1 t is selfadjoint if and only if t r 2 t is positive if and only if t 0 3 t is unitary if and only if t t 4 t is an orthogonal projection if and only if t 0 1 furthermore if t is a projection then it is an orthogonal projection proof the only if statements have already been proved in chapter 8 the if state ments follow from theorem 9 14 either by combining it with the final assertion of proposition 9 12 or by the following direct reasoning write t t dp as in theorem 9 14 if t is contained in the real line then by theorem 9 8 t t dp t dp t if t is contained in the nonnegative half line then for all x h we have t x x t dpx 0 if t is contained in the unit circle then t is invertible and t t dp t 1 dp t 1 if t is a normal projection the spectral theorem for normal operators gives t 0 1 dp 0 p 0 1 p 1 p 1 298 the spectral theorem for bounded normal operators which is an orthogonal projection since the spectrum of any projection is contained in 0 1 this also gives the final assertion as the example of the volterra operator v shows see example 8 12 and problem 8 12 normality cannot be omitted in parts 1 2 and 4 the operator i v shows that normality cannot be omitted in part 3 for normal operators t l h and functions f bb t the operator f l h defined in terms of the projection valued measure of t by is denoted by f t f t f t f dp therefore the properties of the bounded calculus for translate into corresponding properties for the mapping f 7 f t theorem 9 19 bounded functional calculus for normal operators let t l h be normal then i for f z zmzn we have f t t mt n ii for all f g bb t we have f g t f t g t iii for all f bb t we have f t f t iv for all f bb t we have f t 6 f v for all fn f bb t if supn 1 fn and fn f pointwise on t then for all x h we have fn t x f t x moreover for all x h and f bb t we have f t x x f dpx and f t x 2 f 2 dpx the operators f t are normal and if f is real valued respectively nonnegative they are selfadjoint respectively positive proof everything but i follows from theorem 9 8 i follows from ii and iii theorem 9 20 composition let t l h be a normal operator let f c t and put k f t f t then i the projection valued measure q of f t is given by qb pf 1 b b b k ii for all g bb k we have g f t g f t 9 4 the spectral theorem for bounded normal operators 299 proof once the first assertion has been proved the second is merely a restatement of the substitution rule of proposition 9 9 let p and q denote the projection valued measures on t and k of the normal operators t and f t respectively and define the projection valued measure q on k by q b pf 1 b for borel sets b k let u be a relatively open subset of k approximating 0 6 fn 1 u pointwise with the functions fn in c k and using the result of step 1 for all x h we obtain qx u k 1 u dqx lim n k gn dqx lim n gn f t x x lim n gn f t x x lim n t gn f dpx t 1 u f dpx k 1 u dq x q x u the inner regularity of the finite borel measures qx and q x now implies that these measures are equal it is of some interest to revisit the case of a compact normal operator t the spectrum of t is then a finite or infinite sequence n n 1 with 0 as its only possible limit point in theorem 8 15 we have already shown that for any nonzero t the orthogonal projection p onto the corresponding eigenspace equals the spectral projection p of theorem 6 25 proposition 9 21 let t l h be a compact normal operator and let p be its projection valued measure then for all nonzero t p p p proof putting p p and extending this definition by putting p 0 0 if 0 is not an eigenvalue the spectral theorem for compact normal operators implies that p defines a projection valued measure and t x x t p x x t 0 p x x t 0 dp x t dp x hence by the uniqueness theorem for projection valued measures p p further results along this line are given in problem 9 7 and theorem 10 56 we conclude this section with two famous results due to von neumann theorem 9 22 von neumann if t l h is a contraction then for all polynomials 300 the spectral theorem for bounded normal operators p in one complex variable we have p t 6 sup z 1 p z proof first suppose that u is a unitary operator then u is contained in the unit circle since unitaries are normal by theorem 9 14 we have u u dp where p is the projection valued measure of u then by theorem 9 8 and the fact that u t p u sup z u p z 6 sup z 1 p z 9 6 next let t be a contraction by the sz nagy dilation theorem theorem 8 36 t has a unitary dilation u so that t n j unj for some isometric operator j and all n n then p t j p u j so p t 6 p u and the result follows from 9 6 as an application of the spectral theorem for normal operators we prove von neu mann s theorem on pairs of commuting selfadjoint operators two projection valued measures p f p h and p f p h are said to commute if pf and p f commute for all f f f lemma 9 23 let p 1 pk be commuting projection valued measures on compact hausdorff spaces k 1 kk respectively there exists a unique projection valued mea sure p on k k 1 kk such that pb 1 bk p 1 b 1 p k bk for all borel sets b j k j j 1 k proof for borel sets b j k j j 1 k and f 1 b 1 bk define f p 1 b 1 p k bk we extend this definition by linearity to functions f on k which are linear combinations of borel rectangles using the commutativity assumptions it is easily checked that this is well defined and that for such f we have f 6 f we may use this to define for functions f c k a well defined bounded operator f by uniform approximation by simple functions of the above form in the same way as in the proof of theorem 9 14 there exists a projection valued measure p on k such that 9 3 holds for all f c k and x h that is f x x k f dpx f c k x h 9 5 the von neumann bicommutant theorem 301 this projection valued measure has the desired properties its uniqueness can be proved using the method of proposition 9 13 theorem 9 24 von neumann two selfadjoint operators t 1 t 2 l h commute if and only if there exist a normal operator s l h and continuous functions f 1 f 2 s r such that t 1 f 1 s t 2 f 2 s proof the if part follows from the multiplicativity of the borel calculus of s the point is to prove the only if part to this end let p 1 and p 2 denote the projection valued measures of t 1 and t 2 on t 1 and t 2 respectively and let p be the projection valued measure on k t 1 t 2 r 2 as in lemma 9 23 let l z c rez t 1 imz t 2 c that is we identify k with a rectangle l in the complex plane under this identification p induces a projection valued measure on l denoted by q the operator s tq l dq is normal we will prove that t 1 f 1 s and t 2 f 2 s with f 1 z rez and f 2 z imz for all x h we have using that qx is supported on s f 1 s x x s f 1 dqx l re dqx we claim that the image measure of qx under f 1 equals p 1 x indeed for all borel sets b 1 t 1 we have f 1 px b 1 qx b 1 i t 2 qb 1 i t 2 x x pb 1 t 2 x x p 1 b 1 p 2 t 2 x x p 1 b 1 x x p 1 x b 1 where we used that p 2 t 2 i so f 1 qx p 1 x as claimed it now follows that l f 1 dqx t 1 dp 1 x t 1 x x together with the above identities we find that f 1 s x x t 1 x x this being true for all x h we conclude that f 1 s t 1 the identity f 2 s t 2 is proved similarly 9 5 the von neumann bicommutant theorem in this section we prove a result of fundamental importance in the theory of operator al gebras von neumann s celebrated bicommutant theorem we also start the proof to be 302 the spectral theorem for bounded normal operators completed in the next chapter of the identification of the bicommutant of a single self adjoint operator on a separable hilbert space as being precisely the bounded functional calculus of this operator we begin by introducing the relevant terminology definition 9 25 commutant the commutant of a subset t l h is the set t s l h st t s t t the bicommutant of a subset t l h is the set t t definition 9 26 strong and weak operator topologies the strong operator topology on l h is the smallest topology on l h with the property that the linear map ping t 7 t x is continuous for all x h the weak operator topology on l h is the smallest topology on l h with the property that the linear mapping t 7 t x y is continuous for all x y h definition 9 26 has natural counterparts for l x with x a banach space but this will not be needed in the same way as was explained in section 4 6 for the weak and weak topologies the strong operator topology is generated by the sets of the form t l h t t 0 x with 0 x h and t 0 l h and likewise the weak operator topology is generated by the sets of the form t l h t t 0 x y with 0 x y h and t 0 l h for every set t l h the commutant t is closed in the weak operator topology to see this suppose that t 0 6 t then there exist an operator s t vectors x y h and a number 0 such that t 0 sx y st 0 x y the set u t l h t 0 t sx y 2 t 0 t x s y 2 is open in the weak operator topology contains t 0 and every t u fails to commute with s it follows that u t recall that a subalgebra of l h is a subspace of l h closed under taking compo sitions a subalgebra of l h is a subalgebra of l h closed under taking hilbert space adjoints a subalgebra is said to be unital if it contains the identity operator theorem 9 27 von neumann bicommutant theorem for a unital subalgebra a of l h the following assertions are equivalent 1 a a 9 5 the von neumann bicommutant theorem 303 2 a is weakly closed 3 a is strongly closed a subalgebra a of l h which is closed with respect to the operator norm is called a c algebra this is not the commonly used definition the standard definition is mentioned in the notes to chapter 7 but one of the main theorems on the structure of c algebras establishes that this definition is equivalent to the standard one a unital subalgebra a of l h satisfying the equivalent conditions 1 2 of theorem 9 27 is called a von neumann algebra proof the implications 1 2 3 are clear 3 1 fix x 0 h and let p denote the orthogonal projection in h onto the closure y of the subspace t x 0 t a since a contains the identity operator i we have px 0 x 0 we claim that y is invariant under all t a for if t a and y y say y limn tnx 0 with tn a for all n 1 then ty limn t tnx 0 with t tn a for all n 1 and therefore ty y similarly y is invariant under all t a for if t a and x y then for all y y we have t x y x t y 0 since t a and therefore t y y by the claim for all t a and x h we have t px y and t i p x y and therefore t px pt px pt px i p x pt x x h we conclude that t p pt for all t a that is p a let t 0 a be fixed then pt 0 t 0 p since p a and this implies that t 0 x 0 t 0 px 0 pt 0 x 0 y by the definition of y this means that for all 0 there exists an element t a such that t 0 x 0 t x 0 to show that every strongly open set containing t 0 intersects a it suffices to show that for any choice of x 1 xk h and 0 there exists t a such that t 0 t x j j 1 k 9 7 in what follows we set x 0 x 1 xk for s l h let s l hk be given by s h 1 hk sh 1 shk we claim that t 0 a 304 the spectral theorem for bounded normal operators indeed suppose that s si j ki j 1 a this means that s t y t sy for all t a and y y 1 yk hk that is k j 1 si jty j k j 1 t si jy j i 1 k y 1 yk h which implies that for all 1 6 i j 6 k we have si j t for all t a so si j a but this clearly implies that t 0 commutes with s we now apply the first part of the proof with h a and t 0 replaced by hk a and t 0 respectively this gives an operator t a such that t 0 t x 0 that is k j 1 t 0 t x j 2 2 in particular 9 7 follows from this we have shown that every strongly open set containing an element from a intersects a this means that a is strongly dense in a since a was assumed to be strongly closed it follows that a a the next theorem provides a beautiful connection between bicommutants and the bounded functional calculus theorem 9 28 von neumann bicommutant of a selfadjoint operator let h be sepa rable and let t l h be selfadjoint then t f t f bb t proof the fuglede putnam rosenblum theorem theorem 8 18 implies that t t it follows that every operator of the form p t t with p a polynomial in z and z is contained in t by the stone weierstrass theorem the same is true for every function f c t by pointwise approximation from below the result extends to indicator functions f 1 u with u t relatively open for all x h the outer regularity of px implies that pbx limn punx whenever the relatively open sets u 1 u 2 b satisfy limn px un b 0 applying this to sx and x with s t as a consequence we obtain pbsx lim n punsx limn spunx spbx x x which shows that pb s for all s t that is pb t this in turn implies that if f bb t and s t then upon approximating f with simple functions s f t s t f dp t f dp s f t s and therefore f t t for all f bb t 9 6 application to orthogonal polynomials 305 the proof of the inclusion is more involved and requires h to be separable the proof makes use of the spectral theory for unbounded selfadjoint operators developed in the next chapter accordingly we defer this part of the proof to that chapter 9 6 application to orthogonal polynomials in this final section we present an interesting application of the spectral theorem to or thogonal polynomials let be a borel measure on the real line satisfying the condition x n d x n n 9 8 we further assume that the support of is not a finite set suppose that pn n n is a se quence of polynomials with real coefficients satisfying the following two assumptions i for all n n we have deg pn n ii for all m n n with m 6 n we have the orthogonality relation pm x pn x d x 0 9 9 for n 0 i is understood to mean that p 0 6 0 by linearity i and ii imply xm pn x d x 0 whenever m n proposition 9 29 let be a borel measure on the real line with the properties stated above for any sequence of polynomials pn n n with real coefficients satisfying the conditions i and ii there exist real numbers an bn cn n n satisfying c 0 0 and an 1 cn 0 n 1 such that with p 1 0 xpn an pn 1 bn pn cn pn 1 n n proof since xpn is a polynomial of degree n 1 it is of the form xpn n 1 j 0 c j n p j with all coefficients c j n real valued then 9 9 implies xpn x pm x d x cm nnm where nm p 2 m x d x since the support of is not finite we have nm 6 0 for all m n for n n the poly nomial pn x is orthogonal to xpm x for all m 0 1 n 2 this forces cm n 0 for all m 0 1 n 2 this in turn implies xpn cn 1 n pn 1 cn n pn cn 1 n pn 1 n n this gives the three point recurrence relation with an cn 1 n bn cn n and cn 306 the spectral theorem for bounded normal operators cn 1 n with convention c 0 c 1 0 0 say since the degree of xpn is n 1 we have an 6 0 also for n 1 an 1 nn cn n 1 nn xpn x pn 1 x d x xpn 1 x pn x d x cn 1 nnn 1 cnnn 1 9 10 and therefore an 1 cn 0 for n 1 the polynomial pn has norm one in l 2 r if and only if nn 1 hence if the pn are orthonormal 9 10 gives 0 6 an 1 cn for all n 1 as an application of the spectral theorem we show that conversely for every sequence of polynomials satisfying the three point recurrence relation subject to the conditions 0 6 an 1 cn for all n 1 and satisfying the additional boundedness assumption sup n n max an bn cn there exists a finite borel measure on the real line with respect to which the polyno mials are orthonormal theorem 9 30 three point recurrence for every sequence pn n n of polynomials satisfying the three point recurrence relation xpn an pn 1 bn pn cn pn 1 n n with p 1 0 subject to the conditions 0 6 an 1 cn for all n 1 and sup n n max an bn cn there exists a finite borel measure on the real line which satisfies 9 8 and such that the sequence pn n n is orthonormal in l 2 r proof without loss of generality we may assume p 0 1 on the hilbert space 2 n we consider the bounded operator ten anen 1 bnen cnen 1 n n with the understanding that te 0 a 0 e 1 b 0 e 0 boundedness of t is a consequence of the boundedness assumption on an bn and cn since an 1 cn from en t em an m n 1 bn m n an 1 m n 1 am 1 m 1 n bm m n am m 1 n en tem which is checked by hand also to hold if n 0 or m 0 we see that t is selfadjoint let p be its projection valued measure and define pe 0 then is a finite measure supported on t which is a compact set since t is bounded 9 6 application to orthogonal polynomials 307 define a linear operator from 200 n the span of the vectors en in 2 n into l 2 r by setting uen pn for n n we further define the bounded operator m l 2 r l 2 r by m f x x f x the boundedness of m follows from the fact that is supported in a bounded interval i from uten an pn 1 bn pn an 1 pn 1 xpn muen we see that ut mu as linear operators from 200 n to l 2 r by a simple induc tion argument ut n mnu for all n n we claim that u extends to a unitary operator from 2 n to l 2 r first we check that u has dense range by the stone weierstrass theorem the functions k x e 2 ikx i k z can be uniformly approximated by polynomials and the injectivity of the fourier transform of finite borel measures theorem 5 32 implies that the span of the functions k k z is dense in l 2 i hence in l 2 r these observations imply that u has dense range next from ut ne 0 mn p 0 xn and pe 0 we obtain ut me 0 ut ne 0 xm xn i xm n dpe 0 x t m ne 0 e 0 t me 0 t ne 0 using the functional calculus of t the span of the vectors t ne 0 n n being dense in 2 n this concludes the proof that u extends to a unitary operator it now follows from pm pn uem uen em en mn that the polynomials pn are orthonormal in l 2 r example 9 31 we have already encountered two examples of orthogonal polynomials i the hermite polynomials hn n n have been introduced in section 3 5 b they are orthogonal with respect to the gaussian measure 1 2 exp 12 x 2 dx on the real line and satisfy the three point recurrence relation h 0 x 1 h 1 x x and hn 2 x xhn 1 x n 1 hn x n n ii the monic laguerre polynomials ln n n have been introduced in problem 3 14 as a scaled version of the laguerre polynomials they are orthogonal with respect to the measure 1 r x exp x on the real line and satisfy the three point recurrence relation l 0 x 1 l 1 x x 1 and ln 2 x x 2 n 3 ln 1 x n 1 2 ln x n n 308 the spectral theorem for bounded normal operators problems 9 1 let t l h be a compact normal operator with spectral decomposition t n 1 npn prove that if f t c is a bounded function then f t x n 1 f n pnx x h does the sum n 1 f n pn converge to f t in the norm of l h 9 2 let t l h be a compact normal operator give a direct proof that is without invoking theorem 7 11 of the following two statements a if is a nonzero element of t then is an eigenvalue hint use the fact that r t is closed lemma 7 9 to establish the equiv alences n t 0 n t 0 r t h b if t has infinitely many distinct eigenvalues n then limn n 0 hint choose eigenvectors t hn nhn and define h 0 0 and hn span h 1 hn for n 1 2 show that hn 1 hn and choose norm one vectors xn hn h n 1 show that if n m then t xm t xn n 9 3 let t l h be a selfadjoint operator with projection valued measure p prove the following results a if t r then for all x h we have lim 0 i r t i t x p t x b if a b r with a b then for all x h we have stone s formula lim 0 1 2 i b a r t i t x r t i t xdt 1 2 p a b x p a b x hint show first that lim 0 1 2 i b a 1 i t 1 i t dt 0 t 6 a b 1 2 t a b 1 t a b 9 4 let t 1 t 2 l h be selfadjoint operators with projection valued measures p 1 and p 2 respectively prove that the following assertions are equivalent 1 the projection valued measures p 1 and p 2 commute that is for all borel sets b 1 b 2 in r we have p 1 b 1 p 2 b 2 p 2 b 2 p 1 b 1 problems 309 2 the resolvents of t 1 and t 2 commute that is for all 1 t 1 and 2 t 2 we have r 1 t 1 r 2 t 2 r 2 t 2 r 1 t 1 3 for all t 1 t 2 r we have exp it 1 t 1 exp it 2 t 2 exp it 2 t 2 exp it 1 t 1 hint for the implication 2 1 use the results of the preceding problem for implication 3 1 write exp it 1 t 1 and exp it 2 t 2 as spectral integrals with re spect to p 1 and p 2 and use the properties of the fourier plancherel transform to deduce that for all f g f 2 r we have f t 1 g t 2 g t 2 f t 1 and hence for all f g f 2 r f t 1 g t 2 g t 2 f t 1 by approximation with functions in f 2 r deduce that p 1 a 1 b 1 p 2 a 2 b 2 p 2 a 2 b 2 p 1 a 1 b 1 for all a 1 a 2 b 1 b 2 r with a 1 b 1 and a 2 b 2 9 5 let t l h be a normal operator with projection valued measure p let b be a borel subset of t a show that t leaves the range of pb invariant b show that t r pb b 9 6 prove that if t l h is normal then t sup t x x x 1 hint fix 0 t with 0 t why does such 0 exist and 0 and consider the projection pb 0 where p is the projection valued measure of t show that if x b 0 has norm one then t x x t 9 7 let t l h be a normal operator with projection valued measure p a show that n t r p 0 hint for the inclusion write t 0 as a countable union of borel sets bn each of which has the property that inf bn 0 and consider fn z 1 f z z bn 0 z t bn b conclude that if t is an eigenvalue then p equals the orthogonal projection p onto the eigenspace e c conclude that if t is an isolated point then is eigenvalue and p p equals the spectral projection associated with 310 the spectral theorem for bounded normal operators 9 8 show that the space l p introduced in definition 9 10 is a banach space 9 9 prove the following two claims made in example 9 16 a the position operator x on h l 2 0 1 defined by x f x x f x x 0 1 f l 2 0 1 has spectrum x 0 1 b the projection valued measure of x is given by pb f 1 b f for all borel subsets b of 0 1 and f l 2 0 1 9 10 find the projection valued measures of the following unitary operators a the right shift on 2 z b translation over t on l 2 r c rotation over on l 2 t d the fourier transform on l 2 rd hint for parts c and d revisit problems 8 14 and 6 9 respectively 9 11 let k l 2 0 1 0 1 satisfy k s t k t s almost everywhere find the projection valued measure of the selfadjoint integral operator t on l 2 0 1 t f t 1 0 k t s f s ds f l 2 0 1 9 12 let t l h be selfadjoint a show that there exist positive operators t and t such that t t t hint consider the functions f t t and f t t b show that these operators are unique if we also ask that t t t t 0 9 13 prove that if u l h is unitary there exists a selfadjoint operator t such that u eit and t is this operator t unique hint write u t dp as in theorem 9 14 find a projection valued mea sure q on 0 1 whose image under t 7 eit is p 9 14 this problem outlines another proof of the spectral theorem for normal operators a explain how the proof of the spectral theorem for normal operators simplifies for selfadjoint operators b deduce the spectral theorem for normal operators from the selfadjoint case by considering for a normal operator t the selfadjoint operators 12 t t and 12 i t t and applying lemma 9 23 to their projection valued mea sures 10 the spectral theorem for unbounded normal operators up to this point we have been dealing exclusively with bounded operators in order to make the functional analytic apparatus applicable to the study of partial differential equations we need to accommodate differential operators into the theory this leads to the notion of an unbounded operator as a linear operator defined only on a suitable subspace the domain of the operator of special interest are unbounded selfadjoint and normal operators and the main goal of this chapter is to extend the spectral theorems of the preceding chapter to these classes of operators 10 1 unbounded operators throughout this chapter x and y are banach spaces definition 10 1 linear operators a linear operator from x to y is a pair a d a where d a is a subspace of x and a d a y is a linear operator the subspace d a is called the domain of a a linear operator is densely defined when d a is a dense subspace of x when no confusion is likely to arrive we omit the domain from the notation and write a instead of a d a it is perfectly allowable that d a x so in particular every bounded operator a x y is a linear operator in the sense of the above definition more generally it may happen that there exists a constant c 0 such that ax 6 c x for all x d a in this situation a admits a unique extension to a bounded operator of norm at most c this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 311 312 the spectral theorem for unbounded normal operators defined on the closure of d a the interest in the above definition arises from the fact that many interesting examples of unbounded linear operators exist that is linear operators for which such a constant c does not exist typical examples treated in more detail below include differential operators and multiplication operators with unbounded multipliers the terms linear operators and unbounded operators are often used interchange ably with the latter terminology however it becomes somewhat ambiguous whether bounded operators are to be considered as special cases of unbounded operators to avoid such trivial issues we generally prefer the terminology linear operator which is neutral in this respect 10 1 a closed operators a linear operator from x to y is bounded if and only if its graph is closed in x y the if part being the content of the closed graph theorem this motivates the following definition definition 10 2 closed operators a linear operator a from x to y is called closed when its graph g a x ax x d a is closed in x y every bounded operator from x to y is closed and by the closed graph theorem a closed operator with domain d a x is bounded if a is a linear operator with domain d a then a is bounded in fact contractive as an operator defined on the normed space d a endowed with the graph norm x d a x ax x d a this follows from the trivial inequality ax 6 x ax x d a the following proposition gives a necessary and sufficient condition for closedness in terms of the graph norm proposition 10 3 a linear operator is closed if and only if its domain is a banach space with respect to its graph norm proof if suppose that the domain d a of the linear operator a is complete with respect to its graph norm to prove that a is closed we must show that its graph is closed or equivalently sequentially closed in x y let xn axn n 1 be a sequence converging to some limit x y in x y we must check that x y belongs to the graph 10 1 unbounded operators 313 of a by the properties of product norms we have xn x in x and axn y in y in particular the sequences xn n 1 and axn n 1 are cauchy in x and y respectively then the sequence xn n 1 is cauchy in d a since xn xm d a xn xm axn axm 0 as m n by the completeness of d a the sequence xn n 1 converges in d a say xn x in d a this means that xn x in x and axn ax in y comparing limits we find that x x and ax y this means that x y x ax belongs to d a only if assume now that a is closed and that xn n 1 is a cauchy sequence in d a so xn n 1 is a cauchy sequence in x and axn n 1 is a cauchy sequence in y then xn axn n 1 is a cauchy sequence in x y this cauchy sequence is contained in the graph of a this graph is closed by our assumption and since closed subspaces of banach spaces are banach spaces this cauchy sequence converges in x y to a limit contained in the graph of a say xn axn x ax in x y this implies that xn x in x and axn ax in y which is the same as saying that xn x in d a with respect to the graph norm we have thus shown that every cauchy sequence in d a is convergent the following proposition gives a convenient sequential criterion for a linear operator to be closed the proof is already implicitly contained in the proof of proposition 10 3 and the reader is invited to make this explicit proposition 10 4 a linear operator a with domain d a is closed if and only if the following holds whenever xn x in x with xn d a for all n and axn y in y then x d a and ax y this criterion is used to prove closedness in the next two examples example 10 5 the derivative operator as a linear operator in c 0 1 with domain c 1 0 1 is densely defined and closed the density of c 1 0 1 in c 0 1 is clear by the weierstrass approximation theorem we can even approximate continuous functions with polynomials to prove closedness suppose that fn f in c 0 1 with fn c 1 0 1 for all n and f n g in c 0 1 we must prove that f c 1 0 1 and f g for all x 0 1 we have f x f 0 lim n fn x fn 0 lim n x 0 f n y dy x 0 g y dy using the uniform convergence of f n to g in the last step the right hand side is a con tinuously differentiable function with derivative g this proves that f c 1 0 1 and f g an analogous result holds for weak derivatives in lp d where d is an open subset of rd see section 11 1 a 314 the spectral theorem for unbounded normal operators example 10 6 let f be a measure space and let 16 p 6 given a measurable function m k we may define d am f lp m f lp am f m f f d am we claim that the linear operator am is closed moreover if 1 6 p then am is densely defined to prove closedness let fn f in lp with each fn in d am and am fn g in lp we must show that f d am and am f g by passing to a subsequence we may assume that both convergences also hold pointwise almost everywhere then for almost all g lim n am fn lim n m fn m f this proves that m f lp and m f g almost everywhere hence as elements of lp equivalently this says that f d am and am f g now let 1 6 p by dominated convergence limn 1 m 6 n f f for all f lp with convergence in the norm of lp since 1 m 6 n f d am this shows that d am is dense in lp example 10 7 if a is a closed operator and b is bounded then the operator a b with domain d a b d a defined by a b x ax bx for x d a is closed the easy proof is left as an exercise example 10 8 if a is an injective closed operator in particular if a is an injective bounded operator its inverse a 1 with domain d a 1 r a is closed this is im mediate by noting that the graph of a 1 equals y a 1 y y d a 1 ax x x d a and that the latter is closed in y x since x ax x d a is closed in x y further examples will be given later on we highlight two of them example 10 9 the adjoint a of a densely defined linear operator a acting between ba nach spaces is closed by proposition 10 18 likewise by proposition 10 22 the hilber tian adjoint a of a densely defined linear operator a acting between hilbert spaces is closed example 10 10 generators of c 0 semigroups are closed by proposition 13 4 it frequently happens that linear operators are initially defined on a too small domain to be closed but can be extended to a closed operator on a larger domain typical examples of this situation arise in connection with differential operators which initially can be defined on compactly supported smooth functions only 10 1 unbounded operators 315 when a and b are linear operators satisfying d a d b and ax bx for all x d a we call b an extension of a notation a b definition 10 11 closability and closure a linear operator is said to be closable if it has a closed extension or equivalently if the closure of its graph is the graph of a linear operator the unique linear operator a whose graph is the closure of the graph of a closable operator a is called the closure of a it is the smallest closed extension of a we have the following analogue of proposition 10 4 proposition 10 12 a linear operator a with domain d a is closable if and only if the following holds whenever xn 0 in x and axn y in y with all xn in d a then y 0 proof we only need to prove the if part the only if part being trivial denote the closure of g a by g we must prove that under the stated condition g is the graph of a linear operator b this is the case if and only if x y 1 g x y 2 g implies y 1 y 2 for in that case we may define d b to be the set of all x x such that x y g for x b we may then define bx y where y y is the unique element such that x y g by a limiting argument the linearity of a implies that the operator b thus defined is linear clearly it extends a and its graph g b g is closed suppose therefore that x y 1 g and x y 2 g then 0 y 1 y 2 g since g is a linear subspace of x y and this means that there exists a sequence xn axn 0 y 1 y 2 in x y but then xn 0 in x and axn y 1 y 2 in y by our assumption this forces y 1 y 2 0 example 10 13 in the setting of examples 10 5 and 10 6 a closable operator is ob tained by replacing the domain d a of the operator a by any smaller subspace y the closure of the operator thus obtained equals a if and only if y is dense in d a with respect to the graph norm example 10 14 it is shown in proposition 10 34 in the next section that every densely defined symmetric operator acting in a hilbert space is closable example 10 15 let d be an nonempty open subset ofrd let 16 p 6 and let nd be a multi index in lp d we consider the linear operator a with domain c c d defined by a f f f c c d where 11 d d with j x j the jth directional derivative we claim that a is closable indeed suppose the functions fn c c d satisfy fn 0 and a fn g in 316 the spectral theorem for unbounded normal operators lp d integrating by parts for all c c d we obtain d g dx lim n d fn dx 1 lim n d fn dx 0 10 1 where 1 d the last step follows by ho lder s inequality cf corollary 2 25 it is shown in proposition 11 5 in the next chapter that 10 1 implies g 0 almost everywhere example 10 16 let d be an nonempty open subset of rd and let 16 p 6 in lp d we consider the linear operator a with domain c c d defined by a f f f c c d where f 21 f 2 d f is the laplacian of f in the same way as in the previous example one shows that this operator is closable various explicit descriptions of its closure can be given some of which are discussed in chapters 11 13 see in particular sections 11 1 e 12 3 and 13 6 c 10 1 b the adjoint operator when a is a densely defined linear operator from x to y we may uniquely define a linear operator a from y to x by defining its domain d a to be the set of all y y with the property that there exists an element x x such that x x ax y x d a since d a is dense in x the element x x if it exists is unique and we can set a y x y d a thus by definition we have the identity ax y x a y x d a y d a definition 10 17 adjoint operator the operator a is called the adjoint of a the adjoint of a closable densely defined operator a equals the adjoint of the clo sure a for if x x and y y are such that x x ax y for all x d a by continuity this identity extends to all x d a proposition 10 18 if a is a densely defined linear operator from x to y then a is weak closed in the sense that its graph is weak closed in y x and we have g a j g a where j x y y x is defined by j x y y x if a is densely defined and closed then a is weak densely defined in the sense that its domain is weak dense 10 1 unbounded operators 317 proof the pairing y x y x y y x x allows us to identify y x with the dual of y x by the definition of the adjoint operator we have y x g a if and only if ax x y x 0 x d a this proves the identity g a j g a since annihilators are weak closed this proves that a is weak closed if d a is not weak dense then by proposition 4 44 there exists a nonzero element y 0 y such that y 0 y 0 for all y d a by assumption g a is closed in x y and 0 y 0 6 g a it follows that j g a is a closed subspace of y x not containing j 0 y 0 y 0 0 so by the hahn banach theorem there exists an element y 0 x 0 y x annihilating j g a but not y 0 0 in other words x x 0 ax y 0 x d a and y 0 y 0 6 0 the first equality implies that y 0 d a so the second one implies that y 0 does not vanish against every element of d a contradicting the choice of y 0 if the linear operators a and b act from x to y we define the operator a b acting from x to y by d a b d a d b a b x ax bx x d a b if a acts from x to y and b acts from y to another banach space z we define the operator ba acting from x to z by d ba x d a ax d b bax b ax x d ba there is of course a priori no guarantee that d a b and d ba contain any nontrivial elements even when both a and b are densely defined proposition 10 19 let a and b be densely defined operators acting in the ways indi cated above then 1 if a b then b a 2 if a b is densely defined then a b a b with equality if b is bounded 3 if ba is densely defined then a b ba with equality if b is bounded 318 the spectral theorem for unbounded normal operators proof part 1 is immediate from the definitions if y d a b d a d b then for all x d a b d a d b we have a b x y ax y bx y x a y b y so y d a b and a b y a y b y if b is bounded and y d a b then for all x d a b d a we have ax y a b x y bx y x a b y x b y so that y d a d a b and a y a b y b y this gives 2 if z d a b then z d b and b z d a and for all x d ba we have ba x z ax b z x a b z so that z d ba and ba z a b z if b is bounded and z d ba then for all x d ba d a we have ax b z bax z x ba z so b z d a and z d a b and a b z ba z this gives 3 we have the following useful duality criterion to decide whether an element belongs to the domain of an operator proposition 10 20 let a be a densely defined closed operator from x to y if x x and y y are such that y y x a y for all y d a then x d a and ax y proof by the hahn banach theorem the result follows once we have checked that x y x y 0 for all x y g a indeed this gives x y g a g a weak g a where the first identity follows from proposition 4 45 and the second from the fact that closed subspaces are weakly closed by the hahn banach theorem see proposition 4 42 fix an arbitrary x y g a for all x d a we have x ax g a and therefore 0 x ax x y x x ax y this means that y d a and a y x hence x y x y x a y y y 0 in what follows we let h and k be hilbert spaces when a is a densely defined operator acting from h to k the riesz representation theorem may be used to identify the adjoint a which acts from k to h with a linear operator a acting from k to h thus by definition an element k k belongs to d a if there exists a necessarily unique element h h such that x h ax k x d a 10 1 unbounded operators 319 and in that case a k h thus we have the identity x a k ax k x d a k d a definition 10 21 hilbert space adjoint the operator a is called the hilbert space adjoint of a proposition 10 18 admits the following hilbertian version we denote by h k the hilbert space obtained by endowing the cartesian product h k with the inner product h k h k h h k k proposition 10 22 if a is a densely defined linear operator from h to k then a is closed and we have g a j g a in the sense of orthogonal complements where j h k k h is defined by j x y y x if a is densely defined and closed then a is densely defined proof in hilbert spaces the weak topology and the weak topology agree and a sub space is weakly dense respectively weakly closed if and only if it is dense respec tively closed hence everything follows from proposition 10 18 except the statement that g a is the orthogonal complement of j g a in k h this follows from k h g a ax k x h for all x d a k h ax x for all x d a k h j g a mutatis mutandis proposition 10 19 admits a hilbertian version as well we leave this as an exercise to the reader proposition 10 23 if a is a densely defined closed operator acting from h to k then a a with equality of domains proof if z is a subspace of h k then k h j z j h k z k h j z which shows that j z j z using proposition 10 22 it follows that g a j g a j g a and g a j g a jj g a g a g a for operators acting in hilbert spaces we have the following extension of proposition 4 31 the proof of which is almost verbatim the same 320 the spectral theorem for unbounded normal operators proposition 10 24 if a is a densely defined closed operator from h into another hilbert space k then h and k admit orthogonal decompositions h n a r a k n a r a in particular 1 a is injective if and only if a has dense range 2 a has dense range if and only if a is injective 10 1 c the spectrum the spectrum of a linear operator is defined in the same way as for bounded operators except that explicit attention has to be paid to domains definition 10 25 resolvent and spectrum the resolvent set of a linear operator a acting in x is the set a consisting of all c for which the operator i a has a two sided inverse that is there exists a bounded operator u on x such that i for all x d a we have u i a x x ii for all x x we have ux d a and i a ux x the spectrum of a is defined as the complement of the resolvent set of a a c a we emphasise that although a is allowed to be unbounded the two sided inverse u i a 1 is required to be bounded it is customary to write r a a 1 for a as in the bounded case the resolvent identity holds if a then r a r a r a r a 10 2 by the observation in example 10 8 a linear operator with nonempty resolvent set is closed the proofs of lemmas 6 7 the holomorphy of the resolvent contained as part of lemma 6 10 and propositions 6 12 and 6 17 carry over verbatim and proposition 1 21 carries over with an obvious adaptation of the proof for the reader s convenience we state the results here proposition 10 26 if a is closed and satisfies ax c x for some c 0 and all x d a then a is injective and has closed range 10 1 unbounded operators 321 proposition 10 27 the spectrum a is a closed subset of c more precisely if a then b r a with r 1 r a moreover if 6 r with 0 6 1 then r a 6 1 r a proposition 10 28 the function 7 r a is holomorphic on a and its complex derivative is given by r a 2 proposition 10 29 if n in c with each n a and with a then lim n r n a by the result of examples 10 7 and 10 8 a linear operator which is not closed has full spectrum a c for if we had a then the boundedness of r a a 1 exhibits a as the inverse of a bounded hence closed operator and hence a is closed the following proposition gives a simple but powerful uniqueness result proposition 10 30 let a and b be linear operators on a banach space x if a b 6 and b is an extension of a then a b with equality of domains proof fix an arbitrary a b then for all x x we have r a x d a d b and b r a x a r a x x multiplying both sides from the left with r b gives r a x r b x since x x was arbitrary we conclude that r a r b and therefore d a d b the following result is proved in the same way as propositions 6 18 and 8 9 proposition 10 31 if a as a densely defined operator in a banach space x then a a if a as a densely defined operator in a hilbert space h then a a for later use we compute the spectrum of a simple diagonal operator proposition 10 32 let a be a densely defined closed operator in a separable hilbert space h with an orthonormal basis hn n 1 of eigenvectors if a 6 and the corre sponding eigenvalue sequence n n 1 satisfies limn n then a n n 1 322 the spectral theorem for unbounded normal operators proof let 6 n n 1 the assumption n implies that infn 1 n 0 and therefore the mapping r hn 7 1 n hn has a unique extension to a bounded operator on h of norm at most 1 it is clear that this operator is injective so its inverse r 1 is closed hence the operator b r 1 with domain d b r r is closed clearly b and r b r moreover bhn hn n hn nhn ahn n 1 we claim that the linear span y of the vectors hn n 1 is dense in d b with re spect to the graph norm indeed let g d b then g r r say g r h with h j 1 c jh j h let pk denote the orthogonal projection onto the span of h 1 hk then pkg g in h as k also pkg r r d b and b pkg b pkr h b k j 1 c j j h j k j 1 c jh j h r 1 g b g as k this implies bpkg bg it follows that pkg g in d b as claimed since y is contained in d a and a is closed it follows that b a now let 0 a then 0 6 n n 1 since every n is an eigenvalue for a and therefore 0 b by what we just proved proposition 10 30 now implies a b but then by what we already proved for b every 6 n n 1 belongs to a 10 2 unbounded selfadjoint operators in what follows we let h be a hilbert space definition 10 33 symmetric and positive operators a linear operator a acting in h is called symmetric if for all x y d a we have ax y x ay positive if for all x d a we have ax x 0 over the complex scalars positive operators are symmetric indeed if a is positive then for all x d a we have ax x ax x x ax by polarisation as in the proof of proposition 8 1 this requires working over the complex scalars this implies ax y x ay for all x y d a it is an immediate consequence of definition 10 33 and the definition of a that if a is densely defined and symmetric then d a d a and ax a x for all x d a that is a is an extension of a since a is closed we have shown 10 2 unbounded selfadjoint operators 323 proposition 10 34 if a is a densely defined symmetric operator then a is closable and a is a closed extension of a in general d a may be strictly smaller than d a a simple example is the laplace operator on l 2 rd with domain c c r d this operator is densely defined and sym metric but not closed and therefore is a proper extension of this motivates the following definition definition 10 35 selfadjoint operators a densely defined operator a in h is called selfadjoint if a a that is if d a d a and ah a h for all h d a d a the operator a is called essentially selfadjoint if it is closable and its closure a is self adjoint here are some simple examples example 10 36 multipliers let f be a measure space and let m c be a measurable function it has been shown in example 10 6 that the linear operator mm in l 2 defined by d mm f l 2 m f l 2 mm f m f f d mm is densely defined and closed it is immediate from the definition of the hilbert space adjoint that m m mm with equality of domains d mm d mm as a consequence mm is selfadjoint in l 2 if and only if m is real valued almost everywhere example 10 37 fourier multipliers let m rd r be a real valued measurable func tion and let am denote the possibly unbounded fourier multiplier in l 2 rd defined by d am f l 2 rd m f l 2 rd am f m f f d am 10 3 let us prove that am is selfadjoint in l 2 rd the symmetry of the multiplier mm con sidered in the previous example implies that am is symmetric for all f g d am we have f g d mm and by the plancherel theorem am f g mm f g f mmg f amg by proposition 10 34 this implies d am d a m conversely if g d a m and a mg h then for f d am we have since f d mm f h f h am f g a m f g mm f g this means that g d m m hence by the previous example g d mm this means that mg l 2 rd and therefore g d am 324 the spectral theorem for unbounded normal operators two special cases are of special interest example 10 38 the momentum operator the multiplier m gives rise to the operator 1 i d dx on l 2 r with the domain given by 10 3 this operator is selfadjoint with the notation and techniques developed in section 11 1 e this domain is seen to be the sobolev space h 1 r w 1 2 r example 10 39 the laplacian the multiplier m 2 gives rise to the laplace operator dj 1 2 x 2 j on l 2 rd with the domain given by 10 3 this operator is selfadjoint with the notation and techniques developed in section 11 1 e this domain is seen to be the sobolev space h 2 rd w 2 2 rd the following version of theorem 8 11 holds proposition 10 40 if a is selfadjoint then a r if in addition a is positive then a 0 proof this may be established by repeating parts of the proof of theorem 8 11 using propositions 10 26 and 10 24 instead of proposition 1 21 and 4 31 respectively the following proposition provides a sufficient condition for selfadjointness proposition 10 41 if a is densely defined and symmetric and a r 6 then a is selfadjoint proof the nonemptiness of the resolvent set implies that a is closed cf example 10 8 the operator a is closed as well the symmetry of a implies d a d a and if a r then a in view of proposition 10 31 the identity a a with equality of domains therefore follows from proposition 10 30 an efficient proof of the next proposition is obtained by noting that proposition 10 22 implies the following criterion for selfadjointness a densely defined operator a in h is selfadjoint if and only if j g a g a where j x y y x for x y h proposition 10 42 if the linear operator a is selfadjoint injective and has dense range then its inverse a 1 with domain d a 1 r a is selfadjoint proof from x y g a 1 y x g a j x y g a x y j g a x y j g a 10 2 unbounded selfadjoint operators 325 we see that g a 1 j g a applying j to both sides gives j g a 1 g a hence since a is selfadjoint by the above criterion g a 1 j g a g a j g a 1 applying the criterion once more this proves that a 1 is selfadjoint as a simple application of proposition 10 42 we record the following result corollary 10 43 let a be a densely defined closed positive operator in h if i a has dense range then a is selfadjoint proof from i a x x i a x x x 2 we see that i a x x for all x d a since a and hence i a is closed by proposition 10 26 this implies that i a is injective and has closed range since i a also has dense range i a is surjective and the inverse i a 1 is well defined as a linear operator the bound i a x x implies that i a 1 is bounded and in fact contractive at the same time this bounded operator is positive and therefore selfadjoint proposition 10 42 therefore implies that i a hence also a is selfadjoint as an application of corollary 10 43 we have the following sufficient condition for selfadjointness theorem 10 44 selfadjointness of a a if a is a densely defined closed operator from h into another hilbert space k then 1 the operator a a is selfadjoint and positive 2 d a a is dense in d a with respect to the graph norm this operator will be revisited in proposition 12 18 in connection with the theory of forms proof 1 we check that the operator a a which is obviously positive satisfies the assumptions of corollary 10 43 by proposition 10 22 we have the orthogonal decomposition h k g a j g a hence for any u k we can find x d a and y d a such that 0 u y a y j x ax y ax a y x it follows that y ax which implies x d a a and u a y x i a a x this proves that i a a is surjective 2 to prove density of d a a in d a with respect to the graph norm suppose that x d a is such that x y d a 0 for all y d a a where x y d a x y ax ay is the inner product of d a viewed as a hilbert space with respect to this inner 326 the spectral theorem for unbounded normal operators product completeness being a consequence of the closedness of a see proposition 10 3 then 0 x y x a ay x i a a y for all y d a a since i a a is surjective this means that x z 0 for all z d a so x 0 we finish this section with another useful criterion for selfadjointness theorem 10 45 for a densely defined symmetric operator a in h the following asser tions are equivalent 1 a is selfadjoint 2 a is closed and n a i n a i 0 3 r a i r a i h proof 1 2 if a is selfadjoint then a a is closed by proposition 10 23 if x d a satisfies a i x 0 then x d a and ax a x ix and i x x ax x x a x i x x implies x 0 in the same way a i x 0 implies x 0 2 3 by the same argument as in the proof of proposition 4 31 the injectivity of a i a i implies that a i has dense range and conversely this will be used in the proof of the next implication by the same argument as in the proof of theorem 8 11 the symmetry of a implies a i x x for all x d a and since a is closed proposition 10 26 implies that the ranges of a i are closed we conclude that both ranges equal h 3 1 fix an arbitrary h d a the assumption r a i r a i implies that there exists an h d a such that a i h a i h since a extends a we have h d a and a h ah it follows that a i h a i h as was noted in the proof of the previous implication the assumptions imply that a i is injective and therefore h h since h d a this implies that h d a and ah a h the latter since a extends a this shows that a extends a since a extends a these operators are equal the theory of selfadjoint operators is taken up again in section 12 2 in connection with the theory of forms 10 3 unbounded normal operators having dealt with unbounded selfadjoint operators we now turn to unbounded normal operators 10 3 unbounded normal operators 327 10 3 a definition and general properties definition 10 46 normal operators a linear operator a in h is said to be normal if it is closed densely defined and satisfies a a aa the equality a a aa is shorthand for equality of the domains d a a x d a ax d a d aa x d a a x d a along with equality a ax aa x for all x in this common domain since a a by proposition 10 23 a densely defined closed operator a is normal if and only if its adjoint a is normal proposition 10 47 if a is a normal operator then 1 d a d a 2 ax a x for all x d a d a 3 if a b with b normal then a b proof 1 and 2 the normality of a implies that if x d a a d aa then x d a x d a and ax 2 a ax x aa x x a x 2 by theorem 10 44 d a a is dense in d a so for any x d a we may choose a sequence xn x with each xn d a a d aa and with convergence in the graph norm of d a then xm xn d a and from lim n m a xn a xm lim n m axn axm 0 we infer that a xn y for some y h from the closedness of a proposition 10 23 we infer that x d a and a x y this argument shows that d a d a since a is normal what we just proved can be applied to a this together with proposition 10 23 gives the reverse inclusion d a d a d a 3 if a b with a and b normal then by 1 proposition 10 19 1 and another application of 1 d b d b d a d a together with the assumption d a d b this implies d a d b 328 the spectral theorem for unbounded normal operators 10 3 b the measurable functional calculus projection valued measures give rise to normal operators theorem 10 48 measurable functional calculus let f be a measurable space let p f l h be a projection valued measure and let f c be a measurable function there exists a unique normal operator f in h satisfying d f x h f 2 dpx f x x f dpx x d f for all x d f we have f x 2 f 2 dpx 10 4 furthermore if fn f g c are measurable functions then 1 f g f g with d f g d f g d g 2 f f 3 if 06 fn 6 f and limn fn f pointwise on then d f d fn and lim n fn x f x x d f the operator f is selfadjoint if and only if f is real valued px almost everywhere for all x h it follows from 1 that f g f g d f g d g 10 5 this is trivially the case if g is bounded for then d g h in that case g is bounded and equals the operator given by the bounded calculus of theorem 9 8 this fact and the properties of the bounded calculus will be frequently used in the proof below example 10 49 under the above assumptions it follows from 10 5 that f n f n n 1 2 to prove this proceeding by induction it suffices to check that f k 1 f k f for all k 1 2 by 10 5 this operator identity holds if and only if d f k 1 d f if x d f k 1 then f 2 k 2 dpx since px is a finite measure this implies f 2 dpx that is x d f 10 3 unbounded normal operators 329 proof for the moment define d f to be the set x h f 2 dpx if x y d f and g kj 1 c j 1 b j is a simple function satisfying 06 g 6 f 2 with c j 0 and disjoint sets b j f then by the cauchy schwarz inequality for the sesquilinear forms x y 7 pb j x y gdpx y k j 1 c j pb j x y x y 6 k j 1 c j pb j x x 2 pb j x x 1 2 pb j y y 1 2 pb j y y 6 2 k j 1 c j pb j x x pb j y y 2 gdpx 2 gdpy 6 2 f 2 dpx 2 f 2 dpy taking the supremum over all such simple functions g we obtain f 2 dpx y 6 2 f 2 dpx 2 f 2 dpy this shows that d f is closed under addition the identity f 2 dpcx c 2 f 2 dpx is evident for simple functions f follows for general functions f by approximation and shows that d f is also closed under scalar multiplication it follows that d f is a linear subspace of h to prove that d f is dense in h fix an arbitrary x h and for n 1 2 let bn f 6 n then for all x r pbn and b f 1 b dpx pbx x pbpbnx x pb bnx x bn 1 b dpx so by linearity and monotone convergence f 2 dpx bn f 2 dpx 6 n 2 px bn 6 n 2 px n 2 x 2 this implies that r pbn is contained in d f since n 1 bn monotone convergence implies that pbnx 2 pbnx x 1 bn dpx 1 dpx x 2 and therefore x pbnx x 2 2 pbnx x pbnx 2 0 as n this proves that x belongs to the closure of d f 330 the spectral theorem for unbounded normal operators for simple functions g kj 1 c j 1 b j we set g k j 1 c jpb j it is routine to check that this is well defined and that 10 4 holds for g if x d f then f l 2 px if gn f in l 2 px with each gn simple then gn x gm x 2 gn gm 2 dpx 0 as n m consequently for x d f we may define f x lim n gn x this is well defined and the validity of 10 4 for gn implies the validity of 10 4 for f in this way we obtain a well defined linear operator f d f h in what follows we view f as a linear operator in h with domain d f d f the closedness of f follows from 2 applied to f and proposition 10 18 normality of f is an easy consequence of 1 applied with g f noting that d f 2 d f follows from ho lder s inequality or noting that f 2 dpx 6 1 f 4 dpx by 2 f is selfadjoint if and only if f f and by 10 4 applied to f f this holds if and only if f is real valued px almost everywhere for all x h 3 by 10 4 applied to f fn for x d f we have x d f fn and lim n f x fn x lim n f fn 2 dpx 0 by dominated convergence so limn fn x f x in what follows for n 1 2 let fn 1 f 6 n f 1 first let f be bounded and measurable and g be measurable for all x d g we have x d f g and using 3 the boundedness of f and the multiplicativity of the borel calculus for bounded normal operators f g x lim n f gn x lim n f gn x f g x hence by 10 4 f 2 dp g x f g 2 dpx this being true for all bounded measurable functions f by monotone convergence it is true for all measurable functions f hence if f and g are measurable we infer that for elements x d g we have g x d f if and only if x d f g this is the same as saying that 1 holds 10 3 unbounded normal operators 331 2 let x d f and y d f d f then by 3 and the properties of the borel calculus for bounded normal operators f x y lim n fn x y lim n x fn y x f y this shows that y d f and f y f y we have thus proved the inclusion f f for the converse inclusion let y d f we wish to prove that y d f d f that is that f 2 dpy let z f y we claim that 1 f 6 n z fn y 10 6 it follows from 1 applied with g 1 f 6 n that for all x h we have 1 f 6 n x d f and f 1 f 6 n x fn x then for all x h x 1 f 6 n z 1 f 6 n x f y f 1 f 6 n x y fn x y x fn y using the conjugation property of the borel calculus for bounded normal operators in the last step this proves the claim 10 6 by 10 4 and 10 6 fn 2 dpy fn y 2 1 f 6 n z 2 1 f 6 n dpz and therefore f 2 dpy lim n fn 2 dpy lim n 1 f 6 n dpz 6 1 dpz z 2 so that y d f this completes the proof of the identity f f the following substitution rule extends proposition 9 9 proposition 10 50 let f and f be measurable spaces and let f be a measurable mapping if p f l h is a projection valued measure then the mapping q f l h defined by qb pf 1 b b f is a projection valued measure denoting by and the measurable functional calculi of p and q for all measurable functions g c we have g f g with equality of domains 332 the spectral theorem for unbounded normal operators proof the proof is the same as that of proposition 9 9 except that some domain issues have to be taken care of following this proof for all nonnegative measurable functions g on and x x we obtain g f dpx gdqx 10 7 the finiteness of one of these integrals implying the finiteness of the other applying this with g replaced by g 2 it follows that x d g f if and only if x d g for all x in this common domain 10 7 can be rewritten as g f x x g x x and by polarisation this implies that for all x y in this common domain we have g f x y g x y the operator g being normal is densely defined and therefore this identity holds for all y h the result now follows 10 4 the spectral theorem for unbounded normal operators the proof of the spectral theorem for unbounded normal operators proceeds by a reduc tion to the bounded case the basic idea is to exploit the fact that the mapping z 7 z 1 z 2 1 2 maps the complex plane bijectively onto the open unit disc d this suggests that if a is a normal operator then za a i a a 1 2 is a normal contraction on h this is indeed the case as will be proved in proposition 10 53 it follows that za d by the spectral theorem for bounded normal operators there exists a projection valued measure q on d such that za d dq we now define a projection valued measure p on c by setting pb q b for borel sets b c and use proposition 10 50 to show that a c dp in the same way the uniqueness of p for representing a is reduced to the uniqueness of q for representing za some technical details need to be addressed to turn this simple idea into a rigorous proof one has to deal with subtle domain issues and with the fact that maps c onto the open unit disc whereas q is supported on the closed unit disc we start with the proof that za is well defined as a contractive normal operator on h this is accomplished in proposition 10 53 for which we need two lemmas 10 4 the spectral theorem for unbounded normal operators 333 lemma 10 51 let a be a closed operator in h let t l h and let f c t then 1 if t is selfadjoint and ta at then f t a a f t 2 if t is normal and ta at and t a at then f t a a f t proof we only prove the second assertion the first being an immediate consequence we have t 2 a t ta t at ta t at t at 2 continuing by induction we see that t ka at k for all k n in the same way it is seen that t ka at k for all k n these inclusions imply that p t t a ap t t for all polynomials p in the variables z and z notation is as in section 8 2 b by the stone weierstrass theorem there exist polynomials pn in the variables z and z such that pn z z f z uniformly with respect to z t then by the properties of the continuous functional calculus for normal operators theorem 8 22 pn t t f t sup z t pn z z f z 0 as n the inclusions pn t a apn t imply that if x d a then pn t x d a and lim n apn t x lim n pn t ax f t ax since also limn pn t x f t x the closedness of a implies that f t x d a and a f t x f t ax this gives the result we have seen in theorem 10 44 that if a is a densely defined closed operator in h then a a is selfadjoint and by proposition 10 40 we have a a 0 this allows us to define ta i a a 1 this operator is bounded and positive and if a is normal we have ta ta lemma 10 52 if a is normal then for all x d a we have tax d a and atax taax proof let x d a then y tax d a a d a ay atax d a and a ay x tax d a so ay d aa d a a combining this with i aa a a aa a a a a a a i a a it follows that atax ta i aa atax taa i a a ta x taax proposition 10 53 if a is a normal operator then 334 the spectral theorem for unbounded normal operators 1 the range of t 1 2 a is densely contained in d a 2 the operator za at 1 2 a is contractive and we have ta i z aza 3 za is normal and z a za proof 1 and 2 we have r ta d a a d a and therefore the operator ata is well defined on all of h as a composition of a bounded operator and a closed operator it is closed and therefore bounded by the closed graph theorem the operator ta is bounded and positive and the injectivity of ta implies the injectivity of its square root t 1 2 a by selfadjointness and proposition 4 31 this square root has dense range for y t 1 2 a x in this range we have t 1 2 a y tax d a a d a so y d za h h t 1 2 a h d a and zay 2 atax 2 a atax tax x tax tax tax 6 x tax y y y 2 since the range of t 1 2 a is dense so is d za and therefore with respect to the norm of h za is contractive from its dense domain into h the operator za is also closed for if yn y in h with yn d za and zayn at 1 2 a yn y in h the closedness of a implies t 1 2 a y d a and at 1 2 a y y but then y d za and zay y thus za is closed densely defined and contractive with respect to the norm of h this forces d za h we have already shown that the range of t 1 2 a is contained in d a to see that this inclusion is dense with respect to the graph norm it suffices to note that r ta d a a is dense in d a with respect to the graph norm of d a by theorem 10 44 the inclusions r ta r t 1 2 a d a therefore imply that the inclusion r t 1 2 a d a is dense with respect to the graph norm of d a by lemma 10 52 for x d a we have tax d a and atax taax so taa ata and then lemma 10 51 implies t 1 2 a a at 1 2 a 10 8 also for x d a z azax x at 1 2 a x at 1 2 a x t 1 2 a ax t 1 2 a ax taax ax atax ax a atax x i ta x x since both ta and za are bounded the identity z azax x i ta x x extends to arbitrary x h this implies the operator identity ta i z aza 3 since a is normal we have ta ta since this operator is selfadjoint and a is normal it follows that za a t 1 2 a a t 1 2 a a t 1 2 a i t 1 2 a a ii at 1 2 a z a 10 4 the spectral theorem for unbounded normal operators 335 where both i and ii follow from proposition 10 19 and 10 8 both za and za are bounded the latter by proposition 10 53 applied to a and therefore za z a normality of za now follows from z azax x zax zax at 1 2 a x at 1 2 a x a at 1 2 a x t 1 2 a x and zaz ax x z ax z ax za x za x aa t 1 2 a x t 1 2 a x observing that the two right hand sides are equal since a is normal now we are ready for stating and proving the main result of this section theorem 10 54 spectral theorem for normal operators for every normal operator a there exists a unique projection valued measure p on a such that a a dp proof consider the mapping z 7 z 1 z 2 1 2 10 9 which maps the complex plane bijectively onto the open unit disc d with inverse 1 w 7 w 1 w 2 1 2 define the projection valued measure p on c by pb q b b b c where q is the projection valued measure of the normal contraction za which is sup ported on za since za is contractive za is contained in d it will be convenient to think of q as supported on d the proof that p has the desired properties and is unique is carried out in several steps in what follows we let and denote the measurable functional calculi of p and q step 1 let id we begin by proving the inclusion r t 1 2 a d id where id c iddp let cc c satisfy 0 6 6 1 pointwise using proposition 10 50 the fact that 1 has compact support in d and the fact that q is supported on za d c z z 2 dpx z d 1 1 2 dqx 336 the spectral theorem for unbounded normal operators d 1 1 2 dqx za 1 1 2 dqx za x x where c za is the function 1 1 2 1 2 1 2 1 suppose now that x r t 1 2 a say x t 1 2 a y i za 2 1 2 y 10 10 for some y h this follows from ta i z aza i za 2 then c z z 2 dpx z za x x 1 za za 2 y y 1 2 1 za zay 2 6 7 1 2 1 zay 2 6 zay 2 ax 2 keeping in mind that x r t 1 2 a d a applying this to a sequence n cc c satisfying 06 n 1 pointwise as n by monotone convergence we obtain c id 2 dpx c z 2 dpx z 6 ax 2 this proves that x d id step 2 we now prove that for x t 1 2 a y r t 1 2 a we have c dpx ax x repeating the reasoning in step 1 with cc c as before with 1 1 1 1 2 1 2 we obtain c z zdpx z za x x 1 za za i za 2 1 2 y y applying this to a sequence n cc c satisfying 0 6 n 1 pointwise as n by dominated convergence the convergence property of the bounded functional calculus and 10 10 we obtain c zdpx z lim n c n z zdpx z lim n n 1 za za i z aza 1 2 y y za i z aza 1 2 y y zat 1 2 a y y ax x step 3 since both a and id are closed and since r t 1 2 a is dense in d a by 10 4 the spectral theorem for unbounded normal operators 337 proposition 10 53 the result of step 2 implies that a id since both operators are normal the identity a id c dp follows from proposition 10 47 step 4 it remains to prove uniqueness of p we will do so by reducing matters to the uniqueness of q suppose that a a dp for a projection valued measure p on a let denote the measurable calculus as sociated with p we have id a and id a by theorem 10 48 2 by the multiplicativity 1 id 6 n id 2 1 id 6 n id 1 id 6 n id taking limits n using theorem 10 48 3 for x d a a we have x d id 2 and id 2 x id id x a ax similar arguments show that 1 id 2 1 x 1 id 2 1 x i a a 1 x tax since d a a is dense this identity extends to arbitrary x h then as in step 1 of the proof of theorem 10 54 the multiplicativity for the measurable calculus for bounded selfadjoint operators and the uniqueness of positive square roots gives 1 id 2 1 2 t 1 2 a hence x id 1 id 2 1 2 x at 1 2 a x zax 10 11 since d a a is dense in h this identity extends to arbitrary x h consider the projection valued measure q on d given by q b p 1 b where c d is the bijection of 10 9 in what follows we view as a measurable mapping from c to d with cc c as before by 10 11 and proposition 10 50 we have zax x x x x x lim n c 1 6 n dp x limn d 1 6 n 1 dq x d 1 dq x d 1 dq x applying this to a sequence n cc c satisfying 06 n 1 pointwise as n by the 338 the spectral theorem for unbounded normal operators convergence property of the bounded functional calculus and dominated convergence we obtain zax x lim n n zax x lim n d n 1 dq x d dq x by proposition 9 12 the support of q is contained in za and therefore we have za za dq x this shows that q is the projection valued measure of za now proposition 9 13 implies that q q and hence p p for normal operators a and measurable functions f a c the operator f defined in terms of the projection valued measure of a by the calculus of theorem 10 48 will be denoted by f a f a f a f dp in the same way as for bounded normal operators in theorem 9 19 the properties of the bounded calculus translate into corresponding properties for the mapping f 7 f a the result of example 10 49 says that for any normal operator a and measurable function f a c f n a f a n n 1 2 if p is a projection valued measure on a measurable space f and f c is measurable the p essential range of f is the set rp f of all z c such that pez r 6 0 for all r 0 where ez r f z r it is easy to see that rp f is a closed set contained in f theorem 10 55 spectral mapping theorem let a be normal with projection valued measure p and let f a c be measurable then f a rp f f a if f is continuous then f a f a proof let z rp f since rp f is closed the function gz 7 z f 1 is well defined p almost everywhere and bounded on a and therefore the operator gz a is bounded moreover z f a gz a gz a z f a a by theorem 10 48 and the boundedness of gz it follows that gz a is a two sided inverse for z f a this proves the inclusion f a rp f 10 4 the spectral theorem for unbounded normal operators 339 suppose next that z rp f since p is supported on a for n 1 2 the orthogonal projections pez 1 n are nonzero where ez 1 n a f z 1 n in particular ez 1 n 6 and this implies that d z f a 1 n this being true for all n 1 it follows that z f a if f is continuous and c is such that f 6 f a rp f then for 0 small enough the relatively open set n a f f satisfies pn 0 the continuity of f implies that b a n for some small enough 0 but then 6 rp id id a a this proves the inclusion f a f a which self improves to f a f a since f a is closed the following result gives necessary and sufficient condition for the presence of eigenvalues for the operators f a theorem 10 56 eigenvalues let a be a normal operator with projection valued mea sure p and let f a c be measurable for c let n f a f the following assertions are equivalent 1 is an eigenvalue of f a 2 pn f 6 0 in this situation pn f is the orthogonal projection onto the corresponding eigenspace and for a vector x h the following assertions are equivalent 3 x d f a and f a x x 4 pn f x x proof upon replacing f by f we may assume that 0 set n f n f 0 for brevity if x d f a satisfies f a x 0 then f 0 for px almost all a by 10 4 this is equivalent to saying that px almost every point of a is contained in n f that is px a n f 0 this in turn is equivalent to saying that p a n f x 0 that is x pn f x 0 conversely if pn f x x or equivalently if f 0 px almost everywhere on a then x d f d f a by the definition of d f in theorem 10 48 this proves the equivalence 3 4 this equivalence also establishes that pn f is the orthogonal projection onto the eigenspace x d f a f a x 0 it further shows that if 0 is an eigenvalue of f a with eigenvector x d f a then pn f x p a x p a n f x p a x x 2 6 0 since x 6 0 this proves the implication 1 2 if 2 holds there exists a nonzero x h with pn f x x and 1 follows from the implication 4 3 340 the spectral theorem for unbounded normal operators corollary 10 57 let a be a normal operator and let f a c be measurable if x d a satisfies ax x then x d f a and f a x f x as in the bounded case we can use the functional calculus to define square roots proposition 10 58 if a is a positive selfadjoint operator then a admits a unique posi tive selfadjoint square root a 1 2 proof the operator f a with f 1 2 is selfadjoint and positive and squares to a by the result of example 10 49 this proves existence to prove uniqueness suppose that b is a positive selfadjoint operator satisfying b 2 a let p and q be the projection valued measures of a and b both are supported on 0 since a and b are selfadjoint and positive let r be the projection valued measure on 0 defined by rc qc 2 for borel sets c 0 by theorem 10 50 and the result of example 10 49 0 dr 0 2 dq b 2 a 0 dp it follows that both r and p are projection valued measures representing a by the uniqueness part of theorem 10 54 we therefore have r p but then a 1 2 0 1 2 dp 0 1 2 dr 0 dq b if a is normal we may use the measurable calculus to define a f a where f furthermore a a is selfadjoint and positive so it has a unique selfad joint and positive square root a a 1 2 by proposition 10 58 the next corollary extends corollary 8 29 to unbounded normal operators corollary 10 59 for every normal operator a we have d a d a and a a 1 2 a proof with id we have d a d id d id d a the middle identity being immediate from the definition of these domains applying the result of example 10 49 twice we obtain with f a 2 f a f a f 2 a id id a id a id a a a with justification of the domain equalities as in the preceding proof the identity a a 2 1 2 now follows by taking positive square roots using proposition 10 58 we proceed with some examples 10 4 the spectral theorem for unbounded normal operators 341 example 10 60 multiplication operators let f be a measure space and let m c be a measurable function the linear operator am defined by d am f l 2 m f l 2 am f m f f d am is normal its spectrum am equals the essential range of m and its projection valued measure is given by pb f 1 m 1 b f for b b am and f l 2 example 10 61 fourier multiplication operators let m rd c be a measurable function the linear operator tm defined by d tm f l 2 rd f f d am tm f f 1 amf f f d tm where am is the operator of the preceding example is normal its spectrum equals tm am and its projection valued measure is given by pb f f 1 1 m 1 b f f t 1 m 1 b for b b tm and f l 2 rd thus the projections in the range of the projection valued measure of the fourier multiplier operator tm are fourier multiplier operators themselves to conclude we complete the proof of theorem 9 28 proof of theorem 9 28 the inclusion we split the proof into four steps step 1 let hn n 1 be a dense sequence in h and set gn hn n 1 k 1 khn n 1 where k is the orthogonal projection onto the closed linear span hk of the sequence t jgk j n we further set 0 0 we claim that t k kt for all k n for k 0 this is trivial and for k 1 this follows from the following argument if h r k hk then t h hk r k and therefore t kh t h kt h if h r k then h t jgk for all j n and then t h t jgk h t j 1 gk 0 by selfadjointness so t h t jgk for all j n and conse quently t h r k this implies t kh 0 kt h we claim that j k k j 0 j k n j 6 k 10 12 342 the spectral theorem for unbounded normal operators it is clear that 10 12 holds for j 0 and k 1 suppose 10 12 has been proved for all indices 06 j 6 k 6 n 1 if j n then jgn jhn j n 1 k 1 khn jhn jhn 0 by the induction hypothesis in particular jt kgn t k jgn 0 k n from which it follows that hn r n is contained in n j so hn h j this implies that j n n j 0 completing the induction step next we claim that h j 1 jh h for all h h by density it suffices to prove this for the vectors h hn from the dense sequence for these vectors hn gn n 1 k 1 khn gn n 1 k 1 khn hn where we used the orthogonality of the projections n to see that gn ngn gn and k k choose a sequence of numbers cn 0 such that the sum n 1 cngn converges for in stance one could choose cn 2 n gn 1 n denote its sums by x let hx denote the closed linear span of the sequence t kx k n and let x denote the orthogonal projection onto hx by the same argument as before the operators x and t commute step 2 let s t be arbitrary and fixed since x t it follows that s x xs as a result sx hx since hx is the closed linear span of the vectors t jx j n it follows that there exist polynomials pn such that pn t x sx then pn t x pm t x 2 t pn pm 2 dpx where p is the projection valued measure of t since the left hand side tends to 0 as m n the sequence pn n 1 is cauchy in l 2 t px let f l 2 t px be its limit and pick any pointwise defined measurable function representing it with slight abuse of notation this representative is denoted by f again step 3 relative to the projection valued measure p by the measurable calculus of theorem 10 48 the operator f t f with domain d f t h h f 2 dph is well defined and selfadjoint to complete the proof we show that d f t h f t is bounded hence a posteriori f can be taken to be bounded and s f t we begin by noting that x d f t and sx t f dpx lim n t pn dpx lim n pn t x f t x 10 4 the spectral theorem for unbounded normal operators 343 if v l h commutes with t then v t so v commutes with s we claim that v x d f t and f t v x v f t x v sx indeed first we note that t pn pm 2 dpv x pn t pm t v x 2 v pn t pm t x 2 v s s x 2 0 since pn f in l 2 t px after passing to a subsequence if necessary we may assume that pn f pointwise outside a borel set n satisfying px n 0 but since v commutes with pn pv x n t 1 npv x pnv x v x pnx v v x 6 pnx v v x pnx x 1 2 v v x 0 this implies that also pn f pointwise pv x almost everywhere this allows us to in voke the dominated convergence theorem to conclude that for every n 1 t f 2 n dpv x lim n t pn 2 n dpv x 6 limsup n t pn 2 dpv x limsup n pn t v x 2 limsup n v pn t x 2 6 v 2 limsup n pn t x 2 v 2 t f 2 dpx letting n and applying the monotone convergence theorem this proves that v x d f t the required identity then follows from f t v x lim n pn t v x v lim n pn t x v f t x v sx sv x step 4 we apply the result of step 3 to the bounded operator vkmn c 1 m pnt k m where pn p f 6 n in view of mx n 1 cn mgn cmgm we have f t pnt kgm c 1 m f t pnt k mx f t vkmnx svkmnx c 1 m spnt k mx spnt kgm it follows that f t pnh spnh for all h in the linear span of the sequence t kgm k n which is dense in hm since the spaces hm m 1 span a dense subspace of h this 344 the spectral theorem for unbounded normal operators implies that there is a dense subspace y of h such that f t pnh spnh for all n 1 and h y since f t is closed and f t pn is bounded this identity extends to arbitrary h h fix an arbitrary h d f t then pnh h and f t pnh spnh sh so the closed ness of f t implies that f t h sh since s is bounded and f t is closed this forces d f t h and f t s problems 10 1 prove propositions 10 26 10 29 10 2 let a be a densely defined operator in a banach space x which is bounded with respect to the norm of x that is there is a constant c 0 such that ax 6 c x for all x d a prove that a is closable d a x and a is bounded with ax 6 c x for all x x 10 3 let a be a densely defined closed operator in a banach space x and suppose there is a subspace y contained in d a and dense in x such that ay 0 for all y y does it follow that ax 0 for all x d a what happens if the closedness assumption is dropped 10 4 show that if a and b are linear operators in a complex hilbert space such that d a d b and ax x bx x x d a d b then a b 10 5 define the linear operator a in l 2 0 1 by d a c 0 1 a f f 0 1 f d a show that a is densely defined but nonclosable 10 6 let a be any nonclosable operator in a hilbert space h show that the operator b on the hilbert space direct sum h h defined by d b d a 0 b x 0 0 ax x 0 d b is symmetric and nonclosable this example shows that the densely definedness assumption cannot be omitted from proposition 10 34 10 7 provide the details to example 10 7 problems 345 10 8 let m be an arbitrary nonempty closed subset of c in the banach space cb m of bounded continuous functions on m consider the linear operator a given by d a f cb m z 7 z f z cb m a f z z f z f d a z m a show that a is a closed operator b show that a m 10 9 in c 0 1 consider the linear operators a 1 f f and a 2 f f with domains d a 1 c 0 1 and d a 2 c c 0 1 a show that a 1 is closable and find the domain of its closure b show that a 2 is closable and find the domain of its closure 10 10 let a be a densely defined closed linear operator from a banach space x to a banach space y prove or disprove a for all t l x the operator at with domain d at x x t x d a is closed b for all t l y the operator ta with domain d ta d a is closed 10 11 let a be a densely defined closed linear operator from a banach space x to a banach space y prove or disprove a for all t l x we have d at d t a b for all t l y we have d ta d a t 10 12 give a direct proof of proposition 10 42 10 13 give a proof of proposition 10 24 10 14 let f be a measure space x be a banach space and suppose that f x is bochner integrable with respect to a prove hille s theorem if a is a closed linear operator in a banach space x f takes its values in d a almost everywhere and the almost everywhere defined function a f x is bochner integrable then f d d a and a f d a f d hint show that 7 f a f is bochner integrable as a function with values in x x and hence by the result of problem 1 26 as a function with values in the graph g a b justify the identity t 1 0 f t s ds 1 0 t f t s ds by providing conditions on f so that the result of part a can be applied 346 the spectral theorem for unbounded normal operators 10 15 show that the results of problems 9 3 and 9 4 extend to unbounded selfadjoint operators 10 16 prove the claims in examples 10 60 and 10 61 10 17 combining examples 10 39 and 10 61 find the projection valued measure of the laplace operator on l 2 rd viewed as a selfadjoint operator in this space with domain d h 2 rd 10 18 let a be a normal operator with projection valued measure p and let b a be a bounded borel subset show that pbx d a for all x h 10 19 let a be a selfadjoint operator with projection valued measure p show that for all c r we have the following formula for the resolvent of a r a a 1 dp 10 20 let a be a normal operator with projection valued measure p and let f g bb a show that if f g p almost everywhere in the sense that there is a borel set n such that pn 0 and f g on n then f a g a 10 21 let a be a normal operator a show that a is bounded if and only if a is bounded b find necessary and sufficient conditions on a given borel function f on a in order that f a be bounded 10 22 let a be a normal operator and let f be a borel function on a show that f a is injective with dense range if and only if f 6 0 p almost everywhere where p is the projection valued measure of a and that in this case we have f a 1 1 f a hint explain how 1 f a can be defined through the measurable functional calculus then use theorem 10 48 to check that d 1 f a f a d f a conclude that f a 1 1 f a to get the reverse inclusion apply the pre ceding to f 1 instead of f 11 boundary value problems having developed some of the core results of functional analysis we now turn to applications to partial differential equations this chapter is concerned with boundary value problems 11 1 sobolev spaces we begin by developing some elements of the theory of sobolev spaces our aims are relatively modest in that we only discuss those aspects of the theory that are needed for the purposes of the present chapter throughout this chapter we assume that d 1 is an integer and d is a nonempty open subset of rd multi index notation a d tuple 1 d nd is called a multi index of di mension d its order is the nonnegative integer 1 d we also define 1 d we write 6 if j 6 j for all j 1 d and in such cases we define 1 1 d d and this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 347 348 boundary value problems for x rd and nd we write x x 11 x d d similarly we define 11 d d where j is the partial derivative in the jth direction by a standard calculus result for ck functions the order in which the derivatives are taken is unimportant test functions by c d we denote the space of functions f d k having continu ous derivatives f on d of all orders nd and by c c d its subspace consisting of all functions compactly supported in d recall that this means that the closure of the set x d f x 6 0 is a compact set contained in d elements of c c d are referred to as test functions on d the existence of test functions with various additional properties is established in problem 2 9 in the same way one defines the space ck d k n as the space of functions f d k having continuous derivatives f on d of all orders nd satisfying 6 k with the convention that c 0 d c d and ckc d as its subspace of compactly supported functions by c d we denote the space of all functions in c d and with the property that f has a continuous extension to d for all nd the spaces ck d are defined similarly by considering only the multi indices satisfying 6 k a measurable function f d k is called locally integrable if its restriction to every open set u with compact closure contained in d is integrable the space of all locally integrable functions f d k is denoted by l 1 loc d as always we identify functions that are equal almost everywhere in our study of weak derivatives we need the following result on convolutions proposition 11 1 let k be a nonnegative integer if f l 1 loc r d and g ckc rd then the convolution f g is pointwise well defined and belongs to ck rd and we have f g f g for all multi indices nd satisfying 6 k this proposition may be proved in exactly the same way as lemma 4 59 but it is instructive to give a proof by mollification here proof first note that the convolution integrals defining f g and f g are point wise well defined as lebesgue integrals step 1 we begin with the case k 0 let f l 1 loc r d and g cc rd be given choose r 0 such that the support of g is contained in the ball b 0 r by uniform 11 1 sobolev spaces 349 continuity given 0 there exists 0 such that for all u u rd with u u we have g u g u hence for all x x rd with x x f g x f g x 6 rd f y g x y g x y dy b x r 2 f y g x y g x y dy 6 b x r 2 f y dy noting that g x y g x y 0 for y 6 b x r 2 this proves the continuity of f g at the point x rd step 2 next consider the case k 1 fix 1 6 j 6 d and let e j rd denote the unit vector along the jth coordinate axis let r 0 be such that the support of g is contained in the ball b 0 r given 0 choose 0 such that u u implies jg u jg u if 0 h then for all y rd we obtain 1 h g y he j g y jg y 1 h h 0 jg y te j jg y dt 6 1 h h 0 jg y te j jg y dt 6 taking the supremum over y this shows that lim h 0 1 h g he j g jg 0 as a consequence for all x rd we have lim h 0 1 h f g x he j f g x lim h 0 1 h rd f y g x he j y g x y dy lim h 0 1 h b 0 r f x y g y he j g y dy b 0 r f x y jg y dy rd f x y jg y dy where the penultimate step is justified by the uniform convergence of the difference quo tient and the fact that f is integrable on bounded sets this proves the differentiability of f g in the jth direction with j f g f jg and the derivative is continuous by step 1 applied to the function jg cc rd step 3 the result for k 2 follows by repeating the argument of step 2 inductively 350 boundary value problems the following version of theorem c 11 will be useful proposition 11 2 smooth partition of unity let f u 1 uk where f rd is compact and the sets u j rd are open for all j 1 k then there exist nonnegative functions f j c c u j j 1 k such that f 1 fk 1 on f here we think of the functions f j as elements of c c r d with support in u j proof taking intersections with an open ball containing f there is no loss of general ity in assuming that the sets u j are bounded since f is compact and the sets u j are open there exists a 0 such that f u 1 u k where f x r d d x f 6 and u j x u j d x u j theorem c 11 provides us with nonnegative con tinuous functions g j rd 0 1 supported in u j such that g 1 gk 1 on f choose a nonnegative test function c c rd with compact support in the open ball b 0 and satisfying rd dx 1 the functions f j g j are smooth by proposition 11 1 and have the desired properties 11 1 a weak derivatives in order to make the body of theorems in functional analysis applicable to the theory of partial differential equations it is desirable to be able to discuss derivatives of functions in lp d the difficulty is that for such functions the classical pointwise definition of differentiability through limits of difference quotients does not make sense since their values are well defined only almost everywhere this necessitates an approach that is insensitive to redefining functions on sets of measure zero such an approach is provided by the notion of a weak derivative with the help of weak derivatives we then introduce the class of sobolev spaces which provides the lp analogues of the classical spaces of continuously differentiable functions if f ck d then for all test functions c c d and multi indices nd with 6 k we have the integration by parts formula d f x x dx 1 d g x x dx 11 1 where g f using a smooth partition of unity proposition 11 2 the proof of this identity can be reduced to the situation where the support of is contained in an open 11 1 sobolev spaces 351 rectangle contained within d for such the formula follows by separation of variables and integration by parts on intervals in dimension one this motivates the following definition definition 11 3 weak derivatives let f l 1 loc d a function g l 1 loc d is said to be a weak derivative of order nd of f if for all c c d we have d f x x dx 1 d g x x dx 11 2 a function f l 1 loc d is said to be weakly differentiable of order k if it has weak derivatives f l 1 loc d for all multi indices satisfying 6 k remark 11 4 the definition of a weak derivative of order can equivalently be stated by using functions ckc d for any integer k to see this suppose that g l 1 loc d is a weak derivative of order for the function f l 1 loc d we wish to prove that the integration by parts formula 11 1 holds for functions ckc d to this end we claim that there exist functions n c c d such that n and n uniformly once this has been shown 11 2 follows from d f x x dx lim n d f x n x dx 1 lim n d g x n x dx 1 d g x x dx to prove the claim let c c rd be supported in the unit ball b 0 1 ofrd and satisfy rd dx 1 for n 1 let n x nd nx we extend identically zero outside d and define for y d n y n y rd n y x x dx since n is supported in b 0 1 n for sufficiently large n the functions n are compactly supported in d they are also smooth and hence belong to c c d by proposition 11 1 and the desired convergence properties follow by elementary calculus arguments the following proposition implies that weak derivatives if they exist are necessarily uniquely defined up to a null set this allows us to speak of the weak derivative of order of a function f and denote it by f the proposition could be proved along the lines of lemma 4 59 but it will be instructive to present a proof based on mollification in what follows we write u b d to express that the closure of u is compact and contained in d 352 boundary value problems proposition 11 5 if a function g l 1 loc d satisfies d g x x dx 0 for all c c d then g 0 almost everywhere on d proof let b be any open ball such that bb d and let c c d satisfy 1 on b pick a mollifier c c rd satisfying rd dx 1 for y r d set y x y x where x d 1 x for x rd extending and g identically zero outside d and noting that y c c d the assumption implies that for all y rd we have g y rd y x x g x dx d y x x g x dx 0 by proposition 2 34 we have g g in l 1 rd as 0 passing to an almost everywhere convergent subsequence it follows that g 0 almost everywhere on rd and therefore g 0 almost everywhere on b since this is true for every open ball bbd the result follows the following simple observation will be used repeatedly without further comment lemma 11 6 if f l 1 loc d and n d is a multi index then 1 if f has a weak derivative of order and d is a nonempty open subset of d then f d has a weak derivative of order given by f d f d 2 if f has a weak derivative g of order and g has weak derivative h of order then f has a weak derivative of order given by h that is f f proof 1 we consider only test functions c c d in 11 2 extending them identically 0 to test functions defined on all of d we obtain d f x x dx d f x x dx 1 d g x x dx 1 d g x x dx 2 for all c c d we have d f x x dx 1 d g x x dx and d g x x dx 1 d h x x dx 11 1 sobolev spaces 353 and the result follows by applying the first identity with example 11 7 the classical integration by parts formula 11 1 says that functions in ck d are weakly differentiable of order k with weak derivatives given by their classical derivatives example 11 8 the function f x x has a weak derivative on r given by sign x 1 x 0 1 x 0 this follows from x x dx 0 x x dx 0 x x dx 0 x dx 0 x dx sign x x dx a far reaching generalisation of this example is given in theorem 11 23 example 11 9 we claim that the function f x sign x has no weak derivative on r suppose for a contradiction that g l 1 loc r is a weak derivative of f the restrictions of g to r and r are weak derivatives of the corresponding restrictions of f but these restrictions being constant functions have classical derivatives both equal to 0 since classical derivatives are weak derivatives it follows that g 0 on both r and r almost everywhere and therefore g 0 on r almost everywhere we then arrive at the contradiction that for all test functions c c r 0 g x x sign x x dx 0 x dx 0 x dx 0 0 0 0 2 0 this proves the claim we have the following version of proposition 11 1 in its statement we think of f as being defined on rd by zero extension proposition 11 10 let f l 1 loc d have a weak derivative of order on d suppose that c c rd has support in b 0 r for some r 0 and let the open set u bd satisfy d u d r then the function f has weak and classical derivatives of order on u and both are given by f g f g f g 11 3 proof proposition 11 1 shows that f ck rd and f f with all derivatives classical 354 boundary value problems for all c c u we have using fubini s theorem twice u f x x dx rd f x x dx rd rd y f x y dy x dx rd y rd f x y x dx dy b 0 r y d f x y x dx dy 1 b 0 r y d x f x y x dx dy 1 rd y rd x f x y x dxdy rd x rd y y f x y dy dx rd f x x dx u f x x dx here we used subscripts x and y to express the variable with respect to which the deriva tives are taken the identity is justified by the assumptions that is supported in u is supported in b 0 r and d u d r and therefore y cc d for all y b 0 r this proves that f has a weak derivative of order on u given by 11 3 in the proof of the next proposition we will use the fact that for all 1 6 p 6 the operator f 7 f is closed as a linear operator in lp d with domain d f lp d f has a weak derivative of order in lp d this domain of course depends on p but we suppress this from the notation to prove that is a closed operator suppose that fn f in lp d with fn d for all n and fn g in lp d we must prove that f d and f g for all c c d we have d fn dx 1 d fn dx passing to the limit n in this formula which is possible by ho lder s inequality 11 1 sobolev spaces 355 thanks to the fact that test functions belong to lq d with 1 p 1 q 1 we obtain d f dx 1 d g dx this means that the function g lp d is a weak derivative of f of order by lploc d we denote the space of measurable functions whose restrictions to all sets u b d belong to lp u identifying functions that are equal almost everywhere on d proposition 11 11 let 1 6 p a function f lploc d admits a weak derivative of order if and only if there exist a sequence of functions fn c c d and a function g lploc d such that for all open sets u b d we have i fn f in lp u ii fn g in lp u in this situation we have f g proof if let u b d since is closed as an operator in lp u i and ii imply that f d and f g if u 1 b d and u 2 b d are open sets with nonempty intersection the resulting weak derivatives g 1 lp u 1 and g 2 lp u 2 agree on u 1 u 2 by proposition 11 5 hence by piecing together these weak derivatives we obtain a well defined function g lploc d since every test function is supported in one of the sets u under consideration g is seen to be a weak derivative of order for f only if for r 0 let dr x d d x d r for every 0 choose cc rd such that 0 6 6 1 pointwise 1 on d 2 and 0 on d let cc rd have support in b 0 1 and satisfy rd dx 1 and define d 1 x for n 1 define fn 1 n f 1 n where we think of f as a function on rd by zero extension then fn c c d and by proposition 11 10 and the classical product rule fn 1 n f 1 n 06 6 6 0 1 n f 1 n we will prove that the functions fn have the required properties with g f given an open set u bd let n 1 be so large that u d 2 n for all n n we have 1 n 1 on u and 1 u x f 1 n x 1 u x rd f x y 1 n y dy 1 u x rd 1 u b 0 1 n x y f x y 1 n y dy 1 u x 1 u b 0 1 n f 1 n x x d 356 boundary value problems with u b 0 1 n b d since 1 u b 0 1 n f lp d by proposition 2 34 we obtain 1 u fn 1 u 1 n f 1 n 1 u 1 u b 0 1 n f 1 n 1 u 1 u b 0 1 n f 1 u f as n with convergence in lp d also for all n n we have f 1 n f 1 n on u as well as 1 n 0 on u for all 06 6 with 6 0 therefore by the same reasoning 1 u fn 1 u 1 u b 0 1 n f 1 n 1 u f as n with convergence in lp d as an application of this proposition we prove the following result on existence of lower order weak derivatives theorem 11 12 existence of lower order weak derivatives if a function f l 1 loc d admits a weak derivative f for some nd then it admits weak derivatives f for all nd satisfying 0 6 6 if both f and f belong to lp d then so do the weak derivatives f for notational simplicity we give the proof only in dimension d 1 the argument carries over without difficulty to higher dimensions the crucial step is contained in the next lemma lemma 11 13 for all k 1 there is a constant ck 0 such that for all f c 2 c r and 16 p we have k 1 f p 6 ck f p k f p proof let c c r satisfy 0 1 and 0 0 0 combining the identity d dt t f x te 1 t f x te 1 t f x te 1 which follows from ddt f x te 1 f x te 1 with the identity d dt t f x te 1 t 2 f x te 1 t f x te 1 which follows from ddt f x te 1 2 f x te 1 we arrive at d dt t f x te 1 t 2 f x te 1 d dt t f x te 1 t f x te 1 upon integrating and using that c c r and 0 1 f x 0 t 2 f x te 1 dt 0 t f x te 1 dt 11 1 sobolev spaces 357 if f c 3 c r we can apply this identity with f replaced by f after an integration by parts we obtain 2 f x 0 t 3 f x te 1 dt 0 t f x te 1 dt 0 t 3 f x te 1 dt 0 3 t f x te 1 dt continuing inductively for f ckc r with k 2 we arrive at the identity k 1 f x 0 t k f x te 1 dt 1 k 0 k t f x te 1 dt taking lp norms and moving norms inside the integral using proposition 1 44 we ob tain k 1 f p 6 0 t k t f te 1 p k f te 1 p 6 l k f p k f p where l is the length of an interval containing the compact support of proof of theorem 11 12 again we limit ourselves to dimension d 1 for notational convenience and set k the cases k 0 1 being trivial we assume that k 2 let f l 1 loc d have weak derivative k f it suffices to prove that f has a weak derivative k 1 f in l 1 loc d for once we know that lower order weak derivative are obtained by applying this result several times let fn n 1 be a sequence in c c d as stated in proposition 11 11 that is for all open sets u b d we have i fn f in l 1 u ii k fn g in l 1 u by the lemma for all 16 p we have k 1 fn k 1 fm 1 6 ck fn fm 1 k fn k fm p since the right hand side tends to 0 as m n by completeness there exists a function gu l 1 u such that limn k 1 fn g in l 1 u as in the proof of proposition 11 11 these functions may be glued together to a well defined function g l 1 loc d and this function is easily checked to be a weak derivative of order k 1 of f if f and k f belong to lp d and fn n 1 is a sequence in c c d such that i and ii hold with l 1 u replaced by lp u then by the estimate of the lemma the functions gu belong to lp u with norm gu lp u 6 ck f lp u 6 f lp d this implies that also g lp d 6 ck f lp d as an application we prove the following product rule 358 boundary value problems proposition 11 14 product rule if f l 1 loc d admits a weak derivative of order then so does pointwise product f for every c d and we have the leibniz formula f g 06 6 f g the lower order weak derivatives f exists thanks to theorem 11 12 in most appli cations however the function f belongs to suitable sobolev spaces and the existence of all weak derivatives up to a certain order is assumed the proposition admits variations in terms of the assumptions on f and see for instance problem 11 12 proof we only need to prove this for multi indices of order one since the general case then follows by an induction argument for 16 j 6 d since for all c c d we have c c d the classical product rule for gives d x j x j x x f x dx d x x j f x dx after rearranging this says that the weak derivative j f exists and is given by j f j f for the proof of the next proposition we need a simple lemma on extensions lemma 11 15 let f l 1 loc d be supported in an open set u b d and let d be an open set containing d if f admits a weak derivative f on d then the zero extension f of f to d admits a weak derivative f on d given by the zero extension of f proof fix an arbitrary test function c d with support in d and such that 1 on u for all c c d the classical derivatives and agree on u and therefore d f dx d f dx 1 d f dx 1 d f dx since c c d the gradient of a weakly differentiable function f is the function f l 1 loc d k d defined by f 1 f d f as a linear operator from lp d into lp d kd with domain w 1 p d the weak gra dient is closed this is proved in the same way as we did for weak derivatives here lp d kd denotes the banach space of all functions g d kd with measurable com ponent functions such that x 7 g x dj 1 g j x 2 1 2 belongs to lp d identifying functions that are equal almost everywhere the proof that g lp d kd g lp d 11 1 sobolev spaces 359 defines a norm which turns lp d kd into a banach space is the same as in the scalar valued case see problem 2 27 for the more general case of vector valued lp spaces an open subset u of rd is said to be pathwise connected if any two points x y u can be joined by a continuous curve in u that is there exists a continuous mapping 0 1 u such that 0 x and 1 y proposition 11 16 let f l 1 loc d be weakly differentiable if f 0 almost every where on an open connected subset u of d then f is almost everywhere equal to a constant on u proof let b be an open ball whose closure is contained in u and choose a test function c c d such that 1 on b by proposition 11 14 f is weakly differentiable on d and f f f in particular f 0 on b extending f and identically zero to all of rd by lemma 11 15 the function f is weakly differentiable as a function on rd with a weak gradient in l 1 loc r d that equals the zero extension of the weak gradient of f on d by slight abuse of notation both will be denoted by f pick mollifier c c rd satisfying rd dx 1 and set x d 1 x x rd by proposition 11 10 we have f c rd and f f on rd in particular f 0 on b since the function f is c classical cal culus arguments imply that this function is constant on b taking the l 1 rd limit as 0 using proposition 2 34 and passing to an almost everywhere convergent subse quence it is seen that f is constant almost everywhere on b indeed this shows that f is the almost everywhere limit of a sequence of functions each of which is constant on b since 1 on b it follows that f is constant almost everywhere on b this being true for every open ball b contained in u this gives the result 11 1 b the sobolev spaces w k p d by ho lder s inequality every f lp d with 16 p 6 belongs to l 1 loc d this sug gests the following definition definition 11 17 sobolev spaces for k n and 16 p 6 the sobolev space w k p d is the space of all f lp d whose weak derivatives of all orders 6 k exist and belong to lp d endowed with the norm f w k p d 6 k f lp d 360 boundary value problems w k p d is a banach space indeed if fn n 1 is a cauchy sequence in w k p d then for all 6 k the sequence of weak derivatives fn n 1 is a cauchy sequence in lp d and hence convergent to some f set f f 0 using ho lder s inequality as in corollary 2 25 we may pass to the limit n in the identity d fn x x dx 1 d f n x x dx c c d it follows that f has weak derivatives of all orders 6 k given by f f having observed this it is clear that f w k p d and fn f in w k p d for 16 p the linear operators are densely defined this follows by noting that functions in c c d belong to d and recalling from proposition 2 29 that c c d is dense in lp d this prompts the question which functions in w k p d can be approxi mated in the norm of this space by test functions a first result into this direction is the following lemma proposition 11 18 local approximation by test functions for all f w 1 p d with 16 p there exists a sequence of test functions fn c c d such that for every open set u b d we have lim n fn u f u in w 1 p u proof this follows from proposition 11 11 noting that the functions fn constructed in the proof will handle the lp convergence of all weak derivatives simultaneously proposition 11 19 chain rule let k k be a c 1 function with bounded deriva tive and satisfying 0 0 and let 1 6 p 6 for all f w 1 p d we have f w 1 p d and j f f j f j 1 d proof the condition 0 0 and the boundedness of imply that t 6 m t with m supt k t and therefore f lp d implies that f lp d the bound edness of implies that f is bounded and therefore j f lp d implies that f j f lp d to conclude the proof it therefore suffices to check that f j f is a weak derivative in the jth direction of f fix c c d and let u bd be an open set containing the compact support of by proposition 11 18 we can find functions fn c c d such that fn u f u in w 1 p u since fn f 6 m fn f and fn f in lp u ho lder s inequality and the classical chain rule imply that d f j dx lim n d fn j dx lim n d fn j fn dx upon passing to a subsequence if necessary by corollary 2 21 we may assume that fn f and j fn j f almost everywhere on d and that there exists a function 06 g lp u 11 1 sobolev spaces 361 such that j fn 6 g almost everywhere on u for every n then fn j fn 6 m g almost everywhere on u for every n and since g l 1 u we may use dominated convergence to obtain lim n d fn j fn dx d f j f dx noting that on both sides the integrands vanish outside u this completes the proof proposition 11 20 substitution rule let d and d be nonempty open subsets of rd and suppose that d d is a ck diffeomorphism with k 1 let 1 6 p a function f l 1 loc d belongs to if and only if f 1 l 1 loc d is weakly differentiable denoting the space variables of d and d by x and y respectively in that case we have f xi d j 1 j xi f 1 y j proof for smooth functions f this is the substitution rule from calculus and the gen eral case follows by local approximation with smooth functions 11 1 c the sobolev spaces w 1 p 0 d we now introduce a class of spaces which play an important role in the theory of partial differential equations where they provide the lp setting for studying boundary value problems subject to dirichlet boundary conditions definition 11 21 the spaces w 1 p 0 d for 1 6 p we define w 1 p 0 d to be the closure of c c d in w 1 p d the following result gives a simple sufficient condition for membership of w 1 p 0 d proposition 11 22 let u b d be open and let 1 6 p if f w 1 p d vanishes outside u then f w 1 p 0 d proof since u is compact and does not intersect d we have d u d 0 fix a function c c rd compactly supported in the ball b 0 1 and satisfying rd dx 1 and set x d 1 x for 0 each has compact support in b 0 extending f identically zero outside d the condition 0 implies that the convolution f is compactly supported in d as 0 by proposition 2 34 we have f f in lp rd and hence in lp d 11 4 by proposition 11 10 the weak derivatives of f are given by j f j f j 1 d 362 boundary value problems these weak derivatives belong to lp d so f restricts to an element of w 1 p d by proposition 2 34 j f j f j f in lp rd and hence in lp d 11 5 by 11 4 and 11 5 we have f f in w 1 p d finally we observe that f is c by proposition 11 1 and compactly supported since both and f have compact support it is trivial that if f w 1 p d then re f im f w 1 p d and similarly if f w 1 p 0 d then re f im f w 1 p 0 d the next proposition asserts that the positive part f of a real valued function f in w 1 p d belongs to w 1 p d and provides an explicit expression for its weak derivatives moreover if f w 1 p 0 d then f w 1 p 0 d the analogous results then also hold for the negative part f f f and the absolute value f f f theorem 11 23 positive parts let 16 p then 1 for all real valued functions f w 1 p d we have f w 1 p d and j f 1 f 0 j f j 1 d and if f w 1 p 0 d then f w 1 p 0 d 2 the mapping f 7 f is continuous with respect to the norm of w 1 p d proof the idea of the proof is to approximate the function t 7 t max t 0 with c 1 functions n in such a way that for all t r we have i 06 n t t ii 06 n t 1 0 t for instance the choice n t t 2 1 n 2 1 2 1 n for t 0 and n t 0 for t 6 0 will do see figure 11 1 step 1 let f be a real valued function in w 1 p d by proposition 11 19 we have n f w 1 p d and for test functions c c d d n f x j x dx d n f x j f x x dx by i ii and dominated convergence we obtain d f x j x dx d 1 f 0 x j f x x dx this proves the first part of 1 step 2 to prove 2 let fn f in w 1 p d with all functions real valued we must show that f n f in w 1 p d it is clear that f n f in lp d so it remains to 11 1 sobolev spaces 363 t f t t 1 t t 2 1 1 2 1 2 t t 2 14 1 2 12 figure 11 1 the functions n t t 2 1 n 2 1 2 1 n show that j f n j f for all 1 6 j 6 d by step 1 this is equivalent to showing that 1 fn 0 j fn 1 f 0 j f in l p d for all 16 j 6 d by corollary 2 21 we can choose a subsequence such that fnk f and fnk 6 g almost everywhere where 06 g lp d and j fnk j f and j fnk 6 h j almost ev erywhere where 06 h j lp d for all 16 j 6 d then 1 fnk 0 1 f 0 almost ev erywhere so dominated convergence implies that 1 fnk 0 j fnk 1 f 0 j f in l p d for all 16 j 6 d applying the above argument to subsequences of fn n 1 we thus find that every subsequence fnm m 1 of fn n 1 contains a further subsequence fnmk k 1 such that f nmk f in w 1 p d this implies that f n f in w 1 p d step 3 it remains to prove the second part of 1 suppose that f w 1 p 0 d is real valued we must prove that f w 1 p 0 d choose functions fn c c d such that fn f in w 1 p d then f n f in w 1 p d by step 2 thus it suffices to show that every f n can be approximated by functions in c c d this is accomplished by a mollifier argument fix n 1 since fn is compactly supported in d its support has positive distance n to the boundary of d if c c rd has compact support in b 0 1 and satisfies rd dx 1 then for 0 n the function f n where x d 1 x is smooth by proposition 11 1 has compact support in d and by proposition 2 34 we have f n f n in lp d as 0 likewise by 11 3 applied to f n j f n j f n j f n with convergence in lp d 364 boundary value problems the following proposition connects the space w 1 p 0 d with dirichlet boundary con ditions theorem 11 24 let d be bounded and let 16 p for all f w 1 p d c d the following assertions hold 1 if f d 0 then f w 1 p 0 d 2 if d is c 1 and f w 1 p 0 d then f d 0 proof 1 by considering real and imaginary parts separately we may assume that f is real valued and by theorem 11 23 we may even assume that f is nonnegative since f 1 k f in w 1 p d as k and taking positive parts is continuous in w 1 p d by theorem 11 23 we see that fk f 1 k f f in w 1 p d as k hence to prove that f w 1 p 0 d it suffices to prove that fk w 1 p 0 d for all n 1 by continuity each fk vanishes in a neighbourhood of the compact set d then proposition 11 22 shows that fk can be approximated in w 1 p d by functions fk n c c d 2 by the definition of a c 1 boundary and a partition of unity argument it suffices to prove that for all f w 1 p 0 r d c rd we have f rd 0 here rd x r d xd 0 let n f in w 1 p 0 r d with n cc rd for all n 1 for all x x xd rd rd 1 0 n x xd 6 xd 0 d x y dy integrating over x 1 and averaging over 0 xd with 0 1 we obtain 1 0 x 1 n x xd dx dxd 6 1 0 x 1 xd 0 d n x y dydx dxd xd 0 x 1 1 xd d n x y dxd dx dy 6 0 x 1 d n x y dx dy letting n we obtain 1 0 x 1 f x xd dx dxd 6 0 x 1 d f x y dx dy letting 0 we obtain x 1 f x xd dx 0 11 1 sobolev spaces 365 this implies f x 0 0 for almost all x rd 1 and since f is continuous on rd f x 0 0 for all x rd 1 theorem 11 25 for all 16 p we have w 1 p 0 r d w 1 p rd proof clearly w 1 p 0 r d w 1 p rd to prove the reverse inclusion we must show that every f w 1 p rd can be approximated in w 1 p rd by functions in c c rd let n c c rd satisfy 06 n 6 1 pointwise on rd n 1 for all 6 n and n 6 1 on rd proposition 11 14 implies that the functions n f belong to w 1 p rd and by dominated convergence we have n f f and j n f n j f f j n j f in lp rd as n using that j n 0 and n 1 pointwise on rd with uniform bounds j n 6 1 and n 6 1 to justify dominated convergence it follows that n f f in w 1 p rd accordingly it suffices to prove that every compactly supported function in w 1 p rd can be approximated in the norm of w 1 p rd by test functions this was accom plished in proposition 11 22 with the same method of proof one obtain the following density result theorem 11 26 for all k n and 16 p the space c c rd is dense in w k p rd 11 1 d extension operators let k n be an integer that is kept fixed throughout this section we say that d has a ck boundary if for every x 0 d there exist open sets u v rd with x 0 u and a ck diffeomorphism u v with the following properties i d u x v xd 0 ii d u x v xd 0 iii there exists a constant c 0 such that c 1 6 det d x 6 c x u where d is the total derivative of see figure 11 2 in this situation by proposition 11 20 applied inductively a function u l 1 loc u belongs to w k p u if and only if the function v u 1 l 1 loc v belongs to w k p v and c 1 v w k p v 6 u w k p u 6 c v w k p v 11 6 366 boundary value problems d u d u v d u figure 11 2 the definition of a ck boundary theorem 11 27 density of c d in w k p d if d is bounded with ck boundary then for all 16 p the space c d is dense in w k p d we actually prove the stronger result that for any f w k p d there exists a sequence of functions fn c rd whose restrictions to d satisfy limn fn f w k p d 0 proof the proof proceeds in three steps the first step deals with the case where d is a bounded open subset of rd x rd xd 0 the second step commonly referred to as straightening the boundary uses the definition of a ck domain to carry over the result of step 1 to the open sets u in the definition the third step patches together the local results of step 2 by means of a partition of unity argument step 1 in this first step we prove that if f w k p rd then there exists a sequence of functions fn c c rd whose restrictions to rd satisfy fn f in w k p rd as n let c c rd satisfy 1 b 0 1 6 6 1 b 0 2 and let m sup 6 k then for all n 1 the function n x x n satisfies 1 b 0 n 6 n 6 1 b 0 2 n and n 6 n 6 m by the product rule and dominated convergence this implies that n f f in w k p rd it follows that we may assume that f has bounded support for t 0 define the functions ft x f x ted x rd where ed is the dth unit vector of rd clearly we have ft w k p rd with weak deriva tives ft x f x ted x rd 11 7 the lp continuity of translations proposition 2 32 therefore implies that ft f in 11 1 sobolev spaces 367 w k p rd as a result it suffices to approximate each ft in w k p rd with functions in c c rd in the remainder of this step we fix t 0 let h w k p rd be a function whose restriction to x rd xd t agrees with the restriction of f on that set such a function may be found by multiplying f with a test function c c rd satisfying 1 on supp f x rd xd t this results in a function with the desired properties by proposition 11 14 and lemma 11 15 letting ht x h x ted for x rd it follows that for almost all x rd we have ht x h x ted f x ted ft x choose a mollifier c c rd satisfying rd dx 1 and let x d 1 x for 0 and x rd by proposition 11 10 the functions ht ht belong to c rd and for all multi indices 6 k we have ht ht 11 8 by 11 7 11 8 and proposition 2 34 for 0 we then obtain ht ft lp rd ht ht lp rd 0 this gives de desired approximation step 2 let x 0 d be fixed choose open sets u v rd with x 0 u and a ck diffeomorphism u v with the properties i iii in the definition of a ck domain in this step we assume that f w k p d has its support in an open set u bu let g v rd r be defined by g f 1 then g w k p v rd by 11 6 since u bv the same argument as in the proof of lemma 11 15 shows that the zero extension g of g to all of rd belongs to w k p rd by step 1 we may choose functions gn c c rd such that gn g in w k p rd fix a test function c c v such that 1 on u then also gn g in w k p rd and on v rd we have g g replacing gn by gn if necessary we may therefore assume without loss of generality that gn c c v where v b v contains the support of let fn gn then fn c c u it follows that fn c rd by zero extension and fn f in w k p d by 11 6 step 3 now let f w k p d be arbitrary since d is compact as in step 1 we can find open sets um and vm and ck diffeomorphisms m um vm m 1 m as well as open sets u m bum m 1 m in such a way that d m m 1 u m by adding one open set u 0 bd we may arrange that d m m 1 u m let m m m 0 be a smooth partition of unity for d subordinate to this cover that is m c c u m for m 0 1 m and m m 0 m 1 on d 06 m 6 1 m 0 1 m 368 boundary value problems let f m m f by lemma 11 15 the zero extension of f 0 belongs to w k p rd and therefore by theorem 11 25 and we can find f 0 n c rd such that f 0 n f 0 in w k p d for 16 m 6 m the function f m is supported in u m and by step 2 we can find f m n c rd such that f m n f m in w k p d finally let fn m m 0 f m n then fn c rd and as n fn f w k p d 6 m m 0 f m n f m w k p d 0 the restrictions of fn to d have the required properties the boundary of a ck domain is locally the graph of a ck function in d 1 hor izontal coordinates and in fact this could be taken as an alternative definition of a ck domain by translating f in the remaining vertical direction the use of the ck diffeomorphism and the substitution rule can be avoided and all constructions can be carried out directly in u this is the reason we have been rather brief in explaining the fine details of the substitution rule and its use in the present proof nevertheless we prefer the approach presented here as it brings out clearly the idea that constructions involving the boundary can locally be reduced to hyperplanes x rd xd 0 using ck diffeomorphisms the advantage of this becomes even more clear in the proof of the next theorem theorem 11 28 extension operator let d be bounded and have a ck boundary then there exists a linear mapping e l 1 loc d l 1 loc r d with the following properties i for all f l 1 loc d we have e f d f ii for all 16 p and f w k p d we have e f w k p rd iii for all 16 p there exists a constant c 0 such that for all 0 1 k e f w p rd 6 c f w p d f w p rd proof we proceed in three steps step 1 let the integer 06 6 k be fixed for f l 1 loc r d and multi indices 6 define e f l 1 loc r d by e f x f x x rd 1 j 1 j d c j f x 1 xd 1 jxd x 6 rd where the scalars c j are chosen in such a way that 1 j 1 j kc j 1 k 0 1 11 1 sobolev spaces 369 by the theory of vandermonde determinants this system of 1 equations is uniquely solvable for c 1 c 1 it is easily verified that if f c rd then e 0 f c rd due to the choice of the coefficients c j and e 0 f e f thus e 0 f p lp rd rd f p dx rd 1 j 1 j d c j f x 1 xd 1 jxd p dx 6 cp p f p lp rd this gives the bound e 0 f w p rd 6 ck p f w p rd by theorem 11 27 this bound extends to functions f w p rd step 2 now let d be bounded and open by theorem 11 27 it suffices to prove the existence of a linear mapping e l 1 loc d l 1 loc r d such that for all f l 1 loc d we have e f d f and for all 16 p 0 1 k and f c c d we have e f w p rd 6 c f w p d with a constant c 0 depending only on p and d let f l 1 loc d and 0 6 6 k be given using the notation of the proof of theorem 11 27 set fm m f m 0 1 m let h 0 be the zero extension of f 0 to rd and for m 1 m let gm denote the zero extension to rd of the function fm 1 m l 1 vm rd let e 0 be the extension operator of step 1 and define e f m m 0 hm where for m 1 m we set hm e 0 gm m on um 0 on um then e f f on d if we now assume that f c d and fix 16 p then f 0 0 f c d and h 0 w p rd 6 c p d f w p d for m 1 m we have hm c um with support in u m therefore hm c rd and using 11 6 twice hm w p d hm w p um 6 c 1 e 0 gm w p vm 6 c 1 e 0 gm w p rd 6 c 2 gm w p rd c 2 gm w p vm rd 6 c 3 fm w p um d 6 c 4 f w p d it follows that e f w p rd 6 m m 0 hm w p rd 6 c 5 f w p d with all constants only depending on p d 370 boundary value problems 11 1 e bessel potential spaces a function f lp d with 1 6 p 6 is said to admit a weak lp laplacian if there exists a function g lp d such that for all test functions c c d we have d f dx d g dx this defines a linear operator p d in lp d the weak lp laplacian on d with domain d p d f lp d f admits a weak lp laplacian on d by the argument of example 10 16 this operator is closed in what follows we will denote weak laplacians simply by among other things as an application of the plancherel theorem the next theorem establishes that the domain of the weak laplacian in l 2 rd equals w 2 2 rd theorem 11 29 fourier analytic characterisation weak laplacian let k 0 be a nonnegative integer for a function f l 2 rd the following assertions are equivalent 1 f belongs to w k 2 rd 2 7 1 2 k 2 f belongs to l 2 rd moreover f 7 7 1 2 k 2 f 2 defines an equivalent norm on w k 2 rd for k 2 1 and 2 are equivalent to 3 f admits a weak laplacian in l 2 rd moreover f 7 f 2 f 2 defines an equivalent norm on w 2 2 rd definition 11 30 the bessel potential spaces hs rd for real numbers s 0 the subspace of all f l 2 rd such that 7 1 2 s 2 f belongs to l 2 rd is denoted by hs rd and is called the bessel potential space with smoothness exponent s with respect to the norm f hs rd 7 1 2 s 2 f l 2 rd 11 9 this space is a hilbert space the easy verification is left as an exercise for noninteger values of s the spaces hs rd play an important role in the regularity theory for partial differential equations the equivalence of 1 and 2 of theorem 11 29 asserts 11 1 sobolev spaces 371 theorem 11 31 w k 2 rd hk rd if k 0 is a nonnegative integer then w k 2 rd hk rd with equivalence of norms the proof of theorem 11 29 relies on the following lemma where for vectors rd and multi indices nd we use the short hand notation 11 d d lemma 11 32 a function f l 2 rd admits a weak derivative f belonging to l 2 rd if and only if 7 f belongs to l 2 rd and in that case we have f i f for almost all rd proof if for test functions c c rd and rd we have 1 2 d 2 rd exp ix x dx i 2 d 2 rd exp ix x dx i 11 10 also by differentiating under the integral we see that is smooth and i x x 11 11 suppose now that 7 f belongs to l 2 rd and denote its inverse fourier plancherel transform by g using the plancherel isometry and 11 10 for real valued c c rd we obtain 1 rd f x x dx 1 f 1 f i rd f d i rd g x x dx considering real and imaginary parts separately the identity extends to complex valued c c rd this shows that f has weak derivative f i g in l 2 rd only if fix a test function c c rd using proposition 5 29 and 11 11 we obtain rd f d rd f d 1 rd f d i rd f x x d i rd f d by proposition 11 5 this implies f i f for almost all rd since by 372 boundary value problems assumption f l 2 rd the plancherel theorem implies that f l 2 rd this shows that 7 f belongs to l 2 rd proof of theorem 11 29 we begin with the proof of the equivalence 1 2 for gen eral integers k 0 the heart of the matter is contained in the two sided estimate 1 2 k 2 hd k 6 k 2 1 2 11 12 which follows from the binomial identity here the notation a hd k b is short hand for the existence of constants cd k c d k 0 both depending only on d and k such that a 6 cd kb and b 6 c d ka 1 2 first let f w k 2 rd by 11 12 lemma 11 32 and plancherel s theorem rd 1 2 k f 2 d hd k 6 k rd f 2 d 6 k rd f 2 d 6 k rd f x 2 dxhd k f 2 w k 2 rd this shows that 7 1 2 k 2 f belongs to l 2 rd and that its l 2 norm is equiv alent to the norm of f in w k 2 rd 2 1 suppose that f l 2 rd is a function with the property that 7 1 2 k 2 f belongs to l 2 rd then 7 f belongs to l 2 rd for all multi indices nd satisfying 6 k and therefore f has weak derivatives f for all 6 k by lemma 11 32 this shows that f w k 2 rd for k 2 1 obviously implies 3 the converse follows from lemma 11 32 the equivalence of norms again follows from the plancherel theorem and 11 12 11 2 the poisson problem u f the results developed above are now applied to study the poisson problem 11 2 a dirichlet boundary conditions we recall from theorem 11 31 that hk rd w k 2 rd with equivalent norms for nonempty open subsets d of rd it is customary to define hk d w k 2 d h 10 d w 1 2 0 d 11 2 the poisson problem u f 373 where w 1 20 d is the closure of c c d in w 1 2 d we endow hk d with the norm f 2 hk d 6 k f 22 where the summation extends over all multi indices nd of order at most k this norm is associated with the inner product f g hk d 6 k f g 2 and it turns hk d into a hilbert space as a closed subspace of h 1 d the space h 10 d is a hilbert space as well let us now take a look at the poisson problem with dirichlet boundary conditions u f on d u d 0 11 13 where f l 2 d is a given function and di 1 2 i is the laplace operator multiply ing both sides of the equation 11 13 with a test function c c d and integrating we obtain the following integrated version of the problem d u dx d f dx which after a formal integration by parts which can be rigorously justified if u c 2 d can be rewritten as d u dx d f dx 11 14 this formal derivation justifies the following definition definition 11 33 weak solutions a function u h 10 d is called a weak solution of the poisson problem with dirichlet boundary conditions 11 13 if d u dx d f dx c c d the notion of weak solution makes sense for inhomogeneities in f l 2 d in the special case f c d a classical solution may be defined as a function u c 2 d c d satisfying the equations of the poisson problem u f on d and u d 0 pointwise classical solutions may not exist however even when f cc d see prob lem 11 26 the advantage of working with weak solutions is that integrated equation in 11 14 involves only the first derivative and both integrals in 11 14 can be inter preted as inner products this makes the problem of finding weak solutions amenable to hilbert space methods the requirement that u be in h 10 d implements the boundary condition u d 0 as evidenced by theorem 11 24 374 boundary value problems having admitted membership of h 10 d as a valid way of implementing dirichlet boundary conditions one may still be tempted to look for solutions in h 10 d h 2 d it can be shown that this works in the sense that a unique weak solution in the sense of definition 11 33 belonging to this space exists if d is assumed to be bounded with c 2 boundary see remark 11 38 without additional assumptions on d however such solutions need not exist before attacking the problem 11 13 using hilbert space methods we pause to em phasise that in some special cases this problem is simple enough to admit a direct ele mentary solution for instance for d 1 and d a b we may integrate the equation twice and determine the two integration constants by substituting the boundary condi tions which take the form u a u b 0 after some computations one arrives at u x b a k x y f y dy x a b where k x y 1 b a b y x a x 6 y b x y a y 6 x is the so called green function for the poisson problem on a b with dirichlet bound ary conditions the reader may check see problem 11 25 that the function u thus defined belongs to h 10 a b and is indeed a weak solution of 11 13 it is difficult however to extend this elementary method to higher dimensions in contrast the hilbert space method adopted here works in arbitrary dimensions our main tool is the following inequality which is of interest in its own right theorem 11 34 poincare inequality let d be bounded and let 1 6 p there exists a constant c cp d 0 such that the following estimate holds f lp d 6 c f lp d kd f w 1 p 0 d as a consequence f w 1 p 0 d f lp d kd defines an equivalent norm on w 1 p 0 d proof first assume that f c c d by extending f identically zero outside d we may view f as a function in c c r d choose r 0 so large that d r r r d for 1 6 p and x 1 r r we have using ho lder s inequality and the fact that f r x 2 xd 0 f x 1 x 2 xd p x 1 r f x 1 t x 2 xd dt p 6 x 1 r p q x 1 r f x 1 t x 2 xd p dt 11 2 the poisson problem u f 375 where 1 p 1 q 1 integrating both side we obtain f pp r f x 1 x 2 xd p dx 6 f x 1 p p r x 1 r p q dx 2 r d 1 f x 1 p p r r x 1 r p q dx 1 1 p 2 r p d 1 f x 1 p p since trivially f x 1 p 6 f p this gives the desired estimate with constant cp d p 1 p 2 r 1 d 1 p since c c d is dense in w 1 p 0 d the estimate for a general f w 1 p 0 d follows by approximation finally the equivalence of the norms follows from f p 6 f p f p 6 cp d 1 f p we now take p 2 and recall the notation h 1 d w 1 2 d and h 10 d w 1 2 0 d poincare s inequality then states that f h 10 d f 2 f h 1 0 d defines an equivalent norm on h 10 d with respect to this norm h 1 0 d is again a hilbert space this time with respect to the inner product f 1 f 2 h 10 d f 1 f 2 2 theorem 11 35 poisson problem dirichlet boundary conditions if d is bounded then for every f l 2 d the poisson problem 11 13 admits a unique weak solution u h 10 d moreover there exists a constant c 0 independent of f such that u h 10 d 6 c f 2 proof by the cauchy schwarz inequality and poincare s inequality the linear map ping l g 7 d g f dx is bounded from h 1 0 d to k l g 6 g 2 f 2 6 c g 2 f 2 c g h 10 d f 2 therefore l defines a bounded functional on h 10 d hence by the riesz representation theorem there exists a unique u h 10 d such that l g g u h 10 d g h 1 0 d 11 15 and it satisfies u h 10 d l 6 c f 2 writing out the identity 11 15 it takes the form d g udx d g f dx g h 10 d 11 16 376 boundary value problems in particular it holds for all g c c d since c c d is contained in h 10 d replacing g by g and taking conjugates on both sides we see that u is a weak solution of 11 13 if v h 10 d is another weak solution then d u v dx 0 c c d since c c d is dense in h 1 0 d it follows that d u v gdx 0 g h 10 d and applying this to g gives u v g h 10 d 0 for all g h 1 0 d this implies u v 0 in h 10 d we prove next that the weak solution actually belongs to h 10 d h 2 loc d where h 2 loc d is the space of all f l 1 loc d with the property that f u h 2 u for all open sets u b d defining the space l 2 loc d similarly this will follow from the following lemma lemma 11 36 if f h 1 d admits a weak laplacian in l 2 loc d then f h 2 loc d proof let u u be bounded open sets such that u b u b d and let c c u satisfy 1 on u it is routine to check that if we view f as an element of l 2 rd it admits a weak laplacian belonging to l 2 rd given by the leibniz formula f f h d j 1 j g j where g j j f l 2 d and h f l 2 d are the weak directional derivatives and the weak laplacian of f on d respectively we view all terms as functions defined on all of rd by zero extension theorem 11 29 then implies that f h 2 rd since f u f u it follows that f u belongs to h 2 u in particular for all c c u we have d f x x dx 1 d gu x x dx if u 1 and u 2 are bounded open sets whose closures are contained in d the weak derivatives up to order 2 coincide almost everywhere on u 1 u 2 gluing them together gives the result theorem 11 37 let d be bounded the weak solution u of the poisson problem u f with f l 2 d subject to dirichlet boundary conditions belongs to h 10 d h 2 loc d proof the very definition of a weak solution implies that u admits a weak laplacian belonging to l 2 d given by u f the result now follows from the lemma 11 2 the poisson problem u f 377 remark 11 38 if d has a c 2 boundary it can be shown that the weak solution belongs to h 2 loc d the proof of this fact lies beyond the scope of this work the next proposition shows that a function in h 10 d solves the poisson problem with dirichlet boundary conditions if and only if it minimises a certain energy functional theorem 11 39 variational characterisation let d be bounded and let f l 2 d for a function u 0 h 10 d the following assertions are equivalent 1 u 0 is the weak solution of the poisson problem u f on d subject to dirichlet boundary conditions 2 u 0 minimises the energy functional e h 10 d r defined by e u 1 2 d u 2 dx re d u f dx proof we use the notation a u v d u vdx l u d u f dx with this notation for all t r and u 0 u h 10 d we have e u 0 tu e u 0 t re a u u 0 lu 1 2 t 2 a u u 11 17 1 2 suppose that u 0 is a weak solution that is u h 10 d and a u 0 l for all c c d by density this identity extends to arbitrary h 10 d applying the identity with u and taking t 1 in 11 17 for all nonzero u h 10 d we obtain e u 0 u e u 0 1 2 a u u e u 0 11 18 and by poincare s inequality the inequality is in fact strict it follows that u 0 is a min imiser of e in h 10 d 2 1 suppose conversely that u 0 minimises e in h 10 d the identity 11 17 implies that for all u h 10 d the function t 7 e u 0 tu is differentiable in t and 0 d dt t 0 e u 0 tu re a u u 0 lu over the real scalar field this implies that a u u 0 lu 0 over the complex scalar field we apply the preceding identity with u replaced by iu to find that also im a u u 0 lu 0 and again it follows that a u u 0 lu 0 in both cases we conclude that u 0 is a weak solution 378 boundary value problems the existence and uniqueness of a weak solution implies that for each f l 2 d the energy functional e u 1 2 d u 2 dx re d u f dx has a unique minimiser in the above proof uniqueness was reflected by the strictness of the inequality in 11 18 theorem 11 39 is a special case of a more general result on the existence and unique ness of minimisers for suitable nonlinear functionals defined on hilbert spaces see problem 11 31 11 2 b neumann boundary conditions having dealt with dirichlet boundary conditions we shall now take a look at the poisson problem with neumann boundary conditions u f on d u 0 on d 11 19 where u u is the partial derivative in the direction of the outward normal along d and f l 2 d is a given function the treatment of this example in higher dimensions requires some familiarity with standard techniques from partial differential equations as the notion of an outward normal is meaningful only under some regu larity assumptions on the boundary d for the present treatment c 1 regularity of the boundary suffices to motivate the notion of weak solutions we need green s theorem if d is bounded with c 1 boundary then for all u c 2 d and v c 1 d we have d u vdx d v udx d v u ds where ds is the normalised surface measure on d we forget the boundary condi tion for a moment and ask ourselves which information is conveyed by the integrated equation d u dx d f dx 11 20 if it is to hold for all c d and not just for all c c d since that would ignore what happens at the boundary by green s theorem d udx d u ds d f dx 11 21 11 2 the poisson problem u f 379 since we wish to solve u f we substitute this relation into 11 21 and find that d u ds 0 this can only hold for all c d if u 0 on d that is if neumann boundary conditions hold by considering 1 we see that the identity 11 20 can only hold for all c d if f satisfies the compatibility condition d f dx 0 more generally the integral of f against every locally constant function should vanish likewise solutions of 11 20 cannot be unique if u is a solution in whatever weak sense then also u c is a solution for any locally constant function c in order to simplify matters we henceforth assume that d is connected so that the only locally constant functions are the constant functions under this assumption we get rid of inte gration constants by imposing the constraint d udx 0 that is the average of u over d should vanish accordingly we define h 1 av d u h 1 d d udx 0 this discussion leads to the following weak formulation of problem 11 19 definition 11 40 weak solutions let d be bounded and connected a function u h 1 av d is called a weak solution of the poisson problem 11 19 if d u dx d f dx c d our treatment of the poisson problem with dirichlet boundary conditions crucially depended on the poincare inequality for h 10 d the treatment of neumann boundary conditions proceeds analogously the role of h 10 d being taken over by h 1 av d we will prove a version of the poincare inequality for this space in theorem 11 42 its proof depends on the following compactness result theorem 11 41 rellich kondrachov compactness theorem if d is bounded and 16 p then 1 the inclusion mapping from w 1 p 0 d into l p d is compact 380 boundary value problems 2 if d has c 1 boundary the inclusion mapping from w 1 p d into lp d is compact proof we first prove 1 and deduce 2 from by means of the extension theorem 1 we must show that the unit ball of w 1 p 0 d is relatively compact in l p d by extending the elements of w 1 p 0 d identically zero outside d we may view this unit ball as a bounded subset which we denote by b of lp rd and it suffices to prove that this set is relatively compact in lp rd for this purpose we use the fre chet kolmogorov theorem or rather its corollary for bounded domains corollary 2 36 according to this theorem we must check that lim h 0 sup f b h f f p 0 11 22 here h f is the translate of f over h that is h f x f x h to prove this first let f b c c d and extend f to identically zero to all of rd for r 0 let dr x rd d x d r if h 12 r then by ho lder s inequality fubini s theorem and a change of variables rd h f f p dx d 1 2 r f x h f x p dx 6 d 1 2 r 1 0 d dt f x th dt p dx 6 d 1 2 r 1 0 d dt f x th p dt dx 6 h p d 1 2 r 1 0 f x th p dt dx h p 1 0 d 1 2 r f x th p dxdt 6 h p 1 0 dr f y p dydt h p d f y p dy h p f w 10 d 6 h p keeping in mind that f w 10 d 6 1 since f b the above estimate holds for any f b c c d since c c d is dense in w 1 p 0 d this estimate extends to arbitrary f b this proves that if h 12 r then sup f b h f f p 6 h and 11 22 follows 11 2 the poisson problem u f 381 2 let d b d where d rd is some larger bounded domain let c c rd be compactly supported in d and satisfy 1 on d as in theorem 11 28 let ed w 1 p d w 1 p rd be a bounded extension operator let m w 1 p rd w 1 p 0 d be the multiplier given by f 7 f we use proposition 11 22 to see that this operator maps into w 1 p 0 d as claimed let id w 1 p 0 d lp d be the inclusion mapping which is compact by step 1 and let rd d l p d lp d the restriction operator f 7 f d then the inclusion mapping jd w 1 p d lp d factors as jd rd d id m ed and is therefore compact as an application of the rellich kondrachov theorem we have the following variant of poincare s inequality where we define w 1 pav d u w 1 p d d udx 0 theorem 11 42 poincare wirtinger inequality let d be bounded and connected with c 1 boundary let 1 6 p then there exists a constant c cp d such that for all f w 1 pav d the following estimate holds f p 6 c f p in particular f w 1 pav d f p defines an equivalent norm on w 1 p av d proof we argue by contradiction if the theorem were false we could find a sequence fn n 1 in w 1 p av d such that fn p n fn p for n 1 2 by scaling we may assume that fn p 1 so that fn p 6 1 n since fn n 1 is bounded in w 1 p av d we may use the rellich kondrachov theorem to extract a subsequence fnk k 1 of fn n 1 that converges with respect to the norm of lp d to some f lp d also fnk p 6 1 nk 0 as n and therefore the closed ness of as an operator from lp d to lp d kd implies that f d w 1 p d and f 0 in view of d f dx lim k d fnk dx 0 11 23 we even have f w 1 pav d but f 0 implies via proposition 11 16 that f is a constant almost everywhere in view of 11 23 this is only possible if f 0 almost everywhere we thus arrive at the contradiction 0 f p limk fnk p 1 we are now in a position to solve the poisson problem with neumann boundary conditions 382 boundary value problems theorem 11 43 poisson problem neumann boundary conditions let d be bounded and connected with c 1 boundary for every f l 2 d satisfying d f dx 0 the poisson problem 11 19 admits a unique weak solution u h 1 av d moreover there exists a constant c 0 independent of f such that u h 1 av d 6 c f 2 proof the argument follows the proof of theorem 11 35 with minor adjustments by theorem 11 42 g h 1 av d g 2 defines an equivalent norm on h 1 av d this norm arises from the inner product g h h 1 av d g h 2 in the rest of the proof we shall consider h 1 av d with this norm by the cauchy schwarz inequality and the poincare wirtinger inequality the linear mapping l g 7 d g f dx is bounded from h 1 av d to k l g 6 g 2 f 2 6 c g 2 f 2 c g h 1 av d f 2 therefore l defines a bounded functional on h 1 av d hence by the riesz representation theorem there exists a unique u h 1 av d such that l g g u h 1 av d g h 1 av d and it satisfies u h 1 av d l 6 c f 2 writing out this identity it takes the form d g udx d g f dx g h 1 av d 11 24 for an arbitrary g h 1 d we may write g m g m with m d gdx then g m h 1 av d since 11 24 also holds with g replaced by the constant function m it follows that 11 24 holds for all g h 1 d in particular it holds for all g c d since such functions belong to h 1 d taking conjugates on both sides we see that u is a weak solution of 11 19 if v is another weak solution then d u v dx 0 c d since c d is dense in h 1 d by theorem 11 27 u v g h 1 av d 0 for all g h 1 av d this implies that u v 0 in h 1 av d 11 2 the poisson problem u f 383 the analogue of theorem 11 37 holds with the same proof theorem 11 44 let d be bounded and connected with c 1 boundary the weak solu tion of the poisson problem u f with f l 2 d subject to neumann boundary conditions belongs to h 1 d h 2 loc d if d has c 2 boundary the weak solution u can again be shown to belong to h 2 d a variational characterisation of weak solutions in the spirit of theorem 11 39 can again be given theorem 11 45 variational characterisation of the solution let d be bounded and connected with c 1 boundary and let f l 2 d for a function u 0 h 1 av d the follow ing assertions are equivalent 1 u 0 is the weak solution of the poisson problem u f on d subject to neumann boundary conditions 2 u 0 minimises the energy functional e h 1 d r defined by e u 1 2 d u 2 dx re d u f dx proof the proof is very similar to that in the case of dirichlet boundary conditions we use the notation a u v d u vdx l u d u f dx with this notation for all t r and u 0 u h 1 d we have e u 0 tu e u 0 t re a u u 0 lu 1 2 t 2 a u u 11 25 1 2 suppose that u 0 is a weak solution that is u 0 h 1 av d and a u 0 l for all c d by density this identity extends to arbitrary h 1 d by approximation applying the identity with u and t 1 in 11 25 for all nonzero u h 1 d we obtain e u 0 u e u 0 1 2 a u u e u 0 and by the poincare wirtinger inequality the inequality is strict if u h 1 av d it fol lows that u 0 is a minimiser of e in h 1 d 2 1 suppose conversely that u 0 h 1 av d minimises e in h 1 d the identity 11 25 implies that for all u h 1 av d the function t 7 e u 0 tu is differentiable in t and 0 d dt t 0 e u 0 tu re a u u 0 lu 384 boundary value problems over the real scalar field this implies that a u u 0 lu 0 over the complex scalar field we apply the preceding identity with u replaced by iu to find that also im a u u 0 lu 0 and again it follows that a u u 0 lu 0 in both cases we conclude that u 0 is a weak solution 11 2 c the elliptic problem u u f the results of the preceding two sections admit straightforward modifications for the elliptic problem u u f for re 0 and f l 2 d subject to dirichlet or neumann boundary conditions as always we assume that d is open and bounded in rd and in the case of neumann boundary conditions we furthermore assume that d is connected and has c 1 boundary to treat the case of dirichlet boundary conditions we define a weak solution to be a function u h 10 d such that d u u dx d f dx c c d repeating the steps of the proofs of theorem 11 35 and 11 39 one obtains theorem 11 46 elliptic problem dirichlet boundary conditions if d is bounded then for all re 0 and f l 2 d the elliptic problem u u f subject to dirichlet boundary conditions admits a unique weak solution for 0 this weak solution is the unique minimiser of the energy functional e h 10 d r defined by e u 1 2 d u 2 u 2 dx re d u f dx in the case of neumann boundary conditions the presence of additional term u has the effect of simplifying the heuristic reasoning motivating the definition of a weak solution in section 11 2 b in that the averaging condition is no longer needed repeating the argument it is found that a weak solution should now be defined to be an element u h 1 d such that d u u dx d f dx c d repeating the steps of the proofs of theorem 11 43 and 11 45 one obtains theorem 11 47 elliptic problem neumann boundary conditions if d is bounded and connected with c 1 boundary then for all re 0 and f l 2 d the elliptic prob lem u u f subject to neumann boundary conditions admits a unique weak so lution for 0 this weak solution is the unique minimiser of the energy functional 11 3 the lax milgram theorem 385 e h 10 d r defined by e u 1 2 d u 2 u 2 dx re d u f dx we limit the present treatment of the elliptic problem to the above two theorems in the next two chapters we will develop powerful techniques that allow us to give precise l 2 estimates for the solutions u in terms of the data f and to extend these estimates to lp for 1 p 11 3 the lax milgram theorem the considerations of the previous section depended crucially on the use of the riesz representation theorem as an abstract tool to prove the existence and uniqueness of solutions this technique can be generalised to more general classes of boundary value problems by using a more flexible version of riesz representation theorem the so called lax milgram theorem 11 3 a the theorem in what follows v is a hilbert space the reason for using the letter v is that in appli cations typical choices are v h 10 d and v h 1 d where d is an open subset of rd in such settings the letter h will be reserved for the space l 2 d in order to prevent possible confusion the inner product and norm of v will be denoted by v and v respectively definition 11 48 forms a form on v is a sesquilinear mapping a v v k a form a on v is called bounded if there exists a constant c 0 such that a u v 6 c u v v v u v v in the language of forms proposition 9 15 asserts that if a v v k is a bounded form then there exists a unique bounded operator a on v such that a v v av v v for all v v v moreover a v 6 c where c is the boundedness constant of a definition 11 49 accretive and coercive forms a form a on v is called accretive if rea v v 0 v v and coercive if there exists a constant 0 such that rea v v v 2 v v v 386 boundary value problems for bounded coercive forms we have the following version of proposition 9 15 theorem 11 50 lax milgram if a is a bounded coercive form on v then 1 the bounded operator a associated with a is boundedly invertible and a 1 v 6 1 where is the coercivity constant of a 2 for every bounded functional l v k there exists a unique v v such that l v a v v v v moreover v v 6 a 1 v l proof we proceed in two steps step 1 let a be the bounded operator provided by proposition 9 15 the estimate v 2 6 rea v v 6 a v v av v v 6 av v v v implies that v v 6 av v for all v v from this we infer that a is one to one and has closed range r a in v see proposition 1 21 the operator a is also surjective for otherwise there exists a nonzero element v r a and we arrive at the contradic tion 0 v 2 v 6 rea v v re av v v 0 by the open mapping theorem a has bounded inverse the estimate v v 6 av v now implies that a 1 v 6 1 step 2 given a bounded functional l v k by the riesz representation theorem there exists a unique v 0 v such that l v v v 0 v for all v v moreover it satisfies v 0 v l since a and hence a is boundedly invertible there exists a unique v v satisfying a v v 0 then l v v v 0 v v a v v av v v a v v v v and v v 6 a 1 v v 0 v a 1 v l this proves the existence part as well as the estimate for the norm of v to prove uniqueness suppose that also l v a v v for some v v and all v v then a v v v 0 for all v v taking v v v coercivity gives 0 6 v v 2 v 6 rea v v v v 0 this implies v v part 2 of the theorem provides a generalisation of the riesz representation theorem with the inner product replaced by a bounded coercive form a if a is symmetric that is a v v a v v for all v v v some authors refer to this as a being hermitian then a v v defines an inner product on v generating an equivalent norm in this situation the lax milgram theorem is an immediate consequence of the riesz representation theorem the principal interest in the theorem lies in the nonsymmetric case 11 3 the lax milgram theorem 387 11 3 b the sturm liouville problem as a first application of the lax milgram theorem generalising the results on the pois son problem we shall consider the sturm liouville problem with dirichlet boundary conditions on a nonempty bounded open subset d of rd div a u qu f on d u d 0 11 26 where we make the following assumptions the function f belongs to l 2 d the matrix valued function a d md k has bounded measurable coefficients and is coercive in the sense that there is a constant 0 such that for almost all x d we have re d i j 1 ai j x i j 2 kd the function q d k is bounded and measurable and satisfies req x 0 for almost all x d a function u h 10 d is called a weak solution of 11 26 if for all c c d we have d a u dx d qu dx d f dx theorem 11 51 sturm liouville problem let d be bounded under the above as sumptions on a q and f 11 26 admits a unique weak solution u in h 10 d moreover there exists a constant c 0 independent of f such that u h 10 d 6 c f 2 proof the proof is a straightforward adaptation of the proof of existence and unique ness of the poisson problem with dirichlet boundary conditions this time we apply the lax milgram theorem to the form a h 10 d h 1 0 d k a u v d a u vdx d quvdx which is bounded and coercive boundedness follows from a u v 6 a u 2 v 2 q u 2 v 2 6 2 max a q u h 10 d v h 10 d and coercivity from rea v v re d a v vdx re d q v 2 dx 388 boundary value problems d rea v vdx v 22 v 2 h 10 d where v h 10 d v 2 is the equivalent norm on h 1 0 d considered before the case of neumann boundary conditions can be handled similarly and is left to the reader see problem 11 30 problems 11 1 show that for all f lp 0 1 with 16 p 6 the function i f x x 0 f y dy x 0 1 belongs to w 1 p 0 1 and its weak derivative is given by i f f moreover the mapping f 7 i f from lp 0 1 to w 1 p 0 1 is bounded 11 2 let f w 1 p 0 1 with 16 p 6 a show that f is equal almost everywhere to a continuous function f c 0 1 such that for all x 0 1 we have f x f 0 x 0 f y dy b show that the resulting mapping f 7 f from w 1 p 0 1 to c 0 1 is bounded c show that a function f w 1 p 0 1 with 16 p belongs to w 0 0 1 if and only if its continuous version f see problem 11 2 satisfies f 0 f 1 0 11 3 give a direct proof that c 0 1 is dense in w 1 p 0 1 for all 16 p 11 4 fix 1 p and f w 1 p 0 1 and let f c 0 1 be its continuous version see problem 11 2 a suppose that f 0 0 show that x 7 f x x belongs to l p 0 1 with x 7 f x x p 6 p p 1 f p hint use young s inequality for r dxx from problem 2 25 with f x x 1 p f x x 0 1 0 x 1 b suppose that x 7 f x x belongs to l p 0 1 show that f 0 0 hint argue by contradiction problems 389 c define f x 1 1 logx x 0 1 show that f w 1 1 0 1 and f 0 0 but f x x l 1 0 1 11 5 determine whether the function f l 1 1 1 1 1 given by f x y xy x y 1 1 1 1 has weak derivatives of order one if no provide a proof if yes compute the weak derivatives 1 f and 2 f 11 6 let d be bounded and fix 16 p let r r satisfy r 1 dp a show that the function f x x r belongs to w 1 p d and compute its weak partial derivatives b let xn n 1 be a countable dense set in d show that the function g x n 1 1 2 n x xn r belongs to w 1 p d c show that if d 2 and 1 dp r 0 then g is unbounded on every open subset of d 11 7 for 1 6 p we consider the weak derivative a linear operator in lp 0 1 with domain d c c 0 1 a show that is closable as an operator in lp 0 1 b show that the domain of the closure of equals w 1 p 0 d c show that this closure has a proper closed extension given by the weak derivative with domain w 1 p 0 1 d why doesn t this contradict the result of proposition 10 30 11 8 let f l 1 loc d a show that if f admits a weak gradient then it admits weak derivatives j f for all j 1 d b show that if f admits a weak laplacian then it admits weak derivatives j f for all j 1 d c show that if f l 2 loc d and f admits a weak laplacian in l 2 loc d then f h 2 loc d hint first check that the weak derivatives j f belong to h 2 loc d and use this to prove that f has a weak laplacian in l 2 loc d for every test function c c d then use theorem 11 29 11 9 show that if f w 1 p d with 1 p then f 0 almost everywhere on the set x rd f x 0 hint in the real valued case f f f 11 10 is h 1 d a banach lattice 390 boundary value problems 11 11 show that if a real valued function f l 1 loc d admits weak derivatives j f and r k is a c 1 function with bounded derivative then f admits weak derivatives given by j f f j f 11 12 let 16 p q r 6 satisfy 1 p 1 q 1 r prove that if f w k p d and g w k q d then f g w k r d and for all multi indices with 6 k we have the leibniz formula f g 06 6 f g 11 13 does theorem 11 41 extend to the case p 11 14 consider the inclusion mapping f 7 f from w 1 p 0 1 to c 0 1 of problem 11 2 in what follows we let 1 p 6 a show that there is a constant c 0 such that f 6 c f w 1 p 0 1 for all f w 1 p 0 1 b show that the inclusion w 1 p 0 1 c 0 1 is compact hint use the arzela ascoli theorem c show that the inclusion w 1 1 0 1 c 0 1 fails to be compact hint approximate 1 12 1 pointwise by a sequence of piecewise linear func tions which is cauchy in w 1 1 0 1 11 15 show that the inclusion mapping w 1 2 r l 2 r fails to be compact 11 16 let f w 1 d a suppose that l 1 rd has support in the unit ball b 0 1 of rd and satis fies rd x dx 1 for 0 denote x d 1 x show that the convolution f f satisfies the pointwise bound f x 6 f w 1 d x d where d x d d x d b show that if d is convex then f x f y 6 f w 1 d x y x y d c deduce that if d is convex then for every f w 1 d there exists a lip schitz continuous function g d k such that f g almost everywhere with lipschitz constant lg f w 1 d d show that the result of part c fails for the nonconvex open set inr 2 obtained by removing the nonnegative part of the x axis from b 0 1 problems 391 11 17 show that if f w 1 p 0 d with 1 6 p and d is an open set containing d then the function f d k defined by f x f x x d 0 x d d belongs to w 1 p 0 d 11 18 show that there exists a constant c 0 such that for all f c c rd we have f 2 6 c f 1 2 2 f 1 2 show that this inequality extends to functions f w 2 2 rd hint start by showing that f 2 6 c f 2 f for some possibly differ ent constant c 0 then apply this inequality with f cx in place of f x and optimise over c 0 11 19 for h rd let dtj f x 1 t f x te j f x 16 j 6 d t r 0 where e j is the jth standard unit vector of rd a prove that if f w 1 p rd with 16 p 6 then dtj f p 6 j f p 16 j 6 d t r 0 where j f denotes the jth partial derivative of f b prove that if there exists a constant c 0 such that for all f lp rd we have 1 p then dtj f p 6 c 16 j 6 d t r 0 then f w 1 p rd and j f p 6 c for all 16 j 6 d 11 20 let 1 6 p the aim of this problem is to show that for all f w 1 p r we have f limh 0 dh f in lp r where dh f x f x h f x h x r h 6 0 a let h 6 0 show that th f x 1 h x h x f t dt x r defines a bounded operator on lp r of norm th 6 1 hint show that th f 1 h 1 0 1 1 h f where denotes the convolution product and use young s inequality b show that for all f c 1 c r we have f limh 0 dh f in lp r 392 boundary value problems c deduce that for all f w 1 p r we have f limh 0 dh f in lp r 11 21 show that for all s 0 the norm given by 11 9 turns hs rd into a hilbert space 11 22 using fourier analytic methods prove the following special case of the sobolev embedding theorem if k d 2 then every f hk rd is equal almost ev erywhere to a function belonging to c 0 rd moreover the inclusion mapping hk rd c 0 rd is continuous 11 23 the aim of this problem is to prove another special case of the sobolev embed ding theorem by completing the following steps show that if d p then every f w 1 p d is equal almost everywhere to a continuous function on d a first let d rd show that if f c 1 c rd and the function c 1 c 1 1 satisfies 0 1 then f 0 0 b 0 1 r d j 1 y j j f ry f ry y ds y dr where s is the surface measure and hence f 0 6 c b 0 1 1 x d f x f x dx for some constant c 0 independent of f b apply ho lder s inequality to obtain the bound f 0 6 c f w 1 p rd for some constant c 0 independent of f c by translation conclude that f 6 c f w 1 p rd use a density argument to prove that if f w 1 p rd then it is equal almost everywhere to a bounded continuous function d for general domains use a localisation argument 11 24 this problem is a continuation of the preceding one a show that if 1 6 p q satisfy d 1 p 1 q 1 then every f w 1 p rd belongs to lq rd and f lq rd 6 c f w 1 p rd for some constant c 0 independent of f hint starting from the formulas of the preceding problem use a translation argument in combination with young s inequality see the hint of problem 11 20 problems 393 b by repeatedly applying the inequality of part a deduce an embedding result for functions in w k p rd into the space of bounded continuous functions 11 25 consider the green function on the unit interval 0 1 see section 11 2 a k x y 1 x y 06 y 6 x 1 y x x 6 y 6 1 a show that the associated integral operator tk f x 1 0 k x y f y dy on l 2 0 1 is compact and has eigenvalues 1 n 2 n 1 2 3 with cor responding eigenfunctions x 7 sin n x let now f l 2 0 1 be given and define u l 2 0 1 by u x tk f x x 0 1 b show that u h 10 0 1 c show that u is a weak solution of the poisson problem with dirichlet bound ary conditions u f on 0 1 u 0 u 1 0 11 26 in this problem we consider the poisson problem with dirichlet boundary condi tions on the unit disc d b 0 1 in r 2 u f on d u d 0 11 27 if f l 2 d we know from theorem 11 35 that 11 27 has a unique weak so lution u h 10 d the aim of this problem is to show that even for functions f cc d 11 27 may not admit a classical solution u c 2 d c d define v b 0 12 0 r by v x y x 2 y 2 log log x 2 y 2 1 2 x y b 0 12 a show that v c 2 b 0 12 0 and compute vx vy vxx and vyy b show that lim x y 0 0 v x y lim x y 0 0 vx x y lim x y 0 0 vy x y 0 conclude v can be extended to a function in c 1 b 0 12 hint for 0 one has logs 6 s for s small and logs 6 s for s large 394 boundary value problems c show that v b 0 12 0 r has a continuous extension to b 0 1 2 which we denote by g b 0 12 r moreover show that b 0 12 v dx b 0 12 g dx c c b 0 1 2 hint use green s theorem on b 0 12 b 0 with 0 and let 0 d let c c d be compactly supported in b 0 1 2 with 1 on b 0 1 4 show that u v belongs to h 10 d and is the weak solution of 11 27 with f g 2 v v e show that limx 0 vxx x x and deduce from this that u c 2 d con clude that 11 27 does not admit a classical solution u hint use theorem 11 35 11 27 prove theorems 11 46 and 11 47 11 28 the aim of this problem is to solve the poisson problem with inhomogeneous boundary conditions u f on d u d g 11 28 where d rd is bounded and f l 2 d and g c d are given functions we assume the function g admits an h 1 d extension by which we mean that there exists a function g h 1 d c d such that g d g under these as sumptions a function u h 1 d is called a weak solution of the poisson problem with dirichlet boundary conditions 11 28 if d u dx d f dx c c d and u g h 10 d the condition u g h 1 0 d is the rigorous way to express the boundary condition u d g a the condition u g h 10 d explicitly refers to the extension g by using theorem 11 24 show that the fulfilment of this condition does not depend on the particular choice of the extension b prove that for every f l 2 d the poisson problem 11 28 has a unique weak solution u h 1 d hint for u h 10 d show that l u d u f dx d u g dx defines a bounded functional on h 10 d and apply the riesz representation theorem problems 395 11 29 let d be a bounded and let g c d be arbitrary let u be a classical solution g of the dirichlet problem that is the problem 11 28 with f 0 prove that the following assertions are equivalent 1 u has finite energy that is d u 2 dx 2 u is a weak solution 3 g has an h 1 extension hint for the proof of 3 2 let d bd the function g u d has an h 1 d extension given by u d hence by the result of the preceding problem the prob lem v 0 on d v d g has a unique weak solution u h 1 d prove that u u almost everywhere on d and that the restriction of u u to d belongs to h 10 d 11 30 discuss the sturm liouville problem for neumann boundary conditions 11 31 let h be a hilbert space and let h h be a given element show that the nonlin ear functional e h r defined by e u 1 2 u 2 re u h has a unique minimiser by completing the following steps a show that e is continuous and bounded from below that is m inf u h e u b using the parallelogram identity show that for all u v h we have 1 4 u v 2 6 e u e v c deduce that if un n 1 is a sequence in h such that limn e un m then this sequence is cauchy d prove that u limn un is the unique element of h minimising e 11 32 let v be a hilbert space and consider a bounded coercive form a v v k let l v k be a bounded functional by the lax milgram theorem there is a unique uv v satisfying a v uv l v for all v v suppose now that w is a closed subspace of v by the lax milgram theorem applied to the restriction of a to w w there is a unique uw w satisfying a w uw l w for all w w a show that a uv uw w 0 for all w w 396 boundary value problems b show that uv uw 6 c 1 inf w w uv w 11 29 with c 0 and 0 the boundedness and coercivity constants of a c show that if a is symmetric that is a v 1 v 2 a v 2 v 1 for all v 1 v 2 v then uv uw 6 c 1 inf w w uv w 11 30 the quasi optimality estimates in 11 29 and 11 30 are known as ce a s lemma 11 33 in this problem we outline an application to the so called finite element method for the poisson problem 11 13 on the unit interval 0 1 with datum f l 2 0 1 u f on 0 1 u 0 u 1 0 11 31 in what follows we endow v h 10 0 1 with the norm v h 10 0 1 v 2 by the poincare inequality this norm is equivalent to the sobolev norm v 2 v 2 consider a partition x 0 xn of the interval 0 1 that is we assume that 0 x 0 x 1 xn 1 xn 1 let v denote the closed subspace con sisting of all v v that are linear on each of the intervals xn 1 xn a show that there exist unique elements u h 10 0 1 and u v such that a v u 1 0 v x f x dx v v a v u 1 0 v x f x dx v v 11 32 using the results of problem 11 32 prove the quasi optimality estimate u u h 10 0 1 6 infv v u v h 10 0 1 b show that for all v h 10 0 1 h 2 0 1 we have v h 1 0 1 and v v h 10 0 1 6 h v l 2 0 1 where v v is obtained by piecewise linear interpolation of the values v xn 06 n 6 n and h max 16 n 6 n xn xn 1 is the mesh of hint fix x 0 1 and choose 16 n 6 n such that xn 1 x xn then v x v xn v xn 1 xn xn 1 problems 397 and since v h 2 0 1 v xn v xn 1 xn xn 1 v xn 1 xn xn 1 xn y v y dy rewriting the latter as v xn 1 v xn v xn 1 xn xn 1 xn xn 1 xn y xn xn 1 v y dy and using that y xn 1 xn xn 1 6 1 and xn y xn xn 1 6 1 show that v x v x 6 xn xn 1 v y dy c let the assumptions of theorem 11 35 be satisfied with d 1 and d 0 1 and let u h 10 0 1 h 2 0 1 be the weak solution of the poisson problem 11 31 see theorem 11 37 prove that u u h 10 0 1 6 h u l 2 0 1 since the norm v h 10 0 1 is equivalent to the sobolev norm v 2 v 2 the result of part c shows that u and its weak derivative u provide good approxi mations of u and its weak derivative u in the l 2 0 1 norm if h is small the approximate solution u can be constructed explicitly as follows every u v can be written uniquely as a finite linear combination u n 1 n 1 cn n where n v is the piece wise linear function given by the requirements n xm 1 n m 0 n 6 m since these functions form a basis for v by definition u is the unique element of v solving 11 32 which for our boundary value problem takes the form 1 0 v u dx 1 0 v f dx v v since the functions n form a basis for v this holds if and only if 1 0 nu dx 1 0 n f dx n 1 n 1 writing u n 1 m 1 cm m our task is reduced to determining the coefficients c 1 cn 1 from the equation system of n 1 linear equations n 1 m 1 cm 1 0 m n dx 1 0 n f dx n 1 n 1 the functions n take nonzero constant values on the intervals xn 1 xn and 398 boundary value problems xn xn n 1 and vanish on the remaining sub intervals it follows from this that 1 0 m n dx 0 unless m n 1 0 1 therefore the computation of the co efficients cm reduces to a matrix problem of the form sc d where the so called stiffness matrix s is the n 1 n 1 matrix whose coefficients snm 1 0 n m dx vanish off the diagonal and the two neighbouring off diagonals and dn 1 0 n f dx this problem is easy to solve with numerical methods from linear algebra 12 forms this chapter develops elements of the theory of sesquilinear forms and uses it to define and study certain bounded and unbounded operators including second order differen tial operators such as the laplace operator subject to dirichlet and neumann boundary conditions 12 1 forms in the previous chapter we proved existence and uniqueness of weak solutions of the poisson problem u f on a nonempty bounded open subset d rd for functions f h l 2 d by exploiting the properties of the sesquilinear mapping a v v k a u v 7 d u vdx 12 1 where v h 1 d or a suitable closed subspace thereof if the matrix valued function a d md k is coercive the sesquilinear mapping a u v 7 d a u vdx 12 2 played the same role in solving the sturm liouville problem in each of these cases the key ingredient was the poincare inequality which can be phrased in terms of a as rea v v v 2 h v v where 0 is a positive constant this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 399 400 forms in order to study these matters from an abstract point of view it will be useful to interpret a form a defined on a subspace v of a hilbert space h as one in h with domain d a v in the same way as the notion of a bounded operator has been generalised to that of a linear possibly unbounded operator a defined on a domain d a definition 12 1 forms accretivity and coercivity a form in a hilbert space h is a pair a d a where d a is a subspace of h the domain of a and a d a d a k is a sesquilinear mapping a form a d a is called accretive if rea x x 0 x d a and coercive if there exists a constant 0 such that rea x x x 2 x d a in what follows h always denotes a hilbert space definitions 11 48 and 11 49 are recovered in the special case d a h when no confusion is likely to arise we omit d a from the notation and denote the form by a example 12 2 the forms in h l 2 d defined by 12 1 and 12 2 are accretive and continuous on the domain d a h 1 d and coercive on the domains d a h 10 d and d a h 1 av d if a is an accretive form in h then x y a rea x y x y x y d a 12 3 defines an inner product on d a here x y is the inner product of x and y in h and rea 1 2 a a is the symmetric part of a given by a x y a y x the inner product 12 3 induces a norm on d a given by x a x x 1 2 a warning rea x y 1 2 a x y a y x should not be confused with re a x y 1 2 a x y a x y the former defines a sesquilinear form the real part of a but the latter generally does not it is true however that rea x x re a x x for all x d a 12 1 forms 401 from definition 11 48 we recall that a form a on v is said to be bounded if there exists a constant c 0 such that a u v 6 c u v u v v this definition can be extended to forms in h as follows definition 12 3 continuous forms an accretive form a in h is called continuous if there exists a constant c 0 such that a x y 6 c x a y a u y d a a sufficient condition for continuity will be given in proposition 13 42 12 1 a closed forms the following definition is motivated by the simple fact observed in proposition 10 3 that a linear operator a is closed if and only if its domain d a is a banach space with respect to the graph norm definition 12 4 closed forms an accretive form a in h is called closed if d a is a hilbert space with respect to the norm a the following two propositions express some robustness properties of closed forms among other things the first proposition clarifies the relation between definition 12 1 where accretivity of forms in h was defined through the condition rea x x x 2 x d a and definition 11 49 where accretivity of a form on a hilbert space v was defined through the condition rea x x x 2 v x v in the former case one could view a as a form on v d a and ask why norms are taken in h rather than in v as it turns out except for the numerical value of the constant this leads to the same definition proposition 12 5 a closed form a in h is accretive respectively coercive continu ous if and only if a as a form on the hilbert space v d a a is accretive respectively coercive bounded proof only the assertion concerning coercivity needs proof we must prove that there exists a constant 0 such that rea x x x 2 x d a 12 4 402 forms if and only if there exists a constant 0 such that rea x x x 2 a x d a 12 5 if 12 4 holds then for all x d a we have 1 rea x x rea x x x 2 x 2 a and therefore 12 5 holds with 1 conversely if 12 5 holds then for all x d a we have rea x x x 2 a rea x x x 2 this forces 0 1 and 12 4 holds with 1 proposition 12 6 let a be a closed accretive form in h if v d a admits an inner product v turning v into a hilbert space such that the inclusion mapping from v into h is bounded then the associated norm v is equivalent to the norm a proof define a norm on v by v v v v a v v we claim that v is complete with respect to indeed if vn n 1 is a cauchy se quence with respect to then it is cauchy with respect to both v and a by completeness there exist v v v such that limn vn v v limn vn v a 0 since the inclusion mapping from v into h is bounded with respect to both norms we also have limn vn v limn vn v 0 in h it follows that v v as elements in h hence also as elements of v setting v v v we then have limn vn v 0 proving the completeness of v with respect to since u v 6 u and u a 6 u for all u v the open mapping theorem can be applied to find that both v and a are equivalent to 12 1 b gelfand triples motivated by proposition 12 6 we shall now consider the abstract setting where we are given a hilbert space v which is continuously embedded into another hilbert space h meaning that there exists a bounded injective operator i v h we shall write and respectively v and v for the inner products and norms of h and v identifying elements of v with their images in h without loss of generality we may and will assume that as a set v is a subspace of h and i is the inclusion mapping we write v h to summarise this state of affairs 12 1 forms 403 definition 12 7 gelfand triples a gelfand triple is a triple i v h where h and v are hilbert spaces and i v h is a continuous and dense embedding example 12 8 gelfand triples from closed forms if a is a densely defined closed accretive form in h then i d a h with i the inclusion mapping from d a into h is a gelfand triple the concrete examples covered by example 12 2 will be discussed in section 12 3 where the connection with weak solutions to boundary value problems will be made this connection will be made more explicit in operator theoretic terms in section 12 4 our main aim is to connect gelfand triples with the theory of closed operators we will prove that if i v h is a gelfand triple and a is a bounded accretive form on v then it is possible to associate a densely defined closed linear operator a with a such that d a v and au v a u v u d a v v moreover suitable bounds on the resolvent of a can be given we start with some preparations definition 12 9 conjugate dual the conjugate dual of a hilbert space v is the vector space v of all mappings v k that are conjugate linear in the sense that u v u v cv c v u v v c k and bounded in the sense that v 6 c v v v v where c 0 is a constant it is routine to check that the space v is a banach space in a natural way with norm v sup v v 61 v in the presence of a continuous embedding i v h every element h h defines an element h v in a natural way by defining h v h i v v v and we have h v 6 sup v v 61 h i v 6 i h 12 6 as a mapping from h to v the mapping h 7 h is linear additivity is clear and for the scalar multiplication we have ch v ch i v c h i v c h v 404 forms so ch c h the estimate 12 6 shows that this mapping is bounded with norm 6 i we claim that if the inclusion mapping i has dense range then is injective indeed if h 0 then for all v v we have h i v h v 0 and since i has dense range this is only possible if h 0 composing i and every v v defines an element j v i v in v and we have j v u iv u i v i u u v v the mapping j v v thus obtained is linear proposition 12 10 if i v h has dense range then the mapping h v is injective and has dense range proof injectivity has already been observed so it remains to prove the dense range property the riesz representation theorem sets up a norm preserving conjugate linear bijection v v and a norm preserving conjugate linear bijection v v is obtained by mapping a functional v v to the conjugate linear mapping v v given by v v v v combining these identifications we obtain a norm preserving linear bijection v v by proposition 4 31 the injectivity of i implies that its adjoint i has dense range in v and maps this range to a dense subspace of v the claim follows from this by observing that i since for all h h and v v we have i h v v i h v i h v i h v v h i v h v from now on we assume that v is densely embedded in h omit the mappings i j and think of v as a dense subspace of h and h as a dense subspace of v definition 12 11 the linear operator associated with a form the operator a associ ated with a densely defined closed accretive form a in h is defined by u d a and au h u d a and h v a u v for all v d a since d a is dense in h the element h h is uniquely defined and thus a is well defined as a linear operator in h linearity being clear from the definition without imposing further properties on a this definition is not very useful under appropriate additional assumptions on a the next theorem provides some interesting properties of the associated operator theorem 12 12 resolvent estimate bounded coercive forms in v let i v h be a gelfand triple and let a be the linear operator in h associated with a bounded coercive form a on v then a is densely defined and closed and for all c with re 0 we have a and a 1 6 1 re a 1 6 1 c 1 12 1 forms 405 where c and are the boundedness and coercivity constants of a proof fix c with re 0 as a form on v a u v a u v u v u v v is bounded and coercive this follows from a u v 6 a u v u v 6 c u v v v i 2 u v v v and rea v v rea v v re v v rea v v v 2 v 12 7 denote by av the bounded operator on v associated with a through proposition 9 15 so that av u v v a u v for all u v v the bounded operator on v associated with a equals av av i i by the lax milgram theorem applied to the form a av is boundedly invertible with a 1 v l v 6 1 composing av with the isometric isomorphism from v onto v from the proof of proposition 12 10 we may identify av with a bounded operator a v from v to v which is boundedly invertible and satisfies a 1 v l v v 6 1 let r denote the restriction of a 1 v to h viewed as a bounded operator from h to h as such it is bounded and injective define the closed operator b d b in h by d b r r and b r 1 to see that b is densely defined in h note that d b r r r a 1 v h a 1 v h h h is dense in v and hence in h since a 1 v v v is an isomorphism v is dense in h and h is dense in v for all u f h u d b and b u f u r r and r 1 u u f u v and av u u f u v and f v a u v for all v v u d a and au f it follows that a b so a is densely defined and closed and a b r 1 this in turn implies that a is injective and surjective the latter since r is defined on all of h and hence boundedly invertible for v d a the accretivity of a gives a v v a v v re a v v re v 2 rea v v re v 2 this gives the first resolvent estimate 406 forms fix an arbitrary h h defining u a 1 h r h v and using that h a u r 1 u a v u av u we have a u v a u v u v av u v h v v v 12 8 taking v u in 12 8 by 12 7 we obtain u 2 v 6 rea u u re h u 6 h u 12 9 by 12 8 and 12 9 u 2 6 h u a u u 6 h u c u 2 v 6 1 c h u where c is the boundedness constant of a substituting back the definition of u we obtain the bound a 1 h 6 1 c h h h this gives the second resolvent estimate in applications v often arises as the domain of a densely defined closed form a in h cf example 12 8 in this setting theorem 12 12 implies the following result corollary 12 13 let a be the linear operator in h associated with a closed continuous accretive form a in h then a is densely defined and closed for all c with re 0 we have a and a 1 6 1 re re 0 and for all 0 we have a 1 6 c re where c is a constant depending only on and the continuity constant c of a proof consider the hilbert space v d a a and let i v h be the inclusion mapping by proposition 12 5 and its proof for all 0 the form a u v a u v u v a u v i iu v v u v v is bounded and coercive as a form on v with boundedness constant c i i and accretivity constant 1 the operator associated with a is a by theorem 12 12 this operator and hence a itself is densely defined and closed and for all re 0 the operator a is boundedly invertible and satisfies the resolvent bounds a 1 6 1 re a 1 6 1 c i i 1 1 since 0 was arbitrary the corollary follows from this 12 1 forms 407 further properties of the operators a in the theorem and its corollary will be obtained in the next chapter see theorem 13 37 without the continuity assumption it is still possible to prove a version of the first resolvent estimate see theorem 13 36 an elegant application of the corollary is the following duality result recall that if a is a form in h we define a x y a y x for x y d a corollary 12 14 a is associated with a let a be the densely defined closed operator in h and suppose that one of the following two conditions is satisfied 1 a is the operator associated with a closed continuous accretive form a in h 2 a is the operator associated with a bounded coercive form a on v where i v h is a gelfand triple then a is the densely closed defined operator associated with the form a proof 1 since a is densely defined d a is dense since d a d a by defini tion it follows that a is densely defined from v v a rea v v v v rea v v v v v v a v v it follows that a is continuous and accretive let b denote the densely defined closed operator associated with a if x d b then for all y d a we have y bx bx y a x y a y x ay x it follows that x d a and a x bx this shows that b a next let x d a by corollary 12 13 applied to a the operator i b is invertible so there exists y d b such that i a x i b y since b a we have y d a and i a x i a y by corollary 12 13 applied to a the operator i a is invertible and therefore so is its adjoint i a it follows that x y d b this shows that a b 2 this is proved in the same way this time using theorem 12 12 12 1 c closable forms we return to the setting of forms in a hilbert space h considered at the beginning of section 12 1 definition 12 15 closable forms an accretive form a in h is called closable if there exists a closed accretive form a in h extending a that is a is closed and accretive d a d a and a u v a u v for all u v d a the following proposition in which we view d a as a not necessarily complete normed space with norm a gives a useful necessary and sufficient condition for a form a in h to be closable it should be compared with proposition 10 12 408 forms proposition 12 16 for a continuous accretive form a in h the following assertions are equivalent 1 a is closable 2 every cauchy sequence in d a converging to 0 in h converges to 0 in d a the hard implication is 2 1 it is tempting to try to prove it as follows by con tinuity a extends to an accretive form a on the completion of d a with respect to the norm a it is not clear however whether the inclusion mapping of d a into h ex tends to an embedding of its completion into h this difficulty explains why we have to proceed more carefully proof set v d a with norm v a we note that assertion 2 can be equivalently stated as follows 2 whenever a sequence vn n 1 in v satisfies limn vn 0 in h and lim m n rea vm vn vm vn 0 then limn rea vn vn 0 1 2 suppose that a has a closed extension a whose domain v is complete with respect to a if un n 1 is a sequence in v such that limn un 0 in h and limm n rea um un um un 0 then the sequence un n 1 is cauchy with respect to a and hence since a extends a with respect to a since v is complete with respect to the norm a the sequence is convergent in v say to u v the sequence un n 1 is cauchy in h as well and since v embeds in h we have un u in h since we assumed that un 0 in h it follows that u 0 hence limn un 0 with respect to a and this in turn implies that limn rea un un 0 2 1 the proof proceeds in three steps step 1 define v to be the set of all v h for which there exists a cauchy sequence vn n 1 in v such that limn vn v in h in what follows we refer to a sequence with these properties as an approximating sequence for v we begin by showing that the limit a u v lim n a un vn exists whenever un n 1 and vn n 1 are approximating sequences for u v v and that this limit is independent of the choice of approximating sequences to begin with the existence of the limit we note that for all m n 1 a um vm a un vn a um un vm a un vm vn 6 c um un a sup m 1 vm a c vm vn a sup n 1 un a 12 10 12 1 forms 409 by the continuity of a since un n 1 and vn n 1 are cauchy in v they are bounded and we conclude from 12 10 that a un vn n 1 is a cauchy sequence hence convergent as to the well definedness of the limit suppose that u and v are approximated by the sequences u n n 1 and v n n 1 with the properties as stated then by a similar estimate a un vn a u n v n 6 c un u n a sup m 1 vn a c vn v n a sup n 1 u n a now un u n 2 a un u n 2 rea un u n un u n the first term on the right hand side tends to 0 as n since un u and u n u the second term tends to 0 because of the restatement of 2 mentioned at the beginning of the proof in the same way we obtain vn v n 2 a 0 and the proof can be completed as before it is clear that v v and that the resulting mapping a v v c is sesquilinear so it defines a form is continuous and accretive and extends a step 2 we show that v is dense in v with respect to the norm a to this end let v v and let vn n 1 be an approximating sequence we claim that limn vn v a 0 since we already know that limn vn v it suffices to prove that limn rea vn v vn v 0 this follows from lim n rea vn v vn v lim n lim m rea vn vm vn vm 0 the first of these identities being a consequence of the definition of a along with the fact that vn vm vn v in h and rea vn vm vn v vn vm vn v 0 as m step 3 to prove that a is closed suppose first that vn n 1 is a sequence in v which is cauchy with respect to a this means that vn n 1 is cauchy in h and lim m n rea vm vn vm vn 0 let limn vn v the convergence being in h since a extends a we have lim m n rea vm vn vm vn 0 the very definition of v implies that v v and as in step 2 we have lim n vn v 2 a limn rea vn v vn v vn v 2 lim n lim m rea vn vm vn vm vn v 2 0 suppose next that vn n 1 is a sequence in v which is cauchy with respect to a since v is dense in v by step 2 we may choose elements vn v such that vn vn 410 forms 1 n then vn n 1 is cauchy in v and by what we just proved it has a limit v in v then v is also a limit for vn n 1 the form a constructed in the above proof is called the closure of a further properties of a are discussed in problem 12 5 12 2 the friedrichs extension theorem it has been shown in corollary 10 43 that if a is a densely defined operator which is positive in the sense that ax x 0 for all x d a and has the property that i a has dense range then a is selfadjoint the next theorem states that if we give up the dense range condition selfadjoint extensions still exist theorem 12 17 friedrichs extension let a be a densely defined positive operator acting in a complex hilbert space h then 1 the form a in h given by d a d a and a x y ax y x y d a is densely defined positive continuous and closable 2 the operator associated with the closure of a is a positive selfadjoint extension of a proof 1 it is clear that a is densely defined and positive and continuity of a follows from the cauchy schwarz inequality a x y 2 6 a x x a y y 6 x 2 a y 2 a here the positivity of a was used to see that a x x ax x 0 and hence a x x rea x x 6 x 2 a to prove that a is closable we check the criterion of proposition 12 16 keeping in mind that a x x 0 for all x d a pick a sequence vn n 1 in v such that limn vn 0 in h and limm n a vm vn vm vn 0 we must show that limn a vn vn 0 given 0 for large enough m n we have 06 a vm vn vm vn avm avn vm vn avm vm avn vn 2 re avm vn fixing m upon letting n and using that vn 0 we obtain 06 avm vm limsup n avn vn 6 since a is positive this can only happen if limsupn avn vn 6 and since 0 was arbitrary this forces limn a vn vn 0 12 3 the dirichlet and neumann laplacians 411 2 by 1 the form a is densely defined continuous closable and satisfies a v v 0 for all v d a its closure a enjoys the same properties and therefore corollary 12 13 allows us to associate a positive operator b with b re 0 by proposition 10 41 which applies since positive operators are symmetric here we use the assumption that the scalar field is complex cf the remark after definition 10 33 this implies that b is selfadjoint alternatively one may observe that the positivity of a implies that a a and hence a a and therefore b b by corollary 12 14 if a is a densely defined closed operator from h to another hilbert space k then by theorem 10 44 the operator a a with domain d a a x d a ax d a is positive and selfadjoint the next result relates this operator with the theory of forms proposition 12 18 let a be a densely defined closed operator from h to another hilbert space k the form a on d a d a defined by a u v au av u v d a is closed continuous and accretive and a a coincides with the operator associated with a proof densely definedness continuity and accretivity are clear for v d a we have v 2 a v 2 a v v v 2 av 2 from which we deduce that a is equivalent to the graph norm of a since a is closed d a d a is complete with respect to a and the closedness of a follows let b be the operator associated with a then b satisfies bu u a u u au 2 0 for all u d b so b is positive by the definition of the domain of an operator associated with a form we have u d b u v and f d a f v a u v for all v d a u v and f d a f v au av for all v d a u d a au d a and bu a au this shows that b a a 12 3 the dirichlet and neumann laplacians we now turn to some examples that connect the theory developed in the preceding sections to the boundary value problems studied in the previous chapter 412 forms 12 3 a the laplace operator let v h 1 rd w 1 2 rd and consider the sesquilinear form a on v defined by a u v rd u vdx u v v this form is bounded and positive on v the easy proof is left to the reader we claim that the densely defined closed operator a in l 2 rd associated with a equals where is the weak laplacian in l 2 rd with domain d h 2 rd cf theorem 11 29 to prove the claim we begin by noting that if u h 2 rd then ju h 1 rd w 1 2 rd by theorems 11 29 and 11 31 and therefore a u v d j 1 rd 2 j u x v x dx u v 12 11 for all v c c rd by approximation this identity extends to all v h 1 rd this means that u d a and au u conversely if u d a then u h 1 rd and for all v c c rd we have rd au x v x dx au v a u v rd u vdx rd u x v x dx by the definition of weak derivatives this shows that u admits a weak laplacian given by u au in the sense of theorem 11 29 and therefore u h 2 rd by this theorem another description of the operator can be given on the basis of theorem 10 44 and proposition 12 18 these results identify the operator associated with the form a defined by 12 11 to be with domain d f d f d where d h 1 rd summarising this discussion we have proved theorem 12 19 the following operators in l 2 rd are equal with equal domains 1 the weak laplacian with domain d f l 2 d f admits a weak laplacian in l 2 rd 2 the operator a where a is the operator in l 2 rd associated with the form a on h 1 rd given by a u v rd u vdx 3 the operator with domain d f d f d where is the weak gradient viewed as a densely defined closed operator from l 2 rd to l 2 rd cd with domain d h 1 rd 12 3 the dirichlet and neumann laplacians 413 a fourth description of will be added to this list in section 13 6 c namely as the generator of the heat semigroup on l 2 rd 12 3 b the dirichlet laplace operator let d be a nonempty bounded open subset of rd as before we write h 10 d w 1 2 0 d let v h 10 d viewed as a dense subspace of l 2 d and consider the form adir on v given by adir u v d u vdx u v v 12 12 this form is bounded positive and coercive by the poincare inequality as a form on v the densely defined closed operator in l 2 d associated with it is denoted by dir the operator dir is called the dirichlet laplacian on l 2 d to substantiate the claim that dir correctly models the dirichlet boundary condition consider a function u c 2 d which satisfies u d 0 if v c 2 c d an integration by parts gives u v d u vdx d u vdx adir u v where the last identity is justified by the fact that u belongs to h 10 d by theorem 11 24 since c 2 c d is dense in h 1 0 d it follows that u d dir and diru u using theorem 11 37 it follows that d dir u h 10 d h 2 loc d u l 2 d 12 13 to prove this we must show that a function u h 10 d belongs to h 2 loc d if and only if there exists f l 2 d such that d f vdx d u vdx v h 10 d 12 14 if such a function f exists then u is the weak solution of the poisson problem u f and theorem 11 37 implies that u h 2 loc d in the converse direction suppose that u h 10 d belongs to h 2 loc d if c c d is a given test function select an open set u b d containing the support of and use the fact that u h 2 u to see that d u dx u u dx u u dx d u dx since f l 2 d both sides depend continuously on with respect to the norm of h 10 d since c c d is dense in h 1 0 d it follows that this identity extends to arbitrary h 10 d this proves that u satisfies 12 14 with f u l 2 d 414 forms the result of remark 11 38 also implies by the same reasoning that if d has a c 2 boundary this domain characterisation improves to d dir h 1 0 d h 2 d 12 3 c the neumann laplace operator as before we let d be nonempty bounded open subset of rd as a variation of the preceding example we may take v h 1 d w 1 2 d viewed as a dense subspace of h l 2 d and consider the form aneum on v given by aneum u v d u vdx u v v the only difference with 12 12 is the different choice of the space v this form is bounded and positive as a form on v the densely defined closed operator in l 2 d associated with it is denoted by neum the operator neum is called the neumann laplacian on l 2 d to substantiate the claim that neum correctly models the neumann boundary con dition let us assume for the moment that d has a c 1 boundary consider a function u c 2 d which satisfies f d 0 where is the outward normal vector on d if v c 2 d then green s formula asserts that u v d u vdx d u vds d u vdx d u vdx aneum u v where s is the normalised surface measure on d since c 2 d is dense in h 1 d by theorem 11 27 it follows that u d neum and neumu u as for the dirichlet laplacian theorem 11 44 implies that d neum u h 1 d h 2 loc d u l 2 d 12 15 if d has a c 2 boundary this improves to d neum h 2 d 12 3 d selfadjointness the following result is an immediate consequence of theorem 12 17 noting that the forms involved are closed theorem 12 20 selfadjointness of the laplacian the laplacian on l 2 rd and the dirichlet and neumann laplacians on l 2 d with d rd nonempty bounded and open are positive and selfadjoint 12 4 the poisson problem revisited 415 these three operators also fall into the setting of theorem 10 44 indeed by the proposition all three laplacians are of the form where is the gradient viewed as a densely defined closed operator from h to k where h l 2 u and k l 2 u rd with u rd d this gives an alternative proof of their selfadjointness 12 3 e operators in divergence form let d be a nonempty bounded open subset of rd and consider a matrix valued function a d md k satisfying the following conditions i the coefficients ai j d k are measurable and bounded ii for all x d and kd we have re di j 1 ai j x i j 0 condition ii is an accretivity condition and is more general than its coercive counter part used in our treatment of the sturm liouville problem in the preceding chapter under the assumptions i and ii a bounded accretive form aa on both v h 10 d in the case of dirichlet boundary conditions and v h 1 d in the case of neumann boundary conditions can be defined by aa u v d a u vdx u v v the operator on l 2 d associated with aa is usually denoted by div a in recognition of the fact that at least formally the hilbert space adjoint of equals div the operator div a is often referred to as a second order differential operator in divergence form this operator is selfadjoint if the coefficients satisfy the symmetry condition ai j a ji 12 4 the poisson problem revisited we now revisit the poisson problem u f by viewing it as a special instance of the abstract problem au x where a is assumed to be a closed operator acting in a banach space x x x is a given element and u x is the unknown one could define a classical solution as an element u d a such that au x but this is not what we did in section 11 2 instead we considered weak solutions defined in terms of the sesquilinear form with which a is 416 forms associated a third option is to use duality to define a scalar solution to be an element u x with the property that u a x x x x d a in line with standard functional analytic terminology it would be more appropriate to call this a weak solution but the usage of the term weak solution in connection with integration by parts using test functions is well established proposition 12 21 let a be a densely defined closed linear operator on a banach space x and let x x be a given element for an element u x the following assertions are equivalent 1 u is a classical solution of au x that is u d a and au x 2 u is a scalar solution of au x that is u a x x x for all x d a if x h is a hilbert space and a is the operator associated with a form a on a contin uously and densely embedded hilbert space v then 1 and 2 are equivalent to 3 u is a weak solution of au x that is u v and a u v x v for all v v proof the implications 1 2 and 1 3 are trivial the implication 2 1 is an immediate consequence of proposition 10 20 finally if 3 holds then by the defi nition of the associated operator we have u d a and au x so 1 holds in the special case where a is the dirichlet or neumann laplacian proposition 12 21 implies that every weak solution of the poisson problem u f with f l 2 d is in fact a strong solution in view of the domain identifications 12 13 and 12 15 this recovers the maximal regularity results of theorems 11 37 and 11 44 for the sake of completeness we also mention a maximal regularity result for the poisson problem on u f on the full space rd theorem 12 22 maximal regularity for rd let f l 2 rd if u is a weak solution of the poisson problem u f on rd then u h 2 rd proof if u is a weak solution an integration by parts gives that u admits a weak lapla cian the result now follows from theorem 11 29 12 5 weyl s theorem this section is a digression from the main line of development and is dedicated to a proof of weyl s celebrated asymptotic formula for the number of eigenvalues of dirich let laplacian 12 5 weyl s theorem 417 12 5 a spectrum of the dirichlet and neumann laplacians as a warm up we compute the spectrum of dir and neum in l 2 0 1 example 12 23 both dir and neum are positive and selfadjoint as operators in l 2 0 1 by theorem 12 20 and their spectrum is contained in 0 by theorem 12 17 we will use the fact that every u c 2 0 1 is included in their domains that the laplacians of such a function u are given by taking classical second derivatives pointwise and that a function u c 2 0 1 belongs to h 10 0 1 if and only if u 0 u 1 0 we leave the elementary proof to the reader see problem 11 2 for a more precise result the functions un sin n n 1 satisfy dirun u n 2 n 2 un and obey dirichlet boundary conditions moreover by theorem 3 30 these functions form an orthonormal basis for l 2 0 1 by proposition 10 32 this implies dir 2 n 2 n 1 2 with eigenfunctions un sin n likewise the functions vn cos n n 0 satisfy neumun u n 2 n 2 un and obey neumann boundary conditions again by theorem 3 30 and form an orthonormal basis for l 2 0 1 this implies neum 2 n 2 n 0 1 2 turning to higher dimensions begin with a simple observation proposition 12 24 let d be a nonempty bounded open subset of rd 1 dir is both injective and surjective and hence invertible 2 if in addition d is connected and has c 1 boundary the null space of neum consists of the constant functions and its range is the orthogonal complement of the constant functions in particular its range is closed and dimn neum codimr neum 1 extending the corresponding definition for bounded operators a fredholm operator is a closed operator whose null space is finite dimensional and whose range has finite codimension with the same proof as in the bounded case the second condition implies that the range is closed the index of such an operator a is defined as ind a dimn a codimr a proposition 12 24 implies that both dir and neum the latter under the stated more restrictive assumptions on d are fredholm operators with index 0 proof 1 if diru 0 for some u d dir then u h 10 d and u is a classical solution and hence a weak solution of the dirichlet poisson problem with f 0 by 418 forms the uniqueness of weak solutions it follows that u 0 likewise surjectivity follows from the existence of weak solutions for any f l 2 d combined with proposition 12 21 according to which weak solutions are strong solutions 2 this is proved in the same way using that the problem u f with neumann boundary conditions has a weak solution for a given f l 2 d if and only if d f dx 0 and that uniqueness of weak solutions holds in h 1 av d u h 1 d d udx 0 for the proof of the next theorem we isolate a lemma that will also be useful in the next chapter lemma 12 25 let a be a closed operator on a banach space x with nonempty resol vent set and suppose that r 0 a is compact for some 0 a then 1 for all a the resolvent operator r a is compact 2 for all a the following spectral mapping theorem holds r a 0 1 a 3 every a is an eigenvalue with finite multiplicity 4 for all a the eigenspace of the eigenvalue for a and the eigenspace of the eigenvalue 1 for r a coincide 5 a is either finite or it is a sequence diverging to proof once 1 and 2 have been established 3 5 are easy consequences of the riesz schauder theorem for compact operators theorem 7 11 1 this is immediate from the resolvent identity 2 fix a let r a 0 by the riesz schauder theorem is an eigenvalue for r a if r a x x with x d a then x a x and ax 1 x x with 1 it follows that is an eigenvalue of a and 1 let a if we had 1 r a then by elementary computation it would follow that a and r a 1 r a r 1 r a this contra diction shows that 1 r a 3 and 4 for all x x and a we have x d a and ax x r a x 1 x this gives 4 by 1 and the riesz schauder theorem r a 0 consists of eigenvalues of finite multiplicity if a then 1 is an eigenvalue for r a of finite multiplicity by 2 and then 2 and 4 show that is an eigenvalue for a of the same finite multiplicity 12 5 weyl s theorem 419 5 if a is an infinite set then so is r a by the riesz schauder theorem r a can only accumulate at 0 so a can only accumulate at infinity theorem 12 26 let d be a nonempty bounded open subset of rd then 1 the spectrum of dir is of the form dir 1 2 with 0 1 2 2 if in addition d has c 1 boundary the spectrum of neum is of the form neum 1 2 with 0 1 2 in either case each j is an eigenvalue with finite dimensional eigenspace proof let a dir in the case of dirichlet boundary conditions or a neum in the case of neumann boundary conditions we claim that under the respective assumptions on d the resolvent operators r a are compact for all a to prove the claim we recall that d a is contained in v h 10 d in the case of dirichlet boundary conditions respectively in v h 1 d in the case of neumann boundary conditions by the rellich kondrachov theorem theorem 11 41 in either case the inclusion mapping from v into l 2 d is compact the compactness of r a now follows by viewing it as the composition of three bounded operators one of which is compact i r a viewed as a bounded operator from l 2 d to d a ii the inclusion mapping from d a into v which is bounded by the closed graph theorem the closedness of a and the boundedness of the inclusion mappings from both d a and v into l 2 d and iii the compact inclusion mapping from v into l 2 d since a is positive and selfadjoint by theorem 12 20 we have a 0 by proposition 10 40 by proposition 12 24 we have 0 dir and 0 neum the result now follows from lemma 12 25 as a variation on the min max theorem for compact positive hilbert space operators theorem 9 4 we prove an explicit formula for the dirichlet and neumann eigenvalues of the laplace operator on a nonempty bounded open set d rd in the case of neu mann boundary conditions we make the additional assumption that d is connected and has c 1 boundary we denote by 0 1 6 2 6 and 0 1 6 2 6 the sequences of eigenvalues of dir and neum respectively taking multiplicities into account theorem 12 27 courant fischer with the notation just introduced 1 for all n 1 we have n inf y h 10 d dim y n sup y y y 6 0 y 2 l 2 d y 2 l 2 d 420 forms where the infima are taken over all subspaces y of dimension n 2 if in addition d has a c 1 boundary then for all n 1 we have n inf y h 1 d dim y n sup y y y 6 0 y 2 l 2 d y 2 l 2 d where the infima are taken over all subspaces y of dimension n proof we present the case of dirichlet eigenvalues the proof for neumann eigenval ues being entirely similar the zero eigenvalue 1 does not create difficulties since it has multiplicity 1 here we use the connectedness assumption we write dir and choose an orthonormal basis h j j 1 in l 2 d such that h j jh j for all j 1 as was shown in the proof of theorem 12 26 such a se quence exists by the spectral theorem applied to the compact positive operator 1 this theorem also implies that the span of this sequence is dense in l 2 d for n 1 let hn 1 f h 10 d f h j 0 j 0 n 1 with the convention that h 0 h 10 d step 1 fix f l 2 d and set fn nj 1 c jh j with c j f h j since h j j 1 is an orthonormal bases for l 2 d we have fn f in l 2 d as n clearly f fn fn in l 2 d we claim that if f h 10 d then also f fn fn in h 10 d in view of g g h 10 d g g g g g g h 10 d 12 16 this amounts to showing that f fn fn 0 for all j k 1 we have h j hk h j hk j h j hk j jk and therefore fn fn n j 1 c j 2 j also for j 1 we have j 0 and f h j f h j j f h j c j j and therefore f fn n j 1 c j f h j n j 1 c j c j j n j 1 c j 2 j 12 17 12 5 weyl s theorem 421 it follows that f fn fn n j 1 c j 2 j n j 1 c j 2 j 0 this proves the claim by what we just proved f 2 f fn 2 fn 2 fn 2 this shows that the sequence fn n 1 is bounded in h 10 d by proposition 3 16 some subsequence fnk k 1 converges weakly to a limit f in h 1 0 d since also fn f in l 2 d we must have f f thus fnk f weakly in h 1 0 d by 12 16 this implies fnk f weakly in l 2 d by 12 17 it then follows that f 2 lim k f fnk limk nk j 1 c j 2 j j 1 c j 2 j 12 18 step 2 let y h 10 d be any subspace of dimension n since hn 1 has codimen sion n 1 in h 10 d the intersection hn 1 y is a nonzero subspace of h 1 0 d and hence contains a nonzero element f applying the results of step 1 to f and noting that f h j c j 0 for j 1 n 1 by 12 18 we have f 2 j n j c j 2 n j n c j 2 n f 2 this proves the inequality n 6 inf y h 10 d dim y n sup y y y 6 0 y 2 y 2 step 3 if f belongs to the span of h 1 hn then by 12 18 f 2 n j 1 c j 2 j 6 n j 1 c j 2 n f 2 this proves the inequality n inf y h 10 d dim y n sup y y y 6 0 y 2 y 2 this completes the proof corollary 12 28 for all n 1 we have n 6 n 422 forms 12 5 b weyl s theorem the following celebrated theorem of weyl gives an asymptotic expression for the num ber of dirichlet eigenvalues in the interval 0 r as r theorem 12 29 weyl let d be a nonempty bounded open subset of rd satisfying d 0 let 0 1 2 the sequence of eigenvalues of dir on l 2 d taking multiplicities into account and for r 0 let nd r max n 1 n 6 r then lim r nd r rd 2 d 2 d d where d d 2 1 1 2 d is the volume of the unit ball in r d the condition d 0 is satisfied if the boundary is a rectifiable curve before turning to the proof it is instructive to revisit example 12 23 for the dirichlet laplacian in l 2 0 1 we obtain nd r max n 1 2 n 2 6 r on the other hand 1 1 1 2 and d 0 1 1 it follows that lim r nd r r 1 2 1 1 2 d 2 2 1 1 the main lemma needed for the proof of weyl s theorem is a monotonicity result lemma 12 30 let d 1 and d 2 be nonempty bounded open subsets of rd with d 1 d 2 then the corresponding dirichlet eigenvalues taking multiplicities into account satisfy n d 1 n d 2 n 1 as a consequence nd 1 r 6 nd 2 r for all r 0 proof this follows from the courant fischer theorem observing that zero extensions of functions in h 10 d 1 belong to h 1 0 d 2 the analogue of this lemma fails for neumann boundary conditions it is for this reason that we only present weyl s theorem for dirichlet eigenvalues the case of neu mann boundary conditions is discussed in the notes to this chapter proof of theorem 12 29 for an open subset u ofrd we denote the dirichlet laplacian in l 2 u by u step 1 the theorem is true if d dj 1 a j b j is an open rectangle to prove this 12 5 weyl s theorem 423 there is no loss of generality in assuming that a j 0 for all j 1 d by the results of example 12 23 and section 3 5 c the eigenfunctions for d are the functions un x d j 1 sin n j x j b j x x 1 xd d 12 19 where n n 1 nd with each n j in n 1 n n n 1 the corresponding eigen values are the positive real numbers n 2 d j 1 n 2 j b 2 j hence nd r n nd 1 d j 1 n 2 j b 2 j 6 r 2 as r this is asymptotic to 2 d drd 2 d dj 1 b j namely a fraction 1 2 d the positive quadrant of the area enclosed by the ellipse dj 1 x 2 j b 2 j r 2 thus lim r nd r rd 2 d 2 d d j 1 b j 1 since dj 1 b j equals the area of d this is precisely what we wanted to prove step 2 if u 1 and u 2 are disjoint open subsets of rd and u u 1 u 2 is their union then for all r 0 we have nu r nu 1 r nu 2 r 12 20 indeed f l 2 u is an eigenfunction for u then for j 1 2 the restriction f u j is either an eigenfunction for u j with the same eigenvalue or else it vanishes almost everywhere on u j if the first alternative happens for both j 1 2 then f contributes 2 to nr r since we count multiplicities and f u j contributes 1 to nr j r for j 1 2 if the second alternative happens for either j 1 or j 2 both cannot happen for this would imply that f vanishes almost everywhere on u then f contributes 1 to nr r and one of the f u j contributes 1 to nr j r and the other one contributes 0 in the converse direction if f j l 2 r j is an eigenfunction for the dirichlet lapla cian on r j then its zero extension to r is an eigenfunction for the dirichlet laplacian on r this contributes 1 to nr r and 1 to nr j r step 3 by steps 1 and 2 applied inductively the theorem holds for finite unions of open rectangles hence if r 1 rk are disjoint open rectangles contained in d and r denotes their union then by lemma 12 30 d 2 d r lim r nr r rd 2 6 liminf r nd r rd 2 424 forms approximating d from within by such finite unions we obtain d 2 d d 6 liminf r nd r rd 2 12 21 let 0 be so large that d d by the same reasoning d 2 d d d 6 liminf r n d d r rd 2 12 22 using step 1 12 20 12 21 and 12 22 and the assumption d 0 we obtain d 2 d 2 r d lim r n d r rd 2 liminf r nd r rd 2 liminf r n d d r rd 2 d 2 d d d d d 2 r d 2 d 12 23 it follows that we have equality throughout hence using 12 20 and step 1 once more d 2 r d 2 d liminf r nd r rd 2 liminf r n d d r rd 2 liminf r nd r rd 2 d 2 d 2 r d limsup r nd r rd 2 and therefore the limit inferior and the limit superior are equal it follows that the limit limr nd r rd 2 exists finally if we had strict inequality 12 21 that is if d 2 d d liminf r nd r rd 2 then in 12 23 the second inequality would be strict if one imagines a bounded open set d in rd as a drum the eigenvalues of the neg ative dirichlet laplacian on l 2 d can be interpreted as the frequencies of the drum this prompted the famous question of mark kac can one hear the shape of a drum in its mathematical formulation the question is whether the shape of d up to an isom etry of rd is determined by its sequence of frequencies without further assumptions on d in general the answer is negative nevertheless weyl s theorem implies that the volume d of d can be recovered from the spectrum problems 12 1 let i v h be a gelfand triple and let a be the linear operator in h associated with a bounded accretive form a on v prove that the inclusion mapping from d a into v is bounded problems 425 12 2 let i v h be a gelfand triple a form a on v is said to be elliptic if there exist 0 and 0 such that rea v v v 2 v 2 v v v a show that the form a on v is elliptic if and only if the form a u v a u v u v u v v is coercive on v b prove a version of corollary 12 13 for operators a associated with an elliptic form a on v 12 3 let i v h be a gelfand triple let a be a coercive form on v and let b l v h be bounded show that the form ab on v defined by ab u v a u v bu v u v v is bounded and elliptic 12 4 revisiting the conditions imposed in the treatment of the sturm liouville prob lem in section 11 3 b let d rd be open and bounded and let a d md c be a function with bounded measurable coefficients such that re d i j 1 ai j x i j 2 cd for some 0 and almost all x d let b d kd have bounded measurable coefficients and let b d k be bounded and measurable show that the form a u v d a u vdx d b uvdx d cuvdx u v h 10 d is elliptic 12 5 prove that the form a constructed in the proof of proposition 12 16 has the fol lowing minimality property if a v v c is a closed form extending the continuous accretive form a then a extends a 12 6 prove the following facts for d 1 and d a b a d dir f h 2 d f a f b 0 b d neum f h 2 d f a f b 0 12 7 let v be a hilbert space let a v v k be a bounded coercive form and let l v k be a bounded functional a show that the energy functional e x 1 2 a x x rel x is bounded from below 426 forms fix a nonempty closed convex subset c of v b let xn n 1 be a sequence in c such that lim n e xn inf x c e x e prove that this sequence is cauchy in v hint the convexity of c implies that 12 xn xm c then use the identity e 1 2 xn xm 1 2 e xn 1 2 e xm 1 8 a xn xm xn xm c prove that x limn xn is the unique element of c minimising e d compare this result with problem 11 31 12 8 we take a look at example 12 23 from a calculus perspective a for which r does the problem u u on 0 1 u 0 u 1 0 admit a c 2 solutions for these values of find all c 2 solutions b do the same for neumann boundary conditions u 0 u 1 0 c explain why this is not enough to determine the spectra of the dirichlet and neumann laplacians in l 2 0 1 12 9 provide the details of the proof that all dirichlet eigenfunctions on a cube are given by 12 19 13 semigroups of linear operators in this chapter we set up a functional analytic framework for the study of linear and non linear initial value problems this includes the treatment of parabolic problems such as the heat equation and hyperbolic problems such as the wave equation from the operator theoretic perspective the main challenge is to arrive at a thorough understand ing of linear equations this is achieved through the theory of c 0 semigroups developed in the present chapter once this is done nonlinear equations are handled by perturba tion techniques 13 1 c 0 semigroups linear equations of mathematical physics describing systems involving time evolution can often be cast in the abstract form u t au t f t u t t 0 t u 0 u 0 where the unknown is a function u from the time interval 0 t into a banach space x the operator a is a linear usually unbounded operator acting in x f 0 t x x is a given function and the initial value u 0 is assumed to be an element of x this initial value problem is referred to as the abstract cauchy problem associated with a and f in applications typically x is a banach space of functions suited for the particular problem and a is a partial differential operator for instance for the heat equation on a bounded open set d of rd subject to dirichlet boundary conditions one could choose x l 2 d and take a to be the dirichlet laplacian studied in the previous chapter this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 427 428 semigroups of linear operators if a is a bounded operator the unique solution u of the linear abstract cauchy problem u t au t t 0 t u 0 u 0 acp is given by u t etau 0 n 0 tn n anu 0 t 0 t the operators eta may be thought of as solution operators mapping the initial value u 0 to the solution etau 0 at time t for unbounded operators a this simple strategy does not work since we run into convergence and domain issues in the case of selfadjoint operators a and more generally normal operators a acting in a hilbert space one could instead use the functional calculus of chapter 10 to define the exponentials eta this would still limit the scope and applicability of the theory considerably in order to set up a more general and flexible framework we take a more abstract approach which is motivated by the properties of the exponentials eta for bounded operators a they satisfy e 0 a i and etaesa e t s a and the mapping t 7 eta is continuous with respect to the operator norm 13 1 a definition and general properties throughout this chapter x is a banach space and h is a hilbert space the preceding discussion suggests the following definition definition 13 1 c 0 semigroups a family s s t t 0 of bounded operators acting on x is called a c 0 semigroup if the following three properties are satisfied s 1 s 0 i s 2 semigroup property s t s s s t s for all t s 0 s 3 strong continuity limt 0 s t x x 0 for all x x its infinitesimal generator or briefly the generator is the linear operator a defined by d a x x lim t 0 1 t s t x x exists in x ax lim t 0 1 t s t x x x d a the idea is to interpret the orbit u t s t u 0 as the solution of the linear problem acp to find a precise way to make this idea 13 1 c 0 semigroups 429 rigorous and to subsequently cover also nonlinear initial value problems is among the main objectives of this chapter remark 13 2 strong convergence versus uniform convergence the properties of eta suggest replacing s 3 by the stronger condition limt 0 s t i 0 as it turns out however this condition forces the generator a to be bounded see problem 13 2 this renders the theory useless as it would fail to cover equations in which a is a differen tial operator acting in banach space x of functions in a sense the strong convergence imposed in s 3 is also more natural as it gives the continuity with respect to the norm of x of the solution u t s t u 0 see proposition 13 4 the next two propositions collect some elementary properties of c 0 semigroups and their generators proposition 13 3 let s be a c 0 semigroup on x there exist m 1 and r such that s t 6 me t for all t 0 proof there exists a number 0 such that supt 0 s t indeed oth erwise we could find a sequence tn 0 such that limn s tn by the uniform boundedness theorem this implies the existence of an x x such that supn 1 s tn x contradicting the strong continuity assumption s 3 by the semigroup property s 2 for t k 1 k it follows that s t 6 k 6 1 t where the second inequality uses that 1 by s 1 this proves the proposi tion with m and 1 log we will frequently use the trivial observation that if a generates the c 0 semigroup s t t 0 then for all scalars the linear operator a generates the c 0 semigroup e ts t t 0 for this rescaled semigroup has exponential decay in operator norm proposition 13 4 let s be a c 0 semigroup on x with generator a the following as sertions hold 1 for all x x the orbit t 7 s t x is continuous for t 0 2 for all x d a the orbit t 7 s t x is continuously differentiable for t 0 we have s t x d a and d dt s t x as t x s t ax t 0 3 for all x x and t 0 we have t 0 s s xds d a and a t 0 s s xds s t x x and if x d a then both sides are equal to t 0 s s axds 430 semigroups of linear operators 4 the generator a is a densely defined closed operator proof the proof uses the calculus rules for banach space valued riemann integrals proposition 1 45 1 right continuity of t 7 s t x follows from the right continuity at t 0 s 3 and the semigroup property s 2 for left continuity observe that by the semigroup property for 0 h t we have s t x s t h x 6 s t h s h x x 6 sup s 0 t s s s h x x where the supremum is finite by proposition 13 3 2 fix x d a by the semigroup property we have lim h 0 1 h s t h x s t x s t lim h 0 1 h s h x x s t ax this proves all assertions except left differentiability for t 0 we note that lim h 0 1 h s t h x s t x lim h 0 s t h 1 h s h x x s t ax where we used that x d a and the fact that the convergence limh 0 s t h y s t y for all y x implies convergence uniformly on compact sets by proposition 1 42 3 the first identity follows from lim h 0 1 h s h i t 0 s s xds lim h 0 1 h t 0 s s h xds t 0 s s xds lim h 0 1 h t h t s s xds h 0 s s xds s t x x where we first did a substitution and then used the continuity of t 7 s t x the identity for x d a follows by integrating the identity of part 2 or by noting that lim h 0 1 h s h i t 0 s s xds lim h 0 1 h t 0 s s 1 h s h x x ds t 0 s s axds where the convergence under the integral is justified by the fact that the convergence of the difference quotients 1 h s h x x to ax implies uniform convergence of the inte grands on 0 t 4 denseness of d a follows from 1 and the first part of 3 for any x x the latter implies that t 0 s s xds d a for all t 0 while the former implies that limt 0 1 t t 0 s s xds x to prove that a is closed we must check that the graph g a x ax x d a 13 1 c 0 semigroups 431 is closed in x x suppose that xn n 1 is a sequence in d a such that limn xn x and limn axn y in x then by the second part of 3 1 h s h x x lim n 1 h s h xn xn lim n 1 h h 0 s s axn ds 1 h h 0 s s yds passing to the limit for h 0 this gives x d a and ax y we have just seen that the generator of a c 0 semigroup is always densely defined and closed as a consequence of the latter d a is a banach space with respect to its graph norm in various applications it is of interest to know when a subspace y which is dense in x and contained in d a is dense as a subspace of d a if this is the case y is called a core for a the next result gives a simple sufficient condition proposition 13 5 let s be a c 0 semigroup with generator a on x if y is a subspace of d a which is dense in x and invariant under each operator s t t 0 then y is dense in d a proof the operator a is the generator of the c 0 semigroup e ts t t 0 hence by the exponential boundedness of s replacing a by a for sufficiently large 0 we may assume that limt s t 0 fix x d a and choose a sequence yn n 1 in y such that limn yn ax in x fix t 0 then lim n t 0 s s yn ds t 0 s s axds s t x x in x and lim n a t 0 s s yn ds lim n s t yn yn s t ax ax it follows that lim n t 0 s s yn ds s t x x in d a the identity s t x x d a s t x x s t ax ax implies that the restriction of s to d a is strongly continuous with respect to the graph norm of d a and for this reason we may approximate the integrals by riemann sums in the norm of d a by the invariance of y under s these riemann sums belong to y it follows that for each t 0 and 0 there is a yt y such that s t x x yt d a as t s t x d a s t x s t ax 0 and therefore for large enough t 0 yt x d a 6 s t x d a 2 432 semigroups of linear operators this shows that x can be approximated in d a by elements of y this proposition is often helpful in determining the domain of the generator explicitly when the semigroup is given see for instance section 13 6 b the proof of the next proposition uses the following version of the product rule it is proved in the same way as the product rule in calculus uniform convergence on compact sets follows from proposition 1 42 lemma 13 6 let i r be an open interval and let s i l x and t i l x be strongly continuous functions let t 0 i and x x be fixed if i t 7 s t x is differentiable at t 0 with derivative d dt t t 0 s t x s t 0 x ii t 7 t t s t 0 x is differentiable at t 0 with derivative d dt t t 0 t t s t 0 x t t 0 s t 0 x then t 7 t t s t x is differentiable at t 0 with derivative d dt t t 0 t t s t x t t 0 s t 0 x t t 0 s t 0 x proof for t i t 0 we have t t s t x t t 0 s t 0 x t t 0 t t s t x t t s t 0 x t t 0 t t s t 0 x t t 0 s t 0 x t t 0 i ii by assumption ii tends to t t 0 s t 0 x as t t 0 concerning i fix 0 small enough so that t 0 t 0 is contained in i set it 0 t 0 t 0 t 0 t 0 and consider the relatively compact set ct 0 s t x s t 0 x t t 0 s t 0 x t it 0 for t it 0 we have t t s t x t t s t 0 x t t 0 t t 0 s t 0 x 6 t t s t x s t 0 x t t 0 s t 0 x t t t t 0 s t 0 x 13 1 c 0 semigroups 433 6 sup y ct 0 t t y t t 0 y t t 0 s t x s t 0 xt t 0 s t 0 x t t t t 0 s t 0 x the strong continuity of t and the fact that strong convergence implies strong conver gence on compact sets imply that the first and third terms on the right hand side tend to 0 as t t 0 the second term tends to 0 by the assumptions on s a c 0 semigroup is uniquely determined by its generator proposition 13 7 if a is the generator of the c 0 semigroups s and t then s t t t for all t 0 proof by lemma 13 6 for all t 0 and x d a the function t s s t s t s x is continuously differentiable on 0 t with derivative t s as t s t s x s t s at s x 0 and therefore t is constant by proposition 1 45 hence s t x t 0 t t t t x this being true for all x in the dense subspace d a of x it follows that s t t t the next proposition identifies the resolvent of the generator as the laplace transform of the semigroup proposition 13 8 let a be the generator of a c 0 semigroup s on x and fix constants m 1 and r such that s t 6 me t for all t 0 then c re a and on this set the resolvent of a is given by r a x 0 e ts t xdt x x as a consequence for re we have r a 6 m re proof fix x x and define r x 0 e ts t xdt using the semigroup property s 2 and a substitution we obtain the identity lim h 0 1 h s h i r x lim h 0 1 h eht h e ts t xdt 0 e ts t xdt lim h 0 eht 1 h h e ts t xdt lim h 0 1 h h 0 e ts t xdt r x x from which it follows that r x d a and ar x r x x this shows that the bounded operator r is a right inverse for a 434 semigroups of linear operators integrating by parts and using that ddt s t x s t ax for x d a we obtain for x d a t 0 e ts t xdt e t s t x x t 0 e ts t axdt since re sending t gives r x x r ax this shows that r is also a left inverse the estimate for the resolvent follows from 0 e ts t xdt 6 0 e re t s t x dt 6 m x 0 e re t dt m re x combining this result with proposition 10 30 we obtain the result that a c 0 semigroup is determined by its generator proposition 13 9 if a and b generate c 0 semigroups on x and if b is an extension of a then a b proof proposition 13 8 implies that the resolvent sets of a and b share a common half plane the equality a b then follows from proposition 10 30 for operators satisfying the resolvent estimate of proposition 13 8 we have the fol lowing convergence result proposition 13 10 let a be a densely defined closed operator acting in x and suppose that for some r we have a and r a 6 m then for all x x we have lim r a x x proof first let x d a and fix an arbitrary a then x r a y for y a x by the resolvent identity and the above estimate on the resolvent we obtain lim r a x lim r a r a y lim r a r a y r a y x for general x x the claim then follows by approximation with elements from d a using the uniform boundedness of the resolvent for re 1 13 1 c 0 semigroups 435 the final result of this section gives a useful sufficient condition for a semigroup of operators to be strongly continuous we need the following terminology a family of bounded operators s s t t 0 on x is said to be a weakly continuous semigroup if conditions s 1 and s 2 in definition 13 1 hold and s 3 is replaced by the condition that for all x x and x x one has limt 0 s t x x x x theorem 13 11 phillips every weakly continuous semigroup is strongly continuous proof let x 0 x x lim t 0 s t x x 0 it is evident that x 0 is a linear subspace of x we wish to show that x 0 x by proposition 5 5 the family s t x 0 6 t 6 1 is uniformly bounded for every x x and by the uniform boundedness theorem theorem 5 2 this implies that the family s t 0 6 t 6 1 is uniformly bounded a first consequence is that x 0 is a closed subspace of x next we note that the weak continuity of t 7 s t x along with the fact that closed subspaces are weakly closed proposition 4 42 implies that each orbit t 7 s t x is contained in a separable closed subspace of x it follows that we can apply the pettis measurability theorem theorem 4 19 and conclude that every orbit t 7 s t x is strongly measurable it follows from these considerations that the bochner integrals xt 1 t t 0 s s xds are well defined fix x x and 0 t 12 for 0 s t s s xt xt 1 t t 0 s s r xdr t 0 s r xdr 1 t t s t s r xdr s 0 s r xdr 6 2 s 1 t sup 06 r 61 s r x this shows that x t x 0 suppose now for a contradiction that x 0 6 x then there exists an x x x 0 and by the hahn banach theorem we can find an x x which vanishes on x 0 but not on x then with xt 1 t t 0 s s xds as before 0 lim t 0 xt x lim t 0 1 t t 0 s s x x ds x x 6 0 a contradiction 13 1 b c 0 groups instead of considering only forward time we could also include backward time this leads to the notion of a c 0 group 436 semigroups of linear operators definition 13 12 c 0 groups a c 0 group is a family s s t t r of bounded opera tors acting on x with the following properties g 1 s 0 i g 2 s t s s s t s for all t s r g 3 limt 0 s t x x 0 for all x x its infinitesimal generator or briefly its generator is the linear operator a defined by d a x x lim t 0 1 t s t x x exists ax lim t 0 1 t s t x x x d a it is evident from the definition that if a generates a c 0 group s t t r then both s t t 0 and s t t 0 are c 0 semigroups denoting their generators by a and a it is evident that d a d a d a and that for all x d a we have ax a x a x in fact more is true proposition 13 13 a linear operator a in x generates a c 0 group s t t r if and only if both a and a generate c 0 semigroups these semigroups are s t t 0 and s t t 0 respectively proof if a generates a c 0 group s t t r and x d a then lim t 0 1 t s t x x a x lim t 0 1 t s 1 1 1 t s s a xds a x 0 since also limt 0 1 t s t x x a x it follows that x d a and ax a x in com bination with the inclusion d a d a it follows that d a d a and therefore a a in the same way one proves that d a d a and a a for the converse suppose that a and a generate c 0 semigroups s t t 0 and s t t 0 respectively by lemma 13 6 for x d a d a the function t 7 s t s t x is continuously differentiable and d dt s t s t x as t s t x s t as t x 0 where we used that s t commutes with a it follows from proposition 1 45 that the function t 7 s t s t x is constant and evaluation at t 0 shows that s t s t x x for all t 0 since d a is dense this identity extends to arbitrary x x this proves that s t is a left inverse for s t interchanging the roles of s t and s t we find that s t is also a right inverse for s t as a result s t is invertible and s t 1 s t for all t 0 for t r define s t s t t 0 s t t 0 13 1 c 0 semigroups 437 with what we have proved it is trivial to verify that s t t 0 is a c 0 group and that a is its generator proposition 13 8 applied to the semigroups generated by a implies corollary 13 14 if a generates a uniformly bounded c 0 group on x then a ir the spectrum of the generator of a c 0 semigroup may be empty an example is given in problem 13 4 this is contrasted by the second part of the following result for a uniformly bounded c 0 group s on x and f l 1 r we define s f l x by s f x f t s t xdt x x 13 1 theorem 13 15 if a generates a uniformly bounded c 0 group s on x then 1 if the fourier transform of a function f l 1 r is compactly supported and van ishes in a neighbourhood of i a then s f 0 2 if x 6 0 then a 6 proof 1 for all 0 and s r we have is a and for all x x we have the identities r is a x 0 e is ts t xdt and r is a x r is a 0 e is ts t xdt hence by dominated convergence fourier inversion theorem 5 21 fubini s theorem and propositions 13 8 and 13 13 s f x lim 0 e t f t s t xdt 1 2 lim 0 e t eist f s ds s t xdt 1 2 lim 0 f s e t eists t xdt ds 1 2 lim 0 f s r is a r is a xds by dominated convergence this identity immediately implies 1 2 suppose that a the result of part 1 implies that s f 0 for all f l 1 r whose fourier transform has compact support we claim that such func tions are dense in l 1 r to see this fix an arbitrary nonzero function c c r its inverse fourier transform belongs to l 1 r since k l 1 r implies that 438 semigroups of linear operators x k x is bounded for all k n since is nonzero by the injectivity of the in verse fourier transform after multiplying with an appropriate scalar we may assume that r dx 1 by proposition 2 34 we then have lim 0 f f in l 1 r where x d 1 x and the fourier transforms f 2 f are compactly sup ported this proves the claim by approximation we obtain that s f 0 for all f l 1 r in particular taking f 0 t e t for t 0 and f 0 t 0 for t 0 proposition 13 8 implies that r 1 a s f 0 0 since r r 1 a d a is dense in x this implies that x 0 we will use this theorem to give a proof of wiener s tauberian theorem theorem 5 22 recall that this theorem asserts that if the fourier transform of a function f l 1 r is zero free then the span of the set of all translates of f is dense in l 1 r we start with some preparations if s is a uniformly bounded c 0 group on a banach space x we define is f l 1 r s f 0 where s f is given by 13 1 the arveson spectrum of s is the set sp s r f 0 for all f is the key to proving wiener s tauberian theorem is the following result which is of independent interest theorem 13 16 let s be a uniformly bounded c 0 group s with generator a on x then sp s i a proof first let r satisfy 6 i a noting that a ir we choose a function f l 1 r whose fourier transform is compactly supported and vanishes in a neigh bourhood of i a but not on by theorem 13 15 s f 0 so f is but then f 6 0 implies that 6 sp s conversely let i a since a ir and since the topological boundary of a is always contained in the approximate point spectrum see section 10 1 c where it was observed that the corresponding result for bounded operators proposition 6 17 extends to unbounded operators i is contained in the approximate point spectrum of a hence we may choose a sequence xn n 1 of norm one vectors in x with xn d a for all n 1 such that limn axn i xn 0 in view of s t xn e i txn t 0 ei ss s a i xn ds 0 as n xn n 1 is an approximate eigensequence of s t with approximate eigenvalue e i t let f l 1 r by dominated convergence lim n f t s t xn e i txn dt 0 13 2 the hille yosida theorem 439 thus using that xn 1 s f lim n s f xn lim n f t s t xn dt e i t f t dt f this inequality implies that f 0 for all f is therefore sp s the right translation group is the c 0 group u u t t r on l 1 r defined by u t f s f s t s t r note that u f g f g for all f g l 1 r where denotes convolution we are now ready for the proof of wiener s tauberian theorem proof of theorem 5 22 let f l 1 r be a function whose fourier transform is zero free and let x span u t f t r we wish to prove that x l 1 r consider the quotient space y l 1 r x and let uy uy t t r denote the associated quo tient translation group on y this group is strongly continuous and bounded for all g l 1 r we have u f g f g g f u g f by the translation invariance of x u g f x hence u f g x so uy f g x 0 for all g l 1 r it follows that uy f 0 on the other hand by assumption we have f 6 0 for all r therefore sp uy we conclude that y 0 and x l 1 r 13 2 the hille yosida theorem the main generation theorem for c 0 semigroups is the hille yosida theorem which gives necessary and sufficient conditions in terms of resolvent growth we only need the version for contraction semigroups which is somewhat easier to state and prove its extension to general semigroups can be done via the same reductions that will be used in the proof of theorem 13 18 see problem 13 1 theorem 13 17 hille yosida for a densely defined closed linear operator a in x the following assertions are equivalent 1 a generates a c 0 semigroup of contractions on x 2 c re 0 a and r a 6 1 re re 0 3 r 0 a and r a 6 1 0 440 semigroups of linear operators proof the implication 1 2 follows from propositions 13 4 and 13 8 and the im plication 2 3 is trivial assume now that 3 holds for the bounded operators an nar n a n 2 r n a ni n 1 proposition 13 10 implies limn anx ax for all x d a also etan 6 en 2 r n a te nt 6 ente nt 1 13 2 fix x d a and t 0 the identity etanx etamx t 0 d ds e t s amesanx ds t 0 e t s amesan anx amx ds and the contractivity estimate 13 2 imply etanx etamx 6 t anx amx and therefore etanx n 1 is cauchy in x for all x d a hence the limit s t x limn etanx exists for all x d a by the uniform boundedness of the operators etan guaranteed by 13 2 this limit in fact exists for all x x moreover for each t 0 the resulting mapping x 7 s t x is linear and contractive it remains to verify that the contractions s t t 0 form a c 0 semigroup on x and that a is its generator it is clear that s 0 i the semigroup property follows from s t s s x lim n etanesanx lim n e t s anx s t s x using the uniform boundedness of the sequence etan n 1 in the first equality and the properties of the power series of the exponential function in the second next we prove the strong continuity for x d a we have s t x x lim n etanx x lim n t 0 esananxds t 0 s s axds where we used that esananx s s ax 6 esan anx ax esan s s ax 6 anx ax esan s s ax 0 therefore for x d a lim t 0 s t x x lim t 0 t 0 s s axds 0 once again the strong continuity for general x x follows from this by approximation it remains to check that a equals the generator of s which we denote by b by what we have already proved for x d a we have lim t 0 1 t s t x x lim t 0 1 t t 0 s s axds ax 13 2 the hille yosida theorem 441 so x d b and bx ax since both a and b are closed and share a half line in their resolvent sets proposition 10 30 implies that a b as an application we have the following perturbation result theorem 13 18 perturbation let a be the generator of a c 0 semigroup s on x and let b be a bounded operator on x then a b generates a c 0 semigroup on x here it is understood that d a b d a and a b x ax bx for x d a the proof of the theorem shows that if s t 6 me t then sb t 6 me b t proof we prove the theorem in three steps we begin with two reductions step 1 choose m 1 and r such that s t 6 me t for all t 0 the operator a is the generator of the c 0 semigroup e ts t t 0 and this semigroup satisfies e ts t 6 m since a b a b and b is bounded this argument shows that it is enough to prove the theorem for uniformly bounded semigroups step 2 we now assume that the semigroup generated by a is uniformly bounded say by a constant m 1 from x 6 sup t 0 s t x 6 m x it follows that x sup t 0 s t x defines an equivalent norm on x with respect to this norm for all x x we have s s x sup t 0 s s t x 6 sup r 0 s r x x this argument shows that we may assume that our semigroup is a semigroup of con tractions step 3 by the previous two steps it suffices to prove the theorem for generators of contraction semigroups fix c with re 0 then a and r a 6 re 1 because a b i br a a and br a 6 re 1 b for re b the operator i br a is invertible and the neumann series for its inverse gives r a i br a 1 6 re 1 i re 1 b 1 re b 1 442 semigroups of linear operators hence for re b the operator a b is invertible and its inverse satisfies r a b 6 re b 1 the operator a b b is then invertible for re 0 and satisfies a b b 6 re 1 by the hille yosida theorem this operator generates a c 0 semigroup t of contractions then a b generates the c 0 semigroup given by sb t et b t t clearly sb t 6 et b remembering that we made two reductions reversing them gives the estimate given after the statement of the theorem in general there is no closed form expression for sb t but we do have the so called variation of constants identity sb t x s t x t 0 s t s bsb s xds the proof of this identity is simple for x d a d a b using lemma 13 6 we differentiate the function s s t s sb s x using the product rule and get s as t s sb s x s t s a b sb s s t s bsb s x integrating this identity over the interval 0 t gives the required result as a consequence of this identity we see that the norm of the difference is of the order s t sb t o t as t 0 we continue with a useful approximation formula by means of which it is possible to deduce information about the semigroup from information about the properties of the resolvent along the positive real line it will be used later on to prove the positivity of the heat semigroup under dirichlet and neumann boundary conditions to motivate the result we recall euler s formula for the exponential which entails that for all a r and t 0 eta lim n 1 t n a n lim n n t n t a 1 n theorem 13 19 euler s formula let a be the generator of a c 0 semigroup s on x then for all x x and t 0 we have s t x lim n n t r n t a n x proof by proposition 10 28 the resolvent of a is holomorphic with complex derivative given by dd r a r a 2 by induction this implies dn d n r a 1 nn r a n 1 13 3 13 2 the hille yosida theorem 443 on the other hand repeated differentiation under the integral in the laplace transform representation r a x 0 e ss s xds gives dn d n r a x 1 nsn 0 e ss s xds substituting s rt and specialising to n t we obtain dn d n r a x n t 1 ntn 1 0 re r ns rt xdr 13 4 combining 13 3 and 13 4 and using the identity nn 1 n 0 re r n dt 1 13 5 we arrive at n t r n t a n 1 x s t x nn 1 n 0 re r ns rt xdr s t x nn 1 n 0 re r n s rt x s t x dr fixing x x and 0 by strong continuity we may choose 0 a 1 b in such a way that sup a 6 r 6 b s rt x s t x we split the integral into three parts i 1 i 2 and i 3 corresponding to 0 a a b and b and estimate each part separately using that u 7 ue u is increasing on 0 1 and decreasing on 1 for the first integral using the elementary bound nn n 6 en 2 n 13 6 we obtain i 1 6 nn 1 n ae a n a 0 s rt x s t x dr 6 1 2 n 1 2 en ae a n 2 sup 06 s 6 t s s x which tends to 0 as n since ae a e 1 next using 13 5 i 2 6 nn 1 n b a re r n dr 6 nn 1 n 0 re r n dr to estimate i 3 we choose m 1 and r such that s t 6 me t choose 0 1 so small that be 1 b 1 1 this is possible since be b e 1 for all n 1 1 max t 1 by 13 6 we have i 3 6 nn 1 n b rne r 1 ne r 1 max t 1 m e rt e r x dr 444 semigroups of linear operators 6 nn 1 n 1 1 n 2 m x b r 1 e r 1 n e r dr 6 en 2 n 1 2 be b 1 n 2 m x b e r dr 6 1 2 n 1 2 be 1 b 1 n 2 m x which tends to 0 as n by the choice of we used the monotonicity of u 7 ue u on 1 to bound r 1 e r 1 by b 1 e b 1 collecting the estimates we have shown that lim n n t r n t a n 1 x s t x this is almost the result we want except for the power n 1 instead of n to correct for this we argue as follows by proposition 13 8 n t r n t a n 1 x n t r n t a n x 6 n t r n t a n n t r n t a x x 6 m 1 t n n n t r n t a x x as n by euler s formula and proposition 13 10 we have 1 t n n e t n t r n t a x x 0 and therefore lim n n t r n t a n x lim n n t r n t a n 1 x s t x we conclude this section with a simple result about compact semigroups proposition 13 20 compact semigroups let a be the generator of a c 0 semigroup s on x if s t is a compact operator for every t 0 then 1 the semigroup is uniformly continuous for t 0 2 the resolvent operator r a is compact for every a 3 the spectrum of a is finite or countable and consists of isolated eigenvalues and the corresponding eigenspaces are finite dimensional 4 for all t 0 we have the spectral mapping formula s t 0 exp t a moreover the eigenspaces corresponding to a and e t s t coincide 13 2 the hille yosida theorem 445 proof 1 fix s 0 for t s 2 we have s t s s sup x 61 s t s 2 s s 2 s s 2 x since s s 2 bx is relatively compact by proposition 1 42 this implies limt s s t s s 0 2 choose m 1 and r such that s t 6 me t for all t 0 we first claim that the compactness of the semigroup operators s t for t 0 implies that r a is compact for all re for all x x and t 0 we have s t r a x r a x t 0 s s ar a x and therefore s t r a r a 6 t sup s 0 t s s ar a where ar a r a i is a bounded operator since s t r a is compact for every t 0 from proposition 7 5 we obtain that r a is compact this proves the claim the compactness of r a for arbitrary a now follows from the resolvent identity 10 2 3 this follows from lemma 12 25 finally for any fixed a a nonzero x x is an eigenvector of a with eigenvalue if and only if it is an eigenvector of a with eigenvalue 1 since the eigenspaces corresponding to the nonzero eigenvalues of the compact operator r a are finite dimensional the second part of 3 follows 4 this follows from 3 and the next proposition in the next proposition we denote by p b the point spectrum of a bounded or un bounded operator b that is the set of its eigenvalues proposition 13 21 spectral mapping theorem for the point spectrum let a be the generator of a c 0 semigroup s on x then p s t 0 exp t p a t 0 moreover the eigenspaces corresponding to p a and e t p s t coincide proof if x d a is an eigenvector of a corresponding to the eigenvalue the identity t 0 e t s s s a xds e t s t x shows that s t x e tx that is e t is an eigenvalue of s t with eigenvector x this proves the inclusion p s t 0 exp t p a 446 semigroups of linear operators the inclusion p s t 0 exp t p a is proved as follows fix t 0 and sup pose that x x is an eigenvector of s t corresponding to a nonzero eigenvalue then e t for some c the identity s t x e tx implies that the map s 7 e ss s x is periodic with period t since this map is not identically zero the uniqueness theorem for the fourier transform implies that after scaling the interval 0 t to 0 2 at least one of its fourier coefficients is nonzero thus there exists an integer k z such that with k 2 ik t we have xk 1 t t 0 e kss s xds 6 0 we will show that k is an eigenvalue of a with eigenvector xk choose m 1 and r such that s t 6 me t by the t periodicity of s 7 e ss s x for all re we have r a x 0 e ss s xds n 0 n 1 t nt e ss s xds n 0 t 0 e ss s e nts nt x ds n 0 e nt t 0 e ss s xds 1 1 e t t 0 e ss s xds 1 1 e k t t 0 e ss s xds 13 7 since the integral on the right hand side is an entire function of the variable this shows that the map 7 r a x can be holomorphically extended toc 2 in t n z denoting this extension by f by 13 7 and the definition of xk we have lim k k f xk also by 13 7 and the t periodicity of s 7 e ss s x lim k k a k f lim k k 1 e k t i e ts t k t 0 e ss s xds 1 t 0 0 0 from the closedness of a it follows that xk d a and k a xk 0 it remains to prove the final statement on coincidence of eigenspaces let us denote the eigenspaces corresponding to p a and e t p s t by e and et respec tively the first part of the proof shows that e et denote by f and ft the closed linear spans of s t x x e and s t x x et then e f ft and the second part of the proof shows that ft e because the vector xk belongs to ft putting these inclusions together we obtain e f ft e and e et ft e 13 3 the abstract cauchy problem 447 and therefore all these subspaces coincide 13 3 the abstract cauchy problem having set up the general theory of c 0 semigroups it is time to put them to use in solving abstract cauchy problems 13 3 a the inhomogeneous cauchy problem if a is the generator of a c 0 semigroup s on x then by proposition 13 4 for initial values u 0 d a the function u t s t u 0 t 0 13 8 solves the initial value problem acp u t au t t 0 t u 0 u 0 in the sense that u is continuously differentiable takes values in d a and satisfies the equation pointwise in time a function u with these properties is called a classical solution however the definition 13 8 makes sense for arbitrary u 0 x not just for u 0 d a and for all u 0 x the function u t s t u 0 solves the following integrated version of acp u t u 0 a t 0 u s ds t 0 t 13 9 indeed by proposition 13 4 3 for arbitrary u 0 x we have t 0 s s u 0 ds d a and a t 0 s s u 0 ds s t u 0 u 0 confirming that 13 9 holds for u t s t u 0 this obser vation leads to the notion of strong solution which we develop next in the more general context of the inhomogeneous cauchy problem u t au t f t t 0 t u 0 u 0 iacp with initial value u 0 x we assume that f belongs to l 1 0 t x the space of all strongly measurable functions f 0 t x such that f 1 t 0 f t dt identifying functions that are equal almost everywhere in same way as in the scalar valued case one shows that l 1 0 t x is banach space 448 semigroups of linear operators definition 13 22 strong solutions a strong solution of iacp is a continuous func tion u 0 t x such that for all t 0 t we have t 0 u s ds d a and u t u 0 a t 0 u s ds t 0 f s ds we proceed with an existence and uniqueness result for strong solutions of iacp it is based on the following lemma lemma 13 23 let f l 1 0 t x then 1 for all t 0 t the function s 7 s t s f s has a strongly measurable represen tative and is integrable on 0 t 2 the function t 7 t 0 s t s f s ds is continuous on 0 t proof 1 choose a strongly measurable representative for f which we denote again by f as well as a sequence of simple functions fn converging to f pointwise each function s 7 s t s fn s is strongly measurable since it is a linear combination of functions of the form s 7 1 b s s t s x with b 0 t a borel subset and such func tions are strongly measurable because continuous functions on an interval are strongly measurable and if f is strongly measurable and b is a borel set then 1 b f is strongly measurable by proposition 1 48 their pointwise limit s 7 s t s f s is strongly measurable integrability follows from the estimate s t s f s 6 m f s where m supt 0 t s t and the integrability of f 2 let 06 t 6 t 6 t then t 0 s t s f s ds t 0 s t s f s ds 6 t t s t s f s ds t 0 s t s f s ds t 0 s t s f s ds the first term on the right hand side can be bounded above by m t t f s ds which tends to 0 by dominated convergence as t t 0 the second term tends to 0 by dominated convergence as well for simple functions f this follows from the strong continuity and local boundedness of the semigroup and for general f l 1 0 t x this follows by approximation by simple functions in the l 1 0 t x norm theorem 13 24 existence and uniqueness for all u 0 x and f l 1 0 t x the problem iacp admits a unique strong solution u it is given by the convolution formula u t s t u 0 t 0 s t s f s ds 13 10 if f lp 0 t x with 16 p then u lp 0 t x 13 3 the abstract cauchy problem 449 the function t 7 s t u 0 t 0 s t s f s ds is usually referred to as the mild solution of iacp proof for the existence part we will show that the right hand side of 13 10 defines a strong solution by lemma 13 23 this function is continuous we begin by showing that t 0 u s ds d a we have t 0 s s u 0 ds d a by propo sition 13 4 to prove that t 0 s 0 s s r f r dr ds d a we apply the definition of a as h 0 we have using fubini s theorem 1 h s h i t 0 s 0 s s r f r dr ds t 0 1 h s h i t r s s r f r dsdr t 0 1 h s h i t r 0 s s f r dsdr t 0 a t r 0 s s f r dsdr t 0 s t r f r f r dr u t s t u 0 t 0 f r dr the convergence is justified by the dominated convergence theorem since for all 0 h 1 we have the following pointwise bound with respect to the variable r 1 h s h i t r 0 s s f r ds 1 h t r h t r s s f r ds h 0 s s f r ds 6 1 h t r h t r s s f r ds 1 h t r h t r s s f r ds 6 2 mt f r where mt sup 06 6 t 1 s the above computation shows that t 0 u s ds d a and a t 0 u s ds a t 0 s s u 0 ds a t 0 s 0 s s r f r dr ds s t u 0 u 0 u t s t u 0 t 0 f r dr this shows that the function u given by 13 10 is a strong solution to prove uniqueness suppose that u and u are strong solutions of iacp it follows from the definition that u and u are continuous set v u u then v is continuous t 0 v s ds d a and v t a t 0 v s ds for all t 0 t fix 0 t 6 t and define w 0 t x by w s s t s s 0 v r dr this function is differentiable with derivative w s s t s v s s t s a s 0 v r dr s t s v s s t s v s 0 450 semigroups of linear operators it follows that w is constant hence t 0 v r dr w t w 0 0 since this is true for all 0 t 6 t and v is continuous it follows that v r 0 for all r 0 t the final assertion is a consequence of young s inequality the solution u depends continuously on u 0 in the norm of c 0 t x the banach space of all continuous functions from 0 t to x indeed if u 0 is another initial value and the corresponding unique strong solution is denoted by u then u t u t 6 s t u 0 u 0 6 m u 0 u 0 where m supt 0 t s t and therefore u u 6 m u 0 u 0 unique solvability plus continuous dependence on the initial value is usually sum marised as well posedness thus the inhomogeneous problem iacp is well posed for strong solutions 13 3 b the semilinear cauchy problem in this section we study a class of nonlinear evolution equations of the form u t au t f t u t t 0 t u 0 u 0 scp equations of this form are referred to as semilinear equations we assume that a gener ates a c 0 semigroup s on x and that the initial value u 0 lies in x we make the following assumptions on the function f 0 t x x i integrability for all x x the function t 7 f t x is bochner integrable on 0 t ii linear growth there exists a constant c 0 such that f t x 6 c 1 x t 0 t x x iii lipschitz continuity there exists a constant l 0 such that f t x f t x 6 l x x t 0 t x x x under these assumptions in force throughout this section we will prove existence uniqueness and continuous dependence on the initial conditions of mild solutions thus scp is well posed for mild solutions 13 3 the abstract cauchy problem 451 definition 13 25 mild solutions a function u 0 t x is called a mild solution of scp if it is continuous and satisfies u t s t u 0 t 0 s t s f s u s ds t 0 t to see that this is well defined we must check that the integral converges as a bochner integral in x lemma 13 26 takes care of this taking the lemma for granted for the moment let us first motivate the definition first of all it generalises the formula of theorem 13 24 for the strong solution of the inhomogeneous problem perhaps more importantly we shall prove that every classical solution is a mild solution to prepare for this suppose that u 0 t x is not just continuous but continuously differentiable and takes values in d a then it makes sense to ask whether u satisfies scp in a pointwise sense if it does we call u a classical solution let us assume that this is the case multiplying the equation for s 0 t on both sides with s t s and integrating we obtain t 0 s t s u s ds t 0 s t s au s ds t 0 s t s f s u s ds on the other hand an integration by parts using that u 0 u 0 and s t x s t ax for x d a gives the identity t 0 s t s u s ds u t s t u 0 t 0 s t s au s ds substituting this identity into the preceding one the identity defining a mild solution is obtained in general there is no reason to expect existence of classical solutions but under the standing assumptions i iii formulated above a unique mild solution always exists in the definition of a mild solution no differentiability or d a valuedness is imposed and this is precisely what makes things work as promised we now check that the integral in definition 13 25 is well defined as a bochner integral in x the next result extends lemma 13 23 to the present situation lemma 13 26 let f 0 t x x satisfy the conditions i iii and suppose that u 0 t x is continuous then 1 the functions s 7 f s u s and s 7 s t s f s u s have strongly measurable representatives and are integrable 2 the function t 7 t 0 s t s f s u s ds is continuous on 0 t proof 1 first let v kj 1 1 i j x j be an x valued step function where the intervals i j 0 t are disjoint if s i j then f s v s f s x j and therefore s 7 v s f s 452 semigroups of linear operators belongs to l 1 0 t x by the integrability assumption i moreover using the linear growth assumption t 0 f s v s ds k j 1 i j f s x j ds 6 c k j 1 i j 1 x j c t 0 1 v s ds if v is another x valued step function from the lipschitz continuity assumption iii we obtain the estimate t 0 f s v s f s v s ds 6 lt v v since u 0 t x is continuous we can find step functions un 0 t x such that u un 6 1 n then for m n n un um 6 un u u um 6 1 n 1 m 6 2 n so the functions s 7 f s un s form a cauchy sequence in l 1 0 t x by the com pleteness of l 1 0 t x they tend to a limit say g moreover after passing to a sub sequence we may assume that limn f s un s g s for almost all s 0 t by modifying the functions on a common borel null set as in the proof of lemma 13 23 we may even assume that the convergence holds pointwise on the other hand for all s 0 t we have f s un s f s u s 6 l n it follows that g s f s u s for almost all s 0 t in particular this proves that s 7 f s u s has a strongly measurable representative and belongs to l 1 0 t x 2 this follows by applying lemma 13 23 to the function s 7 f s u s we are now ready to state and prove our main result theorem 13 27 well posedness of the semilinear problem under the assumptions i iii formulated at the beginning of the section the semilinear problem scp admits a unique mild solution u c 0 t x this solution depends continuously in the norm of c 0 t x on the initial condition u 0 x proof to obtain existence and uniqueness we define a nonlinear mapping from c 0 t x to itself by v t s t u 0 t 0 s t s f s v s ds t 0 t v c 0 t x we have already observed in lemma 13 26 that the integrand is integrable and the continuity of v follows from the strong continuity of the semigroup and lemma 13 23 it follows that is well defined as a mapping of c 0 t x into itself we now 13 3 the abstract cauchy problem 453 reuse the idea in the proof of lemma 2 14 and set for a parameter 0 to be chosen in a moment g sup t 0 t e t g t this defines an equivalent norm on c 0 t x by the lipschitz continuity assumption for all v w c 0 t x and t 0 t we have v t w t 6 t 0 s t s f s v s f s w s ds 6 lm t 0 e se s v s w s ds 6 lm t 0 e s v w ds lm e t 1 v w where m supt 0 t s t it follows that v w 6 lm 1 e t v w 6 lm v w if we choose lm the mapping is a uniform contraction on c 0 t x and therefore has a unique fixed point u c 0 t x by the banach fixed point theorem theorem 2 13 fixed point argument then u t u t s t u 0 t 0 s t s f s u s ds t 0 t so u is a mild solution conversely any mild solution is a fixed point of and since has a unique fixed point the mild solution u is unique to complete the proof we check the continuous dependence of the mild solution on the initial value u 0 if u 0 is another initial value and the corresponding unique mild solution is denoted by u estimating as before we obtain u t u t 6 s t u 0 u 0 t 0 s t s f s u s f s u s ds 6 m u 0 u 0 lm e t 1 u u and therefore u u 6 m u 0 u 0 lm u u choosing 2 lm gives 1 2 u u 2 lm 6 m u 0 u 0 and the desired continuity follows keeping in mind that 2 lm is an equivalent norm on c 0 t x 454 semigroups of linear operators for this this to be useful one must have ways to translate nonlinearities occurring in concrete partial differential equations into our abstract framework we demonstrate how this works by means of an example consider the following semilinear heat equation on a nonempty bounded open subset d of rd u t t u t b u t d t 0 t u t 0 d t 0 t u 0 u 0 d we assume that b r r is lipschitz continuous with lipschitz constant l b b 6 l r the assumption that b only depends on the solution is made for simplicity the more general case where b also depends on time can be treated in the same way to cast this problem into a semilinear abstract cauchy problem we assume that the initial value u 0 belongs to l 2 d the above problem may then be written in the form u t au t b u t u 0 u 0 where a is the dirichlet laplacian on l 2 d which generates an analytic c 0 contraction semigroup on this space see proposition 13 49 and b l 2 d l 2 d is the nemyt skii mapping associated with b b x b x x l 2 d the next proposition checks that this mapping is well defined of linear growth and lipschitz continuous on l 2 d and with the same proof on lp d with 16 p proposition 13 28 under the above assumptions on b the nemytskii mapping b l 2 d l 2 d is well defined of linear growth and lipschitz continuous in the sense that f t x b x satisfies conditions ii and iii at the beginning of this section proof let us first check that b x l 2 d for all x l 2 d using the triangle in equality in l 2 d for all x l 2 d we have b x l 2 d d b x 2 d 1 2 6 d b x b 0 2 d 1 2 d b 0 2 d 1 2 6 l d x 0 2 d 1 2 b 0 d 1 d 1 2 l x 2 d 1 2 b 0 13 4 analytic semigroups 455 where d stands for the lebesgue measure of d this proves that b is well defined and of linear growth lipschitz continuity follows by a similar estimate for all x y l 2 d b x b y l 2 d d b x b y 2 d 1 2 6 l d x y 2 d 1 2 x y l 2 d we have thus shown that all assumptions of theorem 13 27 are fulfilled accord ingly we obtain unique solvability of the semilinear heat equation in the sense that the corresponding abstract cauchy problem admits a unique mild solution 13 4 analytic semigroups analytic semigroups provide an abstract framework for discussing a class of initial value problems referred to in the partial differential equations literature as parabolic an important characteristic of this class of problems is that solutions are smooth 13 4 a the main result for 0 consider the open sector z c 0 arg z where the argument is taken in definition 13 29 analytic c 0 semigroups a c 0 semigroup s on x is called analytic on if for all x x the function t 7 s t x extends holomorphically to and satisfies lim z z 0 s z x x we call s an analytic c 0 semigroup if it is an analytic c 0 semigroup on for some 0 if s is an analytic c 0 semigroup on then for all z 1 z 2 we have s z 1 s z 2 s z 1 z 2 indeed for each x x the functions z 1 7 s z 1 s t x and s z 1 t x are holomorphic ex tensions of s 7 s s t x and are therefore equal repeating this argument the functions z 2 7 s z 1 s z 2 x and s z 1 z 2 x are holomorphic extensions of t 7 s z 1 t x and are therefore equal 456 semigroups of linear operators as in the proof of proposition 13 3 the uniform boundedness theorem implies that if s is an analytic c 0 semigroup on then the operators s z is uniformly bounded on b 0 r for every 0 and r 0 the same argument as in proposition 13 3 then gives exponential boundedness on for all 0 in the sense that there are constants m 1 and c c r such that s z 6 m ec z z we say that s is a bounded analytic c 0 semigroup on if s is an analytic c 0 semigroup on and the operators s z are uniformly bounded on analytic c 0 contraction semigroups on are defined similarly there is a rather subtle point here boundedness and contractivity are imposed on a sector not just on the positive real line that this makes a difference is shown by simple example of the rotation group on c 2 given by s t cos t sin t sin t cos t for each t r we have s t 1 upon replacing t by a complex parameter z the group extends holomorphically to the entire complex plane but it is unbounded on every sector with 0 it may even happen that a bounded analytic c 0 semigroup is contractive on the positive real line yet fails to be an analytic c 0 contraction semigroup an example of such a semigroup on c 2 is discussed in problem 13 14 theorem 13 30 bounded analytic semigroups complex characterisation for a dens ely defined closed operator a in x the following assertions are equivalent 1 a generates a bounded analytic c 0 semigroup on for some 0 12 2 there exists 12 such that a and sup r a denoting the suprema of all admissible and in 1 and 2 by holo a and res a respectively we have res a 1 2 holo a under the equivalent conditions 1 and 2 we have the inverse laplace transform representation s t x 1 2 i e tr a xd t 0 x x 13 11 where b is the upwards oriented boundary of b for any 12 and any closed ball b centred at the origin note that 2 implies a ir 0 13 4 analytic semigroups 457 proof by cauchy s theorem if the integral representation holds for some choice of 12 and a closed ball b centred at the origin then it holds for any such and b 1 2 we start with the preliminary observation that if a linear operator a gen erates a uniformly bounded c 0 semigroup s on x then by proposition 13 8 the open right half plane c re 0 is contained in the resolvent set of a and we have the bound r a 6 m re for all c moreover for all 0 12 and we have re cos and therefore sup r a 6 m cos now if a generates a c 0 semigroup which is bounded on a sector with 0 12 say by a constant m we can apply the above reasoning to the bounded semigroups s ei t with 0 and obtain 2 optimising the various choices of angles we obtain the inequality res a 1 2 holo a 2 1 the idea is to define the semigroup operators by the integral representa tion given in the statement of the theorem and prove that they define a bounded c 0 semigroup which has the properties stated in part 1 once we have this it is fairly straightforward to deduce 1 with 12 this is done in the second step and gives the inequality holo a res a 1 2 step 1 let 12 for any let s x 1 2 i e r a xd x x where is the boundary of b with 0 12 any number such that 1 2 arg z and b is any closed ball centred at the origin see figure 13 1 this integral converges absolutely and defines a bounded holomorphic function on the sector the proof of the semigroup property proceeds much in the same way as the proof of the multiplicativity of the holomorphic calculus fix and choose contours and as above with to the right of then by the resolvent identity 10 2 cauchy s theorem fubini s theorem and the cauchy integral formula s s x 1 2 i 2 e r a r a xd d 458 semigroups of linear operators figure 13 1 the contour 1 2 i 2 e r a x r a x d d 1 2 i 2 e r a x d d 1 2 i e r a xd d s x put m sup r a and fix to estimate the norm of s x by cauchy s theorem we may take br with br b 0 r the ball of radius r and centre 0 where we take 12 arg z as before the choice of r 0 will be made shortly the arc z r arg z 6 contributes at most 1 2 2 r exp r m r m exp r while each of the rays z r arg z contributes at most 1 2 m r r exp cos d 6 1 2 m r cos 13 4 analytic semigroups 459 it follows that s 6 m exp r 1 r cos taking r 1 and letting we obtain the uniform bound s 6 m e 1 cos 1 2 it remains to prove strong continuity on each sector with 0 let x d a fix and write x r a y with inserting this in the in tegral expression for s x using the resolvent identity to rewrite r a r a y r a r a and arguing as above we find that the integral corre sponding to the term with r a vanishes by cauchy s theorem and the choice of and obtain s x 1 2 i e 1 r a yd letting 0 inside we see that s x converges to 1 2 i 1 r a yd r a y x by dominated convergence this proves the convergence s x x for x d a as 0 inside in view of the uniform boundedness of s on the convergence for general x x follows from this the following result characterises analytic c 0 semigroups directly in terms of the semigroup and its generator without reference to the resolvent its importance lies in the smoothing property revealed by 2 the semigroup operators s t map every x x into the smaller subspace d a for all t 0 theorem 13 31 bounded analytic semigroups real characterisation let a be the gen erator of a c 0 semigroup s on x the following assertions are equivalent 1 s is bounded analytic 2 s t x d a for all x x and t 0 and sup t 0 t as t remark 13 32 by writing s t s tn n part 2 self improves as follows for all x x and t 0 we have s t x d an for all x x and t 0 and sup t 0 tn ans t mn this will be used in the proof below 460 semigroups of linear operators proof of theorem 13 31 1 2 fix t 0 and x x arguing as in the proof of proposition 13 8 from the integral representation 13 11 with b we deduce that s t x d a and as t x 1 2 i e tr a axd the integral on the right hand side converges absolutely since sup ar a sup r a i by estimating this integral and letting the radius of the ball b in the definition of tend to 0 it follows moreover that t as t x 6 m x 0 te t cos d m cos x 2 1 for all x d an the mapping t 7 s t x is n times continuously differen tiable and s n t x ans t x as t n nx since d an is dense in x the bounded ness of as t n and closedness of the nth derivative in c 0 t x together imply that the same conclusion holds for x x moreover s n t x 6 cnnn tn x where c is the supremum in 2 from the inequality n nn en which follows from stirling s inequality we obtain that for each t 0 the series s z x n 0 1 n z t ns n t x converges absolutely on every ball b t rt ec with 0 r 1 and defines a holomor phic function there the union of all these balls is the sector with sin 1 ec we shall complete the proof by showing that s z is uniformly bounded and satisfies limz 0 s z x x in for each 0 to this end we fix 0 r 1 so that the union of the balls b t rt ec equals for z b t rt ec we have s z x 6 n 0 1 n rn t ec n cnnn tn x 6 n 0 rn x x 1 r this proves uniform boundedness on the sectors to prove strong continuity it then suffices to consider x d a for which it follows from estimating the identity s z x x ei r 0 s sei axds where z rei 13 4 analytic semigroups 461 13 4 b the lumer phillips theorem the main result of this section is the lumer phillips theorem which gives a charac terisation of analytic c 0 semigroups of contractions in hilbert spaces we begin with a useful lemma about extending resolvent bounds from a half line to a sector lemma 13 33 let a be a linear operator acting in x if the open half line 0 is contained in a and sup 0 r a m then m 1 the open sector c arg arcsin 1 m is contained in a and sup r a 6 m 1 m arcsin 1 m the argument is always taken in the interval proof for x d a we have r a x x r a ax x as from which it follows that m 1 proposition 10 27 implies that for every 0 the open ball with centre and radius 1 r a is contained in a the union of these balls is a sector we shall now verify that the sine of its angle equals at least 1 m let 0 arcsin 1 m 0 12 fix and let 0 be determined by the requirement that the triangle spanned by 0 has a right angle at thus by pythagoras 2 2 2 so 2 re let denote the angle of with the positive real line see figure 13 2 then sin sin 1 m so m 6 1 r a hence a and by the estimate for the neumann series in proposition 10 27 r a 6 r a n 0 n n r a n 6 m n 0 sin nmn 6 m 1 m sin 1 a typical application of this lemma is the second part of the next corollary which extends a uniform bound on r a on a half plane to a larger sector for reasons of completeness we also include its counterpart for uniform bounds on r a lemma 13 34 suppose that the half plane c re 0 arg 12 is contained in the resolvent set a of the linear operator a acting in x then 462 semigroups of linear operators figure 13 2 the proof of lemma 13 33 1 if sup c r a then there exists a 0 such that re a and sup re r a 2 if sup c r a then there exists a 0 such that arg 1 2 a and sup arg 12 r a proof proposition 10 29 implies that in case 1 we have ir a and that in case 2 we have ir 0 a the result now follows from proposition 10 27 applied to the points ir in case 1 and lemma 13 33 applied to the operators ia in case 2 in hilbert spaces with have the following characterisation of contractive analytic c 0 semigroups for an extension to banach spaces see problem 13 18 theorem 13 35 lumer phillips analytic contraction semigroups let a be a densely defined closed operator in a hilbert space h and let 0 12 the following asser tions are equivalent 1 a generates a contractive analytic c 0 semigroup on h on the sector 13 4 analytic semigroups 463 z 1 2 ax x ax x figure 13 3 ax x 2 a has dense range for some 0 and ax x 1 2 for all x d a proof by a multiplicative scaling of a we may assume that 1 1 2 let x d a and consider the function f t re s tei x x observe that f 0 x 2 furthermore for all t 0 we have f t s tei x x 6 s tei x x 6 x 2 where we used that s is contractive on from these two observations we infer that f 0 6 0 on the other hand differentiating f gives f t re ei s tei ax x evaluating at t 0 gives re ei ax x 6 0 this can only be true for all if ax x 1 2 2 1 set rei with r 0 and we want to show that for all x d a we have a x r x x for this we may assume that x 1 from and ax x 1 2 it is easy to see that ax x see figure 13 3 as a consequence 464 semigroups of linear operators a x a x x ax x x 13 12 from this inequality and proposition 10 26 we infer that a has closed range therefore to show that this operator is invertible it suffices to show that it has dense range this will be deduced from the assumption that i a has dense range since i a has also closed range we have in fact 1 a now suppose for a contradiction that some 1 belongs to a set t 1 t t 1 then t for all t 0 1 let t 0 inf t 0 1 t a then t 0 0 1 and limt t 0 r t a since resolvent norms diverge as we approach the boundary of the spectrum by proposition 10 29 this clearly contradicts 13 12 which tells us that r t a 6 t 6 1 1 for all t 0 t 0 we have now shown that a and r a 6 on this sector by lemma 13 33 the resolvent of a extends holomorphically to a slightly larger sector where it is still true r a 6 m for some finite constant m possibly greater than 1 theorem 13 30 then implies that the semigroup generated by a is bounded analytic on the sector 12 its contractivity on the smaller sector 12 is obtained by applying the hille yosida theorem to the operators ei a with the conditions of the theorem are satisfied if a is a positive selfadjoint operator on h in that case the semigroup s generated by a is given by s t a e t dp where p is the projection valued measure associated with a more generally this for mula can be used to associate a c 0 semigroup of contractions with every normal opera tor a see theorem 13 63 with the same proofs both theorem 13 35 and its corollary extend to 0 pro vided we interpret 0 as the positive real line and replace analytic c 0 semigroup of contractions by c 0 semigroup of contractions the theorem then takes the following form theorem 13 36 let a be a densely defined operator on a hilbert space h the follow ing assertions are equivalent 1 a generates a c 0 semigroup of contractions on h 2 a has dense range for some 0 and re ax x 0 for all x d a the condition re ax x 0 for all x d a says that a is accretive since the open half line 0 is contained in the resolvent set of any operator generating a c 0 semigroup of contractions in theorems 13 35 and 13 36 the condition a has dense range for some 0 may be replaced by 1 a an accretive operator a satisfying 1 a is also called a maximal accretive operator or briefly an m accretive operator 13 4 analytic semigroups 465 13 4 c semigroups associated with forms the first estimate of theorem 12 12 shows that the assumptions of the hille yosida theorem are fulfilled the second estimate combined with corollary 12 13 and lemma 13 34 applied to a and a implies that the conditions of theorem 13 30 are fulfilled thus we obtain the following result theorem 13 37 bounded analytic semigroups via forms let v and h be hilbert spaces with v continuously and densely embedded in h and let a be the densely defined closed operator in h associated with a bounded accretive form on v then a generates a c 0 contraction semigroup on h moreover 1 for all 0 the operator a generates a bounded analytic c 0 semigroup on h 2 if in addition to the above assumptions a is coercive then a generates a bounded analytic c 0 semigroup on h example 13 38 operators in divergence form i let d be a nonempty bounded open subset of rd in h l 2 d we consider the divergence form operators aa div a of section 12 3 e subject to dirichlet conditions as in that section we assume that the matrix valued function a d md c satisfies i the functions ai j d c are measurable and bounded ii there exists a constant 0 such that re d i j 1 ai j x i j 0 c d the operator aa is rigorously defined as the densely defined closed operator associated with the form aa u v d a u vdx on v h 10 d the form aa is satisfies the assumptions of the first part of theorem 13 37 if the accretivity assumption re d i j 1 ai j x i j 0 of section 12 3 e is replaced by the coercivity condition re d i j 1 ai j x i j 2 466 semigroups of linear operators of section 11 3 b with 0 then the second part of theorem 13 37 can be applied we show next that generators of analytic c 0 contraction semigroups are obtained if the range of a is contained in the closure of a subsector strictly contained in the open right half plane definition 13 39 sectorial forms let 0 6 12 a form a on h is called sectorial if a v a v v v d a theorem 13 40 analytic contraction semigroups via forms let h be a hilbert space and let a be the densely defined closed operator in h associated with a densely defined closed for a that is sectorial for some 0 12 then a generates an analytic c 0 semigroup of contractions on the sector 1 2 proof this is an immediate consequence of theorem 13 35 example 13 41 operators in divergence form ii consider again the divergence form operator aa div a 13 13 in l 2 d subject to dirichlet conditions as before we assume that d is a nonempty bounded open subset of rd we now assume that the matrix valued function a d md c satisfies i the functions ai j d c are measurable and bounded ii there exists a constant 0 such that d i j 1 ai j x i j 2 cd the uniform ellipticity condition ii is stronger than the corresponding condition of example 13 38 in that no real parts are taken it implies that the form aa of example 13 38 takes values in 0 so it is sectorial for all 0 12 accordingly aa generates an analytic c 0 semigroup of contractions on every sector with 0 12 sectorial forms of angle less than 12 are continuous and accretive this clarifies the relationship between theorems 13 37 and 13 40 accretivity is clear and continuity follows from the following proposition proposition 13 42 let a be an sectorial form on h with 0 12 then a is continuous and for all u v d a we have a u v 6 1 1 tan rea u 1 2 rea v 1 2 13 4 analytic semigroups 467 proof by the cauchy schwarz inequality applied to the form rea rea u v 6 rea u 1 2 rea v 1 2 let us now consider the imaginary part ima 12 i a a where a u v a v u for u v d a d a fix u v d a replacing v by ei v if necessary we may assume that ima u v r then ima u v ima v u and therefore by sectoriality ima u v 1 4 ima u v u v ima u v u v 6 1 4 tan rea u v u v rea u v u v 1 2 tan rea u rea v replacing u and v with u and v gives ima u v 6 1 2 tan rea u 1 rea v if rea u 6 0 we may take rea v rea u and obtain ima u v 6 1 tan rea u 1 2 rea v 1 2 if rea u 0 then ima u v 6 1 2 tan rea v and applying this with u and v replaced by u and v upon letting 0 we obtain ima u v 0 13 4 d maximal regularity in section 13 3 we have seen that the mild solution u of the inhomogeneous problem u au f with initial condition u 0 u 0 which is given by u t s t u 0 t 0 s t s f s ds t 0 is also a strong solution that is for all t 0 we have t 0 u s ds d a and u t u 0 a t 0 u s ds t 0 f s ds in general it cannot be asserted however that u t u 0 t 0 au s ds t 0 f s ds 468 semigroups of linear operators the problem being that u need not take values in d a almost everywhere and even if it does so we cannot be certain that s 7 au s is integrable on intervals 0 t the aim of the present section is to prove that these things do hold if a generates a bounded analytic c 0 semigroup on a hilbert space theorem 13 43 maximal regularity let a be the generator of a bounded analytic c 0 semigroup s on a hilbert space h then for all f l 2 r h the mild solution u u f of the inhomogeneous problem u au f with initial condition u 0 0 enjoys the following properties 1 u belongs to d a almost everywhere au belongs to l 2 r h and for almost all t 0 we have u t t 0 au s ds t 0 f s ds 2 we have au 2 6 c f 2 where c sup r 0 ar i a by the lebesgue differentiation theorem theorem 2 39 or rather its the vector valued version which is proved in exactly the same way the identity in 1 implies that u is differentiable almost everywhere and that the pointwise identity u t au t f t holds for almost all t 0 this in combination with 2 implies that also u belongs to l 2 r h with estimate u 2 6 c 1 f 2 this explains the name maximal regularity attached to the theorem we begin with a reduction to a class of nice functions f to this end for subspaces f and y of l 2 r and h respectively we introduce the notation f y for the vector space of all linear combinations of functions f r h of the form f y with f and y y where y t t y t 0 if f and y are dense in l 2 r and h respectively then f y is a dense subspace of l 2 r h this is because the dt simple functions are dense in l 2 r h and every such function is a linear combination of functions of the form 1 b h with b a borel set of finite measure and h an element of h we now approximate 1 b with functions in f with respect to the norm of l 2 r and h with elements in y with respect to the norm of h in what follows we consider the dense subspaces f c 1 c r and y d a for 13 4 analytic semigroups 469 functions f c 1 c r d a the mild solution of the problem u au f with initial condition u 0 0 given by u t t 0 s t s f s ds t 0 is continuously differentiable in h takes values in d a and satisfies u t au t f t for every t 0 lemma 13 44 let a be the generator of a bounded analytic c 0 semigroup s on a hilbert space h if there exists a constant c 0 such that for all f c 1 c r d a the mild solution u associated with f satisfies au l 2 r h and au 2 6 c f 2 where c 0 is a constant independent of f then the assertions 1 and 2 of theorem 13 43 hold for all f l 2 r h with the same constant c proof since c 1 c r d a is dense in l 2 r h for any f l 2 r h we may choose functions fn c 1 c r d a converging to f in l 2 r h writing u and un for the mild solutions corresponding to f and fn respectively the assumptions imply that the functions aun form a cauchy sequence in l 2 r h and therefore converge to a limit v in l 2 r h using the cauchy schwarz inequality for l 2 0 t h and taking the supremum over t 0 t we obtain un um c 0 t h 6 t 1 2 aun aum l 2 0 t h fn fm l 2 0 t h it follows that the functions un converge uniformly on every interval 0 t to a function u as a result for all t 0 we obtain u t t 0 v s ds t 0 f s ds since a is closed a standard subsequence argument furthermore gives that v takes values in d a almost surely and v au in l 2 r h the proof of theorem 13 43 relies on the observation that the fourier plancherel transform f on l 2 r extends to an isometry from l 2 r h onto itself defining its action on simple functions in l 2 r h by the prescription f 1 b h f 1 b h for borel sets b of finite measure and elements h h and extending this definition by linearity that this extension enjoys the stated properties can be proved in exactly the same way as in the scalar valued case repeating the proof given for that case word by word with the obvious adjustments 470 semigroups of linear operators proof of theorem 13 43 for functions f c 1 c r d a the mild solution u asso ciated with f takes values in d a and satisfies au v f in l 2 r h where v f t t 0 as t s f s ds t 0 thus the assumptions of lemma 13 44 are satisfied if we can show that v f l 2 r h for all f c 1 c r d a and v f 2 6 c f 2 f c 1 c r d a where c is the constant from the statement of the theorem in order to set the stage for the fourier transform we translate this into a statement about functions defined on the full real line let k t as t for t 0 and k t 0 for t 6 0 and define v f t k t s f s ds f c 1 c r d a t r then v f v f for functions f c 1 c r d a where on the left hand side we think of f as being extended identically zero to all of r so it suffices to prove that v maps c 1 c r d a into l 2 r h with bound v f 2 6 c f 2 f c 1 c r d a 13 14 this will be achieved by showing that v f tm f f c 1 c r d a 13 15 where tm is the operator valued fourier multiplier operator with m ar i a i r i a i r 0 that is tm f f 1 mf f f l 2 r h to see that the operator tm is well defined and bounded we note that since a generates a bounded analytic c 0 semigroup the function m ar i a i r i a i r 0 is uniformly bounded moreover by holomorphy this function is continuous from r 0 into l h as a consequence the mapping g 7 mg given almost everywhere by applying m to g is well defined and bounded on l 2 r h as required with norm tm sup r 0 ar i a this gives 13 15 as well as 13 14 with the correct value for c 13 4 analytic semigroups 471 in order to prove the identity 13 15 we must show that fv f t m f f c 1 c r d a at least formally the operator v has the form of a convolution with k so in view of proposition 5 30 one is led to believe that the identity fv f f k f 2 k f m f should hold since at least formally 2 k e it k t dt 0 e it as t dt a 0 e it s t dt ar i a m and this would give the desired result none of the steps in this formal argument is rigorous however and the remainder of the proof is devoted to presenting a rigorous version of it we mollify both v and m by defining for r 0 the regularising operator b r 1 ra 1 a r a 1 r 1 r 1 a 1 r r a r a 1 r 1 a 1 r a 1 r 1 r 1 a 1 13 16 if y r a say y ax then r 1 a 1 r a 1 y r 1 a 1 r a 1 r a r x r 1 a 1 x r r a 1 r 1 a 1 x as r 0 we have r 1 r 1 a 1 y y by propositions 13 10 and 13 8 and the latter one implies r r a 1 6 m and r 1 a 1 6 m r 1 where m is as in the proposition combining these observations we find that lim r 0 b r ax ax x d a 13 17 moreover 13 16 implies that b r 6 m r 1 m r m m 2 m define mr m b r for 6 0 and v r f t t 0 as t b r f s ds kr t s f s ds f c 1 c r d a where kr t as t b r for t 0 and kr t 0 otherwise by theorem 13 31 and the uniform boundedness of s t for t 0 kr t a 2 s t 1 ra 1 r a 1 6 cr t 2 and kr t 6 s t a 1 ra 1 a r a 1 6 cr 472 semigroups of linear operators where cr is independent of t 0 it follows that kr l 1 r l h and thus by domi nated convergence and proposition 13 8 2 k r lim 0 0 e i tkr t dt lim 0 a i a 1 b r mr therefore v r tmr on c 1 c r d a we now let r 0 by 13 17 and dominated convergence for f g x c 1 c r d a and t r we have v r f t t 0 g s s t s b r axds g s s t s axds v f t for every t r similarly by 13 17 and the uniform boundedness of the operators b r mr f g i a 1 b r ax g i a 1 ax m f with convergence in l 2 r h therefore tmr f tm in l 2 r h and along an ap propriate subsequence we also have almost everywhere convergence this shows that v f tm f and by linearity this implies v f tm f for all f c 1 c r d a we demonstrate the usefulness of maximal regularity by proving local existence for the time dependent inhomogeneous cauchy problem u t a t u t f t t 0 t u 0 0 13 18 where a t t 0 t is a family of densely defined closed operators on a hilbert space h we make the following assumptions each domain d a t is isomorphic to a fixed banach space d which is continuously and densely embedded in h the mapping t 7 a t l d h is continuous on 0 t the operator a 0 is invertible and generates a bounded analytic c 0 semigroup on h the idea is to rewrite the problem in the form u t a 0 u t gu t with gu t a t a 0 u t f t now let 0 a 6 t and consider a fixed function u l 2 0 a d referring to theorem 13 24 denote by ka u the mild solution of the inhomogeneous problem u t a 0 u t gu t t 0 a u 0 0 13 19 then at least formally the solutions of 13 18 are the fixed points of ka the maximal regularity of a 0 will now be used to show that ka is a uniform contraction that is 13 5 stone s theorem 473 its norm is strictly smaller than one in l 2 0 a d provided 0 a 6 t is small enough the banach fixed point theorem then gives the existence of a unique fixed point for ka in l 2 0 a d this fixed point will be called the solution on 0 a indeed if u 1 u 2 l 2 0 a d then ka u 1 ka u 2 equals the solution u of u t a 0 u t gu 1 t gu 2 t u 0 0 since d is isomorphic to d a 0 which is a banach space with respect to the norm x 7 a 0 x since 0 a 0 we obtain with the maximal regularity inequality for the problem 13 19 on the interval 0 a that ka u 1 ka u 2 l 2 0 a d a 0 u l 2 0 a h 6 c gu 1 gu 2 l 2 0 a h c a a 0 u 1 u 2 l 2 0 a h 6 c sup t 0 a a t a 0 l d h u 1 u 2 l 2 0 a d to justify the first inequality we extend the inhomogeneity gu 1 gu 2 identically 0 on a and observe that the mild solution for the resulting inhomogeneous problem on r restricts to u on the interval 0 a if the constant a 0 is small enough then sup a t a 0 t 6 a 1 c and ka l l 2 0 a d 1 and the banach fixed point theorem provides a unique solution for 13 18 on 0 a 13 5 stone s theorem if a is a positive selfadjoint operator on a hilbert space h then a satisfies the con ditions of theorem 13 35 denote by s the analytic c 0 semigroup of contractions gen erated by a it can be shown see problem 13 12 that for all t r and x h the limit u t x lim s 0 s s it x exists and that the family u t t r is a c 0 group of unitary operators with genera tor ia the main result of this section is stone s theorem which asserts that for any selfadjoint operator a it is true that the operators ia generate c 0 groups of unitary operators for the proof of this theorem we need the following auxiliary result a more precise version for bounded selfadjoint operators has been proved in theorem 8 11 474 semigroups of linear operators proposition 13 45 if a is a selfadjoint operator on a hilbert space h then a r and r a 6 1 im c r proof let i with 6 0 for all x d a we have ax x x ax ax x and therefore ax x r then a x x a x x x x ax x i x x x 2 and therefore a x x this implies that a is injective and by proposition 10 26 it has closed range the same argument can be applied to and allows us to con clude that a is injective and has closed range moreover using that a x y x a y the injectivity of a implies that a has dense range we conclude that a is bijective hence invertible and from the inequality a x x we see that r a 6 1 theorem 13 46 stone for a densely defined operator a in h the following assertions are equivalent 1 a is selfadjoint 2 ia is the generator of a c 0 group of unitary operators proof 1 2 by proposition 13 45 a is contained in the real line and for all c r we have r a 6 1 im hence by the hille yosida theorem theorem 13 17 the operators ia generate c 0 contraction semigroups s hence by proposition 13 13 ia generates a c 0 group of contractions given by u t s t t 0 s t t 6 0 also since ia ia ia we have s t s t and vice versa from which it follows that the operators u t are unitary 2 1 suppose that ia generates the unitary group u t t r from u t u t 1 u t we see that u t t r is a c 0 group as well to determine its gener ator which we call b for the moment suppose that x d a and h d b then x bh lim t 0 1 t x u t h h lim t 0 1 t u t x x h iax h this shows that h d a and ia ia h bh in the converse direction if h d a then for all x d a we have x ia h iax h lim t 0 1 t u t x x h lim t 0 1 t x u t h h x bh 13 6 examples 475 this shows that h d b and bh ia h we conclude that b ia with equal domains the identity 1 t u t x x 1 t u t x x then shows that x d a if and only if x d a and iax bx ia x some applications of this theorem will be given in the next section see sections 13 6 g and 13 6 h 13 6 examples in this section we collect some important examples of c 0 semigroups and c 0 groups 13 6 a multiplication semigroups let f be a measure space and let m k be measurable with real part bounded from below inf rem m the operators s t f e tm f t 0 are bounded on lp 16 p 6 with norm s t 6 e tm we will prove that s is a c 0 semigroup on lp for 16 p with generator a given by d a f lp m f lp a f m f f d a 13 20 fix 16 p the semigroup properties s 1 and s 2 are clear and s 3 follows by dominated convergence to prove 13 20 let f lp be such that m f lp for almost all we have s t f f e tm f f m f t 0 e sm ds also by proposition 13 4 s t f f a t 0 s s f ds it follows that a t 0 s s f ds m f t 0 e sm ds next we note that lim t 0 1 t t 0 s s f ds f 476 semigroups of linear operators and lim t 0 a 1 t t 0 s s f ds lim t 0 m f 1 t t 0 e sm ds m f in lp since a is closed this implies f d a and a f m f conversely if f d a then the limit lim t 0 1 t e tm f f exists in lp and equals a f since convergence in lp implies almost every where convergence along a subsequence there is a sequence tn 0 such that a f lim n 1 tn e tnm f f for almost all clearly lim n 1 tn e tnm f f m f it follows that m f lp and a f m f 13 6 b the translation group on the space lp r 16 p the formula s t f x f x t x r t r defines a c 0 group s its generator a is given by d a w 1 p r a f f f d a the group properties g 1 and g 2 are clear and g 3 follows from proposition 2 32 to prove that d a w 1 p r and a f f we first note that for f c 1 c r we have s t f x f x f x t f x t 0 f x s ds t 0 s s f x ds it follows that s t f f t 0 s s f ds also s t f f a t 0 s s f ds it follows that a t 0 s s f ds t 0 s s f ds next we note that lim t 0 1 t t 0 s s f ds f 13 6 examples 477 and lim t 0 a 1 t t 0 s s f ds lim t 0 1 t t 0 s s f ds f in lp r since a is closed this implies f d a and a f f since c 1 c r is dense in l p r and invariant under translations from proposition 13 5 we infer that c 1 c r is dense in d a since c 1 c r is also dense in w 1 p r and f d a f a f f f f w 1 p r for all f c 1 c r it follows that d a w 1 p r and a f f for all f d a w 1 p r 13 6 c the heat semigroup the heat semigroup on rd for 16 p and t 0 we define a linear operator h t on lp rd by h t f x kt f x f cc rd x rd 13 21 where kt x 4 t d 2 e x 2 4 t is the heat kernel since kt l 1 rd with kt 1 1 it follows from young s inequality proposition 2 33 that for all 16 p the operators h t are well defined and bounded on lp rd and satisfy h t f lp rd 6 f lp rd we furthermore set h 0 i the identity operator on lp rd we will prove that the family h h t t 0 is a c 0 semigroup of contractions the so called heat semigroup on lp rd and that its generator a is the weak lp laplacian thus the heat semigroup solves the linear heat equation u t t x u t x t 0 x rd u 0 x f x x rd in the sense that its orbits satisfy ddt h t f h t f and h 0 f step 1 fix 1 6 p first we prove that h is a c 0 semigroup on lp rd for all t 0 by lemma 5 20 and a change of variables the fourier transform of kt is given by k t 1 2 d 2 rd kt x e ix dx 1 2 d 2 e t 2 rd it follows that 2 d 2 k t k s k t s for each t s 0 and by proposition 5 30 this implies h t s f h t h s f for all f l 2 rd in particular this identity holds for functions 478 semigroups of linear operators f lp rd l 2 rd and since we have already seen that the operators h t are con tractive on lp rd the identity h t s f h t h s f extends to general functions f lp rd by the density of lp rd l 2 rd in lp rd strong continuity of the semigroup is an immediate consequence of proposition 2 34 step 2 we now prove that a the weak lp laplacian with equal domains we begin by proving the inclusion d d a along with the fact that a f f f d a first let f c c rd for all t 0 we have the pointwise identities t kt kt t kt f kt f and therefore h t f f kt f f t 0 ks f ds t 0 h s f ds 13 22 since we are assuming that f c c rd all identities can be rigorously justified by el ementary calculus arguments as we have already observed at the beginning of section 11 1 e c c r d is dense in d since all terms in the above identity depend continu ously on the graph norm of d the identity extends to arbitrary functions f d dividing both sides by t and passing to the limit t 0 by the continuity of t 7 h t f as an lp rd valued function we obtain that f d a and a f f as claimed this completes the proof to prove the converse inclusion d a d we must show that every f d a admits a weak lp laplacian to this end we multiply both sides of 13 22 with a test function and integrate by parts this results in the identity rd h t f x f x x dx t 0 rd h s f x x dxds dividing by t and passing to the limit t 0 and using the assumption f d a we obtain the identity rd a f x x dx rd f x x dx this identity precisely expresses that f admits a weak laplacian given by the function a f lp rd by theorem 11 29 for p 2 we have d a d w 2 2 rd 13 23 remark 13 47 for 1 p one has the analogous equality d a d w 2 p rd 13 6 examples 479 but this is highly nontrivial and depends on the lp boundedness of the riesz transforms see the notes to chapter 5 for d 1 there is the following more elementary argument that also works for p 1 the inclusion w 2 p rd d being clear for any dimension d the point is to prove the inclusion d w 2 p r if f lp r admits a weak lp laplacian f f theorem 11 12 implies that f admits a weak derivative f belonging to lp r this shows that f belongs to w 2 p r remark 13 48 there is a slightly different route to the identification a for p 2 which depends on the fact that each of the operators h t is a fourier multiplication operator associated with the multiplier mt exp t 2 defining h t g mtg we obtain a multiplication semigroup h on l 2 rd which is strongly continuous and whose generator a is given by d a g l 2 rd 7 2 g l 2 rd h 2 rd a g 2 g g d a rd this follows from the results proved in section 13 6 a this semigroup is related to the heat semigroup through the identity h t f 1 h t f t 0 from which it follows that a function f l 2 rd belongs to the domain of the generator a of h if and only if f f f belongs to the domain of the generator a of h in which case the identity a f f 1 a f f holds as we have seen this is the case if and only if f h 2 rd since h 2 rd w 2 2 rd up to equivalence of norm this implies 13 23 the heat semigroup on bounded domains let d be a nonempty bounded open set in rd proposition 13 49 the dirichlet and neumann laplacians on l 2 d generate analytic c 0 semigroups of selfadjoint contractions on every sector of angle less than 1 2 proof everything follows from lumer phillips theorem theorem 13 35 except the selfadjointness of the semigroup operators which follows from euler s theorem theo rem 13 19 after noting that for 0 the resolvent operators are selfadjoint alternatively proposition 13 49 can be deduced from the spectral theorem for self adjoint operators as such the result is a special case of theorem 10 54 where further details are provided this gives the representation s z 0 e zt dp t rez 0 480 semigroups of linear operators where p is the projection valued measure associated with the laplacian under consid eration see example 13 64 the dirichlet and neumann heat semigroups on l 2 d are positivity preserving that is they map nonnegative functions to nonnegative functions from the physics point of view it is natural to expect that heat semigroups should have this property as they are meant to describe the time evolution of heat distributions positivity of the heat semigroup on l 2 rd is evident from the explicit representation though convolution with the heat kernel theorem 13 50 positivity let d be bounded then the c 0 semigroups on l 2 d gen erated by dir and neum are positivity preserving proof let a denote the dirichlet or neumann laplacian on l 2 d and let s be the c 0 semigroup generated by a on l 2 d we must prove that s t f 0 for all t 0 whenever f l 2 d satisfies f 0 in what follows we fix such a function f step 1 we first prove that for all 0 we have g r a f 0 since the positive and negative parts g and g of g have disjoint supports they are orthogonal in l 2 d and therefore g g g 2 furthermore theorem 11 23 implies that if g h 1 d then g h 1 d and jg 1 g 0 jg and this in turn implies that d g g dx d g 2 dx combination of these facts gives 06 g 2 g g g g f g ag g 6 ag g d g g dx d g 2 dx 6 0 the middle inequality being a consequence of the fact that f 0 and the equality following being a consequence of the definition of a as the operator associated with the form on the right hand side of the equality this proves that g 0 in l 2 d so r a f g g 0 step 2 the positivity of the operators s t follows from the result of step 1 via the euler formula theorem 13 19 s t f lim n n t r n t a n f f l 2 d in section 13 6 c we have seen that the laplace operator generates a c 0 semigroup of contractions on lp rd for all 1 6 p for bounded open subsets d of rd up to this point we have only considered the analogues of this semigroup on the space l 2 d we prove next that the dirichlet and neumann laplacians also generate c 0 semigroups of contractions on the space lp d for 16 p this will be derived from an abstract result on lp boundedness of submarkovian operators which we discuss first 13 6 examples 481 let f be a finite measure space a bounded operator t on l 2 is called doubly submarkovian if it has the following properties i t f 0 for all f 0 ii t 16 1 and t 16 1 such operators enjoy the following extension property theorem 13 51 lp boundedness of doubly submarkovian operators let f be a finite measure space and let t be a doubly submarkovian operator on l 2 then 1 for all 1 6 p the restriction of t to l 2 lp has a unique extension to a contraction on lp 2 the restriction of t to l 2 l has a unique weak continuous extension to a contraction on l proof for all f l 1 l 2 t f 1 t f 1 6 t f 1 t f 1 t f 1 f t 1 6 f 1 f 1 f 1 f 1 hence t has a unique extension to a contraction on l 1 the same argument applied to t gives a unique extension of t l 1 l 2 to a contraction on l 1 and it is easy to verify that the hilbert space adjoint of this extension agrees with t on the weak dense subspace l 2 l of l this implies that t l 2 l has a unique weak continuous extension to a contraction on l boundedness and contractivity for 1 p now follow from the riesz thorin interpolation theorem turning to the lp boundedness of the heat semigroup we begin with the case of neumann boundary conditions theorem 13 52 lp boundedness neumann boundary conditions let d be bounded and let sneum denote the c 0 semigroup generated by neum to l 2 d for all 16 p the restriction of sneum t to l 2 d lp d uniquely extends to a c 0 semigroup of positivity preserving contractions on lp d proof by proposition 13 49 and theorem 13 50 for all t 0 the operator sneum t is selfadjoint and positivity preserving from neum 1 0 it follows that s neum t 1 sneum t 1 1 and therefore the operators sneum t are doubly submarkovian applying theorem 13 51 we obtain that for all 1 6 p and t 0 the restriction of sneum t to l 2 d lp d has a unique extension also denoted by sneum t to a contraction on lp d 482 semigroups of linear operators by ho lder s inequality the strong continuity of sneum on l 2 d implies that for all 16 p 2 and f l 2 d we have sneum t f f p 6 d 1 r sneum t f f 2 0 as t 0 where 12 1 r 1 p since sneum t p 6 1 for all t 0 the density of l 2 d in lp d implies that the strong continuity extends all f lp d for 2 p we use selfadjointness to see that for all f l 2 d lp d and g l 2 d lq d with 1 p 1 q 1 we have sneum t f f g sneum t f f g f sneum t g g f sneum t g g 6 f p sneum t g g q 0 13 24 applying in the last step what we already proved to the exponent 1 q 2 using the contractivity of the operators sneum t on lp d and lq d by density 13 24 extends to arbitrary f lp d and g lq d it follows that the semigroup sneum is weakly continuous on lp d by theorem 13 11 this implies its strong continuity positivity on lp d follows from the positivity of l 2 d by a density argument our next aim is to prove the following analogue of theorem 13 52 for the dirichlet heat semigroup theorem 13 53 lp boundedness dirichlet boundary conditions let d be a bounded open subset of rd and let sdir denote the c 0 semigroup generated by dir to l 2 d for all 1 6 p the restriction of sdir to l 2 d lp d extends to a c 0 semigroup of positivity preserving contractions on lp d the heart of the matter is to prove the following resolvent inequality lemma 13 54 for all 06 f l 2 d and 0 we have 06 r dir f 6 r neum f proof fix 0 and 0 6 f l 2 d then 0 6 u r dir f d dir and 0 6 v r neum f d neum and u diru f v neumv 13 25 the theorem will be proved by showing that this implies u 6 v fix a nonnegative test function c c d multiplying 13 25 on both sides with and integrating by parts we arrive at d u dx d u dx d v dx d v dx 13 26 we claim that this equality extends to all nonnegative functions h 10 d indeed if n in h 10 d with n c c d for all n 1 then n in h 10 d by theorem 13 6 examples 483 11 23 since each n has compact support mollification with a nonnegative compactly supported smooth mollifier allows us to approximate n by nonnegative test functions in h 10 d as in proposition 11 22 applying 13 26 to these test functions and taking limits the claim is obtained next we claim that u v belongs to h 10 d the point here being that u h 1 0 d but v h 1 d to prove the claim let uk u in h 10 d with uk c c d since v 0 for each k 1 the function uk v is supported in the compact support of uk and therefore it belongs to h 10 d by proposition 11 22 by another application of theorem 11 23 it then follows that u v limk uk v belongs to h 10 d as claimed by 13 26 which we may now apply to u v d u u v dx d u u v dx d v u v dx d v u v dx as a consequence d u v 2 dx d u v u v dx d u v u v dx d u v 2 dx 6 0 arguing as in the proof of theorem 13 50 in the last step this implies that u v 6 0 that is u 6 v proof of theorem 13 53 by the lemma and euler s formula theorem 13 19 sdir t f lim n n t r n t dir n f 6 lim n n t r n t neum n f sneum t f in particular this implies sdir t 1 6 sneum t 1 1 together with positivity and self adjointness this implies that the operators sdir t are doubly submarkovian the proof can now be finished along the lines of that of theorem 13 52 13 6 d the poisson semigroup let 1 6 p for t 0 we define the operator p t on lp rd by convolution with the poisson kernel pt x cdt t 2 x 2 1 2 d 1 t 0 x rd 13 27 where cd 1 2 d 1 1 2 d 1 with t 0 x t 1 e x dx the euler gamma function the change of variables y x t gives the norm estimate pt l 1 rd cd rd 1 1 y 2 1 2 d 1 dy 484 semigroups of linear operators cd d 1 0 1 1 r 2 1 2 d 1 rd 1 dr cd d 1 1 2 12 d 12 d 1 1 where d 1 2 d 2 1 2 d is the surface area of the unit sphere in r d young s in equality guarantees that the operators p t are well defined and contractive on lp rd for d 1 the formula 13 27 takes the simpler form pt x 1 t t 2 x 2 t 0 x r define p t f pt f for t 0 and f lp rd and supplement this definition by setting p 0 i to see that the operators p t satisfy the semigroup property we will show that the fourier transform of pt is given by p t 1 2 d 2 exp t 13 28 to prove this identity we compute the inverse fourier transform of the exponential on the right hand side by a standard contour integration argument for 0 we have e r ei y 1 y 2 dy writing 1 1 y 2 0 e 1 y 2 u du using fubini s theorem to interchange the order of in tegration and lemma 5 20 and a change of variables to evaluate the inner integral we obtain e r 0 ei ye 1 y 2 u dudy 0 e u r ei ye y 2 u dy du 1 0 e u u e 2 4 u du we apply this with t using fubini s theorem lemma 5 20 and another substi tution we obtain 1 2 d 2 rd 1 2 d 2 exp t x exp ix dx 1 2 d rd 1 0 e u u e t 2 x 2 4 u exp ix dudx 1 0 e u u 1 2 d rd e t 2 x 2 4 u exp ix dxdu 1 0 e u u 1 2 d u t 2 d 2 e x 2 u t 2 du 13 6 examples 485 1 1 2 d 1 1 td 0 e t 2 x 2 u t 2 u 1 2 d 1 du 1 1 2 d 1 t t 2 x 2 1 2 d 1 0 e vv 1 2 d 1 dv 1 1 2 d 1 t t 2 x 2 1 2 d 1 1 2 d 1 pt x this completes the proof of 13 28 thanks to this identity for t s 0 we obtain p t ps 2 d 2 p t p s 2 d 2 exp t exp s 2 d 2 exp t s p t s and therefore pt ps pt s it follows that for say f cc rd p t p s f pt ps f pt ps f pt s f p t s f since cc rd is dense in lp rd for 16 p this proves that p t p s p t s for all t s 0 this identity of course trivially extends to t s 0 strong continuity of the family p on lp rd for 16 p is an immediate consequence of proposition 2 34 we will determine the generator a of this semigroup for p 2 it will turn out that a 1 2 d a h 1 rd here the square root first is defined by the functional calculus of the selfadjoint oper ator see proposition 10 58 or by the following more direct argument recall the definition of h 1 rd as the space of all f l 2 rd for which 7 1 2 1 2 f belongs to l 2 rd in view of the trivial inequality 6 1 2 1 2 for all f h 1 rd the function 7 f belongs to l 2 rd thus we can define an opera tor b d b by b f 7 f d b h 1 rd note the formal analogy with the definition of fourier multiplier operators the only difference here is that the multiplier function m does not belong to l rd and is therefore not covered by the definition of these operators for f h 2 rd we similarly have f 7 2 f so that b f d and b 2 f b b f f this justifies the notation 1 2 b d 1 2 h 1 rd 13 29 486 semigroups of linear operators from b f f f f rd f 2 d 0 we see that b is positive the uniqueness part of proposition 10 58 implies that b co incides with the positive square root of obtained in the corollary by means of the functional calculus of in dimension d 1 the identity isign i implies that d 2 dx 2 1 2 h d dx where h is the hilbert transform which as we recall from section 5 6 is the fourier multiplier operator corresponding to the multiplier 7 isign theorem 13 55 poisson semigroup the poisson semigroup on l 2 rd is generated by the selfadjoint operator 1 2 selfadjointness follows from example 10 37 proof we start by noting that a function f l 2 rd belongs to h 1 rd if and only if 7 f belongs to l 2 rd the only if part has already been noted and the if part follows from the inequality 1 2 1 2 6 1 in the same way on l 2 rd we now define the multiplication semigroup q by q t g e t g for t 0 and g l 2 rd as we have shown in section 13 6 a this is a c 0 semigroup whose generator c d c is given by cg g for g d c g l 2 rd 7 g l 2 rd evidently p t f 1 q t f t 0 from which it follows that a function f l 2 rd belongs to the domain of the generator a of p if and only if f f f belongs to the domain of the generator c of q in which case the identity a f f 1 c f f holds by the observation at the beginning of the proof and 13 29 f f belongs to d c if and only if f h 1 rd d 1 2 and in that case we have 1 2 f 7 f f 1 c f f these considerations prove that a 1 2 with equality of their domains 13 6 examples 487 the operator 1 2 has an interesting connection with the wave equation which will be elaborated in section 13 6 h 13 6 e the ornstein uhlenbeck semigroup in this section we assume some elementary knowledge about gaussian random vari ables let d x 1 2 d 2 exp 1 2 x 2 dx denote the standard gaussian measure on rd for t 0 and f cc rd define the operator ou t on l 2 rd by ou t f x rd f e tx 1 e 2 ty d y x rd we will prove that ou is a c 0 semigroup on lp rd for all 16 p this semigroup is known as the ornstein uhlenbeck semigroup it plays a central role in the so called malliavin calculus an infinite dimensional gaussian version of calculus which finds applications in for example the theory of stochastic partial differential equations and mathematical finance interestingly this semigroup also makes its appearance in quan tum field theory where its negative generator takes the role of the so called bosonic number operator this point of view will be taken up in section 15 6 let us first show that each operator ou t extends to a bounded operator on lp rd of norm at most 1 by ho lder s inequality for all f cc rd we have ou t f p lp rd rd rd f e tx 1 e 2 ty d y p d x 6 rd rd f e tx 1 e 2 ty p d x d y e f e tx 1 e 2 ty p where x and y are independent standard gaussian random variables defined on some probability space and e is the expectation with respect to the probability measure since e t 2 1 e 2 t 2 1 the random variable e tx 1 e 2 ty is standard gaussian again so it is equal in distribution to x hence e f e tx 1 e 2 ty p e f x p rd f x p d x f p lp rd this proves that ou t f p 6 f p next we claim that c c r d is dense in lp rd to this end we first approximate f by a function of the form f where 0 6 6 1 and 1 on a large enough open ball b 0 r in rd on each ball b 0 r the gaussian density is bounded from below 488 semigroups of linear operators and therefore convergence in the l 2 b 0 r norm is equivalent to convergence in the lp b 0 r norm since c c b 0 r is dense in l p b 0 r the desired result follows combining the above two steps it follows that the operators ou t extend uniquely to contractions on lp rd by a limiting argument involving the extraction of an almost everywhere convergent subsequence and dominated convergence the defining formula for ou t extends to arbitrary functions f lp rd in the sense that for every f lp rd the formula holds for almost all x rd next we prove that ou is a c 0 semigroup on lp rd it is clear that s 1 holds to prove the semigroup property s 2 let us first fix a function f cc rd then ou t f cb rd and ou t ou s f x rd ou s f etx 1 e 2 ty d y rd rd f e s e tx 1 e 2 ty 1 e 2 sz d z d y e f e t s x e s 1 e 2 ty 1 e 2 sz where y and z are independent standard gaussians in view of the identity e s 1 e 2 t 2 1 e 2 s 2 1 e 2 t s the random variable e s 1 e 2 ty 1 e 2 sz is equal in distribution to a gaussian random variable with variance 1 e 2 t s therefore e f e t s x e s 1 e 2 ty 1 e 2 sz e f e t s x 1 e 2 t s y rd f e t s x 1 e 2 t s y d y ou t s f x this proves the identity ou t ou s f ou t s for f cc rd using the denseness of these functions in lp rd the identity extends to general f lp rd to prove the strong continuity property s 3 we again first consider a function f cc rd by ho lder s inequality ou t f f p lp rd 6 rd rd f e tx 1 e 2 ty f x p d x d y the right hand side tends to 0 as t 0 by dominated convergence this gives strong continuity for functions f cc rd the general case follows again by approximation keeping in mind that the operators ou t are all contractive the generator of ou t t 0 is traditionally denoted as l we show next that it is given for functions f c c rd by the ornstein uhlenbeck operator l f x f x x f x 13 30 13 6 examples 489 before turning to the proof we wish to point out an interesting feature of this formula multiplying both sides with a test function integrating with respect to and integrat ing by parts after having written out the gaussian density we obtain rd l f x x d x 1 2 d 2 rd f x x f x x exp 1 2 x 2 dx 1 2 d 2 rd f exp 1 2 x 2 dx rd f d x 13 31 since c c r d is dense in d w 1 2 rd the gaussian sobolev space of all f l 2 rd whose weak first order derivatives exist and belong to l 2 rd for p 2 the identity 13 31 identifies l as the operator associated with the closed densely defined accretive form aou with domain w 1 2 rd defined by aou f g rd f gd x let us now turn to a proof of 13 30 substituting 1 e 2 ty u and e tx u v and writing out the gaussian density we arrive at ou t f x 1 2 d 2 1 1 e 2 t d 2 rd f e tx u exp 1 2 u 2 1 e 2 t du 1 2 d 2 1 1 e 2 t d 2 rd f v exp 1 2 e tx v 2 1 e 2 t dv rd mt x v f v dv 13 32 this represents ou t as an integral operator with kernel mt x y 1 2 d 2 1 1 e 2 t d 2 exp 1 2 e tx y 2 1 e 2 t the function mt is called the mehler kernel at time t we can express it in terms of the heat kernel as mt x y k 1 2 1 e 2 t e tx y and therefore we have the pointwise identity ou t f x h 12 1 e 2 t f e tx where h is the heat semigroup on l 2 rd let f c c rd then f w 2 p rd and therefore by the results of section 13 6 c f d hence we may differentiate the above identity at t 0 and obtain lim t 0 1 t ou t f f 490 semigroups of linear operators e 2 t h 12 1 e 2 t f e t e t h 12 1 e 2 t f e t t 0 f f in the middle expression h s g is short hand for dj 1 h s jg the combined use of the product rule and chain rule can be rigorously justified by going through the steps of the standard proof of the corresponding scalar analogue which we leave as an exercise to the reader it is important to point out that the limit is taken with respect to the norm of lp rd as we were dealing with the heat semigroup in lp rd however since convergence in lp rd implies convergence in lp rd it follows that the above differentiation can retrospectively be interpreted with respect to the norm of lp rd this proves that f d l and that the asserted formula for l f holds let us show next that the analogue of theorem 12 19 holds for l we have already identified l as the operator associated with the form aou this in combination with theorem 10 44 and proposition 12 18 implies that l where the adjoint refers to the inner product of l 2 rd finally mutatis mutandis the argument for the heat semigroup can be repeated to prove that in l 2 rd the generator domain d l equals the domain of the weak l 2 ornstein uhlenbeck operator which is defined in the obvious way remark 13 56 for 1 p it can be shown that d l w 2 p rd the gaussian sobolev space of all f lp rd admitting weak derivatives up to order 2 all of which belong to lp rd the proof of this fact is beyond the scope of this work even for the case p 2 for d 1 one has the following representation for the ornstein uhlenbeck semi group in terms of the hermite polynomials hn discussed in section 3 5 b ou t hn e nthn n n 13 33 this is a simple exercise based on the representation 13 30 and the recurrence relation for the hermite polynomials discussed in section 3 5 b and it implies l n see corollary 15 59 the formula 13 33 generalises to arbitrary dimension d once one has found an analogue of the hermite basis for l 2 rd this is accomplished in section 15 6 a see theorems 15 57 and 15 58 an immediate consequence is that the ornstein uhlenbeck semigroup extend holomorphically and contractively to the open right half plane z c rez 0 and is strongly continuous on every sector with 13 6 examples 491 12 another way to see this is to note that l is selfadjoint by proposition 10 41 noting that l is symmetric by the selfadjointness of the operators ou t and satisfies 0 l by proposition 13 8 the holomorphic extension to the right half plane may now be defined by ou z exp zl rez 0 following this approach strong continuity on the sectors with 1 2 will follow from theorem 13 63 this discussion is summarised in the following theorem theorem 13 57 the operator l generates an analytic c 0 semigroup of contractions on every sector with 1 2 13 6 f the hermite semigroup let 0 6 v l 1 loc r d be given in applications we think of v as a potential consider the forms a av c c r d c c rd defined by a u v rd u x v x dx av u v rd v x u x v x dx the form a av is closable positive and symmetric and its closure a is positive as well the operator a associated with a is densely defined positive and symmetric so its closure is selfadjoint by theorem 12 17 we denote this closure somewhat suggestively by h v an interesting special case arises if we take v x x 2 this results in the selfadjoint operator x 2 on l 2 rd the so called hermite operator in quantum mechanics the operator h 1 2 1 2 x 2 is called the quantum harmonic oscillator let us here take a closer look at the c 0 contraction semigroup generated by a rescaled version of h theorem 13 58 the hermite semigroup the c 0 semigroup s on l 2 rd generated by h d 2 i is unitarily equivalent to the ornstein uhlenbeck semigroup ou on l 2 rd more precisely we have u 1 s t u ou t t 0 where u l 2 rd l 2 rd is the unitary operator given by u d e with d l 2 rd l 2 rd and d l 2 rd l 2 rd given by d f x 2 d 2 f 2 x e f x 1 2 d 4 exp x 2 4 f x 492 semigroups of linear operators proof fix f c c rd recalling from 13 30 that l f f x f a somewhat tedious but straightforward computation gives the identity l f u 1 d 2 h u f passing to the resolvents applying theorem 13 19 and using the density of c c r d in l 2 rd the identity for the semigroups follows from this as an immediate consequence of this result and theorem 13 57 we see that the her mite semigroup extends to an analytic c 0 semigroup of contractions on every sector with 12 it will follow from theorem 15 58 that l equals n 0 1 2 and consists of eigenvalues see corollary 15 59 from this we see that the spectrum of h equals h d 2 n and consists of eigenvalues the lowest eigenvalue 12 d is the ground state energy of h 13 6 g the schro dinger group we again consider the setting of section 13 6 f for nonnegative potentials v l 1 loc r d we defined the positive operator h v as the operator associated with the closure of the positive symmetric form a a av where a u v rd u x v x dx av u v rd v x u x v x dx for u v c c rd by stone s theorem the operator ih generates a unitary c 0 group on l 2 rd the so called schro dinger group with potential v it solves the schro dinger equation with potential v 1 i t u t x u t x v x u t x t 0 x rd 13 34 the special case v 0 is of special interest example 13 59 free schro dinger group the c 0 group s t t r on l 2 rd gener ated by the operator a i with domain d a h 2 rd is called the free schro dinger group for functions f l 1 rd l 2 rd and 6 0 it is given explicitly be the formula s t f x 1 4 it d 2 rd exp i x y 2 4 t f y dy 13 35 valid for almost all x rd note that on a formal level we have s t h it where 13 6 examples 493 h z rez 0 is the holomorphic extension to the open right half plane of the heat semigroup generated by given by 13 21 we refer to problem 13 12 for a proof that the limit h it f lims 0 s s it f indeed exists for all f l 2 rd the point we are making here is that this limit is still represented by the explicit formula 13 21 for the heat semigroup evaluated at it taking the result of problem 13 12 for granted 13 35 follows from 13 21 with t replaced by s it by dominated convergence an alternative derivation can be given on the basis of the spectral theorem for self adjoint operators see problem 13 23 this idea will be explored more systematically in example 13 64 the representation 13 35 implies that s t f l rd for all f l 1 rd l 2 rd and t r 0 with bounds s t f 6 1 4 t f 1 s t f 2 6 f 2 the former by a direct estimate and the latter by plancherel s theorem by the riesz thorin interpolation theorem for all t r 0 the operators s t when restricted to l 1 rd l 2 rd extend to bounded operators from lp rd to lq rd for all 16 p 6 2 and 1 p 1 q 1 with bound s t l lp rd lq rd 6 1 4 t 1 p 1 2 13 36 13 6 h the wave group the wave group on bounded domains let d be a nonempty bounded open set in rd the space h h 10 d l 2 d is a hilbert space with respect to the norm given by u v 2 u 21 2 v 2 2 where we consider the norm on h 10 d given by u 21 2 d u 2 dx u h 10 d 13 37 this norm is equivalent to the usual sobolev norm on h 10 d by poincare s inequality in h we define the operator a defined by a 0 i dir 0 d a d dir h 10 d 494 semigroups of linear operators where dir is the dirichlet laplacian on l 2 d we will prove that a is the generator of a unitary c 0 group w on h this group solves the linear wave equation 2 u t 2 t x u t x t r x d u 0 x u 0 x x d v t 0 x v 0 x x d written as a system of first order odes u v v u with initial value u 0 u 0 v 0 v 0 subject to dirichlet boundary conditions the operator a is densely defined and an integration by parts gives for u u 1 u 2 d a and v v 1 v 2 d a au v u 2 u 1 v 1 v 2 d u 2 v 1 u 2 v 1 u 1 v 2 dx d u 2 v 1 u 1 v 2 dx u 1 u 2 v 2 v 1 u av this implies that ia is symmetric we next observe that 0 dir by theorem 12 26 this allows us to consider the bounded operator r 0 1 dir i 0 on h for u v h we have r u v 1 dirv u d dir h 10 d d a and it is immediate to check that ar i and rah h for h d a this proves that a is boundedly invertible that is 0 a an application of proposition 10 41 now gives that ia is selfadjoint therefore by stone s theorem theorem 13 46 we obtain theorem 13 60 wave group on bounded domains the operator a generates a unitary c 0 group w t t r on h 10 d l 2 d provided h 10 d is endowed with the equivalent norm given by 13 37 13 6 examples 495 the wave group on rd let us next consider the case d rd which is not covered by the above considerations since it was assumed that d be bounded we have h 10 r d h 1 rd by theorem 11 25 and theorem 11 31 and dir with d h 2 rd this suggests considering in h 1 rd l 2 rd the operator a 0 i 0 d a h 2 rd h 1 rd we will use the theory of fourier multipliers to prove that a generates a c 0 group on h 1 rd l 2 rd and give an explicit expression for it to motivate the upcoming expressions we first consider the matrix aa 0 1 a 0 where a 0 is a nonnegative scalar and compute its exponentials etaa the powers of aa are given by a 2 ka a k 0 0 a k a 2 k 1 a 0 a k a k 1 0 k n so that with b a 1 2 etaa k 0 t 2 k 2 k a k t 2 k 1 2 k 1 a k t 2 k 1 2 k 1 a k 1 tk 2 k ak k 0 1 k t 2 k 2 k b 2 k 1 k t 2 k 1 2 k 1 b 2 k 1 k t 2 k 1 2 k 1 b 2 k 2 1 k t 2 k 2 k b 2 k cos tb b 1 sin tb bsin tb cos tb substituting for a and 1 2 for b we arrive at the following guess for the ex pression for the wave group w t cos t 1 2 1 2 sin t 1 2 1 2 sin t 1 2 cos t 1 2 t 0 we need to give a meaning to the operators occurring in this matrix which can be 496 semigroups of linear operators accomplished by the functional calculus of or by interpreting them as fourier mul tiplier operators as follows the operators on the diagonal can be interpreted as fourier multiplier operators on l 2 rd associated with the multipliers m 1 1 t m 2 2 t cos t this function belongs to l rd with norm 1 for every t r recalling the characteri sation of h 1 rd as those functions f in l 2 rd for which 7 1 2 1 2 f is in l 2 rd we see moreover that cos t 1 2 maps w 1 2 rd into itself recalling the norm of h 1 rd given by 11 9 this argument also gives the estimates cos t 1 2 l l 2 rd 6 1 cos t 1 2 l h 1 rd 6 1 similarly we can associate a bounded operator from h 1 rd to l 2 rd with the multi plier m 2 1 t sin t indeed if f h 1 rd then m 2 1 t f l 2 rd 6 sup rd 1 2 1 2 sin t f h 1 rd 6 f h 1 rd and therefore 1 2 sin t 1 2 f l h 1 rd l 2 rd 6 1 for all t r in the same way the operators 1 2 sin t 1 2 are interpreted as bounded operators from l 2 rd into h 1 rd given by the multipliers m 1 2 t sin t which satisfy distinguish the cases 6 1 and 1 m 1 2 t f l 2 rd 6 sup rd sin t 1 2 1 2 f l 2 rd 6 c 1 t f l 2 rd c 1 t f l 2 rd where c is a universal constant therefore 1 2 sin t 1 2 l l 2 rd h 1 rd 6 c 1 t for all t r 13 6 examples 497 theorem 13 61 wave group on rd the operator a generates a c 0 group w t t r on h 1 rd l 2 rd which is given by w t cos t 1 2 1 2 sin t 1 2 1 2 sin t 1 2 cos t 1 2 t r moreover there is a constant c 0 such that w t 6 c 1 t t r proof the group property follows from formal matrix multiplication which can be made rigorous by noting that in the fourier domain we are just multiplying matrices of scalar valued multipliers much like what we did in the treatment of the heat and poisson semigroups once we have proved strong continuity differentiation of the entries at t 0 identifies 0 i 0 as the generator by the same reasoning to prove strong continuity we note that m 1 1 t 6 1 and limt 0 m 1 1 t 1 point wise implying that limt 0 m 1 1 t f f in l 2 rd by dominated convergence hence limt 0 cos t 1 2 f f in l 2 rd for all f l 2 rd by plancherel s theorem the strong convergence of the other three terms is proved similarly remark 13 62 notwithstanding the linear growth bound for w t the energy func tional e t tw t f 22 w t f 2 2 is constant in time for functions f d a one has e t 0 by direct calculation and the general case then follows by density we conclude with some informal remarks establishing a connection with the pois son semigroup of section 13 6 d since 1 2 with domain h 1 rd is selfadjoint i 1 2 is the generator of a c 0 group u t t r of unitary operators on l 2 rd by stone s theorem for f h 2 rd we have 1 2 f h 1 rd and d 2 dt 2 u t f i 1 2 2 u t f u t f in this sense t 7 u t x u t f x satisfies the wave equation with initial condition u 0 x f x we are neglecting the initial condition for the first derivative however and in fact we could run the same argument for i 1 2 which is the generator of the c 0 group u t t r to find that its orbits also solve the wave equation with initial condition u 0 x f x interpreting u t and u t as fourier multipliers one sees that 1 2 u t u t cos t 1 2 which is the first entry in the matrix representation for the wave group these operators 498 semigroups of linear operators solve the wave equation with initial conditions u 0 x f x and u t 0 x 0 the latter because of the cancellation of the derivatives of u t f and u t f this argument is admittedly somewhat sketchy the reader is invited to provide the rigorous details 13 7 semigroups generated by normal operators we begin with a general observation about semigroup generation by normal operators recall from section 13 4 the notation z c 0 arg z for the open sector of angle 0 arguments being taken in theorem 13 63 semigroups generated by normal operators let n be a normal oper ator in h with associated projection valued measure p then 1 if n is contained in the closed right half plane then n is the generator of a c 0 semigroup of contractions s given by s t n e t dp t 0 2 if n is contained in a closed sector of angle 0 12 then n is the gener ator of an analytic c 0 semigroup of contractions s z z 1 2 given by s z n e z dp z 1 2 proof we give a detailed proof of 1 the proof of 2 is entirely similar first of all the operators s t are well defined and contractive by theorem 9 8 ii we next check that the semigroup is strongly continuous for all x h dominated convergence gives lim t 0 s t x x lim t 0 n e t dpx n dpx x x by a polarisation argument this gives the weak continuity of the semigroup by theo rem 13 11 this implies its strong continuity it remains to be shown that n is its gener ator if x d n that is if n 2 dpx then by dominated convergence lim t 0 1 t s t x x x lim t 0 n e t 1 t dpx n dpx nx x 13 38 13 7 semigroups generated by normal operators 499 the same argument proves that lim t 0 1 t 2 s t x x 2 lim t 0 1 t 2 s t i s t x x x n 2 dpx nx 2 13 39 using the final identity in the statement of theorem 10 48 in the last step by polarisation 13 38 implies that lim t 0 1 t s t x x y nx y x d n y d n and hence using that limsupt 0 1 t s t x x by 13 39 by approximation we obtain lim t 0 1 t s t x x y nx y x d n y h denoting the generator of the semigroup by a for y d a it follows that nx y lim t 0 1 t s t x x y lim t 0 1 t x s t y y x a y this implies that nx d a d a referring to proposition 10 23 for the equality of these domains we have thus proved that n a since 0 is contained in the resolvent sets of both n by assumption and a since it generates a c 0 contraction semigroup proposition 10 30 implies a n some of the semigroup examples of the previous section can be constructed rather easily using the spectral theorem example 13 64 heat semigroup poisson semigroup free schro dinger group wave group revisited let p be the projection valued measure on r associated with the neg ative laplace operator viewed as a selfadjoint operator on l 2 rd see problem 10 17 the heat semigroup h is then given by h t r e t dp t 0 and the free schro dinger group by s t r e i t dp t 0 the positive square root 1 2 defined through proposition 10 58 coincides with the unbounded fourier multiplier operator corresponding to the multiplier m using proposition 10 50 to switch between the projection valued measure p of and 500 semigroups of linear operators q of 1 2 we see that the poisson semigroup generated by the latter is given by h t 0 e t dq 0 e 1 2 t dp t 0 in the same way the operators cos t 1 2 and sin t 1 2 featuring in the wave group are given by cos t 1 2 0 cos t dq 0 cos t 1 2 dp sin t 1 2 0 sin t dq 0 sin t 1 2 dp example 13 65 stone s theorem revisited let p be the projection valued measure on r associated with a selfadjoint operator a on a hilbert space h then the unitary c 0 group u t t r generated by ia is given by u t r ei t dp t 0 problems 13 1 let s be a c 0 semigroup on x with generator a and suppose that s t 6 me t for all t 0 prove that a k 6 m re k re k 1 2 hint by considering a instead of a we may assume that 0 under this assumption observe that r a 6 1 re where x supt 0 s t x de fines an equivalent norm on x remark the converse holds as well if a is a densely defined operator on x satisfying the above inequalities then a generates a c 0 semigroup on x satisfying s t 6 me t for all t 0 this is the version of the hille yosida theorem for arbitrary c 0 semigroups the ambitious reader may try to prove this 13 2 the aim of this problem is to prove that if a generates a c 0 semigroup s on x then a is bounded if and only if lim t 0 s t i 0 a show that if a is bounded then s t eta and limt 0 s t i 0 b use a neumann series argument to prove that if limt 0 s t i 0 then for small enough t 0 the operators tt l x defined by tt t 0 s s ds problems 501 are invertible and show that for such t 0 we have a t 1 t s t i 13 3 let a be the generator of a c 0 semigroup s on x this problem gives a rigorous interpretation to the formula s t eta for each h 0 consider the bounded operator a h x 1 h s h x x a choosing m 1 and 0 so that s t 6 me t for all t 0 show that eta h 6 mexp t h e h 1 deduce that for all 0 h 6 1 we have eta h 6 met e 1 b using the identity s t x eta h x t 0 d ds e t s a h s s x ds deduce from part a that for all x d a and 0 h 1 we have s t x eta h x 6 tm 2 et e 1 ax a h x c prove that for all x x and t 0 we have lim h 0 eta h x s t x d for n n with n let an nr n a a as in the proof of the hille yosida theorem prove that for all x x and t 0 we have lim n etanx s t x 13 4 let a be the generator of the c 0 semigroup s on l 2 0 1 of left translations in serting zeroes from the right show that a 13 5 let a be the generator of a c 0 semigroup s on x the adjoint semigroup on x is the family s s t t 0 where s t s t for t 0 a show that the adjoint semigroup has the semigroup properties s 1 and s 2 but may fail s 3 set x x x lim t 0 s t x x 0 b show that x is a closed subspace of x c show that the adjoint semigroup maps x into itself and that its restriction to x is a c 0 semigroup 502 semigroups of linear operators d show that for all x x and t 0 there exists a unique element t x x satisfying x t x t 0 x s s x ds e show that for all x x and t 0 we have t x d a and a t x s t x x f show that x d a and deduce that x is weak dense in x g show that d a x x limsup t 0 1 t s t x x h show that if x is reflexive then s is a c 0 semigroup on x and a is its generator hint for the strong continuity apply phillips s theorem theorem 13 11 for the identification of the generator use proposition 10 30 13 6 in this problem we prove a continuous analogue of the sz nagy dilation theorem theorem 8 36 let s be a c 0 semigroup of contractions on a hilbert space h a show that the mapping t r l h defined by t t s t t 0 i t 0 s t t 0 is positive definite hint for t 1 tn q use lemma 8 35 to show that for all h 1 hn h we have nm n 1 t tn tm hm hn 0 b show that there exist a hilbert space h containing h as a closed subspace and a c 0 group u t t r on h such that t t h pu t h t 0 h h where p is the orthogonal projection of h onto h hint combine the result of part a with theorem 8 34 to obtain the dilation and use theorem 13 11 to prove its strong continuity 13 7 let a be the generator of a c 0 semigroup on x prove the following spectral inclusion formula for all t 0 we have s t exp t a problems 503 hint suppose e t s t for some c and denote the inverse of e t i s t by q t show that the bounded operator b defined by b x t 0 e t s s s q txds is a two sided inverse for a 13 8 let a be the generator of a c 0 semigroup on x and let f l 1 0 t x be given and fixed a function u l 1 0 t x is said to be a weak solution of the inhomo geneous abstract cauchy problem u t au t f t t 0 t u 0 u 0 if for all t 0 t and x d a we have u t x u 0 x t 0 u s a x ds t 0 f s x ds prove that the inhomogeneous abstract cauchy problem has a unique weak solu tion and that it equals the unique strong solution 13 9 on c 2 consider the norm q induced by the inner product x y q qx y where q 1 2 1 1 a show that the symmetric matrix q is positive and conclude that q does indeed define an inner product on c 2 on c 2 q we consider the c 0 semigroup s s t e t 2 1 t 0 1 b show that s t 2 q 1 2 e t t 2 2 t t 2 4 and conclude that s t is con tractive for all t 0 hint use the fact that s t 2 q equals the largest eigenvalue of s t s t see problem 4 14 where the adjoint refers to the inner product q c show that s extends to an entire c 0 semigroup which is uniformly bounded on the open sector for all 0 1 2 d show that s fails to be contractive on any open sector 13 10 let a be the generator of an analytic c 0 semigroup on x show that if b is a bounded operator on x then a b generates an analytic c 0 semigroup on x also show that if a generates a bounded analytic c 0 semigroup then so does a b b i 504 semigroups of linear operators hint first prove the second assertion 13 11 let a be the generator of an analytic c 0 contraction semigroup on a hilbert space h show that the form a on h with domain d a d a defined by a x y ax y is accretive continuous and closable 13 12 let a be the generator of a c 0 semigroup c 0 semigroup s on x which is bounded analytic on the open right half plane show that for all t r and x x the limit t t x lim s 0 s s it x exists and that the family t t t r is a uniformly bounded c 0 group of operators with generator ia hint begin by observing that if 0 s s and t t then s s it x s s it x 6 m s s s x x where m suprez 0 s z deduce from this the existence of the limits deduce the semigroup properties and strong continuity in a similar manner finally show that if x d a then t 0 t s iaxds t t x x to deduce that x d b where b is the generator of u t t r and use this to conclude that b ia 13 13 let a be the generator of an analytic c 0 semigroup s on x prove that if a z c rez 0 then s is uniformly exponentially stable that is there exists an exponent 0 such that supt 0 e t s t hint verify the assumptions of theorem 13 30 for a for small enough 0 13 14 this problem gives a two dimensional example of a bounded analytic c 0 semi group which is uniformly exponentially stable contractive on r and fails to be contractive on any open sector containing r 13 15 let s t t 0 be a c 0 semigroup on x and let 16 p prove the datko pazy theorem the semigroup s t t 0 is uniformly exponentially stable see problem 13 13 if and only if the orbit t 7 s t x belongs to lp r x for all x x hint apply the uniform boundedness theorem and reason by contradiction 13 16 let a be the generator of a c 0 semigroup s t t 0 on a hilbert space h prove the gearhart pru ss theorem the semigroup s t t 0 is uniformly exponentially stable see problem 13 13 if and only if c re 0 a and sup re 0 r a hint suppose that s t 6 me t complete the following steps a extend the fourier plancherel theorem to l 2 rd h problems 505 b prove that t 7 r s it a x belongs to l 2 r h for all x h and s c use a taylor expansion argument for the resolvent operators near the imagi nary axis to prove that there exists a 0 such that c re a and sup re r a hint compare with the proof of lemma 13 33 d use the resolvent identity to prove that the function t 7 r it a x belongs to l 2 r h for all x h e conclude that t 7 s t x belongs to l 2 r h for all x h 13 17 this problem shows that the gearhart pru ss theorem of problem 13 16 does not extend to general banach spaces let 1 6 p q and let x lp 1 lq 1 this space is a banach space under the norm f max f p f q see problem 2 21 on x define the operators s t t 0 by s t f x f xet x 1 a show that s is a c 0 semigroup on x with generator a given by d a f x x 7 x f x x a f x x f x x 1 f d a b show that re 1 q a and that for all 1 q we have sup re r a c show that for all 1 p we have limt e t s t 13 18 for x x define x x x x x x x x x this set is called the subdifferential of x a show that x 6 b show that if x is a hilbert space then for all x x we have x x 13 40 c let 1 p and 1 p 1 q 1 show that if x l p then for all f lp we have f g f p 13 41 506 semigroups of linear operators where g f p lq is defined by writing f ei f and setting g f p e i f p 1 d is the subdifferential always a singleton e using subdifferentials extend the lumer phillips theorem theorem 13 35 to banach spaces 13 19 discuss examples 13 38 and 13 41 for neumann boundary conditions 13 20 prove the identity 13 33 13 21 consider the wave groups w on a bounded open set d rd as in theorem 13 60 or on the full space d rd as in theorem 13 60 and denote their gener ators by a prove that if f u v d a then the solution of the wave equation in the sense of semigroup theory that is the mapping t 7 w t f belongs to c 2 r l 2 d c r h 2 d hint let h h 10 d l 2 d be the hilbert space on which the wave group acts start from the general observation that if f d a then t 7 w t f belongs to c 1 r h c r d a this follows from general semigroup considerations then use the special structure of the wave operator a 13 22 this problem gives some perspective on the bound w t 6 c 1 t for the wave group over the domain rd theorem 13 61 let a be its generator a is the operator ia selfadjoint compare with theorem 13 60 b show that a i satisfies the conditions of the lumer phillips theorem for all 0 if we endow h 1 rd with the equivalent norm u 21 2 d u 2 u 2 dx u h 1 rd compare with 13 37 conclude that with respect to the resulting equiva lent norm on h 1 rd l 2 rd we have w t 6 et for all t 0 how does the norm compare to the norm used in theorem 13 61 c elaborating on the idea of part b show that for all 0 the space h 1 rd l 2 rd admits an equivalent norm such that w t 6 e t for all t 0 13 23 derive the formulas 13 21 and 13 35 for the heat semigroup and the free schro dinger group from their representations in terms of the projection valued measure associated with the laplace operator example 13 64 14 trace class operators this chapter is devoted to the study of trace class operators and the related class of hilbert schmidt operators in a sense that will be explained in the next chapter we can think of positive trace class operators and the trace as noncommutative analogues of finite measures and the expectation after proving some general properties of trace class operators we compute traces in a number of interesting examples 14 1 hilbert schmidt operators throughout this chapter we assume that h is a separable complex hilbert space definition 14 1 hilbert schmidt operators a bounded operator t l h is called a hilbert schmidt operator if n 1 t hn 2 for some equivalently for every orthonormal basis hn n 1 of h to see that this definition is independent of the orthonormal basis hn n 1 let h n n 1 be another orthonormal basis of h if t 1 and t 2 are hilbert schmidt then n 1 t 1 hn t 2 hn n 1 k 1 t 1 hn h k h k t 2 hn n 1 k 1 t 1 h k hn hn t 2 h k k 1 t 1 h k t 2 h k 14 1 this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 507 508 trace class operators using this identity with hn replaced by h n k 1 t 1 h k t 2 h k n 1 t 1 h n t 2 h n taking t 1 t 2 t we infer that for a hilbert schmidt operator t the quantity t l 2 h n 1 t hn 2 1 2 is independent of the orthonormal basis hn n 1 of h it is clear that t 6 t l 2 h for g h h we recall the notation g h for the operator on h defined by g h x x h g x h example 14 2 finite rank operators every finite rank operator is a hilbert schmidt operator indeed by a gram schmidt argument we may represent t as t k j 1 g j h j with g 1 gk h orthonormal in h and h 1 hk h completing to an orthonormal basis g j j 1 we have n 1 t gn 2 n 1 k j 1 gn h j 2 k j 1 n 1 gn h j 2 k j 1 h j 2 example 14 3 integral operator with square integrable kernel let be a finite measure space and let k l 2 be given then t f s k s t f t d t s defines a hilbert schmidt t operator on l 2 for if hn n 1 is an orthonormal basis of l 2 then t 2 l 2 h n 1 k s t hn t d t 2 d s n 1 k s t hn t d t 2 d s k s 2 l 2 d s k 2 l 2 14 1 hilbert schmidt operators 509 as a special case any d d matrix a a jk 16 j k 6 d is a hilbert schmidt operator as a linear operator on cd and a 2 l 2 cn 16 j k 6 d a jk 2 a converse to this example will be stated at the end of this section proposition 14 4 the space l 2 h of all hilbert schmidt operators on h is a hilbert space with respect to the inner product t 1 t 2 n 1 t 1 hn t 2 hn where hn n 1 is any orthonormal basis of h proof it is elementary to check that t 1 t 2 n 1 t 1 hn t 2 hn defines an inner prod uct its independence of the choice of the basis follows from 14 1 the triangle inequality in 2 implies that l 2 h is a normed space to prove com pleteness suppose that tn n 1 is a cauchy sequence in l 2 h then tn n 1 is a cauchy sequence in l h let t l h be its limit if h j j 1 is an orthonormal basis for h then for all n 1 we have n j 1 t h j 2 lim k n j 1 tkh j 2 6 lim k tk 2 l 2 h upon letting n it follows that t is a hilbert schmidt operator and t l 2 h 6 limk tk l 2 h also n j 1 tk t h j 2 lim m n j 1 tk tm h j 2 6 limsup m tk tm 2 l 2 h it follows that limk tk t l 2 h 6 limk limsupm tk tm l 2 h since the latter tends to 0 as k it follows that limk tk t in l 2 h this proves com pleteness proposition 14 5 every hilbert schmidt operator is compact and can be approxi mated in the hilbert schmidt norm by finite rank operators proof let t be a hilbert schmidt operator on h let hn n 1 be an orthonormal basis for h and denote by pn the orthogonal projection onto the span of h 1 hn then pnt is a finite rank operator and hence hilbert schmidt and we have limsup n pnt t 2 6 limsup n pnt t 2 l 2 h limsup n n n 1 t hn 2 0 510 trace class operators each pnt is a finite rank operator hence compact since uniform limits of compact operators are compact it follows that t is compact proposition 14 6 a bounded operator t l h is a hilbert schmidt operator if and only if t is a hilbert schmidt operator and in this case we have t l 2 h t l 2 h proof this is immediate from 14 1 hilbert schmidt operators have the following ideal property proposition 14 7 if t is a hilbert schmidt operator and s and u are bounded then stu is a hilbert schmidt operator and stu l 2 h 6 s t l 2 h u proof it is clear that st is a hilbert schmidt operator and st l 2 h 6 s t l 2 h applying this to u and t using proposition 14 6 it follows that u t is a hilbert schmidt operator and u t l 2 h 6 u t l 2 h u t l 2 h then tu u t is a hilbert schmidt operator and tu l 2 h u t l 2 h 6 u t l 2 h using the first step once more this implies that stu is a hilbert schmidt operator and satisfies the estimate in the statement of the proposition theorem 14 8 let f be a separable measure space that is the hilbert space l 2 is separable if t l 2 h there exists a unique k l 2 such that for almost all we have t f k f d the proof of this theorem will be given in the next section 14 2 trace class operators 14 2 a the singular value decomposition recall that a bounded operator t l h is called positive if t h h 0 for all h h every positive operator is selfadjoint 14 2 trace class operators 511 definition 14 9 trace of a positive operator the trace of a positive operator t l h is the nonnegative extended real number defined by tr t n 1 t hn hn where hn n 1 is any orthonormal basis of h to see that tr t is well defined suppose that hn n 1 and h n n 1 are orthonormal bases of h then by selfadjointness for any n 1 we have n n 1 t h n h n n n 1 j 1 t h n h j h j h n j 1 n n 1 t h j h n h n h j 6 j 1 t h j h j j 1 t h j h j this gives the bound n 1 t h n h n 6 j 1 t h j h j the converse bound is obtained by interchanging the roles of the two bases definition 14 10 trace class operators a bounded operator t l h is called a trace class operator if its modulus t t t 1 2 has finite trace proposition 14 11 if t l h is a trace class operator then t 6 tr t proof this follows from t t t 1 2 sup h 1 t h t h 1 2 sup h 1 t h t sup h 61 t h h 6 tr t using the identities of proposition 4 28 and theorem 8 11 example 14 12 finite rank operators every finite rank operator is a trace class oper ator this follows quite easily once we have proved in theorem 14 22 that the set of trace class operators is a linear subspace of l h indeed taking this result for granted we only need to observe that each rank one operator of the form t g h is a trace class operator to this end we normalise g h 1 from x t y g h x y x h g y x g y h x y g h x h g y we deduce that t h g this implies t t x h g g h x h g x h g x h g g h x h h h h x proving that t t h h this is an orthogonal projection so it equals its own square root hence t h h and tr t 1 undoing the normalisation this gives tr t g h 14 2 512 trace class operators it is instructive to present a direct proof that finite rank operators are trace class which avoids the use of theorem 14 22 if only because it provides an explicit expression for the trace of t let us write h v v with v n t finite dimensional and observe that t t maps v into v and vanishes on v indeed for v v and v v n t we have t t v v t v t v 0 since t v 0 so the range of t t is orthogonal to v and hence contained in v the second part of the claim is trivial since v n t the subspace w r t is finite dimensional denoting by tvw the restriction of t to v viewed as a mapping into w we have t t v t vw tvw indeed this follows from the fact that for all v v v we have t t v v v t t v v h t v t v h tvw v tvw v w t vw tvw v v v and the claim follows choose an orthonormal basis h j kj 1 for v and complete it to an orthonormal basis h j j 1 for h by adding the vectors in an orthonormal basis for v if j k 1 then h j v n t so t h j 2 t t 1 2 h j t t 1 2 h j t t h j h j 0 therefore j 1 t h j h j k j 1 t h j h j k j 1 t vw tvw 1 2 h j h j tr t vw tvw 1 2 proposition 14 13 every trace class operator is compact proof first assume that t is a positive trace class operator let hn n 1 be an orthonor mal basis of t then from n 1 t 1 2 hn 2 n 1 t hn hn tr t we see that t 1 2 is a hilbert schmidt operator and therefore compact hence also t t 1 2 2 is compact in the general case let t u t be the polar decomposition of t with u an isometry from r t onto r t see theorem 8 30 since the positive operator t is a trace class operator t is compact hence so is t let t be a compact operator with polar decomposition t u t viewing u as an isometry from r t onto r t its adjoint u is an isometry from r t onto r t satisfying u u i and consequently t u t it follows that t is compact definition 14 14 singular values the singular values of a compact operator t on h are the nonzero eigenvalues of the compact operator t 14 2 trace class operators 513 since t is positive every singular value is a strictly positive real number and since t is compact the set of singular values is finite or countable with 0 as its only possible accumulation point we may therefore think of the set of singular values as a nonin creasing finite or infinite sequence n n 1 this sequence where each n is repeated according to its multiplicity is called the singular value sequence according to the singular value decomposition for compact operators theorem 9 2 every compact operator t l h admits a decomposition t n 1 ngn hn with convergence in the operator norm where n n 1 is the singular value sequence of t and gn n 1 and hn n 1 are orthonormal bases in h the following theorem char acterises trace class and hilbert schmidt operators in terms of the sequence n n 1 in order to state the two cases symmetrically we use the notation t l 1 h tr t in the next section we prove that the set l 1 h of all trace class operators on h is a banach space theorem 14 15 singular value decomposition let t l h be compact and let n n 1 be its singular value sequence then 1 t is a trace class operator if and only if n 1 n in this case we have t l 1 h n 1 n 2 t is a hilbert schmidt operator if and only if n 1 2 n in this case we have t 2 l 2 h n 1 2 n in either case we have t n 1 ngn hn where gn n 1 and hn n 1 are orthonormal bases in h with convergence in the norm of l 1 h in case 1 and convergence in the norm of l 2 h in case 2 if t is positive we may take gn n 1 hn n 1 proof 1 let 1 2 be the sequence of distinct nonzero eigenvalues of t since t is selfadjoint the eigenspaces yk corresponding to k are pairwise orthogonal and since t is compact they are finite dimensional say dim yk dk by the spectral theorem for compact selfadjoint operators theorem 9 1 we have t k 1 kpk 514 trace class operators with convergence in the operator norm of l h choosing orthonormal bases hkj dk j 1 for yk we may write pk dk j 1 h k j h k j and t k 1 k dk j 1 hkj h k j again with convergence in the operator norm of l h fixing an orthonormal basis h n n 1 of h it follows that tr t n 1 t h n h n n 1 k 1 k dk j 1 h n h k j h k j h n k 1 k dk j 1 n 1 h n h k j 2 k 1 dk k n 1 n this gives the first assertion to prove convergence in the norm of l 1 h we note that t n n 1 ngn hn l 1 h n n 1 ngn hn l 1 h 6 n n 1 n gn hn l 1 h n n 1 n 0 as n making use of the fact that gn hn l 1 h 1 by 14 2 2 with the notation of 1 the doubly indexed sequence hkj k 1 16 j 6 dk is an or thonormal basis for k 1 yk and we have k 1 dk j 1 t hkj 2 k 1 dk j 1 t 2 hkj h k j k 1 dk j 1 2 k n 1 2 n since t h 0 for h y 0 n t this gives the first assertion convergence in the norm of l 2 h is proved by testing against the orthonormal basis gn n 1 t n n 1 ngn hn 2 l 2 h n n 1 ngn hn 2 l 2 h n n 1 n gn hn gn 2 l 2 h n n 1 n 2 gn hn 2 6 n n 1 n 2 0 as n at this point we briefly pause to insert a proof of theorem 14 8 14 2 trace class operators 515 proof of theorem 14 8 let t l 2 l 2 be given with l 2 separable by theorem 14 15 we have t n 1 ngn hn where gn n 1 and hn n 1 are orthonormal bases of l 2 and the nonnegative real numbers n 0 satisfy n 1 2 n then for f l 2 and almost all t f n 1 n f hn gn n 1 n f hn gn d k f d where k n 1 ngn hn is square integrable since k 2 d d m 1 n 1 m ngm gn hm hn d d m 1 n 1 m n gm gn hn hm n 1 2 n returning to the main line of development theorem 14 15 permits us to extend the trace to arbitrary trace class operators theorem 14 16 trace if t l h is a trace class operator for any orthonormal basis hn n 1 of h the sum tr t n 1 t hn hn converges absolutely the sum is independent of the choice of the basis and tr t 6 tr t proof let t u t be the polar decomposition of t with u a partial isometry from r t onto r t first consider the special case where hn n 1 is the orthonormal sequence of eigenvectors of t obtained by combining the sequences hkj dk j 1 k 1 from the proof of theorem 14 15 into one sequence so that t h n 1 n h hn hn then n 1 t hn hn n 1 u t hn hn n 1 n uhn hn 6 n 1 n tr t 516 trace class operators it follows that tr t n 1 t hn hn with absolute convergence and tr t 6 tr t now let h n n 1 be an arbitrary orthonormal basis then with the notation as above n 1 t h n h n n 1 k 1 t h n hk hk h n 6 n 1 k 1 t h n hk hk h n k 1 n 1 uh n t hk hk h n k 1 k n 1 uh n hk hk h n 6 k 1 k n 1 uh n hk 2 1 2 n 1 hk h n 2 1 2 k 1 k u hk hk 6 k 1 k this shows that n 1 t h n h n is absolutely summable moreover n 1 t h n h n n 1 k 1 t h n hk hk h n k 1 n 1 t h n hk hk h n k 1 n 1 t hk h n h n hk k 1 t hk hk k 1 t hk hk where the change of summation order is justified by the previous estimates which imply the absolute summability of the double summations definition 14 17 trace of a trace class operator the trace of a trace class operator t l h is defined by tr t n 1 t hn hn where hn n 1 is any orthonormal basis of h by theorem 14 16 the trace is well defined example 14 18 finite rank operators continued the trace of a finite rank operator t nn 1 gn hn is given by tr t n n 1 tr gn hn n n 1 gn hn here we use the fact that the trace of a rank one operator g h may be evaluated in terms of an orthonormal basis h n n 1 chosen such that h 1 h h to give tr g h n 1 g h n h n h g h if p is a not necessarily orthogonal projection onto an n dimensional subspace then tr p n 14 2 trace class operators 517 to see this we write p nn 1 gn hn with g 1 gn orthonormal from phn hn 2 gn and p 2 hn hn 2 gn hn gn we deduce that gn hn 1 and the result follows from the first part of the example more interesting examples will be given in section 14 5 we prove next that the set l 1 h of all trace class operators on h is a vector space and endowed with norm t l 1 h tr t a banach space we begin with the proof that l 1 h is a vector space it is evident that if t is a trace class operator then so is ct for all c c and tr ct c tr t additivity is less trivial and is based on a characterisation of trace class operators which we prove first the crucial ingredient is the following lemma lemma 14 19 let t l h be compact and let n n 1 be its singular value se quence then for all n 1 we have j 1 j sup g h j t g j h j sup g h j t g j h j where the suprema are taken over all finite orthonormal sequences g g j kj 1 and h h j kj 1 in h here we allow the possibility that all three expressions are infinite proof without loss of generality we assume that t 6 0 let e j be a normalised eigen vector for t with strictly positive eigenvalue j consider a polar decomposition t u t with u a partial isometry which is isometric from r t onto r t then n j 1 j n j 1 t e j e j n j 1 u te j e j n j 1 u te j e j n j 1 te j ue j where in the second identity we used that x y ux uy for all x y r t and in the third that all j are positive for the same reason ue j nj 1 is an orthonormal sequence this gives the two inequalities 6 in the converse direction let two orthonormal sequences g j nj 1 and h j n j 1 in h be given then with the above notation repetition of the second part of the proof of theorem 14 16 gives n j 1 t g j h j n j 1 k 1 g j u t ek ek h j k 1 k n j 1 g j uek ek h j 518 trace class operators 6 k 1 k n j 1 g j uek 2 1 2 n j 1 ek h j 2 1 2 6 k 1 k uek ek 6 k 1 k this concludes the proof of the equalities theorem 14 20 trace class operators for a bounded operator t l h the follow ing assertions are equivalent 1 t is a trace class operator 2 we have sup g h j 1 t g j h j the supremum being taken over all orthonormal sequences g g j j 1 and h h j j 1 of h 3 we have sup g h j 1 t g j h j the supremum being taken over all orthonormal sequences g g j j 1 and h h j j 1 of h in this situation the suprema in 2 and 3 are in fact maxima and we have t l 1 h sup g h j 1 t g j h j sup g h j 1 t g j h j proof the equivalences follow from lemma 14 19 which also gives the equalities in the final assertion of the theorem to see that the suprema are in fact maxima consider the sequences given by the singular value decomposition of theorem 14 15 the trace class condition is stated in terms of summability of its singular value se quence as a first application of theorem 14 20 we show that if an operator is a trace class operator its eigenvalue sequence is summable as well proposition 14 21 for any trace class operator t l h with eigenvalue sequence n n 1 repeated according to algebraic multiplicity we have n 1 n 6 t l 1 h proof by the multiplicativity of the holomorphic calculus the spectral subspaces x r p corresponding to nonzero points t defined as in theorem 6 25 are pairwise orthogonal moreover by corollary 7 13 each x is finite dimensional since x is invariant under t the restriction of t to x can be brought into jordan normal 14 2 trace class operators 519 form by selecting a suitable orthonormal basis x j j 1 for x here dim x is the algebraic multiplicity of it follows that t x j c j 1 x 1 c j jx j with c j j j 1 we then have t x j x j hence if i i 1 denotes the finite or infinite sequence of distinct nonzero eigenvalues of t we have n 1 n i 1 i j 1 i i 1 i j 1 t x ij x i j 6 t l 1 h the last inequality being a consequence of theorem 14 20 we continue with some results about the structure of the set of trace class operators theorem 14 22 sums if t 1 and t 2 are trace class operators on h then so is their sum t 1 t 2 and we have tr t 1 t 2 tr t 1 tr t 2 and tr t 1 t 2 6 tr t 1 tr t 2 proof let n n 1 n n 1 and n n 1 denote the singular value sequences of t 1 t 2 and t 1 t 2 respectively applying theorem 14 20 first to the compact operator t 1 t 2 and then to t 1 and t 2 separately we obtain n 1 n sup g h n 1 t 1 t 2 gn hn 6 sup g h n 1 t 1 gn hn sup g h n 1 t 2 gn hn n 1 n n 1 n where the suprema are taken over all orthonormal sequences g gn n 1 and h hn n 1 in h theorem 14 23 completeness the normed space l 1 h is a banach space and the finite rank operators are dense in this space proof suppose tn n 1 is a cauchy sequence in l 1 h then tn k 1 is a cauchy sequence in l h let t l h be its limit since each tn is compact so is t moreover for all orthonormal sequences g j j 1 and h j j 1 in h and all k 1 k j 1 t g j h j lim n k j 1 tng j h j 6 sup n 1 tn l 1 h therefore theorem 14 20 implies that t is a trace class operator also k j 1 tn t g j h j lim m k j 1 tn tm g j h j 6 limsup m tn tm l 1 h 520 trace class operators again by theorem 14 20 this implies that tn t l 1 h 6 limsup m tn tm l 1 h since the latter tends to 0 as n it follows that limn tn t in l 1 h this proves that l 1 h is complete to prove that the finite rank operators are dense it suffices to show that if t is a trace class operator then the convergence in part 2 of theorem 14 20 also takes place with respect to the norm of l 1 h the partial sums in 2 are cauchy in the norm of l 1 h thanks to the absolute summability of the sequence n n 1 and the fact that g h l 1 h g h therefore by the completeness of l 1 h the partial sums converge to some operator t l 1 h but since we know already that the sum con verges to t in l h we must have t t trace class operators have the following ideal property theorem 14 24 ideal property if t is a trace class operator and if s and u are bounded then stu is a trace class operator and stu l 1 h 6 s t l 1 h u for the proof we need a lemma which is of some independent interest lemma 14 25 every contraction is a convex combination of four unitaries proof let t l h be a contraction the two operators s 1 12 t t and s 2 1 2 i t t are selfadjoint and satisfy t s 1 is 2 the four operators u j s j i i s 2 j 1 2 are unitary and satisfy s j 1 2 u j u j proof of theorem 14 24 if u is a unitary operator the operator tu is a trace class operator and tu l 1 h 6 t l 1 h by theorem 14 20 for contractions u the same conclusion follows by combining the unitary case with lemma 14 25 and the general case follows by scaling the proof can now be finished as in proposition 14 7 proposition 14 26 a bounded operator t is a trace class operator if and only if t is a trace class operator and in this case we have tr t tr t and t l 1 h t l 1 h proof this is immediate from theorem 14 20 proposition 14 27 if t is a trace class operator and s is bounded then st and t s are trace class operators and tr st tr t s 14 3 trace duality 521 proof that st and t s are trace class operators follows from theorem 14 24 to prove the identity tr st tr t s we first assume that s is unitary if hn n 1 is an orthonormal basis for h then so is shn n 1 hence since the trace is independent of the choice of basis tr st n 1 st hn hn n 1 st shn shn n 1 t shn hn tr t s where we used that s s i the general case follows as in the previous proof by writing a contraction s as a convex combination of four unitaries we conclude with a proposition describing the relationship between trace class oper ators and hilbert schmidt operators as a preliminary observation note that the inner product of l 2 h can be reinterpreted in terms of the trace we have the trace duality t 1 t 2 tr t 2 t 1 tr t 1 t 2 proposition 14 28 a bounded operator on h is a trace class operator if and only if it is the product of two hilbert schmidt operators if t s 2 s 1 is such a decomposition then t l 1 h 6 s 1 l 2 h s 2 l 2 h proof if if s 1 and s 2 are hilbert schmidt and t s 2 s 1 then for all orthonormal sequences g j nj 1 and h j n j 1 in h and all n 1 n j 1 t g j h j 6 n j 1 s 1 g j s 2 h j 6 n j 1 s 1 g j 2 1 2 n j 1 s 2 h j 2 1 2 6 s 1 l 2 h s 2 l 2 h s 1 l 2 h s 2 l 2 h letting n by theorem 14 20 this implies that t is a trace class operator and satisfies the inequality t l 1 h 6 s 1 l 2 h s 2 l 2 h only if using a polar decomposition t u t with u a partial isometry take s 1 t 1 2 and s 2 u t 1 2 since t is a trace class operator t 1 2 is a hilbert schmidt operator and hence so are s 1 and s 2 14 3 trace duality we have already noted that the space l 2 h of hilbert schmidt operators on h is a hilbert space with respect to the inner product given by trace duality t 1 t 2 tr t 1 t 2 t 1 t 2 l 2 h 522 trace class operators the next theorem establishes that by the same formula l 1 h can be identified iso metrically as the dual of k h the closed subspace of l h consisting of all compact operators on h and l h as the dual of l 1 h theorem 14 29 trace duality by trace duality we have isometric isomorphisms k h l 1 h and l 1 h l h more precisely the following results hold 1 for every t l 1 h the mapping t k h c given by t s tr st is linear and bounded and satisfies t k h t l 1 h and conversely for every k h there exists a unique t l 1 h such that t 2 for every t l h the mapping t l 1 h c given by t s tr st is linear and bounded and satisfies t l 1 h t l h and conversely for every l 1 h there exists a unique t l h such that t the point of working with tr st rather than tr st is that this makes the identifi cations of the duals into a linear correspondence rather than a conjugate linear one proof 1 linearity of t is clear and boundedness follows from theorem 14 24 which also gives the upper bound t k h 6 t l 1 h to conclude the proof of 1 it remains to show that every k h is of the form t for some t l 1 t and that the converse inequality t l 1 h 6 t k h holds this also gives uniqueness let k h be given the inclusion mapping i l 2 h k h is contin uous so the same is true for the functional i l 2 h c by the riesz representation theorem there exists a unique t l 2 h such that s s s t l 2 h s l 2 h let t u t be its polar decomposition and let gn n 1 be an orthonormal basis for r t denoting by pn nj 1 g j g j the orthogonal projection onto the span of g 1 gn n 1 t gn gn n 1 u t gn gn n 1 ugn t gn 14 4 the partial trace 523 lim n pnupn t l 2 h limn pnupn where the nonnegativity of the first expression justifies the second equality because is continuous it follows that pnupn ipnupn 6 i pnupn 6 which proves that t is a trace class operator with t l 1 h tr t 6 we now show that t for all g h h we have t g h tr g h t tr h t g tr t g h t g h g t h on the other hand if hn n 1 is an orthonormal basis such that h 1 h g h g h t n 1 g h hn t hn h h g t h g t h by linearity this proves the identity t s s for all finite rank operators s since these are dense in k h by proposition 7 6 it follows that t as claimed 2 again linearity is clear and boundedness follows from theorem 14 24 which also gives the upper bound t l 1 h 6 t l h the converse inequality follows from t l h sup x y 61 t x y sup x y 61 tr t x y sup x y 61 t x y 6 t sup x y 61 x y l 1 h t which also gives uniqueness to conclude the proof of 2 it remains to show that every l 1 h is of the form t for some necessarily unique t l h by the riesz representation theorem for any h h there is a unique element t h h such that g t h g h g h and the mapping h 7 t h is linear from the identity it is immediate that t is bounded with t 6 as in the proof of 1 for all finite rank operators s we have s t s by theorem 14 23 the finite rank operators are dense in l 1 h therefore t 14 4 the partial trace if we think of the trace as the noncommutative analogue of the expectation the partial trace of a trace class operator is then the noncommutative analogue of the conditional expectation of a random variable 524 trace class operators using the notation of appendix b we introduce the following definition definition 14 30 hilbert space tensor product the hilbert space tensor product of the hilbert spaces h 1 hn is the completion of the algebraic tensor product h 1 hn with respect to the norm obtained from the inner product k i 1 g i 1 g i n j 1 h j 1 h j n k i 1 j 1 n n 1 g i n h j n with slight abuse of notation the hilbert space tensor product of h 1 hn is de noted again by h 1 hn we leave it to the reader to check that if h 1 hn are separable with an orthonormal basis h n j j 1 for each hn then the tensors h 1 j 1 h n jn form an orthonormal basis for h 1 hn if 1 1 n n are finite measure spaces then the linear mapping from l 2 1 1 l 2 n n into l 2 1 n 1 n defined by f 1 fn 7 1 n 7 n n 1 fn n extends uniquely to an isometric isomorphism l 2 1 1 l 2 n n l 2 1 n 1 n 14 3 now let h and k be hilbert spaces if s l h then the operator s i defined on the algebraic tensor product of h and k by s i h k sh k and extended by linearity extends to a bounded operator on the hilbert space tensor product h k and s i s we leave the proof of this simple fact as an exercise to the reader a more general version of this result will be proved in section 15 6 c see proposition 15 65 for k k let uk h h k be given by ukh h k its hilbert space adjoint equals u k h k k k h theorem 14 31 partial trace let h and k be separable hilbert spaces and let t l 1 h k there exists a unique operator trk t l 1 h such that for all s l h we have tr trk t s tr t s i 14 4 14 4 the partial trace 525 the mapping t 7 trk t is called the partial trace with respect to k and is obtained by tracing out k proof we claim that if vn n 1 is an orthonormal basis of k the sum trk t n 1 u vntuvn 14 5 converges in l 1 h and its sum has the required properties by theorem 14 24 each operator u vntuvn is a trace class operator hence by theo rem 14 20 for each n 1 there exist orthonormal sequences g n j j 1 and h n j j 1 of h such that u vntuvn l 1 h j 1 u vntuvng n j h n j it follows that n 1 u vntuvn l 1 h n 1 j 1 u vntuvng n j h n j n 1 j 1 t g n j vn h n j vn where the last step uses that t is a trace class operator and the sequences g n j vn j n 1 and h n j vn j n 1 are orthonormal in h k next we check the required identity if um m 1 is an orthonormal basis for h then tr trk t s n 1 tr u vntuvns n 1 m 1 tuvnsum uvnum n 1 m 1 t s i um vn um vn tr t s i it remains to prove uniqueness if a is a trace class operator on h such that tr as tr trk t s for all s l h then theorem 14 29 implies that a trk t example 14 32 partial trace of a rank one projection if h h and k k have norm one and t h k h k is the corresponding rank one projection in h k then trk t is the rank one projection h h in h trk t h h indeed for all s l h we have tr trk t s tr t s i s i h k h k sh k h k sh h k k sh h tr h h s 526 trace class operators the result now follows from the uniqueness part of theorem 14 31 in the terminology of the next chapter the following proposition states that the partial trace of a state is again a state proposition 14 33 let h and k be separable hilbert spaces and let t l 1 h k then 1 if t has unit trace then so has trk t 2 if t is positive then so is trk t proof both properties are immediate consequences of the formulas 14 4 and 14 5 for the partial trace indeed the first implies that if tr t 1 then for any orthonormal basis un n 1 of h tr trk t n 1 trk t un un n 1 tr trk t un un n 1 tr t un un i n 1 j k 1 t un un i u j vk u j vk n 1 j k 1 t un un u j vk u j vk n 1 k 1 tun vk un vk tr t 1 this proves 1 assertion 2 follows from trk t h h n 1 u vntuvnh h n 1 tuvnh uvnh 0 14 5 trace formulas in this final section we illustrate the preceding theory by computing traces in a number of interesting situations 14 5 a lidskii s theorem if t is a linear operator acting on cd we may select an orthonormal basis with respect to which its matrix representation is in jordan normal form using this basis we find 14 5 trace formulas 527 that tr t d n 1 n where 1 d are the eigenvalues of t repeated according to their algebraic multi plicities see example 7 16 if t is a normal trace class operator on a hilbert space h the spectral theorem for compact normal operators allows us to select an orthonormal basis for h consisting of eigenvectors in the following way for each of the eigenspaces corresponding to the eigenvalues of t we select an orthonormal basis these eigenspaces are mutually orthogonal and the union of these bases after a relabelling is an orthonormal basis hn n 1 for h for this basis we have tr t n 1 t hn hn n 1 n where n n 1 is the sequence of nonzero eigenvalues of t repeated according to their multiplicities in the last sum we left out the indices corresponding to eigenvalue n 0 and did another relabelling the following deep result asserts that these formulas for the trace extend to general trace class operators theorem 14 34 lidskii for every trace class operator t we have tr t n 1 n where n n 1 is the sequence of nonzero eigenvalues of t repeated according to their algebraic multiplicities here we use the convention tr t 0 in case there are no nonzero eigenvalues we present the beautiful proof of this theorem due to simon which is based on the theory of fredholm determinants in order to introduce these we need some notation from multi linear algebra we refer to appendix b for the definitions the n fold exterior product of a vector space v is denoted by nv if t is a linear operator on v then n t v 1 vn t v 1 t vn defines a linear operator n t on n v it is the restriction to n v of the n fold tensor product t n acting on v n if s is another linear operator on v then n st n s n t if h is a hilbert space and t is bounded on h then n t is bounded on n h which is a hilbert space in a natural way and its adjoint equals n t n t from this we infer that n t n t thus if j j 1 is the singular value se quence of t the singular values of n t are j 1 jn with j 1 jn it follows 528 trace class operators that n t is a trace class operator and n t l 1 nh j 1 jn jn jn 1 n j 1 jn 1 j 1 jn 1 n t nl 1 h 14 6 for n n matrices a we have the following identity relating the determinant to traces and exterior products known as macmahon s formula det 1 a n k 0 tr ka with the convention that 0 t i a proof is sketched in problem 14 13 observ ing that k v 0 when k dim v macmahon s formula suggests the following definition definition 14 35 fredholm determinant let t l h be a trace class operator the fredholm determinant of i t is defined as det i t n n tr n t the sum on the right hand side is absolutely convergent since n n tr n t 6 n 1 n t l 1 nh 6 n n 1 n t nl 1 h exp t l 1 h 14 7 the crucial step in the proof of lidskii s theorem is to establish the following identity valid for all trace class operators t and all c det i t n 1 1 n here n n 1 is the sequence of eigenvalues of t repeated according to algebraic multi plicities notice that proposition 14 21 guarantees the convergence of the infinite prod uct once this formula has been obtained lidskii s theorem is immediate by compar ing the linear term of this product with the linear term in the definition det i t n n n tr n t the remainder of this section is devoted to proving lidskii s theorem we fix a sepa rable hilbert space h and start with some preliminary results lemma 14 36 let t be a bounded operator on h such that t pt p for some or thogonal projection p on h of finite rank viewing pt p as an operator on the finite dimensional hilbert space r p we have det i t det ir p pt p 14 5 trace formulas 529 proof the identity t pt p implies that t is of rank at most and therefore we have n t 0 for n for 06 n 6 we have tr n t tr n pt p applying definition 14 35 twice det i t n 0 tr n t n 0 tr n pt p n 0 tr n pt p r p det ir p pt p lemma 14 37 let t l h be a trace class operator and let n n 1 be its singular value sequence repeated according to multiplicities then det i t 6 n 1 1 n proof it follows from 14 6 that det i t 6 n n tr n t 6 n n n t l 1 nh 6 n n 1 n j 1 jn 1 j 1 jn 6 n 1 1 n lemma 14 38 let t l h be a trace class operator for all 0 there exists a constant c 0 such that for all c we have det i t 6 c exp proof using the inequality 1 t 6 exp t lemma 14 37 implies for any n 1 det i t 6 n 1 1 n 6 n n 1 1 n exp n n 1 n fix 0 if we choose n 1 so large that n n 1 n 1 2 the desired estimate is obtained with c sup c n n 1 1 n exp 1 2 lemma 14 39 the map t 7 det i t is continuous from l 1 h to c 530 trace class operators proof suppose tj t in l 1 h as j fix 0 and choose n 0 so large that n n 1 c n n 13 where c sup j tj l 1 h then by 14 7 det i tj det i t 6 2 3 n n 1 tr n tj n t denoting by pn the orthogonal projection in h n onto n h we have tr n tj n t tr pn t nj t n pn 6 tr t nj t n 6 ncn 1 tj t l 1 h if we choose n 1 so large that also tj t l 1 h 1 3 n n 1 nc n 1 1 for j n then det i tj det i t for j n lemma 14 40 if s t l h are trace class operators then det i t det i s det i t i s proof first assume that t and s are both of finite rank let p be a finite rank projection in h whose range contains the ranges of t t s and s with m being the rank of p from lemma 14 36 we obtain det i t det i s tr m p i t p tr m p i s p tr m p i t p m p i s p tr m p i t i s p det i t i s here we used that m r p is one dimensional so that the trace is multiplicative on this space this proves the lemma for finite rank operators t and s by lemma 14 39 the general case now follows by approximation proposition 14 41 if t l h is a trace class operator then i t is invertible if and only if det i t 6 0 proof suppose first that i t is invertible and let s t i t 1 then s is a trace class operator and an easy computation gives i t i s i it follows from lemma 14 40 that det i t det i s det i 1 so det i t 6 0 if i t is not invertible then 1 is an eigenvalue of t denoting the corresponding spectral projection by p then from lemma 14 40 and the commutation relation t p pt we obtain det i t p det i t i p det i t p t i p t pt i p det i t denote by the algebraic multiplicity of 1 by lemma 14 36 applied to t p det i t p is the determinant of a finite dimensional noninvertible operator and there fore it equals 0 this proves that det i t det i t p 0 14 5 trace formulas 531 proposition 14 42 if t l h is a trace class operator with nonzero eigenvalue 1 0 of algebraic multiplicity then f det i t has a zero at 0 of multi plicity proof denoting by p the spectral projection associated with 1 0 we have det i t det i t p det i t i p and det i t i p 6 0 by proposition 14 41 the operator t p vanishes on the range of i p and its restriction to the range of p has spectrum 1 0 thus for 06 n 6 tr n t p 16 j 1 jn 6 0 n n 0 n and consequently det i t p n 0 n 0 n 1 0 the next lemma from complex function theory is stated without proof lemma 14 43 let f be an entire function whose zeroes z 1 z 2 counting multiplic ities satisfy n 1 1 zn assume furthermore that f 0 1 and that for all 0 there exists a constant c 0 such that f z 6 c exp z then f z n 1 1 z zn z c theorem 14 44 if t l h is a trace class operator with eigenvalue sequence n n 1 repeated according to algebraic multiplicities then for all c we have det i t n 1 1 n proof by propositions 14 41 and 14 42 the zeroes of f det i t count ing multiplicities are precisely the points 1 n proposition 14 21 and lemma 14 38 show that the assumptions of lemma 14 43 hold for this function the result now fol lows from the lemma proof of theorem 14 34 the linear term in the taylor expansion of det i t n n tr n t equals tr 1 t tr t on the other hand by theorem 14 44 this term equals n 1 n 532 trace class operators 14 5 b trace formula for integral operators the trace of an integral operator with continuous kernel can be computed as follows theorem 14 45 mercer let be a finite borel measure on a compact metric space k let t be an integral operator on l 2 k of the form t f x k k x y f y d y with continuous kernel k c k k then 1 if t is a trace class operator then its trace is given by tr t k k y y d y 2 if t is positive that is if t f f 0 for all f l 2 k then t is a trace class operator by an argument similar to that employed in the proof below one sees that t is positive if and only if the kernel k is positive definite in the sense that for all finite choices of t 1 tn s and z 1 zn c we have n n m 1 k tm tn zmzn 0 proof it has been observed in remark 2 31 that l 2 k is separable 1 suppose that the integral operator t is a trace class operator by proposition 14 28 we have t s 2 s 1 with s 1 s 2 hilbert schmidt on l 2 k accordingly by theorem 14 8 there exist k 1 k 2 l 2 k k such that for almost all s k we have t f s k k k 2 s t k 1 t u f u d u d t as a result for almost all s t k k we have k s t k k 2 s t k 1 t u f u d u by theorem 14 29 tr t tr s 2 s 1 s 1 s 2 l 2 l 2 k k 1 k 2 l 2 k k k k k 1 s t k 2 t s d s d t k k s s d s where follows from the fact which follows from example 14 2 and theorem 14 8 14 5 trace formulas 533 that the correspondence between hilbert schmidt operators and their square integrable kernels is unitary 2 by the result of example 7 7 t is compact and the positivity of t implies that its singular value sequence equals its sequence of nonzero eigenvalues n n 1 taking into account multiplicities the rest of the proof is accomplished in two steps step 1 let hn n 1 be an orthonormal basis of eigenvectors in l 2 k correspond ing to the sequence n n 1 the uniform continuity of k implies that t maps l 2 k into c k and therefore t hn nhn implies hn c k for all n 1 as a consequence for each n 1 the kernel kn s t k s t n j 1 jh j s h j t s t k is continuous let f l 2 k then t f f n 1 m 1 n f hn hn f hm hm n 1 n f hn 2 and therefore k k kn s t f t f s d t d s t f f n j 1 j k k f t h j t f s h j s d t d s n 1 n f hn 2 n j 1 j f h j 2 0 in particular for any borel sets b of positive measure 1 b 2 k k kn s t 1 b t 1 b s d t d s 0 14 8 by a limiting argument applying 14 8 to a sequence of balls b t rn centred at a given point t supp with radii rn 0 from this inequality and the continuity of kn we obtain kn t t 0 for almost all t k for all n 1 and t k then 06 k kn t t d t k k t t d t n j 1 j k h j t 2 d t k k t t d t n j 1 j letting n we obtain that t l 1 h and t l 1 h tr t j 1 j 6 k k t t d t 534 trace class operators in the positive case the trace formula can be alternatively proved by the following more elementary argument for m 1 2 let k m n nm n 1 be a partition of k of mesh less than 1 m for 16 n 6 nm let h m n 1 k m n k m n here and in what follows we discard those indices for which k m n 0 without expressing this in our notation in order not to overburden it this sequence is orthonormal in l 2 k using the uniform continuity of k we obtain lim m nm n 1 t h m n h m n lim m nm n 1 1 k m n k m n k m n k x y d x d y lim m nm n 1 1 k m n k m n k m n k y y d x d y lim m nm n 1 k m n k y y d y k k y y d y hence by theorem 14 20 k k y y d y lim m nm n 1 t h m n h m n 6 tr t 14 5 c trace formula for fredholm operators the following theorem gives a formula for the index of a fredholm operator in terms of traces theorem 14 46 fedosov let t l h be a fredholm operator and let s l h be an operator such that both i st and i t s are finite rank operators then the commutator t s t s st is a trace class operator and tr t s ind t by atkinson s theorem theorem 7 23 operators s with the stated properties always exist proof the operator t s i st i t s is of finite rank and hence a trace class operator if s l h is another operator such that i s t and i t s are of finite rank then r s s is of finite rank and tr t s s t tr t s st t r rt tr t s st tr t r rt tr t s st using that r is a trace class operator and therefore tr t r tr rt by proposition 14 27 to prove the theorem it therefore suffices to prove it for the bounded operator s 14 5 trace formulas 535 l h constructed in the proof of theorem 7 23 this operator enjoys the follow ing properties i i st and i t s are finite rank projections and ii dimn t dimr i st and codimr t dimr i t s since the rank of a finite rank projec tion is equal to its trace by example 14 18 we have ind t dimn t codimr t tr i st tr i t s tr t s st 14 5 d trace formula for commutators of toeplitz operators from section 7 3 d we recall that h 2 d is the vector space of all holomorphic functions on d of the form n n cnzn with n n cn 2 identifying it with the closed subspace of l 2 t consisting of all functions whose negative fourier coefficients vanish h 2 t is the range of the riesz projection p n z f n en 7 n n f n en in l 2 t where en ein this projection discards the terms in the fourier series f n n z of f corresponding to the negative indices n 1 2 given a function l t the toeplitz operator with symbol has been defined as the bounded operator t on h 2 d given by t f p f f h 2 d it follows from lemma 7 30 that for all c t the commutator t t t t t t is compact for functions c 2 t we have the following stronger result theorem 14 47 helton howe for all c 2 t the commutator t t is a trace class operator and tr t t 1 2 i d 14 9 proof the proof is a matter of computation first ten tem is a finite rank operator of rank at most min m n and therefore by 14 2 it is a trace class operator with ten tem l 1 h 2 d 6 min m n 14 10 second for all n m z and j n we have tenteme j nm j en m j with nm j 0 1 so that tr ten tem j 0 nmj mn j en m j e j 14 11 536 trace class operators case 1 n m 6 0 in that case 14 11 gives tr ten tem 0 1 2 i en e m d case 2 n m 0 in this case n nj 0 if j n and n n j 1 if j n while always n nj 1 and 14 11 gives tr ten tem n n 2 en e n d 1 2 i en e m d this completes the proof of 14 9 for en and em since both the left and right hand side of 14 9 are linear in both and for n n anen and n n bnen we have t t m n n anbm ten tem 14 12 and hence taking traces tr t t m n n anbm tr ten tem m n n anbm 1 2 en e m d 1 2 i d provided the sum in 14 12 converges in l 1 h 2 d keeping in mind 14 10 this can be guaranteed if we assume that and are c 2 for then an and bn are of order o 1 n 2 as n and m n z min m n 1 m 2 1 n 2 m z n z n 6 m n 1 m 2 1 n 2 n z m z m n m 1 m 2 1 n 2 k z log 1 k 1 k 2 14 5 e trace formula for the dirichlet heat semigroup let d be a bounded open subset of rd satisfying d 0 and let sdir be the c 0 semigroup on l 2 d generated by the dirichlet laplacian dir associated with d theorem 14 48 trace formula for the dirichlet heat semigroup for all t 0 the operator sdir t is a trace class operator on l 2 d with lim t 0 td 2 tr sdir t d 4 d 2 14 5 trace formulas 537 for the proof of this formula we need the following lemma lemma 14 49 let be a borel measure on 0 whose laplace transform satisfies l t 0 e tx d x for all t 0 if for some r 0 and a r we have lim x x r 0 x a then lim t 0 trl t a 1 r where s 0 x s 1 e x dx s 0 is the euler gamma function proof integrating by parts and setting x 0 x we have trl t tr 0 e tx d x tr 1 0 e tx x dx tr 0 e y y t dy 0 e y t y r 1 y t r y t dy by assumption we have limx x r x a and therefore for all y 0 lim t 0 1 y t r y t a in particular we have c supx 0 1 x r x and therefore e y t y r 1 y t r y t 6 ce y t y r and for 06 t 6 1 we can bound the right hand side by ce y 1 y r it follows that the dominated convergence theorem can be applied to obtain lim t 0 trl t a 0 e yyr dy a 1 r proof of theorem 14 48 as was observed in the course of the proof of theorem 12 26 the resolvent operators r dir are compact and this implies the compactness of the inclusion mapping of d dir into l 2 d by analyticity for each t 0 the oper ator sdir t maps l 2 d into d dir boundedly and therefore sdir t is compact as a bounded operator on l 2 d we can now apply the spectral mapping formula proposi tion 13 20 evaluating the trace against an orthonormal basis consisting of eigenvectors we conclude that sdir t is a trace class operator and tr sdir t n 1 e nt 538 trace class operators where 0 1 2 is the enumeration counting multiplicities of the eigen values of dir the finiteness of this sum is a consequence of weyl s theorem theo rem 12 29 we now apply lemma 14 49 to the borel measure n 1 n setting n x max n 1 n 6 x by weyl s theorem we have lim x x d 2 0 x lim x x d 2 n x d 2 d d where d d 2 1 1 2 d is the volume of the unit ball in r d lemma 14 49 allows us to conclude that lim t 0 td 2 tr sdir t lim t 0 td 2 n 1 e nt lim t 0 td 2 t d 2 d d 1 d 2 d 4 d 2 14 5 f euler s identity revisited consider the dirichlet laplacian dir on l 2 0 1 as shown in example 12 23 the spectrum of this operator equals dir 2 n 2 n 1 2 and consists of the eigenvalues corresponding to the eigenfunctions fn t sin n t as a consequence of lemma 12 25 the spectrum of the inverse operator 1 dir is given by 1 dir 1 2 n 2 n 1 2 3 and it again consists of the eigenvalues since 1 dir is positive it follows from mercer s theorem that n 1 1 2 n 2 tr 1 dir 1 0 k t t dt where k is green s function for the poisson problem on the unit interval with dirichlet boundary conditions from section 11 2 a we recall that it is given by k s t 1 t s s 6 t 1 s t t 6 s in view of 1 0 k t t dt 1 0 1 t t dt 1 6 we recover euler s identity n 1 1 n 2 2 6 problems 539 problems 14 1 show that if t l h is a trace class operator and u l h is unitary then utu is a trace class operator and tr t tr utu 14 2 show that if a l h is a positive trace class operator then a 6 tr a i that is tr a i a is positive 14 3 prove the following properties of the partial trace a if t l 1 h k then tr trk t tr t b if a 1 a 2 l h then a 1 i t a 2 i l 1 h k and trk a 1 i t a 2 i a 1 trk t a 2 c if a l 1 h and b l 1 k then t a b l 1 h k and trk t tr b a 14 4 show that if s x x and t y y with x y 1 are two rank one orthog onal projections then s t 2 1 x y 2 1 tr st 14 5 consider a bounded operator t l h show that the following assertions are equivalent 1 t is a trace class operator respectively hilbert schmidt 2 exp t i is a trace class operator respectively hilbert schmidt hint compare with problem 7 10 14 6 prove the two assertions made after definition 14 30 14 7 let t l 2 0 1 l 0 1 be a bounded operator and let hn n 1 be an orthonor mal basis for l 2 0 1 a show that for every k 1 there exists a null set nk 0 1 such that for all c kk we have k j 1 c jt h j t 6 t t 0 1 nk b deduce from part a that k j 1 t h j t 2 6 t 2 t 0 1 nk let i l 0 1 l 2 0 1 be the inclusion mapping c show that i t is hilbert schmidt on l 2 0 1 and t l 2 l 2 0 1 6 t 540 trace class operators 14 8 prove that if t l h is selfadjoint and s l h is compact and if the com mutator t s is a trace class operator then tr t s 0 hint compute the traces of t s s relative to orthonormal bases which diag onalise s s 14 9 let s t l h be selfadjoint trace class operators let f r r be a convex c 1 function a show that for all norm one vectors h h we have f t h h f t h h f sh h f sh h t s h h hint for the first inequality expand h against an orthonormal basis of eigen vectors of t b deduce that tr f t tr f s tr f s t s hint show that if h is an eigenvector of s then the right hand side in the identity of part a equals f s f s t s h h 14 10 prove the following analogue of proposition 14 21 if t l h is a hilbert schmidt operator with eigenvalue sequence n n 1 repeated according to alge braic multiplicity then n 1 n 2 6 t 2 l 2 h 14 11 let t be a d d matrix and let n dn 1 and n d n 1 be the sequences of nonzero eigenvalues and singular values of t respectively repeated according to algebraic multiplicities show that d n 1 n d n 1 n hint use the result from linear algebra that there exists a unitary d d matrix u such that u tu is upper triangular and has 1 d on the diagonal to see that det t dn 1 n apply this to t 14 12 let t l h be compact and let 1 2 0 be the sequence of its nonzero singular values repeated according to multiplicities show that for all n 1 we have n inf y h dim y n 1 sup y 1 y y ty where the infima are taken over all subspaces y of h of dimension n 1 hint use theorem 9 4 problems 541 14 13 complete the following outline of a proof of macmahon s formula det 1 a n j 0 tr j a for complex n n matrices a a prove the formula for the special case when a is diagonalisable by showing that in this case the formula reduces to the identity n k 0 1 k n k 0 16 i 1 ik 6 n i 1 ik b complete the proof by showing that the diagonalisable matrices are dense in mn c 14 14 prove the following symmetric analogue of macmahon s formula for complex n n matrices a one has 1 det 1 a n j 0 tr j a 14 15 let be smooth functions on the unit circle and let f g d r denote their harmonic extensions applying green s theorem to f g x f g y show that theo rem 14 47 implies the identity tr t t 1 2 i d f x g y g x f y dxdy 14 16 using fedosov s theorem prove that if t is a fredholm operator on h and t u t is its polar decomposition then ind t tr uu u u hint show that i u u and i uu are the projections onto the null spaces of t and t respectively and that codimr t dimn t 14 17 use fedosov s theorem to give an alternative proof of the identity ind t 1 t 2 ind t 1 ind t 2 for fredholm operators t 1 and t 2 acting on h 15 states and observables in this final chapter we apply some of the ideas developed in the preceding chapters to set up a functional analytic framework for quantum mechanics more specifically we will show how the replacement of borel sets in classical mechanics by orthogonal pro jections in a hilbert space leads in a natural way to the quantum mechanical formalism for states and observables 15 1 states and observables in classical mechanics we start by taking a brief look at the notions of state and observable in classical me chanics from a rather abstract measure theoretic point of view 15 1 a states in classical mechanics the state space of a physical system is a measurable space x x typically a manifold with its borel algebra for example the state space of an ensemble of k free moving point particles in r 3 is r 3 k r 3 k three position coordi nates x j and three momentum coordinates p j for each particle and that of the harmonic oscillator with physical constants normalised to unity is the submanifold of r r given by x 2 p 2 1 definition 15 1 states pure states let x x be a measurable space i a state is a probability measure on x x this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 543 544 states and observables ii a pure state is an extreme point of the set of probability measures on x x for a measurable set b x the number b is thought of as the probability that the state is described by a point in b thus we identify the state of a system with the ensemble of truth probabilities of certain questions about the system for example the exact positions and momenta of all particles in a gas container at a given time cannot be known with complete precision but one might ask about the probability of finding a certain portion of the gas in a certain subset of the container recall that a measure on x x is said to be atomic if whenever we have b 0 and b b 0 b 1 with disjoint b 0 b 1 x it follows that either b 0 0 or b 1 0 proposition 15 2 the pure states are precisely the atomic probability measures proof this was shown in example 4 35 15 1 b observables definition 15 3 observables let f be a measurable space an valued ob servable is a measurable function f x an elementary observable is a 0 1 valued observable for example the three position coordinates x j and momentum coordinates p j of a free moving particle in r 3 are real valued observables on the state space x r 3 r 3 and so are the kinetic energy p 2 2 m where the mass m is treated as a constant and potentials v x if is a state on x x and f x is an observable then for f f the number f 1 f x x f x f belongs to the interval 0 1 and is interpreted as the probability that measuring f results in a value in f when the system is in state 15 1 c from classical to quantum an elementary observable is of the form 1 b with b x its range equals 0 1 unless b or b x in which case one has 1 0 and 1 x 1 orthogonal projections in a complex hilbert space enjoy similar properties spectrally if p is an orthogonal projection in a hilbert space h its spectrum equals p 0 1 unless p 0 or p i in these cases one has 0 0 and i 1 the basic idea that underlies quantum mechanics is to replace elementary observ ables by orthogonal projections the set of all orthogonal projections in a complex 15 2 states and observables in quantum mechanics 545 hilbert space h is denoted by p h this set is partially ordered in a natural way by declaring p 1 6 p 2 to mean that the range of p 1 is contained in the range of p 2 this is equivalent to the statement that the operator p 2 p 1 is positive with respect to this par tial ordering p h is a lattice in the sense of definition 2 50 for p 1 and p 2 in p h the greatest lower bound p 1 p 2 in p h is the orthogonal projection onto r p 1 r p 2 and the least upper bound p 1 p 2 in p h is the orthogonal projection onto the closed subspace spanned by r p 1 and r p 2 in addition to these operators the negation of an orthogonal projection p p h is the orthogonal projection p i p onto the orthogonal complement of r p one has the associative laws p 1 p 2 p 3 p 1 p 2 p 3 p 1 p 2 p 3 p 1 p 2 p 3 and the identities p 1 p 2 p 1 p 2 p 1 p 2 p 1 p 2 the important difference with the classical setting is that the distributive laws p 1 p 2 p 3 p 1 p 2 p 1 p 3 p 1 p 2 p 3 p 1 p 2 p 1 p 3 generally fail example 15 4 in c 2 consider the orthogonal projections p 1 p 2 and p 3 onto the first and second coordinate axes and the diagonal respectively then p 1 p 2 i p 1 p 3 p 2 p 3 0 and p 1 p 2 p 3 p 3 p 1 p 3 p 2 p 3 0 15 2 states and observables in quantum mechanics from now on h is a separable complex hilbert space 546 states and observables 15 2 a states upon replacing indicator functions of measurable sets by orthogonal projections in h one is led to the idea to define a state as a mapping p h 0 1 that satisfies 0 0 i 1 and is countably additive in the sense that n 1 pn p whenever pn n 1 is a finite or infinite sequence of pairwise disjoint orthogonal pro jections and p is their least upper bound that is p is the orthogonal projection onto the closure of the span of the ranges of pn n 1 here two orthogonal projections are called disjoint if their ranges are mutually orthogonal and a family of projections said to be disjoint if every two distinct members of this family are disjoint although this definition is quite satisfactory in many ways it suffers from the defect that it does not present an obvious way to extend to nonnegative linear combinations of pairwise disjoint orthogonal projections in the classical picture the expected value of a nonnegative simple function f nn 1 cn 1 bn in state is given by its integral x f d n n 1 cn bn the desideratum n n 1 cnpn n n 1 cn pn 15 1 can be thought of as a quantum analogue of this and constitutes the first step towards defining the expected value for more general classes of observables however if one attempts to take 15 1 as a definition a problem of well definedness arises that such a problem indeed may arise is demonstrated by the example at the end of this section the next definition proposes a way around this difficulty recall that the convex hull of a subset s of a vector space v is the smallest convex set in v containing s and is denoted by co s definition 15 5 affine mappings let s be a subset of a vector space v a mapping s 0 1 is called affine if it extends to a mapping co s 0 1 satisfying n n 1 nvn n n 1 n vn for all n 1 v 1 vn s and scalars 1 n 0 satisfying nn 1 n 1 let us denote by pfin h the set of all finite rank projections in p h that is the set of all projections with finite dimensional ranges to prepare for the definition of a state we prove the following result proposition 15 6 let pfin h 0 1 be affine and satisfy 0 0 then there 15 2 states and observables in quantum mechanics 547 exists a unique positive trace class operator t on h such that p tr pt p pfin h it satisfies tr t sup p pfin h p conversely if t is a positive trace class operator on h then p tr pt p p h defines an affine mapping p h 0 1 satisfying 0 0 and sup p pfin h p sup p p h p i tr t moreover countably additive proof to prove uniqueness suppose that t t l h are such that tr pt tr pt for all p pfin h taking p to be the rank one projection h h x 7 x h h with h h of norm one gives t h h t h h by scaling this identity extends to arbitrary h h and it implies t t by proposition 8 1 the existence proof proceeds in several steps step 1 throughout this step it is important to keep in mind that when considering general convex or nonnegative linear combinations of projections p 1 pn in pfin h the projections pn need not be mutually orthogonal and the same projection may be used multiple times fix orthogonal projections p 1 pn pfin h and scalars 0 6 c 1 cn 6 1 sat isfying nn 1 6 1 with cn 1 1 n n 1 cn and pn 1 0 the affinity assumption implies n n 1 cnpn n 1 n 1 cnpn n 1 n 1 cn pn n n 1 cn pn where we used that 0 0 also if an operator admits two such representations say n n 1 cnpn n n 1 c np n then by the same argument the affinity of implies that n n 1 cn pn n n 1 c n p n consider next the case of scalars c 1 cn 0 and consider an operator of the form 548 states and observables s nn 1 cnpn with projections pn pfin h fix an arbitrary integer k n n 1 cn then by what we just proved the number k 1 k s k n n 1 cn k pn k n n 1 cn k pn n n 1 cn pn is independent of k hence we may define an extension of again denoted by by s k 1 k s n n 1 cn pn if s admits two such representations say s nn 1 cnpn n n 1 c np n then by taking k max nn 1 cn n n 1 c n and using the well definedness in the case already considered we obtain that s is well defined the extension just defined is finitely additive on the set of operators s of the form just described indeed this follows by induction from the fact that if s nn 1 cnpn and s n n n 1 cnpn are two such operators then s s n n 1 cnpn n n 1 cn pn n n 1 cn pn n n n 1 cn pn s s shifting the index in the expression for s is justified since no restrictions are imposed on the projections occurring in the expressions for s and s other than their membership of pfin h cf the remark at the beginning of the proof step 2 consider now an operator of the form s nn 1 cnpn with coefficients cn r and projections pn pfin h then we may write s s s where s are nonnegative linear combinations of projections in pfin h as in step 1 and define s s s to see that this is well defined let s s s s s be two such representations by the finite additivity proved in step 1 s s s s s s s s so s s s s as desired similarly it is checked that c s cs for all c r and that s s s s if s nn 1 cnpn with coefficients cn c and projections p pfin h we set s 1 2 s s 1 2 i i s s 15 2 then is easily seen to be additive and real linear and from is 1 2 is is 1 2 i i is is 15 2 states and observables in quantum mechanics 549 i 1 2 i is is 1 2 s s i s it follows that is in fact complex linear step 3 let s k h be any finite rank operator we may represent s as nn 1 cnpn with c 1 cn c and mutually orthogonal projections p 1 pn pfin h in doing so we obtain s n n 1 cnpn n n 1 cn pn 6 max 16 n 6 n cn n n 1 pn max 16 n 6 n cn n n 1 pn 6 max 16 n 6 n cn n n 1 cnpn s 15 3 here we used that nn 1 pn 6 1 since n n 1 pn is an orthogonal projection step 4 by the spectral theorem theorem 9 1 every compact selfadjoint operator s k h can be approximated in the norm of l h by a sequence of finite rank operators sn the estimate 15 3 applied to their differences entails that the limit s lim n sn exists if the finite rank operators s n form another approximating sequence then by what has been proved before we have sn s n sn s n 6 sn s n 0 this shows it that the number s is independent of the choice of approximating se quence for general compact operators s l h we define s by 15 2 and find s 6 1 2 s s 1 2 i s s 6 2 s repeating previous arguments this extension is again seen to be linear step 5 the argument of step 4 proves that we may identify with an element in k h the dual of the space k h of compact operators on h by trace duality theorem 14 29 there exists a unique trace class operator t l 1 h such that for all s k h we have s tr st by considering the orthogonal projection p h h onto the span of the norm one vector h we obtain t h h tr pt p 0 this implies that t is positive if pn is an increasing sequence of finite rank projections converging to the identity operator strongly then tr t lim n tr pnt lim n pn 6 sup p pfin h p 550 states and observables in the opposite direction for any p pfin h we have p tr pt tr t p 6 tr t taking the supremum over all p pfin h we obtain supp pfin h p 6 tr t this proves the identity tr t supp pfin h p thereby completing the proof of the first assertion of the theorem step 6 we now turn to the converse statement let t be a positive trace class oper ator on h and define s tr st tr t s for s l h its restriction to p h which we shall denote by again is obviously affine and satisfies 0 0 to prove countable additivity let pn n 1 be a sequence of disjoint orthogonal projections and let p be the orthogonal projection onto the closure of the span of their ranges if h n j j 1 is an orthonormal basis for the range of pn then the union of these sequences can be relabelled into an orthonormal basis hk k 1 for the range of p then p tr t p k 1 t hk hk n 1 j 1 t pnh n j h n j n 1 tr t pn n 1 pn the fourth identity being justified by the nonnegativity of the summands step 7 let p p h be arbitrary and choose an orthonormal basis hn n 1 for r p denoting the coordinate projections by pn by the countable additivity of we have p 6 p n 1 pn i this being true for any p p h it follows that sup p p h p 6 i on the other hand if hn n 1 is an orthonormal basis for h the countable additivity of gives limn n n 1 pn i since n n 1 pn pfin h this implies sup p pfin h p i in combination with the second part of step step 5 which shows that for any positive trace class operator t on h we have tr t supp pfin h tr pt this proves the identi ties in the second part of the theorem in what follows we denote by s h the convex set of all positive trace class operators with unit trace on h we will see below proposition 15 14 that this set is the closed convex hull of its set of extreme points and that these extreme points are precisely the orthogonal rank one projections in h a functional l h c is called positive if t 0 for every positive t l h and normal if n 1 pn p 15 2 states and observables in quantum mechanics 551 whenever pn n 1 is a sequence of disjoint orthogonal projections in h and p is their least upper bound the same terminology applies to functionals k h c theorem 15 7 the following six sets are in one to one correspondence 1 affine mappings pfin h 0 1 satisfying 0 0 and supp pfin h p 1 2 affine mappings p h 0 1 satisfying 0 0 and i 1 3 positive trace class operators t on h satisfying tr t 1 via p tr pt p pfin h 4 positive trace class operators t on h satisfying tr t 1 via p tr pt p p h 5 positive functionals k h c satisfying supp pfin h p 1 via s tr st s k h 6 positive normal functionals l h c satisfying i 1 via s tr st s l h proof for m n 1 2 3 4 we write m n to express that every object in the set described by m uniquely defines an element in the set described by n 1 3 this one to one correspondence is contained in proposition 15 6 3 6 let t be a positive trace class operator with unit trace and define l h c as in 6 then i tr t 1 to prove the positivity of let s 0 if hn n 1 is an orthonormal basis for h the positivity of t implies s tr st tr s 1 2 t s 1 2 n 1 t s 1 2 hn s 1 2 hn 0 the normality of follows from the countable additivity of the mapping p 7 tr pt proved in the second part of proposition 15 6 6 5 this inclusion follows from step 7 of the proof of proposition 15 6 5 1 the restriction pfin h is affine takes values in 0 1 and satisfies 0 0 and supp pfin h p 1 6 2 1 the first inclusion is obtained in the same way and the second again follows from step 7 of the proof of proposition 15 6 1 4 3 these inclusions are also contained in proposition 15 6 we my now define a state as either one of these six sets for the sake of definiteness we take the sixth 552 states and observables definition 15 8 states a state is a positive normal functional l h c satis fying i 1 this definition captures what is generally called a normal state in the mathematical literature on quantum mechanics the term state is usually reserved for general positive functionals l h c satisfying i 1 the small abuse of terminology com mitted by omitting the adjective normal from our terminology may be excused by the third item in the above list which does not involve normality remark 15 9 density functions in the physics literature the positive trace class op erator t with unit trace associated with state is called the density operator associated with as the following example shows a countably additive mapping p c 2 0 1 satisfying 0 0 and i 1 need not be affine and therefore need not define a state example 15 10 failure of affineness in two dimensions let h c 2 and let s denote its unit sphere let f s 0 1 be a function with the following two properties i f h 1 f h 2 whenever span h 1 span h 2 ii f h 1 f h 2 1 whenever h 1 h 2 apart from these restrictions f can be completely arbitrary define p h 0 1 by 0 0 i 1 and ph f h h s where ph is the orthogonal projection onto span h it is clear that is countably addi tive if the orthogonal projections p 1 p 2 are pairwise disjoint then all but at most two must be zero if there are zero or one nonzero projections then countable additivity is trivial and if there are two nonzero projections they must be of the form ph 1 and ph 2 with h 1 h 2 in that case countable additivity follows from ph 1 ph 2 f h 1 f h 2 1 i ph 1 ph 2 if there exists a positive operator t on h with unit trace such that for all p p h we have p tr pt then f h ph tr pht t h h depends continuously on h it is however easy to construct discontinuous functions f satisfying the conditions i and ii indeed once the value of f at a given point h 0 s is fixed the conditions i and ii fix the values of f only on the points ei h 0 and all points orthogonal to them if we identify s with the unit sphere s 3 in r 4 these points define a great circle incident with h 0 and an equator relative to the north pole h 0 therefore 15 2 states and observables in quantum mechanics 553 in a sufficiently small neighbourhood of h 0 f is only determined on a submanifold of dimension 1 this leaves enough room to construct functions f satisfying i and ii but discontinuous at h 0 if were affine we could represent it by a positive operator t this would contradict the discontinuity of f it is not a coincidence that this counterexample lives in two dimensions a celebrated theorem due to gleason asserts that if dim h 3 then every countably additive map ping p h 0 1 is affine and hence defines a state 15 2 b pure states theorem 15 7 establishes four equivalent ways of looking at the convex set of all states since the correspondences between them preserve convex combinations and hence ex treme points the following definition makes sense from each of these points of view definition 15 11 pure states a pure state is an extreme point of the convex set of states proposition 15 12 a state l h c is pure if and only if it is a vector state that is there exists a unit vector h h such that s sh h s l h this unit vector is unique up to a scalar multiple of modulus one the first assertion can be equivalently stated as saying that the extreme points of the set of all positive trace class operators with unit trace are precisely the orthogonal projections of rank one proof only if let be a state and let t be the associated positive trace class operator on h with unit trace by the singular value decomposition theorem 14 15 we have t n 1 nhn hn for some orthonormal basis hn n 1 of h and a nonnegative scalar sequence n n 1 such that n 1 n tr t 1 this allows us to write t as a convex combination of distinct states unless all but one n vanish in which case we have t h h for some unit vector h h and p tr p h h ph h for all orthogonal projections p p h if if is a vector state then the associated positive trace class operator is of the form t h h with h 1 if t 1 t 0 t 1 is a convex combination of positive trace class operators t 0 and t 1 with unit trace then the unit vector h t h 1 t 0 h t 1 h is a convex combination of two vectors of norm at most one hence we must have either h 1 t 0 h or h t 1 h since t 0 and t 1 are contractive this is only possible if 0 in the first case or 1 in the second case this means 554 states and observables that either t t 0 or t t 1 so t is an extreme point of the convex set of positive trace class operator on h with unit trace since the correspondence between states and the associated positive trace class operators preserves convex combinations it follows that is an extreme point of the convex set of states the uniqueness assertion follows by observing that for all r and h h we have ei h ei h h h remark 15 13 bras kets superpositions mixed states in the physics literature the pure state corresponding to a unit vector h h is commonly denoted by h and referred to as the ket or wave function associated with h often h is identified with h the addition in h can be used to define for orthogonal unit vectors h 1 h 2 h and scalars 1 2 c satisfying 1 2 2 2 1 the pure state 1 h 1 2 h 2 1 h 1 2 h 2 such states are referred to as coherent superpositions of the states h 1 and h 2 such states should be carefully distinguished from states that can be built by using the ad dition of l 1 h indeed for h 1 h 2 h are linearly independent unit vectors in h and 0 1 the convex combination 1 h 1 h 1 h 2 h 2 or in physics notation 1 h 1 h 1 h 2 h 2 defines a state in l 1 h such states which are not pure unless 0 or 1 are called mixed states or more precisely mixtures of the states h 1 and h 2 we recall that s h denotes the convex set of all positive trace class operators with unit trace on h as we have seen in theorem 15 7 the elements of this set are in one to one correspondence with states by proposition 15 12 the extreme points of s h are the rank one projections of the form h h with h h of norm one proposition 15 14 the set s h is the closed convex hull of its extreme points the extreme points of this set are precisely the rank one projections of the form h h with h h of norm one proof by the singular value decomposition of theorem 14 15 every element of t s h is of the form t n 1 nhn hn with convergence in trace norm with hn n 1 an orthonormal basis in h and n n 1 a nonnegative sequence satisfying n 1 n 1 this gives the first assertion the second follows from theorem 15 7 which informs us that the operators of the form h h with h h of norm one are in one to one corre spondence with the vector states which are the extreme points of the convex set of all states by proposition 15 12 15 2 states and observables in quantum mechanics 555 15 2 c observables let f be a measurable space classically an valued observable on the state space x x is a measurable function f x by definition of measurability f induces a mapping from f to x given by f 7 f 1 f f f and this mapping is countably additive in the sense that if the sets fn f are pairwise disjoint then f 1 n 1 fn n 1 f 1 fn identifying sets in x by their indicator functions and replacing them by orthogonal projections in a hilbert space h we arrive at the following definition of an observable in quantum mechanics definition 15 15 observables let f be a measurable space and h a hilbert space an valued observable is a countably additive mapping p f p h satis fying p i an elementary observable is a 0 1 valued observable by corollary 9 18 the elementary observables are precisely the orthogonal projec tions this should be compared to the classical situation where elementary observables being precisely the indicator functions of measurable sets thus the basic principle of replacing indicators by orthogonal projections can now be rephrased as replacing clas sical elementary observables by their quantum mechanical counterparts observables defined in this way are sometimes called sharp observables as opposed to unsharp observables which will be introduced in section 15 3 b following notation introduced in chapter 9 we write pf p f for f f for vectors h h we denote by ph the nonnegative probability measure on given by ph f pf h h f f in the language of chapter 9 a real valued observable is nothing but a projection valued measure on r and by the spectral theorem theorem 10 54 we can associate a unique selfadjoint operator a with p determined by d a h h r 2 dph and for h d a ah h r dph see theorem 10 48 in the converse direction the spectral theorem asserts that every selfadjoint operator a arises from a projection valued measure on r in this way and hence defines an observable thus we arrive at the conclusion that real valued observables are in one to one corre spondence with selfadjoint operators in most treatments of quantum mechanics this is 556 states and observables simply taken as a postulate in a sense the present treatment provides the deeper motiva tion for this postulate in that this correspondence appears as a consequence of the point of view that on the mathematical level the classical to quantum transition is simply the transition from the boolean algebra of subsets of measurable space to the lattice of orthogonal projections on a hilbert space a further advantage of the present approach is that in the same vein the spectral theorem for normal operators can be reinterpreted as establishing a one to one correspondence between complex valued observables and normal operators and between observables with values in the unit circle and unitary operators we return to the abstract setting of observables p f p h with values in if l h c is a pure state represented by the unit vector h h then we have pf pf h h ph f f f so the assignment f 7 pf defines a probability measure the following proposition is an immediate consequence of the fact that states are normal it is the mathematical counterpart of the so called born rule in quantum mechanics and allows us to interpret the number pf as the probability that measuring p results in a value contained in f f when the system is in state proposition 15 16 born rule if l h c is a state and p f p h an valued observable the mapping f 7 pf f f defines a probability measure on f if p is a real valued or complex valued observable represented by a selfadjoint or more generally a normal operator a then as a projection valued measure p is sup ported on the spectrum a and therefore p can be thought of as an a valued observable the physical interpretation is that with probability one a measurement of a produces a value belonging to a 15 2 d the uncertainty principle if p is an observable represented by a bounded selfadjoint operator a the expected value of p in state is defined as the number a a if h is a pure state associated with a unit vector h h contained in d a we have a h ah h 15 2 states and observables in quantum mechanics 557 in this situation for h d a we can define the variance by var h a a a h 2 h a ah h h 2 the uncertainty of a in state h is defined by h a var h a 1 2 theorem 15 17 uncertainty principle let h be a pure state associated with the unit vector h h and consider two real valued observables with associated selfadjoint operators a and b if h d a b h d a d b ah d b bh d a and a b h abh bah then h a h b 1 2 a b h h proof the operators a a ah h and b b bh h with domains d a d a and d b d b are selfadjoint in particular we note that a h d b b h d a and we have a b h a b h the cauchy schwarz inequality implies h a h b a h b h a h b h im a h b h 1 2 a h b h b h a h 1 2 a b h h 1 2 a b h h the physical interpretation of the next result is that a measurement of a in a pure state h gives the expected value ah h with probability one if and only if the representing unit vector h is an eigenvector of a and in this case the eigenvalue equals ah h proposition 15 18 let p be a real valued observable represented by the selfadjoint operator a and let h d a satisfy h 1 the following assertions are equivalent 1 a has zero uncertainty in the state h 2 h is an eigenvector for a if these equivalent conditions hold then for the corresponding eigenvalue we have ah h and p h h 1 proof 1 2 if var h a 0 then ah ah h h so h is an eigenvector of a with eigenvalue ah h a h 2 1 ah h then var h a a ah h h 2 a h 2 0 558 states and observables if the equivalent conditions hold then by corollary 10 57 for all measurable functions f a c we have f a h f h and consequently a f dph f a h h f this forces ph and therefore h p p h h h h 1 15 2 e the qubit it is instructive to take a closer look at the simplest genuinely quantum mechanical system the qubit it is the quantum version of the bit 0 1 which we think of as equipped with the counting measure giving mass 1 to each of the two elements of 0 1 physically the qubit models a spin 12 particle we write 1 0 and 1 1 for the unit basis vectors of the hilbert space l 2 0 1 and denote the pure states associated with them by 0 and 1 every pure state is then of the form 0 1 with c satisfying 2 2 1 here we used the ket notation h to denote the pure state represented by a unit vector h since pure states are defined up to a complex number of modulus one every pure state can be uniquely written in the form cos 2 0 ei sin 2 1 15 4 for suitable 06 6 and 06 2 in spherical coordinates the variables and uniquely determine a point sin cos sin sin cos 15 5 on the unit sphere s 2 of r 3 this representation of pure states is frequently referred to as the bloch sphere the bloch sphere source wikipedia in what follows we identify l 2 0 1 isomet rically identify with c 2 under this identifica tion linear operators on l 2 0 1 correspond to 2 2 matrices with complex coefficients states can be identified with points in the closed unit ball of r 3 as follows any selfadjoint oper ator t ti j 2 i j 1 on c 2 with unit trace tr t t 11 t 22 1 is of the form t 1 2 1 c 3 c 1 ic 2 c 1 ic 2 1 c 3 15 6 with c 1 c 2 c 3 r the vector c c 1 c 2 c 3 r 3 is called the bloch vector of t it is easily checked that the eigenvalues of t are 12 1 c from this we see that t 0 if and only if c 6 1 15 2 states and observables in quantum mechanics 559 a routine computation shows that the pure state h cos 2 0 ei sin 2 1 corresponds to the operator t h h 1 cos e i sin ei sin 1 cos 15 7 with bloch vector sin cos sin sin cos thus the bloch sphere representation of the pure state h equals the bloch vector of the associated operator h h equation 15 6 can be written as t 1 2 1 0 0 1 c 1 2 0 1 1 0 c 2 2 0 i i 0 c 3 2 1 0 0 1 1 2 i c 1 1 c 2 2 c 3 3 where 1 0 1 1 0 2 0 i i 0 3 1 0 0 1 are the three pauli matrices these matrices are selfadjoint and their spectra equal 1 therefore they are associated with 1 valued observables also denoted by 1 2 and 3 the corresponding eigenstates of j are called the spin up spin down states along the jth axis every selfadjoint operator a on c 2 is of the form a a c id c id b c 0 c 3 c 1 ic 2 c 1 ic 2 c 0 c 3 c 0 i c 1 1 c 2 2 c 3 3 for certain a b c d c 0 c 1 c 2 c 3 r with a c 0 c 3 b c 0 c 3 c c 1 and d c 2 it follows that the quadruple i 1 2 3 is a basis for the real linear vector space of selfadjoint operators on c 2 15 2 f entanglement the natural choice for the state space of a system of n classical point particles in r 3 is r 3 n r 3 n the idea being that six coordinates are needed three for position three for momentum to describe the state of each particle in quantum mechanics the natural choice of hilbert space is l 2 r 3 n labelling the points of r 3 n as x x n j 3 n j n 1 this choice suggests the following natural definition of observables x n j describing the jth coordinate of the nth particle x n j f x x j f x f d x n j x r 3 n 560 states and observables where d x n j f l 2 r 3 n x j f l 2 r 3 n later we will see that the correspond ing momentum operators are given by p n j f 1 i x j f f d p n j with their natural domains the space l 2 r 3 n is isometric in a natural way to the n fold hilbert space tensor product see definition 14 30 and the discussion following it l 2 r 3 n l 2 r 3 l 2 r 3 n times this suggests that if the hilbert spaces h 1 hn describe the states of n quantum mechanical systems then their hilbert space tensor product h 1 hn serves to describe the system composed of these n subsystems in what follows we focus on the case n 2 but everything we say extends to general n without difficulty let h and k be hilbert spaces and let h k be their hilbert space tensor product for unit vectors h h and k k we write h and k for the pure states in h and k represented by these vectors and h k h k for the pure state represented by the unit vector h k in h k suppose now that orthonormal vectors h 1 h 2 h and orthonormal vectors k 1 k 2 k are given then the unit vectors h 1 k 1 and h 2 k 2 are orthogonal in h k hence for scalars 1 2 c satisfying 1 2 2 2 1 the superposition 1 h 1 k 1 2 h 2 k 2 defines a unit vector in h k to this unit vector corresponds the pure state 1 h 1 k 1 2 h 2 k 2 1 h 1 k 1 2 h 2 k 2 unless 1 0 or 2 0 such states cannot be written in the form h k and are called entangled states the partial trace see section 14 4 can be used to define states of subsystems starting from the state of a composite system more concretely suppose that t l 1 h k is a positive trace class operator with unit trace then the operators trk t and trh t are positive trace class operators with unit trace in l 1 h and l 1 k respectively if we think of t as describing the state of a system with hilbert space h k trk t and trh t can be thought of as describing the states of the two constituent subsystems with hilbert spaces h and k respectively for example by the result of example 14 32 if the operator t corresponds to a unit vector h k in h k the states corresponding to 15 3 positive operator valued measures 561 trk t and trh t are the pure states h and k that is trk t h h trh t k k 15 3 positive operator valued measures we discuss next a natural extension of the notion of an observable 15 3 a effects as a warm up we show proposition 15 19 let x x be a measurable space the closed convex hull in bb x of the set of elementary observables 1 b b x equals e x f bb x 06 f 6 1 pointwise the extreme points of e x are precisely the elementary observables 1 b b x proof denote by e x the closed convex hull of the set of elementary observables the inclusion e x e x is trivial to prove the inclusion e x e x let f e x be given given 0 select a simple function g kj 1 c j 1 b j such that f g this function may be chosen in such a way that the measurable sets b j are disjoint and the coefficients satisfy 0 6 c j 6 1 after relabelling we may assume that 06 c 1 6 6 ck 6 1 if k 1 then g 1 c 1 1 c 11 b 1 belongs to e x if k 2 we set l 0 and li k j i b j j 1 k and 0 1 ck 1 c 1 and i ci ci 1 i 2 k then 06 i 6 1 k i 0 i 1 and g k j 1 c j 1 b j k i 0 i 1 li it follows that g belongs to e x since 0 was arbitrary this proves that f e x if g e x is an elementary observable and g f 0 1 f 1 with 0 1 and 0 6 f j 6 1 for j 0 1 then 0 g f 0 1 f 1 implies f 0 f 1 0 and 1 g f 0 1 f 1 implies f 0 f 1 1 that is f 0 f 1 g pointwise it follows that every elementary observable is an extreme point 562 states and observables of e x if g e x is not an elementary observable then the set 6 g 6 1 is nonempty for sufficiently small 0 and then it is easy to produce measurable f 0 6 f 1 satisfying 06 f j 6 1 for j 0 1 and g 12 f 0 1 2 f 1 it follows that g is not an extreme point of e x the quantum mechanical counterpart of the elementary observables are the orthog onal projections in analogy to the above result we now characterise the closed convex hull of p h in l h we write s 6 t to express that t s is a positive operator proposition 15 20 the closed convex hull in l h of p h equals e h e l h 06 e 6 i the extreme points of e h are precisely the orthogonal projections proof every element of the convex hull of p h belongs to e h and this passes on to the closed convex hull since elements of e h are positive and hence selfadjoint every e e h admits a representation as e e dp where p is the projection valued measure of e let fn 2 n j 1 j 2 n 1 i j 1 2 n 2 n j 1 1 j 1 2 n 1 where i j j 1 2 n j 2 n for 16 j 6 2 n set en e fn dp 1 2 n 2 n j 1 p j 1 2 n 1 then en is in the convex hull of p h and lim n e en 6 lim n sup 0 1 fn 0 this proves that e is in the closed convex hull of p h if e e h is an orthogonal projection and e e 0 1 e 1 with 0 1 and 06 e j 6 i for j 0 1 then for all x n e we have e 0 x x 1 e 1 x x 0 with eix x 0 for i 0 1 and this is possible only if e 0 x x e 1 x x 0 for all norm one vectors x r e we have ex x x x 1 and consequently e 0 x x 1 e 1 x x 1 since eix x 6 1 for i 0 1 this is possible only if e 0 x x e 1 x x 1 it follows that e 0 e 1 0 on n e and e 0 e 1 i on r e and therefore e 0 e 1 e it follows that e is an extreme point of e h 15 3 positive operator valued measures 563 if e e h is not an orthogonal projection then the spectral theorem for bounded selfadjoint operators implies that the spectrum e cannot be equal to 0 1 since e is contained in 0 1 it follows that 1 e is nonempty for all sufficiently small 0 and then again by the spectral theorem it is easy to produce operators e 0 6 e 1 in e h such that e 12 e 0 1 2 e 1 it follows that e is not an extreme point of e h definition 15 21 effects an effects is an element of the set e h effects are selfadjoint and it follows from theorem 8 11 that a selfadjoint operator on h is an effect if and only if its spectrum is contained in the unit interval 0 1 if t is an arbitrary nonzero positive operator then for all 06 c 6 t 1 the operator ct is an effect indeed this is clear for c 0 and if c 0 the operator c 1 i t is positive since it is selfadjoint and has positive spectrum a mapping e h 0 1 is said to be finitely additive if n n 1 en e whenever e 1 en e e h satisfy e 1 en e theorem 15 22 busch every finitely additive mapping e h 0 1 satisfying i 1 restricts to an affine mapping p h 0 1 and hence defines a state proof by assumption we have i 1 and from 1 i i 0 i 0 1 0 it follows that 0 0 by additivity the restriction of to p h to 0 1 is affine 15 3 b positive operator valued measures the next definition generalises the notion of a projection valued measure by replacing the role of orthogonal projections by effects definition 15 23 positive operator valued measures a positive operator valued mea sure povm on a measurable space f is a mapping q f e h that assigns to every set f f an effect qf q f e h with the following properties i q i ii for all x h the mapping f 7 qf x x f f defines a measure qx on f 564 states and observables the measure defined by ii is denoted by qx thus for all f f and x h by definition we have qf x x qx f 1 f dqx note that qx q x x x x x 2 this shows that the measures qx are finite every projection valued measure is a povm in the converse direction we have the following simple result proposition 15 24 a povm q f e h is a projection valued measure if and only if qf qf qf f for all f f f proof the only if part has already been established in section 9 2 the if part is evident from q 2 f qf f qf which shows that each qf is a projection since qf is also positive it is an orthogonal projection a povm which is not projection valued is sometimes called an unsharp observable an example will be discussed in section 15 3 d we have seen in proposition 15 16 that if p f p h is a projection valued measure then for every state the mapping f 7 pf f f is probability measure on f this sets up an affine mapping from s h to the convex set m 1 of probability measures on f we recall that s h denotes the convex set of all positive trace class operators with unit trace on h as we have seen in proposition 15 14 this set is the closed convex hull of its extreme points which are precisely the rank one projections of the form h h with h h of norm one inspection of this argument shows that it extends to povms the following proposi tion shows that in the converse direction every povm arises in this way theorem 15 25 povms as unsharp observables let f be a measurable space if s h m 1 is an affine mapping then there exists a unique povm q f e h such that for all t s h we have t f tr qf t f f proof the proof consists of two steps step 1 we claim that extends to a bounded operator from l 1 h into m the proof of this claim is accomplished in three steps first we set 0 0 and for an arbitrary nonzero positive operator t l 1 h t t 1 t t 1 15 3 positive operator valued measures 565 where t 1 tr t 0 since t is positive and nonzero note that for all c 0 we have ct c t the identity s t s 1 t 1 s s 1 1 t t 1 where s 1 s 1 t 1 implies that if s t l 1 h are positive then s t s 1 t 1 s s 1 1 t t 1 s 1 t 1 s s 1 1 t t 1 s 1 t 1 s s 1 1 t t 1 s 1 s s 1 t 1 t t 1 s t where we used the assumption that is affine applying this to as and bt with a b 0 we find that as bt as bt a s b t next for an arbitrary selfadjoint t l 1 h write t t 1 t 2 with t 1 t 2 positive operators in l 1 t such decompositions always exist one could take for instance t 1 1 2 t t and t 2 t t 1 we then set t t 1 t 2 to see that this is well defined suppose that we also have t t 1 t 2 with t 1 t 2 positive operators in l 1 t then t 1 t 2 t 2 t 1 and hence by what we just proved t 1 t 2 t 1 t 2 t 1 t 2 t 2 t 1 0 as in the proof of theorem 15 7 it is checked that is real linear finally for an arbitrary t l 1 t we set t a i b where a 12 t t and b 12 i t t are the unique selfadjoint operators such that t a ib as in the proof of theorem 15 7 it is checked that is linear step 2 we now turn to the proof of the theorem using the extension provided by step 1 for every fixed f f the mapping t 7 t f defines a bounded functional on l 1 h and therefore by theorem 14 29 it defines a bounded operator qf l h such that t f tr t qf t l 1 h 566 states and observables for all norm one vectors h h we have qf h h tr h h qf h h f 0 1 which gives the operator inequality 06 qf 6 i that is we have qf e h it is clear that q i and for every norm one vector h h the measure f 7 qf h h h h f f f is a probability measure this proves that q f 7 qf is a povm uniqueness is clear since tr t qf 0 for all t l 1 h implies qf 0 remark 15 26 the assumption that should be affine is a reasonable one in the light of the following argument suppose we have two quantum mechanical systems at our disposal represented by the operators t 1 and t 2 in s h describing their states we use a classical coin to decide which state is going to be observed if with probability p heads comes up we observe the system corresponding to t 1 otherwise we observe the system corresponding to t 2 this experiment can be described as observing the state corresponding to the convex combination pt 1 1 p t 2 if is the observable to be measured we expect the probability distribution of the outcomes pt 1 1 p t 2 to be given by p t 1 1 p t 2 povms admit a bounded functional calculus but an important difference with the bounded functional calculus for projection valued measures of theorem 9 8 is that the calculus for povms fails to be multiplicative see however 15 10 for a partial result on multiplicativity proposition 15 27 bounded functional calculus for povms let q f l h be a povm there exists a unique linear mapping bb l h satisfying 1 f qf f f and f 6 f f bb it satisfies f f f bb proof for x y h consider the complex measure qx y defined by qx y f qf x y f f that this indeed defines a measure follows by a polarisation argument from the count able additivity of the measures qx x h for any measurable partition f 1 fk 15 3 positive operator valued measures 567 we have by the cauchy schwarz inequality applied twice k j 1 qx y fk k j 1 qfj x y 6 k j 1 qfj x x 1 2 qfj y y 1 2 k j 1 qx fj 1 2 qy fj 1 2 6 k j 1 qx fj 1 2 k j 1 qy fj 1 2 qx 1 2 qy 1 2 x y from which it follows that qx y has finite variation qx y 6 x y for f bb define a f x y f dqx y x y h the form a is sesquilinear and bounded and defines a bounded operator f on h by proposition 9 15 it is clear that 1 f qf for all f f and f x y f dqx y 6 f d qx y 6 f x y the identity f f is a consequence of qy x qx y from which it follows that f x y x f y f y x a f y x f dqy x f dqx y a f x y f x y uniqueness is clear from the fact that 1 f qf and the simple functions are dense in bb 15 3 c naimark s theorem if j is an isometry from h into another hilbert space h and p is an orthogonal projection in h then j pj is an effect in h for all x h we have 06 p jx jx p jx 2 6 x 2 x x and therefore 06 j pj 6 i this gives a method of producing povms from projection valued measures proposition 15 28 compression let j be an isometry from h into another hilbert space h if p f p h is a projection valued measure then q j p j f e h is a povm 568 states and observables proof by what we just observed q maps sets f f to elements of e h it is clear that q j j i to see that q is a povm it remains to observe that for all x h and f f we have qx f qf x x p f jx jx p jx f from which it follows that qx is a finite measure on f the main result of this section is naimark s theorem which asserts that conversely every povm arises in this way theorem 15 29 naimark let f be a measurable space and let q f e h be a povm there exists a hilbert space h a projection valued measure p f p h and an isometry j h h such that qf j pf j f f to motivate the proof of this theorem we consider first the special case t and f b t its borel algebra if q b t e h is a povm the operator t t zdq z is a contraction on h by proposition 15 27 by the sz nagy dilation theorem theorem 8 36 there exist a hilbert space h a unitary operator u l h and an isometry j h h such that t n j unj n n using the spectral theorem for bounded normal operators let p b t p h be its associated projection valued measure then by the properties of the bounded functional calculus of u t n j unj j t zn dp z j t zn dq z n n we claim that p has the desired properties indeed for all x h we have t n dqx t nx x unjx jx t n dpjx this means that the nonnegative fourier coefficients of the probability measures qx and pjx agree hence qx pjx by theorem 5 32 and the observation following it but this implies for all borel subsets b b t qbx x qx b pjx b pbjx jx j pbjx x this being true for all x h we conclude that qb j pbj this argument cannot be extended to cover the general case but it does suggest a 15 3 positive operator valued measures 569 proof strategy for theorem 15 29 namely to adapt the proof of the sz nagy dilation theorem proof of theorem 15 29 let s f h f x f f x h and consider the function q s s c by q p p qf f x x for p f x p f x we claim that this function is positive definite in the sense that for all finite choices of p 1 pn s and z 1 zn c we have n n m 1 q pn pm znzm 0 15 8 first assume that pn fn xn with the sets fn disjoint in that case n n m 1 q pn pm znzm n n m 1 qfn fmxn xm znzm n n 1 qfnznxn znxn 0 by the positivity of the operators qfn for general f 1 fn f we write their union n n 1 fn as a union of 2 n disjoint sets c in f indexed by the elements 2 n the power set of 1 n as follows for 2 n we set c n fn m 6 fm it is straightforward to check that the sets c are pairwise disjoint and that for all n 1 n we have fn 2 n n c fn fm 2 n n m c then by the additivity of q and the positivity of the operators qc n n m 1 q pn pm znzm n n m 1 qfn fmxn xm znzm n n m 1 2 n n m qc xn xm znzm 2 n 16 n m 6 n n m qc xn xm znzm 570 states and observables 2 n qc 16 n 6 n n znxn 16 m 6 n m zmxm 0 this completes the proof of 15 8 let v be the vector space of finitely supported complex valued functions defined on s the elements of v are functions h s c such that f p 0 for all but at most finitely many pairs p f x s the function v v that maps p s to the complex number z and is identically zero otherwise will be denoted as v z 1 p for two functions v v v say v nn 1 zn 1 pn and v n n 1 z n 1 pn allowing some of the zn and z n to be zero we define v v n n m 1 q pn pm znz m 15 9 arguing as in the proof of theorem 8 34 this uniquely defines a sesquilinear mapping from v v to c which satisfies v v v v for all v v v and v v 0 for all v v and n v v v v 0 is a subspace of v it follows that 15 9 induces an inner product on the vector space quotient v n let h denote the hilbert space completion h of v n with respect to this inner product consider elements in h of the form p n x n and p n x n with x x h then p n p n h q x x x x taking x x in particular we may identify x h isometrically with the element p n in h where p x in this way we obtain an isometric embedding j of h into h to ease up notation we use the notation p f x for general elements of h rather than the more precise notation p n f x n with this notation jx x the mapping h h defined by f x qf x satisfies 2 f x qf x q qf x qf x f x we extend by linearity and check that this results in a selfadjoint hence orthogonal projection in h whose range equals h from f x x h qf x x h f x x h f x jx h it follows that viewed as a mapping from h to h equals j finally set pf f x f f x 15 3 positive operator valued measures 571 again it is routine to check that pf is an orthogonal projection in h by the properties i and ii in definition 15 23 the mapping p f l h is a projection valued measure finally from j pf jx pf x f x f x qf x we conclude that qf j pf j the argument given after the statement of theorem 5 32 works for general contrac tions theorem 15 30 for every contraction t l h there exists a unique povm q b t e h such that t n t zn dq z n n if q is a povm with the above property then t is unitary if and only if q is a projection valued measure proof existence follows follows by following the lines just mentioned if u is a unitary dilation of t and p is its projection valued measure the compression q of p has the required properties to prove uniqueness suppose that for all x h we have t nx x t zn dqx z t zn dq x z n n where q is another povm on t this means that the nonnegative fourier coefficients of the probability measures qx and q x agree now theorem 5 32 and the observation following it can be applied to see that qx q x for the final statement it only remains to prove the only if part but this follows from uniqueness for if t t zdq z is unitary for some povm q on t then we may also represent t in terms of its associated projection valued measure p that is t t zdp z by uniqueness q p if q is as in theorem 15 30 then for all trigonometric polynomials f c t of the form f z nn 0 cnz n we have f t f dq f t where t t zdq z by the continuity of the bounded functional calculus with respect to the supremum norm this identity persists for functions f in the disc algebra a d the banach space of all functions f c t which have continuous extension to d which is holomorphic ond these are precisely the functions belonging to the closure in f c t of the trigonometric polynomials of the form just considered an easy consequence is 572 states and observables that the bounded functional calculus of a povm q on t is multiplicative on the disc algebra that is f g f g f g a d 15 10 15 3 d the phase number pair a convenient model for the number operator the selfadjoint operator in quantum op tics which corresponds to the observable of counting the number of photons can be given on the hardy space h 2 d considered in section 7 3 d recall that h 2 d is the hilbert space of all holomorphic functions on d of the form n n cnzn with n n cn 2 as we have seen in that section the mapping n n cnz n 7 n n cnen with en ein sets up an isometry from h 2 t onto the closed subspace of l 2 t consisting of all functions whose negative fourier coefficients vanish this allows us to identify h 2 d with the range of the riesz projection n z cnen 7 n n cnen on l 2 t in h 2 d we consider the unbounded selfadjoint operator n with domain d n f n n cnz n h 2 d n n n 2 cn 2 given by n zn nzn n n where zn is shorthand for the function z 7 zn here and in later sections we adopt the physics convention to denote concrete observables with a hat this notation should not be confused with the notation for fourier transforms selfadjointness of n is evident by noting that up to unitary equivalence it is a multiplication operator of the form considered in example 10 60 the sequence zn n n is an orthonormal basis of eigenvectors for n and accordingly we have n n on the other hand if c n then for every f n n cnzn in h 2 d the equation n u f is uniquely solved by u n n cn n z n 2 n this implies that n we conclude that n n 15 11 this is a special case of proposition 10 32 but the proof could be simplified here be cause we have precise information about the domain of the operator we think of the 15 3 positive operator valued measures 573 eigenfunctions zn on n as the pure states describing the n photon states of an electromag netic field in this interpretation 15 11 tells us that the number of photons observed is a nonnegative integer the projection valued measure n associated with n is given by n n n the orthogonal projection in h 2 d onto the one dimensional subspace spanned by zn so that n f f n ndn f n n n n n n f f f d n to define phase as a t valued unsharp observable in the sense of povms we proceed as follows let s be the left shift on h 2 d that is s n n cnz n n n cn 1 z n in the language of section 7 3 d s is the toeplitz operator t with symbol z z identifying h 2 d with the range of the riesz projection in l 2 t a unitary dilation of s is given by the left shift v on l 2 t v n z cnen n z cn 1 en the projection valued measure p b t p l 2 t associated with v is easily checked to be given by pb f 1 b f b b t f l 2 t 15 12 its compression to h 2 d is a povm t e l 2 t which is called the phase observable it satisfies sn t zn d z n n the covariance property expressed in the following theorem identifies the povm as the complementary unsharp observable to the number observable n the notions of covariance and complementarity will be developed in more detail in section 15 5 theorem 15 31 covariance of phase let u be the unitary c 0 group generated by in the phase observable is covariant with respect to this group that is for all borel subsets b t we have u t bu t eit b t r where eitb eitz z b is the rotation of b over t proof since the povm is the compression of the projection valued measure p given by 15 12 for all m n n we have bu t en em pbju t en jem e int 1 ben em 574 states and observables while at the same time u t eit ben em peit bjen ju t em e itm 1 eit ben em e itm eit b zn m dz e itm b e itz n m dz e itn b zn m dz e int 1 ben em since the functions en n n have dense span in h 2 d this completes the proof 15 4 hidden variables the one to one correspondence of theorem 15 25 between the set of povms and the set of affine mappings from s h to m is particularly satisfying from a philosoph ical point of view as it characterises unsharp observables in an operational way an unsharp observable is nothing but a rule of assigning probability distributions to states in such a way that convex combinations are respected the rationale of this assumption has been discussed in remark 15 26 thinking of unsharp observables as affine mappings from s h to m 1 the con vex set of all probability measures on analogously we can define classical unsharp observables as affine mappings from m 1 x to m 1 where x x is the state space of the classical system indeed in section 15 2 we have defined observables as measur able functions from x to and such functions f induce an affine mapping from m 1 x to m 1 by sending to its image measure f f 1 in this way every classi cal observable defines a classical unsharp observable the following theorem shows that every family of quantum observables with values in a locally compact hausdorff space admits a classical model in the sense made precise in the formulation of the theorem theorem 15 32 hidden variables let be a locally compact hausdorff space and suppose that qi b e h i i is a family of unsharp quantum mechanical observables indexed by an index set i each of which induces an affine map s h to m 1 by the prescription qi t b tr qi bt b b then there exists a compact hausdorff space x and a family of unsharp classical ob servables fi m 1 x m 1 i i each of which induces an affine map m 1 x to m 1 by the prescription fi b f 1 i b b b x such that the following conditions hold 15 4 hidden variables 575 1 the elements of x are the equivalence classes of the extreme points of s h modulo indiscernibility under q that is two extreme points t 1 t 2 of s h are said to be indiscernible under qi i i if qi t 1 qi t 2 i i 2 the quotient mapping q t 7 t from the set of extreme points of s h to x is continuous 3 the classical unsharp observables fi are related to the unsharp observables qi by passing to equivalence classes that is fi t qi t where t m 1 x is the dirac measure supported on t x the classical observables in fi are hidden variables by their very definition they cannot be observed using the measurements of the quantum observables qi sketch of the proof in what follows we think of the set extr s h of extreme points of s h as being equipped with the coarsest topology such that all mappings t 7 g qi t with i i and g c 0 are continuous the brackets refer between the duality of c 0 and mr see theorem 4 2 adapting the proof of the banach alaoglu in a straightforward way it is seen that turns extr s h into a compact hausdorff space as mentioned in the statement of the theorem we define x extr s h where is the equivalence relation of indiscernibility under qi i i we endow this space with the quotient topology that is we declare a subset of x to belong to if its pre image under the quotient mapping q t 7 t belongs to this topology renders the quotient mapping from extr s h to x continuous as a result the space x is a compact hausdorff space with respect to we extend the mapping t 7 qi t to the convex hull in m 1 x of the dirac measures by convexity fi n n 1 n t n n 1 nqi t for scalars 06 n 6 1 such that n n 1 n 1 clearly fi preserves convex combinations the functions fi are continuous with respect to the weak topologies of m 1 x and m 1 the span of the dirac measures is dense in m 1 x with respect to the weak topology leaving aside some topological subtleties these functions admit unique ex tensions to all of m 1 x and these extensions again preserve convex combinations 576 states and observables it is of some interest to work through the details of this construction for the qubit accordingly let h c 2 as we have seen in section 15 2 e the set of extreme points of s h then corresponds to the bloch sphere s 2 in r 3 under this correspondence the bloch vector sin cos sin sin cos s 2 corresponds to the operator t s c 2 given in matrix form as t 1 cos e i sin ei sin 1 cos let us take the pauli matrices as the set of observables of interest 1 2 3 let pj be the projection valued measure associated with j for example p 1 1 and p 1 1 are the orthogonal projections onto the one dimensional subspaces spanned by the eigenvectors corresponding to the eigenvalues 1 and 1 of 1 0 1 1 0 p 1 1 1 2 1 2 1 2 1 2 p 1 1 1 2 1 2 1 2 1 2 we view these as observables with values in 1 since separates the points of s 2 the space x constructed in the proof of theorem 15 32 can be identified with s 2 the corresponding family classical variables f f 1 f 2 f 3 is given by the mappings f j m 1 s 2 m 1 1 f 1 1 tr p 1 1 t tr 1 2 1 2 1 2 1 2 1 cos e i sin ei sin 1 cos 1 2 tr 1 cos ei sin 1 cos e i sin 1 cos ei sin 1 cos e i sin 1 2 1 cos ei sin 1 cos e i sin 1 cos sin 1 1 and likewise f 1 1 1 1 similar computations give f 2 1 1 2 f 3 1 1 3 by considering convex combinations of dirac measures and a limiting argument it 15 5 symmetries 577 follows that the hidden variables f j m 1 s 2 m 1 1 are given by d f j 1 2 1 p s 2 x j d x dp j 1 2 3 where dp is the probability measure on 1 giving each point mass 12 15 5 symmetries in order to motivate our definition of a symmetry we introduce some notation and ter minology the adjoint of a conjugate linear mapping t h h that is a mapping satisfying t x y t x t y and t cx cx is the unique conjugate linear map ping t h h defined by x t y t x y x y h a mapping t h h is called antiunitary if it is conjugate linear and satisfies t t t t i it is straightforward to check that if u h h is unitary or antiunitary then the mapping u t utu is well defined as a mapping from s h to s h and satisfies tr u t 1 u t 2 tr t 1 t 2 t 1 t 2 s h 15 13 here as before s h denotes the set of all positive trace class operators on h with unit trace as we have seen the elements of this set are precisely the rank one projec tions h h with h h of norm one the physical interpretation of 15 13 is that u preserves transition probabilities between pure states to see this recall that if a is the selfadjoint operator in h representing a real valued observable and h h has norm one and belongs to d a in case a is unbounded then the quantity tr a h h ah h is interpreted as the expected value of the observable in the pure state h in particular if g is another pure state then tr g g h h g g h h g h 2 is the expected value of the observable g g in state h in physics parlance this is the probability of finding a system with state h in state g when measuring it against an orthonormal basis containing g that is the transition probability between h and g a remarkable theorem due to wigner provides a converse to 15 13 578 states and observables theorem 15 33 wigner if u s h s h is a bijection with the property that tr u t 1 u t 2 tr t 1 t 2 t 1 t 2 s h there exists a mapping u h h which is either unitary or antiunitary such that u t utu t s h this mapping is unique up to a complex scalar of modulus one we sketch a proof of the theorem only for the case of the qubit that is for h c 2 and refer to the notes for some missing details and references to the general case sketch of the proof of theorem 15 33 for the qubit we begin by recalling 15 4 and 15 7 which state that if we write a unit vector h c 2 as cos 2 0 ei sin 2 1 with 06 6 and 06 2 then the rank one projection h h in c 2 onto the span of h is given as a matrix by h h 1 cos e i sin ei sin 1 cos by elementary computation tr h h h h h h 2 1 2 1 xh xh where as in 15 5 xh sin cos sin sin cos is the bloch vector of h under the bijective correspondence h h xh between the elements of s c 2 and the points of the unit sphere s 2 of r 3 the assumption of the theorem implies that u induces a mapping r s 2 s 2 satisfying 12 1 rxh rxh 1 2 1 rxh rxh that is rxh rxh xh xh this identity implies that the 3 3 matrix r defined by ri j rui u j i j 1 2 3 with u 1 u 2 u 3 the standard unit vectors of r 3 is orthogonal now we use the algebraic fact taken for granted here that for every orthogonal 3 3 matrix r with real coeffi cients there exists a mapping u c 2 c 2 which is either unitary or antiunitary and which is unique up to a complex scalar of modulus one such that u x u rx x r 3 where x x 1 1 x 2 2 x 3 3 where x r 3 and 1 2 3 are the pauli matrices the mapping u has the required properties 15 5 symmetries 579 informally speaking wigner s theorem tells us that symmetries u of quantum me chanical systems are given by operators u acting on the underlying hilbert space that are either unitary or antiunitary in practice one is primarily interested in one parameter groups of symmetries indexed by time suppose u t t r is such a group by the uniqueness part of wigner s theorem for all s t r the identity u t u s u t s implies the existence of a scalar c t s of modulus one such that the corresponding anti unitary operators satisfy u t u s c t s u t s from the associative law u t u s u r u t u s u r we obtain the cocycle identity c s r c t s r c t s c t s r in this situation a theorem of bargmann implies that there exists function d taking values in the scalars of modulus one such that c t s d t d s d t s and the operators v t d t 1 u t are unitary they satisfy u t t v t tv t v t v s v t s the unitary group v t t r can be shown to be strongly continuous hence by stone s theorem it follows that there exists a selfadjoint operator h the hamiltonian asso ciated with the family u such that v t eith for t r the action of the unitary c 0 group eith t r on pure states is given by u t h h v t h v t h the equa tion d dt v t h ih v t is an abstract version of the schro dinger equation 13 34 which corresponds to the special case h l 2 rd m and h potential these considerations motivate the following definition definition 15 34 symmetry of a hilbert space a symmetry of h is a unitary operator on h 15 5 a covariance definition 15 35 symmetry of a measure space a symmetry of the measure space f is a measurable bijective mapping g with measurable inverse that leaves invariant that is g f g 1 f f f f 580 states and observables if g is a symmetry of f then for all f f the set g f is measurable and f g 1 g f g f that is is also invariant under g 1 definition 15 36 conservation and covariance let f be a measure space and let u be a symmetry of a hilbert space h i an observable p f p h is said to be conserved under u if upfu pf for all f f ii an observable p f p h is said to be covariant under the pair g u where g is a symmetry of f if upfu pg f for all f f that is if the following diagram commutes f f p h p h f 7 g f p p pf 7 upfu as we will see shortly position is covariant with respect to translation an object at position x appears at position x x if the origin is translated over x and momentum is covariant with respect to boosts an object with momentum p appears with momentum p p if a boost of size p is applied that is if the origin in momentum space is translated over p locally compact abelian groups an interesting special case arises when observ ables take values in a locally compact abelian lca group g our treatment borrows some results from the theory of lca groups that will not be proved here for the spe cial cases rd and t the presentation is self contained as all missing details can be filled in with the help of the results of chapter 5 a fuller treatment of symmetries should also cover the case of noncommutative lie groups such as so 3 and su 2 but this would take us too far afield every lca group g admits a haar measure that is a borel measure such that b g 1 b for all b b g and g g this measure is unique up to a scalar multiple with respect to a haar measure every g g induces a symmetry on g by g g 7 gg g g this induces a symmetry ug on l 2 g l 2 g given by ug f f g 1 15 5 symmetries 581 we refer to ug as the translation over g we have u g 1 u g 2 f f g 12 g 1 1 f g 1 g 2 1 u g 1 g 2 f so u g 1 u g 2 u g 1 g 2 this means that the mapping u g l l 2 g g 7 ug is multiplicative and hence defines a unitary representation it is easily checked that this representation is strongly continuous a character of g is a continuous group homomorphism g t the set of all characters of g is called the pontryagin dual of g it has the structure of a locally com pact abelian group in a natural way by endowing it with the weak topology inherited from l g local compactness being a consequence of the fact that 0 is a weak closed subset of the closed unit ball bl g which is weak compact by the banach alaoglu theorem it follows that carries a haar measure which is again unique up to a normalisation every g g defines a character 7 g on and the pontryagin duality theorem asserts that these are the only ones and the pontryagin dual of equals g both as a set and as an lca group every character induces a symmetry on l 2 g via v f g g f g g g f l 2 g we refer to v as the boost over in the language of chapter 5 v is the pointwise multiplier with it is immediate from the above definitions that the so called weyl commutation rela tion holds proposition 15 37 weyl commutation relation for all g g and we have v ug g ugv proof for f l 2 g and g g we have v ug f g g ug f g g f g 1 g and g ugv f g g v f g 1 g g g 1 g f g 1 g g f g 1 g we now turn to the definition of a pair of canonical observables that can be associ ated with lca groups for the statement of the second part of the theorem we need the plancherel theorem for lca groups which asserts that the fourier plancherel trans form f l 1 g l defined by f f g f g g d g 582 states and observables where is a haar measure on g maps l 1 g l 2 g into l 2 and there is a unique normalisation of the haar measure of such that f extends to a unitary operator from l 2 g onto l 2 for later reference we note that g g 1 and hence fug f g f g 1 g g d g g f g gg d g g 1 f f 15 14 where the second identity follows by substitution and invariance of theorem 15 38 position and momentum let g be an lca group let be its pon tryagin dual and let b g and b be their borel algebras then 1 there exists a unique g valued observable x b g p l 2 g such that for all we have v g dx and it is given by xb f 1 b f for f l 2 g and b b g 2 there exists a unique valued observable b p l 2 g such that for all g g we have ug gd and it is given by b f f 11 bf f for f l 2 and b b g proof 1 consider the g valued observable x b g l l 2 g defined by xb f 1 b f b b g f l 2 g for borel sets b g the operator t 1 b g 1 b dx on l 2 g is the pointwise multiplier t 1 b f 1 b f by linearity for simple functions on g the operator t g dx on l 2 g is the pointwise multiplier t f f by approximation the operator t g dx is the pointwise multiplier t f f v f this proves existence we only sketch the proof of uniqueness for the special cases g rd and g t the missing details are easily filled in by using the properties of the fourier transform proved in chapter 5 if x is an observable satisfying v g dx then for all f l 2 g we have g dx f g dx f this can be interpreted as saying that the finite borel measures x f and x f have the same fourier transforms their equality therefore follows from the injectivity of the fourier transform as a mapping from m g to l 2 we begin with the existence part applying the construction of the preceding part to we obtain the dual position operator x b l l 2 given by x b 1 b b b f l 2 15 5 symmetries 583 by conjugation with the fourier plancherel transform it induces an observable b l l 2 g b f f 1 x b f f b b f l 2 g this observable has the desired property uniqueness is proved in the same way as in part 1 definition 15 39 position and momentum the g valued observable x and the valued observable of the theorem are called the position and momentum observables of g respectively proposition 15 40 let g be an lca group and let x and be the position and mo mentum observables of g 1 x is covariant with respect to every g ug and conserved under every v ugxbu g f g xgb f g v xbv f 1 b f xb f 2 is covariant with respect to every v and conserved under every ug v bv f b f ug bu g f 1 b f b f proof 1 for all g g and b b g we have ugxbu g f g 1 bug 1 f g 1 g 1 b g 1 g f g xgb f g proving covariance with respect to g ug conservation under v is even simpler v xbv f 1 b 1 f 1 b f xb f the proof of 2 is entirely similar remark 15 41 complementarity in the physics literature the duality between the position and momentum observables is referred to as complementarity as we will see in the next two sections this captures the complementarity of the position and momentum observables in rd as well as that of the angle and angular momentum observables in t 15 5 b the case g rd position and momentum we now specialise to g rd with normalised lebesgue measure dm x 2 d 2 dx as the haar measure every character rd t is of the form x e x e ix for some rd under the identification e we have rd the haar measure being the normalised lebesgue measure m to distinguish g rd from its dual rd we use roman letters for elements of g and greek letters for elements of its dual 584 states and observables for every y rd the translation y x 7 x y is a symmetry of rd the induced symmetry uy on l 2 rd m is right translation over y uy f x f x y x rd f l 2 rd m for every rd the boost v on l 2 rd m is given by v f x e ix f x x rd f l 2 rd m the weyl commutation relation takes the form v ux e ix uxv x r d applying this identity to functions in c 1 c r d and differentiating this relation with re spect to x j and k we obtain the heisenberg commutation relation x j k kx j i jki 15 15 where x j f x x j f x k f x 1 i f xk x 15 16 the rigorous interpretation of 15 15 is that for all f c 1 c rd the equality x j k f kx j f i jk f holds in l 2 rd m of course 15 15 could also be derived directly from the definitions given in 15 16 when considered as densely defined operators in l 2 rd m with domain c 1 c r d the operators x j and k are closable and their closures are selfadjoint on l 2 rd m indeed by stone s theorem theorem 13 46 the generators of the unitary c 0 groups ute j t r and vtek t r are of the form ia j and ibk with a j bk selfadjoint moreover c 1 c r d is contained in their domains and we have a j f x j f and bk f k f for all f c 1 c rd the space c 1 c r d is dense in l 2 rd m and invariant under both groups and therefore by proposition 13 5 it is dense in both d a j and d bk with respect to their respective graph norms with slight abuse of notation we write x j and k for the selfadjoint closures and denote their domains by d x j and d k for pure states represented by a norm one function f d x j d j such that x j f j f d x j d j the uncertainty principle of theorem 15 17 takes the form x j j 1 2 it follows from proposition 15 40 that the position observable x is covariant with respect to translations and conserved under boosts and that the momentum observable is conserved under translations and covariant with respect to boosts this essentially characterises these observables 15 5 symmetries 585 theorem 15 42 covariance characterisation of position and momentum up to con jugation with a translation respectively a boost position and momentum are charac terised by their covariance and conservation properties more precisely denoting by x and the position and momentum observables of definition 15 39 the following asser tions hold 1 if the observable p b rd p l 2 rd m is covariant with respect to all pairs x ux x rd and conserved under all boosts v rd then there exists a unique y rd such that pb uyxbu y b b r d 2 if the observable p b rd p l 2 rd m is invariant under all translations ux x rd and covariant with respect to all pairs v rd then there exists a unique rd such that pb v bv b b rd proof let the projection valued measure p b rd p l 2 rd m be covariant with respect to all pairs x ux and conserved under all boosts v the boost invari ance means that every projection pb commutes with pointwise multiplication with ev ery trigonometric exponential x 7 exp ix by lemma 5 34 this implies that pb is a pointwise multiplier of the form pb f x mb x f x with mb l rd m since pb is a projection mb must be an indicator function say of the set cb pb f 1 cb f substituting this into the covariance with respect to translations we arrive at the identity 1 cb x t 1 cb t as elements of l rd m that is we have cb t cb t up to a null set similarly one sees that crd r d and c b cb up to null sets finally if b and b are disjoint then so are pb and pb and therefore cb and cb are disjoint up to a null set it follows that the mapping b 7 cb commutes up to null sets with translations and the boolean set operations let b 0 1 d be the half open unit cube suppose x y rd are lebesgue points of 1 cb satisfying max 16 j 6 d x j y j 1 then cb and cb y x intersect in a set of positive measure this is only possible if b and b y x intersect in a set of positive measure but these sets are disjoint this contradiction proves that all lebesgue points x y of 1 cb satisfy max 16 j 6 d x j y j 6 1 since almost every point of 1 cb is a lebesgue point it follows that up to a null set cb is contained in the rectangle dj 1 a j b j where a j inf x j x is a lebesgue point of 1 cb b j sup x j x is a lebesgue point of 1 cb 586 states and observables in particular since 0 6 b j a j 6 1 up to a null set we have cb dj 1 a j a j 1 a b where a a 1 ad we next claim that up to a null set we have equality cb a b indeed the sets k b with k zd are pairwise disjoint and their union is rd hence up to null sets the sets ck b k cb are disjoint and their union is rd this is only possible if a b cb is a null set this proves the claim let n n and consider the set b n 0 2 n d the same argument as above proves that there exists an a n rd such that cb n a n b n now b is the disjoint union of 2 nd translates k b n k 0 2 n 1 d therefore up to a null set cb a b is the disjoint union of the 2 nd sets ck b n a n k b n this union equals a n b this shows that a n a for all n n summarising what we have proved we find that for all sets b of the form y b n with y rd and n z we have pb f 1 a b f equivalently this can be expressed as pb uaxbu a uaxbu a this proves the first part of the theorem to prove the second part suppose that the projection valued measure p b rd p l 2 rd m is conserved under all uy and covariant with respect to all pairs v then p b f 1 pbf defines a projection valued measure that is covariant with respect to all pairs y uy and conserved under all v it follows from the previous step that p uaxu a for some a rd and therefore p f p f 1 va v a by 15 14 15 5 c the case g t angle and angular momentum the results of the preceding section have natural analogues for the unit circle t we identify t with the unit circle of c and take the normalised lebesgue measure on t as haar measure every character t t is of the form z zk z t for some k z under this identification we have z its normalised haar measure being the counting measure for every w t the rotation z 7 wz is a symmetry of t the induced symmetry uw on l 2 rd m is given by uw f z f w 1 z z t f l 2 t 15 17 15 5 symmetries 587 for every k z the boost vk on l 2 t is given by vk f z z k f z z t f l 2 t 15 18 the weyl commutation relation takes the form vkuz z kuzvk z t k z the position and momentum observables in t associated with the symmetries uz and vk are denoted by and l and are called the angle and orbital angular momentum observables they take values in t and z respectively in particular angular momentum can only assume discrete values in the physics literature one speaks about quanta of angular momentum remark 15 43 by viewing z as a subset of the real line we may identify l with a real valued observable and thus associate with l a selfadjoint operator l on l 2 r there is no natural way however to do the same with one could identify t with the interval contained in the real line and thus identify with a real valued observable the choice of the interval is somewhat arbitrary however and entails a nonunique ness issue that cannot be resolved satisfactorily the associated selfadjoint operator appears not to be very useful for instance it does not satisfy the continuous variable weyl commutation relation eis eit l eisteit l eis this will be further discussed in problem 15 13 by proposition 15 40 is covariant under every pair z uz and conserved under every vk and l is conserved under every uz and covariant under every pair k vk repeating the proof of theorem 15 42 almost verbatim we arrive at the following result theorem 15 44 covariance characterisation of angle and angular momentum up to conjugation with a translation respectively a boost angle and angular momentum are characterised by their covariance and conservation properties more precisely denot ing by and l the position and momentum operators associated with the rotations uz and boosts vk given by 15 17 and 15 18 the following assertions hold 1 if the observable p b t p l 2 t is covariant with respect to all pairs z uz z t and conserved under all vk k z then there exists a unique w t such that pb uw bu w b b t 2 if the observable p b z p l 2 t is conserved under all uz z t and 588 states and observables covariant with respect to all pairs k vk k z then there exists a unique j z such that pb vjlbv j b b z 15 5 d the stone von neumann theorem we have seen in theorem 15 42 that therd valued position and momentum observables are uniquely determined up to conjugation with a translation and a boost respectively by their transformation properties under translations and boosts it is interesting to ob serve that both the covariance relation for position uxxbu x f xxb f x r d f l 2 rd m and the covariance relation for momentum v bv f b f r d f l 2 rd m imply the weyl commutation relation here as before dm x 2 d 2 dx is the nor malised lebesgue measure indeed approximating eix by simple functions as in the proof of theorem 15 38 we find that the covariance relation for position implies the identity v ux e ix uxv for x rd which is the weyl commutation relation in the same way the covariance relation for momentum implies the weyl commutation re lation in view of this it is reasonable to ask to what extent position and momentum are determined by the weyl commutation relation the answer to this question is provided by a theorem due to stone and von neumann theorem 15 48 and its corollary proving this theorem is the main objective of the present section we start with some preparation suppose that u v rd l h are strongly contin uous unitary representations ofrd on a hilbert space h such that the weyl commutation relation holds that is v u x e ix u xv x r d 15 19 the relation 15 19 states that u and v commute up to a multiplicative scalar of mod ulus one this suggests to interpret 15 19 as a projective unitary representation of rd rd on h there is a quick way to extend 15 19 to a unitary representation as follows consider the unitary operators w x e 1 2 ix u xv e 12 ix v u x x r d 15 20 15 5 symmetries 589 the operators w x defined by 15 20 satisfy w x w x e 1 2 i x x v u xv u x e 1 2 i x x ix v v u xu x e 1 2 i x x e 1 2 i x x v u x x e 1 2 i x x w x x 15 21 from this it follows that the unitary operators defined by w x t eitw x 15 22 satisfy w x t w x t ei t t w x w x ei t t 12 x x w x x w x t x t 15 23 where x t x t x x t t 1 2 x x one easily checks that the operation turns hd rd rd r into a group definition 15 45 heisenberg group the heisenberg group in dimension d is the group hd rd rd r with composition law x t x t x x t t 1 2 x x the identity 15 23 informs us that w defines a unitary representation of the heisen berg group hd on h it is strongly continuous and it satisfies w 0 0 t eit i t r 15 24 definition 15 46 schro dinger representation the schro dinger representation is the unitary representation w hd l l 2 rd m arising in the special case where the unitary representations u v rd l l 2 rd m are given by translations and boosts respectively explicitly the schro dinger representation is given by w x t f x eite 1 2 ix eix f x x proposition 15 47 the schro dinger representation is irreducible that is the only closed subspaces of l 2 rd m invariant under the action of w are the trivial subspaces 0 and l 2 rd m 590 states and observables the proof of this proposition will be given at the end of the section for it uses ele ments of the proof of the following theorem which says that the schro dinger represen tation is essentially the only irreducible unitary representation of hd satisfying 15 24 theorem 15 48 stone von neumann let w hd l h be a strongly continuous unitary representation of hd on a separable hilbert space h if w is irreducible and satisfies w 0 0 t eit i for all t r then w is unitarily equivalent to the schro dinger representation w more precisely there exists a unitary operator s l 2 rd m h such that w x t sw x t s x t hd the operator s is unique up to a multiplicative scalar of modulus one here we use the term unitary operator for an operator s h k where h and k are hilbert spaces such that s s i the identity operator on h and ss i the identity operator on k we have the following immediate corollary for representations arising from pairs of unitary representations satisfying the weyl commutation relation corollary 15 49 let u v rd l h be strongly continuous unitary representa tions on a separable hilbert space h satisfying the weyl commutation relation v u x e ix u xv x r d suppose furthermore that the family u x v x rd rd acts irreducibly on h in the sense that the only closed subspace invariant under all operators ux and v x rd rd are the trivial subspaces 0 and h then there exists a unitary operator s l 2 rd m h such that u x suxs x rd v sv s rd where u and v are the translation and boost representations on l 2 rd m respectively the operator s is unique up to a multiplicative constant of modulus one proof defining w hd l h by 15 20 and 15 22 the irreducibility assumption of the corollary translates into the irreducibility of the representation w we now fix a strongly continuous unitary representation w hd l h and define u x w x 0 0 v w 0 0 w x w x 0 then 15 19 15 23 hold again we write m for both the normalised lebesgue mea sures on rd and r 2 d 15 5 symmetries 591 definition 15 50 weyl transform for a l 1 r 2 d m we define the operator w a l h by w a h r 2 d a x w x hdm x dm h h where the integral is a bochner integral in h the next two lemmas state some properties for the weyl transform associated with the schro dinger representation w hd l l 2 rd m lemma 15 51 for all a l 1 r 2 d m l 2 r 2 d m the operator w a is hilbert schmidt on l 2 rd m and w a l 2 l 2 rd m a l 2 r 2 d m proof for the schro dinger representation we have the explicit formula w x f x e 1 2 ix eix f x x f l 2 rd m 15 25 where w x w x 0 as in 15 22 by a change of variables and fubini s theo rem we obtain w a f r 2 d a x e 1 2 ix ei f x dm x dm rd rd a x e 1 2 i x ei dm f x dm x rd k x f x dm x where k x x rd a x x e 1 2 i x x dm by plancherel s theorem r 2 d k y z 2 y z 2 2 dm y dm z r 2 d rd a z e 1 2 iy dm 2 dm y dm z 2 d r 2 d a z y 2 dm y dm z 2 d a 22 and hence r 2 d k x x 2 dm x dm x 1 2 d r 2 d k y z 2 y z 2 2 dm y dm z a 22 the result now follows from example 14 3 which says that an integral operator with square integrable kernel is hilbert schmidt with hilbert schmidt norm equal to the l 2 norm of the kernel 592 states and observables since l 1 r 2 d m l 2 r 2 d m is dense in l 2 r 2 d m the lemma implies that the map ping w a 7 w a has a unique extension to an isometry from l 2 r 2 d m into the space of hilbert schmidt operators l 2 l 2 rd m this extension is again denoted by w a special role is played by the functions a 0 x exp 1 4 x 2 2 x rd 0 x 2 d 4 exp 1 2 x 2 x rd note that 0 l 2 rd m 1 lemma 15 52 the operator w a 0 equals the rank one projection 0 0 proof using 15 25 and the elementary identity which follows from lemma 5 20 rd e 1 2 ix eiu exp 1 4 2 dm 2 d 2 exp u 1 2 x 2 we obtain for f l 2 rd m w a 0 f r 2 d exp 1 4 x 2 exp 1 4 2 e 1 2 ix ei f x dm x dm 2 d 2 rd exp 1 2 x 2 exp 1 4 x 2 f x dm x 2 d 2 exp 1 2 2 rd exp 1 2 x 2 f x dm x 0 0 f returning to a general strongly continuous unitary representation w hd l h we note the following important multiplicativity property lemma 15 53 for all a b l 1 r 2 d m we have w a w b w a b where the so called twisted convolution a b l 1 r 2 d m is defined by a b x r 2 d e 1 2 i x x a x x b x dm x dm young s inequality implies that a b does indeed belong to l 1 rd m proof fix h h by 15 21 a change of variables and fubini s theorem w a w b h r 4 d a x b x w x w x hdm x dm dm x dm r 4 d e 1 2 i x x a x b x 15 5 symmetries 593 w x x hdm x dm dm x dm r 4 d e 1 2 i x x a x x b x w x hdm x dm dm x dm r 2 d a b x w x hdm x dm w a b h this lemma is used to establish the following technical fact lemma 15 54 we have w a 0 w x w a 0 a 0 x w a 0 x rd proof repeating the steps in the proof of lemma 15 53 for all h h we obtain w x w a 0 h r 2 d a 0 x w x w x hdm x dm r 2 d e 1 2 i x x a 0 x x w x hdm x dm w ax h 15 26 where ax x e 1 2 i x x a 0 x x hence by lemma 15 53 the lemma is equivalent to the statement that w a 0 ax a 0 x w a 0 for this it suffices to show that a 0 ax a 0 x a 0 by the injectivity of the schro dinger representation w which follows from lemma 15 51 this in turn is equivalent to showing that w a 0 w x w a 0 w a 0 ax a 0 x w a 0 the verification of this identity proceeds by explicit calculation by lemma 15 52 w a 0 w x w a 0 f 0 0 w x 0 0 f w x 0 0 f 0 0 w x 0 0 w a 0 f moreover by 15 25 lemma 15 52 and an elementary computation w x 0 0 e 1 2 ix ei 0 x 0 2 d 2 e 1 2 ix rd eiy exp 1 2 y x 2 exp 1 2 y 2 dm y 594 states and observables exp 1 4 x 2 exp 1 4 2 a 0 x we are now ready for the proof of the stone von neumann theorem proof of theorem 15 48 we split the proof into three steps step 1 we begin by showing that w a 0 is a rank one projection by lemmas 15 52 and 15 53 applied to w w a 0 a 0 w a 0 w a 0 0 0 2 0 0 w a 0 by the injectivity of w which follows from lemma 15 51 this implies that a 0 a 0 a 0 another application of lemma 15 53 this time to w gives w a 0 w a 0 w a 0 a 0 w a 0 this means that w a 0 is a projection we will use the assumption of irreducibility of w to prove that this projection has rank one we begin by showing that w a 0 6 0 indeed if we had w a 0 0 then for all x rd and h h h we would have by 15 21 and 15 26 0 w x w a 0 w x h h w ax w x h h r 2 d e 1 2 i x x a 0 x x w x w x h h dx d r 2 d e 1 2 i x x a 0 x w x x w x h h dx d r 2 d e i x x a 0 x w x h h dx d r 2 d e i x x a 0 x w x h h dx d this being true for all x rd the fourier inversion theorem would then imply that w x h h 0 for almost all x rd since h h h were arbitrary it would follow that w x 0 for almost all x rd contradicting the fact that all these operators are unitary fix any nonzero h r w a 0 this is possible by the preceding argument let y h be the closed linear span of the set w x h x rd from 15 21 we see that y h is invariant under each operator w x and hence under the representation w since w is assumed to be irreducible it follows that y h h 15 5 symmetries 595 by 15 19 and 15 20 w x e 1 2 ix u x v e 1 2 ix u xv e 12 ix v u x w x this identity implies that w a 0 is selfadjoint and then we infer from lemma 15 54 that if h h r w a 0 say h w a 0 g and h w a 0 g then w x h w x h w x w x w a 0 g w a 0 g e 1 2 i x x w x x w a 0 g w a 0 g e 1 2 i x x a 0 x x w a 0 h h e 1 2 i x x a 0 x x g g 15 27 using in the last step that w a 0 h h w a 0 h w a 0 h since w a 0 is an orthogo nal projection in particular if h h with h h r w a 0 then y h y h since y h h this implies y h 0 in particular w x h 0 for all x rd and therefore h 0 by the injectivity of w x recall that these operators are unitary this proves that r w a 0 equals the one dimensional span of h step 2 define s n n 1 cnw xn n 0 n n 1 cnw xn n h 0 where h 0 r w a 0 has norm h 0 1 0 it follows from 15 27 applied to both w and w that s is well defined and isometric on the linear span of the functions w x 0 x rd and hence extends to an isometry from y 0 onto y h 0 the former being defined as the closed linear span of the functions w x 0 x rd but y h 0 h and by applying this to w we see that likewise y 0 l 2 rd m this proves that s is isometric from l 2 rd m onto h and hence unitary since s 0 h 0 this proves that s has the desired properties step 3 if t l 2 rd m h is another unitary operator with the property that w x t tw x t t 1 for all x t hd then s 1 tw x w x s 1 t for all x rd from this it follows that s 1 t commutes with w a 0 and therefore it maps the one dimensional range of this operator onto itself this implies that s 1 t f ei f for some r and all f r w a 0 then t n n 1 cnw xn n f ss 1 t n n 1 cnw xn n f s n n 1 cnw xn n s 1 t f ei s n n 1 cnw xn n f and therefore t ei s 596 states and observables proof of proposition 15 47 reasoning by contradiction suppose that y is a nontrivial closed subspace invariant under w and let y be its orthogonal complement the iden tity w x w x implies that y is invariant under w as well by restriction we thus obtain two strongly continuous unitary representations wy hd l y and wy h d l y and they satisfy wy 0 0 t e it iy wy 0 0 t e it iy lemma 15 52 and step 1 of the proof of theorem 15 48 imply that w a 0 wy a 0 and wy a 0 are orthogonal projections of rank one in l 2 rd m y and y respectively this leads to the contradiction y 0 y 0 w a 0 wy a 0 wy a 0 as it represents the rank one projection y 0 y 0 as a sum of two disjoint rank one projec tions the final result of this section describes the ornstein uhlenbeck semigroup in terms of the weyl calculus let us first recall some notation from theorem 13 58 where a different normalisation of lebesgue measure was used the multiplication e e f x exp 1 4 x 2 f x is unitary from l 2 rd to l 2 rd m and the dilation d d f x 2 d 4 f 2 x is unitary on l 2 rd m consequently the operator u d e 15 28 is unitary from l 2 rd to l 2 rd m theorem 15 55 for all t 0 we have with s 1 e t 1 e t ou t 1 s d u 1 w as u where w is the schro dinger representation and as x exp s x 2 2 x rd proof by the definition of the weyl transform the identity 15 25 and a change of variables for a l 2 r 2 d m one has w a f y r 2 d a 1 2 x y exp i x y f x dm x dm 15 5 symmetries 597 by the definition of u this gives the explicit formula u 1 w a u f y r 2 d a 1 2 x y 2 exp i x y 2 exp 1 2 x 2 1 4 y 2 f x 2 dm dm x 1 2 d 2 r 2 d a x y 2 2 exp i x y 2 exp 1 4 x 2 1 4 y 2 f x dm dm x rd ka y x f x dm x with ka y x 1 2 d 2 exp 1 4 x 2 1 4 y 2 rd a x y 2 2 exp i x y 2 dm applying this to the function as we obtain kas y x 1 2 d 2 exp 1 4 x 2 1 4 y 2 rd exp s 2 1 8 x y 2 exp i x y 2 dm 1 2 d 2 exp s 8 x y 2 exp 1 4 x 2 1 4 y 2 rd exp s 2 i x y 2 dm 1 2 d 2 exp 1 8 s x y 2 exp s 8 x y 2 exp 1 4 x 2 1 4 y 2 rd exp s 2 dm 1 2 dsd 2 exp 1 8 s x y 2 exp s 8 x y 2 exp 1 4 x 2 1 4 y 2 1 2 dsd 2 exp 1 8 s 1 s 2 x 2 y 2 1 4 1 s s xy exp 1 2 x 2 therefore u 1 w as u f y rd kas y x f x dm x 1 2 d 2 s d 2 rd exp 1 8 s 1 s 2 x 2 y 2 1 4 1 s s xy f x e 1 2 x 2 dx 598 states and observables with s 1 e t 1 e t this identity implies 1 s d u 1 w as u f y 1 2 d 2 d 2 2 1 e t d 1 e t 1 e t d 2 rd exp 1 2 e 2 t 1 e 2 t x 2 y 2 e t 1 e 2 t xy f x exp 1 2 x 2 dx 1 2 d 2 1 1 e 2 t d 2 rd exp 1 2 e ty x 2 1 e 2 t f x dx rd mt y x f x dx ou t f y where mt y x 1 2 d 2 1 1 e 2 t d 2 exp 1 2 e ty x 2 1 e 2 t is the mehler kernel the last step used the mehler formula 13 32 for ou t 15 6 second quantisation up to this point we have been concerned with the problem of first quantisation namely how to define the quantum analogues of classical observables in order to arrive at a version of quantum mechanics that is consistent with special relativity one must be able to describe systems with a variable number of particles this is due to the fact that the equivalence of mass and energy makes it possible that particles are created and annihilated if one uses a hilbert space h to describe the pure states of a single particle one postulates that the n fold hilbert space tensor product h n h h n times describes the pure states of a system of n such particles more precisely as explained in appendix b we have a direct sum decomposition h n n h n h into symmetric and antisymmetric tensor products a boson is a particle whose n particle states are given by elements of n h and a fermion is a particle whose n particle states are given by elements of n h we will discuss the bosonic theory only the fermionic theory requires deeper tools from noncommutative analysis that would take us too far afield the bosonic theory moreover has interesting connections to sev eral other topics covered in this work 15 6 second quantisation 599 the elements of the hilbert space direct sum h n n n h correspond to superpositions of states carrying different numbers of bosons the process of passing from h to h is called bosonic or symmetric second quantisation the observation that every contraction t on h extends to a contraction t on h see section 15 6 c allows us to establish a beautiful connection for the special case h kd with the ornstein uhlenbeck semigroup discussed in section 13 6 e namely ou t e t i theorem 15 68 under this correspondence the negative generator l of this semi group corresponds to the number operator of section 15 3 d where a unitarily equiva lent model of it was studied our study will also uncover a deep connection between second quantisation and the fourier transform over the complex scalars the fourier plancherel transform is unitarily equivalent to the second quantisation of the operator ii theorem 15 70 taken together these facts connect the fourier plancherel trans form to the ornstein uhlenbeck semigroup some connections of second quantisation with number theory will be discussed in the notes for simplicity we will limit ourselves to the case where the hilbert space describing the pure states of a single particle is finite dimensional mutatis mutandis the theory generalises to arbitrary hilbert spaces h if one replaces the gaussian measure by a so called h isonormal process a central object in malliavin calculus although this gen eralisation does not pose any mathematical difficulties we will not pursue it as it adds a layer of abstraction that would only obscure the various connections just described unless otherwise stated the scalar field k is allowed to be either real or complex 15 6 a the wiener ito chaos decomposition for h kd we define h l 2 rd l 2 rd by h x x h d j 1 x jh j x rd let hn n n be the sequence of hermite polynomials introduced in section 3 5 b for n n we define hn span hn h h 1 the closure being taken in l 2 rd here hn h x hn h x hn x h for x rd the space hn is sometimes referred to as the gaussian chaos of order n note that h 0 k 1 is the one dimensional space of constant functions 600 states and observables we are going to prove that the subspaces hn are pairwise orthogonal and induce a direct sum decomposition n n hn l 2 rd in a second step we will identify orthonormal bases for the summands hn to start our analysis for h kd we define the functions kh exp h 1 2 h 2 from exp h l 2 rd we see that kh is well defined as an element of l 2 rd from 3 15 we see that kh exp h h h 1 2 h 2 n n h n n hn h h h k d 15 29 in particular kh n n 1 n hn h h 1 15 30 in 3 15 we worked over the real scalars over the complex scalars 3 15 15 29 and 15 30 follow by analytic continuation lemma 15 56 the functions kh h kd span a dense subspace in l 2 rd proof suppose that f l 2 rd is such that rd f kh d 0 for all h k d then rd f exp h d 0 for all h k d taking h dj 1 c je j with e j the jth standard unit vector of rd we see that rd f x exp d j 1 c jx j d x 0 for all c 1 cd k in case the scalar field is real by analytic continuation we obtain that the same holds for all c 1 cd c taking c j iy j with y j r this implies that the fourier transform of the function x 7 f x exp 12 x 2 vanishes by the injectivity of the fourier transform theorem 5 21 we conclude that f x exp 12 x 2 0 for almost all x rd that is f x 0 for almost all x rd theorem 15 57 wiener ito decomposition we have the orthogonal decomposition l 2 rd n n hn proof fix h h kd with h h 1 and s t r repeating the steps of 3 16 for all s t r we have h s h h t h l 2 rd exp st h h 15 6 second quantisation 601 substituting h r k 0 rk k hk and exp st h h k 0 st k k h h k and taking the partial derivative n m sm tn at s t 0 on both sides of the resulting identity we obtain hm h hn h l 2 rd mnn h h n noting that mnn mn m n this can be equivalently stated as hm h m hn h n mn h h n 15 31 for m 6 n this implies hm hn if f hn for all n n then f hn h l 2 rd 0 for all h k d with h 1 and therefore 15 29 implies that f kh l 2 rd 0 for all h k d and therefore f 0 by lemma 15 56 the next result shows that the wiener ito decomposition diagonalises the ornstein uhlenbeck semigroup ou on l 2 rd introduced in section 13 6 e theorem 15 58 the following identities hold 1 for all h kd and t 0 ou t kh ke t h 2 for all n n f hn and t 0 ou t f e ntf proof completing squares in the exponential for all h rd and t 0 we have rd exp 1 e 2 t y h d y d j 1 1 2 r exp 1 e 2 ty jh j 1 2 y j 2 dy j d j 1 exp 1 2 1 e 2 t h j 2 exp 1 2 1 e 2 t h 2 hence from the definitions of ou t h and kh ou t kh x rd exp h e tx 1 e 2 ty 1 2 h 2 d y exp e t x h 1 2 h 2 rd exp 1 e 2 t y h d y exp e t x h 1 2 h 2 exp 1 2 1 e 2 t h 2 exp x e th 1 2 e th 2 ke t h x this gives 1 when k r when k c the result follows by analytic continuation 602 states and observables if h 1 and s 0 it follows from 15 29 and the preceding calculation that ou t n n sn n hn h ou t ksh ke t sh n n sne nt n hn h taking nth derivatives in s and evaluating at s 0 we obtain the identity ou t hn h e nthn h by linearity and taking limits this gives 2 part 2 of the theorem implies that each summand hn is contained in d l and lf nf f hn n n over the complex scalars proposition 10 32 can be applied and we obtain corollary 15 59 l n 15 6 b the wiener ito isometry our next aim is to find an orthonormal basis for each summand hn this will be achieved in theorem 15 60 by means of multivariate hermite polynomials for n n 1 nk nk we write n k j 1 n j n k j 1 n j for orthonormal systems h h j kj 1 and n n k we define hn h k j 1 hn j h j theorem 15 60 let h h j dj 1 be an orthonormal basis for k d for each n n the family 1 n hn h n nd n n defines an orthonormal basis for hn as a consequence the family 1 n hn h n nd defines an orthonormal basis for l 2 rd 15 6 second quantisation 603 proof the proof is divided into three steps step 1 first we prove that the family 1 n hn h n nd is an orthonormal system in l 2 rd let m n nd by separation of variables and 15 31 1 m hm h 1 n hn h d i 1 d j 1 1 mi hmi hi 1 n j hn j h j d i 1 d j 1 min j hi h j n j d j 1 m jn j mn 15 32 step 2 next we prove completeness of this system in l 2 rd suppose f l 2 rd is such that f hn h 0 for all n nd fix an arbitrary h kd and put gk k j 0 1 j j h then limk gk exp h in l 2 rd by dominated convergence by writing h dj 1 c jh j we see that each gk is a polynomial in h 1 hd and such poly nomials are linear combinations of the functions hn h for appropriate multi indices n nd it follows that f gk 0 for all k n passing to the limit k it follows that f exp h 0 and therefore f kh 0 since h kd was arbitrary lemma 15 56 implies that f 0 together with step 1 this proves that hn h n nd is an orthonormal basis of l 2 rd step 3 the final step is to prove that 1 n hn h n nd n n is an or thonormal basis for hn denote by gn the closed linear span of the set hn h n nd n n by step 1 gm gn if m 6 n if h dj 1 c jh j k d and 0 6 m 6 n then hm h hm d j 1 c j h j is a linear combination of polynomials of the form hk h with k 6 m and therefore hm h m j 1 g j in particular this implies that hm m j 1 g j n j 1 g j and therefore n j 1 h j n j 1 g j also by step 1 hn n 1 j 1 g j it follows that hn gn this being true for all n n by step 2 it follows that l 2 rd n n hn n n gn l 2 rd from this we infer that hn gn for all n n the orthogonal projection in l 2 rd onto hn will be denoted by jn 604 states and observables corollary 15 61 for all n n and h kd with h 1 we have jn n h hn h more generally if h 1 hk are orthonormal in kd and n n 1 nk nk then j n n 1 h 1 nkhk hn 1 h 1 hnk hk proof we have hn 1 h 1 hnk hk n 1 h 1 nkhk q h 1 hk 15 33 where q is a polynomial of degree strictly less than n hence theorem 15 60 im plies that q h 1 hk n 1 j 0 h j and the corollary follows by projecting 15 33 onto h n since hn 1 h 1 hnk hk h n the left hand side remains unchanged the right hand side is mapped to j n n 1 h 1 nkhk corollary 15 62 for all h kd with h 1 kh n n 1 n jn n h proof this follows from the previous corollary and 15 30 proposition 15 63 for all g 1 gn kd and h 1 hn kd we have jn g 1 gn jn h 1 hn sn g 1 h 1 gn h n where sn is the group of permutations of 1 n proof let e j dj 1 be the standard basis of k d choose nonnegative integers 1 j and m 1 mk such that 1 j m 1 mk n by adding extra zeroes to the shortest of these two sequences we may assume that j k by corollary 15 61 jn 1 ei 1 keik h 1 ei 1 h k eik jn m 1 ei 1 mkeik hm 1 ei 1 hmk eik hence by 15 32 jn 1 ei 1 keik jn m 1 ei 1 mkeik m 1 m 1 k mk on the other hand with g 1 g 1 ei 1 g 1 k 1 1 g 1 k eik h 1 hm 1 ei 1 hm 1 mk 1 1 m 1 k eik 15 34 we have sn g 1 h 1 gn h n 15 6 second quantisation 605 sn ei 1 h 1 ei 1 h 1 eik h 1 k 1 1 eik h 1 k 1 k m 1 mk 1 m 1 k mk m 1 m 1 k mk this proves the corollary in the special case 15 34 by n linearity the corollary then also follows if each of the functions f and g are finite linear combinations of such expressions and finally the general case follows by density the main result of this section relates the spaces hn to the n fold symmetric tensor product of kd the n fold tensor product kd n kd kd n times is a hilbert space with respect to the inner product j 1 g j 1 g j n m k 1 h k 1 h k n j 1 m k 1 g j 1 h k 1 g j n h k n 15 35 we identify kd 0 with the scalar field k from appendix b we recall that the n fold symmetric tensor product of kd denoted by n kd is defined as the range of the orthogonal projection p n l k d n given by p n h 1 hn 1 n sn h 1 h n h 1 hn k d and extended by linearity where sn is the group of permutations of 1 n equiva lently n kd is the subspace of those elements of kd n that are invariant under the action of sn for the formulation of the next theorem we introduce the following notation let h h j kj 1 be a finite sequence in k d for n nk with n n let h n h n 11 h nk k where h n j j h j h j n j times with the convention that h 0 1 similarly we let n h n 1 h 1 nkhk theorem 15 64 wiener ito isometry there exists a unique isometric isomorphism w kd l 2 rd with the following property for every 16 k 6 d every orthonormal system h h j kj 1 in kd every n n and every multi index n nk with n n w p n h n 1 n hn h n nk 606 states and observables this mapping w will be referred to as the wiener ito isometry to appreciate the role of the scalar field one should keep in mind that l 2 rd always means l 2 rd k hence over the real scalars the wiener ito isometry gives an isometric isomorphism w rd l 2 rd r over the complex scalars it gives an isometric isomorphism w cd l 2 rd c proof uniqueness being clear we concentrate on existence let e e j dj 1 be the standard basis in k d for every integer n n consider the linear mapping wn n kd hn defined by wn p n e n 7 1 n hn e n nd n n and extended by linearity we begin by showing that if h hi ki 1 is any orthonormal system in kd then wn p n h n 1 n hn h n nk n n 15 36 as a second step we show that wn is an isometry from n kd onto hn in view of the wiener ito decomposition these two facts prove the theorem step 1 let hi d j 1 ci je j i 1 k be the expansion in terms of the standard basis let n nk be a multi index satisfying n n then wn p n h n wn p n d j 1 c 1 je j n 1 d j 1 cd je j nk wn p n m n ame m wn m n amp ne m m n am 1 n hm e 1 n m n am d j 1 hm j e j 1 n m n amjn d j 1 m j e j 1 n jn m n am d j 1 m j e j 1 n jn m n am m e 1 n jn k 1 d j 1 c j e j n 1 n jn k 1 n h 1 n k 1 hn h 1 n hn h where the coefficients am m nd are determined by the identity m n am m k 1 d j 1 c j j n 15 6 second quantisation 607 in the formal variables 1 d and m m 1 1 md d this establishes 15 36 step 2 in this step we show that the mappings wn are isometric from n kd onto hn first let h 1 hn kd be arbitrary by proposition 15 63 we have jn h 1 hn 2 sn h 1 h 1 hn h n sn h 1 hn h 1 h n n h 1 hn p n h 1 hn n p n h 1 hn 2 the projection p n p 2 n being orthogonal and hence selfadjoint specialising to the standard basis of kd and using corollary 15 61 we obtain p n e n p n e n 1 1 e nd d 1 n jn n 1 e 1 nd ed 1 n hn 1 e 1 hnd ed 1 n hn e this identity extends to finite linear combinations by the pythagorean identity noting that both on the left and on the right the contributing terms in the sums are orthogonal this proves that the mapping in the statement of the proposition is an isometry since the multivariate hermite polynomials of degree n form an orthonormal basis in hn this isometry is surjective as a special case note that for all h kd with h 1 w h n 1 n hn h 15 37 15 6 c second quantised operators for a linear operator t on h we obtain a linear operator t n on h n by t n h 1 hn t h 1 t hn and linearity for n 0 we understand that h n k and t 0 ik where k is the scalar field proposition 15 65 if t is a bounded operator on h then t n is a bounded operator on h n of norm t n t n proof by a scaling argument it suffices to show that if t 1 then t n 1 the inequality t n 1 being obvious from the definition of the inner product on h n we prove the inequality t n 6 1 608 states and observables if the scalar field is real we denote by hc the complexification of h endowed with the norm h ih 2 hc h 2 h 2 this is a complex inner product space if t is a contraction on h then tc h ih t h it h defines a contraction on hc of the same norm noting that tc n t n c it suffices to prove the proposition in the case of complex scalars if t is unitary then t n k j 1 c jh j 1 h j n 2 k i 1 k j 1 cic j n m 1 t h i m t h j m k i 1 k j 1 cic j n m 1 h i m h j m k j 1 c jh j 1 h j n 2 and therefore t n is an isometry on h n the corresponding result for contractions follows from the fact that every contraction t on h can be represented as a convex combination of four unitaries by lemma 14 25 restricting t n to the symmetric part n h of h n we obtain well defined con tractions n t on n h of h n by taking direct sums t n n n t defines a contraction on n n n h definition 15 66 symmetric second quantisation the hilbert space completion h of n n n h is called the symmetric fock space over h when t is a contraction on h the contraction t on h is called the symmetric second quantisation of t antisymmetric second quantisation can be defined similarly but will not be studied here because of this we will omit the adjective symmetric from now on and simply talk about second quantisation if s and t are contractions on h their second quantisations satisfy i i st s t t t 15 38 in what follows we take again h kd if t is a contraction on kd via the wiener ito isometry theorem 15 64 the operator t induces a contraction on l 2 rd which by a slight abuse of notation will be denoted by t as well it is easily checked that 15 38 holds again lemma 15 67 if t is a contraction on kd then for all h kd t kh kt h 15 6 second quantisation 609 proof denoting by w the wiener ito isometry for all h kd with t h 6 0 we have kt h n n t h n n hn t h t h n n t h n n w t h t h n n n 1 n w t h n w n n 1 n n t h n w t n n 1 n h n t w n n 1 n h n t n n 1 n hn h t kh where the first identity follows from 15 29 and the second and penultimate steps follow from 15 37 if t h 0 then kt h k 0 1 t k 0 as a special case for the ornstein uhlenbeck semigroup we obtain theorem 15 68 ornstein uhlenbeck semigroup and second quantisation under the wiener ito isometry for all t 0 we have ou t e t i proof this follows from theorem 15 58 and lemma 15 67 which give ou t kh ke t h e t i kh and the density of the span of the functions kh in l 2 rd shown in lemma 15 56 over the real scalars we have the following positivity result theorem 15 69 positivity if t is a contraction on rd then t is a positivity pre serving contraction on l 2 rd proof by lemma 15 67 for all h kd we have t kh kt h 0 moreover for all c r t exp c h t exp ch exp 1 2 c 2 h 2 t kch exp 1 2 c 2 h 2 kct h exp c t h 1 2 c 2 h 2 t h 2 by analytic continuation this identity extends to arbitrary c c let 06 f f 2 rd f l 1 rd l 2 rd f l 1 rd l 2 rd by fourier inversion t f 1 2 d 2 rd f 1 n t exp i d 610 states and observables 1 2 d 2 rd f 1 n exp i t 1 2 2 t 2 d in view of t x x t t x by dominated convergence we have t f lim 0 f t where f f g with g exp 1 2 2 1 t 2 by taking inverse fourier transforms and applying lemma 5 20 we conclude that 2 d 2 f f g if we can prove that the g is nonnegative almost everywhere on rd it follows that t f 0 almost everywhere on rd since t is a contraction we may write 2 1 t 2 i 1 t t d 2 where d i 1 t t 1 2 is invertible hence g x 1 2 d 2 rd exp 1 2 d 2 exp ix d after a change of variables the right hand side can be evaluated as a fourier transform of a gaussian and is therefore strictly positive on rd 15 6 d the segal plancherel transform in this section we discuss a gaussian analogue of the fourier plancherel transform f the so called segal plancherel transform w on l 2 rd we work over the complex scalars as before we denote by dm x 1 2 d 2 dx the normalised lebesgue measure if we reinterpret the fourier transform as an operator from l 1 rd m to l rd m f f rd exp ix f x dm x rd f l 1 rd m its restriction to l 1 rd m l 2 rd m extends to an isometry on l 2 rd m in the present section the term fourier plancherel transform will refer to this operator as in section 15 5 d we let u d e where d l 2 rd m l 2 rd m and e l 2 rd l 2 rd m are the unitary operators d f x 2 d 4 f 2 x e f x e x f x with e x exp 14 x 2 15 6 second quantisation 611 theorem 15 70 the mapping w f 7 w f defined for multivariate polynomials f rd c and analytic continuation by w f x rd f ix 2 y d y x rd extends to a unitary operator on l 2 rd and we have w u 1 f u 15 39 proof since d e and f are unitary the unitarity of w will follow from the operator identity 15 39 to prove this identity we substitute 2 y and ix to obtain w f x 1 2 d 2 rd f ix 2 y exp 1 2 y 2 dy 1 4 d 2 rd f ix d j 1 exp 1 4 2 j d 1 4 d 2 ix rd f d j 1 exp 1 4 j ix j 2 d 1 4 d 2 rd f d j 1 exp 1 4 j ix j 2 d 1 4 d 2 rd f exp 1 4 2 1 2 i x 1 4 x 2 d to justify it suffices by writing f as a linear combination of monomials and sepa rating variables to show that for any k n and x r ix r k exp 1 4 ix 2 d r k exp 1 4 ix 2 d but this is clear by cauchy s integral formula and a limiting argument using the decay at infinity hence e w e 1 f x 1 4 d 2 exp 1 4 x 2 rd exp 1 4 2 f exp 1 4 2 1 2 i x 1 4 x 2 d 1 4 d 2 rd f exp 1 2 i x d 1 2 d 2 rd 2 d 2 f 2 exp i x dm f d 2 f x d 1 f d f x where we used that f d d 1 f 612 states and observables we have the following representation of w in terms of second quantisation theorem 15 71 segal w ii proof let f rd c be a multivariate polynomial mehler s formula and theorem 15 68 tell us that for all t 0 e t i f x ou t f x rd f e tx 1 e 2 ty d y by analytic continuation we may replace t 0 by any z c with rez 0 now let z 12 i the preceding two theorems combine to the following result recall the definition of the unitary operator u of 15 28 corollary 15 72 the fourier plancherel transform is unitarily equivalent to ii more precisely we have u 1 f u ii here u is as in 15 28 this gives a neat explanation of the identity f 4 i by the multiplicativity of second quantisation it follows from the identity i 4 1 15 6 e creation and annihilation for h kd and n n the bosonic creation operator a n h n kd n 1 kd is defined by a n h sn h 1 h n 1 n 1 sn n 1 j 1 h 1 h j 1 h h j h n and the bosonic annihilation operator an 1 h n 1 kd n kd by a 0 h 0 and an 1 h sn 1 h 1 h n 1 1 n 1 sn 1 n 1 j 1 h j h h 1 h j h n 1 using the notation to express that this term is omitted these operators are well defined and bounded and their operator norms are bounded by a n h l n kd n 1 kd an 1 h l n 1 kd n kd 6 cn h 15 6 second quantisation 613 with constants cn depending on n only the first equality follows from the duality a n h an 1 h furthermore a straightforward computation gives the commutation relations an h a n 1 h a n h an 1 h h 2 i let e j dj 1 denote the standard basis of k d using the wiener ito isometry we may define operators a and a as densely defined operators from l 2 rd to l 2 rd kd and from l 2 rd kd to l 2 rd respectively by putting aw x w an e 1 x w an ed x x n kd n n and a w x 1 w xd a n e 1 x 1 a n e 1 x 1 x 1 xg n kd n n the operators a and a are dual to each other in the sense that a f g f a g f hn g h dn 15 40 the identity 15 40 easily implies that a and a are closable from now on we denote by a and a their closures and by d a and d a the domains of their closures let 1 d be the gradient viewed as a densely defined closed operator from l 2 rd to l 2 rd kd with its natural domain d h 1 rd the hilbert space of all functions in l 2 rd admitting a weak derivative belonging to l 2 rd lemma 15 73 the space pol rd of polynomials in the real variables x 1 xd is dense h 1 rd proof we sketch the main line of argument and leave some tedious details to the reader cf problem 15 16 as we have seen in section 13 6 e the densely defined closed operator associated with the sesquilinear form aou f g rd f gd x f g d aou with d aou h 1 rd equals l where l is the generator of the ornstein uhlen beck semigroup ou on l 2 rd we claim that d l is dense in d aou h 1 rd this is a special case of a general density result mentioned in the notes to chapter 13 but can be proved directly as follows since the ornstein uhlenbeck semigroup is analytic theorem 13 57 for all f l 2 rd and t 0 we have s t d l by theorem 13 31 in particular this implies s t f d aou h 1 rd and it suffices to prove that lim t 0 ou t f f h 1 rd 0 614 states and observables for all f h 1 rd for this in turn it suffices to check that for all such f we have lim t 0 ou t f f l 2 rd kd 0 writing g j f this follows by differentiating under the integral in the definition of the ornstein uhlenbeck semigroup jou t rd j f e t 1 e 2 ty d y e t rd g j e t 1 e 2 ty d y e tou t j f the definition of the domain of the operator associated with a form combined with a straightforward computation shows that pol rd is contained in d l we will show that pol rd is invariant under the ornstein uhlenbeck semigroup once this has been established proposition 13 5 implies that pol rd is dense in d l to prove the invariance of the space pol rd under the ornstein uhlenbeck semi group first let f be a monomial of the form f x xk 11 x kd d x r d 15 41 with k j n for all j 1 d for almost all x rd we have ou t f x rd f e tx 1 e 2 ty d y ft x substituting the expression 15 41 by direct evaluation we see that ft pol rd the desired invariance follows by taking linear combinations proposition 15 74 we have a with equality of domains proof first let f 1 n hn h with n n and h 1 this is the image under the wiener ito isometry of the element h n n cd and we have a f j aw h n j w an e j h h n times 1 n n 1 h e j w h h n 1 times n h e j w h h n 1 times n n 1 h e j hn 1 h on the other hand since h n nhn 1 and j h h e j f j 1 n jhn h n n 1 h e j hn 1 h 15 6 second quantisation 615 this proves that a f f for all f hn and n n since the linear span of functions f hn n n is dense in d a by definition and since is closed this gives the inclusion a to prove equality a it remains to be shown that the linear span of functions f hn n n is also dense in h 1 rd for this purpose we recall from the proof of theorem 15 60 in the special case of the standard unit basis of rd that for each n n the linear span of the polynomials hn h h 1 equals the space of all polynomials of the form x 7 hn 1 x 1 hnd xd with n 1 nd n their linear span when n ranges over n equals the space pol rd introduced above this space is dense in h 1 rd by lemma 15 73 in what follows we work over the complex scalars for j 1 d and f pol rd we let a j f a f j and a j f a 0 0 f 0 with f in the jth place by 15 40 these operators are dual to each other in the sense that with respect to the inner product of l 2 rd we have a j f g f a jg f g pol r d define the position operator q q 1 qd by q j 1 2 a j a j the choice of the normalising constant 1 2 in the definition of q j may appear unnat ural the reason for this choice will become apparent in 15 42 15 43 and 15 46 viewed as an operator in l 2 rd with dense initial domain pol rd this operator is symmetric and therefore closable we claim that its closure which we denote by q j again is selfadjoint first we claim that for almost all x rd q j f x 1 2 x j f x f pol rd indeed since by proposition 15 74 we have a j j the directional derivative in the direction of e j it follows that 2 q j f g f jg j f g suppose now that f g pol rd then with x x 1 xd j f g rd f jgd 1 2 d 2 rd f x jg x exp 1 2 x 2 dx 1 2 d 2 rd x j f x j f x g x exp 1 2 x 2 dx j f g x j f g 616 states and observables it follows that j f j f x x j f x this proves the claim the asserted selfadjoint ness of q j is an easy consequence of this claim in a similar way we define the momentum operator p p 1 p j by p j 1 i 2 a j a j again this operator initially defined on functions in pol rd is symmetric and hence closable and its closure is selfadjoint the identities below are understood in the sense that they hold when applied to func tions in pol rd some additional details are addressed in problems 15 17 15 20 from the commutation relation a j a j i we have p j q j 1 2 i a j a j a j a j a j a j a j a j 1 i a ja j a ja j 1 i i 15 42 as well as the identity 1 2 p 2 j q 2 j 1 4 a j a j 2 1 4 a j a j 2 1 2 a ja j a ja j a ja j 1 2 a j a j a ja j 1 2 i 15 43 as is checked by an easy computation in terms of the annihilation and creation op erators the ornstein uhlenbeck operator is given by l a a d j 1 a ja j 15 44 so that by 15 43 l d 2 1 2 p 2 q 2 d 2 d j 1 1 2 p 2 j q 2 j 15 45 again in the sense that these identities hold when the operators are applied to functions in pol rd the operators p and q intertwine with the momentum operator d 1 i and the position operator x in the sense that u q j u 1 x j u p j u 1 1 i j 15 46 with u the unitary operator of sections 15 5 d and 15 6 d these relations are easy to check by explicit computation and justify the terminology position and momentum for q j and p j in this way we recover the unitary equivalence established in theorem 13 58 of l d 2 with the quantum harmonic oscillator problems 617 problems 15 1 prove the assertions about orthogonal projections in section 15 1 c 15 2 prove that if p and q are orthogonal projections on a hilbert space such that r p is contained in r q then q p q p 15 3 let l h c be a state let hn n 1 be an orthonormal basis for h and let pn denote the orthogonal projection onto the span of the set h 1 hn prove that for all t l h we have t lim n pnt hint apply the cauchy schwarz inequality to the mapping t u 7 tu and take u i pn 15 4 consider a qubit in state 0 1 where c satisfy 2 2 1 compute the probabilities that upon measuring the spin in direction j 1 2 3 we find up respectively down 15 5 we take a closer look at the pauli matrices 1 2 3 a show that the complex exponentials of the pauli matrices are given by exp i j cos i i sin j j 1 2 3 b show that if v is a unit vector in r 3 then for all n n we have v n i n even v n odd use this to prove the identity exp i v cos i i sin v furthermore show that det exp i v 1 c conclude that exp i v 0 2 su 2 the group of unitary matrices acting on c 2 with determinant 1 15 6 prove that if u is a symmetry of h then the mapping u p h p h given by u p u pu enjoys the following properties i u i i ii for all p p h we have u p u p iii for all p 1 p 2 p h we have u p 1 p 2 u p 1 u p 2 u p 1 p 2 u p 1 u p 2 618 states and observables 15 7 show that position and momentum are covariant with respect to rotations r on l 2 rd m given by r f x f 1 x where so d the group of orthogonal transformations on rd with determinant 1 15 8 for g z 2 z determine the position and momentum operators on l 2 g c 2 15 9 find the projection valued measures associated with the selfadjoint operators x j and j discussed in section 15 5 b 15 10 in this problem we prove wintner s theorem there exists no pair of bounded op erators s t l h satisfying the heisenberg commutation relation st t s ii we may absorb the imaginary constant i into one of the two operators and consider the identity st t s i instead assuming that s t l h satisfy st t s i obtain a contradiction by completing the following steps a show that for all n 1 2 we have snt t sn nsn 1 b deduce that sn 1 6 0 and n sn 1 6 2 sn 1 s t 15 11 the aim of this problem is to prove that for a linear mapping l h c the following assertions are equivalent 1 t kj 1 t x j y j for suitable k 1 and x 1 xk y 1 yk h 2 is continuous with respect to the weak topology of l h 3 is continuous with respect to the strong topology of l h a prove the implications 1 2 3 the remainder of the problem is devoted to a proof of the implication 3 1 b show that 3 implies that there exist x 1 xk h such that t 6 max 16 j 6 k t x j t l h c let k be the closure of the subspace t x 1 t xk hk t l h in hk show that the linear mapping k c defined by t x 1 t xk t is well defined and bounded d using the riesz representation theorem show that is of the form as in 1 15 12 prove that for a linear mapping l h c the following assertions are equiv alent 1 there exist sequences xn n 1 and yn n 1 satisfying n 1 xn 2 and n 1 yn 2 such that for all t l h we have t 1 t xn yn problems 619 2 is continuous on bl h with respect to the weak topology of l h 3 is continuous on bl h with respect to the strong topology of l h 4 is normal if is positive and satisfies i 1 these conditions are equivalent to 5 there exists an orthogonal sequence xn n 1 satisfying n 1 xn 2 1 such that for all t l h we have t n 1 t xn xn 15 13 using the functional calculus for projection valued measures ontwe may define t arg z d z where the projection valued measure b t p l 2 t is the angle ob servable of section 15 5 c there is some ambiguity here as to how to take the argument for the sake of definiteness we take it in a show that is bounded and selfadjoint on l 2 t b show that for all f g l 2 t we have f g 1 2 f ei g ei d define the angular momentum operator as the selfadjoint operator l defined by the angular momentum observable l b z p l 2 t of section 15 5 c l n z nl n c show that with an appropriate choice of domain l is selfadjoint on l 2 t d prove that and l satisfy the heisenberg commutation relation l l ii on d l d l and show that this domain is dense in l 2 t the operator appears to be of little use in physics this is related to the failure of the continuous variable weyl commutation relation for and l e show that there exists no bounded operator t on l 2 t such that the follow ing identity holds for all s t r eist eit l eisteit l eist 15 47 show that the same conclusion holds if we assume that t is a possibly un bounded selfadjoint operator hint show that if an s r exists such that the identity in 15 47 holds for all t r then s z 620 states and observables f prove a similar result for the phase operator of section 15 3 d 15 14 show that if t is a contraction on rd then for every 1 6 p the second quantised operator t extends to a contraction on lp rd 15 15 show that if u is unitary on cd then for all f l 2 rd we have u f x f u x for almost all x rd 15 16 complete the details of the proof of lemma 15 73 15 17 complete the details of the proofs that the position and momentum operators q j and p j are selfadjoint on l 2 rd 15 18 prove the commutation relation a j a j i used in the proof of 15 42 also prove that if j 6 k then a j a k 0 and p j q k 0 15 19 show that the operator d 2 1 2 p 2 q 2 considered in 15 46 as a densely defined operator in l 2 rd with domain pol rd is closable and its closure equals l 15 20 show that the position and momentum operators q j and p j introduced in section 15 6 e satisfy the relations q j w w p j p j w w q j consistent modulo the difference in normalisations of the fourier transform with the relations x j f f 1 i j and 1 i j f f x j for position and mo mentum operators of section 15 5 b appendix a zorn s lemma zorn s lemma provides a sufficient condition for the existence of maximal elements in partially ordered sets its formulation uses some terminology which we introduce first a relation on a set s is a subset r of the cartesian product s s instead of x y r we often write xry definition a 1 partially ordered sets a partially ordered set is a pair s 6 where s is a set and 6 is a relation on s such that for all x y z s we have i reflexivity x 6 x ii antisymmetry if x 6 y and y 6 x then x y iii transitivity if x 6 y and y 6 z then x 6 z a totally ordered set is a partially ordered set s 6 with the property that for all x y s we have x 6 y or y 6 x or both in which case x y definition a 2 maximal elements upper bounds let s 6 be a partially ordered set an element x s is said to be maximal if x 6 y implies y x an element x s is said to be an upper bound for the subset s s if x 6 x holds for all x s assuming the axiom of choice one has the following result theorem a 3 zorn s lemma if s 6 is a nonempty partially ordered set with the property that each of its totally ordered subsets has an upper bound in s then s has a maximal element this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 621 appendix b tensor products let v and w be vector spaces and let b v w denote the vector space of all bilinear mappings from v w into the scalar field k that is all mappings v w k satisfying cv w v cw c v w for all c k v v and w w and v v w v w v w v w w v w v w for all v v v and w w w for all v v and w w the mapping v w 7 v w defines an element of b v w the vector space of all linear mappings from b v w to k note that c v w cv w v cw for all c k v v and w w and v v w v w v w v w w v w v w for all v v v and w w w this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 623 624 tensor products definition b 1 algebraic tensor product the algebraic tensor product v w of v and w is the linear span in b v w of the set v w v v w w we have natural isomorphisms of vector spaces k v v k v by the above definition and the identities preceding it every element of v w admits a representation as a finite sum kj 1 v j w j if the finite or infinite sets vi i i and wi i i are both linearly independent so is the set vi wi i i indeed suppose that kj 1 c jvi j wi j 0 for certain k 1 and scalars c 1 ck for v and w the mapping v w 7 v w belongs to b v w and accordingly 0 k j 1 c jvi j wi j k j 1 c j vi j wi j k j 1 c j vi j wi j k j 1 c j vi j wi j this being true for all w the linear independence of w 1 wk implies that c jvi j c j vi j 0 for all v and j 1 k but this implies that c jvi j 0 for all j 1 k the linear independence of v 1 vk implies that vi j 6 0 for all j 1 k so we must have c j 0 for all j 1 k this proves our claim as a corollary to this observation we obtain that if v and w are finite dimensional with bases vi dv i 1 and w j dw j 1 then vi w j dv dw i j 1 is a basis for v w in particular dim v w dim v dim w for vector spaces u v w the mapping u v w 7 u v w uniquely extends to an isomorphism of vector spaces u v w u v w stated differently taking tensor products is associative this allows us to define the tensor product u v w as either one of the spaces in this isomorphism for the sake of concreteness we will use the space on the left hand side with this in mind we can define the tensor product v 1 vn of vector spaces vn n 1 n inductively by v 1 vn v 1 vn 1 vn tensor products 625 alternatively one could define v 1 vn in terms of functionals on the space of n linear mappings the resulting space is isomorphic in a natural way to the one just defined in what follows we write v n v v for the n fold tensor product of v the n fold symmetric tensor product n v is defined as the range of the projection p on v n given by p v 1 vn 7 1 n sn v 1 v n v 1 vn v where sn is the group of permutations of 1 n likewise one defines the n fold antisymmetric product n v also known as the n fold exterior product of a vector space v as the range of the projection on v n given by p v 1 vn 7 1 n sn sign v 1 v n v 1 vn v in connection with second quantisation these spaces are sometimes denoted by v s n and v a n respectively we conclude with the observation that if s and t are linear operators on the vector spaces v and w respectively then s t v w 7 sv tw uniquely defines a linear operator s t on the tensor product v w to see that this operator is well defined suppose that an element in v w admits two representations n n 1 cnvn wn n n 1 c nv n w n if v w k is bilinear then the mapping s t v w k given by s t v w sv tw is bilinear and n n 1 cnsvn twn n n 1 cn svn twn n n 1 cn s t vn wn n n 1 cnvn wn s t and by the same argument n n 1 c nsv n tw n n n 1 c nv n w n s t 626 tensor products it follows that n n 1 cnsvn twn n n 1 c nsv n tw n this being true for all bilinear v w k it follows that n n 1 cnsvn twn n n 1 c nsv n tw n appendix c topological spaces this appendix offers a brief treatment of topological spaces only those notions are covered that find their way into the main text several others such as convergence will only be needed in the more concrete setting of metric spaces and will be discussed in that context definition and general properties definition c 1 topological spaces a topological space is a pair x where x is a set and is a topology on x that is is a collection of subsets of x with the following properties i and x ii is closed under taking arbitrary unions iii is closed under taking finite intersections a subset u of x is said to be open if u and closed if its complement is open the interior s of a subset s is the union of all open subsets u in x contained in s the closure s of a subset s is the intersection of all closed subsets f of x containing s note that s is the largest open subset of x contained in s and s is the smallest closed subset of x containing s a set s is dense in a closed set s if s s if c is a collection of subsets of x the topology generated by c is the intersection of all topologies on x containing c the topology generated by a collection c is the smallest topology containing every element of c this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 627 628 topological spaces in what follows we often omit the topology from our notation and write x instead of the more cumbersome x to denote topological spaces except in those situations where confusion could arise in such situations we may speak of open and closed sets instead of open and closed sets in order to emphasise the role of a topological space x is said to be hausdorff if for every two distinct points x 1 x 2 x there exist disjoint open sets u 1 u 2 such that x 1 u 1 and x 2 u 2 proposition c 2 finite subsets of a hausdorff topological space are closed proof since finite unions of closed sets are closed it suffices to prove that every sin gleton x in a hausdorff space x is closed for any y x x choose an open set uy such that y uy and x 6 uy this is possible by the hausdorff assumption and actually uses less than that we then have x y x x uy and this set is open since is closed under taking arbitrary unions it follows that x is closed an important class of hausdorff topological space is the class of metric spaces they are discussed in more detail in section d further examples relevant to functional anal ysis are banach spaces with their weak topology dual banach spaces with their weak topology and spaces of bounded operators acting between banach spaces with their strong and weak operator topologies for their definitions we refer to the main text continuity let x x and y y be topological spaces and consider a mapping f x y we call f continuous at the point x 0 x if for every open set v y containing f x 0 there exists an open set u x containing x 0 such that f u v we call f continuous if f is continuous at every point of x as an immediate consequence of the definition we note that if x x y y z z are topological spaces and f x y is continuous at the point x 0 x and g y z is continuous at the point f x 0 y then the composition g f x z is continuous at the point x 0 x in particular the composition of two continuous mappings is continuous proposition c 3 let x x and y y be topological spaces for a mapping f x y the following assertions are equivalent 1 f is continuous 2 f 1 v is open for every open subset v of y 3 f 1 f is closed for every closed subset f of y proof 1 2 suppose that f is continuous and let v be an open set in y let x f 1 v be arbitrary using the definition of continuity we choose an open subset ux x containing x such that f ux v this means that ux f 1 v it follows topological spaces 629 that f 1 v x f 1 v ux and this set is open since is closed under taking arbitrary unions this shows that f 1 v is open in x 2 3 suppose f 1 v is open for every open v y let f y be closed then its complement f is open in y hence by our assumption f 1 f is open from f 1 f f 1 f it follows that f 1 f is closed 3 2 this is proved in the same way interchanging the roles of open and closed 2 1 let x x be arbitrary and let v y be open and contain f x the set u f 1 v is open in x by assumption x is an element of this set and we have f u v thus f is continuous at the point x compactness let x be a topological space and let s be a subset of x a collection u of open subsets of x is called an open cover of s if s u u u a subcover is a cover u of s contained in u the set s is called compact if every open cover of s has a finite subcover a set is called relatively compact if its closure is compact proposition c 4 let x be a topological space then 1 every closed subset of x contained in a compact subset of x is compact 2 if x is hausdorff then every compact subset of x is closed proof 1 let the closed set f be contained in the compact subset s of x let uf be an open cover of f and extend it to an open cover u of s by adjoining the open set f the resulting cover of s has a finite subcover and this subcover also covers f removing the set f from this subcover we are left with a finite subcover of u for s it follows that f is compact 2 let s be a compact subset of the hausdorff space x we first claim that for every x s there is an open set ux containing x and disjoint from s indeed for every y s the hausdorff property provides us with two disjoint open sets ux y and ux y such that x ux y and y ux y the open cover ux ux y y s of s has a finite subcover say u x ux y 1 ux ykx where kx 1 is an integer depending on x the set ux kx j 1 ux y j is open contains x and is disjoint from s this proves the claim but now we see that s x s ux so s is open and s is closed a collection of subsets of a topological space has the finite intersection property if every finite subcollection has nonempty intersection proposition c 5 a nonempty closed subset s of a topological space x is compact if 630 topological spaces and only if every collection of closed subsets of s with the finite intersection property has nonempty intersection proof only if let c be a collection of closed subsets of s having the finite inter section property if we had c c c then u c c c is an open cover of s without a finite subcover for if c 1 ck were to cover s then c 1 ck this contradicts our assumption it follows that c has nonempty intersection if reasoning by contradiction assume that every collection of closed subsets of s with the finite intersection property has nonempty intersection and assume that there exists an open cover u of s without finite subcover then for any finite choice of sets u 1 uk u we have s k j 1 u j 6 it follows that k j 1 s u j 6 from the assumption on s we infer that u u s u 6 but then u does not cover s and we have arrived at a contradiction compactness is preserved under continuous mappings proposition c 6 let x and y be topological spaces let f x y be a continuous mapping if s is a compact subset of x then f s is compact in y proof let u be an open cover of f s then f 1 u u u is an open cover of s by proposition c 3 since s is compact it has a finite subcover f 1 u 1 f 1 un the collection u 1 un is then a finite subcover of f s every continuous function f a b r has a global maximum and a global mini mum on a b more generally we have theorem c 7 global maxima and minima let x be a compact topological space and let f x r be continuous then f attains a global maximum and a global minimum proof we prove that f attains a global maximum by applying this to the continuous function f it follows that f also attains a global minimum for n 1 let un x x f x n the collection u un n 1 is an open cover of x and has thanks to the compactness of x a finite subcover from this it follows that the range of f is bounded above let m sup f x x x suppose that there is no x x such that f x m we show that then x cannot be compact the assumption just made implies that the collection v vn n 1 is an open cover of x where vn x x f x m 1 n since for every n 1 there is an x x such that f x m 1 n this follows from the definition of the supremum v has no finite subcover a topological space is called normal if for any two disjoint closed subsets f and g there exist disjoint open subsets u and v such that f u and g v proposition c 8 every compact hausdorff space x is normal topological spaces 631 proof let f and g be disjoint nonempty closed subsets of the compact hausdorff space x then f and g are compact by proposition c 4 fix a point x f since x is hausdorff for all y g there exist disjoint open subsets ux y and vx y such that x ux y and y vx y by letting y range over all points of g and using compactness we find an open cover vx y 1 vx ykx of g set ux kx j 1 ux y j and vx kx j 1 vx y j then x ux g vx and ux vx letting x range over f and using compactness we find an open cover ux 1 ux of f the sets u j 1 ux j and v j 1 vx j are open and satisfy f u g v and u v in the next appendix we will see that also every metric space is normal corollary c 9 let x be a normal space if f u x with f compact and u open then there exists an open set v such that f v v u proof by normality there exist disjoint open sets w and w such that f w and u w then f w w u the set v w satisfies f v v w u where the third inclusion holds since w is a closed set containing v urysohn s lemma in normal spaces disjoint closed sets can be separated by continuous functions this is the content of the next result proposition c 10 urysohn s lemma let x be a normal space if f u x with f closed and u open then there exists a continuous function f x 0 1 such that f 1 on f and supp f u proof a rational number q 0 1 is called dyadic if it is of the form k 2 n where k n n and 06 k 6 2 n we will construct for every dyadic q 0 1 an open set uq such that f uq uq u and for dyadic r 0 1 q r implies uq ur by corollary c 9 applied twice there exist open sets u 0 and u 1 such that f u 1 u 1 u 0 u 0 u 632 topological spaces reasoning by induction suppose that for some n n and k 0 2 n the open sets u k 2 n have been chosen such that q r implies uq ur using corollary c 9 for all k 0 2 n 1 we find an open set u 2 k 1 2 n 1 such that u k 1 2 n u 2 k 1 2 n 1 u 2 k 1 2 n 1 u k 2 n then uq ur holds for all dyadic q r of the form k 2 n 1 with 06 k 6 2 n 1 now define fq x q if x uq 0 otherwise gr x 1 if x ur r otherwise and put f x supq fq x and g x infr gr x then f is lower semicontinuous g is upper semicontinuous 06 f 6 1 f 1 on f and supp f u to conclude the proof we show that f g if fq x gr x then we must have q r x uq and x 6 ur but q r implies uq ur this contradiction shows that fq x 6 gr x for all dyadic q r 0 1 and x x this implies f 6 g if f x g x there are dyadic numbers q r 0 1 such that f x r q g x but f x r implies that x 6 ur and g x q implies x uq this contradicts the fact that q r implies uq ur it follows that f g the support of a continuous function f x k where x is a topological space is defined as the complement of the largest open set u x such that f 0 on u or equivalently as the set closure of the set x d f x 6 0 theorem c 11 partition of unity let x be a normal space and let f u 1 uk where f is compact and the sets u j are open in x for all j 1 k then there exist nonnegative continuous functions f j x 0 1 with support in u j j 1 k such that f 1 fk 1 on f the same result holds if x is a locally compact hausdorff space proof every x f is contained in at least one of the sets u j and applying normality to the closed sets x and u j we find an open subset v containing x and whose closure is contained in u j letting x range over f and using that f is compact it follows that we can cover f with finitely many open sets v 1 vn such that for all m 1 n we have vm u jm for some 16 jm 6 k set fj m vm u j vm j 1 k topological spaces 633 this set is closed and contained in u j by urysohn s lemma we can find continuous functions g j x 0 1 topologically supported in u j such that g j 1 on fj put f 1 g 1 and f j 1 g 1 1 g j 1 g j j 2 k the support of f j is contained in u j and an easy induction argument shows that f 1 fk 1 1 g 1 1 gk c 1 if x f then g j x 1 for at least one j 1 k and therefore c 1 implies that f 1 fk 1 on f the case of locally compact hausdorff spaces may be reduced to the case of compact hausdorff spaces by the same argument as in proposition 4 3 we conclude with a useful extension theorem its proof makes use of the fact men tioned in section 2 2 a that the space cb x of all bounded continuous functions on a topological space x is complete as a normed space endowed with the supremum norm the proof of this elementary fact is direct and does not introduce circularity in our arguments theorem c 12 tietze extension theorem let f be a closed subset of a normal space x and let f f 0 1 be continuous then there exists a continuous function g x 0 1 such that g f f proof the sets a x f f x 0 13 and b x f f x 2 3 1 are disjoint and closed in f and hence closed in x since f is closed in x by urysohn s lemma there exists a continuous function g 1 x 0 1 3 such that g 1 0 on a and g 1 13 on a this function satisfies 06 f g 1 6 23 pointwise on f proceeding inductively we construct continuous functions gk x 0 2 k 1 3 k k 1 such that for every k 1 we have gk 0 on the set x f f x k 1 j 1 g j x 6 2 k 1 3 k and gk 2 k 1 3 k on the set x f f x k 1 j 1 g j x 2 k 3 k we then have 0 6 f kj 1 g j 6 2 k 3 k pointwise on f the lower bound is clear from the construction and the upper bound follows by induction set g k 1 gk the partial sums of this sum converge uniformly and therefore g is 634 topological spaces continuous by the completeness of cb x on the set f we have 06 f g 6 f k j 1 g j 6 2 k 3 k for every k 1 forcing that f g on f tychonov s theorem let i be a nonempty set and suppose that for every i i a topological space xi i is given the cartesian product of the family xi i i is the set x i i xi whose elements are the mappings x i i i xi with the property that x i xi for all i i for each i i we define the coordinate mapping pi x xi by pi x x i the product topology of x i i xi is the topology generated by the sets p 1 i ui where ui ranges over all open sets in xi and i ranges over i it is the smallest topology i i i with the property that all coordinate mappings pi x 7 x i are continuous as mappings from x into xi if i i 1 ik is finite the topology of x kj 1 xi j coincides with the topology generated by the sets of the form u ui 1 uik with ui j open in x j for all j 1 k theorem c 13 tychonov the product of any family of compact spaces is a compact space if each one of the spaces is hausdorff then so is its product proof let x i i xi where xi i is a compact topological space for each i i if xi for some i i we have x and there is nothing to prove we may therefore assume that xi 6 for all i i fix a collection c of closed subsets of x with the finite intersection property we wish to prove that c c c 6 once this has been proved proposition c 5 implies that x is compact let d be the set of all collections d of subsets of x which have the finite intersection property and contain c as a subcollection the set d is nonempty it contains c and can be partially ordered by set inclusion that is we declare d 6 d to mean that d d note that we do not insist on closedness of the sets in d let t d be a totally ordered subset that is a subset with the property that for all t 1 t 2 t we have either t 1 t 2 or t 2 t 1 we claim that t t t belongs to d for this it suffices to check that this union has the finite intersection property to this end suppose that t 1 tk t t t say tj t j t for j 1 k since t is totally ordered after relabelling we may assume that t 1 tk then every tj belongs to tk and therefore the finite intersection property of tk implies that k j 1 tj 6 this proves that t t t has the finite intersection property evidently the union t t t is an upper bound for t in d we may therefore apply topological spaces 635 zorn s lemma and obtain that d has a maximal element we denote it by m for each i i consider the collection xi pi m m m where pi x 7 x i are the coordinate mappings it consists of closed subsets of xi and has the finite intersection property since m has it since xi is compact the set yi m m pi m is nonempty by proposition c 5 using the axiom of choice for every i i choose a yi yi and let x x be defined by x i yi i i we will prove in two steps that x m for all m m step 1 if ui is open in xi and contains x i yi the fact that x i pi m for all m m implies that x i pi m ui and hence x m p 1 i ui for all m m it follows that the collection m p 1 i ui i i has the finite intersection property and belongs to d by maximality this collection equals m therefore p 1 i ui m for all i i step 2 let u be an open set in x containing x by the definition of the product topology there are indices i 1 ik i and open sets ui j i j for j 1 k such that x k j 1 p 1 i j ui j u by the result of step 1 and the fact that m has the finite intersection property we have m p 1 i 1 ui 1 p 1 ik uik 6 for all m m in particular m u 6 for all m m this being true for all open sets u containing x it follows that x m for all m m it now follows that x m m m c c c c c c where we used that c m and the fact that the elements of c are closed sets therefore c c c 6 and we conclude that x is compact suppose now that each space xi is hausdorff if x x x and x 6 x then for some i i we must have x i 6 x i and since xi is hausdorff there are disjoint open sets ui and u i in xi containing x i and x i respectively their inverse images under i are open and disjoint in x appendix d metric spaces we now introduce an important class of hausdorff spaces namely the class of metric spaces all results of the previous appendix apply to metric spaces but in order to make the present appendix independently readable some proofs are repeated in addition our treatment of metric spaces includes a number of additional topics definition and general properties definition d 1 metric spaces a metric space is a pair x d where x is a set and d a metric or distance function on x that is a function d x x 0 such that for all x y z in x the following conditions are satisfied i d x y 0 x y ii d x y d y x iii d x z 6 d x y d y z the triangle inequality in what follows we omit the distance function d from the notation and write x instead of the more cumbersome x d to denote metric spaces except in those situations where confusion could arise let x be a metric space let x x and let r 0 the set b x r y x d x y r is called the open ball with centre x and radius r the set b x r y x d x y 6 r this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 637 638 metric spaces is called the closed ball with centre x and radius r a subset s of a metric space x is called open if for all x s there exists an r 0 such that b x r s a subset s of a metric space x is called closed if its complement s x s is open it is an easy consequence of the triangle inequality that every open ball b x r is open and every closed ball b x r is closed this justifies the terminology open ball and closed ball the interior of a subset s of a metric space x is the union of all open subsets of x contained in s and is denoted by s it is the largest open subset of x contained in s the closure of a subset s of a metric space x is the intersection of all closed subsets of x containing s and is denoted by s it is the smallest closed subset of x containing s the closure b x r of an open ball is always contained in the closed ball b x r but this inclusion may be strict for example take x z with distance function d m n n m the open ball b 0 1 0 is also closed so its closure equals b 0 1 0 on the other hand b 0 1 1 0 1 for any metric space x d the collection of its open sets is a hausdorff topology the so called borel topology of x more is true proposition d 2 every metric space is normal proof let f and g be disjoint closed sets in a metric space x we must find disjoint open set u and v such that f u and g v we may assume that f and g are both nonempty since otherwise the result is trivial the function f x d x f d x f d x g is well defined continuous takes values in 0 1 and satisfies f 0 on f and f 1 on g the sets u x e f x 12 and v x e f x 1 2 are open by proposition c 3 and have the desired properties convergence a sequence xn n 1 in a metric space x is called convergent if there exists an x x such that for all 0 there is an index n 1 with the property d xn x for all n n we then write lim n xn x and call x a limit of the sequence xn n 1 it is clear that limn xn x if and only if limn d xn x 0 limits are unique for if limn xn x and limn xn y then for all indices n the triangle inequality gives 0 6 d x y 6 d x xn d xn y 0 0 0 and therefore d x y 0 metric spaces 639 a subset s of a metric space x is called sequentially closed if the limit of every sequence in s that converges in x belongs to s proposition d 3 for a subset s in a metric space x the following assertions are equiv alent 1 s is closed 2 s is sequentially closed proof 1 2 let xn n 1 be a sequence in s convergent in x with limit x we must show that x s assume the contrary then x s the complement of s and because s is open there is an 0 such that b x s on the other hand since xn n 1 converges to x there is an index n 1 such that d xn x for all n n that is xn b x and hence xn s for all n n for these indices we obtain the contradiction xn s s 2 1 we must show that s is open choose x s arbitrarily we must show that there is an 0 such that b x s suppose that such an 0 does not exist then for every n 1 we can find an xn b x 1 n s the resulting sequence xn n 1 is contained in s and satisfies d xn x 1 n for all n 1 that is we have limn xn x because s is sequentially closed we conclude that x s in contradiction with the assumption that x s as a corollary we have the following useful criterion for determining which elements belong to the closure of a given set proposition d 4 for a subset s in a metric space x and a point x x the following assertions are equivalent 1 x s 2 s b x 6 for all 0 3 there exists a sequence xn n 1 in s with limn xn x in particular a set s is dense in the closed set s if and only every s s is the limit of a sequence in s proof 1 2 if s b x for some 0 then s b x because b x is closed this implies s b x and therefore x 6 s 2 3 for every n 1 we choose xn s b x 1 n in this way we obtain a se quence xn n 1 in s converging to x 3 1 if x 6 s then x s and this set is open hence there exists an 0 such that b x s in particular it holds that d x y for all y s this implies that no sequence in s can converge to x 640 metric spaces completeness a sequence xn n 1 in a metric space x is called a cauchy sequence if for all 0 there is an index n 1 such that d xn xm for all n m n proposition d 5 in a metric space x the following assertions hold 1 every convergent sequence is a cauchy sequence 2 every cauchy sequence with a convergent subsequence is convergent proof 1 let x be the limit of the convergent sequence xn n 1 and let 0 be arbitrary choose n so large that d xk x for all k n by the triangle inequality for all n m n it follows that d xn xm 6 d xn x d x xm 2 2 let xn n 1 be a cauchy sequence with a subsequence xnk k 1 convergent to x we check that xn n 1 converges to x choose 0 arbitrarily and let n 1 be such that d xn xm for all m n n let k 1 be such that for all k k we have both nk n and d xnk x now choose k k arbitrarily then for all n n we have d xn x 6 d xn xnk d xnk x 2 a subset s of a metric space x is called complete if every cauchy sequence contained in s converges to a limit in s in particular x is complete if every cauchy sequence in x is convergent in x theorem d 6 completion if x is a metric space there exists a complete metric space x d and a mapping i x x with the following properties i i is isometric that is d ix iy d x y for all x y x ii i has dense range that is i x is dense in x moreover if x d is another complete metric space and i x x is a mapping satis fying i and ii then the identity mapping on x has a unique extension to an isometry from x onto x a more precise way of stating the last assertion is that there exists a unique isometry j from x onto x which satisfies j ix i x for all x x proof on the set of cauchy sequences in x we define an equivalence relation by declaring the cauchy sequences xn n 1 and x n n 1 equivalent if limn d xn x n 0 let x be the set of all equivalence classes denoting the equivalence class of a sequence xn n 1 by x on x we define a metric d by d x y lim n d xn yn using the triangle inequality it is readily checked that this limit indeed exists and is independent of the choice of sequences xn n 1 and yn n 1 representing x and y metric spaces 641 if x y x then the constant sequences x n 1 and y n 1 are cauchy and therefore define elements of x which we shall denote by x and y we obtain a mapping i x x by declaring ix x from d ix iy d x y limn d x y d x y we see that this mapping is isometric this gives property i to prove property ii let x x and let xn n 1 be a cauchy sequence in x in its equivalence class for any 0 we may choose n so large that d xn xm for all m n n then d x ixn limn d xn xn 6 this shows that i x is dense in x next we prove that x is complete suppose xn n 1 is a cauchy sequence in x by the density of x in x we may pick elements xn x such that d xn xn 1 n here we identify elements of x with elements of x by means of the mapping i from d xn xm d xn xm 6 d xn xn d xn xm d xm xm 6 1 n d xn xm 1 m and the fact that the middle term tends to 0 as n m we infer that xn n 1 is a cauchy sequence in x let x x be its equivalence class as was shown in the proof of density we have limn d xn x 0 then d xn x 6 d xn xn d xn x 1 n d xn x shows that limn d xn x 0 this proves the completeness of x let i x x denote the identity mapping on x and let x d and i x x satisfy i and ii we obtain an isometry i x x by putting ix lim n ixn lim n xn where xn n 1 is a cauchy sequence representing x and the limit on the right hand side is taken in x this limit exists because the sequence xn n 1 is cauchy in the complete space x the resulting mapping i is an isometry from x onto x whose inverse is obtained by applying the same procedure with the roles of x and x interchanged if i is another isometry from x onto x of the identity mapping on x then ix limn ixn ix for all x x represented by the cauchy sequence xn n 1 in x this gives the uniqueness of i a complete metric space x d is called a completion of x d if there exists a map ping i x x with properties i and ii the second part of the theorem asserts that completions are unique up to isometry to avoid this minor ambiguity we agree to call the metric space x d constructed in the above proof the completion of x d 642 metric spaces continuity in the context of metric spaces this definition takes the familiar form proposition d 7 a mapping f x y is continuous at the point x 0 x if and only if for every 0 there exists a 0 such that for all x x with dx x x 0 we have dy f x f x 0 this is clear from the fact that every open set u in x containing x 0 contains the open balls b x 0 for sufficiently small 0 and every open set v in y containing f x 0 contains the open balls b f x 0 for sufficiently small 0 a mapping f x y is called sequentially continuous at the point x 0 x if for every sequence xn n 1 in x with limn xn x 0 we have limn f xn f x 0 we call f sequentially continuous if f is sequentially continuous at every point of x proposition d 8 for a mapping f x y between the metric spaces x and y the following assertions are equivalent 1 f is continuous at the point x 0 x 2 f is sequentially continuous at the point x 0 x in particular f is continuous if and only if f is sequentially continuous proof 1 2 suppose that limn xn x 0 in x choose 0 arbitrarily and choose using the continuity of f a 0 such that dy f x f x 0 for all x x with dx x x 0 because limn dx xn x 0 0 we can find an index n 1 such that dx xn x 0 for all n n for all n n it then holds that dy f xn f x 0 2 1 suppose that there is an 0 such that no 0 can be found with the property that dy f x f x 0 for all x x with dx x x 0 then for every n 1 we can find xn x with dx xn x 0 1 n and dy f xn f x 0 then limn xn x 0 hence by the sequential continuity of f limn f xn f x 0 this contradicts the fact that dy f xn f x 0 for all n 1 a function f x y is uniformly continuous if for every 0 there exists a 0 such that whenever x y x satisfy dx x y then dy f x f y every uni formly continuous function is continuous but the converse is false even for bounded functions the function f 0 1 1 1 f x sin 1 x is continuous but not uni formly continuous below we prove that if x is compact then every continuous function from x into another metric space is uniformly continuous uniformly continuous functions have the following extension property proposition d 9 let x and y be metric spaces with y complete if f x y is uniformly continuous there exists a unique uniformly continuous function f x y extending f metric spaces 643 proof let x x and choose a sequence xn x with each xn in x then xn n 1 is cauchy in x and the uniform continuity of f implies that f xn n 1 is cauchy in y since y is complete this sequence converges to a limit say y we set f x y we need to check that f is well defined that is f x does not depend on the choice of the approximating sequence and is uniformly continuous if x n x with each x n in x then limn dx xn x n 0 by the uniform conti nuity of f it follows that limn dy f xn f x n 0 and therefore limn f x n limn f xn this proves that f is well defined to prove that f is uniformly continuous let 0 and choose 0 as in the definition of uniform continuity of f applied with 12 instead of if dx x y in x and if xn n 1 and yn n 1 are approximating sequences in x then f xn n 1 and f yn n 1 are approximating sequences for f x and f y in y and for large enough n we have dx xn yn and dy f xn f yn 1 2 for any such n we obtain dy f x f y limn dy f xn f yn 6 1 2 it is clear from the construction that f extends f compactness let x d be a metric space we recall that a subset s of a metric space x is compact if every open cover of s has a finite subcover and relatively compact if its closure is compact in order to characterise compactness in terms of sequences we introduce the following terminology a subset s of a metric space x is called sequentially compact when every sequence in s has a convergent subsequence with limit in s a subset s of a metric space x is called totally bounded if for every r 0 there is a finite cover of s with balls of radius r with centres in s theorem d 10 compactness and total boundedness for a subset s of a metric space x the following assertions are equivalent 1 s is compact 2 s is sequentially compact 3 s is closed complete and totally bounded proof 1 2 suppose that xn n 1 is a sequence in s not containing any subse quence converging to an element of s we will construct an open cover of s without finite subcover the assumption entails that for every x s there is an x 0 with the property that the open ball b x x contains at most finitely many terms of the sequence xn n 1 let u b x x x s this is an open cover of s without finite subcover for every u u contains at most finitely many terms of the sequence xn n 1 but this 644 metric spaces sequence has infinitely many distinct terms otherwise we could immediately exhibit a convergent subsequence 2 3 suppose that s is not totally bounded we will construct a sequence in s without any subsequence converging to an element of s by our assumption there exists an 0 such that s has no finite cover with balls with centres in s choose x 1 s arbitrarily the collection b x 1 does not cover s so there is an x 2 s with x 2 6 b x 1 note that d x 1 x 2 the collection b x 1 b x 2 is not a cover of s so there is an x 3 s with x 3 6 b x 1 b x 2 note that d x 1 x 3 and d x 2 x 3 continuing this way we obtain a sequence xn n 1 with the property that d xn xm for all choices of n and m this sequence has no cauchy subsequence and therefore no convergent subsequence next we prove that s are complete suppose that xn n 1 is a cauchy sequence in s because s is sequentially compact this sequence has a convergent subsequence with limit x in s but then xn n 1 itself converges to x this shows that s is complete 3 1 suppose for a contradiction that s is totally bounded but not compact since s is not compact there is an open cover u of s without finite subcover since s is totally bounded for every n 1 we can find a finite cover bn of s consisting of 1 n balls with centres in s there is a ball b 1 b 1 such that s b 1 cannot be covered by finitely many open sets in u in the same way there is a ball b 2 b 2 such that s b 1 b 2 cannot be covered by finitely many open sets in u continuing in this way we find a sequence of balls bk bk such that s b 1 bk cannot be covered by finitely many open sets in u the sequence of centres xn n 1 of these balls is a cauchy sequence in s to see this we note that for all n m 1 the intersection bn bm is nonempty if xmn is an element in the intersection with the triangle inequality we find that d xn xm 6 d xn xnm d xnm xm 6 1 n 1 m in view of limn m 1 n 1 m 0 our assertion follows by completeness the sequence xn n 1 converges to a limit which belongs to s choose u u such that x u and choose r 0 such that b x r u choose n so large that d xn x 1 2 r for all n n and 1 n 1 2 r then b 1 bn bn b xn 1 n b x r u but this means that b 1 bn is covered by the finite subcollection u of u this contradiction concludes the proof the equivalence of 1 and 3 implies that in a complete metric space a subset is relatively compact if and only if it is totally bounded the only if part is trivial and for the if part we note that the closure of a totally bounded set is totally bounded for metric spaces 645 if s can be covered with finitely many balls of radius b xn with centres in s the balls b xn 2 cover s now it remains to observe that a closed subset of a complete metric space is complete theorem d 11 bolzano weierstrass a subset of rd is compact if and only if it is closed and bounded proof we have seen that in any metric space compact sets are always closed and bounded suppose conversely that the set s is closed and bounded step 1 we prove the theorem for d 1 and the interval a b let u be a cover for a b with open subsets of r we must show that u contains a finite subcover let us call a point x a b reachable from a if there is a finite subcollection of u covering a x let s be the set of all points that are reachable from a we must show that b s first we observe that s is nonempty clearly we have a s since s is bounded above by b we may put p sups choose u u such that p u because u is open there is an 0 with p p u because p sups we can find an x s with p x 6 p choose a finite subcollection u of u covering a x the collection u u u is a finite subcollection of u covering a p we conclude that p s we can also conclude that p b indeed if we had that p b then we could find a y a b p p then u also covers interval a y and it follows that y s this contradicts the fact that p sups step 2 suppose now that s rn is closed and bounded because s is bounded we can find an r 0 such that s r r n we claim that r r n is compact once this has been shown it follows that s being a closed subset of the compact set r r n is compact to prove that r r n is compact we show that r r n is sequentially compact let xn n 1 be a sequence in r r n the n coordinate sequences are sequences in the interval r r which is sequentially compact by the bolzano weierstrass theorem by taking n consecutive subsequences we arrive at a subsequence xnk k 1 all of whose coordinate sequences converge in r r the sequence xnk k 1 then converges in r n with a limit in r r n theorem d 12 let x dx and y dy be metric spaces with x compact every con tinuous mapping f x y is uniformly continuous proof let 0 be arbitrary for every x x we can find a x 0 such that for all x x with dx x x x we have dy f x f x 12 the collection u b x 12 x x x 646 metric spaces is an open cover of x and therefore has a finite subcover say u b x j 1 2 x j j 1 n let min 12 x j j 1 n suppose now that x x x satisfy dx x x we have x b x j 12 x j for some 16 j 6 n since u covers x then dx x x j 1 2 x j and dx x x j 6 dx x x dx x x j 1 2 x j 6 x j consequently dy f x f x 6 dy f x f x j dy f x j f x 1 2 1 2 in many applications the following simple special case of tychonov s theorem the orem c 13 suffices proposition d 13 if k 1 kn are compact metric spaces then their cartesian product k k 1 kn is a compact metric space with respect to the product metric d s t n j 1 d j s j t j s t k proof given 0 for j 1 n choose finitely many open d j balls of radius n to cover k j their cartesian products are open contained in d balls of radius and cover k since 0 was arbitrary this shows that k is totally bounded since the completeness of the metrics d j implies that d is complete this proves the compactness of k definition d 14 separability a metric space is called separable if it contains a dense countable subset proposition d 15 every compact metric space is separable proof for each n 1 2 cover the metric space with finitely many open balls of radius 1 n say b n 1 b n nn together the centres of all these balls form a dense subset indeed any nonempty open set u contains an open ball b say of radius r 0 and this ball must contain at least one of the balls b n j for each n 1 such that 1 n 1 3 r for otherwise the sets b n 1 b n nn cannot cover b the centres of such balls are in u appendix e measure spaces this appendix reviews the basic elements of the theory of lebesgue integration algebras let be a set definition e 1 algebras a algebra in is a collection f of subsets of with the following properties i f ii f f implies f f iii f 1 f 2 f implies n 1 fn f here f f is the complement of f a measurable space is a pair f where is a set and f is a algebra in the sets in f are often referred to as the measurable subsets of if c is any collection of subsets of the algebra generated by c is defined as the intersection of all algebras containing c and is denoted by c it is the smallest algebra containing c the above three properties express that f is nonempty closed under taking comple ments and closed under taking countable unions from n 1 fn n 1 fn this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 647 648 measure spaces it follows that f is closed under taking countable intersections clearly f is closed under finite unions and intersections as well example e 2 if x is a topological space we denote by b x the algebra gener ated by this algebra is referred to as the borel algebra of x as an exercise the reader may check that rd b rd d n 1 r b r for a proof one may use that every open set in rd is a countable union of rectangles of the form a 1 b 1 ad bd let 1 f 1 2 f 2 be a sequence of measurable spaces the product n 1 n n 1 fn is defined by n 1 n 1 2 and n 1 fn f 1 f 2 is defined as the product algebra that is the algebra generated by all sets of the form f 1 fn n 1 n 2 with n 1 2 and fn fn for n 1 n finite products nn 1 n fn are de fined similarly here one takes the algebra in 1 n generated by all sets of the form f 1 fn with fn fn for n 1 n let f r be any function for borel sets b b r we define f b f b the collection f f b b b r is a algebra in the algebra generated by f measures let f be a measurable space definition e 3 measures a measure on f is a mapping f 0 with the following properties i 0 ii for all disjoint sets f 1 f 2 in f we have n 1 fn n 1 fn measure spaces 649 a triple f with a measure on a measurable space f is called a mea sure space a measure space f is called finite if is a finite measure that is if if 1 then is called a probability measure and f is called a probability space in probability theory it is customary to use the symbol p for a probability mea sure a measure space f is called finite if there exist f 1 f 2 in f such that n 1 fn and fn for all n 1 a borel measure on a topological space x is measure b x 0 where b x is the borel algebra of x the following properties of measures are easily checked i if f 1 f 2 in f then f 1 6 f 2 ii if f 1 f 2 in f then n 1 fn 6 n 1 fn iii if f 1 f 2 in f then n 1 fn lim n fn iv if f 1 f 2 in f and f 1 then n 1 fn lim n fn in iii and iv the limits in 0 exist by monotonicity dynkin s lemma lemma e 4 dynkin s lemma let 1 and 2 be two finite measures defined on a mea surable space f let a f be a collection of sets with the following properties i a ii a is closed under finite intersections iii the algebra generated by a equals f if 1 a 2 a for all a a then 1 2 proof let d denote the collection of all sets d f with 1 d 2 d then a d and d is a dynkin system that is d if d 1 d 2 with d 1 d 2 d then also d 2 d 1 d if d 1 d 2 with all dn d then also n 1 dn d 650 measure spaces by assumption we have d f a the algebra generated by a we will show that a d to this end let d 0 denote the smallest dynkin system in f containing a we will show that a d 0 in view of d 0 d this proves the lemma let c d 0 d 0 d 0 a d 0 for all a a this is a dynkin system and a c since a is closed under taking finite intersections it follows that d 0 c since d 0 is the smallest dynkin system containing a but obviously c d 0 and therefore c d 0 now let c d 0 d 0 d 0 d d 0 for all d d 0 this is a dynkin system and the fact that c d 0 implies that a c hence d 0 c since d 0 is the smallest dynkin system containing a but obviously c d 0 and therefore c d 0 it follows that d 0 is closed under taking finite intersections but a dynkin system with this property is a algebra thus d 0 is a algebra and now a d 0 implies that also a d 0 outer measures let s be a set the power set of s that is the set of all subsets of s is denoted by 2 s let 2 s 0 be a mapping which satisfies 0 a set a s is called measurable if q q a q a for all q 2 s the collection of all measurable sets is denoted by m definition e 5 outer measures a mapping 2 s 0 is called an outer measure if i 0 ii a b implies a 6 b iii for all a 1 a 2 2 s we have n 1 an 6 n 1 an lemma e 6 let c 2 s satisfy c and suppose that c 0 satisfies 0 for subsets a s define a inf j 1 c j a j 1 c j where c j c for all j 1 e 1 with the convention that a if the above set is empty then is an outer measure measure spaces 651 proof the mapping 2 s 0 clearly satisfies the conditions i and ii in def inition e 5 in order to check condition iii let a 1 a 2 be subsets of s and let 0 be arbitrary if an for some n 1 then iii trivially holds we may therefore assume that an for all n 1 by the definition of for each fixed n 1 we can find cn j c such that an j 1 cn j and j 1 cn j 6 an 2 n then n 1 an n j 1 cn j and again by the definition of n 1 an 6 n j 1 cn j 6 n 1 an 2 n n 1 an since 0 was arbitrary this proves the required estimate theorem e 7 measures from outer measures if 2 s 0 is an outer measure then m is a algebra and is a measure on s m for the proof of the theorem we need the following terminology a ring in s is a subset r of 2 s with the following properties i r ii a b r implies a b r iii a b r implies a b r if r is a ring the identity a b a a b implies that if a b r then a b r proof of theorem e 7 we proceed in two steps step 1 we begin by checking that if 2 s 0 is any mapping which satisfies 0 then m is a ring and is additive on m it is clear that m in order to check that m is a ring we check the following a a m implies a m b a b m implies a b m given these properties it is straightforward to check that m is a ring indeed this follows from the formulas b a b a and a b a b property a is clear to check b let a b m and set c a b let q 2 s be arbitrary observing that a b c a and a c a and making repeated use of the definition of m we have q q a q a q a b q a b q a q c q c a q c a 652 measure spaces q c q c therefore a b c m to check that is additive on m fix two disjoint sets a b m and let q a b then q a a and q a b since a m we find a b q q a q a a b step 2 we now turn to the proof of the theorem from step 1 we know that m is a ring and is additive on m in view of property a it remains to check that for any disjoint sequence an n 1 in m a n 1 an m and a n 1 an e 2 let bn n j 1 a j for each n 1 fix an arbitrary subset q of s by step 1 for all n 1 we have a bn bn m and n j 1 q a j q a q bn q a 6 q bn q bn q using the subadditivity of and then passing to the limit n we infer q a q a 6 j 1 q a j q a 6 q e 3 on the other hand by subadditivity also the converse inequality q 6 q a q a holds this shows that a m and that the inequalities in e 3 are in fact equalities now e 2 follows by taking q a in e 3 carathe odory s extension theorem for additive functions r 0 one has the following result lemma e 8 let r be a ring and r 0 be additive that is n j 1 an n j 1 a j holds for all disjoint sets a 1 an r the following assertions hold 1 if a b r and a b then a 6 b 2 if a 1 a 2 r are disjoint and j 1 a j r then j 1 a j j 1 a j measure spaces 653 3 if a 1 a 2 r and j 1 a j r and is countably additive on r then j 1 a j 6 j 1 a j proof 1 writing b a b a we see that b a b a a b a a 2 let n n then n j 1 a j j 1 a j and therefore by additivity of and 1 n j 1 a j n j 1 a j 6 j 1 a j the result follows by letting n 3 the sets b 1 a 1 b 2 a 2 a 1 b 3 a 3 a 1 a 2 are disjoint and we have j 1 b j j 1 a j therefore by the additivity of j 1 a j j 1 b j j 1 b j 6 j 1 a j theorem e 9 carathe odory s extension theorem let r be a ring in s and suppose that r 0 is countably additive on r and satisfies 0 then 1 the outer measure restricts to a measure on r extending 2 if is finite on r and if is another finite measure on r extending then from lemma e 6 we know that the mapping defined by e 1 is indeed an outer measure proof by theorem e 7 is a measure on the algebra m we prove that it has the following properties i r m ii a a for all a r clearly part 1 of the theorem follows from the claim which actually shows that there is a further extension to the possibly larger algebra m step 1 in this step we prove i let a r and q s be given the subadditivity of gives q 6 q a q a the converse estimate q a q a 6 q trivially holds if q if q choose b 1 b 2 r such that q n 1 bn then bn a bn a r for all n 1 and q a n 1 bn a and q a n 1 bn a 654 measure spaces using first the definition of and then the additivity of on r we find q a q a 6 n 1 bn a n 1 bn a n 1 bn taking the infimum over all admissible sequences b 1 b 2 as specified above we obtain q a q a 6 q combining both estimates we conclude that a m step 2 in this step we prove ii let a r it is clear that a 6 a this follows by taking b 1 a and bn for n 2 in e 1 the converse estimate a 6 a trivially holds if a if a choose b 1 b 2 r such that a n 1 bn then by lemma e 8 1 and 3 applied to a n 1 a bn part 3 can be applied by the assumed countable additivity of on r a 6 n 1 a bn 6 n 1 bn taking the infimum over all admissible sequences b 1 b 2 as specified above we obtain a 6 a let now the assumptions of part 2 be satisfied and choose pairwise disjoint sets sn r such that s n 1 sn and sn and sn then the restrictions of and agree on the algebras f sn f r in sn by dynkin s lemma which can be applied noting that the collections rn r sn r r are rings in sn and hence are closed under finite intersections by countable additivity this in turn implies that and agree on r to verify the countable additivity condition in carathe odory s result one may use the following sufficient condition proposition e 10 let r be a ring in a set s and let r 0 be an additive map with the property that 0 if for each nonincreasing sequence an n 1 in r with n 1 an we have limn an 0 then is countably additive on r proof let b j j 1 be a disjoint sequence in r with b j 1 b j r we need to show that b j 1 b j e 4 let an j n b j b b 1 bn 1 then an r and an and therefore an 0 by assumption on the other hand b an b 1 b 2 bn 1 an n 1 j 1 b j therefore 06 b n 1 j 1 b j an 0 and e 4 follows measure spaces 655 lebesgue measure as a first application of carathe odory s theorem we construct the lebesgue measure for a a 1 ad and b b 1 bd such that a j 6 b j for j 1 d we write a b x rd a j x j 6 b j j 1 d the collection i d of all finite unions of half open rectangles is a ring and every set in i d can be written as a finite union of disjoint half open rectangles for i a b let i d j 1 j j for a i d of the form a i 1 in with disjoint i j i d define d i d 0 by d a n j 1 i j we must check that this number is well defined to this end suppose that a a 1 a 1 am am c 1 d 1 cn dn are two representations of a as unions of disjoint half open rectangles then ii j ai bi c j d j is either empty or a nonempty half open rectangle and we have m i 1 ii j c j d j and n j 1 ii j ai bi from the definition and the disjointness of the sets ii j we obtain m i 1 d ai bi m i 1 d n j 1 ii j m i 1 n j 1 d ii j n j 1 m i 1 d ii j n j 1 d m i 1 ii j n j 1 d c j d j which proves the asserted well definedness when the dimension d is fixed and there is no danger of confusion we write for d lemma e 11 the function i d 0 is countably additive on i d proof by proposition e 10 it suffices to prove that for each sequence an n 1 in i d satisfying an we have an 0 fix such a sequence an n 1 and let 0 we have to find n n such that an for all n n step 1 for each n n choose a bn i d such that bn an and an bn 6 2 n since bn an we also have n 1 bn it follows that the complements of the sets bn 656 measure spaces form an open cover of the set a 1 which is compact by the bolzano weierstrass theorem therefore there exists an n such that a 1 n n 1 bn it follows that n n 1 bn a 1 since bn a 1 for all n 1 we must have that n n 1 bn step 2 let cn n j 1 b j for n 1 for every n 1 an cn n j 1 an b j n j 1 a j b j therefore using lemma e 8 1 in and the subadditivity of in the verification of which we leave as an easy exercise we find an cn 6 n j 1 a j b j 6 n j 1 a j b j 6 n j 1 2 j since cn for all n n we can conclude that an an cn for every n n theorem e 12 lebesgue measure there exists a unique borel measure on rd satisfying i i for all i i d moreover for all h rd and a b rd we have a h a where a h x h x a proof in lemma e 11 we have shown that is countably additive on the ring i d therefore by theorem e 9 admits a unique extension to a finite measure on i d b rd to prove translation invariance let h rd we claim that for every a b rd one has a h b rd for this let ah a b rd a h b rd by definition ah b rd one can check that ah is a algebra for each open set a one has a h is open and hence a h b rd therefore b rd open sets ah and the claim follows for a b rd set h a a h then h is a measure on b rd and for any half open rectangle i h i i h i i by uniqueness we find h a a for all a b rd product measures as a second application of carathe odory s theorem we prove the existence of product measures theorem e 13 product measures let j f j j j 1 n be finite measure measure spaces 657 spaces then there exists a unique finite measure nj 1 n on the product algebra f nj 1 f j which satisfies f 1 fn n j 1 j fj whenever the sets fj f j satisfy j fj for j 1 n the measure is called the product of 1 n proof let r be the ring consisting of all finite unions of measurable rectangles of finite measure that is sets of the form nj 1 fj with fj f j satisfying j fj for j 1 n since the intersection of finitely many measurable rectangles of finite measure is a measurable rectangle of finite measure every r r can be written as a finite union of disjoint measurable rectangles of finite measure say r r 1 r k and we may define r k j 1 r j where each r j is given by the product formula in the statement of the theorem the proof that r is well defined follows the lines of the proof for the lebesgue measure it is clear that is additive on r we claim that is countably additive on r once we know this the existence of a unique finite product measure follows from carathe odory s theorem a quick proof of the claim is obtained by applying proposition e 10 in combination with the dominated convergence theorem the reader may check that no circularity is introduced by borrowing this result at this stage thus let a j j 1 be a nonincreasing sequence of sets in r satisfying j 1 a j we must show that lim j a j 0 we have a j n 1 1 a j d 1 d n using that a j is the finite union of measurable rectangles of finite measure and that the identity holds for such sets by definition the asserted convergence now follows by applying dominated convergence n times consecutively example e 14 the lebesgue measure on rd b rd is the product measure of d copies of the lebesgue measure on r b r borel measures on metric spaces definition e 15 regularity a borel measure on a topological space x is called 658 measure spaces inner regular if for all borel subsets b of x and all 0 there is a closed set f in x such that f b and b f outer regular if for every borel subset b of x and all 0 there is an open set u in x such that b u and u b regular if it is inner regular and outer regular proposition e 16 regularity every finite borel measure on a metric space is regular proof let be a finite borel measure on a metric space x denote by a x the collection of all borel sets a in x which have the property that for all 0 there exist a closed set f and an open set u such that f a u and u f we must prove that a x b x claim 1 a x is a algebra it is clear that a x and that a x is closed under taking complements to see that a x is closed under taking countable unions let an n 1 be sets in a x let 0 be given and let fn n 1 and un n 1 be se quences of closed and open sets such that fn an un and un fn 2 n the set u n 1 un is open in view of u n 1 fn 6 n 1 un fn there exists an index n such that u n n 1 fn the set f n n 1 fn is closed satisfies f n 1 an u and u f claim 2 a x contains all closed subsets of x to see this let f be a closed subset of x and define for k 1 uk x x d x f 1 k then each uk is open and we have k 1 uk f hence limn uk f and the claim follows combining the two claims we see that a x b x in order to state the theorem we need the following terminology definition e 17 tightness a borel measure on a topological space x is called tight if for every 0 there exists a compact set k in x such that x k the following proposition gives a sufficient condition for tightness proposition e 18 every borel probability measure on a separable complete metric space x is tight measure spaces 659 proof let xn n 1 be a dense sequence in x and fix 0 for each integer k 1 the closed balls b xn 1 k cover x and therefore there exists an index nk 1 such that nk n 1 b xn 1 k 1 2 k the set k k 1 nk n 1 b xn 1 k is closed and totally bounded since x is assumed to be complete k is compact by theorem d 10 moreover k 6 k 1 2 k for separable complete metric spaces this result implies the following improvement to the inner regularity of borel measures provided by proposition e 16 corollary e 19 let be a borel probability measure on a separable complete metric space e then for all borel subsets b of e and all 0 there is a compact set k in e such that k b and b k definition e 20 a borel measure on a topological space x is called radon if for every borel subset b of x and all 0 there is a compact set k x and an open set u x such that k b u and u k proposition e 21 let be a finite borel measure on a separable complete metric space x then is radon proof the measure is regular by proposition e 16 so for every borel set b there is a closed set f x and an open set u x such that k b u and u f 12 in particular we have b f 12 by proposition e 18 is tight so there is a compact set k such that x k 12 the compact set f k is contained in b and satisfies b f k appendix f integration in this appendix we review the lebesgue integral measurable functions let 1 f 1 and 2 f 2 be measurable spaces a function f 1 2 is said to be measurable if f f f 1 for all f f 2 clearly compositions of measurable functions are measurable if c 2 is a subset of f 2 with the property that c 2 f 2 then a function f 1 2 is measurable if and only if f c f 1 for all c c 2 indeed just notice that f f 2 f f f 1 is a sub algebra of f 2 containing c 2 let f and f be measurable spaces and let be a measure on f if f is measurable then f f f f f f defines a measure f on f this measure is called the image of under f in the context where f p is a probability space the image of p under f is called the distribution of f in most applications we are concerned with functions f from a measurable space f to k b k such functions are said to be borel measurable in what fol lows we summarise some measurability properties of borel measurable functions the adjective borel is omitted when no confusion is likely to arise this manuscript will be published by cambridge university press in the series cambridge studies in advanced mathematics this version is free to view and download for personal use only not for re distribution re sale or use in derivative works jan van neerven 661 662 integration since open sets are borel continuous functions are borel measurable by the observation made earlier a function f r is borel measurable if and only if f a f for all a r and a function f c is borel measurable if and only if re f a im f b f for all a b r from this it follows that linear combinations products and quotients if defined of measurable functions are measurable for example if the real valued functions f and g are measurable then f g is measurable since f g a q q f q g a q the measurability of the sum of two complex valued measurable functions is proved in the same way if f k and g k are measurable then f g 12 f g 2 f 2 g 2 is measurable if f c is measurable then its complex conjugate f is measurable it is the com position of the measurable function f and the continuous function z 7 z and therefore re f 12 f f and im f 1 2 i f f are measurable conversely if re f and im f are measurable so is f re f i im f if f supn 1 fn pointwise and each fn r is measurable then f is measurable since f a n 1 fn a it follows from infn 1 fn supn 1 fn that the pointwise infimum of a sequence of measurable functions is measurable as well from this we get that the pointwise limit superior and limit inferior of measurable functions are measurable since limsup n fn lim n sup k n fk inf n 1 sup k n fk and liminfn fn limsupn fn it follows that the pointwise limit limn fn of a sequence of measurable functions fn r is measurable by considering real and imaginary parts separately the latter extends to pointwise limits of functions fn c in the above considerations involving suprema and infima it is implicitly assumed that these suprema and infima exist and are finite pointwise this restriction can be lifted by considering functions f such functions are said to be borel measurable if the sets f b b b r as well as the sets f and f are in f a simple function is a function f k that can be represented in the form f n n 1 cn 1 fn integration 663 with coefficients cn k and disjoint sets fn f for all n 1 n proposition f 1 a function f k is measurable if and only if it is the pointwise limit of a sequence of simple functions fn k which may be chosen to satisfy 06 fn f pointwise if f is bounded it may in addition be arranged that the convergence is uniform if f is nonnegative we may furthermore arrange that 06 fn f pointwise and uniformly if f is bounded proof there is no loss of generality in taking k c the if part is clear from the fact that measurability is preserved under taking point wise limits it remains to prove the only if part to prove the first assertion for j k z and n n consider the rectangles r n jk j 2 n j 1 2 n i k 2 n k 1 2 n in the complex plane let c n jk be the unique point in the closure of r n jk with minimum modulus then the simple functions fn 22 n j k 22 n c n jk 1 f r n jk satisfy fn f and 06 fn f pointwise if f is bounded the convergence is uniform to prove the second assertion for j n and n n consider the intervals i n j j 2 n j 1 2 n in the nonnegative real line then the simple functions fn 22 n j 0 j n 1 f i n j satisfy 06 fn f pointwise if f is bounded the convergence is uniform the lebesgue integral we now construct the lebesgue integral and study its properties the construction of the integral proceeds in two stages in the first step the lebesgue integral of an arbi trary nonnegative measurable function is defined allowing the value in the second step the notion of integrability is introduced and the lebesgue integral of an integrable function is defined let f be a measure space for a nonnegative simple function f nn 1 cn 1 fn we define f d n n 1 cn fn we allow fn to be infinite this causes no problems because the coefficients cn are 664 integration nonnegative we use the convention 0 0 it is easy to check that this integral is well defined in the sense that it does not depend on the particular representation of f as a simple function also the integral is linear with respect to addition and multiplication with nonnegative scalars a f bgd a f d b gd and monotone in the sense that if 06 f 6 g pointwise then f d 6 gd in what follows a nonnegative function is a function with values in 0 recall that such a function is said to be borel measurable if the sets f b b b r as well as the set f is in f in what follows measurable always means borel measurable for a nonnegative measurable function f we choose a sequence of simple functions 06 fn f see proposition f 1 and define f d lim n fn d the following lemma implies that this definition does not depend on the approximating sequence lemma f 2 for a nonnegative measurable function f and nonnegative simple func tions fn and g such that 06 fn f and g 6 f pointwise we have gd 6 lim n fn d proof first consider the case g 1 f fix 0 arbitrary and let fn 1 f fn 1 then f 1 f 2 and n 1 fn f and therefore fn f since 1 f fn 1 1 fn lim n fn d lim n 1 f fn d 1 lim n fn 1 f 1 gd this proves the lemma for g 1 f the general case follows by linearity the integral is linear and monotone on the set of nonnegative measurable functions indeed if f and g are such functions and 06 fn f and 06 gn g then for a b 0 we have 06 a fn bgn a f bg and therefore a f bgd lim n a fn bgn d integration 665 a lim n fn d b lim n gn d a f d b gd if such f and g satisfy f 6 g pointwise then from 06 fn 6 max fn gn g we see that f d lim n fn d 6 lim n max fn gn d 6 gd let us now take a closer look at the role of null sets we begin with a simple obser vation proposition f 3 if f is a nonnegative measurable function then 1 if f d then f 0 2 if f d 0 then f 6 0 0 proof for all c 0 we have 06 c 1 f 6 f and therefore 06 c f 6 f d the first result follows from this by letting c for the second note that for all n 1 we have 1 n 1 f 1 n 6 f and therefore 1 n f 1 n 6 f d 0 it follows that f 1 n 0 now note that f 0 n 1 f 1 n the monotone convergence theorem the next theorem is the cornerstone of integration theory theorem f 4 monotone convergence theorem let 06 f 1 6 f 2 6 be a sequence of nonnegative measurable functions converging pointwise to a function f then lim n fn d f d proof first note that f is nonnegative and measurable for each n 1 choose a se quence of simple functions 06 fnk k fn set gnk max f 1 k fnk for m 6 n we have gmk 6 gnk also for k 6 l we have fmk 6 fml m 1 n and therefore gnk 6 gnl we conclude that the functions gnk are monotone in both indices 666 integration from fmk 6 fm 6 fn 1 6 m 6 n we see that fnk 6 gnk 6 fn and we conclude that 06 gnk k fn from fn lim k gnk 6 lim k gkk 6 f we deduce that 06 gkk f recalling that gkk 6 fk it follows that f d lim k gkk d 6 lim k fk d 6 f d example f 5 we have the following substitution formula for any measurable f 1 2 and nonnegative measurable 2 r 1 f d 2 d f to prove this note that this is trivial for simple functions 1 f with f f 2 by linearity the identity extends to nonnegative simple functions and by monotone con vergence using proposition f 1 to nonnegative measurable functions from the monotone convergence theorem we deduce the following useful corollary theorem f 6 fatou s lemma let fn n 1 be a sequence of nonnegative measurable functions on f then liminf n fn d 6 liminf n fn d proof from infk n fk 6 fm m n we infer inf k n fk d 6 inf m n fm d hence by the monotone convergence theorem liminf n fn d lim n inf k n fk d lim n inf k n fk d 6 lim n inf m n fm d liminf n fn d the dominated convergence theorem a measurable function f k is called integrable if f d integration 667 clearly if f and g are measurable and g 6 f pointwise then g is integrable if f is integrable in particular if f is integrable then the nonnegative functions f and f are integrable and we define f d f d f d for a set f f we write f f d 1 f f d noting that 1 f f is integrable the monotonicity and additivity properties of this integral carry over to this more general situation provided we assume that the functions we integrate are integrable the next result is among the most useful in all of analysis theorem f 7 dominated convergence theorem let fn n 1 be a sequence of inte grable functions such that limn fn f pointwise if there exists an integrable function g such that fn 6 g for all n 1 then lim n fn f d 0 in particular lim n fn d f d proof we make the preliminary observation that if hn n 1 is a sequence of nonneg ative measurable functions such that limn hn 0 pointwise and h is a nonnegative integrable function such that hn 6 h for all n 1 then by the fatou lemma hd liminf n h hn d 6 liminf n h hn d hd limsup n hn d since hd is finite it follows that 06 limsupn hn d 6 0 and therefore lim n hn d 0 the theorem follows by applying this to hn fn f and h 2 g if f is integrable and f 6 0 0 then f d 0 indeed by considering f and f separately we may assume f is nonnegative choose simple functions 06 fn f then fn 0 6 f 0 0 and therefore fn d 0 for all n 1 the claim follows from this consequently in the main results of the previ ous section in particular in the monotone convergence theorem theorem f 4 and the 668 integration dominated convergence theorem theorem f 7 we may replace pointwise convergence by pointwise convergence almost everywhere where the latter means that we allow an exceptional set of measure zero in the assumptions for instance in the monotone convergence theorem it suffices to assume that 0 6 fn f pointwise almost every where and similarly in the dominated convergence theorem it suffices to assume that limn fn f pointwise almost everywhere and fn 6 g pointwise almost ev erywhere for all n fubini s theorem proposition f 8 let 1 f 1 and 2 f 2 be measurable spaces and let f 1 2 k be measurable with respect to the product algebra f 1 f 2 then 1 the function 2 7 f 1 2 is measurable 2 the function 1 7 f 1 2 is measurable proof the collection f of all sets f f 1 f 2 such that 1 and 2 hold for f 1 f is a algebra containing every set of the form f 1 f 2 with f 1 f 1 and f 2 f 2 since f 1 f 2 is the smallest algebra containing these sets it follows that f f 1 f 2 this proves that the proposition holds for all indicator functions 1 f with f f 1 f 2 by taking linear combinations the result extends to simple functions the result for arbitrary measurable functions then follows by pointwise approximation with simple functions theorem f 9 fubini first version let 1 f 1 1 and 2 f 2 2 be finite mea sure spaces if f 1 2 k is nonnegative and measurable with respect to the product algebra f 1 f 2 then 1 the 0 valued function 2 7 1 f 1 2 d 1 1 is measurable 2 the 0 valued function 1 7 2 f 1 2 d 2 2 is measurable 3 we have 1 2 f d 1 2 2 1 f d 1 d 2 1 2 f d 2 d 1 proof first suppose that 1 1 2 2 1 and let f be the collection of all sets f f 1 f 2 such that 1 3 hold for f 1 f we claim that f is a algebra indeed 1 3 are trivial for f 1 0 if 1 3 hold for a set f f 1 f 2 then 1 f 1 2 1 1 f 1 2 implies that 1 and 2 hold for f and furthermore 1 2 1 f d 1 2 1 2 1 1 f d 1 2 integration 669 1 1 2 1 f d 1 2 1 2 1 1 f d 1 d 2 2 1 1 1 f d 1 d 2 2 1 1 f d 1 d 2 and similarly for the other repeated integral so 3 holds for f if 1 3 hold for disjoint sets 1 f 1 1 f 2 f 1 f 2 the monotone convergence theorem implies that 1 3 hold for 1 f with f n 1 fn this proves the claim it is clear that 1 3 hold for all rectangles f 1 f 2 with f 1 f 1 and f 2 f 2 since f 1 f 2 is the smallest algebra containing these rectangles it follows that f f 1 f 2 if 1 and 2 are finite we apply the preceding step to the normalised measures 1 1 1 and 2 2 2 and again find that 1 3 hold for all f f 1 f 2 this extends to the finite case by approximation and monotone convergence by taking linear combinations the result extends to nonnegative simple functions the result for arbitrary nonnegative measurable functions then follows by another ap plication of monotone convergence a variation of the fubini theorem holds if we replace nonnegative measurable by integrable theorem f 10 fubini second version let 1 f 1 1 and 2 f 2 2 be finite measure spaces if f 1 2 k is integrable with respect to the product measure 1 2 then 1 the function 2 7 1 f 1 2 d 1 1 is integrable with respect to 2 2 the function 1 7 2 f 1 2 d 2 2 is integrable with respect to 1 3 we have 1 2 f d 1 2 2 1 f d 1 d 2 1 2 f d 2 d 1 proof by splitting into real and imaginary parts and then into positive and negative parts we may assume that f is nonnegative hence 3 holds by theorem f 9 with a finite left hand side it follows that the two repeated integrals are finite since an integral with respect to a measure of a nonnegative function is finite only if the integrand is finite almost everywhere assertions 1 and 2 follow as well appendix g notes historical perspectives on functional analysis are presented in dieudonne 1981 monna 1973 pietsch 2007 among the many excellent textbooks on functional analysis our favourites include bressan 2013 brezis 2011 conway 1990 dun ford and schwartz 1988 a einsiedler and ward 2017 lax 2002 rudin 1991 schechter 2002 werner 2000 yosida 1980 chapter 1 exhaustive treatments of the theory of banach spaces and the bochner integral are given in albiac and kalton 2006 diestel 1984 dunford and schwartz 1988 a li and queffe lec 2004 and diestel and uhl 1977 dunford and schwartz 1988 a hyto nen et al 2016 respectively chapter 2 the proofs of propositions 2 19 and 2 23 are taken from haase 2007 our presenta tion of proposition 2 34 and section 2 3 d follows hyto nen et al 2016 where more detailed information on this topic can be found the classical reference is stein 1970 the fre chet kolmogorov compactness theorem is usually stated for bounded subsets of lp rd that boundedness follows from the assumptions i and ii was observed later by sudakov the simple proof presented here is from hanche olsen et al 2019 the presentation of section 2 3 d follows hyto nen et al 2016 our treatment of theorems 2 45 and 2 46 follows bogachev 2007 b comprehensive treatments of vector lattices banach lattices and positive operators are given in aliprantis and burkinshaw 1985 luxemburg and zaanen 1971 meyer nieberg 1991 schaefer 1974 zaanen 1997 671 672 notes the problem of proving the boundedness of t ix on lp x for bounded oper ators t on lp discussed in problem 2 28 is highly nontrivial an interesting com plement to the results mentioned in the problem is the following result of paley and marcinkiewicz zygmund if t is bounded on lp with 16 p and x is a hilbert space then t ix admits a unique extension to a bounded operator on lp x and its norm equals t the proof uses properties of gaussian random variables it was shown by kwapien that the fourier plancherel transform see section 5 5 extends to a bounded operator on l 2 rd x if and only if x is isomorphic to a hilbert space and as such is unitary if x is a hilbert space by results of bourgain and burkholder the hilbert transform see section 5 6 extends to a bounded operator on lp r x for some 1 p if and only if it extends to a bounded operator on lp r x for all 1 p if and only if x has the so called umd property this abbreviation stands for uncondi tionality of martingale differences proofs of these results and their ramifications can be found in hyto nen et al 2016 pisier 2016 the umd property also characterises the boundedness of the vector valued extension of the ito stochastic integral of problem 3 25 see van neerven et al 2015 and the references given therein chapter 3 theorem 3 13 characterises hilbert spaces up to isomorphism more precisely the fol lowing deep theorem has been proved in lindenstrauss and tzafriri 1971 a banach space x is isomorphic to a hilbert space if and only if every closed subspace of x is the range of a bounded projection in x the proof of the radon nikody m theorem outlined in problem 3 22 is due to von neumann and follows rudin 1987 the construction in problem 3 24 of a linear op erator on 2 which fails to be bounded depends on the existence of an algebraic basis in 2 see problem 3 23 which in turn is deduced with the help of zorn s lemma the latter being equivalent to the axiom of choice this raises the question whether a con structive example of an unbounded operator can be given within zermelo fraenkel set theory zf the answer is negative it is consistent with zf that every linear operator on a banach space is bounded in fact it is a theorem in zf extended with the so called axiom of determinacy and the countable axiom of choice that every linear operator on a banach space is bounded fremlin 2015 theorem 567 h c it can be quite hard to decide whether a given subspace is dense in a given hilbert space the following example may illustrate this let h denote the hilbert space of all scalar sequences c cn n 1 for which the norm c 2 h n 1 1 n 2 cn 2 notes 673 is finite for x r let x denote its fractional part that is the unique real number in 0 1 such that x k x for some integer k z for m 1 2 3 let c m nm n 1 and note that these sequences belong to h it is a theorem of nyman and baez duarte that the linear span of the sequence c m m 1 is dense in h if and only if the riemann hypothesis holds this result as well as several related ones is surveyed in baghi 2006 the riemann hypothesis is considered by many mathematicians as one of the most important open problems in all of mathematics chapter 4 our proof of theorem 4 2 is essentially that of folland 1999 although terminology is slightly different different authors use different definitions of radon measures the real version of the hahn banach theorem is due to banach the extension to complex scalars was added a decade later by hahn banach also proved the sequen tial version of the banach alaoglu theorem the general version is due to alaoglu a detailed survey of the hahn banach theorem is given in buskes 1993 the weak and weak topologies are special cases of so called locally convex topolo gies for systematic introductions to this subject we recommend aliprantis and burkin shaw 1985 conway 1990 rudin 1991 theorem 4 47 is a special case of the so called principle of local reflexivity its full formulation can be found for example in albiac and kalton 2006 our proof of theorem 4 63 is closely related to that presented in bogachev 2007 a where more refined versions of the theorem can be found the result of problem 4 10 is discussed in phelps 1960 the converse also holds if every functional on a closed subspace on x has a unique hahn banach extension of the same norm then x is strictly convex see foguel 1958 taylor 1939 the result of problem 4 32 is due to sobczyk 1941 chapter 5 general references on the theory of bounded operators include beauzamy 1988 go hberg et al 2003 2013 nikolski 2002 the proof of the uniform boundedness theorem sketched in problem 5 3 is taken from pietsch 2007 where it is credited to lebesgue most treatments of the fourier plancherel transform use the schwartz space s rd of rapidly decreasing smooth functions instead of our f 2 rd our treatment of the fourier transform and the hilbert transform follows that of hyto nen et al 2016 the lp boundedness of the hilbert transform is classical we follow grafakos 2008 674 notes the theory of fourier multiplier operators can be meaningfully extended to the lp setting where it becomes a powerful tool in the caldero n zygmund theory of singular integral operators the prime example of such an operator is the hilbert transform detailed treatments of the hilbert transform and singular integral operators in the lp setting are given in grafakos 2008 stein 1970 1993 the theory of the hilbert transform extends to higher dimensions where analogous statements hold for the riesz transforms defined as the fourier multipliers operators associated with the functions m j l rd defined by m j j j 1 d an exhaustive treatment of these matters belongs to the realm of harmonic analysis see grafakos 2008 stein 1970 and chapter 5 of hyto nen et al 2016 the proof of the riesz thorin theorem 5 39 presented here is taken from hyto nen et al 2016 where also the argument proving tc t can be found in this ref erence the proof of the clarkson inequalities sketched in problem 5 26 is attributed to ju rgen voigt it is a famous result of beckner 1975 that the constant 1 in the hausdorff young inequality f f lq rd m 6 f lp rd m for the fourier transform with respect to the normalised lebesgue measure m where 16 p 6 2 and 1 p 1 q 1 can be improved f f lq rd m 6 c d p f lp rd m with cp p 1 p q 1 q 1 2 in the same paper beckner proved the improvement to the young inequality mentioned in the main text and showed that both results are sharp the proofs rely on but go beyond the techniques developed in section 15 6 the marcinkiewicz interpolation theorem is of fundamental importance in the the ory of singular integrals see grafakos 2008 stein 1970 and the forthcoming work hyto nen et al 2022 our treatment follows hyto nen et al 2016 the lp bounded ness of the hilbert transform here derived as a consequence of the riesz thorin the orem can also be derived from the marcinkiewicz interpolation theorem the required weak l 1 bound is due to kolmogorov see duoandikoetxea 2001 the result of problem 5 16 is due to pettis 1938 it is no coincidence that the counterexample for p 1 in part b lives in the space c 0 part a extends to p 1 for all banach spaces not containing a closed subspace isomorphic to c 0 a proof of this fact is given in diestel and uhl 1977 further results on the pettis integral can be found in van dulst 1989 musia 2002 talagrand 1984 notes 675 chapter 6 there are many excellent treatments of spectral theory such as the monumental classic dunford and schwartz 1988 b and the monographs arveson 2002 aupetit 1991 mu ller 2007 a discussion of the conditions i and ii for contours in cauchy s theo rem can be found in rudin 1987 the result of problem 6 15 is due to gelfand 1941 the proof outlined here is due to allan and ransford 1989 chapter 7 our proofs of proposition 7 27 and theorems 7 29 and 7 31 follow schechter 2002 bleecker and boo bavnbek 2013 and bo ttcher and silbermann 2006 respectively the proof of theorem 7 33 follows coburn s original papers coburn 1966 1967 see also arveson 2002 another proof is given in douglas 1998 where also the results from the theory of hardy spaces alluded to in the proof can be found toeplitz operators are covered in more depth in arveson 2002 bo ttcher and silbermann 2006 douglas 1998 nikolski 2002 the winding number of a continuous closed curve in c 0 parametrised by the function 0 1 c 0 t 7 e 2 it can be computed as follows one shows that there exists a continuous function g 0 1 c such that e 2 it e 2 ig t t 0 1 the identity e 2 ig 1 1 e 2 ig 0 implies that g 1 g 0 z this integer equals the winding number of proofs and some easy consequences can be found in arveson 2002 the result of problem 7 4 has the following interesting complement due to pitt for all 1 6 p q every bounded operator from q to p is compact an immediate consequence is that the spaces p and q are not isomorphic the proof of pitt s theorem requires some effort see for instance albiac and kalton 2006 ryan 2002 the result of problem 7 8 is due to terziog lu 1971 by using some elementary c algebra techniques it is possible to derive theorem 7 31 as a simple corollary to theorem 7 33 we begin by introducing some terminology a banach algebra is a banach space a endowed with a composition mapping x y 7 xy such that xy 6 x y holds for all x y a a unital banach algebra is a banach algebra a with a unit element that is an element e a such that ex xe x x a 676 notes the spectrum a x of an element x of a unital banach algebra a is the set of all c for which no y a can be found such that x y y x e and most of the spectral theory contained in chapter 6 can be routinely extended to this situation a c algebra is a banach algebra a with an involution that is a mapping x 7 x on a satisfying x y x y cx cx xy y x as well as x x x x x x for all x y a and c c according to the gelfand naimark theorem every c algebra a is isometric to a closed subalgebra of l h for a suitably chosen hilbert space h a subalgebra being a subalgebra closed under taking involutions and a isometric isomorphism being an isometric isomorphism u with the additional properties that u xy uxuy and u x ux for all x y a this theorem connects the abstract definition of c algebras given here with the concrete approach taken in section 9 5 the following generalisation of proposition 8 19 holds see folland 2016 proposi tion 1 23 or rudin 1991 theorem 11 29 if a is a closed unital subalgebra of a unital c algebra b then a x b x x a g 1 the proof follows proposition 8 19 except for the fact that x x implies b x x r this fact can be proved by combining the gelfand naimark theorem and proposi tion 8 19 an elementary proof can be given as follows if u b is unitary that is uu u u e the argument suggested in problem 8 2 proves that b u t then the argument suggested in problem 8 3 proves that if x x then b x r using g 1 let us now give a simple alternative proof of theorem 7 31 based on theorem 7 33 cf corollary 1 in arveson 2002 section 4 3 the results of problem 7 12 prove that for any banach space x the calkin l x k x is a unital banach algebra if h is a hilbert space then l h k h is a unital c algebra in what follows we take h h 2 d since k h is contained in the toeplitz alge bra t it is meaningful to consider the quotient space t k h this space is a unital subalgebra of l h k h by coburn s theorem the mapping t k 7 sets up a isometry from t onto c t and we have the commuting diagram 0 k h t c t 0 0 k h l h l h k h 0 j notes 677 where are the quotient mappings and j is the composition of the isometry from c t onto t k h provided by theorem 7 33 and the natural inclusion mapping from t k h into l h k h as such j is injective now suppose that c t is such that t t is fredholm by atkinson s theorem there exists an s l h 2 d such that i t s and i st are compact this means that t defines an invertible element in l h k h as an application of g 1 t defines an invertible element in t k h a moment s reflection reveals that this im plies that s t say s t k with c t and k k h it then follows that j t t st i j 1 and the injectivity of j implies 1 this is only possible if is zero free chapter 8 our proof of theorem 8 18 is taken from rudin 1991 a proof of runge s theorem which was used in the proof of part i of theorem 8 20 may be found in rudin 1987 the clever proof of proposition 8 21 is taken from whitley 1968 the proof of theo rem 8 36 is taken from davies 1980 the proof of the toeplitz hausdorff theorem proposed in problem 8 9 is due to li 1994 more about numerical ranges can be found in gustafson and rao 1997 chapter 9 most treatments of the spectral theorem for normal operators proceed via the theory of c algebras see for example arveson 2002 rudin 1991 this permits a concise abstract proof but has the drawback that this theory depends on the existence of max imal ideals a well known consequence of zorn s lemma our approach avoids the use of zorn s lemma the idea to use proposition 9 12 to prove that the projection valued measure is concentrated on the spectrum is from haase 2018 our treatment of the von neumann bicommutant theorem and the result stated in problem 15 11 are taken from pedersen 2018 the presentation of section 9 6 follows koelink 1996 in heuser 2006 a direct albeit tricky proof is given of the result of problem 9 13 which relies solely on the continuous functional calculus for selfadjoint operators 678 notes chapter 10 references for this chapter include akhiezer and glazman 1981 a birman and solom jak 1987 dunford and schwartz 1988 b edmunds and evans 2018 b kato 1995 reed and simon 1975 schmu dgen 2012 our proof of the spectral theorem com bines elements of rudin 1991 and schmu dgen 2012 and is elementary in that it avoids the use of c algebra techniques for selfadjoint operators a more direct con struction of the measurable calculus can be given see for example rudin 1991 where it is used to give a simpler proof of the existence and uniqueness of square roots for pos itive selfadjoint operators the proof of the inclusion of theorem 9 28 presented in section 10 3 b is taken from sz nagy 1967 chapter 11 the connections between functional analysis and the theory of partial differential equa tions are emphasised in bressan 2013 brezis 2011 jost 2013 the results of this chapter barely scratch the surface of what can be said in this context sobolev spaces are treated in detail in adams and fournier 2003 evans 2010 some of our proofs are modelled after those presented in these references our pre sentation of propositions 11 5 and 11 16 follows hyto nen et al 2016 the proof of theorem 11 12 follows an idea of krylov 2008 extension operators are treated in adams and fournier 2003 evans 2010 the proof of step 1 of theorem 11 28 is from adams and fournier 2003 our proof of theorem 11 27 is based on unpublished lecture notes by mark veraar the theorem which asserts the density of c d in w k p d for bounded ck domains d actually gives the stronger result that for any f w k p d there exists a sequence of functions fn c rd whose restrictions to d satisfy limn fn f w k p d 0 in this con nection it is worth mentioning that if d is a bounded ck domain then every function f ck d is the restriction of a function in ck rd the analogous result holds for func tions in c d when d is a bounded c domain in both cases the extensions can be realised through a linear mapping this result is due to seeley 1964 the proof of theorem 11 24 follows arendt and urban 2010 and brezis 2011 the c 1 conditions of the second part of the theorem can be relaxed see biegert and warma 2006 if d is bounded and has c 1 boundary d then for 1 6 p the mapping f 7 f d for f c d admits a unique extension to a bounded operator t the trace operator from w 1 p d to lp d here we think of d as being equipped with its surface measure moreover for a function f w 1 p d one has f w 1 p 0 d if and notes 679 only if t f 0 the details can be found in adams and fournier 2003 brezis 2011 evans 2010 it is not true in general that the weak solution of the poisson problem u f with f l 2 d subject to dirichlet boundary conditions belongs to h 2 d a counterexample can be found in satz 6 89 of arendt and urban 2010 proofs of the h 2 regularity result mentioned in remark 11 38 and its analogue for neumann boundary conditions can be found in chapter 6 of evans 2010 systematic treatments of the finite element method are presented in the monographs atkinson and han 2009 brenner and scott 2008 problems 11 23 and 11 24 are taken from krylov 2008 and reproduce sobolev s original proof of the inequality named after him the outline of the proof in problem 11 26 that for f cc d no solution in c 2 d c d to the poisson problem may exist is taken from arendt and urban 2010 problems 11 28 and 11 29 are modelled after the same reference chapter 12 excellent references for the theory of forms are kato 1995 ouhabaz 2005 some of our proofs follow the latter reference for the spectral theory of differential operators the reader is referred to edmunds and evans 2018 a b and the references given therein and for variational methods henrot 2006 more complete treatments of dirichlet and neumann laplacians can be found in the lecture notes arendt 2006 and the survey papers arendt 2004 grebenkov and nguyen 2013 where further references to the literature are given a standard reference for the theory of elliptic second order differ ential operators is gilbarg and trudinger 2001 our proof of theorem 12 12 follows arendt 2006 further results along the lines of this theorem and its corollary can be found there and in ouhabaz 2005 among other things under the assumptions of the corollary d a is dense in d a in some of the results about the neumann laplacian the c 1 assumption on the bound ary can be relaxed for example the neumann laplacian has point spectrum if d has continuous boundary and d lies on one side of it the steps are as follows if d a has continuous boundary then w 1 2 d is compactly embedded in l 2 d according to theorem v 4 17 of edmunds and evans 2018 b and the neumann laplacian has a compact resolvent the assumption on the boundary in theorem 12 26 2 and theorem 12 27 may be weakened accordingly kac s question can one hear the shape of a drum was asked in kac 1966 and answered to the negative in gordon et al 1992 our presentation of weyl s theorem follows higson 2004 an example of a jordan curve of positive area is given in osgood 1903 680 notes the inequality n 6 n of corollary 12 28 comparing the dirichlet eigenvalues n and the neumann eigenvalues n admits a significant improvement due to friedlander 1991 who proved that for all n 1 we have n 1 6 n after reducing to smooth domains an important step in the proof is the spectral flow inequality nneum ndir n for 0 satisfying 6 dir neum where ndir n dir n nneum n neum n and n is the number of negative eigenvalues of the dirichlet to neumann operator r counting multiplicities throughout this is the operator on l 2 d which maps a function f l 2 d to u d l 2 d where u h 1 d is the unique solution of the problem u u on d u f on d it is selfadjoint bounded below and has compact resolvent a simpler proof of friedlander s theorem based on a variant of the courant fischer theorem was obtained by filonov 2005 levine and weinberger 1986 obtained the inequality n d 6 n for bounded convex domains d in rd with strict inequality when d is smooth weyl s theorem has been extended to other types of boundary conditions including neumann boundary conditions and positive selfadjoint elliptic operators for more de tails the reader is referred to safarov and vassilev 1997 such extensions are nontrivial even for the laplace operator because the domain monotonicity for dirichlet eigenval ues of lemma 12 30 generally fails for boundary conditions other than dirichlet this is demonstrated by the following example taken from funano 2022 we use the notation a b to express that a 6 cb for a universal constant c for 1 6 p 6 2 let b pd denote the open unit ball of pd the space k d endowed with the norm given by x pp dj 1 x j p if the positive real number rd p is defined by the condition vol rd pb pd 1 then rd p h d 1 p the smallest neumann eigenvalue for the laplace operator on d rd pb pd can be shown to satisfy 2 d 1 notes 681 keep in mind our convention that 1 d 0 approximating the segment in d con necting the origin and the point rd p 0 0 0 by a convex c 1 domain d d it can be shown that 2 d h 1 r 2 d p h 1 d 2 p in the positive direction in the same reference the following monotonicity result is proved if d d rd bounded convex sets with c 1 boundaries and if d d then for all n 1 we have n d d 2 n d n 1 the counterexample upon letting p 1 shows that the factor d 2 is essentially optimal problems 12 2 12 4 are taken from arendt 2006 chapter 13 excellent introductions to the theory of c 0 semigroups include the monographs apple baum 2019 davies 1980 engel and nagel 2000 pazy 1983 for a discussion of the examples in section 13 6 we refer to these sources the monumental 1957 treatise hille and phillips 1957 is freely available online parts of sections 13 1 13 4 and figures 13 1 and 13 2 are taken from appendix g of hyto nen et al 2017 which in turn is based on the corresponding material in the au thor s lecture notes for the 2006 07 internet seminar stochastic evolution equations available on the author s webpage theorem 13 11 is due to phillips 1955 theorem 13 16 is a special case of a result of jorgensen 1982 the idea to use this result to prove wiener s tauberian theorem is from van neerven 1997 theorem 13 17 was obtained independently by hille and yosida near the end of the 1940 s an extension to arbitrary c 0 semigroups which is somewhat more technical to state was found soon afterwards a detailed account of theorem 13 17 and its history is given in engel and nagel 2000 the intimate connections between semigroups and the theory of laplace transforms are emphasised in arendt et al 2011 fuller treatments of the abstract cauchy problem are given in amann 1995 arendt 2004 tanabe 1979 analytic semigroups are treated in detail in lunardi 1995 maximal regularity for bounded analytic c 0 semigroups on hilbert spaces was first proved in de simon 1964 the result remains valid if l 2 is replaced by lp with 1 p throughout this follows from rather deep extrapolation arguments for singular integral operators and falls out side our scope for a full treatment as well as references to the extensive literature on the subject the reader is referred to hyto nen et al 2022 whose treatment we follow the 682 notes method of applying maximal regularity to solving time dependent problems of section 13 4 d goes back to cle ment and li 1993 94 and has been extended to cover a wealth of other nonlinear problems in the light of example 13 41 which is revisited at the end of this section it is of some interest to mention that in the converse direction every generator a of an analytic c 0 semigroup of contractions on a complex hilbert space h can be represented in divergence form in the following precise sense there exists a hilbert space h a closed operator v d v h h with dense domain and dense range and a bounded coercive operator b l h that is we have bx x h x h for some 0 and all x h such that a v bv more precisely there exists a densely defined closed sectorial form a in h with domain d a d v such that a is the operator associated with a and a g h bv g v h g h d v a proof of this result can be found in maas and van neerven 2009 where it is also shown that this representation is essentially unique our proofs of theorem 13 50 and lemma 13 54 are taken form arendt 2006 the ornstein uhlenbeck semigroup has many interesting properties for which the reader is referred to hyto nen et al 2023 janson 1997 nualart 2006 probabilis tically up to a time scaling it arises as the transition semigroup associated with the solution ux t t 0 of the stochastic differential equation ddu t 1 2 u t dt dbt t 0 with initial condition u 0 x more precisely one has ou t 2 e ux t t 0 the domain identification d l w 2 p rd for the ornstein uhlenbeck operator l in lp rd with 1 p is due in a more general formulation to metafune et al 2002 this paper also contains references to earlier papers on this subject in particular regarding the special case p 2 the ornstein uhlenbeck semigroup extends to an analytic c 0 contraction semigroup in lp rd for 1 p with optimal angle p given by cos p 2 p 1 this result is due to epperson 1989 who also showed that the exact domain of holo morphy is the set ep z x iy c sin y tan p sinh x notes 683 a simpler proof of the latter was given in van neerven and portal 2018 the lp to lq bound 13 36 for the free schro dinger group s t t r in section 13 6 g is an example of a so called dispersive estimate it informs us that initial data in l 1 rd l 2 rd are mapped instantaneously in forward and backward time to l rd and decay to 0 as t with respect to the norm of lq rd for all 2 q 6 this bound lies at the basis of a class of deep estimates named after strichartz who proved an analogous estimate for the wave group the simplest of which gives a bound for the lp r lq rd norm of s f for initial data f l 2 rd and suitable exponents p q such estimates in turn are the key to solving certain important classes of nonlinear schro dinger equations for a detailed treatment of these matters the reader is referred to the lecture notes hundertmark et al 2013 and the references cited there an elementary introduction is presented in stein and shakarchi 2011 the argument in the first part of section 13 6 h is taken from hundertmark et al 2013 the example in problem 13 17 is due to arendt 1995 if a is a densely defined operator acting in a banach space with the property that 0 a and sup 0 a 1 then there exists a unique densely defined closed operator a 1 2 such that a 1 2 2 a moreover d a is dense in d a 1 2 and a 1 2 x 1 0 1 2 a 1 axd x d a a proof of this result can be found in section 3 8 of arendt et al 2011 in particular it applies to a b whenever b is the generator of a uniformly bounded c 0 semigroup on x the result should be compared to proposition 10 58 where it was shown that if a is a positive selfadjoint operator acting in a hilbert space then a admits a unique positive square root a 1 2 let us now apply this to the divergence form operator aa div a of example 13 41 associated with the sesquilinear form aa f g rd a f g f g h 1 rd where the d d matrix a ai j di j 1 is assumed to have bounded measurable real valued coefficients satisfying the uniform ellipticity condition stated in the example since aa generates an analytic c 0 semigroup of contractions by the above discussion 684 notes the square root a 1 2 a is well defined the kato square root problem is to decide whether the domain equality d a 1 2 a d aa h 1 rd holds with equivalence of homogeneous norms divaa 1 2 f h f for all functions f in this common domain starting with the papers kato 1961 and mcintosh 1982 this problem has witnessed a long and interesting history it was fi nally resolved in the affirmative in the generality stated here in auscher et al 2002 this paper also contains references to the various special cases that had been obtained before an alternative proof based on the theory of bisectorial operators was obtained subsequently in axelsson et al 2006 chapter 14 step 1 in our proof of the result of section 14 5 b follows theorem iv 3 1 in gohberg and goldberg 1981 our treatment of theorem 14 34 follows dunford and schwartz 1988 b theorem 14 45 goes back to mercer 1909 the proof of theorem 14 46 and the problems 14 16 and 14 16 are taken from murphy 1994 theorem 14 47 is from helton and howe 1973 the results of section 14 4 are taken from attal 2013 our proof of lidskii s theorem is due to simon 1977 whose arguments we follow here a survey of the connections between determinants and traces containing a proof of macmahon s formula as well as a treatment of fredholm determinants is cartier 1989 a proof of lemma 14 43 based on a theorem of borel and carathe odory is given in simon 1977 for much more on this topic the reader may consult simon 2005 for positive kernel operators theorem 14 45 is due to mercer 1909 the extension to general integral operators of trace class is taken from birman 1989 in that paper it is also shown how to extend the result to general measure spaces as long as its l 2 space is separable further interesting results on this topic can be found in brislawn 1988 it is of interest to note that not every integral operator with continuous kernel is of trace class a classical counterexample can be found in carleman 1916 the derivation of euler s formula from the trace of the dirichlet laplacian on the interval is taken from grieser 2007 the proof outlined in problem 14 7 is taken from arendt 2006 where it is attributed to markus haase problem 14 15 is taken from helton and howe 1973 and problems 14 16 and 14 17 are from murphy 1994 notes 685 chapter 15 historical aspects of the interaction between functional analysis and quantum me chanics are well recorded in landsman 2019 an excellent modern introduction to quantum mechanics from the mathematician s point of view is hall 2013 more ad vanced treatments are offered in landsman 1998 2017 mackey 1968 parthasarathy 2005 takhtajan 2008 the mathematical formulation of quantum mechanics using the language of hilbert space theory is due to von neumann 1968 ever since the publication of this work in 1932 physicists mathematicians and philosophers have wondered as to why na ture made that choice by looking for deeper criteria characterising hilbert spaces a first important step in this direction was taken in piron 1964 and amemiya and araki 1966 1967 in the 1960 s who proved that a complex inner product space is a hilbert space if and only if it is orthomodular by definition an inner product space h is or thomodular if y y h for every closed subspace of h the theorem of piron and amemiya araki was extended by several mathematicians to inner product spaces over r c and h the field of quaternions the definitive result in this direction was proved in sole r 1995 in order to state her result we need the following terminology let h be a vector space over a fieldk a hermitian form on h is a mapping h h k satisfying the axioms of an inner product except the requirement that x x 0 should imply x 0 a hermitian vector space is a vector space endowed with a hermitian form a subspace y of a hermitian vector space h is called closed if y y orthogonal complements being defined in the obvious way using the hermitian form a hermitian vector space h is called orthomodular if y y h for every closed subspace y of h a fieldk is called a field if it admits an involution that is a mapping c 7 c from k onto itself satisfying c 1 c 2 c 1 c 2 c 1 c 2 c 2 c 1 and c c for all c 1 c 2 c k now we are ready to state sole r s theorem if h is a hermitian vector space over a field k admitting an infinite orthonormal sequence orthonormality being defined in the obvious way using the hermitian form then k equals r c or h the hermitian form is an inner product h is a hilbert space over k a survey of sole r s theorem is given in holland 1995 very recently the theorem was used in heunen and kornell 2022 to give a characterisation of the category of hilbert spaces as the unique category in the sense of category theory satisfying certain natural category theoretical axioms modern treatments replace the language of operator theory on hilbert spaces by that of c algebras by a theorem of gelfand naimark and segal see for example rudin 686 notes 1991 every closed subalgebra can be represented as a subalgebra of l h for an appropriate hilbert space h so not much seems to be gained the advantage of this approach however is that it covers both the classical and the quantum settings by a theorem due to gelfand every commutative c algebra can be represented as a space c 0 for some locally compact hausdorff space and by c k for some com pact hausdorff space k if the c algebra has a unit in this precise sense the classical world is commutative while the quantum world in noncommutative comprehensive treatments of c algebras and states defined on them are offered in blackadar 2006 bratteli and robinson 1987 pedersen 2018 takesaki 2002 proofs of gleason s theorem mentioned at the end of section 15 2 a can be found in landsman 2017 parthasarathy 2005 our proof of theorem 15 29 is taken form akhiezer and glazman 1981 b another proof can be derived from stinespring s dilation theorem this approach is presented in han et al 2014 which may be consulted for more on positive operator valued measures older references on the subject are berberian 1966 davies 1976 holevo 2011 landsman 1998 for a detailed discussion and examples of unsharp observ ables the reader is referred to busch et al 1995 which is also the source for the results of section 15 3 d the phase povm introduced in this section was studied in garrison and wong 1970 let us now sketch an elegant proof of naimark s theorem based on stinespring s theorem we leave out some details which can be found in stinespring 1955 see also paulsen 2002 let q be a povm on f and let q bb l h be the bounded functional calculus of proposition 15 27 the crucial observation is that every bounded operator bb l h is completely positive that is for all n 1 2 and all f 1 fn bb and h 1 hn h we have n j k 1 f j fk h j hk 0 by gelfand s theorem there is no loss of generality in assuming that is a compact hausdorff space and that f is its borel algebra fixing an integer n 1 by the riesz representation theorem we find a finite borel measure on such that n j 1 g h j h j gd g c by the radon nikody m theorem there exist functions h jk l 1 such that g h j hk gh jk d g c one then checks that the matrix h jk nj k 1 is positive almost everywhere also the matrix f j fk nj k 1 is positive almost everywhere it follows that n j k 1 f j fkh jk 0 notes 687 almost everywhere and therefore n j k 1 f j fk h j hk n j k 1 f j fkh jk d 0 as was to be shown now a special case of stinespring s theorem asserts that every completely positive bounded mapping bb l h satisfying 1 1 is of the form f j f j where j is an isometry from h to a hilbert space h and bb l h is a homomorphism applying this to q and restricting to indicator functions propo sition 15 24 gives us the desired projection valued measure physically the qubit corresponds to the 2 dimensional irreducible unitary represen tation of su 2 and as such it models a spin 12 particle for every n n su 2 admits an irreducible representation which acts on c 2 n and represents a spin 12 n particle more on this topic can be found in sternberg 1994 woit 2017 a complete proof of theorem 15 33 including a proof of the algebraic fact that was used in our proof for the qubit case is given in landsman 2017 our proof for the qubit case is extracted from it bargmann s theorem mentioned in the text is in bargmann 1954 a complete proof is also found in parthasarathy 2005 theorem 15 32 is a straightforward generalisation of the hidden variable result of holevo 2011 where also the resulting hidden variable model for the qubit is derived the existence of hidden variables for the qubit was first observed by bell 1966 there is an extensive literature on the nonexistence of hidden variables but such results usually work with more restrictive notions of hidden variables a discussion of these results can be found in landsman 2017 for introductions to lie groups and lca groups we recommend folland 2016 more complete treatments of covariance lead to the notion of systems of imprimitivity studied in mackey 1968 for in depth discussions of covariance and the way it pins down observables we recommend parthasarathy 2005 varadarajan 1985 a discus sion from the physicist point of view is given in busch et al 1995 theorem 15 38 is a special case of a generalisation of stone s theorem theorem 13 46 for arbitrary strongly continuous unitary representations of g see theorem 4 5 in folland 2016 the presentation of the stone von neumann theorem follows folland 1989 and hall 2013 the theorem admits a generalisation to lca groups essentially due to mackey for modern references to the literature on this subject the reader is referred to the survey article rosenberg 2004 the formula for the ornstein uhlenbeck semi group in theorem 15 55 goes back at least to unterberger 1979 in its present form it is taken from van neerven and portal 2018 treatments of second quantisation can be found in janson 1997 parthasarathy 688 notes 1992 simon 1974 for a discussion from the physics perspective we recommend talagrand 2022 the proof of theorem 15 69 is taken from simon 1974 theorems 15 70 and 15 71 are due to segal 1956 our discussion of the position and momen tum operators follows parthasarathy 1992 except that we use different normalisations designed to arrive at the physicist s identities 15 44 and 15 45 for the quantum har monic oscillator proposition 15 74 can be found in the notes to chapter 1 of nualart 2006 as mentioned in the text most results in section 15 6 generalise to infinite di mensions if one replaces the gaussian measure on rd by a so called h isonormal process defined on a probability space p where h is a real hilbert space taking the role of rd the resulting theory has deep connections with the theory of stochastic integration see for example nualart 2006 let us finish with describing an interesting connection with number theory roughly speaking it says that spectrally the positive integers are precisely the second quantised primes the starting point to make this into a rigorous statement one is a theorem of brown and pearcy 1966 that if t is a bounded operator on a hilbert space h then the spectrum of its n fold tensor product t n acting on the hilbert space h n equals t n 1 n j t j 1 n if t 1 by taking direct sums one arrives at the formula n n t n n n 1 n j t for 16 j 6 n n 1 with contribution 1 for the spectrum of t 0 i now let p 2 3 5 7 11 be the set of primes and consider the hilbert space 2 p denoting the standard unit basis vectors of this space by e 2 e 3 e 5 we consider the contraction t ep 7 1 p ep p p then t 12 t 1 p p p 0 and accordingly n n t n 1 n n n n 1 0 with each point 1 n being a simple pole thanks to the uniqueness of prime factorisation this observation which extends to the symmetric second quantisation of t as well as deeper connections can be found in bost and connes 1995 connes 1994 notes 689 appendices most of the material is standard some proofs are taken from folland 1999 kallenberg 2002 ryan 2002 zorn s lemma is equivalent with the axiom of choice a proof of this fact and further equivalences can be found in jech 1973 2003 rubin and rubin 1970 the proof of tychonov s theorem follows ruzhansky and turunen 2010 the treatment of carathe odory s treatment is based on lecture notes by mark veraar credits all pictures are in the public domain references adams r a and fournier j j f 2003 sobolev spaces 2 nd edn pure and applied mathematics amsterdam vol 140 elsevier academic press amsterdam 678 679 akhiezer n i and glazman i m 1981 a theory of linear operators in hilbert space vol i monographs and studies in mathematics vol 9 pitman boston mass london 678 akhiezer n i and glazman i m 1981 b theory of linear operators in hilbert space vol ii monographs and studies in mathematics vol 10 pitman boston mass london 686 albiac f and kalton n j 2006 topics in banach space theory graduate texts in mathematics vol 233 new york springer 671 673 675 aliprantis c d and burkinshaw o 1985 positive operators pure and applied mathematics vol 119 academic press inc orlando fl 671 673 allan g r and ransford t j 1989 power dominated elements in a banach algebra studia math 94 1 63 79 675 amann h 1995 linear and quasilinear parabolic problems vol i abstract linear theory monographs in mathematics vol 89 birkha user boston inc boston ma 681 amemiya i and araki h 1966 1967 a remark on piron s paper publ res inst math sci ser a 2 423 427 685 applebaum d 2019 semigroups of linear operators london mathematical society student texts vol 93 cambridge university press cambridge 681 arendt w 1995 spectrum and growth of positive semigroups pages 21 28 of evolution equations baton rouge la 1992 lecture notes in pure and appl math vol 168 dekker new york 683 arendt w 2004 semigroups and evolution equations functional calculus regularity and kernel estimates pages 1 85 of evolutionary equations vol i handb differ equ north holland amsterdam 679 681 arendt w 2006 heat kernels lecture notes of the 9 th internet seminar 2005 06 available at www uni ulm de mawi iaa members arendt 679 681 682 684 arendt w and urban k 2010 partielle differentialgleichungen eine einfu hrung in analytis che und numerische methoden spektrum 678 679 arendt w batty c j k hieber m and neubrander f 2011 vector valued laplace transforms and cauchy problems 2 nd edn monographs in mathematics vol 96 birkha user springer basel ag basel 681 683 arveson w 2002 a short course on spectral theory graduate texts in mathematics vol 209 springer verlag new york 675 676 677 691 692 references atkinson k and han w 2009 theoretical numerical analysis a functional analysis frame work 3 rd edn texts in applied mathematics vol 39 springer dordrecht 679 attal s 2013 tensor products and partial traces lecture notes available at math univ lyon 1 fr attal 684 aupetit b 1991 a primer on spectral theory universitext springer verlag new york 675 auscher p hofmann s lacey m mcintosh a and tchamitchian ph 2002 the solution of the kato square root problem for second order elliptic operators on rn ann of math 2 156 2 633 654 684 axelsson a keith s and mcintosh a 2006 quadratic estimates and functional calculi of perturbed dirac operators invent math 163 3 455 497 684 baghi b 2006 on nyman beurling and baez duarte s hilbert space reformulation of the riemann hypothesis proc indian acad sci math sci 116 137 146 673 bargmann v 1954 on unitary ray representations of continuous groups ann of math 2 59 1 46 687 beauzamy b 1988 introduction to operator theory and invariant subspaces north holland mathematical library north holland 673 beckner w 1975 inequalities in fourier analysis ann of math 2 102 1 159 182 674 bell j s 1966 on the problem of hidden variables in quantum mechanics rev modern phys 38 447 452 687 berberian s k 1966 notes on spectral theory van nostrand mathematical studies no 5 d van nostrand co inc princeton nj toronto ont london 2 nd edition by the author available at web ma utexas edu mp arc c 09 09 32 pdf 686 biegert m and warma m 2006 regularity in capacity and the dirichlet laplacian potential anal 25 3 289 305 678 birman m sh 1989 a proof of the fredholm trace formula as an application of a simple embedding for kernels integral operators of trace class in l 2 rm report lit matk r 89 30 department of mathematics linko pign university 684 birman m sh and solomjak m z 1987 spectral theory of selfadjoint operators in hilbert space mathematics and its applications soviet series d reidel publishing co dor drecht 678 blackadar b 2006 operator algebras encyclopaedia of mathematical sciences vol 122 springer verlag berlin theory of c algebras and von neumann algebras operator alge bras and non commutative geometry iii 686 bleecker d d and boo bavnbek b 2013 index theory with applications to mathematics and physics international press somerville ma 675 bogachev v i 2007 a measure theory vol i springer verlag berlin 673 bogachev v i 2007 b measure theory vol ii springer verlag berlin 671 bost j b and connes a 1995 hecke algebras type iii factors and phase transitions with spontaneous symmetry breaking in number theory selecta math n s 1 3 411 457 688 bo ttcher a and silbermann b 2006 analysis of toeplitz operators 2 nd edn springer mono graphs in mathematics springer verlag berlin 675 bratteli o and robinson d w 1987 operator algebras and quantum statistical mechanics 1 2 nd edn texts and monographs in physics springer verlag new york 686 brenner s c and scott l r 2008 the mathematical theory of finite element methods 3 rd edn texts in applied mathematics vol 15 springer new york 679 references 693 bressan a 2013 lecture notes on functional analysis graduate studies in mathematics vol 143 amer math soc providence ri 671 678 brezis h 2011 functional analysis sobolev spaces and partial differential equations univer sitext springer new york 671 678 679 brislawn c 1988 kernels of trace class operators proc amer math soc 104 4 1181 1190 684 brown a and pearcy c 1966 spectra of tensor products of operators proc amer math soc 17 162 166 688 busch p grabowski m and lahti p j 1995 operational quantum physics lecture notes in physics new series m monographs vol 31 springer verlag berlin 686 687 buskes g 1993 the hahn banach theorem surveyed dissertationes math 327 49 673 carleman t 1916 u ber die fourierkoeffizienten einer stetigen funktion acta math 41 1 377 384 684 cartier p 1989 a course on determinants pages 443 557 of conformal invariance and string theory poiana bras ov 1987 perspect phys academic press boston ma 684 cle ment ph and li s 1993 94 abstract parabolic quasilinear equations and application to a groundwater flow problem adv math sci appl 3 special issue 17 32 682 coburn l a 1966 weyl s theorem for nonnormal operators michigan math j 13 285 288 675 coburn l a 1967 the c algebra generated by an isometry bull amer math soc 73 722 726 675 connes a 1994 noncommutative geometry academic press inc san diego ca 688 conway j b 1990 a course in functional analysis 2 nd edn graduate texts in mathematics vol 96 springer verlag new york 671 673 davies e b 1976 quantum theory of open systems academic press london new york 686 davies e b 1980 one parameter semigroups london mathematical society monographs vol 15 academic press inc london new york 677 681 de simon l 1964 un applicazione della teoria degli integrali singolari allo studio delle equa zioni differenziali lineari astratte del primo ordine rend sem mat univ padova 34 205 223 681 diestel j 1984 sequences and series in banach spaces graduate texts in mathematics vol 92 springer verlag new york 671 diestel j and uhl jr j j 1977 vector measures providence ri amer math soc 671 674 dieudonne j 1981 history of functional analysis north holland mathematics studies vol 49 north holland publishing co amsterdam new york 671 douglas r g 1998 banach algebra techniques in operator theory 2 nd edn graduate texts in mathematics vol 179 springer verlag new york 675 van dulst d 1989 characterizations of banach spaces not containing 1 cwi tract vol 59 amsterdam cwi 674 dunford n and schwartz j t 1988 a linear operators part i general theory wiley classics library john wiley sons inc new york reprint of the 1958 original 671 dunford n and schwartz j t 1988 b linear operators part ii spectral theory selfadjoint operators in hilbert space wiley classics library john wiley sons inc new york reprint of the 1963 original 675 678 684 duoandikoetxea j 2001 fourier analysis graduate studies in mathematics vol 29 amer math soc providence ri translated and revised from the 1995 spanish original 674 694 references edmunds d e and evans w d 2018 a elliptic differential operators and spectral analysis springer monographs in mathematics springer cham 679 edmunds d e and evans w d 2018 b spectral theory and differential operators 2 nd edn oxford mathematical monographs oxford university press oxford 678 679 einsiedler m and ward th 2017 functional analysis spectral theory and applications grad uate texts in mathematics vol 276 springer cham 671 engel k j and nagel r 2000 one parameter semigroups for linear evolution equations graduate texts in mathematics vol 194 new york springer verlag 681 epperson j b 1989 the hypercontractive approach to exactly bounding an operator with com plex gaussian kernel j funct anal 87 1 1 30 682 evans l c 2010 partial differential equations 2 nd edn graduate studies in mathematics vol 19 amer math soc providence ri 678 679 filonov n 2005 on an inequality between dirichlet and neumann eigenvalues for the laplace operator st petersburg math j 16 2 413 416 680 foguel s r 1958 on a theorem by a e taylor proc amer math soc 9 325 673 folland g b 1989 harmonic analysis in phase space annals of mathematics studies vol 122 princeton university press princeton nj 687 folland g b 1999 real analysis 2 nd edn pure and applied mathematics new york new york john wiley sons inc 673 689 folland g b 2016 a course in abstract harmonic analysis 2 nd edn textbooks in mathematics crc press boca raton fl 676 687 fremlin d h 2015 measure theory vol 5 set theoretic measure theory part i torres fremlin colchester corrected reprint of the 2008 original 672 friedlander l 1991 some inequalities between dirichlet and neumann eigenvalues arch ration mech anal 116 2 153 160 680 funano k 2022 a note on domain monotonicity for the neumann eigenvalues of the laplacian arxiv 2202 03598 680 garrison j c and wong j 1970 canonically conjugate pairs uncertainty relations and phase operators j mathematical phys 11 2242 2249 686 gelfand i m 1941 zur theorie der charaktere der abelschen topologischen gruppen mat sbornik n s 51 49 50 675 gilbarg d and trudinger n s 2001 elliptic partial differential equations of second order classics in mathematics springer verlag berlin reprint of the 1998 edition 679 gohberg i and goldberg s 1981 basic operator theory birkha user boston mass 684 gohberg i goldberg s and kaashoek m 2003 basic classes of linear operators birkha user 673 gohberg i goldberg s and kaashoek m a 2013 classes of linear operators operator theory advances and applications vol 63 birkha user 673 gordon c webb d l and wolpert s 1992 one cannot hear the shape of a drum bull amer math soc n s 27 1 134 138 679 grafakos l 2008 classical fourier analysis 2 nd edn graduate texts in mathematics vol 249 new york springer 673 674 grebenkov d s and nguyen b t 2013 geometrical structure of laplacian eigenfunctions siam review 55 4 601 667 679 grieser d 2007 u ber eigenwerte integrale und 2 6 die idee der spurformel math semester ber 54 2 199 217 684 references 695 gustafson k e and rao d k m 1997 numerical range universitext springer verlag new york 677 haase m h a 2007 convexity inequalities for positive operators positivity 11 1 57 68 671 haase m h a 2018 functional calculus lecture notes of the 21 st internet seminar available at www math uni kiel de isem 21 677 hall b c 2013 quantum theory for mathematicians graduate texts in mathematics vol 267 springer new york 685 687 han d larson d r liu b and liu r 2014 operator valued measures dilations and the theory of frames mem amer math soc 229 1075 686 hanche olsen h holden h and malinnikova e 2019 an improvement of the kolmogorov riesz compactness theorem expositiones math 37 1 84 91 671 helton j w and howe r e 1973 integral operators commutators traces index and homol ogy pages 141 209 lecture notes in math vol 345 of proceedings of a conference operator theory dalhousie univ halifax n s 1973 684 henrot a 2006 extremum problems for eigenvalues of elliptic operators frontiers in mathe matics birkha user verlag basel 679 heunen c and kornell a 2022 axioms for the category of hilbert spaces proceedings of the national academy of sciences 119 9 e 2117024119 685 heuser h 2006 funktionalanalysis 4 th edn mathematische leitfa den b g teubner stuttgart 677 higson n 2004 the local index formula in noncommutative geometry pages 443 536 of contemporary developments in algebraic k theory ictp lect notes xv abdus salam int cent theoret phys trieste 679 hille e and phillips r s 1957 functional analysis and semi groups amer math soc colloq publ vol 31 providence ri amer math soc rev ed 681 holevo a 2011 probabilistic and statistical aspects of quantum theory 2 nd edn quaderni monographs vol 1 edizioni della normale pisa 686 687 holland jr s s 1995 orthomodularity in infinite dimensions a theorem of m sole r bull amer math soc n s 32 2 205 234 685 hundertmark d machinek l meyries m and schnaubelt r 2013 operator semigroups and dispersive equations lecture notes of the 16 th internet seminar 2012 13 available at isem math kit edu 683 hyto nen t p van neerven j m a m veraar m c and weis l w 2016 analysis in banach spaces vol i martingales and littlewood paley theory ergebnisse der mathematik und ihrer grenzgebiete 3 folge vol 63 springer cham 671 672 673 674 678 hyto nen t p van neerven j m a m veraar m c and weis l w 2017 analysis in banach spaces vol ii probabilistic methods and operator theory ergebnisse der mathematik und ihrer grenzgebiete 3 folge vol 67 springer cham 681 hyto nen t p van neerven j m a m veraar m c and weis l w 2022 analysis in banach spaces vol iii harmonic analysis and operator theory in preparation 674 681 hyto nen t p van neerven j m a m veraar m c and weis l w 2023 analysis in banach spaces vol iv stochastic analysis in preparation 682 janson s 1997 gaussian hilbert spaces cambridge tracts in mathematics vol 129 cam bridge cambridge university press 682 687 jech th j 1973 the axiom of choice north holland amsterdam london studies in logic and the foundations of mathematics vol 75 689 696 references jech th j 2003 set theory springer monographs in mathematics springer verlag berlin third edition 689 jorgensen p 1982 spectral theory for infinitesimal generators of one parameter groups of isome tries the min max principle and compact perturbations j math anal appl 90 343 370 681 jost j 2013 partial differential equations 3 rd edn graduate texts in mathematics vol 214 springer new york 678 kac m 1966 can one hear the shape of a drum amer math monthly 73 4 part ii 1 23 679 kallenberg o 2002 foundations of modern probability 2 nd edn probability and its applica tions new york springer verlag new york 689 kato t 1961 fractional powers of dissipative operators j math soc japan 13 246 274 684 kato t 1995 perturbation theory for linear operators classics in mathematics springer verlag berlin reprint of the 1980 edition 678 679 koelink h t 1996 8 lectures on quantum groups and q special functions arxiv q alg 9608018 677 krylov n v 2008 lectures on elliptic and parabolic equations in sobolev spaces graduate studies in mathematics vol 96 amer math soc providence ri 678 679 landsman n p 1998 mathematical topics between classical and quantum mechanics springer monographs in mathematics springer verlag new york 685 686 landsman n p 2017 foundations of quantum theory fundamental theories of physics vol 188 springer cham 685 686 687 landsman n p 2019 quantum theory and functional analysis arxiv 1911 06630 685 lax p d 2002 functional analysis wiley 671 levine h a and weinberger h f 1986 inequalities between dirichlet and neumann eigen values arch ration mech anal 94 3 193 208 680 li c k 1994 c numerical ranges and c numerical radii linear and multilinear algebra 37 1 3 51 82 677 li d and queffe lec h 2004 introduction a l e tude des espaces de banach cours spe cialise s vol 12 socie te mathe matique de france paris 671 lindenstrauss j and tzafriri l 1971 on the complemented subspaces problem israel j math 9 263 269 672 lunardi a 1995 analytic semigroups and optimal regularity in parabolic problems progress in nonlinear differential equations and their applications vol 16 birkha user basel 681 luxemburg w a j and zaanen a c 1971 riesz spaces north holland 671 maas j and van neerven j m a m 2009 boundedness of riesz transforms for elliptic operators on abstract wiener spaces j funct anal 257 8 2410 2475 682 mackey g w 1968 induced representations of groups and quantum mechanics w a ben jamin inc new york amsterdam boringhieri turin 685 687 mcintosh a 1982 on representing closed accretive sesquilinear forms as a 1 2 u a 1 2 v pages 252 267 of nonlinear partial differential equations and their applications colle ge de france seminar vol iii paris 1980 1981 res notes in math vol 70 pitman boston mass london 684 mercer j 1909 functions of positive and negative type and their connection to the theory of integral equations phil trans royal soc london series a 209 441 458 415 446 684 metafune g pru ss j rhandi a and schnaubelt r 2002 the domain of the ornstein uhlenbeck operator on an lp space with invariant measure ann scuola norm sci 1 2 471 485 682 references 697 meyer nieberg p 1991 banach lattices universitext berlin springer verlag 671 monna a f 1973 functional analysis in historical perspective john wiley sons new york toronto ont 671 mu ller v 2007 spectral theory of linear operators and spectral systems in banach algebras 2 nd edn operator theory advances and applications vol 139 birkha user basel 675 murphy g j 1994 fredholm index theory and the trace proc roy irish acad sect a 94 2 161 166 684 musia k 2002 pettis integral pages 531 586 of handbook of measure theory vol i ii amsterdam north holland 674 van neerven j m a m 1997 elementary operator theoretic proof of wiener s tauberian theorem rendic istit matem univ trieste suppl vol xxviii 281 286 681 van neerven j m a m and portal p 2018 the weyl calculus with respect to the gaus sian measure and restricted lp lq boundedness of the ornstein uhlenbeck semigroup in complex time bull soc math france 146 4 691 712 683 687 van neerven j m a m veraar m c and weis l w 2015 stochastic integration in banach spaces a survey in stochastic analysis a series of lectures progress in probability vol 68 birkha user verlag 672 nikolski n k 2002 operators functions and systems an easy reading vol 1 mathematical surveys and monographs vol 92 amer math soc providence ri 673 675 nualart d 2006 the malliavin calculus and related topics 2 nd edn probability and its appli cations new york springer verlag berlin 682 688 osgood w f 1903 a jordan curve of positive area trans amer math soc 4 1 107 112 679 ouhabaz e m 2005 analysis of heat equations on domains london mathematical society monographs series vol 31 princeton university press princeton nj 679 parthasarathy k r 1992 an introduction to quantum stochastic calculus modern birkha user classics birkha user springer basel ag basel 2012 reprint of the 1992 original 687 688 parthasarathy k r 2005 mathematical foundations of quantum mechanics texts and readings in mathematics vol 35 new delhi hindustan book agency 685 686 687 paulsen v 2002 completely bounded maps and operator algebras cambridge studies in advanced mathematics vol 78 cambridge university press cambridge 686 pazy a 1983 semigroups of linear operators and applications to partial differential equations applied math sciences vol 44 new york springer verlag 681 pedersen g k 2018 c algebras and their automorphism groups pure and applied mathe matics amsterdam academic press london 677 686 pettis b j 1938 on integration in vector spaces trans amer math soc 44 2 277 304 674 phelps r r 1960 uniqueness of hahn banach extensions and unique best approximation trans amer math soc 95 238 255 673 phillips r s 1955 the adjoint semi group pac j math 5 269 283 681 pietsch a 2007 history of banach spaces and linear operators boston ma birkha user boston inc 671 673 piron c 1964 axiomatique quantique helv phys acta 37 439 468 685 pisier g 2016 martingales in banach spaces cambridge studies in advanced mathematics vol 155 cambridge university press 672 reed m and simon b 1975 methods of modern mathematical physics vol ii fourier anal ysis self adjointness new york academic press 678 698 references rosenberg j 2004 a selective history of the stone von neumann theorem pages 331 353 of operator algebras quantization and noncommutative geometry contemp math vol 365 amer math soc providence ri 687 rubin h and rubin j e 1970 equivalents of the axiom of choice studies in logic and the foundations of mathematics north holland publishing co amsterdam london 689 rudin w 1987 real and complex analysis 3 rd edn mcgraw hill book co new york 672 675 677 rudin w 1991 functional analysis 2 nd edn international series in pure and applied mathe matics mcgraw hill inc new york 671 673 676 677 678 685 ruzhansky m and turunen v 2010 pseudo differential operators and symmetries pseudo differential operators theory and applications vol 2 birkha user verlag basel 689 ryan r a 2002 introduction to tensor products of banach spaces springer monographs in mathematics springer verlag london ltd london 675 689 safarov yu and vassilev d 1997 the asymptotic distribution of eigenvalues of partial dif ferential operators transl math monogr vol 155 amer math soc providence ri 680 schaefer h h 1974 banach lattices and positive operators grundlehren der mathematischen wissenschaften vol 215 new york springer verlag 671 schechter m 2002 principles of functional analysis 2 nd edn graduate studies in mathematics vol 36 amer math soc providence ri 671 675 schmu dgen k 2012 unbounded self adjoint operators on hilbert space graduate texts in mathematics vol 265 springer dordrecht 678 seeley r t 1964 extension of c functions defined in a half space proc amer math soc 15 625 626 678 segal i e 1956 tensor algebras over hilbert spaces i trans amer math soc 81 106 134 688 simon b 1974 the p 2 euclidean quantum field theory princeton series in physics princeton university press princeton nj 688 simon b 1977 notes on infinite determinants of hilbert space operators adv math 24 3 244 273 684 simon b 2005 trace ideals and their applications 2 nd edn mathematical surveys and mono graphs vol 120 american mathematical soc 684 sobczyk a 1941 projection of the space m on its subspace c 0 bull amer math soc 47 938 947 673 sole r m p 1995 characterization of hilbert spaces by orthomodular spaces comm algebra 23 1 219 243 685 stein e m 1970 singular integrals and differentiability properties of functions princeton mathematical series no 30 princeton university press princeton nj 671 674 stein e m 1993 harmonic analysis real variable methods orthogonality and oscillatory integrals princeton university press 674 stein e m and shakarchi r 2011 functional analysis princeton university press princeton nj volume 4 of princeton lectures in analysis 683 sternberg s 1994 group theory and physics cambridge university press cambridge 687 stinespring w f 1955 positive functions on c algebras proc amer math soc 6 211 216 686 references 699 sz nagy b 1967 spektraldarstellung linearer transformationen des hilbertschen raumes ergebnisse der mathematik und ihrer grenzgebiete band 39 springer verlag berlin new york 678 takesaki m 2002 theory of operator algebras i encyclopaedia of mathematical sciences vol 124 springer verlag berlin reprint of the first 1979 edition operator algebras and non commutative geometry 5 686 takhtajan l a 2008 quantum mechanics for mathematicians graduate studies in mathemat ics vol 95 amer math soc providence ri 685 talagrand m 1984 pettis integral and measure theory mem amer math soc 51 307 674 talagrand m 2022 what is a quantum field theory cambridge university press 688 tanabe h 1979 equations of evolution monographs and studies in mathematics vol 6 pitman boston mass london 681 taylor a e 1939 the extension of linear functionals duke math j 5 538 547 673 terziog lu t 1971 a characterization of compact linear mappings arch math basel 22 76 78 675 unterberger a 1979 oscillateur harmonique et ope rateurs pseudo diffe rentiels ann inst fourier grenoble 29 3 xi 201 221 687 varadarajan v s 1985 geometry of quantum theory 2 nd edn new york springer verlag 687 von neumann j 1968 mathematische grundlagen der quantenmechanik grundlehren der mathematischen wissenschaften vol 38 springer verlag berlin new york reprint of the first edition 1932 685 werner d 2000 funktionalanalysis 3 rd edn springer verlag berlin 671 whitley r 1968 the spectral theorem for a normal operator amer math monthly 75 856 861 677 woit p 2017 quantum theory groups and representations springer cham an introduction 687 yosida k 1980 functional analysis 6 th edn grundlehren der mathematischen wissenschaften vol 123 springer verlag berlin new york 671 zaanen a c 1997 introduction to operator theory in riesz spaces springer verlag berlin 671 index 1 a xi 2 s 650 a b 38 a b 38 a d 84 571 ab b 351 a b 315 a 2 c 110 a 2 d 110 a 93 134 a 134 b x r 637 bx 3 bb 287 bx 3 b x r 637 bmo rd 85 xi c 0 33 co f 21 co f 21 c 0 t kd 42 c k 35 c k x 77 c d 348 c d 348 ck d 348 ck d 77 c 0 x 118 cb x 36 c c d 348 ckc d 348 ckc d 348 dir 413 neum 414 d a xi i j 98 358 x 505 348 j 348 d xi e h 562 e 37 h 599 f x 25 f 180 f 180 t 608 n v 625 g h 250 283 104 487 g t 176 h 218 h 2 d 244 hn 599 h 554 hk d 372 hs rd 370 h 10 d 372 h 1 h 2 94 h 1 av d 379 hd 589 id 290 imz xi jn 603 kh 600 n kd 605 k x y 228 k xi kd n 605 n v 625 701 702 index l x 11 l x y 11 l 1 h 517 l 2 h 509 33 p 34 p s 83 l 1 0 t x 447 l 1 loc d 348 l 1 loc r d 60 l p 290 lp 48 lp x 82 lp x 82 lip 0 1 85 66 m f 61 m 63 m 1 564 n a xi nbv 0 1 84 n xi p 605 p h 545 pfin h 546 p 625 p 37 r t 210 rez xi r a xi t 209 r a 320 rd 364 s xi 455 s h 550 s xi t 210 c 647 p t 210 s t 625 t 271 t 138 t 141 t xi ug 581 v w 624 v a n 625 v s n 625 v 581 w k p d 359 w 1 p 0 d 361 x xi x y 87 371 x 12 x 0 x 1 6 z xi absolutely continuous function 84 continuous measure 68 convergent 3 accretive form 400 maximal 464 operator 464 accretive form 385 adjoint of a bounded hilbert space operator 141 of a bounded operator 138 of a densely defined hilbert space operator 319 of a densely defined operator 316 semigroup 501 admissible contour 218 affine 546 algebra c 303 676 banach 675 von neumann 303 algebraic basis 113 multiplicity 233 tensor product 624 analytic c 0 semigroup 455 bounded 456 angle 587 angular momentum 587 annihilation operator 612 annihilator 134 pre 134 antisymmetric tensor product 625 antiunitary 577 approximate eigensequence 215 eigenvalue 215 arveson spectrum 438 atomic 144 544 axiom of choice 621 of determinacy 672 ball closed 638 index 703 open 637 banach algebra 675 lattice 75 limit 168 space 3 basis algebraic 113 orthonormal 98 schauder 202 bernstein polynomials 36 bessel potential space 370 bicommutant 302 bit 558 bloch sphere 558 vector 558 bochner integrable 27 integral 27 boost 581 borel algebra 648 measurable 661 662 664 measure 649 topology 638 boson 598 boundary conditions dirichlet 372 neumann 378 bounded analytic c 0 semigroup 456 form 385 mean oscillation 85 operator 10 pointwise 40 totally 643 uniformly 14 variation 84 weakly 174 c algebra 303 676 c 0 group 436 c 0 semigroup 428 adjoint 501 analytic 455 analytic contraction 456 bounded analytic 456 compact 444 uniformly exponentially stable 504 weakly continuous 435 ck boundary 365 caldero n zygmund theory 674 calkin algebra 240 cartesian product 634 cauchy problem abstract 428 inhomogeneous 447 semilinear 450 cauchy sequence 640 chain rule 360 chaos gaussian 599 character 581 closable operator 315 closed ball 638 convex hull 21 linear operator 176 312 set 627 638 subspace 5 closure xi 627 638 of a closable operator 315 of a form 410 cocycle identity 579 codimension 132 coercive form 385 400 commutant 302 commutation of selfadjoint operators 308 commutation relation heisenberg 584 weyl 581 commutator 534 compact 629 operator 227 relatively 629 sequentially 643 weak 153 compactness and extreme points 145 in c k 40 in lp 58 of the closed convex hull 21 weak 155 weak 153 complement xi complementarity 583 complemented 132 complete 640 completely positive 686 completion 704 index of a banach space 4 of a hilbert space 92 of a metric space 641 complex conjugate xi conditional expectation 111 conjugate dual 403 conjugate exponents 50 conjugate linear 87 connected 359 conserved 580 continuous 628 at a point 628 embedding 402 form 401 sequentially 642 uniformly 642 contraction 14 as a convex combination of unitaries 520 dilation to a unitary 276 represented by a povm 571 von neumann theorem 299 convergence strong of operators 14 uniform of operators 14 weak of operators 14 convergent 2 638 convex function 50 hull 21 set 93 convolution multiplicative 81 twisted 592 core 431 covariant 580 cover open 629 creation operator 612 decomposition hahn 67 jordan 67 orthogonal 94 wold 280 decomposition property of a vector lattice 126 defect operator 275 dense 627 densely defined 311 density argument 12 operator 552 derivative weak 351 diagonal argument 96 dilation 192 of a bounded operator 280 unitary 276 direct sum orthogonal 94 dirichlet boundary conditions 372 kernel 203 laplacian 413 problem 395 dirichlet to neumann operator 680 disc algebra 571 disjoint projections 546 dispersive 683 distance function 637 distribution 661 domain of a form 400 of a linear operator 311 doubly submarkovian 481 dual conjugate 403 of a normed space 12 pontryagin 581 duality 115 trace 521 dyadic 631 dynkin system 649 effect 563 eigensequence approximate 215 eigenspace 232 eigenvalue 210 approximate 215 eigenvector 210 elementary observable 555 elliptic problem 384 embedding continuous 402 energy ground state 492 energy functional associated with a coercive form 425 for the dirichlet problem 395 for the elliptic problem 384 for the poisson problem 377 383 for the wave equation 497 index 705 entangled state 560 equation schro dinger 492 schro dinger abstract 579 wave 494 equicontinuous 40 equivalent norm 18 essential range 225 range p 338 supremum 47 essentially bounded 47 selfadjoint 323 euclidean norm 7 euler s identity n 1 1 n 2 2 6 102 538 exact sequence 250 existence and uniqueness of solutions under a lipschitz assumption 42 existence of solutions under a continuity assumption 44 expected value 37 of an observable 556 extension friedrichs 410 of a functional 128 of a linear operator 315 operator 368 extension vector valued 82 672 exterior product 527 625 extreme point 144 field 685 face 145 feje r kernel 101 fermion 598 finite element method 396 finite intersection property 629 finite rank operator 228 finitely additive 563 first quantisation 598 fixed point 42 argument 43 form 385 400 accretive 385 400 bounded 385 closed 401 407 coercive 385 400 continuous 401 hermitian 685 sectorial 466 formula macmahon 528 stone 308 fourier coefficient 101 multiplier 188 series 102 transform 180 transform of a measure 186 fourier plancherel transform 185 fredholm alternative 235 alternative for integral equations 237 determinant 528 friedrichs extension 410 functional 12 normal 550 positive hilbertian 550 functional calculus bounded 287 continuous 266 268 entire 217 holomorphic 218 measurable 328 gaussian chaos 599 measure standard 104 487 gelfand triple 403 generator 428 geometric multiplicity 233 gradient 358 gram schmidt orthogonalisation 99 graph norm 312 of a bounded operator 176 of a linear operator 312 green function 374 ground state energy 492 group free schro dinger 492 heisenberg 589 schro dinger 492 translation 476 unitary 474 wave on rd 495 wave on domains 494 haar measure 580 property 165 hahn decomposition 67 hardy space 244 hardy littlewood maximal function 61 706 index harmonic 206 heat equation linear 477 equation positivity 480 equation semilinear 454 kernel 477 semigroup on rd 477 semigroup on domains 479 heisenberg commutation relation 584 group 589 hermite operator 491 polynomials 104 hermitian form 685 vector space 685 hidden variables 574 hilbert space 91 characterisation via category theory 685 characterisation via hermitian forms 672 685 hilbert transform 191 lp boundedness 197 and the poisson semigroup 486 characterisation 192 holomorphic x valued function 163 weakly 202 homotopy 246 ideal property of compact operators 228 of hilbert schmidt operators 510 of trace class operators 520 identity parseval 97 image measure 661 imaginary part xi index 238 417 indicator function xi indiscernible 575 inequality bessel 107 cauchy schwarz 88 clarkson 207 ho lder 50 ho lder converse to 52 178 jensen 81 minkowski 47 minkowski continuous 83 poincare 374 poincare wirtinger 381 triangle 2 637 young 55 infinite dimensional 9 infinitesimal generator 428 inner product 87 space 87 integrable 666 bochner 27 uniformly 169 integral bochner 25 27 lebesgue 663 pettis 205 riemann 23 stochastic 114 interior xi 627 638 involution 676 irreducible 589 isometric isomorphism 14 isometry 4 partial 271 spectrum of 214 isomorphism 14 ito isometry 114 jordan decomposition 67 normal form 234 kato square root problem 684 kernel dirichlet 203 feje r 101 heat 477 poisson 483 poisson for the disc 109 ket 554 laguerre polynomials 108 laplace operator dirichlet 413 neumann 414 on rd 412 weak 370 laplace transform 433 inverse 456 of a measure 537 lattice 73 banach 75 normed vector 75 vector 73 law of large numbers 38 lebesgue index 707 measure 655 measure normalised 180 point 63 set 83 leibniz formula 358 lemma ce a 396 cotlar 198 dynkin 649 fatou 666 riemann lebesgue 181 riesz 20 three lines 193 urysohn 631 vitali covering 60 zorn 621 limit 2 638 banach 168 linear operator 311 lipschitz continuous 42 locally compact 118 locally integrable 60 348 lower bound 73 m accretive 464 malliavin calculus 487 599 maximal element 621 maximal regularity for bounded analytic semigroups 468 for the poisson problem on rd 416 measurable 661 borel 661 set 647 strongly 25 weakly 135 measurable space 647 measure 648 k valued 64 finite 649 outer regular 658 atomic 144 544 borel 649 finite 649 inner regular 658 lebesgue 655 outer 650 probability 649 radon 659 radon k valued 118 regular 658 standard gaussian 104 487 measure space 649 mehler kernel 489 metric 637 metric space 637 metrisable 154 minimiser 93 377 383 384 395 426 minkowski functional 143 mixed state 554 modulus xi of an operator 271 mollification 57 momentum operator 324 583 616 multi index 347 multiplication semigroup 475 multiplicity 264 283 algebraic 233 geometric 233 multiplier fourier 188 pointwise 188 negation 545 nemytskii mapping 454 neumann boundary conditions 378 laplacian 414 series 211 norm 2 equivalent 18 euclidean 7 nonequivalent 113 product 6 normal 630 functional 550 operator 256 327 normed space 2 null space xi 13 numerical radius 277 range 277 observable 544 555 elementary 544 555 sharp 555 unsharp 564 open ball 637 cover 629 set 627 638 operator adjoint hilbertian 141 adjoint of a bounded operator 138 adjoint of a densely defined operator 316 708 index angular momentum 619 annihilation 612 antiunitary 577 bounded 10 boundedly invertible 210 closable 315 closed 176 312 compact 227 creation 612 densely defined 311 dirichlet to neumann 680 divergence form 415 doubly submarkovian 481 essentially selfadjoint 323 extension 368 finite rank 228 fourier multiplier 188 fredholm 238 417 hermite 491 hilbert schmidt 507 linear 311 momentum 324 616 normal 256 327 ornstein uhlenbeck 488 position 296 615 positive 322 positive hilbertian 256 positivity preserving 76 quotient 15 selfadjoint 256 323 symmetric 322 toeplitz 245 trace 678 trace class 511 translation invariant on l 1 rd 157 translation invariant on l 2 rd 189 unbounded 312 uniformly elliptic 466 unitary 256 590 volterra 17 order of a multi index 347 ornstein uhlenbeck operator 488 semigroup 487 orthogonal 92 complement 93 decomposition 94 polynomials 305 projection 94 258 orthomodular 685 orthonormal basis 98 system 98 system maximal 100 outer measure 650 parallelogram identity 89 partial isometry 271 order 621 trace 524 partition of unity 632 smooth 350 pauli matrices 559 perturbation 441 pettis integral 205 phase 573 point evaluation 16 spectrum 210 445 pointwise bounded 40 convergence vs norm convergence 202 multiplier 16 188 poisson kernel 2 dimensional 206 kernel d dimensional 483 kernel for the disc 109 problem dirichlet boundary conditions 373 problem inhomogeneous boundary conditions 394 problem neumann boundary conditions 378 semigroup 483 polarisation 256 polynomials bernstein 36 hermite 104 laguerre 108 pontryagin dual 581 position operator 296 583 615 positive cone 75 definite 272 569 functional hilbertian 550 operator 322 operator hilbertian 256 positive definite 532 positivity preserving 76 potential 491 povm 563 power bounded 226 power set 650 index 709 pre annihilator 134 principle of local reflexivity 673 probability space 649 problem abstract cauchy inhomogeneous 447 abstract cauchy linear 428 abstract cauchy semilinear 450 dirichlet 395 elliptic 384 poisson 372 sturm liouville 387 product algebra 648 cartesian 634 measure 657 metric 646 norm 6 rule 358 432 projection 132 orthogonal 94 258 spectral 223 projection valued measure 285 of a bounded normal operator 293 of a normal operator 335 pure state 544 553 quantisation first 598 second 599 quantum harmonic oscillator 491 quasi optimality estimate 396 quaternions 685 quotient banach spaces 5 map 15 operator 15 radon measure 659 range xi 13 real part xi of a form 400 recurrence three point 305 reflexive 154 relation 621 relatively compact 629 representation 272 irreducible 589 projective 588 schro dinger 589 spin 687 unitary 272 resolvent identity 212 320 operator 210 set 209 set of a linear operator 320 riemann hypothesis 673 integral 23 riesz projection 245 ring 651 algebra 647 borel 648 generated by c 647 generated by f 648 scalar homogeneity 2 schauder basis 202 schro dinger equation 492 equation abstract 579 group 492 representation 589 schur property 169 schur estimate 82 second quantisation 599 sector 455 sectorial 466 segal plancherel transform 610 selfadjoint essentially 323 operator 256 323 semigroup heat on rd 477 heat on domains 479 multiplication 475 ornstein uhlenbeck 487 poisson 483 seminorm 129 separable measure space 510 metric space 646 normed space 9 sequence convergent 2 singular value 513 sequentially closed 639 compact 643 continuous 642 sesquilinear 87 sharp observable 555 simple function 662 710 index 26 vector valued 25 singular integrals 674 singular value 512 decomposition for compact operators 283 decomposition for trace class operators 513 sequence 513 sobolev space 359 solution classical of the linear cauchy problem 447 classical of the semilinear cauchy problem 451 global 42 local 44 mild of the inhomogeneous cauchy problem 449 mild of the semilinear cauchy problem 451 strong 448 weak of the elliptic problem 384 weak of the inhomogeneous cauchy problem 503 weak of the poisson problem 373 379 394 spectral inclusion formula 502 mapping theorem for normal operators 338 mapping for compact semigroups 444 mapping the holomorphic calculus 220 projection 223 radius 221 spectral flow 680 spectrum 210 approximate point 215 arveson 438 of a compact operator 232 of a linear operator 320 point 210 445 state 543 552 entangled 560 mixed 554 pure 544 553 spin 559 687 vector 553 stiffness matrix 398 stochastic integral 114 stone s formula 308 strichartz estimate 683 strictly convex 107 165 208 strong convergence of operators 14 strong operator topology 302 strongly measurable 25 sturm liouville problem 387 subadditive mapping 200 subalgebra 216 265 subcover 629 subdifferential 505 sublinear 128 substitution formula 666 substitution rule 361 superposition 554 support 632 of a continuous function 54 supremum norm 35 symbol of a fourier multiplier operator 188 of a toeplitz operator 245 symmetric fock space 608 operator 322 part 400 second quantisation 608 sesquilinear mapping 386 tensor product 605 625 symmetry 579 tensor basis 106 tensor product algebraic 624 antisymmetric 625 of hilbert spaces 524 of vector spaces 624 symmetric 605 625 test function 348 theorem arzela ascoli 40 atkinson 239 baire 172 banach fixed point 42 banach alaoglu 153 beckner 674 bicommutant 302 bolzano weierstrass 645 busch 563 cauchy for banach space valued functions 163 chernoff 226 closed graph 176 closed range 179 coburn 249 continuous functional calculus 266 268 courant fischer 419 datko pazy 504 dieudonne 242 dini 77 dominated convergence 667 euler formula 442 index 711 fedosov 534 fre chet kolmogorov 58 fredholm alternative 235 friedrichs 410 fubini 668 669 fuglede putnam rosenblum 264 gearhart pru ss 504 gelfand naimark 676 goldstine 150 green 378 hahn banach extension for banach spaces 130 hahn banach extension for vector spaces 128 129 hahn banach separation 142 hahn jordan 66 hardy littlewood maximal 61 hartman wintner 248 hausdorff young 197 hellinger toeplitz 277 helton howe 535 hille 345 hille yosida 439 injectivity of the fourier transform 187 inversion of the fourier transform 182 krein milman 145 lp boundedness of the hilbert transform 197 lax milgram 386 lebesgue differentiation 62 lidskii 527 lumer phillips 462 506 lusin 80 marcinkiewicz 200 mercer 532 min max 284 419 monotone convergence 665 naimark 568 noether gohberg krein 246 nyman baez duarte 673 open mapping 175 parseval 97 peano 44 pettis measurability 25 135 phillips 435 picard lindelo f 42 plancherel 185 portmanteau 161 prokhorov 159 radon nikody m 69 112 rellich kondrachov 379 riesz representation for hilbert spaces 95 riesz schauder 232 riesz thorin 192 segal 612 singular value decomposition for compact operators 283 singular value decomposition for trace class operators 513 sobolev embedding 392 spectral mapping for bounded normal operators 269 spectral mapping for normal operators 338 spectral mapping for the holomorphic calculus 220 spectral mapping for the point spectrum 445 spectral radius formula 222 spectral for bounded normal operators 293 spectral for compact normal operators 281 spectral for normal operators 335 stinespring 687 stone 474 500 stone von neumann 590 stone weierstrass 38 sz nagy 276 502 three point recurrence 306 tietze extension 633 toeplitz hausdorff 278 trace duality 522 tychonov 634 uniform boundedness 172 von neumann bicommutant 302 von neumann bicommutant of a selfadjoint operator 304 von neumann on commuting selfadjoint operators 301 von neumann on contractions 299 weierstrass approximation 36 weyl 422 wiener s tauberian 183 wiener ito isometry 606 wigner 578 wintner 618 three point recurrence 305 tight 658 uniformly 158 toeplitz operator 245 topological space 627 hausdorff 628 locally compact 118 normal 630 topology 627 borel 638 generated by a collection of sets 627 712 index strong operator 302 weak 148 weak operator 302 weak 148 totally bounded 643 ordered 621 634 trace class 511 duality 521 of a positive operator 511 of a trace class operator 516 operator 678 partial 524 trace formula and euler s identity 538 and fredholm operators 534 and toeplitz operators 535 for the dirichlet heat semigroup 536 transform fourier 180 fourier of a measure 186 fourier plancherel 185 hilbert 191 segal plancherel 610 transition probability 577 translation 581 adjoint of 139 continuity of in lp 55 invariant operators on l 1 rd 157 wiener s tauberian theorem 183 triangle inequality 2 637 reverse 2 trigonometric polynomial 40 twisted convolution 592 umd property 672 unbounded operator 312 uncertainty of an observable 557 principle 557 uniform convergence of functions 8 of operators 14 uniformly bounded 14 continuous 642 contractive 42 exponentially stable 504 integrable 169 tight 158 unit ball 3 unital 675 unitary dilation 276 operator 256 590 representation 272 unsharp observable 564 upper bound 73 621 vanishing at infinity 118 variance of an observable of a in the state h 557 variation 64 variational method for the poisson problem 377 383 vector lattice 73 normed 75 vector state 553 volterra operator norm of 261 spectrum of 279 von neumann algebra 303 wave equation 494 function 554 group on rd 495 group on domains 494 weak compactness of bx 155 convergence 148 convergence of measures 158 convergence of operators 14 derivative 351 laplacian 370 operator topology 302 topology 148 weak l 1 bound 61 weak compactness of bx 153 continuous functional 148 convergence 148 topology 148 weakly bounded 174 closed 148 continuous functional 148 continuous semigroup 435 holomorphic 202 well posed 450 452 531 weyl commutation relation 581 winding number 218 246 wold decomposition 280 preface notation and conventions 1 banach spaces 2 the classical banach spaces 3 hilbert spaces 4 duality 5 bounded operators 6 spectral theory 7 compact operators 8 bounded operators on hilbert spaces 9 the spectral theorem for bounded normal operators 10 the spectral theorem for unbounded normal operators 11 boundary value problems 12 forms 13 semigroups of linear operators 14 trace class operators 15 states and observables to 1 15 appendix azorn s lemma to 1 15 appendix btensor products to 1 15 appendix ctopological spaces to 1 15 appendix dmetric spaces to 1 15 appendix emeasure spaces to 1 15 appendix fintegration to 1 15 appendix gnotes references index