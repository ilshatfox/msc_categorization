conditional positive definiteness as a bridge between k hyponormality and n contractivity ar x iv 2 01 2 10 96 2 v 2 m at h f a 2 6 ju l 20 21 conditional positive definiteness as a bridge between k hyponormality and n contractivity chafiq benhida ufr de mathe matiques universite des sciences et technologies de lille f 59655 villeneuve d ascq cedex france rau l e curto department of mathematics university of iowa iowa city iowa 52242 1419 usa george r exner department of mathematics bucknell university lewisburg pennsylvania 17837 usa abstract for sequences n n 0 of positive real numbers called weights we study the weighted shift operators w having the property of moment infinite divisi bility mid that is for any p 0 the schur power w p is subnormal we first prove that w is mid if and only if certain infinite matrices logm 0 and logm 1 are conditionally positive definite cpd here is the sequence of moments associated with m 0 m 1 are the canonical hankel matrices whose positive semi definiteness determines the subnormality of w and log is calculated entry wise i e in the sense of schur or hadamard next we use con ditional positive definiteness to establish a new bridge between k hyponormality and n contractivity which sheds significant new light on how the two well known staircases from hyponormality to subnormality interact as a consequence we prove that a contractive weighted shift w is mid if and only if for all p 0 m p 0 and m p 1 are cpd keywords weighted shift subnormal moment infinitely divisible conditionally positive definite completely monotone 2010 mathematics subject classification primary 47 b 20 47 b 37 secondary 44 a 60 email addresses chafiq benhida univ lille fr chafiq benhida raul curto uiowa edu rau l e curto exner bucknell edu george r exner url http www math uiowa edu protect char 126 relax rcurto rau l e curto preprint submitted to elsevier july 27 2021 http arxiv org abs 2012 10962 v 2 contents 1 introduction and statement of main results 2 2 notation and preliminaries 5 2 1 unilateral weighted shifts 5 2 2 agler shifts 6 2 3 mid shifts 6 2 4 k hyponormality 7 2 5 n contractivity 8 2 6 n hypermonotone and n hyperalternating weighted shifts 9 2 7 conditionally positive definite matrices 12 3 a bridge between k hyponormality and n contractivity 15 3 1 a unifying condition 17 3 2 a family of intermediate ladders 19 3 3 cutoffs for rank one perturbations of the agler shifts 20 1 introduction and statement of main results let h denote a separable complex hilbert space and l h be the algebra of bounded linear operators on h recall that an operator t is subnormal if it is the restriction to a closed invariant subspace of a normal operator and hyponormal if t t tt a unilateral weighted shift w acting on the classical sequence space 2 n 0 is called moment infinitely divisible in symbols w mid if all schur powers w p are subnormal thus the class mid consists of all subnormal weighted shifts w with moment sequence such that p is interpolated by a positive borel probability measure p for every p 0 p is the so called berger measure of the subnormal weighted shift w p this is equivalent to the schur infinite divisibility of the two hankel moment matrices m 0 i j i j 0 and m 1 i j 1 i j 0 where is the sequence of moments associated with the weight sequence since all entries in these two matrices are positive and since the matrices are hermitian their infinite divisibility is equivalent to the conditional positive definiteness of their schur logarithms logm 0 and logm 1 as a consequence we can prove that w is mid if and only if both logm 0 and logm 1 are cpd this leads to a new characterization of w mid in terms of the sequence n log n n 2 2 n 1 n 0 2 it is well known that subnormality is a much stronger condition than hyponor mality for a contractive weighted shift w the former requires a berger measure supported in 0 1 that interpolates the latter requires 0 1 2 there are two well known staircases connecting hyponormality and subnormality and they correspond to two well known tests for subnormality the first test involves the bram halmos criterion for subnormality which requires that w be k hyponormal for every k 1 the second test has to do with the agler embry ap proach to subnormality which requires the n contractivity of w for every n 1 in this paper we consider the role of conditional positive definiteness in estab lishing a bridge between the two above mentioned staircases concretely as a first step we will see that k hyponormality implies 2 k contractivity in 20 g r exner i b jung and s s park proved for general operators that k hyponormality implies 2 k contractivity implicit in their work was a significant identity which we use as a point of departure given a moment sequence a positive integer k a nonnegative integer and the k 1 k 1 hankel com pressed moment submatrix m k i j k i j 0 we consider the expression q k v m k v 1 1 where v is the column vector of length k 1 with i th coordinate 1 i k i that is v 1 k 1 k 2 k 3 k k 1 1 observe that k i 0 vi 1 1 k 0 experimental calculations using mathematica 25 easily reveal that 1 1 becomes q k 2 k 1 1 2 k 2 2 2 k 3 3 2 k 2 k 1 2 k 1 2 k 2 k i 0 1 i 2 k i i 1 2 once the proposed form of q k is discovered a proof of 1 2 by induction is straightforward positivity of the expression on the right hand side of 1 2 for all is exactly what we need for 2 k contractivity of w on the other hand 1 1 is one of the expressions used in the determination of cpd for the matrix m k concretely if w is k hyponormal then m k 0 for all 0 then m k is cpd for all 0 and therefore q k 0 for all 0 it follows that 2 k i 0 1 i 2 k i i 0 for all 0 and this means that w is 2 k contractive this is a special case of a more general result involving k 2 m cpd matrices 3 which represents a very useful version of cpd appropriately localized to keep track of the size of the matrix and the initial moment the above calculation is part of a much broader theoretical setting involving properties of sequences such as complete monotonicity and hypercontractivity along with their log analogs e g log complete monotonicity we discuss aspects of this theory in section 3 we are now ready to state the main results of this paper the proofs will be given in section 3 for notation and terminology we refer the reader to section 2 where we also briefly review some topics from unilateral weighted shifts and matrix theory that will be needed for section 3 theorem 1 1 suppose w is a contractive weighted shift then the following statements are equivalent i w is moment infinitely divisible mid ii logm 0 and logm 1 are cpd iii for every p 0 m p 0 and m p 1 are positive definite iv for every p 0 m p 0 and m p 1 are cpd v the moment sequence is log completely monotone vi the weight sequence is log completely alternating proposition 1 2 let w be a unilateral weighted shift k 1 and 0 m k assume that w is k 2 m cpd then w is 2 m contractive 2 m 2 contractive 2 k contractive theorem 1 3 let w be a contractive weighted shift whose weight sequence has a limit for example if w is hyponormal and fix m n assume that for all k m w is k 2 m pd or k 2 m cpd then w is subnormal as a consequence we obtain a result including what we believe is a new suffi cient condition for subnormality proposition 1 4 let w be a weighted shift with moment sequence n n 0 the following statements are equivalent i w is mid ii the sequence n n 0 with n ln n n 2 2 n 1 is a stieltjes moment sequence iii the weighted shift with moments n 0 is subnormal we now focus on rank one perturbations of the agler shifts see subsection 2 2 for the definition our study reveals some remarkable cutoffs for k 2 m positive 4 definiteness and for the related weights squared sequence to be m alternating for the terminology see definition 3 6 and page 9 resp in particular k 0 positive definiteness corresponds to k hyponormality theorem 1 5 let aj x be the perturbation of the agler shift aj in which the zeroth weight j 0 1 j is replaced by j 0 x x j and let k n and m 0 1 k i aj x is k 2 m pd if and only if x p j k m where p j k m k 1 m j k m 1 k 2 jk 2 m jm m 2 j k m k m 2 m j 1 j k m k m 2 m 1 3 ii aj x is k 2 m pd if and only if aj x is j k m k m 2 m contractive proposition 1 6 let aj x be the zeroth weight perturbation of the agler shift aj with weight sequence j as in theorem 1 5 then the weights squared of aj x are m alternating if and only if x 1 j 1 m m i 1 j i 1 4 if we take j 2 which corresponds to the bergman shift the weights squared of a 2 x are m alternating if and only if a 2 x is m 1 m 2 2 contractive 2 notation and preliminaries 2 1 unilateral weighted shifts to set the notation for weighted shifts let n 0 0 1 and let 2 denote the classical hilbert space 2 n 0 with canonical orthonormal basis e 0 e 1 note that we begin indexing at zero let 0 1 be a bounded positive weight sequence and w the weighted shift defined by linearity and w ej jej 1 j 0 weighted shifts can be defined for any bounded sequence however for all questions of interest to us without loss of generality we can assume as we do that is positive when is the constant weight sequence 1 1 the resulting un weighted shift is the classical unilateral shift u ej ej 1 j 0 the moments n n 0 of the shift are defined by 0 1 and n n 1 j 0 2 j for n 1 from 12 iii 8 16 and 21 a weighted shift w is subnormal if and only if it has a berger measure meaning a probability measure supported on 0 w 2 such that n w 2 0 tnd t n 0 1 5 applying the cauchy schwarz inequality in l 2 to the monomials tn 2 and t n 2 2 yields 2 n 1 n n 2 n 0 and hence 2 n 2 n 1 n 0 recall that an operator t is hyponormal if t t tt 0 and one computes easily that for a weighted shift w this is exactly 2 n 2 n 1 for all n 0 the canonical polar decomposition of w is u p where p denotes the diag onal operators with diagonal entries 0 1 the aluthge transform 4 of w is given by at w p u p and this is the weighted shift with weight sequence 0 1 1 2 2 3 it is easy to see that at preserves hyponor mality but whether it preserves subnormality is a nontrivial problem addressed in detail in 19 16 7 8 a sufficient condition for subnormality pointed out in 16 is the subnormality of w 2 2 agler shifts we briefly recall a class of subnormal unilateral weighted shifts with berger measures that can be easily computed the agler shifts aj j 1 2 are those with weight sequence n 1 n j n 0 1 these were used in 2 as part of a model theory for hypercontractions since a 1 is the unilateral shift its berger measure is 1 the dirac point mass at 1 for j 2 the berger measure of aj is d t j 1 1 t j 2 dt on 0 1 the agler shifts appear naturally as the weighted shifts associated with the rows and columns of the weight diagram for the drury arveson 2 variable weighted shift 15 pages 29 30 in 19 g r exner proved that for j 2 3 and p 0 the schur p th power of aj is subnormal as is any m th iterated aluthge transform of aj the proof which uses monotone function theory offers no information about the berger measure of the resulting shift however it brings to the fore the signifi cance of complete monotonicity in the study of mid shifts discussed in the next subsection 2 3 mid shifts it is useful to note in considering mid weighted shifts that raising every weight to the p th power is equivalent to raising every moment to the p th power we refer the reader to 7 8 for an initial study of moment infinite divisibility this paper constitutes a continuation of that study a companion to the class of agler shifts is the class of homographic shifts that is those weighted shifts denoted s a b c d where a b c d 0 and with ad bc with weights an b cn d these shifts were defined and studied in 18 together with certain subshifts of such shifts and their subnormality established observe as well that if we throw away a finite number of terms at the beginning of a completely alternating or log completely alternating sequence what remains is still in the 6 original class therefore some of the results to follow may be generalized easily to restrictions of shifts to the canonical invariant subspaces of finite co dimension lemma 2 1 19 the agler shifts are all mid as are the contractive shifts s a b c d i e a b c d 0 ad bc and a c and their subshifts by definition a weighted shift w is completely hyperexpansive when the inequalities for n contractivity in 2 2 are reversed that is n i 0 1 i n i k i 0 k 0 1 for all n 1 for instance the dirichlet shift is completely hyperexpansive we recall that a completely hyperexpansive weighted shift w gives rise to a subnormal weighted shift by forming a new weight sequence where j 1 j for all j 0 further one cannot necessarily begin with a subnormal shift and by taking reciprocals of the weights generate a completely hyperexpansive shift see the discussion after 5 proposition 6 nevertheless the following result holds lemma 2 2 7 corollary 4 1 let w be a completely hyperexpansive weighted shift with positive weight sequence n n 0 then the weighted shift with weight sequence 1 n n 0 is not only subnormal but is mid using the definition of mid and schur products one may show that if w is mid then so is at w we record this and related results in the following lemma 2 3 i 7 corollary 3 6 if a contractive weighted shift w is mid then so is at w ii 8 theorem 4 13 at maps the class mid bijectively onto itself iii 8 theorem 4 4 suppose that w is a contractive weighted shift whose weights j approach a limit as j then at w is mid if and only if w is 2 4 k hyponormality for the reader s convenience we sketch the k hyponormality approach to sub normality and give a brief version of this background see 14 and 17 for a full discussion and some of the beginnings of this substantial study it is the bram halmos characterization of subnormality see 11 that an operator t is subnormal if and only if for every k 1 2 a certain k 1 k 1 operator matrix an t is positive for k 1 an operator is k hyponormal if this positivity con dition holds for k for weighted shifts it is well known from 13 theorem 4 7 that k hyponormality reduces to the positivity for each n of the k 1 k 1 hankel moment matrix m k where m k n n 1 n k n 1 n 2 n k 1 n k n k 1 n 2 k 2 5 n contractivity another approach to subnormality this time for a contractive operator t that is t 1 is the agler embry characterization based on the notion of n contractivity for n 1 an operator is n contractive if an t n i 0 1 i n i t it i 0 cf 2 2 1 a contractive operator is subnormal if and only if it is n contractive for all positive integers n cf 2 it is well known and follows easily from w iw i being diagonal that for a weighted shift it suffices to test this condition on basis vectors and that a weighed shift is n contractive if and only if n i 0 1 i n i k i 0 k 0 1 2 2 given a sequence a aj j 0 let the forward difference operator be defined by a j aj aj 1 and the iterated forward difference operators n by 0 a a and n n 1 for n 1 for instance 2 a j aj 2 aj 1 aj 2 j 0 2 3 to ease the notation in some settings set for any n 1 and k 0 ta n k na k n i 0 1 i n i ai k 8 where we write simply t n k if no confusion as to the sequence a will arise with a slight abuse of language say that a sequence a is n contractive if ta n k 0 for all k 0 1 there is alternative language for these and related notions a sequence a is n monotone if ta n k na k 0 for all k 0 1 n hypermonotone if it is j monotone for all j 1 n and completely monotone if it is n monotone for all n 1 2 similarly a sequence is n alternating if ta n k na k 0 for all k 0 1 n hyperalternating if it is j alternating for all j 1 n and completely alternating if it is n alternating for all n 1 2 a sequence is n log monotone respectively completely log monotone n log alternating com pletely log alternating if the sequence ln aj is n monotone respectively com pletely monotone n alternating completely alternating notice that we define log monotonicity using n monotonicity so we allow for the sequence to possibly be negative as in the case of ln a where a is the sequence of moments of a contractive weighted shift thus we allow slightly more generality than in the definition given in 9 definition 6 1 2 6 n hypermonotone and n hyperalternating weighted shifts proposition 2 4 suppose n n and ak k 0 is a sequence of real numbers and in addition limk ak exists i if ak k 0 is n monotone it is n hypermonotone ii if ak k 0 is n log monotone it is n log hypermonotone iii if ak k 0 is n alternating it is n hyperalternating iv if ak k 0 is n log alternating it is n log hyperalternating proof we prove only the first assertion as the other proofs are similar if n 1 there is nothing to prove so assume n 1 suppose for a contradiction that ak k 0 is n monotone but not n hypermonotone and let m be the least integer 1 m n such that the sequence is m monotone but not m 1 monotone for each j and k recall that t j k is defined by t j k j i 0 1 i j i ak i the positivity of t j k for all k yields j monotonicity further it is routine that for any j and k t j 1 k t j k t j k 1 2 4 9 suppose k 0 to be the least k such that t m 1 k 0 0 then 0 t m k 0 t m 1 k 0 t m 1 k 0 1 forces t m 1 k 0 1 repeating the argument we have t m 1 k 0 k k 0 2 5 if limk ak l then it is elementary that lim k t m 1 k m 1 i 0 1 i m 1 i l 0 which is a contradiction of 2 5 observe that in light of the dirichlet shift d that is the standard 2 isometry whose moment sequence is therefore 2 monotone but not 1 monotone some as sumption like existence of the limit of the weight sequence is required corollary 2 5 suppose k k 0 is the sequence of moments of a weighted shift if the weighted shift is contractive and k k 0 is n monotone for some n n then k k 0 is n hypermonotone alternatively if the sequence k k 0 is both 1 monotone and n monotone for some n n then the sequence is n hypermonotone proof in either case the sequence k is decreasing and bounded below by zero and so has a limit this transfers to the n log monotone and n log hypermonotone case at least in situations of interest to us corollary 2 6 suppose k k 0 is the sequence of moments of a bounded weighted shift w if w is contractive and its weights have a non zero limit in particular if w is hyponormal then for any n n if k k 0 is n log monotone then it is n log hypermonotone alternatively if the shift is hyponormal or its weights have a non zero limit and if the sequence k k 0 is both 1 log monotone and n log monotone for some n n then the sequence is n log hypermonotone 10 proof one applies the previous corollary to the sequence log k and the only thing to check is that the given conditions yield that the resulting expressions t n k for the sequence of logs actually have limits which is straightforward com bining the terms using rules of logs we leave to the interested reader the appropriate versions of the corollaries for the n alternating and n log alternating case let us record some results on product sequences it is trivial that the schur term wise product of two n log monotone sequences is again n log monotone and in fact the schur term wise product of two n log alternating sequences is again n log alternating the good thing holds for n monotone sequences as well lemma 2 7 suppose ak k 0 and bk k 0 are n hypermonotone sequences then akbk k 0 is n hypermonotone in particular if they are moment sequences arising from a contractive weighted shift and if each is both 1 monotone and n monotone it follows that akbk k 0 is n hypermonotone proof the first claim follows immediately from leibniz s rule of differences if is the usual forward difference operator on sequences then n akbk n j 0 n j n jak j jbk 2 6 since the coefficients are positive and the differences appearing are non negative we have the result the second claim follows because we have shown that in the contractive case n hypermonotonicity and n monotonicity coincide we end this section with an example where the complete alternating property is crucial in the proof of mid example 2 8 7 example 3 5 the weighted shift with weights the sequence n defined by n 1 1 2 1 3 1 n 1 ln n 2 n 0 1 or the shift with weights the square roots of these is mid and subnormal this is because this sequence is completely alternating and it increases to the euler constant 0 577 11 2 7 conditionally positive definite matrices throughout this paper and as is common in the literature the expression positive definite is to be understood as positive semi definite that is a k k matrix a is positive definite in symbols a 0 if a is hermitian and v av 0 for all vectors v ck since we are mainly interested in sequences of real numbers and matrices built from those sequences we will focus our discussion on matrices over r amongst canonical examples of k k positive matrices we mention the gram matrices vv the hilbert matrix 1 i j 1 k i j 1 the pascal matrix i j i k i j 1 the lehmer matrix min i j max i j k i j 1 and the gcd matrix g c d i j k i j 1 these matrices have the added property of remaining positive after taking the p th schur power for all p 0 that is they are infinitely divisible matrices cf 10 remark 2 9 it is easy to see that all positive definite 2 2 matrices are infinitely divisible however the same is not true of 3 3 matrices witness the matrix r a 1 1 a 1 2 1 a 1 1 r a is positive definite for all a 0 1 but detr a 1 2 0 for small positive values of a we briefly pause to give a precise definition of conditional positive definiteness cf 9 p 66 definition 2 10 a hermitian k k complex matrix a aij ki j 0 i e aji aij for all i j 0 k is conditionally positive definite abbreviated cpd whenever c ac k i j 0 aij c icj 0 for all complex vectors c c 0 c 1 ck such that c 0 c 1 ck 0 an infinite scalar matrix is cpd if all of its principal minors of finite size are cpd clearly a positive definite matrix is cpd when k 2 a is cpd if and only if a 11 a 12 a 21 a 22 0 when k 3 a straightforward calculation reveals that a is cpd if and only if the 2 2 matrix a 11 a 12 a 21 a 22 a 12 a 13 a 22 a 23 a 21 a 22 a 31 a 32 a 22 a 23 a 32 a 33 is positive definite a much more general result holds as we will see below first we present two elementary observations 12 remark 2 11 observe that a real hermitian matrix a is cpd if and only if it satisfies the cpd positivity condition for vectors with real coordinates adding up to zero here is the argument for the non trivial direction given a complex vector v whose components sum to zero we may write v x iy where x and y are real vectors each of whose coordinates must sum to zero then v av x iy a x iy xtax ytay iytax ixtay xtax ytay i ytax xtay 2 7 xtax ytay using the fact that v av must be real since a is hermitian and therefore the imaginary part of 2 7 must be zero if we assume that a satisfies conditional positive definiteness for real vectors we must have xtax ytay 0 and it follows that v av 0 showing that a satisfies conditional positive definiteness for complex vectors remark 2 12 i cf 6 lemma 4 1 4 if a is cpd then a has at most one negative eigenvalue ii assume that a k k matrix a is nonzero has non positive entries and is cpd then a has exactly one negative eigenvalue for since a is hermitian all eigenvalues are real and not all eigenvalues can be zero since the trace of a is non positive at least one eigenvalue must be negative by i at most one eigenvalue can be negative and therefore a has exactly one negative eigenvalue iii consider a contractive unilateral weighted shift w and its moment matrices m 0 and m 1 whose entries are real numbers in the interval 0 1 recall that we have assumed that the weights are positive then logm 0 k and logm 1 k are nonzero matrices have non positive entries and are cpd it follows from ii that each of these matrices has exactly one negative eigenvalue since we wish to study cpd matrices and weighted shifts the equivalence of i and ii in the following result is of special interest to us theorem 2 13 cf 6 theorem 4 1 3 10 and 22 problem 6 3 8 for k 2 let a aij ki j 1 be a hermitian k k matrix the following statements are equivalent i a is cpd ii b aij ai j 1 ai 1 j ai 1 j 1 k 1 i j 1 is positive definite iii there exist real numbers i i 1 k such that c aij i j ki j 1 is positive definite iv for all p 0 the k k matrix epa is positive definite 13 remark 2 14 assume that the matrix a in theorem 2 13 is hankel so the entries are of the form aij wi j then the entries of the matrix b in ii are of the form wi j 2 wi j 1 wi j 2 this sum is precisely what one obtains by letting the square of the forward difference operator act on w cf 2 3 we ll revisit this viewpoint in subsection 3 1 we now establish a link between conditional positive definiteness and unilateral weighted shifts cf lemma 2 2 remark 2 15 let a be a k k matrix with positive entries and assume that a is cpd then the k k matrix r of reciprocals defined as rij 1 aij is infinitely divisible 22 subsection 6 3 problem 11 we now present a proposition crucial for our purposes which r bhatia 10 attributes to c loewner and which may be found in 22 proposition 2 16 22 theorem 6 3 13 suppose m is a symmetric matrix with positive entries then m is infinitely divisible if and only if logm meaning the hadamard logarithm matrix is cpd remark 2 17 cpd matrices are intrinsically associated with distance matrices as follows in rd consider k points p 1 p k and their euclidean distances p i p j 2 i j 1 k now form the k k matrix d p 1 p k dij k i j 1 where dij p 1 p k p i p j 2 for i j 1 k d d p 1 p k is called the distance matrix associated with the k tuple p 1 p k clearly dii 0 for i 1 k so the diagonal entries of d are all zero moreover d is cpd as a calculation reveals in fact fix i and j and write p i p j 2 p i 2 p j 2 2 pi pj now let i p i 2 mij i j m mij k i j 1 and gij pi pj for k 2 consider the map from hermitian k k matrices to hermitian k 1 k 1 matrices given by a 7 a aij ai j 1 ai 1 j ai 1 j 1 k 1 i j 1 the above mentioned matrix m is a typical element of the linear subspace of k k matrices a such that a 0 that is m ker it follows that d can be written as the difference between a matrix in ker and twice the gramian matrix g gij k i j 1 now consider an arbitrary cpd hermitian k k matrix a aij ki j 1 and let ha hij k i j 1 with hij aii ajj 2 i j 1 k we already know that ha 0 so ha ker moreover a ha is cpd and has diagonal 14 identically equal to zero then by 6 theorem 4 1 7 a ha is a distance matrix from the discussion above we see that a ha m 2 g for some m ker and g gramian as a result we can prove that given a cpd hermitian k k matrix a one can find a positive integer d and k points p i rd i 1 k such that a 2 g ker where g is the gramian of the k tuple p 1 p k in particular a 2 g 0 since it is well known that gramians are pd see for instance 23 theorem 7 2 10 we close this section by mentioning a very recent paper of z j jab lon ski i b jung and j stochel 24 in which they study the cpd condition for operators on hilbert space the focus is on cpd sequences of exponential growth with emphasis given to obtaining criteria for their positive definiteness 3 a bridge between k hyponormality and n contractivity proposition 2 16 establishes an equivalence between the infinite divisibility of a moment matrix m and the conditional positive definiteness of its schur logarithm logm this allows us to view k hyponormality under a new lens and describe moment infinite divisibility of a weighted shift w as follows for each k 1 i 0 and p 0 the matrix mp i k p i p i 1 p i 2 p i k p i 1 p i 2 p i k 1 p i 2 p i k 2 p i k p i k 1 p i k 2 p i 2 k is positive definite where the i are the moments of the shift when p 1 we will simply write m i k the following two corollaries are immediate note however that in this context we do not need to assume that w is a contraction while the agler conditions equivalently the approach through monotone moment sequences yield subnormality for a contraction but not in general viz the dirichlet shift the k hyponormality conditions do yield subnormality for any shift observe also that if we wish to operate at the level of infinite matrices of moments we must take care that we examine two such matrices recall that for subnormality we are in pursuit of stieltjes moment sequences that is moment 15 sequences n n 0 for which the following two matrices are simultaneously positive definite 3 m 0 m 0 0 1 k 1 2 k 1 k k 1 k 2 n 3 1 and m 1 m 1 1 2 k 1 2 3 k 2 k 1 k 2 k 2 n 1 3 2 corollary 3 1 let w be a weighted shift then w is mid if and only if for each i 0 and each k 1 logm i k is cpd equivalently both logm 0 and logm 1 are cpd corollary 3 2 let w be a weighted shift and let k n then w p is k hyponormal for all p 0 if and only if logm i k is cpd for each i 0 we leave to the interested reader to show that the corollaries may be improved to add the equivalent condition subnormal for each p in some interval 0 with 0 respectively k hyponormal for each p in some interval 0 with 0 this may be accomplished by considering positivity of schur products of positive matrices we may apply this to a weighted shift to yield the following result this yields a test for subnormality which is as far as we know new proposition 3 3 let w be a weighted shift with moment sequence n n 0 the following statements are equivalent i w is mid ii the sequence n n 0 with n ln n n 2 2 n 1 is a stieltjes moment sequence iii the weighted shift with moments n 0 is subnormal proof this is immediate from the fact that logm 0 and logm 1 must be cpd theorem 2 13 i ii and the standard two matrix requirement that a sequence be a stieltjes moment sequence 16 when the weighted shift is a contraction we may add to the list in proposition 3 3 of conditions equivalent to moment infinite divisibility as we do in the following theorem note that however as in the observation following corollary 3 2 we may instead add a condition only on some schur powers p for p in a small interval 0 to extend this to all p 0 one needs to resort to schur multiplication to go from say p to 2 p and so on we now prove our first main result which we restate for the reader s conve nience theorem 3 4 let w be a contractive weighted shift and let m i k m 0 and m 1 be as above the following statements are equivalent i w is mid ii logm 0 and logm 1 are cpd iii for every i 0 and every k 1 logm i k is cpd iv for every p 0 m p 0 and m p 1 are positive definite v for every p 0 m p 0 and m p 1 are cpd vi the moment sequence is log completely monotone vii the weight sequence is log completely alternating proof the only assertion not immediate is the equivalence of m p 0 and m p 1 being cpd for all p 0 to the others fix some power p 0 for the moment using the observation just before the theorem the condition in question yields all of the 2 k monotonicity conditions and using corollary 2 6 we obtain 2 k hypermonotonicity for all k yielding that the sequence of moments p is completely monotone since p was arbitrary this yields the result in view of the results in this section one can try and extend the notion of moment infinite divisibility for weighted shifts to arbitrary contractions on hilbert space using the polar decomposition factor as in problem 3 5 below we plan to pursue this idea in a forthcoming paper problem 3 5 starting with the canonical polar decomposition of a subnormal operator t v t should one consider the subnormality of v t p for all p 0 as the proper analog of moment infinite divisibility 3 1 a unifying condition it is well known that k hyponormality for all k 1 2 is necessary and sufficient for subnormality of an operator it is true as well that n contractivity for all n 1 2 is sufficient for subnormality of an operator and necessary if 17 the operator is a contraction of course these in their equivalents as conditions on moments of the shift hold as well with the exception of 20 theorem 1 2 which shows in general that k hyponormality implies 2 k contractivity and work in 1 which gives in a very special case a situation in which each k hyponormality coincides exactly with a particular n contractivity the two sets of conditions have remained resistant to a common point of view it is the goal of this subsection to give a more general condition exhibiting a unified point of view yielding the sets of conditions we will have occasion to operate mainly upon a sequence likely in the sequel to be the moment sequence of a weighted shift often contractive so we will employ n n 0 for this sequence recall the forward difference operator acting on sequences by n n n 1 for all n 0 1 and with its powers defined iteratively as m 1 m for all m 0 we let 0 note that m contractivity means that m is a non negative sequence for a sequence a an n 0 k 1 and i 0 we let ma i k denote the hankel matrix of size k 1 by k 1 given by ma i k ai ai 1 ai 2 ai k ai 1 ai 2 ai k 1 ai 2 ai k 2 ai k ai k 1 ai k 2 ai 2 k observe that we use the positive integer k to keep track of k hyponormality but the actual size of the related matrices is k 1 as in subsection 2 4 in the case of a weighted shift k hyponormality is exactly that m i k is positive definite for each i 0 1 observe that by theorem 2 13 i ii applied to hankel matrices it follows that m i k is a cpd matrix if and only if m 2 i k 1 is positive definite see also remark 2 14 definition 3 6 let k 1 and 0 m k we say a sequence n n 0 is k 2 m pd if for every i 0 the matrix m 2 m i k m is positive definite similarly we say the sequence is k 2 m cpd if for every i 0 the matrix m 2 m i k m is cpd we will abuse language slightly to say a weighted shift w with moment se quence is k 2 m pd respectively k 2 m cpd if its moment sequence is observe that a weighted shift is k hyponormal exactly when it is k 0 pd a computation shows that a shift is k 2 k pd if and only if it is 2 k contractive this is the sense in which the k hyponormality condition and the 2 k contractivity 18 condition are simply instances in fact extremes of the single more general con dition it is productive to think of the condition as beginning with the moment matrix of size k 1 employing repeatedly the matrix transformation implicit in theorem 2 13 ii and insisting that the matrix obtained after m such steps be positive definite respectively cpd observe also that if the shift w is a contraction with some other mild condi tion such as hyponormality and if w is k 2 k pd then its moment sequence is 2 k hypermonotone see corollary 2 5 we now record the following proposition proposition 3 7 let w be a unilateral weighted shift k 1 and 0 m k assume that w is k 2 m cpd then w is 2 m contractive 2 m 2 contractive 2 k contractive proof this is just a computation use each matrix m 2 m i k m as a quadratic form against an appropriately sized negative binomial vector such as 0 0 1 1 0 or 0 1 3 3 1 0 0 to show one significant instance of this calculation let k 4 m 2 and i then m 2 k m becomes m 2 2 2 1 2 1 2 2 3 2 2 3 4 1 2 2 3 2 2 3 4 3 2 4 5 2 2 3 4 3 2 4 5 4 2 5 6 and therefore 1 1 0 m 2 2 1 1 0 4 1 6 2 4 3 4 which is one of the agler expressions needed to verify 4 contractivity 3 2 a family of intermediate ladders it is well known that the k hyponormality conditions k n provide a ladder with subnormality at the top and that the n contractivity conditions n 1 2 serve similarly if the shift is a contraction if w is a contraction whose weights have a limit for example it is hyponormal and if we fix some m the k 2 m pd or k 2 m cpd conditions for k m form a similar ladder the proof is immediate from proposition 3 7 the fact that in the presence of contractivity n monotonicity implies n hypermonotonicity and the agler embry characterization of subnormality as applied to a shift 19 theorem 3 8 let w be a contractive weighted shift whose weights have a limit for example if w is hyponormal and fix m n if for all k m w is k 2 m pd or k 2 m cpd w is subnormal we turn next to some results showing that these ladders are different by considering zeroth weight perturbations aj x of the agler shifts aj recall that the moment sequence j j n n 0 of the j th agler shift satisfies j n j 1 n n j 1 j 2 n 0 3 3 it is a computation to show that j j 1 j j 1 and that therefore 2 m j j 1 j 2 m 1 j 2 m 3 4 observe that this is in general not a moment sequence because 2 m j 0 may not be equal to 1 however since aj is subnormal for all j 2 m j is up to a normalizing constant a stieltjes moment sequence 3 3 cutoffs for rank one perturbations of the agler shifts recall that if we form the standard hankel matrices of moments of a weighted shift n hyponormality amounts to positivity of all those matrices of size n 1 by n 1 we have seen as well that instead of insisting these matrices be positive we might ask only that the matrices of size n 1 by n 1 be cpd which is equivalent to the matrices of size n by n and consisting of second differences 2 be positive definite and of course we could insist only that these matrices be cpd which is equivalent to matrices of size n 1 by n 1 and consisting of fourth differences of the original moments be positive definite we may continue in this way terminating by insisting that matrices of size 1 by 1 and having the entry consisting of 2 n th order differences be positive definite and this turns out just to be the 2 n th agler condition we set some notation so if the original moment sequence is n we write m 2 m k n 1 for the matrix of 2 m th order differences of of size n by n and with the upper left hand entry consisting of the difference beginning at k 20 however in what follows we need to consider only those matrices for which k 0 and we abbreviate m 2 m 0 n 1 to 2 m n thus for example 4 3 0 4 1 1 4 2 2 4 3 1 4 2 2 4 3 3 4 4 2 4 3 3 4 4 4 4 5 we shall consider perturbations aj x of the j th agler shift aj in which the zeroth weight 0 1 j is replaced by 0 x x j it is well known that this results in the moment sequence 1 x j 1 x j 2 x j 3 the task is to consider the cutoffs in x for which aj x is various k 2 m pd as usual with zeroth weight perturbations we need to consider only the tests of matrices whose 1 1 entry is j 0 since other matrices relevant to some k 2 m pd are simply x times a matrix relevant to aj 2 m which is subnormal and so the matrix is positive definite and hence cpd to detect positive definiteness we will use the nested determinant test perturbations a 2 x of the bergman shift were studied initially in 13 proposition 7 where the specific cutoff for 2 hyponormality was calculated here we will follow the approach described in 1 section 2 both for k hyponormality and n contractivity of agler type shifts we will therefore merely sketch the computations here for the reader s convenience below we state one of the main results in 1 theorem 3 9 1 theorem 2 6 for j 2 let aj x be the rank one pertur bation of the j th agler shift as described above i aj x is n contractive if and only if x c j n n j 1 n ii aj x is k hyponormal if and only if x h j k k k j j 1 k k j as a consequence aj x is k hyponormal if and only if aj x is k k j contractive remark 3 10 i the quantities on the right hand side of the inequalities in theorem 3 9 i and ii are consistent with previous partial results on rank one perturbations of weighted shifts see 13 proposition 7 and 17 problem 3 2 and proposition 3 4 however while those results define the 0 th weight as x for our purposes it is better to write it as x j ii in the specific case of the bergman shift j 2 we get c 2 n n 1 n and h 2 k k 2 2 k 1 k 2 2 k so it is immediate that a 2 x is 2 hyponormal if and only if it is 8 contractive our aim is to obtain a comparable result for k 2 m pd which will enable us to relate this notion to n contractivity to ease the notation view j as fixed 21 for the moment which we then suppress as much as possible and let n k m denote the matrix m 2 m j 0 k m and let n k m denote the matrix obtained from n k m by deleting the first row and first column to detect k 2 m pd we wish to test for positivity the determinant detm 2 m j x 0 k m it is a computation to show that this positivity is equivalent to x 1 1 detn k m det n k m in light of 3 4 and the fact that n k m is of size k 1 m we have detn k m j 1 j 2 m 1 k 1 m detm j 2 m 0 k m and using again 3 4 and that n k m is of size k 1 m 1 k m we obtain det n k m j 1 j 2 m 1 k m detm j 2 m 2 k m 1 the ratio detm j 2 m 0 k m detm j 2 m 2 k m 1 was computed in 1 lemma 2 5 transferred to our setting it is j 2 m 1 k m j 2 m 1 k m 1 putting this all together yields the following result theorem 3 11 let aj x be the perturbation of the agler shift aj in which the zeroth weight 0 1 j is replaced by 0 x x j and let k n and m 0 1 k i aj x is k 2 m pd if and only if x p j k m where p j k m k 1 m j k m 1 k 2 jk 2 m jm m 2 j k m k m 2 m j 1 j k m k m 2 m 3 5 ii aj x is k 2 m pd if and only if aj x is j k m k m 2 m contractive we now present some examples of this result for the case of the bergman shift j 2 recall that the size of the relevant matrix is k 1 in accordance with the size of the matrix to be tested for k hyponormality in this case 22 p j k m p 2 k m k k 2 m 2 1 k k 2 m 2 observe that the numerator is 1 plus the denominator m 0 1 2 3 4 5 1 4 3 3 2 2 9 8 8 7 5 4 k 3 16 15 15 14 12 11 7 6 4 25 24 24 23 21 20 16 15 9 8 5 36 35 35 34 32 31 27 26 20 19 11 10 as described in theorem 3 11 each entry in this table corresponds with an exact cutoff for n contractivity where n k k 2 m 2 that is the perturbation is n contractive if and only if x n 1 n so for example 4 3 pd corresponds with the shift being 15 contractive in general there is not an exact correspondence with any k hyponormal condition for instance the 4 2 pd cutoff 21 20 falls between the cutoffs for 3 and 4 hyponormality 16 15 and 25 24 respectively as noted above the cutoff for k hyponormality is exactly that for k 0 pd it is worth noting that the cutoffs for m 1 and m 0 are close the difference amounts to 1 k k 2 k k 2 1 recall that the latter is exactly the threshold for k hyponormality while by theorem 2 13 ii the former is the cutoff for the standard matrix for k hyponormality to be cpd observe also that the cutoff for k 2 k pd which is the same as for 2 k contractivity is considerably bigger than that for the standard matrix for k hyponormality to be cpd this shows in particular that for that matrix to be non negative as a quadratic form against all the negative binomial vectors of appropriate size e g 0 1 1 0 0 0 0 1 3 3 1 0 is a weaker property than for it to be cpd this is because if the operator is 2 k contractive it is being a contrac tion 2 k hypercontractive and the quadratic form results just mentioned are all necessarily non negative it is therefore reasonable to raise the following question question 3 12 given integers k 1 and m with 0 m k what is the set of vectors upon which the original matrix of size k 1 is non negative as a quadratic form if it is k 2 m pd if m 0 it is the whole space if m 1 it is the subspace of dimension k consisting of those vectors whose components sum to zero if m k it contains at least the negative binomial vectors remark 3 13 from the above it is easy to show that the various conditions in k and m are distinct from one another even just using j 2 the bergman shift 23 it is also true in this setting that there is an easy expression in x equivalent to the shift aj x p contractive x p j 1 p cf theorem 3 9 it results from this that the condition in theorem 3 9 i is satisfied if and only if aj x is j k m k m 2 m contractive this allows us to use contractivity as a scale to measure and compare the strengths of the various positivities of matrices of certain sizes and certain order of differences the following table for a 2 illustrates this we suppress j 2 to ease the notation slightly recall that if a weighted shift is n hyponormal then it is 2 n contractive and that if we begin with n hyponormality the process terminates in a 1 by 1 matrix whose positivity is exactly this 2 n th agler expression further each of the intermediate conditions is at least no stronger than the previous one in fact the result above shows that at least in this case the previous condition is strictly stronger than the subsequent one obtained by introducing another 2 and decreasing the size of the matrix note also that positive definiteness of an entry in one column is equivalent to conditional positive definiteness of the entry one column to the left recall finally that for a contraction if all the even order contractivity tests are positive the contraction is subnormal so each of these ladders has for contractions subnormality at the top n hyponormal n x n 1 0 2 x n 0 4 x n 1 0 6 x n 2 0 8 x n 3 0 1 3 c 2 c 2 8 c 7 c 4 c 3 15 c 14 c 11 c 6 c 4 24 c 23 c 20 c 15 c 8 c put informally every regularity you see in this display is correct for exam ple in any row the decreases in contractivity have gaps 1 3 5 7 the corresponding results for a 3 and a 4 are similarly orderly we conclude this section with a brief digression to report another fact about these zeroth weight perturbations aj x of the agler shifts aj proposition 3 14 let aj x be the zeroth weight perturbation of the agler shift aj with weight sequence j as in theorem 3 11 then the weights squared of aj x are m alternating if and only if x 1 j 1 m m i 1 j i 3 6 24 if we take j 2 that is the case of the bergman shift the weights squared of a 2 x are m alternating if and only if a 2 x is m 1 m 2 2 contractive proof as usual with zeroth weight perturbations the only condition to check for m alternating is that beginning with 0 x since we know that aj has weights squared that are completely alternating 7 remark 2 9 the relevant expression is x j m 1 2 j 1 m 2 3 j 2 m m m 1 m j x j 1 j 1 j m 1 2 j 1 m 2 3 j 2 m m m 1 m j x j 1 j m j 0 one may compute using an induction argument that m j n 1 j m n m i n j i and this plus an easy calculation yields the result the assertion for the bergman shift is simply another calculation using 3 6 one may check that for aj x with j 2 the cutoffs for m alternating do not necessarily correspond to some n contractivity the n contractivity cutoff is n 1 n and what comes out of the expression above need not correspond to an integer n when it does the correspondence is exact in some sense the cutoffs correspond approximately with n contractivity where n o m 2 as is to be expected from the formula in 3 6 acknowledgments the authors are deeply grateful to the referee for a detailed reading of the paper and for detecting an inconsistency in the use of the phrase infinite divisibility the authors also wish to express their appreciation for sup port and warm hospitality during various visits which materially aided this work to bucknell university the university of iowa and the universite des sciences et technologies de lille and particularly the mathematics departments of these institutions several examples in this paper were obtained using calculations with the software tool mathematica 25 25 references 1 g t adams and g r exner k hyponormality and n contractivity for agler type shifts j operator theory 71 2014 585 600 2 j agler hypercontractions and subnormality j operator theory 13 1985 203 217 3 n i akhiezer the classical moment problem and some related questions in analysis oliver and boyd 1965 4 a aluthge on p hyponormal operators for 0 p 1 integral equations operator theory 13 1990 307 315 5 a athavale on completely hyperexpansive operators proc amer math soc 124 1996 3745 3752 6 r b bapat and t e s raghavan nonnegative matrices and applications cambridge university press cambridge 1997 7 c benhida r e curto and g r exner moment infinitely divisible weighted shifts complex analysis and operator theory 13 2019 241 255 8 c benhida r e curto and g r exner moment infinite divisibility of weighted shifts sequence conditions preprint 2020 arxiv 2009 07797 9 c berg j p r christensen and p ressel harmonic analysis on semigroups springer verlag berlin 1984 10 r bhatia infinitely divisible matrices amer math monthly 113 3 2006 221 235 11 j bram subnormal operators duke math j 22 1965 75 94 12 j b conway the theory of subnormal operators mathematical surveys and monographs vol 36 amer math soc providence 1991 13 r e curto quadratically hyponormal weighted shifts integral equations operator theory 13 1990 49 66 14 r e curto joint hyponormality a bridge between hyponormality and sub normality proc sym pure math 51 1990 69 91 15 r e curto 2 variable weighted shifts in multivariable operator theory in handbook of analytic operator theory k zhu ed chapman hall crc handbooks in mathematics series pp 17 63 26 16 r e curto and g r exner berger measure for some transformations of sub normal weighted shifts integral equations operator theory 84 2016 429 450 17 r e curto and l a fialkow recursively generated weighted shifts and the subnormal completion problem i integral equations operator theory 17 1993 202 246 18 r e curto y t poon and j yoon subnormality of bergman like weighted shifts j math anal appl 308 2005 334 342 19 g r exner aluthge transforms and n contractivity of weighted shifts j operator theory 61 2 2009 419 438 20 g r exner i b jung and s s park on n contractive and n hypercontractive operators ii integral equations operator theory 60 2008 451 467 21 r gellar and l j wallen subnormal weighted shifts and the halmos bram criterion proc japan acad 46 1970 375 378 22 r a horn and c r johnson topics in matrix analysis cambridge univer sity press cambridge 1991 23 r a horn and c r johnson matrix analysis 2 nd ed cambridge university press cambridge 2013 24 z j jab lon ski i b jung and j stochel conditionally positive definiteness in operator theory preprint 2020 arxiv 2008 09494 25 wolfram research inc mathematica version 12 1 wolfram research inc champaign il 2019 27 http arxiv org abs 2008 09494 1 introduction and statement of main results 2 notation and preliminaries 2 1 unilateral weighted shifts 2 2 agler shifts 2 3 mid shifts 2 4 k hyponormality 2 5 n contractivity 2 6 n hypermonotone and n hyperalternating weighted shifts 2 7 conditionally positive definite matrices 3 a bridge between k hyponormality and n contractivity 3 1 a unifying condition 3 2 a family of intermediate ladders 3 3 cutoffs for rank one perturbations of the agler shifts