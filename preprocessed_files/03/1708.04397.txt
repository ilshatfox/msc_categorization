ar x iv 1 70 8 04 39 7 v 1 m at h g r 1 5 a ug 2 01 7 group embeddings with algorithmic properties arman darbinyan 1 abstract we show that every countable group h with solvable word problem can be subnormally embedded into a 2 generated group g which also has solvable word problem moreover the membership problem for h g is also solvable we also give estimates of time and space complexity of the word problem in g and of the membership problem for h g 2 introduction in the famous paper 8 by higman b h neumann and h neumann in 1949 using constructions based on hnn extensions it was shown that every count able group can be embedded in a group generated by two elements later b h neumann and h neumann suggested an alternative embedding construction based on wreath products 15 which allowed them to show that every count able solvable group can be embedded in a 2 generated solvable group further development of these ideas was done by hall 7 subsequently other construc tions based on this ideas were introduced where the 2 generated group inherited some other properties of the initial group for example embeddings of periodic groups phillips 19 property of residually finiteness wilson 22 sd groups subnormal and verbal embeddings orderable groups mikaelian 11 9 10 12 embedding which preserves elementary amenability olshanskii osin 17 etc most of the aforementioned embedding constructions were motivated either by the desire to better control the algebraic structure or geometric properties of the embedding but none of the constructions based on wreath products was keywords embedding of groups wreath product word problem membership problem time complexity space complexity 2010 math subject classification 20 f 05 20 f 10 1 http arxiv org abs 1708 04397 v 1 concerned about algorithmic properties of the resulting group algorithmic properties for embeddings of countable groups were investigated by clapham 3 collins 4 thompson 21 boone higman 2 birget olshan skii rips sapir 1 miller iii 13 olshanskii sapir 18 and others all the embeddings in these papers use constructions based on hnn extensions which have a disadvantage of leading to large finitely generated groups even if the initial group is relatively small countable group for example the resulting finitely generated group always contains nonabelian free subgroups in this paper we will investigate algorithmically well behaving embeddings based on wreath products and using ideas which can be traced back to b h neumann h neumann 15 and hall 7 for a given alphabet i e set of letters x we denote by x the set of words in the alphabet x x 1 and for a given word u x we denote its length with respect to this alphabet by u x or if there will not occur ambiguity we will simply denote it by u let s a 1 a 2 be a generating set of a countably generated group h since turing machines work only with finite input alphabets for consider ing word problem in h we will encode the elements of s by a quaternary code in the following way encode a i as 3 bi and a i 1 as 4 bi where bi is the binary presentation of the index i clearly the code of a i 1 is not longer than 2 log 2 i we define log 2 n 0 for n 0 hence for the alphabet sn a 1 a 2 a n if v s n then the length of the quaternary code of v which we will denote by l v is less than or equal to v sn 2 log 2 n v s 2 log 2 n 1 for example the code of a 1 is 31 l a 1 2 log 2 1 2 the code of a 1 1 is 41 l a 1 1 2 log 2 1 2 we will assume that the word problem for the group h is solvable in the sense that there exists an algorithm such that for every encoded word from s it decides whether the corresponding element in h is trivial or not for convenience we introduce the notation lg n 2 log 2 n also we define the commutator of x and y as x y xyx 1 y 1 to estimate complexity functions for the below described algorithms we will use standard asymptotic notations namely f n o f n if there exists a real number n 0 and a positive constant m such that n n 0 implies f n m f n our main result is the following 2 theorem 1 let h be a group generated by a countable set s a 1 a 2 and having solvable word problem with respect to the above described encoding of s then there is a subnormal embedding of the group h into a two generator group g gp c s with solvable word problem and it can be recognized whether a word from c s represents an element of h or not i e the membership problem for h g is solvable as well moreover given a word w from c s if f g n n are time complexity and space complexity functions for the word problem in h respectively where we consider the word problem with respect to the quaternary encoding described above then i the word problem in g can be solved in time o n 3 lg n n 2 f nlg lg n where n is the length of the word w from c s ii the membership problem for h g can be solved in time o n 4 lg n n 3 f nlg lg n iii the space complexity for the word resp membership problem in g resp for h g is o g n lg lg n roughly speaking the space function of an algorithm is a measurement which shows the maximal amount of memory or space used by a turing machine at some point of time while running the algorithm and time complexity is the time required by the machine to run the algorithm and the domain of these functions shows the length of the input data for more rigorous definitions of time and space complexity functions we refer to the articles 16 20 directly from the formulas in i and in ii we obtain the following corollary 1 if the word problem for h is solvable in polynomial time then the word resp membership problem for g resp for h g is solvable in polynomial time as well in other words corollary 1 means that if the word problem in h belong to the class p then the word problem in g belongs to the class p too in the proof of theorem 1 it is shown that if the word problem in h resp the membership problem for h g belongs to the class np then the word problem in g resp the membership problem for h g belongs to the class np too also from the formula in iii it follows that if the word problem in h belongs to the space complexity class l or nl then the word problem in g and the membership problem for h g belong to the same space complexity class in the statement of theorem 1 we said that is a subnormal embedding meaning that there exists a finite chain g 0 g 1 gk of subgroups of g such 3 that h g 0 g 1 gk g from the embedding construction given in the proof of theorem 1 we also obtain corollary 2 if h is a solvable group of length l then g is a solvable group of length l 2 a group g is called locally indicable if for every finitely generated subgroup 1 6 h g there exists a surjective homomorphism from h onto the infinite cyclic group z corollary 3 if h is torsion free or locally indicable then so is g before moving forward to prove the theorem let us recall the definition of wreath products given two groups a and b the base subgroup ab is the set of functions from b to a with pointwise multiplication and the group b acts on ab from the left by automorphisms such that for f ab and b b the resulting function bf is given by bf x f xb x b for the convenience we will denote bf by f b definition 1 the wreath product awrb is defined as a semidirect prod uct ab b with the multiplication f 1 b 1 f 2 b 2 f 1 f b 1 2 b 1 b 2 for all f 1 f 2 ab b 1 b 2 b note that from the above definition it follows that f b bfb 1 also the inverse of fb is f 1 b 1 b 1 the conjugate of f 1 b 1 by f 2 b 2 is f 1 b 1 f 2 b 2 f 2 f b 2 1 f 1 2 b 2 b 1 b 1 2 b 2 b 1 b 1 2 definition 2 for g fb awrb we call f the passive and b the active part of the group element g the group g is called linearly ordered or fully ordered if there is a linear order defined on the elements of g such that for any elements g 1 and g 2 from g if g 1 g 2 then g 1 x g 2 x and xg 1 xg 2 for all x g in the paper 12 see also 5 the following fact was proved lemma 1 let a and b be linearly ordered groups and be a subgroup of awrb if for each fb supp f is well ordered then is linearly orderable in what follows this lemma applied to the group g from theorem 1 gives the following corollary 4 if h is linearly orderable then so is g 4 3 proof of theorem 1 in the proof first we will describe the construction of the group g and the em bedding h g then we will describe the algorithms for the word problem and the membership problem simultaneously estimating the time complexity of these algorithms finally we will turn to the proof of the part iii let us consider the group hwrz where z z is an infinite cyclic group take b i hz such that b i zk a i if k 0 1 otherwise i 1 2 note that zb i z 1 zk a i if k 0 1 otherwise this is because zb i z 1 zk zb i zk b i zk 1 therefore z b i 1 zb i z 1 1 b i 1 1 a i and z b i zk 1 for all k 6 0 i e the functions z b i generate a subgroup isomorphic to h so the mapping a i 7 z b i embeds the group h into the subgroup k gp z b i i n of the wreath product now let us consider the group kwrs where s s is an infinite cyclic group consider c ks such that c sk z if k 1 b i if i 0 and k 2 i 1 otherwise for our construction it is vital that the support of c is sparse one of the reasons can be seen in the next described key property the element c cs 2 i 1 considered as a s k function takes a non trivial value a i more precisely z b i only at s indeed c cs 2 i 1 s c s cs 2 i 1 s c 1 s c s 2 i 1 s c s c s 2 i c s 1 c s 2 i 1 zb i z 1 b i 1 z b i and in general if c cs 2 i 1 sk 6 1 then c sk 6 1 cs 2 i 1 sk c s 2 i k 1 6 1 but this means that k and 2 i k 1 are some powers of 2 which can take place only if k 1 this property of c c 2 i 1 implies that the map h g gp c s given by a i 7 c c 2 i 1 embeds h into the 2 generated group g 5 now let us describe a procedure which recognizes identities in g among the words of c s let w s 0 c 1 s n 1 c ns n 2 be an arbitrary word in c s where 0 1 n 1 n are some non zero integers with a possible exception of 0 and n they could be equal to 0 particularly w c s 2 n 1 note that w is equal to cs 1 1 cs 2 2 cs n ns 3 in g where n i 0 i j j 1 i 0 i 4 thanks to the identity s c cs s also note that w c s n i 0 i n i 1 i n i 1 i a direct consequence of these formulas is that for passing from the form 2 to the form 3 we only need to find s using the above described formula 4 since the binary lengths of s are not larger than log 2 w we get that j 1 i 0 i can be computed in o j log 2 w time this means that the whole computation in 4 can be done in o log 2 w n 2 time also we have o log 2 w n 2 o log 2 w w 2 5 for the presentation 3 of w let us define the set bi j 1 n j i for i 1 n lemma 2 if cs 1 1 cs 2 2 cs n ns 1 then j bi j 0 for i 1 n and 0 proof denote cs 1 1 cs 2 2 cs n n by f the active part of f s i 1 regarded as an element of k is equal to z j bi j for i 1 n because f s i 1 cs 1 1 cs 2 2 cs n n s i 1 cs 1 1 s i 1 cs 2 2 s i 1 cs n n s i 1 and cs j j s i 1 c s j z j if j i and c s j j s i 1 c s j i 1 j gp b i i n if j 6 i in the same way as we obtained the rewriting 3 we can present f s i 1 in the form b i 1 z 1 1 b i 2 z 2 2 b im z m mz 6 for some integers k k by the analogy with the equations 4 we have j bi j hence if f s i 1 1 then j bi j should be 0 also trivially should be 0 too further we will use the notation 0 max 1 n lemma 3 if 3 0 and j bi j 0 i 1 n then cs 1 1 cs 2 2 cs n n s 1 proof assume f s cs 1 1 cs 2 2 cs n n s 6 1 first we will show that there exist integers k and l 1 k 6 l n such that k 6 l and c s k k s 6 1 cs l l s 6 1 indeed if this does not take place then for a fixed k cs k k s 6 1 implies that for arbitrary l bk i e for l 6 k we have c s l l s 1 but this means that f s ij bk cs ij ij s cs k ij bk ij s cs k 0 s 1 a contradiction thus there exist k and l such that 1 k 6 l n k 6 l c s k k s 6 1 and cs l l s 6 1 but for any z cs s c s 6 1 only if 2 x i e 2 x for some nonnegative integer x therefore there exist nonnegative integers x 1 and x 2 such that x 1 6 x 2 and 2 x 1 k 2 x 2 l assume x 1 x 2 then 2 x 2 2 x 1 2 x 2 k l 2 0 hence 2 x 2 l 2 x 2 l 2 0 0 3 0 a contradiction a direct consequence of lemma 2 and lemma 3 is the following lemma 4 the word w cs 1 1 cs 2 2 cs n ns is trivial in g if and only if 0 and j bi j 0 for i 1 n 6 and cs 1 1 cs 2 2 cs n n s 7 is trivial in g for all 3 0 3 0 note that since 0 w in lemma 4 3 0 3 0 can be replaced by 3 w 3 w for the further we denote the element in 7 by f 7 exactly in analogy with the equation 5 the condition 6 can be checked in time o log 2 w w 2 8 we have f c s 1 1 s cs 2 2 s cs n n s 9 and cs i s b log 2 i if i is a natural power of 2 z if i 1 1 otherwise 10 thus in the case 0 0 we have f 1 otherwise f is an element in gp 1 z b j 1 j log 2 0 whence can be presented in the form z 0 b i 1 1 z 1 b i 2 2 b im mz m 11 where j s are nonnegative and j s are positive integers 0 ij log 2 0 andm n w also j s ij s and j s can be calculated based on 10 this calculation can be done in time o n log 2 0 o w log 2 0 since we are interested only in the case 3 0 3 0 for this case we have log 2 0 log 2 0 3 0 lg w the following inequality put the just calculated time estimation in a more convenient form for our purposes o w log 2 0 o w lg w 12 after applying a transformation similar to the one which led from 2 to 3 but this time based on the identity z b i b i z z 9 can be rewritten as b i 1 z 1 1 b i 2 z 2 2 b im z m mz 13 where in analogy with the equation 4 we have m i 0 i j j 1 i 0 i 14 using this formula as in the case of equation 5 we obtain that if the exponential coefficients of 11 are given the exponential coefficients of 13 can be calculated in time o log 2 w w 2 hence by this and by 5 and 12 we obtain that given the word w in the form 2 the coefficients of the rewriting 13 of w can be calculated in time o w lg w o log 2 w w 2 o log 2 w w 2 o w 2 lg w 15 8 at this point by lemma 4 we got that the word problem in g is reduced to the word problem in k and according to 15 this reduction can be done in polynomial time in turn the word problem in k can be reduced to the word problem in h indeed b i z z b i z a i if 0 and it is 1 if 0 therefore the function b i 1 z 1 1 b i 2 z 2 2 b im z m m z is constant and equal to a i 1 1 a i 2 2 a im m for all 0 and equal to 1 for all 0 where by 0 we denote max 1 m thus in order f to be trivial a necessary and sufficient condition is that 0 and b i 1 z 1 1 b i 2 z 2 2 b im z m m z is trivial for all 0 and consequently for all w thus we reduced the word problem in g to the word problem in h moreover according to 15 this reduction is done in polynomial time which particularly means that if the word problem in h belongs to the class p or np then the word problem in g belongs to the same class since above we described a procedure of reducing the word problem in g to the word problem in h we conclude that the word problem in g is solvable whenever the word problem in h is solvable now let us finish the proof of the part i of theorem 1 first notice that since in 13 0 ij log 2 0 we have that b i 1 z 1 1 b i 2 z 2 2 b im z m m z b i 1 z 1 1 z b i 2 z 2 2 z b im z m m z 16 regarded as a word in s a 1 a 2 belongs to s log 2 0 s lg w recall that by s n we denoted the set of words a 1 a 2 a n hence taking into account the inequality 1 we have l b i 1 z 1 1 b i 2 z 2 2 b im z m m z mlg lg w w lg lg w 17 the last inequality means that triviality of the word b i 1 z 1 1 b i 2 z 2 2 b im z m m z s lg w can be checked in time o f w lg lg w thus since f is trivial iff the corresponding word 16 is trivial in h for all w we conclude that given the rewriting 13 i e the coefficients in 13 of f we can check its triviality in time o 2 w f w lg lg w o w f w lg lg w 18 were f as we mentioned in the statement of theorem 1 is the time complexity function of the word problem in h with respect to the encoding described in the introduction 9 combined this with 15 we conclude that triviality of f when it is given in the form 9 can be checked in time o w 2 lg w w f w lg lg w hence since 0 w triviality of 7 for all appropriate s can be checked in time o w 3 lg w w 2 f w lg lg w finally combined this with the formula 8 we conclude that one can check triviality of w in time o log 2 w w 2 o w 3 lg w w 2 f w lg lg w o w 3 lg w w 2 f w lg lg w 19 at this point we showed that the word problem for the group g is solvable and also proved the part i of theorem 1 now let us solve the membership problem for the subgroup h g i e describe a procedure for determining whether the element in g corresponding to w belongs to the image of h under the map or not the following lemma is a slightly modified version of lemma 2 lemma 5 if the word 2 regarded as an element of g belongs to h then j bi j 0 for all i 1 n proof this is true because if w h then w s 1 for all 6 1 the rest of the proof is the same as the proof of lemma 2 it is clear that w h iff in the rewriting 3 0 and cs 1 1 cs 2 2 cs n n s gp z b i i n if 1 and it is 1 if 6 1 combined this with lemma 3 and lemma 5 we get the following lemma 6 w h iff 0 j bi j 0 for i 1 n cs 1 1 cs 2 2 cs n n s 1 for 6 1 3 0 0 max 1 2 n and cs 1 1 cs 2 2 cs n n s gp z b i i n 10 so the membership problem for h g is reduced to the membership prob lem for h k since a i 7 z b i induces an embedding of h into k we can regard h as a subgroup of the group k considered the rewriting 13 let us use the following notation b b i 1 z 1 1 b i 2 z 2 2 b im z m m lemma 7 the element in 13 belongs to h iff 0 and b z 1 b z 2 b z 0 1 proof indeed it follows from the fact that b 1 h and b z 1 for 0 and b z b z 0 for 0 so we see that the membership problem is reduced to the word problem in k hence since the word problem in k is solvable we conclude that the membership problem is solvable as well moreover just like in the case of the word problem described above if the word problem in h belongs to the class p or np then the membership problem for h g belongs to the same class according to the formula 19 we can check the condition in lemma 7 in time 2 o w 3 lg w w 2 f w lg lg w but w which means that the membership problem for w can be solved in time o w 4 lg w w 3 f w lg lg w this completes the proof of the part ii of theorem 1 below we complete the proof of theorem 1 by showing the part iii and mean while review the steps of the algorithms for the word and membership problems described above first notice that the word w in 2 can be encoded in a machine as a 2 n 1 tuple 0 1 n n since for each integer k its binary presentation has length o log 2 k we obtain that the 2 n 1 tuple 0 1 n n occu pies onlyo n i 0 log 2 i o w machine space or squares of the machine as it is usual to call for turing machines or memory in other words at one of the steps in the above described word problem algorithm we transferred from the form 2 to the form 3 which can be done using the formula 4 since the formula 4 is only about using addition it can be implemented so that the machine will not occupy more than o w machine space at each point of the machine work for example at the j th step we can keep in machine j instead of 0 i 1 and at the j 1 st step add aj 1 to j and delete aj 1 and so on after we have got the form 3 in the machine according to our word problem algorithm it is time to check the condition 14 which will take only o w machine space since it involves only operation of addition of less than w numbers in the case this check shows negative result our 11 algorithm finishes its work showing that w is not trivial in g otherwise our algorithm suggests that the next and final step should be checking the triviality of cs 1 1 cs 2 2 cs n n s for all w since for different values of we can check this condition consecutively not simultaneously the space func tion for the whole procedure is the same as the space function for a procedure for a fixed we showed that cs 1 1 cs 2 2 cs n n s for all w can be presented in the form 13 where and j s can be calculated by the formula 14 and i s in 14 can be calculated according to 10 since again 14 involves only operation of addition and m w this procedure does not occupy more than o w machine space implementation of the formula 10 does not use more than o w machine space because it is basically about calculating logarithms of numbers which are less than w to summarize up to this point we showed that passing to the form z 0 b i 1 1 z 1 b i 2 2 b im mz m from 13 requires not more than o w machine space it was shown above that if w is trivial in g then z 0 b i 1 1 z 1 b i 2 2 b im mz m z is also trivial for all w we can check the triviality of this word for dif ferent values of consecutively so that it will use as much machine space as for checking triviality only for one fixed value of taken into account 17 check ing the triviality for some fixed requires not more than g w lg lg w machine space thus we obtained that the space function for the word problem algorithm is not larger than o w o g w lg lg w o g w lg lg w since triviality of the words in lemma 7 can be checked consecutively the space complexity function of the membership problem algorithm coincides with the space complexity function of the algorithm for the word problem 4 proof of the corollaries corollary 2 follows from the general fact that if groups a and b are solvable of lengths k and l respectively then awrb is solvable as well and the length of solvability is at most k l this and other properties of wreath products can be found in the book 14 in general the estimation l 2 in corollary 2 is optimal for example it was shown by ph hall 6 that the additive group q of rational numbers does not embed into a finitely generated metabelian group i e into a finitely gener ated group of solvability length at most 2 12 corollary 3 follows from the fact that for torsion free groups a and b since awrb ba b we get that awrb is torsion free as an extension of a tor sion free group by a torsion free group as a direct application of this fact we have that if h is torsion free then hwrz is torsion free as well therefore hwrz wrs is torsion free thus g is torsion free as a non trivial subgroup of a torsion free group for the property of locally indicability exactly the same argument works since the supports of the elements b i from the proof of theorem 1 are well ordered subsets of z i e bounded from the left side we have that the passive parts of the elements of the group k gp z b i i n have well ordered sup ports they are well ordered subsets of z the same way since c ks has a well ordered support we get that the supports of the passive parts of the elements of g gp c s are well ordered subsets of z now it becomes appar ent that since infinite cyclic groups are linearly ordered by their natural order according to lemma 1 the group k is linearly orderable therefore again by lemma 1 the group g kwrs is linearly orderable thus corollary 4 is proved acknowledgement i am grateful to alexander olshanskii for his encour agement to work on this paper for his support and many valuable discussions references 1 birget j c olshanskii a yu rips e sapir m v 2002 isoperimetric functions of groups and computational complexity of the word problem ann of math 156 2 467 518 2 boone w w higman g 1974 an algebraic characterization of groups with soluble word problem collection of articles dedicated to the memory of hanna neumann ix j austral math soc 18 41 53 3 clapham c r j 1967 an embedding theorem for finitely generated groups proc london math soc 17 419 430 4 collins d j 1969 on embedding groups and the conjugacy problem j london math soc 674 682 5 darbinyan a mikaelian v h 2012 on order preserving and verbal embeddings of the group q arxiv 1201 5505 6 hall p 1959 finiteness conditions for soluble groups proc london math soc 9 595 622 7 hall p 1974 on the embedding of a group in a join of given groups collection of articles dedicated to the memory of hanna neumann viii j austral math soc 17 434 495 13 http arxiv org abs 1201 5505 8 higman g neumann b h neumann h 1949 embedding theorems for groups j london math soc 24 247 254 9 mikaelian v h 2000 subnormal embedding theorems for groups j lon don math soc 62 2 398 406 10 mikaelian v h 2004 on normal verbal embeddings of some classes of groups beitrge algebra geom 45 2 501 516 11 mikaelian v h 2004 on embedding properties of sd groups int j math math sci 1 4 65 76 12 mikaelian v h 2003 an embedding construction for ordered groups j aust math soc 74 3 379 392 13 miller iii c f 1992 decision problems for groups survey and reflec tions algorithms and classification in combinatorial group theory 23 1 59 14 neumann h 1967 varieties of groups springer verlag 15 neumann b h neumann h 1959 embedding theorems for groups j london math soc 34 465 479 16 olshanskii a yu 2012 space functions of groups trans amer math soc no 364 4937 4985 17 olshanskii a yu osin d 2013 a quasi isometric embedding theorem for groups duke math journal 162 9 1622 1648 18 olshanskii a yu sapir m 2004 the conjugacy problem and higman embeddings mem amer math soc 804 19 phillips r e 1977 embedding methods for periodic groups proc london math soc 35 2 238 256 20 sapir m v birget j c rips e 2002 isoperimetric and isodiametric functions of groups ann of math 156 345 466 21 thompson r j 1980 embeddings into finitely generated simple groups which preserve the word problem word problems ii conf on decision problems in algebra oxford 1976 pp 401 441 stud logic foundations math 95 north holland amsterdam new york 401 441 22 wilson j s 1980 embedding theorems for residually finite groups math z 174 2 149 157 14 1 abstract 2 introduction 3 proof of theorem 4 proof of the corollaries