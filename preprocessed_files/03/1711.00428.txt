ar x iv 1 71 1 00 42 8 v 2 m at h l o 2 8 s ep 2 01 8 on ordinal invariants in well quasi orders and finite antichain orders mirna dz amonja sylvain schmitz and philippe schnoebelen abstract we investigate the ordinal invariants height length and width of well quasi orders wqo with particular emphasis on width an invariant of interest for the larger class of orders with finite antichain condition fac we show that the width in the class of fac orders is completely determined by the width in the class of wqos in the sense that if we know how to calculate the width of any wqo then we have a procedure to calculate the width of any given fac order we show how the width of wqo orders obtained via some classical constructions can sometimes be computed in a compositional way in particular this allows proving that every ordinal can be obtained as the width of some wqo poset one of the difficult questions is to give a complete formula for the width of cartesian products of wqos even the width of the product of two ordinals is only known through a complex recursive formula although we have not given a complete answer to this question we have advanced the state of knowledge by considering some more complex special cases and in particular by calculating the width of certain products containing three factors in the course of writing the paper we have discovered that some of the relevant literature was written on cross purposes and some of the notions re discovered several times therefore we also use the occasion to give a unified presentation of the known results keywords wqo width of wqo ordinal invariants 1 introduction in the finite case a partial order also called a poset p has natural car dinal invariants a width which is the cardinal of its maximal antichains and a height which is the cardinal of its maximal chains the width and height are notably the subject of the theorems of dilworth 1950 and mirsky 1971 respec tively see west 1982 for a survey of these extremal problems in the infinite case cardinal invariants are however less informative especially for countable posets while the theorems of dilworth and mirsky are well known to fail peles 1963 schmerl 2002 when the poset at hand enjoys additional conditions the corresponding ordinal invariants offer a richer theory as studied for instance by kr z and thomas 1990 namely if p has the the finite antichain condition fac meaning that its antichains are finite then the tree inc p def x 0 x 1 xn p 0 n 0 i j n xi xj mirna dz amonja thanks the leverhulme trust for a research fellowship for the academic year 2014 2015 the simons foundation for a visiting fellowship in the autumn of 2015 and the isaac newton institute in cambridge for their support during the hif programme in the autumn of 2015 supported by epsrc grant number ep k 032208 1 she most gratefully acknowledges the support of the institut d histoire et de philosophie des sciences et des techniques ihpst at the university paris 1 where she is as an associate member the three authors thank the london mathematical society for their support through a scheme 3 grant 1 http arxiv org abs 1711 00428 v 2 2 m dz amonja s schmitz and ph schnoebelen of all non empty finite sequences of pairwise incomparable elements of p ordered by initial segments has no infinite branches note that the tree inc p does not necessarily have a single root and that the empty sequence is excluded the latter is a matter of aesthetics but it does make various arguments run more smoothly by not having to consider the case of the empty sequence separately therefore inc p has a rank which is the smallest ordinal such that there is a function f inc p with s t f s f t for all s t inc p this ordinal is called the width of p and in this paper we denote it by w p it was denoted by wd p by kr z and thomas 1990 similarly if p is well founded wf also called artinian meaning that its descending sequences are finite then the tree dec p def x 0 x 1 xn p 0 n 0 i j n xi xj of non empty strictly descending sequences has an ordinal rank which we denote by h p kr z and thomas denote it by ht p and call the height of p finally if p is both well founded and fac i e is a well partial order wpo then the tree bad p def x 0 x 1 xn p 0 n 0 i j n xi 6 xj of non empty bad sequences of p has an ordinal rank which we denote by o p and call the maximal order type of p after de jongh and parikh 1977 and schmidt 1979 kr z and thomas denote it by c p blass and gurevich call it the stature of p in the finite case this invariant is simply the cardinal of the poset quite some work has already been devoted to heights and maximal order types and to their computation widths are however not that well understood as kr z and thomas 1990 rem 4 14 point out they do not enjoy nice characteri sations like heights and maximal order types do and the range of available results and techniques on width computations is currently very limited our purpose in this paper is to explore to what extent we can find such a char acterisation and provide formul for the behaviour of the width function under various classically defined operations with partial orders regarding the first point we first show in sec 3 that the width coincides with the antichain rank defined by abraham and bonnet 1999 which is the height of the chains of antichains however unlike the height and maximal order type of wpos the width might not be attained rem 3 7 regarding the second point we first show in sec 2 6 that computing widths in the class of fac orders reduces to computing widths in the class of wpos we recall several techniques for computing ordinal invariants and apply them in sec 4 to obtain closed formul for the width of sums of posets and for the finite multisets finite sequences and tree extensions of wpos one of the main questions is to give a complete formula for the width of the cartesian products of wpos even the width of the product of two ordinals is only known through a complex recursive formula due to abraham see sec 4 4 and we only have partial answers to the general question the three ordinal invariants appear in different streams of the literature often unaware of the results appearing in one another and using different definitions and notations another motivation of this paper is then to provide a unified presentation of the state of the knowledge on the subject and we also recall the corresponding results for heights and maximal order types as we progress through the paper 2 background and basic results 2 1 posets and quasi orders we consider posets and more generally quasi orders qo when q q is a qo we write x q y when x q y and y 6 q x we write x q y when x 6 q y and y 6 q x and say that a and b are incomparable on ordinal invariants in well quasi orders 3 we write x q y when x q y y q x this is an equivalence and the quotient q q q is a poset that as far as ordinal invariants are concerned is indis tinguishable from q therefore we restrict our attention to posets for technical reasons but without any loss of generality note that some constructions on posets e g taking powersets yield quasi orders that are not posets a qo q is total if for all x y in q x q y or x q y a total poset is also called a chain when a qo does not have infinite antichains we say that it satisfies the finite antichain condition or simply that it is fac a qo that does not have any infinite strictly decreasing sequence is said to be well founded or wf a well quasi order or wqo is a qo that is both wf and fac it is well known that a qo is wqo if and only if it does not have any infinite bad sequence kruskal 1972 milner 1985 where a sequence x 0 x 1 x 2 is good if xi xj for some positions i j and is bad otherwise for a qo q we define the reverse qo q as q that is to say x q y if and only if x q y an augmentation of q is a qo q such that x y x y i e is a subset of a substructure of a qo q is a qo q such that q q and in this case we write q q 2 2 rankings and well founded trees recall that for every wf poset p there exist ordinals and order preserving functions f p that is such that x p y f x f y for all x y p the smallest such ordinal is called the rank of p one can obtain the associated ranking function r p by defining inductively r x sup r y 1 y p x and the rank turns out to be equal to its height h p see sec 2 3 when p is total i e is a chain then its rank is also called its order type traditionally for a tree t t one says that it is well founded if it does not have an infinite branch which with the notation above amounts to saying that the reverse partial order t t is well founded this somewhat confusing notation implies that for rooted well founded trees the root s have the largest rank and the leaves have rank 0 in our definitions of ordinal invariants given in the introduction we considered trees of non empty finite sequences ordered by initial segments if s x 0 x 1 xn and t y 0 y 1 ym we write s e t and say that s is an initial segment of t when n m and s y 0 yn equivalently the associated strict ordering s t means that t can be obtained by appending some sequence t after s denoted t s t we also make an easy but important observation regarding substructures when p is embedded in q as an induced substructure then w p w q and similarly for o and h indeed every antichain bad sequence decreasing sequence resp of p is an antichain bad sequence decreasing sequence resp of q so the ranks of the corresponding trees can only increase when going from p to q 2 3 residual characterisation for a poset p x p and 6 we define the residual of p at x as the induced poset defined by 1 p x def y p y x since this is an induced substructure of p p x is fac resp wf wpo whenever p is fac resp wf wpo the interest of residuals resp residuals 6 residuals is that they provide the range of choices for continuing incomparable resp descending bad sequences once element x has been chosen as first element the suffix of the sequence should belong to p x and we have recursively reduced the problem to measuring the rank of the tree inc p x resp dec p x bad p 6 x the following lemma shows precisely how we can extract the rank from such a recursive decomposition of the tree 4 m dz amonja s schmitz and ph schnoebelen lemma 2 1 1 suppose that ti i i is a family of well founded trees and let t be their disjoint union then t is a well founded tree and it has rank t supi i ti 2 let t t f denote a tree rooted at t with f t t and suppose that f is well founded of rank f then so is t and t f 1 proof of 1 it is clear that t is well founded for each i i let fi ti ti be a function witnessing the rank of ti then f def i i fi is an order reversing function from t to def supi i ti showing t conversely if f t t is a witness function for the rank of t its restriction to any ti is order reversing showing that ti t proof of 2 clearly t is well founded let def f 1 sup f 1 1 consider the ranking function r f f and let f t be given by f s def r s if s f sup f 1 if s t it is clear that f is an order reversing function witnessing h t suppose that and that h t is an order reversing function in particular h r f r so let f be such that h r 1 let s f be such that f s hence h r h s yet r t s a contradiction 2 1 lemma 2 1 yields the equations 2 w p sup x p w p x 1 h p sup x p h p x 1 o p sup x p o p 6 x 1 that hold for any fac wf or wpo poset p respectively note that it yields w h o 0 equation 2 is used very frequently in the literature and provides for a method for computing ordinal invariants recursively which we call the method of residuals equation 2 further shows that the function r x def h p x is the optimal ranking function of p thus h p is the rank of p i e the minimal such that there exists a strict order preserving f p recall sec 2 2 2 4 games for wqo invariants one limitation of the method of residu als is that it tends to produce recursive rather than closed formul see e g schmitz and schnoebelen 2011 another proof technique adopts a game theoretical point of view this is based on blass and gurevich 2008 3 which in turn can be seen as an application of a classical game for the rank of trees to the specific trees used for the ordinal invariants we shall use this technique to obtain results about special products of more than two orders see for example thm 4 18 the general setting is as follows for a wqo p and an ordinal the game g p where is one of h o w is a two player game where positions are pairs s of an ordinal and a sequence over p we start in the initial position at each turn and in position s player 1 picks an ordinal and player 2 answers by extending s with an element x from p player 2 is only allowed to pick x so that the extended s s x is a decreasing sequence or a bad sequence or an antichain when h resp o or w and he loses the game if he cannot answer player 1 s move after player 2 s move the new position is s and the game continues player 2 wins when the position has 0 and hence on ordinal invariants in well quasi orders 5 player 1 has no possible move the game cannot run forever so one player has a winning strategy applying blass and gurevich 2008 prop 23 we deduce that player 2 wins in g p iff p as we are mostly interested in the invariant w we shall adopt the notation gp for g w p 2 5 cardinal invariants we can connect the ordinal invariants with cardinal measures but this does not lead to very fine bounds here are two examples of what can be said lemma 2 2 suppose that q is a fac quasi order of cardinal 0 then w q the cardinal successor of q proof the tree inc q has size equal to and therefore its rank is an ordinal 2 2 theorem 2 3 dushnik miller suppose that p is a wpo of cardinal 0 then h p proof this is an easy consequence of thm 5 25 in dushnik and miller 1941 by the definition of h it suffices to show that p has a chain of size define a colouring c on the set p 2 of pairs of p by saying c x y def 0 if x is comparable to y and c x y def 1 otherwise then use the relation 0 2 meaning that p has a chain of cardinal or an antichain of cardinal 0 which for 0 is the ramsey theorem and for 0 is the dushnik miller theorem since p is fac we must have a chain of order type at least 2 3 such results are however of little help when the poset at hand is countable because they only tell us that the invariants are countable infinite as expected this justifies the use of ordinal invariants rather than cardinal ones 2 6 wpos as a basis for fac posets a lexicographic sum of posets in some family pi i q of disjoint orders along a poset q q denoted by i q pi is defined as the order on the disjoint union p of pi i q such that for all x y p we have x y iff x y pi for some i q and x pi y or x pi and y pj for some i j q satisfying i q j the lexicographic sum of copies of p along q is denoted by p q and called the direct product of p and q the disjoint sum of posets in pi i q is defined as the union of the orders pi this is just a special case of a lexicographic sum where the sum is taken over an antichain q in the case of two orders p 1 p 2 the lexicographic sum is denoted by p 1 p 2 as a consequence of thm 7 3 of abraham et al 2012 by taking the union over all infinite cardinals one obtains the following classification theorem theorem 2 4 abraham et al let bp be the class of posets which are either a wpo the reverse of a wpo or a linear order let p be the closure of bp under lexicographic sums with index set in bp and augmentation then p is exactly the class of all fac posets we will use the classification in thm 2 4 to see that if we know how to calculate w p for p an arbitrary wpo then we can bound w p for any fac poset p this in fact follows from some simple observations concerning the orders in the class bp lemma 2 5 1 if p is total then w p 1 in general if all the antichains in a poset p are of length n for some n then w p n and w p n in the case that there are antichains of length n 2 for any poset p inc p inc p and hence in the case of fac posets we have w p w p 6 m dz amonja s schmitz and ph schnoebelen 3 if p is an augmentation of a fac poset p then inc p is a subtree of inc p and therefore w p w p 4 let p be the lexicographic sum of posets pi i l along some linear order l then inc p i l inc pi and in the case of fac posets we have w p supi l w pi proof 1 the only non empty sequences of antichains in a linear order p are the singleton sequences it is clear that the resulting tree inc p has rank 1 by assigning the value 0 to any singleton sequence the more general statement is proved in the same way namely if all the antichains in a poset p are of length n for some n then it suffices to define f inc p n by letting f s def n s 2 3 obvious 4 this is the same argument as in thm 4 1 3 2 5 in conjunction with thm 2 4 we conclude that the problem of bounding the width of any given fac poset is reduced to knowing how to calculate the width of wqo posets this is the consideration of the second part of this article starting with sec 4 3 characterisations of ordinal invariants we recall in this section the known characterisations of ordinal invariants with the method of residuals we can follow kr z and thomas 1990 and show that the height and maximal order types of wpos also correspond to their maximal chain heights sec 3 1 and maximal linearisation heights sec 3 2 relying on results of wolk 1967 and de jongh and parikh 1977 to show that these maxima are indeed attained in a similar spirit the width of a fac poset is equal to its antichain rank sec 3 4 an invariant studied by abraham and bonnet 1999 but this time it is not necessarily attained finally in sec 3 5 we recall an inequality relating all three invariants and shown by kr z and thomas 1990 3 1 height and maximal chains given a wf poset p let c p denote its set of non empty chains each chain c from c p is well founded and has a rank h c we denote the supremum of these ranks by rkcp def supc c p h c as explained for example by kr z and thomas 1990 thm 4 9 we have 3 rkcp h p and this can be shown for instance by induction on the height using the method of residuals indeed 3 holds when p and for the induction step sup c c p h c 2 sup c c p sup x c h c x 1 sup x p sup c c p x h c 1 because c x is a chain in c p x and then by induction hypothesis 3 sup c c p h c sup x p h p x 1 2 h p remark 3 1 the inequality in 3 can be strict for instance consider the forest f defined by the disjoint union cn n n along n where each cn is a chain of height n and add a new top element t yielding p def t f then p is wf but not fac and is thus not a wpo note that h p h f 1 1 however every chain c in c p is included in t cn for some n and has height bounded by n 1 while rkc p h p 3 1 on ordinal invariants in well quasi orders 7 wolk 1967 thm 9 further shows that when p is a wpo the supremum is attained i e there is a chain c with rank h c rkcp in such a case 3 can be strengthened to 4 max c c p h c rkcp h p as can be checked by well founded induction with h p 2 sup x p h p x 1 sup x p h cx 1 sup x p h cx x sup c c p h c where cx is a chain of p x witnessing 4 by induction hypothesis and cx x is therefore a chain in c p of height h cx 1 theorem 3 2 wolk kr z and thomas let p be a wpo then h p rkcp maxc c p h c is the maximal height of the non empty chains of p more generally the wpo condition in thm 3 2 can be relaxed using the follow ing result proven in pouzet 1979 schmidt 1981 milner and sauer 1981 theorem 3 3 pouzet schmidt milner and sauer let p be a wf poset then either rkcp maxc c p h c i e there exist chains of maximal height or there exists an antichain a of p such that the set of heights h p x x a is infinite 3 2 maximal order types and linearisations a linearisation of a poset p is an augmentation l p which is a total order x y implies x y we let l p denote the set of linearisations of p as stated by de jongh and parikh 1977 a poset is a wpo if and only if all its linearisations are well founded de jongh and parikh furthermore considered the supremum supl l p h l of the order types of the linearisations of p and showed that this supremum was attained de jongh and parikh 1977 thm 2 13 this is also the subject of of blass and gurevich 2008 thm 10 theorem 3 4 de jongh and parikh kr z and thomas let q be a wqo then o q maxl l q h l is the maximal height of the linearisations of q 3 3 maximal order types and height of downwards closed sets a sub set d of a wqo q is downwards closed if for all y in d and x y x also belongs to d we let d q denote the set of downwards closed subsets of q for instance when q d is isomorphic to 1 it is well known that a quasi order q is wqo if and only if it satisfies the descending chain condition meaning that d q is well founded therefore d q has a rank h d q when q is wqo as shown by blass and gurevich 2008 prop 31 this can be compared to the maximal order type of q theorem 3 5 blass and gurevich let q be a wqo then o q 1 h d q 3 4 width and antichain rank abraham and bonnet 1999 consider a struc ture similar to the tree inc p for fac posets p namely the poset a p of all non empty antichains of p in the case of a fac poset the poset a p is well founded let us call its height the antichain rank of p and denote it by rkap def h a p this is the smallest ordinal such that there is a strict order preserving function from a p to in fact the antichain rank and the width function we study have the same values as we now show thus one can reason about the width w p by looking at the tree inc p or at a p a different structure theorem 3 6 let p be a fac poset then w p rkap 8 m dz amonja s schmitz and ph schnoebelen proof let rkap and let r a p be such that s t r s r t for all non empty antichains s t define f inc p by letting for s non empty f s def r s where s is the set of elements of s this function satisfies s t f s f t and hence w p rkap conversely let w p and f inc p be such that s t f s f t for a non empty antichain s a p observe that there exist finitely many precisely s sequences s in inc p with support set s call this set lin s and define r a p by r s def mins lin s f s consider now an antichain s with r s f s for some s lin s and an antichain t with t s then there exists an extension t of s in lin t which is therefore such that f s f t and hence r s f s f t r t thus w p rkap 3 6 remark 3 7 the width w p is in general not attained i e there might not exist any chain of antichains of height w p first note that even when p is a wpo a p is in general not a wpo hence thm 3 2 does not apply in fact examples of fac posets where the width is not attained abound consider indeed any fac poset p with w p and any non empty chain c in c a p as c is well founded for it has a minimal element which is an antichain a a p such that for all a 6 a in c a a since p is fac a is finite and c is therefore finite as well h c 3 7 3 5 relationship between width height and maximal order type as we have seen in the previous discussion w p h a p the antichain rank where antichains are ordered by reverse inclusion kr z and thomas 1990 thm 4 13 proved that there is another connection between the ordinal functions discussed here and the width function the statement uses natural products of ordinals recall for this that the cantor normal form cnf of an ordinal 0 m 0 m is determined by a non empty decreasing sequence 0 1 0 of ordinals and a sequence of natural numbers mi 0 cantor proved that every ordinal has a unique representation in this form two well known operations can be defined based on this representation the natural or hessenberg sum is defined by adding the coefficients of the normal forms of and as though these were polynomials in the natural or hessenberg product is obtained when the normal forms of and are viewed as polynomials in and multiplied accordingly theorem 3 8 kr z and thomas for any wqo q the following holds w q o q h q w q 5 for completeness we give a detailed proof proof for the first inequality clearly any antichain in q can be linearised in an arbitrary way in a linearisation of q so w q is certainly bounded above by the length of the maximal such linearisation which by thm 3 4 is exactly the value of o q for the second inequality let w q and let g inc q be a function witnessing that also let h q and let q be the rank function for any bad sequence q 0 q 1 qn in q we know that i j n implies that either qi is incomparable with qj or qi qj and hence in the latter case qi qj fixing a bad sequence s q 0 q 1 qn consider the set ss def qi 0 qi 1 qim i 0 i 1 im n qi 0 qi 1 qim on ordinal invariants in well quasi orders 9 in other words ss consists of subsequences of s that end with qn and where all elements are incomparable so for each t ss the value g t is defined we define that s is the minimum over all g t for t ss the intuition here is that is an ordinal measure for the longest incomparable sequence within a bad sequence now we are going to combine and into a function f defined on bad sequences given such a sequence s q 0 q 1 qn we let f s def q 0 q 0 q 1 q 0 q 1 qn q 0 q 1 qn noticing that every non empty subsequence of a bad sequence is bad we see that f is a well defined function which maps bad q into the set of finite sequences from moreover let us notice that every sequence in the image of f is a bad sequence in if i j and qi qj let t be a sequence from s q 0 q 1 q 2 qi such that g t q 0 q 1 q 2 qi hence t includes qi and for every qk t we have qk qi qj therefore t qj was taken into account when calculating q 0 q 1 q 2 qj in particular 6 q 0 q 1 q 2 qj g t qj g t q 0 q 1 q 2 qi then qi q 0 q 1 q 2 qi 6 qj q 0 q 1 q 2 qj another possibil ity when i j is that qi qj and it yields the same conclusion we have therefore shown that f bad q bad let us also convince ourselves that f is a tree homomorphism meaning a function that preserves the strict tree order the tree bad q is ordered by initial segments the order which we have denoted by if s t then obviously f s f t given that it is well known and easy to see that tree homomorphisms can only increase the rank of a tree we have that o q o the latter as shown by de jongh and parikh 1977 is equal to w q h q note that is commutative 3 8 from thm 3 8 we derive a useful consequence recall that is additive or multiplicative principal if implies respectively implies these implications also hold for natural sums and products corollary 3 9 assume that o q is a principal multiplicative ordinal and that h q o q then w q o q proof assume by way of contradiction that w q o q from h q o q we deduce h q w q o q since o q is multiplicative principal contradicting the inequality 5 in thm 3 8 hence w q o q and necessarily w q o q again by 5 3 9 4 computing the invariants of common wqos we now consider wqos obtained in various well known ways and address the question of computing their width and recall along the way what is known about their height and maximal order type in the ideal case there would be a means of defining well quasi orders as the clo sure of some simple orders in the hausdorff like spirit of thm 2 4 unfortunately no such result is known and indeed it is unclear which class of orders one could use as a base for example how would one obtain rado s example see sec 4 6 from a base of any reasonable orders therefore our study of the width of wqo orders will have to be somewhat pedestrian concentrating on concrete situations 4 1 lexicographic sums in the case of lexicographic sums along an ordinal defined in sec 2 6 we have the following result lemma 4 1 suppose that for an ordinal we have a family of wqos pi i then i pi is a wqo and 10 m dz amonja s schmitz and ph schnoebelen 1 o i pi i o pi 2 h i pi i h pi 3 w i pi supi w pi proof first note that any infinite bad sequence in i pi would either have an infi nite projection to or an infinite projection to some pi which is impossible hence i pi is a wqo therefore the values w i pi o i pi and h i pi are well defined 1 we use thm 3 2 let i def o pi then i i is isomorphic to a lin earisation of i pi hence o i pi i o pi suppose that l is a linearisation of i pi necessarily a well order then the projection of l to each pi is a linearisation of pi and hence it has type i this gives that the type of l is i i proving the other side of the desired inequality 2 we use thm 3 4 any chain c in i pi can be obtained as c i ci where ci is the projection of c on the coordinate i the conclusion follows as in the case of o 3 every non empty sequence of incomparable elements in p must come from one and only one pi hence inc p i l inc pi and therefore w pi supi w pi by lem 2 1 4 1 4 2 disjoint sums we also defined disjoint sums in sec 2 6 as sums along an antichain lemma 4 2 suppose that p 1 p 2 is a family of wqos 1 o p 1 p 2 o p 1 o p 2 2 h i pi sup h pi i 3 w p 1 p 2 w p 1 w p 2 proof 1 is thm 3 4 from de jongh and parikh 1977 2 is clear since for an arbitrary family pi of wqos dec i pi is isomorphic to i dec pi we observe that for infinite families i pi is not wqo but it is still well founded hence has a well defined height 3 is lem 1 10 from abraham and bonnet 1999 about antichain rank which translates to widths thanks to thm 3 6 4 2 we can apply lexicographic sums to obtain the existence of wqo posets of every width corollary 4 3 for every ordinal there is a wqo poset p such that w p proof the proof is by induction on for finite the conclusion is exemplified by an antichain of length for a limit ordinal let us fix for each a wpo p satisfying w p then w p sup as follows by lem 4 1 for 1 we take p p 1 i e p with an extra incomparable element added and rely on w q 1 w q 1 w q 1 shown in lem 4 2 4 3 4 3 direct products direct products are again a particular case of lexicographic sums along a poset q this time of the same poset p while the cases of o and h are mostly folklore the width of p q is not so easily understood and its computation in lem 1 11 from abraham and bonnet 1999 uses the notion of heisenberg products defined for any ordinal by induction on the ordinal 0 def 0 1 def def sup 1 where is a limit ordinal note that this differs from the natural product and is not commutative 2 but 2 2 on ordinal invariants in well quasi orders 11 lemma 4 4 abraham and bonnet suppose that p and q are two wpos 1 o p q o p o q 2 h p q h p h q 3 w p q w p w q 4 4 cartesian products the next simplest operation on wqos is their carte sian product it turns out that the simplicity of the operation is deceptive and that the height and especially the width of a product p q are not as simple as we would like as a consequence this section only provides partial results and is unexpectedly long to recall the product order p q of two partial orders is defined on the pairs p q with p p and q q so that p q p q iff p p p and q q q it is easy to check and well known that product of wqos is wqo and similarly for fac and wf orders the formula for calculating o p q is still simple it was first established by de jongh and parikh 1977 thm 3 5 see also blass and gurevich 2008 thm 6 lemma 4 5 de jongh and parikh suppose that p and q are two wqos then o p q o p o q the question of the height of products is also well studied and a complete answer appears in abraham 1987 where it is stated that the theorem is well known the following statement is a reformulation of lem 1 8 of abraham 1987 lemma 4 6 abraham folklore if p p h p and q q h q are the rank functions of the well founded posets p and q then the rank function on p q is given by x y p x q y in particular h p q sup 1 h p h q we recall that for any two ordinals and we have sup 1 see e g abraham and bonnet 1999 p 55 thus the statement in thm 4 6 cannot be easily simplified remark 4 7 height of products of finite ordinals the very nice general proof of abraham 1987 lem 1 8 can be done in an even more visual way in the case of finite ordinals let p n 1 nk for some finite n 1 nk then h p n 1 nk 1 k indeed we observe that any chain a 1 p p a in p leads to a strictly increasing a 1 a where by a we denote the sum of the numbers in a since a is at most i ni 1 i ni k and since a 1 is at least 0 the longest chain has length 1 i ni k furthermore it is easy to build a witness for this length we conclude by invoking thm 3 4 which states that for any wpo p h p is the length of the longest chain in p 4 7 having dealt with h and o we are left with w here we cannot hope to have a uniform formula expressing w p q as a function of w p and w q indeed already in the case of ordinals one always has w w 1 while w has quite a complex form as we are going to see next 4 4 1 products of ordinals probably the simplest example of wqo which is not actually an ordinal is provided by the product of two ordinals thanks to thm 3 6 we can translate results of abraham 1987 section 3 to give a recursive formula which completely characterises w for ordinals we shall sketch how this is done first note that if one of is a finite ordinals n say n then we have w n min n the next case to consider is that of successor ordinals 12 m dz amonja s schmitz and ph schnoebelen which is taken care by the following thm 4 8 abraham proved this theorem using the method of residuals and induction we offer an alternative proof using the rank of the tree inc theorem 4 8 abraham for any ordinals with infinite we have w 1 w 1 the proof is provided by the next two lemmas lemma 4 9 w 1 w 1 for any ordinals proof write i for inc 1 and i for inc any sequence s p 1 p which is in i is either in i or contains a single pair of the form pi a with a in the latter case we write s for s with pi removed note that s is in i except when s has length 1 let i rank i w be a ranking function for i and define i on via s def s 1 if s i s if s 6 i and s 1 rank i otherwise one easily checks that is anti monotone for this assume s t 1 if both s and t are in i monotonicity is inherited from 2 if none are in i then s t or s is empty and again monotonicity is inherited or s rank i t t 3 if s is in i and t is not then s e t entailing s t so that s s 1 t t in conclusion having values in w 1 witnesses the assertion of the lemma 4 9 lemma 4 10 if is infinite then w 1 w 1 for any proof write i for inc any s i has the form s a 1 b 1 a b we write s for the sequence a 1 1 b 1 a 1 b and observe that it is still a sequence over since is infinite and that its elements form an antichain since the elements of s did let now s be r s where r 0 the prepended element is not comparable with any element of s so that s is an antichain and s e t iff s e t iff s e t write i for s s i r this is a tree made of a root glued below a tree isomorphic to i hence rank i rank i 1 on the other hand i is a substructure of inc 1 hence w 1 rank i 4 10 with thm 4 8 in hand the remaining case is to compute w when are limit ordinals this translates into saying that and for some 0 a recursive formula describing the weight of this product is the main theorem of section 3 of abraham 1987 which we now quote it is proved using a complex application of the method of residuals and induction theorem 4 11 abraham suppose that and are given in their cantor normal forms 0 m 0 0 n 0 where 0 m 0 and 0 n 0 are the leading terms and and are the remaining terms of the cantor normal forms of and respectively then if 1 we have w and in general w 0 0 m 0 n 0 1 w 0 w 0 it would be interesting to have a closed rather than a recursive formula for the width of the product of two ordinals however the formula does give us a closed form of values of the weight of the product of two ordinals with only one term in the cantor normal form as we now remark here m n are finite ordinals 1 on ordinal invariants in well quasi orders 13 1 if k then we have w 1 k m 1 n w k m n k 1 m n 1 2 example 3 4 3 from abraham 1987 if then 1 and 1 so w m n w m n m n 1 3 if and k then w m 1 k n k m n 1 let us mention one more result derivable from thm 4 11 lemma 4 12 abraham w for any ordinal proof by induction on if is a limit we write it 0 m 0 m now thm 4 11 yields w 0 m 0 m if is a successor we use lem 4 9 and 4 10 4 12 4 4 2 finite products and transferable orders since the width of the product of two ordinals is understood we can approach the general question of the width of products of two or a finite number of wqo posets pi by reducing it to the width of some product of ordinals using that strategy we give a lower bound to w i npi theorem 4 13 for any wqo posets p 0 p 1 pn w i n pi w i n h pi the proof follows directly from a simple lemma which is of independent interest lemma 4 14 suppose that p 0 p 1 pn are wqo posets then i n h pi em beds into i n pi as a substructure proof we use thm 3 2 and pick in each pi a chain ci in pi that has order type h ci h pi then i n ci is an induced suborder of i n h pi which is isomorphic to i n h pi 4 14 now we shall isolate a special class of orders for which it will be possible to calculate certain widths of products let us write x for the downwards closure of an element x i e for y x y definition 4 15 a fac partial order p belongs to the class t of transferable orders if w p x 1 xn w p for any finitely many elements x 1 xn p theorem 4 16 suppose that p is a wqo transferable poset and is an ordinal then w p w p proof write for w p we prove that player 2 has a winning strategy denoted p for each game gp where p is some p y 1 yn and the proof is by induction on if 0 then 0 and player 1 loses immediately if is a limit the strategy for player 2 depends on player 1 s first move say it is then means that for some player 2 chooses one such and now applies p 1 which exists and is winning by the induction hypothesis for the whole game note that a strategy for a substructure p of the original p will lead to moves that are legal in the original game also note that 1 is if 1 is a successor then player 2 answers each move 1 m played by player 1 by writing it in the form i i i with i note that i if 1 m note that 1 2 m let player 2 play xm where xm is p applied on 1 m that strategy exists and is winning since p is transferable and has width if m then player 2 switches strategy and 14 m dz amonja s schmitz and ph schnoebelen now uses p as if a new game was starting with m as player 1 s first more and for p p x 1 xm 1 by the induction hypothesis player 2 will win by producing a sequence s in p these moves are legal since x 1 xm 1 s is an antichain in p 1 4 16 in order to use thm 4 16 we need actual instances of transferable orders lemma 4 17 for any 1 1 n the order p 1 n is transfer able proof since each i is additive principal p x 1 xm contains an isomorphic copy of p for any finite sequence x 1 xm of elements of p 4 17 theorem 4 18 let p be a transferable wpo poset 1 suppose that 1 m then w p m w p m w p m 2 if w p for some then w p m w p m note that this applies to any p which is the product of the form see the examples after thm 4 11 3 w 2 an easy way to provide an upper bound needed in the proof of thm 4 18 is given by the following observation lemma 4 19 for any fac poset p and 1 m w p m w p m proof we just need to remark that p m is an augmentation of the perpendicular sum i mp and then apply lem 4 2 4 19 proof of thm 4 18 1 we get w p m w p m from thm 4 16 we get w p m w p m from lem 4 19 2 this follows because m m 3 let p hence we know thatw p since any p m is a substructure of p we clearly have that w p supm w p m supm m 2 let us now give a proof using games that w p 2 it suffices to give a winning strategy to player 1 in the game gp for any ordinal 2 so given such a player 1 starts the game by choosing as his first move the ordinal 2 player 2 has to answer by choosing an element x in p say an element p m with p k now notice that any element of p that is incompatible with p m is either an element of p m or of the form q n for some q p in or is of the form r i for some r which is incompatible with p in therefore any next step of player 2 has to be in an order p which is isomorphic to an augmentation of a substructure of the disjoint union of the form 7 p m k 1 1 k 1 1 it now suffices for player 1 to find an ordinal o 2 satisfying o w p as the game will then be transferred to gp o where player 1 has a winning strategy as 2 is closed under it suffices to show that each of the orders appearing in equation 7 has weight 2 this is the case for p m by 2 we have that w k 1 1 w k 1 1 which by applying lem 4 19 is 1 k 1 for k 1 we apply lem 4 19 to to obtain w k 1 k 1 and similarlyw 1 1 4 18 4 5 finite multisets sequences and trees well quasi orders are also pre served by building multisets sequences and trees with wqo labels together with suitable embedding relations finite sequences in q are compared by the subsequence embedding ordering defined by s x 0 xn 1 s x 0 x p 1 if there exists f n p on ordinal invariants in well quasi orders 15 strictly monotone such that xi x f i in q for all i n the fact that q is wqo when q is wqo was first shown by higman 1952 given a wqo q a finite multiset over q is a function m from q n with finite support i e m x 0 for finitely many x q equivalently a finite multiset is a finite sequence m in q where the order is irrelevant and can be noted as a set with repetitions m x 1 xn we denote by m q the set of finite multisets over q the multiset embedding ordering is then defined by m x 0 xn 1 m x 0 x p 1 if there exists an injective function f n p with xi x f i in q for all i n as a consequence of q being wqo m q is also wqo when q is finally a rooted ordered finite tree t over q is either a leaf x for some x q or a term x t 1 tn for some n 0 x q and t 1 tn trees over q a tree has arity b if we bound n by b in this definition we let t q denote the set of finite trees over q the homeomorphic tree embedding ordering is defined by t x t 1 tn t t x t 1 t p where n p 0 if at least one the following cases occurs t t t j for some 1 j p or x x in q and t 1 tn t 1 t p for the subsequence embedding relation on t q the fact that t q t is wqo when q is wqo was first shown by higman 1952 for trees of bounded arity before kruskal 1960 proved it in the general case note that it implies q being wqo for the special case of trees of arity 1 4 5 1 maximal order types the maximal order types of m q q and t q have been studied byweiermann 2009 and schmidt 1979 see also van der meeren 2015 sec 1 2 for a nice exposition of these results for finite multisets with embedding we need some additional notations for an ordinal with cantor normal form 1 n where o p 1 n we let 8 def 1 n where is 1 when is an epsilon number i e when and is just otherwise the following is weiermann 2009 thm 2 with a corrected proof due to van der meeren et al 2015 thm 5 theorem 4 20 weiermann let q be a wqo then o m q o q thus for o q 0 one has simply o m q o q for finite sequences with subsequence embedding we recall the following result by schmidt 1979 theorem 4 21 schmidt let q be a wqo then o q o q 1 if o q is finite o q 1 if o q n for an epsilon number and n finite o q otherwise the case of finite trees is actually a particular case of the results of schmidt 1979 on embeddings in structured trees her results were originally stated using schu tte s klammer symbols but can be translated in terms of the functions of rathjen and weiermann 1993 defining such ordinal notation systems is beyond 16 m dz amonja s schmitz and ph schnoebelen the scope of this chapter it suffices to say for our results that the ordinals at hand are going to be principal multiplicative theorem 4 22 schmidt let q be a wqo then o t q o q 4 5 2 heights for a wqo q we define h q as 9 h q def h q if h q is additive principal h q otherwise we are going to show that the heights of finite multisets finite sequences and finite trees over q is the same namely h q theorem 4 23 let q be a wf poset then h m q h q h t q h q since obviously h m q h q h t q the claim is a consequence of lemmata 4 24 and 4 26 below lemma 4 24 h t q h q proof consider a strictly decreasing sequence x 0 t x 1 t in t q where each xi is a finite tree over q necessarily these finite trees have a nonincreasing number of nodes x 0 x 1 if we add a new minimal element below q we can transform any xi by padding it with some s so that now the resulting x i has the same shape and size as x 0 let us use 1 q instead of q so that the new trees belong to t 1 q have all the same shape and form a strictly decreasing sequence this construction is in fact an order reflection from dec t q to dec n 1 q n from which we get 10 h t q h n 1 q n sup n h 1 q n using lem 4 2 2 for the last equality for n one has 11 h 1 q n sup n 1 1 h q using lemmata 4 1 2 and 4 6 if h q 1 h t q h q h q obviously for h q 1 and thanks to 10 and 11 it is sufficient to show that n 1 h q for all n and all 1 h q we consider two cases 1 if h q is additive principal 1 h q h q entails n h q thus n 1 h q h q 2 otherwise the cnf for h q is m i 1 i with m 1 then 1 h q implies 1 m thus n 1 1 m n 1 1 1 h q h q 4 18 let us write mn q for the restriction of m q to multisets of size n lemma 4 25 h mn q h q n proof with x x 1 xn q n we associate the multiset mx x 1 xn obviously x y implies mx my we further claim that my 6 mx indeed assume by way of contradiction that my mx then there is a permutation f of 1 n such that yi q xf i for all i 1 n from x y we get xi q yi q xf i q yf i xf f i yf f i q q xfk i q yfk i q so that for all j in the f orbit of i xj q xi q yj entailing y x which contradicts the assumption x y we have thus exhibited a mapping from qn to mn q that will map chains to chains hence h qn h mn q 4 24 on ordinal invariants in well quasi orders 17 lemma 4 26 h m q h q proof the result is clear in cases where h q h q and when h q 1 entail ing h m q h q so let us assume that h q is not additive principal and has a cnf m i 1 i with m 1 thus h q h q 1 1 since by lem 4 6 for 0 n h qn sup n 1 h q we deduce h qn 1 n 1 since mn q is a substructure of m q and using lem 4 25 we deduce h m q h mn q h q n 1 n 1 for all 0 n hence h m q sup n 1 n 1 1 h q 4 26 4 5 3 widths the previous analyses of the maximal order types and heights of m q q and t q allow us to apply the correspondence between o h and w shown by kr z and thomas 1990 thm 4 13 in particular its consequence spelled out in cor 3 9 theorem 4 27 let q be a wqo then w q o q where q can be t q or q when o q 1 or m q when o q 1 is a principal additive ordinal proof first observe that h q h q o q o q when q is t q by thm 4 22 q with o q 1 by thm 4 21 or m q with o q 1 by thm 4 20 furthermore when q is t q or q and when it is m q with o q a principal additive ordinal o q is a principal multiplicative ordinal thus cor 3 9 shows that w q o q 4 27 the assumptions in thm 4 27 seem necessary for instance if q 1 then m 1 is isomorphic to 1 and with height and width 1 if a 3 1 1 1 is an antichain with three elements then m a 3 is isomorphic with h m a 3 by lem 4 6 or thm 4 23 o m a 3 3 by lem 4 5 and w m a 3 2 by thm 4 18 3 4 6 infinite products and rado s structure one may wonder what happens in the case of infinite products we remind the reader that the property of being wqo is in general not preserved by infinite products the classical example for this was provided by rado in rado 1954 who defined what we call the rado structure denoted r 1 rado s order is given as a structure on where we define a b a b if a a and b b or b a the definition of bqos was motivated by trying to find a property stronger than wqo which is preserved by infinite products so in particular rado s example is not a bqo see milner 1985 thm 1 11 and 2 22 we can use the method of residuals and other tools described in previous sections to compute o r 2 h r w r 12 which gives the same ordinal invariants as those of the product even though they are not isomorphic and moreover is a bqo since the notion of bqo is preserved under products while rado s order is not therefore one cannot charac terise bqos by the ordinal invariants considered here moreover the two orders do not even embed into each other to see this assume by way of contradiction that f injects into r write ai bi and ci di for f 0 i and resp f i 0 when 1 we adopted the definition from laver 1976 18 m dz amonja s schmitz and ph schnoebelen table 1 ordinal invariants of the main wqos p o p h p w p on 1 or 0 an size n antichain n 1 n rado s r 2 i pi i o pi i h pi supi w pi p q o p o q max h p h q w p w q p q o p o q h p h q w p w q p q o p o q sup h p h q 1 see sec 4 4 m p o p h p see sec 4 5 2 see thm 4 27 p o p 1 see thm 4 21 h p o p t p o p h p o t p i necessarily the bi s and the di s are unbounded if the ai s are unbounded one has the contradictory f 1 0 r f 0 i ai bi for some i and there is a similar contradiction if the ci s are unbounded so assume the ai s and the ci s are bounded by some k by the pigeonhole principle we can find a pair 0 i j with ai cj so that f 0 i 6 r f j 0 another contradiction hence 6 r in the other direction r 6 is obvious since is bqo while r is not 5 concluding remarks we provide in table 1 a summary of our findings regarding ordinal invariants of wqos mostly the new results concern the width w p of wqos we note that the width w p q of cartesian products is far from elucidated the first difficulty being that unlike other constructs it cannot be expressed as a function of the widths w p and w q for cartesian products sec 4 4 only provide definite values for a few special cases for the rest one can only provide upper and lower bounds for the moment references u abraham a note on dilworth s theorem in the infinite case order 4 2 107 125 1987 doi 10 1007 bf 00337691 u abraham and r bonnet hausdorff s theorem for posets that satisfy the finite antichain property fund math 159 1 51 69 1999 issn 0016 2736 u abraham r bonnet j cummings m dz amonja and k thompson a scat tering of orders trans amer math soc 364 12 6259 6278 2012 issn 0002 9947 doi 10 1090 s 0002 9947 2012 05466 3 a blass and y gurevich program termination and well partial orderings acm trans comput log 9 3 18 2008 issn 1529 3785 doi 10 1145 1352582 1352586 d h j de jongh and r parikh well partial orderings and hierarchies nederl akad wetensch proc ser a 80 indag math 39 3 195 207 1977 doi 10 1016 1385 7258 77 90067 1 r p dilworth a decomposition theorem for partially ordered sets ann math 51 1 161 166 1950 doi 10 2307 1969503 b dushnik and e w miller partially ordered sets amer j math 63 3 600 610 1941 issn 0002 9327 doi 10 2307 2371374 on ordinal invariants in well quasi orders 19 g higman ordering by divisibility in abstract algebras proc london math soc 3 2 326 336 1952 issn 0024 6115 doi 10 1112 plms s 3 2 1 326 i kr z and r thomas ordinal types in ramsey theory and well partial ordering theory in j nes etr il and v ro dl editors algorithms and combinatorics vol 5 mathematics of ramsey theory pages 57 95 springer 1990 doi 10 1007 978 3 642 72905 8 7 j kruskal well quasi ordering the tree theorem and vazsonyi s conjecture trans ams 95 2 210 225 1960 doi 10 2307 1993287 j b kruskal the theory of well quasi ordering a frequently discovered con cept j comb theory a 13 3 297 305 1972 issn 0097 3165 doi 10 1016 0097 3165 72 90063 5 r laver well quasi orderings and sets of finite sequences math proc cambridge 79 1 1 10 1976 doi 10 1017 s 030500410005204 x e c milner basic wqo and bqo theory in graphs and order banff alta 1984 volume 147 of nato adv sci inst ser c math phys sci pages 487 502 reidel dordrecht 1985 doi 10 1007 978 94 009 5315 4 14 e c milner and n sauer on chains and antichains in well founded partially ordered sets j london math soc s 2 24 1 15 33 1981 doi 10 1112 jlms s 2 24 1 15 l mirsky a dual of dilworth s decomposition theorem amer math month 78 8 876 877 1971 doi 10 2307 2316481 m a peles on dilworth s theorem in the infinite case israel j math 1 2 108 109 1963 doi 10 1007 bf 02759806 m pouzet sur les cha nes d un ensemble partiellement bien or donne publ de p math lyon 16 1 21 26 1979 url http www numdam org article pdml 1979 16 1 21 0 pdf r rado partial well ordering of sets of vectors mathematika 1 2 89 95 1954 doi 10 1112 s 0025579300000565 m rathjen and a weiermann proof theoretic investigations on kruskal s the orem ann pure app logic 60 1 49 88 1993 doi 10 1016 0168 0072 93 90192 g j h schmerl obstacles to extending mirsky s theorem order 19 2 209 211 2002 doi 10 1023 a 1016541101728 d schmidt well partial orderings and their maximal order types habilitation sschrift heidelberg 1979 d schmidt the relation between the height of a well founded partial ordering and the order types of its chains and antichains j comb theory b 31 2 183 189 1981 issn 0095 8956 doi 10 1016 s 0095 8956 81 80023 8 s schmitz and ph schnoebelen multiply recursive upper bounds with higman s lemma in proc icalp 2011 volume 6756 of lect notes comput sci pages 441 452 springer 2011 doi 10 1007 978 3 642 22012 8 35 j van der meeren connecting the two worlds well partial orders and ordinal notation systems phd thesis universiteit gent 2015 j van der meeren m rathjen and a weiermann well partial orderings and the big veblen number arch math logic 54 1 2 193 230 2015 doi 10 1007 s 00153 014 0408 5 a weiermann a computation of the maximal order type of the term ordering on finite multisets in proc cie 2009 volume 5635 of lect notes comput sci pages 488 498 springer 2009 doi 10 1007 978 3 642 03073 4 50 d b west extremal problems in partially ordered sets in i rival editor ordered sets volume 83 of nato advanced study institutes series pages 473 521 springer 1982 doi 10 1007 978 94 009 7798 3 16 http www numdam org article pdml 1979 16 1 21 0 pdf 20 m dz amonja s schmitz and ph schnoebelen e s wolk partially well ordered sets and partial ordinals fund math 60 2 175 186 1967 university of east anglia norwich uk e mail address m dzamonja uea ac uk lsv ens paris saclay cnrs universite paris saclay france e mail address schmitz phs lsv ens cachan fr 1 introduction 2 background and basic results 2 1 posets and quasi orders 2 2 rankings and well founded trees 2 3 residual characterisation 2 4 games for wqo invariants 2 5 cardinal invariants 2 6 wpos as a basis for fac posets 3 characterisations of ordinal invariants 3 1 height and maximal chains 3 2 maximal order types and linearisations 3 3 maximal order types and height of downwards closed sets 3 4 width and antichain rank 3 5 relationship between width height and maximal order type 4 computing the invariants of common wqos 4 1 lexicographic sums 4 2 disjoint sums 4 3 direct products 4 4 cartesian products 4 5 finite multisets sequences and trees 4 6 infinite products and rado s structure 5 concluding remarks references