ar x iv 1 00 5 13 31 v 3 m at h d g 4 j ul 2 01 1 displacement convexity of generalized relative entropies shin ichi ohta and asuka takatsu november 6 2018 abstract we investigate the m relative entropy which stems from the bregman diver gence on weighted riemannian and finsler manifolds we prove that the displace ment k convexity of the m relative entropy is equivalent to the combination of the nonnegativity of the weighted ricci curvature and the k convexity of the weight function we use this to show appropriate variants of the talagrand hwi and the logarithmic sobolev inequalities as well as the concentration of measures we also prove that the gradient flow of the m relative entropy produces a solution to the porous medium equation or the fast diffusion equation contents 1 introduction 2 2 preliminaries 4 2 1 weighted ricci curvature 4 2 2 generalized exponential functions and gaussian measures 4 2 3 wasserstein geometry 8 3 generalized relative entropies 10 3 1 background tsallis entropy and information geometry 10 3 2 m relative entropy 11 4 displacement convexity 14 5 functional inequalities 19 department of mathematics kyoto university kyoto 606 8502 japan sohta math kyoto u ac jp max planck intitut fu r mathematik vivatsgasse 7 53111 bonn germany supported in part by the grant in aid for young scientists b 20740036 graduate school of mathematics nagoya university nagoya 464 8602 japan takatsu math nagoya u ac jp institut des hautes e tudes scientifiques bures sur yvette 91440 france supported in part by research fellowships of the jsps for young scientists by jsps ihe s epdi fellowship 1 http arxiv org abs 1005 1331 v 3 6 concentration of measures 22 7 gradient flow of hm 27 7 1 geometric structure of p m w 2 28 7 2 gradient flows in p m w 2 28 7 3 m relative entropy and the porous medium fast diffusion equation 29 7 4 proof of claim 7 7 34 8 finsler case 37 1 introduction the displacement convexity of a functional on the space of probability measures was intro duced in mccann s influential paper mc 1 as the covexity along geodesics with respect to the l 2 wasserstein distance recent astonishing development of optimal transport theory reveals that the displacement convexity of entropy type functionals plays important roles in the theory of partial differential equations probability theory and differential geometry see ags vi 1 vi 2 and the references therein for instance on a compact rieman nian manifold m g equipped with the riemannian volume measure volg the gradient flow of the relative entropy entvolg see 3 3 for definition in the l 2 wasserstein space p m w 2 produces a weak solution to the heat equation oh 1 go vi 2 chap ter 23 then the displacement k convexity of entvolg for some k r denoted by hess entvolg k for short implies the k contraction property w 2 p t x volg p t y volg e ktd x y x y m of the heat kernel p 0 m m 0 and vice versa vrs where d is the riemannian distance the condition hess entvolg k is called the curvature dimension condition cd k and known to be equivalent to the lower ricci curvature bound ric k vrs there is a rich theory on general metric measure spaces satisfying cd k st 2 lv 2 vi 2 part iii especially cd k withk 0 is an important condition which yields among others the logarithmic sobolev inequality and the normal concentration of measures a kind of large deviation principle the curvature dimension condition is generalized to cd k n for each k r and n 1 and then cd k n is equivalent to the lower bound of the weighted ricci curvature ricn k of a weighted riemannian manifold m where is a conformal deformation of volg st 3 lv 1 see 2 1 for the definition of ricn however cd k n with n is written as a simple convexity condition only when k 0 and it causes some difficulties when k 6 0 see bs precisely cd 0 n is defined as the convexity of the re nyi entropy sn see 3 2 for definition while cd k n with k 6 0 is a more sub tle inequality involving the integrand of sn sturm has shown in st 1 theorem 1 7 that there are by no means unique functionals whose displacement k convexity is equivalent to the combination of ric k and dim n for unweighted riemannian manifolds but it is unclear how this observation relates to cd k n in this article we introduce and consider a different kind of relative entropy hm for m n 1 n 1 1 we call this the m relative entropy which is related to 2 but different from sn here expm is a fixed conformal deformation of and expm is the m exponential function see subsection 2 2 our definition of hm stems from the bregman divergence in information theory geometry which is closely related to the tsallis and re nyi entropies see subsection 3 1 roughly speaking hm is defined as hm 1 m m 1 m m m m 1 m 1 m d for and see definition 3 1 for the precise definition we can regard hm as representing the difference between and taking the limit as m tends to 1 recovers the usual relative entropy ent or the kullback leibler divergence h our results will guarantee that hm is a natural and important object our first main theorem asserts that hesshm k in p 2 m w 2 is equivalent to the combination of ricn 0 with n 1 1 m and hess k where ricn is of m theorem 4 1 we remark that n can be negative such ricn is not previ ously studied and would be of independent interest it is also interesting to obtain split curvature bound convexity conditions from a single convexity condition of the entropy then according to the technique similar to the curvature dimension condition we show that ricn 0 and hess k imply appropriate variants of the talagrand hwi loga rithmic sobolev and the global poincare inequalities propositions 5 1 5 4 theorem 5 2 and also the concentration of measures theorem 6 1 proposition 6 7 furthermore the gradient flow of hm produces a weak solution to the porous medium equation for m 1 or the fast diffusion equation for m 1 of the form t 1 m m div where and div are the laplacian and the divergence associated with the measure theorem 7 6 among others we shall follow the metric geometric way of interpreting this coincidence as in oh 1 go most results hold true also for finsler manifolds thanks to the theory developed in oh 2 and os 1 see section 8 we comment on former related work on this kind of entropy on unweighted rieman nian manifolds sturm showed a similar characterization of the displacement k convexity of a class of entropies or free energies including hm st 1 theorem 1 3 we general ize this to weighted riemannian and even finsler manifolds and then ric is replaced with ricn this is natural but nonobvious also our treatment of singular measures is more precise than st 1 gradient flow from the view of wasserstein geometry has been investigated by otto ot in the euclidean case and by villani vi 2 chapters 23 24 in the weighted riemannian case in a different manner from ours functional inequalities related to the convexity of the weight were studied in agk cgh and ta 2 in eu clidean spaces see also st 1 remark 1 1 and vi 2 chapters 24 25 the concentration of measures seems new even in the euclidean setting the organization of the article is as follows after preliminaries we introduce the m relative entropy hm in section 3 and show that hesshm k is equivalent to hess k with ricn 0 in section 4 using this equivalence we obtain several func tional inequalities in section 5 and the concentration of measures in section 6 section 7 is devoted to the study of the gradient flow of hm finally we treat the finsler case in section 8 3 2 preliminaries throughout the article except the last section m g will be a complete connected n dimensional c riemannian manifold and d stands for the riemannian distance of m for simplicity and since we are interested in the role of curvature bounds we will always assume n 2 denote by b x r the open ball of center x m and radius r 0 i e b x r y m d x y r see e g ch for the basics of riemannian geometry 2 1 weighted ricci curvature we fix a conformal change e volg with c m of the riemannian volume measure volg as our base measure given a unit vector v txm andn 0 n we define the weighted ricci curvature by ricn v ric v hess v v v 2 n n 2 1 we also set ricn v ric v hess v v if v 0 otherwise observe that if is constant then ricn v coincides with ric v for all n remark 2 1 we usually consider ricn only for n n where ric v ric v hess v v is the bakry e mery tensor see be qi lo and then it enjoys the mono tonicity ricn v ricn v for n n admitting n 0 violates this monotonicity but we abuse this notation for brevity the reason why we consider this range of n will be seen in 2 2 as we mentioned in the introduction ricn k for k r and n n is equivalent to sturm s curvature dimension condition cd k n spaces satisfying cd k n behave like a space with dimension n as well as ricci curvature k see st 3 lv 1 vi 2 part iii 2 2 generalized exponential functions and gaussian measures we briefly recall them calculus see ts 2 for further discussion we introduce a parameter m such that m n 1 n 1 1 we sometimes eliminate the special case m 1 2 with n 2 section 5 or restrict ourselves to m 2 sections 6 7 we set n n m 1 1 m 0 n 2 2 define the m logarithmic function by lnm t tm 1 1 m 1 for t 0 if m 1 t 0 if m 1 4 note that lnm is monotone increasing and that the image of lnm is 1 1 m if m 1 1 m 1 if m 1 we define the m exponential function expm as the inverse of lnm namely expm t 1 m 1 t 1 m 1 for t 1 1 m if m 1 t 1 m 1 if m 1 for the sake of simplicity we set expm t 0 for m 1 and t 1 m 1 we also define em t t lnm t tm t m 1 for t 0 em 0 0 observe that lim m 1 lnm t ln t lim m 1 expm t e t lim m 1 em t t ln t remark 2 2 1 taking m 1 andm 1 gives rise to qualitatively different phenomena see lemma 2 5 example 2 6 for instances nonetheless most of our results will cover both cases 2 in some notations it is common to use the parameter q 2 m instead of m e g expq and q gaussian measures in the present paper however we shall use only m for brevity using expm and the base measure e volg we will fix another measure expm as our reference measure where c m such that 1 1 m if m 1 note that the two weights e and expm involve different kinds of exponential function so that they can not be combined for later convenience we set m 0 m for m 1 1 1 m 1 for m 1 2 3 and assume that m 0 is nonempty note that supp m 0 holds in both cases we shall study how the convexity of has an effect on the geometric and analytic structures of m definition 2 3 k convexity given k r we say that is k convex in the weak sense denoted by hess k for short if any two points x y m admit a minimal geodesic 0 1 m from x to y along which t 1 t x t y k 2 1 t td x y 2 2 4 holds for all t 0 1 note that this is equivalent to saying that 2 4 holds along any minimal geodesic between x and y for 1 is a unique minimal geodesic for all 0 and is continuous 5 remark 2 4 consider a different presentation c c 1 of for some constant c 0 then the weighted ricci curvature ricn is unchanged while c expm cm 1 m 1 cm 1 1 m 1 1 m 1 cm 1 c m 1 1 m 1 1 m 1 expm and hence hess cm 1 hess sections 5 6 will be concerned with the case where hess k 0 as well as ricn 0 in such a situation it turns out that has finite total mass here we give explicit estimates for later use in section 6 lemma 2 5 assume that hess k holds for some k 0 and take a unique mini mizer x 0 m of i if m 1 and ricn 0 then lc m for all c 1 2 1 in particular m moreover we have m c d c 1 c 1 m c c 2 kc m 1 for some c 1 c 1 0 and c 2 c 2 m c 0 ii if m 1 and ricn 0 then m d x 0 x p d for all p 1 1 1 m iii if m 1 then m 0 and supp are convex in the sense that any pair of points in m 0 or supp is connected by a minimal geodesic contained inm 0 or supp respectively in addition we have supp b x 0 2 k 1 m 1 x 0 1 2 proof by our assumption hess k 0 we find a unique point x 0 m 0 such that x 0 infm then we deduce from 2 4 that 1 x 0 k 2 d x 0 1 2 holds for all minimal geodesics with 0 x 0 thus we have x expm x expm x 0 k 2 d x 0 x 2 2 5 for all x m 0 i denote by area s x 0 r the area of the sphere s x 0 r x m d x 0 x r with respect to then 2 5 implies m c d b x 0 1 c d 1 expm x 0 k 2 r 2 c area s x 0 r dr 6 on the one hand it follows from ricn 0 that for r 1 area s x 0 r rn 1 area s x 0 1 rm 1 m area s x 0 1 cf st 3 theorem 2 3 therefore we obtain putting a expm x 0 m 1 0 1 expm x 0 k 2 r 2 c area s x 0 r dr area s x 0 1 1 a 1 m k 2 r 2 c m 1 rm 1 m dr area s x 0 1 1 ar 2 1 m k 2 c m 1 r m 2 c 1 m dr area s x 0 1 1 m k 2 c m 1 1 r m 2 c 1 m dr as c 1 2 the most right hand side coincides with area s x 0 1 1 m c m 1 1 2 c 1 k 2 c m 1 c 2 m c k c m 1 on the other hand as m is already observed the ho lder inequality and c 1 yield b x 0 1 c d b x 0 1 d c b x 0 1 1 c m c b x 0 1 1 c we set c 1 b x 0 1 and complete the proof ii we similarly deduce from 2 5 and ricn 0 that m b x 0 1 d x 0 x p d x 1 rp expm x 0 k 2 r 2 area s x 0 r dr area s x 0 1 1 m k 2 1 m 1 1 rp m 2 1 m dr area s x 0 1 1 m m m 1 1 1 m p k 2 1 m 1 we used p 1 1 m to see p m 2 1 m 1 iii recall that m 0 1 1 m 1 and supp m 0 therefore m 0 and supp are convex and 2 5 shows the desired estimate observe that the convexity of m 0 and supp in lemma 2 5 iii holds true also for k 0 7 example 2 6 m gaussian measures one fundamental and important example to which lemma 2 5 applies is the m gaussian measure on rn defined by nm v v dx c 0 detv 1 2 expm c 1 2 x v v 1 x v dx 2 6 where dx is the lebesgue measure a vector v rn is the mean a positive definite sym metric matrix v sym n r is the covariance matrix and c 0 c 1 are positive constants depending only on n andm see ta 2 then clearly hess cm 10 detv 1 m 2 c 1 v 1 by taking remark 2 4 into account and hence hess cm 10 c 1 detv 1 m 2 1 0 where denotes the largest eigenvalue of v note that nm v v has unbounded and bounded support for m 1 and m 1 respectively the family of m gaussian measures will play interesting roles in sections 3 5 7 2 3 wasserstein geometry we very briefly recall some fundamental facts in optimal transport theory and wasserstein geometry we refer to vi 1 vi 2 for basics as well as recent diverse development of them let x d be a complete separable metric space a rectifiable curve 0 1 x is called a geodesic if it is locally minimizing and has a constant speed we say that is minimal if it is globally minimizing i e d s t s t d 0 1 for all s t 0 1 if any two points in x is connected by a minimal geodesic then x d is called a geodesic space we denote by p x the set of all borel probability measures on x and by pp x p x with p 1 the subset consisting of measures of finite p th moment that is x d x y p d y for some and hence all x x clearly pp x p x if x is bounded given p x a probability measure p x x is called a coupling of and if its projections coincides with and namely a x a and x a a hold for any borel set a x we define the lp wasserstein distance between pp x by wp inf x x d x y p d x y 1 p where runs over all couplings of and we call an optimal coupling if it attains the infimum above we remark that wp is finite since pp x and it is indeed a distance of pp x the metric space pp x wp is called the lp wasserstein space over x if x is compact then p x wp is also compact and the topology induced from wp coincides with the weak topology we will consider only the case of p 2 that is suitable and important for applications in riemannian geometry a minimal geodesic between p 2 x amounts to an optimal way of transporting to with respect to the quadratic cost d x y 2 then it is natural to expect that such an optimal transport is performed along minimal geodesics in x that is indeed the case as seen in the following proposition we denote by x 8 the set of all minimal geodesics 0 1 x endowed with the topology induced from the distance d x supt 0 1 d t t for t 0 1 define the evaluation map et x x as et t and observe that each et is 1 lipschitz proposition 2 7 vi 2 corollary 7 22 let x d be a locally compact geodesic space then for any p 2 x and any minimal geodesic 0 1 p 2 x between them there exists p x such that e 0 e 1 is an optimal coupling of and and that et t holds for all t 0 1 we denoted by et the push forward measure of by et in riemannian man ifolds a more precise description of an optimal transport using a gradient vector field of some kind of convex function is known we first recall mccann s original work on compact riemannian manifolds denote by pac m volg p m the subset of ab solutely continuous measures with respect to the volume measure volg we also set p 2 ac m volg p 2 m pac m volg theorem 2 8 mc 2 theorems 8 9 let m g be a compact riemannian manifold then for any pac m volg and p m there exists a d 2 2 convex function m r such that the map tt x expx t x t 0 1 provides a unique minimal geodesic from to precisely t 0 t 1 is an optimal coupling of and and t tt is a minimal geodesic from 0 to 1 with respect to w 2 see vi 2 chapter 5 for the definition of the d 2 2 convex function here we only remark that it is semi convex in compact spaces such convexity is important as it implies the almost everywhere twice differentiability due to the alexandrov bangert theorem and is generalized to noncompact spaces in fg theorem 2 9 fg theorem 1 let m g be a complete riemannian manifold then for any p 2 ac m volg and p 2 m there exists a locally semi convex function r on an open set m with 1 such that the map tt x expx t x t 0 1 provides a unique minimal geodesic from to in the sense of theorem 2 8 we will also use the following jacobian or monge ampere equation theorem 2 10 vi 2 theorems 8 7 11 1 let m g be complete and and tt be as in theorem 2 9 above put j t x e x tt x det dtt x for x and t 0 1 then it holds t p 2 ac m volg and t tt j t 0 0 a e for all t 0 1 where we set t tt t in particular j t 0 0 a e for each t 0 1 if in addition p 2 ac m volg then the above assertions hold also at t 1 note that j t is the combination of the jacobian det dtt of tt with respect to the metric g and the ratio e tt of the weight e on volg 9 3 generalized relative entropies before discussing the m relative entropy we briefly review the boltzmann and the tsallis entropies see ts 1 ts 2 and explain the motivation related to information geometry see am an 3 1 background tsallis entropy and information geometry entropy is a functional playing prominent roles in thermodynamics information theory sometimes with the opposite sign and many other fields it describes how particles dif fuse in thermodynamics and measures the uncertainty of an event in information theory the most fundamental entropy is the boltzmann gibbs shannon entropy given by e rn ln dx for dx pac rn dx where dx is the lebesgue measure boltzmann entropy is thermodynamically extensive and probabilistically additive so that it is suitable for the treatment of independent systems precisely for two independent distributions 1 2 pac rn dx and their joint probability 1 2 pac r 2 n dx one easily observes e 1 2 e 1 e 2 recently there is a growing interest in strongly correlated systems and non additive entropies among them we are interested in the tsallis entropy defined by em rn em dx rn lnm dx rn m m 1 dx 3 1 for dx pac rn dx where m n 1 n 1 1 2 note that letting m tend to 1 recovers the boltzmann entropy e and that em is closely related to the re nyi entropy sn rn 1 1 n dx m 1 em 1 3 2 one can connect e and em via gaussian measures as follows on the one hand given v rn and v sym n r the usual gaussian measure n v v 1 2 n 2 detv 1 2 exp 1 2 x v v 1 x v dx maximizes e among pac rn dx with mean v and covariance matrix v on the other hand the m gaussian measure nm v v defined in 2 6 similarly maximizes e 2 m under the same constraint for m 6 1 2 2 in the following sections we shall verify that a number of further geometric and analytic properties of e have counterparts for em precisely since em itself is not really interesting in our view see remark 4 3 2 we modify em in the manner of information geometry we start from the family of gaussian measures n n n v v v rn v sym n r 10 as an n 2 3 n 2 dimensional manifold in information geometry we equip n n with the fisher information metric mf which is different from the wasserstein metric w 2 in fact n 1 mf has the negative constant sectional curvature am while n 1 w 2 is flat cf ta 1 theorem 2 2 and the references therein the fisher metric admits a pair of dually flat connections exponential and mixture connections and the kullback leibler divergence h rn ln d for dx pac rn dx and dx pac rn note that h is nonnegative by jensen s inequality the square root of the divergence h can be regarded as a kind of distance between and it certainly satisfies a generalized pythagorean theorem though it does not satisfy symmetry nor the triangle inequality the kullback leibler divergence h coincides with the relative entropy ent of with respect to roughly speaking ent is defined for p rn and a borel measure on rn by ent rn ln d for pac rn otherwise 3 3 and then ent ln rn the family of m gaussian measures n n m nm v v v rn v sym n r similarly admits dually flat connections and the corresponding bregman divergence called the divergence cf ow 2 1 is hm 1 m m 1 rn m m m 1 m 1 m dx 3 4 for dx pac rn dx and dx pac rn we can rewrite this by using em as hm 1 m rn em em e m dx and recover the kullback leibler divergence as the limit lim m 1 hm rn ln ln ln 1 dx h it will turn out that the entropy induced from 3 4 is appropriate for our purpose we remark that the division by m in 3 4 is unessential we prefer this form merely for aesthetic reasons of the presentation of theorem 4 1 3 2 m relative entropy recall our weighted riemannian manifold m and reference measure the bregman divergence 3 4 leads us to the following generalization of the relative entropy 11 definition 3 1 m relative entropy assume lm m given p m let s be its lebesgue decomposition into absolutely continuous and singular parts with respect to then we define the m relative entropy as follows 1 for m 1 hm 1 m m em em e m d 1 m 1 m m 1 d s hm s m 1 m m 1 m m m 1 m d 1 m 1 m m 1 d hm s m 3 5 if lm 1 m where hm 0 we define hm for p m with 6 lm 1 m 2 for m 1 hm is defined by 3 5 if lm m where hm and 0 0 as convention we set hm for p m with 6 lm m for pac m 3 5 has the simplified form hm 1 m m 1 m m m m 1 m 1 m d as in 3 4 note that the first two terms in the right hand side are regarded as the internal and external energies and the last term which is independent of is added for the sake of nonnegativity see lemma 3 3 remark 3 2 1 if hess k 0 then the primal assumption lm m is clearly satisfied for m 1 by lemma 2 5 iii we deduce from lemma 2 5 i that lm m also holds true if hess k 0 ricn 0 and m 1 2 1 2 a for m 1 if lm 1 m then the ho lder inequality implies m m d m m 1 m m 1 m d m m 1 d m m m d 1 m thus we have lm m moreover for pac m it holds hm 1 m m m d 1 m m 1 m m 1 d m m m d 1 m 1 1 m m m 1 d 1 m 1 m m m 1 d m m m m 1 d 1 m m m d 1 m and hence it is natural to define hm for with 6 lm 1 m 2 b for m 1 and lm m the ho lder inequality m m 1 d m m d 1 m m m d m 1 m 12 similarly yields lm 1 m and for pac m hm 1 m m m d 1 m m 1 m m d 1 m m m d m 1 m m m m d m 1 m hence it is again natural to set hm for 6 lm m 3 the validity of the definition of hm would be understood by the following observation putting b x b x so that b x is the characteristic function of b x b x 1 b x m d b x 1 m 0 if m 1 if m 1 as tends to zero see also lemma 3 4 below next we see that is a unique ground state of hm provided m 1 lemma 3 3 we have hm 0 for all p m and equality holds if and only if pac m and proof note that if s m 0 then the singular part 1 m 1 m m 1 d s hm s m in 3 5 is positive for m 1 since 0 on m and infinity for m 1 respectively hence it is sufficient to consider the absolutely continuous part as the function em t tm t m 1 is strictly convex on 0 we have em em e m 0 in 3 5 and equality holds if and only if therefore hm 0 and equality holds if and only if s m 0 and a e the following lemma will be used in section 7 claim 7 7 where m is assumed to be compact this also guarantees the validity of the definition of hm lemma 3 4 let m g be compact then the entropy hm is lower semi continuous with respect to the weak topology that is to say if a sequence i i n p m weakly converges to p m then we have hm lim inf i hm i proof we divide hm m 1 m m d into two parts h 1 1 m m 1 m m d hm s m h 2 1 m 1 m m 1 d then h 2 is clearly continuous in since m is compact in addition the lower semi continuity of h 1 follows from lv 2 theorem b 33 since the function um t tm m m 1 is continuous convex and satisfies um 0 0 as well as limt um t t hm 13 4 displacement convexity in this section we prove our first main theorem on a characterization of the displacement convexity of hm along the lines of cms vrs st 1 and st 3 in st 1 sturm considered a more general class of entropies or free energies on unweighted riemannian manifolds then his st 1 theorem 1 3 includes the equivalence between a and b in theorem 4 1 below with volg see also st 1 remark 1 1 to be precise in his theorem the condition a is written as u r ric v hess v v k for all r r and unit vectors v tm where u r e m 1 r m m 1 one more condition u r u r n 0 corresponds to m n 1 n see remark 4 3 1 thus theorem 4 1 can be regarded as the combination of st 1 theorem 1 3 and the equivalence between ricn k and cd k n for m see st 3 theorem 1 7 lv 1 theorem 4 22 our proof is also in a sense the combination of them recall from 2 3 that m 0 m for m 1 m 0 1 1 m 1 for m 1 and that m 0 supp in both cases theorem 4 1 let m and m n 1 n 1 1 with lm m be given then for k r the following three conditions are mutually equivalent a we have ricn 0 on m 0 with n 1 1 m as well as hess k on m 0 in the sense of definition 2 3 b for any 0 1 p 2 ac m 0 such that any two points x 0 supp 0 x 1 supp 1 are joined by some geodesic contained in m 0 there is a minimal geodesic t t 0 1 p 2 ac m 0 along which we have hm t 1 t hm 0 thm 1 k 2 1 t tw 2 0 1 2 4 1 for all t 0 1 c for any 0 1 p 2 m 0 such that any two points x 0 supp 0 x 1 supp 1 are joined by some geodesic contained in m 0 there is a minimal geodesic t t 0 1 p 2 m 0 along which we have 4 1 for all t 0 1 proof note that c b is clear thus it suffices to show a c and b a as the general case of the part a c is somewhat technical let us begin with absolutely continuous measures in other words a b a b since the assertion 4 1 is clear if hm 0 or hm 1 we assume that both hm 0 and hm 1 are finite theorem 2 9 ensures that there is an almost everywhere twice differentiable function m r such that the map tt x expx t x gives the unique minimal geodesic t tt 0 from 0 to 1 due to cms proposition 4 1 t 1 x is not a cut point of x for 0 a e x and hence 14 the minimal geodesic tt x t 0 1 is unique and contained in m 0 recall that putting t t hm t 1 m m 1 m m 1 t m m 1 d t 1 m m m d by the jacobian equation theorem 2 10 we deduce that m m 1 t m m 1 d t m t tt m 1 m tt m 1 d 0 m j t 0 1 m m tt m 1 d 0 where j t x e x tt x det dtt x 0 0 a e claim 4 2 for 0 a e x m the function j t x 1 m m 1 nj t x 1 n is convex in t proof for m 1 and hence n n this is proved in st 3 theorem 1 7 see also oh 2 section 8 2 we can apply the same calculation to m 1 and n 0 for completeness we briefly explain how to modify calculations in oh 2 with the notations in oh 2 section 8 2 we observe that ricn 0 implies n 1 h 3 h 13 0 thus h 3 is convex and e is concave therefore e x j t x 1 n h t e t 1 nh 3 t n 1 n is convex in t via the ho lder inequality a b 1 n c d n 1 n a 1 nc n 1 n b 1 nd n 1 n for a b 0 and c d 0 in order to estimate the term tt m 1 1 m we observe from hess k that tt m 1 1 m 1 1 m tt 1 1 m 1 t t 0 t t 1 k 2 1 t td t 0 t 1 2 1 t t 0 m 1 1 m t t 1 m 1 1 m k 2 1 t td t 0 t 1 2 combining this with claim 4 2 and integrating with 0 yield the desired inequality 4 1 a c we next consider the more technical case where 0 or 1 has nontrivial sin gular part there is nothing to prove form 1 form 1 we decompose as 0 0 s 0 and 1 1 s 1 and take an optimal coupling of 0 and 1 now is decomposed into four parts aa as sa ss such that p 1 aa p 1 as p 2 aa and p 2 sa are absolutely continuous and that p 1 sa p 1 ss p 2 as and p 2 ss are sin gular or null measures here p 1 p 2 m m m denote projections to the first and second elements 15 we divide optimal transport between 0 and 1 into two parts corresponding to ss and ss as for 0 p 1 ss and 1 p 2 ss theorems 2 9 2 10 are again applicable and give a minimal geodesic t t 1 ss m m p 2 ac m 0 i e t m 1 ss m m satisfying m mt d 1 t m m 0 d t m m 1 d m m 1 d t 1 t m m 1 d 0 t m m 1 d 1 1 m k 2 1 t t m m d x y 2 d ss x y we then choose an arbitrary minimal geodesic t t s t ss m m p 2 m 0 from 0 p 1 ss to 1 p 2 ss thanks to proposition 2 7 t is also realized through a family of geodesics in m 0 and hence hess k implies m m 1 d t 1 t m m 1 d 0 t m m 1 d 1 1 m k 2 1 t t m m d x y 2 d ss x y we put t t t and conclude that hm t 1 m m 1 m t t m m 1 m d 1 1 m m m 1 d t 1 m m 1 m mt m 1 m d 1 1 m m m 1 d t t 1 t hm 0 thm 1 k 2 1 t tw 2 0 1 2 b a by approximation it suffices to show ricn 0 and hess k on m 0 we first consider the case of m 1 fix a unit vector v txm with x m 0 and put t expx tv b b 1 a for 0 1 with a constant a r chosen later set 0 0 b b 1 1 b b 4 2 where a stands for the characteristic function of a set a let t tt 0 be the unique optimal transport from 0 to 1 recall that hm t 1 m m m d 1 m m 1 m m 10 j t 1 m m tt m 1 d 0 4 3 where j t e tt det dtt by definition we find m 10 cne 1 a n n o n 1 1 m b 16 where cn denotes the volume of the unit ball in r n note also that m j t 1 m d 0 m j t d 0 1 m supp t b 1 m 4 4 as the second order behavior of the distance function is controlled by the sectional curvature we have supp 1 2 expx n i 1 ai xi txm n i 1 ai i 2 1 i 1 ki 2 2 o 3 where we chose a coordinate xi ni 1 around x such that xi x ni 1 is orthonormal and that x 1 x 0 and denote by ki the sectional curvature of the plane spanned by 0 and xi x so that k 1 0 see the proof of vrs theorem 1 thus we observe from ric v n i 1 ki that lim sup 0 supp 1 2 cn n e x lim sup 0 volg supp 1 2 cn n e x 1 1 2 ric v 2 o 3 4 5 we similarly observe that supp t cn n is uniformly bounded as 0 hence since 1 m 0 the leading term of 4 3 as 0 is 1 1 m m tt m 1 d 0 thus we obtain from 4 1 with t 1 2 that by letting go to zero 0 m 1 m 1 m 1 2 1 m k 8 2 2 this means that hess 1 1 m hess m 1 k in the weak sense in order to show ricn v 0 we choose a point y with d x y and modify 0 and 1 into i 1 n 1 b y b y n 1 i 4 6 for i 0 1 then w 2 0 1 n 1 2 w 2 0 1 and t 1 n 1 b y b y n 1 t 17 is the unique minimal geodesic from 0 to 1 so that 4 3 is modified into hm t 1 m m m d n 1 m m 1 m n 1 0 m 1 j t 1 m m tt m 1 d 0 1 m m 1 1 n 1 b y b y 1 n 1 b y m 1 m m 1 d we rewrite this as hm t 1 m m m d 1 n 1 m m 1 1 n 1 b y m 1 m b y b y m 1 d n 1 m m 1 m n 1 0 m 1 j t 1 m m tt m 1 d 0 4 7 since n 1 0 m 1 cne 1 a n 1 o 1 1 m b the leading term of 4 7 as 0 is m n 1 m m 1 m m 10 j t 1 m d 0 therefore 4 1 with t 1 2 and the jacobian equation theorem 2 10 yield that lim inf 0 m j 1 2 1 m d 0 1 2 j 0 1 m j 1 1 m 1 2 1 1 a 1 a n n e n combining this with 4 4 and 4 5 we obtain 1 1 2 ric v 2 1 a ne x m j t 1 m d 0 1 1 m o 3 1 2 n 1 a n ne x n 1 a n ne x n n o 3 hence we have expanding the 1 n th power of both sides near 0 1 1 2 n ric v 2 1 2 1 a n ne x n 1 a n ne x n o 3 1 2 2 n n n n 1 a 2 0 n 0 2 n 2 2 na n 0 n o 3 1 2 2 n 0 n n n n a 2 2 n 0 n a 0 2 n o 3 18 therefore we obtain ric v 0 n n n n a 2 2 n 0 n a 0 2 n 0 4 8 if n n then choosing the minimizer a 0 n n gives the desired curvature bound ricn v ric v 0 0 2 n n 0 if n n then we consider a going to or and find 0 0 as well as ricn v 0 in the case of m 1 we use the same transport 4 2 and then the leading term of 4 3 changes into 1 m m 1 m m 10 j t 1 m d 0 thus calculations as above yield the reverse inequality of 4 4 and finally 4 8 with n 0 we again choose the minimizer a 0 n n and find ricn v 0 similarly for the transport 4 6 the leading term of 4 7 is n 1 1 m m tt m 1 d 0 and then 4 1 yields hess hess m 1 1 m k note that w 2 0 1 2 n 1 w 2 0 1 2 has the same order remark 4 3 1 if we admitm 0 n 1 n and generalize ricn in 2 1 ton 1 n then claim 4 2 is false moreover as the coefficient of a 2 in 4 8 is negative 4 1 is never satisfied let a compare this with st 1 1 7 which means m n 1 n in our setting 2 note that the special case i e 0 in theorem 4 1 makes sense only for k 0 then the assertion of theorem 4 1 corresponds to the equivalence between ricn 0 and the convexity of the re nyi entropy sn i e the curvature dimension condition cd 0 n of m 3 in the limit case ofm 1 two weights and are synchronized as e volg and hess ent k i e cd k for m is equivalent to the single condition ric hess k vrs theorem 1 st 2 proposition 4 14 for m 6 1 however and keep separate and they measure different phases of m as indicated in theorem 4 1 5 functional inequalities since otto and villani s celebrated work ov the displacement convexity of entropy type functionals has played a significant role in the study of functional inequalities and the concentration of measures in this section we follow the argument in lv 2 section 6 that the direct application of the displacement convexity of the entropy implies various functional inequalities our proofs use only fundamental properties of convex functions 19 in more analytic context related results for m 6 1 in the euclidean spaces m rn dx can be found in agk cgh and ta 2 see especially agk section 4 and cgh section 3 for various generalizations of the talagrand transport inequality logarithmic sobolev entropy information inequality hwi inequality and the poincare inequality the relation among these inequalities are also discussed there throughout the section we suppose that m 1 2 ricn 0 and that hess k holds for some k 0 note thatm 1 2 is clear if n 3 recall from lemma 2 5 i iii that m automatically follows from these hypotheses so that the normalization gives expm m 1 pac m with hess m 1 mk according to remark 2 4 lemma 2 5 moreover ensures that lm m p 2 ac m and that m 0 is convex keeping these in mind we will consider with m 1 for simplicity proposition 5 1 talagrand inequality assume that m n 1 n 1 2 1 m 1 ricn 0 and hess k 0 then we have for any p 2 m 0 w 2 2 k hm proof there is nothing to prove if hm so that we assume hm let t t 0 1 p 2 m 0 be the optimal transport from 0 to 1 it follows from 4 1 and hm 0 that hm t 1 t hm k 2 1 t tw 2 2 5 1 since hm t 0 lemma 3 3 we obtain hm k 2 w 2 2 by dividing 5 1 with 1 t and letting t go to 1 the above talagrand inequality is regarded as a comparison between distances in wasserstein geometry and information geometry recall subsection 3 1 in the remainder of the section let be locally lipschitz for p 2 ac m such that is locally lipschitz we define the m relative fisher information by im 1 m 2 m e m e m 2 d 1 m 1 2 m m 1 m 1 2 d 5 2 it will be demonstrated in proposition 7 10 that im is the absolute gradient of hm at thus it is natural to expect that the convexity of hm yields the following inequality theorem 5 2 hwi and logarithmic sobolev inequalities we assume that m n 1 n 1 2 1 m 1 ricn 0 hess k 0 and that is locally lipschitz then we have for any p 2 ac m 0 such that hm and is lipschitz hm im w 2 k 2 w 2 2 5 3 hm 1 2 k im 5 4 20 proof let t t p 2 ac m 0 t 0 1 be the optimal transport from 0 to 1 given by t tt with tt x expx t x and put h t hm t then it follows from 5 1 that h 0 h 0 h t t k 2 1 t w 2 2 5 5 we shall estimate the term h 0 h t 1 m m 1 m m mt m t m 1 d since the function f s sm m 1 is convex we have m mt m 1 f t m m 1 m 1 t and hence h 0 h t 1 m 1 m m 1 m 1 t d as tt t we observe m m 1 m 1 t d m tt m 1 tt m 1 d this yields h 0 h t 1 m 1 m m 1 m 1 tt m 1 tt m 1 d thus we obtain lim sup t 0 h 0 h t t 1 m 1 m m 1 m 1 d t 0 t 1 d 1 m 1 m m 1 m 1 2 d 1 2 m d t 0 t 1 2 d 1 2 im w 2 combining this with 5 5 we conclude that hm im w 2 k 2 w 2 2 1 2 k im remark 5 3 it is established in ta 2 that in the euclidean space m rn dx equality of 5 3 and 5 4 is characterized by using m gaussian measures we finally show a kind of poincare inequality observe that letting m 1 recovers the usual global poincare inequality m f 2 d k 1 m f 2 d 21 proposition 5 4 global poincare inequality assume that m g is compact m n 1 n 1 2 1 m 1 ricn 0 hess k 0 and that is lipschitz then for any lipschitz function f m 0 r such that m 0 f d 0 we have m f 2 m 1 d 1 k m f m 1 2 d proof apply 5 4 to 1 f for small 0 and obtain 1 m m 1 m m m m 1 m 1 m d 1 2 k 1 m 1 2 m m 1 m 1 2 d we remark that hm as m is compact on the one hand m m m 1 m 1 m 1 f m m m 1 f m m 1 m m 1 f m 1 m f m m 1 mf 2 2 2 o 3 where o 3 is uniform on m thanks to the compactness of m on the other hand m 1 m 1 2 1 f m 1 1 m 1 2 m 1 f m 1 o 2 2 m 1 2 2 f m 1 2 o 3 thus we have letting go to zero m f 2 m d 1 k m f m 1 2 d 6 concentration of measures this section is devoted to an application of proposition 5 1 to the concentration of mea sures let us assume m 1 and define the concentration function by m r sup 1 b a r a m a 1 2 for r 0 where a is any measurable set and b a r y m inf x a d x y r the function m describes how the probability measure concentrates on the neigh borhood of an arbitrary set of half the total measure in a quantitative way in other words a kind of large deviation principle an especially interesting situation is that a sequence mi i i n satisfies limi mi i r 0 for all r 0 that means that 22 mi i is getting more and more concentrated we refer to le for the basic theory and applications of the concentration of measure phenomenon in the classical case of m 1 it is well known that the concentration of measures has rich connections with functional inequalities appearing in section 5 for instance the l 1 transport inequality w 1 2 k ent implies the normal concentration r ce cr 2 with constants c c 0 depending only on k le section 6 1 in the same spirit we show that an application of proposition 5 1 gives new examples of concentrating spaces we set gc gc m c d for c 1 2 recall from lemma 2 5 i that if m 1 ricn 0 and if hess k 0 then gc c 1 1 c m c c 2 m c kc m 1 6 1 holds for each c 1 2 1 theorem 6 1 m 1 case let m satisfy ricn 0 and m n 1 n 1 1 2 1 i assume that m 1 and hess k 0 then we have m r m lnm 2 m r g 1 m 1 mk 2 r gm 2 gm 6 2 for all r 0 and 0 2 m 1 ii take a sequence i expm i pac m i n such that hess i ki and limi ki then we have limi m i r 0 for all r 0 proof i note that p 2 ac m by lemma 2 5 ii and m 1 2 we also remark that 6 2 clearly holds for r 2 2 gm mk indeed then the right hand side is nonnegative and the trivial bound m r 1 2 implies lnm 2 m r 0 suppose r 2 2 gm mk take a measurable set a m with a 1 2 and put b m b a r a a b b a a a b b b we assumed b 0 since there is nothing to prove if b 0 for all such a observe that w 1 a b r as d x y r for all x a and y b the triangle inequality of w 1 and proposition 5 1 together imply as w 1 w 2 by the schwarz inequality r w 1 a b w 1 a w 1 b 2 k hm a 2 k hm b note that hm a 1 m 1 m a mam 1 1 am m d 1 m gm 23 and mam 1 1 0 since a 1 2 m 1 1 m thus we obtain mk 2 r gm gm b m mbm 1 1 1 m b m d we observe from r 2 2 gm mk that mk 2 r 2 gm which yields 0 mb m 1 1 2 b m 1 1 hence we have mk 2 r gm 2 gm b m lnm 2 b b m d 6 3 it follows from the ho lder inequality that b m d b m d b d b m 1 d 1 b g 1 m 1 where the assumption 2 m 1 ensures m 1 1 2 therefore we obtain the desired inequality 6 2 by choosing ai m such that limi m b ai r m r ii thanks to 6 1 we know that lim sup i gc i c 1 1 c for all c 1 2 1 therefore we deduce from i with 0 that setting i m i r lim i mi lnm 2 i lim i 1 i 21 m 1 2 i 1 m 1 m which shows limi i 0 remark 6 2 1 taking the proof of lemma 2 5 i into account we can generalize the orem 6 1 ii as follows suppose that a sequence mi i i i n satisfies for m n 1 n 1 1 2 1 a ricn 0 for all mi i b i expm i i pac mi i so that hess i ki and limi ki c supi n i b xi r and supi n area i s xi r for some r 0 where xi mi is the minimizer of i then we have limi mi i r 0 for all r 0 2 taking the limit of 6 2 as m 1 and then 1 we obtain ln 2 r k 2 r 1 2 1 here limc 1 gc g 1 1 follows from the dominated convergence theorem since c max c 0 l 1 m for 1 2 c 0 c 1 therefore we recover the normal concen tration r 1 2 exp k 2 r 1 2 1 1 2 e kr 2 4 2 which is well known to hold for m with ric k 0 24 theorem 6 1 ii is applicable to the fundamental example of m gaussian measures see example 2 6 example 6 3 let nm vi vi i n p 2 ac rn dx be a sequence of m gaussian measures with m n 1 n 1 1 2 1 satisfying lim i detvi 1 m 2 1 i where i is the largest eigenvalue of vi then we have limi rn nm vi vi r 0 for all r 0 note that detvi 1 m 2 1 i 1 m n 2 1 i 1 2 i under the additional assumption that m we further obtain the m normal concentration we first prove a computational lemma for later use lemma 6 4 i for any m 1 2 1 and a r 0 we have expm ar 1 2 1 2 m 1 1 m 1 expm a 2 2 r 2 ii for any m 1 2 and a r 0 we have expm ar 1 2 1 2 m 1 1 m 1 expm a 2 2 r 2 proof i we just calculate expm ar 1 2 1 expm a 2 2 r 2 2 1 m 1 a 2 2 r 2 2 1 m 1 2 m 1 1 m 1 1 m 1 a 2 2 2 m 1 r 2 1 m 1 2 m 1 1 m 1 expm a 2 2 r 2 ii we similarly find expm ar 1 2 1 expm 1 m 2 a 2 r 2 2 m 2 m m m 1 1 m 2 a 2 r 2 1 m 1 2 m 1 1 m 1 1 m 2 m 1 a 2 r 2 1 m 1 2 m 1 1 m 1 expm a 2 2 r 2 25 note that the hypothesis m 1 2 ensures that 1 m 2 a 2 r 2 2 m 2 m 1 m 1 corollary 6 5 m normal concentration assume that m n 1 n 1 1 2 1 m 1 m ricn 0 and hess k 0 then we have m r 2 m 1 1 m 1 2 expm mk 4 m 1 m r 2 for all r 0 proof let us use the same notation as the proof of theorem 6 1 we deduce from the ho lder inequality that b m d b d m b 1 m bm b 1 m bm m 1 m and similarly gm m 1 m in particular r 2 8 m 1 m mk otherwise the assertion is clear since 2 m 1 1 m 1 expm 2 1 implies r 2 8 gm mk therefore we deduce from 6 3 that mk 2 r m 1 m 2 2 m 1 m mk 2 r gm 2 gm b m lnm 2 b b m d m 1 m lnm 2 b and hence m r 1 2 expm m m 1 2 mk 2 r 1 2 1 then lemma 6 4 i completes the proof remark 6 6 note that for m 1 expm cr 2 is greater than e cr 2 and is a polynomial of r so that the m normal concentration is weaker than the exponential concentration r ce cr this is natural and the most we can expect because the m gaussian measures have only the polynomial decay for m 1 lemma 2 5 iii ensures that supp is bounded thus and gc for all c 0 then the proof of theorem 6 1 i is applicable to m 1 2 and gives the same estimate 6 2 for all r 0 and 0 1 furthermore for m 2 we again obtain the m normal concentration depending on proposition 6 7 m 1 case let m satisfy ricn 0 and m 1 2 i assume that m 1 and hess k 0 then we have 6 2 for all r 0 and 0 1 26 ii if in addition m 2 then we have m r 1 2 m 1 1 m 1 expm mk 1 m 4 r 2 for all r 0 proof i this is completely the same as theorem 6 1 i since 1 2 m 1 1 m holds also for m 1 2 ii in 6 3 with m 1 we observe b m d b m 1 and gm m 1 note also that r 2 8 m 1 mk otherwise 2 m m 1 m 1 expm 2 1 immediately gives the assertion ensures r 2 8 gm mk these yield mk 2 r m 1 2 2 m 1 b 1 m m 1 lnm 2 b m 1 lnm b 1 hence we have m r 1 expm 1 m 2 mk 2 r 1 2 1 and lemma 6 4 ii completes the proof note that we obtained the estimate of the form r c expm cr 2 for m 1 while r c expm cr 2 1 for m 1 this is in a sense natural because the domain of expm is 1 1 m for m 1 and 1 m 1 for m 1 remark 6 8 we deduce from proposition 6 7 ii that if limi ki i 1 m for some sequence mi i i n satisfying hess i ki then we have limi mi i r 0 for all r 0 e g a sequence of m gaussian measures nm vi vi i n such that limi i 0 compare this with example 6 3 this is however an immediate con sequence of a stronger conclusion limi diam supp i 0 of lemma 2 5 iii valid for all m 1 indeed diam supp i 2 8 ki 1 m 1 infmi i 8 ki i m 1 m 1 7 gradient flow of hm in this section we show that the gradient flow of the m relative entropy produces a weak solution to the porous medium equation m 1 or the fast diffusion equation m 1 this kind of interpretation of evolution equations has turned out extremely useful after the pioneering work due to jordan et al jko there are several ways of explaining this coincidence see e g jko ags and vi 2 chapter 23 among them here we follow the rather metric geometric approach in oh 1 to do this we start with a review of the geometric structure of the wasserstein space and the general theory of gradient flows in it in accordance with the strategy in oh 1 see also go throughout the section m g is assumed to be compact so that p 2 m p m and lm m 27 7 1 geometric structure of p m w 2 we briefly review the geometric structure of p m w 2 it is known that p m w 2 is an alexandrov space of nonnegative curvature if and only if m g has the nonnegative sectional curvature st 2 proposition 2 10 lv 2 theorem a 8 in the case where m g is not nonnegatively curved although p m w 2 does not admit any lower curvature bound st 2 proposition 2 10 we can show the following see also oh 1 theorem 3 6 theorem 7 1 gi theorem 3 4 remark 3 5 given p m and unit speed geodesics 0 p m with 0 0 the joint limit lim s t 0 s 2 t 2 w 2 s t 2 2 st 1 1 exists theorem 7 1 means that an angle between and makes sense so that p m w 2 looks like a riemannian space rather than a finsler space and we can investigate its infinitesimal structure in the manner of the theory of alexandrov spaces for p m denote by p m the set of all nontrivial unit speed minimal geodesics emanating from given p m theorem 7 1 verifies that the angle arccos lim s t 0 s 2 t 2 w 2 s t 2 2 st 0 is well defined we define the space of directions p m as the completion of p m where holds if 0 the tangent cone c p m is defined as the euclidean cone over p m i e c p m p m 0 p m 0 s t s 2 t 2 2 st cos using this infinitesimal structure we introduce a class of differentiable curves definition 7 2 right differentiability we say that a curve 0 l p m is right differentiable at t 0 l if there is v c t p m such that for any sequences i i n of positive numbers tending to zero and i i n of unit speed minimal geodesics from t to t i the sequence i w 2 t t i i i n c t p m converges to v such v is clearly unique if it exists and then we write t v 7 2 gradient flows in p m w 2 consider a lower semi continuous function f p m which is k convex in the weak sense for some k r we in addition suppose that f is not identically and define p m p m f given p m and p m we set d f lim inf p m lim t 0 f t f t 28 define the absolute gradient called the local slope in ags of f at p m by f max 0 lim sup f f w 2 note that d f f for any p m lemma 7 3 oh 1 lemma 4 2 for each p m with 0 f there exists unique p m satisfying d f f using in the above lemma we define the negative gradient vector of f at as f f c p m in the case of f 0 we simply define f as the origin of c p m definition 7 4 gradient curves a continuous curve 0 l p m which is locally lipschitz on 0 l is called a gradient curve of f if f t for all t 0 and if it is right differentiable with t f t at all t 0 l we say that a gradient curve is complete if it is defined on entire 0 theorem 7 5 oh 1 theorem 5 11 corollary 6 3 go theorem 4 2 i from any p m there starts a unique complete gradient curve 0 p m of f with 0 ii given any two gradient curves 0 p m of f we have w 2 t t e ktw 2 0 0 7 1 for all t 0 to be precise the uniqueness in i is a consequence of the k contraction property 7 1 therefore the gradient flow g 0 p m p m of f given as g t t in theorem 7 5 i is uniquely determined and extended to the closure g 0 p m p m continuously 7 3 m relative entropy and the porous medium fast diffusion equation we recall basic notions of calculus on weighted riemannian manifolds m with e volg for a c 1 vector field v on m we define the weighted divergence as div v div v v where div v denotes the usual divergence of v for m volg note that for any f c 1 m m f v d m f e v dvolg m f div e v dvolg m f div v d 29 for f c 2 m the weighted laplacian is defined by f div f f f then it is an established fact that the gradient flow of the corresponding relative entropy or the free energy ent m ln d m e ln e dvolg m d produces a solution to the associated heat equation or the fokker planck equation t e e div e see jko theorem 5 1 vi 1 subsection 8 4 2 for the euclidean case oh 1 theo rem 6 6 go theorem 4 6 vi 2 corollary 23 23 for the riemannian case and os 1 section 7 for the finsler case we shall see that a similar argumentation gives a weak solution to the porous medium equation for m 1 or the fast diffusion equation for m 1 with drift of the form t 1 m m div 7 2 as gradient flow of the m relative entropy hm this is demonstrated by otto ot for the tsallis entropy as well as hm nm 0 cin with respect to the m gaussian measures nm 0 cin on r n dx and by villani vi 2 theorem 23 19 on weighted riemannian manifolds in a different way of interpretation from ours here we present a precise proof along the strategy of oh 1 go recall that expm theorem 7 6 gradient flow of hm let m g be compact m n 1 n 1 1 2 and be lipschitz if a curve t t 0 pac m is a gradient curve of hm then its density function t is a weak solution to the porous medium or the fast diffusion equation 7 2 to be precise m t 1 d t 1 m t 0 d t 0 t 1 t 0 m t t 1 m m 1 t t 1 m 1 t m 1 d t dt 7 3 holds for all 0 t 0 t 1 and c r m where t t t t proof fix t 0 and given small 0 choose p m as a minimizer of the function 7 hm w 2 t 2 2 we postpone the proof of the following technical claim until the end of the section we remark that the hypotheses m n 1 n and m 2 come into play in the proof of claim 7 7 i and iii respectively claim 7 7 i such indeed exists and is absolutely continuous with respect to 30 ii we have lim 0 w 2 t 2 2 0 lim 0 hm hm t in particular converges to t weakly iii moreover by putting m converges to mt in l 1 m take a lipschitz function m r such that t x expx x gives the optimal transport from to t we consider the transport f in another direction for small 0 where f x expx t x it immediately follows from the choice of that hm w 2 t 2 2 hm w 2 t 2 2 7 4 we first estimate the difference of distances observe that as f t is a not necessarily optimal coupling of and t lim sup 0 w 2 t 2 w 2 t 2 lim sup 0 1 m d f x t x 2 d x t x 2 d x m 2 t d we used the first variation formula for the distance d in the last line cf ch theo rem ii 4 1 thanks to the compactness of m there is a constant c 0 such that t t x t x t x x cd x t x 2 thus we obtain by virtue of claim 7 7 ii lim inf 0 1 2 lim sup 0 w 2 t 2 w 2 t 2 lim sup 0 1 m t d lim inf 0 1 m t t t d cw 2 t 2 lim inf 0 1 m t d m t d t next we calculate the difference of entropies in 7 4 we put and j e f det df then we obtain from the jacobian equation f j theorem 2 10 that hm 1 m m m d 1 m m 1 m m 1 m m 1 d 1 m m 1 m f m 1 m f m 1 d 1 m m 1 m j m 1 m f m 1 d 31 thus we have hm hm 1 m m 1 m m 1 1 j 1 m m m 1 f m 1 d note that as det df 0 1 lim 0 j 1 lim 0 e f det df 1 trace hess t t t t t hence we obtain together with claim 7 7 iii lim 0 hm hm m 1 m m 1 t 1 m 1 t m 1 d 7 5 m 1 m m 1 t t 1 m 1 t m 1 d t as tends to zero these together imply lim inf 0 1 m t d m t d t m 1 m m 1 t t 1 m 1 t m 1 d t moreover equality holds since we can change into recall from go 4 see also oh 1 lemma 6 4 that lim 0 1 m h d t m h d 0 holds for all h c m therefore we conclude lim 0 1 m t d t m t d t lim 0 1 m t t d t m t d t m t d t m t t 1 m m 1 t t 1 m 1 t m 1 d t as desired remark 7 8 in theorem 7 6 assuming t is absolutely continuous is redundant for m 1 hm t immediately implies t pac m for m 1 if t with t 0 32 has a nontrivial singular part s then the modification of t as in the proof of claim 7 7 i with t gives a measure r pac m for small r 0 such that w 2 t r 2 s m r 2 hm r hm t c m s m rn 1 m with c 0 as n 1 m 1 these yield hm t as r goes to zero which contradicts the definition of gradient curves compare this with ags theorem 10 4 8 recall from theorem 4 1 that the entropy hm is k convex if and only if ricn 0 and hess k combining this with theorems 7 5 7 6 we obtain the following corollary 7 9 suppose that m g is compact and m 0 is convex then the weak solution t t 0 pac m 0 to the porous medium or the fast diffusion equation 7 2 con structed in theorem 7 6 enjoys the k contraction property 7 1 under the assumptions ricn 0 and hess k on m 0 the argument in the proof of theorem 7 6 also shows that the absolute gradient of hm at coincides with the square root of them relative fisher information introduced in 5 2 for general m compare this with theorem 5 2 proposition 7 10 take m n 1 n 1 1 and pac m such that is lipschitz for any d 2 2 convex function m r and the corresponding transport t tt with tt x expx t x t 0 it holds that lim t 0 hm t hm t 1 m 1 m m 1 m 1 d in particular we have hm im and if hm then the negative gradient vector hm is achieved by m 1 m 1 m 1 proof recall that is twice differentiable a e and that t is absolutely continuous for t 1 vi 2 theorem 8 7 using the calculation deriving 7 5 we obtain lim t 0 hm hm t t m 1 m m 1 1 m 1 m 1 d m 1 m m m 1 m 1 d 1 m 1 m m 1 m 1 d as any geodesic with respect to w 2 is realized in this way theorem 2 8 we have hm im and if hm hm m 1 m 1 m 1 33 remark 7 11 the family of m gaussian measures example 2 6 is closely related to the barenblatt solution to 7 2 without drift and again has a role to play here on the unweighted euclidean space rn dx it is known by ow proposition 5 that a solution to 7 2 starting from an m gaussian measure will keep being m gaussian an explicit expression of such solutions is given in ta 2 7 4 proof of claim 7 7 i the existence follows from as usual the compactness of p m and the lower semi continuity of hm lemma 3 4 the absolute continuity is obvious for m 1 for m 1 decompose into absolutely continuous and singular parts s and suppose s m 0 we modify into r pac m as d r x r x d x x m b y r x b y r d s y d x for small r 0 then we find m m 1 d r m m 1 d m y m 1 1 b y r b y r m 1 d d s y m m 1 d sup m m 1 r s m given an optimal coupling 1 2 of and t such that p 1 1 and p 1 2 s d r x z d 1 x z y m b y r x b y r d x d 2 y z is a coupling of r and t hence we observe w 2 r t 2 m m d x z 2 d 1 x z m m d y z r 2 d 2 y z m m d x z 2 d x z 2 diamm r r 2 m m w 2 t 2 3 diamm r s m finally it follows from the ho lder inequality that m mr d m m x s m b y r x b y r d s y m d x s m m 1 m m x s m b y r x b y r m d s y d x s m m 1 m m b y r m s m m d b y r 1 b y r m d d s y m m d s m 1 m b y r m d d s y s m m 1 m b y r 1 m d s y 34 as m is compact we find s m m 1 m b y r 1 m d s y s m mc 1 m rn 1 m and for all y supp s b y r m d b y r m 1 m m 1 m d b y r m 1 d m b y r m d 1 m b y r m 1 d m c 2 m r n 1 m since limr 0 supy m b y r m 1 d 0 these imply for small r 0 m mr d m m d 1 2 c 1 m s m mrn 1 m combining these we conclude that hm r w 2 r t 2 2 hm w 2 t 2 2 c 3 m s m mrn 1 m c 4 m m s m r where c 3 c 4 0 then n 1 m 1 and s m 0 yield that hm r w 2 r t 2 2 hm w 2 t 2 2 holds for small r 0 this contradicts the choice of therefore we obtain s m 0 ii by the choice of we have hm w 2 t 2 2 hm t which immediately implies lim 0 w 2 t 2 lim 0 2 hm t 0 thus con verges to t weakly and hence lim sup 0 w 2 t 2 2 hm t lim inf 0 hm 0 by the lower semi continuity lemma 3 4 this further yields hm t lim inf 0 hm lim sup 0 hm hm t where the last inequality follows again from the choice of iii this is a consequence of the following general lemma 35 lemma 7 12 assume m n 1 n 1 1 2 and that a sequence i i n pac m converges to pac m weakly as well as limi hm i hm then by setting i i and m i converges to m in l 1 m proof note that the convergence of hm i ensures limi m mi d m m d we shall show the following for any constant c 0 it holds limi min i c min c l 2 m 0 then we have for m 1 m mi m d m i m d m 1 m m i d m and m i d m min i c min c max i c 0 max c 0 d 0 as i and then c precisely m max i c 0 d m i min i c d 1 m min c d i 0 c where is used when taking the limit as i for m 1 2 we similarly find m mi m d m m i max i m 1 d m m i m d 1 m m i m d m 1 m 7 6 and m i m d 2 m 1 m min i c min c m max i c 0 m max c 0 m d 0 as i and then c indeed m max i c 0 m d m i min i c m d m mi min i c m d m m min c m d i 0 c 36 where we used the calculation as in 7 6 and to see lim i m min i c m min c m d 0 to show we suppose that it is false then there are some constants c 0 and a sequence lj j n n going to infinity such that min c min lj c l 2 m 7 7 for all j n note that as d 2 tm m m 1 dt 2 tm 2 1 m m 1 lj 2 m m mlj 2 m m 1 max lj m 2 8 lj 2 for the second term we observe max lj m 2 lj 2 cm 2 min c min lj c 2 this is clear if max lj c or min lj c and follows from m 2 2 1 2 for 1 otherwise thus we obtain by 7 7 1 m m 1 m lj 2 m d m m mlj 2 m m 1 d cm 2 8 m min c min lj c 2 d m m mlj 2 m m 1 d cm 2 8 2 this means that j lj 2 satisfies lim sup j hm j lim i hm i cm 2 8 2 hm cm 2 8 2 this contradicts the lower semi continuity of hm lemma 3 4 8 finsler case we finally stress that most results in this article are extended to finsler manifolds accord ing to the theory developed in oh 2 os 1 see also a survey oh 3 briefly speaking a finsler manifold is a differentiable manifold equipped with a minkowski norm on each tangent space restricting these norms to those coming from inner products we have the family of riemannian manifolds as a subclass we refer to bcs sh for the basics of finsler geometry and to oh 2 os 1 oh 3 for the details omitted in the following discussion a finsler manifold m f will be a pair of an n dimensional c manifold m and a c finsler structure f tm 0 satisfying the following regularity positive homogeneity and strong convexity conditions 37 1 f is c on tm 0 where 0 stands for the zero section 2 f v f v holds for all v tm and 0 3 in any local coordinate system xi ni 1 of an open set u m and the corresponding coordinate v i v i xi x of txm with x u the n n matrix 2 f 2 vi vj v n i j 1 is positive definite for all v txm 0 and x u then the distance d geodesics and the exponential map are defined in the same manner as riemannian geometry whereas d is typically nonsymmetric and not a distance in the precise sense since f is merely positively homogeneous nonetheless d satisfies the positivity and the triangle inequality on a finsler manifold m f there is no constructive measure as good as the rie mannian volume measure in the riemannian case cf oh 4 but we can consider an arbitrary positive c measure on m and associate it with the weighted ricci curva ture ricn oh 2 this curvature turns out extremely useful and the argument in oh 2 is applicable to generalizing the whole results in sections 4 6 to the finsler setting we need a little trick only in proposition 5 4 put 1 f when m 1 to have 1 f m 1 1 m 1 1 m f m 1 1 m f m 1 theorem 8 1 let m f be a forward complete connected finsler manifold and be a positive c measure on m then the following results in this article hold true also for m f with appropriate interpretations for the nonsymmetric distance cf oh 2 equivalence between the convexity of hm and a curvature bound theorem 4 1 functional inequalities propositions 5 1 5 4 theorem 5 2 concentration of measures theorem 6 1 corollary 6 5 proposition 6 7 as for section 7 due to the lack of the analogue of theorem 7 1 we can not directly follow the riemannian argument nonetheless we can apply the discussion in os 1 using a formal finsler structure of the wasserstein space and obtain results corresponding to theorem 7 6 and proposition 7 10 the point is the usage of the structure of the underlying space m while we did not explicitly use it in subsections 7 1 7 2 see os 1 sections 6 7 for further details we remark that however the k contraction property 7 1 essentially depends on the riemannian structure and can not be expected in the finsler setting cf os 2 let m f be compact from now on due to otto s idea ot section 4 we introduce a finsler structure of p m w 2 as follows given p m we define the tangent space t p fw at by fw m f 2 d 1 2 for c m t p c m fw 38 where the gradient vector x txm is the legendre transform of the derivative d x t xm and the closure was taken with respect to fw we remark that the gradient is a nonlinear operator i e 1 2 x 6 1 x 2 x and x 6 x in general since the legendre transform is nonlinear unless f txm is riemannian now we take a locally lipschitz curve t t i p m w 2 on an open interval i r we can associate it with the tangent vector field t t t tp that is is a borel vector field on i m with t x txm and f l loc i m d tdt satisfying the continuity equation t t div t t 0 in the weak sense that i m t t d t t d tdt 0 8 1 holds for all c c i m ags theorem 8 3 1 os 1 theorem 7 3 using these differentiable structures we can consider gradient curves in a way different from the metric approach in section 7 definition 8 2 given a function f p m and p m with f we say that f is differentiable at if there is t p such that lim t 0 f tt f t m l d holds for all c m where tt x expx t and l txm t xm stands for the legendre transform then we write wf then a gradient curve should be a solution to t w hm t we first show that w hm t is described by the fisher information like proposition 7 10 proposition 8 3 take pac m with m h 1 m if m 1 m 1 6 h 1 m then hm is not differentiable at if m 1 m 1 h 1 m then hm is differentiable at and we have w hm m 1 m 1 1 m t p proof fix arbitrary c m and put tt x expx t x t t tt for sufficiently small t 0 then the jacobian equation t tt j t holds a e oh 2 theorem 5 2 where j t x stands for the jacobian of dtt x txm ttt x m with respect to thus we obtain as in the proof of theorem 7 6 hm t hm 1 m m 1 m m 1 j t 1 m 1 m m 1 tt m 1 d we observe as m h 1 m lim t 0 m j t 1 m 1 t m d 1 m lim t 0 m j t 1 t m d 1 m lim t 0 m m tt m t j t d m 1 m d m d m m d m 1 d 39 and hence lim t 0 hm hm t t m d m 1 m 1 1 m d this yields w hm m 1 m 1 1 m provided that m 1 m 1 h 1 m suppose m 1 m 1 6 h 1 m note that m 1 m 1 l 2 m since m l 2 m and m is compact thus we find f m 1 m 1 6 l 2 m therefore we obtain lim sup hm hm w 2 by approximating m 1 m 1 with c m and choosing 1 m hence hm is not differentiable at theorem 8 4 let t t 0 pac m be a continuous curve that is locally lipschitz on 0 and assume that t t satisfies mt h 1 m as well as m 1 t m 1 h 1 m t for a e t 0 then we have t w hm t at a e t 0 if and only if t t 0 is a weak solution to the reverse porous medium or fast diffusion equation of the form t div m 1 m 1 1 m 8 2 proof if t w hm t holds for a e t then proposition 8 3 yields t m 1 t m 1 1 m a e t thus it follows from the continuity equation 8 1 that 0 m t t d tdt 0 m d t m 1 t m 1 1 m d tdt for all c c 0 m therefore t weakly solves 8 2 conversely if t is a weak solution to 8 2 then the same calculation implies that t m 1 t m 1 1 m satisfies the continuity equation 8 1 therefore proposition 8 3 shows t t w hm t we meant by the reverse porous medium or fast diffusion equation the equation with respect to the reverse finsler structure f v f v as the gradient vector for f is written by u u 8 2 is indeed rewritten as t div m 1 m 1 m 1 40 references agk m agueh n ghoussoub and x kang geometric inequalities via a general com parison principle for interacting gases geom funct anal 14 2004 215 244 am s amari differential geometrical methods in statistics lecture notes in statis tics 28 springer verlag new york 1985 an s amari and h nagaoka methods of information geometry translated from the 1993 japanese original by daishi harada american mathematical society providence ri oxford university press oxford 2000 ags l ambrosio n gigli and g savare gradient flows in metric spaces and in the space of probability measures birkha user verlag basel 2005 bs k bacher and k t sturm localization and tensorization properties of the curvature dimension condition for metric measure spaces j funct anal 259 2010 28 56 be d bakry and m e mery diffusions hypercontractives french se minaire de probabilite s xix 1983 84 177 206 lecture notes in math 1123 springer berlin 1985 bcs d bao s s chern and z shen an introduction to riemann finsler geometry springer verlag new york 2000 ch i chavel riemannian geometry a modern introduction second edition cam bridge university press cambridge 2006 cgh d cordero erausquin w gangbo and c houdre inequalities for generalized en tropy and optimal transportation recent advances in the theory and applications of mass transport 73 94 contemp math 353 amer math soc providence ri 2004 cms d cordero erausquin r j mccann and m schmuckenschla ger a riemannian interpolation inequality a la borell brascamp and lieb invent math 146 2001 219 257 fg a figalli and n gigli local semiconvexity of kantorovich potentials on non compact manifolds to appear in esaim control optim calc var gi n gigli on the inverse implication of brenier mccann theorems and the structure of p 2 m w 2 preprint 2009 available at http cvgmt sns it people gigli go n gigli and s ohta first variation formula in wasserstein spaces over compact alexandrov spaces to appear in canad math bull jko r jordan d kinderlehrer and f otto the variational formulation of the fokker planck equation siam j math anal 29 1998 1 17 41 http cvgmt sns it people gigli le m ledoux the concentration of measure phenomenon american mathematical society providence ri 2001 lo j lott some geometric properties of the bakry e mery ricci tensor comment math helv 78 2003 865 883 lv 1 j lott and c villani weak curvature conditions and functional inequalities j funct anal 245 2007 311 333 lv 2 j lott and c villani ricci curvature for metric measure spaces via optimal transport ann of math 169 2009 903 991 mc 1 r j mccann a convexity principle for interacting gases adv math 128 1997 153 179 mc 2 r j mccann polar factorization of maps on riemannian manifolds geom funct anal 11 2001 589 608 ow a ohara and t wada information geometry of q gaussian densities and be haviors of solutions to related diffusion equations j phys a 43 2010 035002 18 pp oh 1 s ohta gradient flows on wasserstein spaces over compact alexandrov spaces amer j math 131 2009 475 516 oh 2 s ohta finsler interpolation inequalities calc var partial differential equa tions 36 2009 211 249 oh 3 s ohta optimal transport and ricci curvature in finsler geometry adv stud pure math 57 2010 323 342 oh 4 s ohta vanishing s curvature of randers spaces to appear in differential geom appl os 1 s ohta and k t sturm heat flow on finsler manifolds comm pure appl math 62 2009 1386 1433 os 2 s ohta and k t sturm non contraction of heat flow on minkowski spaces preprint 2010 available at arxiv 1009 2312 ot f otto the geometry of dissipative evolution equations the porous medium equation comm partial differential equations 26 2001 101 174 ov f otto and c villani generalization of an inequality by talagrand and links with the logarithmic sobolev inequality j funct anal 173 2000 361 400 qi z qian estimates for weighted volumes and applications quart j math oxford ser 2 48 1997 235 242 vrs m k von renesse and k t sturm transport inequalities gradient estimates entropy and ricci curvature comm pure appl math 58 2005 923 940 42 http arxiv org abs 1009 2312 sh z shen lectures on finsler geometry world scientific publishing co singapore 2001 st 1 k t sturm convex functionals of probability measures and nonlinear diffusions on manifolds j math pures appl 84 2005 149 168 st 2 k t sturm on the geometry of metric measure spaces i acta math 196 2006 65 131 st 3 k t sturm on the geometry of metric measure spaces ii acta math 196 2006 133 177 ta 1 a takatsu wasserstein geometry of gaussian measures to appear in osaka j math ta 2 a takatsu wasserstein geometry of porous medium equation preprint 2010 available at http sites google com site asukatakatsu home paper ts 1 c tsallis possible generalization of boltzmann gibbs statistics j statist phys 52 1988 479 487 ts 2 c tsallis introduction to nonextensive statistical mechanics springer 2009 vi 1 c villani topics in optimal transportation american mathematical society providence ri 2003 vi 2 c villani optimal transport old and new springer verlag berlin 2009 43 http sites google com site asukatakatsu home paper 1 introduction 2 preliminaries 2 1 weighted ricci curvature 2 2 generalized exponential functions and gaussian measures 2 3 wasserstein geometry 3 generalized relative entropies 3 1 background tsallis entropy and information geometry 3 2 m relative entropy 4 displacement convexity 5 functional inequalities 6 concentration of measures 7 gradient flow of hm 7 1 geometric structure of p m w 2 7 2 gradient flows in p m w 2 7 3 m relative entropy and the porous medium fast diffusion equation 7 4 proof of claim 7 7 8 finsler case