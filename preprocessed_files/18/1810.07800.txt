alignments as compositional structures janember 9999 issn 2631 4444 alignments as compositional structures sarah berkemer 1 christian h ner zu siederdissen 2 and peter f stadler 3 1 max planck institute for mathematics in the sciences leipzig germany and bioinformatics group depart ment of computer science universit t leipzig germany 2 bioinformatics group department of computer science universit t leipzig germany 3 bioinformatics group department of computer science universit t leipzig germany max planck institute for mathematics in the sciences leipzig germany department of theoretical chemistry university of vienna austria facultad de ciencias universidad nacional de colombia bogot colombia santa fe institute santa fe nm usa alignments i e position wise comparisons of two or more strings or ordered lists are of utmost practical importance in computational biology and a host of other fields including historical linguistics and emerging areas of research in the digital humanities the problem is well known to be computationally hard as soon as the number of input strings is not bounded due to its prac tical importance a huge number of heuristics have been devised which have proved very successful in a wide range of applications alignments nevertheless have received hardly any attention as formal mathematical structures here we focus on the compositional aspects of alignments which underlie most algo rithmic approaches to computing alignments we also show that the concepts naturally generalize to finite partially ordered sets and partial maps between them that in some sense preserve the partial orders 1 introduction alignments play an important role in particular in bioinformatics as a means of comparing two or more strings by explicitly identifying correspondences between letters usually called matches and mismatches as well as insertions and deletions 11 the aligned positions are interpreted either as deriving from a common ancestor homologous or to be functionally equivalent alignments have also been explored as means of comparing words in natural languages see e g 5 9 33 51 as a convenient way of comparing ranked lists 16 for comparison of text editions 53 58 and to analyse synteny in the comparison of genomes 21 55 the literature on alignments is extensive however it its concerned almost exclusively with practical algorithms and applications the alignment problem for two input strings has an elegant recursive solution for rather general cost models and has served as one of the early paradigmatic examples of dynamic programming 44 49 since these algorithms have only quadratic space and time requirements for simple cost models 19 44 they are sarah berkemer bsarah bioinf uni leipzig de christian h ner zu siederdissen choener bioinf uni leipzig de peter f stadler studla bioinf uni leipzig de accepted in compositionality on 9999 99 99 click on the title to verify 1 ar x iv 1 81 0 07 80 0 v 1 m at h c o 9 o ct 2 01 8 http www compositionality journal org template https orcid org 0000 0003 2028 7670 https orcid org 0000 0001 9517 5839 https orcid org 0000 0002 5016 5191 mailto bsarah bioinf uni leipzig de mailto choener bioinf uni leipzig de mailto studla bioinf uni leipzig de janember 9999 issn 2631 4444 a b c d a 0000111110000 a 0000111110000 b 000011011 b 000011011 b 000011011 c 100010000 c 100010000 c 100010000 s 4 s 2 s 5 s 5 figure 1 alignments of three binary sequences a b and c with a simple column wise score of 1 for matches 0 for mismatches and 1 for gaps alignment c is transitively implied by a and b but is it not an optimal pairwise alignment of b and c of key importance in practical applications the same recursive structure easily generalizes to alignments of more than two sequences 8 38 even though the cost models need to be more restrictive to guarantee polynomial time algorithms 31 the computational effort for these exact solutions to the alignment problem increases exponentially with the number of sequences hence only implementations for 3 way 20 32 34 and 4 way alignments 51 have gained practical importance a wide variety of multiple sequence alignment problems for arbitrary numbers of input sequences have been shown to be np hard 6 14 28 30 56 and max snp hard 40 57 the construction of practical multiple alignment algorithms therefore relies on heuristic approximations these fall into several classes see e g 3 12 for reviews 1 progressive methods typically compute all pairwise alignments and then use a guide tree to determine the order in which these are stepwisely combined into a multiple align ment of all input sequences the classical example is clustalw 35 the approach can be extended to starting from exact 3 way 32 34 or 4 way alignments 51 2 iterative methods starting to align small gapless subsequences and then extend and improve the alignment until the score converges a paradigmatic example is dialign 42 3 consistency based alignments and consensus methods start from a collection of partial alignments often exact pairwise alignments to obtain candidate matches and extract a multiple alignment using agreements between between the input alignments most of the successful multiple alignment algorithm in computational biology combine these paradigms for example t coffee 45 and probcons 10 use consistency ideas in combination with progressive constructions muscle 13 and mafft 29 combine progres sive alignments with iterative refinements a key assumption underlying consistency based methods is transitivity considering three input sequences x y and z if xi aligns with yj and yj aligns with zk then xi should also align with zk while this property holds for the pairwise constituents of a multiple alignment it is a well known fact that the three score optimal alignments that can be constructed from three sequences in general violate transitivity see fig 1 transalign 39 uses transitivity to align input sequences to a target database using an intermediary database of sequences to increase the search space here intermediary sequences show which subsequences of input and target sequence can be transitively aligned this may result in a few well aligned subsequences that are then extended to one aligned region via a simple scoring function the same notion of transitivity is also used in psiblast 2 to stepwisely increase the set of sequences that are faintly similar to an input sequence practical applications distinguish whether the complete input sequences are to be aligned or whether a maximally scoring interval is to be considered in the latter case one allows an additional unaligned state for prefixes and or suffixes of the input this leads to slight changes in exact algorithms exemplified by an extra term in the local smith waterman algorithm 50 compared to the global needleman wunsch 44 algorithm this idea can be generalized to mixed problems in which a user can determine for each of the two ends of each input sequence whether it is to be treated as local or global 48 for accepted in compositionality on 9999 99 99 click on the title to verify 2 janember 9999 issn 2631 4444 the purpose of the present contribution partially local alignments require a slight trivial extension of the presentation which we for the sake of clarity in the presentation only briefly comment on alignments are usually constructed from strings or other totally ordered inputs hence the columns of the resulting alignment are usually also treated as a totally ordered set consecutive insertions and deletions however are not naturally ordered relative to each other gugugu acgggcca guguguac gggcca gucuguug gggccc gucugu uggggccc 1 are alignments that are equivalent under most plausible scoring models the idea to con sider alignment columns as partial orders was explored systematically in 37 and a series of follow up publications 22 36 here mis matches are considered as an ordered back bone with no direct ordering constraints between an insertion and a deletion the resulting alignments are then represented as directed acyclic graphs dags more precisely as the hasse diagrams of the partial order the key idea behind the poa software 37 is that a sequence of dags can be used as an input to a modified version of the needleman wunsch algorithm 44 recently this idea has been generalized to the problem of aligning a sequence to a general directed graph 47 54 despite the immense practical importance of alignments they have received very little attention as mathematical structures in the past the most comprehensive treatment at least to our knowledge is the technical report 43 which considers pairwise alignments as binary relations between sequence positions that represent matchings and preserve order we use many of these ideas here the notion of a composition of pairwise alignments formalized as composition of partial maps that represent the matching first appears in 39 we will return to this point in section 3 following our earlier work 46 we will use a language that is closer to graph theory than the presentation of 43 2 alignments and partial orders consider a finite collection x of two or more finite totally ordered sets xa it will be convenient in the following to denote an element i xa by a i the following definition rephrases the approach taken e g in 43 52 it will be generalized below to deal with partial orders instead of total orders definition 1 46 a total alignment of the totally ordered sets xa is a triple x a where x a is a graph and is a total order relation on the set of connected components c x a satisfying 1 1 q c x a is a complete subgraph of x a 2 if a i q and a j q then i j 4 if a i b j p and a k b l q with i k then j l 5 if a i p a j q and i j then p q the connected components of x a are usually called the alignment columns condi tion 2 ensures that every alignment column contains at most one element of each ordered set xa conversely every element a i is contained in exactly one connected compo nent i e alignment column condition 4 requires that alignment columns do not cross 1 there is no condition 3 due to synchronization with the definitions for partial orders defined later accepted in compositionality on 9999 99 99 click on the title to verify 3 janember 9999 issn 2631 4444 condition 5 ensures that the order on the columns is such that the projection of the alignment columns to each individual row exactly recovers the input order conditions 4 and 5 in general only specify a partial order as the following result shows lemma 2 let x a be the graph of an alignment and denote by the relation on c x a defined by p q whenever there is a i p and a j q with i j then the transitive closure of is a partial order on c x a proof clearly is antisymmetric if p q then there there is a sequence of columns p q 0 q 1 qk q since the sequence of elements a i belonging to the same xa is strictly increasing with the column index j for each a along any such sequence of columns it follows that the transitive closure of is still antisymmetric and thus a partial order as an immediate consequence there is also a not necessarily unique total order of the alignment columns obtained as an arbitrary linear extension of which by con struction satisfies p q a i p and a j q implies i j 2 hence whenever conditions 1 2 and 4 in definition 1 are satisfied there indeed exists a total order on c x a that satisfies condition 5 in order to treat partially local alignments it is necessary to distinguish aligned and unaligned columns each unaligned column may contain only a single element note however that also regular columns may contain only a single entry from each row fur thermore all unaligned positions for a prefix and or a suffix of each input xa a form unaligned columns in this condition we will consider a more general setting instead of totally ordered sets xa we will consider finite partially ordered sets xa a definition 3 an alignment of x is a triple x a where x a is a graph and is a partial order on the set of connected components c x a such that a 1 q c x a is a complete subgraph of x a a 2 if a i q and a j q then i j a 3 if a i p a j q and a i a a j then p q a 4 p q a i p and a j q implies a i a a j or a i and a j are incomparable w r t a condition a 3 constrains the partial order on the columns to respect the partial order of the rows condition a 4 insists that columns also must not cross indirectly condition a 4 obviously implies the following generalization of 4 a 4 a i b j p and a k b l q and a i a a k implies b j b b l or b j and b l are incomparable w r t b however a 4 is not sufficient to guarantee that the alignment columns form a partially ordered set a counterexample is shown in fig 2 it is therefore necessary to require the existence of the partial order on c x a in definition 3 accepted in compositionality on 9999 99 99 click on the title to verify 4 janember 9999 issn 2631 4444 1 2 3 4 a b figure 2 property a 4 is not sufficient to ensure the existence of a partial order on c x a consider the partial orders a 4 a a 1 and a 2 a a 3 and b 1 b b 2 and b 3 a b 4 with alignment colums a i b i for i 1 2 3 4 clearly a 2 a 3 and a 4 holds but the directed cycle shows that no partial order on the colums exists that is consistent with both partial orders in order to model partially local alignments of posets we consider the set a of aligned columns and a partition of the set of unaligned columns into two not necessarily non empty subsets p and s such that for all u p v a and w s it holds that w 6 v and v 6 u i e no unaligned suffix column preceeds an aligned column and no unaligned prefix column succeeds an aligned column unaligned prefix columns belonging to different rows xa a are considered mutually incomparable the same is assumed for unaligned suffix columns with the caveat that unaligned columns need to be marked as such there is no structural difference between local and global alignments if all xa a are totally ordered then condition a 4 implies the non crossing condition 4 because b j and b l cannot be incomparable w r t b and thus the required partial order is obtained as the transitive closure of the relative order of any two columns definitions 1 and 3 therefore coincide for totally ordered rows the existence of non trivial alignments of any collection of finite partial orders xi i i 1 n is easy to see each of the partial orders can be linearly extended to a total order xi i any alignment of these total orders is also an alignment of the underlying partial orders with a suitable partial order of the columns given by lemma 2 it may be interesting to explore alignments satisfying a much stronger version of axiom a 4 which stipulates that xa a is recovered as projection of x a onto row a i e a 5 p q a i p and a j q implies a i a a j as argued above a 4 and a 5 are equivalent if all xa a are totally ordered in general this is not the case as the example in fig 3 shows the following simple technical result is a generalization of lemma 2 showing that condition a 5 is sufficient to guarantee the existence of a partial order on the columns lemma 4 let x a be a graph with connected components c x a satisfying a 1 and a 2 let denote the transitive closure of the relation defined by a 3 i e p q whenever a i p a j q and a i a a j then p q finally assume that axiom a 5 holds then is a partial order on c x a proof it suffices to show that is antisymmetric it is clear from the construction that by a 5 we know that is antisymmetric if is not antisymmetric then there is a finite sequence of columns pi i 0 k such that p 0 p 1 pk p 0 such that any two consecutive columns pi and pi 1 have at a pair of entries say ai h pi and ai h pi 1 in the same row for the transitive closure this would imply both accepted in compositionality on 9999 99 99 click on the title to verify 5 janember 9999 issn 2631 4444 figure 3 top pairwise alignments of partially ordered sets thin black edges show the hasse diagram to be read from left to right alignment edges are shown in green bottom the induced partial order of the alignment columns with corresponding points vertically aligned the partial order is again shown as a hasse diagram with superflous edges omitted both the l h s and the r h s example satisfy a 4 i e none of order relations 1 and 2 is violated in the alignment the red edges highlight two comparabilities introduced by partial order of the columns that are absent in the input posets red edges therefore imply a violation of condition a 5 hence the l h s alignment violates a 5 while the r h s alignment does not ai h ai h from ai h ai h and ai h ai h by going around the cycle contradictiong axiom a 5 condition a 5 implies that the restriction of the partial order on the columns to any subset of columns in which a given set of rows is represented coincides with the induced partial order on the corresponding vertex set in xa a regarding the xa a as graphs the aligned columns form a common induced subgraph the alignment problem for partially ordered sets under axiom a 5 thus can be seen as a generalized version of a maximum induced subgraph problem we refer to 7 for a discussion of the relationships of edit distances and maximum common subgraph problems in a more general setting the following result generalizes lemma 1 of 46 lemma 5 let x a be an alignment and let y x then the induced subgraph x a y with the partial order restricted to the non empty intersections q y for q c x a is again an alignment furthermore if x a satisfies a 5 then the restriction to x a y again satisfies a 5 proof every induced subgraph of a complete graph is again a complete graph hence a 1 holds for x a y hence the connected components of x a y are exactly the non empty intersections of y with the components q of x a condition a 2 remains unchanged by the restriction to y finally the partial order satisfying a 3 restricted to the non empty intersections q y for q c x a is a partial order that obviously still satisfies a 4 since the restriction to y only removes some of the conditions in a 4 to see that the restriction of x a y again satisfies a 5 it suffices to recall that the partial order in the colums is given by p y q y whenever p q and both p y 6 and q y 6 if one of the intersections is empty axiom a 5 becomes void since the empty set is not a column in x a y on the other hand if the two restricted accepted in compositionality on 9999 99 99 click on the title to verify 6 janember 9999 issn 2631 4444 columns have entries a i and a j in the same row then a 5 for x a ensures a i a a j i e the implication a 5 remains true for the restricted alignment note that additional partial orders on connected components of the induced subgraph x a y may exist that are not obtained as restrictions of the partial order on c x a the reason is that omitting parts of the columns may allow a relaxation of their mutual ordering rooted trees can be seen as partially ordered sets with the natural partial order defined by x y if y lies on the unique path connecting x and the root of the tree this special case is thus covered in the general framework outlined here usually tree alignments are defined on rooted oriented trees however where the relative order of siblings is preserved 4 23 27 thus imposing additional restrictions on valid alignments we will return to this point in some generality in the discussion section 3 composition of alignments the fact that alignments are again totally or partially ordered sets implies that one can also meaningfully define alignments of alignments more precisely lemma 6 let x a be an alignment and consider a non trivial partition p of the set of objects i e the rows denote the site sets of the classes of p by x 1 x 2 xp and consider the sub alignments x a xi then x a is isomorphic to the vertex disjoint union of the x a xi augmented by extra edges x x whenever there is a column q of a with x q xi and x q xj for xi 6 xj proof the alignments x a xi are induced subgraphs of x a their disjoint union lacks exactly all edges that connect pairs of vertices that are in the same connected com ponent of x a but are not in the same subgraph x a xi since the partial order on the colums of x a xi is the one inherted from x a the re composition of the columns also recovers the original partial order the x a xi can also be interpreted as partially ordered sets whose points are the non empty restrictions q xi of the connected components of x a definition 7 we denote by x a p the quotient graph whose vertices are the columns of the alignments x a xi that is the non empty sets q xi where q is a connected component of x a its edges are the pairs q xi q xj for which both q xi and q xj are non empty the connected components of the graph x a p are therefore of the form q q p q xi q xi 6 note that q is non empty since the column q of x a contains at least one element which belongs to at least one of the x a xi thus there is a 1 1 correspondence between the connected components of x a and those of x a p the columns of x a p naturally inherit the partial order of c x a we write x a p for the quotient graph with this partial order on its connected components lemma 8 x a p is an alignment proof consider the quotient graph x a p by construction each column q is a complete graph and contains at most one node for each class of p since it is the quotient of a column of x a w r t p also by construction we have p q for the columns of x a p whenever p q in x a since there is a 1 1 correpondence between accepted in compositionality on 9999 99 99 click on the title to verify 7 janember 9999 issn 2631 4444 columns of x a and x a p also serves as a partial order on the columns of x a p which is by construction consistent with the partial order on each of the x a xi as a consequence every alignment can be decomposed into an alignment of alignments w r t an arbitrary partition of the rows the constituent alignments xi a i have at most the same number of columns since all gap columns q q xi are removed by lemma 8 the decomposition can be used recursively until each constituent is only a single partially ordered set xa a any such recursive composition is naturally represented as a tree t whose leaves are the input posets xa a each internal node of t corresponds the an alignment of its children with the root corresponding to x a the alignment of all the data the reverse of this type of decomposition underlies all progressive alignment schemes one starts from a guide tree t whose leaves are the xa a and for each inner node of t constructs an alignment or a set of alternative alignments from the set of alignments attached to its children it is important to note that a score optimal alignment x a in general is not the score optimal alignment x a p of score optimal consitutents xi ai i or in other words if x a is score optimal there is no guarantee that there is any partition of the rows p such that all the restrictions x a xi are score optimal subalignments progressive alignments methods thus can only approximate the solution of the multiple alignment problem practical results depend substantially on the choice of the guide tree t it is has been suggested early 17 that t should closely resemble the evolutionary history of the input sequences usually t is constructed from distance or similarity measures between all pairs of input sequences and usually pairwise alignments are employed to obtain these data a special case of progressive alignment adds a single sequence in each step instead of also considering alignments of alignments 4 blockwise decompositions on the other hand we can also decompose alignments into blocks of columns more precisely if x a is an alignment and q is a partition of the x with classes yk such that i if p c x a then p yk for some class yk q ii there is a partial order on q such that for any two distinct classes y y q such that y y whenever there are columns p y and q y with p q we call the classes of such a partition blocks by lemma 5 each block x a yk is again an alignment lemma 9 given blocks x a yk and the partial order there is an alignment x a where is an an extension of defined by p q if and only if p q for p q y for some y q and p q for p y and q y with y y proof each alignment block consists of the disjoint union of alignment column s thus the disjoint union of complete subgraphs given the partial order of alignment columns given by p q this order is preserverd inside the alignment blocks yk as each block is an alignment too given an alignment block y with p q for p q y for some y q one can decompose this into two blocks y and y with at least one column in each block such that p y and q y based on the decomposition of y into y and y one can accepted in compositionality on 9999 99 99 click on the title to verify 8 janember 9999 issn 2631 4444 restore the order of the alignment blocks such that y y based on y thus one gets the order of p q that is present for the alignment columns p and q as well as for the alignment blocks y and y in the case of totally ordered inputs the restriction xa y of a block y to an input xa is an interval of xa and the columns in y form an interval of the columns of x a similarly one can restrict the choice of blocks in such a way that just mirrors the initial partial order i e y y if and only if p q for p in y and q in y in which case and the original alignment is recovered by the concatenation of the blocks in particular this also guarantees that valid block decompositions can be constructed for alignments satisfying a 5 each alignment can thus be recursively decomposed into blocks this sets the stage for divide and conquer algorithms such as dca 52 which cuts the sequences to be aligned into subsequences and then concatenates the subalignments so as to optimize a global score in order to find the best cut points the algorithm recurses on differently cut subse quences algorithms such as dialign 42 work in a conceptually similar manner but use a bottom up instead of a top down approach they first identify blocks with high sequence conservation as anchors and recurse to construct alignments for sequences between them an extreme case of the block wise decomposition is to consider the division of an alignment x a into a single maximal or minimal alignment column p and the rest x p a of the alignment in order for x a p to hold we have to ensure that pa 6 a qa for all pa p and qa x p i e the column p must entirely consist of suprema of the respective input posets under this condition we obtain a recursive column wise decomposition of alignments as we shall see in the following section this recursion can also be used constructively 5 recursive construction given a poset y we say that p y is a bottom set if for all p p every p p satisfies p p by definition the empty set y itself as well as the set p y p y for each y y are bottom sets note however that p also may contain points that are incomparable to all other elements of p denote by supp the set of suprema of p i e the points such that there is no p p with p p clearly if p is a bottom set and p supp then p p is again a bottom set the latter observation suggests that there is a recursive construction for the set of alignments of x 1 1 and x 2 2 denote by apq the set of all pairwise alignments on bottom sets p in x 1 and q in x 2 an alignment a apq is necessarily of one of three types i a a pq with a ap q ii a a p with a ap q or iii a a q with a apq where p p p for p supp q q q for q supq and a contains only the empty alignment the three cases correspond to a mis match insertion and deletion it is important to note that this recursion is in general not unique because the columns extracted from a in consecutive steps are not necessarily ordered relative to each other whenever supp 1 or supq 1 it is however a proper generalization of the needleman wunsch recursion accepted in compositionality on 9999 99 99 click on the title to verify 9 janember 9999 issn 2631 4444 44 for the pairwise alignment of ordered sets strings if the a are total orders then suppa always contains a single element and we recover the usual needleman wunsch algorithm in order to have a proper start and end case for the recursion and thus dp algorithm it is convenient to introduce virtual source and a sink nodes being connected to all start or end nodes of the poset respectively this idea generalizes to alignments of an arbitrary number of partial orders in the obvious way denote by a p 1 p 2 pn the set of all alignments where the pa are a bottom set of xa a theorem 10 every alignment a a p 1 p 2 pn is of the form a where the alignment column is a supremum w r t the partial order of of alignment columns and a a p 1 p 2 p n the column contains in row a either a gap row a in which case p a pa or pa suppa in which case p a pa pa and does not entirely consist of gaps for every column of a we have either or and are incomparable proof the p a are again bottom sets hence a is an alignment by assumption there is a partial order on the columns of a since every non gap entry in is a pa suppa it follows that this partial order extends to a if and only if is a supremum i e it is either incomparable with or larger than any column in a now suppose that the column contains a qa suppa i e there is a pa xa with pa qa consider the column containing pa then either no partial order on the columns exists contradicting that a is an alignment or contradicting that is a supremum for the alignment columns the bottom sets are of course uniquely defined by their suprema clearly supp is an antichain i e its elements are pairwisely incomparable conversely every antichain u in xa a uniquely defines a bottom set p p xa p u it is obvious therefore that for two bottom sets p and q it holds that p q if and only if supp supq hence there is a 1 1 correspondence between the antichains of a partial order and their bottom sets the recursion in the theorem can be written in terms of the antichains of the xa a in order to capture the more restrictive notion of alignments satisfying a 5 the recur sion has to be modified in a such a way that for every mis match between two rows it can be ensured that all previously formed columns are either comparable in both rows or incomparable in both rows this is non trival because this information is not purely local for ease of discussion we only consider the case of aligning two posets there are at least two strategies to maintain this information attempting to construct a similar recursion as in the a 4 case one could store with each pair p x 1 and q x 2 also all the set m of all matchings pq to the right of p and q i e p x 1 p and q x 1 q then every allowed matching column p q p supp and q supq must satisfy for all pq m holds either p p and q q or both p p and q q are incomparable every such pair can be appended to m with corresponding updates p p p and q q q insertions and deletions of course only require the removal of either p from p or q from q respectively initially p x 1 q x 2 and m every set of valid partial alignments is characterized by a triple p q m an alternative approach is to store instead for each p p and q q also the sets cq p and cp q that can form matches p q q cq p and p q p cp q respectively initially we have p x 1 q x 2 cq p q for all p p and cp q p for all q q whenever an alignment is continued with a mis match pq p supp q supq we have to remove all candidates from cp q and cq p that are inconsistent with pq that accepted in compositionality on 9999 99 99 click on the title to verify 10 janember 9999 issn 2631 4444 is if q q then cp q p cp q p p if q and q and incomparable then cp q p cp q p p incomparable the cq p are updated correspondingly in the case of an insertion p we only need to remove p from fp q q q similarly q implies that q has to be removed from the fq p for all p p we suspect that an encoding of alignment sets of the form p fq p 2 p q fp q 2 p will be efficient if the poset has only small antichains a more detailed analysis of this kind of recursive construction from the point of view of algorithmic efficiency will be considered elsewhere the poa algorithm 37 computes the alignment of two posets satisfying a 5 albeit with the restriction that one of the two inputs is totally ordered this removes all ambigu ities in the totally ordered po set and implies that given any match uv in the alignment all preceeding matches u v satisfy v v in the totally ordered set and thus u must be a predecessor of u the alignment thus must follow a single path in the hasse diagram of the unrestricted input poset 6 pairwise alignments as relations pairwise alignments have a particularly simple structure in particular they are bipartite undirected graphs and hence can be regarded equivalently as symmetric binary relations r x 1 x 2 more precisely we can identify a relation r with an undirected graph with vertex set x 1 x 2 and undirected edges x 1 x 2 whenever x 1 x 2 r we write this graph as x 1 x 2 r relations have a natural composition for r x y and s y z is is defined by x z s r iff y y s t x y r and y z s 3 in the following we will be interested in the following properties of binary relations m x y r and x z r implies y z and x z r and y z r implies x y p there is a partial order on r such that u 1 x or v 2 y implies u v x y p if x 1 y 1 r and x 2 y 2 r then x 1 x 2 if and only if y 1 y 2 lemma 11 the composition of two binary relations satisfying m and p is again a binary relation satisfing m and p proof suppose x z r s then there is y such that both x y r and y z s by m there is no other y 6 y with x y r and no z 6 z such that y z s hence in particular there is no z 6 z such that x z r s analogously one argues that there is no x 6 x such that x z r s thus r s again satisfies m suppose x 1 z 1 x 2 z 2 r s by m there are unique vertices y 1 and y 2 such that x 1 y 1 x 2 y 2 r and y 1 z 1 y 2 z 2 s respectively now suppose x 1 1 x 2 then p implies y 1 2 y 2 and using p again yields z 1 3 z 2 starting from z 1 3 z 2 the same argument yields z 1 1 z 2 conversely suppose x 1 z 1 x 2 z 2 r s and x 1 x 2 are incomparable by m there are unique vertices y 1 and y 2 with x 1 y 1 x 2 y 2 r and y 1 z 1 y 2 z 2 s for which p now implies that they are incomparable using the same argument again shows that that z 1 and z 2 also must be incomparable hence concatenation preserves not only the relative order but also comparability i e r s again satisfies p accepted in compositionality on 9999 99 99 click on the title to verify 11 janember 9999 issn 2631 4444 it is easy to see that axiom p is in general not preserved under concatenation requiring only p allows the intermediate vertices y 1 and y 2 to be incomparable hence it is possible in this scenario to have x 1 1 x 2 incomparable vertices y 1 and y 2 and z 2 3 z 1 with x 1 y 1 x 2 y 2 r and y 1 z 1 y 2 z 2 s while the concatenation violates the p a relation satisfying m and p can easily be extended to an alignment x 1 x 2 r considering each edge x 1 y 1 and considering all unmatched positions i e every x such that there is no y x 2 x y and every y such that there is no x x 1 x y as alignment columns the relative order of these columns is inherited from the partial order x 1 1 and x 2 2 lemma 12 every pairwise alignment satisfying a 1 a 2 a 3 and a 4 can be writ ten as an extension of the a binary relation r x 1 x 2 satisfying m and p con versely every binary relation r x 1 x 2 satisfying m and p gives rise to an alignment satisfying a 1 a 2 a 3 and a 4 proof by definition all edges are incident to one vertex in x 1 and one vertex in x 2 thus the graph is a bipartite matching condition m is therefore equivalent to a 1 and a 2 for the case of two input posets axiom a 3 implies the ordering required by p as well as its extension to the in del columns a 4 and p equivalently guarantee the existence of the partial order on the columns that satisfy a 3 lemma 13 every pairwise alignment satisfying a 5 corresponds to a binary relation r x 1 x 2 satisfying m and p proof axiom a 5 simplifies to p in the case of only two inputs the existence of the required partial order on the set of all columns is guaranteed by lemma 4 this suggests that the more restrictive condition a 5 may be a more natural condition for defining alignments of partially ordered sets as a down side however it seems that there is no convenient recursive construction of the search space similar to the dynamic programming approaches for sequence alignment instead it seems more natural to treat this class of alignment problems as maximum induced subgraph problems composition of binary relations is a powerful tool to construct multiple alignments suppose we are given a set of posets xa a and a set r of pairwise relations satisfying m and p such that the graph representation of r is tree then there is a unique multiple alignment satisfying a 5 obtained as the transitive closure of the graph on x with edges defined by the r r however not every alignment can be represented in this manner as a simple counterexample consider the alignment of the three sequences a a c a a c a a c b bc b bc b bc b bc c ab c ab c a b where the composition of any two pairwise alignments gives rise to two different columns for in del columns of the pairwise components in the example of two a entries on the other hand the progressive approach in which sequence c is aligned to the pairwise alignment of a and b yields the example alignment in fact lemma 8 implies that in principle every alignment can be obtained by a progressive alignment scheme if r contains cycles then there is no guarantee that the transitive closure a of r rr is an alignment in general both conditions a 1 and a 2 will be violated so called accepted in compositionality on 9999 99 99 click on the title to verify 12 janember 9999 issn 2631 4444 transitive alignment approaches deliberately accept this at an intermediate stage various heuristics can be used to remove superfluous edges from the graph x a that is they construct a subgraph x a a a that again satisfies all conditions of a valid alignment 7 discussion an interesting idea that follows quite naturally from the discussion above is a general approach towards graph comparison for sets of graphs it seems natural to generalize the idea of progressive alignments in the following manner 1 given two graphs g 1 and g 2 and a common induced subgraph h strictly speaking together with an embedding of h into g 1 and g 2 the graph defined by identifing the copies of h in g 1 and g 2 can be thought of as pairwise alignment if g 1 and g 2 have vertex labels i v gi ai i 1 2 for some alphabets ai on labels g 1 h g 2 with label pairs 1 x 2 x for x v h 1 x for x v g 1 h and 2 for x v g 2 h naturally an optimization criterion such as maximal common induced subgraph will be used in practice since g 1 h g 2 is again a labeled graph the procedure can be repeated e g along a line of guidetrees this gives raise to a natural notion of a multiple alignment of graphs ga with vertex sets v ga and edge sets e ga let x v ga and a be a set of undirected edges on x and let c x a be the set of connected components of the graph x a then x a e is a multiple alignment of the graph ga where e denotes the set of edges on c x a g 1 q c x a is complete subgraph of x a g 2 if a i q and a j q then i j g 3 if a i p a j q for some p q c x a and a i a j e ga then p q e g 5 if p q e a i p and a j q then a i a j e the graph c x a e can be constructed as the quotient graph x a ae ga c x a obtained by adding in all the edges of ga and collapsing all columns connected compo nents of x a to a single vertex a plausible generalization of a 4 might be to require g 4 if p q e then there is a row a with a i p a j q and a i a j e ga i e g 3 completely determines the edges between alignment columns in this setting g 4 does not impose additional conditions on the columns however if both the input graphs ga and the alignment graph c x a e are restricted to particular graph classes such constraints appear the graphs of partially ordered sets i e the transitive acyclic digraphs discussed at length in the previous sections of course serve as a non trivial example it is important to note the graph alignment in the sense used here namely requiring a matching between vertices and notion of structural congruence between the alignment and its consitutent graphs are more restrictive than some concepts of graph alignments discussed in the literature in particular we make a sharp distinction here between graph alignments and various approaches of comparison by means of graph editing see e g 15 for a recent review the example of graph alignments and oriented tree alignments suggests to consider an even broader class of structures given a finite collection of sets xa each endowed with a set of relational structures or more general set systems we may ask for collections of accepted in compositionality on 9999 99 99 click on the title to verify 13 janember 9999 issn 2631 4444 partial maps between any pair of them that satisfy g 1 and g 2 i e define a partition on axa such that each class contains at most one element of each xa and the relation or set system structure is preserved in a sense similar to conditions g 3 and g 5 above such constructions are of practical interest e g for alignments of oriented trees or forests 4 23 27 where two distinct partial orders are defined one capturing the order implied by parent child relationship and another one representing the relative order of siblings alignments of ordered trees preserve both partial orders since the alignment is defined as an ordered tree on the columns such that each ordered input tree with vertices xa is obtained as a restriction to exactly the columns in which row a does not have a gap entry intuitively this seems to require that 1 a super object g exists for a pair of objects g 1 and g 2 such that g 1 and g 2 can be obtained as projections and 2 an intersection of the embeddings of g 1 and g 2 into g defines an induced sub object h common to g 1 and g 2 is well defined while the super object corresponds to the alignments the sub object takes on the role of matches in the alignment a similar notion of alignment is used in computational biology for rna structures where base pairs need to be preserved in addition the total order of the input sequences 41 here however only consistency similar in flavor to a 4 is enforced suggesting that it may be of interest to relax the requirement of induced sub objects the recursive formulation of the poset alignments is an extension of the well known needleman wunsch alignment algorithm beyond many implementations of the needleman wunsch algorithm the implementation based on adpfusion algebraic dynamic program ming with compile time fusion of grammar and algebra 24 is designed in a way to be extendable to different scoring functions problem descriptions and data structures 25 future work thus will include the adaptation of the adpfusion framework written in a functional language haskell to the data structure of posets earlier adaptations of the needleman wunsch algorithm to trees forests and sets already exist 4 26 it may also be possible to implement the poset alignment algorithm for the a 5 notion of alignments in a way similar to the graph alignment algorithm above i e starting from a maximal induced common subgraph that is then extended depending on the structure of the posets this might be more efficient than the recursive dp algorithm where additional information has to be stored and updated in each step finding maximal induced common subgraphs is well known to be a np complete prob lem nevertheless dp algorithms have been devised for restricted settings such as planar graphs 18 these proved practical for moderate size problems even though their resource requirements still scale exponentially for general graphs there exist algorithms to detect common subgraphs 1 however as the problem is np complete the problem can only be solved for small instances of the input structures in a reasonable amount of time for small graphs such as representations of small chemical molecules the dp algorithm might be able to solve the maximal common subgraph problem as described in 1 here the dp algorithm is based on the analogous version for trees where the vertex degree has to be bounded in order to find a solution in a reasonable time frame the algorithm divides the input structures in overlapping bicon nected components and tries to find the best match between both input graphs preserving the order of the biconnected components of the original graph finally it seems natural to consider multiple alignments at a more abstract level in order to properly define them it seems sufficient that induced sub objects can be used to glue together two and recursively more objects in such a way that the resulting super object projects down to the given inputs it is natural to ask how such structures can be characterized in the language of category theory is there an interesting class of categories accepted in compositionality on 9999 99 99 click on the title to verify 14 janember 9999 issn 2631 4444 that admit well defined alignments objects and do the resulting alignments themselves from categories with useful properties acknowledgements this work was supported in part by the german academic exchange service daad proj no 57390771 references 1 tatsuya akutsu a polynomial time algorithm for finding a largest common subgraph of almost trees of bounded degree ieice transactions on fundamentals of electronics communications and computer sciences 76 9 1488 1493 1993 2 stephen f altschul thomas l madden alejandro a sch ffer jinghui zhang zheng zhang webb miller and david j lipman gapped blast and psi blast a new generation of protein database search programs nucleic acids res 25 3389 3402 1997 doi 10 1093 nar 25 17 3389 3 shakuntala baichoo and christos a ouzounis computational complexity of algo rithms for sequence comparison short read assembly and genome alignment biosys tems 156 157 72 85 2017 doi 10 1016 j biosystems 2017 03 003 4 sarah j berkemer christian h ner zu siederdissen and peter f stadler algebraic dynamic programming on trees algorithms 10 135 2017 doi 10 3390 a 10040135 5 tanmoy bhattacharya damian blasi william croft michael cysouw daniel hr uschka ian maddieson lydia m ller nancy retzlaff eric smith peter f stadler george starostin and hyejin youn studying language evolution in the age of big data j language evol 3 94 129 2018 doi 10 1093 jole lzy 004 6 paola bonizzoni and gianluca della vedova the complexity of multiple sequence alignment with sp score that is a metric theor comp sci 259 63 79 2001 doi 10 1016 s 0304 3975 99 00324 2 7 h bunke on a relation between graph edit distance and maximum common subgraph pattern recognition letters 18 689 694 1997 doi 10 1016 s 0167 8655 97 00060 3 8 humberto carrillo and david lipman the multiple sequence alignment problem in biology siam j appl math 48 1073 1082 1988 doi 10 1137 0148063 9 michael cysouw and hagen jung cognate identification and alignment using practi cal orthographies in proceedings of ninth meeting of the acl special interest group in computational morphology and phonology pages 109 116 association for com putational linguistics 2007 url https www aclweb org anthology w w 07 w 07 1314 pdf 10 chuong b do mahathi sp mahabhashyam michael brudno and serafim batzoglou probcons probabilistic consistency based multiple sequence alignment genome res 15 330 340 2005 doi 10 1101 gr 2821705 11 richard durbin sean r eddy anders krogh and graeme mitchison biological sequence analysis probabilistic models of proteins and nucleic acids cambridge uni versity press cambridge uk 1998 12 r c edgar and s batzoglou multiple sequence alignment curr opin struct biol 16 368 373 2006 doi 10 1016 j sbi 2006 04 004 13 robert c edgar muscle multiple sequence alignment with high accuracy and high throughput nucleic acids res 32 1792 1797 2004 doi 10 1093 nar gkh 340 accepted in compositionality on 9999 99 99 click on the title to verify 15 https doi org 10 1093 nar 25 17 3389 https doi org 10 1016 j biosystems 2017 03 003 https doi org 10 3390 a 10040135 https doi org 10 1093 jole lzy 004 https doi org 10 1016 s 0304 3975 99 00324 2 https doi org 10 1016 s 0304 3975 99 00324 2 https doi org 10 1016 s 0167 8655 97 00060 3 https doi org 10 1137 0148063 https www aclweb org anthology w w 07 w 07 1314 pdf https www aclweb org anthology w w 07 w 07 1314 pdf https doi org 10 1101 gr 2821705 https doi org 10 1016 j sbi 2006 04 004 https doi org 10 1093 nar gkh 340 janember 9999 issn 2631 4444 14 isaac elias settling the intractability of multiple alignment j comp biol 13 1323 1339 2006 doi 10 1089 cmb 2006 13 1323 15 frank emmert streib matthias dehmer and yongtang shi fifty years of graph matching network alignment and network comparison information sci 346 347 180 197 2016 doi 10 1016 j ins 2016 01 074 16 ronald fagin ravi kumar and d sivakumar comparing top k lists siam j discr math 17 134 160 2003 doi 10 1137 s 0895480102412856 17 da fei feng and russell f doolittle progressive sequence alignment as a pre requisite to correct phylogenetic trees j mol evol 25 351 360 1987 doi 10 1007 bf 02603120 18 fedor v fomin ioan todinca and yngve villanger exact algorithm for the max imum induced planar subgraph problem in camil demetrescu and magn s m halld rsson editors proceedings of the 19 th european conference on algorithms volume 6942 of lecture notes comp sci pages 287 298 berlin heidelberg 2011 springer verlag 19 o gotoh an improved algorithm for matching biological sequences j mol biol 162 705 708 1982 doi 10 1016 0022 2836 82 90398 9 20 o gotoh alignment of three biological sequences with an efficient traceback proce dure j theor biol 121 327 337 1986 doi 10 1016 s 0022 5193 86 80112 6 21 manfred g grabherr pamela russell miriah meyer evan mauceli jessica alf ldi federica di palma and kerstin lindblad toh genome wide synteny through highly sensitive sequence alignment satsuma bioinformatics 26 1145 1151 2010 doi 10 1093 bioinformatics btq 102 22 catherine grasso and christopher lee combining partial order alignment and pro gressive multiple sequence alignment increases alignment speed and scalability to very large alignment problems bioinformatics 20 1546 1556 2004 doi 10 1093 bioin formatics bth 126 23 michael h chsmann bj rn voss and robert giegerich pure multiple rna secondary structure alignments a progressive profile approach ieee acm trans comp biol bioinf 1 53 62 2004 doi 10 1109 tcbb 2004 11 24 christian h ner zu siederdissen sneaking around concatmap efficient combinators for dynamic programming in proceedings of the 17 th acm sigplan international conference on functional programming icfp 12 pages 215 226 new york ny usa 2012 acm isbn 978 1 4503 1054 3 doi 10 1145 2364527 2364559 url http www bioinf uni leipzig de software gadp 25 christian h ner zu siederdissen ivo l hofacker and peter f stadler product grammars for alignment and folding ieee acm trans comp biol bioinf 12 507 519 2015 doi 10 1109 tcbb 2014 2326155 26 christian h ner zu siederdissen sonja j prohaska and peter f stadler algebraic dynamic programming over general data structures bmc bioinformatics 16 suppl 19 s 2 2015 doi 10 1186 1471 2105 16 s 19 s 2 27 tao jiang lusheng wang and kaizhong zhang alignment of trees an alternative to tree edit theor comp sci 143 137 148 1995 doi 10 1016 0304 3975 95 80029 9 28 winfried just computational complexity of multiple sequence alignment with sp score j comp biol 8 615 623 2001 doi 10 1089 106652701753307511 29 kazutaka katoh kei ichi kuma hiroyuki toh and takashi miyata mafft version 5 improvement in accuracy of multiple sequence alignment nucleic acids res 33 511 518 2005 doi 10 1093 nar gki 198 accepted in compositionality on 9999 99 99 click on the title to verify 16 https doi org 10 1089 cmb 2006 13 1323 https doi org 10 1016 j ins 2016 01 074 https doi org 10 1137 s 0895480102412856 https doi org 10 1007 bf 02603120 https doi org 10 1007 bf 02603120 https doi org 10 1016 0022 2836 82 90398 9 https doi org 10 1016 s 0022 5193 86 80112 6 https doi org 10 1093 bioinformatics btq 102 https doi org 10 1093 bioinformatics btq 102 https doi org 10 1093 bioinformatics bth 126 https doi org 10 1093 bioinformatics bth 126 https doi org 10 1109 tcbb 2004 11 https doi org 10 1145 2364527 2364559 http www bioinf uni leipzig de software gadp https doi org 10 1109 tcbb 2014 2326155 https doi org 10 1186 1471 2105 16 s 19 s 2 https doi org 10 1016 0304 3975 95 80029 9 https doi org 10 1089 106652701753307511 https doi org 10 1093 nar gki 198 janember 9999 issn 2631 4444 30 j d kececioglu the maximum weight trace problem in multiple sequence alignment in proceedings of the 4 th symposium on combinatorial pattern matching volume 684 of lecture notes comp sci pages 106 119 berlin 1993 springer 31 john kececioglu and dean starrett aligning alignments exactly in philip e bourne and dan gusfield editors proceedings of the 8 th acm conference on research in computational molecular biology recomb pages 85 96 new york ny 2004 acm doi 10 1145 974614 974626 32 a s konagurthu j whisstock and p j stuckey progressive multiple alignment using sequence triplet optimization and three residue exchange costs j bioinf and comp biol 2 719 745 2004 doi 10 1142 s 0219720004000831 33 grzegorz kondrak a new algorithm for the alignment of phonetic sequences in proceedings of naacl 2000 1 st meeting of the north american chapter of the asso ciation for computational linguistics pages 288 295 san francisco ca usa 2000 morgan kaufmann publishers inc doi 10 1 1 19 9698 url http aclweb org anthology a 00 2038 34 matthias kruspe and peter f stadler progressive multiple sequence alignments from triplets bmc bioinformatics 8 254 2007 doi 10 1186 1471 2105 8 254 35 mark a larkin gordon blackshields n p brown r chenna paul a mcgettigan hamish mcwilliam franck valentin iain m wallace andreas wilm rodrigo lopez j d thompson t j gibson and d g higgins clustal w and clustal x version 2 0 bioinformatics 23 2947 2948 2007 doi 10 1093 bioinformatics btm 404 36 christopher lee generating consensus sequences from partial order multiple sequence alignment graphs bioinformatics 19 999 1008 2003 doi 10 1093 bioinformat ics btg 109 37 christopher lee catherine grasso and mark f sharlow multiple sequence alignment using partial order graphs bioinformatics 18 452 464 2002 doi 10 1093 bioinformatics 18 3 452 38 david j lipman stephen f altschul and john d kececioglu a tool for multi ple sequence alignment proc natl acad sci usa 86 4412 4415 1989 doi 10 1073 pnas 86 12 4412 39 ketil malde and tomasz furmanek increasing sequence search sensitivity with tran sitive alignments plos one 8 e 54422 2013 doi 10 1371 journal pone 0054422 40 bodo manthey non approximability of weighted multiple sequence alignment theor comp sci 296 179 192 2003 doi 10 1007 3 540 44679 6 9 41 mathias m hl sebastian will and rolf backofen lifting prediction to alignment of rna pseudoknots j comput biol 17 429 442 2010 doi 10 1089 cmb 2009 0168 42 burkhard morgenstern dialign 2 improvement of the segment to segment ap proach to multiple sequence alignment bioinformatics 15 211 218 1999 doi 10 1093 bioinformatics 15 3 211 43 burkhard morgenstern jens stoye and andreas w m dress consistent equivalence relations a set theoretical framework for multiple sequence alignments technical report university of bielefeld fspm 1999 44 saul b needleman and christian d wunsch a general method applicable to the search for similarities in the amino acid sequence of two proteins j mol biol 48 443 453 1970 doi 10 1016 0022 2836 70 90057 4 45 c dric notredame desmond g higgins and jaap heringa t coffee a novel method for fast and accurate multiple sequence alignment journal of molecular biology 302 205 217 2000 doi 10 1006 jmbi 2000 4042 accepted in compositionality on 9999 99 99 click on the title to verify 17 https doi org 10 1145 974614 974626 https doi org 10 1142 s 0219720004000831 https doi org 10 1 1 19 9698 http aclweb org anthology a 00 2038 http aclweb org anthology a 00 2038 https doi org 10 1186 1471 2105 8 254 https doi org 10 1093 bioinformatics btm 404 https doi org 10 1093 bioinformatics btg 109 https doi org 10 1093 bioinformatics btg 109 https doi org 10 1093 bioinformatics 18 3 452 https doi org 10 1093 bioinformatics 18 3 452 https doi org 10 1073 pnas 86 12 4412 https doi org 10 1073 pnas 86 12 4412 https doi org 10 1371 journal pone 0054422 https doi org 10 1007 3 540 44679 6 9 https doi org 10 1089 cmb 2009 0168 https doi org 10 1093 bioinformatics 15 3 211 https doi org 10 1093 bioinformatics 15 3 211 https doi org 10 1016 0022 2836 70 90057 4 https doi org 10 1006 jmbi 2000 4042 janember 9999 issn 2631 4444 46 wolfgang otto peter f stadler and sonja j prohaska phylogenetic footprinting and consistent sets of local aligments in r giancarlo and g manzini editors cpm 2011 volume 6661 of lecture notes in computer science pages 118 131 heidelberg germany 2011 springer verlag doi 10 1007 978 3 642 21458 5 12 47 mikko rautiainen and tobias marschall aligning sequences to general graphs in o v me time technical report biorxiv 2017 48 nancy retzlaff and peter f stadler partially local multi way alignments math comp sci 12 207 234 2018 doi 10 1007 s 11786 018 0338 4 49 david sankoff and joseph kruskal editors time warps string edits and macro molecules the theory and practice of sequence comparison addison wesley london u k 1983 50 temple f smith and michael s waterman comparison of biosequences adv appl math 2 482 489 1981 doi 10 1016 0196 8858 81 90046 4 51 lydia steiner peter f stadler and michael cysouw a pipeline for computa tional historical linguistics language dynamics change 1 89 127 2011 doi 10 1163 221058211 x 570358 52 jens stoye vincent moulton and andreas w m dress dca an efficient implementa tion of the divide and conquer approach to simultaneous multiple sequence alignment comput appl biosci 13 625 626 1997 doi 10 1093 bioinformatics 13 6 625 53 jochen tiepmar and gerhard heyer an overview of canonical text services linguis tics literature studies 5 132 148 2017 doi 10 13189 lls 2017 050209 54 kavya vaddadi naveen sivadasan kshitij tayal and rajgopal srinivasan sequence alignment on directed graphs technical report biorxiv 2017 55 cristian a velandia huerto sarah j berkemer anne hoffmann nancy retzlaff lil iana c romero marroqu n maribel hern ndez rosales peter f stadler and clara i berm dez santana orthologs turn over and remolding of trnas in primates and fruit flies bmc genomics 17 617 2016 doi 10 1186 s 12864 016 2927 4 56 l wang and t jiang on the complexity of multiple sequence alignment j comput biol 1 337 348 1994 doi 10 1089 cmb 1994 1 337 57 h t wareham a simplified proof of the np and max snp hardness of multiple sequence tree alignment j comput biol 2 509 514 1995 doi 10 1089 cmb 1995 2 509 58 j g wolff syntax parsing and production of natural language in a framework of information compression by multiple alignment unification and search j universal comp sci 6 8 781 829 2000 doi 10 3217 jucs 006 08 0781 accepted in compositionality on 9999 99 99 click on the title to verify 18 https doi org 10 1007 978 3 642 21458 5 12 https doi org 10 1007 s 11786 018 0338 4 https doi org 10 1016 0196 8858 81 90046 4 https doi org 10 1163 221058211 x 570358 https doi org 10 1163 221058211 x 570358 https doi org 10 1093 bioinformatics 13 6 625 https doi org 10 13189 lls 2017 050209 https doi org 10 1186 s 12864 016 2927 4 https doi org 10 1089 cmb 1994 1 337 https doi org 10 1089 cmb 1995 2 509 https doi org 10 1089 cmb 1995 2 509 https doi org 10 3217 jucs 006 08 0781 1 introduction 2 alignments and partial orders 3 composition of alignments 4 blockwise decompositions 5 recursive construction 6 pairwise alignments as relations 7 discussion