ar x iv 2 10 5 03 30 7 v 2 m at h a t 1 0 m ay 2 02 1 interleaving mayer vietoris spectral sequences a lvaro torras and ulrich pennig abstract we discuss the mayer vietoris spectral sequence as an invariant in the context of persistent homology in particular we introduce the notion of acyclic carriers and acyclic equivalences between filtered regular cw complexes and study stability conditions for the associated spectral sequences we also look at the mayer vietoris blowup complex and the geometric realization finding sta bility properties under compatible noise as a result we prove a version of an approximate nerve theorem adapting work by serre we find conditions under which interleavings exist between the spectral sequences associated to two dif ferent covers 1 introduction one of the benefits of homology as a topological invariant over for example the homotopy groups is its computability via long exact sequences the classical mayer vietoris exact sequence has been used in countless examples to compute hk x from a decomposition of x into two open subsets u and v when we generalise this concept to open covers ui i i consisting of more than just two subsets the relations between the parts hk ui become more intricate and are encoded in the mayer vietoris spectral sequence these sequences first appeared in work of leray and later serre and they proved to be one of the most powerful tools in pure algebraic topology applications of spectral sequences in applied algebraic topology however are still a young subject in 19 it was proven that the persistence mayer vietoris spectral sequence can be used to compute persistent homology the starting point is a filtered simplicial complex x together with a cover by subcomplexes u then one computes phi u for all i 0 and nu where nu denotes the nerve of the cover u the mayer vietoris spectral sequence starts from these groups and the morphisms induced by inclusions and converges to phi x as pointed out in 20 the additional insight gained from the cover u can be used for example for multiscale feature detection similar information was also explored much earlier in 21 in the form of localized homology motivated by these results one might be interested in studying the spectral se quence e p q x u as an invariant in its own right in this paper we will in particular pursue the following questions given a pair x u consisting of a space x and a cover u an object closely related to the mayer vietoris spectral sequence e p q x u is the mayer vietoris blowup complex u x is u x stable in which way 2020 mathematics subject classification 55 t 18 55 n 31 key words and phrases spectral sequences mayer vietoris geometric realization acyclic carriers interleaving distance a lvaro torras research has been supported by an epsrc grant reference ep n 509449 1 number 1941653 1 http arxiv org abs 2105 03307 v 2 interleaving mayer vietoris spectral sequences 2 suppose that the data in each covering set u for nu is modified slightly if the underlying cover u is ignored then we would not expect e p q x u to be stable are there natural coherence conditions between changes in the sets u that imply stability if so what do we mean by stability of spectral sequences let u and v be covers of the same space x can we compare e p q x u and e p q x v up to interleavings to explain why the first question is important and how it is linked to spectral sequences we note that e p q x u converges to the target persistent homology ph u x this is usually denoted by e p q x u ph u x the blowup complex u x already appeared in the context of topological data analysis in 11 and 21 it is homotopy equivalent to a homotopy colimit and therefore enjoys good properties with respect to local homotopy equivalences for example if we assume that x x u is contractible for all n u then we can use 8 prop 4 g 2 to recover leray s nerve theorem that is there are homotopy equivalences x u x u n u where denotes the constant complex of spaces on u see 8 app 4 g the funda mental importance of this result in applied topology is underlined by the persistent nerve lemma presented in 3 it is worth mentioning the approximate nerve the orem 7 and the generalized nerve theorem 2 which are approximate versions of the leray theorem within the context of persistence in particular in 7 the spectral sequence e p q x u ph x is examined and it is studied how much it differs from the other spectral sequence e p q u ph n u by careful inspec tion of all pages as well as the extension problem throughout the paper we focus on the category rcw cpx of regularly filtered regular cw complexes as well as the subcategory fcw cpx of filtered regular cw complexes see subsection 2 1 instead of restricting our attention to a space x to gether with a cover u we look at regular diagrams d in rcw cpx over a simplicial complex k there is a natural replacement for the mayer vietoris blowup complex in this setting denoted by k d as explained in 8 app 4 g this object also appears in the context of semisimplicial spaces where it is called the geometric re alization 6 in fact it has an associated spectral sequence 6 sub 1 4 as we explain in sec 3 there are good reasons as to why it is worth taking this more general perspective in particular we consider the spectral sequence e 2 p q d php q kd in order to address the first two questions we introduce the notion of acyclic carriers to define acyclic equivalences using the acyclic carrier theorem we show the following let x and y be two objects inrcw cpx if there exists an acyclic equivalence f x y then ph x is interleaved with ph y see lem 4 7 and prop 4 2 for a stronger statement in fcw cpx these equivalences provide a very flexible notion that works in different contexts as the examples 4 5 and 4 6 show then we adress the first question in the following way let d and l be two diagrams over the same simplicial complex k and assume that for all k there are acyclic equivalences f d l which satisfy a compatibility condition with respect to composition in the poset category associated to k see proposition see prop 5 2 for details then there is an acyclic equivalence f k d k l this result implies stability in the targets of convergence of the spectral sequences we interleaving mayer vietoris spectral sequences 3 use this result to show a strong approximate multinerve theorem in thm 5 3 later in section 6 we introduce n interleavings which are given by spectral sequence morphisms that start at some page n together with a shift by a persistence parameter 0 assuming the same conditions as in the geometric realization case prop 5 2 we can obtain a 1 interleaving between e p q d and e p q l this result appears in theorem 6 5 and a specialized strong statement for covers of spaces in fcw cpx is given in proposition 6 4 as for the third question about the comparison of the spectral sequences as sociated to two covers u and v of a space x we rely on work of serre from the fifties in which he studied the relation between the c ech cohomology of two different covers 18 here we adapt this work in the context of cosheaves and cosheaf homology given a cosheaf f of abelian groups on x and assume that there is a refinement v u serre showed that the refinement morphism in duced on c ech homology uv h v f h u f is independent of the par ticular choice of morphism in the cochains in 18 it was also shown that uv can be factored through a construction that uses a double complex associated to both covers cp q u v f see 18 prop 4 sec 29 this construction introduces two double complex spectral sequences ie p q u v f and iie p q u v f both of which converge to h u v f h v f here one might study conditions on iie p q u v f to find when an inverse of uv exists as an application serre obtained an analogous result to the leray theorem in the context of sheaves 18 thm 1 in 29 we start our analysis of the third question in sec 7 in case v u there is a unique morphism induced by the refinement map on the second page uv e p q x v e p q x u on the other hand thm 7 10 tells us under what conditions there exists a shifted morphism e p q x u e p q x v so that uv and form an 2 interleaving between e p q x u and e p q x v finally in prop 7 12 we give a means of obtaining an 2 interleaving between e p q x u and e p q x v through the computation of local mayer vietoris spectral sequences e p q u v u for all nu since the open regions u are assumed to be small in comparison to x this gives a means of using local calculations to deduce the interleaving as corollary 7 13 we present the case when v does not need to refine u acknowledgements we would like to thank p skraba and d govc for fruitful discussions during spring 2020 that lead up to important ideas of this manuscript in particular p skraba pointed out to us the 1955 notes 18 from j p serre which have been key for the results from section 7 2 background 2 1 regular cw complexes with filtrations recall the definition of cw complex from 8 chapter 0 in contrast to the usual treatment of cw complexes but in line with the structure we are dealing with in tda we will consider the cell decomposition as part of the data of our cw complexes for a cw complex x if c is an open cell in x we will follow the notation from 5 and denote this by c x we will denote by xn the set of n dimensional cells from x and we interleaving mayer vietoris spectral sequences 4 will denote by x n the n skeleton from x recall that x has a natural filtration given by its skeleta x 0 x 1 x n and a cellular morphism f x y respects this filtration in the sense that it restricts to morphisms fm x m y m for all m 0 we will work with regular cw complexes which are cw complexes where the attaching maps are homeomorphisms given a pair of cells a xn and b xn 1 we denote by b a the degree of attaching map a b b a cellular morphism f x y will be called a regular morphism whenever the closure f a is a subcomplex of y for all cells a x for such a morphism and and a pair a xn and b y n we will denote by b f a the degree of the morphism f restricted to the open cell a and mapping into the open cell b we will write cw cpx to denote the category of finite regular cw complexes and regular morphisms denote by r the ordered category r of real numbers we will focus on functors x r cw cpx which we will call regularly filtered cw complexes and we denote their category by rcw cpx we say that an object x rcw cpx is tame whenever x is constant along a finite number of right open intervals decomposing the poset r for x rcw cpx we will write xr for the regular cw complex x r for all r r on the other hand we will write x r s to denote the morphism xr xs for all r s in r if the morphisms x r s xr xs are injections preserving the cellular structure for all r s in r then we call x a filtered cw complex denoting by fcw cpx the corresponding subcategory of rcw cpx notice that objects in fcw cpx can be seen as a pair colimx f where colimx is a regular cw complex and f colimx r is a filtration function given x rcw cpx we define the persistent homology in degree n as the functor phn x r vect given by computing cellular homol ogy phn x r h cell n xr for all r r we will always use homology with field coefficients notice that by finiteness of xr the vector space phn x r is finite di mensional for all r r if in addition x is tame phn x only changes at a finite number of points r r we call the category of functors r vect persistence modules and denote it by pmod given a 0 and x rcw cpx we will write x a for the element of rcw cpx such that x a r xr a for all r r we use to denote the shift functor rcw cpx hom rcw cpx which sends x rcw cpx to x x x where 0 also for any morphism of filtered cw complexes f a b one can check that f a b f where we use f a b similarly there are shift functors for persistence modules pmod hom pmod for 0 remark notice that the standard algorithm for the computation of persistent ho mology can not be applied to objects in rcw cpx however if x is tame and one successfully computes the coefficients for the morphisms ccell xr c cell xs for all r s in r then one can use image kernel from 19 to obtain a barcode basis for the filtered cellular complex ccell x then we compute homology of the persistence morphisms given by the differentials dn c cell n x c cell n 1 x by the use of image kernel see 19 for an explanation 2 2 acyclic carriers consider two objects and from cw cpx with their respective pairs of chains and differentials ccell and ccell let and denote the inner products on c cell and c cell where the cells form an orthonormal basis we define a relation on by setting if 6 0 and by taking the transitive closure we will denote by the partial order generated interleaving mayer vietoris spectral sequences 5 by thus will not necessarily imply dim 1 dim also notice that see the cellular boundary formula from 8 sec 2 2 definition 2 1 a carrier f is a map from the set of cells of to subcomplexes of that is semicontinuous in the sense that for any pair in f f a carrier f is called acyclic if for every f is a nonempty acyclic subcomplex of given a chain map wp c cell p c cell p r of degree r we say that it is carried by f if for all cells p p r wp 6 0 f where we followed the notation from 15 the next statement is an application of 14 thm 13 4 in proposition 4 2 we will prove a version of this statement that will apply to filtered cw complexes theorem 2 2 let f be an acyclic carrier between cw complexes and then we have that existence there is a chain map carried by f equivalence if f carries two chain maps and then f carries a chain homotopy between and given two acyclic carriers f g we write f g whenever f g for all given a pair of acyclic carriers f and h we also define the composition carrier h f where each is sent to h f f h in particular notice that if f is carried by f and g is carried by g then g f is carried by g f note however that this composition does not need to be acyclic example 2 3 consider a regular morphism f we can then define the not necessarily acyclic carrier ff induced by f as the assignement sending to f notice that by continuity of f we have that for any pair in we have that f f also f 6 since it must contain at least a point given an acyclic carrier g we will denote by g f the composition of carriers g ff for all this situation will come up very often in this text and whenever we are looking at the composition g ff we will assume that it is acyclic note that ff is acyclic if f is an embedding of the regular cw complex as a subcomplex of 2 3 regular diagrams of filtered complexes we will first recall a few gluing constructions that one can perform in algebraic topology for a brief introduction to these see 8 app 4 g they are also relevant in kozlov s approach 10 where diagrams of spaces over trisps are studied let k be a simplicial complex we may view k as a category in several ways the first construction has the 0 simplices of k as its objects and a unique morphism v 0 v 1 if and only if either v 0 v 1 or there is a chain of 1 simplices connecting the two the composition of morphisms is completely fixed by uniqueness if we apply this construction to the barycentric subdivision bd k of k we end up with another category defined as follows the objects are given by the simplices in k and there is a unique morphism if is adjacent to in the following we will interleaving mayer vietoris spectral sequences 6 mean the second construction when we refer to k as a category and we will denote the morphism by the following will be our main object of study definition 2 4 let k be a simplicial complex a contravariant functor d k cw cpx is called a regular diagram of cw complexes and its category is denoted by rdiag k a regularly filtered regular diagram of cw complexes d over k is a contravariant functor d k rcw cpx we will denote this category by rrdiag k a morphism f d l between a pair of diagrams over k consists of natural transformations f d l for all k such that f d l f for all in k on the other hand if we restrict to contravariant functors d k fcw cpx we will call d a filtered regular diagram of cw complexes denoting the corresponding category by frdiag k if for a diagram d frdiag k the maps d are inclusions respecting the cellular structures for all from k then we call d a fully filtered diagram of cw complexes we have embeddings of categories ffdiag k frdiag k rrdiag k for all simplicial complexes k example 2 5 consider a filtered cw complex x covered by filtered subcomplexes u ui i i we define xu over the nerve nu as x u j j j uj this diagram xu is part of ffdiag nu since all morphisms x u i j are actually embeddings of subcomplexes on the other hand we can define the constant diagram u as u j r if x u j r 6 or u j r otherwise for all j nu and all r r we also have that u is in ffdiag nu then there is an obvious epimorphism of diagrams xu u continuing with the same example we can also define the complex of spaces u 0 given by 0 u j 0 uj for all j nu each 0 uj is a disjoint union of points that are identified with each other as the filtration value increases notice that in this case u 0 rrdiag k altogether we have a sequence of epimorphisms xu 0 u u 2 4 geometric realization for an abstract simplicial complex k we denote by k its underlying topological space given a k simplex k we write to denote the number of vertices of we will use dim for the dimension of a simplex that is dim 1 we write by n the topological space associated to the standard n simplex given a simplex k we will use the notation dim for simplicity given a pair ink we have a corresponding inclusion as a special case of a cw complex we will denote by kn and k n the set of n cells and the n skeleton respectively definition 2 6 let d rdiag k the geometric realization kd of d is the object in cw cpx defined as kd k d where for any pair in k the relation identifies a pair of points x y x d y for each pair of points x and y d this kd has a natural filtration given by f p kd k p d for all p 0 a cell c is a face of another cell a if and only if and also c d a if the underlying simplicial complex k is clear from the context we will write d instead of kd interleaving mayer vietoris spectral sequences 7 notice that definition 2 6 also applies to diagrams d rrdiag k we define kd by setting kd r k dr for all r r notice that our gluing conditions are consistent in this case as d td y td d y for any pair from k and all t 0 and all points y d altogether we obtain k d rcw cpx given a regular morphism f d l of diagrams in rrdiag k there is an induced morphism on the geometric realization which we denote f denote by d the diagram given by d r if d r 6 else and note that there is a homotopy equivalence d r k d r where k d is the filtered simplicial complex with the same underlying vertex set as k and kdr if and only if d r 6 the projection onto the simplex coordinates gives a base projection pb d d kd example 2 7 let d frdiag k we define the multinerve of d as mnerv d 0 d this object was first introduced in 4 in the case of u 0 for a space x covered by u in 4 it was defined as a simplicial poset a notion that is equivalent to that of a complex there are epimorphisms d mnerv d d k remark let d be a diagram of cw complexes over the simplicial complex k we can extend d to a diagram d on the barycentric subdivision bd k by defining d 0 n d n on an n simplex 0 1 n in bd k a non identity morphism in bd k that has 0 1 n as its codomain must have the same flag with one of the k s left out as its domain the diagram d maps such a morphism to the identity in case k 6 n or the morphism d n 1 n in case k n it is clear from the definition of the homotopy colimit via the simplicial replacement that the geometric realization d is homotopy equivalent to hocolimd a modified version of the homotopy equivalence k bd k shows that d d hence we could have worked with homotopy colimits all throughout but we chose to work with the geometric realization since it is technically easier to handle and because in some instances it is the mayer vietoris blowup complex which has already appeared before in topological data analysis 21 proposition 2 8 let f d l be a morphism of diagrams in rdiag k if f is a homotopy equivalence for all k then f d l is a homotopy equivalence one way to see this is to view d as a homotopy colimit see last remark which is a homotopy invariant functor on diagrams also a proof of this result in the more general context of diagrams of spaces can be found in 8 prop 4 g 1 example 2 9 let x cw cpx covered by u and recall the diagram xu from example 2 5 in this case xu is the mayer vietoris blowup complex associated to the pair x u and it can be described as a subspace of the product x nu this leads to the fiber projection pf x u x and to the base projection pb x u nu as shown in 8 prop 4 g 2 pf is a homotopy equivalence interleaving mayer vietoris spectral sequences 8 xu x if each xu is contractible for all nu then pb is also a homotopy equivalence by proposition 2 8 proposition 2 8 is of fundamental importance in applied topology for example in the persistence nerve lemma from 3 an interesting direction of research would be to use this result to define compatible collapses such as in discrete morse the ory see 15 and 1 and end up with a diagram of regular cw complexes this motivates the study of spectral sequences associated to such diagrams we will see further reasons in section 3 on the other hand given the importance of propo sition 2 8 we would like to adapt it to an approximate version in the context of diagrams in rrdiag k instead of studying homotopy equivalences we will con sider equivalences induced by acyclic carriers this will be done in section 5 2 5 spectral sequences of bounded filtrations let a be a graded module with differentials dn an an 1 for all n 1 and such that am 0 for all m 0 assume that there is a filtration 0 f 1 a f 0 a f 1 a f na a of a that is preserved by the differentials d in the sense that dn f pa f pa for all p 0 we say that a is a filtered differential graded module and denote this by the triple a d f then there is a spectral sequence e 1 p q hq f pa f p 1 a hp q a for all p q 0 see 13 thm 2 6 a morphism of spectral sequences is a sequence of bigraded morphisms f r erp q e r p q that commute with the spectral sequence differentials ie dr f r dr f r for all r 0 apart from that these morphisms satisfy f r 1 h f r for all r 0 suppose that a d f is another filtered differential graded module together with its corresponding spectral sequence e r p q consider a morphism f a b that commutes with the differential f d d f and also preserves filtrations f f pa f p a for all p 0 this induces a morphism of spectral sequences erp q e r p q by 13 thm 3 5 we will denote by spsq the category of spectral sequences while we will denote by pspsq the category of functors f r spsq 3 spectral sequences for geometric realizations recall the persistent mayer vietoris spectral sequence 19 associated to a pair x u of a space with a cover e 1 p q x u n p u phq x u php q x u php q x 1 for the details about this spectral sequence in the persistent case we refer the reader to 19 there are some limitations to the applicability of this spectral sequence to vietoris rips complexes that were already pointed out in 20 if we choose a cover of a point cloud x and then deduce a cover u of the associated vietoris rips complex vr x by subcomplexes then we will only be able to recover phk vr x from phk vr x u for filtration parameters below an upper bound r determined by the overlaps of the covering sets in this section we will present an alternative regular diagram of cw complexes that avoids this upper limit problem completely see example 3 4 interleaving mayer vietoris spectral sequences 9 before we solve our problem we need to introduce some chain complexes we will come back to the case of filtrations later but for now we will focus on regular diagrams instead given a diagram d in rdiag k we will denote by d the induced morphism of cellular chain complexes ccell d c cell d the cellular chain complex ccell d associated to d is defined as follows for all m 0 we have that ccellm d is a vector space generated by cells c with dim p and c d q so that p q m on such a cell c the differential is given by c i 1 i a d i c a d i c i a 1 dim b c c b c b where dq is the differential dq cq d cq 1 d and the sum runs over the faces i of as we will see in the proof of lemma 3 1 the map is indeed a dif ferential in addition notice that the filtration of k d carries over to c cell kd by taking f pc kd c f p kd for all p 0 now consider the double complex cp q d d v dh given by cp q d kp ccellq d for all p q 0 the vertical differential is defined by the direct sum of chain differ entials dvp q 1 p kp d q where d denotes the differential from c cell d for all kp the horizontal differential is given by the c ech differential dhp q which is defined for a cell a d as i 1 id i a where d i denotes the induced chain morphism ccell d c cell d i for all faces i from of course dv dv 0 and dh dh 0 by functoriality of ccell and the fact that d d d for any three simplices on the other hand anticommutativity dv dh dh dv follows since d is a chain morphism for all from k now we consider the double complex spectral sequence from 13 section 2 4 given d in rdiag k there is a spectral sequence e 1 p q d kp hq d hp q s tot d where stot d is the total complex defined as stotn d p q ncp q d together with a differential dtot dv dh also recall that the total complex has a filtration induced by the vertical filtration on cp q d given by fmstot d p q n p m cp q d for all integers m 0 see 19 for an explanation we will now relate this total complex to the geometric realization from definition 2 6 lemma 3 1 there is an isomorphism ccell d stot d which preserves filtration that is f pccell d f pstot d for all p 0 proof first we define a chain morphism ccellm d s tot m d generated by the assignment a cell c d m with k p and c d q for integers p q m is sent to c c s tot m d here we denote by c the vector in s tot d interleaving mayer vietoris spectral sequences 10 that is zero everywhere except at the entry ccellq d on the other hand is a chain morphism since we have the equality c i 1 i a d i c a d i c a i 1 dim b c c b c b i 1 i d i c i 1 dim d c dh dv c d tot c one can see that is injective and admits an inverse 1 stotm d c cell m d that sends c to c notice that by definition sends a chain in f pccelln d to a chain in f pstotn d for all p 0 and in particular it preserves filtration remark continuing with the remark at the end of subsection 2 3 we could have considered the homotopy colimit spectral sequence e 1 p q bd k d bd k p hq d hp q hocolimd let us construct a diagram of spaces whose geometric realization is homeomorphic to k for any finite simplicial complex k we start by taking a finite partition p of the vertex set v k and denote by k u the maximal subcomplex of k with vertices in u p we will denote by p the standard simplex with vertices in p for a simplex k we define p p to be the simplex consisting of all partitioning sets u p such that u 6 in particular if u p then it determines a standard simplex u k u of dimension u 1 0 for a vertex v k we will denote by p v the partitioning set from p which contains v we define the k p join diagram j kp p fcw cpx for all p by assigning the subspace j kp k p u u u k u for all p for any pair in p the projection u k u u k u induces a regular morphism j k p j k p j k p lemma 3 2 let k be a simplicial complex together with a partition p of its vertex set v k there is a cw complex homeomorphism j kp k proof consider the continuous map f j kp k defined by mapping a point u p yuu v u xvv u p p u p u to v yp v xvv in for all k where we have values 0 yu 1 and 0 xv 1 for all u p and all v u and such that u p yu 1 and v u xv 1 for all u p on the other hand let v xvv be a point such that 0 xv 1 for all v and such that v xv 1 then we can define the inverse continuous map f 1 v xvv u p v u xv u u v xvv u p interleaving mayer vietoris spectral sequences 11 where u v xvv v xv v u xv v if v u xv 6 0 u otherwise see below if v u xv 0 then xv 0 for all v u and the u coordinate of the simplex in p is 0 which means that u is collapsed to a single point by the equivalence relation used to define j kp it is straightforward to check that f and f 1 are well defined and consistent along k example 3 3 consider a simplicial complex k depicted in the top left part of figure 1 we consider a partition of the vertex set of k into the two subsets p u v where points in u are indicated by black circles and points in v are indicated by red squares in the top right of figure 1 we depict the standard 1 simplex p together with the diagram jkp over it in particular notice that j k p u v is a subset of the product k u k v and that the morphisms jkp u v jkp v k v and j k p u v j k p u k u are both projections finally the bottom left of figure 1 shows the geometric realization jkp where each green line and each red dashed line gets squashed to a single point k u v jkp u j k p v jkp u v u v u v p jkp jkp figure 1 illustration of an example of a jkp diagram note that j kp is not a diagram of simplicial complexes but of prodsimplicial complexes as in 10 def 2 43 see figure 2 for an example of j kp where p partitions the vertex set of a 7 simplex in particular one can consider the spectral sequence e 1 p q j k p p hq j k p hp q k now let us consider a filtered simplicial complex k fcw cpx such that its vertex set v k is fixed throughout all values of r let p be a partition of v k we define the filtered regular diagram j kp frdiag p by sending r r to j kr p these diagrams inherit the shift morphisms k from k in the following way let interleaving mayer vietoris spectral sequences 12 figure 2 on the left the 7 simplex together with a partition p of its vertex set on the right the associated diagram of spaces j kp p and notice that we have restrictions s rk u kr u ks u for all u so that we have induced morphisms u s rk u j kr p j ks p for all p in turn these induce a shift morphism on jkp which respect filtrations so that we have a commutative diagram e p q j kr p j kr p kr e p q j ks p j ks p ks and thus ph j k p ph k for each simplex p one can see j kp as a filtered simplicial complex so that e 1 p q j k p p p phq j k p php q k example 3 4 consider a point cloud x a partition p and consider its vietoris rips complex vr x fcw cpx in this case we have a fixed partition of the vertex set of vr x which allows us to consider the spectral sequence e 1 p q j vr x p p phq j vr x p php q vr x this is very convenient as it avoids the main difficulties with the mayer vietoris blowup complex associated to a cover namely one recovers ph k completely without any bounds depending on the cover overlaps in addition notice that j vr x p does not blowup more than vr x the k p join diagram is related to 17 example 4 there the motivation behind the filtrations is given by a consistency radius and a filtration based on the differences between local measurements the same example appears without a filtration as one of the opening examples in 8 appendix 4 g interleaving mayer vietoris spectral sequences 13 4 acyclic carriers the following definition will encode our notion of noise definition 4 1 let x y rcw cpx an acyclic carrier f x y is a family of acyclic carriers f a xa ya for all a r such that y a b f a c f b x a b c for all cells c of xa and a b r with a b the proposition below is an adaptation of 14 thm 13 4 or 5 lem 2 4 to the context of tame filtered cw complexes proposition 4 2 let x y fcw cpx be tame and assume that there exists an acyclic carrier f x y then there exist chain morphisms f a c xa c ya carried by f a for all a r so that y a b f a f b x a b furthermore given another such sequence of morphisms g a c xa c ya there exist chain homotopy equivalences h a g a f a which are carried by f a for all a r proof let b r and assume that f a has already been defined for all values a b where we allow for b we first define f b on all cells which are in the image of x a b for any a b using the definition f b x a b y a b f a notice that the assumption that xa xb is crucial for this to work by hypotheses given a cell c im x a b its image f b c is then contained in y a b f a c f b x a b c where c xa is such that c x a b c hence f b satisfies the carrier condition next we define f b on the remaining cells in x b xb a b x a b we proceed to prove this by induction first choose a 0 cell f b v f b v for each remaining 0 cell v x b and notice that d f b v 0 f b d v where we use d for the chain complex differentials next by induction assume that for a fixed p 0 the p cells s xb have image f b s carried by f b s and such that d f b s f b d s we would like to extend f b to the p 1 cells by semicountinuity given such a cell c xb its boundary d c will be contained in f b c on the other hand notice that by linearity and the induction hypotheses d f b d c f b d d c 0 thus f b d c is a cycle in f b c by acyclicity there exists h f b c such that d h f b d c and thus we can define f b c h altogether we have defined a chain morphism f b which is carried by f b since x is tame the statement holds for all filtration values on r now assume that g b is also carried by f b for all b r following 12 sec 12 3 we define the chain complex i given by i 0 0 1 and i 1 0 1 and ik 0 for k 0 this is the cellular chain complex of the unit interval i decomposed into two 0 cells and one 1 cell a chain homotopy h b f b g b corresponds to a chain map h b c cell xb i c cell yb such that h b x 0 f b x and h b x 1 g b x for all x xb let h b c i f b c for a cell c i x i by assumption h x i y interleaving mayer vietoris spectral sequences 14 is an acyclic carrier note that ccell xb i ccell xb i replicating the first part of the proof we can now extend any map h b c cell xb i 0 c cell yb with the above properties to all cells of x i definition 4 3 let x y rcw cpx we will call an acyclic carrier i x x x carrying the standard shift x a shift carrier suppose that there are acyclic carriers f x y g y x together with shift carriers i 2 x and i 2 y we say that x and y are acyclic equiv alent whenever we have inclusions g f i 2 x and f g i 2 y the motivation for the definition of acyclic equivalences is the following lemma proposition 4 4 let x and y be two tame elements from fcw cpx which are acyclic equivalent then ph x and ph y are interleaved proof by prop 4 2 we know that there exist two chain maps f c x c y and g c y c x carried by f and g respectively by hypothesis the compositions g f and f g are carried by corresponding shift carriers i 2 x and i 2 y thus using the second part of prop 4 2 we obtain chain homotopies g f 2 c x and f g 2 c y altogether in homology these compositions are equal to the corresponding shifts and ph x and ph y are interleaved example 4 5 consider two finite metric spaces x and y let dh x y be their hausdorff distance and set 2 dh x y given a subcomplex k vr x we denote its vertex set by x k x likewise for a simplex vr x we write x x for the vertices spanning define a carrier f vr x vr y by mapping a simplex vr x a to f sup k vr y a dh x y k 2 this is clearly semicontinuous if v 0 vn are vertices in f then by definition v 0 vn is an n simplex in f therefore we have f n for some n n which is acyclic in particular f is an acyclic carrier interchanging the roles of x and y we also obtain an acyclic carrier g vr y vr x similarly we define for a simplex vr x a the shift carrier i 2 x sup k vr x a 2 dh x x k analogously one defines i 2 y since g f i 2 x and f g i 2 y prop 4 4 implies that ph vr x and ph vr y are interleaved this is similar to the proof using correspondences see 16 prop 7 8 sec 7 3 example 4 6 consider rn together with a 1 lipschitz function f rn r with constant 0 on the other hand consider the lattices zn and rzn l for a pair of vectors r l rn such that the coordinates of r satisfy 0 ri 1 for all 1 i n then we take their corresponding cubical complexes c zn and c rzn l thought as embedded in rn the function f induces a natural filtration for these cubical complexes a vertex v c zn is contained in c zn f v while a cell a c z n appears at the maximum filtration value on its vertices there is a acyclic carrier f c zn c rzn l sending each cell a c zn to the smallest subcomplex f a containing all b c rzn l such that b a 6 in an analogous way the interleaving mayer vietoris spectral sequences 15 inverse acyclic carrier can be defined and the compositions f g and g f define the shift carriers thus using proposition 4 4 one shows that ph c z n and ph c rz n l are interleaved here an important assumption of proposition 4 2 is that we are dealing with tame filtered cw complexes however what if we considered instead a pair of elements x y rcw cpx in this context we notice that given an acyclic carrier f x y it is not necessarily true that the compositions y a b f a c and f b x a b c are still acyclic for all pairs a b from r thus whenever we talk about acyclic carriers f x y in this context we will assume that f b x a b c is acyclic for all pairs a b r with a b and all cells c x a lemma 4 7 let x y rcw cpx be a pair of elements such that both are acyclic equivalent in the above sense then di ph x ph y proof for each persistence value a r we use theorem 2 2 twice to obtain a pair of chain morphisms fa c cell a x c cell a y and ga c cell a y c cell a 2 x in a similar way we obtain a pair of chain homotopies ga fa 2 ccell x a and fa ga 2 ccell y a so that we have equalities between the induced homology morphisms ga fa 2 ccell x a and fa ga 2 ccell y a for all a r now for a pair of values a b from r it is not necessarily true that y a b fa fb x a b however since y a b fa and fb x a b are both included in f b x a b c by hypotheses then by applying theorem 2 2 again there is a chain homotopy equivalence y a b fa fb x a b which implies y a b fa fb x a b and we have defined a persistence morphism f ph x ph y similarly we can also put together the ga for all a r so that we obtain a morphism g ph y ph x this leads to the claimed interleaving example 4 8 consider a point cloud x and a vietoris rips complex vr x on top of it for this example we will look at this applying an exponential transformation xr vrexp r x for all r r we let pr be a partition of x in such a way that for any partitioning set u pr for any pair of points p q u we have that d p q exp 2 for a point p x we will denote by pr p the partitioning set from pr containing p then we define a simplicial complex yr over the set pr and where we include a simplex pr p 0 pr p 1 pr pn whenever there exists a simplex p 0 p 1 pn in vrexp r x here we ignore degenerate simplices it is easy to see that in general y is not a filtered complex but rather a regularly filtered cw complex we define the acyclic carrier f r xr yr by sending a simplex p 0 p 1 pn xr to the standard simplex pr p 0 pr p 1 pr pn on the other way we start from a simplex u 0 u 1 um yr and send it to the subcomplex of xr given by the join u 0 u 1 um where by ui we mean the standard simplex with vertices on the elements from ui pr these assignements lead to a acyclic equivalence between xr and yr where the shift carriers are given by composition now by lemma 4 7 there is a interleaving between ph x and ph y interleaving mayer vietoris spectral sequences 16 remark notice that our notion of acyclicity is different from that in 2 and 7 in 7 a filtered complex k is called acyclic whenever the induced homology maps h kr h kr vanish for all r r in this case one can still trivially define acyclic carriers between and k the problem arises when defining the shift carrier ia k for some constant a 0 which does not exist in general one can however adapt the proof of proposition 4 2 so that there is a chain morphism dim kr 1 c kr c kr dim kr 1 and that this coincides up to chain homotopy with the composition through c one does this by following the same proof as in proposition 4 2 but increasing the filtration value by each time we assume that some cycle lies in an acyclic carrier thus if we have dim k supr r dim kr then one could say that there is an dim k 1 approximate chain homotopy equivalence between c and c k 5 interleaving geometric realizations next we focus on acyclic carrier equivalences between a pair of diagrams d l rrdiag k we start by taking acyclic carriers f d l for all k which have to be compatible in the following sense for any pair and any cell c d there is an inclusion l f c f d c 2 and we assume in addition that f d rd c is acyclic for all r 0 this compatibility leads to local diagrams of spaces that is given a pair of values a r and r 0 and a cell c d a we consider an object f r c rdiag it is given by the space f r c f d rd c for all faces for any sequence in k there are morphisms in f r c given by restricting morphisms from l f r c f d rd c f r c f d rd c l using condition 2 repeatedly on the cells from l d rd c we see that we have an inclusion l f l f d l thus the diagram f r c is indeed well defined and we may consider the geometric realization f r c by hypothesis each f r c is acyclic for all so that the first page of the spectral sequence e p q f r c hp q f r c is equal to e 1 p q f r c p hq f r c p f if q 0 0 otherwise where f denotes our coefficient field for homology in fact computing the homology with respect to the horizontal differentials on the first page corresponds to computing the homology of thus e 2 p q f r c is zero everywhere except at p q 0 where it is equal to f thus the spectral sequence collapses on the second page and f r c is acyclic we will use the notation f c f 0 c interleaving mayer vietoris spectral sequences 17 definition 5 1 let d and l be two diagrams in rrdiag k suppose that there are acyclic carriers f d l for all k and such that l f c f d c for all c d and in addition f d rd c is acyclic for all r 0 then we say that the set f k is a k acyclic carrier between d and l we denote this by f d l theorem 5 2 let d and l be two diagrams in rrdiag k suppose that there are k acyclic carriers f d l and g l d together with a pair of shift k acyclic carriers i 2 d d d and i 2 l l l and such that these restrict to acyclic equivalences g f i 2 d and f g i 2 l for each simplex k then there is an acyclic equivalence f d l which preserves filtrations that is there are acyclic equivalences f pf f p d f p l for all p 0 proof let c d be a cell where c is anm cell ind define an acyclic carrier f d l by sending c to the acyclic carrier f c which is a subcomplex of l let us first check semicontinuity for any pair of cells a c in d the cell a is contained in the subcomplex d c and by continuity of d we have that d a d c thus there are inclusions f d a f d c f d c for all more concisely f a f c for all as a consequence f a f c and semicontinuity holds next notice that f r d c f rd c f r c which is an acyclic carrier in order for f to be an acyclic carrier it remains to show the inclusion r l f f r d for all r 0 for this take c d and see that r l f c r l f d c rl f d c f rd d c f d rd c f rd c f r d c similarly one can define an acyclic carrier g l d sending c l to g c in addition we define respective shift acyclic carriers i 2 d d d and i 2 l l l sending respectively c d to i 2 d c and a l to i 2 l a then we have g f c g f c g f d c g l f d c g f d c i 2 d c i 2 d c interleaving mayer vietoris spectral sequences 18 where we have used the commutativity condition and equivalence of f and g consequently g f i 2 d the other inclusion f g i 2 l follows by symmetry altogether we have obtained an equivalence f d l finally notice that for all p 0 and for each cell c f p d its carrier f c is contained in f p d and so it preserves filtration the same follows for the other acyclic carriers let x be a filtered simplicial complex together with a cover u by filtered subcom plexes recall the definitions of the diagrams xu and u 0 over nu from example 2 5 consider the case when di ph x u ph u 0 for all nu this example has been of interest before see for example 7 or 2 as mentioned in the remark at the end of section 4 our notion of acyclicity is much stronger than that from 7 this is why we obtain a result closer to the persistence nerve theorem from 3 than to the approximate nerve theorem from 7 corollary 5 3 strong approximate multinerve theorem consider a diagram d in frdiag k assume that there are is a k acyclic carrier f 0 d d then there is a acyclic equivalence f mnerv d d consequently di ph mnerv d ph d proof notice that 0 d is a well defined element from rrdiag k and there is an obvious choice for the k acyclic carrier g d 0 d where we send cells to their corresponding connected component classes the compatibility condition 0 d g d g d also follows the shift 2 k carrier i 2 0 d sends points to points while the other i 2 d is defined as the composition f g which can be checked to define a 2 k acyclic carrier altogether we can use proposition 5 2 and there exists a acyclic equivalence f mnerv d d example 5 4 consider a point cloud x together with a partition p assume that the vr x p join diagram j vr x p is such that there are compatible acyclic equivalences 0 j vr x p j vr x p for all p then there is an acyclic equivalence 0 j vr x p j vr x p so that di ph mnerv j vr x p ph vr x acyclic carriers have been used in 9 and in 15 for approximating continuous morphisms by means of simplicial maps here we have used the same tools to obtain an approximate homotopy colimit theorem the acyclic carrier theorem is an instance of the more general acyclic model theorem an interesting future research direction would be to see how that general result can bring new insights into applied topology 6 interleaving spectral sequences definition 6 1 let a and b from spsq a n spectral sequence morphism f a b is a spectral sequence morphism f a b which is defined from page n definition 6 2 given two objects a and b in pspsq we say that a and b are n interleaved whenever there exist two n morphisms a b and b a such that the following diagram commutes interleaving mayer vietoris spectral sequences 19 a b a b a 2 b 2 a b a b 3 for all pages r n this interleaving defines a pseudometric in pspsq dni a b inf a and b are n interleaved proposition 6 3 suppose that a and b are n interleaved then these are m interleaved for all m n in particular we have that dmi a b dni a b for any pair of integers m n proof follows directly from the definitions we start now by considering mayer vietoris spectral sequences under some conditions which are a special case of theorem 5 2 one can obtain one page stability in fact this stability is due to morphisms directly defined on the underlying double complexes which is a very strong property proposition 6 4 let x u and y v be two tame elements in fcw cpx to gether with covers by subcomplexes both having the same finite nerve k nu nv suppose that there are k acyclic carriers f xu y v and g y v xu together with a pair of shift k acyclic carriers i 2 xu xu xu and i 2 y v y v y v and such that these restrict to acyclic equivalences g f i 2 xu and f g i 2 y v for each simplex k then there are a pair of double complex morphisms c x u c y v and c y v c x u inducing a first page interleaving between e x u and e y v proof unpacking the definitions this means we have to give chain homomorphisms r c x u r c y v r r c y v r c x u r that are natural in k and in r r since k is a poset category these can be constructed inductively as follows as in prop 4 2 we may define on all simplices k of dimension dim dim k note that r is carried by f r for all r r assume by induction that are defined and carried by f for all k with n dim dim k in such a way that for all cofaces the naturality condition x u y v holds now let k have dimension dim n 1 0 the naturality condition on the simplices fixes on the filtered subcomplex x im xu where the union is taken over all cofaces of here notice that we can assume that is well defined since the previous choices of for all cofaces are consistent due to the fact that for each cell c x there exists a unique maximal simplex nu such that c x in addition notice that by hypotheses y v f c f x u c for interleaving mayer vietoris spectral sequences 20 all a r and c xu so that our definition of in x is indeed carried by f we then proceed as in prop 4 2 to define a on all simplices in the subset xu a x a for all a r the resulting chain map a is carried by f a for all a r since xu is tame we only need finitely many steps to obtain a morphism c x u c y v that satisfies the induction hypotheses thus we obtain double complex morphisms p q cp q x u cp q y v for all p q 0 by adding up our defined local morphisms p q kp kp cq x u kp cq y v notice that p q commute both with horizontal and vertical differentials since we assumed that each is a chain morphism and these satisfy a naturality condi tion with respect to k thus this double complex morphism induces a spectral sequence morphism p q e p q x u e p q y v by doing the same construc tion we can obtain local chain morphisms c y v c x u so that by proposition 4 2 we have equalities 2 c x u and also 2 c y v for all k then we can construct a double complex morphism p q cp q y v cp q x u inducing an inverse spectral sequence morphism p q e p q y v e p q x u these are such that from the first page and form a 1 interleaving of spectral sequences notice that the proof of proposition 6 4 relies heavily on the fact that the di agrams we are considering come from a cover this allows us to define a pair of double complex morphisms that are compatible along the common indexing nerve however in theorem 5 2 we observed that under some conditions the geomet ric realizations of regularly filtered regular diagrams are stable does this stability carry over to the associated spectral sequences the next theorem shows that this is indeed the case theorem 6 5 let d and l be two diagrams in rrdiag k suppose that there are k acyclic carriers f d l and g l d together with a pair of shift k acyclic carriers i 2 d d d and i 2 l l l and such that these restrict to acyclic equivalences g f i 2 d and f g i 2 l for each simplex k then d 1 i e d k e l k proof recall from theorem 5 2 that there is a filtration preserving acyclic carrier f kd kl this implies that there are chain complex morphisms f a c d r c l a which respect filtrations in the sense that f r f pc d r f pc l r for all p 0 by lemma 3 1 this defines a morphism f r stot d r stot l r which respects filtrations altogether we deduce that f r determines a morphism of spectral sequences f r e p q d r e p q l r similarly as in lemma 4 7 the commutativity e p q l r f r f r e p q d r 4 does not need to hold for all r r however recall from theorem 5 2 that there is an inclusion r l f f r d where the superset is acyclic so that rc d a f a and f a r rc d a are both carried by the filtration preserving interleaving mayer vietoris spectral sequences 21 acyclic carrier f r d this implies that there exist chain homotopies h r cn d r cn 1 d r which respect filtrations and such that f a r rc d a rc d a f a h a h a for all a r and all r 0 recall that the zero page terms are given as quotients on successive filtration terms e 0 p q d a f pstotp q d a f p 1 stotp q d a for all a r and all integers p q 0 thus by lemma 3 1 these chain homotopies carry over to stot d a and the commutativity relation from equation 4 holds from the first page onwards similarly we can define spectral sequence morphisms g r e p q d a e p q d a for all a r which commute with the shift morphisms from the first page also by inspecting the shift carriers we can obtain equalities of 1 spectral sequence mor phisms g r f r 2 e p q d r and also f r g r 2 e p q l r for all r r and the result follows example 6 6 consider a pair of point clouds x y rn together with partitions p and q for x and y respectively also assume that there is an isomorphism p q such that dh x v y v for all v p as defined in example 4 5 there are acyclic carrier equivalences f v vr x v vr y v for all v u for any p one can define acyclic equivalences f j vr x p j vr y q by sending a cell v v j vr x p to v f v v j vr y q these are compatible and d 1 i e j vr x p p e j vr y q q 7 interleavings with respect to different covers 7 1 refinement induced interleavings in the previous sections we considered general diagrams in frdiag k for some simplicial complex k we will now focus on the situation where we have a filtered simplicial complex x together with a cover u by filtered subcomplexes which provides a diagram xu nu fcw cpx the associated spectral sequence will be denoted by e x u as done at the start of section 3 we want to measure how e x u changes depending on u and follow ideas from 18 to achieve this first we consider a refinement v u which means that for all v v there exists u u such that v u in particular one can choose a morphism u v nv nu such that v u for all nv this choice is of course not necessarily unique we would like to compare the mayer vietoris spectral sequences of both covers for this we recall the definition of the c ech chain complex outlined in the introduction of 19 which leads to the following isomorphism on the terms from the 0 page e 0 p q x u n p u ccellq u s xq f s u ccellp s u 5 here a u is the simplex of maximal dimension in nu such that a x u a u and f a u a u nu denotes the inclusion the isomorphism in 5 is given by sending a generator a n p u ccellq u to its transpose a for all cells a x and all nu interleaving mayer vietoris spectral sequences 22 returning to a refinement v u and a morphism u v nv nu there is an induced double complex morphism u vp q cp q x u cp q x v given by u vp q a u v a if dim u v p 0 otherwise for all generators a cp q x u with n p v and a x q lemma 7 1 u v is a morphism of double complexes thus it induces a morphism of spectral sequences u vp q e p q x v e p q x u dependent on the choice of u v proof let v and u denote the respective c ech differentials from c p v c cell q and c p u c cell q as we have the refinement chain morphism u v c cell nu c cell nv we also have commutativity u v v u u v this implies that u v commutes with the horizontal differential dh for commutativity with dv we consider a gen erating chain a e 0 p q x v with n p u and a x q then if dim u v p we have u v p q 1 d v a u v p q 1 1 p b a b a b 1 p b a b a u v b 1 pdcellq u v a dv u vp q a and for dim u v p commutativity follows since both terms vanish a morphism of double complexes gives rise to a morphism of the vertical filtra tions by 13 thm 3 5 this induces a morphism of spectral sequences u v since u v nu nv is not unique the induced morphism u v on the 0 page will in general not be unique either we have however the following proposition 7 2 the 2 morphism obtained by restricting u v is independent of the particular choice of refinement map u v nv nu proof we have to show that u v is independent of the particular choice of the refinement morphism first define a carrier r nv nu by the assignment 7 r nu v u the geometric realisation of the subcomplex r is homeomorphic to a standard simplex in particular contractible so r is acyclic note that u v is carried by r hence by thm 2 2 for any pair of refinement maps u v u v nv nu there exists a chain homotopy k cn nv cn 1 nu carried by r so that k v uk u v u v for all n 0 and where u v and u v are induced morphisms of chain complexes c nv c nu in particular using the same notation this translates into chain homotopies k e 0 p q x v e 0 p 1 q x u on the 0 page such that k v uk u v u v thus u v u v from the second page onward interleaving mayer vietoris spectral sequences 23 a b c d e f g h a b c d e f g h a b c d e f g h a b c d e f g h figure 3 cubical complex c at values 0 1 2 and 3 id 0 u 0 0 1 id 2 0 u 1 id id u 2 figure 4 cubical complex c with covers u 0 u 1 and u 2 and with filtration values 0 1 and 2 blue dots represent classes in e 21 0 c ui and red loops represent classes on e 20 1 c ui for i 0 1 2 example 7 3 consider a filtered cubical complex c at value 0 c is given by the vertices on r 2 at the coordinates a 0 0 b 1 0 c 2 0 d 3 0 e 0 1 f 1 1 g 2 1 h 3 1 together with all edges contained in the boundary of the rectangle adhe then at value 1 there appears the edge bf with the face abfe at value 2 the edge gc with the face fgcb and finally at value 3 the face ghdc appears this is depicted on figure 3 then consider the cover u 0 by three subcomplexes on the squares a a b f e b b c g f and c c d h g also we consider the cover u 1 given by a and c b and u 2 given by all c the induced morphisms on second page terms at different filtratioin values are either null or the identity as illustrated on figure 4 a consequence of prop 7 2 is that if we have a space x together with covers u v u then by uniqueness the morphism on the second page induced by the consecutive inclusions coincides with the identity this gives rise to the next result proposition 7 4 suppose a pair of covers u and v of x are a refinement of one another then there is a 2 spectral sequence isomorphism e 2 x u e 2 x v this corollary implies that for any cover u of x the cover u x obtained by adding the extra covering element x is such that the second page e 2 p q x u x has only the first column nonzero lemma 7 5 consider a cover u of a space x and suppose that x u then e 2 p q x u 0 for all p 0 proof this follows from the observation that the cover x consisting of a single el ement satisfies x u x using prop 7 4 we therefore obtain isomorphisms e 2 p q x u e 2 p q x x and the result follows interleaving mayer vietoris spectral sequences 24 v 1 v 2 u 1 v 1 u 1 v 1 u 2 v 2 u 2 v 1 u 1 u 2 v 1 v 2 u 1 v 1 u 1 v 1 u 2 v 2 u 2 v 1 u 1 u 2 figure 5 cp q c v u phk at filtration values 0 and 1 suppose that none of the two covers v and u refines the other one can still compare them using the common refinement v u v u v v u u which is a cover of x thus there are two refinement morphisms e 2 p q x u e 2 p q x v u e 2 p q x v u v u p q v v u p q 6 following 18 sec 28 we can now build the double complex cp q v u phk which is for each k 0 given by n p 1 v n q u phk v u n p 1 v n q 1 u phk v u n p v n q u phk v u n p v n q 1 u phk v u v 1 p 1 u v 1 p u for any pair of integers p q 0 from this double complex we can study the two associated spectral sequences ie 1 p q v u phk n p v h q 1 p u v u phk iie 1 p q v u phk n q u h p v v u phk whose common target of convergence is h n v u phk with p q n for details about the spectral sequence associated to a double complex the reader is recommended to look at 13 thm 2 15 example 7 6 consider the cubical complex c from example 7 3 set u u 1 that is u is the cover by the sets u 1 a and u 2 a b on the other hand consider v to be formed of v 1 a b and v 2 c the double complex cp q c v u phk is illustrated on figure 5 for filtration values 0 and 1 and for k 0 one can see that the refinement morphisms from 6 are actually projections consider the nerve nu v as a subset of the product of nerves nu nv we have then two projections u nu v nu and v nu v nv both of which induce chain morphisms u c nu v c nu and v c nu v c nv these interleaving mayer vietoris spectral sequences 25 induce a pair of morphisms n p u ccellk v n p u n q v ccellk v u n q v ccellk u u q k v p k for any pair of integers p q 0 the induced map vp k on ck v u satisfies vp k s s if dim 0 0 else for all n p v nu and a cell a v u k the map u acts similarly by definition u and v both commute with the c ech differentials u and v respectively let n p v and n 0 u then we have a a b a b a b b a b a b v dn dn v for all cells a v u k this implies that v commutes with dn and the same holds for u we obtain a morphism vp k n p v n 0 u ck v u n p v ck v commuting with d and v and u thinking of the 0 th column ie 0 p 0 v u phk as a chain complex with c ech differential v one has a chain morphism vp k ie 1 p 0 v u phk c p v phk e 1 p k x v for all p 0 by the same argument there is another chain morphism uq k iie 1 0 q v u phk c q u phk e 1 q k x u for all q 0 there is a very natural way of understanding how much vp k fails to be an isomorphism to do this we take for each simplex n p v the mayer vietoris spectral sequence for v covered by v u m 2 q k v u phq k v where we changed the notation from e 2 q k v v u to m 2 q k v u as it helps distinguishing this spectral sequence from ie p q then ie 1 p 0 v u phk n p v m 20 k v u here we notice that the restriction of vp k to the summand m 2 0 k v u is given by the composition m 20 k v u m 0 k v u phk v in consequence there is an induced morphism on the second page 0 th column vp k ie 2 p 0 v u phk h p v phk notice that ph 0 is a cosheaf and in this case interleaving mayer vietoris spectral sequences 26 m 20 0 v u ph 0 v for all n p v this implies that v p 0 is an isomorphism for all p 0 now we turn to the morphism v v u p k defined by the composition h p v u phk ie p 0 v u phk ie 2 p 0 v u phk h p v phk v p k and notice that v v u p k is carried by the acyclic carrier sending nv u to nv in particular if v u then by using lemma 7 5 we have ie 1 p q 0 for all q 0 and the first two arrows in the definition of v v u p k are isomorphisms similarly in this case we obtain m 2 q k 0 for all q 0 and v p k becomes an isomorphism altogether the inverse v v u p k 1 is well defined and by composition we define morphisms u v p k u v u p k v v u p k 1 here notice that u v u p k is defined in an analogous way to v v u p k but using iie 0 p v u phk instead of ie p 0 v u phk the following proposition should also follow from applying an appropriate version of the universal coefficient theorem to 18 prop 4 4 instead we will prove the dual statement of this proposition by means of acyclic carriers proposition 7 7 suppose that v u and let u v denote a refinement map the morphism u v p k e 2 p k x v e 2 p k x u coincides with the standard morphism induced by u v proof since v u the morphism v v u p k h p v u phk h p v phk is an isomorphism now consider the diagram h p v phk h p u phk h p v u phk iie 0 p v u phk iie 20 p v u phk u v p k u p k to check that it commutes we study the following triangle of acyclic carriers nv u nv nu uf r where r is defined in prop 7 2 the carrier f is given for every nv by f r since f is acyclic there exists f c nv c nv u inducing a chain morphism f c p v sk c p v u sk by the assignment s 7 f s for all simplices s sk x and all nv in fact f defines an acyclic equivalence by considering the inverse carrier p nv u nv sending to in this case the shift carrier iv nv nv is given by the assignment 7 and iv u nv u nv u is given by 7 r as v v u p k is carried by p this implies that f v v u p k 1 as morphisms h p v phk h p v u phk consequently u v p k is carried by uf r altogether we obtain the equality u v p k u v p k as morphisms h p v phk h p u phk since both are carried by r interleaving mayer vietoris spectral sequences 27 still assuming that v u we now look for conditions for the existence of an inverse v u p k e 2 p k x u e 2 p k x v of u v p k proposition 7 8 suppose that v u if m 2 p k v u 0 for all p 0 k 0 and all n q u then the maps u v induce a 2 isomorphism of spectral sequences e 2 x u e 2 x v proof by prop 7 2 and prop 7 7 we can choose a refinement map u v nv nu giving a morphism of spectral sequences u v e 2 x v e 2 x u that coincides with u v our assumption about m 2 p k implies iie 2 p q v u phk 0 for all p 0 which in turn gives ker h q v u phk iie 0 q v u phk 0 7 and coker iie 0 q v u phk iie 2 0 q v u phk 0 8 now note that uq k yields an isomorphism iie 2 0 q v u phk h q u phk this shows that u v q k is a composition of isomorphisms thus the statement follows we will now relax the conditions in prop 7 8 and use the relations of left interleaving and right interleaving of persistence modules denoted by l and r respectively to achieve this see 7 sec 4 we have to adapt 7 prop 4 14 lemma 7 9 suppose that we have persistence modules a b and c and a param eter 0 such that a r b and b l c denote by the morphism a c given by the composition a b c then there exists c a 2 such that and define a 2 interleaving a 2 c proof by hypothesis we have a sequence e 1 a b c e 2 f g which is exact in a and c and where e 1 0 and e 2 0 then let v c and notice that c v im g thus there exists a unique vector w b such that g w c v on the other hand there exists z a not necessarily unique such that f z w this defines a unique element a z a to see this suppose that another z a is such that f z w then f z z 0 and z z ker f which implies 0 a z z a z a z and then a z a z altogether we set a 1 c which is well defined recall that for v u we have that h q v phk h q v u phk for all k 0 and q 0 there is a natural way to relax 7 and 8 to the persistent case we assume that for 0 there are right and left interleavings h q v u phk r iie 0 q v u phk l iie 2 0 q v u phk 9 if we define q k h q v u phk iie 2 0 q v u phk to be the composition of the associated persistence morphisms as in lem 7 9 then there exists q k iie 2 0 q v u phk h q v u phk 2 interleaving mayer vietoris spectral sequences 28 such that q k and q k define a 2 interleaving we repeat this argument for the local mayer vietoris spectral sequences assume that for some 0 there are interleavings iie 1 0 q v u phk r n q u m k 0 v u l n q u phk u 10 let q k iie 1 0 q v u phk n q u phk u be the composition of the associated morphisms by lem 7 9 there exists q k such that q k and q k define a 2 interleaving by slight abuse of notation we will continue to denote the induced 2 interleaving between iie 2 0 q v u phk and h q u ph by q k and q k altogether we have that u v q k q k q k v v u q k 1 and in this situation there is indeed an inverse v u q k v v u q k q k q k which increases the persistence values by 2 theorem 7 10 suppose that v u and for 0 and 0 the interleavings in 9 and 10 hold then v up q e p q x u e p q x v 2 defines a 2 morphism of spectral sequences such that u vp q and v u p q is a 2 page 2 interleaving between e p q x u and e p q x v proof the only thing that remains to be proved is that v up q commutes with the spectral sequence differentials dn for all n 2 since these differentials commute with the shift morphisms 2 this follows from considering the diagram enp q x u e n p n q n 1 x u enp q x v e n p n q n 1 x v enp q x v 2 e n p n q n 1 x v 2 dn v u p q v u p n q n 1 dn u v p q 2 u v p n q n 1 2 dn in which the two trapeziums and the two triangles commute example 7 11 consider a cubical complex c as shown in fig 6 together with the covers v a b c d and u a b c d see fig 6 for the cells a b c and d in this case we have h 1 v ph 0 h 1 v u ph 0 i 0 1 i 1 1 i 0 1 iie 2 0 1 v u ph 0 and also iie 1 0 0 v u ph 1 0 i 1 1 i 1 1 dim 0 ph 1 u these interleavings are shown in fig 7 thm 7 10 implies that there is a 4 interleaving between e p q x u and e p q x v notice that in this example the nontrivial interleaved terms are in different positions of the spectral sequences interleaving mayer vietoris spectral sequences 29 a b c d figure 6 cubical complex c at values 0 1 and 1 id 0 figure 7 morphisms u v 1 0 along 0 1 and along 1 1 therefore we can improve the upper bound to 2 we will use this observation later in prop 7 12 7 2 interpolating covers and spectral sequence interleavings considerx fcw cpx together with a pair of covers w and u so that w u motivated by the interleaving constructed in thm 7 10 we take a closer look at the following finite sequence of covers interpolating between w and a cover that both refines and is refined by u let the strict r th intersections of u be the family of sets u r u nr u for all r 0 we define the r w u interpolation as the covering set wr w u r in particular note that the 0 w u interpolation has the property that w 0 u w 0 and consequently e 2 p q x u e 2 p q x w 0 in addition if u is a finite cover then we will have un for n 0 sufficiently large and consequently wn w proposition 7 12 local checks let w u be a pair of covers for x where u is finite let n 0 be such that un for every 0 r n we assume that there exist r 0 and r 0 such that for all n r u e 20 q u w r 1 u rr e 0 q u w r 1 u rl phq u and also di e 2 p q u w r 1 u 0 r for all p 0 and q 0 then we have that d 2 i e p q x w k e p q x w k 1 2 max r r therefore by using the triangle inequality we obtain d 2 i e p q x u e p q x w n k 0 2 max r r proof we need to consider the spectral sequence iie 2 p q w r 1 wr phk note that by construction of the covers wr we have that for each n ru with dim 0 the set wr is contained in one of the open sets from w r 1 by lemma 7 5 this implies that iie 1 p q w r 1 wr phk 0 for all p 0 and q 0 and k 0 moreover we have that iie 1 0 q w r 1 wr phk n q wr phk w r for all q 0 and k 0 the resulting spectral sequence is shown in fig 8 interleaving mayer vietoris spectral sequences 30 as a consequence of these observations condition 10 holds for these indices with 0 in addition iie 2 0 q w r 1 wr phk e 2 q k x w r holds for all q 2 and k 0 see fig 8 and 9 in particular there is only one possible non trivial differential for each entry in the bottom row as indicated in fig 9 note that our hypothesis di e 2 p q u w r 1 u 0 r applies to the entries in the first column with p 0 and gives left and right interleavings of the form h q w r 1 wr phk r r iie 0 q w r 1 wr phk r l iie 2 0 q w r 1 wr phk for all q 0 and k 0 hence condition 9 holds with value r iie 1 2 0 w r 1 wr phk 0 0 iie 1 1 0 w r 1 wr phk 0 0 0 iie 1 0 0 w r 1 wr phk n 1 wr phk w r n 2 wr phk w r n 3 wr phk w r d 1 figure 8 first page of iie p q w r 1 wr phk r 0 0 r 0 0 0 iie 2 0 0 w r 1 wr phk iie 2 0 1 w r 1 wr phk e 2 2 k x w r e 23 k x w r d 2 d 3 figure 9 second page of iie p q w r 1 wr phk together with higher differentials let us look now at the case q 0 here we have h 0 w r 1 wr phk iie 2 0 0 w r 1 wr phk and consequently 9 holds with value 0 next by hypothesis for all k 0 we have right and left interleavings m 20 k u w r 1 rr m 0 k u w r 1 rl phk u for all n ru thus by taking the direct sum of these interleavings we obtain iie 10 0 w r 1 wr phk r r nw r 0 m 0 k w r w r 1 rl e 1 0 k x w r and condition 10 also holds for q 0 the result now follows from thm 7 10 notice that we can slightly improve the statement of thm 7 10 here for each term in the bottom row of the spectral sequence in this particular example only one of the two conditions 9 and 10 is nontrivial and the proof of thm 7 10 carries over with 2 max r r replacing 2 r r interleaving mayer vietoris spectral sequences 31 remark notice that for reasonable cases the parameters r are bounded above by k r for some constant k 0 by a result from 7 nevertheless we would like to keep r and r separated here since we hope to compute it from m p k u w r 1 u for n ru hereby get more accurate estimates intuitively asking for r and r to be small is equivalent to asking for cycle representatives in covers from wr to be approximately contained in covering sets from wr 1 finally we would like to compare two separate covers u and v and have an estimate for the interleaving distance between the associated spectral sequences the main idea of prop 7 12 is to translate this comparison problem into a few local checks that can be run in parallel we formalize this in the following corollary corollary 7 13 stability of covers consider two pairs x u and x v where x is a space and u and v are covers let w u v and denote by wru and w r v the respective r w u and r w v interpolations for every 0 r n we assume that there exist r r 0 and r r 0 such that for all n r u and n r v e 20 q u w r 1 u rr e 0 q u w r 1 u rl phq u e 20 q v w r 1 v r r e 0 q v w r 1 v r l phq v for all r 0 and also di e 2 p q u w r 1 u 0 r di e 2 p q v w r 1 v 0 r for all p 0 and q 0 then we have that d 2 i e p q x u e p q x v r u v where r u v max n r 0 2 max r r n r 0 2 max r r proof by lemma 7 1 there are double complex morphisms given by the refinement maps c p u c cell q c p w c cell q c p v c cell q u w p q v w p q in turn these induce 2 morphisms of spectral sequences e 2 p q x u e 2 p q x w e 2 p q x v u w p q v w p q let u wp q and v w p q be the inverses of u w p q and v w p q respectively witnessing the interleavings of the two spectral sequences see thm 7 10 and prop 7 12 the result follows from considering the commutative diagram e 2 p q x u e 2 p q x w e 2 p q x v e 2 p q x u r v u e 2 p q x w r v u e 2 p q x v r v u r v u w u p q u w p q v w p q r v u r v u w v p q u w p q v w p q where all arrows are 2 morphisms of spectral sequences interleaving mayer vietoris spectral sequences 32 8 conclusion we have introduced spectral sequences associated to geometric realisations of diagrams of cw complexes and have given examples of such diagrams that are relevant in topological data analysis we expect them to have a natural use in the distributed computation of persistent homology we studied spectral sequences as an invariant in their own right in particular their stability properties to achieve this we introduced acyclic carriers and equivalences as well as suitable compatibility conditions for diagrams which lead to the stability of the spectral sequences and their targets we also adapted the tools in 18 to study stability with respect to different covers in particular given a refinement for a cover together with its induced map we have built an inverse morphism up to some shift in the persistence values then we used this result to construct interleavings between the second pages of two spectral sequences associated to two different covers on a fixed filtered complex we hope these tools motivate the further study and use of spectral sequences in applied topology references 1 u bauer persistence in discrete morse theory phd thesis niedersa chsische staats und universita tsbibliothek go ttingen 2011 2 n j cavanna methods in homology inference doctoral dissertations 2118 university of connecticut 2019 3 f chazal and s y oudot towards persistence based reconstruction in eu clidean spaces in proceedings of the twenty fourth annual symposium on com putational geometry pages 232 241 2008 4 e colin de verdie re g ginot and x goaoc helly numbers of acyclic families advances in mathematics 253 163 193 2014 5 g e cooke and r l finney homology of cell complexes based on lectures by norman e steenrod princeton university press princeton n j university of tokyo press tokyo 1967 6 j ebert and o randal williams semisimplicial spaces algebraic geometric topology 19 4 2099 2150 2019 7 d govc and p skraba an approximate nerve theorem foundations of computational mathematics 18 5 1245 1297 sep 2018 8 a hatcher algebraic topology volume 40 2002 9 t kaczynski k mischaikow and m mrozek computational homology vol ume 42 springer science business media 2004 10 d kozlov combinatorial algebraic topology volume 21 of algorithms and com putation in mathematics springer berlin 2008 11 r lewis and d morozov parallel computation of persistent homology using the blowup complex annual acm symposium on parallelism in algorithms and architectures 2015 june 323 331 2015 12 p may a concise course in algebraic topology university of chicago press 1999 13 j mccleary a user s guide to spectral sequences number 58 cambridge university press 2000 14 j r munkres elements of algebraic topology addison wesley 1984 15 v nanda discrete morse theory for filtrations phd thesis rutgers university graduate school new brunswick 2012 interleaving mayer vietoris spectral sequences 33 16 s oudot persistence theory from quiver representations to data analysis volume 209 american mathematical society 2015 17 m robinson assignments to sheaves of pseudometric spaces compositionality 2 june 2020 18 j p serre faisceaux alge briques cohe rents french annals of mathematics 61 197 278 1955 19 a torras casas distributing persistent homology via spectral sequences arxiv 1907 05228 2019 20 h r yoon and r ghrist persistence by parts multiscale feature detection via distributed persistent homology arxiv 2001 01623 2020 21 a zomorodian and g carlsson localized homology computational geome try theory and applications 41 3 126 148 2008 email address torrascasasa cardiff ac uk email address pennigu cardiff ac uk 1 introduction acknowledgements 2 background 2 1 regular cw complexes with filtrations 2 2 acyclic carriers 2 3 regular diagrams of filtered complexes 2 4 geometric realization 2 5 spectral sequences of bounded filtrations 3 spectral sequences for geometric realizations 4 acyclic carriers 5 interleaving geometric realizations 6 interleaving spectral sequences 7 interleavings with respect to different covers 7 1 refinement induced interleavings 7 2 interpolating covers and spectral sequence interleavings 8 conclusion references