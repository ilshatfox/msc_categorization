ar x iv 2 01 1 06 92 7 v 1 st at m e 1 3 n ov 2 02 0 group design in group testing for covid 19 a french case study tifaout almeftah 1 luce brotcorne 1 diego cattaruzza 2 bernard fortz 3 1 kaba keita 1 martine labbe 3 1 maxime ogier 2 and fre de ric semet 2 1 inria centre de recherche lille nord europe inocs f 59000 lille france 2 universite de lille cnrs centrale lille inria umr 9189 cristal f 59000 lille france 3 department of computer science universite libre de bruxelles 1050 brussels belgium november 16 2020 abstract group testing is a screening strategy that involves dividing a population into several disjointed groups of subjects in its simplest implementation each group is tested with a single test in the first phase while in the second phase only subjects in positive groups if any need to be tested again individually in this paper we address the problem of group testing design which aims to determine a partition into groups of a finite population in such a way that cardinality constraints on the size of each group and a constraint on the expected total number of tests are satisfied while minimizing a linear combination of the expected number of false negative and false positive classifications first we show that the properties and model introduced by aprahmian et al can be extended to the group test design problem which is then modeled as a constrained shortest path problem on a specific graph we design and implement an ad hoc algorithm to solve this problem on instances based on sante publique france data on covid 19 screening tests the results of the computational experiments are very promising keywords covid 19 group testing group design constrained shortest path dynamic program ming 1 introduction as covid 19 has considerably impacted public health some countries have privileged herd collective immunity whereas many countries have undergone national lockdowns which has significantly threatened the world economically and socially by the end of spring 2020 when the spread and mortality rate of covid 19 appeared to be under control several countries have lifted lockdowns while respecting various measures e g social distancing wearing masks to revive the economy of the nation and the education of youth the fact that the after lockdown has known an exploding number of infected cases and disease clusters is proving to be very worrying indeed a second epidemic peak may force countries to decide on a local or general containment and consequently have an impact on all economic and social sectors trying to recover it is clear that no one can be spared from the virus a significant number of patients can carry the virus without realizing it they may be asymptomatic or pre symptomatic so they naturally continue to live their normal lives and are not isolated in the meantime an increase in the number of undetected asymptomatic persons leads to an exponential increase in coronavirus spread making the threat more 1 http arxiv org abs 2011 06927 v 1 serious therefore detecting massively daily covid 19 carriers in the population is an urgent necessity to slow the uncontrollable spread of the virus the operation of screening a population of individuals to detect the infected subjects and the non infected ones can rapidly consume huge resources time effort money the need for rapid test results is very important to reduce laboratory congestion identify positive individuals isolate them and provide appropriate treatment when necessary moreover it allows to better distinguish true negatives who may feel some symptoms from other viral infections similar to those of covid 19 and allow them to continue their daily social and economic activities therefore massive tests are very important to screen the whole population however we cannot lower the classification quality as it would let false negatives in the population and favor the spread of the virus from an economic point of view a single real time polymerase chain reactor rt pcr test including the two steps of collecting individuals swab specimens and using pricey sophisticated equipment can rapidly reach an approximate cost of 74 euros for the french social security which leads to 300 millions euros per month last massive testing means more congestion in laboratories there is a crucial need to reduce as much possible the stress felt by medical crews in laboratories and the costs of testing protocols thus reducing the cost and the social impact of classifying the population into two sets appears important one strategy is to test samples of the population instead of testing each person individually consequently saving scarce resources while maintaining the classification accuracy dorfman initially introduced this method in 1943 1 as group testing gt the principle of gt in its basic implementation is to divide the population into several disjoint groups of subjects and in the first stage test each group with a single test in the second stage only subjects in positive groups if any need to be tested again individually when the risk of being infected is low especially with large scale populations gt can be a highly beneficial strategy to screen all the subjects with minimal costs in the case of a pandemic as covid 19 the subjects to test can be pooled in groups where their samples are mixed and then tested with only one test if viral rna is not detected in the mixed samples no one in the group is infected otherwise at least one subject of the group is positive in this case a second phase of testing is fundamental to test every subject s sample individually to screen the infected patients dorfman s scheme considers several theoretical assumptions as perfect tests an infinite population and the homogeneity of risk in the population that may not appear in real life indeed the sensibility and the sensitivity of the tests play a major role in the possibility of having subjects classified as false negative and false positive in reality as the probability of being infected with covid 19 cannot be the same for all subjects we have to consider a heterogeneous population where individuals have different risks which leads us to use the risk based gt approach introduced in 2 specifically our work is based on the following assumptions 1 the tests are imperfect with classification errors and can be used on an individual sample as well as on a mixture of samples 2 the population to be screened which is finite includes subjects with different known probabilities of being covid 19 positive i e the prevalence of the disease varies within the population in this paper we address the gt design problem gtdp the gtdp consists of determining a partition into groups of a finite population such that the cardinality of each group does not exceed a maximum value and that a testing budget constraint i e representing the required number of tests to screen the population is satisfied while minimizing a linear combination of the expected number of false negative and false positive classifications the constraint on maximum group size plays a key role in the context of covid 19 diagnosis as it avoids the dilution effect which leads to a decrease in test sensibility indeed the dilution of a single positive sample in a mixture of a large number of negative samples may likely make the positive sample undetectable which may eventually cause misclassifications of some subjects our main contribution concerns the design implementation and evaluation of an exact optimization algorithm to determine such a partition of a population to be tested the remainder of the paper is organized as follows section 2 presents a literature review in section 3 we describe the gt design problem and the notation used the details on the algorithms proposed to tackle the gt problem are described in section 4 computational results are reported in section 5 finally in section 6 we draw conclusions and discuss future work 2 2 literature review since the pioneering work of dorfman 1 in gt in 1943 several relevant scientific contributions were proposed to improve both the gt procedure and its application to various fields in the following we present some relevant contributions in the literature that deal with the gt design problem the well known dorfman s gt procedure is based on two stages in the first stage subjects are tested in groups if a group tests negative then all subjects in the group are classified as negative in the second stage only subjects that belonged to positive groups are re tested one by one to single out positives dorfman s gt scheme suppose that the test is perfect subjects are homogeneous and the population to be tested is infinite several contributions in the literature based on this procedure can be found see e g 3 4 5 6 7 later some contributions are proposed to extend dorfman s gt procedure hwang 4 proposes the earliest works to incorporate subject specific risk characteristics in gt design the extension to the realistic case of imperfect tests is introduced by 8 9 10 11 12 the recent work proposed by aprahamian et al 2 relaxed all the unrealistic assumptions introduced initially in dorfman s gt procedure however they did not take into account the limitation on group size in all their experiments although this limitation is relevant in some practical situations as in the case of covid 19 gt has been largely used in several areas other than health with applications considered in quality control 3 communications 13 14 pattern matching 15 16 database systems 17 traitor tracing 18 or machine learning 19 however in the field of health care the application of gt is the most widespread the relevant applications include blood screening to detect human immunodeficiency virus hiv the detection of hepatitis b virus hbv and other diseases 20 21 22 23 the screening of chemical compounds as part of the drug discovery 24 dna screening 25 26 27 recently some contributions have been proposed on the application of gt for covid 19 screening the prevalence rate of this disease being low with many asymptomatic cases the application of gt is of great interest early works in the context of covid 19 disease focused on determining the ideal group size beyond which the dilution effect causes false negatives yelin et al 28 show that one can always detect a positive case in the mixed sample of a group of 32 or even 64 subjects under certain conditions ben ami et al 29 suggest that the ideal group size should be eight subjects to ensure a reliable group test other contributions focused on the application of the gt scheme but using mainly statistical methods curturi et al 30 propose noisy adaptive gt using bayesian sequential experimental design with possible application in covid 19 context ghosh et al 31 present tapestry a single round smart pooling technique for covid 19 testing the authors claim that tapestry pooling gives confirmed results in a single round of testing by testing each sample thrice as part of three different pools shental et al 32 propose a gt scheme where they pooled 384 patient samples into 48 pools each containing 48 samples each sample was added to six different pools however the number of groups and their size are not determined by an optimization algorithm in this paper we propose a gt scheme applied to covid 19 screening using advanced techniques derived from combinatorial optimization we consider an imperfect test a finite population and hetero geneous subjects as in 2 our main contribution is the addition of a limit on group size to avoid the dilution effect 3 problem definition and notation this section relies on the work proposed by aprahamian et al 2 let s s 1 sn be the set of subjects to be tested the risk vector denoted p p 1 p 2 pn represents the probability of each individual of being infected by covid 19 we assume subjects are ordered by increasing values of this risk i e p 1 p 2 pn the gtdp consists of finding an optimal feasible partition of set s as diagnostic tests are not error free we say that a partition is optimal if it minimizes a convex combination of expected false negatives and expected false positives tests we say that a partition is feasible if it respects the cardinality constraint for each group and the budget constraint we denote by se the test sensitivity i e true positive probability and by sp the test specificity i e true negative probability with this notation we can formulate the gt design problem as follows 3 minimize e fn 1 e fp subject to ni l i 1 e t b 1 where represents the set of all possible partitions of set s represents a single partition of set s and represents the cardinality of the partition ni denotes the size of group i where i states that i is a set belonging to partition e fn is the expected number of false negative classifications e fp corresponds to the expected number of false positive classifications e t represents the expected number of tests to perform 0 1 is a weight set by the decision maker that controls the importance of false negatives versus false positives in the objective function l is the maximum group cardinality b is the test budget i e the maximal number of tests that can be performed the objective function in model 1 minimizes the weighted sum of the expected number of false negative and false positive classifications the constraints state that the size of each group cannot exceed the maximum group size and that the expected number of tests must be smaller or equal than a given testing budget 3 1 expected number of false negatives positives and tests let m 1 s we denote by sm the subject corresponding to position m in s let i m denote the indicator random variable corresponding to the true positive status of subject sm s for a partition let fnm and fpm denote the indicator random variables respectively corresponding to the false negative classification and false positive classification of subject sm similarly let n i i fni i and fpi i respectively denote the counterparts of these random variables for group i i 1 note that for a partition i and g respectively correspond to the sets of subjects to be tested individually and in groups the computation of the expected number of false negatives positives and tests is presented in sections 3 1 1 3 1 3 3 1 1 expected number of false negatives in individual testing a truly positive subject is falsely classified as negative if the test outcome is neg ative in contrast in gt a truly positive subject is falsely classified as negative if i the group test outcome is negative or ii the group test outcome is positive and the subject s subsequent indi vidual test outcome is negative then given a partition for any subject sm s with risk p m we have e fnm e fnm im 1 p im 1 e fnm im 0 p im 0 1 se pm 0 if sm i se 1 se 1 se pm 0 if sm g leading to e fnm 1 se pm if sm i 1 se 2 pm if sm g then the expected number of false negative classifications for group i is given by 4 e fni i 1 se m i pm if ni 1 1 se 2 m i pm otherwise and the expected number of false negative classifications for all subjects in set s is given by e fn 1 se m i p m 1 se 2 m g p m 2 3 1 2 expected number of false positives in individual testing a truly negative subject is falsely classified as positive if the test outcome is posi tive whereas in gt a truly negative subject is falsely classified as positive if the group test outcome is positive and the subject s subsequent individual test outcome is positive then given a partition for any individually tested subject sm i we can write e fpm e fpm im 1 p im 1 e fpm im 0 p im 0 0 1 sp 1 pm and for any subject sm g grouped in some set i such that i 1 ni 1 i e sm i we have e fpm e fpm im 1 p im 1 e fpm im 0 p im 0 0 1 sp 2 k i m 1 pk se 1 sp 1 k i m 1 pk 1 pm 1 sp se se sp 1 k i m 1 pk 1 pm 1 sp se 1 pm 1 sp se sp 1 k i 1 pk leading to e fpi i 1 sp 1 pm if sm i 1 sp se 1 pm 1 sp se sp 1 k i 1 pk if sm g then the expected number of false positive classifications for group i is given by e fpi i 1 sp m i 1 pm if ni 1 1 sp se m i 1 pm ni 1 sp se sp 1 m i 1 pm otherwise 3 and the expected number of false positive classifications for all subjects in set s is given by e fp i e fpi i 3 1 3 expected number of tests in individual testing the number of tests per subject is always one in gt the number of tests de pends on the outcome of the group test if the group test outcome is negative then only one test is performed for the entire group and if the group test outcome is positive an additional individual test is performed for each subject in the group given a partition the expected number of tests for group i i 1 is 1 if ni 1 i e individual testing and if ni 1 we can write e ti i ni k 0 e ti i n i i k p n i i k e ti i n i i 0 p n i i 0 ni k 1 e ti i n i i k p n i i k 5 sp 1 sp 1 ni p n i i 0 ni k 1 1 se se 1 ni p n i i k 1 ni se se sp 1 m i 1 pm thus e ti i 1 if ni 1 1 ni se se sp 1 m i 1 pm otherwise 4 and the expected number of tests needed for all subjects in set s is given by e t i e ti i for more details on how the expressions of the expected number of false negatives positives and tests are computed we refer the interested readers to 2 4 an exact algorithm for the gtdp before presenting the algorithm that we develop to partition the sets of individuals in groups let us introduce the definition of an ordered partition 2 a partition i i 1 is said to be an ordered partition if it follows the ordered set s s 1 sn that is 1 s 1 sn 1 2 sn 1 1 sn 1 n 2 s 1 i 1 ni 1 sn where 1 n and ni z i 1 aprahamian et al 2 showed that the following properties hold for model 1 when only the maximum budget constraint is considered 1 there exists an optimal partition that is an ordered partition of s 2 if subject sm is individually tested in an optimal partition then it is optimal to individually test all subjects having a risk higher than pm these properties remain valid when we consider the maximum group size constraints indeed the proofs of both properties are based on the same type of argument let us consider the first property suppose that there exists an optimal partition that does not follow an ordered partition of s two groups of violating the ordered partition property are identified a new partition is then constructed by interchanging subjects between the two groups to satisfy the ordered partition property all other groups of remain unchanged in the key observation is that the subgroups of subjects interchanged between the two groups have the same cardinality in the proof by aprahamian et al 2 this means that if satisfies the cardinality constraints on the groups also satisfies them therefore the rest of the proof by aprahamian et al 2 is valid the proof of the second property follows the same lines and is therefore valid when we impose the cardinality constraints on the size of the group since the properties given above still hold problem 1 reduces to solve a constrained shortest path problem 33 over the directed graph g v a defined as follows the node set v s sn 1 contains one node per subject in s and an artificial node sn 1 that represents a subject with risk 1 the arc set a si sj si sj v i j e ti i j b j i l contains arcs si sj that represent the corresponding groups i j si si 1 sj 1 that are feasible with respect to the maximum group size constraint and to the budget constraint the cost of the arc si sj a is equal to cij e fni i j 1 e fpi i j aprahamian et al 2 showed that each path from node s 1 to node sn 1 corresponds to an ordered partition of set s to solve 1 as a constrained shorted path problem we propose an algorithm derived from the exact algorithm of feillet et al 34 which is a dynamic programming based procedure based on a label correcting strategy due to the fact that the cost of the arcs of the graph g v a are all positive we do not have to impose elementarity reducing the complexity of the algorithm proposed in feillet et al 34 moreover the acyclic structure of the graph helps in reducing the computational burden to obtain the optimal partition of s 6 paths and labels each feasible path between the sink s 1 and a node si corresponds to a label l i such a label is a triplet l pred c r containing a pointer to the label of its predecessor pred with respect to the order of subjects in the list s the cost of the path c and the consumption of the resource r which corresponds to the expected number of tests we do not need to introduce an additional resource related to the size of the groups since groups that exceed the maximum size are excluded when constructing the graph let li 1 and l i 2 be two distinct paths from the sink s 1 to a node si we say that l i 1 l i 2 label li 1 lower than l i 2 if c l i 1 cl i 2 we store for every node si in the acyclic graph the list of labels i l i 1 l i 2 l i k corresponding to all the possible paths from s 1 to si with l i 1 l i 2 l i k let sj j 1 be a node let s si s i 1 j 1 be the list of predecessors of sj let i be the list of labels on every predecessor si s each label lj corresponding to a feasible path from s 1 to sj is computed as follows for all label li i l j li cl j rl j such as cl j cl i cij r l j rl i rij if r l j rij b with rij e ti i j for j 1 there is no predecessors thus 1 contains only the label nil 0 0 as the number of labels on every node can increase exponentially we only keep in memory the non dominated paths thanks to the following dominance rule dominance rule let li 1 and l i 2 be two distinct paths from the sink s 1 to a node si l i 1 dominates l i 2 if and only if l i 1 l i 2 and rl i 1 rl i 2 this dominance rule allows us to save only pareto optimal paths all along the execution of the algorithm algorithm algorithm gtcspp gt constrained shortest path problem is described in algorithm 1 it applies the label correcting algorithm by traversing nodes in topological order on the implicit acyclic graph g thus when processing a node sj all the nodes si s i j that precede it in topological order have their final labels labels of this node are therefore only computed once starting by processing node s 1 at each step of the algorithm the first unprocessed node in the topological order imposed by s is selected then all its labels are extended to each of its successors thanks to algorithm 2 extendanddominance its outgoing arcs define the set of successors of a node before inserting a label in the list of labels associated with the corresponding node we check if the label is dominated by an already present label in this case the new label is discarded if the new label is not dominated we check if it dominates already present labels and in the affirmative case we discard the dominated labels to obtain the optimal partition after computing the shortest path with resource constraint between the first node and the artificial node we browse the resulting path backward as described in algorithm 3 7 algorithm 1 gtcspp input 1 s ordered list of subjects of size n b number of available tests output partition p of the subjects s 2 function gtcspp s b m 3 add an artificial subject at the end of s with risk 1 4 1 nil 0 0 5 for j 2 n 1 do 6 j 7 i 1 8 while i j and si sj a do 9 rij e ti i j 10 cij e fn i j 1 e fp i j 11 for l i do 12 if rl rij b then 13 l l c l cij r l rij 14 j extendanddominance j l 15 end if 16 end for 17 i i 1 18 end while 19 end for 20 if n 1 6 then 21 l 1 n 1 22 i 23 while predl 6 nil do 24 i i predl 25 l predl 26 end while 27 end if 28 remove the artificial subject at the end of s 29 p recoverpartition s i 30 return p 31 end function 8 algorithm 2 extend and dominance input 1 j sorted list of size k of labels at a node j l the new label to be added dominates l 1 l 2 returns true if r l 1 rl 2 when l 1 l 2 output insert l in the right position in j if not dominated and remove dominated labels if any 2 function extendanddominance j l 3 index 0 4 if j then 5 index 0 6 else 7 i 1 8 while i k do 9 if l ij then 10 index i 11 if dominates l ij then 12 while i k do 13 if dominates l ij then 14 remove ij 15 else 16 i i 1 17 end if 18 end while 19 end if 20 break 21 else 22 if dominates ij l then 23 index 0 24 break 25 else 26 index i 27 i i 1 28 end if 29 end if 30 end while 31 end if 32 if index 6 0 then 33 insert l at index in j 34 end if 35 return j 36 end function 9 algorithm 3 recover partition input 1 s list of subjects i list of size m of labels corresponding to first elements in every group output the corresponding partition p 2 function recoverpartition s i 3 for i m 1 do 4 p p 5 for j ii ii 1 do 6 pm i pm i sj 7 end for 8 end for 9 return p 10 end function figure 1 an example of graph with 8 subjects s 9 is the artificial one s 1 s 2 s 3 s 4 s 5 s 6 s 7 s 8 s 9 figure 1 shows the graph g v a corresponding to an example of 8 subjects s s 1 s 2 s 8 let p 0 01 0 02 0 03 0 04 0 05 0 06 0 07 0 08 be the corresponding risk vector the costs cij of the arcs si sj a i j are computed as explained above let se sp 0 75 0 6 andb 6 the optimal solution computed by algorithm 1 is s 1 s 2 s 3 s 4 s 5 s 6 s 7 s 8 with an expected cost c 0 311 and an expected number of tests r 5 444 the other depicted path corresponds to the feasible partition s 1 s 2 s 3 s 4 s 5 s 6 s 7 s 8 with with an expected cost c 0 332 and an expected number of tests r 4 647 5 computational experiments in this section we evaluate the gtcspp algorithm proposed to tackle the gtdp in the case of covid 19 screening we ran our algorithm on instances generated from the data set provided by the french national health care agency sante publique france we used data related to covid 19 screening tests carried out in city laboratories these data concern all 101 french departments they cover 11 weeks from week 11 to week 21 of 2020 march 10 to may 24 this period corresponds to the peak of the first epidemic in france the data set contains the number of tests performed 404 550 the number of people tested 404 046 and the number of people tested positive 39 830 these data are classified by gender women and men and by age group five age groups table 1 and 2 report the numbers of women and men tested the number of women and men tested positive and the risk of covid 19 for each subgroup 5 1 instance generation an instance of the gtdp is composed of a set of subjects that must be tested each subject has a risk i e covid 19 prevalence rate the prevalence of a disease corresponds to the number of cases in 10 table 1 the number of women tested the number of women tested positive and the risk of covid 19 for each age group of women age group week 11 12 13 14 15 16 17 18 19 20 21 women under 15 years pos 0 1 10 16 12 4 5 2 3 12 5 tot 22 86 144 211 248 226 245 213 411 1004 1014 risk 0 1 16 6 94 7 58 4 84 1 77 2 04 0 94 0 73 1 2 0 49 women between 15 44 years pos 44 573 1856 2047 1575 859 571 257 188 148 79 tot 272 2798 8532 11958 12026 11788 11752 7951 9155 11355 8708 risk 16 18 20 48 21 75 17 12 13 1 7 29 4 86 3 23 2 05 1 3 0 91 women between 45 64 years pos 43 525 1634 1896 1565 833 477 231 139 112 47 tot 201 1841 6289 9395 10281 9938 9806 6798 7851 9582 7298 risk 21 39 28 52 25 98 20 18 15 22 8 38 4 86 3 4 1 77 1 17 0 64 women between 65 74 years pos 11 117 366 390 351 221 117 42 48 32 24 tot 37 328 1209 1753 2164 2089 2140 1440 1842 2801 2365 risk 29 73 35 67 30 27 22 25 16 22 10 58 5 47 2 92 2 61 1 14 1 01 women 75 years and over pos 19 237 782 1307 2383 1656 965 337 281 268 141 tot 71 824 2762 3917 9250 12581 12418 7928 7837 7266 4631 risk 26 76 28 76 28 31 33 37 25 76 13 16 7 77 4 25 3 59 3 69 3 04 pos number of positive women tot total number of women tested risk covid 19 prevalence rate table 2 the number of men tested the number of men tested positive and the risk of covid 19 for each age group of men age group week 11 12 13 14 15 16 17 18 19 20 21 men under 15 years pos 3 10 25 41 21 13 18 11 8 21 9 tot 24 103 171 208 204 246 268 216 387 1160 1161 risk 12 5 9 71 14 62 19 71 10 29 5 28 6 72 5 09 2 07 1 81 0 78 men between 15 44 years pos 38 291 837 804 573 362 234 140 108 80 55 tot 170 1066 3190 4655 4926 4552 4700 3543 4529 7449 5921 risk 22 35 27 3 26 24 17 27 11 63 7 95 4 98 3 95 2 38 1 07 0 93 men between 45 64 years pos 32 399 1213 1119 760 416 265 124 98 85 45 tot 119 1089 3530 4792 4846 4285 4599 3394 4200 6172 4933 risk 26 89 36 64 34 36 23 35 15 68 9 71 5 76 3 65 2 33 1 38 0 91 men between 65 74 years pos 18 200 551 477 342 205 126 43 47 22 20 tot 64 468 1501 1851 1918 1861 2030 1430 1713 2666 2259 risk 28 13 42 74 36 71 25 77 17 83 11 02 6 21 3 01 2 74 0 83 0 89 men 75 years and over pos 13 192 654 784 874 526 310 133 93 87 55 tot 54 625 1746 2282 3536 4225 4364 2960 2919 3291 2423 risk 24 07 30 72 37 46 34 36 24 72 12 45 7 1 4 49 3 19 2 64 2 27 pos number of positive men tot total number of men tested risk covid 19 prevalence rate 11 table 3 2 significance test of prevalence between different age groups of women age group week 11 12 13 14 15 16 17 18 19 20 21 w 15 vs 4 others w 15 44 vs 3 others w 45 64 vs 2 others w 65 74 vs w 75 w 15 w 15 44 w 45 64 w 65 74 w 75 women under 15 between 15 44 45 64 65 74 and 75 years and over 4 others w 15 44 w 45 64 w 65 74 w 75 3 others w 45 64 w 65 74 w 75 2 others w 65 74 w 75 green week 11 means w 15 has a prevalence of covid 19 significantly different to the ones of all other age groups for the week 11 see the first row red week 20 means w 15 has a prevalence of covid 19 that is not sig nificantly different to at least one of the others for the week 20 see the first row table 4 2 significance test of prevalence between different age groups of men age group week 11 12 13 14 15 16 17 18 19 20 21 m 15 vs 4 others m 15 44 vs 3 others m 45 64 vs 2 others m 65 74 vs m 75 m 15 m 15 44 m 45 64 m 65 74 m 75 male under 15 between 15 44 45 64 65 74 and 75 years and over 4 others m 15 44 m 45 64 m 65 74 m 75 3 others m 45 64 m 65 74 m 75 2 others m 65 74 m 75 green week 18 means m 65 74 has a prevalence of covid 19 significantly different to the one of m 75 for the week 18 see the last row red week 11 means m 15 has a prevalence of covid 19 that is not sig nificantly different to at least one of the others for the week 11 see the first row a population at a given point in time including both new and old cases the risk of each subject is determined according to his her gender age group we compute each gender age group risk weekly see table 1 and 2 as covid 19 prevalence vary along time note that the french national health care agency initially defined the partition of the data set into age groups by gender to ensure that it is meaningful to use different risks by gender and age group we need to verify whether the risks are statistically different by performing 2 tests on the data for the entire period of the epidemic results of statistical tests are reported in tables 3 4 and 5 these tables report the 2 test results on the significance of women men and women and men covid 19 prevalences columns correspond to weeks of covid 19 screening tests and rows report the comparisons between a gender age group prevalence and the other ones a green cell in the table indicates that the prevalence of the gender age group this week is significantly different from the prevalences of all other gender age groups a red cell indicates that the prevalence of the gender age group is not significantly different from at least one of the other gender age group prevalences the results in tables 3 4 and 5 show that the prevalences of the 10 gender age groups are not statistically different during the epidemic period in france therefore we group the same age group of different genders reducing the numbers of groups from 10 to 5 the partition of the number of people tested the number of people tested positive and the risk of covid 19 for each of the 5 age groups is reported in table 6 the 2 tests on the new partition of the population into 5 age groups show that from week 14 to 12 table 5 2 significance test of prevalence between different age groups of women and men age group week 11 12 13 14 15 16 17 18 19 20 21 w 15 vs 5 others w 15 44 vs 5 others w 45 64 vs 5 others w 65 74 vs 5 others w 75 vs 5 others w 15 w 15 44 w 45 64 w 65 74 w 75 female under 15 between 15 44 45 64 65 74 and 75 years and over m 15 m 15 44 m 45 64 m 65 74 m 75 male under 15 between 15 44 45 64 65 74 and 75 years and over 5 others m 15 m 15 44 m 45 64 m 65 74 m 75 green week 21 means w 75 has a a prevalence of covid 19 significantly different to the ones of all the others for the week 21 see the last row red week 11 means m 15 has prevalence of covid 19 that is not signif icantly different to at least one of the others for the week 11 see the first row table 6 the number of people tested the number of people tested positive and the risk of covid 19 for each age group people age group week 11 12 13 14 15 16 17 18 19 20 21 people under 15 years pos 3 11 35 57 33 17 23 13 11 33 14 tot 46 189 315 419 452 472 513 429 798 2164 2175 risk 6 52 5 82 11 11 13 6 7 3 3 6 4 48 3 03 1 38 1 52 0 64 people between 15 44 years pos 82 864 2693 2851 2148 1221 805 397 296 228 134 tot 442 3864 11722 16613 16952 16340 16452 11494 13684 18804 14629 risk 18 55 22 36 22 97 17 16 12 67 7 47 4 89 3 45 2 16 1 21 0 92 people between 45 64 years pos 75 924 2847 3015 2325 1249 742 355 237 197 92 tot 320 2930 9819 14187 15127 14223 14405 10192 12051 15754 12231 risk 23 44 31 54 28 99 21 25 15 37 8 78 5 15 3 48 1 97 1 25 0 75 people between 65 74 years pos 29 317 917 867 693 426 243 85 95 54 44 tot 101 796 2710 3604 4082 3950 4170 2870 3555 5467 4624 risk 28 71 39 82 33 84 24 06 16 98 10 78 5 83 2 96 2 67 0 99 0 95 people 75 years and over pos 32 429 1436 2091 3257 2182 1275 470 374 355 196 tot 125 1449 4508 6199 12786 16806 16782 10888 10756 10557 7054 risk 25 6 29 61 31 85 33 73 25 47 12 98 7 6 4 32 3 48 3 36 2 78 pos number of positive people tot total number of people tested risk covid 19 prevalence rate 13 table 7 2 significance test of prevalence between different age groups age group week 11 12 13 14 15 16 17 18 19 20 21 15 vs 4 others 15 44 vs 3 others 45 64 vs 2 others 65 74 vs 75 15 15 44 45 64 65 74 75 people under 15 between 15 44 45 64 65 74 and 75 years and over 4 others 15 44 45 64 65 74 75 3 others 45 64 65 74 75 2 others 65 74 75 green week 21 means people between 65 74 years have a prevalence of covid 19 significantly different to the ones of 75 years and over people for the week 21 see the last row red week 17 means people under 15 years have a prevalence of covid 19 that is not significantly different to at least one of the others for the week 17 see the first row week 16 all the risks of the subgroup are statistically different two by two see table 7 this table has the same format as tables 3 4 and 5 to generate an instance we considered the daily data related to covid 19 screening tests in the department of north in france we disaggregated the data to obtain individual data we assumed that the prevalences available on week w are those computed for week w 1 thus we assigned to each subject the risk of the previous week w 1 according to his her age group we obtained six instances representing one day covid 19 screening tests from week 14 to 16 they include 54 54 157 146 104 and 100 subjects tested on march 30 and 31 and april 8 9 14 and 17 respectively as these instances are associated with different weeks they present a certain diversity which allows us to evaluate the effect of the size and composition of an instance on the optimal solution the aggregated data of the six instances are presented in tables 8 to 13 for each instance we report the covid 19 prevalence rate risk the total number of people tested and the number of positive ones by age group we set the test sensitivity of the rt pcr tests se to 0 7 and specificity sp to 0 95 according to 35 these are conservative values from systematic reviews 36 is set to 0 8 to favor the minimization of expected false negatives the testing budget b or the number of available tests to be conducted should clearly be at most s 1 to need partitioning s otherwise we test all the population individually to tighten b starting from b s 1 we decrease the budget of available tests as much as we can until the algorithm fails to find a solution note that another way to have an approximate value of b is to simply compute b e t 1 n 1 where 1 n 1 s 1 s 2 sn b can be used as starting value to decrease from instead of b s 1 5 2 computational results we present the results of our experiments on real instances arising from covid 19 screening tests per formed in laboratories in the northern department of france results are computed with the procedure proposed in section 4 the procedure is coded in c and experiments are run on an intel core i 7 9850 h cpu 2 60 ghz 2 59 ghz computer with 16 gb of ram researchers have shown the accuracy of gt when the size of groups does not exceed a specific number using the standard covid 19 rt qpcr test 28 showed that a single positive subject can be detected in a pool of up to 32 persons while 29 has shown the accuracy of limiting the group sizes to only eight subjects we used both limits for the group size in our experiments the computational results on the six instances are reported in tables 14 and 15 each row in the tables is associated with one instance in the first three columns we indicate the number of subjects the minimum and the maximum covid 19 risk values the fourth column reports the minimum number of tests needed the optimal value of the weighted sum of the expected number of false negative and false 14 table 8 instance 1 54 subjects resulting from covid 19 screening tests on march 30 week 14 in city laboratories in the department of north in france the risks are those of week 13 for the department of north ages years risk number positive 15 0 0 15 44 0 238 18 1 45 64 0 339 18 5 65 74 0 370 4 2 75 0 253 14 5 total 54 13 table 9 instance 2 54 subjects resulting from covid 19 screening tests on march 31 week 14 in city laboratories in the department of north in france the risks are those of week 13 for the department of north ages years risk number positive 15 0 0 15 44 0 238 18 3 45 64 0 339 21 1 65 74 0 370 4 0 75 0 253 11 7 total 54 11 positive classifications is reported in the fifth column the sixth column reports the number of groups formed the seventh and eighth columns report the minimum and maximum numbers of subjects in a group the ninth column shows the expected gain in percentage in terms of test budget compared with the individual screening solution the last column reports the computation time in seconds when we compare the results for a group size fixed to 8 and 32 in table 14 we notice that for all instances the number of tests required found when the group size i fixed to 8 is greater or equal to that found when the group size is 32 nevertheless the group size of 8 tends to perform slightly better in terms of misclassification errors as measured by the objective function value see column objval in table 14 a smaller objective function value corresponds to a higher test precision however when the population size increases better results are obtained in terms of test budget and precision with a group size fixed to 32 for example for instance 3 with 157 subjects tested the test budget and the test precision are 103 and 12 80 respectively when the group size is 32 these values are 104 and 12 91 respectively when the group size is 8 the use of gt is always better than the current practice of testing each subject individually regardless of whether the group size is limited to 32 or 8 in our experiments on real instances we can achieve more than 34 of expected gain compared to the current practice see column gain in table 14 this expected gain depends on the size of the population and the prevalence rate of the disease we will have a much higher gain if we consider a large population with a low prevalence rate concerning the optimal solution we observe that the minimum number of tests required b the misclassification errors objval the number of groups formed g the groups lower bound minsubg and upper bound maxsubg depend on the size of the population and the subject risks in an instance for example instance 1 and 2 have the same number of subjects however the test precision is different in the two cases see table 14 in table 15 we compare the results when the group size is fixed to 8 and 32 by setting the test budgets to the same value we observe that a group size of 32 leads to better results in terms of misclassification errors with large instances see column objval in table 15 15 table 10 instance 3 157 subjects resulting from covid 19 screening tests on april 8 week 15 in city laboratories in city laboratories in the department of north in france the risks are those of week 14 for the department of north ages years risk number positive 15 0 000 2 0 15 44 0 187 76 14 45 64 0 152 44 6 65 74 0 125 13 5 75 0 369 22 7 total 157 32 table 11 instance 4 146 subjects resulting from covid 19 screening tests on april 9 week 15 in city laboratories in city laboratories in the department of north in france the risks are those of week 14 for the department of north ages years risk number positive 15 0 000 1 0 15 44 0 187 59 11 45 64 0 152 45 8 65 74 0 125 12 2 75 0 369 29 7 total 146 28 table 12 instance 5 104 subjects resulting from covid 19 screening tests on april 14 week 16 in city laboratories in city laboratories in the department of north in france the risks are those of week 15 for the department of north ages years risk number positive 15 0 000 3 1 15 44 0 157 49 9 45 64 0 199 34 9 65 74 0 176 4 0 75 0 277 14 1 total 104 20 table 13 instance 6 100 subjects resulting from covid 19 screening tests on april 17 week 16 in city laboratories in the department of north in france the risks are those of week 13 for the department of north ages years risk number positive 15 0 000 0 0 15 44 0 157 49 7 45 64 0 199 36 5 65 74 0 176 9 0 75 0 277 6 1 total 100 13 16 table 14 results over the 6 real instances with a limit of 8 vs 32 on the group size p p p p p p p pp instances nbsub minrisk maxrisk b objval g minsubg maxsubg expected gain cpu s 8 32 8 32 8 32 8 32 8 32 8 32 inst 1 54 0 238 0 370 42 40 6 29 6 44 14 8 1 1 8 32 22 22 25 93 0 00 inst 2 54 0 238 0 370 42 40 6 46 6 54 13 8 1 1 8 32 22 22 25 93 0 00 inst 3 157 0 000 0 369 104 103 12 91 12 80 38 37 1 1 8 19 33 76 34 39 0 00 inst 4 146 0 000 0 369 98 96 12 66 12 66 34 32 1 1 8 28 32 88 34 25 0 00 inst 5 104 0 000 0 277 69 68 7 88 8 08 29 23 1 4 4 14 33 65 34 62 0 00 inst 6 100 0 000 0 277 66 66 7 58 7 58 26 26 1 1 5 5 34 0 34 0 0 00 nbsub number of subjects in the instance minrisk minimum value of covid 19 risk for the instance maxrisk maximum value of covid 19 risk for the instance b the minimal number of available tests required to find a partition by the algorithm objval objective function value g number of groups in the optimal solution minsubg minimal number of subjects in a group maxsubg maximal number of subjects in a group cpu s cpu time in seconds expected gain expected gain in percentage compared to the individual screening solution table 15 results over the 6 real instances with a limit of 8 vs 32 on the group size and the same budget p p p p p p p pp instances nbsub minrisk maxrisk b objval g minsubg maxsubg expected gain cpu s 8 32 8 32 8 32 8 32 8 32 8 32 inst 1 54 0 238 0 370 42 42 6 29 6 00 14 14 1 1 8 29 22 22 22 22 0 00 inst 2 54 0 238 0 370 42 42 6 46 6 10 13 14 1 1 4 4 9 25 9 25 0 00 inst 3 157 0 000 0 369 104 104 12 91 12 62 38 40 1 1 8 16 33 76 33 76 0 00 inst 4 146 0 000 0 369 98 98 12 66 12 24 34 38 1 1 8 21 32 88 32 88 0 00 inst 5 104 0 000 0 277 69 69 7 88 7 88 29 29 1 1 4 4 33 65 33 65 0 00 inst 6 100 0 000 0 277 66 66 7 58 7 58 26 26 1 1 5 5 34 0 34 0 0 00 nbsub number of subjects in the instance minrisk minimum value of covid 19 risk for the instance maxrisk maximum value of covid 19 risk for the instance b the minimal number of available tests required to find a partition by the algorithm objval objective function value g number of groups in the optimal solution minsubg minimal number of subjects in a group maxsubg maximal number of subjects in a group cpu s cpu time in seconds expected gain expected gain in percentage compared to the individual screening solution 17 6 conclusions gt is a screening strategy that can be very efficient to test samples of a large population instead of individual screening since it reduces the required resources while maintaining the classification accuracy for a given maximum size of the groups to be identified a key question is how to build such groups which can be modeled as the group testing design problem gtdp in this paper we extended the results of aprahamian et al 2 when we impose a maximum size for the groups then the gtdp can still be modeled as a constrained shortest path problem which can be solved in polynomial time due to the acyclic property of the underlying graph computational results on instances derived from data provided by sante publique france show that the proposed algorithm is able to provide solutions that reduce the number of tests by up to 34 compared with an individual screening strategy while minimizing a convex combination of the expected numbers of false negative and false positive classifications in very short computation times the main perspective of this work is to investigate how the results could be further improved by designing a more relevant segmentation of the population the population is currently segmented ac cording to age groups set by sante publique france and the risks are calculated accordingly we might benefit from designing a more relevant segmentation depending on the risks other relevant information such as co morbidities could then be taken into account another perspective would be to consider additional constraints in the gtdp related to the technical characteristics of the clinical test and to see how the properties on which the approach is based are still preserved references 1 r dorfman the detection of defective members of large populations the annals of mathematical statistics 14 4 1943 436 440 2 h aprahamian d r bish e k bish optimal risk based group testing management science 65 9 2018 4365 4384 https doi org 10 1287 mnsc 2018 3138 3 m sobel p a groll group testing to eliminate efficiently all defectives in a binomial sample bell system technical journal 38 5 1959 1179 1252 4 f k hwang a generalized binomial group testing problem journal of the american statistical association 70 352 1975 923 926 5 b a saraniti optimal pooled testing health care management science 9 2 2006 143 149 6 j feng l liu m parlar an efficient dynamic optimization method for sequential identification of group testable items mathematics iie transactions 43 2 2010 69 83 7 t li c l chan w huang s jaggi group testing with prior statistics ieee international symposium on information theory 2014 2346 2350 8 c r blider j m tebbs pooled testing procedures for screening high volume clinical specimens in heterogeneous populations statistics in medicine 31 27 2012 3261 3268 9 m s black c r bilder j m tebbs group testing in heterogeneous populations by using halving algorithms journal of royal statistical society series c 61 2 2012 277 290 10 c s mcmahan j m tebbs c r bilder informative dorfman screening biometrics 68 1 2012 287 296 11 j m tebbs c s mcmahan c r bilder informative dorfman screening biometrics 69 4 2013 1064 1073 12 m s black c r bilder j m tebbs optimal retesting configurations for hierarchical group testing journal of royal statistical society series c 64 4 2015 693 710 13 t berger n mehravari d towsley j wolf random multiple access communication and group testing ieee transactions on communications 32 7 1984 769 779 18 14 j wolf born again group testing multiaccess communications ieee transactions on information theory 31 2 1985 185 191 15 a j macula l j popyack a group testing method for finding patterns in data discrete applied mathematics 144 1 2 2004 149 157 16 r clifford k efremenko e porat a rothschild pattern matching with don t cares and few errors journal of computer and system science 76 2 2010 115 124 17 g cormode s muthukrishnan what s hot and what s not tracking most frequent items dynam ically acm transactions on database systems tods 30 1 2005 249 278 18 p meerwald t furon group testing meets traitor tracing ieee international conference on acoustics speech and signal processing icassp 2011 4204 4207 19 y zhou u porwal c zhang h q ngo x nguyen c re v govindaraju parallel feature selection inspired by group testing in advances in neural information processing systems 2014 pp 3554 3562 20 j gastwirth w johnson screening with cost effective quality control potential applications to hiv and drug testing journal of the american statistical association 89 427 1994 972 981 21 s k bar lev o boxma w stadje f a v der duyn schouten screening with cost effective quality control potential applications to hiv and drug testing methodology and computing in applied probability 12 2010 309 322 22 c r blider j m tebbs p chen informative retesting journal of the american statistical association 105 491 2010 942 955 23 s l stramer u wend d candotti g a foster f b hollinger r y dodd j p allain w gerlich nucleic acid testing to detect hbv infection in blood donors the new england journal of medicine 364 3 2011 236 247 24 l zhu j m hughes oliver s s young statistical decoding of potent pools based on chemical structure biometrics 57 3 2001 922 930 25 a j macula probabilistic nonadaptive group testing in the presence of errors and dna library screening annals of combinatorics 3 1999 61 69 26 d du f k hwang pooling designs and nonadaptive group testing in w scientific ed important tools for dna sequencing vol 18 of applied mathematics 2006 p 248 27 c cao x sun combinatorial pooled sequencing experiment design and decoding quantitative biology 4 2016 36 46 28 i yelin n aharony e s tamar a argoetti e messer d berenbaum e shafran a ku zli n gandali o shkedi t hashimshony y mandel gutfreund m halberthal y geffen m szwarcwort cohen r kishony evaluation of covid 19 rt qpcr test in multi sample pools clin ical infection diseases 29 r ben ami a klochendler m seidel t sido o gurel gurevich m yassour e meshorer g benedek i fogel e oiknine djian a gertler z rotstein b lavi y dor d wolf m salton y drier large scale implementation of pooled rna extraction and rt pcr for sars cov 2 detection clinical microbiology and infection 26 2020 1248 1253 30 m cuturi o teboul q berthet a doucet j vert noisy adaptive group testing using bayesian sequential experimental design https arxiv org abs 2004 12508 2020 31 s ghosh a rajwade s krishna n gopalkrishnan t e schaus a chakravarthy s vara han v appu r ramakrishnan s ch m jindal v bhupathi a gupta a jain r agarwal s pathak m a rehan s consul y gupta n gupta p agarwal r goyal v sagar u ra makrishnan s krishna p yin d palakodeti m gopalkrishnan tapestry a single round smart pooling technique for covid 19 testing https doi org 10 1101 2020 04 23 20077727 2020 19 32 n shental s levy s skorniakov v wuvshet y shemer avni a porgador t hertz efficient high throughput sars cov 2 testing to detect asymptomatic carriers https doi org 10 1101 2020 04 14 20064618 2020 33 r garcia resource constrained shortest paths and extensions ph d thesis georgia institute of technology 2009 34 d feillet p dejax m gendreau c gueguen an exact algorithm for the elementary shortest path problem with resource constraints application to some vehicle routing problems networks 44 3 2004 216 229 35 j watson p f whiting j e brush interpreting a covid 19 test result bmj 369 arxiv https www bmj com content 369 bmj m 1808 full pdf doi 10 1136 bmj m 1808 url https www bmj com content 369 bmj m 1808 36 i arevalo rodriguez d buitrago garcia d simancas racines p zambrano achig r del campo a ciapponi o sued l martinez garcia a rutjes n low et al false negative results of initial rt pcr assays for covid 19 a systematic review medrxiv 20 https www bmj com content 369 bmj m 1808 http arxiv org abs https www bmj com content 369 bmj m 1808 full pdf https doi org 10 1136 bmj m 1808 https www bmj com content 369 bmj m 1808 1 introduction 2 literature review 3 problem definition and notation 3 1 expected number of false negatives positives and tests 3 1 1 expected number of false negatives 3 1 2 expected number of false positives 3 1 3 expected number of tests 4 an exact algorithm for the gtdp 5 computational experiments 5 1 instance generation 5 2 computational results 6 conclusions