polyhedral analysis of a polytope from a service center location problem with a type of decision dependent customer demand polyhedral analysis of a polytope from a service center location problem with a type of decision dependent customer demand fengqiao luoa anorthwestern university department of industrial engineering and management science evanston il 60202 abstract the polytope from a service center location problem with a special location dependent demand has been investigated in this paper the location dependent demand is defined based on a maximum attraction principle assumption along this direction the intersection polytope of the capacity constraints and demand constraints yields a novel polyhedral structure the structure is investigated in this paper via a family of valid and facet defining inequalities that can reflect the change of demand fulfillment in a neighborhood keywords valid and facet defining inequalities service center location decision dependent demand maximum attraction principle 1 introduction we investigate the polytope conv where is the set of points satisfying the following linear and mixed binary constraints x y m i 1 xij cjyj j n n j 1 xij max j n dijyj i m xij 0 yj 0 1 i m j n 1 polyhedral analysis for a service center location problem corresponding author email address fengqiaoluo 2014 u northwestern edu fengqiao luo preprint submitted to discrete applied mathematics december 13 2021 ar x iv 2 11 2 05 25 2 v 1 m at h o c 9 d ec 2 02 1 where m represents the set of indices 1 m note that conv is indeed a polytope which is shown in proposition 1 1 1 motivation and background the above linear system is motivated from a service center location prob lem with standard capacity constraints and additional decision dependent con straints more specifically we consider a problem of allocating a set of service centers facilities in a region to meet the customer demand from the region similarly to the traditional facility location problem the region consists of cus tomer sites and candidate locations for the service centers each customer site has certain demand that needs to be fulfilled by a service center from its neigh borhood especially we consider the case that the demand of each customer site is a value which depends on the location pattern of service centers suppose there are m customer sites and n candidate locations for the service centers let cj be the capacity of the service center at the location j n let di y be the demand from customer site i for a given service center location vector y in par ticular we consider a special type of dependency between the customer demand and the location vector which is simple but sensible in depicting customers behavior in certain situations we referred it as the maximum attraction prin ciple to explain this principle we assume that when there is just one service center been allocated which is opened at j n it will attract dij amount of customer demand from the site i if there are multiple service centers opened at different locations the maximum demand that can be attracted from i is equal to the maximum dij for j n that has a opened service center this principle is formally described by the following equation di y 0 if yj 0 for all j n dij if y ej for some j n maxj n dijyj for other cases 2 where ej is the n dimensional vector with the j th entry being 1 and other entries being 0 2 the maximum attraction principle matches with our intuition from practice in certain situations note that the principle has incorporated the case that customers in site i are not willing to visit any service centers that are not within a certain range from i in this case assume fi n is the subset of candidate locations that some customers from site i are willing to visit and then we can set dij 0 for every j n fi in particular fi can be a subset of candidate locations in a neighborhood of site i as customers usually will not consider visiting a service center that is beyond a certain distance from their living place for a given location vector y let fi y j fi yj 1 the maximum attraction principle further assumes that within the preferable opened service centers fi y there exists one service center j or multiple centers that is are most attractive to the customers from site i in the sense that j argmaxj fi y dij and the presence of multiple service centers in fi y including j attracts the same amount of demand from site i as the presence of just a single service center at j this assumption is also consistent with our intuition in some situations for example if all service centers are identical in scale and service quality the most attractive one to site i is likely the one that is closest to i furthermore customers who are willing to visit service centers with a longer distance are also willing to visit the one that is closest to their living place notice that the polyhedral properties of the capacity constraints m i 1 xij cjyj in 1 have been well studied in 1 however the demand attraction con straints n j 1 xij maxj n dijyj concerned in this research are novel which brings new features to the polyhedral structure when interacting with the ca pacity constraints we focus on investigating the polyhedral structure induced by the demand attraction constraints and the capacity constraints 1 2 literature review the facility location problem 2 is one of the most fundamental problems investigated in operations research in this problem a decision maker needs to decide locations of a limited number of facilities factories retail centers 3 power plants service centers etc and determine coverage of demand from different sites by the located facilities the objective is to minimize the facility setup cost and the cost of production and delivery this problem provides a basic framework to formulate related problems in resource allocation 3 supply chain management 4 and logistics 5 6 etc see 7 for a comprehensive review on this topic facility location problems with non deterministic demand have received plen tiful investigation in the framework of stochastic optimization and robust op timization in the stochastic optimization framework customer demand are independent random parameters with known probability distributions and the problem can be formulated as a two stage stochastic program in which the loca tion vector is in the first stage decision that needs to be made before realization of customer demand 8 9 in a special case when the customer demand rates and service rates of each facility are assumed to follow exponential probability distributions the problem of minimizing long term average cost can be reformu lated as a deterministic optimization problem with corresponding poisson rates to characterize the demand and service this setting has been applied to an al location problem of atms 10 the probability distribution of demand can also be used to define chance constraints to ensure a required service level under pos sible stockout and supply disruption 11 12 13 14 in the robust optimization framework for facility location problems the information of demand is partially known to the decision maker and the goal is to find a robust optimal location vector that optimizes the objective after a worst case realization of demand information 15 following this direction of research baron and milner 16 in vestigated a robust multi period facility location problem with box and ellipsoid sets of uncertainty gourtani et al 17 investigated a distributionally robust two stage facility location problem with an ambiguity set defined corresponding to the mean and covariance matrix of a random parameter for expressing the demand facility location problems with demand uncertainty have been studied with a variety of novel application background which includes but not limited to medication coverage and delivery under a large scale bio terror attack 11 4 medical equipment defibrillators location problem to reduce cardiopulmonary resuscitation cpr risk 18 humanitarian relief logistics 19 and hazardous waste transportation 20 etc in a lot of real world problems the parameters or the uncertainty of them can interplay with the decision to be made this behavior is well observed especially in a sequential multi stage decision making process in which in formation about system parameters are gradually revealed and the decisions made up until the current stage can reshape the uncertainty in future 21 the customer demand could also depend on the location of facilities or ser vice centers as revealed in 22 23 which motivates the study of the facility location problem with location dependent demand as a robustification of it basciftci et al 24 investigated a distributionally robust facility location prob lem with decision dependent ambiguity where the ambiguity set is defined using disjointed lower and upper bounds on the mean and variance of the candidate probability distributions for customer demand and these bounds are defined as linear functions of the location vector to admit a tractable milp reformulation identifying valid and facet defining inequalities is an essential topic in under standing the polyhedral structure of a mixed integer set of points 25 26 as a by product adding some of these inequalities may improve the computational performance of solving the corresponding mixed integer linear program as a result of strengthening the formulation 27 28 29 30 31 32 some standard techniques are well developed to construct the face an facet defining inequalities such as lifting and simultaneous lifting 33 34 35 36 37 38 lift and project 39 40 41 42 43 44 and fourier motzkin elimination 45 46 47 etc by applying these techniques different families of inequalities such as lifted cover inequalities 38 36 lifted flow cover inequalities 37 and disjunctive inequali ties 48 etc are constructed for corresponding basic polytopes that are often building blocks in the formulation of various mixed integer linear programming problems in practice in many mixed integer linear programming problems from the application construction of valid and facet defining inequalities usually de pends on ad hoc observations that identify sources leading to fractional solutions 5 cite references the key observation for constructing facet defining inequali ties in this paper is inspired by 49 the work in 49 has constructed and generalized a family of facet defining inequalities for the polytope of a stan dard capacitated facility location problem computational performance with the inequalities added to the linear relaxation problems have been investigated in 50 51 in the standard capacitated facility location problem considered in 49 the demand of each client site is given as a fixed constant whereas the customer demand is considered to be decision dependent in this work 2 polyhedral properties of conv we first show in the following proposition that the convex hull conv is indeed polytope proposition 1 the convex hull conv is a polytope proof let y be the subset of with a given binary vector y at value y once the variable y is fixed the right side of the inequalities m i 1 xij cj y j and n j 1 xij maxj n dij y j becomes a constant and hence y is a polytope notice that the convex hull of can be rewritten as conv conv y 0 1 n y 3 the right side of 3 is a convex hull of a finite union of polytopes and hence the result is also a polytope notice that the representation 1 of involves a nonlinear term maxj m dijyj of the decision vector y which is inconvenient for the polyhedral analysis the nonlinear term can be avoided by reformulating in a lifted space the lifted 6 reformulation of is given as follows l x y q m i 1 xij cjyj j n n j 1 xij j n dijqij i m n j 1 qij 1 i n qij yj i n j m xij 0 qij 0 yj 0 1 i m j n 4 proposition 2 the polytope is the projection of l on to the x y space i e conv proj x y conv l proof notice that both and l can be represented as the convex hull of a finite number of sub polytopes as follows conv conv y 0 1 n y conv l conv y 0 1 n l y 5 so it suffices to show that y projx l y first consider any x y q l y to show x y y it suffices to verify that n j 1 x ij maxj n dij y j holds for every i n indeed if we let ji j m y j 1 we have n j 1 x ij j n dij q ij j ji dij q ij j m ji dij q ij j ji dij q ij j m ji dij y j j ji dij q ij max j ji dij k ji q ik max j ji dij max j n dij y j 6 therefore we have shown that projx l y y second consider any x y y we need to show that there exists a q such that x y q l y we can construct a q and the as follows let ki argmaxj jidij for any i m let q iki 1 and q ij 0 for all j m ki clearly the constraints n j 1 q ij 1 and q ij y j are satisfied for each i m by the way of constructing q 7 furthermore we have j n dij q ij di ki max j ji dij max j n dij y j n j 1 x ij 7 which shows that the constraint n j 1 x ij j n dij q ij is satisfied and hence y projx l y proposition 2 has revealed a type of equivalence between and l we will hence focus on deriving valid and facet defining inequalities for l as we will see later these inequalities do not involve the variables q and hence they are also valid for to give an insight on how the valid and facet defining inequalities are con structed we consider the quantity i i j j xij for any subsets i m and j n the capacity and demand attraction constraints imply that i i j j xij j j cjyj and i i j j xij i i maxj n dijyj the upper bound of the quantity i i j j xij depends on which constraint is more restrictive figure 1 illustrates a critical situation that if any one of the service centers in j is not opened the total attracted demand is greater than the total capacity while if all service centers in j are opened the total attracted demand is less than the total capacity based on this critical situation we can derive a facet defining valid inequality conv l under some mild conditions the theoretical results on the polyhedral properties of conv l are given by theorem 2 and theorem 3 2 1 technical lemmas for proving facetness we provide a sequence of technical lemmas that will be used to prove the facet extension results given in theorem 1 lemma 1 let n be a positive integer then there exist n linearly independent vectors in any n 1 affinely independent vectors proof suppose s vk nk 0 are n 1 affinely independent vectors if span s n then there must exist n linearly independent vectors in s we now sup pose that span s n 1 specifically suppose span s m with m 8 2 2 1 4 a 1 2 2 4 b 2 2 2 4 4 c figure 1 an illustration of the competition between the capacity constraints and the demand attraction constraints in all subfigures three customer sites are represented as circles which are denoted as s 1 s 2 s 3 from top to bottom and two candidate service center locations are represented as squares which are denoted as f 1 f 2 from top to bottom the number in a customer site circle indicates the attracted demand and the number in a service center square indicates the capacity in case a only f 1 is opened which attracts 2 units of demand from s 1 and s 2 respectively and 1 unit from s 3 in this case the total attracted demand is greater than the total capacity in case b only f 2 is opened and the situation is similar to a in case c two service centers are opened which attracts 2 units of demand from all customer sites the total attracted demand is less than the total capacity n 1 then there exist m linearly independent vectors in s we assume that vk nk n m 1 are linearly independent without loss of generality it fol lows that vi span vk nk n m 1 i 0 1 n m therefore we have span vk v 0 nk 1 span v k nk n m 1 and hence dim v k v 0 nk 1 m which contradicts to that vk v 0 nk 1 are linearly independent lemma 2 let vi ki 1 be affinely independent vectors in r n and ui mi 1 be linearly independent vectors in rn if span ui mi 1 span vi k i 1 0 then vi ki 1 ui m i 1 are affinely independent vectors in r n proof consider any coefficients ai ki 2 and bi m i 1 that satisfy the following equation k i 2 ai vi v 1 m j 1 bj uj v 1 0 8 if bj 0 j m then 8 implies k i 2 ai vi v 1 0 and hence ai 0 i 9 2 k due to the affinely independence of vi ki 1 now let j j m bj 6 0 and assume j 1 then 8 becomes j j bjuj j j bjv 1 k i 2 ai vi v 1 9 by linearly independence we have j j bjuj 6 0 since span ui mi 1 span vi k i 1 0 we must have j j bjuj 0 which leads to a contradiction therefore we have proved that ai 0 i 2 k and bj 0 j m which shows that vi ki 1 ui m i 1 are affinely independent vectors lemma 3 let l m n be three non negative integers such that m max n l and n 0 let vk nk 1 v k l k 1 and uk n k 1 be three sets of vectors in r m the following properties hold a if vk nk 1 and v k l k 1 are n l linearly independent vectors then for any r 0 there exists an 0 r such that uk vk nk 1 and v k l k 1 are also n l linearly independent vectors b if vk nk 1 are n affinely independent vectors v k l k 1 are l linearly inde pendent vectors span v k k l span uk k n and span vk k n span uk k n 0 then for any r 0 there exists an 0 r such that uk vk nk 1 and v k l k 1 are n l affinely independent vectors proof a note that the set vk nk 1 v k l k 1 contains n l linearly independent vectors if and only if deta a 6 0 where a v 1 vn v 1 v l it amounts to show that there exists an 0 r such that detb b 6 0 where b u 1 v 1 un vn v 1 v l we prove it by contradiction assume that detb b 0 for all 0 r note that since detb b is a polynomial of on r this hypothesis implies that the polynomial detb b has infinite number of real roots however only zero polynomial has infinitely many real roots if we can show that detb b is not a zero polynomial we deduce a contradiction the polynomial detb x b x can be rewritten as 10 detb x b x det u 1 xv 1 u n xv n v t 1 v t l u 1 xv 1 un xvn v 1 v l deta a x 2 n f x 10 where f x is a polynomial of x with degree at most 2 n 1 therefore we have lim x detb x b x x 2 n deta a 6 0 which shows that detb x b x is not a zero polynomial b we first make the following claim claim for any r 0 there exists an 0 r such that the set uk vk nk 1 contains n affinely independent vectors proof of claim note that the vectors vk nk 1 are affinely independent if and only if 1 v k n k 1 are linearly independent since by assumption we have span vk k n span uk k n 0 it amounts to show that there exists an 0 r such that 1 u k v k n k 1 are linearly independent which is equivalent to that u k v k n k 1 are linearly independent since we have u k v k 0 u k 1 v k we can apply the result of part a to conclude the proof the claim suppose uk vk nk 1 are n affinely independent vectors we now show that span uk vk k n span v k k l 0 then by lemma 2 we can deduce that uk vk nk 1 and v k l k 1 are n l affinely independent vectors assume that span uk vk k n span v k k l 6 0 then there exist coefficients k nk 1 and k l k 1 which are not all zero such that n k 1 k uk vk l k 1 kv k which implies that n k 1 kvk l k 1 kv k n k 1 kuk since n k 1 kvk span vk k n and l k 1 kv k n k 1 kuk span uk k n but span vk k n span uk k n 0 holds by the given hypothesis it follows that n k 1 kvk 0 and hence k 0 k n and k 0 k l which leads to a contradiction lemma 4 a let n be a positive integer the following set of vectors are affinely independent u eni e n i 1 i n with the convention n 1 1 11 where eni is a n dimensional vector with the i th entry being 1 and other entries being 0 b let ni ki 1 be k positive integers with ni 2 i k consider the following sets of vectors in rn with n k i 1 ni u l 0 n 1 0 nl 1 enli e nl i 1 0 nl 1 0 nk i nl 1 l k v 0 n 1 0 ni 1 eni 1 e ni 1 1 0 ni 2 0 nk i k with the convention k 1 1 the n vectors in kl 1 u l v are affinely independent proof part a can be easily verified we now focus on proving part b with out loss of generality we prove for the case that nl 4 for all l k it is easy to verify that all vectors in kl 1 u l are linearly independent and by part a the vectors in v are affinely independent we claim that span v span kl 1 u l 0 n if the claim holds then by lemma 2 the n vectors in kl 1 u l w are affinely independent to prove this claim we label the vectors in u l as uli for l k i nl 1 and label the vectors in v as vl for l k we can verify that vl k 1 l 1 are linearly independent and vk k 1 l 1 vl sup pose span v span kl 1 u l 6 0 n and let li l k i nl 1 and l l k 1 be the coefficients such that w l k i nl 1 liuli l k 1 lvl 6 0 n 11 consider the ensi entry of w for s k and i 2 nl 1 evaluating this coefficient based on l k 1 lvl implies that the coefficient should be 0 on the other side evaluating this coefficient based on l k i nl 1 liuli implies that it should be equal to s i s i 1 therefore we must have s i s i 1 for s k and i 2 nl 1 for l k let al l i for i 2 nl 1 by matching the coefficient corresponding to the en 11 entry of w we get a 1 1 by matching the coefficient corresponding to the enlnl entry of w we get al 0 for l k this shows that w 0 which leads to a contradiction 12 lemma 5 let l m n be three positive integers let uk rl rn and vk rm rn for all k n be arbitrary vectors with dimension l n and m n respectively let u rl rn and v rm rn be two arbitrary vectors let wi ni 1 be n linearly independent vectors in r n with wij 0 1 i j n let ji j n wij 1 consider the following sets of vectors in the rl n rm n rn space uk uk vk wk eij 0 0 ei j 0 0 i i l i 6 i j jk k n v k uk vk wk 0 eij 0 i m j jk k n y u v 1 n e 1 j 0 0 e 1 j 1 0 0 j n with the convention n 1 1 w uk vk wk k n where 1 n is the n dimensional vector with all entries being 1 eij 0 0 e l i enj 0 m n 0 n and 0 eij 0 0 l n emi e n j 0 n then the set s nk 1 u k v k y w contains l m 1 n affinely independent vectors proof since wi ni 1 are n linearly independent binary vectors in r n for each j n there exists an i n depending on j such that j ji therefore there exists a mapping n n such that is surjective and j j j we define the following sets of vectors u j u j v j w j eij 0 0 ei 1 j 0 0 i l 1 j n v j u j v j w j 0 eij 0 i m j n clearly the sets u j j n are disjoint and j n u j k n uk simi larly the sets v j j n are disjoint and j n v j k n v k we claim that all vectors in the following sets are affinely independent u eij 0 0 ei 1 j 0 0 i l 1 j n v 0 eij 0 i m j n y e 1 j 0 0 e 1 j 1 0 0 j n 13 the claim can be proved using lemma 4 b and lemma 2 with following argu ment by lemma 4 b all vectors in u y are affinely independent one can easily verify that all vectors in v are independent and span u y span v 0 0 0 and hence by lemma 2 all vectors in u v y are affinely independent then by lemma 3 b the following l m 1 n vectors are affinely independent u u j v j w j eij 0 0 ei 1 j 0 0 i l 1 j n v u j v j w j 0 eij 0 i m j n y u v 1 n e 1 j 0 0 e 1 j 1 0 0 j n w uk vk wk k n since we have u v y w s it implies that s should contain l m 1 n affinely independent vectors 2 2 valid and facet defining inequalities our goal is to construct valid and facet defining inequalities for the convex hull c i j induced by the subsets i j of indices for the customer sites and candidate locations and then show that some of them are also valid and facet defining inequalities for conv l and conv c i j x y q conv l yj 0 j n j xij 0 qij 0 i j i j 12 the conversion from the facets of c i j to the facets of conv l is depicted by the following theorem theorem 1 facet extension consider the polytope conv l defined in 4 induced by the index subsets i m and j n suppose conv l is in full dimension i e dim conv l 2 m 1 n and dij 0 for i m j n suppose an inequality j j jyj i i j j xij ijqij 13 14 with coefficients j ij and define a facet of c i j and it is valid for conv l if there exists a set v of 2 i 1 j affinely independent points in c i j that are on the plane defined by this inequality and v satisfies the following conditions 1 for any point x y q v it holds that yj 0 1 j j 2 j j there exists an point x j y j q j v such that y j j 1 and i i x j ij cj 3 for each i i there exists a point x i y i q i v such that j j q i ij 1 then the inequality 13 defines a facet of conv l proof we first show that conv l is of full dimension since conv l is defined by 2 m 1 n variables we will prove dim conv l 2 m 1 n by constructing 2 m 1 n 1 affinely independent points in conv l as follows 0 0 0 0 ej 0 j f 0 ej eij i s j f eij ej eij i s j f where is a sufficient small positive constant in particular min dij cj it is easy to verify the above 2 m 1 n 1 points are affinely independent points in conv l and hence dim conv l 2 m 1 n using a similar argument we can show that dim c i j 2 i 1 j we now focus on proving the theorem we refer the inequality j j jyj i i j j xij ijqij as ineq in the proof since ineq defines a facet of c i j there exist 2 i 1 j affinely independent points in c i j that are on the plane defined by ineq we denote this set of the 2 i 1 j affinely independent points as v we will construct additional 2 m 1 n 2 i 1 j linearly independent points of conv l that are on the plane defined by ineq let x y q be an arbitrary point in v we 15 first construct the following set of points v 1 x y q 0 ej 0 j n j x y q 0 ej eij i m i j n j x y q eij ej eij i m i j n j with 0 sufficient small we can verify that all points in v 1 are linearly independent points of conv l that are on the plane defined by ineq and v 1 2 m 2 i 1 n j let x j y j q j v for every j j be the vector satisfying the condition 2 we construct the following set of points v 2 x j y j q j 0 0 eij i m i j j x j y j q j eij 0 eij i m i j j with sufficient small 0 one can verify that all points in v 2 are linearly independent points of c i j that are on the plane defined by ineq and v 2 contains 2 m i j linearly independent points finally we construct the following set of points v 3 x i y i q i 0 ej eij i i j n j x i y i q i eij ej eij i i j n j where x i y i q i is the point satisfying the condition 3 for each i i and 0 are sufficient small numbers again it is straightforward to verify that all points in v 3 are linearly independent points of conv l that are on the plane defined by ineq and v 3 2 i n j by looking at the perturbation terms involved in v 1 v 2 and v 3 we see that the vectors in v 1 v 2 and v 3 are linearly independent furthermore since span v 1 v 2 v 3 span v 0 0 0 then by lemma 2 all vectors in v v 1 v 2 v 3 are affinely independent the number of points we have constructed is v v 1 v 2 v 3 2 i 1 j 2 m 2 i 1 n j 2 m i j 2 i n j 2 mn n which shows that the ineq defines a facet of conv l 16 theorem 2 suppose dij 0 for all i m n the following hold a for any subsets of indices i m j n and index j n j the following inequality is valid for conv l i i j j j xij i i max j n dij j j cj yj j j cj 14 b let i m and j n be two subset of indices if j j cj i i maxj jdij then the following inequality is valid for conv l i i j n xij j n j i i max j j j dij j j cj yj j j cj 15 proof part a it suffices to show the validness for the two cases yj 0 and yj 1 if yj 0 then we have i i j j j xij i i max j n dij j j cj yj i i j j xij j j i m xij j j cj 16 where we use yj 0 yj 1 and the constraint i m xij cjyj to get the above inequalities for the case of yj 1 we have i i j j j xij i i max j n dij j j cj yj i i j j j xij i i max j n dij j j cj i i j n xij i i max j n dij j j cj i i j n dijqij i i max j n dij j j cj j j cj 17 where we use yj 1 and the constraint j n xij j n dijqij in 17 part b for a feasible point x y q let j j n j yj 1 for any i i let i argmaxj j j dij where ties are broken arbitrarily let ij i i i j for every j j j and by definition the subsets ij j j j form a partition of i if j 1 then 15 reduces to 14 therefore without 17 loss of generality we assume j 2 the expression on the left can be relaxed as i i j n xij j n j i i max j j j dij j j cj yj i i j j dijqij j j i i max j j j dij j j cj 18 notice that we have the following inequalities hold i i j j j dijqij i i di i j j j i ij dij j j i ij max j j dij j j i ij dij 19 furthermore the second term in 15 is evaluated as j n j i i max j j j dij j j cj yj j j i i max j j j dij j j cj j j j j j i ij max j j j dij j j j cj 20 the first term in 20 can be decomposed as j j j j j i ij max j j j dij j j j j i ij max j j j dij j j j j i ij max j j j dij t 1 t 2 21 where t 1 and t 2 represent the first and second term on the right side of 19 respectively the term t 1 is evaluated as t 1 j j j j i ij max j j j dij j j j j i ij max j j dij j j j i ij max j j dij 22 where we use the fact that for any j j i ij and j n j we have 18 dij maxj j j dij maxj j dij the term t 2 can be lower bounded as t 2 j j i ij j j max j j j dij j j i ij max j j j dij j j i ij j j j max j j j dij j j i ij dij j j i ij j j j max j j j dij j j i ij dij j 1 j j i ij max j j dij 23 substituting 22 and 23 into 21 yields the following inequalities j j j j j i ij max j j j dij j j j i ij max j j dij j j i ij dij j 1 j j i ij max j j dij j j i ij max j j dij j j i ij dij j 1 j j j i ij max j j dij j j i ij max j j dij j j i ij dij j 1 i i max j j dij 24 where we use the fact that ij j j j form a partition of i substituting 24 into 20 yields j n j i i max j j j dij j j cj yj j j i ij max j j dij j j i ij dij j 1 i i max j j dij j j j cj j j i ij max j j dij j j i ij dij j j cj 25 where we use the assumption i i maxj jdij j j cj 0 substituting 19 and 25 into 18 yields i i j n xij j n j i i max j j j dij j j cj yj j j cj 26 this shows that 15 is valid for conv l 19 theorem 3 let i m and j n suppose the following conditions are satisfied j j cj i i max j j dij max j n dij max j j dij i i j j j 0 cj i i max j j j 0 dij j 0 j 27 then the following inequality defines a facet of conv l i i j j xij j j j j j cj i i max j j dij yj j 1 j j cj i i max j j dij 28 proof we will first provide an intuition of how the coefficients of the inequality 28 are determined given the condition in 27 since we restrict the decision variables induced by the subsets i and j a facet defining valid inequality is likely in the form of i i j j xij j j ajyj b 29 we need to determine the coefficients aj and b notice that there are j 1 coefficients to be determined and we will set up j 1 linear equations corre sponding to the following j 1 situations 1 opening service centers at all locations in the subset j 2 opening service centers at all locations in j j for all j j notice that 2 contains j different situations referred as situation 2 j in the first situation all locations in j have service centers so the max imum value of i i j j xij is i i maxj j dij i e the aggregated demand constraint is binding similarly in the situation 2 j 0 locations in j j 0 have service centers and the maximum value of i i j j xij is j j j 0 cj i e the aggregated capacity constraint is binding these observations help us set up the following linear equations to determine aj and b i i max j j dij j j aj b 30 a j j j cj j j j aj b j j 30 b 20 by solving the above linear equation system we can determine the values of all coefficients b j 1 j j cj i i max j j dij aj j j j cj i i max j j dij j j which leads to the inequality 28 now we give a formal proof of that 28 is a facet defining valid inequality of conv l to see the validness we divide the analysis into four cases a yj 1 for all j j b yj 1 and yj 0 for all j j j c there exists a j 0 j satisfying 2 j 0 j 1 and yj 1 for all j j j 0 and yj 0 for all j j 0 d yj 0 for all j j the validness of 28 clearly holds in the cases a and b by the way of determining the coefficients for the case d 28 becomes i i j j xij j 1 j j cj i i max j j dij it is valid because in this case we have i i j j xij 0 and cj i i maxj j dij 0 by assumption it remains to verify the validness in the case c substitute yj 1 for j j j 0 into 28 and notice that we have j 1 j j cj i i max j j dij j j j 0 j j j cj i i max j j dij j 0 j 0 j j j 0 cj j 0 1 i i max j j dij j 0 j 0 j j j 0 cj j 0 1 j j cj j 0 1 j j 0 cj j 0 j j j 0 cj j 0 1 j j cj j j j 0 cj i i j j xij where the assumed condition is used to get the first inequality above it proves the validness in this case to show that 28 defines a facet of conv l we will first show that it defines a facet of c i j see 12 and apply theorem 1 to conclude that it also defines 21 a facet of conv l via verifying the three conditions in theorem 1 are satisfied let v x y q c i j x y q satisfies 28 as equality clearly there exists a facet of c i j containing all points in v and suppose this facet is represented in the following general form i i j j ijxij j j jyj i i j j ijqij 31 it suffices to show that the above coefficients are different from the coefficients in 28 by a positive constant note that all points in v should satisfy 31 as an equality we are going to propose some specific points from v and plug them into 31 to determine the coefficients first we notice that there must exist a vector j j x 0 ej q 0 v such that x 0 ij 0 0 q 0 ij 1 for all i j i j and i i x 0 ij cj for all j j it can be deduced that the points x 0 eij 1 eij 2 j j ej q 0 for all i i j 1 j 2 j j 1 6 j 2 and j j ej x 0 ei 1 j ei 2 j q 0 for all i 1 i 2 i j j are also in v for some sufficient small substituting these points into 31 as an equality we conclude that ij 1 ij 2 and i 1 j i 2 j which implies that ij i j i j for some 0 without loss of generality we can set 1 since the inequality is invariant under multiplication of a positive constant similarly the exists a point x 1 j j j 0 ej q 1 v such that 0 q 1 ij 1 for all i j i j j 0 it can be deduced that the points x 1 j j j 0 ej q 1 ei 1 j 1 i 1 j 1 i j j 0 are all in v substituting this point into 31 as an equality we conclude that ij 0 for all i j i j j 0 since j 0 is arbitrary we conclude that ij 0 for all i j i j therefore 31 becomes i i j j xij j j jyj 32 clearly since the previously considered point x 0 j j ej q 0 v should sat isfy i i j j x 0 j i i maxj j dij this can be obtained by substituting the point into 28 as an equality then substituting this point into 32 as an equality gives an equation in the same form of 30 a similarly substituting the point x 1 j j j 0 ej q 1 v into 32 as an equality gives an equation in 22 the same form of 30 b therefore the to be determined coefficients are the solution of 30 which shows that the facet defining valid inequality 32 of c i j is exactly 28 now we show that 28 is also a facet defining inequality of conv l using theorem 1 to achieve this we first need to show that 28 is valid for conv l the validness of 28 for conv l is based on the following two observations if a subset j n j of service centers are opened the maximum attracted demand from a customer site i is at most maxj j j dij maxj n dij but maxj n dij maxj j dij by assumption which implies that once all places in j have service centers the aggregated demand constraint i i j j xij i i maxj j dij is valid and it is independent of whether or not other places having service centers similarly in the case that places at j j 0 have service centers the aggregated capacity constraint dominates the aggregated demand constraint which is also independent of service center locations at other places due to the fact maxj j j 0 dij maxj j j j 0 dij for any j n j it remains to show that there exist 2 i 1 j affinely independent vectors in c i j that satisfy the three conditions in theorem 1 since we have already proved that 28 is a facet defining inequality of c i j there must exist a set v of 2 i 1 j affinely independent vectors in c i j that satisfy 28 as an equality furthermore we can make sure that v includes the following two vectors x 0 j j ej q 0 and x 1 j j j 0 ej q 1 where the two vectors are introduced in the previous analysis of this proof notice that x 0 j j ej q 0 satisfies the condition 2 of theorem 1 for all j j and x 1 j j j 0 ej q 1 satisfies the condition 3 of theorem 1 for each i i this concludes the proof theorem 2 and 3 provide valid and facet defining inequalities for conv l notice that these inequalities do not involve variables q introduced to lift this observation raises a question are these inequalities also valid and facet defining for conv the following proposition gives an affirmative answer to this question 23 proposition 3 let x y rm n p be a full dimensional polytope in rm represented by a linear inequality system of variables x and q be a full dimen sional polytope in rm n represented by a linear inequality system of variables x y suppose p projxq if x 0 is a valid facet defining inequality of q it is also a valid facet defining inequality of p proof 1 suppose x 0 is a valid inequality of q due to the projection relationship for any x p there exists a x y q since x 0 is valid for q we have x 0 which implies that x 0 is valid for p 2 suppose x 0 is a facet defining inequality of q we focus on the case that the facet does not contain the point 0 0 by definition there exists m n linearly independent points xk yk k m n satisfying xk 0 since every yk is a n dimensional vector the set xk k m n contains m linearly independent vectors in other words there exist m linearly independent vectors on the hyperplane x 0 which shows that x 0 defines a facet of p corollary 1 the inequality 14 is valid for conv the inequality 15 is valid for conv given that the condition in theorem 2 is satisfied and the inequality 28 defines a facet of conv given that the conditions in theorem 3 is satisfied 3 conclusion the facet defining inequalities given in theorem 2 hold when the parameters of demand and capacity satisfy a certain condition for a subset of client loca tions and candidate facility locations the same spirit can be used to construct various conditions that lead to different families of facet defining inequalities identifying the subsets that satisfy the conditions is also a np hard problem which prevents a systematic application of these inequalities in computation at low cost of computing power this indicates that the facet defining inequali ties identified in this work is of more theoretical interest for understanding the 24 facility location polyhedral structure under competing constraints of capacity and demand acknowledgement this research was partially supported by the onr grant n 00014 18 1 2097 references 1 k aardal y pochet l a wolsey capacitated facility location valid inequalities and facets mathematics of operations research 20 3 1995 562 582 2 m s daskin network and discrete location models algorithms and applications 2 nd edition wiley 2013 3 s melkote m s daskin an integrated model of facility location and transportation network design transportation research part a policy and practice 35 6 2001 515 538 4 m t melo s nickel f s da gama facility location and supply chain management a review european journal of operational research 196 2 2009 401 412 5 c boonmee m arimura t asada facility location optimization model for emergency humanitarian logistics international journal of disaster risk reduction 24 2017 485 498 6 j allen m browne t cherrett investigating relationships between road freight transport facility location logistics management and urban form journal of transport geography 24 2012 45 57 7 s h owen m s daskin strategic facility location a review european journal of operational research 111 3 1998 423 447 25 8 f v louveaux d peeters a dual based procedure for stochastic facility location operations research 40 3 1992 564 573 9 m albareda sambola e ferna ndez f s da gama the facility location problem with bernoulli demands omega 39 2011 335 345 10 q wang r batta c m rump algorithms for a facility location problem with stochastic customer demand and immobile servers annals of opera tions research 111 2002 17 34 11 p murali f ordo n ez m m dessouky facility location under demand uncertainty response to a large scale bio terror attack socio economic planning sciences 46 2012 78 87 12 n gu lp nar d pachamanova e c anakog lu robust strategies for facility location under uncertainty european journal of operational research 225 2013 21 35 13 m k lim a bassamboo s chopra m s daskin facility location de cisions with random disruptions and imperfect estimation manufacturing service operations management 15 2 2013 239 249 14 y li j shu m song j zhang h zheng multisourcing supply network design two stage chance constrained model tractable approximations and computational results informs journal on computing 29 2 2017 287 300 15 l v snyder facility location under uncertainty a review iie transac tions 38 2006 537 554 16 o baron j milner facility location a robust optimization approach production and operations management 20 5 2010 772 785 17 a gourtani t d nguyen h xu a distributionally robust optimiza tion approach for two stage facility location problems euro journal on computational optimization 8 2020 141 172 26 18 t chan z shen a siddiq robust defibrillator deployment under car diac arrest location uncertainty via row and column generation operations research 66 2017 358 379 19 a do yen n aras g barbarosog lu a two echelon stochastic facility lo cation model for humanitarian relief logistics optim lett 6 2012 1123 1145 20 p g berglund c kwon robust facility location problem for hazardous waste transportation netw spat econ 14 2014 91 116 21 v goel i e grossmann a class of stochastic programs with decision dependent uncertainty math program 108 2006 355 394 22 m j eppli j d shilling how critical is a good location to a regional shop ping center the journal of real estate research 12 3 1996 459 468 23 rajagopal growing shopping malls and behavior of urban shoppers jour nal of retail leisure property 8 2009 99 118 24 b basciftci s ahmed s shen distributionally robust facility location problem under decision dependent stochastic demand https doi org 10 1016 j ejor 2020 11 002 2020 25 m conforti g cornue jols g zambelli integer programming 2014 th edition springer 2014 26 g l nemhauser l a wolsey integer and combinatorial optimization 1 st edition wiley interscience 1999 27 y pochet l a wolsey lot sizing with constant batches formulation and valid inequalities mathematics of operations research 18 4 1993 767 785 28 k aardal y pochet l a wolsey capacitated facility location valid inequalities and facets mathematics of operations research 20 3 1995 562 582 27 https doi org 10 1016 j ejor 2020 11 002 https doi org 10 1016 j ejor 2020 11 002 29 g perboli r tadei r tadei new families of valid inequalities for the two echelon vehicle routing problem electronic notes in discrete mathematics 36 1 2010 639 646 30 l c coelho g laporte improved solutions for inventory routing prob lems through valid inequalities and input ordering international journal of production economics 155 1 2014 391 397 31 r baldacci m battarra d vigo valid inequalities for the fleet size and mix vehicle routing problem with fixed costs networks 54 2009 178 189 32 d huygens m labbe a r mahjoub p pesneau the two edge con nected hop constrained network design problem valid inequalities and branch and cut networks 49 1 2006 116 133 33 q louveaux l a wolsey lifting superadditivity mixed integer rounding and single node flow sets revisited annals of operations research 153 1 2007 47 77 doi 10 1007 s 10479 007 0171 7 34 j richard i de farias jr g nemhauser lifted inequalities for 0 1 mixed integer programming basic theory and algorithm mathematical program ming 98 2003 89 113 doi 10 1007 s 10107 003 0398 2 35 a atamtu rk on the facets of the mixed integer knapsack polyhe dron mathematical programming 98 2003 145 175 doi 10 1007 s 10107 003 0400 z 36 z gu g l nemhauser m savelsbergh lifted cover inequalities for mixed 0 1 integer programs complexity informs journal on computing 11 1 1999 117 123 doi 10 1287 ijoc 11 1 117 37 z gu g l nemhauser m w savelsbergh lifted flow cover inequalities for mixed 0 1 integer programs mathematical programming 85 3 1999 439 467 doi 10 1007 s 101070050067 28 http dx doi org 10 1007 s 10479 007 0171 7 http dx doi org 10 1007 s 10107 003 0398 2 http dx doi org 10 1007 s 10107 003 0400 z http dx doi org 10 1007 s 10107 003 0400 z http dx doi org 10 1287 ijoc 11 1 117 http dx doi org 10 1007 s 101070050067 38 z gu g l nemhauser m savelsbergh lifted cover inequalities for mixed 0 1 integer programs computation informs journal on computing 10 4 1998 427 437 doi 10 1287 ijoc 10 4 427 39 y h au l tunc el a comprehensive analysis of polyhedral lift and project methods siam journal on discrete mathematics 30 1 2016 411 451 doi 10 1137 130950173 40 b kocuk h jeon s s dey j linderoth j luedtke x a sun a cycle based formulation and valid inequalities for dc power transmission problems with switching operations research 64 4 2016 922 938 doi 10 1287 opre 2015 1471 41 m r k l nc j linderoth j luedtke lift and project cuts for convex mixed integer nonlinear programs mathematical programming computa tion 9 4 2017 499 526 doi 10 1007 s 12532 017 0118 1 42 s burer d vandenbussche solving lift and project relaxations of binary integer programs siam journal of optimization 16 3 2006 726 750 doi 10 1137 040609574 43 n e aguilera s m bianchi g l nasini lift and project relaxations for the matching and related polytopes discrete applied mathematics 134 1 3 2004 193 212 doi 10 1016 s 0166 218 x 03 00337 8 44 e balas a modified lift and project procedure mathematical program ming 79 1 1997 19 31 doi 10 1007 bf 02614309 45 g b dantzig b c eaves fourier motzkin elimination and its dual journal of combinatorial theory series a 14 3 1973 288 297 doi 10 1016 0097 3165 73 90004 6 46 h p williams fourier motzkin elimination extension to integer program ming problems journal of combinatorial theory series a 21 1 1976 118 123 doi 10 1016 0097 3165 76 90055 8 29 http dx doi org 10 1287 ijoc 10 4 427 http dx doi org 10 1137 130950173 http dx doi org 10 1287 opre 2015 1471 http dx doi org 10 1287 opre 2015 1471 http dx doi org 10 1007 s 12532 017 0118 1 http dx doi org 10 1137 040609574 http dx doi org 10 1016 s 0166 218 x 03 00337 8 http dx doi org 10 1007 bf 02614309 http dx doi org 10 1016 0097 3165 73 90004 6 http dx doi org 10 1016 0097 3165 73 90004 6 http dx doi org 10 1016 0097 3165 76 90055 8 47 m schechter integration over a polyhedron an application of the fourier motzkin elimination method the american mathematical monthly 105 3 1998 246 251 doi 10 1080 00029890 1998 12004874 48 e balas s ceria g cornue jols a lifted and project cutting plane al gorithm for mixed 0 1 programs mathematical programming 58 1993 295 324 49 k aardal y pochet l a wolsey capacitated facility location valid inequalities and facets mathematics of operations research 20 3 1995 562 582 50 k aardal capacitated facility location separation algorithms and com putational experience mathematical programming 81 1998 149 175 51 k aardal a branch and cut algorithm for hub location problems with single assignment mathematical programming 102 2004 371 405 30 http dx doi org 10 1080 00029890 1998 12004874 1 introduction 1 1 motivation and background 1 2 literature review 2 polyhedral properties of conv 2 1 technical lemmas for proving facetness 2 2 valid and facet defining inequalities 3 conclusion