a distributionally robust service center location problem with decision dependent demand induced from a maximum attraction principle fengqiao luo department of industrial engineering and management science northwestern university evanston illinois 60208 fengqiaoluo 2014 u northwestern edu this paper establishes and analyzes a service center location model with a simple but novel decision dependent demand induced from a maximum attraction principle the model formulations are investigated in the distributionally robust optimization framework for the capacitated and uncapacitated cases a statis tical model that is based on the maximum attraction principle for estimating customer demand and utility gain from service is established and analyzed the numerical experiments show that the model admits high computational efficiency in solving mid and large size instances key words service center location distributionally robust optimization decision dependent demand maximum attraction principle 1 introduction the facility location problem is one of the most fundamental problems investigated in operations research in this problem a decision maker needs to decide locations of a limited number of facilities factories retail centers power plants service centers etc and determine coverage of demand from different sites by the located facilities the objective is to minimize the facility setup cost and the cost of production and delivery this problem provides a basic framework to formulate related problems in resource allocation supply chain management and logistics etc the facility location models in the stochastic and robust distributionally robust optimization framework have also received sufficient investigation in the stochastic optimization framework the customer demand can be random parameters following a known or partially known probability distributions while in the robust distributionally robust optimization framework customer demand the probability distribution of customer demand can have a certain level of uncertainty ambiguity incorporating randomness or uncertainty in customer demand estimation is a sensible and realistic model improve ment as the decision maker has no perfect prediction on the demand in practice recently there is a trend of research on distributionally robust optimization problems with decision dependent ambiguity in which the ambiguity set is specified by decision dependent parameters introducing decision dependency has certain merit in situations when model parameters are naturally functions 1 ar x iv 2 01 1 12 51 4 v 2 m at h o c 7 j ul 2 02 1 author service center location problem with decision dependent demand 2 informs journal on optimization 00 0 pp 000 000 0000 informs of decision variables for example in a basic pricing and revenue management problem the demand of a product can be a decreasing function of the price to be determined the notion of modeling decision dependency in the robust distributionally robust optimization framework can be applied to investigate a variety of specific problems in this paper we investigate a distributionally robust service center location problem with decision dependent customer demand in the model customers need to physically access a service center in order to receive service this problem is motivated from clinic or medical test center such as for covid 19 screen test allocation the objective is to maximize the total utility gain of all customers who have decided to receive service from the opened service centers the decision dependence is decoupled from the ambiguity set in our model which is different from basciftci et al 2020 specifically we impose the decision dependency on the demand itself but not on the uncertainty of demand and the decision dependent demand is induced from a maximum attrac tion principle based on a ranking of opened service centers in the neighborhood our investigation shows that the decoupling approach leads to high computational efficiency of solving the problem and it can be more data driven in practice furthermore the novel approach of modeling decision dependency introduce additional combinatorial properties to the model which is of independent interest the contribution of this paper is summarized as follows 1 a novel approach of modeling decision dependency of the customer demand has been estab lished for the service center location problem with a possible extension on the modeling of decision dependency in this approach the decision dependency is decoupled from the ambiguity set which admits highly computational tractable reformulations 2 a learning model has been established to estimate utilities and demand based on data from survey 3 the numerical experience with this model shows that mid and large size instances can be solved very efficiently due to decoupling of decision dependency from the ambiguity set literature review facility location problems with non deterministic demand have received plentiful investigation in the framework of stochastic optimization and robust distributionally robust optimization in the stochastic optimization framework customer demand are independent random parameters with known probability distributions and the problem can be formulated as a two stage stochastic program in which the location vector is in the first stage decision that needs to be made before realization of customer demand louveaux and peeters 1992 albareda sambola et al 2011 in a special case when the customer demand rates and service rates of each facility are assumed to author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 3 follow exponential probability distributions the problem of minimizing long term average cost can be reformulated as a deterministic optimization problem with corresponding poisson rates to characterize the demand and service this setting has been applied to an allocation problem of atms wang et al 2002 the probability distribution of demand can also be used to define chance constraints to ensure a required service level under possible stockout and supply disruption murali et al 2012 gu lp nar et al 2013 lim et al 2013 li et al 2017 in the robust distributionally robust optimization framework for facility location problems the information of demand is partially known to the decision maker and the goal is to find a robust optimal location vector that optimizes the objective after a worst case realization of demand infor mation snyder 2006 following this direction of research baron and milner 2010 investigated a robust multi period facility location problem with box and ellipsoid sets of uncertainty gour tani et al 2020 investigated a distributionally robust two stage facility location problem with an ambiguity set defined corresponding to the mean and covariance matrix of a random parameter for expressing the demand facility location problems with demand uncertainty have been studied with a variety of novel application background which includes but not limited to medication coverage and delivery under a large scale bio terror attack murali et al 2012 medical equipment defib rillators location problem to reduce cardiopulmonary resuscitation cpr risk chan et al 2017 humanitarian relief logistics do yen et al 2012 and hazardous waste transportation berglund and kwon 2014 etc in a lot of real world problems the uncertainty of parameters can interplay with the decision to be made this behavior is well observed especially in a sequential multi stage decision making process in which information about system parameters are gradually revealed and the decisions made up until the current stage can reshape the uncertainty in future goel and grossmann 2006 it motivates the research on multi stage stochastic optimization with decision dependent uncer tainty solution strategies based on lagrangian duality and novel branch and bound methods are developed to solve this family of problems goel and grossmann 2005 gupta and grossmann 2011 tarhan et al 2013 and it has a rich application in oil chemical industrial goel and grossmann 2004 tarhan and grossmann 2008 goel et al 2006 tarhan et al 2009 an approximation scheme vayanos et al 2011 is proposed to tackle the high complexity in solving the multi stage problems with decision dependent information discovery decision dependent uncertainty has also been con sidered in stochastic optimization problems such as resource management tsur and zemel 2004 stochastic traffic assignment modeling shao et al 2006 and robust network design ahmed 2000 viswanath et al 2004 imposing decision dependent uncertainty for robust distributionally robust optimization has received great attention in recently years nohadani and sharma 2018 luo and mehrotra 2020 author service center location problem with decision dependent demand 4 informs journal on optimization 00 0 pp 000 000 0000 informs noyan et al 2017 basciftci et al 2020 luo and mehrotra 2019 a nohadani and sharma 2018 studied robust linear programs with decision dependent budget type uncertainty and its general ization with a polyhedral uncertainty set this concept is demonstrated in a robust shortest path problem where the uncertainty is resolved progressively when approaching the destination noyan et al 2017 investigated a family of distributionally robust optimization problems with an ambiguity set defined using earth mover s distances including total variation distance and the wasserstein metric with decision dependent parameters such as the nominal probability distribution and the radius and focused on understanding which settings can lead to tractable formulation royset and wets 2017 provided a variational principle analysis for optimization under stochastic ambiguity which gives fruitful tools for analyzing solution quality and price of robustness some novel appli cations are studied in spacey et al 2012 for robust software partition and in nohadani and roy 2017 for radiation therapy design the work in basciftci et al 2020 and luo and mehrotra 2019 b are mostly related to the work of this paper basciftci et al 2020 investigated a distributionally robust facility location problem with decision dependent ambiguity where the ambiguity set is defined using disjointed lower and upper bounds on the mean and variance of the candidate probability distributions for customer demand and these bounds are defined as linear functions of the location vector to admit a tractable milp reformulation the model considered in luo and mehrotra 2019 b assumed deterministic customer demand and imposed a linear decision dependency on the moment bounds for candidate probability distributions of utility which leads to a misocp reformulation 2 problem formulation we consider a problem of allocating a set of service centers facilities in a region to meet the customer demand from the region similarly to the traditional facility location problem the region consists of customer sites and candidate locations for the service centers each customer site has certain demand that needs to be fulfilled by a service center from its neighborhood especially we consider the case that the demand of each customer site is a random parameter which depends on the locations of service centers in most literature on decision dependent robust distributionally robust optimization the decision dependency is formulated as a linear function in this problem we consider a special form of decision dependency that is based on an assumption of maximum attraction principle which will be clear in section 2 1 2 1 a deterministic model we first formulate a deterministic model of this problem in which we treat the demands as deter ministic parameters that depend on the locations of service centers and introduce the notion of maximum attraction principle the notations used in this model is given by the following list author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 5 s the set of customer sites f the set of candidate locations for service centers bj the cost of opening a service center at location j f b the budget of allocating service centers cj the service capacity of a service center located at j f uij the utility gain obtained by a customer from site i s who gets service from the service center at j f yj the binary decision variable of opening a service center at location j f di y the demand from customer site i that depends on the decision vector y xij the demand flow from customer site i s to the service center at j f the deterministic model is formulated as follows max i s j f uijxij s t j f bjyj b i s xij cjyj j f j f xij di y i s yj 0 1 xij 0 i s j f 1 the first three constraints represent the limit of budget capacity and the amount of demand respectively note that in general the demand from site i s can depend on the pattern of service center locations which is represented by the decision vector y in this paper we investigate a specific type of location dependent demand which is simple but sensible in depicting customers behavior in practice this type of location dependency of demand is referred as the maximum attraction principle in this paper we now give a detailed description of this principle first each customer site i is associated with a preferable subset fi of candidate facility locations when there is only one service center opened at j fi it will attract dij amount of demand from i if there are multiple service centers opened at locations in fi the maximum demand that can be attracted from i is equal to the maximum dij for j fi that has a facility this principle is formally described by the following equation di y 0 if j f 1 j fi yj 0 dij if y ej for some j fi maxj fi y dij for other cases 2 where ej is the fi dimensional vector with the j th entry being 1 and other entries being 0 and the set fi y is defined as fi y j fi yj 1 the maximum attraction principle matches with our intuition from practice this principle first assumes that locations of service centers that are not within the preferable location set fi are not attractive to customers from site i at all author service center location problem with decision dependent demand 6 informs journal on optimization 00 0 pp 000 000 0000 informs the most natural way of establishing fi is based on the distance from site i to the candidate locations this is a reasonable assumption because customers usually will not consider visiting a service center that is beyond a certain distance from their living place the maximum attraction principle further assumes that within the preferable opened service centers fi y there exists one service center j or multiple centers that is are most attractive to the customers from site i in the sense that j argmaxj fi y dij and the presence of multiple service centers in fi y including j attracts the same amount of demand from site i as the presence of just a single service center at j this assumption is also consistent with our intuition from practice if every service center is identical in the sense of scale and service quality the most attractive one to site i is likely the one that is most close to i furthermore customers who are willing to visit further service centers are also willing to visit the one that is most close to their living place note that the maximum attraction principle can be extended to incorporate the impact of the number of opened service centers in fi on the demand this extension is discussed in section 2 2 we also define the subset sj as sj i s j fi for all j f based on the maximum attraction principle the service center location problem 1 is written as the follows max i s j f uijxij s t j f bjyj b i s xij cjyj j f j fi xij max j fi y dij i s yj 0 1 xij 0 i s j f 3 to go one step further we can linearize the term maxj fi y dij by introducing some continuous auxiliary variables qij to form it as a convex combination of dij for j fi after this transformation we obtain the following equivalent formulation of 3 max i s j f uijxij ddsl 1 s t j f bjyj b ddsl 2 i s xij cjyj j f ddsl 3 j fi xij j fi dijqij i s ddsl 4 j fi qij 1 i s ddsl 5 qij yj i s j fi ddsl 6 yj 0 1 xij 0 qij 0 i s j fi ddsl 7 author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 7 notice that in the above reformulation the auxiliary variables qij j fi are used select the most attractive candidate location driven by the sense of maximizing the objective the constraint qij yj ensures that only opened service centers in fi are involved in the maximum attraction principle since j fi qij 1 the model will set qij 1 and qij 0 for all j fi j to relax the constraint j fi xij j fi dijqij as possible 2 2 some remarks on the model in the model setting we implicitly assume that the customers are willing to corporate with the decision maker to maximize the total utility gain although this assumption is highly impractical the rationality of this model depends on what metric we use to measure the system performance if the goal is to estimate what is expectation of total utility in practice then the following questions should be addressed and the corresponding aspects should be properly modeled what is the service policy used by each service center fifo or some other policies how to characterize customers behavior and the mechanism of competing for the limited service capacity if their most favored service center does not have any capacity are they willing to accept the service from the less preferred locations with less utility gain incorporating all these factors into the model can easily make it very complicated and meanwhile a large amount of customers information are needed to drive this approach of modeling on the other side if the goal is to access what is the maximum potential utility that can be achieved by the system in the most ideal situation then the ddsl model can be used to give an estimation a possible modification of modeling the decision dependent demand is to add a perturbation term to the demand based on the number of opened service centers specifically we can modify the constraint i fi xij maxj fidij to be i fi xij maxj fidij ai j fi yj where ai is a parameter that measures the influence of opening one more service center on the demand in this way of modeling it is assumed that the marginal increase of demand may depend on the number of opened service centers in reality when potential customers see more chain stores are opened in the neighborhood they may have higher intention to try one of them in this case the parameter ai can be a random parameter with certain level of ambiguity in the distributionally robust extension of the model 2 3 a distributionally robust two stage stochastic extension the deterministic service center location model with decision dependent demand can be further extended to a distribtuionally robust two stage stochastic program after imposing an ambiguity set on the pairwise demand dij this extension is motivated by the fact that estimation of the demand parameters dij could be inaccurate therefore we can treat dij as random parameters with an unknown joint probability distribution and apply the distributionally robust framework on this service center location problem with uncertainty we assume a finite support of the joint author service center location problem with decision dependent demand 8 informs journal on optimization 00 0 pp 000 000 0000 informs probability distribution of the pairwise random demand vector d dij i s j fi let the finite support be based on samples written as d d ij i s j fi for all in this case any probability distribution of d can be represented as a dimensional vector we define a nominal probability distribution 0 of d as 0 d d 0 5 in the vector representation we write it as 0 0 the ambiguity set of candidate joint probability distribution of d is defined based on the total variation distance between two probability distributions specifically we consider an ambiguity set of the following form p r 0 1 d 6 based on the above definition of ambiguity set the distributionally robust two stage stochastic extension of the service center location model can be formulated as follows max y min p ed q y d s t j f bjyj b yj 0 1 j f dro fl where the recourse function q y d for scenario is given by q y d max i s j fi uijx ij 7 a s t i s x ij cjyj j f 7 b j fi x ij j fi d ijq ij i s 7 c j fi q ij 1 i s 7 d q ij yj i s j fi 7 e x ij 0 q ij 0 i s j fi 7 f using a standard technique for two stage stochastic programming we can decompose dro fl into a master problem and scenario sub problems the original problem dro fl can be solved iteratively in each iteration we solve the current master problem in the space of y and pass the current master solution to each scenario sub problem after solving each scenario sub problem for the fixed first stage solution we can generate a valid inequality for each scenario using the optimal dual values associated with constraints of the scenario sub problem then we aggregate the valid inequalities from all scenario sub problems using the worst case measure of scenarios to get a single author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 9 cut for the master problem which is an optimality cut the optimality cut is added to the master problem in the next iteration specifically the master problem at iteration n can be represented as max s t j f bjyj b k r k j f t k jyj k n 1 y 0 1 f 0 master where k is the iteration based worst case probability measure on scenarios at iteration k n 1 the way of determining this worst case probability measure is given in 10 at iteration n we solve the master problem master and obtain the current optimal first stage solution y n this y n is input into every second stage scenario sub problem the second stage linear program is solved and let n j 0 n i 0 n i 0 and n ij 0 for all i s j fi are optimal dual values corresponding to the constraints 7 b 7 c 7 d and 7 e respectively using the standard technique of bender s decomposition cite ref we can obtain the following valid inequality on the value function q y d q y d i s n i j f cj n j i sj n ij yj 8 the strong duality implies that when evaluating q y d at y n we get q y n d i s n i j f cj n j i sj n ij y n j 9 the worst case probability measure n is an optimal solution of the following linear program min q y n d s t 0 1 d 1 0 10 where q y n d is the value function evaluated at the first stage solution y n and scenario once the current worst case probability measure is obtained the following inequality will be added to the first stage master problem n i s n i j f cj n j i sj n ij yj 11 the algorithm and convergence property for solving dro fl are given in appendix 5 it can be shown that for a given first stage solution y the scenario sub problem can be solved using a greedy algorithm author service center location problem with decision dependent demand 10 informs journal on optimization 00 0 pp 000 000 0000 informs 2 4 a single stage reformulation of dro fl for the uncapacitated case we consider a special case of dro fl in which each candidate service center has sufficient capacity for service in this case the capacity constraints 7 b can be removed from the second stage scenario problems we will show that this leads to a simplified scenario problem that admits a closed form optimal solution and optimal objective for the second stage problem with a mild regularity condition on the parameters then after dualizing the inner minimization problem over the probability measure on scenarios dro fl can be reformulated as a mixed 0 1 linear program the single stage reformulation result is given by the following theorem definition 1 the utility gain and demand are consistent if for every i s and f fi there exists a j f such that uij maxj f uij and d ij maxj f d ij the consistency condition for utility gain and demand says that the location that attracts the most demand over other locations should also correspond to the highest utility theorem 1 suppose the utility gain and demand are consistent in the uncapacitated case the distributionally robust service center location problem dro fl with decision dependent demand based on the maximum attraction principle and the ambiguity set 6 can be reformulated as the following mixed 0 1 linear program max 0 d s t j f bjyj b i s j fi uijd ijsij 0 sij yj i s j fi j fi sij 1 i s 0 0 0 r yj 0 1 j f 0 sij 1 i s j fi 12 proof without capacity constraints it is easy to see that the optimal objective value of the scenario problem is given by i s max j fi uijyj max k fi d ikyk i s max j k fi uijd ijyjyk i s max j fi uijd ijyj 13 author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 11 where we use the assumption that the utility gain and demand are consistent the problem dro fl becomes the following max y min i s max j fi uijd ijyj s t j f bjyj b 0 d yj 0 1 j f 14 the terms involved in the inner minimization problem of 14 can be written as min i s max j fi uijd ijyj s t d 0 0 1 0 0 15 taking the dual of the above linear program with respect to the probability measure we obtain the following inner problem max 0 d s t i s max j fi uijd ijyj 0 0 0 0 0 r to linearize the term maxj fi uijd ijyj we can introduce binary indicator variables sij and refor mulate the first constraint as follows i s j fi uijd ijsij 0 sij yj j fi sij 1 0 sij 1 where we implicitly use the consistency condition of utility and demand which implies argmaxj fiuijd ijyj is scenario independent and hence the variable sij incorporate with the outer maximization yields the reformulation 12 author service center location problem with decision dependent demand 12 informs journal on optimization 00 0 pp 000 000 0000 informs 3 a statistical model for utilities and demand estimation we establish a regression model based on the maximum attraction principle for estimating utility value uij and demand dij that are input parameters to the service center location model dro fl as a by product this regression model can also be used to estimate the size parameter d of the ambiguity set 6 the regression model requires samples of survey among potential customers from a site i s on their ratings of multiple candidate service center locations before formulating the regression model we first introduce how the samples of survey are collected for fitting the regression model suppose n residents have been randomly selected from the site i and they are viewed as potential customers of service centers under planning each of them is asked to give a score in the range 0 1 q to each candidate service center location in fi the score that a customer is assigned to a location j fi is taken as the potential utility gained by the customer if going to the service center at j score value 0 means the customer is unwilling to get service from the corresponding location since the regression model structure is identical for each i s we omit the customer site index i and re write fi as g in the following modeling and analysis suppose the indices of location in g are labeled as g 1 2 g the n residents are labeled as 1 2 n and the score assigned to a candidate location j g by the resident k is denoted as akj the maximum attraction principle described in 2 may not be satisfied in reality but it is possible to establish a utility demand estimation model that approximately meets the maximum attraction principle for example we can verify whether the samples from survey satisfy the max imum attraction principle by grouping the customers who have taken the survey as follows vj k n akj 1 j g 16 where n 1 n in words vj is the set of residents who are willing to go to a service center located at j according to 2 the samples satisfy the maximum attraction principle exactly if there exists a permutation on the indices in g such that the following inclusive condition holds v 1 v 2 v g 17 a logic behind the maximum attraction principle is that if two candidate locations have similar features then if a customer is attracted by one location the customer should also be attracted by the other location with high chance in this case the difference in the attractability of the two candidate locations viewed by the customer is reflected in the score assigned to the two locations by the customer the scores in this case are both non zero indicating that the customer is willing to visit any of them only in the case that two candidate locations have some substantial differences i e one is too far away from the customer site or one is located at a bad community a customer will be willing to visit one location assigning a non zero score to it while unwilling to visit the other one assigning a zero score to it author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 13 3 1 an inclusive chain representation of the maximum attraction principle we establish an inclusive chain model to represent the set level realization of the maximum attrac tion principle first we build the subsets 16 using collected samples and the we sort the indices in g such that v 1 v 2 v g where is a permutation on g that makes this condition hold for clarity we assume that v 1 v 2 vg without loss of generality the inclusive chain model assumes that the score assigned to the candidate locations in g by a customer from a fixed location should match with one of the following patterns 0 0 a i i a i g for i 1 g 1 18 where in the i th pattern first i 1 scores are all zero and the remaining g i 1 scores are all non zero by convention the g 1 th pattern is just 0 0 in a probabilistic flavor the inclusive chain model icm for the score vector can be formally established as a statistical model presented as d g 1 i 1 1 b i 0 0 q i i q i g p q i j r i jr i 1 g j i g r 1 q p b i pi i 1 g 1 g 1 i 1 pi 1 q r 1 i jr 1 i 1 g j i g icm where is the random score vector b is an indicator random variable that selects the pattern matching with the score vector pj is the probability of score vector matching with the j th pattern and i jr r 1 q gives the probability distribution of the random score q i j note that pi and i jr are model parameters that can be determined by fitting the inclusive chain model with collected samples the following proposition connects the inclusive chain model with the set level maximum attraction principle proposition 1 if the score vector of every customer taking the survey follows the inclusive chain model then the set level maximum attraction principle v 1 v 2 vg is satisfied by the collection of samples almost surely proof we prove it contradiction suppose there exist subsets vi and vj with i j such that vi vj 6 with some positive probability suppose k is the customer who is willing to visit vi but not vj and let k be the score vector of this customer the definition of vi implies that i 1 but k vj implies kj 0 on the other side for every pattern vector we should have 1 i 0 1 j 0 almost surely which implies that 1 ki 0 1 kj 0 almost surely but this contradicts to ki 1 and kj 0 author service center location problem with decision dependent demand 14 informs journal on optimization 00 0 pp 000 000 0000 informs 3 2 an adjusted inclusive chain model for incorporating defective score vectors we consider the problem of fitting the inclusive chain model with the collected samples score vectors the first step is to determine the rank level of attracability of candidate locations g involved in the inclusive chain an empirical method by simply sorting the cardinality of vi can be used to achieve this the probability guarantee of this method which will be discussed in a moment for now assume that the order has been identified and suppose v 1 v 2 vg without loss of generality so empirically this implies that the rank is 1 2 g sorted by level of attractability from low to high based on this information we can establish an inclusive chain model as icm but this model is not capable to handle score vectors in which there is at least one zero value entry between two non zero value entries i e 0 0 5 7 0 0 7 6 9 we call a score vector defective if it can not match with any pattern vector in 18 valid for the inclusive chain model note that to convert the defective score vector 0 0 5 7 0 0 7 6 9 into a qualified pattern one can either add two 1 score entries to the middle 0 0 5 7 0 0 7 6 9 0 0 5 7 1 1 7 6 9 or remove the first two nonzero entries 0 0 5 7 0 0 7 6 9 0 0 7 6 9 the first approach has added a total 2 units of score while the second one has removed a total 12 units of score and it can be verified that the first approach is the one that makes the minimum total score change among all possible changes that can convert this score vector into a qualified pattern based on this rule we can define the defective score units for an arbitrary score vector as follows definition 2 for a given arbitrary score vector v the defective score quantity is given as min v w 1 s t w is a qualified pattern of the inclusive chain model 19 observation 1 the defective score quantity has an upper bound g 1 let hs be the event that the defective score quantity of score vector is s and ms is the probability of this event after introducing these additional parameters the inclusive chain model can then be adjusted to incorporate all defective score vectors as follows e h 0 d g 1 i 1 1 b i 0 0 q i i q i g p q i j r i jr i 1 g j i g r 1 q p b i pi i 1 g 1 g 1 i 1 pi 1 q r 1 i jr 1 i 1 g j i g p hs ms s 0 1 g 1 g 1 s 0 ms 1 aicm the above model is referred as the adjusted inclusive chain model aicm author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 15 3 2 1 a theoretical probability guarantee of identifying the order of the inclusive chain model as mentioned at the beginning of section 3 2 a simple sorting method can be used to identify the rank of the candidate locations in g for the aicm we sort the cardinality of subsets v j j g defined as v j k n akj 1 where ak is the score vector of the k th customer participated in the survey and akj is its j th element the following proposition provides a probability guarantee on identifying the order of inclusive chain model given that samples obey the aicm proposition 2 suppose the set of n samples collected from survey follow the aicm let the set of candidate locations be g 1 g let e be the event that the rank of inclusive chain model can be successfully identified by sorting the cardinality of v j j g let p minj g pj if p 1 m 0 m 0 then p e 1 g 1 exp 1 2 n m 0 1 p 1 2 20 proof we first show that with the given assumptions the rank of the inclusive chain model can be identified almost surely as the total number of samples n goes to infinity in the analysis we let be the permutation that gives the rank of locations i e 1 g is the rank of locations from low to high let nj be the number of samples that match with the j th pattern 0 0 q j j q j g based on the probability setting of aicm and the law of large numbers we should have the following asymptotic relation hold nj n m 0 pj a s as n j g 21 this implies that nj 0 almost surely as n by the definition of v j we should have the following bounds for every v j j k 1 nk v j j k 1 nk g 1 s 1 hs j g 22 for any i j satisfying i j it suffices to show that v i v j as n indeed we have v j v i n 1 n j k 1 nk i k 1 nk g 1 s 1 hs 1 n j k i 1 nk g 1 s 1 hs j k i 1 mpk 1 m 0 as n author service center location problem with decision dependent demand 16 informs journal on optimization 00 0 pp 000 000 0000 informs and j k i 1 mpk 1 m 0 mp 1 m 0 0 by assumption therefore the rank of the inclusive chain can be identified almost surely as n goes to infinity now we prove the non asymptotic result note the probability p e can be lower bounded as follows p e p g 1 i 1 v i 1 v i 0 1 p g 1 i 1 v i 1 v i 0 1 g 1 i 1 p v i 1 v i 0 1 g 1 i 1 p n i 1 g 1 s 1 hs 0 since we have n i 1 g 1 s 1 hs n k 1 ik where ik nk 1 are i i d random variables satisfying p ik 1 m 0 pi 1 p ik 0 m 0 1 pi 1 and p ik 1 1 m 0 which gives e ik m 0 1 pi 1 1 0 by assumption let i 1 n n k 1 ik applying hoeffding s inequality gives the following bound p n i 1 g 1 s 1 hs 0 p n k 1 ik 0 p i e i 1 m 0 1 pi 1 exp 1 2 n m 0 1 pi 1 1 2 exp 1 2 n m 0 1 p 1 2 then it follows that p e 1 g 1 exp 1 2 n m 0 1 p 1 2 3 2 2 model fitting and parameter estimation to avoid redundant notations in the fol lowing analysis we assume that candidate locations are ranked as 1 g based on attractability to fit the aicm with samples a likelihood function and some regularity terms need to be estab lished note that without consideration of any regularity all model parameters can be estimated naturally using a frequency count approach based on the given samples for example an empirical estimation of pj can be p j nj n and an empirical estimation of i jr can be i jr n i jr q r 1 n i jr where n i jr is the number of samples that have q i j r however this estimation can lead to overfitting of new samples we now focus on establishing a likelihood function and introduce some regularity terms to prevent overfitting first the parameter ms can be estimated as m s k n k hs n for all s 1 g 1 all defective samples can be further used to estimate other parameters with more information if a sample k is defective it can be converted into a qualified score vector k by imposing a defective score quantity definition 2 to k and hence the original samples k nk 1 can then be converted into a set of qualified score vectors k nk 1 we can evaluate the probability of generating k by the model using the model parameters and denote this probability as p k p then the logarithmic likelihood function of generating k nk 1 can then be formulated as l p 1 n n k 1 logp k p 23 author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 17 note that maximizing the above likelihood function with only probability normalization constraints leads to a frequency estimation of all parameters some regularity terms can be added to balance this trend first for score vectors in the same pattern parameters that lead to smaller variance of score on a given candidate location are preferred and hence the following regularity terms can be added with some regularity coefficients r 1 ij var q i j q r 1 r 2 i jr q r 1 r i jr 2 i 1 g j i g second consider any two consecutive locations j and j 1 in the inclusive chain the two locations are both included in patterns h 1 hj in the pattern hi 1 i j the mean score difference between the two locations is given by wij e q i j 1 q i j q r 1 r i j 1 r i j r for every pattern that contains locations j and j 1 we expect the above mean score difference to be similar to enforce this similarity we can add the following regularity terms with some regularity coefficients r 2 j 1 j j i 1 wij 2 1 j 2 j i 1 wij 2 j 1 g 1 after incorporating the above regularity terms the parameters can be estimated by solving the following constrained minimization problem of the loss function min l p 2 1 g g 1 g i 1 g j i r 1 ij 2 g 1 g 1 j 1 r 2 j 1 n n k 1 logp k p s t q r 1 i jr 1 i 1 g j i g g 1 j 1 pj 1 24 where 1 and 2 are regularity coefficients that can be tuned using a cross validation approach note that we add a negative sign to the logarithmic likelihood function when it is incorporated into the loss function l p notice that 24 is a nonconvex optimization problem with continuous parameters and simple constraints and it can be solved to local optimality very efficiently using numerical optimization solvers author service center location problem with decision dependent demand 18 informs journal on optimization 00 0 pp 000 000 0000 informs 3 3 generation of utility and demand samples guided by aicm once the regression problem 24 is solved to give an estimation of the aicm parameters the aicm can be used to estimate the mean utility value guide the generation of demand samples first the utility value u j the customer site index is ignored since the aicm is established for any given customer site can be estimated as follows u j j i 1 p i q r 1 r i jr 25 where p and are the estimation of aicm parameters generating a number of joint demand samples and use them to construct the ambiguity set can be a challenging problem in practice there are two major obstacles in achieving this a scaling factor since only a limited amount of survey samples are collected how to scale the demand estimation based on the samples to roughly estimate the total demand from a customer site b demand catenation how to catenate the estimated demand samples for each customer site to get joint demand vectors for all customer sites as samples that can be directly input to the ambiguity set we try to give a few guidelines for dealing with these problems in this paper for a the total potential demand from a customer site could be estimated via a different channel which is not the focus of this paper some investigation on the demand estimation and especially the healthcare service demand estimation is conducted in bajari and benkard 2005 cote and stephen 2001 doi et al 2017 griffin et al 2008 the survey of scoring on candidate locations are only used to quantify the attractability of each candidate location that can lead to different estimated demand for different candidate locations when the total potential demand is given in the next paragraph for addressing b we provide a estimation of demand associated with each candidate location based on assuming the total potential demand is n the number of collected samples in the case that we have a separate estimation a can be a random variable of total potential demand the scaling factor can be defined as a n and it can be used to scale up estimated demand associated with different candidate locations in the following discussion for b we assume that the demand samples generated using algorithm 1 2 will be multiplied by the scaling factor could be customer site dependent and omit this factor in these algorithms for b one approach is to assume the distributions of demand di dij j fi for different customer sites i are independent in this case we can generate demand samples for each i and combine them in an outer product manner to construct samples for the random vector d dij i s j fi for example if we have constructed i samples for di which are denoted as d i i then we can get samples for d as d i i i s i i i s in this manner the number of samples for d can be as large as i s i to reduce the sample size for d one can author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 19 select a desired number n of combinations of samples for each di at random another way is to assume the demand from different costumer sites are strongly correlated as a consequence we can divide the samples for each di into several bands according to the magnitude of the demand then we select samples from the same band for different di s to construct a sample for d a possible way of defining the bands can be based on different intervals of quantiles for example one can define bands corresponding to 5 intervals of percentage 0 0 2 0 2 0 4 0 8 1 0 for each di this way of constructing samples scenarios has been used in mehrotra et al 2020 now let us focus on how to generate samples for each di the pseudo code for generating a sample for di is given in algorithm 1 note that by repeatedly call this algorithm one can generate any given number of samples for di a pseudo code for generating a sample for d is given as algorithm 2 algorithm 1 an algorithm for generating a mixed defective sample for di i s following aicm 1 input data score vector samples yi k nk 1 that have been collected from the survey at the customer site i 2 determine the rank of icm based on the score vectors in yi sort the indices in fi from low to high based on this rank 3 based on this rank partition yi into qualified subset y q i of samples and defective subset y d i of samples let nq y qi n d y di and nq nq nd 4 solve 24 to get an optimal estimation of probability parameters denoted as p and substitute p into icm 5 generate n i i d score vectors denoted as k nk 1 such that each score vector is generated using the way given as follows with probability sample k following the fitted icm and with probability 1 sample k uniformly from y di 6 let d ij card k kj 1 for all j fi 7 return the sample d i d ij j fi algorithm 2 an algorithm for generating a mixed defective sample for d following aicm 1 input data 1 same input as algorithm 1 for all i s 2 sample size ni for every i s and n 2 generate ni i i d mixed defective samples for every i s using algorithm 1 3 catenate the mixed defective demand samples d ki ni k 1 over i s either in an independent approach or a strong correlated approach and draw n mixed defective samples d k nk 1 for d 4 return the mixed defective samples d k nk 1 author service center location problem with decision dependent demand 20 informs journal on optimization 00 0 pp 000 000 0000 informs 4 numerical investigation the numerical investigation consists of two major parts the numerical analysis of the aicm and the computational performance of the dro fl model in section 4 1 we provide numerical analysis of the aicm where we simulate certain amount of score vector samples and use them to fit the aicm in section 4 2 we show the computational performance of solving generated instances of the dro fl model and provide sensitivity analysis of the robust optimal locations with respect to the sample size and the choice of radius in the ambiguity set 4 1 numerical analysis of the aicm for the numerical analysis of aicm we focus on a specific customer site with 4 candidate service center locations labeled as l 1 l 4 the rank of attractability is unknown we consider 6 possible scores 0 1 5 we simulate n i i d score vectors with some defected ones and use them to fit the aicm the generation of each score vector is based on the following procedures first we simu late a 4 dimensional real vector v following the gaussian distribution n w with w 1 3 4 5 2 corresponding to the mean score of l 1 l 4 respectively and diag 0 82 1 52 1 1 52 as the covariance matrix next each entry of v is rounded to the closest integer from 0 1 5 finally with probability 0 8 we accept this score vector while with probability 0 2 we randomly select an entry of v set it to be zero and accept the resulting score vector we follow the steps instructed in section 3 2 to fit the aicm an essential step is to solve the nonlinear optimization problem 24 this problem is implemented in julia 1 5 2 bezanson et al 2017 with optimization package jump dev dunning et al 2017 as the modeling interface and ipopt 3 13 2 wa chter and biegler 2006 as the solver for simplicity we let 1 2 in 24 we use a 4 fold cross validation approach to select an appropriate regularization parameter the parameter selection consists of two rounds the first round is a rough selection where the candidate 1 is selected from 0 0 1 0 2 5 based on the out of sample performance suppose 1 is the selected value after the first round in the second round we select an optimal from the set 1 0 01 k k 0 1 10 based on the out of sample performance the out of sample performance is measured by the averaged logarithm of likelihood the first round selection results are given in figure 1 for three different sample sizes n 50 100 200 the second round selection results are given in table 2 from which we see that the optimal is 2 98 2 98 and 0 37 for n 50 100 200 respectively the curves in figure 1 indicate that for a small sample size n 50 a larger regularization parameter lead to a better out of sample performance while for a larger sample size n 200 the best out of sample performance is achieved at a smaller regularization parameter this behavior is intuitive since training the model with a small sample size can lead to over fitting if the model parameters are not sufficiently regularized when more samples are available to train the model the regularization can be less restrictive author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 21 table 1 mean scores for each location at different sample sizes samples loc 1 loc 2 loc 3 loc 4 50 0 83 2 79 3 86 1 67 100 0 88 2 91 3 89 1 87 200 0 87 2 88 3 94 1 78 figure 1 first round of selection table 2 second round of selection n 50 100 200 range 2 9 3 0 2 9 3 0 0 3 0 4 2 98 2 98 0 37 finally we fit the aicm using n samples and the optimal parameter the probability param eters p and from aicm can be used to estimate the probability distribution on scores for each candidate location the results are given in figure 2 for the 4 candidate locations the probability distribution on score values reveal that the rank of attractability from high to low is location 3 location 2 location 4 location 1 which matches with the underline stochastic model that generates the scores the mean scores corresponding to the four locations are given in table 1 4 2 computational performance of the dro fl model we investigate the computational performance of solving numerical instances of the dro fl model to generate numerical instances we create a 100 100 two dimensional square as the map the customer sties are points inside the square and the coordinates of each customer site are uni formly drawn from the range 0 100 2 we let f s which means each customer site can be a can didate location of a service center we sort the set of distances w d i j i s j s i j from small to large and let dc be the 5 quantile of the sorted list for every customer site i we select all customer sites including i that are within dc distance from i to form the set fi we let the utility completely depend on the distance specifically we set uii 5 for all i s we also let the first element in w correspond to utility 5 the last element in w correspond to utility 0 5 and any other elements correspond to utility values obtained using a linear interpolation for a sample the demand d ij is drawn from the normal distribution n 120 uij 12 uij 2 the capacity of each candidate service center is set to be 1000 we assume the cost of opening each service center author service center location problem with decision dependent demand 22 informs journal on optimization 00 0 pp 000 000 0000 informs a probability distribution on scores of location 1 b probability distribution on scores of location 2 c probability distribution on scores of location 3 d probability distribution on scores of location 4 figure 2 probability distribution on scores for each location at different sample sizes is identical an unit cost and the budget b in this case is equivalent to the maximum number of service centers that can be opened we have generated 18 instances of dro fl and each instance is characterized by the number s of customer sites also candidate locations and the budget b number of maximum service centers that can be allocated for each instance we have tried three different sample size options n 100 200 500 and the total variation distance is set to be 0 2 in these calculation the dro fl model is implemented and solved using a gurobi python interface python 3 7 and gurobi 9 0 for every instance the master problem and all scenario sub problems are solved using a single 2 50 ghz cpu the computational results for the 12 instances are shown in table 3 it is shown that all instances have been solved to optimality within 15 master iterations see algorithm 3 the first 9 instances are solved within 120 seconds and large instances are solved within 1 5 hours where the majority of computational time is spent on the scenario sub problems the range of the robust optimal objective is less than 0 7 across author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 23 table 3 computational performance of solving 12 numerical instances of dro fl in all instances the total variation distance for the ambiguity set is set to be 0 2 all instances are solved to optimality n 100 n 200 n 500 s b obj 103 iters t s obj 103 iters t s obj 103 iters t s 20 3 9 60 7 5 2 9 66 6 5 8 9 61 6 10 2 20 5 15 57 9 2 3 15 57 7 4 8 15 6 8 11 2 20 7 22 68 6 1 6 22 55 8 5 1 22 7 12 17 0 40 5 17 52 10 8 2 17 55 11 17 8 17 53 10 43 4 40 10 36 30 12 9 8 36 38 9 15 9 36 34 11 49 7 40 15 54 44 11 9 2 54 46 11 19 1 54 38 12 55 7 60 10 35 74 7 14 6 35 74 8 36 5 35 74 6 67 5 60 15 54 64 8 17 4 54 70 10 46 8 54 70 10 120 2 60 20 67 62 8 20 2 67 70 8 37 8 67 61 7 84 6 80 15 60 62 13 61 3 60 47 7 74 3 60 56 6 158 1 80 20 80 13 9 41 6 80 02 8 79 80 11 6 136 80 25 98 3 14 70 6 98 29 14 127 5 98 38 10 220 5 100 20 78 93 10 92 5 78 90 12 204 3 78 89 7 293 1 100 25 100 69 13 120 100 54 11 185 5 100 53 15 637 6 100 30 117 3 15 143 9 117 16 11 186 3 117 15 15 694 3 200 40 173 24 12 1092 9 173 28 7 1184 173 41 11 4678 1 200 50 215 74 13 1102 2 215 74 15 2549 9 215 78 9 3829 4 200 60 256 8 14 1214 2 256 9 8 1360 1 256 78 13 5515 9 three different sample size options for each instance and we have also observed that the robust optimal solution remains the same for different sample size options we further investigate the impact of the total variation distance d on the robust optimal decision and the objective value in this study we focus on the two instances s b 60 20 and s b 60 10 for a given sample size n with n 100 200 500 we tune the total variation distance d from 0 to 0 4 with an increment 0 05 and investigate the change of optimal objective of dro fl the results are shown in figure 3 obviously the objective should decrease with d as a larger d value can allow the worse scenarios get more weight and hence makes the objective decrease with d increasing from 0 to 0 4 the decrement of the objective is 1 5 1000 units for the case b 20 and 1 9 700 units for the case b 10 the relative decrement is about one magnitude smaller compared to the 10 relative deviation in generating samples for the demand it is also observed that the optimal decision of dro fl does not change with the sample size or the total variation distance 5 concluding remarks the distributionally robust service center location problem investigated in this research possesses decision dependent demand induced naturally from a maximum attraction principle and the num ber of opened service centers in a neighborhood the ambiguity set considered in this work is a decision independent one defined using the total variational distance while many other metics such as the wasserstein distance phi divergences etc can also be applied to define the ambiguity set with minor modification in the formulation the modeling approach in this work decouples the endogenous impact decision dependency and distributional ambiguity as a result the model is author service center location problem with decision dependent demand 24 informs journal on optimization 00 0 pp 000 000 0000 informs a s 60 and b 20 b s 60 and b 10 figure 3 the impact of total variation distance on the robust optimal objective of dro fl highly computationally efficient for mid and large scale instances compared to models with an endogenous uncertainty ambiguity set in practice such decoupling is likely to be more data driven as there is a higher chance to identify data based evidence that supports decision dependent demand than decision dependent uncertainty of demand appendix a cutting plane algorithm for solving dro fl the model dro fl is a special case of the distributionally robust two stage stochastic program with a polyhedral ambiguity set algorithm 3 a cutting plane algorithm for solving dro fl 1 initialization y 0 f n 0 y n 0 f n and solset 2 while y n is not in solset do 3 solset solset y n 4 set n n 1 5 solve the master problem master for iteration n and let y n be the optimal solution 6 evaluate the value function q y n d for each 7 solve the linear program 10 to get the worst case probability measure n 8 add the inequality 11 to master 9 end while 10 set y y n and n 11 return y as the optimal solution and as the optimal objective theorem 2 bansal et al 2018 algorithm 3 terminates in a finite number of iterations and return an optimal solution and optimal objective of dro fl author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 25 acknowledgments the author is grateful to dr liwei zeng for a valuable discussion on getting an interpretation of the model references ahmed s 2000 strategic planning under uncertainty stochastic integer programming approaches ph d thesis university of illinois at urbana champaign urbana il usa albareda sambola m ferna ndez e da gama fs 2011 the facility location problem with bernoulli demands omega 39 335 345 bajari p benkard cl 2005 demand estimation with heterogeneous consumers and unobserved product characteristics a hedonic approach journal of political economy 113 6 1239 1276 bansal m huang kl mehrotra s 2018 decomposition algorithm for two stage distributionally robust mixed binary programs siam journal on optimizaion 28 3 2360 2383 baron o milner j 2010 facility location a robust optimization approach production and operations management 20 5 772 785 basciftci b ahmed s shen s 2020 distributionally robust facility location problem under decision dependent stochastic demand https doi org 10 1016 j ejor 2020 11 002 berglund pg kwon c 2014 robust facility location problem for hazardous waste transportation netw spat econ 14 91 116 bezanson j edelman a karpinski s shah vb 2017 julia a fresh approach to numerical computing siam review 59 1 65 98 url https doi org 10 1137 141000671 chan t shen z siddiq a 2017 robust defibrillator deployment under cardiac arrest location uncertainty via row and column generation operations research 66 358 379 cote m stephen t 2001 four methodologies to improve healthcare demand forecasting healthcare finan cial management 55 5 54 doi s ide h takeuchi k fujita s takabayashi k 2017 estimation and evaluation of future demand and supply of healthcare services based on a patient access area model international journal of environ mental research and public health 14 11 1367 do yen a aras n barbarosog lu g 2012 a two echelon stochastic facility location model for humanitarian relief logistics optim lett 6 1123 1145 dunning i huchette j lubin m 2017 jump a modeling language for mathematical optimization siam review 59 2 295 320 url http dx doi org 10 1137 15 m 1020575 goel v grossmann ie 2004 a stochastic programming approach to planning of offshore gas filed develop ments under uncertainty in reserves comp chem eng 108 1409 1429 goel v grossmann ie 2005 a lagrangian duality based branch and bound for solving linear stochastic programs with decision dependent uncertainty puigjaner l espun a a eds european symposium on computer aided process engineering 15 elsevier science b v https doi org 10 1016 j ejor 2020 11 002 https doi org 10 1137 141000671 http dx doi org 10 1137 15 m 1020575 author service center location problem with decision dependent demand 26 informs journal on optimization 00 0 pp 000 000 0000 informs goel v grossmann ie 2006 a class of stochastic programs with decision dependent uncertainty math program 108 355 394 goel v grossmann ie el bakry as mulkay el 2006 a novel branch and bound algorithm for optimal development of gas fields under uncertainty in reserves comp chem eng 30 1076 1092 gourtani a nguyen td xu h 2020 a distributionally robust optimization approach for two stage facility location problems euro journal on computational optimization 8 141 172 griffin pm scherrer cr swann jl 2008 optimization of community health center locations and service offerings with statistical need estimation iie transactions 40 9 880 892 gu lp nar n pachamanova d c anakog lu e 2013 robust strategies for facility location under uncertainty european journal of operational research 225 21 35 gupta v grossmann ie 2011 solution strategies for multistage stochastic programming with endogenous uncertainty comp chem eng 35 2235 2247 li y shu j song m zhang j zheng h 2017 multisourcing supply network design two stage chance constrained model tractable approximations and computational results informs journal on com puting 29 2 287 300 lim mk bassamboo a chopra s daskin ms 2013 facility location decisions with random disruptions and imperfect estimation manufacturing service operations management 15 2 239 249 louveaux fv peeters d 1992 a dual based procedure for stochastic facility location operations research 40 3 564 573 luo fq mehrotra s 2019 a distributionally robust service center location problem with decision dependent utilities tech report northwestern university luo fq mehrotra s 2019 b service center location problem with decision dependent utilities https arxiv org pdf 1910 09765 pdf luo fq mehrotra s 2020 distributionally robust optimization with decision dependent ambiguity set optimization letters 14 2565 2594 mehrotra s rahimian h barah m luo fq schantz k 2020 a model of supply chain decisions for resource sharing with an application to ventilator allocation to combat covid 19 naval research logistics 67 5 303 320 murali p ordo n ez f dessouky mm 2012 facility location under demand uncertainty response to a large scale bio terror attack socio economic planning sciences 46 78 87 nohadani o roy a 2017 robust optimization with time dependent uncertainty in radiation therapy iise transactions on healthcare systems engineering 7 2 81 92 nohadani o sharma k 2018 optimization under decision dependent uncertainty siam journal on opti mization 28 2 1773 1795 https arxiv org pdf 1910 09765 pdf https arxiv org pdf 1910 09765 pdf author service center location problem with decision dependent demand informs journal on optimization 00 0 pp 000 000 0000 informs 27 noyan n rudolf g lejeune m 2017 distributionally robust optimization with decision dependent ambiguity set http www optimization online org db file 2018 09 6821 pdf royset jo wets rjb 2017 variational theory for optimization under stochastic ambiguity siam journal on optimization 27 2 1118 1149 shao h lam whk tam ml 2006 a reliability based stochastic traffic assignment model for network with multiple user classes under uncertainty in demand netw spat econ 6 173 204 snyder lv 2006 facility location under uncertainty a review iie transactions 38 537 554 spacey sa wiesemann w kuhn d luk w 2012 robust software partitioning with multiple instantiation informs j comput 24 3 500 515 tarhan b grossmann ie 2008 a multistage stochastic programming approach with strategies for uncer tainty reduction in the synthesis of process networks with uncertain yields comp chem eng 32 766 788 tarhan b grossmann ie goel v 2009 stochastic programming approach for planning of offshore oil or gas field infrastructure under decision dependent uncertainty ind eng chem res 48 3078 3097 tarhan b grossmann ie goel v 2013 computational strategies for non convex multistage minlp models with decision dependent uncertainty and gradual uncertainty resolution ann oper res 203 141 166 tsur y zemel a 2004 endangered aquifers ggroundwater management under threats of catastrophic events water resources research 40 w 06 s 20 vayanos p kuhn d rustem b 2011 decision rules for information discovery in multi stage stochastic programming 50 th ieee conference on decision and control and european control conference cdc ecc viswanath k peeta s salman fs 2004 investing in the links of a stochastic network to minimize expected shortest path length technical report purdue university wa chter a biegler lt 2006 on the implementation of a primal dual interior point filter line search algorithm for large scale nonlinear programming mathematical programming 106 1 25 57 wang q batta r rump cm 2002 algorithms for a facility location problem with stochastic customer demand and immobile servers annals of operations research 111 17 34 http www optimization online org db file 2018 09 6821 pdf 1 introduction 2 problem formulation 2 1 a deterministic model 2 2 some remarks on the model 2 3 a distributionally robust two stage stochastic extension 2 4 a single stage reformulation of dro fl for the uncapacitated case 3 a statistical model for utilities and demand estimation 3 1 an inclusive chain representation of the maximum attraction principle 3 2 an adjusted inclusive chain model for incorporating defective score vectors 3 2 1 a theoretical probability guarantee of identifying the order of the inclusive chain model 3 2 2 model fitting and parameter estimation 3 3 generation of utility and demand samples guided by aicm 4 numerical investigation 4 1 numerical analysis of the aicm 4 2 computational performance of the dro fl model 5 concluding remarks