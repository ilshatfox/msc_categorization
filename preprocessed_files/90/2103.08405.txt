a machine learning approach to itinerary level booking prediction in competitive airline markets daniel hopman ger koole and rob van der mei march 16 2021 abstract demand forecasting is extremely important in revenue management after all it is one of the inputs to an optimisation method which aim is to maximize revenue most if not all forecasting methods use historical data to forecast the future disregarding the why in this paper we combine data from multiple sources including competitor data pricing social media safety and airline reviews next we study five competitor pricing movements that we hypothesize affect customer behavior when presented a set of itineraries using real airline data for ten different od pairs and by means of extreme gradient boosting we show that cus tomer behavior can be categorized into price sensitive schedule sensitive and comfort ods through a simulation study we show that this model produces forecasts that result in higher revenue than traditional time se ries forecasts keywords demand forecasting effects of competition traditional statis tics machine learning 1 introduction and motivation our definition of rm is the process of dynamically assigning capacity to products of perishable nature with a fixed total capacity in practice this means determin ing what booking classes should be open for what origin and destination od pair such that the overall network revenue is maximized for this optimisation process we need the airline s own demand forecast fares and capacity traditionally it was thought it was sufficient to segment a market by whether a customer is a business or leisure passenger an example of this can be found in fare rules since the inception of pricing the saturday rule has been used this rule says that a customer has to stay at least a saturday night before returning to their origin business travellers want to spend their weekends at home while leisure passengers do not mind spending a saturday night teichert et al 40 however show that this type of segmentation is not suf ficient they find customers that travel in business class for non business rea sons and customers in economy class travelling for business reasons instead they define five different segments efficiency comfort price price performance and all round performance moreover they find that it is difficult to segment customers but rather trips should be segmented for example someone that travels for business may not be price sensitive but when this same individ ual travels for leisure they are as the industry has changed whether it is 1 ar x iv 2 10 3 08 40 5 v 1 m at h o c 1 5 m ar 2 02 1 through deregulation or through the advances in data capture and analytics segmentation on the other hand has not modelling customer behavior is complicated and there are many reasons for this first everyone is different everyone prioritizes aspects differently second not everyone acts rational while it is impossible to model these characteristics it is important to gain an understanding of underlying processes this can help us understand why people make certain decisions in this paper we investigate the effects of competition on booking behavior in order to make itinerary based booking predictions we do so by combining several data sources an overview of these data sources is given in the next section using these data sources we engage in feature engineering next we divide these features into those that are airline specific for example safety record while others are itinerary specific for example departure time the objective of this paper is to build a model that given a set of itineraries to predict what itineraries will be purchased armed with this data airlines can then use this as a strategic tool to increase their demand we consider reviews of a well known airline review website this dataset consists of the actual review text as well as ratings given by the user to the seat in flight entertainment ife meal crew and ground service next we analyze the last 10000 tweets of the airlines that appear in this article based on these two sources we perform sentiment analysis another vital dataset gave us access to historical pricing information for a given od this dataset captures the price for every airline for every departure date at every day before departure dbd visually these curves not only tell us what the price was at what point in time before departure we can also inspect whether airlines react to each other s price change we were given access to a data source that includes information about the airline such as fleet size fleet age and total aircraft worth we also have access to an airline safety index lastly we have od specific characteristics these are features engineered from the ota s search results features include whether this od has a day flight whether there is a direct flight the time of the first departure of the day the time of the last departure of the day the number of frequencies the mini mum connection time and the minimum travel time flying time connection time this paper is organized as follows a literature review is conducted in section 2 we provide an overview of the data used for our work in section 3 our approach to this problem is discussed in section 4 before modelling is covered in section 5 we review the model s performance in section 6 a discussion of our work and directions for further research are given in section 7 in the appendix in section 8 we show all engineered features its source and calculation 2 literature review beckmann 3 provides the first framework of rm in this work published in 1958 he claims that reservations are a form of rationing and argues that pricing is a direct result of competition beckmann followed by littlewood 30 are widely credited as being the first to describe the process of optimisation in what follows we separate between findings from surveys and underlying processes 2 modelling through statistical methods and modelling through machine learning techniques surveys and background in this section we provide an overview of surveys and the background of the decision making process for bookings these surveys are conducted in different countries and aim to illustrate the rationale behind making a booking the importance of loyalty programmes is also discussed other industries including hospitality are also discussed woodside and macdonald 45 provide a frame work for the decision and find that the decision of travelling to the destination was made on a separate day than travel plans to that destination were made this delay in decision making is discussed in 21 the concept of loyalty in the aviation and hospitality industry is very important the behavior of loyal customers is studied by dolnicar et al 13 they show that customer satisfac tion was not a driver to airline loyalty they also note that this conclusion only applies for business travellers and claim it is difficult to model this for leisure travellers dowling and uncles 14 investigate whether loyalty programmes are a driver for success and find any benefits are quickly overshadowed by compe tition sandada and matibiri 39 study the service quality and presence of a frequent flyer programme in the airline industry in south africa and find that customer satisfaction and a frequent flyer programme result in customer loyalty the differences between full service legacy and low cost airlines is discussed by koklic et al 27 they show that staff positively influences satisfaction and satisfaction positively influences the likelihood of a customer returning tsikriktsis and heineke 41 discusses the impact of customer dissatisfaction in the domestic us airline and find evidence that service delivery should be impor tant to an airline not just wanting to be the cheapest park et al 36 go one step further and show that that in flight service convenience and accessibility were each found to have a positive effect on airline image carlsson and lofgren 7 study the domestic market of sweden over a time period of ten years and discuss the cost of a customer churning and show that not every frequent flyer programme is perceived of the same value the domestic market of india was discussed by khan et al 24 and they show that the gap between expectations and perception is of greater importance than the actual product offered atalik and arslan 2 study the the turkish market it was found that flight safety was rated highest followed by on time performance staff and image of the air line only after these variables the price of the ticket was listed in terms of importance cho 10 studies the domestic united states us market through surveys he shows that not only choice of airline but also choice of airport mat ters when considering different options baker 12 studies the same domestic us market and investigates the difference between legacy and low cost carriers through data of fourteen us airlines baker shows that perceived service qual ity of low cost airlines is higher than those of legacy airlines keiningham et al 23 discuss the effect of service failures on the future behavior of customers in the domestic us market they show that major accidents that cause injuries or fatalities did not show any impact on customer satisfaction while minor incidents such as baggage delays greatly negatively influence future customer satisfaction customer choice in the nigerian market is studied by adeola and adebiyi 1 and they find that the fare is the most important factor khan and 3 khan 25 discuss the market in pakistan they show that customer assurance and empathy factors have the largest weights hussain et al 22 study the united arab emirates market and in particular how service quality affects cus tomer booking behavior they show customer expectations has a direct impact on perceived quality but not customer value law 28 investigates the thai travel market and find that price is the main driver followed by schedule the indonesian market is explored by manivasugen 32 in this research he asked 140 students about their travel preferences the most important factors when deciding between airlines were identified as price comfort safety schedule and airline image the growth of the air transport industry as a whole is discussed by bieger et al 4 it is concluded that ticket price is most important for both economy and business class passengers poelt 37 mentions how traditionally airlines segment customers between leisure and business customers teichert et al 40 show why traditional segmentation both for marketing and optimisation purposes is no longer sufficient the hospitality industry has many similarities with the aviation industry especially in terms of rm a customer is given a number of choices each with a different quality of service a customer needs to decide what is the best value proposition for them verma and plaschka 42 show that personalized on demand service and brand image are found to be most important brunger 6 investigates the internet price effect and shows that this effect represents 3 to 8 in terms of fare value this reinforces the need to include distribution channel in the definition of rm which we discuss in 19 traditionally it was thought that customers purchasing tickets in premium first and business class cabins have a different thought and decision making process than customers in economy class cabins boetsch et al 5 shows that brand image is more important than both sleep quality flat seats and price paid modelling through statistical methods in this section we discuss the modelling of demand forecasts through statistical models the majority of these methods are based on multinomial logit models coldren et al 11 study the classification of itinerary through a multinomial logit mnl model in the us domestic market vulcano et al 43 study the feasibility of customer choice modelling and the effects of customer choice rm over traditional rm lucchesi et al 31 evaluate customer preferences for a domestic route in brazil and try different logit methods milioti 33 does not use a mnl approach but rather a multivariate probit model out of those passengers that are not price sensitive they find that men and business travellers are least likely to be influenced by the level of airfare chen et al 9 argue that the level of service is hard to quantify words such as good or bad to describe service quality are ambigious and use fuzzy logic ratliff and gallego 38 use customer choice modelling for a different application they introduce a decision support framework for evaluating sales and profitability impacts of fare brands by using a customer choice model airlines only observe bookings if tickets are available for sale once the airline stops selling tickets every demand request is rejected estimating this true demand is the process of unconstraining or uncensoring haensel and koole 17 use a statistical way 4 to estimate unconstrained demand and use real airline data from an airline in the netherlands modelling through machine learning in this section we give an overview of the research of modelling demand and making predictions through machine learning mottini and acuna agost 34 expose the drawbacks of using a statistical model specifically the mnl logit model which was outlined in section 2 in a similar way lhertier et al 29 discuss itinerary choice modelling they categorize two kinds of features features that describe the individual which they call characteristics and features that describe alternatives which they call attributes and compare mnl with other methods they show a random forest outperforming a mnl model gunarathne et al 16 show the effects of social media on the service levels of the industry they find that the number of followers offensive language used and mention of a competing airline positively influence an airline s response time to an enquiry cancellations are modelled through machine learning by hopman et al 18 they use a combination of traditional statistics and machine learning in particular extreme gradient boosting based on features of competition schedule price safety and service quality 3 data overview in this section we provide a brief overview of the data sources we used 3 1 online travel agent ota dataset this data source contains both search queries and bookings made by customers customers on this website are tracked through cookies as well as through their accounts if they are logged in in this paper we only look into actual bookings made so we omit details of search queries a sample of the dataset is shown below od airline id dep day id dbd dep time mam travel time price ams lhr 4 3063 119 1305 4 33 173 92 ams lhr 4 3213 3 465 2 86 225 46 ams lhr 4 3444 101 870 7 96 178 81 ams lhr 1 3448 83 420 6 82 228 74 ams lhr 2 3481 33 805 0 9 363 20 ams lhr 3 3621 40 1265 0 9 425 37 ams lhr 4 3625 98 420 5 81 132 23 ams lhr 3 3677 100 835 0 9 453 85 ams lhr 3 3966 47 865 0 9 140 14 ams lhr 2 3966 47 440 0 9 277 91 table 1 sample of booking dataset as we see from table 1 we are given itinerary details of bookings for storage purposes this company does not store competitor offerings that were not booked 5 while the true dataset contains the actual airline name departure date and other revealing details this ota asked to obfuscate airline names and dates for this study as they consider it sensitive information 3 2 competitive pricing the data supplied here contains the historical price for every itinerary offered by every airline this data is similar in terms of dimensions of the data given in section 3 1 but contain pricing information of all itineraries not just the one that were purchased an example of this dataset is given below in table 2 od airline id dep day id dbd dep time mam travel time price fra syd 1 946 6 1220 13 24 605 73 fra syd 2 946 6 1200 15 83 416 74 fra syd 3 946 6 445 12 95 336 32 fra syd 4 946 6 455 12 65 719 43 fra syd 5 946 6 800 13 72 634 05 fra syd 6 946 6 815 10 5 795 12 fra syd 7 946 6 445 15 41 564 63 fra syd 8 946 6 1290 14 99 677 94 fra syd 9 946 6 800 14 75 582 23 table 2 example of competitive pricing data note that the data in table 2 greatly enriches the data from the previous section for every booking made we now know how each competitor s schedule and price compared naturally the fare in this dataset should in theory match with the fare that is associated with the booking for the vast majority of the bookings 93 of our dataset is within 1 this is the case we refer to the reader to figure 1 we review this in our discussion section figure 1 fare errors in our dataset 6 we used the same encoding for obfuscating the airline names and dates to make comparing fares fair we always use the fares from this dataset even though it is given for bookings in our other dataset 3 3 airline ratings the website we used for our data contains reviews on airlines people are given the opportunity to write a free text review as well as rate their trip based on several characteristics shown below id airline rec review fb ground ife crew seat value wifi 1 5 n 2 3 3 2 1 4 1 2 1 n 2 2 2 1 1 3 2 3 2 y 3 4 4 3 4 4 5 4 4 y 5 4 5 5 5 5 4 5 5 y 2 2 3 5 4 4 4 table 3 airline review dataset we have omitted the review text to save space rec is short for recommended passengers rate their airline based on a general recommendation their f b offering the service on the ground the in flight entertainment ife the qual ity of the seat value for money and wifi performance they also have the possibility to write a free text review 3 4 twitter sentiment we were given access to the past year s worth of tweets of the airlines present in our data this dataset required a lot of preparing we left out retweets rts replies and we only focused on reviews written in english retweets were left out to avoid duplicates records and create a bias towards sentiment replies most often by the airline are not representative of an individual s perception and for this reason these were left out finally we only focuses on reviews written in english since these would not require translation translating tweets from other languages may lose the impact they had in their native language 3 5 airline safety ratings this website provides an index for airline ratings it uses accident and incident history environmental factors and operational risk factors to derive a safety score a sample of this data is given in table 4 rank airline code score 1 cx 0 005 2 nz 0 007 3 hu 0 009 4 qr 0 009 5 kl 0 011 table 4 airline safety index 7 3 6 fleet information this dataset contains information on the airline s fleet it contains several prop erties of an airline s fleet such as size and cost while not always correct we aim to use the average fleet s age as a proxy for a comfort rating newer aircraft are typically quieter and provide better entertainment similarly we intend to use the fleet size as a proxy to how well passengers are accommodated when irregular operations happen if an airline only has a handful of aircraft and a flight gets cancelled it is likely a passenger will endure long delays an example of this data is shown in table 5 airline id aircraft aircraft cost aircraft registration aircraft age 1 77 w 300 ph abc 8 8 1 77 w 300 ph xyz 12 2 table 5 fleet information example in table 5 we show the airline id again obfuscated to anonymize the data the iata aircraft code for example 77 w represents a boeing 777 300 er its obfuscated registration and aircraft age in years 3 7 data overview in this section we provide a few characteristics of our dataset table 6 shows the number of competitors by od this is not an exhaustive list of all airlines that sell this od rather it is a list of airlines that sold this od in our dataset ams dxb ams lhr ams syd cdg syd fra syd fra kul fra syd kul sin lhr jfk lhr syd 7 4 5 4 9 6 5 2 2 5 table 6 number of competitors by od figure 2 shows the demand sum of bookings of competitors by od note not every airline is operating every od for example it is unlikely that an airline operating kul sin will also operate lhr jfk figure 2 demand by od and competitor figure 3 illustrates the average travel time in hours by airline by od 8 figure 3 travel time by od and competitor taking a look at ams lhr the big difference can be explained by the fact that airline 2 and 3 offer a direct flight between these airports while airlines 1 and 4 offer connections resulting in longer average travel times note that for lhr syd the small difference in travel times across airlines even though there are five competing airlines in this od each with their own hub and a thus a different way to fly the resulting travel time is quite similar 4 approach in this section we will illustrate the approach we have taken first we reiterate the objective in section 4 1 next in section 4 2 we discuss the features we have engineered 4 1 objective consider an itinerary with features as described in the previous section the objective is to determine whether an itinerary will be purchased we will use extreme gradient boosting to build this binary logistic model after all an itinerary is purchased yes or no note that this is different from typical choice modelling in that case the objective is given a set of alternatives what option a customer is most likely to purchase our objective goes beyond that we look at the features of an individual itinerary to determine whether this will be purchased since we suspect that behavior will be different across ods we suspect we cannot compare a short haul to a long haul od or a business heavy to a leisure heavy od we build a separate model for every od 4 2 feature engineering arguably the most important step in building the model is the process of fea ture engineering feature engineering involves constructing novel features from given data driven by domain knowledge developed over time with the goal of improving predictive learning performance 26 in this section we follow the same structure as in the data overview section section 3 and will review our feature engineering 9 4 2 1 ota dataset from this dataset we construct the following airline od specific features 1 number of unique itineraries offered 2 minimum maximum and average flying time 3 minimum maximum and average travel time flying time connection time 4 is an evening departure offered boolean if there is an itinerary departure time after 6 pm 5 departure time of first flight of the day first sector in minutes after midnight 6 departure time of last flight of the day first sector in minutes after midnight 7 arrival time of first flight of the day first sector in minutes after mid night 8 arrival time of last flight of the day first sector in minutes after midnight 9 is a direct flight offered boolean true if and only if there is an itinerary with one sector next we derive the following itinerary specific features 1 flying time in hours 2 travel time in hours 3 morning afternoon or evening departure time departure time for the first sector before 9 am before 6 pm or after 6 pm respectively 4 morning afternoon or evening arrival time arrival time for the first sector before 9 am before 6 pm or after 6 pm respectively 5 wide body or narrow body aircraft used 6 night flight boolean if departure time is before midnight and arrival time is after midnight both in local timezones 4 2 2 competitive pricing using this dataset we derived features that measure current and rolling window price movements in the example that follows we look into the calculation of pricing features for airline 1 for 100 days before departure the features compare this airline s pricing against the cheapest airline in the market dubbed yy and second cheapest airline in the market dubbed xx we use this terminology since airline codes typically consist of two characters table 7 shows a subset of fares for four different airlines at specific times before departure 10 time airline 1 fare airline 2 fare airline 3 fare airline 4 fare 103 450 600 500 1000 102 475 600 500 1100 101 450 625 360 1100 100 450 750 500 300 table 7 example of fares time airline 1 fare yy fare xx fare is cheapest yy fare difference xx fare difference 103 450 450 1 500 3 y 0 50 102 475 475 1 500 3 y 0 25 101 450 360 3 450 1 n 90 0 100 450 300 4 450 1 n 100 0 table 8 step 1 calculation of fare difference the number between parentheses indicates what airline this fare belongs to table 8 shows how we first calculate the yy and xx fare this is simply the cheapest and second cheapest fare note that the parentheses indicate what airline offers that specific fare our first engineered feature is is cheapest which is a boolean and is true if the airline s fare equals the yy fare note that you can have multiple airlines that are cheapest if they have the same fare next we calculate the difference between the airline and the yy and xx fares time mean 3 d yy mean 3 d xx farediff 100 0 0 90 3 30 50 25 0 3 25 450 360 90 table 9 step 2 feature engineering table 9 then illustrates how these features are calculated note that the mean 3 dyy and mean 3 dxx fares indicate the average difference in fares over the past three days while farediff is a snapshot feature that only measures the difference at only one particular day t 100 apart from calculating the mean we also calculate the standard deviation we repeat this process for a 7 14 and 28 rolling window as a result we will have the following features 1 mean 3 dyy sd 3 dyy mean 3 dxx sd 3 dxx 2 mean 7 dyy sd 7 dyy mean 7 dxx sd 7 dxx 3 mean 14 dyy sd 14 dyy mean 14 dxx sd 14 dxx 4 mean 28 dyy sd 28 dyy mean 28 dxx sd 28 dxx 5 farediff 6 is cheapest 11 airline rec review f b ground ife crew seat value wifi obs 1 0 89 6 52 4 19 4 18 3 6 4 65 3 8 4 1 2 6 79 2 0 52 5 84 3 22 3 04 2 79 3 64 3 25 3 25 2 66 638 3 0 74 6 21 3 62 3 77 4 44 3 73 3 97 3 75 3 63 221 4 0 6 5 63 3 15 2 94 3 29 3 37 3 31 3 06 3 2 87 5 0 89 6 35 3 84 3 89 3 35 4 19 3 86 4 2 2 67 71 table 10 example of airline ratings 4 2 3 airline ratings from our dataset we derived median values for the characteristics as well as counted the observations these are given in table 10 some reviews contain what route the reviewer flew ideally one would only look into reviews that match the od we are studying however the resulting number of reviews are too low to be reliable measures for aggregates for this reason we have chosen to take aggregates across airlines note in table 10 that there is no od present we review this decision in our discussion table 10 shows whether passengers recommend this airline as well as the median scores for the onboard f b the service provided on the ground the ife the crew quality of the seat value for money and wifi the obs column show how many reviews we collected the value under review is constructed using sentiment analysis we do this as follows the free text of all reviews are read into r each review is converted into a long 1 n vector by splitting the review each element in the vector will have a single word first stop words and punctuation are removed the text is converted to lowercase this vector may then be joined with the afinn dataset the afinn dataset 35 was created by nielsen containing 1468 unique words that nielsen manually labeled with a score between minus five highly negative and plus five highly positive next we simply take the mean over this list of scores to determine how positive or negative a review was and scale this value between 0 and 10 an example of the afinn dataset is shown in table 11 word score amazing 4 breathtaking 5 disaster 2 distrust 3 excellence 3 fraudsters 4 limited 1 misleading 3 table 11 afinn subset sample 4 2 4 twitter sentiment after removing quotes retweets special characters among other things we fol lowed the same procedure as for airline ratings reviews we matched every word 12 in the tweets with the afinn list then took an average of these scores to get a rating by tweet we aggregated these individual reviews by taking the median of each tweet s rating to obtain a score by airline then scaled it to a value be tween 0 and 10 just like for airline ratings we were unable to obtain scores by od we were unable to derive from the tweets what od passengers were flying an example of this dataset is given in table 12 airline id twitter sentiment 1 6 32 2 4 22 3 7 02 4 6 49 5 7 21 table 12 twitter sentiment scores by airline 4 2 5 airline safety ratings we did not engineer any features instead we used the score provided to us 4 2 6 fleet information for fleet information we derived the following airline specific features 1 fleet size number of aircraft 2 fleet cost sum of aircraft cost list price 3 fleet age median of aircraft age an example of these features is shown in 13 airline id fleet size fleet cost fleet median age a 226 42343 11 19 b 268 54130 11 67 c 249 85298 6 15 table 13 fleet information example in table 13 we have used a different airlineid as in previous sections as there are ways to trace the actual airline s name using these characteristics 5 modelling having engineered features we will predict whether a given itinerary is pur chased to accomplish this we will use extreme gradient boosting 13 5 1 extreme gradient boosting in this section we provide a brief overview of extreme gradient boosting xgb for a full introduction of xgb we refer the reader to chen et al 8 in what follows we provide a short alternative brief suppose we have an input xi and an output yi we would like to make a prediction denote this by y i an example of estimating yi is given in equation 1 y i j 1 jxij 1 this of course is simple linear regression we omit a constant and standard error in this case yi is expressed as a linear combination of explanatory vari ables denoted by xi the objective is to estimate those j that minimize an error measure we typically want to minimize some error measure denoted by om depending on a model m a natural selection of an objective function is an error measure om j 1 yi y i 2 2 this is known as the root mean squared error rmse extreme gradient boosting is a tree boosting algorithm the method works in a similar fashion first specify how our predictor is expressed in terms of fea tures like 1 next specify an objective function comparable to 2 finally iterate to find the optimal value consider the following objective function oxgb l 3 in equation 3 the first term l is the loss function typically r mse is used the second term is the regularization term this term measures the complexity of the model and helps us control overfitting let fk xi be a function that takes a set of input parameters xi as before and return the score of xi in tree k k 1 k suppose we have m different features in xgb we assume that y i k k 1 fk xi 4 that is the prediction for yi y i is the sum of linear combination of the score in each tree let t be the number of leaves in a tree and wi the weight of leaf i assume that we have m features therefore our input xi is a m dimensional vector introduce a function q xi which takes an input xi and follow the rules of the decision tree to map it to the leaves specifically q xi rm t the prediction is then given by this function q xi weighted by the weights of the leaves denoted by wi therefore f xi q xi wi 14 since xgb is an iterative method there is no static objective function as in equation 2 similarly the prediction of yi at time t is given by the previous value of y represented as yti plus the score of xi in our new tree y ti y t 1 i ft xi 5 suppose now we have a generic loss function l some choice for l as we intro duced in 3 in this case we have otxgb n i 1 l yi y t 1 i ft xi fk 6 xgb uses a second order taylor expansion to approximate this function l recall that the taylor expansion of f x at x a up to the second degree is given by f x f x a f x a 1 x a f x a 2 x a 2 7 deciding to use the mse for our generic function l our objective function oxgb at time t is equal to otxgb n i 1 yi y t 1 i ft xi 2 fk 8 n i 1 2 y t 1 i yi ft xi ft xi 2 fk 9 the term that remains is fk as we discussed above this term is impor tant but often forgotten and helps us control the complexity of the models by penalizing large models in xgb this function is defined as follows fk t 1 2 n i 1 wi 2 10 in the regularization shown in 10 is threshold of reduction in the loss function for xgb to further split a leaf smaller values will make xgb split more leaves therefore generating a more complex tree structure while larger values will limit the number of leaves we chose 0 25 on the other hand penalizes on large values of wi intuitively this is an appealing property it encourages xgb to use all of its inputs a little bit rather that some of its inputs a lot the choice of is defined by the user in our work we chose 1 other parameters are investigated in section 5 2 5 2 selecting parameters learning rate the learning rate is the shrinkage used the shrinkage factor is a way to slow down the incremental performance gain of a new tree being added to the en semble a smaller learning rate means the model will take longer to run but is less likely to overfit we try values of 0 01 0 02 0 1 15 number of decision trees nt the number of decision trees specifies how many trees can be used until we stop optimizing in practice this number is typically relatively low 1000 or less depending on the model size and is a direct result of how the algorithm works more specifically it is the result of how fast errors are being corrected a new boosted tree model is constructed based on errors of the current tree we therefore expect to see diminishing returns let nt be the number of trees we can use we perform a grid search over values of nt 50 100 500 depth of the tree dt this parameter specifies how many layers a tree may have intuitively a small number of layers in a tree do not capture enough details about the data to be a good descriptor on the other hand a tree with too many levels may be overfitting the dataset let dt be the depth of the tree we will evaluate values of dt 3 4 20 subsample st subsample represents the percentage of the number of observations chosen to fit a tree taking out too much data means the model will run faster after all less fitting needs to be done but taking not enough data may expose us to overfitting let st be the proportion of data used to fit a tree then we will try st 0 2 0 3 1 number of features used per tree ft in the dataset each row represent an observation every column contains a feature the xgb algorithm samples the number of columns in building a new tree using all columns for every tree may lead to overfitting but also makes the problem slower to solve we present the results in section 6 more specifically in section 6 4 we will review the influence of each of these parameters for the different ods 5 3 performance suppose we have the following generalized linear model that is used to make a prediction for a value yi y i j wjxij 11 in our dataset we have an exhaustive list of options offered by the most popular airlines on this route we know what itinerary was purchased this will be our label as a result we have a logistic binary objective function yes or no the extreme gradient boosting algorithm will return a probability of pur chase between 0 and 1 to obtain a yes no label we round the probability to the nearest integer we used the r implementation of the widely used xgboost package specifically version 0 72 we used a maximum tree depth of 20 and used 10 passes iterations of the data 16 figure 4 rmse error improvement by iteration figure 4 shows the rmse by iteration note from this graph that the rmse decreases quickly we show that the number of passes chosen 10 is sufficient to obtain sufficiently close to optimal performance while making sure runtime is acceptable 5 4 runtime the xgb model performance is excellent in terms of runtime we record an average of 11 9 seconds across the 10 ods we consider on the other hand the feature engineering process takes a significantly longer amount of time this involves a series of expensive operations on the dataset calculating the pricing features in particular involves joining a dataset on itself this was done in memory in r despite this the entire process from loading data to the actual engineering of features took an average of 23 minutes per od this is important metric since frequent forecasting and reoptimisation discussed in 20 is important in practice 6 results 6 1 comparison with logistic regression in this section we compare the performance of the proposed model against the logistic regression model the results are shown in table 14 note that the model is biased against predicting a non purchase since the majority of itineraries are never purchased we therefore omit true negatives from our performance metric and study the proportion of false negative false positive and true positive predictions 17 classification false negative false positive true positive od method logit xgb logit xgb logit xgb ams dxb 0 55 0 34 0 05 0 19 0 39 0 47 ams lhr 0 40 0 26 0 10 0 18 0 50 0 56 ams syd 0 63 0 11 0 05 0 06 0 32 0 83 cdg syd 0 39 0 09 0 10 0 06 0 51 0 86 fra syd 0 24 0 17 0 07 0 13 0 69 0 70 fra kul 0 36 0 23 0 11 0 19 0 53 0 58 fra syd 0 80 0 10 0 04 0 06 0 16 0 83 kul sin 0 09 0 07 0 00 0 02 0 90 0 91 lhr jfk 0 39 0 20 0 10 0 17 0 51 0 62 lhr syd 0 63 0 10 0 05 0 06 0 32 0 84 table 14 comparison of false negatives false positive and true positives for the logistic regression logit and xgb model bolded values represent the better value table 14 shows the performance by od the numbers in bold face compare the logit and xgb model by prediction type and highlight the better value first let us consider the false negative the xgb model outperforms the logit model for every od the differences range from 0 02 for kul sin to 0 7 for fra syd we suspect that the logit model for the kul sin od performs relatively well since the number of competitors is low namely 2 and seems to be driven by a single feature which we will discuss in section 6 3 reviewing the false positives there is only one od in which the number of false positives are lower for the xgb model the differences range from outperforming logit by 4 to 14 more false positive predictions for ams dxb comparing these false positives to false negatives the results seem to indicate that the logitistic regression model is biased toward predicting false negatives while the xgb model is biased toward predicting false positives however most interesting are the true positives in all cases the xgb model outperforms the logit model this seems to illustrate the need for a more advanced method than simple logistic regression the differences in performance range from 1 on the kul sin od to 67 on fra syd for fra syd note that the number of false negatives is almost equivalent to the number of true positives in fact the performance gains on most syd ods are impressive 51 for ams syd 15 for cdg syd and 52 for lhr syd 6 2 overall performance as before it should be noted that only 20 3 of all options displayed were purchased for this reason to study the effectiveness of our model we disregard true negatives the percentages in what follows are calculated by comparing the element against true positives false negatives and false positives this is shown in figure 5 18 figure 5 model performance by od note the difference in performance between ods for example for ams dxb we note a relatively high rate of false positives and false negatives our initial hypothesis was this is caused by the number of competitors the more options presented to the customer the more dispersed the data and therefore the more mistakes we can make however from table 6 we note that this is not the case for example consider the ams dxb with ams lhr ods these have respectively seven and four competitors however the number of false negatives and false positives in terms of percentage for ams lhr is barely different now compare lhr jfk with kul sin both of these ods have two competitors but the model performs much better for the latter od we have therefore evidence which may suggest that the lhr jfk market is one that has more dynamics than the kul sin market overall the results across ods are very positive this is illustrated by the median percentage of 84 5 the best performing od is kul sin with a score of 93 4 closely followed by the syd ods ams lhr and ams dxb with 66 5 and 58 1 respectively score worst complete confusion matrices are show in the appendix out of all ods we feel that the ams dxb case is the most worrying comparing 1769 true positives with 1275 false negatives the model severely underestimates the total number of bookings these ratios are much lower for other ods 6 3 customer behavior in our opinion the more interesting topic is what features drive booking behav ior we refer the reader to figure 6 this figure shows by od the gain of each feature we exclude any features with a gain smaller than 0 05 19 figure 6 gain of features by od sorted by importance from left to right we note three very different behaviors price sensitive ods od pairs that are predominantly affected by price departure time sensitive ods those od pairs that are driven by schedule and comfort ods od pairs for which pas senger comfort is important these are discussed in sections 6 3 1 6 3 2 and 6 3 3 respectively 6 3 1 price sensitive ods for these ods the pricing features dominate booking behavior interestingly for ams dxb the features of how the airline moves against the cheapest and second cheapest airline in the market is dominant the actual price difference to 20 that cheapest airline is not therefore it is safe to assume that customers are set on booking with a particular airline but monitor how this preferred airline is pricing itself against those cheaper airlines this observation underlines the difference and added value of our research and development of these metrics while the price movement feature captures how the fare offering by the host airline and its competitors has moved since time of booking the price differential feature is a snapshot of the current fare offering compared to the fare at time of booking another example of this is fra syd the feature that captures the price movement against the cheapest airline in the market is dominant on the other hand the fra kul market seems to be concerned with the fare different against the cheapest airline the same applies for kul sin it only seems to be driven by price to summarize the od s in this category are ams dxb fra syd fra kul and kul sin 6 3 2 departure time sensitive ods amsterdam london and new york are traditionally considered routes for busi ness travellers one of the reasons for this is that all of these cities are financial hubs it is worth noting that the delta in time between the airline s departure time and 6 am has a lot of explanatory power note that especially in the lhr jfk case the pricing features have little weight in the ams lhr case the fare difference versus the cheapest airline in the market is the second most powerful variable we hypothesize that this is as a result of the recent increase in low cost carrier lcc frequencies between amsterdam and london in summary the od s that make up this category are ams lhr and lhr jfk 6 3 3 flying comfort ods on these ultra long haul ods a passenger s comfort is a deciding factor note that the review scores of the ife have great explanatory power and actually have greater explanatory power than the price also note that other features that may describe the comfort of a journey such as the quality of the seat crew or ground services did not appear this seems to indicate that on long haul ods passengers value their entertainment more than their seat while airlines traditionally segment their pricing based on the origin it is worth nothing that for these ods terminating in sydney customer behavior seems fairly consistent summarizing the od s that fall in this category are ams syd cdg syd fra syd and lhr syd 6 3 4 comparing ods it is interesting to compare the model s performance shown in figure 5 with the features used to obtain the predictions shown in figure 6 consider the ams syd and cdg syd ods from table 6 we note that these ods have five and four competitors respectively looking at figure 2 we note that the distribution of demand by airlines is similar airline 8 is missing from cdg syd airline 4 has proportionally more demand for cdg syd because of this missing airline in short from a competition perspective we can argue that these are similar looking at the model s performance in figure 21 5 we note very similar results for all three metrics false positive false negative and true positive the metrics that powered these predictions in figure 6 show that the information gain for both the rating of ife and mean 3 dyy features are very similar and these combined have an information gain of 0 45 with ife being the most important feature for this reason we have segmented these together as a comfort od 6 4 xgb performance in this section we will review the parameters of the xgb model we introduced in section 5 2 note that the number of rounds is not shown here but shown in figure 4 and discussed in section 5 3 learning rate figure 7 shows the different values of learning rate for different ods recall that this parameter also known as shrinkage controls how much weight a new tree is assigned figure 7 performance of learning rate by iteration and od from figure 7 as expected we see a very slow improvement of rmse for 0 1 red line increasing this parameter to 0 2 orange shows a much faster convergence values of around 0 3 moss green seem to be the best trade off between finding a good rmse and runtime for this reason 0 3 is chosen note that very large choices of actually results in a slight increase of rmse as the number of iterations grow across the different ods in conclu sion we do not observe great differences between the different ods and keep the parameter fixed at 0 3 for all ods depth of the tree dt figure 8 shows the development of rmse on the test set for different values of the depth of the tree we allow dt 22 figure 8 performance of dt by iteration and od first let us consider the kul sin od here we see a dramatic improve ment from dt 1 red a tree with one level to dt 2 dark orange a tree with two the performance of this model measured as the rmse over the test set no longer improves as we grow dt further this seems to indicate that the ensemble of trees for this od is relatively simple comparing the different ods we may conclude that different ods have different levels of complexities for the ams syd cdg syd fra syd and lhr syd ods we see a clear improvement as we grow dt up to its maximum chosen value of dt 20 while other ods seem to converge at values of dt beyond 7 light blue the value of dt depends on the od and is chosen visually at the lowest value after which we do not see any improvement of performance for example for ams syd we choose dt 5 moss green since we do not see any improvement for larger values of dt while for lhr syd we choose dt 20 bright pink 23 number of observations st in figure 9 we study the effects of the number of observations used when building trees figure 9 performance of st by iteration and od from figure 9 we observe that the parameter st is important for some ods while it is not important for others for example consider ams dxb earlier we saw that the value of dt was important for this od while it does not seem to be of importance for st even for very small values of st this may indicate that the observations for this od are fairly uniform the model performs just as well randomly selecting 10 of all observations as it does using all observations other ods such as fra syd seem to exhibit different model performance for different values we choose the smallest value of st accordingly this helps re ducing both runtime and avoids overfitting for ams dxb we choose st 0 2 orange and for ods that are affected by the number of observations such as lhr jfk we choose st 0 1 red number of features ft figure 10 shows the effect of rmse over ten iterations when using a certain proportion ft of features when constructing trees for different ods 24 figure 10 performance of ft by iteration and od in practice a value of ft 0 1 red means that we use less than two features when modelling this exemplifies the poor performance in terms of rmse for all ods in figure 6 we observed that for most ods two features are often very important in the performance of the model not randomly choosing these two features will therefore naturally result in poor performance while the performance of the model does improve for low values of ft the trade off is not worth it even when choosing ft 1 the longest runtime across the 10 different ods is less than four seconds in summary we choose ft 1 for all ods 6 5 examples one of the main drawbacks of xgb is that method is a black box method this method produces an ensemble of decision trees while a single decision tree is easy to understand an ensemble is not in this section we use the xgboostexplainer 15 package to show for a number of examples how the model arrives at its prediction this is achieved by drawing the ensemble of all trees and traversing them to obtain the probability estimation we will review three examples below each of these examples represents a given itinerary the probability of purchase is shown on the vertical axis the numbers inside the bar represent the log odds of each feature as discussed in the approach section our goal is to predict whether a itinerary is purchased for this reason we round the probability to the nearest integer as a result the horizontal line at p 0 5 represents the cut off for predicting whether or not this itinerary is purchased or not features are ordered by their weight from left to right 25 figure 11 example one long haul itinerary low priced airline figure 11 shows en example of how the probability is generated for a long haul itinerary for a low priced airline the model starts at a probability of purchase of 43 the intercept this probability increases by 6 to 49 because this airline was 46 cheaper than the cheapest airline in this od market notice the negative sign indicating the host airline s fare is lower is lower than the next airline in the market the crew for this airline is rated very high at 4 63 5 which causes the probability of purchase to strengthen to 55 this probability drops back to just over 50 because the airline itself has been cheaper in the past 28 days on average by 14 indicating a price sensitive market note that the ife score of 4 08 drags the purchase probability down by almost 3 the final probability of purchase is 0 45 which after rounding is marked as a non purchase 26 figure 12 example two long haul itinerary well priced airline with great ife figure 12 shows another example in this example the airline is well priced compared to competition and possesses a great ife product the baseline purchase probability is again 43 here we clearly see the impact of ife the probability of purchase increases by over 11 compare this to the impact the pricing difference to the cheapest carrier in the market in the past three days the log odd impact of the ife rating weighs twice as heavy as this pricing feature 0 47 and 0 22 respectively other features have negligible impact the model generates a purchase probability of over 62 figure 13 example three long haul itinerary higher priced airline with great ife figure 13 shows another example of how the model generates its purchase 27 probability in this case the airline has great ife but is higher priced than competitors the baseline purchase probability is 43 again we see how the ife has the biggest impact on determining purchase probability interestingly the airline is on average by 45 more expensive than the cheapest carrier in the market this actually increases the purchase probability this could indicate the willingness to pay more for a itinerary that contains a better ife product however it also shows a bound note that because this carrier is 75 more expensive than the market fare at time of purchase the purchase probability declines slightly 2 this may indicate that the sweet spot this airline could demand lies anywhere between 45 and 75 6 6 in practice as we discussed predicting whether an itinerary is purchased can provide great insights in the positioning of the airline it can benefit pricing and marketing teams and help them understand how to each of the features affect a customer s decision while this itself provides great insights we believe that the true value of this forecasting framework will become apparent when considering the greater revenue management problem consider what the end objective of rm is maximizing revenue studies for example 44 have shown that increases in forecast accuracy show clear increases in revenue performance intuitively this makes sense inputs closer to reality should mean better output revenues therefore in this section we will compare demand forecasting through our framework with demand forecasting typically done in practice in practice this is done by forecasting aggregated od class for brevity demand to compare revenues we will use a time series forecast in simulations to provide us with a base case our framework on the other hand provides estimates on an itinerary level therefore we roll up these estimates to obtain an aggregated od class level forecast and then use this as input in simulations for a single flight this enables us to have a like for like comparison and study the effects of this method of forecasting in the end goal of revenue management maximizing revenue unfortunately we were only given access to data for 10 ods in practice however a flight has many different ods crossing it we are unable to create forecasts for every od therefore we have chosen a flight from a big airline that has four out of the ten ods utilizing it these four ods combined represent on average 42 of the total demand for this flight the simulation is constructed as follows 1 calculate an optimal policy using a traditional forecasting method in our case we chose double exponential smoothing 2 calculate an optimal policy using our new forecasting framework discussed in this paper for the ods that are available use the traditional forecasting method for those ods we do not have data for 3 generate n 500 arrival processes with an average demand factor of 0 98 and standard deviation of 0 1 4 simulate accepting requests and calculate revenues for both methods 28 in the simulations we make a distinction between whether a customer downsells or not downsell occurs when a customer purchases a cheaper class than she was willing to pay for suppose we have twelve different classes for sale with ordered fares such that f 1 is the most expensive product and fare f 12 the cheapest now consider for example a customer wanting to purchase booking class 10 with fare f 10 however class 12 is available for sale with fare f 12 a customer downsells if she actually purchases class 12 in this case the airline loses f 10 f 12 we have done extensive research into downsell and have covered this in the literature 21 the fares for the four ods we have used are covered in table 15 the associated demand by fare brand is given in table 16 demand by booking class has a relatively high variance so we have summarized these in terms of fare brand recall that the definition of a fare brand was introduced in 20 fare brands are a collection of products with identical fare conditions with the only differing factor price od class 1 2 3 4 5 6 7 8 9 10 11 12 1 2324 1913 1672 1152 1081 966 871 706 660 498 494 447 2 2489 2078 1995 1707 1462 1363 1187 1009 774 553 534 474 3 1904 1621 1323 1094 1091 962 922 737 682 622 495 311 4 2509 2043 1452 1420 1035 762 700 523 449 374 311 206 table 15 fare by booking class od fare brand 1 2 3 1 0 05 0 30 0 65 2 0 10 0 18 0 70 3 0 02 0 46 0 40 4 0 12 0 20 0 59 table 16 percentage of demand by fare brand booking classes 1 through 3 are part of fare brand 1 4 through 8 part of fare brand 2 9 through 12 part of fare brand 3 table 17 shows the simulation results downsell std xgb gain no 27468 27648 0 70 yes 9622 9898 2 90 table 17 revenue performance comparing forecast methods std standard fore casting with xgb demand factor 0 98 in table 17 we compare the standard forecasting technique std with xgb the numbers represent the revenue performance for this flight the percentage gain shows the relative performance if customers do not downsell our simula tions show an average improvement of 0 7 however of particular interest is the scenario where customers do downsell this is a more realistic scenario and this provides revenue gains of 2 90 we therefore have found evidence that this framework is particularly beneficial in these cases 29 7 discussion the results show our ability to segment ods in three distinct categories price schedule and comfort sensitive currently we use bookings from the entire period for which we have been given access to as one big dataset it could be that there is seasonality in what customers prefer for example in the summer peak when schools have their holidays people may be less price sensitive after all they are bound by these dates to travel much more so than in an off peak period when it is easy to move your travels a day or two another detail we would like to highlight is that the data shown here is from one specific ota this brings us to the following firstly it could be that there are airlines that do not sell ticket through this ota for example in the us southwest airlines only sells tickets through their own channel not through any ota secondly while we dealt with a large enough number of bookings to make our research statistically significant one has to remember that the airline also sells through other channels including other otas for this reason the dataset may not represent the entire population however we cannot think of reasons why customer behavior on one ota will be drastically different than behavior on another channel when using ratings from airlines we chose to calculate aggregates by airline not by od and airline as discussed we took this decision because the number of reviews would get extremely small and as a result aggregates are not reliable particularly for airlines that offer many different types of aircraft some of them having certain features such as wifi or ife while other aircraft do not this may not be fair to aggregate review scores like this while elements such as safety records may be a deciding factor intuitively the number of accidents or incidents is at an historically low level in effect flying has become very safe and therefore there is little difference in measures between airlines for this reason we suspect the model is not using this feature for any od intra day changes to fares can cause the fares from the booking dataset mismatch those from the competitive pricing dataset while bookings depend on real time availability the fares in the competitive pricing dataset are only scraped once a day but always at the same time the implications for rm are as follows we have shown that on some ods passengers only seem to look at fare in their decision making process as a result the airline could considering lowering fares for these ods alternatively it could look into unbundling fares to become more competitive on the other hand the approach in this paper extends to other departments of airlines it shows that the investments some airlines make in their entertainment offering do drive extra bookings in traditional rm optimisation techniques one optimizes network revenue using demand forecasts estimated fares as well as capacity constraints some techniques assume booking class independent demand forecasts while others use customer choice probabilities to derive demand forecasts in this paper we have presented a framework to estimate whether a given itinerary will get purchased or not naturally rolling up these estimates from an itinerary to od level we can derive a true competitor based demand forecast another implication for rm is having an ability to estimate what your air line s fare premium should be given your offering it is often a discussion in 30 airlines how much more expensive or similarly how much more cheaper you should be compared to your competitors given your product for figure 13 we estimated what this airline s premium could be for this od given its very well rated ife offering before discussing the results we compared the logit to the xgb model we found that the xgb model outperforms the logit model for true positives how ever we also found that the logit model is more biased toward predicting false negatives while the xgb model is more biased toward false positives in prac tice we would prefer a false positive to some extent after all predicting a false negative is arguably worse than a false positive research typically shows that overforecasting results in better revenue performance than underforecasting it may be interesting to study why these methods are biased toward different errors but this is outside the scope of this paper we argue that the most important result of our work is obtaining a better forecast weatherford et al 44 show that overforecasting by 25 accuracy lead to a revenue loss of 1 35 while overforecasting by 12 5 lead to revenues 0 18 lower than an optimal forecast the fares ranged from 66 to 275 in their work with demand consistent across classes comparing our work to this work we suspect that our results are higher as a result of a wider spread fare ladder and a different optimization technique since our forecast considers competition this could be a straightforward method to incorporate competitor based information into the optimization process one should remember that the results presented in this paper in particular in table 17 are a lower bound to actual revenue performance after all only 42 of the flight s total demand was modelled using our new technique the objective of this paper was to introduce a new method to predict booking behavior the results we showed have a demand factor of 0 98 we suggest further research into different scenarios for example extremely empty of extremely popular flights different optimization techniques different fare ladders to study the effects of our method on revenue performance finally the method used in this paper is a black box method as we dis cussed while a decision tree is easy to understand an ensemble of decision trees is not therefore the analyst may have its doubts on how the model arrives at its prediction the xgboostexplainer tool which we used to produce figures 11 12 and 13 is a great tool to give insight in the model which in turn will restore analyst confidence 31 8 appendix engineered features field title field description source calculation airline x airline competitor pricing od od competitor pricing airline num id obfuscated airline id schedule num obfuscated date ota t x days before departure ota home carrier is this airline a home carrier schedule is od s origin or destination the airline s hub sc 1 review score site 1 review website sc 2 review score site 2 review website price price of itinerary competitor pricing rating l recommended airline recommended by leisure passengers review website median rating of all review rating l review review sentiment by leisure passengers review website text mining based on afinn dataset rating l fb f b rating by leisure passengers review website median rating of all review rating l ground ground services rating by leisure passengers review website median rating of all review rating l ife ife rating by leisure passengers review website median rating of all review rating l crew crew rating by leisure passengers review website median rating of all review rating l seat seat rating by leisure passengers review website median rating of all review rating l value value for money rating by leisure passengers review website median rating of all review rating l wifi wifi rating by leisure passengers review website median rating of all review rating l obs number of review observations by leisure passengers review website count of number of reviews rating b recommended airline recommended by business passengers review website median rating of all review rating b review review sentiment by business passengers review website text mining based on afinn dataset rating b fb f b rating by business passengers review website median rating of all review rating b ground ground services rating by business passengers review website median rating of all review rating b ife ife rating by business passengers review website median rating of all review rating b crew crew rating by business passengers review website median rating of all review rating b seat seat rating by business passengers review website median rating of all review rating b value value for money rating by business passengers review website median rating of all review rating b wifi wifi rating by business passengers review website median rating of all review rating b obs number of review observations by business passengers review website count of number of reviews sent mean mean sentiment score review website median rating of all review sent sd standard deviation sentiment score review website text mining based on afinn dataset sent mean rel diff difference to mean sentiment score review website median rating of all review sent mean rel perc percentage difference to mean sentiment score review website median rating of all review sent sd rel diff difference to sd sentiment score review website median rating of all review sent sd rel perc percentage difference to sd sentiment score review website median rating of all review direct flight is this a direct flight yes no review website median rating of all review has night flight does this airline offer a night flight review website median rating of all review has day flight does this airline offer a day flight review website median rating of all review first flight dep airline s time of departure of first flight of the day review website count of number of reviews first flight arr airline s time of arrival of first flight of the day review website median rating of all review last flight dep airline s time of departure of last flight of the day review website text mining based on afinn dataset last flight arr airline s time of arrival of lasst flight of the day review website median rating of all review min flying time airline s minimum flying time review website median rating of all review min conn time airine s minimum connection time review website median rating of all review min travel time airline s minimum travel time review website median rating of all review has night departure is this a night departure review website median rating of all review has morning arrival is this a morning arrival review website median rating of all review num frequencies number of frequencies offered by airline review website median rating of all review aircraft type aircraft type review website count of number of reviews airline fleet size airline fleet size kaggle sum of airframes airline fleet cost airline fleet cost estimated kaggle sum of airframe cost airline fleet age airline fleet age kaggle average age of airframes bucket t bucketed time time before departure grouped in multiples of 10 ota floor time before departure 10 10 32 field title field description source calculation mean 3 d al mean last 3 day price moment of own airline competitor pricing mean of fare at t x fare at t y rolling 3 days airline vs itself min 3 d al min of last 3 day price moment of own airline competitor pricing min of fare at t x fare at t y rolling 3 days airline vs itself max 3 d al max of last 3 day price moment of own airline competitor pricing max of fare at t x fare at t y rolling 3 days airline vs itself sd 3 d al sd of last 3 day price moment of own airline competitor pricing sd of fare at t x fare at t y rolling 3 days airline vs itself mean 7 d al sd of last 7 day price moment of own airline competitor pricing mean of fare at t x fare at t y rolling 7 days airline vs itself min 7 d al sd of last 7 day price moment of own airline competitor pricing min of fare at t x fare at t y rolling 7 days airline vs itself max 7 d al sd of last 7 day price moment of own airline competitor pricing max of fare at t x fare at t y rolling 7 days airline vs itself sd 7 d al sd of last 7 day price moment of own airline competitor pricing sd of fare at t x fare at t y rolling 7 days airline vs itself mean 14 d al sd of last 14 day price moment of own airline competitor pricing mean of fare at t x fare at t y rolling 14 days airline vs itself min 14 d al sd of last 14 day price moment of own airline competitor pricing min of fare at t x fare at t y rolling 14 days airline vs itself max 14 d al sd of last 14 day price moment of own airline competitor pricing max of fare at t x fare at t y rolling 14 days airline vs itself sd 14 d al sd of last 14 day price moment of own airline competitor pricing sd of fare at t x fare at t y rolling 14 days airline vs itself mean 28 d al sd of last 28 day price moment of own airline competitor pricing mean of fare at t x fare at t y rolling 28 days airline vs itself min 28 d al sd of last 28 day price moment of own airline competitor pricing min of fare at t x fare at t y rolling 28 days airline vs itself max 28 d al sd of last 28 day price moment of own airline competitor pricing max of fare at t x fare at t y rolling 28 days airline vs itself sd 28 d al sd of last 28 day price moment of own airline competitor pricing sd of fare at t x fare at t y rolling 28 days airline vs itself mean 3 d yy mean last 3 day price moment of cheapest airline competitor pricing mean of fare at t x fare at t y rolling 3 days airline vs cheapest airline min 3 d yy min of last 3 day price moment of cheapest airline competitor pricing min of fare at t x fare at t y rolling 3 days airline vs cheapest airline max 3 d yy max of last 3 day price moment of cheapest airline competitor pricing max of fare at t x fare at t y rolling 3 days airline vs cheapest airline sd 3 d yy sd of last 3 day price moment of cheapest airline competitor pricing sd of fare at t x fare at t y rolling 3 days airline vs cheapest airline mean 7 d yy sd of last 7 day price moment of cheapest airline competitor pricing mean of fare at t x fare at t y rolling 7 days airline vs cheapest airline min 7 d yy sd of last 7 day price moment of cheapest airline competitor pricing min of fare at t x fare at t y rolling 7 days airline vs cheapest airline max 7 d yy sd of last 7 day price moment of cheapest airline competitor pricing max of fare at t x fare at t y rolling 7 days airline vs cheapest airline sd 7 d yy sd of last 7 day price moment of cheapest airline competitor pricing sd of fare at t x fare at t y rolling 7 days airline vs cheapest airline mean 14 d yy sd of last 14 day price moment of cheapest airline competitor pricing mean of fare at t x fare at t y rolling 14 days airline vs cheapest airline min 14 d yy sd of last 14 day price moment of cheapest airline competitor pricing min of fare at t x fare at t y rolling 14 days airline vs cheapest airline max 14 d yy sd of last 14 day price moment of cheapest airline competitor pricing max of fare at t x fare at t y rolling 14 days airline vs cheapest airline sd 14 d yy sd of last 14 day price moment of cheapest airline competitor pricing sd of fare at t x fare at t y rolling 14 days airline vs cheapest airline mean 28 d yy sd of last 28 day price moment of cheapest airline competitor pricing mean of fare at t x fare at t y rolling 28 days airline vs cheapest airline min 28 d yy sd of last 28 day price moment of cheapest airline competitor pricing min of fare at t x fare at t y rolling 28 days airline vs cheapest airline max 28 d yy sd of last 28 day price moment of cheapest airline competitor pricing max of fare at t x fare at t y rolling 28 days airline vs cheapest airline sd 28 d yy sd of last 28 day price moment of cheapest airline competitor pricing sd of fare at t x fare at t y rolling 28 days airline vs cheapest airline mean 3 d zz mean last 3 day price moment of second cheapest airline competitor pricing mean of fare at t x fare at t y rolling 3 days airline vs second cheapest airline min 3 d zz min of last 3 day price moment of second cheapest airline competitor pricing min of fare at t x fare at t y rolling 3 days airline vs second cheapest airline max 3 d zz max of last 3 day price moment of second cheapest airline competitor pricing max of fare at t x fare at t y rolling 3 days airline vs second cheapest airline sd 3 d zz sd of last 3 day price moment of second cheapest airline competitor pricing sd of fare at t x fare at t y rolling 3 days airline vs second cheapest airline mean 7 d zz sd of last 7 day price moment of second cheapest airline competitor pricing mean of fare at t x fare at t y rolling 7 days airline vs second cheapest airline min 7 d zz sd of last 7 day price moment of second cheapest airline competitor pricing min of fare at t x fare at t y rolling 7 days airline vs second cheapest airline max 7 d zz sd of last 7 day price moment of second cheapest airline competitor pricing max of fare at t x fare at t y rolling 7 days airline vs second cheapest airline sd 7 d zz sd of last 7 day price moment of second cheapest airline competitor pricing sd of fare at t x fare at t y rolling 7 days airline vs second cheapest airline mean 14 d zz sd of last 14 day price moment of second cheapest airline competitor pricing mean of fare at t x fare at t y rolling 14 days airline vs second cheapest airline min 14 d zz sd of last 14 day price moment of second cheapest airline competitor pricing min of fare at t x fare at t y rolling 14 days airline vs second cheapest airline max 14 d zz sd of last 14 day price moment of second cheapest airline competitor pricing max of fare at t x fare at t y rolling 14 days airline vs second cheapest airline sd 14 d zz sd of last 14 day price moment of second cheapest airline competitor pricing sd of fare at t x fare at t y rolling 14 days airline vs second cheapest airline mean 28 d zz sd of last 28 day price moment of second cheapest airline competitor pricing mean of fare at t x fare at t y rolling 28 days airline vs second cheapest airline min 28 d zz sd of last 28 day price moment of second cheapest airline competitor pricing min of fare at t x fare at t y rolling 28 days airline vs second cheapest airline max 28 d zz sd of last 28 day price moment of second cheapest airline competitor pricing max of fare at t x fare at t y rolling 28 days airline vs second cheapest airline sd 28 d zz sd of last 28 day price moment of second cheapest airline competitor pricing sd of fare at t x fare at t y rolling 28 days airline vs second cheapest airline dep time mam departure time in minutes after midnight schedule hours and minutes converted into minutes connecting time connecting time schedule dep time next flight arr time previous flight travel time travel time schedule flying time connecting time mintt minimum connecting time offered by airline schedule min travel time by od by days before departure tt delta difference between airline travel time and min travel time for this od schedule airline s travel time mintt dept delta difference between itinerary s departure time and ideal deparure time schedule departure time 7 am departure mkt fare lowest fare in the market competitor pricing min fare by od by time before departure mkt fare diff difference to lowest fare in the market competitor pricing airline s fare mkt fare mkt fare diff perc percentage difference to lowest fare in the market competitor pricing airline s fare mkt fare 1 is cheapest is this airline cheapest competitor pricing if airline s fare mkt fare is bought itineray purchased label ota is this itinerary bought airline id obfuscated airline id ota randon number table 18 overview of all engineered features references 1 mukarramah modupe adeola and sulaimon olanrewaju adebiyi service quality perceived value and customer satisfaction as determinant of airline choice in nigeria international letters of social and humanistic sciences 20 66 80 2014 2 ozlem atalik and melike arslan a study to determine the effects of cus tomer value on customer loyalty in airline companies operating case of turkish air travelers international journal of business and management 4 6 154 162 2009 3 martin j beckmann decision and team problems in airline reservations econometrica journal of the econometric society pages 134 145 1958 4 thomas bieger andreas wittmer and christian laesser what is driv ing the continued growth in demand for air travel customer value of air transport journal of air transport management 13 1 31 36 2007 5 tina boetsch thomas bieger and andreas wittmer a customer value framework for analyzing airline services transportation journal 50 3 251 270 2011 33 6 william g brunger the impact of the internet on airline fares the internet price effect journal of revenue and pricing management 9 1 2 66 93 2010 7 fredrik carlsson and a sa lo fgren airline choice switching costs and frequent flyer programmes applied economics 38 13 1469 1475 2006 8 tianqi chen and carlos guestrin xgboost a scalable tree boosting sys tem in proceedings of the 22 nd acm sigkdd international conference on knowledge discovery and data mining pages 785 794 2016 9 yuan ho chen ming lang tseng and ru jen lin evaluating the cus tomer perceptions on in flight service quality african journal of business management 5 7 2854 2011 10 woohyun cho the impact of airline and customer characteristics on airline and airport choice phd thesis university of maryland 2012 11 gregory m coldren frank s koppelman krishnan kasturirangan and amit mukherjee modeling aggregate air travel itinerary shares logit model development at a major us airline journal of air transport man agement 9 6 361 369 2003 12 baker david mc a service quality and customer satisfaction in the air line industry a comparison between legacy airlines and low cost airlines american journal of tourism research 2 1 67 77 2013 13 sara dolnicar klaus grabler bettina gru n and anna kulnig key drivers of airline loyalty tourism management 32 5 1020 1026 2011 14 grahame r dowling and mark uncles do customer loyalty programs really work sloan management review 38 71 82 1997 15 david foster xgboostexplainer version 0 1 16 priyanga gunarathne huaxia rui and abraham seidmann when social media delivers customer service differential customer treatment in the airline industry mis quarterly 42 2 489 520 2018 17 alwin haensel ger koole and jeroen erdman estimating unconstrained customer choice set demand a case study on airline reservation data journal of choice modelling 4 3 75 87 2011 18 daniel hopman ger koole and rob van der mei a framework for mod elling time dependent cancellations in airline revenue management work ing paper manuscript in preparation 19 daniel hopman ger koole and rob van der mei practical limitations of revenue management theory versus practice working paper manuscript in preparation 20 daniel hopman ger koole and rob van der mei the theory of revenue management a review of demand forecasting pricing and optimisation working paper manuscript in preparation 34 21 daniel hopman ger koole and rob van der mei single leg revenue man agement with downsell and delayed decision making journal of revenue and pricing management 16 6 594 606 2017 22 rahim hussain amjad al nasser and yomna k hussain service quality and customer satisfaction of a uae based airline an empirical investigation journal of air transport management 42 167 175 2015 23 timothy l keiningham forrest v morgeson iii lerzan aksoy and luke williams service failure severity customer satisfaction and market share an examination of the airline industry journal of service research 17 4 415 431 2014 24 mohammed naved khan vippan raj dutt and sc bansal customer perceptions and expectations of service quality a case study of domestic airline industry in india in proceedings of the 2 nd iima conference on research in marketing pages 121 129 2007 25 usman khan and noreen khan customer satisfaction in airline industry international proceedings of economics development and research 76 63 2014 26 udayan khurana deepak turaga horst samulowitz and srinivasan parthasrathy cognito automated feature engineering for supervised learning in 2016 ieee 16 th international conference on data mining workshops icdmw pages 1304 1307 ieee 2016 27 mateja kos koklic monika kukar kinney and spela vegelj an investi gation of customer satisfaction with low cost and full service airline com panies journal of business research 80 188 196 2017 28 colin law the study of customer relationship management in thai airline industry a case of thai travelers in thailand journal of airline and airport management 7 1 13 42 2017 29 alix lhe ritier michael bocamazo thierry delahaye and rodrigo acuna agost airline itinerary choice modeling using machine learning journal of choice modelling 31 198 209 2019 30 kenneth littlewood forecasting and control of passenger bookings airline group international federation of operational research societies proceed ings 1972 12 95 117 1972 31 shanna triche s lucchesi christine tessele nodari ana margarita larran aga and luis afonso dos santos senna airline customer loyalty through analysis of stated preference journal of transport literature 9 2 25 29 2015 32 t manivasugen and rista nova factors affecting customer preferences while choosing a low cost airline global journal of commerce and man agement perspective 2 3 19 26 2013 33 christina p milioti matthew g karlaftis and eleni akkogiounoglou trav eler perceptions and airline choice a multivariate probit approach journal of air transport management 49 46 52 2015 35 34 alejandro mottini and rodrigo acuna agost deep choice model using pointer networks for airline itinerary prediction in proceedings of the 23 rd acm sigkdd international conference on knowledge discovery and data mining pages 1575 1583 acm 2017 35 finn a rup nielsen a new anew evaluation of a word list for sentiment analysis in microblogs arxiv preprint arxiv 1103 2903 2011 36 jin woo park rodger robertson cheng lung wu et al investigating the effects of airline service quality on airline image and passengers future be havioural intentions findings from australian international air passengers journal of tourism studies 16 1 2 2005 37 stefan poelt practical pricing and the airline industry in revenue man agement pages 192 207 springer 2011 38 richard ratliff and guillermo gallego estimating sales and profitability impacts of airline branded fares product design and pricing decisions using customer choice models journal of revenue and pricing management 12 6 509 523 2013 39 maxwell sandada and bright matibiri an investigation into the impact of service quality frequent flier programs and safety perception on satisfaction and customer loyalty in the airline industry in southern africa south east european journal of economics and business 11 1 41 53 2016 40 thorsten teichert edlira shehu and iwan von wartburg customer seg mentation revisited the case of the airline industry transportation re search part a policy and practice 42 1 227 242 2008 41 nikos tsikriktsis and janelle heineke the impact of process variation on customer dissatisfaction evidence from the us domestic airline industry decision sciences 35 1 129 141 2004 42 rohit verma and gerhard plaschka the art and science of customer choice modeling reflections advances and managerial implications cornell ho tel and restaurant administration quarterly 44 5 6 156 165 2003 43 gustavo vulcano garrett van ryzin and wassim chaar om practice choice based revenue management an empirical study of estima tion and optimization manufacturing service operations management 12 3 371 392 2010 44 lr weatherford and pp belobaba revenue impacts of fare input and demand forecast accuracy in airline yield management journal of the operational research society 53 8 811 821 2002 45 arch g woodside and roberta macdonald general system framework of customer choice processes of tourism services spoilt for choice 30 1994 36 1 introduction and motivation 2 literature review 3 data overview 3 1 online travel agent ota dataset 3 2 competitive pricing 3 3 airline ratings 3 4 twitter sentiment 3 5 airline safety ratings 3 6 fleet information 3 7 data overview 4 approach 4 1 objective 4 2 feature engineering 4 2 1 ota dataset 4 2 2 competitive pricing 4 2 3 airline ratings 4 2 4 twitter sentiment 4 2 5 airline safety ratings 4 2 6 fleet information 5 modelling 5 1 extreme gradient boosting 5 2 selecting parameters 5 3 performance 5 4 runtime 6 results 6 1 comparison with logistic regression 6 2 overall performance 6 3 customer behavior 6 3 1 price sensitive ods 6 3 2 departure time sensitive ods 6 3 3 flying comfort ods 6 3 4 comparing ods 6 4 xgb performance 6 5 examples 6 6 in practice 7 discussion 8 appendix engineered features