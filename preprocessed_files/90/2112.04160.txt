ar x iv 2 11 2 04 16 0 v 1 m at h o c 8 d ec 2 02 1 noname manuscript no will be inserted by the editor a finitely convergent cutting plane and a bender s decomposition algorithm for mixed integer convex and two stage convex programs using cutting planes fengqiao luo sanjay mehrotra received date accepted date abstract we consider a general mixed integer convex program we first de velop an algorithm for solving this problem and show its finite convergence we then develop a finitely convergent decomposition algorithm that separates binary variables from integer and continuous variables the integer and contin uous variables are treated as second stage variables an oracle for generating a parametric cut under a subgradient decomposition assumption is developed the decomposition algorithm is applied to show that two stage distribution ally robust convex programs with binary variables in the first stage can be solved to optimality within a cutting plane framework for simplicity the paper assumes that certain convex programs generated in the course of the algorithm are solved to optimality 1 introduction we consider a family of mixed integer convex programs in the form min g 0 x y s t gi x y 0 i i x x 0 1 l 1 y y zl 2 rl 3 jmicp where x are binary variables and y are mixed integer variables the functions g 0 x y and gi x y for i i are convex and x and y are bounded convex sets fengqiao luo department of industrial engineering and management science northwestern university evanston illinois fengqiaoluo 2014 u northwestern edu sanjay mehrotra corresponding author department of industrial engineering and management science northwestern university evanston illinois mehrotra northwestern edu http arxiv org abs 2112 04160 v 1 2 fengqiao luo sanjay mehrotra for x and y an important special case of jmicp is the following two stage stochastic mixed integer convex program min x c x e p p q x s t ax b x c x 0 1 l 1 1 where x is the vector of first stage variables that are pure binary and is a vector of random parameters that follow the joint distribution p the recourse function q x for scenario is given as q x min y q y s t gj s j y t j x r j 0 j j y zl 2 rl 3 2 where every gj is a convex function and q s j t j r j are scenario specific coefficients in addition to developing an algorithm for solving mixed integer convex programs a major result of this paper is to develop a finitely convergent cutting plane decomposition algorithm for solving jmicp under mild reg ularity conditions parametric cuts are generated within the decomposition algorithm an oracle for generating the parametric cuts is also developed the decomposition algorithm makes the following assumptions assumption 1 for any fixed x x 0 1 l 1 jmicp is feasible in y assumption 2 for any x 0 y 0 r l 1 l 2 l 3 the function gi i i 0 0 satisfies gi x 0 y 0 xgi x 0 y 0 ygi x 0 y 0 where gi x 0 y 0 is the set of sub gradients of gi at the point x 0 y 0 xgi x 0 y 0 is the set of sub gradients of the function gi x y 0 at x x 0 and ygi x 0 y 0 is defined similarly assumption 3 we have an oracle that can solve a general convex optimiza tion problem to optimality without error assumptions 1 3 simplify our presentation and analysis it is possible to add additional artificial variables to ensure assumption 1 assumption 2 is used when ensuring that the cutting planes generated to solve jmicp in the space of y for any fixed x are valid and extendable to generate a bender s cut in the space of x more detailed explanation regarding this assumption is provided at the end of section 4 1 note that assumption 2 is satisfied by two important families of functions 1 the differentiable convex functions in the x y space 2 the separable convex functions in the form of g x y x y where and are convex this is the case in two stage stochastic convex programs assumption 3 is needed to prove the finite convergence of our algorithm which frequently calls the oracle to solve a general convex optimization problem to optimality in a finite number of iterations it is possible to develop a variant of title suppressed due to excessive length 3 the algorithm presented here that allows error in solving convex programs however it is not presented here due to space limitations in the context of two stage stochastic convex programs we assume that is a finite set in the case where the set p is singleton i e there is no distributional ambiguity 1 2 also admits an extended reformulation in terms of variables x and y for min c x p q y s t gj s j y t j x r j 0 j j ax b x c x 0 1 n y zl 1 rl 2 3 where p is the probability of the scenario it is straightforward to verify that 3 is in the form of jmicp thus 3 can be solved directly using an algorithm for solving mixed integer convex programs however even in this case a bender s decomposition approach is typically preferable when the number of scenarios is large 1 1 literature review the development of methods and algorithms for solving mixed integer convex programs micps benefits from more mature solvers for mixed integer linear programs milps we provide a brief review on work for solving milps with cutting planes the outer approximation approach for solving micps based on cutting plane methods and generalization of these methods for solving two stage stochastic mixed integer programs branch and cut algorithms 1 2 are well developed methods for solving a general milp the cutting planes are generated at the root relaxation node or some other node of the branch and bound tree to strengthen the linear relaxation or cut the current solution having undesirable fractional compo nents many families of valid inequalities have been developed since 1950 s to serve as cutting planes in the branch and cut algorithm in particular we have general purpose cuts 3 such as gomory cuts 4 disjunctive cuts 8 mixed integer rounding cuts and polyhedral structure based cuts such as flow cover inequalities 5 and flow path inequalities 6 generation of these cuts plays an important role in a branch and cut algorithm a natural question is whether a milp can be solved to optimality by adding cutting planes only for a general mixed 0 1 linear program an affirmative answer is given in 7 in which a systematic way of adding disjunctive cuts to the linear relaxation problem is given the disjunctive cuts are generated using the lift and project method investigated in 8 9 which amounts to solving a linear program to obtain the coefficients of a disjunctive cut owen and mehrotra 10 developed a cutting plane algorithm for solving a general mixed integer linear program to guarantee algorithm s convergence to an optimal solution cuts are added 4 fengqiao luo sanjay mehrotra at all optimal a notion defined in 10 vertices of the lp relaxation mas ter problem at every iteration as an alternative to explring the optimal vertices chen et al 12 proposed a convergent cutting plane algorithm for solving a general mixed integer linear program to optimality with a linear program solver as the only oracle the key idea is to build a tree to keep track of convex hulls formed by the union of disjunctive polytopes jo rg 13 provided an alternative convergent cutting plane algorithm that can solve a general milp to optimality by introducing the notion of k disjunctive cuts which is a generalization of the disjunctive cuts given in 8 9 outer approximation oa methods for solving a mixed integer convex program micp also have a long history the basic idea can be traced back to 14 in an outer approximation method the convex set is outer approx imated with a polyhedron which relaxes the micp with a milp in every master iteration the polyhedron approximation is progressively refined by adding more valid inequalities that are tangent to the convex set the theo retical question on whether a general micp can be solved to optimality with cutting planes is not well addressed particularly when the convex functions are not differentiable towards addressing this question lubin et al 20 use a polishing step after solving the master milp which solves a continuous con vex optimization problem by fixing the integer variables to be the values of integer part in the current master solution this polishing step is similar to the solution polishing done within the algorithm described in 10 the solu tion from the polishing step problem is compared with the master problem solution to check whether an optimal solution is identified however the proof given in 20 is incomplete and is not applicable for the case where the convex functions are not differentiable the convex functions considered in 20 are assumed to be differentiable in which case the outer approximation cutting plane is unique at a specific boundary point and it can be obtained by taking gradient of a constraint function for a micp involving general convex func tions this approach requires generalization in particular if the convex set is a convex cone the number of tangent planes passing the origin can be infinite in which case how to add the cutting planes is unclear cutting plane methods have also been used for solving two stage stochastic mixed integer linear programs tss milp with mixed integer second stage variables one approach is to generate parametric gomory cuts that sequen tially convexify the feasible set 21 22 gade et al 21 have shown the finite convergence of this algorithm for solving tss milps with pure binary first stage variables and pure integer second stage variables based on generating gomory cuts that are parameterized by the first stage solution this approach is generalized by zhang and ku c u kyavuz 22 for solving tss milp with pure integer variables in both stages recent work has also provided insights into developing tighter formulations by identifying globally valid parametric inequalities see 23 and references therein for two stage stochastic mixed integer conic optimization bansal and zhang 24 have developed nonlinear sparse cuts for tightening the second stage formulation of a class of two stage title suppressed due to excessive length 5 stochastic p order conic mixed integer programs by extending the results of 25 on convexifying a simple polyhedral conic mixed integer set sen and sherali 26 developed a decomposition framework for solving a deterministic pure binary linear program with two sets of binary decision vari ables coupled by some linking constraints the algorithm iteratively solves a master problem and a sub problem each involving different sets of variables the bender s cut added to the master problem is a disjunctive valid inequality generated via taking union of all leaf nodes in the branch and bound tree con structed for solving the sub problem this framework is applied to solve two stage stochastic mixed integer programs with pure binary first stage variables as shown in 26 in 29 we showed that the decomposition framework with branch and cut approach can be further developed for the two stage stochas tic mixed integer conic programming using the branch and union approach as well as an approach where the scenarios subproblems are solved using cutting planes the cutting plane framework presented in this paper can be further generalized to incorporate branching together with the addition of cuts us ing the framework from 29 we leave it to a future exposition due to space constraints 1 2 contributions of this paper this paper makes the following contributions a cutting plane algorithm is established for solving a general mixed integer convex program section 2 it is proved that the algorithm can identify an optimal solution of the micp in finitely many iterations with finitely many cutting planes section 3 to the best of our knowledge this is the first formal proof of finitely convergence of the cutting plane algorithm for solving a general micp a decomposition algorithm is developed for solving jmicp a novel as pect of this algorithm is an oracle that develops a parametric cut that is added to the master problem in the decomposition algorithm section 4 the cutting plane algorithm is applied to solve a family of distributionally robust two stage stochastic mixed integer convex programs where the first stage decision variables are pure binary section 5 section 6 illustrates the decomposition algorithm using a numerical example 2 an algorithm for mixed integer convex programs using cutting planes we first consider a mixed integer convex program in the form min c x s t ax b x c x zl 1 rl 2 micp 6 fengqiao luo sanjay mehrotra where c is a general convex set and ax b are linear constraints note that micp is general enough to incorporate the case that the objective is a non linear convex function as the nonlinear term can be reformulated into a con straint leaving only linear terms in the objective afterwards as a special case the set c can be described by inequality constraints ci x 0 for i m where m represents the set of integers 1 m and ci r l 1 l 2 r are proper convex functions in another important special case the set c tt 1 k t where kt are proper cones the cutting plane algorithm developed in this section for solving micp calls an oracle given in the following proposition proposition 2 1 for any general convex sets sk r n with k k any point x bd kk 1 sk and any vector c satisfying c k k 1 nsk x 4 where nsk x is the normal cone of sk at x and the addition follows the minkowski rule there exists an oracle that can generate k points vk for k k some of them can be zero such that c k k 1 vk and vk nsk x k k 5 proof solving the following convex program can generate vk k k with the desired property min k k 1 vk 2 s t c k k 1 vk vk nsk x k k 6 remark 2 1 it is important to note that the cone nsk x may not be finitely generated although the normal cone nsk x is written in an abstract form in the proposition we assume that it is available in an analytical form so that the convex optimization problem 6 can be solved numerically to give an example assume that k 2 s 1 x t a 1 x 2 b 1 t and s 2 x t a 2 x 2 b 2 t where x t r n r and c 1 c 2 0 consider the normal cone of s 1 and s 2 at y 0 0 which can be ns 1 x t a 1 1 x t b 1 and ns 2 x t a 1 2 x t b 2 then the optimization problem 6 becomes the following second order cone program min x 1 t 1 2 x 2 t 2 2 s t x 1 x 2 t 1 t 2 c a 11 x 1 t 1 b 1 a 12 x 2 t 2 b 2 in the above example for simplicity we have kept both second order cones be pointed at the origin however in the proposition allows for these cones be pointed at different points and thus not requiring a translation of cones not pointed at the origin to the origin by adding new equality constraints title suppressed due to excessive length 7 definition 2 1 for a general convex set s an inequality x 0 is called a supporting valid inequality for s if it satisfies 1 x 0 for all x s 2 and x 0 for an x s i e it is a supporting hyperplane of s at x we now provide an overview of our algorithm a pseudo code is given in algorithm 1 we will show that the algorithm terminates with an optimal solution after adding finitely many cuts at the main iteration n we consider the following mixed integer linear program as a master problem of the current iteration min x zl 1 rl 2 c x s t ax b x k z k x x k z k z k k n 1 c k x d k k i n 1 ms n where x k z k x x k z k z k is the cutting plane generated at iteration k to separate the master problem solution x k from c at iteration k and c k x d k are outer approximation cuts generated to approximate c at iteration k n 1 since the outer approximation cuts are not necessarily available at every iteration the algorithm uses the index set i n 1 to record the iteration indices in n 1 for which the outer approximation cuts are generated generation of these cuts will become more clear as we explain the algorithm the algorithm solves ms n by using the oracle from 12 for solving a gen eral mixed integer linear programm using cutting planes without branching if the mixed integer linear program is infeasible we stop and conclude that micp is infeasible otherwise let x n be a solution of the master problem ms n if x n c then x n is optimal to micp and the algorithm stops otherwise consider the projection problem min z c z x n 2 2 7 and let z n be its optimal solution then the algorithm generates the following separation cut x n z n x x n z n z n 8 the algorithm first adds 8 to ms n then it solves the following continuous convex program min x c c x s t ax b xj x n j j l 1 9 the problem in 9 can be viewed as a solution polishing step it also plays a key role in our finite convergence analysis there are three cases a the 8 fengqiao luo sanjay mehrotra problem 9 is infeasible b find an optimal solution x n of 9 and it is in the interior of c i e x n int c c the optimal solution x n is on the boundary of c i e x n bd c the algorithm will proceed accordingly for the cases a and b the algorithm sets i n i n 1 updates n n 1 and proceeds to the next iteration in the case c the optimality condition ensures that the objective vector c is in the normal cone ns n x n for s n x ax b xj x n j j l 1 x c the algorithm runs the oracle given in proposition 2 1 to obtain r ns n x n and r nc x n satisfying c r r where s n x ax b xj x n j j l 1 in this case the algorithm constructs the following supporting linear inequality r x x n 0 10 for simplicity we rewrite the above inequality as the following system c n x d n 11 by lemma 3 3 the oracle ensures the following relation min c x ax b xj x n j j l 1 x c min c x ax b xj x n j j l 1 c n x d n 12 the additional cuts 11 are added to ms n update i n i n 1 n n n 1 and proceed to the next iteration some key notations used in algorithm 1 are given below x k an optimal solution of the master problem at iteration k z k the projection of x k on c computed at iteration k x k z k x x k z k z k the separation cut generated at itera tion k x k an optimal solution of the continuous convex program min c x ax b xj x k j j l 1 x c obtained at iteration k c k x d k the supporting valid inequalities generated at iteration k in the case that x k bd c i n this is the subset k n x k bd c c ns k x k of iteration indices for which the supporting valid inequalities are generated 3 convergence analysis for the cutting plane algorithm we first provide a few technical results that are used for proving the main result theorem 3 1 in this section proposition 3 1 if x n n 1 is a convergent sequence in z l 1 rl 2 then the limit point of this sequence is also in zl 1 rl 2 there exists an index n and a vector v zl 1 such that x n i vi for all i l 1 and all n n title suppressed due to excessive length 9 algorithm 1 an algorithm for solving a mixed integer convex program 1 set n 1 flag 0 and i 0 2 while flag 0 do 3 start iteration n 4 step 1 solve the master problem ms n using the cutting plane oracle from 12 5 to get an optimal solution x n and optimal objective denoted as l n 6 let x n x n z x n r where x n z zl 1 and x n r rl 2 7 if x n c then 8 stop and return x n as an optimal solution of micp 9 else 10 continue 11 end if 12 step 2 solve 7 to get the projection point z n of x n on c 13 add the separation cut x n z n x x n z n z n to ms n 14 step 3 solve the continuous convex program min c x s t ax b xz x n z x c 13 15 if 13 is feasible then 16 let u n be the optimal value of 13 17 if l n u n then 18 stop and return an optimal solution of 13 as an optimal solution of micp 19 end if 20 if 13 has a solution x n bd c then 21 generate a finite number of supporting valid inequalities as illustrated in 11 22 using the oracle provided in proposition 2 1 c n x d n 14 23 add c n x d n to ms n 24 set i n i n 1 n 25 end if 26 else 27 set i n i n 1 28 end if 29 n n 1 30 end while 31 return x n proof we prove by contradiction let x be the limit point of x n n 1 sup pose there exists a variable i l 1 such that x i and 6 z because x n n 1 converges to x we have lim k x k x 1 0 15 therefore for some n we have x n x 1 1 2 where min on the other hand we have x n x 1 l 1 l 2 i 1 x n i x i x n i x i x n i 1 2 16 where we use the fact that x n i z in the last inequality this leads to a contradiction therefore we have x zl 1 rl 2 let v be the l 1 dimensional 10 fengqiao luo sanjay mehrotra vector corresponding to the first l 1 integral components of x again due to the convergence of sequence there exists an index n such that for any n n the following holds x n x 1 1 2 17 then the integrality of the first l 1 integer components of x implies that the first l 1 integer components of x n are identical to that of x which is the vector v otherwise 17 is violated this concludes the proof lemma 3 1 suppose algorithm 1 does not terminate finitely and let x n n 0 be the infinite sequence generated by the algorithm then every convergent sub sequence of x n n 0 has its limit point in bd c where bd c is the set of boundary points of c proof we prove the result by contradiction consider a convergent subse quence x ni i 1 suppose x lim i x ni 18 suppose x bd c there are two possibilities 1 x int c and 2 x c in case 1 there must exist a x ni such that x ni c but such a solution must be optimum because it is obtained from an outer approximation problem and algorithm 1 should have terminated condition in line 7 of algorithm 1 is satisfied at iteration ni in case 2 we have dist x c 0 furthermore we have a i and 0 satisfying dist x ni x 1 4 dist x c i i dist x ni x nj 1 4 dist x c i j i 19 note that by definition z n in 7 line 6 of algorithm 1 is the euclidean projection of x n onto the set c and the inequality x n z n x x n z n z n 20 added in the algorithm is a supporting valid inequality for c for which z n is the support point let f n x x n z n x z n 21 and dist x n s minz s x n z 2 we have f n x n x n z n x n z n dist 2 x n c for any i j satisfying j i i the following inequali title suppressed due to excessive length 11 ties hold f ni x nj x ni z ni x nj z ni x ni z ni x ni z ni x ni z ni x nj x ni dist 2 x ni c x ni z ni x nj x ni dist 2 x ni c dist x ni c dist x nj x ni dist 2 x ni c 1 4 dist x ni c dist x c dist x c dist x x ni 2 1 4 dist x c dist x x ni dist x c 9 16 dist 2 x c 5 16 dist 2 x c 1 4 dist 2 x c 22 the above implies that x nj violates the separation cut f ni x 0 which leads to a contradiction since x nj is an optimal solution of ms nj which involves the cut f ni x 0 based on the algorithm this concludes the proof the next lemma shows that the limit point of the infinite subsequence con sidered in lemma 3 1 can be identified after a certain number of iterations by solving a convex program lemma 3 2 suppose algorithm 1 does not terminate finitely and let x ni i 1 be a convergent subsequence generated by this algorithm let x be the limit point of this subsequence then for a sufficiently large ni x is an optimal solution of the problem min x c c x s t ax b xj x ni j j l 1 23 moreover the condition at line 20 of algorithm 1 is satisfied for a sufficiently large ni proof by lemma 3 1 the limit point x of the subsequence is in bd c by proposition 3 1 there exists an iteration index n such that x ni j x j z for all ni n and j l 1 therefore x is a feasible solution of micp for simplicity let x xz xr where xz denote the first l 1 integer variables and xr represent the continuous variables the convex program 23 fixes the integer component to be x ni z it follows that the convex program 23 is feasible at any iteration ni for ni n because x is a feasible solution of micp for ni n for any ni n let u ni min c x s t ax b xj x ni j j l 1 x c 24 u min c x s t ax b xj x j j l 1 x c 25 we now show that x is an optimal solution of 24 and 25 if not then assume that x is an optimal solution of 25 and it satisfies c rx r c rx r 12 fengqiao luo sanjay mehrotra obviously x ni z x r x z x r is a feasible solution of 25 for sufficiently large ni moreover we have c x ni z x r c zx ni z c rx r c r x r x r c zx ni z c rx r since limi x ni r x r the above inequality implies that c x ni z x r c x ni for sufficiently large ni but this contradicts with that x ni is an optimal solution of the master problem at iteration ni which is a relaxation of micp therefore we have proved that x is an optimal solution of 25 for any ni that is sufficiently large since x ni z x z for sufficiently large ni x is also an optimal solution of 24 lemma 3 3 consider the following convex program min c x s t ax b gx h x c 26 where c is a general convex set in rn assume that 26 is bounded and it has a non empty relative interior suppose x is an optimal solution of 26 then the optimal value of the following linear program is equal to c x min c x s t ax b gx h x x 0 27 where nc x r 1 na x r 2 ng x are three vectors obtained by the oracle in proposition 2 1 such that c r 1 r 2 the nota tions na x ng x and nc x represent the normal cones of the sets x ax b x gx h and c at x respectively proof since the relative interior of the feasible set in 26 is non empty the normal cone n x can be represented as 27 corollary 23 8 1 n x na x ng x nc x where the sum is the minkowski sum since x is a minimizer of 26 we have 0 c n x 28 theorem 1 1 1 the oracle from proposition 2 1 can generate r 1 na x r 2 ng x and nc x such that c r 1 r 2 where r 1 r 2 and can be zero notice that the equation c r 1 r 2 implies that the optimality condition of 27 is satisfied at x which concludes the proof remark 3 1 the supporting valid inequality x x 0 given by lemma 3 3 is added at the solution polishing step lines 22 23 of algorithm 1 addition of these inequalities allows us to develop a proof for solving a mixed integer conic program using a finite number of inequalities theorem 3 1 algorithm 1 terminates with an optimal solution of micp in finitely many iterations after adding a finite number of cutting planes title suppressed due to excessive length 13 proof we prove by contradiction assume that algorithm 1 does not terminate in a finite number of iterations then let x n n 0 be the master problem solutions generated by the algorithm since the infinite sequence is bounded it must contain a convergent subsequence namely x ni i 1 assume that x is the limit point of this subsequence by lemma 3 1 we know that x bd c we focus on proving that l ni u ni for a sufficiently large ni and hence the algorithm should terminates line 17 from proposition 3 1 and lemma 3 2 we have an i such that x ni z x z z l 1 for any i i and we have u ni u where u is defined as u min c x s t ax b xz x z x c 28 from algorithm 1 x ni and l ni are an optimal solution and the optimal value of the following mixed integer linear program min c x s t ax b x k z k x x k z k z k k ni 1 c k x d k k i ni 1 x zl 1 rl 2 29 note that the constraints c k x d k for all k i ni 1 are the supporting valid inequalities generated at step 3 when x k bd c and c ns k x k algorithm 1 line 22 these supporting valid inequalities pass through the point x k bd c which is an optimal solution of 28 therefore the fol lowing relation holds l ni min c x s t ax b x zl 1 rl 2 x k z k x x k z k z k k ni 1 c k x d k k i ni 1 min c x s t ax b xz x z x r l 1 l 2 x k z k x x k z k z k k ni 1 c k x d k k i ni 1 min c x s t ax b xz x z x r l 1 l 2 c k x d k k i ni 1 min c x s t ax b xz x z x r l 1 l 2 x c u u ni where we use lemma 3 3 to replace c k x d k with x c in the third equality in the above analysis this concludes the proof 14 fengqiao luo sanjay mehrotra 4 a finitely convergent cutting plane decomposition algorithm for solving jmicp we now focus on developing a finitely convergent cutting plane decomposition algorithm for jmicp the general idea of this algorithm is as follows the problem jmicp is decomposed into a first stage master problem in the space of x and a second stage in the space of y where is an auxiliary variable which helps reformulating the nonlinear convex objective g 0 x y into a constraint in particular the master problem at the beginning of iteration mth is formulated as the following mixed 0 1 linear program min x x 0 1 l 1 s t akx bk k m 1 rm 1 x sm 1 0 30 where akx bk is a valid inequality added to the first stage at a previous iteration k rm 1 x sm 1 0 are convexification cutting planes generated before iteration m the details on generation of these inequalities are given later the algorithm calls the cutting plane oracle from 7 to solve the mas ter problem and obtain the first stage solution xm upon termination of the cutting plane oracle the convexification cuts are updated to be rmx sm 0 at the second stage of iterationm one needs to solve the following problem to optimality min y y zl 2 rl 3 s t g 0 x m y gi x m y 0 i i 31 we will develop a generalized parametric cutting plane algorithm which shares the same spirit as the cutting plane algorithm developed in section 2 to solve 31 such that upon termination the parametric cutting plane algorithm gen erates the following linear relaxation problem of 31 min r y rl 1 rl 2 s t cmxm dmy em fm 32 where the matrices satisfy the following conditions there exists a common optimal solution ym m of 31 and 32 the linear inequalities cmx dmy em fm are valid for the orig inal feasible set x y g 0 x y gi x y 0 i i x x 0 1 l 1 y y zl 2 rl 3 of jmicp let m 0 be the optimal dual vector corresponding to the constraints in 32 we can then generate the following bender s cut using the strong duality m cmx m fm 33 title suppressed due to excessive length 15 the above inequality will serve as an additional inequality added to the master problem 30 at the end of iterationm i e am x bm with am cm m and bm m fm the core of the decomposition algorithm is to generate the linear relaxation 32 of 31 with the desired properties in section 4 1 we present a parametric cutting plane algorithm to obtain the linear relaxation and in section 4 2 we provide the decomposition algorithm based on the parameter cut generation the convergence properties are analyzed 4 1 the parametric cutting plane algorithm we develop a generalized parametric cutting plane algorithm for solving a general parametric mixed integer convex program in the form min y y zl 2 rl 3 h y s t gi x 0 y 0 i i 34 where x 0 x 0 1 l 1 is the problem parameter which is fixed when solving 34 but it is subject to change and x is a polyhedral set notice that 31 is a special case of 34 after incorporating as a component of y this algorithm is established based on the parametric cutting plane oracle developed in 29 for solving the following parametric mixed integer linear program to optimality min y zl 2 rl 3 q y s t wx 0 ty r 35 with x 0 x 0 1 l 1 be the problem parameter assume that for any x x 0 1 l 1 the problem is feasible in y once 35 is solved to optimality by the oracle the oracle generates an equivalent linear program as follows min y rl 2 rl 3 q y s t w x 0 t y r 36 such that the two problems have a shared optimal solution and the inequalities w x t y r which have incorporated all cuts generated by the oracle are valid for all x x 0 1 l 1 the generalized parametric cutting plane algorithm works as follows at the beginning of the nth main iteration of the algorithm we encounter a master problem in the form min h y s t a k x 0 b k y c k 0 k n 1 c k x 0 d k y d k k i n 1 pms n 16 fengqiao luo sanjay mehrotra where a k x 0 b k y c k 0 is the cutting plane generated at iter ation k induced by a projection problem and c k x 0 d k y d k are outer approximation cuts generated similarly as described in section 2 we now highlight the differences of generating the projection cuts and the outer approximation cuts for the parametric problem as compared with the general micp in section 2 suppose y n is an optimal solution of pms n the projection problem that leads to a n x 0 b n y c n 0 is formulated as min x x 0 2 y y n 2 s t gi x y 0 i i y y 37 let x y be the optimal solution of the projection problem then the co efficients of the inequality are determined by the hyperplane passing through x y with the norm vector x 0 x y n y specifically we have a n x 0 x b k y n y and c n x 0 x x y n y y note that the general form of the projection cut should be a n x b n y c n 0 we set x to be x 0 in pms n the supporting valid inequalities at iteration n are generated based on following similar procedures as described in section 2 first we solve a convex optimization problem in which all integer variables are fixed min h y s t gi x 0 y 0 i i yz y n z y y 38 where yz represent the integer variables in y let y be an optimal solution of 38 the linearity of the objective implies that the point x 0 y must be on the boundary of the set v x y gi x y 0 i i y y 39 it is shown in proposition 2 1 and lemma 4 1 that one can obtain ri cone ygi x 0 y for every i i 0 where i 0 is the index set of active con straints at x 0 y and r ny y such that the following inequalities can be generated to ensure that 45 holds when setting x x 0 see remark 4 1 r x i x x 0 r i y y 0 i i 0 40 r y y 0 41 where rx i is an arbitrary element chosen from xgi x 0 y for every i i 0 the above two sets of supporting inequalities are represented in a generic form c n x d n y d n 42 in the algorithm while setting x x 0 and they are added into pms n at the end of iteration n it is shown in theorem 4 1 that the inequalities 42 are valid for all x y from the set s x y gi x y 0 i i y y title suppressed due to excessive length 17 which satisfies the conditions given between 32 and 33 for generating a valid bender s cut for the first stage problem discussed at the beginning of section 4 this is discussed in section 4 2 the pseudo code of the generalized parametric cutting plane algorithm for solving pms n is given in algorithm 2 lemma 4 1 let y be an optimal solution of 38 if the point x 0 y bd y then the following relation holds h i i 0 cone ygi x 0 y cone 1 z 0 r ny y 43 where i 0 i is the index set of active constraints in gi i i at the point x 0 y 1 z 0 r is the vector that has all ones at the integer components and all zeros at other components of the vector y and ny y is the normal cone of y at y the oracle provided in proposition 2 1 can generate ri cone ygi x 0 y i i 0 a number 0 and r ny y such that h i i 0 ri 1 z 0 r r 44 where the addition follows the minkowski rule consequently the following relation on the optimal objective holds min h y s t gi x 0 y 0 i i yz y n z y y min h y s t r i y y 0 i i 0 yz y n z r y y 0 45 proof note that 43 is exactly the optimality condition of the problem 38 at y y which should obviously hold to show that 45 holds we first observe that y y is a feasible solution to the linear program on the right side of 45 furthermore the optimality condition of the linear program is exactly the same as 44 which is clearly satisfied at y y this concludes the proof remark 4 1 the linear constraint r i y y 0 for ri cone ygi x 0 y and i i 0 of the linear program on the right side of 45 can be alternatively written as r x x x 0 r i y y 0 for some rx xgi x 0 y and then set x x 0 notice that the later inequalities in the x y space are valid for the set v x y gi x y 0 i i y y guaranteed by assumption 2 the later representation is used to generate a bender s cut for the first stage master problem theorem 4 1 suppose assumptions 2 and 3 hold the generalized parametric cutting plane algorithm algorithm 2 can solve the parametric mixed integer convex program 34 to optimality in a finite number of iterations all inequal ities a k x b k y c k 0 and c k x d k y d k added to the master problem pms n are valid for points in the set s x y gi x y 0 i i y y 18 fengqiao luo sanjay mehrotra proof first we notice that all cuts added the master problem pms n are used to build an outer approximation of the set s which can be seen from how these cuts are generated therefore they are valid for all points in s it remains to show that the algorithm converges to an optimal solution of 34 in a finite number of iterations if not there exists a convergent sub sequence denoted as x 0 y nk k 1 which converges to a point x 0 y similarly as in the proof of theorem 3 1 one can show that x 0 y is an optimal solution of pms n y nk z y z for any sufficiently large nk and also x 0 y must be a point in the sub sequence x 0 y nk k 1 due to 45 this indicates that the algorithm must terminate in a finite number of iterations we now discuss the need of assumption 2 in generating a valid parametric cut suppose x 0 y is on the boundary of the set v defined in 39 for simplicity let us assume that gi x y 0 is the only active constraint at x 0 y i e gi x 0 y 0 gi x 0 y 0 for all i i i and y int y the necessary and sufficient condition for an inequality a x x 0 b y y 0 46 to be valid for all points in the set v is a b nv x 0 y the normal cone of v at x 0 y which is equivalent to a b gi x 0 y in this case when we fix x 0 and solve 38 to get y the optimality condition is written as h cone ygi x 0 y cone 1 z 0 r to get an equivalent linear program of 38 we generate a b ygi x 0 y and a number 0 using the oracle from proposition 2 1 such that h b 1 z 0 r to lift a valid inequality generated in the space of y fixing x x 0 to the space of x y and maintaining its validity requires existence of an a such that a b gi x 0 y since in general f x y 6 xf x y yf x y the existence of a is not guaranteed in the general case assumption 2 makes lifting of inequality from the y space to x y space achievable 4 2 a decomposition cutting plane algorithm for jmicp we now focus on developing a cutting plane decomposition algorithm for solv ing jmicp to optimality the master problem 30 can be progressively up dated by adding bender s cuts generated from solving the second stage prob lem 31 specifically algorithm 2 is applied to solve 31 to optimality and when the algorithm terminates it generates a mixed integer linear program milp that has a same optimal solution as 31 the milp is solved to opti mality with the cutting plane oracle from 12 and the oracle generates a linear program whose optimal solution is same as that of the milp suppose the lin ear program at the main iteration m is denoted as 32 then the bender s title suppressed due to excessive length 19 algorithm 2 an algorithm for solving a parametric mixed integer convex program 1 set n 1 flag 0 and i 0 2 while flag 0 do 3 start iteration n 4 step 1 solve the master problem pms n using the cutting plane oracle from 12 5 to get an optimal solution y n and optimal objective denoted as l n 6 let y n y n z y n r where y n z zl 2 and y n r rl 3 7 if x 0 y n s then 8 stop and return y n as an optimal solution of micp 9 else 10 continue 11 end if 12 step 2 solve 37 to get the projection point x y of x 0 y n on s 13 add the separation projection cut a k x 0 b k y c k 0 to pms n 14 step 3 solve the continuous convex program 38 15 if 38 is feasible then 16 let u n be the optimal value of 38 17 if l n u n then 18 stop and return an optimal solution of 38 as an optimal solution of pms n 19 end if 20 if 38 has a solution y such that x 0 y bd v defined in 39 then 21 generate a finite number of supporting valid inequalities as defined in 42 c n x 0 d n y d n 47 22 and add them to pms n 23 set i n i n 1 n 24 end if 25 else 26 set i n i n 1 27 end if 28 n n 1 29 end while 30 return y n cut 33 is generated and added to the master problem for the main iteration m 1 the pseudo code of the cutting plane decomposition algorithm is given in algorithm 3 theorem 4 2 suppose assumptions 1 2 and 3 hold the decomposition cutting plane algorithm algorithm 3 returns an optimal solution to jmicp in a finite number of iterations proof we first show that the parametric cut generated for the first stage prob lem at every iteration is valid it suffices to show that for any feasible solution x y of jmicp the following inequality holds g 0 x y a mx bm m 48 where amx bm is the bender s cut generated at the main iteration m recall that when the generalized parametric cutting plane algorithm is 20 fengqiao luo sanjay mehrotra applied to solve the second stage problem 31 it generates a master problem and updates the master problem at every iteration by adding convexification cuts by theorem 4 1 the convexification cuts added to the master problem are valid for the set s x y g 0 x y gi x y 0 i i y y it implies that the linear program obtained upon termination of algorithm 2 has the form min s t m 1 x m m 2 y m 3 0 wherem 1 m 2 andm 3 are some coefficient matrices and the inequality system m 1 x m 2 y m 3 0 forms a linear relaxation of s then it follows that the bender s cut amx bm generated from the linear program should be valid for the set x y g 0 x y gi x y 0 i i x x y y for the first stage solution xm obtained at the main iterationm let obj 2 x m denote the optimal objective of the second stage problem 31 at x xm when the second stage problem is solved to optimality by algorithm 2 a lin ear program is obtained upon termination the linear program has the same optimal solution and optimal value as the second stage problem strong dual ity implies that obj 2 x m amxm bm let lm and um be the value of l and u at the end of main iteration m suppose algorithm 3 does not termi nate since the feasible set x 0 1 l 1 is finite there exist m and n such that xm xn we have obj 2 xm u m lm ln anxn bn obj 2 xn 49 since xm xn we should have lm um and hence the algorithm should terminate at the main iteration m algorithm 3 a decomposition cutting plane algorithm for jmicp 1 set m 1 l and u 2 while l u do 3 solve the current first stage problem 30 for the main iteration m using the cutting plane oracle from 12 and get the optimal solution xm 4 set l the optimal value of 30 5 substitute xm into the parametric minlp 31 and apply algorithm 2 to solve it 6 set u the optimal value of 31 with x xm 7 when algorithm 2 terminates with an optimal solution to 31 a linear program 32 is established generate a bender s cut 33 from the dual objective of 32 and add it to 30 as amx bm 8 set m m 1 9 end while 10 return xm as an optimal solution of jmicp title suppressed due to excessive length 21 5 a parametric cutting plane algorithm for solving distributionally robust two stage stochastic mixed integer convex programs the cutting plane algorithm algorithm 1 can be naturally applied to solve a special class of two stage mixed integer convex programs with finite con vergence this application is established and analyzed in the current section we consider a class of two stage stochastic mixed integer convex programs tss micp with the following properties the objectives of the first and second stage problems are linear functions the first stage variables are pure binary the first stage constraints can be nonlinear but convex the second stage decision variables can be mixed integer the second stage constraints can be nonlinear but convex in particular the tss micp that we investigate is formulated as min x 0 1 l 1 c x max p p e p q x s t ax b x c 50 where c is a convex set for the first stage variable is a random vector having a finite support denoted as is a finite set of scenarios p is a candidate probability distribution of p is the ambiguity set of all candidate probability distributions and q x is the recourse function at the scenario note that since is a finite set an element in p can be represented as a dimensional vector in 0 1 we further assume that the ambiguity set p is allowed to be any convex set on r the recourse function q x is given as q x min y zl 2 rl 3 q y s t gj s j y t j x r j 0 j j 51 where every gj is a smooth convex function q s j t j and r j are scenario based coefficients we denote the minimization problem in 51 as sub x we consider a typical iteration where the values of first stage variables are given as x consider the second stage sub problem for scenario consider applying algorithm 1 to solve this sub problem when the algorithm terminates cuts have been added suppose the linear program at the termination is given as min y rl 2 l 3 q y s t q y s r x dual 0 52 where q r and s are appropriate matrices and vectors of coefficients that represent the complete set of cutting planes as well as the original linear constraints at termination the lp relaxation should give the same objective as 51 this property is formally stated as follows 22 fengqiao luo sanjay mehrotra lemma 5 1 the termination criteria and theorem 3 1 ensures that the op timal objective of 52 must be equal to q x we then determine a worst case probability distribution with respect to the first stage solution x by solving the following convex optimization problem recall that p is a convex set in r max p p p q x 53 finally we generate an aggregated benders cut for the first stage master problem based on the optimal values of dual variables associated with the constraints q y s r x and the worst case probability distribution p specifically let be the optimal value of the dual variables we can construct the following aggregated benders cut p r x p s 54 where p is the probability of scenario obtained from solving 53 this cut is added to the first stage master problem of 50 so at the mth main iteration the first stage master problem of 50 is given as min x c 0 1 l 1 c x s t ax b p k rk x p k sk k m 1 55 where p k rk x p k sk is the benders cut added to the master problem at the kth 1 k m 1 iteration of the main algorithm note that 55 is a mixed 0 1 linear convex program which can again solved using algorithm 1 the first stage solution of 55 the mth iteration master problem is then fed to each scenario sub problem and gen erate the benders cut indexed by iteration m the above procedures present a typical iteration of an algorithm for solving 50 the cutting plane method we propose for solving 50 to optimality is given in algorithm 4 its finite convergence is proved in the following theorem theorem 5 1 let assumption 3 hold algorithm 4 returns an optimal solu tion of 50 after finitely many iterations proof the proof is similar to the proof of theorem 2 1 in 29 let the first stage problem at main iteration k be denoted by master k lemma 5 1 and title suppressed due to excessive length 23 algorithm 4 a decomposition cutting plane algorithm for solving 50 1 initialization l u m 1 2 while u l 0 do 3 solve the first stage problem 55 to optimality with main iteration index being m 4 let m xm be the optimal solution 5 update the lower bound as l c x m m 6 set the current best solution as x xm 7 for do 8 solve the second stage problem sub xm to optimality using algorithm 1 9 when algorithm 1 terminates it generates a lp relaxation 52 with x xm 10 get the optimal values of the dual variables of 52 and denote them as m 11 end for 12 obtain the worst case probability distribution pm pm 13 by solving 53 with x xm 14 generate the following aggregated benders cut with iteration index m 15 pm m rm x pm m sm 16 add the benders cut to the first stage problem 55 17 update the upper bound as u min u c xm pm q xm 18 m m 1 19 end while 20 return x the strong duality of 52 imply that q xk k rk xk k sk therefore we have g xk max p p ep q x k pk k rk xk pk k sk 56 based on the mechanism of the algorithm it is clear that if the algorithm terminates in finitely many iterations it returns an optimal solution we only need to show that the algorithm must terminate in finitely many iterations assume this property does not hold then it must generate an infinite sequence of first stage solutions xk k 1 we must have k 1 and k 2 so that x k 1 xk 2 with k 1 k 2 at the end of iteration k 1 the upper bound u k 1 satisfies uk 1 c xk 1 pk 1 q xk 1 c yk 1 g xk 1 57 where 56 is used to obtain the last equation the optimal value of master k 2 gives a lower bound lk 2 c xk 2 k 2 since k 2 k 1 master k 2 has the following constraint pk 1 k 1 rk 1 x pk 1 k 1 sk 1 58 24 fengqiao luo sanjay mehrotra therefore we conclude that lk 2 c xk 2 k 2 c xk 2 pk 1 k 1 rk 1 xk 2 pk 1 k 1 sk 1 c xk 1 pk 1 k 1 rk 1 xk 1 pk 1 k 1 sk 1 c xk 1 g yk 1 uk 1 uk 2 59 where we use the fact that xk 1 xk 2 and inequalities 57 58 to obtain 59 hence we have no optimality gap at solution xk 1 and the algorithm should have terminated at or before iteration k 2 6 a numerical example of the cutting plane algorithm let us consider the following tss micp min x 1 x 2 0 1 x 1 2 x 2 e q x s t 3 x 1 x 2 2 60 where there are only two scenarios 1 2 with equal probability the recourse function at the two scenarios are given as q x 1 min y 11 y 12 z 0 5 y 11 y 12 s t 2 y 11 log 1 e y 12 log 1 e y 11 y 12 x 1 x 2 1 61 q x 2 min y 21 y 22 z y 21 y 22 s t log 1 e y 21 y 22 log 1 e y 21 y 22 x 1 x 2 1 62 the master problem at iteration 1 is simply min x 1 2 x 2 s t 3 x 1 x 2 2 0 x 1 x 2 0 1 the relaxation problem yields the fractional solution x 1 x 2 2 3 0 we further add a cut x 1 1 and resolve the master problem which gives the optimal solution x 1 x 2 1 0 substituting the first stage solution x 1 x 2 1 0 into 61 and solving the continuous relaxation sub problem yields a fractional solution y 11 y 12 0 5 0 48 which is on the curve 2 y 11 log 1 e y 12 log 1 e y 11 y 12 0 we add the tangent cut 1 272 y 11 0 586 y 12 0 918 induced by this fraction solution to the relaxation sub problem then we solve the following relaxed milp min 0 5 y 11 y 12 s t 1 272 y 11 0 586 y 12 0 918 0 y 11 y 12 z title suppressed due to excessive length 25 by adding a cut y 11 y 12 1 to the linear relaxation of the above milp which leads to the integral solution y 11 y 12 1 0 of 61 for the given first stage value x 1 x 2 1 0 similarly substituting x 1 x 2 1 0 into 62 and solving the continuous relaxation gives the solution y 21 y 22 0 5 0 5 we add a tangent cut y 21 y 22 1 induced by this fractional solution to the relaxation sub problem then we solve the following relaxed milp min y 11 y 12 s t y 11 y 12 1 0 y 11 y 12 z which leads to an integral optimal solution y 21 y 22 1 0 notice that the eventual linear program that leads to the integral solution y 11 y 12 1 0 of 61 is min 0 5 y 11 y 12 s t y 11 y 12 1 x 1 x 2 1 y 11 y 12 0 the bender s cut associated with this scenario problem is 1 1 0 5 x 1 0 5 x 2 similarly the bender s cut associated with the scenario 2 problem is 2 2 x 1 x 2 the aggregated bender s cut is 1 5 0 75 x 1 x 2 adding this aggregated bender s cut to the master problem gives min x 1 2 x 2 s t 3 x 1 x 2 2 1 5 0 75 x 1 x 2 x 1 x 2 0 1 0 solving the above updated master problem gives the first stage solution x 1 x 2 1 0 which is the same as the previous iteration this indicates that the op timal solution is x 1 x 2 1 0 references 1 padberg m rinaldi g a branch and cut algorithm for the resolution of large scale symmetric traveling salesman problems siam review 33 1 60 100 1991 2 mitchell j e branch and cut algorithms for combinatorial optimization problems in p m pardalos m g c resende eds handbook of applied optimization 1 pp 65 77 oxford university press 2002 3 cornue jols g valid inequalities for mixed integer linear programs mathematical programming 112 1 3 44 2008 4 balas e ceria s cornue jols g natraj n gomory cuts revisited operations research letters 19 1 1 9 1996 5 padberg m w roy t j v wolsey l a valid linear inequalities for fixed charge problems operations research 33 4 842 861 1985 6 roy t j v wolsey l a valid inequalities and separation for uncapacitated fixed charge networks operations research letters 4 3 105 112 1985 7 balas e ceria s cornue jols g a lift and project cutting plane algorithm for mixed 0 1 programs mathematical programming 58 295 324 1993 8 balas e disjunctive programming and a hierarchy of relaxations for discrete optimiza tion problems siam j on algebraic and discrete methods 6 3 466 486 1985 9 balas e disjunctive programming properties of the convex hull of feasible points discrete applied mathematics 89 3 44 1998 10 owen jonathan h mehrotra s a disjunctive cutting plane procedure for general mixed integer linear programs mathematical programming 89 3 437 448 2001 11 owen j h mehrotra s a disjunctive cutting plane procedure for general mixed integer linear programs computational optimization and applications 20 159 170 2001 26 fengqiao luo sanjay mehrotra 12 chen b simge ku c u kyavuz s s finite disjunctive programming characterizations for general mixed integer linear programs operations research 59 1 202 210 2011 13 jo rg m k disjunctive cuts and a finite cutting plane algorithm for general mixed integer linear programs 2007 https arxiv org pdf 0707 3945 pdf 14 duran m grossmann i an outer approximation algorithm for a class of mixed integer nonlinear programs mathematical programming 36 3 307 339 1986 15 tawarmalani m sahinidis n v a polyhedral branch and cut approach to global optimization mathematical programming 103 2 225 249 2005 16 hijazi h bonami p ouorou a an outer inner approximation for separable mixed integer nonlinear programs informs journal on computing 26 1 31 44 2014 17 vielma j p dunning i huchette j lubin m extended formulations in mixed integer conic quadratic programming mathematical programming computation 9 3 369 418 2017 18 abhishek k leyffer s linderoth j filmint an outer approximation based solver for convex mixed integer nonlinear programs informs journal on computing informs journal on computing 22 4 555 567 2010 19 bonami p biegler l conn a cornue jols g grossmann i laird c lee j lodi a margot f sawaya n wachter a an algorithmic framework for convex mixed integer nonlinear programs discrete optimization 5 2 186 204 2008 20 lubin m yamangil e bent r vielma j p polyhedral approximation in mixed integer convex optimization mathematical programming pp 139 168 2018 21 gade d ku c u kyavuz s sen s decomposition algorithms with parametric gomory cuts for two stage stochastic integer programs mathematical programming 144 39 64 2014 22 zhang m ku c u kyavuz s finitely convergent decomposition algorithms for two stage stochastic pure integer programs siam journal on optimization 24 4 1933 1951 2014 23 bansal m huang k l mehrotra s tight second stage formulations in two stage stochastic mixed integer programs siam journal on optimization 28 788 819 2018 24 bansal m zhang y scenario based cuts for structured two stage stochastic and distributionally robust p order conic mixed integer programs journal of global opti mization 2021 url https doi org 10 1007 s 10898 020 00986 w 25 atamtu rk a narayanan v conic mixed integer rounding cuts mathematical pro gramming 122 1 20 2008 26 sen s sherali h d decomposition with branch and cut approaches for two stage stochastic mixed integer programming mathematical programming 106 203 223 2006 27 rochafellar r t convex analysis princeton university press 1970 28 hiriart urruty j b lemare chal c convex analysis and minimization i springer verlag 1993 29 luo f mehrotra s a decomposition method for distributionally robust two stage stochastic mixed integer conic programs mathematical programming 2021 https doi org 10 1007 s 10107 021 01641 2 https arxiv org pdf 0707 3945 pdf https doi org 10 1007 s 10898 020 00986 w https doi org 10 1007 s 10107 021 01641 2 1 introduction 2 an algorithm for mixed integer convex programs using cutting planes 3 convergence analysis for the cutting plane algorithm 4 a finitely convergent cutting plane decomposition algorithm for solving jmicp 5 a parametric cutting plane algorithm for solving distributionally robust two stage stochastic mixed integer convex programs 6 a numerical example of the cutting plane algorithm