ar x iv 2 00 3 00 96 3 v 1 m at h o c 2 m ar 2 02 0 piecewise linear valued constraint satisfaction problems with fixed number of variables manuel bodirsky institut f r algebra technische universit t dresden marcello mamino dipartimento di matematica universit di pisa caterina viola institut f r algebra technische universit t dresden abstract many combinatorial optimisation problems can be modelled as valued constraint sat isfaction problems in this paper we present a polynomial time algorithm solving the valued constraint satisfaction problem for a fixed number of variables and for piecewise linear cost functions our algorithm finds the infimum of a piecewise linear function and decides whether it is a proper minimum 1 introduction the input of a valued constraint satisfaction problem or vcsp for short is a finite set of cost functions depending on a given finite set of variables and the computational task is to find an assignment of values for the variables that minimises the sum of the cost functions many computational optimisation problems arising in industry business manufacturing and science can be modelled as a vcsp vcsps have been extensively studied in the case of cost functions defined on a fixed finite set the domain the computational complexity of solving vcsps depends on the set of allowed cost functions and has recently been classified if the domain is finite 13 12 14 21 3 every finite domain vcsp is either polynomial time tractable or it is np complete however many outstanding combinatorial optimisation problems can be formulated as vcsps only by allowing cost functions defined on infinite domains e g the set q of rational numbers despite the interest in concrete vcsps over the set of rational numbers and over other infinite numeric domains e g the integers the reals or the complex numbers vcsps over infinite domains have not yet been investigated systematically the class of vcsps for all sets of cost functions defined on arbitrary infinite domains is too large to allow gen eral complexity results indeed every computational problem is polynomial time turing equivalent to the vcsp for a suitable set of cost functions over an infinite domain 1 therefore we need to restrict the class of cost functions that we focus on one restriction the authors have received funding from the european research council erc under the european union s horizon 2020 research and innovation programme grant agreement no 681988 csp infinity this author has been supported by dfg graduiertenkolleg 1763 quantla 1 http arxiv org abs 2003 00963 v 1 that captures a great variety of theoretically and practical interesting optimisation prob lems is the class of all piecewise linear pl cost functions over q i e q valued 1 partial functions whose graph is the union of linear half spaces in general the vcsp for pl cost functions is np complete indeed the containment in np follows from the fact that the vcsp for the class of all pl cost functions is equivalent to the existential theory of q 1 which is in np see 2 the np hardness follows from the fact that there exist np complete problems e g the minimum correlation clustering and the minimum feedback arc set problem see 9 6 which can be formulated as in stances of the vcsp for pl cost functions in this paper we prove that the restriction of the vcsp for all pl cost functions to instances with a fixed number of variables is polynomial time tractable the restriction to a fixed number of variables has been studied for several problems in computational optimisation and usually this kind of restriction has led to an improvement in the com putational complexity two remarkable examples of this situation are the combinatorial polynomial time algorithm of megiddo 16 to solve the restriction to a fixed number of variables of linear programming in its full generality linear programming can be solved in polynomial time see e g 10 8 20 but all the known algorithms rely on approximation procedures and the algorithm of lenstra 15 to solve the restriction of integer programming feasibility which is an np complete problem in its full generality to a fixed number of variables 2 preliminaries we adopt the following notation q denotes the set of rational numbers and xi denotes the i th component of a tuple x we start with some preliminaries on the cost functions that we want to take into account definition 2 1 a cost function over q is a function f qn q for a positive integer n here is an extra element with the expected properties that for all c q c c and c iff c q a cost function f qn q can also be seen as a partial function such that f is not defined on x qn if and only if f x definition 2 2 a set c qd is a polyhedral set if it is the intersection on finitely many open or closed half spaces i e it can be specified by a conjunction of finitely many linear constraints i e for some r n there exist linear functions fi q d q for 1 i r such that c x qd p i 1 fi x 0 q i p 1 fi x 0 r i q 1 fi x 0 observe that non empty polyhedral sets in qd are in particular convex sets a polyhedral set c qd is open if it is the intersection of finitely many open half spaces i e for some p n there exist fi q d q linear functions 1 i p such that c x qd p i 1 fi x 0 1 in the pl setting the domains q and r are interchangeable we only require the coefficients of the cost functions to be rational as we need to manipulate them computationally 2 similarly a polyhedral set c qd is closed if it is the intersection of finitely many closed half spaces i e for some q n there exist fi q d q linear functions 1 i p such that c x qd p i 1 fi x 0 q i p 1 fi x 0 a polyhedral set c qn is bounded if it is bounded as a subset of qn we remark that the infimum of a linear function in a closed and bounded polyhedral set is a proper minimum while the infimum of a linear function in an open or unbounded polyhedral set is attained only if the linear function is constant definition 2 3 18 definition 2 47 a function f qd q is a piecewise lin ear pl if its domain dom f can be represented as the union of finitely many polyhedral sets relative to each of which f x is given by a linear expression i e there exist finitely many mutually disjoint c 1 cm polyhedral sets such that m i 1 ci dom f q d and f x 1 xd ai 0 a i 1 x 1 a i d xd if x 1 xd ci if x 1 xd q d dom f where ai ai 0 a i 1 a i d qd 1 for 1 i m piecewise linear functions are some times called semilinear functions we are now ready to formally define the computational problem that we want to focus on definition 2 4 let d be a positive integer and let v x 1 xd be a set of variables an instance i of the valued constraint satisfaction problem vcsp for pl cost functions with variables in v consists of an expression of the form m i 1 fi x i 1 x i ar fi where f 1 fm are finitely many pl cost functions and all the x i j are variables from v the task is to find the infimum cost of defined as inf v q m i 1 fi x i 1 x i ar fi and to decide whether it is attained i e whether it is a proper minimum or not the computational complexity of the vcsp for pl cost functions with variables from a fixed set v depends on how the cost functions are represented in the input instances we fix a representation of cost functions which is strictly related both to the mathematical properties of piecewise linear functions and to the algorithmic procedures and mathemat ical tools that we want to use to deal with them definition 2 5 representation of pl cost functions we assume that a pl cost func tion is given by a list of linear constraints specifying the polyhedral sets and a list of linear polynomials and symbols defining the value of the function relatively to each polyhedral set the linear constraints and the linear polynomials are encoded by the list of their rational coefficients and is represented by a special symbol the constants for numerators and denominators of rational coefficients for linear constraints and linear polynomials are represented in binary linear programming is an example of a problem which can be formulated in our setting it is also a tool that plays an important role later in the paper 3 definition 2 6 linear programming lp is an optimisation problem with a linear objective function and a set of linear constraints imposed upon a given set of underlying variables a linear program has the form minimise n j 1 c jx j subject to n j 1 a i jx j b i for i 1 m this problem has n variables x j ranging over the rationals or over the real numbers and m linear inequalities constraints the coefficients c j a i j and b i are rational numbers for all j 1 n and all i 1 m the linear constraints nj 1 a i jx j b i specify a polyhedral set namely the feasibility polytope over which the objective function has to be optimised an algorithm solving lp either finds a point in the feasibility polytope where the objective function has the smallest value if such a point exists or it reports that the instance is infeasible in this case we assume that the output of the algorithm is or it reports that the infimum of the objective function is in this case we assume that the output of the algorithm is the linear program feasibility problem lpf is a decision problem having the form of a standard linear program but without any objective function to minimise the output of an algorithm solving lpf is no or yes respectively depending on whether the polyhedral set defined by the linear constraints is empty or not both lp and lpf can be solved in polynomial time see e g 10 8 20 in the remainder of the paper we use the fact that linear program feasibility for a set of linear constraints containing also strict inequalities can be solved in polynomial time given a set of linear constraints l and a linear expression obj we denote by lpf l the lpf instance defined by the linear constraints in l and we denote by lp l obj the lp instance defined by the linear constraints in l and by the objective function obj we remark that in lp and lpf the feasibility polytope is defined by weak linear in equalities i e by linear constraints of the form nj 1 a jx j b the feasibility of a set of linear constraints containing also strict linear inequalities i e of the form nj 1 a jx j b can be solved by solving a linear number of linear programs as shown in 7 where the authors give a polynomial time algorithm deciding the feasibility of a set of horn disjunc tive linear constraints however the feasibility of a set of linear constraints containing strict and weak linear inequalities can be decided by solving only one lp instance lemma 2 7 motzkin transposition theorem 17 19 let a qk 1 d and b qk 2 d be matrices such that max k 1 d 1 the system ax 0 bx 0 has a solution x qd if and only if the system at y bt z 0 y 0 z 0 does not admit a solution y z qk 1 k 2 such that y 6 0 0 proposition 2 8 the linear program feasibility problem lpf for a finite set of strict or weak linear inequalities is polynomial time many one reducible to lp and therefore it can be solved in polynomial time 4 proof let us assume that the linear constraints in the input consist of k 1 strict inequalities and k 2 weak inequalities i e we have to check the satisfiability of the following system d i 1 a j ixi a j d 1 0 for 1 j k 1 d i 1 b j ixi b j d 1 0 for 1 j k 2 1 let us first observe that the system 1 is equivalent to the following one d 1 i 1 a j iti 0 for 1 j k 1 td 1 0 d 1 i 1 b j iti 0 for 1 j k 2 2 indeed if t 1 td td 1 is a solution for 2 then x 1 xd with xi ti td 1 is a solution for 1 vice versa if x 1 xd is a solution for 1 then x 1 xd 1 is a solution for 2 let us consider the following linear program minimise k 1 1 j 1 y j subject to at y bt z y 0 3 z 0 with variables y 1 yk 1 1 z 1 zk 2 where a q k 1 1 d 1 is the matrix such that a ji a ji for 1 j k 1 and 1 i d 1 and such that the k 1 1 th row of a is 0 0 1 and the matrix b q k 2 d 1 is such that b ji b ji observe that the linear program 3 can be computed in polynomial time in the size of the input by lemma 2 7 the system 2 is satisfiable if and only if the feasibility polytope determined by the linear constraints in 3 does not admit a solution y z q k 1 1 k 2 such that y 6 0 0 if the output of the algorithm for lp on instance 3 is or a tuple having 0 in the first k 1 1 coordinates then the system 1 is satisfiable and therefore we accept otherwise if the output is or a tuple y z q k 1 1 k 2 such that y 6 0 0 then the system 1 is not satisfiable and we reject 3 pl vcsps with fixed number of variables we exhibit a polynomial time algorithm that solves the vcsp for pl cost functions having variables from a fixed finite set we assume that the input vcsp instance is given as a sum of pl cost functions represented as in definition 2 5 our algorithm computes the infimum of the objective function and specifies whether it is attained i e whether it is a proper minimum the following theorem uses an idea that appeared in 2 observation 17 theorem 3 1 let v be a finite set of variables then there is a polynomial time algorithm that solves the vcsp for pl cost functions having variables in v proof we prove that algorithm 1 correctly solves the vcsp for pl cost functions with variables in v in polynomial time an input of an instance of the vcsp is a representation of an objective function as the sum of a finite number of given cost functions f 1 fn applied to some of the variables in v x 1 xd that is x 1 xd n i 1 fi x i 5 where xi v ar fi for 1 i d we can assume that the cost function fi is defined for every x qd by fi x d j 1 a i l j x j b i l if ci l x for some 1 l mi otherwise for every 1 l mi the formulas ci l x have the following form ci l x p j 1 h i l j x 0 q j p 1 h i l j x 0 r j q 1 h i l j x 0 for some p q r n and for some linear polynomials hi lj q d q where 1 j r we assume that the cost functions fi are represented as in definition 2 5 algorithm 1 first extracts the list of linear polynomials p 1 pk that appear in the finite set of linear constraints defining some cost function fi i e p 1 pk n i 1 mi l 1 j h i l j observe that the linear polynomials p 1 pk decompose the space q d into polyhedral sets where d k d i 0 2 i k i 4 and that this bound is tight i e d k whenever the hyperplanes defined by pi x 0 for 1 i k are in general position inequality 4 can be verified by induction on the number of hyperplanes k clearly for all d n one hyperplane divides qd into 3 20 21 polyhedral sets suppose now that k 3 and that inequality 4 is true for every d and for at most k 1 hyperplanes suppose that the k hyperplanes are in general position we get in this way the upper bound d k observe that by adding the hyperplanes one by one the k th hyperplane intersects at most d 1 k 1 of the polyhedral sets obtained until the previous step in fact this number is equal to the number of polyhedral sets in which a hyperplane that is a subspace of dimension d 1 is divided by k 1 subspaces of dimension d 2 suppose that we know how the space is decomposed into polyhedral sets by the hyper planes p 1 x 0 pk 1 x 0 adding pk x 0 to the list of hyperplanes decompos ing the space each one of the polyhedral sets intersecting it is divided in three polyhedral sets corresponding to pk x 0 pk x 0 and pk x 0 respectively summing up at every step we add to the old polyhedral sets i e polyhedral sets obtained until the previous step two more polyhedral sets for each of the old ones intersecting pk x 0 then it follows that d k d k 1 2 d 1 k 1 using this equality and the inductive hypothesis we obtain d k 2 d 1 i 0 2 i k 1 i d i 0 2 i k 1 i d i 1 2 i k 1 i 1 k 1 i 1 d i 1 2 i k i 1 d i 0 2 i k i in particular the number of polyhedral sets is bounded by a linear polynomial in k and the algorithm 1 produces a tree that a priori has 3 k branches but that actually has o k branches 6 the algorithm computes the list of all non empty polyhedral sets by computing at most k 1 i 1 d i instances of linear program feasibility and then it computes the infimum of the objective function in every non empty polyhedral set by computing at most 3 d k linear programs observe that the only closed and bounded non empty polyhedral sets computed by algorithm 1 are 0 dimensional subspaces i e points and that all the other polyhedral sets computed are open or unbounded therefore in order to check whether the infimum in a polyhedral set c is a minimum it is enough to check whether the objective function in c is constant that is whether the infimum in c is equal to the supremum in c this is done by our algorithm solving at most 3 d k further linear programs the linear expression of the objective function in a polyhedral set can be computed by running a number of linear program feasibility instances that is polynomial in the size of the input instance globally the running time of algorithm 1 is polynomial in the size of the input 7 algorithm 1 algorithm for pl vcsps with a fixed number of variables input x f 1 x fn x with fi x fi j x if x ci j and the ci j s each given as a finite set of linear conditions for 1 j ni and 1 i n output val attr where val is the value of the infimum of the objective function and attr is a string which specifies whether val is attained attr min or not attr inf p 1 pk the set of all the linear functions appearing in the ci j s l the set of polyhedral sets in which the pi s divide the space for i 1 k do for each l in l do l 1 l pi 0 l 0 l pi 0 l 1 l pi 0 for j 1 0 1 do if lpf l j yes then l l l l j end end end end val attr inf for each l in l do lc the closure of l for each c l do if c is of the form p 0 then lc lc p 0 else lc lc c end end for i 1 n do gi for j 1 ni do if lpf l ci j yes then gi x fi j x end end end obj ni 1 gi x m lp lc obj the infimum of in l m lp lc obj the supremum of in l if m val then if m m then attr min the infimum is attained iff is constant in l else attr inf end end end return val attr 8 4 conclusion and future work we have provided a polynomial time algorithm solving the vcsp for piecewise linear cost functions having a fixed number of variables in the future we would like to continue this line of research by studying the computational complexity of the vcsp with a fixed number of variables and semialgebraic cost functions a function f rn r is called semialgebraic if its domain can be represented as the union of finitely many basic semialgebraic sets see 2 of the form x rn x where is a conjunction of weak or strict polynomial inequalities with integer coefficients relative to each of which f x is given by a polynomial expression with integer coefficients the vcsp for all semialgebraic cost function is equivalent to the existential theory of the reals see 2 which is in pspace see 4 the restriction of the feasibility problem associated with a semialgebraic vcsp to a fixed number of variables is polynomial time tractable by cylindrical decomposition cf 5 however we do not know whether with this approach can solve our optimisation problem in polynomial time another contribu tion related with our open problem was given in 11 by khachiyan and porkolab who proved that the problem of minimising a convex polynomial objective function with inte ger coefficients over a fixed number of integer variables subject to polynomial constraints with integer coefficients that define a convex region can be solved in polynomial time in the size of the input references 1 m bodirsky and m grohe non dichotomies in constraint satisfaction complexity in l aceto i damgard l a goldberg m m halld rsson a ing lfsd ttir and i walukiewicz editors proceedings of the international colloquium on automata languages and programming icalp 08 lecture notes in computer science pages 184 196 springer verlag july 2008 2 m bodirsky and m mamino constraint satisfaction problems over numeric do mains in dagstuhl follow ups volume 7 schloss dagstuhl leibniz zentrum fuer informatik 2017 3 a a bulatov a dichotomy theorem for nonuniform csps in 58 th ieee annual symposium on foundations of computer science focs 17 berkeley ca usa october 15 17 2017 pages 319 330 2017 4 j canny some algebraic and geometric computations in pspace in proceedings of the twentieth annual acm symposium on theory of computing stoc 98 pages 460 467 new york ny usa 1988 acm 5 g e collins quantifier elimination for real closed fields by cylindrical algebraic decompostion in h brakhage editor automata theory and formal languages pages 134 183 berlin heidelberg 1975 springer berlin heidelberg 6 m garey and d johnson a guide to np completeness csli press stanford 1978 7 p jonsson and c b ckstr m a unifying approach to temporal constraint reasoning artificial intelligence 102 1 143 155 1998 8 n karmarkar a new polynomial time algorithm for linear programming combi natorica 4 4 373 395 1984 9 r m karp reducibility among combinatorial problems in r e miller j w thatcher and j d bohlinger editors complexity of computer computations pro ceedings of a symposium on the complexity of computer computations pages 85 103 boston ma 1972 springer us 9 10 l khachiyan a polynomial algorithm in linear programming doklady akademii nauk sssr 244 1093 1097 1979 11 l khachiyan and l porkolab integer optimization on convex semialgebraic sets discrete computational geometry 23 207 224 02 2000 12 v kolmogorov a a krokhin and m rolinek the complexity of general valued csps in ieee 56 th annual symposium on foundations of computer science focs 15 berkeley ca usa 17 20 october 2015 pages 1246 1258 2015 13 v kolmogorov j thapper and s ivn the power of linear programming for general valued csps siam j comput 44 1 1 36 2015 14 m kozik and j ochremiak algebraic properties of valued constraint satisfaction problem in automata languages and programming 42 nd international collo quium icalp 15 kyoto japan july 6 10 2015 proceedings part i pages 846 858 2015 15 h w lenstra integer programming with a fixed number of variables mathematics of operations research 8 4 538 548 1983 16 n megiddo linear programming in linear time when the dimension is fixed j acm 31 1 114 127 jan 1984 17 t s motzkin beitr ge zur theorie der linearen ungleichungen phd thesis uni versity of basel azriel jerusalem 1936 english translation contributions to the theory of linear inequalities rand corporation translation 22 the rand corpo ration santa monica california 1952 reprinted in theodore s motzkin selected papers d cantor b gordon b rothschild eds birkh user boston massachus setts 1983 pp 1 80 18 r t rockafellar and r j b wets variational analysis volume 317 springer verlag berlin 1998 19 k roos linear optimization theorems of the alternative in c a floudas and p m pardalos editors encyclopedia of optimization pages 1878 1881 springer us boston ma 2009 20 m h wright the interior point revolution in optimization history recent develop ments and lasting consequences bull amer math soc 42 39 56 2005 21 d zhuk a proof of csp dichotomy conjecture in 58 th ieee annual symposium on foundations of computer science focs 17 berkeley ca usa october 15 17 2017 pages 331 342 2017 10