noname manuscript no will be inserted by the editor hilbert transform spectral filters and option pricing carolyn e phelan daniele marazzina gianluca fusai guido germano received date accepted date abstract we show how spectral filters can improve the convergence of numerical schemes which use discrete hilbert transforms based on a sinc function expansion and thus ulti mately on the fast fourier transform this is relevant for example for the computation of fluctuation identities which give the distribution of the maximum or the minimum of a random path or the joint distribution at maturity with the extrema staying below or above barriers we use as examples the methods by feng and linetsky 2008 and fusai germano and marazzina 2016 to price discretely monitored barrier options where the underlying asset price is modelled by an exponential le vy process both methods show exponential convergence with respect to the number of grid points in most cases but are limited to polynomial convergence under certain conditions we relate these rates of convergence to the gibbs phenomenon for fourier transforms and achieve improved results with spectral filtering the support of the economic and social research council esrc in funding the systemic risk centre grant number es k 002309 1 and of the engineering and physical sciences research council epsrc in funding the uk centre for doctoral training in financial computing and analytics grant number 1482817 are gratefully acknowledged carolyn e phelan department of computer science university college london e mail c phelan cs ucl ac uk carolyn phelan 14 ucl ac uk gianluca fusai dipartimento di studi per l economia e l impresa disei universita del piemonte orientale amedeo avo gadro novara faculty of finance cass business school city university london e mail gianluca fusai uniupo it gianluca fusai 1 city ac uk daniele marazzina dipartimento di matematica politecnico di milano e mail daniele marazzina polimi it guido germano department of computer science university college london systemic risk centre london school of economics and political science e mail g germano ucl ac uk g germano lse ac uk ar x iv 1 70 6 09 75 5 v 2 q fi n c p 1 5 ja n 20 20 2 phelan et al keywords double barrier option discrete monitoring le vy processes spitzer identity wiener hopf factorisation hilbert transform fourier transform fft z transform sinc function gibbs phenomenon spectral filter 1 introduction derivative pricing with fourier transforms was first investigated by heston 1993 carr and madan 1999 published the first method with both the characteristic function and the payoff in the fourier domain fang and oosterlee 2008 2009 devised the cos method based on the fourier cosine expansion the hilbert transform king 2009 has also been successfully employed by feng and linetsky 2008 to price barrier options using backward induction in the fourier space and by marazzina et al 2012 and fusai et al 2016 to compute the factorisations required by the spitzer identities spitzer 1956 kemperman 1963 via the plemelj sokhotski relations pricing derivatives especially exotic options is a challenging problem in the operations research literature fusai et al 2016 provide extensive references for this as well as for many non financial applications of the hilbert transform and the re lated topics of wiener hopf factorisation and spitzer identities in insurance queuing theory physics engineering applied mathematics etc when working in the fourier domain the use of numerical solutions means that one must manage issues arising from the approximation of an integral over an infinite domain with a finite sum as long as the truncation limits in the log price domain are selected ju diciously the main issue to contend with is the so called gibbs phenomenon wilbraham 1848 gibbs 1898 1899 there have been many papers exploring possible solutions to the gibbs phenomenon in a general setting notably by hewitt and hewitt 1979 vande ven 1991 gottlieb and shu 1997 tadmor and tanner 2005 and tadmor 2007 more recently ruijter et al 2015 explored the use of spectral filtering techniques to solve the problem of slow polynomial error convergence seen when the cos method is used with non smooth probability distributions the application investigated in this paper is the improvement of methods based on the fast hilbert transform for the pricing of discretely monitored barrier options with le vy pro cesses recent papers have described significant progress in the valuation of these types of financial contracts feng and linetsky 2008 devised a method using the sinc based hilbert transform by stenger 1993 2011 whose convergence is exponential for many le vy pro cesses but only polynomial for the variance gamma vg process this method has a com putational time which increases linearly with the number of monitoring dates n fusai et al 2016 used the spitzer identities to devise a method whose computation time is independent of n and which achieves exponential convergence for single barrier and lookback options again with the exception of the vg process but which is limited to polynomial convergence for double barrier options our main contribution to the literature on this subject is to produce an error bound ex plaining the origin of the polynomial error convergence seen by fusai et al 2016 and then to extend this method to exponential convergence with the use of spectral filters we have thereby produced the first pricing method for discretely monitored double barrier options whose error converges exponentially on the number of grid points and whose cpu time is independent of the number of monitoring dates we also show that the pricing method by feng and linetsky 2008 can be improved for the vg process and present improved results for both methods with spectral filters in the course of this work we extend the investiga tion into the error performance of the sinc based hilbert transform and show that the error hilbert transform spectral filters and option pricing 3 convergence is related to both the shape of the characteristic function of the underlying pro cess and to the gibbs phenomenon we also implement the exponential filter which was first used in pricing applications by ruijter et al 2015 and the planck taper by mckechan et al 2010 to our knowledge this is the first occasion that the latter has been used in financial mathematics the structure of this paper is as follows in section 2 we run briefly through fourier hilbert and z transforms give a concise overview of the original pricing schemes and ex plain our modifications to improve convergence section 3 includes a discussion of the per formances of the pricing techniques and how they relate to the gibbs phenomenon and the shape of the characteristic function of the underlying processes lastly section 4 shows numerical results comparing the filtered algorithms with the original methods further nu merical tests are presented in the online supplementary material 2 background as this method directly extends the fusai germano and marazzina fgm fusai et al 2016 and fl feng and linetsky 2008 pricing methods we refer to the original papers for a comprehensive introduction aspects of the methods which are directly relevant to the error investigation are described here in order to provide a background to the changes that we made to improve convergence 2 1 fourier and hilbert transforms in this paper we make extensive use of the fourier transform see e g polyanin and manzhi rov 1998 kreyszig 2011 an integral transform with many applications historically it has been widely used in spectroscopy and communications therefore much of the litera ture refers to the function in the fourier domain as its spectrum according to the usual convention in the finance literature the forward and inverse fourier transforms are defined as f fx f x f x ei xdx 1 f x f 1 x f 1 2 f e i xd 2 let s t be the price of an underlying asset and x t log s t s 0 its log price where s 0 s 0 let us consider a derivative characterized by a payoff at maturity t e g a double barrier option with strike k and upper lower barrier u l has the damped payoff x t e xs 0 max e x ek 0 1 l u x 3 where 1 for a call 1 for a put 1 a x is the indicator function of the set a k log k s 0 is the log strike u log u s 0 is the upper log barrier and l log l s 0 is the lower log barrier the damping factor e x is used to ensure the integrability of the payoff function see feng and linetsky 2008 for a full discussion of the selection of the damping parameter to find the price v x t of an option at time t 0 when the initial price of the underlying is s 0 and thus its log price is x 0 0 we need to discount the expected value of the undamped option payoff x t e x t at maturity t t with respect 4 phelan et al to an appropriate risk neutral probability distribution function pdf p x t whose initial condition is p x 0 x as shown by lewis 2001 this can be done using the plancherel relation v 0 0 e rt e x t e x t x 0 0 e rt x e x p x t dx e rt 2 p i t d e rt f 1 x p i t 0 4 here p i t is the complex conjugate of the fourier transform of e x p x t to price options using this relation we need the fourier transforms of both the damped payoff and the pdf the fourier transform of the damped payoff x is available analytically s 0 e 1 i a e 1 i b 1 i ek i a ek i b i 5 where for a call option a u and b max k l while for a put option a l and b min k u the fourier transform of the pdf p x t of a stochastic process x t is the characteristic function t e ei x t p x t ei xdx fx p x t p t 6 for a le vy process the characteristic function can be written as t e t where the characteristic exponent is given by the le vy khinchine formula as i 1 2 2 2 r ei 1 i 1 1 1 l d 7 the le vy khinchine triplet l uniquely defines the le vy process the value of defines the linear drift of the process is the volatility of the diffusion part of the process and l is the le vy measure related to the jump part of the process under the risk neutral measure the parameters of the triplet are linked by the equation r q 1 2 2 r e 1 i 1 1 1 l d 8 where r is the risk free interest rate and q is the dividend rate in general the characteris tic function of a le vy process is available in closed form for example for the gaussian schoutens 2003 nig barndorff nielsen 1998 cgmy carr et al 2002 kou double exponential kou 2002 merton jump diffusion merton 1976 le vy alpha stable nolan 2018 vg madan and seneta 1990 meixner schoutens 2003 and mixed tempered stable mercuri and rroji 2016 processes some pricing techniques based on the fourier transform e g fgm and fl also use the hilbert transform which is an integral transform related to the fourier transform how ever in contrast to the fourier transform the function under transformation remains in the same domain rather than moving between the x and domains the hilbert transform of a function in the fourier domain is defined as h f p v 1 f d lim 0 1 1 f d 1 f d 9 hilbert transform spectral filters and option pricing 5 where p v denotes the cauchy principal value applying the hilbert transform in the fourier domain is equivalent to multiplying the function in the x domain by isgnx see e g king 2009 fusai et al 2016 2 2 applying barriers with hilbert transforms the hilbert transform can be used to obtain the fourier transform of a function above or be low a barrier b i e f b fx f x 1 r x b and f b fx f x 1 r x b without leaving the fourier domain via the generalised plemelj sokhotski relations which also employ the shift theorem fx f x b f e ib these are f b 1 2 f eib ih e ib f 10 f b 1 2 f eib ih e ib f 11 eqs 10 and 11 can be combined to obtain the fourier transform of the part of a function between two barriers i e f lu fx f x 1 l u x f lu 1 2 eil ih e il f eiu ih e iu f 12 we may also be required to factorise a function i e obtain g and g such that g g g this is achieved through a log decompositon i e decomposing the logarithm h log g and then exponentiating the results to obtain g exp h and g exp h the hilbert transform was used by feng and linetsky 2008 to price discrete barrier options exploiting the relationship between the price at two successive monitoring dates being tn n t n 0 1 n v x tn 1 u l v x tn fx x x t dx n n n 1 1 13 here v x tn x e x i e the payoff of the option and fx t denotes the transition density of the underlying process with step size t using the convolution theorem together with the hilbert transform eqs 10 12 can be employed to express the relationship be tween the price at two successive dates as v tn 1 1 2 i t v tn e il ih e il i t v tn 14 for a single barrier down and out option and v tn 1 1 2 eil ih e il i t v tn eiu ih e iu i t v tn 15 for a double barrier option 6 phelan et al 2 3 spitzer identities if we wish to use eq 4 to price barrier options the required characteristic functions are more complicated than the closed form expressions referred to in section 2 1 we need the characteristic function of the distribution of the value of a process x t at time t t conditional on the process remaining inside upper and lower barriers at discrete monitoring dates tn n 0 1 n fortunately for a single barrier we can use the identities by spitzer 1956 and for double barriers their extension by kemperman 1963 these provide the fourier z transform of the required pdf the fourier transform is applied to the log price x and the z transform is applied to the discrete monitoring times the z transform of a discrete function f tn with n n 0 is defined as f q zn q f tn n 0 f tn q n q c 16 this paper uses the formulation of the spitzer identities by green et al 2010 which was also used by fusai et al 2016 the idea is that the required pdfs at subsequent monitoring dates are related as p x tn 1 u l p x tn fx x x t dx 17 where fx x x t is the transition density of the underlying process and p x tn x by applying the z transform to p x tn we obtain a wiener hopf style equation which we must solve to obtain the required pdf p x q q u l p x q fx x x t dx x 18 the wiener hopf method is a large subject and whilst we briefly outline the technique here to provide a background to the pricing schemes we refer the interested reader to references such as noble 1958 daniele and zich 2014 for a detailed treatment of the general method and green et al 2010 fusai et al 2016 for a guide to its use in this application exploiting the convolution theorem i e fx g x h x g h eq 18 is transformed into the fourier domain as p q 1 q t p q p q 1 19 where p q and p q are unknown auxiliary functions defined to extend eq 18 along the entire x axis to solve this for a single lower barrier we have p q 0 we first factorise q 1 q t q q and divide both sides by q so that the wanted function p q is multiplied with the function q only we then discard p q q which is purely negative and decompose 1 q around l to obtain the positive function pl q 1 q l the required pdf func tion subject to monitoring at a lower barrier is p q pl q q 20 which corresponds to fusai et al 2016 eq 14 1 for double barrier options the procedure is more complicated as both of the auxiliary functions p q and p q are non zero 1 with reference to the notation in fusai et al 2016 1 q l e il q due to the shift theorem hilbert transform spectral filters and option pricing 7 we calculate the fourier z transform of the wanted pdf by subtracting the unwanted parts above and below the barriers i e p q 1 jl q ju q q 21 which corresponds to fusai et al 2016 eq 16 however the calculation of ju q requires the knowledge of jl q and vice versa in fact they are linked by the following coupled equations which so far have only been solved by an iterative method jl q q 1 ju q q l 22 ju q q 1 jl q q u 23 2 4 numerical methods the methods in the previous section are described analytically however as they involve some expressions which cannot be solved in closed form their implementation requires the use of numerical approximation techniques which we discuss in the following 2 4 1 discrete fourier transform and spectral filtering the forward and reverse fourier transforms in eqs 1 and 2 are integrals over an infinite domain and in order to compute them numerically one needs to approximate them with a discrete fourier transform dft rather than being defined over an infinite and continuous range of x and values the dft is defined on grids of size m in the x and domains for our scheme both the x and grids are centred around zero and are defined based on the maximum value in the x domain xmax the step size is x 2 xmax m and the x domain grid is defined as x j j x j m 2 m 2 1 m 2 1 24 the points in the domain are then calculated according to the nyquist relation by obtaining the step size xmax and range max x to give the domain grid as k k k m 2 m 2 1 m 2 1 25 the discrete fourier transform is then f m x k x m 2 1 j m 2 f x j e ix j k 26 fm x j 2 m 2 1 k m 2 f k e ix j k 27 in practice we perform this calculation using the built in matlab fft function based on the fftw library by frigo and johnson 1998 it can be seen in eqs 26 and 27 that the range over which we calculate the fourier transform is truncated so we must consider the effect of the gibbs phenomenon on the error 8 phelan et al 0 6 0 4 0 2 0 0 2 0 4 0 6 x 0 0 2 0 4 0 6 0 8 1 f m x m 6 m 8 m 10 1 0 5 0 0 5 1 x 0 6 0 4 0 2 0 0 2 0 4 0 6 f m x f x m 6 m 8 m 10 fig 1 illustration of the effect of the gibbs phenomenon on a rectangular pulse recovered applying the in verse fft with grid size m to sinc 2 the approximated function is shown on the left and the error with respect to an analytical rectangular pulse on the right on increasing m the peak error at the disconti nuity remains the same the error away from the discontinuity reduces and the frequency of the oscillations increases convergence this describes the way that the finite sum in eq 27 converges to the analyt ical function f x corresponding to an infinite sum hewitt and hewitt 1979 provided a comprehensive guide to this effect which was first observed by wilbraham 1848 and later described by gibbs 1898 1899 an example of this can be seen in figure 1 which shows how fm x for a rectangular pulse varies as the value of m increases the error peaks at the discontinuity f xd and oscillates away from it with the amplitude decreasing as a function of distance from the discontinuity the value of the recovered function at the dis continuity fm xd where xd 0 5 will be the mean of the values immediately before and after the discontinuity i e fm xd 1 2 f x d f x d and thus stays the same even as the value of m increases in contrast it can be observed from figure 1 that the oscillations increase in frequency and decrease in amplitude as the value of m increases however the most important aspect of the gibbs phenomenon for the work in this paper is the way that the shape of the function in the fourier domain is related to its shape in the state space from the integration by parts coefficient bound described by boyd 2001 see also ruijter et al 2015 if the function is smooth up to and including its k 2 th derivative and its kth derivative is integrable then the fourier coefficients decrease as o 1 k this is illustrated in figure 2 which shows the fourier transform of a standard normal distribution and the fourier transform of a standard normal distribution multiplied by a step at x 1 5 many proposed solutions to the gibbs phenomenon are too computationally heavy to be useful for our application such as adaptive filtering and mollifiers suggested by tadmor and tanner 2005 and tadmor 2007 moreover as explained in section 3 our error analysis is particularly concerned with the shape of the function in the fourier domain therefore we adopt the approach of ruijter et al 2015 using simple spectral filtering techniques which are applied by a pointwise multiplication in the fourier domain and therefore shape the function directly whilst adding very little computational load in the papers by vandeven 1991 and gottlieb and shu 1997 a filter of order p is defined as a function supported on 1 1 with the following properties a 0 1 l 0 0 b 0 for 1 c cp 1 28 hilbert transform spectral filters and option pricing 9 fig 2 illustration of the effect of the gibbs phenomenon on a the fourier transform of a standard normal distribution it can be seen that introducing a step into a function has the effect of changing the decay of the fourier transform from exponential to o 1 here h x denotes the heaviside step function the scaled variable is related to in our application as max in this paper we investigate the use of two filters the exponential filter described by gottlieb and shu 1997 has the form e p 29 where p is even and positive this does not strictly meet criterion b in eq 28 as it does not go exactly to zero when 1 however if we select log 10 where 10 is machine precision then the filter coefficients are within computational accuracy of the requirements an advantage of the exponential filter is that it has a simple form and the order of the filter is equal to the parameter p which is directly input to the filter equation the other filter we study here is the planck taper mckechan et al 2010 which is defined piecewise as 0 1 1 1 1 e z 1 z 2 1 1 2 1 2 1 2 2 1 1 2 3 3 1 1 e z 1 z 3 4 3 3 4 4 3 4 4 1 0 4 30 the value of gives the proportion of the range of which is used for the slope regions outside these regions it is completely flat with a value of 1 this contrasts with the ex ponential filter which introduces some albeit often very minor distortion for any value of 6 0 in addition the planck taper has the notable property that for all values of 0 c and therefore the order of the planck taper is however it is clear that dif ferent values of give a different filter shape so the order of a filter alone cannot be taken as a predictor of performance examples of the two filters are shown in figure 3 10 phelan et al 1 0 5 0 0 5 1 10 20 10 15 10 10 10 5 10 0 planck taper 0 1 0 3 0 5 1 0 5 0 0 5 1 10 20 10 15 10 10 10 5 10 0 p exponential filter p 4 p 6 p 8 p 12 fig 3 shape of the exponential filter left and planck taper right with different parameter values 2 4 2 hilbert transform the calculation of the hilbert transform of a function f can be realised with an in verse forward fourier transform pair and multiplication by the signum function h f ifx sgn x f 1 x f 31 however this gives an error convergence which is polynomially decreasing with the number of grid points m in order to obtain exponential error convergence feng and linetsky 2008 and fusai et al 2016 have implemented the hilbert transform using the sinc expansion techniques comprehensively studied by stenger 1993 2011 stenger showed that given a function f which is analytic in the whole plane including the real axis the function and its hilbert transform can be expressed as f k f k sin k k 32 h f k f k 1 cos k k 33 where is the grid step size in the fourier domain stenger 1993 also showed that when the function f is analytic in a strip of the complex plane including the real axis the expressions in eqs 32 and 33 are approximations whose error decays exponentially as decreases in addition to discretisation the infinite sum in eq 33 must also be truncated to the grid size m so that the discrete approximation of the hilbert transform becomes h f m 2 k m 2 f k 1 cos k k 34 feng and linetsky 2008 2009 showed that if f decays at least exponentially as i e f exp c then the error in the hilbert transform and the plemelj sokhotski relations caused by truncating the infinite sum in eq 33 is also exponentially bounded furthermore feng and linetsky showed that if f is polynomially bounded as i e f c then the error caused by truncating the series is no longer exponentially bounded feng and linetsky 2008 2009 hilbert transform spectral filters and option pricing 11 2 4 3 pricing method single barrier options with the spitzer identity two of the pricing methods that we modify in order to reduce the errors from the discrete hilbert transform were devised and explained in depth by fusai et al 2016 the first method which we examine is the pricing procedure for single barrier options without loss of gener ality we consider only the down and out case the modifications that we propose are equally applicable to other types of single barrier options this method is briefly described here in order to provide a backdrop to the changes that were made to improve convergence 1 set the number of dates to n 2 so that the characteristic function acts as a smoothing function for the first and last dates in the scheme 2 compute the characteristic function i t where is the damping factor used in section 2 1 3 use the plemelj sokhotski relations with the sinc method to factorise q 1 q i t q q 35 with q selected according to the criteria specified by abate and whitt 1992 b for the inverse z transform 4 decompose p q i t q pl q pl q 36 and calculate f q i t pl q q 37 5 calculate the price v 0 n e rt f 1 x 0 z 1 q n n 2 f q 38 the spitzer identities give the z transform of the characteristic function so the inverse z transform z 1 q n f q must be applied the method used was devised by abate and whitt 1992 a b and approximates the inverse z transform by f tn 1 2 me n n me j 0 me j bne j 39 where bk 1 2 f k j 1 1 j re f e ji n 40 the parameters ne and me are chosen to be large enough to attain sufficient accuracy and small enough such that ne me n tests suggest that a choice of ne 12 and me 20 provides good accuracy this gives ne me 32 which is much smaller than the number of dates specified in most option contracts the parameter controls the accuracy of the inverse z transform in order to have an accuracy of 10 2 one must set 10 n abate and whitt 1992 b this can result in very small values of and so it has been found in practice that the best achievable performance is of the order of 10 12 with 6 however this is more than sufficiently low for practical purposes and to show whether exponential convergence is achieved fusai et al 2016 showed that this method could achieve exponential convergence with a wide range of le vy processes however with the vg process this method only achieved 12 phelan et al polynomial convergence this is consistent with the error behaviour of the discrete hilbert transform with the vg process as explained in section 2 4 2 above section 3 explains in more detail how the error convergence is bounded when this process is used in order to improve the result we multiplied the characteristic function by a spectral filter so that the input to both the factorisation and decomposition steps decay expo nentially the expressions in eqs 35 and 36 are replaced by q 1 q i t max q q 41 p q i t max q pl q pl q 42 2 4 4 pricing method double barrier options with the spitzer identity the second method from fusai et al 2016 which we examine in this paper is the pricing procedure for double barrier options this is very similar to the method for the single barrier options described in section 2 4 3 in that it uses wiener hopf factorisation and decompo sition to compute the appropriate spitzer identitiy however the major difference in this case is that the equations cannot be solved directly and so require the use of a fixed point algorithm the steps in the pricing procedure for double barrier options are the same as the procedure described for the single barrier down and out option described in section 2 4 3 with the exception of step 4 which is now replaced by the following fixed point algorithm 4 a set ju q jl q 0 b decompose p q i t ju q q pl q pl q 43 and set jl q pl q q c decompose q q i t jl q q qu q qu q 44 and set ju q qu q q d calculate f q i t q i q jl q ju q 45 e if the difference between the new and the old value of f q is less than a predefined tolerance or the number of iterations is greater than a certain value e g 5 then calculate the price using eq 38 otherwise return to step b unlike the direct method for single barrier options described in section 2 4 3 this iter ative method is limited to polynomial error convergence for all processes in section 3 we show that this is due to the gibbs phenomenon in order to improve the error convergence we placed a filter on the input to each decomposition step in the fixed point algorithm the calculations for p q and q q in eqs 43 and 44 are replaced by p q max i t ju q q 46 q q max i t jl q q 47 hilbert transform spectral filters and option pricing 13 it must also be noted that this change is only designed to provide significant improve ments to the double barrier method with exponentially decaying characteristic functions in the case of a polynomially decaying characteristic function such as that of the vg process this method will also be subject to the same limitations on accuracy as described in sec tion 3 1 for single barrier options therefore if we wish to use this scheme with the vg process we must also apply filtering to the factorisation step as shown in eq 41 2 4 5 pricing method feng and linetsky the third pricing method that we examine in order to illustrate the improvements obtained by the addition of spectral filtering to the sinc based hilbert transform is the recursive one pub lished by feng and linetsky 2008 and explained in section 2 2 in general the fl method achieves excellent results for both single and double barrier options feng and linetsky 2008 fusai et al 2016 the error converges exponentially with grid size and reaches ma chine accuracy for fairly small grid sizes however with respect to the fgm model it has the disadvantage that the computational time increases linearly with the number of monitor ing dates similarly to the fgm method for single barrier options exponential error convergence is achieved only for processes where the characteristic function reduces exponentially as therefore poor error convergence is achieved for the vg process which has a characteristic function which only reduces polynomially as feng and linetsky 2008 explained this in some detail showing how this is linked to the truncation error of the discrete hilbert transform in order to improve the results we altered the fl method by placing a filter on the input to the hilbert transform to ensure it decays exponentially we replaced eqs 14 and 15 by v tn 1 1 2 max i t v tn eil ih e il max i t v tn 48 v tn 1 1 2 eil ih e il max i t v tn eiu ih e iu max i t v tn 49 3 error convergence of the pricing procedure in this section we present new bounds for the error convergence of the different calculations that make up the original pricing procedures without spectral filters and show bounds for the individual steps in doing this the effect of each step in the procedure on the shape of the output function in the fourier domain is examined as this largely determines the error convergence of the successive steps in the fgm and fl pricing methods the computation of the characteristic function is done directly in the fourier domain so there are no numer ical errors associated with this calculation all the le vy processes that we are considering have characteristic functions that decay exponentially as with the exception of the vg process where the characteristic function decays polynomially and is bounded by 2 t the damping factor is omitted from the calculations to make the notation more 14 phelan et al concise this is appropriate as the value of i becomes insignificant as in the error calculations below cn where n 1 2 3 are included as positive constants 3 1 pricing single barrier options with the vg process using the spitzer identity following the calculation of the characteristic function the next step in the pricing procedure is the factorisation of q 1 q t which means that we need to apply the discrete hilbert transform to log q log 1 q t with the exception of the vg process as q t qe t 2 which quickly becomes very small thus we can say that as log 1 q t ce t 2 with c positive constants therefore from the error bounds for the sinc based hilbert transform proved by stenger 1993 and feng and linetsky 2008 the output of the decomposition of log q has exponential error convergence for exponentially decaying characteristic functions for the vg process the characteristic function is t 1 i 1 2 2 2 2 t 50 when then t is dominated by 2 t so log 1 q t c 2 t therefore we can bound the truncation error from the decomposition of log 1 q t feng and linetsky 2008 showed that the truncation error from applying the sinc based hilbert transform to a function which decays as c 2 t is bounded by 2 c 2 t m 2 t 1 where there is a constraint on the process parameters of t 2 we show that if we take into account the form of the discrete hilbert transform and the similarity between the posi tive and negative tails of the characteristic function a tighter bound can be defined and the constraints on the parameters can be relaxed defining f as the output of the infinite sum from eq 33 and f m as the output of the truncated sum from eq 34 f f m c 1 k m 2 k 2 t 1 cos k k k m 2 k 2 t 1 cos k k c 1 k m 2 k 2 t 1 cos k k 1 cos k k c 2 k m 2 k 2 t 1 k 1 k c 3 k m 2 k 2 t 2 k 2 c 4 k m 2 k 2 t k 2 c 5 m 2 2 t 2 k d k c 6 m 2 t 1 51 hilbert transform spectral filters and option pricing 15 2000 1500 1000 500 0 500 1000 1500 2000 10 15 10 10 10 5 10 0 m o d u lu s o f fu n c ti o n log q log q 1 q fig 4 input and output functions for the factorisation of q 1 q t with the kou process for q the plot shows how the decay of the function is changed by the decomposition the two cosines are equal because the difference of their arguments is 2 k for the integral to converge we must have 2 t 2 1 which is the case for all possible process param eters when the output of this decomposition is exponentiated to obtain the results of the factorisation the error will be bounded as e f e f m e f c 7 1 ec 6 m 2 t 1 52 for large m this converges as o m 2 t 1 thus the error convergence of the factorisa tion is polynomial the expression in eq 51 gives the error at fixed values of i e the chosen grid points therefore can be absorbed into c 3 and c 4 moreover in the final price calculation the spitzer identities are multiplied by the payoff and the characteristic func tion which both decay as increases and therefore the errors close to 0 will have the largest influence on the final error of the solution however as m increases our range of increases and so we should consider the effect of errors at large values of on the error of the next step in the calculation as explained below we multiply the input to the subsequent hilbert transform by the characteristic function and if the number of grid points increases from m to m where m m then the additional error from these points is bounded by c 8 m j m j m 4 t 1 j c 9 m j m m 4 t 1 c 10 m 4 t 53 depending on the parameters of the vg process this decreases more or less rapidly than the original bound and if we were to select our parameters according to the requirement in feng and linetsky 2008 of 2 t 1 then o m 2 t 1 will dominate however regardless of parameter selection the error converges polynomially with m the requirement to multiply the output of the factorisation by the characteristic function is due to its shape in the fourier domain as this will influence the error convergence of the subsequent step figure 4 shows that the function flattens out at high values of and asymptotically approaches 1 therefore if we were to input q directly to the hilbert transform in the decomposition step then we would not be able to bound the truncation error using feng and linetsky s error limit for exponentially bounded functions 16 phelan et al however the last date is taken out of the fgm pricing scheme this means that we multiply the function to be decomposed by the characteristic function in the case of expo nentially decaying characteristic functions this restores the exponential decay of the func tion for high values of which again means that the truncation error of the discrete hilbert transform is exponentially bounded however if the vg process is used then the input to the decomposition is only polynomially decaying and thus we again have polynomial error convergence for this stage 3 2 double barrier options with the unfiltered spitzer identity the original pricing procedure for double barrier options shows polynomial convergence for all processes even those whose characteristic function decays exponentially the main dif ference between the pricing procedure for single and double barrier options is the presence of the fixed point algorithm and in this section we show how this causes the polynomial error convergence as shown in section 3 1 with an exponentially decaying characteristic func tions the factorisation has exponential error convergence in addition we multiply the input to the fixed point algorithm by the characteristic function which means that it is exponen tially bounded as provided the input function to the first iteration of the fixed point algorithm is exponentially bounded the error on the output of the initial decomposition is exponentially bounded however the decomposition operation is equivalent to multiplying the function in the x domain by either 1 r x or 1 r x which introduces a jump into the output functions due to the gibbs phenomenon this means that the output function from the decomposition decays as o 1 as the effect of this is that the input function to the second iteration of the fixed point algorithm is no longer exponentially bounded and so according to stenger 1993 and feng and linetsky 2008 the error from the truncation of the infinite sum in eq 33 to give eq 34 is no longer exponentially bounded a bound for this error is f f m c 1 k m 2 1 k 2 c 2 m 2 1 2 k d k c 3 1 m 54 therefore using the fixed point algorithm with more than one iteration means that the error is no longer exponentially bounded the bound shown in eq 54 is o 1 m however the error of the pricing procedure actually decays as o 1 m 2 this better performance may be due to the alternating nature of the fourier coefficients 3 3 feng and linetsky pricing method with the vg process the fl method is described in eqs 14 and 15 which show how the hilbert transform is applied for each monitoring date as explained in section 3 2 the application of the hilbert transform introduces a discontinuity into the function in the log price domain therefore the fourier coefficients on the output of the hilbert transform will decay as o 1 as however before the hilbert transform is applied for the next monitoring date the fourier domain function is multiplied by the characteristic function of the underlying process therefore as explained by feng and linetsky 2008 if the characteristic function hilbert transform spectral filters and option pricing 17 is exponentially decaying this will result in an exponentially convergent error however with polynomially decaying characteristic functions such as that of the vg process then a polynomially convergent error will be achieved 3 4 error convergence with filtering on the sinc based hilbert transform the multiplication by a filter with exponentially decaying coefficients as gives an exponentially convergent truncation error for the sinc based discrete hilbert transform com pared with the non truncated version however filtering distorts the function somewhat the numerical results with the updated method are shown in section 4 and the prices calculated with the filtered version have been compared with the price calculated using the unfiltered fl method with the maximum grid size to confirm that any distortion error is less significant than the improvement in error convergence due to the error being influenced by these two opposing effects we have not attempted to devise a tight error bound which closely matches the improvement in performance achieved in practice it is often seen in the literature on the gibbs phenomenon that the empirical results outstrip the calculated error bounds for example ruijter et al 2015 suggest that the faster convergence they see may be due to the alternating nature of the fourier coefficients 4 numerical results we performed numerical tests using the pricing schemes updated to include filtering as described in section 2 the results for the fgm method for double barrier options with exponentially decaying characteristic functions are presented in section 4 1 section 4 2 contains results for all methods with the vg process details of the contract and the model parameters are included in table 4 in appendix a the numerical results were obtained using matlab r 2016 b running under os x yosemite on a 2015 retina macbook pro with a 2 7 ghz intel core i 5 processor and 8 gb of ram 4 1 results with exponentially decaying characteristic functions we present results for the fgm method for double barrier options with filtering included in the fixed point algorithm as described in section 2 4 4 we examined the performance for both the kou and nig processes with n 4 52 and 252 2 the values of 52 and 252 represent weekly and daily monitoring over 1 year results with n 4 are presented in order to show the performance of the method with very few monitoring dates figure 5 shows results for the kou process and figure 6 shows results for the nig process the original fl and fgm methods are labelled fl and fgm the fgm method with filtering is labelled fgm e p order for results with the exponential filter and fgm p parameter with the planck taper comparing the results for all methods we see that the fl method gives the best error convergence versus grid size this is due to the error of the fgm method being limited by the performance of the inverse z transform comparing the filtered fgm methods the exponential filter gives better results but the planck taper is less sensitive to variations in the filter shape the best results were achieved with an exponential filter of order p 12 2 the online supplementary material which accompanies this paper demonstrates the robustness of the pricing algorithm with regards to the variation of parameters 18 phelan et al tables 1 and 2 present the number of iterations and the computational time for a range of dates the results demonstrate that as the number of dates increases the number of iterations and computational time either does not increase or minimally increases and thus confirm that the computational time is independent of the number of monitoring dates figures 5 and 6 show how the convergence of the numerical techniques changes with the grid size and figures 7 and 8 show how the convergence behaviour corresponds to computational time with an exponential filter of order 12 the inclusion of a filter in the fgm method produces a large improvement compared to the unfiltered method due to an increase in accuracy of the calculation as shown in fig ures 5 and 6 however this also improves the algorithm computationally as it now reaches the required accuracy in a smaller number of iterations than the original fgm method de spite this improvement for low numbers of monitoring dates the fl method shows the best performance however for 252 monitoring dates the filtered fgm method performs around the same as the fl method for errors greater than 10 10 for higher number of dates the fil tered fgm method shows the best performance for errors greater than 10 10 including the filter in the fl method produces a result with very slightly worse absolute error convergence but which still retains exponential convergence see figures 7 and 8 we can relate this to the error discussion in section 3 4 the filter causes a slight distortion which degrades the abso lute error convergence but there is no improvement to be gained in the rate of convergence as the unfiltered method already achieves exponential convergence 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fgm fgm e p 4 fgm e p 6 fgm e p 12 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 52 fl fgm fgm e p 4 fgm e p 6 fgm e p 12 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 252 fl fgm fgm e p 4 fgm e p 6 fgm e p 12 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fgm fgm p 0 1 fgm p 0 3 fgm p 0 5 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 52 fl fgm fgm p 0 1 fgm p 0 3 fgm p 0 5 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 252 fl fgm fgm p 0 1 fgm p 0 3 fgm p 0 5 fig 5 error vs grid size m for the kou process and varying number of monitoring dates n the filter improves the convergence of the fgm method from polynomial to exponential the best results are obtained with an exponential filter of order p 12 hilbert transform spectral filters and option pricing 19 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fgm fgm p 0 1 fgm p 0 3 fgm p 0 5 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 52 fl fgm fgm p 0 1 fgm p 0 3 fgm p 0 5 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 252 fl fgm fgm p 0 1 fgm p 0 3 fgm p 0 5 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fgm fgm e p 4 fgm e p 6 fgm e p 12 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 52 fl fgm fgm e p 4 fgm e p 6 fgm e p 12 10 2 10 4 m 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 252 fl fgm fgm e p 4 fgm e p 6 fgm e p 12 fig 6 error vs grid size m with the nig process and varying number of monitoring dates n the filter improves the convergence of the fgm method from polynomial to exponential the best results are obtained with an exponential filter of order p 12 dates tolerance m average iterations price error cpu time 4 e 8 1024 2 000 0 00721968941 4 12 e 14 5 63 e 03 52 e 8 1024 2 000 0 00518403635 3 07 e 13 3 81 e 02 104 e 8 1024 2 000 0 00490517113 5 54 e 13 3 99 e 02 252 e 8 1024 2 000 0 00465711572 4 29 e 12 3 72 e 02 504 e 8 1024 2 000 0 00452396360 4 31 e 09 3 80 e 02 4 e 10 1024 2 000 0 00721968941 4 12 e 14 1 82 e 02 52 e 10 1024 2 000 0 00518403635 3 07 e 13 3 50 e 02 104 e 10 1024 2 091 0 00490517113 5 62 e 13 3 88 e 02 252 e 10 1024 2 121 0 00465711572 4 31 e 12 3 71 e 02 504 e 10 1024 2 152 0 00452396360 4 31 e 09 3 90 e 02 table 1 results for the kou process with the fixed point algorithm tolerance set to 10 8 and 10 10 4 2 polynomially decaying characteristic functions we present results for the fl and fgm methods for a process with a polynomially decaying characteristic function i e the vg process figures 9 and 10 show the results of tests for single and double barrier options where we have applied exponential filtering as described in section 2 4 the performance for a low number of dates shows a good improvement with the addition of filtering for both the fgm and fl methods this demonstrates that the performance of the sinc based discrete hilbert transform of polynomially decaying functions can be improved even when the polynomial decay is a true representation of the function shape and not simply an artefact of the fixed point algorithm as was the case in section 4 1 for a higher number of dates the error convergence vs grid size for the fgm method is improved so that it is the same as the fl method with or without filtering this is a significant improvement as the fgm method has the advantage over the fl method that its computation time beyond 20 phelan et al 10 3 10 2 10 1 10 0 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fl e fgm fgm e p 12 10 2 10 0 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 52 fl fl e p 12 fgm fgm e p 12 10 2 10 0 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 104 fl fl e p 12 fgm fgm e p 12 10 2 10 0 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 252 fl fl e fgm fgm e p 12 10 2 10 1 10 0 10 1 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 504 fl fl e p 12 fgm fgm e p 12 10 2 10 0 10 2 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 1008 fl fl e p 12 fgm fgm e p 12 fig 7 error vs cpu time for a double barrier option with the kou process and varying numbers of monitor ing dates n the filter improves the fgm method for all n fgm e is the fastest method for an error of 10 8 with n 252 10 3 10 2 10 1 10 0 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fl e fgm fgm e p 12 10 2 10 0 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 52 fl fl e fgm fgm e p 12 10 2 10 0 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 104 fl fl e fgm fgm e p 12 10 2 10 1 10 0 10 1 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 252 fl fl e p 12 fgm fgm e p 12 10 2 10 1 10 0 10 1 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 504 fl fl e p 12 fgm fgm e p 12 10 2 10 0 10 2 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 1008 fl fl e p 12 fgm fgm e p 12 fig 8 error vs cpu time for a double barrier option with the nig process and varying numbers of moni toring dates n the filter improves the fgm method for all n fgm e is the fastest method for an error of 10 8 with n 504 hilbert transform spectral filters and option pricing 21 dates tolerance m average iterations price error cpu time 4 e 8 1024 2 000 0 00545479385 2 38 e 13 1 50 e 02 52 e 8 1024 2 000 0 00359559460 5 07 e 13 8 57 e 02 104 e 8 1024 2 000 0 00341651334 5 92 e 10 8 58 e 02 252 e 8 1024 2 091 0 00328484367 3 15 e 07 9 63 e 02 504 e 8 1024 2 182 0 00322814330 6 84 e 07 9 34 e 02 4 e 10 4096 2 000 0 00545479385 7 17 e 14 1 45 e 02 52 e 10 4096 2 242 0 00359559460 6 70 e 13 2 20 e 01 104 e 10 4096 2 303 0 00341651275 3 80 e 13 2 15 e 01 252 e 10 4096 2 364 0 00328453104 2 33 e 09 2 08 e 01 504 e 10 4096 2 485 0 00322753427 7 53 e 08 2 21 e 01 table 2 results for the nig process with the fixed point algorithm tolerance set to 10 8 and 10 10 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 4 fl fl e p 12 fgm fgm e p 12 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 52 fl fl e p 12 fgm fgm e p 12 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 252 fl fl e p 12 fgm fgm e p 12 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 504 fl fl e p 12 fgm fgm e p 12 fig 9 error vs grid size m for a single barrier down and out option with the vg process and varying num bers of monitoring dates n the filter improves both the fgm and fl methods with the fl e method performing best at low numbers of dates a small threshold is independent of the number of dates unlike the linear increase of the fl method this is demonstrated by the results shown in figures 11 and 12 the filtered methods show the best performance for all dates filtered fl is the best performing method for low numbers of monitoring dates and filtered fgm is the best performing method for higher numbers of dates 22 phelan et al 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 504 fl fl e p 12 fgm fgm e p 12 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 252 fl fl e p 12 fgm fgm e p 12 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 52 fl fl e p 12 fgm fgm e p 12 10 1 10 2 10 3 10 4 10 5 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 4 fl fl e p 12 fgm fgm e p 12 fig 10 error vs grid size m for a double barrier option with the vg process and varying numbers of moni toring dates n the filter improves the fgm methods for all numbers of monitoring dates and the fl method for low numbers of dates 10 3 10 2 10 1 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fl e fgm fgm e p 12 10 3 10 2 10 1 10 0 cpu time s 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 52 fl fl e fgm fgm e p 12 10 2 10 1 10 0 cpu time s 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 104 fl fl e fgm fgm e p 12 10 2 10 1 10 0 cpu time s 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 252 fl fl e p 12 fgm fgm e p 12 10 3 10 2 10 1 10 0 10 1 cpu time s 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 504 fl fl e fgm fgm e p 12 10 3 10 2 10 1 10 0 10 1 cpu time s 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 1008 fl fl e p 12 fgm fgm e p 12 fig 11 error vs cpu time for a single barrier option with the vg process and varying numbers of moni toring dates n the best performance of the new filtered methods fl e p 12 and fgm e p 12 either equals or exceeds the performance of the existing methods over all numbers of dates hilbert transform spectral filters and option pricing 23 4 3 summary of results table 3 shows a summary of the best performing methods in terms of cpu time for different processes and types of options single barrier double barrier dates vg kou nig vg 4 fl e fl fl fl e 52 fl e fl fl fl e 104 fl e fgm e fl fl fl e 252 fl e fgm e fgm e fl fgm e fl fgm e fl e fl 504 fgm e fgm e fgm e fgm e 1008 fgm e fgm e fgm e fgm e table 3 quickest method for an error of 10 8 due to the slower convergence of all methods with the vg process entries marked with an asterisk show the quickest method for an error of 10 5 bold a filtered method provides the best performance bold italic the performance of the filtered methods equals but does not exceed the best performance of an existing method italic the few cases where an existing method performs best 5 conclusions in this article we showed that numerical methods for pricing derivatives based on the hilbert transform computed with a sinc function expansion can be modified with the addition of 10 3 10 2 10 1 cpu time s 10 15 10 10 10 5 10 0 10 5 a b s o lu te e rr o r o f th e p ri c e n 4 fl fl e fgm fgm e p 12 10 2 10 1 10 0 cpu time s 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 52 fl fl e p 12 fgm fgm e p 12 10 2 10 1 10 0 cpu time s 10 10 10 5 10 0 a b s o lu te e rr o r o f th e p ri c e n 104 fl fl e p 12 fgm fgm e p 12 10 2 10 1 10 0 10 1 cpu time s 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e p ri c e n 252 fl fl e p 12 fgm fgm e p 12 10 2 10 1 10 0 10 1 cpu time s 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e p ri c e n 504 fl fl e p 12 fgm fgm e p 12 10 2 10 1 10 0 10 1 cpu time s 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e p ri c e n 1008 fl fl e p 12 fgm fgm e p 12 fig 12 error vs cpu time for a double barrier option with the vg process and varying numbers of moni toring dates n the best performance of the new filtered methods fl e p 12 and fgm e p 12 either equals or exceeds the performance of the existing methods over all numbers of dates 24 phelan et al spectral filters to improve their convergence furthermore we expanded on the work by stenger and feng and linetsky which showed how the shape of the function on the input to the hilbert transform relates to the resultant error on the output of the hilbert transform we showed that due to the gibbs phenomenon an algorithm using successive hilbert trans forms will achieve polynomial convergence unless additional filtering is applied after the first hilbert transform moreover we demonstrated that simple spectral filters such as the exponential filter or the planck taper are sufficient to improve performance so that exponen tial convergence can be achieved in addition we showed that the pricing schemes by feng and linetsky and fusai et al which have relatively poor performance with the vg process even for single barrier options can also be improved by spectral filters this article directly concerns the pricing of barrier option pricing but the findings are relevant for any application which is related to le vy processes in the presence of barriers and requires the solution of the wiener hopf or fredholm equation references abate j whitt w 1992 a the fourier series method for inverting transforms of probability distributions queueing systems 10 1 2 5 88 doi 10 1007 bf 01158520 abate j whitt w 1992 b numerical inversion of probability generating functions opera tions research letters 12 4 245 251 doi 10 1016 0167 6377 92 90050 d barndorff nielsen oe 1998 processes of normal inverse gaussian type finance and stochastics 2 1 41 68 doi 10 1007 s 007800050032 boyd jp 2001 chebyshev and fourier spectral methods springer heidelberg doi 10 1002 zamm 19910710715 carr p madan d 1999 option valuation using the fast fourier transform journal of com putational finance 2 4 61 73 doi 10 21314 jcf 1999 043 carr p geman h madan db yor m 2002 the fine structure of asset returns an empirical investigation journal of business 75 2 305 332 doi 10 1086 338705 daniele vg zich rs 2014 the wiener hopf method in electromagnetics scitech pub lishing iet edison nj fang f oosterlee cw 2008 a novel pricing method for european options based on fourier cosine series expansions siam journal on scientific computing 31 2 826 848 doi 10 1137 080718061 fang f oosterlee cw 2009 pricing early exercise and discrete barrier options by fourier cosine series expansions numerische mathematik 114 1 27 62 doi 10 1007 s 00211 009 0252 4 feng l linetsky v 2008 pricing discretely monitored barrier options and defaultable bonds in le vy process models a hilbert transform approach mathematical finance 18 3 337 384 doi 10 1111 j 1467 9965 2008 00338 x feng l linetsky v 2009 computing exponential moments of the discrete maximum of a le vy process and lookback options finance and stochastics 13 4 501 529 doi 10 1007 s 00780 009 0096 x frigo m johnson sg 1998 fftw an adaptive software architecture for the fft in proceedings of the 1998 ieee international conference on acoustics speech and signal processing ieee piscataway vol 3 pp 1381 1384 doi 10 1109 icassp 1998 681704 fusai g germano g marazzina d 2016 spitzer identity wiener hopf factorisation and pricing of discretely monitored exotic options european journal of operational research 251 4 124 134 doi 10 1016 j ejor 2015 11 027 hilbert transform spectral filters and option pricing 25 gibbs jw 1898 fourier s series nature 59 1522 200 doi 10 1038 059200 b 0 gibbs jw 1899 fourier s series nature 59 606 doi 10 1038 059606 a 0 gottlieb d shu c 1997 on the gibbs phenomenon and its resolution siam review 39 4 644 668 doi 10 1137 s 0036144596301390 green r fusai g abrahams id 2010 the wiener hopf technique and discretely mon itored path dependent option pricing mathematical finance 20 2 259 288 doi 10 1111 j 1467 9965 2010 00397 x heston sl 1993 a closed form solution for options with stochastic volatility with appli cations to bond and currency options review of financial studies 6 2 327 343 doi 10 1093 rfs 6 2 327 hewitt e hewitt re 1979 the gibbs wilbraham phenomenon an episode in fourier anal ysis archive for history of exact sciences 21 2 129 160 doi 10 1007 bf 00330404 kemperman jhb 1963 a wiener hopf type method for a general random walk with a 2 sided boundary annals of mathematical statistics 34 4 1168 1193 doi 10 1214 aoms 117770 3855 king fw 2009 hilbert transforms cambridge university press cambridge kou s 2002 a jump diffusion model for option pricing management science 48 8 1086 1101 doi 10 1287 mnsc 48 8 1086 166 kreyszig e 2011 advanced engineering mathematics 10 th edn wiley new york lewis a 2001 a simple option formula for general jump diffusion and other exponential le vy processes doi 10 2139 ssrn 282110 ssrn 282110 madan db seneta e 1990 the variance gamma v g model for share market returns journal of business 63 4 511 524 doi 10 1086 296519 marazzina d fusai g germano g 2012 pricing credit derivatives in a wiener hopf framework in cummins m murphy f miller jjh eds topics in numerical methods for finance springer new york springer proceedings in mathematics and statistics vol 19 pp 139 154 doi 10 1007 978 1 4614 3433 7 8 mckechan dja robinson c sathyaprakash bs 2010 a tapering window for time domain templates and simulated signals in the detection of gravitational waves from co alescing compact binaries classical and quantum gravity 27 8 084 020 doi 10 1088 0264 9381 27 8 084020 mercuri l rroji e 2016 option pricing in an exponential mixedts le vy process annals of operations research 260 1 2 353 374 doi 10 1007 s 10479 016 2180 x merton rc 1976 option pricing when underlying stock returns are discontinuous journal of financial economics 3 1 125 144 doi 10 1016 0304 405 x 76 90022 2 noble b 1958 methods based on the wiener hopf technique for the solution of partial differential equations pergamon press london reprinted new york chelsea 1988 nolan jp 2018 stable distributions models for heavy tailed data birkha user boston in progress chapter 1 online at http fs 2 american edu jpnolan www stable stable html polyanin ad manzhirov av 1998 handbook of integral equations crc press boca raton ruijter mj versteegh m oosterlee cw 2015 on the application of spectral filters in a fourier option pricing technique journal of computational finance 19 1 75 106 doi 10 21314 jcf 2015 306 schoutens w 2003 le vy processes in finance wiley new york spitzer f 1956 a combinatorial lemma and its application to probability theory transactions of the american mathematical society 82 2 323 339 doi 10 1090 s 0002 9947 1956 0079851 x 26 phelan et al stenger f 1993 numerical methods based on sinc and analytic functions springer berlin stenger f 2011 handbook of sinc numerical methods crc press boca raton tadmor e 2007 filters mollifiers and the computation of the gibbs phenomenon acta numerica 16 305 378 doi 10 1017 s 0962492906320016 tadmor e tanner j 2005 adaptive filters for piecewise smooth spectral data ima journal of numerical analysis 25 4 635 647 doi 10 1093 imanum dri 026 vandeven h 1991 family of spectral filters for discontinuous problems journal of scien tific computing 6 2 159 192 doi 10 1007 bf 01062118 wilbraham h 1848 on a certain periodic function cambridge and dublin math ematical journal 3 198 201 url https gdz sub uni goettingen de id ppn 600493962 0003 https gdz sub uni goettingen de id ppn 600493962 0003 https gdz sub uni goettingen de id ppn 600493962 0003 hilbert transform spectral filters and option pricing 27 appendix a table 4 contains all the parameters used for the numerical experiments which produced the results presented in section 4 description symbol value option parameters maturity t 1 year initial spot price s 0 1 strike k 1 1 upper barrier double barrier u 1 15 upper barrier down and out u lower barrier l 0 85 risk free interest rate r 0 05 dividend rate q 0 02 model t symbol value nig e t 2 i 2 2 2 15 5 0 5 kou e t 2 2 2 1 p 2 2 i p 1 1 i 1 p 0 3 3 0 1 1 40 2 12 vg 1 i 2 2 2 t 1 9 3 9 1 4 table 4 parameters for the numerical tests and processes used t is the characteristic function of the process that models the transition density of the log price of the underlying asset 1 introduction 2 background 3 error convergence of the pricing procedure 4 numerical results 5 conclusions