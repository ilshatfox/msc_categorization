noname manuscript no will be inserted by the editor generalised approach to modelling a three tiered microbial food web tewfik sari matthew j wade the date of receipt and acceptance should be inserted later abstract ecological modelling of increasingly more complex microbial populations is necessary to reflect the highly functional and diverse behaviour inherent to many systems found in reality anaerobic digestion is one such process that has benefitted from the ap plication of mathematical analysis not only for char acterising the biological dynamics but also to inves tigate emergent behaviour not apparent by simulation alone nevertheless the standard modelling approach has been to describe biological systems using sets of differential equations whose kinetics are generally de scribed by some empirically derived function of growth the drawbacks of this are two fold the growth func tions are derived from empirical studies that may not be representative of the system to be modelled and whose parameters may not have a mechanistic mean ing and mathematical analysis is restricted by a con formity to an assumption of the dynamics here we attempt to address these challenges by investigating a generalised form of a three tier chlorophenol mineral ising food web previously only analysed numerically we examine the existence and stability of the identi fied steady states and find that without a decay term the system may be characterised analytically however it is necessary to perform numerical analysis for the case when maintenance is included but in both cases t sari irstea umr itap montpellier france universite de haute alsace laboratoire de mathe matiques mulhouse france email tewfik sari irstea fr m j wade school of civil engineering of geosciences newcastle uni versity newcastle upon tyne ne 1 7 ru united kingdom email matthew wade newcastle ac uk we verify the discovery of two important phenomena i the washout steady state is always stable and ii the two other steady states can be unstable according to the initial conditions and operating parameters keywords microbial modelling dynamical systems stability theory anaerobic digestion 1 introduction the mathematical modelling of engineered biological systems has entered a new era in recent years with the expansion and standardisation of existing models aimed at collating disparate components of these processes and provide scientists engineers and practitioners with the tools to better predict control and optimise them these forms of mechanistic models emerged initially with the activated sludge models 1 2 for wastewater treatment processes followed by the anaerobic diges tion model no 1 adm 1 3 a few years later the development of adm 1 was enabled largely due to the possibilities for better identification and characterisa tion of functional groups responsible for the discrete degradation steps operating in series within anaerobic digesters it describes a set of fairly complex stoichio metric and kinetic functions representing the standard anaerobic process remaining the scientific benchmark to the present day despite an general understanding of its limitations in describing all necessary biochemical transformations indeed there has been a growing argu ment that the model should take advantage of improved empirical understanding and extension of biochemical processes included in its structure to acquire a better trade off between model realism and complexity 4 it has previously been shown that the simplification or reduction in model complexity can preserve biolog ar x iv 1 50 8 05 25 6 v 1 m at h d s 2 1 a ug 2 01 5 2 tewfik sari matthew j wade ical meaning whilst reducing the computational effort required to find mathematical solutions of the model equations 5 6 7 whilst simpler models are approx imations of real systems it can be beneficial to con sider a reduced model to better understand biologi cal phenomena of sub processes without the need to consider extraneous system parameters and variables which tend to make mathematical analysis intractable and cumbersome nevertheless even with gross simpli fication of a biological system based on a set of ordinary differential equations odes of relatively low dimen sionality analytical techniques are unable to provide general solutions for the system and numerical meth ods must suffice as an example of this for anaerobic digestion a previous study investigated the effect of maintenance on the stability of a two tiered food chain compris ing two species and two substrates 8 although the authors were not able to determine the general con ditions under which this four dimensional syntrophic consortium was stable further work has shown that a model with generality can be used to answer the ques tion posed determining that the two tiered food chain is always stable when maintenance is included 9 in a more recent example the model described by 8 was extended by the addition of a third organism and substrate to create a three tiered food web 10 in this model the stability of some steady states could be determined analytically but due to the complexity of the jacobian matrix for certain steady states local so lutions were necessary using numerical analysis when considering the full system behaviour although the re sults were important in revealing emergent properties of this extended model the motivation of this work is to determine whether the approach carried out in 9 can be applied to the three tiered model from 10 to provide some general properties of that system the paper is organised as follows in section 2 we present a description of the model to be investigated before providing an alternative reduction of its struc ture than that given by 10 in section 3 with sec tion 4 we demonstrate the existence of the three steady states and define four interesting cases for specific pa rameter values that are investigated using the analytical solutions whilst also indicating the regions of existence of the steady states for the operating parameter val ues dilution rate and substrate input concentration in section 5 we perform local stability analysis of the steady states without maintenance and in section 6 perform a comprehensive numerical stability analysis of the four cases for both the model with and without a decay constant we show that our approach leads to the discovery of five operating regions in which one leads to the possibility of instability of the positive steady state where all three organisms exist a fact that has not be reported by 10 indeed we prove that a stable limit cycle can occur in this region finally in section 7 we make comment on the role of the kinetic parameters used in the four example cases in maintaining stability which points to the importance of the relative aptitude of the two hydrogen consumers in sustaining a viable chlorophenol mineralising community in the appendix we describe the numerical method used in section 6 and we give the proofs of the results 2 the model the model developed in 10 has six components three substrate chlorophenol phenol and hydrogen and three biomass chlorophenol phenol and hydrogen de graders variables the substrate and biomass concen trations evolve according to the six dimensional dynam ical of odes dxch dt dxch ychf 0 sch sh 2 xch kdec chxch 1 dxph dt dxph yphf 1 sph sh 2 xph kdec phxph 2 dxh 2 dt dxh 2 yh 2 f 2 sh 2 xh 2 kdec h 2 xh 2 3 dsch dt d sch in sch f 0 sch sh 2 xch 4 dsph dt d sph in sph 224 208 1 ych f 0 sch sh 2 xch f 1 sph sh 2 xph 5 dsh 2 dt sh 2 in sh 2 32 224 1 yph f 1 sph sh 2 xph 16 208 f 0 sch sh 2 xch f 2 sh 2 xh 2 6 where sch and xch are the chlorophenol substrate and biomass concentrations sph and xph those for phe nol and sh 2 and xh 2 those for hydrogen ych yph and yh 2 are the yield coefficients 224 208 1 ych represents the part of chlorophenol degraded to phe nol and 32 224 1 yph represents the part of phe nol that is transformed to hydrogen growth functions take monod form with hydrogen inhibition acting on the phenol degrader and represented in f 1 see eq 7 as a product inhibition term f 0 sch sh 2 km chsch ks ch sch sh 2 ks h 2 c sh 2 f 1 sph sh 2 km phsph ks ph sph 1 1 sh 2 ki h 2 f 2 sh 2 km h 2 sh 2 ks h 2 sh 2 7 here apart from the four operating or control pa rameters which are the inflowing concentrations sch in generalised approach to modelling a three tiered microbial food web 3 sph in sh 2 in and the dilution rate d that can vary all others have biological meaning and are fixed depending on the organisms and substrate considered we use the following simplified notations in eqs 1 6 x 0 xch x 1 xph x 2 xh 2 s 0 sch s 1 sph s 2 sh 2 sin 0 sch in s in 1 sph in s in 2 sh 2 in y 0 ych y 1 yph y 2 yh 2 y 3 224 208 1 ych y 4 32 224 1 yph y 5 16 208 a 0 kdec ch a 1 kdec ph a 2 kdec h 2 with these notations eqs 1 6 can be written as follows dx 0 dt dx 0 y 0 f 0 s 0 s 2 x 0 a 0 x 0 8 dx 1 dt dx 1 y 1 f 1 s 1 s 2 x 1 a 1 x 1 9 dx 2 dt dx 2 y 2 f 2 s 2 x 2 a 2 x 2 10 ds 0 dt d sin 0 s 0 f 0 s 0 s 2 x 0 11 ds 1 dt d sin 1 s 1 y 3 f 0 s 0 s 2 x 0 f 1 s 1 s 2 x 1 12 ds 2 dt d sin 2 s 2 y 4 f 1 s 1 s 2 x 1 y 5 f 0 s 0 s 2 x 0 f 2 s 2 x 2 13 in 10 this model is reduced to a dimensionless form that significantly reduces the number of parameters de scribing the dynamics in this paper we do not assume that the growth functions f 0 f 1 and f 2 have the specific analytical expression eq 7 we will only assume that the growth functions satisfy properties that are listed in appendix c therefore we cannot benefit from the dimensionless rescaling used by 10 because this rescal ing uses some kinetics parameters of the specific growth functions eq 7 while we work with general unspeci fied growth functions in section 3 we consider another rescaling that does not use the kinetics parameters fur thermore we restrict our analysis to the case where we only have one substrate addition to the system such that sin 0 0 s in 1 0 and s in 2 0 3 model reduction to ease the mathematical analysis we can rescale the system eqs 8 13 using the following change of vari ables adapted from 9 x 0 y 3 y 4 y 0 x 0 x 1 y 4 y 1 x 1 x 2 1 y 2 x 1 s 0 y 3 y 4 s 0 s 1 y 4 s 1 s 2 s 2 we obtain the following system dx 0 dt dx 0 0 s 0 s 2 x 0 a 0 x 0 14 dx 1 dt dx 1 1 s 1 s 2 x 1 a 1 x 1 15 dx 2 dt dx 2 2 s 2 x 2 a 2 x 2 16 ds 0 dt d sin 0 s 0 0 s 0 s 2 x 0 17 ds 1 dt ds 1 0 s 0 s 2 x 0 1 s 1 s 2 x 1 18 ds 2 dt ds 2 1 s 1 s 2 x 1 0 s 0 s 2 x 0 2 s 2 x 2 19 where the inflowing concentration is sin 0 y 3 y 4 s in 0 20 the growth functions are 0 s 0 s 2 y 0 f 0 s 0 y 3 y 4 s 2 1 s 1 s 2 y 1 f 1 s 1 y 4 s 2 2 s 2 y 2 f 2 s 2 21 and y 5 y 3 y 4 1 2 1 y 0 1 y 1 22 the benefit of our rescaling is that it permits to fix in eqs 14 19 all yield coefficients to one except that denoted by and defined by eq 22 and to discuss the existence and stability with respect to this sole pa rameter using eq 21 and the growth functions eq 7 we obtain the model eqs 14 19 with the following monod type growth functions 0 s 0 s 2 m 0 s 0 k 0 s 0 s 2 l 0 s 2 1 s 1 s 2 m 1 s 1 k 1 s 1 1 1 s 2 ki 2 s 2 m 2 s 2 k 2 s 2 23 where m 0 y 0 km ch k 0 y 3 y 4 ks ch l 0 ks h 2 c m 1 y 1 km ph k 1 y 4 ks ph ki ki h 2 24 m 2 y 2 km h 2 k 2 ks h 2 for the numerical simulations we will use the nominal values in table 1 given in 10 4 tewfik sari matthew j wade parameters nominal values units km ch 29 kgcods kgcodx d ks ch 0 053 kgcod m 3 ych 0 019 kgcodx kgcods km ph 26 kgcods kgcodx d ks ph 0 302 kgcod m 3 yph 0 04 kgcodx kgcods km h 2 35 kgcods kgcodx d ks h 2 2 5 10 5 kgcod m 3 ks h 2 c 1 0 10 6 kgcod m 3 yh 2 0 06 kgcodx kgcods kdec i 0 02 d 1 ki h 2 3 5 10 6 kgcod m 3 table 1 nominal parameter values 4 existence of steady states a steady state of eqs 14 19 is obtained by setting the right hand sides equal to zero 0 s 0 s 2 d a 0 x 0 0 25 1 s 1 s 2 d a 1 x 1 0 26 2 s 2 d a 2 x 2 0 27 d sin 0 s 0 0 s 0 s 2 x 0 0 28 ds 1 0 s 0 s 2 x 0 1 s 1 s 2 x 1 0 29 ds 2 1 s 1 s 2 x 1 0 s 0 s 2 x 0 2 s 2 x 2 0 30 a steady state exists or is said to be meaningful if and only if all its components are non negative lemma 1 the only steady state of eqs 14 19 for which x 0 0 or x 1 0 is the steady state ss 1 x 0 0 x 1 0 x 2 0 s 0 s in 0 s 1 0 s 2 0 where all species are washed out this steady state al ways exists it is always stable from the previous lemma we deduce that besides the steady state ss 1 the system can have at most two other steady states ss 2 x 0 0 x 1 0 and x 2 0 where species x 2 is washed out while species x 0 and and x 1 exist ss 3 x 0 0 x 1 0 and x 2 0 where all popula tions are maintained in the following we describe the steady states ss 2 and ss 3 of eqs 14 19 with the monod type growth functions eq 23 the general case with unspecified growth function is provided in appendix c with proofs given in appendix d we use the following notations let s 2 be fixed we define the function m 0 y s 2 as follows for all y 0 0 s 2 m 0 s 2 l 0 s 2 we let m 0 y s 2 k 0 y m 0 s 2 l 0 s 2 y notice that y 7 m 0 y s 2 is the inverse function of the function s 0 7 0 s 0 s 2 that is to say for all s 0 0 s 2 0 and y 0 0 s 2 s 0 m 0 y s 2 y 0 s 0 s 2 31 let s 2 be fixed we define the function m 1 y s 2 as follows for all y 0 1 s 2 m 11 s 2 ki we let m 1 y s 2 k 1 y m 1 1 s 2 ki y notice that y 7 m 1 y s 2 is the inverse function of the function s 1 7 1 s 1 s 2 that is to say for all s 1 0 s 2 0 and y 0 1 s 2 s 1 m 1 y s 2 y 1 s 1 s 2 32 we define the function m 2 s 2 as follows for all y 0 2 m 2 we let m 2 y k 2 y m 2 y notice that y 7 m 2 y is the inverse function of the function s 2 7 2 s 2 that is to say for all s 2 0 and y 0 2 s 2 m 2 s 2 y 2 s 2 33 using the functions m 0 m 1 and m 2 we define the following function let 1 let s 2 m 0 d a 0 s 2 m 1 d a 1 s 2 s 2 1 34 notice that is defined if and only if d a 0 0 s 2 and d a 1 1 s 2 which is equivalent to s 02 d s 2 s 1 2 d where s 02 d l 0 d a 0 m 0 d a 0 s 12 d ki m 1 d a 1 d a 1 are the solutions of equations 0 s 2 d a 0 1 s 2 d a 1 35 respectively see fig 1 a straightforward calculations show that s 2 d k 0 d a 0 m 0 d a 0 l 0 s 2 s 2 s 02 d k 1 ki s 2 s 12 d s 2 s 2 1 therefore s 2 0 for s 0 2 s 2 s 1 2 see fig 1 b lim s 2 s 02 s 2 lim s 2 s 12 s 2 generalised approach to modelling a three tiered microbial food web 5 a b c s 2 s 2 s 2 1 s 2 0 s 2 s 2 s 2 d a 0 d a 1 f 2 d f 1 d sin 0 f 1 d s 02 s 1 2 s 0 2 s 1 2 s 0 2 s 1 2 s 2 s 2 m 2 d a 2 6 s 2 s 2 fig 1 graphical definitions a s 02 and s 1 2 b s 2 s 2 f 1 d and f 2 d c s 2 and s 2 a b c d fig 2 graphs of s 02 d and s 1 2 d in black and m 2 d in red and graphical depiction of i 1 0 d 1 where d 1 is the solution of s 02 d s 1 2 d and i 2 a i 2 0 d 2 where d 2 is the solution of m 2 d s 1 2 d b i 2 0 d 2 where d 2 is the solution of m 2 d s 0 2 d c i 2 is empty d i 2 d 2 min d 2 max where d 2 min and d 2 max are the solutions of m 2 d s 0 2 d and m 2 d s 1 2 d respectively and d 2 ds 22 2 k 0 d a 0 m 0 d a 0 l 0 s 0 2 d s 2 s 02 d 3 2 k 1 ki s 1 2 d 1 s 12 d s 2 3 hence d 2 ds 22 0 for all s 2 s 02 d s 12 d so that the function s 2 7 s 2 d is convex and thus it has a unique minimum s 2 d see fig 1 b let 1 we define the function f 1 d inf s 2 s 02 s 1 2 s 2 s 2 36 as shown in fig 1 b the minimum s 2 d is a so lution of an algebraic equation of degree 4 in s 2 al though mathematical software such as maple cannot give its solutions explicitly with respect to the param eters s 2 d could be obtained analytically since alge braic equations of degree 4 can theoretically be solved by quadratures we do not try to obtain such an explicit formula however if the biological parameters are fixed the function s 2 d and hence f 1 d s 2 d d can be obtained numerically the function f 1 d is defined as long as s 0 2 d s 12 d assuming that s 0 2 0 s 1 2 0 f 1 d is defined for 0 d d 1 where d 1 is the positive solution of s 02 d s 1 2 d see fig 2 therefore d 1 is a solution of the the second order algebraic equation l 0 d a 0 m 0 d a 0 ki m 1 d a 1 d a 1 we denote by i 1 d s 02 d s 1 2 d 37 the set on which f 1 d is defined let 1 we define the functions f 2 d m 2 d a 2 38 f 3 d d ds 2 m 2 d a 2 39 since m 2 and are given explicitly by eq 33 and eq 34 respectively the functions f 2 d and f 3 d are given explicitly with respect to the biological pa rameters in eq 23 the functions f 2 d and f 3 d are defined for d such that s 02 d m 2 d s 1 2 d that is to say for d such that l 0 d a 0 m 0 d a 0 k 2 d a 2 m 2 d a 2 ki m 1 d a 1 d a 1 we denote by i 2 d i 1 s 02 d m 2 d s 1 2 d 40 the subset of i 1 on which f 2 d and f 3 d are de fined for all for d i 2 f 1 d f 2 d the equal ity f 1 d f 2 d holds if and only if m 2 d a 2 s 2 d that is d ds 2 m 2 d a 2 0 therefore 6 tewfik sari matthew j wade f 1 d f 2 d holds if and only if f 3 d 0 we define i 3 d i 2 f 3 d 0 since d 7 s 02 d is increasing and d 7 s 12 d is decreasing and assuming s 02 0 s 1 2 0 the domain of definition i 1 of f 1 d is an interval i 1 0 d 1 where d 1 is the solution of s 0 2 d s 1 2 d see fig 2 a necessary condition of existence of ss 2 is 0 d d 1 for the domain of definition i 2 of f 2 d several cases can be distinguished i 2 is an interval i 2 0 d 2 where d 2 is the solution of m 2 d s 1 2 d see fig 2 a or the solution of equation m 2 d s 0 2 d see fig 2 b i 2 is empty see fig 2 c i 2 is an interval i 2 d 2 min d 2 max where d 2 min and d 2 max are the solutions of m 2 d s 0 2 d and m 2 d s 1 2 d re spectively see fig 2 d a necessary condition of exis tence of ss 3 is d i 2 cases a d are obtained with the numerical parameter values listed in table 2 and 3 ks h 2 c ai d 1 d 2 d 3 a 1 0 10 6 0 02 0 432 0 373 0 058 0 0 452 0 393 0 078 b 4 0 10 6 0 02 0 329 0 236 i 3 i 2 0 0 349 0 256 i 3 i 2 c 7 0 10 6 0 02 0 287 i 2 0 0 303 i 2 table 2 parameter values for cases a b and c of fig 2 unspecified parameter values are as in table 1 the table gives the values of d 1 d 2 and d 3 where i 1 0 d 1 i 2 0 d 2 and i 3 0 d 3 ai d 1 d 2 min d 2 max d 3 d 0 02 0 238 0 101 0 198 0 161 0 0 258 0 121 0 218 0 181 table 3 parameter values for case d of fig 2 ks h 2 c 1 2 10 5 ks h 2 0 5 10 5 and km h 2 5 unspeci fied parameter values are as in table 1 the table gives the values of d 1 d 2 min d 2 max and d 3 where i 1 0 d 1 i 2 d 2 min d 2 max and i 3 d 2 min d 3 we can state now the necessary and sufficient con ditions of existence of ss 2 and ss 3 lemma 2 if 1 then ss 2 does not exist if 1 then ss 2 exists if and only if sin 0 f 1 d therefore a necessary condition for the existence of ss 2 is that d i 1 where i 1 is defined by eq 37 if sin 0 f 1 d then each solution s 2 of equation s 2 s in 0 s 2 s 0 2 s 1 2 41 gives a steady state ss 2 x 0 x 1 x 2 0 s 0 s 1 s 2 where s 0 m 0 d a 0 s 2 s 1 m 1 d a 1 s 2 x 0 d d a 0 sin 0 s 0 x 1 d d a 1 sin 0 s 0 s 1 42 lemma 3 if 1 then ss 3 does not exist if 1 then ss 3 exists if and only if sin 0 f 2 d therefore a necessary condition of existence of ss 3 is that d i 2 where i 2 is defined by eq 40 if s in 0 f 2 d then the steady state ss 3 x 0 x 1 x 2 s 0 s 1 s 2 is given by s 0 m 0 d a 0 m 2 d a 2 s 1 m 1 d a 1 m 2 d a 2 s 2 m 2 d a 2 43 and x 0 d d a 0 sin 0 s 0 x 1 d d a 1 sin 0 s 0 s 1 x 2 d d a 2 1 sin 0 s 0 s 1 s 2 44 remark 1 if sin 0 f 1 d then eq 41 has exactly two solutions denoted by s 2 and s 2 and such that see fig 1 c s 02 s 2 s 2 s 2 s 1 2 if sin 0 f 0 d then s 0 2 s 2 s 2 s 2 s 1 2 to these solutions s 2 and s 2 correspond two steady states of ss 2 which are denoted by ss 2 and ss 2 these steady states coalesce when sin 0 f 0 d since f 1 d f 2 d the condition sin 0 f 2 d for the existence of the positive steady state ss 3 implies that the condition sin 0 f 2 d for the existence of the two steady states ss 2 and ss 2 is satisfied therefore if ss 3 exists then ss 2 and ss 2 exist and are distinct if sin 0 f 2 d then ss 3 coalesces with ss 2 if f 3 d 0 and with ss 2 if f 3 d 0 respectively remark 2 using eq 20 the conditions sin 0 f 1 d and sin 0 f 2 d of existence of the steady state ss 2 and ss 3 respectively are equivalent to the conditions sch in f 1 d y 3 y 4 and sch in f 2 d y 3 y 4 respectively expressed with respect to the inflowing concentration sch in our aim now is to describe the operating diagram the operating diagram shows how the system behaves when we vary the two control parameters sch in and d generalised approach to modelling a three tiered microbial food web 7 in eqs 1 6 according to remark 2 the curve 1 of equation sch in 1 y 3 y 4 f 1 d 45 is the border to which ss 2 exists and the curve 2 of equation sch in 1 y 3 y 4 f 2 d 46 is the border to which ss 3 exists see fig 3 if we want to plot the operating diagram we must fix the values of the biological parameters in the remainder of the section we plot the operating diagrams corresponding to cases a d depicted in fig 2 i j 1 j 2 j 3 j 1 j 3 j 4 d d sch in sch in 1 r 2 6 1 r 2 i ii j 1 j 2 j 3 j 1 j 3 j 4 j 5 d d sch in sch in 1 2 6 3 1 r 2 r 3 i fig 3 the curves 1 black 2 red and 3 green for case a i regions of steady state existence with maintenance on the right a magnification for 0 d d 3 0 058 showing the region j 4 ii regions of steady state existence and their stability without maintenance on the right a magnification for 0 d d 3 0 078 showing the regions j 4 and j 5 4 1 operating diagram case a this case corresponds to the parameter values used by 10 we have seen in table 2 that the curves 1 and 2 are defined for d d 1 and d d 2 respec tively and that they are tangent for d d 3 where d 1 0 432 d 2 0 373 and d 3 0 058 therefore they separate the operating plane sch in d into four regions as shown in fig 3 i labelled j 1 j 2 and j 3 and j 4 the results are summarised in table 4 which shows the existence of the steady states ss 1 ss 2 and ss 3 in the regions of the operating diagram in fig 3 i region steady states j 1 ss 1 j 2 j 4 ss 1 ss 2 ss 2 j 3 ss 1 ss 2 ss 2 ss 3 table 4 existence of steady states in the regions of the op erating diagrams of fig 3 i and fig 6 i i j 1 j 4 j 3 j 1 j 3 j 4 d d sch in sch in 1 26 1 2 ii j 1 j 4 j 3 j 5 j 1 j 3 j 4 j 5 d d sch in sch in 2 1 6 3 1 2 3 fig 4 the curves 1 black 2 red and 3 green for case b i regions of steady state existence with mainte nance ii regions of steady state existence and their stabil ity without maintenance on the right a magnification for 0 d 0 1 region steady states j 1 ss 1 j 4 ss 1 ss 2 ss 2 j 3 ss 1 ss 2 ss 2 ss 3 table 5 existence of steady states in the regions of the op erating diagram of fig 4 i 4 2 operating diagram case b this case corresponds to the parameter values used by 10 except that ks h 2 c is changed from 1 0 10 6 to 4 0 10 6 we have seen in table 2 that the curves 1 and 2 are defined for d d 1 and d d 2 re spectively and f 1 d f 2 d for all d d 2 where d 1 0 329 and d 2 0 236 therefore they sepa rate the operating plane sch in d in three regions as shown in fig 4 i labelled j 1 j 3 and j 4 the results are summarised in table 5 which shows the existence of the steady states ss 1 ss 2 and ss 3 in the regions of the operating diagram in fig 4 i note that the region j 2 has disappeared 8 tewfik sari matthew j wade i j 1 j 4 j 1 j 4 d d sch in sch in 1 6 1 ii j 1 j 4 j 1 j 4 d d sch in sch in 1 6 1 fig 5 the curve 1 for case c i regions of steady state existence with maintenance ii regions of steady state ex istence without maintenance and their stability on the right a magnification for 0 d 0 1 region steady states j 1 ss 1 j 4 ss 1 ss 2 ss 2 table 6 existence of steady states in the regions of the op erating diagram of fig 5 i 4 3 operating diagram case c this case corresponds to the parameter values used by 10 except that ks h 2 c is changed from 1 0 10 6 to 7 0 10 6 we have seen in table 2 that the curve 1 is defined for d d 1 0 287 and that i 2 is empty so that ss 3 does not exist therefore 1 separates the operating plane sch in d in two regions as shown in fig 5 i labelled j 1 and j 4 the results are summarised in table 6 which shows the existence of the steady states ss 1 and ss 2 in the regions of the operating diagram in fig 5 i note that the region j 3 of existence of ss 3 has disappeared 4 4 operating diagram case d we end this discussion on the role of kinetic param eters by the presentation of this case which presents a new behaviour that did not occur in the preceding cases there exists d 2 min such that for d d 2 min the system cannot have a positive steady state ss 3 this case corresponds to the parameter values used by 10 except that three of them are changed as indicated in table 3 this table shows that the curves 1 and 2 are defined for d d 1 and d 2 min d d 2 max and i j 1 j 2 j 3 j 4 j 1 j 4 d d sch in sch in 1 2 6 1 ii j 1 j 2 j 5 j 3 j 4 j 1 j 4 d d sch in sch in 1 2 6 3 1 fig 6 the curves 1 black 2 red and 3 green for case d i regions of steady state existence with mainte nance ii regions of steady state existence and their stabil ity without maintenance on the right a magnification for 0 d 0 1 that they are tangent for d d 3 where d 1 0 238 d 2 min 0 101 d 2 max 0 198 and d 3 0 161 there fore 1 and 2 separate the operating plane sch in d in four regions as shown in fig 6 i labelled j 1 j 2 j 3 and j 4 the results are summarised in table 4 which shows the existence of the steady states ss 1 ss 2 and ss 3 in the regions of the operating diagram in fig 6 i 4 5 stability of steady states we know that ss 1 is always stable the analytical study of the stability of ss 2 and ss 3 is very difficult because the conditions for routh hurwitz in the 6 dimensional case are intractable for this reason we will consider in section 5 the question of the stability only in the case without maintenance since the system reduces to a 3 dimensional the general case will be considered only numerically in section 6 5 local stability without maintenance when maintenance is not considered in the model the steady states ss 1 ss 2 and ss 3 are given by 1 ss 1 0 0 0 sin 0 0 0 2 ss 2 x 0 x 1 0 s 0 s 1 s 2 where s 2 a solution of equation sin 0 s 2 m 0 d s 2 m 1 d s 2 s 2 1 generalised approach to modelling a three tiered microbial food web 9 and s 0 m 0 d s 2 s 1 m 1 d s 2 x 0 s in 0 s 0 x 1 s in 0 s 0 s 1 47 3 ss 3 x 0 x 1 x 2 s 0 s 1 s 2 where s 2 m 2 d s 0 m 0 d s 2 s 1 m 1 d s 2 x 0 s in 0 s 0 x 1 s in 0 s 0 s 1 48 x 2 1 sin 0 s 0 s 1 s 2 proposition 1 let ss 2 x 0 x 1 0 s 0 s 1 s 2 be a steady state then ss 2 is stable if and only if 2 s 2 d and d ds 2 0 therefore ss 2 is always unstable and ss 2 is stable if and only if 2 s 2 d this last condition is equiv alent to m 2 d s 2 which implies that f 3 d 0 hence if ss 3 exists then ss 2 is necessarily unstable therefore ss 2 is stable if and only if f 3 d 0 and ss 3 does not exist proposition 2 let ss 3 x 0 x 1 x 2 s 0 s 1 s 2 be a steady state if f 3 d 0 then ss 3 is stable as long as it exists if f 3 d 0 then ss 3 can be unstable the instability of ss 3 occurs in particular when s 2 is sufficiently close to s 2 that is to say ss 3 is sufficiently close to ss 2 the condition f 3 d 0 is equivalent to d ds 2 m 2 d 0 that is to say s 2 m 2 d s 2 s 2 if d ds 2 0 that is to say s 2 s 2 s 2 then ss 3 can be unstable when d is such that f 3 d 0 the determination of the boundary between the regions of stability and instability of ss 3 needs to examine the routh hurwitz condition of stability for ss 3 for this purpose we define the following functions let ss 3 x 0 x 1 x 2 s 0 s 1 s 2 be a steady state let e 0 s 0 f 0 s 2 g 1 s 1 h 1 s 2 i d 2 ds 2 evaluated at the steady state ss 3 defined by 48 that is to say for s 2 m 2 d s 0 m 0 d s 2 s 1 m 1 d s 2 for d i 3 and sin 0 f 2 d we define f 4 d sin 0 eix 0 x 2 e g h 1 fg x 0 x 1 f 2 ix 2 g h x 1 fx 0 gix 1 x 2 49 where f 2 ix 2 g h x 1 e f x 0 notice that to compute f 4 d sin 0 we must replace x 0 x 1 x 2 s 0 s 1 and s 2 by their values at ss 3 given by 48 hence this function depends on the operating parameters d and existence stability ss 1 always exists always stable ss 2 sin 0 f 1 d always unstable ss 2 sin 0 f 1 d f 3 d 0 and s in 0 f 2 d ss 3 sin 0 f 2 d f 3 d 0 or f 3 d 0 and f 4 d sin 0 0 table 7 existence with or without maintenance and sta bility without maintenance of steady states sin 0 for each fixed d i 3 f d sin 0 is polynomial in sin 0 of degree 3 and tends to when sin 0 tends to therefore it is necessarily positive for large enough sin 0 the values of the operating parameters d and sin 0 for which f d sin 0 is positive correspond to the stability of ss 3 as shown in the following proposition proposition 3 let ss 3 x 0 x 1 x 2 s 0 s 1 s 2 be a steady state if f 3 d 0 then ss 3 is stable if and only if f 4 d sin 0 0 the results on the existence of steady states with or without maintenance of lemma 1 lemma 2 and lemma 3 and their stability without maintenance of prop 1 prop 2 and prop 3 are summarised in table 7 5 1 operating diagram case a this case corresponds to the parameter values used by 10 but without maintenance we see from table 2 that the curves 1 and 2 of the operating diagram given by eq 45 and eq 46 respectively are defined now for d d 1 0 452 and d d 2 0 393 respec tively and that they are tangent for d d 3 0 078 beside these curves we plot also on the operating dia gram of fig 3 ii the curve 3 of equation f 4 d y 3 y 4 sch in 0 50 according to prop 3 this curve is defined for d d 3 0 078 and it separates the region of existence of ss 3 into two subregions labelled j 3 and j 5 such that ss 3 is stable in j 3 and unstable in j 5 the other regions j 1 j 2 and j 4 are defined as in the previous section the operating diagram is shown fig 3 ii it looks very similar to fig 3 i except near the origin as it is indicated in the magnification for 0 d d 3 0 078 from table 7 we deduce the following result proposition 4 table 8 shows the existence and stabil ity of the steady states ss 1 ss 2 and ss 3 in the regions of the operating diagram in fig 3 ii 10 tewfik sari matthew j wade region ss 1 ss 2 ss 2 ss 3 j 1 s j 2 s u s j 3 s u u s j 4 s u u j 5 s u u u table 8 existence and stability of steady states in the re gions of the operating diagrams of fig 3 ii and fig 6 ii region ss 1 ss 2 ss 2 ss 3 j 1 s j 3 s u u s j 4 s u u j 5 s u u u table 9 existence and stability of steady states in the re gions of the operating diagram of fig 4 ii region ss 1 ss 2 ss 2 ss 3 j 1 s j 4 s u u table 10 existence and stability of steady states in the re gions of the operating diagram of fig 5 ii 5 2 operating diagram case b we see from table 2 that the curves 1 and 2 are de fined now for d d 1 0 349 and d d 2 0 256 respectively and that f 1 d f 2 d for all d beside these curves we plot also on the operating diagram of fig 4 ii the curve 3 of equation eq 50 which sepa rates the region of existence of ss 3 into two subregions labelled j 3 and j 5 such that ss 3 is stable in j 3 and unstable in j 5 therefore the curves 1 2 and 3 sep arate the operating plane sch in d into four regions as shown in fig 4 ii labelled j 1 j 3 j 4 and j 5 proposition 5 table 9 shows the existence and stabil ity of the steady states ss 1 ss 2 and ss 3 in the regions of the operating diagram in fig 4 ii 5 3 operating diagram case c we see from table 2 that 1 is defined for d d 1 0 303 and that i 2 is empty so that ss 3 does not exist therefore 1 separates the operating plane sch in d into two regions as shown in fig 5 ii labelled j 1 and j 4 proposition 6 table 10 shows the existence and sta bility of the steady states ss 1 ss 2 and ss 3 in the re gions of the operating diagram in fig 5 ii 5 4 operating diagram case d we see in table 3 that the curves 1 and 2 are de fined for d d 1 and d 2 min d d 2 max and that they are tangent for d d 3 where d 1 0 258 and d 2 min 0 121 d 2 max 0 218 and d 3 0 181 beside these curves we plot also on the operating diagram of fig 6 ii the curve 3 defined by eq 50 which sepa rates the region of existence of ss 3 into two subregions labelled j 3 and j 5 such that ss 3 is stable in j 3 and unstable in j 5 therefore the curves 1 2 and 3 sep arate the operating plane sch in d into five regions as shown in fig 6 ii labelled j 1 j 2 j 3 j 4 and j 5 proposition 7 table 8 shows the existence and stabil ity of the steady states ss 1 ss 2 and ss 3 in the regions of the operating diagram in fig 6 ii 6 numerical analysis to confirm and extend the analytical results the aim of this section is to study numerically the method is explained in appendix a the existence and stability of the steady states ss 2 and ss 3 we obtain numerically the operating diagrams that were described in sections 4 and 5 the results in this section confirm the results on existence of the steady states obtained in section 4 in the case with or without maintenance and the results of stability obtained in section 5 in the case without maintenance these results permit also to elucidate the problem of the local stability of ss 2 and ss 3 which was left open in section 4 5 6 1 operating diagram case a we endeavoured to find numerically the operating con ditions under which ss 3 is unstable previously unre ported by 10 given that we have determined analyti cally in proposition 2 that when ss 3 is close to ss 2 it becomes unstable we performed numerical simulations with the parameters defined in table 1 over an oper ating region similar to that shown in fig 2 from 10 whilst also satisfying our conditions in fig 7 we show the case when maintenance is excluded when magni fied we observe more clearly that region j 5 does exist for the conditions described above and also note that the region j 4 occurs in a small area between j 1 and j 5 which corresponds to the results shown in fig 3 ii and is in agreement with proposition 4 in fig 8 we confirm that region j 5 does exist for the conditions described above when maintenance is included but could not be determined analytically the curve 3 is generalised approach to modelling a three tiered microbial food web 11 absent in fig 3 i furthermore we demonstrate that a hopf bifurcation occurs along the boundary of f 3 d for values of d d 3 by selecting values of sch in indi cated by in fig 8 at a fixed dilution rate of 0 01 d 1 and running dynamic simulations for 10000 d the three dimensional phase plots with the axes rep resenting biomass concentrations are shown in fig 9 and show that as sch in approaches j 3 from j 5 emer gent periodic orbits are shown to diminish to a stable limit cycle at the boundary see appendix b for proof subsequently increasing sch in to j 3 results in the orbit reducing to a fixed point equilibrium at ss 3 j 1 j 2 j 3 j 5 j 4 i d sch in j 1 j 2 j 3 j 4 j 5 ii 6 d sch in fig 7 numerical analysis for the existence and stability of steady states for case a without maintenance on the right a magnification for 0 d 0 16 j 1 j 2 j 3 j 4 j 5 d sch in fig 8 numerical analysis for the existence and stability of steady states for case a with maintenance this is a mag nification for 0 d 0 1 showing the presence and extent of region j 5 undetectable by the analytical method the co ordinates labelled are subsequently used to simulate the system dynamics as shown in the proceeding fig 9 10 5 6 x ch kgcod m 3 4 2 00 1 2 x ph kgcod m 3 3 4 5 10 4 10 5 6 0 2 4 6 x h 2 k g c o d m 3 10 10 4 x ch kgcod m 3 8 6 4 2 00 5 x ph kgcod m 3 10 15 10 4 10 4 2 1 0 x h 2 k g c o d m 3 10 4 6 x ch kgcod m 3 4 2 00 0 5 x ph kgcod m 3 1 10 5 10 3 14 10 6 2 1 5 x h 2 k g c o d m 3 10 3 1 x ch kgcod m 3 0 8 0 6 0 4 0 2 00 0 5 1 x ph kgcod m 3 1 5 2 10 4 10 3 2 0 5 1 1 5 2 5 x h 2 k g c o d m 3 fig 9 three dimensional phase plane diagrams of the biomass dynamics for t 10000 d showing initial green dot and final red dot conditions for a dilution rate d 0 01 d 1 and chlorophenol input sch in kgcod m 3 of 0 01 the system converges to ss 1 0 097 the system enters a peri odic orbit of increasing amplitude ultimately converging to ss 1 0 10052 the system is close to a stable limit cy cle 0 16 the system undergoes damped oscillations and converges to ss 3 6 2 operating diagram case b whilst the numerical parameters chosen for this work are taken from the original study 10 there some what arbitrary nature leaves room to explore the im pact of the parameters on the existence and stability of the steady states case b discussed in sections 4 2 and 5 2 involves a small increase to the half saturation constant or inverse of substrate affinity ks h 2 c of the chlorophenol degrader on hydrogen following the same approach as with the preceding case we confirm in fig 10 i the proposition 5 in the scenario without maintenance furthermore the extension of this propo sition with maintenance included corresponding to the existence and stability of all three steady states given in table 9 is show in fig 10 ii it shows the region j 5 that cannot be obtained analytically cf fig 4 i in both cases region j 2 has disappeared as observed analytically additionally the ideal condition j 3 where all organisms are present and stable diminishes 6 3 operating diagram case c here ks h 2 c was further increased and confirm the proposition 6 where the function ss 3 never exist and ss 2 never stable for the case without maintenance the extension of this proposition to the case with mainte 12 tewfik sari matthew j wade nance shown in table 10 produce similar results as shown in the comparison of figs 11 i and ii 6 4 operating diagram case d with the final investigated scenario where km h 2 km ch and ks h 2 ks h 2 c we observe once again the presence of all operating regions j 1 j 5 without and with maintenance as shown in fig 12 it can be seen that regions j 4 and j 5 increase at low dilution rates across a much larger range of sch in than in the default case a and the desired condition stable ss 3 is re stricted to a much narrower set of d as with the previous cases the numerical analysis for case d confirms the proposition 7 without mainte nance and its extension to the case with maintenance indicated in table 8 j 1 j 4 j 3 j 5 i i d sch in j 1 j 4 j 3 j 5 i ii d sch in fig 10 numerical analysis for the existence and stability of steady states for case b i without maintenance ii with maintenance 7 the role of kinetic parameters finally we give brief consideration to the characteri sation of the four cases discussed in the preceding sec tions the main difference between cases a or b and cases c or d is that for small values of d the co existence steady state ss 3 can exist for cases a and b but cannot exist for cases c or d the cases a or b occur if and only if s 02 0 m 2 0 holds or s 02 0 m 2 0 and ds 02 dd 0 dm 2 dd 0 hold that is to say l 0 a 0 m 0 a 0 k 2 a 2 m 2 a 2 or 51 l 0 a 0 m 0 a 0 k 2 a 2 m 2 a 2 and l 0 m 0 m 0 a 0 2 k 2 m 2 m 2 a 2 2 52 j 1 j 4 i d sch in j 1 j 4 d sch in j 1 j 4 ii d sch in j 1 j 4 d sch in fig 11 numerical analysis for the existence and stability of steady states for case c i without maintenance ii with maintenance on the right a magnification for 0 d 0 1 j 1 j 2 j 3 j 4 j 5 i d sch in j 1 j 2 j 3 j 4 j 5 ii d sch in fig 12 numerical analysis for the existence and stability of steady states for case d i without maintenance ii with maintenance the cases c or d occur if and only if s 02 0 m 2 0 holds or s 02 0 m 2 0 and ds 02 dd 0 dm 2 dd 0 hold that is to say l 0 a 0 m 0 a 0 k 2 a 2 m 2 a 2 or 53 l 0 a 0 m 0 a 0 k 2 a 2 m 2 a 2 and l 0 m 0 m 0 a 0 2 k 2 m 2 m 2 a 2 2 54 notice that it is easy to make the difference between case c and case d the first occurs when m 2 d 1 s 02 d 1 and the second when m 2 d 1 s 0 2 d 1 since d 1 is the positive solution of the algebraic quadratic equation s 02 d s 1 2 d it is possible to have an ex pression for d 1 with respect to the biological param generalised approach to modelling a three tiered microbial food web 13 eters however this is a complicated expression in volving many parameters and the preceding conditions m 2 d 1 s 0 2 d 1 or m 2 d 1 s 0 2 d 1 have no bio logical interpretation we simply remark here that the function s 02 d has a vertical asymptote ford m 0 a 0 and the function m 2 d has a vertical asymptote for d m 2 a 2 therefore if m 0 a 0 m 2 a 2 then case c occurs so that a necessary but not sufficient condition for case d to occur is m 0 a 0 m 2 a 2 if m 2 is sufficiently small then case d can occur the observations from the numerical analysis sug gest that the role of the chlorophenol degrader as a secondary hydrogen scavenger is critical in maintain ing full chlorophenol mineralisation and system stabil ity particularly at higher dilution rates as shown by comparing cases c and d more significantly the results coupled with the parameter relationships shown in eqs 51 54 highlight the necessary conditions under which the ideal case ss 3 stable is achieved and in general this is a coupling of the two key parameters describing the half saturation constant and maximum specific growth rates between the two hydrogen com petitors 8 conclusions in this work we have generalised a simplified mecha nistic model describing the anaerobic mineralisation of chlorophenol in a two step food web we are able to show complete analytical solutions describing the exis tence and stability of the steady states in the case that maintenance is excluded from the system whilst with a decay term present purely analytical determination of stability is not possible we confirm the findings of previous numerical anal ysis by 10 that with chlorophenol as the sole input substrate three steady states are possible however the analysis goes further and we determine that under certain operating conditions two of these steady states ss 2 and ss 3 can become stable whilst ss 1 always exists and is always stable furthermore without main tenance we can explicitly determine the stability of the system and form analytical expressions of the bound aries between the different stability regions as the boundary of j 3 is not open to analytical determination in the case with maintenance we de termined numerically substituting the general growth function with the classical monod type growth kinet ics the existence and stability of the system over a range of practical operating conditions dilution rate and chlorophenol input for comparison and confirma tion we also performed this for the case without main tenance and found the same regions in both cases with variations only in their shape and extent for example whilst the boundary between j 1 and j 4 terminates at the origin without maintenance with maintenance it is located at f 1 0 y 3 y 4 0 0195 more interestingly the addition of a decay term results in an extension of the ss 3 unstable steady state reducing the poten tial for successful chlorophenol demineralisation at rel atively low dilution rates and substrate input concen trations additionally we show that at the boundary between j 3 and j 5 a hopf bifurcation occurs and a limit cycle in ss 3 emerges finally we gave an example of how the model could be used to probe the system to answer specific ques tions regarding model parameterisation here we have indicated that a switch in dominance between two or ganisms competing for hydrogen results in the system becoming unstable and a loss in viability this is per haps intuitive to microbiologists but here it has been proven using mathematical analysis and could be used to determine critical limits of the theoretical parameter values in shifting between a stable and unstable system whilst parameters are not arbitrary in real organisms the potential for microbial engineering or synthetic bi ology to manipulate the properties of organisms makes this observation all the more pertinent a numerical methods we consider sets of operating parameters d and sch in for each of the three steady states and using matlab the com plex polynomials for each steady state can be solved by sub stitution of parameter values see table 1 into the explicit solution by investigating the signs of the solutions and the eigenvalues respectively we determine which steady states are meaningful and stable by exploring a localised region of suitable operating parameters we then generate a phase plot showing where each steady state is stable bistable or unstable b proof for hopf bifurcation in section 6 we show the operating diagrams with the pa rameters given in table 1 and determine numerically that as the parameter sch in increases at a fixed dilution rate d 0 01 d 1 the system bifurcates through several sta bility domains we claim that as we cross the boundary be tween regions j 5 and j 3 we observe a hopf bifurcation and in j 5 close to the boundary with j 3 a limit cycle appears in order to test this numerically we checked the real parts of the six eigenvalues at each point along the transect shown in fig 8 10000 points in total and plotted their values fig 13 indicates the conditions for a hopf bifurcation are satisfied as eigenvalues 2 and 3 both change their sign when passing through the coordinate 0 0 1034 and the real part of all eigenvalues 1 4 and 6 remain negative 14 tewfik sari matthew j wade e ig e n v a lu e 1 e ig e n v a lu e 2 e ig e n v a lu e 3 e ig e n v a lu e 4 e ig e n v a lu e 5 e ig e n v a lu e 6 sch in fig 13 real parts of the eigenvalues determined at d 0 01 and sch in 0 08 0 12 in the case with maintenance the red vertical lines indicate the location where the eigenvalue crosses zero c general case as mentioned at the end of section 2 our study does not re quire that growth functions are of monod type eq 23 ac tually the results are valid for a more general class of growth functions satisfying the following conditions which concur with those given by eq 23 h 1 for all s 0 0 and s 2 0 then 0 0 s 0 s 2 and 0 0 s 2 0 0 s 0 0 0 h 2 for all s 1 0 and s 2 0 then 0 1 s 1 s 2 and 1 0 s 2 0 h 3 for all s 2 0 then 0 2 s 2 and 2 0 0 h 4 for all s 0 0 and s 2 0 0 s 0 s 0 s 2 0 0 s 2 s 0 s 2 0 h 5 for all s 1 0 and s 2 0 1 s 1 s 1 s 2 0 1 s 2 s 1 s 2 0 h 6 for all s 2 0 d 2 ds 2 s 2 0 h 7 the function s 2 7 0 s 2 is monotonically increas ing and the function s 2 7 1 s 2 is monotonically decreasing we use eq 31 eq 32 and eq 33 to define m 0 y s 2 m 1 y s 2 and m 2 y respectively lemma 4 let s 2 0 be fixed there exists a unique function y 0 0 s 2 7 m 0 y s 2 0 such that for s 0 0 s 2 0 and y 0 0 s 2 we have s 0 m 0 y s 2 y 0 s 0 s 2 55 lemma 5 let s 2 0 be fixed there exists a unique function y 0 1 s 2 7 m 1 y s 2 0 such that for s 1 0 s 2 0 and y 0 0 1 s 2 we have s 1 m 1 y s 2 y 1 s 1 s 2 56 lemma 6 there exists a unique function y 0 2 7 m 2 y 0 such that for s 2 0 and y 0 2 we have s 2 m 2 y y 2 s 2 57 we use eq 35 to define the functions s 12 d and s 1 2 d lemma 7 for d a 0 0 and d a 1 1 0 there exist unique values s 02 and s 1 2 such that 0 s 02 d a 0 1 s 1 2 d a 1 58 let 1 we use eq 34 to define s 2 d in the general case we let s 02 s 1 2 r defined by s 2 m 0 d a 0 s 2 m 1 d a 1 s 2 s 2 1 59 it should be noted that s 2 0 for s 0 2 s 2 s 1 2 from eq 55 eq 56 and eq 58 we deduce that m 0 d a 0 s 0 2 m 1 d a 1 s 1 2 therefore we have lim s 2 s 02 s 2 lim s 2 s 12 s 2 hence the function s 2 which is positive and tends to at the extremities of the interval s 02 s 1 2 has a minimum value on this interval we add the following assumption h 8 the function has a unique minimum s 2 on the interval s 02 s 1 2 and d ds 2 s 2 is negative on s 0 2 s 2 and positive on s 2 s 1 2 respectively the function together with the values s 02 s 1 2 and s 2 all depend on d however to avoid cumbersome notations we will use the more precise notations s 2 d s 0 2 d s 1 2 d and s 2 d only if necessary we use eq 36 eq 38 and eq 39 to define f 1 d f 2 d and f 3 d in the general case f 1 d inf s 2 s 02 s 1 2 s 2 s 2 60 f 2 d m 2 d a 2 61 f 3 d d ds 2 m 2 d a 2 62 the function f 1 d is defined for d i 1 d 0 s 02 d s 1 2 d the function f 2 d and f 3 d are defined for d i 2 d i 1 s 02 d m 2 d a 2 s 1 2 d for all for d i 2 f 1 d f 2 d the equality f 1 d f 2 d holds if and only if m 2 d a 2 s 2 d that is d ds 2 m 2 d a 2 0 that is if and only if f 3 d 0 as it will be shown in appendix d the lemmas 2 and 3 stated in section 5 in the particular case of the monod type growth functions eq 23 are true in the general case of growth functions satisfying assumptions h 1 h 8 generalised approach to modelling a three tiered microbial food web 15 d proofs in this section we give the proofs of the results in these proofs we do not assume that the growth function are of monod type eq 23 we only assume that the growth func tions satisfy h 1 h 8 d 1 existence of steady states proof lemma 1 assume first that x 0 0 then as a conse quence of eq 28 we have s 0 s in 0 and as a consequence of eq 29 we have ds 1 1 s 1 s 2 x 1 0 which implies s 1 0 and 1 s 1 s 2 x 1 0 therefore as a consequence of eq 26 we have x 1 0 replacing x 0 0 and x 1 0 in eq 30 we have ds 2 2 s 2 x 2 0 which implies s 2 0 and 2 s 2 x 2 0 therefore as a con sequence of eq 27 we have x 2 0 hence the steady state is ss 1 assume now that x 1 0 then as a consequence of eq 30 we have ds 2 0 s 0 s 2 x 0 2 s 2 x 2 0 which implies s 2 0 0 s 0 s 2 x 0 0 and 2 s 2 x 2 0 therefore as a consequence of eq 25 we have x 0 0 as shown previously this implies that the steady state is ss 1 evaluated at ss 1 the jacobian matrix of eqs 14 19 is d a 0 0 0 0 0 0 0 d a 1 0 0 0 0 0 0 d a 2 0 0 0 0 0 0 d 0 0 0 0 0 0 d 0 0 0 0 0 0 d thus ss 1 is stable ut proof lemma 2 since x 0 0 and x 1 0 then as a conse quence of eq 25 and eq 26 we have 0 s 0 s 2 d a 0 1 s 1 s 2 d a 1 hence we have s 0 m 0 d a 0 s 2 s 1 m 1 d a 1 s 2 63 using eq 28 and eq 29 we have eq 42 using eq 30 we have s 2 sin 0 s 0 s 1 s in 0 s 0 0 64 if 1 this equation has no solution if 1 this equation is equivalent to sin 0 s 0 s 1 s 2 1 using eq 63 we see that s 2 must be a solution of eq 41 since s 1 0 and s 2 0 then from eq 64 we have necessarily s 1 s 2 1 sin 0 s 0 0 so that sin 0 s 0 0 from eq 42 we deduce that x 0 0 since sin 0 s 0 0 and s 2 0 then from eq 64 we have necessarily sin 0 s 0 s 2 s in 0 s 0 s 1 0 so that sin 0 s 0 s 1 0 from eq 42 we deduce that x 1 0 ut proof lemma 3 since x 0 0 x 1 0 and x 2 0 then as a consequence of eq 25 eq 26 and eq 27 we have 0 s 0 s 2 d a 1 s 1 s 2 d b 2 s 2 d c hence s 0 s 1 and s 2 are given by eq 43 using eq 28 eq 29 and eq 30 we have eq 44 for x 2 to be positive it is necessary that s 0 s 1 and s 2 satisfy the condition 1 sin 0 s 0 s 1 s 2 65 if 1 this equation has no solution if 1 this equation is equivalent to the condition sin 0 s 0 s 1 s 2 1 using eq 43 this condition is the same as sin 0 m 2 d a 2 f 2 d therefore from eq 65 we have sin 0 s 0 0 and s in 0 s 0 s 1 0 so that x 0 0 and x 1 0 ut d 2 stability of steady states we use the change of variables z 0 s 0 x 0 z 1 s 1 x 1 x 0 z 2 s 2 x 2 x 0 x 1 66 therefore eqs 14 19 with a 0 a 1 a 2 0 become dx 0 dt dx 0 0 z 0 x 0 z 2 x 0 x 1 x 2 x 0 67 dx 1 dt dx 1 1 z 1 x 0 x 1 z 2 x 0 x 1 x 2 x 1 68 dx 2 dt dx 2 2 z 2 x 0 x 1 x 2 x 2 69 dz 0 dt d sin 0 z 0 70 dz 1 dt dz 1 71 dz 2 dt dz 2 72 in the variables x 0 x 1 x 2 z 0 z 1 z 2 where z 1 z 2 and z 3 are defined by eq 66 the steady states ss 1 ss 2 and ss 3 are given by 1 ss 1 0 0 0 sin 0 0 0 2 ss 2 x 0 x 1 0 s in 0 0 0 where x 0 and x 1 are defined by eq 47 3 ss 3 x 0 x 1 x 2 s in 0 0 0 where x 0 x 1 and x 2 are de fined by eq 48 let x 0 x 1 x 2 s in 0 0 0 be a steady state the jacobian matrix of eqs 67 72 has the block triangular form j j 1 j 2 0 j 3 where j 1 0 d e f x 0 fx 0 fx 0 g h x 1 1 d g h x 1 hx 1 ix 2 ix 2 2 d ix 2 j 2 ex 0 0 fx 00 gx 1 hx 1 0 0 ix 2 j 3 d 0 00 d 0 0 0 d 16 tewfik sari matthew j wade and e 0 s 0 f 0 s 2 g 1 s 1 h 1 s 2 i d 2 ds 2 are evaluated at the steady state since j is a block triangular matrix its eigenvalues are d with multiplicity 3 together with the eigenvalues of the 3 3 upper left matrix j 1 note that we have used the oppo site sign for the partial derivative h 1 s 2 so that all constants involved in the computation become positive which will simplify the analysis of the characteristic polynomial of j 1 proof proposition 1 evaluated at ss 2 the matrix j 1 is j 1 e f x 0 fx 0 fx 0 g h x 1 g h x 1 hx 1 0 0 2 d since j 1 is a block triangular matrix its eigenvalues are sim ply 2 d together with the eigenvalues of the 2 2 upper left matrix note that the trace of this 2 2 matrix is negative hence its eigenvalues are of negative real part if and only if its determinant is positive that is if and only if e g h 1 fg 0 73 using m 0 s 2 0 s 2 0 s 0 1 f e m 1 s 2 1 s 2 1 s 0 1 h g we deduce from s 2 m 0 d s 2 m 1 d s 2 s 2 1 that d ds 2 m 0 s 2 m 0 s 2 1 1 f e h g 1 1 hence d ds 2 e g h 1 fg 1 eg 74 therefore the condition of stability eq 73 is equivalent to d ds 2 0 hence we have proved that ss 2 is stable if and only if 2 s 2 d and d ds 2 0 ut proof proposition 2 evaluated at ss 3 the matrix j 1 is j 1 e f x 0 fx 0 fx 0 g h x 1 g h x 1 hx 1 ix 2 ix 2 ix 2 the characteristic polynomial is given by 3 f 2 2 f 1 f 0 0 75 where f 2 ix 2 g h x 1 e f x 0 76 f 1 x 0 x 1 eix 0 x 2 gix 1 x 2 77 f 0 egix 0 x 1 x 2 78 and e g h 1 fg to satisfy the routh hurwitz criteria we require fi 0 for i 0 1 2 and f 1 f 2 f 0 0 notice that f 1 f 2 f 0 eix 0 x 2 x 0 x 1 f 2 ix 2 g h x 1 fx 0 gix 1 x 2 79 we always have f 0 0 and f 2 0 from eq 74 we deduce that 1 eg d ds 2 there fore if f 3 d 0 that is to say d ds 2 0 then 0 hence f 1 0 and f 1 f 2 f 0 0 so that ss 3 is stable on the other hand if d ds 2 0 and x 2 is very small which occurs when ss 3 is very close to ss 2 then f 2 has the sign of since the term with x 2 is negligible compared to the term x 0 x 1 f 2 x 0 x 1 eix 0 xgix 1 x 2 0 thus ss 3 is unstable ut proof proposition 3 since we always have f 0 0 and f 2 0 from the previous proof it follows that ss 3 is stable if and only if f 1 f 2 f 0 0 indeed this condition implies that we have also f 1 f 0 f 2 0 using eq 49 and eq 79 we see that f 1 f 2 f 0 f 4 d sin 0 therefore the condition f 1 f 2 f 0 0 is equivalent to f 4 d sin 0 0 ut d 3 operating diagrams proof proposition 4 we know that ss 1 always exist and is stable we know that ss 2 is unstable if it exists using table 7 and remark 2 we obtain the following results j 1 is defined by d d 1 or 0 d d 1 and sch in f 1 d y 3 y 4 therefore ss 1 is the only existing steady state in this region j 2 if defined by d 3 d d 1 and f 1 d y 3 y 4 sch in f 2 d y 3 y 4 therefore both steady state ss 2 exist and ss 2 is stable since f 3 d 0 j 3 if defined by 0 d d 2 and f 2 d y 3 y 4 sch in and f 4 d sch in y 3 y 4 0 when 0 d d 3 therefore ss 3 exists and is stable both steady state ss 2 exist and ss 2 is unstable since f 3 d 0 j 4 if defined by 0 d d 3 and f 1 d y 3 y 4 sch in f 2 d y 3 y 4 therefore both steady state ss 2 exist and ss 2 is unstable since f 3 d 0 j 5 if defined by 0 d d 3 f 2 d y 3 y 4 sch in and f 4 d sch in y 3 y 4 0 therefore ss 3 exists and is un stable and both steady state ss 2 exist and ss 2 is unsta ble since f 3 d 0 ut proof propositions 5 6 and 7 the result follows from table 7 and remark 2 the details are as in the proof of proposition 5 ut d 4 general case proof lemma 4 let s 2 0 be fixed by h 4 the function s 0 0 7 0 s 0 s 2 0 0 s 2 is monotonically increasing hence it has an inverse function denoted by y 0 0 s 2 7 m 0 y s 2 0 generalised approach to modelling a three tiered microbial food web 17 such that for all s 0 0 s 2 0 and y 0 0 s 2 55 holds ut proof lemma 5 let s 2 0 be fixed by h 5 the function s 1 0 7 1 s 1 s 2 0 1 s 2 is monotonically increasing hence it has an inverse function denoted by y 0 1 s 2 7 m 1 y s 2 0 such that for all s 1 0 s 2 0 and y 0 0 1 s 2 56 holds ut proof lemma 6 by h 6 the function s 2 0 7 2 s 2 0 2 is monotonically increasing hence it has an inverse function denoted by y 0 2 7 m 2 y 0 such that for all s 2 0 and y 0 2 57 holds ut proof lemma 7 by h 7 for d a 0 0 and d a 1 1 0 there exist unique values s 02 and s 1 2 such that eq 58 holds see fig 1 a ut references 1 m henze c p l j grady w gujer g v r marais t matsuo activated sludge model no 1 tech rep 1 awprc scientific and technical reports london uk 1987 2 m henze w gujer t mino t matsuo m c wentzel g v r marais m c van loosdrecht activated sludge model no 2 d asm 2 d wat sci technol 39 1 1999 165 182 doi 10 1016 s 0273 1223 98 00829 4 3 d j batstone j keller i angelidaki s v kalyuzh nyi s g pavlostathis a rozzi w t m sanders h siegrist v a vavilin anaerobic digestion model no 1 tech rep report no 13 iwa publishing london uk 2002 4 u jeppsson j alex d j batstone l benedetti j co mas j b copp l corominas x flores alsina k v gernaey i nopens m n pons i rodr guez roda c rosen j p steyer p a vanrolleghem e i p volcke d vrecko benchmark simulation models quo vadis wat sci technol 68 1 2013 1 15 doi 10 2166 wst 2013 246 5 c garc a die guez o bernard e roca reducing the anaerobic digestion model no 1 for its application to an industrial wastewater treatment plant treating winery effluent wastewater biores technol 132 2013 244 253 doi 10 1016 j biortech 2012 12 166 6 a bornho ft r hanke rauschenbach k sundmacher steady state analysis of the anaerobic digestion model no 1 adm 1 nonlinear dynam 73 1 2 2013 535 549 doi 10 1007 s 110710130807 x 7 m weedermann g s k wolkowicz j sasara op timal biogas production in a model for anaerobic di gestion nonlinear dynam 81 2015 1097 1112 doi 10 1007 s 11071 015 2051 z 8 a xu j dolfing t p curtis g montague e martin maintenance affects the stability of a two tiered microbial food chain j theor biol 276 1 2011 35 41 doi 10 1016 j jtbi 2011 01 026 9 t sari j harmand maintenance does not affect the stability of a two tiered microbial food chain hal id hal 01026149 version 1 math ds july 2014 10 m j wade r w pattinson n g parker j dolf ing emergent behaviour in a chlorophenol mineralising three tiered microbial food web arxiv 1503 01580 q bio pe march 2015 http dx doi org 10 1016 s 0273 1223 98 00829 4 http dx doi org 10 2166 wst 2013 246 http dx doi org 10 2166 wst 2013 246 http dx doi org 10 1016 j biortech 2012 12 166 http dx doi org 10 1007 s 110710130807 x http dx doi org 10 1007 s 11071 015 2051 z http dx doi org 10 1007 s 11071 015 2051 z http dx doi org 10 1016 j jtbi 2011 01 026 http dx doi org 10 1016 j jtbi 2011 01 026 1 introduction 2 the model 3 model reduction 4 existence of steady states 5 local stability without maintenance 6 numerical analysis to confirm and extend the analytical results 7 the role of kinetic parameters 8 conclusions a numerical methods b proof for hopf bifurcation c general case d proofs