rhombic tilings and primordia fronts of phyllotaxis pau atela and christophe gole department of mathematics smith college abstract we introduce and study properties of phyllotactic and rhombic tilings on the cylin der these are discrete sets of points that generalize cylindrical lattices rhombic tilings appear as periodic orbits of a discrete dynamical system s that models plant pattern formation by stacking disks of equal radius on the cylinder this system has the advantage of allowing several disks at the same level and thus multi jugate config urations we provide partial results toward proving that the attractor for s is entirely composed of rhombic tilings and is a strongly normally attracting branched manifold and conjecture that this attractor persists topologically in nearby systems a key tool in understanding the geometry of tilings and the dynamics of s is the concept of pri mordia front which is a closed ring of tangent disks around the cylinder we show how fronts determine the dynamics including transitions of parastichy numbers and might explain the fibonacci number of petals often encountered in compositae 1 introduction phyllotaxis is the study of arrangements of plant organs these originate at the growing tip apex meristem of a plant as protuberances of cells called primordia the geomet ric classification of phyllotactic patterns has often been reduced to that of cylindrical lattices where the helices joining nearest primordia called parastichies form two families winding in opposite directions counting parastichies in each family gives rise to the pair of parastichy numbers that are used to classify phyllotactic patterns the striking phenomenon central to phyllotaxis is the predominance of pairs of successive fibonacci numbers as parastichy numbers however fibonacci patterns and transitions among these are not the only ones observed in nature a very common transition can be seen on stems of sunflowers for instance after a few pairs of aligned leaves alternating at a 90 o angle leaves suddenly grow in spirals yielding fibonacci numbers in terms of parastichy numbers classifi cation the pattern with parastichy numbers 2 2 decussate transitions to 2 3 this transition is usually absent from the analysis of dynamical models of phyllotaxis even when they can reproduce it more generally transitions to and from multijugate phyllotaxis where parastichy numbers have a common divisor k and where k organs appear at the same level whorl is not often discussed 7 parts ii iii being a 1 ar x iv 1 70 1 01 36 1 v 1 q bi o t o 4 j an 2 01 7 1 2 3 45 6 7 8910 11 12 131415 16 171 8 1920 21 22 2324 25 26 2728 2930 31 32 33 3435 36 37 38 39 4 041 4243 4445 46 474849 50 51 5 2 5354 55 56 57 5859 60 61 62 63 6465 66 67 686970 7172 7 3 7475 7677 78 79 80 81 8283 84 85 86 8788 golden angle cc 12 34 56 7 8 910 1112 1314 15 16 1718 1920 2122 23 24 25 26 2728 2930 31 32 33 34 3536 3738 3940 41 42 4344 4546 4748 49 50 5152 5354 5556 57 58 59 60 6162 6364 65 66 67 68 6970 7172 3 74 75 76 7778 7980 8182 83 84 8586 8788 golden angle bbaa c birch catkin original data lattice fit rhombic tiling fit 14 better lattice fit rescaled vertically rhombic tiling fit rescaled vertically figure 1 each picture represents the unrolled surface of a cylinder a the imprint of a birch catkin rolled on clay after a vertical compression counterbalancing anisotropic growth we used a method of least squares with nonlinear constraints to fit lattices and rhombic tilings to this pattern the results of this process are seen in the lattice in b the tiling in c note that there are 5 blue segments and 8 green in the fronts represented at the bottom of the pattern they form the front parastichy numbers and coincide with the number of parastichies of both figures one can think of the tiling as a deformation of the lattice obtained by rotating the segments of the front of the lattice the tiling offers an improvement of the fit of more than 14 percent over the lattice and it also accounts for the undulations of the parastichies note that even though the parastichies are well defined in the rhombic tiling the divergence angle between successive primordia numbered according to height and thus presumably according to age is widely erratic although periodic see for instance the differences of horizontal spacing between primordia pairs 42 43 and 43 44 notable exception part of the difficulty lied in the absence in the literature of a con tinuum of patterns encompassing lattices of all jugacies and of more local geometric tools to follow the transitions as they unfold one primordium at a time we introduce the geometric concept of phyllotactic and rhombic tilings which do encompass lattices of all jugacies as well as patterns hitherto considered as transient these tilings can be seen as deformations of cylindrical lattices in contrast with lattices they can account for the marked undulations of parastichies often observed in nature fig 1 we also reintroduce van iterson s century old concept of zickzacklinie 25 that we call here primordia fronts fig 1 these zig zaging fronts and their parastichy numbers offer a practical and theoretical tool to understand not only the steady state tilings but also transitions from one to another in a way that may be less confusing than the divergence angles often used in experiments see e g section 2 2 the concept of primordia front might also offer an explanation as to the statistical predominance of fibonacci numbers of ray petals in many asteracea 5 the number of primordia in a front is the sum of its fibonacci likely parastichy numbers hence itself a likely fibonacci number 2 we root the concepts of tilings and fronts within a simple discrete dynamical model that more or less explicitly exists since the 19 th century 27 25 26 6 this system that we call the snow map after 7 and denote by s represents primordia formation as the stacking of disks on a cylinder according to the simple rules the new disk appears at the lowest level above the older ones without overlap as we fix the circumference of the cylinder the diameter d of the of the primordia is the fundamental parameter of this model theorem 4 brings together the geometry and dynamics of this paper by showing that for each parastichy number pair m n and for d in an appropriate range there exists a manifold of rhombic tilings each of which is a periodic orbit of period mn for s this manifold is of dimension m n and contains the m n lattice of the fixed point bifurcation diagram for that d see section 6 2 we also show that this manifold is a local attractor for s and that the attraction occurs in finite time we conjecture that the entire set of dynamically sustainable rhombic tilings forms a normally attracting set this should imply the persistence of an invariant set with comparable topology in nearby models 8 and would confer the snow model and rhombic tilings some universality in phyllotaxis although we do not study phyllotactic transitions in great detail here see sections 2 2 and 6 1 we hope that this paper will serve as foundation for further research in that direction later work will explore the topological structure of the set of dynamically sustainable tilings and of the dynamical transitions it allows as well as generalizations of these tilings to other geometries experimental applications of some of the concepts discussed here such as using fronts derived from plant data as initial conditions for growth modeling using a similar model appeared in 13 recent experimental and modeling work points to the active transport of the hor mone auxin 20 4 14 23 as the underlying mechanism of primordia formation although some authors still advocate for a buckling explanation 22 although the type of models based on auxin transport should eventually prove invaluable in testing the validity of proposed biological mechanisms to date they can t easily and stably reproduce fibonacci phyllotaxis and neither could they form the proper context for a geometrical explanation of its prominence our approach is grounded in the tradition of dynamical geometric models 27 25 26 1 7 6 15 18 2 often based on the botanical observations of hofmeister 11 and snow snow 24 the model we study is also compatible with the general assumptions of 20 and 22 our goal is to distill to their simplest and most rigorous form the geometric mechanisms that could be at play in phyllotactic pattern formation the concepts we develop are general enough that they may adapt to other situations such as the assembly of the hiv 1 ca protein 16 to motivate this otherwise rather theoretical paper we start in section 2 by report ing on some numerical experiments showing how phenomena encountered by iterating s on a computer naturally lead to rhombic tilings and primordia fronts we then re view the classical geometry of the cylindrical lattices and of their parastichies section 3 in section 4 1 we establish the notion for general configurations of primordia of chains and fronts of primordia as sets of tangent primordia encircling the meristem the parastichy numbers of chains and fronts are just the number of up and down segments as one travels around the chain the definition of phyllotactic and rhombic 3 tiling as cyclic sums of up and down vectors follows in section 4 2 followed by the analysis of their periodicity and properties of parastichies in section 4 5 we show the equality of parastichy numbers of a tiling and of any of its fronts thus validating the usage of the front parastichy numbers we then give a rigorous definition of the snow map s followed by a study of its domain of differentiability section 5 section 6 brings the dynamics of s and the geometry of fronts and tilings together in section 6 1 we show that the top primordia front of a configuration determines its dynamical future and that changes in parastichy numbers can be simply read from the number of sides of the polygonal tile between a new primordium and the top front we show that the fixed points of the map s in duced on the shape space of configurations are the same rhombic cylindrical lattices as in the hofmeister map of 2 and conjecture that periodic orbits all form rhombic tilings section 6 2 in section 6 4 we prove theorem 4 on the existence of attracting sets of rhombic tilings mentioned above returning to experimental results section 7 shows numerically how tilings whose parastichy numbers sum up to 4 coexist in the shape space of chains of four primordia we show that the latter set for the chosen parameter has the topology of the projective plane 2 numerical explorations before formally studying the concepts of rhombic tilings primordia front and their relation to the dynamics of the snow map s we present some numerical observations that motivated our theoretical inquiry 2 1 asymptotic behavior of s in our numerical simulations we consistently observed that under iterations of s all configurations converge to of fat rhombic tilings lattice like sets of points of the cylinder that are vertices of tilings with rhombic tiles that are not too thin see section 4 2 the tilings have like the classical lattices of phyllotaxis parastichies strings of tangent primordia winding up and down the cylinder in somewhat irregular helices and as with lattices these parastichies come in two families winding in opposite directions fig 2 interestingly we observed two distinct types of convergence to rhombic tilings a finite time convergence and an asymptotic infinite time convergence in our exper iments asymptotic convergence always involves at least one pair of pentagonal and triangular tiles repeating along a parastichy fig 2 one can see from the figure see proposition 4 6 for a proof that when an orbit goes through segments of a given rhombic tiling of parastichy numbers m n its shape repeats periodically with period mn hence orbits that we have observed are either periodic in the shape space preperiodic or asymptotically periodic with triangle and pentagon pairs moreover we observed large continua of tiling segments that are periodic orbits in theorem 4 we prove the existence of such continua and of the preperiodicity of all orbits near steady state lattices we will leave the analysis of the asymptotic convergence to a later work 4 4039 38 3736 35 34 33 32 31 30 29 28 2726 2524 2322 21 20 19 18 1716 15 1413 1211 109 8 7 6 5 43 21 a b figure 2 a rhombic tiling of parastichy numbers 5 3 obtained by iterating the transformation s on a front of parastichy numbers 5 3 the older the primordium the greater its index three fronts at primordia 1 16 and 31 are shown with their up vectors in thick black down vectors in thick white a period vector shown in dark grey joins primordia k and k 15 and translates a front into another periodically with 5 3 primordia in between this is an orbit of period 15 see theorem 1 and proposition 4 6 b asymptotically periodic orbit with pairs of triangles and shrinking pentagons aligned in a parastichy it is intuitively clear that at a given time step of the iteration the top connected layer of primordia holds the key to the dynamics and the geometry of the orbits we call such a layer a primordia front section 4 1 the number of up and down vectors forming the zigzagging curve as one travels from left to right on a front corresponds to parastichy numbers in the case of lattices and tilings proposition 4 5 we call them front parastichy numbers section 4 1 we contend that counting front parastichy numbers at each step of the iteration which can be programmed in either simulations or data analysis may be less misleading than the divergence angles commonly used in this type of experiment see figures 1 and 3 and the next section 2 2 the fibonacci path the litmus test for a model of phyllotaxis is its ability to reproduce aspects of the bifurcation diagram or fixed point set of section 6 2 and especially of its fibonacci branch this diagram is formed by the generators see section 3 of the good lattices of phyllotaxis that are steady states of the given model in this case presented of both s and the hofmeister map of 2 each dark curve segment of the diagram corre 5 0 50 100 150 200 250 300 0 5 10 15 c 170 274 50 100 150 200 250 300 50 100 150 200 250 300 137 51 170 274 a up parastichy number down parastichy number d 170 274 0 20 40 60 80 100 120 140 125 130 135 140 145 137 51 b figure 3 a divergence angle vs number of iterates of s the initial condition is the 2 1 steady state lattice for the parameter d 2083 diameter of primordia d is decreased by 1 at each iterate until iterate 170 after which it is kept constant note how close to the golden angle 137 510 the divergence angle is until iterate 140 and how wildly it oscillates after that a periodicity of 104 8 13 can be observed after iterate 170 b a section from a blown up to show the oscillation of the divergence angle that mirrors up to some small amplitude secondary oscillation the zigzagging of the fibonacci branch of the bifurcation diagram of fig 8 c the front parastichy numbers vs iterate numbers note the extreme regularity of this data contrasting with the oscillations of the divergence angle d the 13 8 dynamical tiling obtained after iterate 170 when d is kept constant the mild nature like undulations of its parastichies contrast with the irregularities of its divergence angles seen in a sponds to lattices with a given pair of parastichy numbers whose shapes are fixed under s the x coordinate of a generator corresponds to the so called divergence angle be tween two consecutive points in the vertical ordering of the lattice it also corresponds to the difference of x coordinate of the new primordium and the next in an iteration process the divergence angle and its connection to parastichy numbers in lattices has been widely used to explain and detect in models the fibonacci phenomenon 7 the fibonacci branch of the bifurcation diagram is the largest in the diagram and starts at lattices of parastichy numbers 1 1 corresponding to the beginning of the growth of most monocotyledonous plants in our work on the hofmeister map 2 we showed that the steady state lattices are attractors accounting for the fact that once near the fibonacci branch a configuration remains near it as the parameter in that case the internodal distance was decreased we were originally pessimistic about s yielding fibonacci transitions as the param eter varies indeed we had observed numerically that a steady state lattice for s is part of an attracting manifold of periodic orbits and the eigenvalues of the differential are either 0 or on the unit circle a consequence of theorem 4 hence the steady states for s can at best be neutrally stable however our experiments fig 3 a b show that as we lower the diameter of the primordia while iterating s the fibonacci phenomenon as measured by front parastichy numbers is in fact much more robust in our s model than the divergence angle measurements indicates while the divergence angle can vary wildly even in an orbit close to a lattice the parastichy numbers stay 6 constant orbits do not have to stay too close to lattices to follow the fibonacci route it is sufficient that they stay in a neighborhood the substantially larger and attracting set of rhombic tilings this flexibility allows for much faster transitions than previously thought in a time scale observed in plants as we will show in future work last but not least the strong attraction of s orbits to the set of rhombic tilings should make this set persist topologically in nearby systems 3 classical geometry of phyllotaxis 3 1 underlying geometry in this paper we concentrate on cylindrical phyllotaxis we normalize the cylinder c to have circumference 1 mathematically c is the cartesian product s 1 r of the unit circle s 1 r z with the reals note that fixing the circumference of the cylinder does not mean that we preclude lateral plant growth in our modeling we make this convenient normalization choice without loss of generality since in the patterns we study the important parameters such as the ratio d of the size of primordia relative to the diameter of the meristem are independent of scale both botanists and mathematicians often unroll cylindrical patterns on the plane r 2 which can also be seen as the complex plane c this is the covering space of the cylinder see section 3 2 we will use the same notation for points and vectors in r 2 and c by a configuration we mean a finite set of points in c ordered by height these points represent centers of primordia along the stem 3 2 covering space notions and notation we often describe objects in the cylinder via their covers and lifts in the plane the intuitive notion of cover of a set in the case of the cylinder is simple mark each point of the set with ink and use the cylinder as a rolling press as you roll the cylinder indefinitely on the plane the points printed form the cover of the original set each piece of the cylindrical pattern is repeated at integer intervals along the x direction the cover of a helix for example is a collection of parallel lines the lift of a helix at a point is the choice of one of these lines here is a more rigorous description of these classical concepts 19 and notation that we will be using the natural projection r 2 7 c which maps a point x y to x mod 1 y is a covering map and the plane r 2 is a covering space of the cylinder c this means that is surjective and that around any point z of c there exists an open neighborhood u such that 1 u the inverse image of u is a disjoint union uk of open sets of the plane each homeomorphic to u one says that is a local homeomorphism and that u is evenly covered in the case of the cylinder is also a local isometry for the metric induced by on the cylinder a subset x of r 2 is a fundamental domain if x 7 c is a bijection any region of r 2 of the form x y r 2 a x a 1 is a fundamental domain the cover of a subset y of c is the inverse image y 1 y of y a set y of the plane is a cover of its projection y if and only if y 1 0 y the tilde notation as above is often used to denote covering spaces in this paper we also use 7 the underline notation to denote the projection of a set in the plane to the cylinder x x as with all covering maps has the lifting property if is a path in c and c r 2 is a point lying over 0 i e c 0 then there exists a unique path r 2 lying over i e and with 0 c the curve is called the lift of at c the lift of a path is only a connected part of its cover for instance the lift at 3 0 of the line of equation x 0 of the cylinder is the line x 3 in the plane whereas its cover is the union of all the lines x k k z 3 3 cylindrical lattices helical lattices multijugate config urations a cylindrical lattice l is a set of points in c whose cover l is a lattice of r 2 l m v n w r 2 m n z where v w r 2 are independent generating vectors note that l a discrete subgroup of r 2 isomorphic to z 2 since l is a cover it must be invariant under translation by 1 0 changing bases if necessary one can assume that w 1 k 0 for some positive integer k called the jugacy of the lattice if k 1 we say that l is monojugate or that it is a helical lattice in this case w 1 0 0 0 mod 1 and l has the unique generator v if k 1 l is called a multijugate configuration or specifically a k jugate configuration or k jugate lattice a cylindrical lattice l is a discrete subgroup of c s 1 r isomorphic to z z kz simply z in the case of a helical lattice in a k jugate lattice each point is part of a set of k points called a whorl evenly spread around a horizontal circumference of c parastichies of a helical lattice l are helixes joining each point of l to its nearest neighbors we now make this more precise in general there are two points of l nearest to 0 in the positive half plane say zm m v m 0 and zn n v n 0 nearest to 0 where m n m n z also assume that 0 zm makes a larger angle with the horizontal than 0 zn so in particular 0 zm and 0 zn are not colinear the line through 0 and zm lifts a helix in c that contains all the points kzm km v k z the set of these points is called a parastichy and the helix connecting them a connected parastichy there are m helixes also called parastichies parallel to this one each goes through a set of points kzm jzn k z for a fixed j 0 m 1 to prove this one shows that when j m one obtains another lift of the original parastichy using n m m n 1 1 this is a consequence of zm zn being closest to 0 2 proposition 4 2 and it implies that m and n are co prime gcd m n 1 thus there are m parastichies and they correspond to a cosets of the subgroup mz of z likewise there are n parallel parastichies joining the second closest neighbors if l is a k jugate lattice we can trace parastichies through nearest neighbors in a similar fashion this time the parastichy numbers m and n must have the common divisor k an intuitive way to see this is that rescaling the cover l of l by k one 8 wv b w vvc 6 5 4 3 2 1 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 v a figure 4 cylindrical lattices each represented in a fundamental domain of their cover with 1 2 x 1 2 all these lattices are rhombic each primordium is equidistant to its 4 nearest neighbors a 3 5 helical lattice with only one generator v we only show the indices k of the points zk note how z 3 and z 5 are the closest to z 0 we have shaded the parastichies through z 3 and z 5 there are 5 parastichies parallel to that through z 5 and 3 parallel to that through z 3 b 2 jugate bijugate 6 10 lattice obtained by rescaling two copies of the one in a by 1 2 and setting them side by side on the cylinder this lattice has two generators v which is half the vector v of a and the vector w 1 2 0 each primordium is in a whorl of 2 separated by w c 4 4 lattice 4 jugate with two generators v as shown and w 1 4 0 each primordium is in a whorl of 4 obtains the cover of a helical lattice call it lh build the parastichies through nearest neighbors for lh as before then rescale back by 1 k the rescaled parastichies are parastichies of l since you need k copies of the rescaled lh to go around the cylinder you need k rescaled copies of each parastichy of lh crossing the x axis at intervals of 1 k to get all the parastichies of l thus all cylindrical lattices can be classified by their parastichy numbers m n k i j where k is the number of primordia in a whorl helical lattices are the special case where k 1 whorled configurations where primordia in a new whorl are placed midway between those of the previous whorl is another notable case which corresponds to k 1 1 3 4 limitations of cylindrical lattices in phyllotaxis in section 2 2 we presented a numerical simulation showing fibonacci transitions along orbits of s when the parameter d is decreased we argued briefly that the dynamical transitions observed mirrored the continuous geometric deformation of helical lattices along the main fibonacci branch of the bifurcation diagram the existence of the con nected fibonacci branch has been the basis of many explanations of the phenomenon since the 19 th century 1 27 25 unfortunately this kind of argument made rig orous for the hofmeister model in 2 cannot work for transitions involving a change of jugacy in the pattern one of these transitions from 2 1 1 decussate to 2 3 1 this neat geometric fact has often been a source of confusion between the global deformation of a pattern and its transitions via a dynamical process with varying parameter 9 fibonacci spiral is the norm in the vast majority of dycotyledonous plants such as the sunflower where after a few whorls of two leaves at 90 o angle symmetry is broken and a spiral pattern emerges this transition cannot be attributed to the proximity of iterated patterns to a continuous path within the set of lattices between lattices of parastichy numbers 2 2 and 2 3 indeed no such continuous path exists since it would have to involve the continuous deformation of the vector w 1 2 0 into 1 0 within the discrete set of rational vectors of the form 1 k 0 which is clearly absurd even in a fibonacci transition the global geometric deformation of lattices or thostichies becoming parastichies when d decreases does not translate easily into a dynamical understanding of the transitional region in short we need more flexible and local geometrical tools to better describe dynamical transitions 4 new geometry for phyllotaxis in this section we introduce primordia fronts and phyllotactic tilings they address the limitations noted in the previous paragraph fronts are local in nature and are well defined in the setting of general configurations of points of the cylinder we will show that fronts are key in understanding transitions phyllotactic tilings and more specifically rhombic tilings allow many more deformations than cylindrical lattices while still featuring parastichies we give an algebraic definition of these tilings as a set of points obtained by cyclically adding up and down vectors in later sections we derive the geometric and periodicity properties of these tilings and of the tiles they bound 4 1 parents ontogenetic graphs fronts local parastichy num bers this subsection gives definitions regarding very general configurations of points of the cylinder they can naturally be adapted to other geometries cone or disk as well see 13 we consider general configurations of a number k of disks of a given diameter d in the cylinder these configurations are given by their centers p 1 pk and they form the set ck cartesian product of k copies of the cylinder occasionally we need to consider countably infinite configurations as well the ontogenetic order for a configuration in ck is a choice of indices 1 k for the points which corresponds to the following order of the points coordinates i j y pi y pj or y pi y pj and x pi x pj where we choose the fundamental domain x 1 2 1 2 often such as with lattices we consider finite configurations that are pieces of infi nite ones a configuration p ck comprising all the points of an infinite configuration x between some pi and pi k in the ontogenetic order of x is called a segment of x of length k a primordium pj is a left resp right parent of pi if it is tangent below and to the left resp right of pi more precisely we adopt the convention that for pj to be left parent of pi the coordinates x y of the vector pipj must satisfy 1 x 0 y 0 10 and x 2 y 2 d 2 and 1 x 0 y 0 x 2 y 2 d 2 for pj to be right parent of pi in the obvious fashion pi is a right resp left child of pj if pj is a left resp right parent of pi the ontogenetic graph of a primordia configuration is the directed graph embedded in c whose vertices are the centers of the primordia and where oriented edges are drawn between primordia and their parents if they have any given an ontogenetically ordered configuration p of ck we call parents data the information about which primordia are parents of which primordia one way to rep resent this data is by a k k parents data matrix whose i j th entry is 1 if pj is left parent of pi 1 if pj is right parent of pi and 0 if pi is not a parent of pj note that the absolute value of this matrix is just the adjacency matrix of the directed ontogenetic graph a primordia chain for a configuration is a subset pi 1 piq of distinct points in the configuration such that the chain is connected by tangencies for all k 1 q primordium pik 1 is either a right parent or right child of pik a chain can thus be represented by a piecewise linear curve through the centers of its primordia which can be lifted to r 2 the chain is closed and does not fold over itself the point piq is either a left parent or left child of pi 1 and any lift at a point p with p pi 1 of the chain is the graph of a piecewise linear function over the x axis in r 2 joining p to its translate p 1 0 the vector pikpik 1 is an up vector of the chain if pik 1 is a right child of pik the vector pikpik 1 is a down vector if pik 1 is a right parent of pik we call the number of up resp down vectors in a chain its right resp left parastichy number if pik 1 is always parent of pik for k 1 m 1 and then always a child for i m q we call the chain a necklace given a configuration ordered ontogenetically a front at k is a chain with primordia of indices greater or equal to k such that any primordium not necessarily in the configuration which is the child of a primordium in the chain without overlapping any other primordium in the chain is necessarily at a height greater or equal to that of pk the parastichy numbers of a front are called front parastichy numbers remark 4 1 most of the notions defined above are applicable to plant data by relax ing the definition of left resp right parent to that of closest primordia below to the left resp to the right with some tolerance level in the case of configurations on the disk below translates to farther away from the meristem see 13 algorithms using these notions were also used to produce fig 1 and 4 2 phyllotactic tilings a phyllotactic tiling is a set of points of c that can be obtained by summing to a base point cyclically ordered sums of up and down vectors more precisely a tiling t is determined by a base point a b r 2 down vectors d 1 dm r 2 where each dk 11 has components x 0 y 0 and up vectors u 1 un r 2 each with components x 0 y 0 moreover we ask that m j 1 dj n i 1 ui 1 0 2 we then define t zm n c m n z where zm n zm n with zm n a b sumdown m sumup n and where sumdown m m j 1 dj if m 0 0 if m 0 m 1 j 0 dm j if m 0 3 and we use the periodicity convention dj m dj j z the function sumup n is a cyclical sum of up vectors defined similarly with the convention that ui n ui i z the numbers m n of down and up vectors are called the parastichy numbers of the tiling a terminology justified by proposition 4 4 the phyllotactic tiling t is rhombic if all the up and down vectors have same length d and we call d the length of the tiling a fat tiling is a phyllotactic tiling such that the angles between any two down and up vectors are in the interval 3 2 3 it is not hard to see that the ontogenetic graph of a rhombic tiling is the embedded graph in the cylinder whose vertices are the points of the tiling and the edges are the down and negative up vectors connecting them for general phyllotactic tiling we call this graph the graph of the tiling we call the connected components of the complement of the graph its tiles remark 4 2 the following are simple but important consequences of the previous definitions equation 2 implies that the set t zm n r 2 m n z is indeed the cover of the tiling t if z t so does z 1 0 equation 2 also implies that zm km n kn zm n for all n m k z it also implies that the down vectors stringed together followed by the up vectors form a necklace which clearly has parastichy numbers n m if all the down vectors dj d are equal are equal and if up vectors ui u are equal and if the tiling parastichy numbers m n are coprime the tiling is in fact a lattice of parastichy numbers m n generated by d and u if the tiling is fat d zm and u zn in the notation of section 3 3 if m n are not coprime the tiling is a multijugate configuration the condition of fatness implies that a rhombic tiling can be seen as a config uration of tangent disks with no overlap 12 d 1 d 3 d 2 d 3 d 1 d 2 d 3 u 1 u 2 u 3 u 5 u 4 u 4 u 5 u 2 u 3 u 1 z 1 2 z 0 0 z 0 1 z 0 2 z 1 2 z 1 1 z 1 1 z 2 2 z 1 3 z 1 4 z 1 5 z 0 3 z 0 4 z 0 5 z 0 6 z 1 3 z 1 4 z 1 5 z 1 6 z 2 3 z 2 4 z 2 5 z 2 3 z 2 4 z 3 2 a b z 2 7 z 2 6 z 2 5 z 4 3 z 3 7 z 3 6 z 3 5 z 3 4 z 3 3 z 2 1 z 3 1 z 2 0 z 4 4 z 4 5 z 5 3 z 3 4 figure 5 a fat rhombic tiling of parastichy numbers m 3 n 5 on the left the up and down vectors are shown on a front and on a necklace translating the tiling from one star to another does not change it if a pair of down and up vectors meet at a point they meet again at the other extremity of the necklace they both belong to inducing periodicity in the tiling theorem 1 on the right the z 2 like numbering of primordia of the same tiling the equation zm km n kn zm n is shown at primordia z 1 5 and z 0 6 note that parastichies are obtained by keeping all the points that have same down resp up index given a certain type of subsets of the cylinder we say that two subsets have the same shape if one is a translation of the other we call the set of all distinct classes of shapes the shape space proposition 4 1 when m n d 1 the set rt m n d of opposed rhombic tilings of parastichy numbers m n with vectors of length d is a manifold of dimension m n possibly with boundaries and corners every strictly fat lattice is contained in an open neighborhood of such a manifold the set of fat rhombic tilings is a submanifold with possibly more boundaries and corners of rt m n d the set rt m n d k of segments of length k m n of tilings in rt m n d is homeomorphic to rt m n d when considering the shape spaces of these respective types of objects subtract 2 to the dimension of each set above proof we parameterize rt m n d by the two independent variables for the base point a b and m n 2 angles with the horizontal of m 1 down and n 1 up vectors the last down and up vectors are given by the two sides of an isosceles triangle of equal sides of length d between the points 1 0 and m 1 j 1 dj n 1 i 1 ui boundaries are determined by the inequalities 2 j 0 on the angles of down vectors j 1 n 1 and 0 j 2 j 1 m 1 for the angles of 13 up vectors as well as some more complicated inequalities that we won t make explicit here involving differentiable functions of these m n 2 angles that guarantee that the last up and last down vectors can be defined and satisfy the above inequalities as well the statement on lattices derives from the fact that for a strictly fat lattice the inequalities on angles stated above are all strict the condition of fatness only adds further inequalities on the angles j i the set of segments of tilings of sufficient length is parameterized by the same angles with the same inequalities as the set of itself and thus these sets are homeomorphic when considering the shape spaces the base point is removed from the parameterization lowering the dimension by 2 4 3 periodicity of phyllotactic tilings we say that an infinite configuration of points x in c or r 2 has period vector v if x v x theorem 1 periodicity of tilings the cover t of a phyllotactic tiling t with down and up vectors and d 1 dm and u 1 un has the two independent period vectors d m j 1 dj and u n i 1 ui since in c these two vectors sum to 0 t has only one independent period vector say u proof pick a point zm n t we will do the case m n 0 the other cases derive from this one and the equality zm km n kn zm n k 0 from uj n uj we obtain zm n u a b m i 1 di n j 1 uj n j 1 uj a b m i 1 di n n j 1 uj zm n n t likewise we obtain zm n d zm m n t this proves that t u t and t d t inclusions in the other direction are proven identically by subtracting the vectors u d to points of t and showing that one obtains points of t the statement about the periodicity of t already contains its proof the periodicity above can be expressed by saying that phyllotactic tilings are multi lattices a multilattice of c or r 2 is the union of a number k of copies of the same lattice l each translated by a different vector vi k i 1 vi l note that the generating vector s of the lattice l is are period vector s of the multilattice to see that a phyllotactic tiling is indeed a multilattice let l be the cylindrical lattice generated by u n k 1 uk and let the v is be vectors of the form m i 1 di n j 1 uj m 1 m n 1 n this interpretation of tilings as 14 multilattices explains the appearance of parallelogram shaped tiles of size m n that repeat periodically in a tiling 4 4 parastichies of phyllotactic tilings we call parastichies at a point zm n of a tiling in c the two subsets of the tiling ob tained by successively adding or subtracting all the up vectors starting with um 1 and following the cyclical order or all the down vectors starting at dn 1 and following the cyclical order we call these parastichies left and right parastichies respectively de noting their directions as they are traversed down from the point zm n a connected parastichy is the piecewise linear curve formed by joining the successive parastichy points with the up or down vectors that connect them we denote by lpm n and rpm n the lifts of the left and right connected parastichies through zm n hence lpm n is the piecewise linear curve through the points zm j j z and rpm n is the piece wise linear curve through the points zi n i z where two successive points are joined by an up resp down vector in the case that the tiling is a fat lattice or multijugate configuration the above def inition coincides with the classical definition of parastichy the regular helices joining nearest left resp nearest right neighbors in the case that the tiling is a fat lattice or multijugate configuration the above def inition coincides with the classical definition of parastichy the regular helices joining nearest left resp nearest right neighbors the following underlines the similarity between tilings and lattices and justifies the qualifier of rhombic given to some of the tilings we consider proposition 4 2 properties of lifted parastichies the lift of a connected left parastichy lpm j intersects the lift of a connected right parastichy rpi n at the unique point zm n the curves lpm n and lpi k intersect if and only if m i in which case they are equal rpm n and rpi k intersect if and only if n k in which case they are equal the tiles of the cover of a phyllotactic tiling are parallelograms whose vertices are of the form zm n zm 1 n zm n 1 zm 1 n 1 for some integer pair m n in the case of a rhombic tiling these tiles are rhombi proof the curves lpm j and rpi n contain zm n we show that they do not intersect in any other point if they crossed at another point of the tiling cover there would exist integers k l such that zm k zl n but this implies l j m 1 dj n i k 1 ui we ve assumed l m 0 n k 0 other cases are similar which is absurd in the plane since up and down vectors are in different quadrants the case where the parastichies cross at segments between tiling points would yield an equally absurd equality between a linear combination of up vectors and a combination of down vectors with real coefficients this time lemma 4 3 in the lift of a phyllotactic tiling each curve lpm n is homeomorphic to a line and separates r 2 into two unbounded regions homeomorphic to a half plane containing the respective subsets zi j i m j z and zi j i m j z of the tiling and similarly for rpm n 15 proof of the lemma lpm n is a periodic perturbation of the line ll t 7 zm n tu where u n i 1 ui whereas rpm n is a periodic perturbation of the line lr t 7 zm n t 1 0 u and thus lifts of connected parastichies have the same asymp totic directions as the corresponding lines ll lr since all up vectors are in the same quadrant the orthogonal projection on lr of lpm n is a homeomorphism which can be extended to an isotopy bijective continous deformation of the plane and similarly for the left parastichy we sketch the isotopy leaving the details to the reader draw lines perpendicular to lr through the parastichy points zm j j z the lines separate the plane into parallel strips apply a shear within each strip so that the vector zm jzm j 1 becomes parallel to lr translating the other strips so that the transformation is con tinuous the points zi k i m k z are all on one side of lpm n through zm n the right connected parastichy of each point zi k i m crosses lpm n at zm k and thus at no other point in particular the point zi k i m is on the same side of lpm n as zm 1 k since the determinants of the angles between the vectors dm zm 1 kzm k and the vector uk 1 zm kzm k 1 of lpm n are of the same sign for all k the points zm 1 k are all on the same side of lpm n thus zi k i m k z are all on one side of lpm n similar statements hold for right parastichies back to the main proof from the lemma we obtain that lpm n and lpi k intersect if and only if i m in which case they coincide moreover one left connected parastichy is a translate of another as it is easy to check that assuming m i lpm n lpi k m j i 1 ui similarly for right parastichies consider now the tiles adjacent to a point zm n since there are only four edges of the graph of the tiling adjacent to zm n there are at most four tiles adjacent to that point without loss of generality we only consider the tile sharing the edges zm 1 nzm n dm and zm n 1 zm n un we claim that this tile has exactly the vertices zm n zm 1 n zm n 1 and zm 1 n 1 these points form the vertices of a parallelogram or a rhombus if the tiling is rhombic with edges dm and un to check that this indeed forms a tile there remains to show that no other than these four tiling points is included in this parallelogram the parallelogram is in a quadrant formed by the parastichies lpmn and rpmn and containing the point zm 1 n 1 from lemma 4 3 any other point of the tiling contained in the parallelogram must be of the form zi j with i m j n but the parallelogram is also contained in the quadrant formed by the parastichies lpm 1 n 1 and rpm 1 n 1 and containing the point zm n which forces zi j to satisfy i m 1 j n 1 in other words the only points of the tiling that the parallelogram may contain are its already defined vertices proposition 4 4 properties of parastichies connected left parastichies lpm n and lp i k cross only if and only if i m mod m in which case they are equal thus there are m left parastichies likewise rpm n and rp i k cross if and only if k n mod n in which case they are equal and there are n right parastichies left and right parastichies lpm n and rp i k cross at the points zm qm k pn q p z interspaces of a phyllotactic tiling are parallelograms proof since their lifts do not intersect non trivially by proposition 4 2 left parastichies can only coincide or be disjoint lpm n has lifts lpm n q 1 0 lpm qm n qn q z by remark 4 2 likewise parastichy lp i k has lifts lpi pm k pn p z the two 16 parastichies coincide if and only if m qm i pm for some p q z i e if i m mod m there are thus m distinct parastichies the proof is identical for right parastichies parastichies lpm n and rp i k intersect at projections by of intersection points of two of their lifts lpm qm n qn q z and rpi pm k pn p z by proposition 4 2 these intersection points are zm qm k pn q p z a tile of the cover of a phyllotactic tiling is entirely in a fundamental domain and is thus isomorphic to its projection on the cylinder which must thus be a parallelogram and a tile all tiles arise this way 4 5 front vs tiling parastichy numbers the following proposition connects the three notions of parastichy numbers encountered so far the following proposition about chain parastichy numbers clearly applies to the special case of front parastichy numbers proposition 4 5 in a phyllotactic tiling with m down and n up vectors i e with parastichy numbers m n the parastichy numbers of any of its chains are also equal to m n which are equal to the numbers of left and right parastichies all the up and down vectors of the tiling are represented in the chain a chain must have m n primordia proof a left parastichy coming from above a chain c must first intersect c at the origin of one of its down vector whereas a right parastichy first intersects c at the origin of an up vector this provides a one to one correspondence between left and right parastichies and down and up vectors in a chain respectively hence there are m down and n up vectors for a total of m n primordia in c on the other hand each point of the parastichy lp k 1 j is the origin of the down vector dk and likewise for rp i l 1 and ul this provides a 1 1 correspondence between parastichies and the vectors that originates at their points and thus a 1 1 correspondence between the set of up and down vectors of the tiling and those of c remark 4 3 number of petals in daisies the predominance of flowers whose number of petals is a fibonacci number was observed before people had noticed the relationship of these numbers to that sequence 10 modern studies also show that the number of petals in asteracea e g daisies has a statistical peak at fibonacci numbers see references in 5 proposition 4 5 provides among other things a pos sible explanation as to why this might be if we accept that parastichy numbers of the inflorescence of these plants are predominently successive fibonacci numbers this phenomenon would simply be a consequence of the fact that the ray petals occur statistically at a single primordia front a front has n m primordia a fibonacci number if n and m are successive fibonacci numbers it would be interesting to check experimentally the hypothesis of petals forming predominantly at a single front theorem 2 in a fat rhombic tiling t there is a unique primordia front at each point 17 proof we describe the algorithm that builds the front pi 1 pim n given a point pi 1 zm n of t let pi 2 zm 1 n be the right parent of pi 1 by induction let pij 1 be the right child of pij unless this child is strictly higher than pi 1 in which case let pij 1 be the right parent of pij we now show that this process has an end suppose by contradiction that the piecewise linear curve cr we built crosses the vertical line through pi 1 1 0 strictly below that point construct with a similar algorithm a curve cl starting from pi 1 1 0 but going left the curves cr and cl necessarily cross at a tiling point in the strip between the vertical lines through pi 1 and pi 1 1 0 let q be the rightmost such crossing point the right parent of q is in cr the right child of q is in cl and is thus lower than pi 1 which contradicts the algorithm for cr the set of points obtained is clearly a chain it is a front because a child of any of its primordia is higher than pi 1 by construction the periodicity proven in the following proposition is illustrated in fig 2 proposition 4 6 there are mn primordia in a phyllotactic tiling t of parastichy numbers m n between a point z t and its translate z z u including z where u n i 1 ui in the ontogenetic order proof let fz and fz be the fronts at z and z respectively because of the periodicity fz fz u the segment of t comprised between z and z including z includes all the points between fz and fz as well as fz the segment comprises all the segments of n primordia of the left parastichies strictly above fz since there are m such parastichies the number of points in the segment including z is mn 5 the snow dynamical system s 5 1 definition of s remember that in the introduction we gave the following intuitive definition of the snow model given a configuration of disks of equal diameter d on the cylinder place a new one in the lowest position possible on top of the configuration avoiding overlaps to turn this intuitive definition into a mathematical one we made the choice of considering configurations of constant finite number of disks on the cylinder we achieve this simply by removing the last primordium in our list at each iterate making sure that there are enough primordia so that this removal does not have perverse artificial effects this allows us to use the framework of dynamical systems where the space of configurations is of constant dimension throughout the time evolution we also require that the configurations be ordered by height the highest being the first one so that the lowest one is the one removed at each iterate to decide on the location of the new disk primordium we slide a circle y h up the cylinder starting at the top of the configuration and at each height h we check whether there is room to place a disk of radius d without overlapping disks in the configuration this checking is done via computing minimum distances to points of the configuration along that circle when the test is positive we add the new disk and erase the last disk in the list we call the height y y at which there is first room to place a primordium at the 18 edge of the meristem the threshold value in dry mathematical terms this translates into see fig 6 for an illustration definition 5 1 snow map define the map s on k tuplets of points of the cylinder c by s p 1 pk p 1 p 1 pk p 1 pk 1 where each point pk is given by its angular and height coordinates xk yk and where the function p 1 determines the center of the new primordium in the following way let disy k x dist x y pk where dist is the usual euclidean distance on c let mindisy x min k 1 k disy k x and let y min y max k yk max x mindisy x d finally define p 1 p 1 pk to be the point x y c at which this minimax imin is attained if it is attained at several possible values of x choose the smallest of those x in the interval 1 2 1 2 pn pm p 0 x x y y d mindis x x 0 figure 6 the function mindisy at the threshold value y shown below the corresponding configuration the maxima of mindisy occur when the graphs represented with lighter lines of two convex functions disy k cross thus at a maximum the corresponding test point x y is equidistant to its two nearest neighbors in the configuration as the threshold value y is reached where maxxmindisy x d the point x y at which the maximum is attained is thus at distance d from its two nearest neighbors pm and pn there is exactly enough space for a disk of radius d and it must be tangent to the disks centered at pm and pn the convexity of the functions disy m and disy n also implies that pm and pn are on opposite sides of p 1 19 remark 5 1 douady and couder 7 used a similar idea in the algorithm for their snow computer models see also 18 instead of the mindisy function they used potentials which are the sum of repulsive interactions with existing primordia with interactions decaying as the distance increases the map s can be seen as the limit of such models as their rate of decay goes to infinity in the limit the test primordium only feels the closest primordium as is the case in s in 7 this limit is called the hard disk case remark 5 2 as shown in figure 6 and its caption the geometry of the function mindisy implies the following 1 equidistance and tangency to nearest neighbors if the two nearest neighbors of p 1 are less than 2 d apart p 1 is tangent to them and thus equidistant to them if they are farther apart p 1 is located at their midpoint we use the term of parents for the two closest neighbors even in the latter situation generalizing the notion of section 4 1 correspondingly p 1 is the child of its parents 2 opposedness of parents generically see section 5 2 the new primordium has only two parents in this case the centers of these two anterior primordia must lay on opposite sides of a vertical line through the center of the new one hence generically p 1 has a left and a right parent these properties form the basis of our computer algorithm in which we draw lists of candidates new primordium by placing disks tangentially to appropriate pairs of existing disks on sufficiently dense configurations we then weed out the candidates that overlap with existing primordia or whose parents are not opposed and choose the lowest of the remaining candidates in contrast to the above definition our computer algorithm may add disks lower than the highest disk in the given configuration when there is room for one i e if the configuration has holes for instance the algorithm may fill in a necklace until it forms a front since all decent configurations eventually fill in and form a front at their top we chose to elude in this paper the issue of which configurations eventually fill in and concentrate on configurations which already terminate by a front or perturbations of such configurations remark 5 3 a potential alternate definition of front in the case of a rhom bic tiling it is not hard to check that the primordia that contribute to the function mindisy for a given y form a front thus for rhombic tilings a front at a new born primordium can be defined as the set of primordia closest to the meristem one could use this to generalize the definition of front to general configurations letting go of the requirement of tangency we will be specially interested in the lattices and tilings that are preserved by s to make this notion more precise definition 5 2 dynamical configurations an infinite configuration p is called dynamical if given any of its segments x of length k s x is the segment of p immediately above i e obtained by shifting the ontogenetic indices of x by 1 20 5 2 domain of differentiability of s we call a configuration in ck a critical configuration if two distinct pairs of parent primordia lead to two candidate children primordia at the same lowest level for the map s this may occur when the function mindisy x attains its maximum at two distinct values of x but it can also occur as a triple tangency where two pairs of primordia sharing a common primordium give rise to the same child in that case the graphs of three functions disy k forming mindisy cross at the maximum proposition 5 1 the set of critical configurations is a closed set finite union of manifolds maybe with boundaries of codimension at least 1 and thus of measure 0 in ck proof given the location of one child candidate one needs one differentiable equa tion to express the fact that another candidate belongs to the same horizontal line this equation can be written in the form f p 0 where p denotes a configuration in ck and f is the algebraic function giving the difference of height of children of two distinct pairs of primordia in p the gradient of f is always non zero on the level set f 0 indeed let p be such that f p 0 and let pl and pr be the parents of one of the two candidates choose an infinitesimal deformation p of p that rotates pr around pl leaving all other primordia fixed the corresponding displacement of the candidate child is p 2 since it rotates at half the radius f p p is approximately the vertical component of p 2 which is not 0 since pr and pl are not above one another hence 0 is a regular value for f and the equation f p 0 defines locally a manifold of codimension 1 see the preimage theorem 9 each choice of two distinct ordered pairs of primordia gives rise to such a manifold the number of such critical manifolds is thus bounded by the choices of two distinct ordered pairs of distinct indices in 1 k the critical set is closed for each of the choices of pairs of ordered pairs of parents the zero level set of the corresponding function f is closed at the points of ck that a given pair of parents ceases to correspond to maxima another pair must yield a maxima hence the limit of a sequence of critical configurations is always critical we call a configuration p q non critical if sk p is not critical for k 0 q we use s 0 id here we denote by ncq the set of q non critical configuration note that ncq 1 ncq proposition 5 2 the map s is continuous and differentiable on the open set nc 0 of non critical configurations more generally the map sq 1 is continuous and differ entiable on the open set ncq of q non critical configurations proof nc 0 is the complement of a closed set and is thus open outside of the set of critical configurations the function x 7 mindisy x has a unique maximum for each y near the threshold value y this maximum corresponds to two parent primordia whose child p 1 is strictly the lowest candidate primordium in a neighborhood of a non critical configuration the parents indices of the new primordium do not change p 1 is a differentiable algebraic function of the two parents p 1 is the intersection of two circles centered at the parents so the first component function p 1 of s in definition 21 5 1 is continuously differentiable and thus continuous on non critical configurations all other component functions of s are trivially continuously differentiable we show that the set ncq is open and that s q 1 is differentiable on it by induc tion on q we have proven the first step of the induction for q 0 above assume nck is open and s k 1 is continuous on nck for k q let p ncq this implies that sq p nc 0 and that p ncq 1 since sq is continuous on the open set ncq 1 by induction hypothesis and nc 0 is open we can find an open neighborhood u p ncq 1 such that sq u p nc 0 this implies that u p ncq which makes ncq open s q is differentiable on ncq since this set is a subset of ncq 1 since sq ncq nc 0 and s is differentiable on nc 0 the composition sq 1 is dif ferentiable on ncq by chain rule we call the orbit segment of length q of a configuration p the configuration xq p in cq made of q first points of sq p corollary 5 3 continuity of parents data the function associating to a con figuration p the parent data of xq 1 p is constant on each connected component of ncq proof connected components of ncq are by definition the open sets of configurations whose kth new primordium under s have the same parent indices for k 1 q 1 discontinuities of s do occur at configurations on the boundaries of the connected components of nc 0 where there are multiple maxima for mindisy at the threshold level y y indeed two different configurations arbitrarily close to such a critical one may yield a new primordium in drastically different positions although in the long run two such configurations might look arbitrarily similar this switch of ontogenetic order is what makes the divergence angle a less than adequate classifying tool for the geometry of configurations see section 2 2 the map s also fails to be differentiable at configurations with a triple tangency for which p 1 has more than two equidistant nearest neighbors even though it is continuous there this occurs for instance when the configuration is a segment of hexagonal lattice corresponding to at a turning point of a branch of the bifurcation diagram of figure 8 at those points there is more than one choice for the differential matrix violating differentiability 6 dynamics and geometry in this section we show that fronts determine the future of a configuration and the its changes of parastichy numbers we also give some strong evidence that the set of dynamical tilings forms an attractor for s 22 6 1 dynamical properties of primordia fronts we say that a front f is a top front for a configuration p if f p and the points of p are in or below f we based some of our fastest algorithms for s on the following proposition proposition 6 1 if a configuration p has a top front so does s p and the top front of s p is the union of the new primordium p 1 and of the points of the top front of p that are not between the parents of p 1 if two configurations in ck have the same top front they have the same orbit segments proof if p has top front f the only functions disy k whose graphs contribute parts to the graph of x 7 mindisy x in the definition of s are those corresponding to primordia in f remark 5 3 hence f determines the new primordium p 1 in the iteration one can check that the union of p 1 and of all the primordia in f except for those between if any the left parent and right parent of p 1 in the front ordering constitute a top front for s p by induction all the subsequent primordia in the orbit are determined by f the following proposition is at once simple and we think fundamental to understand phyllotactic transitions pointing to the central role of the local geometry of fronts the proof is essentially by picture see fig 7 proposition 6 2 given a configuration p with a top front f the top front f of s p has same parastichy numbers as f if and only if the left and right parents of the new primordium p 1 are separated by exactly one primordium in f in this case p 1 creates a rhombic tile with f if the parents of p 1 are adjacent in f one of the parastichy numbers of f increases by one and p 1 forms a triangular tile with f finally if the parents are separated by two primordia in f one of the parastichy numbers decreases by one and the new tile is pentagonal proof the transitions are understood by the number of down and up vectors between the left and right parents of the new primordium these are always replaced by a pair of up and down vectors in that order the numbers of up and down vectors replaced determine the shape of the new tile of the ontogenetic graph and the change of front parastichy numbers see fig 7 in our numerical experiments the rhombic transitions are by far the most common followed by triangles and pentagons equally common when d is constant as they usually come in pairs hexagons are much rarer conjecture 1 configurations with top fronts cannot yield polygonal tiles with more than 6 sides 6 2 fixed points and periodic orbits in the shape space we now consider the shapes of configurations that are preserved under some iteration of s configurations whose shape is preserved under any iteration fixed points are 23 hexagon 7 5 6 4 d 6 5 pentagon 6 6 c rhombus 6 6 6 6 btriangle 6 5 6 6 a figure 7 the different front transitions a a triangle transition one down vector is replaced by another down angle 3 with the original and an up vector angle 3 with the down vector replaced one of the front parastichy numbers the up number increases by one while the down number stays the same b a rhombus transition a pair of down and up vectors has switched order in the front with no change in the sets of down and up vectors c a pentagon transition one down vector and a pair of up vectors are replaced by one up and one down hence the front up parastichy number decreases by one note that there are no simple relationship between the angles of the new vectors and the old ones they replace d a much rarer hexagon transition a pair of down and a pair of up vectors are replaced by one vector each these four orbit segments are taken from the same orbit with a b c corresponding to successive iterations and d an anterior one found to be the same as for the hofmeister map of 2 in other words see definition 5 2 the dynamical lattices of s and coincide for appropriate choices of parameters on the other hand we will see that many dynamical tilings for s are not dynamical for we first introduce a parameterization of the shape space of configurations and the map s that s induces on it the shape of a configuration is determined by its relative coordinates pk pk 1 pk k 1 k 1 this set of coordinates can be seen as a parameterization of the quotient space of the set of cylindrical configurations modulo the translations on the cylinder as a particular example a helical lattice in this quotient space is simply given by the equations pk p for all k 1 k 1 and for a fixed p c the map s induces a map s on this quotient space of the form s p 1 pk 1 p 1 pk p 1 p 2 pk 1 p 2 pk 2 since k above is an arbitrary large integer we set k k 1 for a lighter notation in the rest of this section similarly to s in the hofmeister map the placement of the new primordium is determined by the maxima of the function mindis called d in 2 but instead of being at a threshold level y y it is evaluated at fixed equal intervals of y the 24 interval length called internodal distance and denoted by y in 2 is the parameter for that system in 2 inspired by 15 we used hyperbolic geometry to analyse in detail the fixed points set of the hofmeister map for all values of y it turned out to be a subset of the set of segments of fat rhombic lattices see figure 8 this latter set described by van iterson 25 must be truncated along crucial segments of its branches to obtain lattices that are dynamical for the same diagram was obtained by douady 6 in a geometric context which is essentially that of this present paper using euclidean geometry only the next proposition shows that the fixed points sets of the maps and s are identical when considering all values of the parameters y and d proposition 6 3 fixed points for the map s are segments of fat rhombic lattices in ck these fixed points are the same as for the hofmeister map of 2 and their set can be visualized in the truncated van iterson diagram of figure 8 proof a fixed point for s is such that p 1 pk p 1 pk on the other hand the definition of s gives p k pk 1 k 2 k hence pk pk 1 k 2 k it easy to see that this yields in the absolute coordinates pk p 0 kp for some p 0 and p independent of k proving that fixed points of s are segments of helical lattices by remark 5 2 these lattices must be rhombic and opposed if p is fixed for s we just saw it is a segment of lattice and by periodicity of the lattice it has constant internodal distance y between successive points in its ontogenetic order since the new primordium maximizes mindis at its level it must correspond to the choice of new primordium for the map for that value of the parameter y thus p is fixed under for that value of parameter y conversely if p is fixed under we showed in 2 that it is a segment of fat opposed rhombic lattice let d be the mutual distance of points in this lattice the new primordium of p under maximizes mindis at the threshold values corresponding to d and is thus the new primordium for s proving p is fixed for s remark 6 1 in the bifurcation diagram there is a monotone correspondence y 7 d y between the parameter d for the map s and the internodal distance y used as parameter for see 7 when the m n branch is not truncated the so called regular case where m 2 n and n 2 m see 2 the angle between the up vector and the down vector of the lattice spans the range of 3 2 3 simple trigonometry on a necklace of the lattice shows that this corresponds to the parameter d ranging in m 2 n 2 mn 1 2 m 2 n 2 mn 1 2 proposition 6 4 periodic points are segments of multilattices if an orbit is a segment of a phyllotactic tiling of parastichy number m n then the tiling is fat and rhombic and the orbit has period mn for s proof periodic orbits of period q are such that s q p 1 pk p 1 pk the same argument as above implies that pk q pk this makes the configuration a mul tilattice with generator q j 1 pj and translation vectors vk k j 1 pj k 1 q the fact that a tiling orbit is fat and rhombic is an immediate consequence of the interpretation of s as a process of piling non overlapping disks of the same size in c 25 figure 8 fixed point set for the snow and hofmeister maps s and each point x y in this plane represents the generator of a cylindrical lattice the lattices that correspond to fixed points for s and have their generator along the dark arcs of circle each dark point representing a dynamical lattice we have indicated a few parastichy number pairs corresponding to different branches the grey arcs bound regions of constant parastichy numbers in 2 the coordinate y of the generator is used as a parameter for the map and this graph is the fixed point bifurcation diagram a monotonic change of coordinates y 7 d y would give the topologically equivalent bifurcation diagram for s opposedness comes from the optimization involved in the definition see comments at the end of section 5 1 the corresponding orbit of s is periodic of period mn since by proposition 4 6 each front s shape is repeated every mn iterates conjecture 2 periodic points for s are segments of fat rhombic tilings the proof of this conjecture would rest on the fact to be established that no periodic orbit may contain other tiles than rhombi apart from rhombi at the boundary of fatness which can be interpreted as two triangles we now obtain with relatively little work infinitely many sets of periodic orbits for the map s that could not exist for the hofmeister map since two primordia could not be generated at the same height in that model the cover of a k jugate configuration lk is obtained from a lattice l by gluing k copies of the cover of l rescaled by 1 k see fig 4 since the cover l k is homothetic to the cover l and homothecies preserve angles and equidistance l is respectively rhombic opposed or fat if and only if lk is we now show that the the correspondence l 7 lk maps fixed points of s to periodic points of period k proposition 6 5 a lattice l is dynamical if and only if its corresponding k jugate configuration lk is a segment of a dynamical lk is a periodic point for s of period k 26 proof choose a segment pk of lk ckk which has k primordia at the same top level the segment pk as a subset of c can be seen as k rescaled copies of a segment p of l in ck see fig 4 set side by side on the cylinder we can choose p and pk to have the same base point 0 0 accordingly the graph of the function mindisy k in the definition of s for pk is made of k copies set side by side rescaled by 1 k of the graph of mindisy for p the value y is a threshold for the function mindisy for p given the parameter d at a point of l if and only if y k is a threshold for pk with parameter d k at k points on the same level of lk this implies that lk is dynamical if and only if l is dynamical since a segment of lk has from 1 up to k primordia at each level an orbit of a segment of lk is of period k a segment of lk in ckk can translate into another one if and only if they both have the same number of primordia at the top level 6 3 sufficient conditions for periodicity this section provides a useful and easily implemented test to establish in a finite number of iterates of s whether an orbit is part of a tiling and thus periodic we call an ancestor of a primordium p in a phyllotactic tiling t a primordium a which can be joined to p by a connected sequence of up and negative down vectors of t in a rhombic tiling this is equivalent to the intuitive meaning of ancestor parent of parent of it is not hard to see that in this case p is on or above the necklace formed by the left and right parastichies between the ancestor a and a u the function dxe used below denotes the smallest integer greater than x theorem 3 let p be a configuration with top front if the top fronts of sq p for q in 0 d 3 mn 2 e have all the same parastichy numbers m n then any orbit segment of p is the segment of the same dynamical tiling in particular the s orbit of p is periodic of period mn proof consider the rhombic tiling t generated by the left and down vectors of the top front f 0 of p we will show that t is in fact a dynamical tiling and that points of t above f 0 form the s orbit for p since the front parastichy numbers are constant all transitions in the orbit are rhombic see proposition 6 2 assume by induction that the top front fk with k 3 mn 2 1 of sk p is in t by hypothesis f 0 is in t let p be the new primordium at iteration k 1 and zm n be its left parent in fk since the transition is rhombic zm 1 n 1 must be its right parent and p zm n un 1 zm n 1 t thus any orbit segment of p is a subset of t we will now show that any orbit segment x of p is in fact a full segment of the tiling t above f 0 suppose first that the orbit segment of length mn above f 0 is equal to a segment of t by proposition 4 6 the front at iterate nm is a translate of f 0 and thus the orbit shape is periodic of period mn for s and must coincide with t above f 0 we now show that this is the only case possible assume by contradiction that some point z of the segment of t of length mn above f 0 is not in the orbit segment x of same length and choose z to be the lowest such point above f 0 the orbit is then strictly bounded above by the necklace formed by the left and right parastichies between the points z and z u of t indeed since 27 any point in the orbit segment x is in t if a point of x were above the necklace it would have z as an ancestor which is absurd since z is not part of the orbit but as is not hard to check the number of points of t comprised between the front immediately below z and the necklace is strictly less than dmn 2 e and thus the number of points between f 0 and the necklace is strictly less than mn dmn 2 e d 3 mn 2 e this is a contradiction to the fact that at least d 3 mn 2 e points of the orbit are in t 6 4 attracting manifolds of periodic points the following theorem shows that around each helical lattice segment of parastichy numbers m n of the bifurcation diagram apart for its turning points there exists a superattracting manifold of dimension m n of dynamical tilings periodic of period mn for s on which neighboring orbits land in finite time in fact such a manifold exists near any sufficiently non critical segment of dynamical tiling we remind the reader that ncq is the open set of q non critical configurations and that rt m n d k is the manifold of segments of length k of rhombic tilings of parastichy numbers m n and parameter d theorem 4 let m and n be coprime and let k m n the set dt m n d k of segments of dynamical tilings of length k in ncmn is an open submanifold of rt m n d k moreover there exists an open neighborhood v of dt m n d k in ck such that for any configuration p v and any j k sj p is in dt m n d k the manifold dt m n d k is not empty when a non critical m n lattice of the bifurcation diagram exists for the given parameter d proof take a segment xk t of a dynamical tiling t and assume xk t is in ncmn then it is in fact in ncq for all q 0 by periodicity theorem 1 let o be the open connected component of ncq containing xk t for a chosen q d 3 mn 2 e by proposition 4 1 xk t is also contained in an open subset u of the manifold rt m n d k the boundary of the set of non fat tilings is made of critical tilings thus since xk t is in ncq it is also strictly non fat the set o u o is thus an open submanifold of tilings segments in rt m n d k containing xk t let y in o be a segment of a tiling t since y is in the same component of ncq as xk t parastichy numbers of the successive top fronts of sj y are constant for 0 j q since all the transitions are rhombic these fronts are all fronts of t by theorem 3 t is dynamical we have shown that dt m n d k is an open submanifold of rt m n d k given xk t dt m n d k take a configuration p in ck in the same open connected component of ncq as xk t p need not be a tiling since all iterates of xk t have a top front of parastichy numbers m n s j p must also have a top front of parastichy numbers m n for k j q by theorem 3 sj p is thus a segment of a dynamical tiling of parastichy numbers m n the union v of all the ncq connected components of configurations in dt m n d k is open and attracted to dt m n d k in finite time in the regular case m 2 n and n 2 m see remark 6 1 each fixed point helical lattice in the range d m 2 n 2 mn 1 2 m 2 n 2 mn 1 2 is non critical 28 and by periodicity q non critical for all q 0 thus for each d in this range the manifold dt m n d k is non empty and provides a manifold of dimension m n of periodic orbits in the irregular case the range of allowable d is smaller but not empty since k jugate lattices have k primordia at the same level they are automatically critical nonetheless a perturbation argument should show conjecture 3 around any dynamical k jugate lattice of parastichy numbers m n whose corresponding helical lattice is non critical there is an open set of dynamical tilings in rt m n d k conjecture 4 the set of dynamical tilings of given parameter d forms an attract ing invariant branched manifold with branches of different dimensions for the map s which in nearby systems persists as an attracting invariant nearby branched man ifold confirming theorem 4 a computation shows that the characteristic polynomial for the differential of s at a non critical dynamical lattice of parastichy numbers m n has the neat form char b 1 m 1 n where b k m n k is the dimension of the phase space thus the eigenvalues are either 0 or equal to m th or n th roots of unity clearly the dimensions of the generalized eigenspaces corresponding to the roots of unity sum up to m n which shows that the sum of these spaces must equal the tangent space to dt m n d k at l the zero eigenvalue in the complementary subspace shows that dt m n d k is normally hyperbolic at l numerical evidence indicates the same to be true at dynamical tilings geometrically the super attraction correspond to fronts forming in finite time on configurations that might not have them thus the set of dynamical tiling could entirely be made of pieces of normally hyper bolic invariant manifolds there are theorems e g 8 that show that given certain conditions on the map or flow normally hyperbolic invariant manifolds survive per turbations of the system as perturbed invariant manifolds in the case of the map s we have some hurdles stacked against us 1 s is not a diffeomorphism it is not 1 1 2 s is not continuous everywhere 3 the set of tilings has branches of various dimensions some of which connect 7 a glimpse at the set of dynamical tilings we conclude this paper with a numerical study of the topology of dynamical tilings to see how dynamical tilings of different parastichy numbers coexist we look at the shape space of all chains of four primordia of diameter d 0 3 such a chain is given by four points or vectors v 1 v 2 v 3 and v 4 we fix one primordium at the origin v 1 0 0 which has no consequence on the shape of the chain we choose two angles and as parameters as fig 9 shows a choice of these angles gives primordia located at 29 v 1 v 2 and v 3 as follows v 1 0 0 v 2 d cos d sin v 3 v 2 d cos d sin d cos cos d sin sin v 1 v 2 v 3 0 0 1 0 v 4 v 4 figure 9 parameterization of 4 chains to be able to define v 4 and effectively have a chain with four primordia we must have d distance v 3 1 0 2 d which is equivalent to 1 cos cos 1 d 2 sin sin 2 4 for our choice of parameter d the first inequality is always satisfied in the case of strict second inequality for each choice of and the placement of primordia v 4 is determined up to two possibilities these are depicted in fig 9 labeled as v 4 and v 4 so without the further identifications that we will make below the parameterized shape space of 4 chains consists of two copies of the same disk like region depicted in fig 10 the boundary points of these regions the equator correspond to choices of and for which the distance between primordia v 3 and v 1 0 0 1 0 mod 1 is 2 d and so v 4 v 4 hence the boundary points of the region are identified one by one to those of the region making the set a topological sphere for now we further identify the four configurations v 1 v 2 v 3 v 4 v 2 v 3 v 4 v 1 v 3 v 4 v 1 v 2 and v 4 v 1 v 2 v 3 as they have the same shape on the cylinder this leads us to make some identifications in the above sphere fig 10 shows these with a number coding regions with same number are identified one can see that the shape space for 4 chains is topologically equivalent to the projective plane rp 2 the colored regions corre spond to shapes of fronts of dynamical tilings of parastichy numbers 1 3 2 2 and 3 1 this coloring was obtained numerically by sweeping the shape space checking for front conditions parastichy numbers and rhombic transitions for each chain in a grid of about 10000 points only 6 iterates of s were necessary at each chain thanks to theorem 3 note that after identification the yellow and red regions each have 30 11 2 4 7 3 7 6 5 4 3 4 3 2 1 1 2 2 3 4 6 6 67 7 5 5 5 a a c c a a a a d d a b c c c c c d b b b b b b 1 0 1 1 0 1 figure 10 the shape space of chains of 4 primordia of diameter d 0 3 the regions and are identified at their boundary equator forming a sphere the black curves drawn are the images of the equator under the cyclic permutations of primordia in the chain these curves separate regions which are identified when representing chains of same shape according to the numbers shown the union of the regions 1 7 forms a topological disk with antipodal identification at the boundary yielding a space topologically equivalent to the projective plane p 2 the point a corresponds to the front of a 1 3 lattice b to that of the 3 1 lattice c and d correspond to the two possible fronts of the bi jugate 2 2 configuration all these lattices are dynamical the yellow region corresponds to chains that are fronts of dynamical tilings of parastichy numbers 1 3 the red region corresponds to fronts of 3 1 tilings and the blue one corresponds to fronts of 2 2 tilings other chains are either not front and or transit in one iterate of s to the above colored regions or to 2 3 and 3 2 tilings only one connected component on which the map has period 3 1 3 3 1 on the other hand the blue shape space of fronts of 2 2 dynamical tilings is disconnected and the map s toggles between one component and the other at each iterate with period 4 2 2 if one were looking at the shape space of dynamical tilings and not their fronts one would have to identify points in each orbit of s in each colored region the space of 2 2 dynamical tilings is then apparently connected the fronts c and d are identified as belonging to the same cylindrical lattice for instance conjecture 5 the shape space of dynamical tilings of parastichy number m n and parameter d is contractible acknowledgments even though the bulk of the research for this paper occurred before our collaborations on this model with ste phane douady jacques dumais and scott hotton it was solidified by many invaluable discussions with them dumais 31 helped us see what might be useful to biologists and suggested our fitting of cylindrical plant patterns to tilings hotton made helpful suggestions on the programming used in figure 1 douady encouraged us to pursue the study of rhombic tilings and their fronts showed us enticing experiments about them and pointed us to the work of van iterson on zickzacklinie hotton dumais and luke grecki read a draft of this paper and made many good suggestions jordan crouser anna naito duc nguyen and erich kummerfeld helped gather plant data that was used in figure 1 we thank them all warmly this research was supported by the nsf nih collaborative research grant 0540740 and a mellon collaborative grant references 1 adler i a model of contact pressure in phyllotaxis j theor biol 45 1974 1 79 2 atela p gole c hotton s a dynamical system for plant pattern for mation rigorous analysis j nonlinear sci 12 6 2002 641 676 3 atela p gole and smith students phyllotaxis an interactive site for the math ematical study of plant pattern formation http www math smith edu phyllo 4 barbier de reuille p bohn courseau i ljung k morin h carraro n godin c and traas j computer simulations reveal properties of the cell cell signaling network at the shoot apex in arabidopsis proc of natl acad sci 103 2006 1627 1632 5 battjes j prunsinkiewicz p modelling meristic characters of asteracean flowerheads in symmetry in plants world scientific 1998 281 312 6 douady s the selection of phyllotactic patterns symmetry in plants world scientific 1998 335 358 7 douady s couder y phyllotaxis as a self organizing iterative process parts i ii iii j theor biol 178 1996 255 312 8 fenichel n persistence and smoothness of invariant manifolds for flows ind univ math j 21 3 1971 9 guillemin v pollack a differential topology prentice hall 1974 10 grew n anatomy of plants rawlings london 1682 available on http www botanicus org 11 hofmeister w allgemeine morphologie der gewachse in handbuch der phys iologischen botanik 1 engelmann leipzig 1868 405 664 12 hotton s symmetry of plants thesis university of california santa cruz 1999 13 hotton s johnson v wilbarger j zwieniecki k atela p gole c and dumais j the possible and the actual in phyllotaxis bridging the gap be tween empirical observations and iterative models j plant growth regul 25 2006 313 323 14 jo nsson h heisler m g shapiro b e meyerowitz e m and mjolsness e an auxin driven polarized transport model for phyllotaxis proc natl acad sci 103 2006 1633 1638 15 lee h w levitov l s universality in phyllotaxis a mechanical theory symmetry in plants world scientific 1998 619 653 32 http www math smith edu phyllo http www botanicus org 16 li s p hill c p sundquist w i finch j t image reconstructions of helical assemblies of the hiv 1 ca protein nature 407 2000 409 413 17 koch a j bernasconi g and rothen f phyllotaxis as a geometrical and dynamical system in symmetry in plants world scientific publishers 1998 459 486 18 kunz m phyllotaxie billiard polygonaux et the orie des nombres the se uni versite de lausanne switzerland 1997 19 munkres j r topology a first course prentice hall 1975 20 reinhardt d mandel t and kuhlemeier c physiologists auxin regulates the initiation and radial position of plant lateral organs the plant cell 12 2000 507 518 21 robinson c dynamical systems crc press 1994 22 shipman pd newell ac polygonal planforms and phyllotaxis on plants j theor biol 236 2 2005 154 97 23 smith r s guyomarc h s mandel t reinhardt d kuhlemeier c and prusinkiewicz p a plausible model of phyllotaxis proc natl acad sci 103 2006 1301 1306 24 snow m snow r minimum areas and leaf determination proc roy soc b 139 1952 545 566 25 van iterson g mathematische und microscopisch anatamische studien uber blattstellungen nebst betraschungen uber der schalenbau der miliolinen gustav fischer verlag jena 1907 26 williams r f brittain e g a geometrical model of phyllotaxis aust j bot 32 1984 43 72 27 weisse a sketch of the mechanical hypothesis of leaf position in k goebel s organography of plants i clarendon press oxford 1900 74 84 28 zago rska marek b phyllotaxic diversity in magnolia flowers acta soc bot poloniae 63 1994 117 137 33 1 introduction 2 numerical explorations 2 1 asymptotic behavior of s 2 2 the fibonacci path 3 classical geometry of phyllotaxis 3 1 underlying geometry 3 2 covering space notions and notation 3 3 cylindrical lattices helical lattices multijugate configurations 3 4 limitations of cylindrical lattices in phyllotaxis 4 new geometry for phyllotaxis 4 1 parents ontogenetic graphs fronts local parastichy numbers 4 2 phyllotactic tilings 4 3 periodicity of phyllotactic tilings 4 4 parastichies of phyllotactic tilings 4 5 front vs tiling parastichy numbers 5 the snow dynamical system s 5 1 definition of s 5 2 domain of differentiability of s 6 dynamics and geometry 6 1 dynamical properties of primordia fronts 6 2 fixed points and periodic orbits in the shape space 6 3 sufficient conditions for periodicity 6 4 attracting manifolds of periodic points 7 a glimpse at the set of dynamical tilings