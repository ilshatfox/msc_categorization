ar x iv 1 60 5 08 46 1 v 2 m at h d g 1 7 n ov 2 01 7 a bochner formula for harmonic maps into non positively curved metric spaces brian freidin brown university bfreidin math brown edu abstract we study harmonic maps from riemannian manifolds into arbitrary non positively curved and cat 1 metric spaces first we discuss the domain variation formula with special emphasis on the error terms expanding higher order terms of this and other formulas in terms of curvature we prove an analogue of the eels sampson bochner formula in this more general setting in particular we show that harmonic maps from spaces of non negative ricci curvature into non positively curved spaces have subharmonic energy density when the domain is compact the energy density is constant and if the domain has a point of positive ricci curvature every harmonic map into an npc space must be constant 1 introduction in 1964 eels and sampson es introduced a bochner identity for harmonic maps between smooth riemannian manifolds one of the consequences is that for a harmonic map from a space with a non negative ricci tensor to a space of non positive sectional curvatures the map is totally geodesic with constant energy density and if the domain has any point with positive ricci curvature then the map is constant the study of harmonic maps has applications in the setting of geometric rigidity the geometric formulation asks if every map is homotopic to a totally geodesic map the bochner formula and other vanishing theorems allow one to deduce a positive answer under further geometric assumptions in the event that one is looking at equivariant harmonic maps this sort of rigidity statement implies rigidity statements for the representations of fundamental groups gromov and schoen gs initiated the study of harmonic maps into singular spaces in particular riemannian simplicial complexes in c chen introduced harmonic maps with simplicial complexes as domains as well in ks 1 ks 2 j 1 j 2 the study of harmonic maps is extended to maps into non positively curved npc metric spaces an npc space x is a geodesic length space any two points can be connected by a curve whose length realizes their distance with a comparison principle for any geodesic triangle abc in x one can build a euclidean triangle a b c r 2 with the same side lengths the npc criterion is that for any point d on the geodesic bc and the corresponding point d on c d cutting the segment into the same proportions the distince d a d in x is no more 1 http arxiv org abs 1605 08461 v 2 than the distance a d in r 2 these spaces generalize simply connected manifolds of non positive sectional curvature a cat 1 space is simply an npc space with a stronger comparison principle instead of constructing comparison triangles in r 2 construct them in h 2 and the cat 1 space has the same comparison inequality the introduction of singular spaces into the theory of harmonic maps has allowed for more statements in geometric rigidity for example gs studied harmonic maps into eu clidean buildings to assert the p adic superrigidity of lattices in groups of rank 1 in dmv daskalopoulos mese and vdovina prove the superrigidity of hyperbolic buildings and in dm 2 daskalopoulos and mese prove similar regularity for maps into more general simpli cial complexes in dm 1 daskalopoulos and mese prove rigidity statements for harmonic maps from 2 dimensional complexes to general npc spaces in c chen used techniques developed in gs to attack the problem of the bochner for mula for harmonic maps from manifolds of non negative sectional curvature to non positively curved simplicial complexes we expand these methods to derive a bochner formula for maps into general npc spaces involving the ricci curvatures of the domain and as a result con clude theorem 1 for a harmonic map u m x from a riemannian manifold m to an npc metric space x u 2 satisfies the weak differential inequality 1 2 u 2 ric here is the pull back metric tensor as defined in ks 1 and ric denotes the quantity gijgk ricik j if in addition x is cat 1 then 1 2 u 2 ric u 4 a similar result was obtained in m where mese studies the bochner formula on flat domains and concludes u 2 2 u 4 for maps into cat spaces in m mese also investigates conformal harmonic maps deriving a curvature bound for the pull back metric in dimension 2 we will derive an energy bound for conformal harmonic maps from hyperbolic surfaces into cat 1 spaces much as in w corollary 2 if u m x is a conformal harmonic map from a closed hyperbolic n manifold m into a cat 1 space x then u 2 n n 1 in ks 2 it is deduced that harmonic maps from flat tori to npc spaces are totally geodesic as a byproduct of the methods of this paper we reproduce this result corollary 3 if m is a flat compact riemannian manifold and x is an npc metric space and u m x is a harmonic map then u is totally geodesic that is constant speed geodesics on m are sent by u to constant speed geodesics in x 2 after first discussing some useful analytic results in 2 our next order of business is to discuss a domain variation formula in 3 we derive the formula from gs via integration by parts finding one term to have a sign different from what was printed there the term of interest derives from the geometry of the domain in gs this and another term were labeled as remainder and shown to have small enough order in terms of other quantities so as not to affect any further results the sign of these terms is however essential to our work also in 3 we derive the target variation formula as well as reproving the lipschitz continuity of harmonic maps in 4 we expand these remainder terms as well as others to ultimately prove a mean value inequality that will lead to the bochner identity above acknowledgements the author would like to thank chikako mese for her interest and comments as well as jingyi chen for his comments and encouragement 2 preliminaries throughout this paper m denotes a riemannian manifold of dimension n with levi civita connection and riemannian curvature tensor r x y z x yz y xz x y z for a local frame ei of tangent vectors define the symbols of the curvature tensor by r ei ej ek rijk e and rijk r ei ej ek e rijkmgm the symbols of the ricci curvature now become rij ric ei ej g k rkij rkij k we will work throughout this paper in normal coordinates around x 0 m identified with 0 tx 0 m we will denote by d and d respectively the riemannian volume and surface measures and by dx and ds the euclidean measures we will also use the convention that n is the volume of the unit ball in euclidean r n under all of our conventions the methods in gjw show proposition 4 on a riemannian manifold m take normal coordinates xi about a point x 0 m identifying x 0 with 0 tx 0 m the metric may be written locally near x 0 as gij ij 1 3 rkij 0 x kx o x 3 3 and taking determinants the volume density can be expanded as g 1 1 6 rij 0 x ixj o x 3 here the curvature symbols rkij and rij are symbols of the curvature tensor at 0 x 0 both of the o x 3 terms depend on the geometry of m and in particular are smooth functions of x we will also require the following proposition 5 let q and q be quadratic forms on euclidean space rn write q x qijx ixj and q x q ijx ixj for symmetric matrices qij and q ij then 1 b q x ds ntr q n 1 2 b q x dx n n 2 tr q n 2 3 b q x q x ds n n 2 2 q q tr q tr q n 3 here the notation q q denotes the trace of the product of the matrices q q qijq ji proof for 1 see b q x ds b qijx ixj for i 6 j this integral vanishes since the integrand is an odd function of xi so b q x ds qii b xi 2 ds 1 n tr q b 2 ds ntr q n 1 2 follows from integrating 1 for 3 compute b q x q x ds b qijx ixjq k x kx 4 define a vector field v qijx ixjq k x ke and note that on b the unit outward normal is 1 xmem now the divergence theorem yields the result q e d two special cases of part 2 are as follows if we take the euclidean metric g x 0 in tx 0 m and let q x ricx 0 x x then qij ricij 0 are the symbols of the ricci tensor whose trace tr ric s is the scalar curvature so b 0 ricx 0 x x dx n n 2 s x 0 n 2 1 if we fix a vector v tx 0 m and take q x rx 0 x v v x then qij vkv rik j x 0 and tr q vkv rik i x 0 v kv rick x 0 ricx 0 v v so b 0 rx 0 v x x v dx n n 2 ricx 0 v v n 2 2 we also now have the tools to phrase a more precise asymptotic version of the bishop gromov comparison theorem proposition 6 let m be a riemannian manifold of dimension n then for x 0 m and small b x 0 n 1 3 n 2 s x 0 o 2 b x 0 proof the ball of radius in normal coordinates coincides with the euclidean ball of the same radius and we have the taylor expansion of the volume density from proposition 4 g 1 1 6 rij 0 x ixj o x 3 integrate to find the volume of the ball using part 2 from proposition 5 b b gdx b 1 1 6 rijx ixj o x 3 dx n n n 6 n 2 s 0 n 2 o n 3 1 b 1 n n 1 1 6 n 2 s 0 2 o 3 now the area of the sphere can be found by differentiating the above or by integrating the volume density on the sphere 5 b n n n 1 n 6 s 0 n 1 o n 2 b b n 1 6 s 0 o 2 1 1 6 n 2 s 0 2 o 3 n 1 3 n 2 s 0 o 2 q e d throughout much of the paper we will be expanding non smooth terms and we will need to understand how small the error terms are the following definition captures the features of the error terms we will accumulate that are essential to showing they are small enough definition 7 a term o k denotes a function on m depending on the parameter with the property that for less than some 0 o k k l is finite and bounded independent of i e an o k is o k and for almost every x m o k k 0 as 0 remark 8 by the dominated convergence theorem a term that is o k has for any compact k m o k k l 1 k 0 note also that a smooth o k term is in particular o k 1 we will need to do some arithmetic with o k terms as well as integrate such a function over a range of lemma 9 for a function o k the function 0 o k d defined by integrating o k pointwise on m is o k 1 additionally o k o o k eo k 1 o k 1 1 o k 1 o k 6 proof we will prove the integral statement the other three follow similarly the latter two with taylor expansions for sufficiently small we have o k k c independent of hence 1 k 1 0 o k x d 1 k 1 0 c kd c k 1 and for 0 and almost any x m we can find 0 0 so that 0 implies 1 k o k x so for 0 we compute 1 k 1 0 o k x d 1 k 1 0 kd k 1 since 1 k 1 0 o k d is bounded in l independent of and tends to 0 almost every where 0 o k d o k 1 q e d the way in which most of the o k error terms will arise is by pulling non smooth functions out of integrals the following propositioni allows us to do this proposition 10 for bounded functions f and on a domain m integrating in normal coordinates around x 0 we have for d x 0 b x 0 f x x dx x 0 b x 0 f x dx o n sup b x 0 f proof first observe b x 0 f x x dx b x 0 f x x 0 dx sup b x 0 f b x 0 x x 0 dx define x 0 b x 0 x x 0 dx at a lebesgue point x 0 for we have 1 n x 0 0 this is the almost everywhere convergence condition since l there is some k 0 with k so 2 k n n this gives the l bound hence o n so we can write b f x x dx b f x 0 dx o n sup b f q e d 7 3 domain and target variation formulas and lips chitz continuity we will now derive the formula from gs taking special care with terms involving derivatives of metric information as these will be essential to the rest of our work proposition 11 for a riemannian manifold m an npc metric space x and a harmonic map u m x we have for almost every x 0 m writing b for b x 0 2 n b u 2 d b u 2 2 u r 2 d b xk gij xk u xi u xj g u 2 xk g xk dx 3 remark 12 note that this formula corrects a sign error appearing in gs the change to one term on the right hand side of the above formula while essential to the present work does not affect the remainder of the arguments in gs as they only require these terms to be o 2 b u 2 d proof these computations will be done in normal coordinates around x 0 0 consider a family of maps ut m x as follows let be a smooth test function supported near 0 and let ft x 1 t x x define ut x u ft x ks 1 describes how to relate the pull back tensor of ut with that of u by the formula ut ij x f t xi x f t xj x u ft x this formula generalizes the chain rule for smooth functions now we consider the energy of the map ut 8 e ut ut 2 d gij x ut ij x d gij x u ft x 1 t x i tx xi x 1 t x j tx xj x d gij x 1 2 t x u ij ft x 2 tx k xi x u jk ft x d o t 2 o t 2 gij f 1 t x 1 2 t f 1 t x u ij x 2 t f 1 t k x xi f 1 t x u jk x det df 1 t x g f 1 t x dx this last line comes from the change of variables formula which is valid even in the presence of the l 1 tensor first compute f it xj 1 t x ij t xj xi det dft 1 nt x tx k xk o t 2 det df 1 t 1 nt txk xk o t 2 we will need the following computation for smooth functions f t f f 1 t x f xk f 1 t x f 1 t k t x since ft x 1 t x x there is some function so that f 1 t x t x x then x ft f 1 t x 1 t t x x t x x x hence 1 t t x x t x 1 and so taking t we have 0 t x x t x 1 t t x x t at t 0 0 x 1 since f 0 is the identity so t t 0 x now f 1 t k x t x xk so we have the following formula for smooth functions f which we will apply for f g and f gij 9 t t 0 f f 1 t x x xk f xk x now we can take the derivative of e ut at t 0 and pass the derivative under the integral writing for u since u is harmonic the derivative is 0 0 d dt t 0 e ut xk gij xk ijd gij 2 ij 2 x k xi jk d gij ij n xk xk d gij ij x k g xk dx in other words 2 n u 2 d 2 gijxk xi jk xk xk u 2 d ijx k g ij xk g u 2 xk g xk dx let now approach the characteristic function of a ball b about 0 the partial deriva tives xk approach xk x times a distribution on the sphere b so the above formula becomes 2 n b u 2 d b xkxk x u 2 2 gijx kxi x jk d b ijx k g ij xk g u 2 xk g xk dx now note in the second integral on the left that xkxk x 2 2 from gjw equation 2 8 says xigij x j so gijxixk jk x jxk jk and x jxk jk x j j x k k r r r r r 2 u r 2 hence 2 n b u 2 d b u 2 2 u r 2 d b ijx k g ij xk g u 2 xk g xk dx q e d for the rest of our work we will need a more precise expansion of the terms on the right hand side of this formula 10 lemma 13 let m be a riemannian manifold x an npc metric space and u m x a harmonic map for almost every x 0 m 2 n b x 0 u 2 d b x 0 u 2 2 u r 2 d n 2 ric x 0 s x 0 u 2 x 0 3 n 2 n 2 o n 2 here ric denotes the quantity gikgj ijrk which at the center of normal coordinates becomes ijricij if u 2 x 0 6 0 then 2 n b x 0 u 2 d b x 0 u 2 2 u r 2 d 1 3 n 2 2 ric x 0 u 2 x 0 s x 0 2 o 2 b x 0 u 2 d proof this result follows from taking a closer look at the terms on the right hand side in 3 we will first expand the terms that come from the domain those that do not involve the tensor fix x 0 m a lebesgue point for all the ij and u 2 and identify it with 0 tx 0 m via exponential coordinates recall the taylor expansion for the metric and the volume density from proposition 4 and compute xk xk gij 2 3 r 0 i x x j o x 3 xk g xk 1 3 ric 0 x x o x 3 combining all the o x 3 terms and recalling that ij u 2 we may now rewrite the right hand side of 3 as 2 3 b ij r 0 i x x j dx 1 3 b u 2 ric 0 x x dx o 3 b u 2 dx since u 2 is in l loc because u is locally lipschitz it is in l for some m compact and all the quadratic curvature terms are smooth and o x 2 so proposition 10 lets us write the above as 2 3 ij 0 b r 0 i x x j dx 1 3 u 2 0 b ric 0 x x dx o n 2 note that b u 2 d is o n and so o 3 b u 2 dx is o n 3 which is in particular o n 2 so it has been absorbed into that term 11 now choose an orthonormal change of basis to diagonalize 0 so that ij 0 i ij now the right hand side of 3 can be further rewritten 2 3 i b r 0 i x x i dx 1 3 u 2 0 b ric 0 x x dx o n 2 equations 1 and 2 after proposition 5 let us integrate these curvature terms the above becomes n 3 n 2 2 ric 0 s 0 u 2 0 n 2 o n 2 hence 3 can be written 2 n b x 0 u 2 d b x 0 u 2 2 u r 2 d n 3 n 2 n 2 2 ric x 0 u 2 x 0 s x 0 u 2 x 0 o n 2 since x 0 is a lebesgue point for u 2 we have b x 0 u 2 d u 2 x 0 v ol b o n u 2 x 0 n n o n the o n error term in the first line is integrable and small by the same reasoning as in proposition 10 so as long as u 2 x 0 6 0 we can write b x 0 u 2 d 1 1 n n u 2 x 0 1 o 1 so around points with u 2 6 0 3 can be further written 2 n b x 0 u 2 d b x 0 u 2 2 u r 2 d 1 3 n 2 2 ric x 0 u 2 x 0 s x 0 2 o 2 b x 0 u 2 d q e d the following proposition comes from variation of the map u on the target rather than on the domain in gs this is proved using the chain rule for maps into riemannian simplicial complexes in our more general setting we do not have tools quite as strong as the chain rule so we resort to the triangle comparison principle 12 proposition 14 for a harmonic map u m x into an npc space x and for any q x we have in the weak sense 1 2 d 2 u q u 2 proof pick a point x m and a tangent direction v txm with v 1 for 0 small let x v denote the image of v under the exponential map expx for the pointsq u x and u x v in x let the points 0 u x and u x v in r 2 be a comparison triangle that is the distances between the three points in x coincides with the corresponding distances in r 2 extend the map u to the geodesic between x and x v by the formula u x s v 1 s u x su x v take a smooth test function supported in a neighborhood of x and define a one parameter family of maps ut m x defined by setting ut y to be the point that is a fraction 1 t y of the way along the geodesic from q to u y similarly along the geodesic from x to x v define u t y 1 t y u y now we can compute the directional derivative of the map u t using the chain rule v u t y 1 t y v u y t v y u y and we can compute the magnitude of this derivative v u t y 2 1 t y 2 v u y 2 2 t v y u y v u y o t 2 1 2 t y v u y 2 t v y v u 2 y o t 2 a simple computation shows v u x lim s 0 u x s v u x s u x v u x and hence v u x 2 d 2 u x v u x 2 also v u 2 x lim s 0 u x sv 2 u x 2 s u x v 2 u x 2 o 1 now we have 13 v u t x 2 1 2 t x d 2 u x v u x 2 t v x d 2 u x v q d 2 u x q o 1 o t 2 by the triangle comparison principle we have d ut x ut x v 2 u x u x v 2 2 v u x 2 o 1 taking 0 yields ut v 2 x 1 2 t x u v 2 x t v x v d 2 u q x o t 2 averaging over the sphere of unit vectors at x we get ut 2 x 1 2 t x u 2 x t d 2 u q x o t 2 finally integrate over the domain and recall that u is minimizing e u e ut e u 2 t u 2 t d 2 u q o t 2 cancelling the e u dividing by t and sending t 0 yields d 2 u q 2 u 2 q e d in particular letting approach the characteristic function of the ball b 0 we see b u 2 d b d 2 u q d b r d 2 u q d we would like now to derive a stronger result if the target has a stronger curvature bound proposition 15 for a harmonic map u m x into a cat 1 space x and for any q x we have 1 2 d 2 u q u 2 d u q cosh d u q sinh d u q 1 u 2 d u q 2 proof the strategy for this proof is identical to that of proposition 14 but now for the points q u x and u x v we have comparison points in h 2 we will choose normal coordinates in h 2 identifying it with r 2 except with the metric ds 2 dr 2 sinh 2 r d 2 14 so take our comparison points to be 0 u x and u x v extend the map u to map the geodesic joining x and x v to the geodesic joining u x and u x v and define u t on that geodesic segment by u t y 1 t y u y for some smooth function just as before the directional derivative of u t at x is v u t x 1 t y v u x t v x u x but now this vector is based at u t x so we must use the metric at that point to compute its norm the vector u x is already pointing in the radial direction when it is based at u x or even at u t x for v u x the radial component is simply v u 0 x and so the component orthogonal to the radial has length v u x 2 u x v u 0 x 2 at u x now in these coordinates the euclidean length of the tangential component of v u is u x 0 sinh u x 0 times its length at u x and so its length when placed at u t x is sinh u t x 0 1 t x sinh u x 0 v u x 2 u x v u 0 x 2 here i am using subscripts on norms of quantities on the target to indicate where those norms are being taken in particular u x 0 is the distance from u x to 0 now we can compute v u t x 2 u t x 1 t x v u 0 x t v x u x 0 2 sinh 2 u t x 0 sinh 2 u x 0 v u x 2 u x v u 0 x 2 by taylor expansion we have sinh z n 0 z 2 n 1 2 n 1 sinh 1 t z n 0 1 t 2 n 1 z 2 n 1 2 n 1 n 0 1 2 n 1 t z 2 n 1 2 n 1 o t 2 sinh z t z cosh z o t 2 sinh 2 1 t z sinh 2 z 2 t z sinh z cosh z o t 2 sinh 2 u t x 0 sinh 2 u x 0 1 2 t u x 0 cosh u x 0 sinh u x 0 o t 2 15 so now we have v u t x 2 u t x 1 2 t x v u 0 x 2 2 t u x 0 v u 0 x v x 1 2 t x u x 0 cosh u x 0 sinh u x 0 v u x 2 u x v u 0 x 2 o t 2 1 2 t x v u x 2 u x t v u 2 0 x v x o t 2 2 t x u x 0 cosh u x 0 sinh u x 0 1 v u x 2 u x v u 0 x 2 the remainder of the argument follows exactly as in proposition 14 q e d we have already used in lemma 13 and will continue to use extensively the fact that a harmonic map is locally lipschitz continuous this was shown in gs for maps into simplicial complexes and in ks 1 for maps into npc spaces it also follows from our work if one takes only the weaker statements without assuming continuity so we include the proof here for completeness proposition 16 let u m x be a harmonic map from a riemannian manifold m into and npc metric space x then u is locally lipschitz continuous with lipschitz constant depending on the energy of u and the injectivity radius of m proof first we have equation 3 but not the result of lemma 13 following that we will have only the following statement out of gs which we expand near 0 rather than the full force of proposition 20 b u 2 d b d 2 u q d e c 1 2 1 o 2 and finally in the proof of proposition 22 we would see d d log b u 2 d o since the function d 2 u q is subharmonic for any q x the mean value inequality from ls says sup br 2 x 0 d 2 u q c 1 o r br x 0 d 2 u q d here the constant c depends on the dimension of m while the o r term depends on the ricci curvatures if m has non negative ricci curvatures we may take o r 0 now for x m r smaller than the injectivity radius at x and any q x we have 16 sup br 2 x d 2 u q c 1 o r br x d 2 u q d c o r br x r 0 bs x d 2 u q d ds c o r br x r 0 1 o s s bs x u 2 d ds o r 2 br x u 2 d fix x 0 m and smaller than its injectivity radius for x 1 x 2 b 8 x 0 we have d x 1 x 2 4 take q to be the midpoint of u x 1 and u x 2 note that d 2 u x 1 u x 2 2 d 2 u x 1 q 2 d 2 u x 2 q applying the above inequality around xi for i 1 2 with radius r 2 d x 1 x 2 we have d 2 u xi q o r 2 br xi u 2 d integrating the inequality from proposition 22 gives b 2 xi u 2 d 1 o 2 br xi u 2 d hence d 2 u xi q o r 2 1 o 2 b 2 xi u 2 d o r 2 1 o 2 b 2 xi b 2 x 0 u 2 d this o r 2 term we can say is less than some cr 2 c 4 d 2 x 1 x 2 putting everything together yields for some constant c depending on d 2 u x 1 u x 2 d 2 x 1 x 2 c b x 0 u 2 d as this holds for any x 1 x 2 b 8 x 0 this gives a local lipschitz bound and it can be seen how the bound depends on the energy of u as well as the injectivity radius i e distance to the boundary q e d 17 4 a bochner formula this section of the paper will first give an asymptotic expansion of the usual monotonicity formula for harmonic maps before deriving the mean value property that will lead to our main theorem for most of this section we will be working around a single fixed point x 0 m and computing in normal coordinates around x 0 so until we reach proposition 22 fix x 0 to be a lebesgue point for pi and such that u 2 x 0 6 0 in a neighborhood of x 0 identify points x m with vectors in tx 0 m via the exponential map in particular identifying x 0 with 0 also for simplicity of notation we will use b to denote b x 0 b 0 now define e b u 2 d and for a point q x define i b d 2 u q d we would like to choose the point q x that minimizes the integral i at least asymptotically as 0 since harmonic maps are locally lipschitz continuous c f gs ks 1 we will always take q u x 0 we will use frequently expansions of e and i for e we will take advantage of x 0 being a lebesgue point for u 2 to say e u 2 0 v ol b o n n u 2 0 n o n for i we first work only at a single point x to derive a pointwise expression for d 2 u q before arriving at an expansion of i lemma 17 d 2 u x u 0 ij 0 x ixj e x here e x depends on the basepoint 0 as well as x near 0 but e x x 2 can be bounded independent of both x and 0 integrating e x x 2 along concentric spheres the quantity tends to 0 at almost every basepoint i n u 2 0 n 1 o n 1 proof we recall the definition of the directional derivatives from ks 1 for almost every direction z u z 2 0 lim 0 d 2 u z u 0 2 we also recall that the pull back tensor satisfies u z 2 0 ij 0 z izj 18 hence the quantity d 2 u z u 0 2 ij 0 z izj tends to 0 as 0 for almost every direction z say z 1 and letting x z we define e x d 2 u x u 0 ij 0 xixj since u is locally lipschitz we can say e x x 2 is bounded independent of x and the base point 0 integrating over a sphere of radius we see i n u 2 0 n 1 b e x d the quantity 1 n 1 b e x d measures the difference between the approximate energy density at 0 and the actual energy density this difference tends towards 0 at almost every point 0 m together with the boundedness property this shows i n u 2 0 n 1 o n 1 q e d for cat 1 targets we will also need to understand d u q since we expect the same result whether x is cat 1 or just npc and the computations are easier if we compare to euclidean space we will only really use the weaker assumption that x is npc lemma 18 b d 2 u q d u q 2 d n n 2 0 n 2 o n 2 here means gikgj ij k which at the center of normal coordinates becomes ij ij proof for a point x b and a unit vector v tx 0 m consider the points u 0 q u x u x v and u 1 x v construct a subembedding in r 2 i e four points 0 u x u x v and u 1 x v such that d u x v q u x v d u 1 x v u x u 1 x v u x and all other corresponding distances are equal now extend u to be an affine map that interpolates the points u x u x v and u 1 x v it will be given by u tx s v tu x s u x v u x t 1 1 u x v u 1 x v now we compute 19 v d 2 u q x lim s 0 d 2 u x s v q d 2 u x q s lim s 0 u x s v 2 u x 2 s 2 u x u x v u x 2 x u x v u x 1 1 x u x 2 1 2 v u x 2 1 v x u x 2 the first term is simply x u x 2 u x 2 d 2 u x q ij x xixj e x the second term is 1 2 v u x 2 1 2 u x v u x 2 2 o 1 u v 2 x o 1 the last term is u 1 x v u x 2 2 o 1 u 1 v x 2 x o 1 u v x 2 x o 1 putting this all together and sending 0 recall lemma 17 and see v d 2 u q x d 2 u x q u v 2 x u v x 2 x 2 ij x x ivj e x considering taking a partial derivative in the opposite direction v we would have v d 2 u q x 2 ij x xivj e x hence we have an equality the sign of the e x term does not matter as it is sufficiently small so it will become a little oh term upon integration now we use proposition 5 d 2 u q 2 x 1 n b 1 v d 2 u q 2 x ds v 1 n b 1 4 ij x k x x ivjxkv ds v e x 4 ik x jk x x ixj e x b d 2 u q 2 d 4 b ik x jk x x ixj 1 o 2 dx o n 2 4 b ik 0 jk 0 x ixjdx o n 2 4 n n 2 0 n 2 o n 2 20 q e d now we will derive an inequality relating e i and u r lemma 19 let u m x be a harmonic map into a metric space x if x is npc then e i b u r 2 d 1 2 if x is cat 1 then e 1 0 u 4 0 3 n 2 u 2 0 2 o 2 i b u r 2 d 1 2 proof first the triangle inequality gives r d u q du dr 4 if x is npc apply the divergence theorem and the cauchy schwarz inequality to propo sition 14 e 1 2 b d 2 u q d 1 2 b r d 2 u q d b d u q r d u q d i b u r 2 d 1 2 if x is cat 1 apply the divergence theorem and cauchy schwarz to proposition 15 21 1 2 d 2 u q d u q d u q d u q 2 d u q cosh d u q sinh d u q u 2 d u q cosh d u q sinh d u q 1 d u q 2 u 2 tanh d u q d u q d u q 2 e b u 2 b tanh d u q d u q b d u q 2 b tanh d u q r d u q b tanh 2 d u q d u q 2 b tanh 2 d u q 1 2 b u r 2 1 2 b d 2 u q d u q 2 o n 4 now let s compare b tanh 2 d u q with i we have tanh 2 z z 2 2 3 z 4 o z 6 so 1 i b tanh 2 d u q 1 2 3 i b d 4 u q o 4 1 2 2 0 u 4 0 3 n 2 u 2 0 2 o 2 from lemma 18 we have b d 2 u q d u q 2 n n 2 0 n 2 o n 2 0 n 2 u 2 0 2 o 2 e moving this term to the other side and combining all the ingredients 1 0 n 2 u 2 0 2 o 2 e 1 2 0 u 4 0 3 n 2 u 2 0 2 o 2 i b u r 2 1 2 and hence e 1 0 u 4 0 3 n 2 u 2 0 2 o 2 i b u r 2 1 2 22 q e d it was shown in gs that for a suitable constant c 1 0 the function ec 1 2 e i is non decreasing in they used the monotnicity of this function to define the order of u at x 0 as ord x 0 lim 0 ec 1 2 e i at points where u 2 6 0 gs showed that u has order 1 this can also be seen via our expansions of e and i from the beginning of this section we can now see how the ratio e i behaves asymptotically near 0 proposition 20 let u m x be a harmonic map into npc space then e i 1 2 ric 0 3 n 2 u 2 0 2 o 2 if x is cat 1 then e i 1 2 ric 0 u 4 0 0 3 n 2 u 2 0 2 o 2 proof first note that lim 0 e i lim 0 e c 1 2 ec 1 2 e i lim 0 e c 1 2 lim 0 ec 1 2 e i 1 ord x 0 for an l function f on m compute d d b fd b r f g ds n 1 b f gds b f r d 1 3 b f x ric 0 x x x ds n 1 b fd o 2 b fds 23 applying this to f x d 2 u x q d 2 u x u 0 we compute a logarithmic derivative i i 1 i b r d 2 u q d n 1 o 2 1 3 i b d 2 u q ric 0 x x ds using lemma 17 to rewrite d 2 u q and then part 3 from proposition 5 compute b d 2 u q ric 0 x x ds b ij 0 x ixj e x rk 0 x kx ds n n 2 2 ric 0 s 0 u 2 0 n 3 o n 3 combining see i i 1 i b r d 2 u q d n 1 1 3 n 2 2 ric 0 u 2 0 s 0 o now compute the logarithmic derivative of e e e e 1 b u 2 d n 2 2 e b u r 2 d 1 3 n 2 2 ric 0 u 2 0 s 0 o this last line comes from lemma 13 now combine these d d log e i 1 e e i i i 1 b r d 2 u q d 2 e 1 b u r 2 d 1 3 n 2 4 ric 0 u 2 0 o from lemma 19 we have for some constant c depending on the curvature bound for x 24 e 1 c 2 o 2 i b u r 2 d 1 2 2 e b u r 2 d 2 1 c 2 o 2 1 i b u r 2 d 1 2 and from cauchy schwarz we get 1 i b r d 2 u q d 2 1 i b u r 2 d 1 2 note also that 1 i b u r 2 d 2 o 2 and so conclude d d log e i 4 ric 0 3 n 2 u 2 0 2 c o integrating over recall lemma 9 and see log e i log ord 0 2 ric 0 3 n 2 u 2 0 c 2 o 2 recall ord x 0 1 and e t 1 t o t 2 taking exponentials now shows e i 1 2 ric 0 3 n 2 u 2 0 c 2 o 2 the value of c for npc or cat 1 targets that comes from lemma 19 yields the desired results q e d as a consequence of the order growth we have the following useful lemma lemma 21 let u m x be a harmonic map if x is npc we have b u r 2 d 1 2 ric 0 3 n 2 u 2 0 2 o 2 e if x is cat 1 then we have b u r 2 d 1 2 ric 0 3 u 4 0 3 0 3 n 2 u 2 0 2 o 2 e 25 proof there are constants c coming from lemma 19 and c coming from proposi tion 20 that depend on the curvature bound of x such that e 1 c 2 o 2 i b u r 2 d 1 2 e i 1 c 2 o 2 combining these see i b u r 2 d 1 2 1 c 2 o 2 e 1 c c 2 o 2 i b u r 2 d 1 c c 2 o 2 i b u r 2 d 1 2 1 c 2 c 2 o 2 e supplying the appropriate constants yields the desired results q e d now we are prepared to prove the mean value inequality that will lead to our main result proposition 22 let u m x be a harmonic map and let x 0 m be almost any point if x is npc then b x 0 u 2 d u 2 x 0 ric x 0 n 2 2 o 2 if x is cat 1 then b x 0 u 2 d u 2 x 0 ric x 0 u 4 x 0 x 0 n 2 2 o 2 proof if u 2 x 0 0 then the inequality holds trivially let x 0 m with u 2 x 0 6 0 be a point where the previous propositions and lemmas apply and identify x 0 with 0 tx 0 m compute setting for simplicity v v ol b x 0 26 d d b u 2 d 1 v 2 v b u 2 d v e 1 v b u 2 d n e 1 3 n 2 s 0 o 2 e 1 v 2 b u r 2 d 2 e 1 3 n 2 2 ric 0 u 2 0 o e 2 v b u r 2 d e ric 0 3 n 2 u 2 0 2 o 2 e the comparison of v and v comes from proposition 6 recall lemma 21 with a constant a depending on the curvature of x and apply it as follows b u r 2 d 1 a 2 o 2 e d d b u 2 d 2 v ric 0 3 n 2 u 2 0 a 2 o 2 e d d log b u 2 d 2 ric 0 3 n 2 u 2 0 2 a o integrating with respect to recall that we are working at a lebesgue point for u 2 and see b u 2 d u 2 0 exp ric 0 n 2 u 2 0 a 2 o 2 u 2 0 1 ric 0 n 2 u 2 0 a 2 o 2 substituting the appropriate value for a from lemma 21 yields the desired result q e d and now we d like to turn the mean value inequality into a differential inequality 27 proposition 23 let f be an l function on a relatively compact riemannian domain of dimension n satisfying for almost every x 0 b x 0 fd f x 0 x 0 2 o 2 then f satisfies the weak differential inequality 1 2 f n 2 proof first we will need a computation about smooth functions for a smooth function h on take normal coordinates about x 0 and the taylor expansion of h about x 0 in these coordinates is h x h 0 ih 0 x i 1 2 i jh 0 x ixj o x 2 now compute the average of h on b x 0 recalling that the volume density in normal coordinates is g 1 o x 2 and that the riemannian volume of b is n n o n 2 b hd h 0 ih 0 b xid 1 2 i jh 0 b xixjd o 3 h 0 ih 0 b xidx 1 2 i jh 0 b xixjdx o 3 integrating now with respect to a euclidean metric ffl b xidx 0 and proposition 5 implies b 1 2 i jh 0 x ixjdx 1 2 n 2 2 i ih 0 and in normal coordinates i ih 0 h 0 so b x 0 hd h x 0 1 2 n 2 2 h x 0 o 3 this o 3 term depends on the geometry of as well as higher order information about the function h note that this formula when combined with the hypothesis immediately yields the result for the smooth function h for f l 1 we will integrate against a smooth test function it will be useful to be able to move an average value operator from one function onto the other in order to do so we must first compare volumes of balls centered at different points b p n n 1 s p 6 n 2 2 o 3 1 b x 1 b y 1 n n s x s y 6 n 2 2 o 3 o d x y 2 n 28 for 1 2 d supp we can make sense of the following x b x f y d y d x d x y 1 b x x f y d y d x f y 1 b y o 3 n b y x d x d y f y b y x d x o 3 y d y now since is smooth it satisfies b x d x 1 2 n 2 x 2 o 3 now we are in a position to integrate against f f d 2 n 2 2 f x b x d x o 3 d x 2 n 2 2 y b y fd o 3 f y f y d y o 2 n 2 y y o 1 d y o taking 0 yields the desired weak inequality f d 2 n 2 d q e d proof of theorem 1 from proposition 22 we have b x u 2 d x here the function depends on the ricci curvatures of m and the curvature bound for x applying proposition 23 we get our result q e d remark 24 compare to the bochner formula of es 1 2 u 2 du 2 ricm u u rx u u u u the terms ric that have appeared are exactly analogous to the ric u u that appears in the classical formula in addition when the target is a manifold of curvature 1 the sectional curvature term rx u u u u simplifies to gijgk ij k ik j u 4 29 corollary 25 let u m x be a harmonic map from a compact manifold m of non negative ricci curvatures into an npc space x then u 2 0 if the ricci curvatures of m are positive somewhere then u is a constant map if x is cat 1 and u is not a constant map then the rank of is almost everywhere equal to one proof theorem 1 implies that over m we have u 2 0 since m is compact m u 2 d 0 hence we must have u 2 0 almost everywhere so u 2 is constant if in addition the ricci curvatures of m are positive at a single point of m there is an open set where the ricci curvatures are strictly positive theorem 1 now says that over there is m 0 so that 1 2 u 2 m u 2 since u 2 0 we must have u 2 0 on since u 2 is constant it must be 0 on all of m that is u is a constant map if x is cat 1 then the vanishing of u 4 implies that has at most one pos itive eigenvalue since is positive semi definite if it is not zero then it has rank one q e d proof of corollary 2 let m be a closed hyperbolic manifold of dimension n a map u m x being conformal means that the pull back tensor satisfies g for a non negative function if u is harmonic and x is cat 1 then theorem 1 says n 2 n n 2 n 2 n n 1 1 at a point where is maximized 0 at such a point 1 n 1 q e d in the case that x is cat 1 and so has rank one we expect that the map u should map into a geodesic on x we will approach this problem in a later paper as it will require several new tools in the meantime for a harmonic map from a flat torus into an npc space we can analyze all the inequalities we used in order to show the map is totally geodesic of harmonic maps since the energy density is constant if it is not identically 0 then every point has order 1 the following arguments essentially those presented in gs lemma 3 2 show that such a map must be totally geodesic proof of corollary 3 if m is compact and flat then in normal coordinates around any point the metric is constant thus the formula 3 is simply 30 2 n b x u 2 dx b x u 2 2 u r 2 ds 0 the further lemmas and propositions then follow with no error terms in particular since u 2 is constant by theorem 1 we have 0 d d b u 2 d 0 hence all of the inequalities used must be equalities the cauchy schwarz inequality gives a constant depending on so that on b we have r d u q c d u q equation 4 gives almost everywhere r d u q u r and from b d 2 u q ds 2 b u r 2 ds we have c 1 now we see u r r d u q 1 d u q first note that for x near 0 we calculate d u x u 0 x 0 r d u q dt x 0 u r dt and this last integral calculates the length of the image of the geodesic from 0 to x hence the image of this geodesic segment is a geodesic in x now from r d u x u 0 1 x d u x u 0 conclude that the image of the unit speed geodesic from 0 to x is a constant speed geodesic in x since harmonic maps into npc spaces are locally lipschitz continuous c f gs ks 1 the speed of the image geodesics in x depends only on the direction of the geodesics in m hence u is totally geodesic q e d classically the bochner formula proves that any map from a space of non negative ricci curvature to a space of non positive curvature is totally geodesic the methods of this paper are not quite strong enough to detect this when the domain is not flat the sectional curvatures of the domain influence many of the o k error terms in order to show the map is totally geodesic we need all of our inequalities to be equalities but these error terms interfere we nonetheless phrase this as a conjecture conjecture 26 any harmonic map from a riemannian manifold of non negative ricci cur vatures to an npc metric space is totally geodesic 31 references c j chen on energy minimizing mappings between and into singular spaces duke math j 79 1995 77 99 dm 1 g daskalopoulos and c mese fixed point and rigidity theorems for harmonic maps into npc spaces geometriae dedicata 141 2009 33 57 dm 2 g daskalopoulos and c mese on the singular set of harmonic maps into dm complexes memoirs of the amer math soc 239 2016 dmv g daskalopoulos c mese and a vdovina superrigidity of hyperbolic buildings geom func anal 21 2011 no 4 905 919 es j eels and j h sampson harmonic mappings of riemannian manifolds amer j math 86 1964 109 160 gs m gromov and r schoen harmonic maps into singular spaces and p adic super rigidity for lattices in groups of rank one publ math ihes 76 1992 165 246 gjw d t guarrera n g johnson and h f wolfe the taylor expansion of a riemannian metric preprint 2002 j 1 j jost equilibrium maps between metric spaces calculus of variations and partial differential equations 1994 173 204 j 2 j jost nonpositive curvature geometric and analytic aspects lectures in mathe matics eth zu rich birkha user verlag 1997 ks 1 n korevaar and r schoen sobolev spaces and harmonic maps into metric space targets comm anal geom 1 1993 561 659 ks 2 n korevaar and r schoen global existence theorem for harmonic maps to non locally compact spaces comm anal geom 5 1997 333 387 ls p li and r schoen lp and mean value properties of subharmonic functions on riemannian manifolds acta math 153 1984 279 301 m c mese curvature of minimal surfaces in metric spaces comm anal geom 9 2001 3 34 w r wentworth the action of the mapping class group on representation varieties advanced lectures in mathematics 16 2011 277 299 32 1 introduction 2 preliminaries 3 domain and target variation formulas and lipschitz continuity 4 a bochner formula