ar x iv 1 50 5 02 96 4 v 2 m at h a g 1 8 ju n 20 17 brane actions categorification of gromov witten theory and quantum k theory etienne mann and marco robalo abstract let x be a smooth projective variety using the idea of brane actions discovered by toe n we construct a lax associative action of the operad of stable curves of genus zero on the variety x seen as an object in correspondences in derived stacks this action encodes the gromov witten theory of x in purely geometrical terms and induces an action on the derived category qcoh x which allows us to recover the quantum k theory of givental lee contents 1 introduction 2 1 1 main results 3 1 2 plan of the paper 6 1 3 future directions 8 1 4 acknowlegments 9 1 5 prerequisites 9 2 brane actions 9 2 1 brane actions for operads in spaces 9 2 2 brane actions for operads in a topos 19 2 3 brane actions for graded operads 27 2 4 graded operads in a topos and brane actions 31 3 stable actions 32 3 1 the operad m of costello and its brane action 32 3 2 the stable sub action of m 36 3 3 gromov witten lax action 38 4 categorification of gw invariants and quantum k theory 45 4 1 categorification 45 4 2 the effects of the lax action on k theory 50 4 3 quantum k theory comparison with the k theoretic invariants of givental lee 56 references 62 e m is supported by the grant of the agence nationale de la recherche new symmetries on gromov witten theories anr 09 jcjc 0104 01 and syme trie miroir et singularite s irre gulie res provenant de la physique anr 13 is 01 0001 01 02 m r was supported by a postdoctoral fellowship of the fondation sciences mathematiques de paris 1 http arxiv org abs 1505 02964 v 2 2 etienne mann and marco robalo 1 introduction gromov witten invariants were introduced by kontsevich and manin in algebraic geometry in km 94 kon 95 the foundations were then completed by behrend fantechi and manin in bm 96 bf 97 and beh 97 in symplectic geometry the definition is due to y ruan and g tian in rt 94 rua 96 and rt 97 mathematicians developed some techniques to compute them via a localization formula proved by graber and pandharipande in gp 99 via a degeneration formula proved by j li in li 02 and another one called quantum lefschetz proved by coates givental cg 07 and tseng tse 10 these invariants can be encoded using different mathematical structures quantum prod ucts cohomological field theories kontsevich manin in km 94 frobenius manifolds dubrovin in dub 96 lagrangian cones and quantum d modules givental giv 04 variations of non commutative hodge structures iritani iri 09 and kontsevich katzarkov and pantev in kkp 08 and so on and used to express different aspects of mirror symmetry another impor tant aspect concerns the study of the functoriality of gromov witten invariants via crepant resolutions or flop transitions in terms of these structures see rua 06 per 07 cit 09 ccit 09 bg 09 iri 10 bcr 13 bc 14 cij 14 etc the goal of this project is to study a suggestion of manin and toe n can the gromov witten invariants of x be detected at the level of the derived category qcoh x we first recall the classical construction of these invariants let x be a smooth projective variety or orbifold the basic ingredient to define gw invariants is the moduli stack of stable maps to x with a fixed degree h 2 x z mg n x the evaluation at the marked points gives maps of stacks evi mg n x x and forgetting the morphism and stabilizing the curve gives a map p mg n x mg n to construct the invariants we integrate over the fundamental class of the moduli stack mg n x for this integration to be possible we need this moduli stack to be proper which was proved by behrend manin bm 96 and some form of smoothness in general the stack mg n x is not smooth and has many components with different dimensions nevertheless and thanks to a theorem of kontsevich kon 95 it is quasi smooth in the sense that locally it looks like the intersection of two smooth sub schemes of smooth scheme in genus zero however this stack is known to be smooth under some assumptions on the geometry of x for instance when x is the projective space or a grassmaniann or more generally when x is convex i e if for any map f p 1 x the group h 1 p 1 f tx vanishes see fp 97 behrend fantechi then defined in bf 97 a virtual fundamental class denoted by mg n x vir which is a cycle in the chow ring of mg n x that plays the role of the usual fundamental class finally this allows us to define the maps that encoded gw invariants as ixg n h x n h mg n 1 0 1 1 n 7 stb mg n x vir iev i i brane actions categorification of gromov witten theory and quantum k theory 3 and we set ixg n ixg n 1 0 2 this collection of maps verifies some particular compatibilities as n and vary summa rized in the notion of cohomological field theory km 94 6 latter in lee 04 giv 00 lee and givental defined morphisms kxg n k x n k mg n 1 0 3 1 n 7 stb o vir mg n x iev i i where ovir mg n x is an element in g 0 mg n x which is called the virtual structure sheaf and which plays a similar role to that of the virtual fundamental class the main result of lee 04 is that these morphisms satisfy the axioms of a k field theory notice that these ax ioms are very similar to the one of the cohomological field theory except the splitting axiom which is more elaborated as it was first explained by givental in giv 00 1 1 main results our main goal in this paper is to provide a first answer to the question of manin and toe n and construct a system of gromov witten invariants at the level of the derived category of x denote by qcoh the derived category of quasi coherent sheaves in this paper we define dg functors qcx 0 n qcoh x n qcoh m 0 n 1 1 1 e 1 en 7 stb o rm 0 n x ie v i ei where o rm 0 n x is the structure sheaf of the derived stack rm 0 n x which is the natural derived enhancement of the stack m 0 n x notice that the map stb rm 0 n x m 0 n and e vi rm 0 n x x are related with the classical stabilization maps resp evi by the natural closed immersion m 0 n x rm 0 n x our main theorem says that these dg functors satisfy the axioms of a system of gromov witten invariants and that when passing to k theory we recover the invariants of givental lee theorem 1 1 1 see prop 4 1 2 4 1 3 4 2 1 and cor 4 3 3 let x be a smooth projective variety over c 1 the dg functors qcx 0 n satisfy the axioms of a qcoh field theory i e the fundamental class the mapping to a point and the splitting axioms similar to the one in k theory 2 the dg functors and the axioms on qcx 0 n restrict also to perf x the derived cat egory perfect complexes 1 1 recall that for x smooth the inclusion of perf x inside cohb x the derived category of bounded coherent sheaves is an equivalence 4 etienne mann and marco robalo 3 by applying the k theory functor we recover the k theoretic gw classes of givental lee of lee 04 giv 00 and its splitting principle in order to explain the strategy to prove this theorem let us start by recalling that the collection of homology groups h mg n g n n forms a modular operad gk 98 6 3 by definition a cohomological field theory in the sense discussed above is an algebra over this operad see gk 98 2 25 in this case the maps ixg n written in the more suggestive form 1 1 2 h mg n h x n 1 h x are only expressing the action of h mg n g n n and the conditions to which they are submitted are then controlled by the rules of operation of gluing curves along marked points mg n mg m mg g n m 2 this operadic viewpoint is at the heart of this paper as our original goal was exactly to study the existence of this action before passing to cohomology in fact the definition of the ig n evokes the diagrams of stacks mg n x p ev 1 evn 1 ww evn mg n x n 1 x 1 1 3 and as explained in the pioneering works of kapranov getzler gk 98 the operadic structure on the homology groups h mg n is induced by the fact that the family of stacks mg n forms itself an operad in stacks m with composition given by gluing curves along marked points one can hope to investigate if the diagrams 1 1 3 seen as morphisms mg n x n 1 x in the category of correspondences in stacks can themselves be seen as part of an action of m and if the action in 1 1 2 is induced by this new one after passing to cohomology there is however an immediate problem that appears if we restrict ourselves to work in the setting of usual stacks the resulting yoga of virtual classes does not agree with the one gromov witten theory requires in fact as it understood today virtual classes are not natural to this setting but instead they are part of the framework of derived algebraic geometry toe 14 tv 08 thanks to schu rg toe n vezzosi stv 11 the deligne mumford stack mg n x has a natural quasi smooth derived enrichment rmg n x whose structure sheaf o rmg n x is expected to produce to the virtual cycle of behrend fantechi via a chern character yet to be defined see the discussion at the end of this introduction and toe 14 3 1 brane actions categorification of gromov witten theory and quantum k theory 5 in this case one can replace the diagrams 1 1 3 by their natural derived version 1 1 4 rmg n x ww mg n x n 1 x noticing that as mg n and x are smooth they don t have non trivial derived enhancements these new diagrams are main the protagonists of our main result which is a highly non trivial geometric phenomena behind theorem 1 1 1 theorem 1 1 2 see theorem 3 3 3 let x be a smooth projective complex variety then x seen as an object in correspondences in derived stacks carries a lax associative action of the operad of stable curves of genus zero m 0 with multiplication given by the correspondences 1 1 5 rm 0 n x vv m 0 n x n 1 x this action is lax associative with lax structure given by the gluing maps 1 1 6 rm 0 n x x rm 0 m x rm 0 n m 2 x m 0 n m 2 m 0 n m 0 m n m 2 which are not equivalences moreover this action respects the gradings the structure of lax associativity meaning the family of maps 1 1 6 and their compati bility under gluings is the mechanism that encodes the shape of the splitting principle the fiber product in the left hand side of 1 1 6 appears naturally from the gluing of a stable map with n marked points to a stable map with m marked points the fiber product on the right hand side appears when we consider directly stable maps with n m 2 marked points the failure of the maps 1 1 6 to be equivalences means that this action is not associative in the strongest naive sense this failure is due to the presence on the right hand side of stable maps glued along chains of trees of p 1 s of arbitrary length which disappear after stabiliza tion as we shall explain in section 4 2 the maps 1 1 6 are surjective and in fact the left hand side is the zero level of an hypercover of the right hand side and these excess of trees of p 1 s correspond to the higher codimension levels of this hypercover moreover these excess trees are exactly the metric corrections introduced by givental lee in quantum k theory lee 04 giv 00 to explain the splitting principle 2 the theorem 1 1 1 is then obtained by applying the functor qcoh to the theorem 1 1 2 2 in ordinary cohomological gromov witten invariants these lax structures becomes equivalences as the maps 1 1 6 are birational and surjective 6 etienne mann and marco robalo 1 2 plan of the paper in this section we sketch the plan of the paper together with the strategy to prove the theorems 1 1 2 and 1 1 1 a first problem that we face when trying to prove theorem 1 1 2 is that by working with de rived stacks we are automatically pushed into the setting of higher categories lur 09 lur 16 b where everything works up to specifying homotopies homotopies between homotopies and so on in this setting the process of assembling the diagrams 1 1 4 as part of an action of the operad of stable curves becomes more sophisticated in practical terms operads have to be replaced by operads lur 16 b and actions can no longer be constructed by hand the only solution is to prescribe some assembly mechanism that produces and ensures these coherences for free for this purpose in we will explore the idea of brane actions discovered by toe n in toe 13 theorem 0 1 section 2 is dedicated to reproducing the results of toe n in the setting of higher operads more precisely we show see theorem 2 1 7 that if if o is a single colored operad in spaces that is coherent in the sense introduced by lurie in lur 16 b then its space of binary operations seen as an object in the category of co correspondences in spaces has a natural o algebra structure the idea that brane actions are related to gromov witten invariants was first suggested in toe 13 where the present work was first announced remark 1 2 1 all the results in this paper concern gromov witten invariants in genus zero to adapt this results to higher genus one would first need to developed the foundations of modular operads replacing dendroidal sets by a more general notion of graphical sets we believe that our results will also work in this setting in particular the idea of brane action we leave this for future works one also expects this action to be compatible with the structure of cyclic operad as recently studied in hry 16 section 3 is dedicated to the proof of the theorem 1 1 2 this proof will require several technical stages mainly in order to make the spaces of stable maps and the correspondences 1 1 4 appear as part of a brane action we will need to consider a certain modified version of the operad of stable curves introduced by costello in cos 06 denote by ne x h 2 x z the class of effective curves in x for any n n ne x denote by m 0 n the moduli stack classifying nodal curves of genus 0 with n marked points where each irreducible component comes with the data of an element of ne x and the sum of all these gradings is depending on these gradings we impose certain stability conditions these are smooth artin stacks see section 3 1 1 the collection of these moduli spaces defines a graded operad in the topos of derived stacks m with grading given by ne x in order to make sense of this we will have to define a notion of graded operads in the setting of higher categories and prove that the construction of brane actions of section 2 extends to this graded context this is done in sections 2 3 1 and 2 4 moreover we have maps rm 0 n x m 0 n sending a stable map c f to the curve c without stabilizing and marking each irreducible component ci with the grading i f ci ci ne x in this case we have diagrams given by evaluation at the marked points brane actions categorification of gromov witten theory and quantum k theory 7 1 2 1 rm 0 n x vv m 0 n x n 1 x the main technical result behind the theorem 1 1 2 is the following result theorem 1 2 2 see cor 3 1 8 and prop 3 2 1 let x be a smooth projective algebraic variety then x seen as an object in the category of correspondences in derived stacks has a natural structure of m algebra induced by the brane action of this operad given by correspondences in the formula 1 2 1 remark 1 2 3 the action in the theorem 1 2 2 is strongly associative in the sense that the lax structure analogue of the maps 1 1 6 appearing naturally in this theorem are equivalences as we shall see right below in the formula 1 2 3 the appearance of a weaker form of associativity is hidden in the passage from the operad of costello to the usual operad of stable curves we believe that this result is the fundamental mechanism behind the organization of gromow witten invariants finally in section 3 3 we explain how to pass from this action to a lax action of the usual operad of stable curves m thus concluding the proof of theorem 1 1 2 indeed there is a map of operads m m obtained by stabilizing the curve and forgetting the gradings the key observation is that at the level of correspondences in derived stacks this map can also be seen as a lax associative map of operads in correspondences from m to m given by correspondences 1 2 2 m 0 n zztt tt tt tt t m 0 n m 0 n this is not strongly associative as the natural maps 1 2 3 m 0 n m 0 m m 0 n m 2 m 0 n m 2 m 0 n m 0 m are not invertible on the right hand side we have pre stable curves that are glued via a tree of p 1 s with two marked points whereas for the left hand side of we only have pre stable curves that are glued directly after stabilizing the two become the same we will denote this lax associative map as m m the theorem 1 1 2 is obtained by composing the action of the theorem 1 2 2 with this map of operads in section 4 1 we address the categorification of gromov witten invariants as suggested by b toe n in toe 09 and prove theorem 1 1 1 namely we explain how the actions 8 etienne mann and marco robalo of the theorems 1 2 2 and 1 1 2 both pass to the derived category qcoh x by taking pullback pushforward along the correspondences 1 1 5 and how these actions restrict to the dg derived categories of coherent cohb and perfect complexes perf by taking pullback pushfoward along the correspondences 1 1 5 these restricted action follow essentially for mally from the theorem 1 1 2 the non formal result is in section 4 2 and concerns an explicit description of the splitting principle for perf in terms of an h descent theorem in derived al gebraic geometry theorem 1 1 1 2 was the main motivation to this work y manin suggested to us that this action could be happening at the level of non commutative motives see also man this is now a consequence of our results and the theory developed in rob 15 however it seems in fact more interesting that this action happens before motives and even before the world of derived categories it happens in the geometric world of derived stacks and correspondences between them as explained by our theorem 1 1 2 recall that by definition the g theory of x is the k theory spectrum of the dg category cohb x in the end of section 4 2 and in section 4 3 we show the third part of theorem 1 1 1 namely that applying the g theory functor to thm 1 1 1 2 we obtain a lax associative g m 0 n n algebra structure on the spectrum g x this action recovers the formulas of quantum k theory of givental lee of lee 04 giv 00 and the lax structure explains the metric to conclude the paper in section 4 3 we observe that the k theoretic gw classes obtained in thm 1 1 1 3 are exactly the same as the gw classes introduced by givental lee this follows from results of cfk 09 and ls 12 see cor 4 3 3 1 3 future directions connection with usual gromov witten invariants in cohomology we believe the action given by the theorem 1 2 2 is the main mechanism behind the yoga of gromov witten invariants in fact if a theory of chow groups for derived deligne mumford stacks were already available with the correct pushforward functoriality then applying these chow groups directly to the action in correspondences by deformation to the normal cone also to be developed we believe we would immediately be able to recover the usual gromov witten invariants in the sense constructed by beherend fantechi manin using virtual cycles however a more interesting question remains can the usual cohomogical gromov witten in variants also be detected directly from the categorical action of the theorem 1 1 1 using some version of the derived category of x our result gives us an action in the periodic cyclic homology hp x but we don t know how to identify it with the usual invariants a first ingredient to achieve this comparison is a riemann roch theorem for derived quasi smooth deligne mumford stacks however even with this at our disposable we don t know how to complete the comparison as the invariants obtained seem to live in the twisted sectors we will investigate this in future works quantum product on categories of matrix factorizations starting with a weighted homogeneous polynomial w the moduli space of w spin curves is a smooth deligne mumford stack but to define fan jarvis ruan witten invariants the brane actions categorification of gromov witten theory and quantum k theory 9 same authors construct two vector bundles whose difference provides an ersatz of a virtual fundamental class notice that a similar situation appears also in gromov witten theory indeed the moduli space mg n x 0 mg n x is smooth but its virtual fundamental class is not the fundamental class as one needs to twist by the top chern class of the hodge bundle to get the correct numbers we think that a similar phenomena exists for spin curves namely there is a canonical derived structure on it that is hidden if one defines the correct derived structure one expects to produce a structure of a lax action of qcoh mg n on the category of matrix factorization of w one expects this will provide a geometrical explanation for the results in cir 14 1 4 acknowlegments the original motivation for this project was the idea of categorify ing gromov witten as suggested by bertrand toe n in toe 09 this was the topic of a weekly seminar gromov witten invariants and derived algebraic geometry organized in the uni versity of montpellier in 2012 it was there that the idea of brane actions appeared together with the insight of their connection to gromov witten theory the authors then took the task of adapting these results to gromov witten theory we would like to thank everyone involved in the seminars and in many posterior discussions anthony blanc benjamin hen nion thierry mignon and b toe n we would particularly like to express our gratitude to b toe n for his multiple comments and mathematical insights and for the continuous support during the long gestation period of this paper the key idea of brane actions is due to him also special thanks to benjamin hennion who gave us crucial insights during different stages of the project we would also like to express our gratitude to d calaque a chiodo h iritani m kontsevich y manin t pantev m porta t schu rg g vezzosi and t yue yu for conversations email changes and many insights related to this project finally we would like to thank the anonymous referee for this comments corrections and suggestions that helped improving the paper 1 5 prerequisites we assume the reader is familiar with derived algebraic geometry in the sense of toe 14 tv 08 and with the tools of higher category theory and higher algebra lur 16 b lur 09 particularly with the theory of operads 2 brane actions we start by providing an alternative construction of the brane action of toe 13 thm 0 1 that has the advantage of being formulated purely in terms of categories avoiding stricitification arguments this reformulation is crucial to the proofs given in this paper 2 1 brane actions for operads in spaces the sphere sn is a en 1 algebra in the category of cobordisms of dimension n 1 in the case when n 1 the multiplication map is given by the pair of pants recall that sn is the space of binary operations of the topological operad en 1 these are the standard examples of the so called brane actions where an operad acts on its space of binary operations in toe 13 brane actions were constructed for any monochromatic operad satisfying some mild conditions being of configuration type or equivalently coherent in order for this generalization to have a sense we need to understand brane actions not at the level of cobodisms but rather at the level of co spans the 10 etienne mann and marco robalo construction requires some non trivial strictification arguments in this section we provide an alternative construction that avoids strictifications as we shall explain this action is deeply related to the definition of co correspondences and to the definition of coherent operad introduced by j lurie in lur 16 b 2 1 1 algebras in correspondences and twisted arrows let c be an 1 category with finite limits then we can form an 2 category of correspondences in c which we will denote as spans 1 c this was constructed in dk 12 section 10 moreover admits a symmetric monoidal structure where every object is fully dualizable see hau 14 thm 1 1 dually if c has finite colimits one can also form an 2 category of co spans in c we dispose of two canonical functors c spans 1 c and c op spans 1 c both given by the identity on objects the first sends a map f x y in c to the correspondence x x y and the second sends y x in cop given by f to y x x the canonical functor cop spans 1 c has a universal property it is universal with respect to functors out of cop to an 2 category and satisfying base change pullback pushfoward more precisely whenever we have an functor f cop d with d an 2 category such that 1 for every morphism f x y in c the 1 morphism f f has a right adjoint f in d 2 for every pullback square in c x f g y u x v y the canonical 2 morphism in d f v u g f f is an equivalence then f extends in a essentially unique way to an functor of 2 categories spans 1 d informally defined by sending a correspondence z a b x y to the 1 morphism in d given by b f a brane actions categorification of gromov witten theory and quantum k theory 11 a precise proof of this fact is given in grb part v in our case we will be mostly concerned not with functors out of spans 1 c but instead with functors with values in spans 1 c we now recall a characterization of the maximal 1 category inside spans 1 c which we will denote as ccorr for simplicity for this purpose we have to recall some notation let d be an 1 category in this case we can define a new 1 category tw d as follows objects are morphisms in d a morphism from u x y to v a b is a commutative diagram x u a v y boo this definition can be made precise and defines a new 1 category so called of twisted arrows in d see lur 16 b section 5 2 1 it is also important to remark that the assignment c 7 tw c can be seen as an functor tw cat cat which commutes with all small limits lur 16 b 5 2 1 19 the main reason why we are interested in twisted arrows is the following universal property proposition 2 1 1 let c be an 1 category with finite limits and let d be an 1 category there is a canonical equivalence between the space of functors f d ccorr and the space of functors f tw d c having the property that for any pair of morphisms in d f x y and g y z the object f g f is the fiber product of f g and f f over f idy remark 2 1 2 a dual result holds when we replace correspondences by co correspondences this corresponds to replacing c by cop this result can be used as a definition of ccorr see bar 13 and more recently hau 14 the result also appears in the appendix of ras 14 for our purposes we will need a monoidal upgrade of the previous proposition as c admits finite limits ccorr acquires a symmetric monoidal structure remark that it won t be a cartesian monoidal structure let us denote it as ccorr let now d have a symmetric monoidal structure d then lur 16 b 5 2 2 23 shows that tw d inherits a symmetric monoidal structure induced from d tw d objectwise it corresponds to the tensor product of 1 arrows in d 3 at the same time the construction mapping a category with products to its category of correspondences can also be interpreted as an functor corr catprod cat which also commutes with products and therefore sends algebras to algebras prop 2 1 1 can now be understood as saying that the constructions tw and corr are adjoint 4 by this discussion the adjunction extends to algebras and we have the following corollary 3 the existence of this monoidal structure is easily deduced from the fact that tw commutes with products and therefore sends algebras to algebras tw calg cat calg cat 4 more precisely one can proceed as in hau 14 and see that tw has a right adjoint and corr is a sub functor of this adjoint 12 etienne mann and marco robalo corollary 2 1 3 let c be an 1 category with finite limits and let d be a symmetric monoidal 1 category there is a canonical equivalence between the space of monoidal functors f d ccorr and the space of monoidal functors f tw d c having the property that for any pair of morphisms in d f x y and g y z the object f g f is the fiber product of f g and f f over f idy here c denotes the cartesian monoidal structure remark 2 1 4 again replacing c by cop if c has pushouts we can replace correspondences by co correspondences we will now discuss how this result allows us to describe algebras in correspondences to start with let o be a operad in spaces for the moment let us suppose that o has a unique color so that we can think of o in a more traditional form as a family of spaces o n n n together with certain operations in this case intuitively an o algebra in ccorr consists of an object x ccorr together with operations tn mapccorr x n x indexed by o n these operations are required to satisfy some coherence conditions encoded in the fact that the assignments tn o n mapccorr x n x form a map of operads up to coherent homotopies to give a formal definition we will see the spaces o n as mapping spaces in a multicategory with a single color this is the strategy of lur 16 b in this case the data of an o algebra in ccorr is given as a commutative diagram that preserves inert morphisms 2 1 1 o ccorr yyrr rr rr rr rr n fin and we recover the object x as the image of the unique color of o we will assume that the reader is familiar with this language we will also assume that o is a unital operad recall that this means that the space of nullary operations is contractible as shown in lur 16 b 2 2 4 9 the functor that sees a symmetric monoidal 1 category as an operad has a left adjoint if o is an operad then we can define a symmetric monoidal 1 category the symmetric monoidal envelope of o which we will denote as env o explicitely if we model operads as 1 categories over n fin then env o is the pullback o n fin act n fin so that env o 1 is the subcategory o act of o spanned by all objects and active morphisms between them see lur 16 b 2 2 4 1 2 2 4 3 in this case to give an o algebra in ccorr is the same as giving a monoidal functor env o ccorr but now using 2 1 3 this corresponds to the data of a strongly monoidal functor brane actions categorification of gromov witten theory and quantum k theory 13 tw env o c such that the underlying functor tw env o c satisfies the pullback condition by lur 16 b prop 2 4 1 7 2 this corresponds to an functor tw env o c satisfying the conditions of a weak cartesian structure see lur 16 b def 2 4 1 1 our main interest is the case of co correspondences suppose that c admits finite colimits then we can apply this discussion to cop and the data of an o algebra in cco corr cop corr is equivalent to the data of an functor 2 1 2 tw env o cop satisfying the conditions of weak cartesian structure in cop and the conditions of the corollary 2 1 3 recall that by definition we have env o o act so that we can identify objects of tw env o with sequences n 1 x 1 y 1 n xn yn of active morphisms in o 2 1 2 construction of brane actions we can now use the description of algebras in corre spondences 2 1 1 as functors 2 1 2 to construct brane actions in this section we work with operads in spaces and in the next section we will extend these results to operads enriched in a topos let us introduce some notation let o be a unital operad and let x y be an active morphism an extension of consists of an object x 0 o 1 together with an active morphism x x 0 y such that the restriction to x recovers if p denotes the structural projection o n fin then the canonical map x x x 0 is defined over the inclusion n p x n 1 that misses a single element in n 1 the collection of extensions of can be organized in a 1 category ext see lur 16 b def 3 3 1 4 remark 2 1 5 in the case o is monochromatic with color c o 1 is an groupoid and is an active map c c c over n 1 ext is a space and it is equivalent to the fiber over o n of the map o n 1 o n obtained by forgetting the last input this makes sense because the operad is unital here o n map f o act c c c in the case where o 1 is contractible we have ext idc o 2 we now recall the notion of a coherent operad lur 16 b 3 3 1 9 definition 2 1 6 let o be a operad we say that o is coherent if 1 o is unital 2 the underlying 1 category o 1 of o is a kan complex 3 suppose we are given two composable active morphisms in o x f y g z then the commutative diagram 14 etienne mann and marco robalo ext idy ext g ext f ext g f is a pushout theorem 2 1 7 toe n let c s be the 1 category of spaces let o be a unital coherent monochromatic operad with a unique color c and o 1 5 then the space ext idc o 2 is an o algebra in s co corr more precisely there exists a map of operads 2 1 3 o s co corr xxqqq qq qq qq qq q n fin sending the unique color of o to the space ext idc this theorem is proved in toe 13 thm 0 1 using non trivial stricification arguments here we suggest an alternative proof that avoids those arguments and gives a more conceptual ex planation moreover this new strategy will be very useful throughout the rest of this paper as discussed above we are reduced to construct an functor 2 1 4 tw env o sop sending the identity map idc c c seen as an object of tw env o to the space ext idc an object c c c c in tw env o to the space ext and satisfying certain conditions proof of theorem 2 1 7 to produce the functor 2 1 4 we can use the grothendieck con struction and instead construct a right fibration bo tw env o such that the fiber over an object c c c c in tw env o is the space ext we construct it as follows start with the source map fun 1 tw env o ev 0 tw env o 5 recall that the of being unital condition is equivalent to say that o 0 is a contractible space brane actions categorification of gromov witten theory and quantum k theory 15 which we know to be a cartesian fibration via the composition of morphisms see lur 09 2 4 7 5 2 4 7 11 we let bo denote the non full subcategory of fun 1 tw env o defined as follows 1 its objects are those twisted morphisms n 1 x 1 y 1 n xn yn f 1 u v over the unique active map n 1 such that the corresponding twisted arrow i n xi x i n i u i n yi vy oo satisfies the following two conditions a the active map x i n xi u is semi inert in o and is defined over one of the maps m p i n xi m 1 corresponding to an inclusion that misses a single m 1 b the map y is an equivalence 2 a morphism in fun 1 tw env o over a morphism 1 a 1 b 1 a b g in tw env o is a commutative square 1 w z h g t oo f oo over 1 id 1 g p t oo n p f oo such that a both t and f satisfy the conditions of item 1 b in the induced diagram 16 etienne mann and marco robalo w h u a i n j g 1 i aj oo g i n xi oo the map h sends the unique element p w p a to the missing element in m 1 it follows now from lur 16 b def 3 3 1 4 that the fiber of the composite bo fun 1 tw env o tw env o over an object n 1 x 1 y 1 n xn yn is the space ext i n i i n ext i we remark now that remains a cartesian fibration under the composition of twisted morphisms we will check it in the case when we have a single active morphism as the general case can easily be reduced to this one let x y be an active map and x y be an extension of with x x semi inert over the inclusion n n 1 that misses a single element ai n 1 consider a u g 1 x v y g 2 oo a twisted morphism from an active morphism to we remark that as the operad has a unique color and o 1 is contractible for any u u semi inert over an inclusion that misses a single element p u k k 1 the space of factorizations 2 1 5 u h x u g 1 oo x oo where h satisfies the conditions in 2 b is contractible indeed the definition of operad together with the condition 2 b tells us that map p h o u x map p g 1 o u x o 1 map o u x showing that h is essentially unique once g 1 is given moreover the same argument tells us also that as the operad has a unique color and o 1 is contractible all semi inert morphisms u u over an inclusion that miss a single element k k 1 are equivalent in a canon ical contractible way via the permutations that change the choice of the missing elements this implies that is a cartesian fibration to conclude we have to show that the functor associated to tw env o sop brane actions categorification of gromov witten theory and quantum k theory 17 satisfies 1 the condition of the corollary 2 1 3 and 2 it is a weak cartesian structure in s op in the sense of lur 09 2 4 1 1 but this is exactly where the coherence conditon plays its role 1 is equivalent to the definition of coherent operad and 2 follows from the fact that ext 1 n ext i i i ext i this is clear from the construction and from the definition of ext in lur 16 b 3 3 1 4 3 3 1 7 in particular we have ext id c c n ext idc remark 2 1 8 it follows from the cartesian morphisms in the theorem that co correspondence n ext idc ext ext idc induced by o n can be canonically identified with the pullback of the diagram considered in toe 13 thm 0 1 no 2 o n pp pp pp pp pp pp p o n 1 o 2 o n oo ww o n along the map o n see the remark 2 1 5 following toe 13 prop 3 5 we say that a monochromatic unital operad in spaces o is of configuration type if for every n 2 and m 2 the natural composition diagram o n o m 1 o 2 o n o m o n 1 o m o n m o n o m o n m 1 is a pullback notice that in this case the condition of o being of configuration type is equivalent to being coherent the compatibility between the spaces of extensions of two operations o n and o m is obtained by taking the fibers of the diagram 2 1 8 over the map o n o m example 2 1 9 as shown in lur 16 b thm 5 1 1 1 the operads e n are coherent in this case for en k the space ext is equivalent to a wedge ks n 1 and the brane action is given by the usual cobordism style action when n 1 the co span k s 1 ks 1 s 1 can be identified with the usual pants with k legs 18 etienne mann and marco robalo 2 1 3 functoriality of extensions let f o o be a map of operads and suppose both o and o are unital monochromatic with o 1 o 1 then we have a natural morphism of right fibrations induced by f 2 1 6 bo f bo tw env o f tw env o indeed as we know both constructions tw and env are functorial as the construction fun 1 is also functorial and the source map ev 0 is a natural transformation we know that f induces a commutative diagram of right fibrations 2 1 7 fun 1 tw env o ev 0 f fun 1 tw env o ev 0 tw env o f tw env o more generally the same argument gives us an functor b op fun rf 1 cat where op is the full subcategory of op spanned by the operads satisfying the con ditions at the beginning of this section and funrf 1 cat is the full subcategory of fun 1 cat spanned by those functors that are right fibrations we are now left to check that if f is a map of operads then the induced map of right fibrations 2 1 7 sends the full subcategory bo to bo or in other words f preserves the conditions 1 and 2 in the proof of 2 1 7 but this follows immediately from the fact f is a map of operads and maps of operads preserve semi inert morphisms this follows from the fact inert edges are cocartesian by definition it also follows from the proof of the thm 2 1 7 that f sends cartesian edges to cartesian edges 2 1 4 some examples and remarks remark 2 1 10 from co spans to spans let o be a unital coherent monochromatic operad with color c then the theorem 2 1 7 tells us that the space ext idc is an o algebra in sco corr fix now x a space then we have a functor map x sop s we can use the definition of correspondences to see that this functor produces an functor sco corr op scorr which is monoidal with respect to the opposite of on s co corr and on scorr 6 in this case the space map ext idc x becomes an o algebra in s corr by means of the composition tw env o sop s 6 notice that if c is a category with finite products the operation induces a symmetric monoidal structure in correspondences in c but this structure is no longer cartesian as it does not verify the required universal property for the description of the mapping spaces to a product brane actions categorification of gromov witten theory and quantum k theory 19 example 2 1 11 n loop stacks let c be the topos of derived stacks over a field of characteristic zero considered with the cartesian structure see tv 08 toe 14 as c is presentable we have a canonical monoidal colimit preserving functor s c by the universal property of correspondences this functor provides an functor s co corr cco corr in particular for any unital coherent monochromatic operad in spaces o we can consider ext idc as an o algebra in c co corr via the composition o sco corr cco corr in this case for any derived stack x the mapping stack map ext idc x becomes an o algebra in ccorr in particular when o e n as en 2 s n 1 we find that the mapping stack map sn 1 x becomes and en algebra in correspondences example 2 1 12 at the same time when working with derived stacks which have compactly generated derived categories of quasi coherent sheaves qcoh provides a monoidal functor dstk op dgcatcontk where dgcat cont is the 2 category of k linear presentable dg categories together with continuous functors as 1 morphisms for nice enough derived stacks such as the notion of perfect stacks introduced in bzfn 10 section 3 1 this functor factors through the sub category of compactly generated dg categories and satisfies the pullback pushfoward base change and the 2 monoidal universal property of correspondences tells us that qcoh factors as a monoidal functor spans 1 nicedstk dgcat cont k we restrict to the maximal 1 categories and obtain a monoidal functor nicedst corr k dgcat cont k as a corollary of the theorem and the previous example we deduce that if x is a nice enough stack the dg category qcoh map sn x is an en 1 monoidal dg category thus recovering by a different method the result of bzfn 10 section 6 in toe 13 corollary 5 4 this is used the prove higher formality 2 2 brane actions for operads in a topos 2 2 1 we want to be able to work with operads enriched in derived stacks the first task is to define what these objects are thanks to the works of mw 07 hhm 13 cm 11 chh 16 cm 13 a cm 13 b we can model operads in the sense of lurie lur 16 b using the category of non planar rooted trees either via dendroidal sets i e presheaves on or dendroidal segal spaces i e functors n op s satisfying a local condition with respect to certain segal maps we use this as an inspiration to define operads in a hypercomplete topos 7 7 recall from lur 09 that hypercomplete topos can always be described as sheaves over a site 20 etienne mann and marco robalo definition 2 2 1 let t be hypercomplete topos the 1 category of operads in t is op t fun segal n op t of course when t s the comparison theorem of hhm 13 chh 16 tells us that op s op and in this case when t is the topos of sheaves in a site c we have op t fun segal n op sh c funsegal n op cop s sh c op so that according to our definition here an operad in t is just a sheaf of operads on the site c equivalently one can also describe op t as the 1 category of limit preserving functors top op when t is a topos the yoneda inclusion provides an equivalence t funlimits top s let us now explain the construction of brane actions for an operad in a topos later on we will be interested in the topos of derived stacks over a field of characteristic zero let m sh c op be an operad in t sh c for the rest of this section we will be working under the following assumption a for each z c the operad m z op is unital coherent has a unique color which we will designate by cz and the underlying 1 category of m z is a contractible groupoid in this case we know from the discussion in the previous section that each m z admits a brane action in sco corr our task now is to understand the compatibilites between these brane actions for that purpose we will need some preliminaries the first observation is that as m has a unique color we can use the equivalence op t fun segal n op t see the details in hhm 13 chh 16 to think of m as a collection of objects in t mn n 0 defined by means of the following universal property for every z c we have canonical equivalences map t z mn m tn x mapm z act cz cz cz where tn is the non planar rooted tree with n leafs of course in this case the yoneda s lemma gives us canonical maps in t mn mi 1 min mi 1 in that determine the composition operations in m in other words we can think of m using our familiar intuition of operadic objects and their standard operations this machine cap tures all the necessary coherences moreover as m is unital we will have m 0 so that we will also have operations mn 1 mn which correspond to forgeting the last input our assumption a implies also that m 1 it follows from the remark 2 1 8 that a monochromatic operad in a topos t is coherent if and only if the commutative diagram in t brane actions categorification of gromov witten theory and quantum k theory 21 2 2 1 mn mm 1 m 2 mn mm mn 1 mm mn m mn mm mn m 1 is cartesian given z c the brane action bz m z s co corr of the theorem 2 1 7 en dows the space of extensions ext idcz in m z with a structure of m z algebra in co correspondences of spaces following our assumptions and as explained in the remark 2 1 8 for a given z this space is given by map t z m 2 to describe the action we can also mimic the arguments of the remark 2 1 8 indeed yoneda s lemma ensures the existence of universal diagrams in t 2 2 2 n mn m 2 mn 1 m 2 mn yyss ss ss ss ss oo mn with the universal property for a given z mn the effect of the action of on map t z m 2 mapt z z z m 2 is the co correspondence obtained by pulling back the universal diagram along and taking sections over z namely n map t z z z m 2 mapt z z c mapt z z z m 2 where 2 2 3 c z mn mn 1 remark 2 2 2 the coherence criterium of the diagram 2 2 2 can now be measure in terms of the objects c in fact m is coherent if and only if for any z and any two operations z mn and z mm the map induced between the fibers 2 2 4 c z m 2 c c mn mm 1 m 2 mn mm mn 1 mm mn m mn mm mn m 1 is an equivalence this two step description pulling back along and taking sections suggests that in fact this algebra structure in sco corr exists before taking sections or in other words that the space z m 2 is itself an m algebra in t z co corr intuitively given z mn the 22 etienne mann and marco robalo action of on z m 2 is simply the co correspondence over z given by the pullback along of the universal diagram 2 2 2 namely 2 2 5 n z m 2 c m 2 z zz oo z so that the brane action in co correspondences in spaces can be recovered by applying the monoidal functor t z co corr sco corr which applies map t z z both at the level of objects and correspondences let us explain how to construct this action over z we start with the following nice consequence of rezk s characterization of topoi proposition 2 2 3 let t be an topos the construction z cop 7 t z co corr op is an operad in t proof recall that t z is again an topos lur 09 6 3 5 11 thanks to charles rezk s characterization of topoi lur 09 6 1 6 3 the assignment z cop 7 t z is a sheaf with respect to the topology in c and admits a classifying object which we shall denote as t t in this case as both op and corr are functorial and are right adjoints see section 2 1 1 they commute with limits so that the assignment z cop 7 t z co corr op will also be a sheaf and representable in t we will denote this operadic object as t co corr in this case the compatibilities between the different brane actions when x varies are encoded by the following result proposition 2 2 4 let t be an topos and let m be an operad in t satisfying the assumptions in the beginning of this section then there exists a map of operads in t m t co corr encoding the brane action informally described as follows given z c it sends an active map m z to the operation given by the diagram 2 2 5 before giving the proof of this proposition let us recall a technical fact which will be used several times throughout the paper remark 2 2 5 let x sop be a cocartesian fibration between 1 categories clas sifying a functor p sop cat then the cartesian fibration that also classifies p cart p s can be obtained as follows define a new simplicial set y over s op such that maps of simplicial sets over sop mapsop t y are in bijection with maps of simplicial sets brane actions categorification of gromov witten theory and quantum k theory 23 map t sop y s in particular an object of y over a vertice s s op is just a presheaf on xops let y 0 y be the full subcategory of y spanned by those vertices corresponding to representable presheaves and let y op 0 s denote the opposite of the projection y s op then this map is a cartesian fibration that classifies p conversely if x s is a cartesian fibration classifying a diagram p then the cocartesian fibration classifying the same diagram can be obtained by applying these steps to the cocartesian fibration op and then taking the opposite of the output proof of prop 2 2 4 as t co corr is a sheaf the data of a morphism of operadic sheaves m t co corr equivalent to the data of a morphism in fun cop op using the ad junctions fun cop calg cat fun cop op envoo and fun cop calg cat corr fun cop calg cat twpp this is the same as the data of a natural transformation tw env m t op but as in 2 1 7 this is the same as a natural transformation in fun cop cat 2 2 6 tw env m t op objectwise satisfying the conditions of a weak cartesian structure and the conditions of the cor 2 1 3 it will be more useful now to see them as functors top cat via kan extension in this case to give 2 2 6 is equivalent to construct a map between their associated cartesian fibrations over t 2 2 7 cart tw env m cart t op xxqqq qq qq qq qq q t preserving cartesian edges here the symbol cart denotes the unstraightening construction of lur 09 chapter 3 we now remark that the cartesian fibration cart t op t can be described by applying the discussion in the remark 2 2 5 to the cocartesian fibration x cocart t op sop top but this we can easily see verifies canonically cocart t op cart t op where now cart t t is the cartesian fibration classifying the categorical sheaf x 7 t x for this one we have an explicit description namely it is given by the evaluation map ev 1 fun 1 t t see lur 09 5 2 2 5 therefore and using the notations of the remark 2 2 5 we have cart t op y op 0 so that the data of a map 2 2 7 is uniquely determined by the data of a functor 24 etienne mann and marco robalo 2 2 8 cart tw env m op sop x op s which unwinding the notations can be written as 2 2 9 cart tw env m t fun 1 t s op or in other words as the data of a fiberwise over t left representable right fibration 2 2 10 b t m cart tw env m t fun 1 t we will now explain how to construct the correct right fibration first we let bm denote the image of m through the composition 2 2 11 op t fun t op cat b fun top funrf 1 s ev 0 fun top cat where b is the functor constructed in section 2 1 3 by construction bm comes equipped with a natural transformation 2 2 12 bm tw env m and the transition maps preserve cartesian edges in this case it is an easy exercise to see that the map induced between their associated cartesian fibrations 2 2 13 cart bm cart tw env m is again a right fibration let now x s be a generic cartesian fibration between 1 categories and let fun 1 x cart denote the full subcategory of fun 1 x spanned by the cartesian edges then it is also an easy exercise to check that the natural map 2 2 14 fun 1 x cart x s fun 1 s sending x y 7 y x y is an equivalence of 1 categories indeed the fact that it is fully faithful follow from the definition of cartesian edges using the characteriza tion of cartesian edges via the mapping spaces of lur 09 2 4 1 10 2 and the fact that it is essentially surjective follows from the definition of cartesian fibration in this case it admits a section s brane actions categorification of gromov witten theory and quantum k theory 25 back to our situation we apply this discussion to the cartesian fibrationx cart tw env m s t and composing the section s with the evaluation at 0 we obtain a map 2 2 15 cart tw env m tfun 1 t fun 1 cart tw env m cart cart tw env m finally we define the right fibration b t m in 2 2 10 to be the pullback 2 2 16 b t m cart bm cart tw env m t fun 1 t cart tw env m it is clear from the construction that the fiber over an object over z u y z is the space of extensions ext u in m y in the case when consists of a single active map n 1 in m z classified by a map z mn in t then we have canonical identifications 2 2 17 ext u mapy y c z y mapz y c where c is defined as in 2 2 3 more generally if classifies a list of active maps i ni 1 in m z corresponding to maps i z mni then by the defining properties of extensions and because u is a map of operads we have ext u i ext u i which we can write as 2 2 18 map z y c n i 1 map z y c i where we set 2 2 19 c i c i in t z as we can always assume y to be affine and therefore absolutely compact the formula 2 2 18 gives us the representability condition specified in the remark 2 2 5 to conclude let us remark that the map 2 2 7 thus obtained preserves cartesian edges indeed if is a cartesian edge in cart tw env m over a map f z z by definition this means that f by construction we then have c c z z which is exactly what characterizes cartesian edges in cart t op it remains to show that the map 2 2 6 produced by this construction indeed satisfies 1 the conditions of weak cartesian structure and 2 the conditions of the corollary 2 1 3 objectwise but 1 follows from the formulas 2 2 19 and 2 from the fact that as m is coherent the compositions are classified by pushouts as in the formula 2 2 4 26 etienne mann and marco robalo remark 2 2 6 to conclude this section let us mention that as in the remark 2 1 8 and thanks to the yoneda s lemma to check that a monochromatic unital operad m in t having a single color with m z cz cz is coherent it is enough to check that for every n 2 and m 2 the composition diagram in t mn mm 1 m 2 mn mn mn 1 mn mn m mn mm mn m 1 is a pullback diagram 2 2 2 from co spans to spans in this section we explore the content of the remark 2 1 10 in the case when we fix an object e t and consider branes mapping to e as in the remark fixing e we have a natural strongly monoidal map of operads in t rhom e t co corr t corr mapping the induced coproduct structure in co spans to the product structure in spans 8 we can now compose with the brane action of the prop 2 2 4 to produce a map of operads 2 2 20 m t co corr t corr intuitively this map is defined by the formula sending an operation z mn to rhom z n z m 2 e z rhom z c e z oo rhom z z m 2 e z tt z where c is the pullback c z mn mn 1 mn 1 z mn this correspondence is of course equivalent to 2 2 21 ne m 2 z rhom z c e z oo em 2 z vv z where em 2 rhomt m 2 e in this case and using the adjunction z t t z 2 2 21 is equivalent to the data of a correspondence in t 8 this is indeed a strongly monoidal map of operads because t is an topos brane actions categorification of gromov witten theory and quantum k theory 27 2 2 22 rhom z c e z uu pp pp pp pp pp pp p ne m 2 z em 2 again by yoneda we have a universal diagram when z mn and is the identity map 2 2 23 rhom mn mn 1 e mn tt ne m 2 mn e m 2 so that for any x mn the correspondence assigned to is the pullback of this universal one along remark 2 2 7 using the discussion in the remark 2 2 5 and the arguments in the beginning of the proof of the prop 2 2 4 the composition 2 2 20 is determined by the data of a fiberwise over top left representable left fibration 2 2 24 b t m e cocart tw env m top fun 1 t op where cocart tw env m top is the cocartesian fibration classifying the categorical presheaf tw env m and fun 1 t op top is the opposite of ev 1 indeed to define a natural transformation tw env m t is equivalent to have a map between their associated cocartesian fibrations 2 2 25 cocart tw env m pp pp pp pp pp pp p cocart t xxrr rr rr rr rr t op that preserves cocartesian edges applying the discussion in remark 2 2 5 to the cocartesian fibration x cart t op top such a map is equivalent to a functor 2 2 26 cocart tw env m top fun 1 t op s or in other words to a left fibration 2 2 24 informally speaking the fiber over over z u y z is the mapping space mapz y rhomz c e z 2 3 brane actions for graded operads in this section we discuss the notion of graded operads and explain how to construct graded brane actions we will first deal with graded operads in spaces and at the end of the section we explain how to extend these results to graded operads in a topos 28 etienne mann and marco robalo 2 3 1 graded operads and graded brane actions intuitively a graded operad is an operad o n fin such that for every n 0 the space of operations mapo act x 1 xn y has a natural decomposition b map o act x 1 xn y where b is a monoid in sets in other words every operation is indexed by some b moreover if x y is an active map of degree and for 1 i n i zi xi are active maps of degree i then the composition izi y is of degree i i in order to formalize this idea given b we will construct an operad in spaces n finb n fin which essentialy adds gradings to the morphisms in n fin then we define a graded operad to be an operad o equipped with a map of operads o n finb construction 2 3 1 let b be a monoid in sets with indecomposable zero 9 we define a category finb as follows 1 its objects are the objects of fin 2 a morphism n m is a pair f where f is a map in fin from n m and is a function m b 3 the composition is dictated by the following rule given f n m and g m k then k b is defined by the formula i i if g 1 i i j g 1 i j otherwise it is clear from this definition that the composition law is well defined it is also clear that finb has a forgetful functor fin b fin which simply forgets the grading functions proposition 2 3 2 let b be a monoid with indecomposable zero then the map n finb n fin is an operad proof we verify the three conditions of lur 16 b 2 1 1 10 1 every inert morphism f n m n fin has a cocartesian lifting indeed we can lift f by choosing the grading given by the zero function f 0 the grading has to be zero because of the fact b has indecomposable zero it is easy to see that this is a cocartesing lifting given u n k and a commutative diagram in fin n u f m g k we can show that there exists a unique dotted arrow in n finb 9 recall that indecomposable zero means that if b are such that 0 then both and are zero brane actions categorification of gromov witten theory and quantum k theory 29 n u f 0 m g k that makes the diagram commute choose 2 fixing f n m we have map f n finb n m i m map i f n finb n 1 where i m 1 is the inert map that sends i 1 and all the others to 0 in this case we have map f n finb n m f homsets m b f homsets i m 1 b i m f homsets 1 b i m b which is equivalent to i m i f homsets 1 b i m map i f n finb n 1 3 n finb n n fin b n 1 this is obvious from the definition remark 2 3 3 it follows from the construction and from the assumption that b has inde composable zero that a map f in finb is an isomorphism if and only if 0 and is an equivalence moreover it is also clear that a map in finb is inert lur 16 b def 2 1 2 3 if and only if it is inert in fin and its grading function is zero the same for semi inert morphisms definition 2 3 4 let b be a monoid in sets with indecomposable zero a b graded operad is a map of operads p o n finb remark 2 3 5 as the inert morphisms in n finb are exactly the inert morphims of n fin endowed with a zero grading thanks to the remark 2 3 3 any map of operads o n finb is a fibration of operads 10 in particular and thanks to lur 16 b 2 1 2 22 our definition 2 3 4 is equivalent to the data of an 1 category o together with a map to n finb satisfying the obvious graded analogues of lurie s definition of operads lur 16 b 2 2 1 10 10 see lur 16 b 2 1 2 10 for the definition of fibration of operads 30 etienne mann and marco robalo there exists a combinatorial simplicial model structure in the category of marked simplicial sets over n finb such that the fibrant objects are exactly b graded operads 11 we let opb gr denote its underlying 1 category it is clear from the definition that we have opb gr op n fin b notice also that we have a functor 2 3 1 opb gr op that forgets the graded structure and admits a right adjoint namely the pullback along the map n finb n fin this functor admits a section that sees an operad as a graded operad with zero gradings remark 2 3 6 there is also a dendroidal approach to graded operads indeed we can define a category b of trees where each vertice v comes with the extra data of an element v b and the morphisms of contraction sum the s a graded dendroidal segal object in spaces is then an functor n b op s satisfying the analogue of the segal conditions for dendroidal spaces one can show that the 1 category funsegal n b op s is equivalent to opb gr indeed consider the equivalence op fun segal n op s and remark that the last is also equivalent to the full subcategory of cat n spanned by those functors that are right fibrations and satisfy the segal condition after the grothendieck construction in this case the operad finb produces a right fibration over n whose fibers are discrete spaces its total category can be identified with b and the map b is just the functor that forgets the gradings of the vertices following this discussion we have a chain of equivalences 2 3 2 opb gr op n fin b cat rf segal n n b fun segal n b op s we now discuss the notion of coherent operad lur 16 b in the graded setting this time we want the extensions to fix the gradings let o n finb be a graded operad given an active morphism x y o over f n m m b we want to study the space ext of all active morphisms x x 0 y such that the composition with the semi inert map x x x 0 is and is also of degree as discussed in the remark 2 3 3 every semi inert map in finb must have zero grading this condition forces the grading function of any extension to be necessarily equal to the one of so that the definition of the space of extensions ext is just the same ext as in the non graded case lur 16 b 3 3 1 4 3 3 1 9 it is also obvious from this that the coherence of a graded operad is determined by the coherence of its underlying operad let o be a b graded coherent operad let us now deal with the construction of brane actions for o compatible with the gradings for that purpose we need to construct a map of b graded operads 11 for instance one can use the theory of categorical patterns of lur 16 b appendix b as in the proof of lur 16 b 2 1 4 6 brane actions categorification of gromov witten theory and quantum k theory 31 2 3 3 o p s co corr n fin n fin b uu n finb but using the adjunction 2 3 1 this is the same as a map of operads o sco corr coprod where we forget the grading of o in other words a diagram o b p s co corr n finb n fin sending inert morphism to inert morphisms but as inert morphisms in finb have always zero grading being inert in the graded sense is equivalent to being inert when we forget the gradings following this discussion the construction of brane actions can be performed exactly as in thm 2 1 7 corollary 2 3 7 let o be a b graded operad such that its underlying operad is unital coherent has a unique color c with o 1 0 and o 1 for 6 0 then there exists a map of b graded operads 2 3 3 encoding the brane action for o the functoriality arguments of section 2 1 3 carry over to the graded context providing an functor b opb gr op fun rf 1 cat sending o 7 bo tw env o 2 4 graded operads in a topos and brane actions the arguments of section 2 2 carry over to the context of b graded operads in an topos t sh c which as in section 2 2 we can define as objects in sh c opb gr one can also combine the ar guments of section 2 3 1 and 2 2 to produce brane actions for a graded coherent operad m sh c opb gr as in 2 2 and as m is monochromatic we can think of m as a collection of objects in t mn n 0 b with the following universal property for each z c we have canonical equivalences m z n map m z act cz cz cz mapt z mn and again by yoneda the composition laws of m are represented by maps in t mn mm mn m 1 32 etienne mann and marco robalo satisfying the expected coherences up to homotopy to construct the associated brane action we can proceed as in the section 2 2 and obtain a map of b graded operads in t m t co corr n fin n fin b which as in the proof of the prop 2 2 4 sends an operation z mn to the object 2 4 1 c z mn mn 1 in t moreover the same arguments of sections 2 2 2 tell us that the brane action of a graded operad m with respect to a fixed target e m t co corr n fin n fin b t corr n fin n fin b informally given by the assignment 12 z mn 7 rhom z c e z is induced by universal correspondences in t of the form 2 4 2 rhom mn mn 1 e mn tt ne m 2 0 mn e m 2 0 3 stable actions from now on t will denote the topos of derived stacks dstk over a field of characteristic zero k with respect to the e tale topology we set c dstaffk as a notation for the 1 category of derived affine schemes 3 1 the operad m of costello and its brane action 3 1 1 the stacks m 0 n of costello here we follow cos 06 let x be a smooth projective variety and let b ne x h 2 x z be the mori cone of x generated as a monoid by the numerical classes of irreducible curves in x the mori cone satisfies the following properties 1 ne x has indecomposable zero 0 implies 0 2 ne x has finite decomposition for every ne x the set 1 2 ne x ne x 1 2 is finite the mori cone will play the role of the semi group in cos 06 and will be our grading monoid b we will use the definition of the pre stack in 1 groupoids m 0 n of cos 06 it classifies possible unstable connected nodal genus 0 curves c with n marked smooth points and an 12 see the remark 2 2 7 brane actions categorification of gromov witten theory and quantum k theory 33 index i b attached to each irreducible component ci moreover we impose the following stability conditions i i if i 0 then ci has at least three special points meaning marked or nodal points the stability conditions of cos 06 section 2 force m 0 1 0 and m 0 2 0 remark 3 1 1 notice that if 0 then m 0 n is the usal deligne mumford stack of stable curves m 0 n in particular m 0 3 0 classifying p 1 with three marked points the following proposition summarizes the main features of the pre stacks m 0 n proposition 3 1 2 the following holds 1 for all n 0 and b the pre stack m 0 n is a smooth and proper algebraic stack in 1 groupoids locally of finite type and non separated 2 forgetting the last marked point and stabilising the curve gives a proper separated morphism m 0 n 1 m 0 n which is the universal curve when n 3 proof cos 06 pag 2 propositions 2 0 2 and 2 1 1 remark 3 1 3 as the universal family is flat the properties 1 and 2 combined mean that the object c associated to a map z m 0 n and given by the fiber product in derived stacks 2 4 2 is the same as the fiber product computed in usual stacks and therefore corresponds exactly the curve over z classified by when n 3 when n 2 c z 3 1 2 the collection m 0 n n n b as a graded operad in derived stacks we will now use the moduli spaces of costello to construct a graded operad in stacks more precisely we take the collection m 0 n n 3 b together with ad hoc spaces of unary and nullary operations replacing the role respectively of m 0 2 and m 0 1 we have to do this in order to produce a graded operad that to which we can apply our brane action and this requires the spaces of nullary and unary operations to be contractible therefore we introduce the stacks m fake 0 2 0 m fake 0 1 0 which we think respectively as a p 1 with two resp one marked points and considered only with the identity automorphism moreover we also set m fake 0 2 m fake 0 1 for 6 0 by imposing this we will have to modify the gluing operation of curves see below we now remark that the collection m 0 n n 3 b m fake 0 2 m fake 0 1 forms a b graded symmetric operad in derived stacks we proceed as follows recall that the 1 category of stacks in groupoids embeds fully faithfully in the 1 category of derived stacks dstk 13 in general this inclusion commutes with colimits but not with products however the compatibility with products holds when the stacks involved are smooth as smoothness implies flatness which means the derived tensor product is isomorphic to the ordinary one 13 compose with the nerve functor from groupoids to simplicial sets and take the kan extension along the inclusion affclassic daff 34 etienne mann and marco robalo in our case smoothness follows from the prop 3 1 2 therefore it will be enough to show that the family m 0 n n 3 b m fake 0 2 m fake 0 1 forms a b graded operad in classical 1 stacks intuitively the composition operation corresponds to gluing curves along the marked points the last point is thought as the output of the operation for this we need to make a shift in our notations we set 3 1 1 m n m 0 n 1 if n 3 and 3 1 2 m 1 mfake 0 2 and m 0 m fake 0 1 and with this definition we have m 0 m 1 0 proposition 3 1 4 the collection m n b n n forms a unital b graded symmetric operad in classical 1 stacks the unit is the unique element of m fake 0 2 0 given by a p 1 with two marked points moreover as m 2 0 m 0 3 0 is the moduli of stable curves with 3 marked points it is contractible proof the proof is the same as remarked in gk 98 composition is given by gluing curves along marked points to force the fake projective space with two marked points to be the identity one declares the maps m 0 n m fake 0 2 0 m 0 n to be the identity the operad is unital as mfake 0 1 0 is contractible and m fake 0 1 is empty for 6 0 the maps m 0 n 1 m 0 n n 3 corresponding to the composition with the nullary operation in mfake 0 1 0 are declared to be obtained by forgetting the last marked point and stabilizing if n 2 and 6 0 there is no such map in this operad remark 3 1 5 the necessity of replacing m 0 2 0 by its fake version m fake 0 2 is related to our conditions for the existence of a brane action as it requires the space of unary operations to be contractible by using this fake version we will essentially lose the moduli spaces of stable maps with two marked points as we shall see below this is not relevant in the structure of the quantum product but it is rather crucial to explain the lax structure of our gromov witten action as we shall see in the next section the lax associativity is controlled by these two marked stable maps this b graded operad in classical smooth 1 stacks can be written as a graded dendroidal segal object see the remark 2 3 6 with values in stacks in 1 groupoids sending a graded tree t n op b to the stack v vert t m 0 n v v where n v is the number of edges attached to the vertice v and v is the grading of the vertice v this satifies the segal conditions and as the inclusion of smooth stacks in derived stacks is monoidal for the cartesian product we find that the collection m n n forms a monochromatic unital b graded operad in derived stacks we will denote it as m remark 3 1 6 given an object z c the graded operad in spaces m z n finb verifies map m z act cz cz cz mapt z m n mapt z m 0 n 1 brane actions categorification of gromov witten theory and quantum k theory 35 it is also important to remark that by definition of the operadic structure in the moduli spaces of costello the composition of two active morphisms in m z n f m g 1 corresponds to a gluing of curves over z more precisely if f classifies a family of curves over z cif i m with c i f with grading i and g classifies a curve cg with grading then the composition g f classifies the curve of total grading i obtained by gluing the last marked point of the cif to the i marked point of cg contrary to what the reader could expect at this point the operad m althought it satisfies all the conditions in a pag 20 it is not coherent this occurs essentially because if and are two composable operations classifiying two curves c and c the gluing of these two curves along a marked point which classifies the composition c is not equivalent to the pushout c c in the 1 category of derived stacks as expressed in the remark 2 2 2 indeed the inclusion of schemes in derived stacks does not commute with pushouts in general even along closed immersions all we have is canonical map c c c sch c c neverthless part of the proof of the theorem 2 1 7 still makes sense namely we don t need coherence to have the natural transformation 3 1 3 tw env m t op remark 3 1 7 this map sends an operation consisting of a single active map over z to c as defined in the formula 2 4 1 moreover it sends a twisted arrow to a map c c thanks to the description of compositions in m z as gluing of curves see the remark 3 1 6 we known that the data of a morphism in tw env m z consists of a way to express c as obtained from c by attaching some components determined by for simplicity consider the case where is encoded by a commutative diagram 14 3 1 4 n u m 1 1 the commutativity of this square in m z means that in fact the curve c classified by is equivalent in this case isomorphic to the curve obtained from the curve c classified by by attaching the curves ciu i m classified by u this pushout in schemes attaches the last marked point of ciu to the i marked point of c the commutativity of the diagram is given by the data of an equivalence between c and the result of this gluing in this case the canonical map c c can be naturally identified with the inclusion composed 14 in fact we can always reduce to this case 36 etienne mann and marco robalo with the main problem with 3 1 3 is that it doesn t satisfy the conditions of the cor 2 1 3 but in fact to our purposes this is not a real issue in fact although the map is not an equivalence in t if we take e x the smooth projective variety fixed at the beginning of this section we know that rhom x will see as an equivalence indeed this follows from the characterization of pushouts of schemes along closed immersions in terms of pullbacks for quasi coherent sheaves via tannakian duality more precisely we can use the results of bhl 15 thm 1 4 and lur 11 b thm 7 1 to obtain the criterion of bha 16 more generally following loc cit and hr 14 p 4 we could also take x to be a perfect stack in the sense of bzfn 10 in this case the composition with the natural transformation rhom x tw env m t op t gives a map satisfying the conditions of the corollary 2 1 3 and therefore a map of operads m t corr corollary 3 1 8 let x be a smooth projective algebraic variety then x is an m algebra the algebra structure is encoded by the correspondences 3 1 5 rhom m 0 n 1 m 0 n 2 x m 0 n 1 ss xn m 0 n 1 x 3 2 the stable sub action of m we now want to consider a certain sub action of the one constructed in the previous section following the prop 3 1 2 and the remark 3 1 3 the stack m 0 n 1 is the universal curve over m 0 n in this case the derived stack rhom m 0 n m 0 n 1 x m 0 n classifies pairs c f where c is classified by m 0 n and f is a map f c x inside this stack there is an open sub stack rm 0 n x in fact a connected component that classifies stable maps to x of total degree f c see stv 11 def 2 7 moreover by loc cit we know that this stack is a proper derived deligne mumford stack which is quasi smooth the reason we are interested in the derived stack rm 0 n x is the fact that its structure sheaf is the origin of all the virtual phenomena in gromov witten theory we will come back to this later on for now we are merely interested in producing a new brane action a stable action where the universal correspondences 3 1 5 are replaced by 1 2 1 where the arrows are obtained by composition the maps of 3 1 5 with the open immersion rm 0 n x rhom m 0 n m 0 n 1 x m 0 n our goal in this section is to show that this restriction still carries all the coherences defining an action of m we start with the brane action to the fixed target x encoded by the map of b graded operads in t m t corr n fin n fin b brane actions categorification of gromov witten theory and quantum k theory 37 of the corollary 3 1 8 by adjunction this is the same as a map of operads in t m t corr which by repeating the arguments in the remark 2 2 7 is given by a fiberwise over top left representable left fibration 3 2 1 b t m x x cocart tw env m top fun 1 t op whose fiber over 1 n over z u y z can be described as the mapping space mapz y rhomz c x z where now c is the coproduct ic i where each c i is defined as in the formula 2 4 1 to construct the stable action we consider the full subcategory bstb t m x b t m x whose fiber over an object 1 n over z u y z is spanned by those maps 3 2 2 y rhomz c x z ww z such that for each i the map y rhomz c i x z factors through the open su bstack in fact connected component rhomstbz c i x z classifying families of maps c i fi z x z such that for each geometric point z of z the base change fz satisfies fz c i z i in co homology here i is the degree associated to the active map i it follows from the definition of m 0 n that such fi are necessarily stable maps in particular when z m 0 n and is the identity of the unique color we see that the derived stack rhomstb m 0 n m 0 n 1 z x is exactly the derived enhancement of the stack of stable maps m 0 n x of stv 11 def 2 7 the main result of this section is the following proposition 3 2 1 the composition 3 2 3 bstb t m x b t m x cocart tw env m top fun 1 t op is a fiberwise in top left representable left fibration moreover it defines a new map of b graded operads in t 3 2 4 m t corr n fin n fin b 38 etienne mann and marco robalo explicitely given by the correspondences in the formula 1 2 1 we will call it the stable brane action proof let t over z u y z over z v y z be a morphism in cocart tw env m top fun 1 t op over a map f z z in top and let 3 2 5 y z c x z z be an object in bb gr stb t m x over over z u y z as part of the data of t we are given a commutative diagram in t 3 2 6 y v y u z f z and by construction of x cocartesian liftings of t are given by first taking the base change of the diagram 3 2 7 under f z z 3 2 7 y z c z z y z z z cf x z z and then composing with the canonical map y y z z the conclusion now follows because the pullback of a family of stable maps is stable as stability is determined at the level of geometric points to conclude the proof we have to justify why 3 2 3 provides again a map of operads the condition of weak cartesian structure follows by the arguments used in the proof of the prop 2 2 4 the tensor structure in tw env m z corresponds to the disjoint union of curves the conditions of the corollary 2 1 3 follow because the compositions of operations are classified by the gluings of curves along marked points as in the formula 2 2 4 and the gluing of stable maps is stable as stability is a local condition 3 3 gromov witten lax action so far we have been using the operad m that assembles the moduli stacks of costello the reason is merely technical it provides a natural context where the moduli of stable maps appears as part of the brane action one would now like to extend this to an action of the usual operad of stable curves provided by the family of smooth and proper deligne mumford stacks of stable curves with marked points m 0 n the composition operation is given by gluing curves along the marked points as in m it is well known after gk 98 and km 99 section 1 3 9 that this family forms a symmetric unital brane actions categorification of gromov witten theory and quantum k theory 39 operad in 1 stacks by declaring m 0 2 to be a point thought of as a copy of the projective space with two marked points and only the trivial automorphism and by modifying the composition law by performing stabilizations after gluing the curves as in section 3 1 2 and repeating the shifting of notations in the formula 3 1 1 this provides an operad in the topos of derived stacks which we will denote as m we will leave it to the reader to verify that the canonical maps m 0 n m 0 n given by stabilization assemble to a map of graded operads in 1 stacks and as these are smooth to a map of graded operads in derived stacks more precisely this is a map of b graded operads in t m m n fin n fin b which by the adjunction 2 3 1 we can also write as a map of operads 3 3 1 stb m m given by the maps m 0 n m 0 n our goal in this section is to explore the interaction of the stable action 3 2 4 with this stabilization morphism our main result is the theorem 1 1 2 written in a somewhat less natural language to present the results as written in the theorem 1 1 2 one would need many aspects of the theory of 2 categories that are not yet available in the literature we found a way to avoid those aspects that allows us to still give a precise statement while remaining in the setting of 1 categories and without changing the content at the cost of a less evident formulation to explain the result the first observation is that the sheaf of operads in t given by t corr is in fact the 1 categorical truncation of a sheaf of symmetric monoidal 2 categories 3 3 2 spans t z top 7 spans t z this follows from the same arguments as for correspondences as the construction of spans commutes with products see hau 14 we claim that any such sheaf can be presented as a sheaf of categorical operads in t re call from toe 13 that a categorical operad in spaces is an functor op cat satisfying the segal conditions of course the inclusion s cat produces a fully faithful functor op op cat fun segal op cat informally speaking these correspond to multi categories where the collections of n ary operations form 1 categories a natural source of categorical operads in spaces are symmetric monoidal 2 categories let c be a sym metric monoidal 2 category one can define a categorical operad as follows to a corolla tn one assigns the disjoint union of 40 etienne mann and marco robalo x 1 xn y map c x 1 xn y where the x 1 xn y runs over all the lists of n 1 objects in c and mapc is the 1 category of maps in c for a general t one imposes the segal conditions this construction can be made functorial using the tensor products in c for the moment being we will avoid to give a precise construction of this assignment and we will just assume it has been constructed we hope to give a precise construction in a later version of this project in this case we can exhibit the data of spans t as a limit preserving functor t op op cat which we will again denote as spans t at the same time both m and m can be presented as categorical operads via the inclusion t op op op cat and the map of operads in t encoding the brane action m t corr is equivalent via the universal property of the 1 categorical truncation to a map of categorical operads m spans t that factors through the maximal 1 category as a result we find a correspondence of categorical operads in t 3 3 3 m m oo spans t using the grothendieck construction each categorical operad in t can also be presented as a bifibration over op t and the maps of operads in 3 3 13 produce maps that preserve t cartesian edges and op cocartesian edges ie the segal conditions 3 3 4 m r m q stboo spans t p vv op c we can now present our formulation of the theorem 1 1 2 theorem 3 3 1 there exists an functor 3 3 5 m r spans t p vv op t given informally as follows for each z c and for each corolla tn it sends a curve z m 0 n to the correspondence brane actions categorification of gromov witten theory and quantum k theory 41 3 3 6 nx z rm 0 n x m 0 n z oo x z uu z moreover this map does preserve cartesian edges with respect to the projection to t but does not preserve cocartesian edges with respect to op proof we construct the required functor as a relative left kan extension 3 3 7 m stb spans t p m r 77 t op in order to proceed we remark that p is in fact a locally cocartesian fibration so far p was constructed as a bifibration cocartesian with respect to op and cartesian with respect to t given a corolla tn op and z t the fiber of p over tn z is given by a comma category in the topos theory where the relavant part is the category mapspans t z nx z x z we now remark that in fact the cartesian fibration defined by taking the fiber over a corolla tn spans t op tn t is in fact a bicartesian fibration indeed as the the cartesian structure is given by base change the bicartesian structure is given by the left adjoint of the base change meaning the composition functors we are in the following situation 1 the composition spans t t op is a cartesian fibration 2 for each z t the projection spans t t z op is cocartesian 3 the fiber over a corolla tn spans t op tn t is a cocartesian fibration via the forgetful functor it follows then from the same arguments as in lur 16 b 4 5 3 4 using the segal conditions instead of the inert cocartesian liftings that p is a locally cocartesian fibration it follows then by lur 09 4 3 1 10 that p colimits are colimits in the fibers that remain colimits under change of fiber via p locally cocartesian morphisms as the forgetful functors between comma categories in a topos commutes with colimits and the cocartesian liftings of maps in op are given by taking pullbacks in a topos thus also commuting with colimits it follows that p admits all p colimits this is enough to deduce the existence of a lifting map as in the diagram 3 3 7 using the existence theorem lur 09 4 3 2 13 and the results of lur 09 section 4 3 3 one must now show that this relative left kan extension gives back the formula in the statement of the theorem for this we make a second preliminary observation that in fact the functor stb m m 42 etienne mann and marco robalo admits a right adjoint relatively to the projection to op indeed this follows from a dual version of lur 16 b 7 3 2 6 as for each corolla tn op we have canonical identifications m op tn t m 0 n and m op tn t m 0 n and as stb is given by the composition with the stabilization map m 0 n m 0 n it has a right adjoint given by pulling back also along the stabilization map combined with the arguments in the proof of lur 09 4 3 3 9 as both projections to op are cocartesian fibrations this implies that for for each in m over z t the comma category m is equivalent to the comma topos t z m 0 n m 0 n and the formula for the p relative kan extension sends to the colimit in the fiber over z colimz m 0 n m 0 n z forget hom stb z c x z where forget is the functor that sees an object over z as an object over z along the compo sition with u this is the same as colimz m 0 n m 0 n z forget rm 0 n x m 0 n z which as the forgetful functor is a left adjoint is the same as forget colimz m 0 n m 0 n z rm 0 n x m 0 n z forget colimz m 0 n m 0 n z rm 0 n x m 0 n z m 0 n m 0 n z m 0 n m 0 n z forget rm 0 n x m 0 n z m 0 n m 0 n z m 0 n m 0 n colimz m 0 n m 0 n z z forget rm 0 n x m 0 n z z m 0 n m 0 n z m 0 n m 0 n forget rm 0 n x m 0 n z it is immediate to see from this description that this map preserves cartesian edges rela tively to t moreover it is also clear that it is defined over op as both stb and the brane action are and the pt cocartesian structure is defined fiberwise relatively to op we will now explain why it does not preserve cocartesian edges relatively to op to simplify the notations let us write 3 3 8 rm 0 n x rm 0 n x m 0 n z brane actions categorification of gromov witten theory and quantum k theory 43 for z m 0 n let t be a tree in consisting of a gluing of a corolla tn 1 to a corolla tm 1 where the root of tn 1 is attached to the first leaf of tm 1 then because of the segal condition we can think of an object in m over t z as a pair of composable curves over z where has n marked points and has m marked points then by the previous discussion the relative kan extension sends the object over t z to the pair of arrows rm 0 n x x n rm 0 m x x m here we use again the segal condition for spans t to identify objects over t z as pairs by definition a r cocartesian lifting for the contraction map tn m 2 z t z in gives the gluing of the two curves its target is sent to the map rm 0 n m 2 x x n m 2 while by definition of the cocartesian fibration p relatively to op a p cocartesian lifting of the same contraction map has target the map rm 0 n x x rm 0 m x x n m 2 the universal property of p op cocartesian morphisms then gives us a canonical map rm 0 n x x rm 0 m x rm 0 n m 2 x which corresponds to the gluing of the two stable maps this is not an equivalence in general following the terminology of toe 13 we will say that this map obtained in the theorem is a very lax map of categorical operads from m to spans t and we will denote it as m spans t unwinding the definitions this encodes the coherences of an action given by universal correspondences 3 3 9 rm 0 n x xxqq qq qq qq qq q m 0 n x n and satisfying a lax associative law given by the gluing maps 3 3 10 m 0 n m 0 m rm 0 n x rm 0 m x oo xn xm xn 1 x x xm 1 m 0 n m 0 m rm 0 n x x rm 0 m x q oo xn 1 x xm 1 idn 1 idm 1 oo m 0 n m 0 m rm 0 n m 2 x m 0 n m 2 m 0 n m 0 m x oo xn 1 x xm 1 idn 1 idm 1 m 0 n m 2 rm 0 n m 2 x oo xn 1 xm 1 which are non invertible remark 3 3 2 let us also remark that all the derived stacks involved in this action are derived geometric stacks this follows from tv 08 1 3 3 4 1 3 3 5 which shows that the notion of being n geometric is local stable under pullbacks and in particular closed under small disjoint 44 etienne mann and marco robalo unions another important consequence of this is that we have the base change formula for the two pullback squares in the diagram see dg 11 cor 1 4 5 or hlp 14 b 15 to conclude this section we will also show that our lax action admits a graded version this will be more useful to us in the next sections indeed we can start with the correspondence of graded operads 3 3 11 m n fin n fin b m oo t corr n fin n fin b and replacing the category of trees by the category b of the remark 2 3 6 we can consider the corresponding notion of graded categorical operads in t the definitions apply mutatis mutandis like in 3 3 13 we have a correspondence of such objects which using the grothendieck construction we can exhibit as bifibrations 3 3 12 m n fin n fin b r m q oo spans t n fin n fin b pb tt op b t we have the following graded version of the lax action proposition 3 3 3 there exists an functor 3 3 13 m n fin n fin b r spans t n fin n fin b p tt op b t given informally as follows for each z c and for each corolla tn it sends a curve z m 0 n together with the choice of an element to the correspondence 3 3 14 nx z rm 0 n x m 0 n z oo x z vv z moreover this map preserves cartesian edges relatively to t but does not preserve cocarte sian edges relatively to the direction proof the proof follows from the same arguments as in the theorem 3 3 1 in this case the lax structure is given by the gluing maps rm 0 n x x rm 0 m x rm 0 n m 2 x m 0 n m 2 m 0 n m 0 m brane actions categorification of gromov witten theory and quantum k theory 45 where rm 0 n x is the open component of rm 0 n x consisting of all stable maps with total degree 4 categorification of gw invariants and quantum k theory 4 1 categorification we know from the theorem 1 2 2 that any smooth projective alge braic variety x seen as an object in correspondences carries a natural action of the graded operad m we now explain how to extend this action to the derived category of x and that this action restricts to both perfect and coherent complexes let sp denote the symmetric monoidal 1 category of spectra and let d k modk sp denote the categorical version of the derived category of k with its standard symmetric monoidal structure we set dgcatcontk modd k pr l stb where prlstb is the 1 category of stable presentable 1 categories moreover we observe that the site c dstaffk is equivalent to calg d k 0 for the natural t structure in sp in this case and following grb section 3 1 taking modules defines a lax monoidal functor mod cop calg dgcatcontk informally described by the formula a 7 moda d k moda sp thanks to tv 08 thm 1 3 7 2 this functor has fpqc descent and therefore by kan extension provides a limit preserving functor qcoh top calg dgcatcontk one can also consider the compositon c op qcoh calg dgcatcontk mod dgcat cont k calg catbig which thanks to gai appendix a or toe 12 b remark 2 5 satisfies fppf descent here catbig denotes the very large 1 category of not necessarily small 1 categories again it can be kan extended to a limit preserving functor dgcatcont top calg catbig we start this section with the construction of a lax monoidal map of 1 categories over t 4 1 1 t op dgcatcont informally given by the following formula for z c the map t z op dgcatcont z sends f y z to the 1 category qcoh y seen as a qcoh z module via the action by f qcoh f consider first the functor fun 1 top fun 1 calg dgcatcontk obtained by com position with qcoh now recall now from lur 16 b section 3 3 3 the construction of a 46 etienne mann and marco robalo generalized operad mod dgcatcontk calg dgcatcontk n fin whose fiber over v 1 calg dgcatcontk n fin is modv dgcat cont k in general an object in mod dgcatcontk over 1 can be thought of as a pair v m where v is a presentable sta ble k linear symmetric monoidal 1 category and m is another presentable stable k linear 1 category equipped with a structure of v module there is now a natural functor over calg dgcatcontk fun 1 calg dgcatcontk ev 0 mod dgcatcontk 1 uu calg dgcatcontk which to a symmetric monoidal functor f v w assigns the pair v w where w is now seen as a v module via f see for instance the discussion in rob 14 pag 249 finally by composition with qcoh we obtain a commutative diagram 4 1 2 fun 1 top ev 0 mod dgcatcontk 1 t op qcoh calg dgcatcontk to conclude the construction of 4 1 1 we observe that we have cocart t op cart t op and the last is given by fun 1 top together with the evaluation at zero to top cocart dgcat cont can be canonically identified with the fiber product t op calg dgcatcont k mod dgcat cont k 1 therefore the commutativity of 4 1 2 and the universal property of pullbacks give the map 4 1 1 for technical reasons we will need to impose some conditions in the derived stacks we work with as in toe 13 we consider a full subcategory v t namely we will consider v the full subcategory spanned by all perfect stacks in the sense of bzfn 10 section 3 in particular thanks to bzfn 10 cor 3 22 stacks of the form y g with y a quasi projective derived scheme of finite presentation and g is a smooth linear algebraic group action on y over k are perfect also thanks to the combination of toe 12 b cor 5 2 and fp 97 theorem 1 see also hr 14 p 4 quasi compact separated deligne mumford stacks with coarse moduli space such as the stack of stable maps are perfect we will now summarize the nice features of v brane actions categorification of gromov witten theory and quantum k theory 47 1 any derived affine and any smooth and quasi projective scheme of finite presentation belongs to v in particular x belongs to v 2 the inclusion v t is closed under products and v is a generating site for t more over the functor v z cop 7 v z is a stack of symmetric monoidal 1 categories and the inclusion v t induces a natural transformation v t which induces a new natural transformation of strong monoidal functors v corr t corr this one being faithful but not full 3 the morphism encoding the stable action on x m t corr factors through the non full inclusion v corr t corr this follows from the formula 3 3 14 defining the action and the fact that the stacks appearing in the middle are deligne mumford with course moduli a scheme therefore perfect 4 the restriction qcoh vop top calg dgcatcontk has values in the full subcat egory calg dgcat cont c k spanned by the dg categories having compact generators in this case qcoh is a strongly monoidal functor thanks to toe 12 b thm 0 2 and remark 2 9 the full sub prestack of dg categories having compact generators dgcatcont c dgcatcont is also a stack for the fppf topology moreover this inclu sion is monoidal and in this case the composition v t dgcatcont c defines a monoidal map of stacks in symmetric monoidal categories 5 notice that dgcat cont c k is the 1 categorical truncation of 2 category following the results toe 07 thm 1 4 and cor 1 8 the hom categories are given by bi modules in the same way dgcatcont c is a sheaf with values in symmetric monoidal 2 categories the composition v dgcatcont c satisfies the base change condi tions of section 2 1 1 base change for derived artin stacks see dg 11 cor 1 4 5 hlp 14 b 15 or bzfn 10 prop 3 10 and 3 23 by the 2 universal monoidal property of correspondences grb part v applied object wise it extends in a essen tially unique way to a strongly monoidal 2 functor 48 etienne mann and marco robalo spans v dgcatcont c finally combining 3 and 5 we find a map of operads in t 4 1 3 m v corr spans v dgcatcont c exhibiting an algebra structure on qcoh x by construction over each z affine the map of graded operads m z v z corr dgcatcont c z is defined by sending a stable curve z m 0 n to the correspondence over z 4 1 4 n 1 x z z m 0 n rm 0 n x oo x z vv z and then unwinding the universal property of correspondences to the functor in dgcatcont z modqcoh z dgcat cont c k given by pullback pushforward along 4 1 4 4 1 5 qcoh z m 0 n rm 0 n x qcoh z m 0 n rm 0 n x pushforward qcoh n 1 x z pullback 22 qcoh x z by the items 1 5 above this is equivalent to a map of compactly generated dg categories over z 4 1 6 qcoh x z n 1 z qcoh x z and as the base change qcoh z dgcat cont c k dgcat cont c z is monoidal and admits a right adjoint given by the forgetful functor this is equivalent to the data of a map in dgcatcontk 4 1 7 qcoh x n 1 qcoh x qcoh z corollary 4 1 1 the map 4 1 3 makes qcoh x an algebra over the graded categorical operad qcoh m 0 n n the algebra structure is completely determined by the pullback pushfoward maps in dgcatcontk 4 1 8 qcoh x n 1 qcoh x qcoh m 0 n qcoh x m 0 n brane actions categorification of gromov witten theory and quantum k theory 49 for n 2 and ne x we can now repeat the strategy used to construct the lax action of section 3 3 as dgcat cont c k has a natural structure of symmetric monoidal 2 category we can also encode the data of the limit preserving functor dgcatcont c top calg prl as the 1 categorical truncation of a categorical operad in t dgcatcont c top op cat re peating the same arguments as in section 3 3 we obtain a diagram 4 1 9 m n fin n fin b r m q stboo dgcatcont c n fin n fin b l uu op b t in the same conditions of the diagram 3 3 13 the next proposition establishes the categori fication of the lax gromov witten action proposition 4 1 2 there exists an functor 4 1 10 m n fin n fin b r dgcatcont c n fin n fin b p uu op b t given informally by pullback pushfoward along the universal correspondences 1 1 4 4 1 11 qcoh x n 1 qcoh x m 0 n moreover this map does send c cartesian edges to c cartesian edges but does not preserve cocartesian edges in the direction notice that as the m 0 n is smooth and proper the dg category qcoh m 0 n is dualizable object in dgcat cont c k and also qcoh x m 0 n qcoh x qcoh m 0 n therefore the maps 4 1 11 are equivalent to the pullback pushforward maps 4 1 12 qcoh m 0 n qcoh x n 1 qcoh x proposition 4 1 3 this action is compatible with the subcategories cohb and perf proof as the pullback of perfect along any map is still perfect for perf one only needs to justify why pushfoward along the maps in the diagrams preserve perfect this is because x and m 0 n are both proper smooth algebraic varieties and rm 0 n x is known to be a proper quasi smooth derived deligne mumford stack tv 08 section 2 2 4 so that the stabilization evaluation maps rm 0 n x x n m 0 n are therefore proper and quasi smooth in this case as explained in toe 12 a pushfowards preserve perfect complexes for cohb one has to justify both compatibilities with pushfowards and pullbacks compat ibility with pushfowards follows because the map is proper see gra lemma 3 3 5 and for 50 etienne mann and marco robalo pullbacks we use the fact that pullbacks along quasi smooth maps between proper dm stacks are of finite tor amplitude 4 2 the effects of the lax action on k theory in this section we explore how the categorified lax action obtained at the end of the previous section induces an action on k theory we start by recalling that the k theory spectrum of an algebraic variety x is defined to be the k theory spectrum of the dg category of perfect complexes k perf x respectively the g theory spectrum is defined to be the k spectrum of the dg category cohb x which by definition is the full subcategory of qcoh x spanned by those complexes of bounded cohomological amplitude and coherent cohomology by a well known theorem of serre if x is smooth then the inclusion perf x cohb x is an equivalence of 1 categories and therefore the k and g theories agree let f rm 0 n x and let e 1 en k 0 x g 0 x and p k 0 m 0 n g 0 m 0 n the k theoretic gromov witten numbers that appear naturally from our lax action in the prop 4 1 2 are defined by p ev e 1 en stb p p orm 0 n x ev e 1 en stb p g 0 z where p is the projection to the point alternatively these are encoded by maps 4 2 1 i 0 n k 0 x n k 0 m 0 n induced from the lax action i e via pullback pushfoward along 1 1 4 let us now explain how the lax associative structure produces the metric terms intro duced by givental lee to explain the k theoretic splitting principle we ask the reader to recall the diagram 3 3 10 let 0 1 2 and let n m 2 we have two differ ent ways to go from k 0 x n 1 xm 1 to k 0 m 0 n m 0 m either we use the space of stable maps rm 0 n m 2 x 0 and the pullback diagram or we use the fiber product rm 0 n x 1 x rm 0 m x 2 and the pullback diagram the lax structure measures the difference between the two our goal for the rest of this section is to give a more accurate description of this difference we start with some general preliminary remarks the first observation concerns the derived stack p x rm 0 2 x this stack has natural structure of monoid object over x given by the gluing to stable maps 4 2 2 p x x p x p x this monoid structure can be obtained in a strict way as it exists already at the level of the moduli 1 stacks of costello m 0 2 by definition this stack classifies unparametrized rational paths on x and the monoid operation corresponds to the concatenation we then observe that for every n 2 the stacks of stable maps rm 0 n x are modules over p x simultaneously on the left and on the right via the gluing of stable maps along the brane actions categorification of gromov witten theory and quantum k theory 51 last or first marked point in this case given n m 2 we can have a semi simplical object in derived stacks given by the associated bar complex 4 2 3 rm 0 n x x p x x rm 0 m x rm 0 n x x rm 0 m x where the face maps are the gluing morphisms this semi simplicial object is naturally augmented by the gluing map 4 2 4 rm 0 n x x rm 0 m x rm 0 n m 2 x m 0 n m 2 m 0 n m 0 m let 0 ne x by base change along the open inclusion rm 0 n m 2 x 0 rm 0 n m 2 x we obtain another simplicial object u 0 informally described by 4 2 5 0 d 1 d 2 d 3 rm 0 n x d 1 x rm 0 2 x d 2 x rm 0 m x d 3 0 d 1 d 2 rm 0 n x d 1 x rm 0 m x d 2 with an augmentation u 0 u 0 1 given the gluing map 4 2 6 0 d 1 d 2 rm 0 n x d 1 x rm 0 m x d 2 rm 0 n m 2 x 0 m 0 n m 2 m 0 n m 0 m more generally the level k of u 0 is given by the derived stack 4 2 7 0 d 0 dk 1 zd 0 dk 1 where we define 4 2 8 zd 0 dk 1 rm 0 n x d 0 x rm 0 2 x d 1 x x rm 0 2 x dk x rm 0 m x dk 1 again the face maps are the gluing maps for each k 0 and for each partition of 0 d 0 dk 1 we will let f d 0 dk 1 denote the composition zd 0 dk 1 u 0 k u 0 1 now we list some important facts that we will need in our discussion 1 the composition maps m 0 n m 0 m m 0 n m 2 are closed immersions knu 83 cor 3 9 by pullback so is the map u 0 1 rm 0 n m 2 x 0 52 etienne mann and marco robalo 2 the derived stacks of stable maps rm 0 n x are quasi smooth as x is smooth each stack zd 0 dk 1 will also be quasi smooth quasi smooth maps are stable un der pullback moreover it is also known that the gluing maps rm 0 n x x rm 0 m x rm 0 n m 2 x are closed immersions 3 by the same pullback argument the derived stack u 0 1 is also quasi smooth notice now that the augmented semi simplicial object 4 2 6 lives in the full subcategory of derived deligne mumford stacks and due to the finite properties of the mori cone for each 0 it becomes constant after a certain level k 0 in fact empty as the moduli of stable maps with two marked points and degree 0 is empty in which case the diagram is in fact finite we claim that in fact for each 0 this augmented semi simplicial diagram has a colimit inside derived deligne mumford stacks not all colimits exist inside deligne mumford stacks however and thanks to lur 11 b thm 6 1 15 we know the existence of pushouts of derived dm stacks along closed immersions we now remark that the stacks z d 0 dk 1 can be organized in a finite diagram where all maps are closed immersions and whose colimit is the same as the realization of the simplicial object u 0 let s denote the non full subcategory of with the same objects but only the injective maps as morphisms we know from lur 09 lemma 6 5 3 7 that the inclusion ops op is cofinal in other words to compute the realization of u 0 we only need to care about face maps to describe the diagram with the z d 0 dk 1 we introduce an auxiliary 1 category 0 its objects are pairs k sk where k is an object in and sk is a choice of a decomposition 0 d 0 dk 1 the morphisms k sk k sk are given as in s by specifying the generating face maps a face map k sk d 0 dk 1 k 1 sk 1 0 k 2 is by definition the data of a face map i k k 1 in s together with the condition that dj j if j i dj j j 1 if j i dj j 1 if j i 1 the collection of the z d 0 dk 1 and closed immersions between appears in the form of a op 0 diagram 0 in the 1 category of derived deligne mumford stacks together with a cone op 0 with vertex u 0 1 one can construct this diagram by first constructing a similar diagram by hand in the category of usual 1 stacks using the moduli spaces of costello we have a forgetful functor t 0 s it follows from the definitions that the fibers of t are discrete and it is an easy exercise to check that t is a right fibration its opposite op 0 ops is a left fibration with discrete fibers and it follows that for every k op s the canonical inclusion t 1 k op 0 k is cofinal by quillen s theorem a for categories 15 here one has to show that the theory of derived dm stacks viewed via the functor of points approach is equivalent to the theory of dm stacks in the sense of lur 11 a using ringed topoi this follows from lur 11 a thm 2 4 1 together with the representability theorem lur 12 2 together with the fact that a map of simplicial commutative rings f a b is e tale if and only if the map spece t b spece t a is e tale we thank mauro porta for explaining to us a detailed proof of this result without using the representability theorem brane actions categorification of gromov witten theory and quantum k theory 53 lur 09 thm 4 1 3 1 in this case we conclude that the left kan extension of 0 along the forgetful map t op 0 op is precisely the simplicial object u 0 moreover as colimits are given as left kan extensions along the projections to the constant diagram the colimit of 0 is canonically equivalent to the colimit of u 0 moreover one can freely add degeneracies to u 0 by considering its kan extension along the inclusion op s op as this inclusion is cofinal the colimit of this new diagram is the same with the necessary care we will use the same notation for this new simplicial object it is clear that the colimit of this diagram can be computed in a finite number of steps using only pushout diagrams in this case by the discussion above there exists a colimit internal to the theory of derived deligne mumford stacks d 0 colim dm stk u 0 the key to understand the combinatorics of gromov witten invariants is hidden in the canonical colimit map 4 2 9 f d 0 colimit dm stk k 1 d 0 d 1 dk 1 0 zd 0 dk 1 u 0 1 rm 0 n m 2 x 0 m 0 n m 2 m 0 n m 0 m we believe that this map is an equivalence of derived deligne mumford stacks we will not prove this instead we will restrict ourselves to show the properties required by gromov witten theory in fact for cohomological invariants what matters is that this map is birational and for the k theoretic invariants the important point is that the f od 0 ou 0 1 the first fact follows from a standard easy argument the map f induces an isomorphism when restricted to the open substacks of stable maps whose underlying curves are already stable this is an easy exercice which we will leave to the reader the second statement concerning the structure sheaves is more involved the proof we give below will use the results on derived h cech descent for almost coherent and perfect complexes of hlp 14 together with the fact that our augmented semi simplicial diagram u 0 is bounded and provides an h hypercover in the bounded situation descent and hyperdescent are known to be equivalent this derived h descent for pseudo coherent and perfect complexes is an important feature of derived algebraic geometry which is not true in the classical setting recall that a derived h cover following hlp 14 section 4 2 is a morphism which is represented by a relative algebraic space and which is a universal topological submersion proper surjections are the example we are interested in one is interested in the semi simplicial augmented object u 0 notice first that it only has finite many levels this follows from the decomposition assumptions on 0 starting from a certain level 1 all the terms are empty as the moduli spaces of stable maps with two marked points and degree 0 are empty 16 we can therefore replace u 0 by the coskeletal simplicial diagram cosk u 0 whose colimit inside the theory of derived dm stacks is again d 0 16 here of course we use the real moduli with 2 points and now the fake ones introduced before 54 etienne mann and marco robalo one could try to show that the semi simplicial augmented object u 0 is a bounded h hypercover to check this one would have to check that for each k the canonical map 4 2 10 d 0 dk 1 0 rm 0 n x d 0 x rm 0 2 x d 1 x x rm 0 2 x dk x rm 0 m x dk 1 coskk 1 u 0 k is an h cover at the first level we have 4 2 11 d 0 d 1 0 rm 0 n x d 0 x rm 0 m x d 1 u 0 1 which in fact is an h cover as clearly is proper as both the source and target are proper see lur 16 a 2 1 2 10 2 1 2 13 and surjective however starting from the second level these maps are not surjective as it is easy to see in u 0 0 u 0 1 u 0 0 we can only access the first factor by gluing first and the last factor can only be accessed by gluing last of vice versa as it is easily understood one needs to have both options to have surjectivity in order words we have a lack of symmetry originated from the fact that the simplicial presentation of u 0 required us to fix an order for the different ways of gluing in order to make u 0 an hypercover we need to consider all the possible orders one possible way to achieve this is to consider the symmetrization of u 0 namely recall that the simplicial category can be seen as a non full subcategory of the category fin of non empty finite sets also known in the literature as symmetric simplicial where n is now seen as an unordered set with n 1 elements let op finop be the canonical inclusion for any category c having colimits we have a composition functor fun finop c fun op c which admits a left adjoint given by taking the left kan extension along the canonical inclusion the symmetrization of a simplicial object u is the new simplicial object defined by the restriction of this kan extension which we will denote as u informally it is easy to see that the level n of this new simplicial object will be a disjoint union n 1 u n and the maps will be induced by all the possible orderings of the boundary maps to conclude instead of u 0 we will consider its symmetrization u 0 which one can easily now check is an h hypercover to conclude we combine cis 06 8 3 6 with quillen s theorem a lur 09 4 1 3 1 to deduce that the inclusion op finop is cofinal see also cis 06 4 2 20 4 2 19 2 2 7 3 3 3 and 3 1 1 and notice the appearance of an opposite relating these to the result in lur 09 4 1 3 1 this implies that the unit of the adjunction u 0 u 0 produces an equivalence after taking colimits proposition 4 2 1 we have the following 1 the canonical map ou 0 1 f od 0 is an equivalence 2 there is an equality of g classes 4 2 12 ou 0 1 f d 0 k 1 k 0 d 0 dk 1 f d 0 dk 1 oz d 0 dk 1 remark 4 2 2 the proposition 4 2 1 and more importantly the formula 4 2 12 is analogous to the key result of lee 04 prop 11 section 3 7 which explains the correction of the splitting brane actions categorification of gromov witten theory and quantum k theory 55 principle necessary to handle k theoretic invariants our computations exhibit this formula as a consequence of derived h descent proof of proposition 4 2 1 let us start by showing 1 the crucial result that we will be using is hlp 14 theorem 4 12 namely that perfect complexes satisfy descent with respect to cech h covers this combined with the fact that descent for cech covers implies descent for all n coskeletal hypercovers see lur 09 6 5 3 9 or dhi 04 appendix 1 tells us that the pullback pushfoward maps produces an equivalence perf u 0 1 lim k op 0 d 0 dk 1 perf zd 0 dk 1 at the same time and using lur 11 b thm 7 1 we deduce that the canonical map induced by the pullback functors 4 2 13 qcoh d 0 lim k op 0 d 0 dk 1 qcoh zd 0 dk 1 is fully faithful and the unit of the associated adjunction gives an a natural equivalence 4 2 14 f lim k op 0 d 0 dk 1 f d 0 dk 1 f d 0 dk 1 the two results combined imply the equivalence f od 0 ou 0 1 this concludes the proof of 1 2 is now a consequence of 1 via a standard computation in a stable category as the simplicial diagram object is finite we now turn to the description of the lax structure in the k theory action considering the pullback square for a particular grading 0 we obtain a pullback square 0 that we can fit as 4 2 15 m 0 n m 0 m u 0 1 x 0 g oo i m 0 n m 2 rm 0 n m 2 x 0 stb oo ev xn 1 xm 1 the map k 0 x n 1 xm 1 k 0 m 0 n m 0 m that we are interested in is given by the composition 4 2 16 stb ev using base change for derived deligne mumford stacks applied to the diagram 0 this is equivalent to 4 2 17 g i ev but now we know that in g 0 u 0 1 the structure sheaf can be written as an alternated sum 4 2 12 and 4 2 17 becomes 56 etienne mann and marco robalo 4 2 18 k 1 k 0 d 0 dk 1 g f d 0 dk f d 0 dk 1 i ev let now vd 0 dk 1 denote the stack rm 0 n x d 0 rm 0 2 x d 1 rm 0 2 x dk rm 0 m x dk 1 we have pullback diagrams that fit in 4 2 19 m 0 n m 0 m vd 0 dk 1 stb stb oo ev d 0 dk 1 xn 1 x x 2 x 2 k x xm 1 zd 0 dk 1 q q d 0 dk 1 oo h d 0 dk 1 xn 1 x x k xm 1 k id n 1 k idm 1 oo pk id n 1 pt idm 1 xn 1 xm 1 for each decomposition 0 d 0 dk 1 we now notice that the composition stb stb q d 0 dk 1 is equivalent to g f d 0 dk 1 and using the base change formula for the pullback diagram 4 2 19 4 2 18 becomes 4 2 20 k 1 k 0 d 0 dk 1 stb stb ev d 0 dk 1 k p k which we can write as 4 2 21 stb stb ev 1 2 1 p 1 extra terms of course the first term in the last formula corresponds to the second map k 0 x n 1 xm 1 k 0 m 0 n m 0 m obtained by using 0 the extra terms corresponding to k 1 which we obtain as a result of derived descent appear exactly as in lee 04 prop 11 section 3 7 in order to encode and manage these extra terms lee and givental introduced in lee 04 section 4 and in giv 00 p 6 a combinatorial gadget which they called a metric our results provides a derived computation of these terms in terms of the structure sheaves of the derived stacks rm 0 2 x d see the remark 4 2 2 4 3 quantum k theory comparison with the k theoretic invariants of givental lee in lee 04 giv 00 givental and lee introduced gromov witten invariants living in g theory the basic ingredient to define these invariants is the so called virtual structure sheaf which is an element ovir in the grothendieck group g 0 of the truncation t 0 rm 0 n x let j t 0 rm 0 n x rm 0 n x denote the inclusion our goal in this section is to explain that the virtual structure sheaf ovir constructed by lee in lee 04 section 2 3 can be identified with the restriction of the structure sheaf of rm 0 n x to the truncation this brane actions categorification of gromov witten theory and quantum k theory 57 in particular implies that their gw classes are the same as the ones obtained from our lax action studied in the previous section let us start with some well known general preliminaries let f be a derived artin stack and j t 0 f f its truncation then the structure sheaf of produces a family of sheaves on the truncation i of in general these sheaves are not coherent but one can show that when the base field is of characteristic zero and f is of finite presentation and quasi smooth then these sheaves are coherent and vanish for i 0 see toe 12 a sublemma 2 3 under these hypothesis one can show that the map j sends coherent complexes to coherent complexes and by devissage induces an isomorphism j g 0 t 0 f g 0 f its inverse j 1 sends of g 0 f to i 1 i i of which is a finite sum under these hypothesis recall also that the euler characteristics are defined by taking pushfoward to the point 4 3 1 t 0 f q j f p so that in g theory we have q j 1 e p j j 1 e p e for any e g 0 f our main goal in this section is to explain that the virtual structure sheaf ovir k 0 t 0 f of lee 04 section 2 3 is given by j 1 of in order to explain this we will need some further preliminaries concerning perfect obstruction theories in the sense of bf 97 def 5 1 these were introduced as an ad hoc way to keep track of derived enhancements of classical stacks let y be an underived stack and ly qcoh y its cotangent complex the data of an obstruction theory on y consists of a map of quasi coherent sheaves t t ly satisfying some conditions which we will allow ourselves to omit here informally t is to be understood as the cotangent complex of a derived enhancement of y it is said to be perfect if t is a perfect complex suppose now that there exists a derived stack f whose truncation t 0 f is y this produces a natural associated obstruction theory on y let lf qcoh f denote the cotangent complex of f then we have a natural map t j lf lt 0 f following stv 11 cor 1 3 if f is general geometric stack then this map defines an obstruction the ory this follows from lurie s connectivity estimates and if f is in particular quasi smooth then this is a 1 0 perfect obstruction theory meaning that t is perfect and concentrated tor amplitude 1 and 0 one can also ask if this assignment is essentially surjective this is not true and we can identify the obstructions to produce a lifting sch 14 every perfect obstruction theory on y produces a virtual sheaf namely an object in k y this a consequence of a more structured fact we will show that to every obstruction theory t on y one can naturally associate a derived enhancement of y robs t that splits by definition the virtual structure sheaf associated to t is given by the recipe described above applied to the truncation map i y robs t meaning ovir t i 1 orobs t in general i lrobs t will be different from t as due to the splitting it will be of the form ly li 1 58 etienne mann and marco robalo the construction of the derived enhancement robs t follows from the observation that the construction of the virtual fundamental classes described in bf 97 has a natural interpre tation as homotopy fiber products in derived algebraic geometry indeed let y be classical artin stack together with the data of a perfect obstruction theory t t ly then let c t be the classical cone stack associated to t bf 97 section 2 17 and let cy be the intrinsic normal cone of y then both c t and cy are cone stacks over y cy is a closed sub stack of c t and y can be embedded in both of them via the zero section bf 97 prop 2 4 2 6 and def 3 10 we now use the inclusion of classical 1 stacks inside derived stacks and see these three stacks as derived objects in a trivial way we define a new derived stack robs t to the pullback in the 1 category of derived stacks 4 3 2 robs t r cy y c t where the map y c t is the zero section and cy c t is the closed immersion produced by the obstruction theory in general the inclusion of classical stacks in derived stacks does not commute with homotopy fiber products in fact in this case the usual fiber product in classical stacks is equivalent to y as y can be embedded both in c t and cy via the zero section the truncation functor however commutes with products and therefore we deduce that t 0 robs t y or in other words robs t is a derived enhancement of y it is also clear from the definition of derived fiber products that the structure sheaf of this derived stack is responsible for the virtual structure sheaf described in bf 97 remark 2 4 this derived enhancement of y with truncation map i y robs t has a particular feature it splits via the map r the virtual structure sheaf ovir g 0 t 0 f of lee 04 section 2 3 is defined by the recipe given in the previous paragraph using the following relative obstruction theory as input let m pre 0 denote the stack of all pre stable curves of genus zero with n marked points and let c 0 n m pre 0 denote the universal pre stable curve of total degree then we have a commutative diagram 4 3 3 c 0 n mpre 0 t 0 rm 0 n x ev 0 0 x m pre 0 u t 0 rm 0 n x q 0 m pre 0 where ev 0 is the evaluation map and 0 is the projection to the second factor notice that in this case the relative cotangent complex lu is equivalent to lx following the steps in the discussion preceding bf 97 prop 6 2 we find a natural map t 0 ev 0 tx lq 0 in qcoh y with y t 0 rm 0 n x by bf 97 prop 6 2 this is a perfect obstruction theory the virtual structure sheaf considered by lee in lee 04 section 2 3 can be immediately 17 denoted there as h 1 h 0 t brane actions categorification of gromov witten theory and quantum k theory 59 identified with the element ovir t described above induced by the derived stack robs t proposition 4 3 1 the obstruction theory used by lee is the same as the obstruction theory produced by the derived enrichment f rm 0 n x of y t 0 rm 0 n x proof this follows essentially from the description of the tangent complex of a mapping stack rhom u v when u and v are derived artin stacks in this case one can exhibit a canonical equivalence 4 3 4 trhom u v ev tv in qcoh rhom u v here is the projection u rhom u v rhom u v and ev u rhom u v v is the evaluation map to see this we consider the diagram rhom u v u ev v rhom u v together with the fact that by definition we have qcoh rhom u v limspec a rhom u v d a and the definition of tangent stack if v is a derived stack we denote by tv rhom spec c v the derived stack of morphisms endowed with the natural map tv v given by the composition with the natural inclusion of the point spec c spec c the derived stack tv is therefore completely determined by the cotangent complex of v in the sense that for any u spec a v we have mapc v spec a tv mapd a a u tv mapd a u lv a in this case we see that by definition we have t rhom u v rhom spec c rhom uv rhom u tv so that given xu spec a rhom u v determined by u spec a u v we have that mapc v spec a tv is equivalent to the space of extensions rhom u tv spec a xu 77 rhom u v which by definition of rhom is the space of all extensions tv spec a u u 88 q q q q q v 60 etienne mann and marco robalo which is equivalent to the space mapc v spec a u tv mapqcoh spec a u ospec a u u tv mapd a a p u tv with p spec a u spec a the projection using the fact that u ev xu id the base change property for the diagram spec a u p xu id rhom u v u spec a xu rhom u v gives us p u x u ev the descent property for tangent complexes and reduction to the affine case allows us to conclude the proof of the formula 4 3 4 finally the formula 4 3 4 admits a relative version which we can apply to the diagram of derived stacks 4 3 5 c 0 n mpre 0 rm 0 n x ev x m pre 0 u rm 0 n x q m pre 0 to deduce an equivalence between the relative tangent complexes ev tx tq the dia grams 4 3 3 and 4 3 5 fit in a larger commutative diagram 4 3 6 c 0 n mpre 0 t 0 rm 0 n x i ev 0 0 x m pre 0 u c 0 n mpre 0 rm 0 n x ev 66 t 0 rm 0 n x q 0 j m pre 0 rm 0 n x q 55 where i and j are the truncation maps moreover the face with the truncation maps is a pullback square as c 0 n is already truncated as these are derived deligne mumford stacks we can apply the base change formulas again see dg 11 cor 1 4 5 or hlp 14 b 15 and deduce that 0 ev 0 tx 0 i ev tx j ev tx j tq to conclude we brane actions categorification of gromov witten theory and quantum k theory 61 contemplate that the natural map j tq lq 0 can be naturally identified with the map constructed in bf 97 prop 6 2 here s the current status of the situation we have a classical stack y t 0 rm 0 n x and a derived enhancement f rm 0 n x which produces an obstruction theory t and therefore a second derived enhancement robs t of y these fit in a diagram robs t y ioo j f which is an isomorphism after truncation and therefore in g theory groups g 0 robs t g 0 y i oo j g 0 f to complete the proof one must show that ovir t i 1 orobs t is equal to j 1 of in g 0 y proposition 4 3 2 one has an equality of g theory classes between ovir t i 1 or obs t and j 1 of in g 0 y proof in fact this identification has already been established in the case our derived stack is assumed to be embedded in a smooth stack in cfk 09 proof of thm 3 3 kapranov fontanine identified the two classes in the case of quasi smooth dg manifolds a possible incarnation of derived schemes and more recently in ls 12 section 7 2 2 the authors ex plain how the identification of the two classes for quasi smooth derived schemes follows from deformation to the normal cone together with a 1 invariance of g theory to conclude we remark that our situation is known to admit a global resolution in the sense required see the discussion in lee 04 section 2 3 and gp 99 appendix a in the genus zero case the situation becomes simpler as this global resolution is given by the closed embedding of rm 0 n x in rm 0 n p n given by the fact x is projective the last derived stack is known to be smooth because the projective space is convex finally with the two virtual sheaves identified it is clear that corollary 4 3 3 our lax action produces the same k theoretic classes of lee proof given e 1 en k 0 x g 0 x and p k 0 m 0 n g 0 m 0 n the k invariants of lee are defined by the euler characteristics 4 3 7 0 n o vir j ev e 1 en stb p q o vir j ev e 1 en stb p 4 3 8 p j o vir j ev e 1 en stb p which by the projection formula for j are equivalent to p j o vir ev e 1 en stb p 4 3 9 62 etienne mann and marco robalo and finally by the comparison arguments above p orm 0 n x ev e 1 en stb p which by definition are the k theoretic gromov witten numbers produced from our lax action references bar 13 c barwick on the q construction for exact quasicategories 2013 bc 14 a brini and r cavalieri crepant resolutions and open strings ii arxiv e prints july 2014 bcr 13 a brini r cavalieri and d ross crepant resolutions and open strings arxiv e prints september 2013 beh 97 k behrend gromov witten invariants in algebraic geometry invent math 127 3 601 617 1997 bf 97 k behrend and b fantechi the intrinsic normal cone invent math 128 1 45 88 1997 bg 09 jim bryan and tom graber the crepant resolution conjecture in algebraic geometry seattle 2005 part 1 volume 80 of proc sympos pure math pages 23 42 amer math soc providence ri 2009 bha 16 bhargav bhatt algebraization and tannaka duality camb j math 4 4 403 461 2016 bhl 15 bhargav bhatt and daniel halpern leistner tannaka duality revisited 2015 bm 96 k behrend and yu manin stacks of stable maps and gromov witten invariants duke math j 85 1 1 60 1996 bzfn 10 david ben zvi john francis and david nadler integral transforms and drinfeld centers in derived algebraic geometry j amer math soc 23 4 909 966 2010 ccit 09 tom coates alessio corti hiroshi iritani and hsian hua tseng computing genus zero twisted gromov witten invariants duke math j 147 3 377 438 2009 cfk 09 ionut ciocan fontanine and mikhail kapranov virtual fundamental classes via dg manifolds geom topol 13 3 1779 1804 2009 cg 07 tom coates and alexander givental quantum riemann roch lefschetz and serre ann of math 2 165 1 15 53 2007 chh 16 hongyi chu rune haugseng and gijs heuts two models for the homotopy theory of operads 2016 cij 14 t coates h iritani and y jiang the crepant transformation conjecture for toric complete intersections arxiv e prints september 2014 cir 14 alessandro chiodo hiroshi iritani and yongbin ruan landau ginzburg calabi yau correspon dence global mirror symmetry and orlov equivalence publ math inst hautes e tudes sci 119 127 216 2014 cis 06 denis charles cisinski les pre faisceaux comme mode les des types d homotopie aste risque 308 xxiv 390 2006 cit 09 tom coates hiroshi iritani and hsian hua tseng wall crossings in toric gromov witten theory i crepant examples geometry and topology 13 2009 cm 11 denis charles cisinski and ieke moerdijk dendroidal sets as models for homotopy operads j topol 4 2 257 299 2011 cm 13 a denis charles cisinski and ieke moerdijk dendroidal segal spaces and operads j topol 6 3 675 704 2013 cm 13 b denis charles cisinski and ieke moerdijk dendroidal sets and simplicial operads j topol 6 3 705 756 2013 cos 06 kevin costello higher genus gromov witten invariants as genus zero invariants of symmetric products ann of math 2 164 2 561 601 2006 dg 11 vladimir drinfeld and dennis gaitsgory on some finiteness questions for algebraic stacks 2011 brane actions categorification of gromov witten theory and quantum k theory 63 dhi 04 daniel dugger sharon hollander and daniel c isaksen hypercovers and simplicial presheaves math proc cambridge philos soc 136 1 9 51 2004 dk 12 tobias dyckerhoff and mikhail kapranov higher segal spaces i 2012 dub 96 boris dubrovin geometry of 2 d topological field theories in integrable systems and quantum groups montecatini terme 1993 volume 1620 of lecture notes in math pages 120 348 springer berlin 1996 fp 97 w fulton and r pandharipande notes on stable maps and quantum cohomology in algebraic geometry santa cruz 1995 volume 62 of proc sympos pure math pages 45 96 amer math soc providence ri 1997 gai d gaitsgory sheaves of categories and the notion of 1 affineness giv 00 alexander givental on the wdvv equation in quantum k theory michigan math j 48 295 304 2000 dedicated to william fulton on the occasion of his 60 th birthday giv 04 alexander b givental symplectic geometry of frobenius structures in frobenius manifolds as pects math e 36 pages 91 112 friedr vieweg wiesbaden 2004 gk 98 e getzler and m m kapranov modular operads compositio math 110 1 65 126 1998 gp 99 t graber and r pandharipande localization of virtual classes invent math 135 2 487 518 1999 gra d gaitsgory and n rozenblyum ind coherent sheaves grb d gaitsgory and n rozenblyum a study in derived algebraic geometry available online in http www math harvard edu gaitsgde gl hau 14 rune haugseng iterated spans and classical topological field theories 2014 hhm 13 gijs heuts vladimir hinich and ieke moerdijk the equivalence between lurie s model and the dendroidal model for infinity operads 2013 hlp 14 daniel halpern leistner and anatoly preygel mapping stacks and categorical notions of properness 2014 hr 14 jack hall and david rydh perfect complexes on algebraic stacks 2014 hry 16 philip hackney marcy robertson and donald yau higher cyclic operads 2016 iri 09 hiroshi iritani an integral structure in quantum cohomology and mirror symmetry for toric orb ifolds adv math 222 3 1016 1079 2009 iri 10 hiroshi iritani ruan s conjecture and integral structures in quantum cohomology in new de velopments in algebraic geometry integrable systems and mirror symmetry rims kyoto 2008 volume 59 of adv stud pure math pages 111 166 math soc japan tokyo 2010 kkp 08 l katzarkov m kontsevich and t pantev hodge theoretic aspects of mirror symmetry arxiv e prints may 2008 km 94 maxim kontsevich and yuri manin gromov witten classes quantum cohomology and enumerative geometry comm math phys 164 3 525 562 1994 km 99 m kapranov and yu manin modules and morita theorem for operads 1999 knu 83 finn f knudsen the projectivity of the moduli space of stable curves ii the stacks mg n math scand 52 2 161 199 1983 kon 95 maxim kontsevich enumeration of rational curves via torus actions in the moduli space of curves texel island 1994 volume 129 of progr math pages 335 368 birkha user boston boston ma 1995 lee 04 y p lee quantum k theory i foundations duke math j 121 3 389 424 2004 li 02 jun li a degeneration formula of gw invariants j differential geom 60 2 199 293 2002 ls 12 parker lowrey and timo schu rg grothendieck riemann roch for derived schemes 2012 lur 09 jacob lurie higher topos theory volume 170 of annals of mathematics studies princeton univer sity press princeton nj 2009 lur 11 a jacob lurie dagv structured spaces february 2011 lur 11 b jacob lurie derived algebraic geometry ix closed immersions november 2011 lur 12 jacob lurie dagxiv representability theorems march 2012 lur 16 a jacob lurie spectral algebraic geometry february 2016 lur 16 b jacob lurie higher algebra march 2016 http www math harvard edu lurie papers dag v pdf http www math harvard edu lurie papers dag ix pdf http www math harvard edu lurie papers dag v pdf http www math harvard edu lurie papers sag rootfile pdf http www math harvard edu lurie papers higheralgebra pdf 64 etienne mann and marco robalo man y manin quantum cohomology motives derived categories i ii ihp january 2013 available at http www math jussieu fr yuy rega pdf 1213 16012013 a pdf mw 07 ieke moerdijk and ittay weiss dendroidal sets algebr geom topol 7 1441 1470 2007 per 07 fabio perroni chen ruan cohomology of ade singularities internat j math 18 9 1009 1059 2007 ras 14 sam raskin chiral principal series categories phd thesis harvard 2014 rob 14 marco robalo the orie homotopique motivique des espaces noncommutatifs phd thesis 2014 rob 15 marco robalo k theory and the bridge from motives to noncommutative motives adv math 269 399 550 2015 rt 94 yongbin ruan and gang tian a mathematical theory of quantum cohomology math res lett 1 2 269 278 1994 rt 97 yongbin ruan and gang tian higher genus symplectic invariants and sigma models coupled with gravity invent math 130 3 455 516 1997 rua 96 yongbin ruan topological sigma model and donaldson type invariants in gromov theory duke math j 83 2 461 500 1996 rua 06 yongbin ruan the cohomology ring of crepant resolutions of orbifolds in gromov witten theory of spin curves and orbifolds volume 403 of contemp math pages 117 126 amer math soc providence ri 2006 sch 14 timo schu rg deriving deligne mumford stacks with perfect obstruction theories 2014 stv 11 t schu rg b toe n and g vezzosi derived algebraic geometry determinants of perfect complexes and applications to obstruction theories for maps and complexes arxiv e prints february 2011 toe 07 bertrand toe n the homotopy theory of dg categories and derived morita theory invent math 167 3 615 667 2007 toe 09 bertrand toe n higher and derived stacks a global overview in algebraic geometry seattle 2005 part 1 volume 80 of proc sympos pure math pages 435 487 amer math soc providence ri 2009 toe 12 a b toen proper local complete intersection morphisms preserve perfect complexes 2012 toe 12 b bertrand toe n derived azumaya algebras and generators for twisted derived categories invent math 189 3 581 652 2012 toe 13 b toe n operations on derived moduli spaces of branes 2013 toe 14 bertrand toe n derived algebraic geometry ems surv math sci 1 2 153 245 2014 tse 10 hsian hua tseng orbifold quantum riemann roch lefschetz and serre geometry and topology 14 1 81 2010 math 0506111 tv 08 bertrand toe n and gabriele vezzosi homotopical algebraic geometry ii geometric stacks and applications mem amer math soc 193 902 x 224 2008 etienne mann universite d angers de partement de mathe matiques ba timent i faculte des sciences 2 boulevard lavoisier f 49045 angers cedex 01 france e mail address etienne mann univ angers fr marco robalo sorbonne universite universite pierre et marie curie institut mathe matiques de jussieu paris rive gauche cnrs case 247 4 place jussieu 75252 paris cedex 05 france e mail address marco robalo imj prg fr http www math jussieu fr yuy rega pdf 1213 16012013 a pdf 1 introduction 1 1 main results 1 2 plan of the paper 1 3 future directions 1 4 acknowlegments 1 5 prerequisites 2 brane actions 2 1 brane actions for operads in spaces 2 2 brane actions for operads in a topos 2 3 brane actions for graded operads 2 4 graded operads in a topos and brane actions 3 stable actions 3 1 the operad m of costello and its brane action 3 2 the stable sub action of m 3 3 gromov witten lax action 4 categorification of gw invariants and quantum 39 42 613 a 45 47 603 ak theory 4 1 categorification 4 2 the effects of the lax action on 39 42 613 a 45 47 603 ak theory 4 3 quantum 39 42 613 a 45 47 603 ak theory comparison with the 39 42 613 a 45 47 603 ak theoretic invariants of givental lee references