1 the evolution of cooperation an evolutionary advantage of individuals impedes the evolution of the population xiaoliang wang 1 3 andrew harrison 2 1 college of life sciences zhejiang university hangzhou 310058 china 2 department of mathematical sciences university of essex colchester co 4 3 sq uk 3 school of physical sciences university of science and technology of china hefei 230026 china correspondence x w wxliang mail ustc edu cn a h harry essex ac uk abstract range expansion is a universal process in biological systems and therefore plays a part in biological evolution using a quantitative individual based method based on the stochastic process we identify that enhancing the inherent self proliferation advantage of cooperators relative to defectors is a more effective channel to promote the evolution of cooperation in range expansion than weakening the benefit acquisition of defectors from cooperators with this self proliferation advantage cooperators can rapidly colonize virgin space and establish spatial segregation more readily which acts like a protective shield to further promote the evolution of cooperation in return we also show that lower cell density and migration rate have a positive effect on the competition of cooperators with defectors biological evolution is based on competition between individuals and should therefore favor selfish behaviors however we observe a counterintuitive phenomenon that the evolution of a population is impeded by the fitness enhancing chemotactic movement of individuals this highlights a conflict between the interests of the individual and the population the short sighted selfish behavior of individuals may not be that favored in the competition between populations such information provides important implications for the handling of cooperation keywords chemotaxis biological evolution evolutionary games range expansion 1 introduction biological evolution is closely related to self organized biological pattern formation in evolution through cooperation among their components complex organizations exhibit emergent behaviors fig 1 this has happened in biological systems at all levels 1 2 for example genes cooperate in a genome organelles cooperate in a cell and organisms cooperate in an ecological community however it s not easy to understand the maintenance of cooperation in biological evolution since organisms with cooperative genes often have no competitive advantage relative to those with defective cheating genes whereas evolution is based on competition between individuals 3 in prisoner s dilemma defection is often the evolutionarily stable strategy ess 4 explaining the evolution of cooperation has long been of interest and has not yet been fully understood many theories and mechanisms have been proposed including kin selection 3 5 6 reciprocity 7 9 group selection 10 13 policing and punishment 14 15 and biological range expansion 16 19 kin selection is the most famous which argues that the benefits produced by cooperation can be directed to those individuals with inclusive genes i e relatives and therefore facilitate the maintenance of cooperative behaviors such explanations strengthen darwin natural selection theory which is usually considered solely on individual behaviors mailto wxliang mail ustc edu cn mailto harry essex ac uk 2 figure 1 schematic diagram of connection between biological pattern formation and biological evolution in recent years evolutionary biology is studied quantitatively in both theory and experiments especially quantitative agent based models 20 22 have been developed for finite populations which usually exhibit prominent random effects these models have greatly improved our understanding of biological systems in this article we utilize the quantitative approach and model microorganisms to address a key question of biological evolution how can cooperation be maintained in the presence of cheating real biological systems tend to expand their range by moving into nearby free space 20 23 27 resulting from the inherent growth and reproduction of individuals here we will explore the problem of biological systems with range expansion our ultimate intention here is to provide new insights into the evolution of cooperation figure 2 illustration of a 2 d on lattice simulation and b linear expansion of a population one line of demes equates about one generation 2 models and methods we introduce here a two dimensional on lattice simulation which is based on stochastic processes to deal with biological evolutionary dynamics in range expansion in this model the number of individuals i e the population size in demes located on spatial lattices is not necessary to be kept invariant at every time step genomes organisms cells biological evolution genes biological patterning demes pleft pright ptop pdown j 1 j 1 i 1 i 1 l l 1 l 1 l 1 t 0 time y x periodic boundary conditions demes linear expansion a b 3 and the motions of individuals are not limited within the fixed space either as shown in fig 2 a during each time step one individual in each deme has a probability to reproduce in situ and a probability to migrate into one of the four nearest demes we take linear expansion as an example to show the general evolutionary process fig 2 b initially l demes containing well mixed populations of the same size are arranged on a line the next generation is produced by allowing the current generation to reproduce one by one until the number of each deme reaches the maximum population size n cell density before the production of next generation is finished at each time step individuals are allowed to exchange positions with its neighbors from the nearest demes each step happens randomly to capture the general feature of a biological system periodic boundary conditions are used for both right and left boundaries with the development of biotechnology especially the synthetic biology researchers recently start to use model microorganisms like e coli and yeast to test the evolutionary theory mainly due to their short generation time and simple life system convenient for genetic manipulation 15 in the following the 2 d on lattice simulation is further introduced to deal with evolutionary games and chemotaxis of microorganisms 2 1 evolutionary games of microorganisms in two player games a 2 2 payoff matrix is often used to describe the benefit distribution for the strategies a and b conducted between players table 1 in evolutionary biology strategies a and b usually denote the cooperation and defection respectively explanations for elements a b c and d are as follows when both players select cooperation the benefits they both get are a when one side conducts cooperation and the other selects defection the side which selects cooperation gets the benefit of b while the benefit the side which conducts defection gets is c when both sides conduct defection the benefits they both get are d in games between microorganisms a b c and d all correspond to the fitness i e growth rate the difference is that a and d are the inherent growth rates of species a and b e g the standard growth rate of e coli strains is about 1 h 1 28 while growth rates b and c only arise from social interactions i e competition between these two species table 1 benefits distribution in a b strategy games a b a a b b c d we are mainly concerned by how cooperation can evolve in prisoner s dilemma i e a c and b d in such a situation cooperators usually have higher self reproduction rates than defectors when they don t meet i e a d when cooperators and defectors meet however defectors will cause damage to cooperators through social interactions between them leading the later to have lower fitness since defectors often gain benefits from the former without paying the cost in this study we are mainly concerned by such a situation prisoner s dilemma reproduction probability of microorganisms in random 2 d on lattice model the growth rate of organisms is replaced by the reproduction probability for microorganisms an apparent feature is that the growth rate of them has a strong dependence on the population density the growth rate is approximately proportional to population density when the density is low this phenomenon is called the allee effect 29 and it has a maximum at intermediate cell densities 30 considering this fact the reproduction probabilities per unit time for both species a and b in each deme are taken to be proportional to the fraction of cells in the deme and the fraction of vacancies in that deme 21 4 pa i j afi j b 1 fi j nt i j n nt i j n 2 1 pb i j c fi j d 1 fi j nt i j n nt i j n 2 2 where i j denotes the position of demes nt is the total number of individuals in demes and f is frequency of species a in local demes migration probability of microorganisms for the dense packing of cells there is an obvious crowding effect in such a case the migration ability motility of individuals will be influenced by the cell density in line with korolev et al 21 the probability that an individual from one deme migrates into a nearest neighbor deme in unit time is taken to be proportional to the fraction of cells in the deme and the fraction of vacancies in that neighbor deme for species a and b the probabilities per unit time migrating to the four nearest neighbor demes fig 2 a are expressed as ptop ma b nt i j n nt i 1 j n 2 3 pdown ma b nt i j n nt i 1 j n 2 4 pright ma b nt i j n nt i j 1 n 2 5 pleft ma b nt i j n nt i j 1 n 2 6 where m is the inherent migration probability per unit time of individuals 2 2 chemotactic movement after evolving for a long term evolution many smart species including microorganisms become equipped with chemotaxis behavior that leads to enhanced survival the chemotactic motion which is guided by chemical cues actually means the anisotropic selection of motion directions in simulations for simplicity the chemotactic motion of individuals can be carried out by letting them select the motion direction with the probability proportional to positive gradient of cooperators or the negative gradient of defectors in case of species a namely cooperators we can let them partially move to the position with less defectors species b through the following method partial amounts of direction selecting a 1 n nt i 1 j ka n nbt i 1 j 7 a 2 n nt i 1 j ka n nbt i 1 j 8 a 3 n nt i j 1 ka n nbt i j 1 9 a 4 n nt i j 1 ka n nbt i j 1 10 selection probability of motion directions pi 1 j a 1 a 1 a 2 a 3 a 4 11 pi 1 j a 2 a 1 a 2 a 3 a 4 12 pi j 1 a 3 a 1 a 2 a 3 a 4 13 pi j 1 a 4 a 1 a 2 a 3 a 4 14 similarly for species b defectors the chemotactic motion can be realized through the following 5 partial amounts of direction selecting a 1 n nt i 1 j kbnat i 1 j 15 a 2 n nt i 1 j kbnat i 1 j 16 a 3 n nt i j 1 kbnat i j 1 17 a 4 n nt i j 1 kbnat i j 1 18 selection probability of motion directions pi 1 j a 1 a 1 a 2 a 3 a 4 19 pi 1 j a 2 a 1 a 2 a 3 a 4 20 pi j 1 a 3 a 1 a 2 a 3 a 4 21 pi j 1 a 4 a 1 a 2 a 3 a 4 22 where ka and kb are the parameter which can be used to tune the chemotaxis strength and nat and nbt are the total number of species a and b in demes respectively when ka b 0 the above direction selection probabilities will reduce to those for selecting demes with the most vacancies which is within one s general expectations figure 3 evolutionary games in biological range expansion a b genetic demixing in range expansion of microorganisms a experiment on e coli strains fluorescently labeled into the red and green 24 b 2 d on lattice simulation spatial distribution of frequency of the red strain maximum population size of each deme n 30 migration rate m 0 1 h 1 and growth rate of strains w 1 h 1 these parameters give deme size a 6 um c d evolution of cooperation in prisoner s dilemma c experiment this microbial cooperator defector system is constructed on yeast by using the synthetic biology method 18 d 2 d on lattice simulation growth rates in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 n 20 migration rate 6 m 0 1 h 1 cooperators are in red and defectors in green 3 model validation fig 3 a shows two e coli strains which defer only in expressing the green or red fluorescent protein were well mixed initially and then inoculated to the solid agar after several days the colony developed into well defined sector like regions this experiment 24 and the corresponding stepping stone models 20 showed that the formation of genetic de mixing i e spatial segregation between species is determined by genetic drift resulting from the small number of reproductive individuals at the expanding frontier shown in fig 3 b is our simulation result based on the 2 d on lattice simulation the remarkable similarity with the experiment shows the credibility of our models fig 3 c is the experimental results for the evolution of cooperation in prisoner s dilemma 18 our simulation results in fig 3 d show the similar evolutionary process presenting again the high precision of our models and simulation techniques 4 results and discussion biological range expansion has been shown to be able to promote the evolution of cooperation in both numerical and experimental studies 16 19 spatial segregation produced in this process plays a key role 16 we start with the discussion of this process here because a clear understanding still remains elusive 4 1 the evolution of cooperation in linear range expansion we show in fig 4 the evolutionary dynamics of cooperation in the prisoner s dilemma game which clearly reflects how cooperation is selected due to competition during range expansion both cooperators and defectors can dominate in some local regions and generate spatial segregation from one another as a natural protective shield arising from the proliferation of individuals fig 5 a spatial segregation is able to further reduce the chance for cooperators to play games with defectors resulting in cooperators having a higher proliferation ability and subsequent faster expansion speed fig 5 b consequently defectors are gradually left behind and finally fail in the game this competition process is vividly presented as the evolution in the number of individuals at the expanding frontier fig 5 c in the competition with defectors cooperators will first go through an adaptation phase during this period they suffer from fitness damage and have a reducing abundance within populations after about 30 generations however cooperators develop a higher fitness increase their abundance and finally win the game the terminal selection of cooperation in this game is influenced by the founder effect such as the founder cell density and the founder frequency of cooperators and the migration ability of individuals cooperation is more readily favored under lower cell density fig 5 d lower migration rate fig 5 e and higher initial frequency 18 since these situations will reduce the probability for cooperators to escape from defectors to establish local spatial segregation to identify which one between c and d is more advantageous for evolution of cooperation which is crucial to disclose the fundamental cause for the evolution of cooperation we further explored the selection outcomes of cooperation for c d const figs 5 f g simulations show an evolution law that the probability that cooperation can evolve in prisoner s dilemma games linearly increases with the reduction in growth rate of defectors although the total benefits defectors can get from cooperators and themselves are constant this law illustrates that the maintenance of cooperation is achieved more readily through enhancing the self proliferation advantage of cooperation relative to defection a d rather than reducing the benefits that defectors acquire from cooperators 7 figure 4 2 d on lattice simulation evolutionary dynamics of cooperation in prisoner s dilemma linear range expansion cooperation is gradually selected due to the spatial segregation generated by the higher self proliferation of cooperators n 20 and m 0 1 h 1 elements a b c and d i e growth rates in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 figure 5 prisoner s dilemma games between cooperator and defector strains a illustration of spatial segregation created by the proliferation of individuals b evolution of the population length in y direction when cooperators and defectors are grown individually growth rates of cooperators and defectors are 0 3 h 1 and 0 1 h 1 n 20 and m 0 1 h 1 respectively c evolutionary dynamics of cell number at the root of expanding frontier growth rates in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 d e evolutionary dynamics of the prisoner s dilemma games under different d cell density n m 8 0 1 h 1 and e migration rates m h 1 n 20 initial cell number of both cooperators and defectors is controlled as 5 per deme f g evolution probability of cooperation f vs c d const and g vs d in prisoner s dilemma each point is tested for 10 rounds n 20 and m 0 1 h 1 the inherent self reproduction advantage of cooperators which establishes spatial segregation geographical isolation from defectors plays a significant role in promoting the evolution of cooperation to enhance it is a more effective channel than to weaken the benefit capture of defectors from cooperators such a mechanism is simple as it does not require the organism to have the ability of implementing complex protective mechanisms like kin selection we need to stress that the fundamental evolutionary advantage of cooperation in range expansion lies in the higher self proliferation ability of cooperators themselves resulting from the individual cooperative behavior with which cooperators are able to colonize virgin space in advance this result is important as it shows that conducting cooperative behavior without retaliation e g tit for tat strategy 31 32 is still favored 4 2 chemotaxis effect on the evolution of populations chemotaxis behavior the directed motion guided by beneficial chemical cues is a fitness enhancing mechanism exhibited by many organisms from bacteria 33 to insects 34 to animals 35 chemotaxis is a product of natural selection and intuitively one might expect chemotaxis to promote the evolution of populations however we identified a counterintuitive observation on the competition outcome between cooperators and defectors during radial range expansion fig 6 figure 6 2 d on lattice simulation of the radial range expansion e coli strains chemotaxis effect on the evolution of cooperation in prisoner s dilemma a deme represents a small population located on a spatial lattice a evolutionary games with the incorporation of chemotaxis of single cooperators and lower migration rate of individuals m 0 1 h 1 with an increase 9 in chemotaxis strength evolutionary outcome transitions from cooperation to defection b evolutionary games with the incorporation of chemotaxis of single defectors and higher migration rate of individuals m 0 5 h 1 with the increase in chemotaxis strength cooperation is increasingly favored c d illustration of the discrepancy between individual and population level profits at the expanding frontier c chemotaxis of cooperators cooperators might move into a deme location where no defectors exist but several cooperators might exist which reduces the probability of them colonizing virgin space in advance cooperation may not be favored by competition in such cases d chemotaxis of defectors defectors are more likely to move into the demes with more cooperators which will leave aside a minority of cooperators which are at low density to survive and reproduce and lead defectors to be in unfavorable situation parameters ka and kb represent the chemotaxis strength the population size of each deme n 20 growth rates in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 within the prisoner s dilemma defectors would cause damage to cooperators through social interactions between them we wanted to explore what would happen if cooperators or defectors have an extra ability to evade their opponents defectors or chase after benefits cooperators through chemotactic movement in our simulations we assume defectors can release some chemical with which cooperators tend to move away from defectors at the same time defectors can use the chemicals released by cooperators to track cooperators for more benefits see section 2 2 we observe that chemotaxis of individuals impedes rather than promotes their competition with opponents at the population level figs 6 a and 6 b as in fig 6 a cooperation can be selected during range expansion if the spatial segregation can be established in a timely manner 18 e g under the low migration rates which means less frequent encounters with defectors when the chemotaxis of cooperators is incorporated with an increase in chemotaxis strength evolution outcome is observed to transition from cooperation into defection similarly in fig 6 b defection is selected under a higher migration rate of individuals when no chemotaxis is involved with the incorporation of chemotaxis of defectors and the increase in chemotaxis strength natural selection increasingly favors cooperation the phenomenon above is not very hard to understand since natural selection is a short sighted process 15 without chemotaxis both cooperators and defectors tend to colonize virgin habitat in the expansion direction of their populations move in the strategic direction figs 6 c d in such situations individual profits are nearly consistent with their populations with the involvement of chemotaxis however each cooperator and defector have their own judgment on personal profits based on directed motion which will reduce the fit between the interests of individuals and populations as shown in fig 6 c cooperators tend to evade defectors through the chemotactic movement in such a case moving to locations without defectors is the most beneficial to cooperators however such a situation will cause cooperators to have a probability to move into a deme location where no defectors exist but several cooperators have existed compared with singly migrating into the virgin space without both cooperators and defectors in the range expansion direction when no chemotaxis is involved the involvement of the chemotactic movement reduces the probability of cooperators colonizing virgin space in advance in considering the prisoner s dilemma however the evolutionary advantage for cooperation is to colonize virgin space in the range expansion direction fig 4 cooperation may not be favored by competition in such cases in fig 6 d defectors are more likely to move into the demes with more cooperators through the chemotactic movement which will leave aside cooperators at the low density to survive and reproduce defectors will be always directed by cooperators in this case and are therefore in unfavorable position in evolution our result demonstrates that there is a conflict between individual and population level interests figs 6 c and 6 d and in the competition between populations an individual s evolutionary advantage might not be that of a population instead it may even become deleterious to a population s evolution and the short 10 sighted selfish behaviors of individuals may not be that favored as we expect this situation sets a higher requirement for the evolution of populations figure 7 2 d on lattice simulation evolutionary games between cooperators and defectors in prisoner s dilemma for varying cell density n and chemotaxis strength ka only the chemotaxis of cooperators is included growth rates in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 migration rate of individuals m 0 1 h 1 ka n 0 0 1 0 3 1 2 15 10 frequency 25 40 60 migration rate m 0 1 h 1 11 figure 8 2 d on lattice simulation evolutionary games between cooperators and defectors in prisoner s dilemma for varying cell density n and chemotaxis strength kb only the chemotaxis of defectors is included growth rates in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 migration rate of individuals m 0 5 h 1 we further check the effect of cell density n phase diagrams figs 7 and 8 show again that higher cell density will improve the difficulty for cooperators to outcompete defectors as analyzed in fig 5 d such an effect causes lower chemotaxis strength for cooperators to transition the evolutionary outcome from cooperation to defection fig 7 but higher chemotaxis strength for defectors to transition the evolutionary outcome from defection to cooperation fig 8 as in fig 7 where only the chemotactic movement of cooperators is involved defectors can outcompete the game only if ka 2 when n 15 but this requirement kb n 0 0 3 0 4 0 5 1 10 frequency 15 25 40 60 migration rate m 0 5 h 1 12 for defectors is reduced to ka 0 3 when n 25 for the case that only the chemotaxis of defectors exists fig 8 the requirement for cooperators to defeat defectors is improved from kb 0 3 for n 15 to kb 1 for n 40 5 summary cooperation is responsible for biological organizations at all levels explaining cooperation is not straightforward since cooperation is usually believed to have a smaller competitive advantage than selfish behaviors like defection although many theories have been proposed to explain cooperation cooperation s evolution is still an open question we stress here that the inherent self reproduction advantage of cooperators relative to defectors plays a fundamentally important role in promoting the evolution of cooperation in range expansion this advantage leads cooperators to rapidly colonize virgin space in advance and establish the spatial segregation from defectors which further promotes the evolution of cooperation we show that enhancing this advantage is a more effective channel than dampening the benefit acquisition of defectors from cooperators we also identify an interesting ecological mechanism that in games between populations the fitness enhancing chemotactic movement of individuals impedes the evolution of the population this suggests that an individual s evolutionary advantage e g the chemotaxis might not be that of a population and it can even be deleterious to the evolution of the population as there is a conflict between an individual s and the group s fitness these results give deeper insights into the evolution of cooperation references 1 west s a griffin a s gardner a evolutionary explanations for cooperation curr biol 17 r 661 r 672 2007 2 asfahl k l schuster m social interactions in bacterial cell cell signaling fems microbiol rev 41 92 107 2017 3 nowak m a five rules for the evolution of cooperation science 314 1560 1563 2006 4 nash j f equilibrium points in n person games proc natl acad sci usa 36 48 49 1950 5 hamilton w d the evolution of altruistic behaviour am nat 97 354 356 1963 6 hamilton w d the genetical evolution of social behaviour i ii j theor biol 7 1 52 1964 7 trivers r the evolution of reciprocal altruism q rev biol 46 35 57 1971 8 ohtsuki h hauert c lieberman e nowak m a a simple rule for the evolution of cooperation on graphs and social networks nature 441 502 505 2006 9 preussger d et al reciprocal fitness feedbacks promote the evolution of mutualistic cooperation curr biol 30 1 11 2020 10 wynne edwards v c animal dispersion in relation to social behaviour oliver and boyd edinburgh 1962 11 wilson d s a theory of group selection proc natl acad sci usa 72 143 146 1975 12 traulsen a nowak m a evolution of cooperation by multilevel selection proc natl acad sci usa 103 10952 10955 2006 13 a gardner group selection oxford bibliographies in evolutionary biology oxford university press 2018 14 sigmund k hauert c nowak m a reward and punishment proc natl acad sci usa 98 10757 10762 2001 15 west s a et al social evolution theory for microorganisms nat rev microbiol 4 597 607 2006 16 nadell c d foster k r xavier j b emergence of spatial structure in cell groups and the evolution of cooperation plos comput biol 6 e 1000716 2010 17 korolev k s the fate of cooperation during range expansions plos comput biol 9 e 1002994 2013 18 van dyken j d et al spatial population expansion promotes the evolution of cooperation in an experimental prisoner s 13 dilemma curr biol 23 919 923 2013 19 datta m s et al range expansion promotes cooperation in an experimental microbial metapopulation proc natl acad sci usa 110 7354 7359 2013 20 korolev k s et al genetic demixing and evolution in linear stepping stone models rev mod phys 82 1691 1718 2010 21 korolev k s et al a quantitative test of population genetics using spatiogenetic patterns in bacterial colonies am nat 178 538 552 2011 22 mitri s xavier j b foster k r social evolution in multispecies biofilms proc natl acad sci usa 108 10839 10846 2011 23 klopfstein s currat m excoffier l the fate of mutations surfing on the wave of a range expansion mol biol evol 23 482 490 2006 24 hallatschek o et al genetic drift at expanding frontiers promotes gene segregation proc natl acad sci usa 104 19926 19930 2007 25 hallatschek o nelson d r population genetics and range expansions phys today 62 42 47 2009 26 m ller m j i et al genetic drift opposes mutualism during spatial population expansion proc natl acad sci usa 111 1037 1042 2014 27 mitri s clarke e foster k r resource limitation drives spatial organization in microbial groups isme j 10 1471 1482 2016 28 you l et al programmed population control by cell cell communication and regulated killing nature 428 868 871 2004 29 allee w c et al schmidt principles of animal ecology saunders philadelphia 1949 30 dai l et al generic indicators for loss of resilience before a tipping point leading to population collapse science 336 1175 1177 2012 31 nowak m a sigmund k tit for tat in heterogeneous populations nature 355 250 253 1992 32 nowak m a sigmund k a strategy of win stay lose shift that outperforms tit for tat in the prisoner s dilemma game nature 364 56 58 1993 33 budrene e o berg h c complex patterns formed by motile cells of escherichia coli nature 349 630 633 1991 34 o halloran d m burnell a m an investigation of chemotaxis in the insect parasitic nematode heterorhabditis bacteriophora parasitology 127 375 385 2003 35 krieger j breer h olfactory reception in invertebrates science 286 720 723 1999 acknowledgements this work is supported by zhejiang university national natural science foundation of china and the research builds on research on the calibration of gene expression experiments funded by the uk bbsrc bb e 001742 1 we are grateful to comments from antonio marco on an earlier version of the manuscript author contributions x w conceived this research developed models implemented theoretical calculations and data analysis and wrote the paper a h evaluated the article provided revision suggestions and contributed to the writing all authors participated in discussion conflict of interest the authors declare no conflict of interest data and materials availability all calculation data are available from x w upon reasonable request