ar x iv 2 11 0 03 83 1 v 2 m at h p r 9 n ov 2 02 1 the stefan problem and free targets of optimal brownian martingale transport inwon c kim and young heon kim abstract we formulate and solve a free target optimal brownian stopping problem from a given distribution while the target distribution is free and is conditioned to satisfy a given den sity height constraint the solutions to this optimization problem then generate solutions to the stefan problem for both supercooled fluid freezing st 1 and ice melting st 2 depending on the type of cost for optimality the freezing st 1 case has not been well understood in the literature beyond one dimension while our result gives a well posedness of weak solution in general dimensions with naturally chosen initial data the cost is a lagrangian type integral along path where the lagrangian function satisfies strict time monotonicity increasing type i or decreasing type ii type i case corresponds to the freezing fluid while type ii to the melting ice the optimal stopping time is characterized by the hitting time to a certain monotone barrier set in the space time while the optimal target distribution saturates the density constraint the barrier sets are determined by the type of the cost and the initial distribution and give the space time free boundaries of the flow for the stefan problems st 1 st 2 the free target optimization problem exhibits monotonicity from which a remarkable universality follows in the sense that the optimal target distribution is independent of the cost or its type this gives a new connection between the freezing and melting stefan problems contents 1 introduction 2 2 preliminaries 6 3 properties of stopping times 10 4 stopping times and potential flows 16 5 consistency with the stefan problem 25 6 subharmonically generated sets 28 7 optimal target problem 30 8 saturation property of the optimal target 36 9 global time existence of supercooled stefan problem 41 10 monotonicity of the optimal barrier functions 45 date november 10 2021 ik is partially supported by nsf dms 1900804 and simons foundation yhk is partially supported by the natural sciences and engineering research council of canada nserc as well as an exploration grant from the new frontiers in research fund nfrf this work has been initiated while ik was visiting ubc under the pacific institute for the mathematical sciences pims distinguished visitorship january may 2020 we thank pims for their warm support 2021 by the author all rights reserved 1 http arxiv org abs 2110 03831 v 2 2 inwon c kim and young heon kim references 50 1 introduction given a configuration of agents subject to a random motion what would happen if they try to stay under a given allowed population density height f in particular while trying to optimize their collective dynamics in the present paper we consider the brownian motion wt in rd and the collective dynamics is controlled only by a stopping time that is when each random particle stops precisely we consider the following problem 1 1 consider a nonnegative function f l rn given an absolutely continuous compactly supported measure on rn find a stopping time and its distribution w that solve pf inf c w 0 w f is compactly supported 1 1 notice that here we do not assume that are probability measures so the expression w 0 and w should be understood as for each measurable set e e prob w e w 0 x d x the problem 1 1 obviously requires some condition for f because if f is too small there will be no admissible we consider those cases where there is at least one admissible our model case is f 1 on rd however a much more general f can be considered we are particularly interested in the cost c of the lagrangian form c e 0 l bt t dt for a continuous l rd r 0 r 0 1 2 this problem is in the spirit of what is studied in constrained transport in particular for analyzing congested crowd motion see e g 47 32 1 and tumor growth see e g 43 35 which is subject to contact inhibition the problem 1 1 can be viewed as brownian martingale version of the optimal transport free target problem with upper bound of 32 in those cases the dynamics have less restricted to allow free drift making the optimal dynamics deterministic additional noise to their dynamics would generate stochastic aspects in our problem the dynamics is restricted only to the brownian motion but with freedom for stopping time such dynamics is called brownian martingale throughout this paper we make assumptions on the cost c 1 2 0 l d for some constant d and 1 3 t 7 l t is either strictly increasing type i or strictly decreasing type ii 1 4 we obtain existence uniqueness and characterization of the optimal solution of problem 1 1 see theorem 7 4 remarkably the problem exhibits universality see theorem 7 6 namely the the stefan problem and optimal brownian martingale transport 3 resulting optimal target does not depend on a particular choice of the function l as long as l satisfies either of the monotonicity assumptions these are due to monotonicity properties of the problem regarding the optimal stopping and target theorem 7 1 which also give l 1 contraction theorem 7 8 and bv estimates for theorem 7 10 such monotonicity is a novel feature resulting from not fixing the target distribution but treating it as the solution of the problem another important feature of problem 1 1 is that the optimal solution also the mass flow t of wt toward it saturates the constraint f theorem 8 3 wherever possible the free target feature of problem 1 1 distinguishes it from the more well studied so called optimal skorokhod problem see e g 10 29 28 31 30 as well as the 1 dimensional results considered by 37 16 25 18 where optimal stopping times are studied for given fixed initial and target measures and without the density constraint f that is p inf c w 0 w 1 5 solutions to problem 1 5 solve the skorokhod problem 49 44 6 45 4 23 42 41 for which a connection to optimal transport was hinted in the work of 34 and established in 10 who used optimal transport theory see e g the books 51 52 46 and randomized stopping times to unify all the previous know solutions of the skorokhod problem as the solutions of 1 5 we also mention that optimal skorokhod problem is a special case of the optimal martingale problem see e g 50 8 22 9 33 27 5 28 and references therein which has been recently popularized in mathematical finance as a main application we combine the above mentioned results for problem 1 1 with the pde methods developed in 29 for 1 5 to make progress in the supercooled stefan problem a free boundary problem of the heat equation which has been poorly understood in the literature the supercooled stefan problem describes freezing of supercooled water into ice and can be written in divergence form as st 1 0 t 0 here denotes the temperature of the supercooled water and thus the set 0 is the region for the supercooled water the solution of st 1 is famously known to exhibit irregular fractal like interfaces that could jump discontinuously over time this is in sharp contrast to the stefan problem for melting ice into water st 2 0 t 0 which can be viewed as a singular nonlinear parabolic equation of the form t 0 with an increasing function see 2 where one proves comparison and contraction properties of weak solutions based on this property while st 2 is known to generate stable and regularizing solutions 2 3 15 solutions of st 1 are shown to develop discontinuity and non uniqueness in finite time even in one space dimension and with smooth initial data 48 14 for higher dimensions the global existence of weak solutions for st 1 has stayed largely open 4 inwon c kim and young heon kim it is natural to consider these problems as generated by a particle system which diffuses but stops its motion when it hits the interface between water and ice in one space dimension there has been several works which construct solutions of st 1 as a continuum limit of such particle systems including 12 13 36 19 20 in higher dimensions the global time existence of solutions for st 1 has remained open due to the difficulty of obtaining a stable deterministic limit 40 such an existence theorem is what we establish in this paper similar to aforementioned works we also consider solutions based on brownian particles with hitting times but with optimization indeed a novelty of our approach lies in the op timization structure given by problem 1 1 for the choice of stopping time and the final target distribution the optimality gives a certain regularizing effect to the solution of problem 1 1 and it generates a stable and physically meaningful solutions of both st 1 and st 2 the method and results are valid for general dimensions in particular for st 1 we obtain the following results a theorem 9 3 and corollary 9 11 for uniformly larger than 1 in its support there exists a unique weak solution of st 1 that vanishes in finite time b theorem 9 6 and corollary 9 12 for compactly supported there exists a unique weak solution of st 1 that vanishes in finite time except in the support of similar results hold for st 2 theorem 9 2 the weak solutions in the above results will correspond to the distribution of active brownian particles associated with the optimal stopping times obtained from 1 1 with f 1 for a and f rn supp for b these results rely on a rigorous connection that we establish between the weak solution and the optimal brownian stopping see theorems 5 4 and 5 6 our results also explain the well known non uniqueness for the freezing case see the discussion in section 6 especially proposition 6 3 in connection to the stefan problem we can understand our upper constraint problem 1 1 in the context of freezing and melting for costs of type i the initial distribution can be viewed as the freezing energy of supercooled liquid or in other words the negative temperature distribution of the supercooled heat particles for costs of type ii we view as some distribution of energy that activates the heat particles the upper constraint f should stand for the latent supercooling or heat energy corresponding to the available transition energy that the flow from needed to yield for the freezing or melting to occur in other words f prescribes the maximal amount of stopped brownian particles a given location can accommodate the monotonicity types of the cost i ii correspond to st 1 st 2 respectively while i and ii generate different optimal stopping times we prove that their target measure is independent of the cost or even of its monotonicity type theorem 7 6 using this rather remarkable universality we are able to characterize the initial trace of the solutions given in a and b above we refer to section 9 for further discussions 1 1 the connection between the stefan problem and problem 1 1 the present paper relies on the previous works on the optimal skorokhod problem 1 5 notice that after getting the optimal target in problem 1 1 finding the optimal stopping time is reduced to the stefan problem and optimal brownian martingale transport 5 solving 1 5 with and it is shown 10 29 that the solution to 1 5 is the first hitting time of wt t to a space time barrier r which enjoys time monotonicity such a barrier set can be defined by a barrier function s such that r x t s t t for type i and r x t s t t for type ii our results above imply that the free boundary of the stefan problem at time t corresponds to the boundary of the time t slice of r that is x x t r in fact to derive our well posedness of the stefan problem st 1 st 2 it is crucial for us to verify that r is a closed set so its complement rc is open this can be handled by theorem 4 14 which connects the barrier set of to a closed set generated by the potential function u t of the mass flow of wt under interestingly its proof essentially uses the eulerian method in 29 we remark that in the type i case theorem 4 14 can be derived even in a sharper form based on 26 they showed that the hitting time to a type i barrier set coincides with the stopping time generated by the corresponding potential flow for a general class of stochastic processes 26 the pde methods of 29 is based on the correspondence between stopping time and its eulerian flow given on the space time that describes the distribution of wt t before stopping by and the stopped distribution of mass of w this solves weakly t 1 2 moreover under the assumptions 1 3 1 4 the resulting from a solution of p 1 5 yields that is formally supported on the boundary of the active region 0 29 assuming sufficient regularity should be concentrated on the boundary of the barrier set which is also the boundary of the active region 0 thus 0 t or 0 t depending on the monotonicity of the set 0 over time and we end up with the weighted stefan problem 1 6 0 t 1 2 0 where is the target measure for the optimal stopping time this equation has been formally considered for a given fixed target measure in 29 and our theorem 5 4 and 5 6 provide a rigorous justification the saturation result theorem 8 3 is crucial for the connection between problem 1 1 and the stefan problem st 1 st 2 it gives 1 when f 1 in the active region so it reduces the above equation 1 6 to st 1 st 2 for type i ii respectively 1 2 further remarks a novel element of our approach lies in combination of lagrangian and eulerian point of view as we use both probabilistic arguments using brownian paths and pde arguments using their eulerian coordinates to obtain basic topological properties it seems that the closedness of the barrier set r for type i is new while understanding further regularity of the free boundary for the corresponding supercooled stefan problem st 1 is a wide open problem in this direction we prove a strict monotonicity result for the barrier 6 inwon c kim and young heon kim function s a version of comparison principle which may shed a light on the challenging ques tion see theorems 10 1 and 10 2 this is a novel feature of problem 1 1 as it is a consequence of the optimization of the free target distribution as a byproduct of our approach we define the notion of subharmonically generated sets in section 6 which connects the brownian stopping time and existence of the solution to the supercooled stefan problem st 1 it is a pair e of sets determined by a certain type of brownian stopping time from an initial measure definition 6 1 the solvability of st 1 with the initial data e is determined by whether there is such that e is subharmonically generated from theorem 6 2 this notion is used to describe unique solvability of st 1 and also to characterize vanishing in finite time solution of it in section 9 theorem 9 9 and corollaries 9 11 and 9 12 the main results in this paper appear rather surprising given the lack of understanding in the literature on multi dimensional solutions of st 1 in a subsequent work we will further develop our method to extend well posedness theory for st 1 to more general initial bound aries also the connection remark 9 5 between st 1 and st 2 that we find in this paper seems to be unexpected and understanding this connection at a more physical level is an interesting open problem it would also be interesting to understand the physics behind why type i corresponds to freezing and type ii to melting in this paper our method for finding the optimal target is solely based on optimizing with probability measures we do not consider duality which is a powerful tool for understanding optimal brownian stopping though we heavily rely on the results from 29 that are obtained via solving the dual problem of the fixed target case to find the barrier set of the optimal stoping time our free target problem gives a new aspect to the duality that we will discuss in a subsequent work acknowledgments we thank mathav murugan for various help regarding probabilistic as pects we also thank paul gassiat for helpful comments on section 4 2 preliminaries throughout this section we assume for simplicity that the measures and are compactly supported in rd much of the discussion and notation in this section is borrowed from 29 which gives foundational results for the development given in this paper note that the purpose of this section is to collect the precise definitions and results necessary for the discussion in the subsequent sections we try to include the least amount of information 2 1 notation wt denotes the brownian motion whilew y t denotes the brownian motion withw 0 y br x denotes the ball of radius r centered at x a b min a b for each borel measurable set s rd s denotes its d dimensional lebesgue measure lsc the set of lower semi continuous functions on rd h 10 the sobolev space on r d the stefan problem and optimal brownian martingale transport 7 2 2 randomized stopping times and optimal skorokhod problem in rn related to problem 1 1 it is important to understand the notion of stopping times and randomized stopping times 2 2 1 stopping times and randomized stopping times consider the filtered probability space f ft t r 0 p where c r 0 r d p the wiener measure with initial distribution and ft t r 0 the natural filtration of the brownian motion let m r 0 denote the space of radon measures on r 0 a randomized stopping time 7 39 is a measure valued random variable 7 m r 0 such that as a measure on r 0 0 r 0 1 and the map 7 0 t is ft measurable t along each brownian path mass is dropped according to the distribution on r 0 determined by the randomized stopping time a stopping time r is a random variable such that for each t t is ft measurable it can be understood as a special case of randomized stopping time where the measure on each path is a dirac mass at the value in r 0 to distinguish the different between randomized stopping time and stopping time we often call the latter nonrandomized we will say that a subset q r is almost sure for a randomized stopping time if e r 1 t q d 0 where 1 is the indicator function of the set often this will appear instead as an abbreviated form i e 1 t 1 t q where is a stopping time and q t t we abbreviate a randomized stopping time by in the sense that e f e r 0 f t dt the we say is the distribution of the randomized stopping time that is w if e g w g z dz continuous g from now on we abuse notation and use denote either stopping time or randomized stopping time 2 2 2 subharmonic order and optimal skorokhod problem subharmonic order relates two mea sures from the point of the brownian motion first f is a subharmonic function on an open set o in rd if it is upper semicontinuous with values on r and for every x o and every closed ball b in o with center at x it satisfies f x 1 b b f y dy when f is c 2 the latter condition is equivalent to f 0 on o where d i 1 2 x 2 i is the laplacian the reason why we specify the domain o is because subharmonic functions in o may not necessarily be extended to the whole set rd 8 inwon c kim and young heon kim two measures on rd with is said to be in subharmonic order sh if for each open set o containing supp x d x x d x for every smooth subharmonic function on o see e g 28 definition 1 2 it is known see e g 28 theorem 1 5 that for compactly supported and as we assume throughout the paper we have sh if and only if there exists a randomized stopping time for the brownian motion with w 0 and w with e for such and for any lower semicontinuous cost functional c for the stopping times one can find an optimal randomized time between and using the compactness of the space of randomized stopping times this has been observed by beiglebo ck cox and huesmann 10 in fact it is a nontrivial problem to see that such optimal randomized stopping time is indeed a stopping time non randomized to solve the problem p 1 5 this has been proved under the assumptions on the cost 1 3 and 1 4 for other types of cost for example the one based on the distance c e w 0 w similar results have been proved in 31 see also 30 theorem 2 1 existence uniqueness of optimal skorokhod problem 10 29 given com pactly supported measures on rd with sh and leb the optimal skorokhod problem p 1 5 with the cost c in 1 2 under the assumption 1 3 and 1 4 has a unique optimal stopping time which is not randomized in the type i case and in the type ii case randomized only at t 0 in the latter case w 0 x and 0 occurs with probability x x moreover there exists a space time barrier set r rd r 0 such that is given by the hitting time to r that is inf t wt t r in type ii case it holds for those paths with 0 for our purpose it is important to understand the barrier set r it can be characterized by using the dual solutions of p in 29 they used dynamic programming principle to establish the duality p d where d sup lsc rd z dz rd j x 0 dx here the function x t 7 j x t is called the value function which is the result of dynamic programming j y t sup e w y 0 l t s w ys ds where are randomized stopping times then it is shown 29 that under the assumptions in theorem 2 1 in fact for more general and there exists an optimal dual function lsc h 10 the barrier set r then is given by r x t j t x x rn r 0 2 1 the stefan problem and optimal brownian martingale transport 9 the strict monotonicity assumption on l 1 4 for type i and ii implies forward or back ward time monotonicity of the set r namely r x t t s x for type i r x t t s x for type ii where the function s called the barrier function and the stopping time is given by s x inf t r j t x x inf t t s wt for type i s x sup t r j t x x inf t t s wt for type ii 2 3 eulerian formulation it is important for us to relate the brownian motion with stop ping time with its corresponding mass flow which we call eulerian flow considering such eulerian formulation and effectively using it to analyze optimal stopping times is one of the main innovations of 29 an eulerian flow for us is a pair of measures on rd r 0 such that in the weak sense t x t t x 1 2 t x 2 2 r d x 0 x for a more precise description let o rd be a bounded open convex set that contains the supports of and pick the poincare constant of o we consider c r 0 o w c r o e tw t x 0 as t uniformly in x its dual space m r o is the finite radon measures with exponential decay we let c 1 2 r o denote the functions whose first derivative in time and second derivatives in space lie in c r o then following 29 we shall say that is an admissible pair provided m r o and 0 and they satisfy the following two equations o u z dz o r u x dt dx for all u c o 2 3 o w 0 y dy o r t w t x 1 2 w t x dt dx 2 4 o r w t x dt dx for all w c 1 2 r o let us translate the brownian stopping into eulerian flow proposition 2 2 see 29 proposition 2 2 given and compactly supported with leb suppose is a stopping time with w 0 w then there is an admissible pair of measures on rd r 0 such that for every g cc r d r 0 e g w o r g t x dt dx 10 inwon c kim and young heon kim and e 0 g t wt dt o r g t x dt dx this gives equivalence between the optimization problem for the stopping time and the one for the eulerian flow 29 p p 1 inf rd r l t x dt dx where s are admissible pairs we close this section with an essential lemma for us to consider the eulerian flow in the context of the barrier of the stopping time it will be later used in section 4 lemma 2 3 29 lemma 4 5 suppose leb is a compactly supported measure and r rd r 0 let be admissible with the condition r 0 and r 1 we suppose r is a measurable forward barrier namely r x r whenever t x r with t r and t x r if there is ti x r with ti t then is unique if instead r is a measurable backward barrier namely r x r whenever t x r with t r and t x r if there is ti x r with ti t then is uniquely determined given the value of on the set 0 x where s x 0 remark 2 4 let us comment on why the additional condition r 0 r 1 to the corresponding pde 2 4 is sufficient to determine the unique solution because r 1 for the probability measure we have rc 0 therefore the 2 4 behaves like the heat equation for in rc with the dirichlet condition which is due to r 0 therefore the uniqueness is not surprising especially if r is closed so rc is open in fact we will show that we can take r as a closed set see section 4 theorem 4 14 3 properties of stopping times in this section we prove several basic but important results for the properties of hitting times as well as optimal stopping times we handle the general case where the barriers are merely measurable sets say not open or closed this may be of its own interest for the present paper because of section 4 see thereom 4 14 it suffices to consider only the case where the barrier set is closed in which case some proofs of this section can possibly be simplified results in this section may possibly be known to experts however we were unable to find a suitable reference 3 1 properties of stopping times with respect to a barrier set we first recall the following result from potential theory lemma 3 1 let z is the distribution of the stopped brownian motion starting at z by the first hitting time to the round sphere br of radius r centered at 0 let be the surface measure of br suppose z 2 r or z 1 2 r then there exists a universal constant c 0 depending only on the dimension such that the radom nikodym derivative satisfies d z d c the stefan problem and optimal brownian martingale transport 11 in particular for the brownian motion w zt starting from z and for the first hitting time to the sphere br we have prob w z e c e br for any e br proof as the brownian motion is scaling invariant it is sufficient to consider the case r 1 then the desired upper bound should be a standard result of potential theory this is a consequence of dahlberg s theorem 17 using this lemma we now prove a key lemma which takes care of a subtle possibility that brownian paths blocked by a barrier set may possibly drop mass in the set the lemma says it should not happen when the final distribution is absolutely continuous another equivalent interpretation is that if it takes some time for brownian particles from to reach g then the particles should spread over g before stopping or should be singular we consider probability measures and satisfying 3 1 leb and f for a bounded measurable function f in rd lemma 3 2 for probability measures and satisfying 3 1 let be a randomized stopping time with w 0 and w let g be a measurable set and let g be the first hitting time to g that is g inf t wt g suppose g and g 0 then g 0 remark 3 3 notice that the condition f especially leb is essential in lemma 3 2 for example consider the distribution w of the brownian motion of the hitting time to a sphere g does not satisfy the result of this lemma proof suppose g 0 for contradiction then there exists 0 such that the set g z g d dx has g 0 consider a lebesgue point x of g where the lebesgue density is 1 then for each small 0 there exists r 0 depending on such that the following holds br x 2 br x g br x 1 br x for all 0 r r from the fubini s theorem there are 0 r 1 r 2 r with 8 r 1 r 2 10 r 1 such that hd 1 g bri x 1 5 h d 1 bri x i 1 2 from lemma 3 1 for a dimensional constant c we have prob w 6 br 2 x wt b 4 r 1 x for some t c since for the brownian path from a point inside b 4 r 1 x to go outside br 2 x it has to go through br 2 x but avoiding hitting g thus g therefore prob w br 2 x wt b 4 r 1 x for some t 1 c by a similar argument of using the same lemma we get prob w br 1 x wt b 4 r 1 x b 2 r 1 x for some t c 12 inwon c kim and young heon kim now let us consider br 1 x prob w br 1 x prob w 0 b 2 r 1 x prob w br 1 x w 0 6 b 2 r 1 x i ii notice that i b 2 r 1 x b 2 r 1 x from the assumption g 0 and the choice of x on the other hand from continuity of brownian paths for the brownian path from a point outside b 2 r 1 x to arrive in br 1 x it first needs to arrive in b 4 r 1 x b 2 r 1 x therefore ii prob w br 1 x wt b 4 r 1 x b 2 r 1 x for some t prob w br 1 x wt b 4 r 1 x b 2 r 1 x for some t prob wt b 4 r 1 x b 2 r 1 x for some t also notice that br 2 x prob w br 2 x prob w br 2 x wt b 4 r 1 x for some t prob wt b 4 r 1 x for some t combining all these with the previous probability estimates with we see that ii c 1 c br 2 x which implies br 1 x i ii b 2 r 1 x c 1 c br 2 x recall that br 1 x br 1 x is bounded and that the volumes br 1 x b 2 r 1 x and br 2 x are all comparable up to a constant factor depending only on the dimension then we get a contradiction by letting 0 this completes the proof there are several important consequences of lemma 3 2 an immediate consequence is this corollary 3 4 let be as given in lemma 3 2 in addition suppose that is given as the first hitting time to the barrier function s that is a measurable function s rd r 0 such that inf t t s wt in i case or inf t t s wt in ii respectively let g x s x 0 in i case g x s x in ii case respectively assume f 0 then g 0 proof notice that g inf t wt g from the definition of and g therefore the result follows from lemma 3 2 later in this section we will need another technical fact regarding stopping times the stefan problem and optimal brownian martingale transport 13 lemma 3 5 let be a stopping time suppose that g is a measurable set with positive measure and every point of g has lebesgue density larger than a 0 let d 0 be a countable dense subset such that for each fixed constant t d prob wt g t 0 3 2 let g inf r 0 wr g then g almost surely proof first note that prob g prob t t wt g and prob t d t wt g prob t d t wt g t t wt g prob t t wt g we now show the following claim there exists a dimensional constant c 0 such that prob t d t wt g t t wt g c 2 0 proof of claim for each fixed t t and for given x wt the probability density for wt is nothing but the heat kernel at around x with time t t that is z cd t t d 2 e z x 2 t t also note that for fixed t t and for given wt x the event t is independent of the event wt g from the strong markov property of the brownian motion hence for each x g and for sufficiently small r 0 that depends on x we have prob wt g t wt x prob wt g wt x prob wt g br x wt x cd t t d 2 e r 2 t t g br x a 2 cd t t d 2 e r 2 t t br x where the last line follows since g has lebesgue density larger than a 0 now let r t t 1 2 then above computation yields lim t t prob wt g t wt x c 0 since d is dense this implies that for each 0 prob t d t t t wt g t wt g c 14 inwon c kim and young heon kim notice that for fixed t prob t t wt g 1 as 0 for 0 and thus prob t d t wt g t wt g c 2 0 since c is uniform over t we conclude that prob t d t wt g t t wt g c 2 as well verifying the claim the claim yields that prob t d t wt g c 2 prob g on the other hand since d is countable we have prob t d t wt g t d prob wt g t therefore if prob g 0 then there should exist t d such that prob wt g t 0 this contradicts 3 2 thus completing the proof remark 3 6 in lemma 3 5 the assumption that g consists of its lebesgue point is essential for example consider in r 1 and the interval g 1 3 4 and let g 0 g 1 let be the uniform distribution on the interval 1 2 1 2 one can find a stopping time and its distribution w 0 w such that is supported on 3 2 3 2 then because of the support of we have that g 1 therefore for each t 0 the probability prob wt g t prob wt 0 t 0 however on the other hand 6 g as brownian paths will pass through 0 before with positive probability lemma 3 5 together with lemma 3 2 give the following useful result corollary 3 7 let and be as given in lemma 3 2 and let g be a measurable subset of rd let d 0 be a countable dense subset such that 3 2 holds then either the support of overlaps with that of g or g 0 remark 3 8 notice that the condition f especially leb is essential in corol lary 3 7 in particular if g 0 then prob wt g t 0 for each constant t 0 when w 0 leb so if a singular measure supported on such zero lebesgue measure set for example the distribution w of the brownian motion of the hitting time to a sphere does not satisfy the result of this corollary proof the case g 0 is obvious since leb suppose g 0 and 0 in g we will show that g 0 let g be the set of lebesgue points of g since 3 2 remains valid for g lemma 3 5 yields g almost surely which then implies g 0 by lemma 3 2 as g 0 since g g for leb this completes the proof the stefan problem and optimal brownian martingale transport 15 we now focus on stopping times given as the hitting time to a barrier function s rd r 0 lemma 3 2 and its consequences give a useful characterization for such a stopping time which will play a key role later in the paper see for instance theorem 5 4 and section 10 roughly speaking the following proposition endows a certain regularity to the set x t t s x from the condition 3 1 by ensuring that the brownian particles stop only at the set nor above or below in t for instance proposition 3 9 let s rd r 0 be a measurable function and let be the hitting time to the barrier s that is inf t t s wt in the type i case inf t t s wt in the type ii case respectively assume w 0 w where satisfies 3 1 in the ii case further assume that 0 then 3 3 s w almost surely proof first recall that by 29 corollary 3 6 the stopping time occurs only in the barrier set thus if 3 3 is not true then prob s w 0 in the i case prob s w 0 in the ii case respectively then there exists q t 0 such that prob t s w 0 in the i case prob t s w 0 in the ii case respectively let us separate the i and ii cases 1 i case consider the set s x s x t and the distribution t of wt note that wt s implies that t therefore wt s is equivalent to w s and t which is then equivalent to s w t and t whose probability is strictly 1 due to prob t s w 0 therefore t s 1 thus the measure t t t s has a positive total mass t 0 we then start the brownian motion from the distribution t and initial time t we immediately stop if t otherwise we continue the brownian motion until we call this stopping time let denote that distribution ofw then from the condition leb we also have leb moreover from the definition of s and the fact prob t s w 0 we have s 0 on the other hand let s be the first hitting time to the set s for brownian motion starting from the time t with the initial distribution t notice that if wt s with t t then t t s wt by the definition of s therefore t thus t from the construction of the stopping time this implies that s from the construction of t we see that t leb and t s 0 therefore from lemma 3 2 we see that s 0 a contradiction this completes the proof in the i case 2 ii case let s x s x t let t and s inf t wt s notice that obviously if t t then t on the other hand if t t and wt s then s wt t so t 16 inwon c kim and young heon kim these imply that s moreover let be the distribution of that is w then from prob t s w 0 and the assumption 0 in this ii case there exists s 1 s such that s 1 0 and s 1 0 since s 1 0 and s s 1 we have from lemma 3 2 that s 1 0 a contradiction this completes the proof 4 stopping times and potential flows for each stopping time we can consider the time flow of distribution t of w t 0 t these distributions then define potential functions by solving the corresponding poisson equation the potential functions can be used back to study the stopping times which is especially beneficial because they have regularity properties coming from the elliptic regularity and ito s formula using potential functions to study stopping times has been considered in the literature starting from 6 for existence of brownian stopping times skorokhod problem and more recently for analyzing optimal stopping problems see 16 25 18 for one space dimension and 29 26 for higher dimensions the main result of this section theorem 4 14 shows that when is given by the hitting time to a barrier of type i or ii the barrier is a closed set which is a consequence from the correspondence between the stopping time and its potential flow we remark that in the type i case such correspondence a sharper form than ours is proved in 26 even for much more general class of stochastic processes closednesss of the barrier set is a key fact that will be used in section 5 where we establish the consistency of our probabilistic formulation of the stefan problem with the pde formulation 4 1 potential flows definition and regularity in this subsection we define the potential flow u t and establish its space time continuity corollary 4 9 let n y be the newtonian potential function on rd namely n y 1 2 y d 1 2 log y d 2 1 d 2 d d y 2 d otherwise where d is the volume of the unit ball in r d such that n y 0 given a measure define the potential u defined as u x n x y d y since u standard elliptic regularity theory yields the following lemma 4 1 spatial continuity assume that there are constants m r 0 such that m and 0 outside br then u c 1 rd c for any 0 1 with c c m r the stefan problem and optimal brownian martingale transport 17 remark 4 2 our main focus is on the stopping times generating a compactly supported w with the upper density constraint f for such the measure t the distribution of w t t is uniformly bounded with respect to t as t is bounded by the greater of the solution to the heat equation with initial value and f also the support of t is contained in the convex hull of the support of since the subharmonic order t sh implies convex order t c in what follows we thus focus on the case where the result of lemma 4 1 holds we now recall a simple consequence of ito s formula for each 0 g c 1 c r d consider a subharmonic function u c 2 such that u g note that one can find such u c 2 from elliptic regularity using ito s formula for each stopping time 0 we have e u w w 0 y u y e 0 1 2 u wt dt w 0 y e 0 1 2 g wt dt w 0 y in particular we can show lemma 4 3 suppose that is a probability measure on rd and w 0 and w i i i 1 2 and that the potentials u 1 u 2 are measurable functions assume that 1 2 then for each closed or open set e rd we have for the characteristic function e that 4 1 e u 2 u 1 y dy e 2 1 1 2 e wt dt in general for a measurable e there exists a monotonically increasing sequence of compact sets kn e with limn e kn 0 and monotonically decreasing sequence of open sets with e on and limn on e 0 such that e u 2 u 1 y dy lim n e 2 1 1 2 kn wt dt e 2 1 1 2 lim n kn wt dt e u 2 u 1 y dy lim n e 2 1 1 2 on wt dt e 2 1 1 2 lim n on wt dt proof 1 first let us consider the case where e is compact or open for a compact set e k there exists a monotonically decreasing sequence 0 gk c 1 c r d point wisely converging to k that is k infk gk indeed take a continuous function hk that equals d x e if d x e 1 k 1 if d x e 2 k and the linear interpolation 1 1 k d x e 1 k 1 k for 1 k d x e 2 k after mollifying this generates a monotone increasing sequence of c 1 functions that converges to 1 e when e o is open and bounded we can modify the above construction for k rd o br for r 1 to find corresponding gk k converging to o 18 inwon c kim and young heon kim now consider the subharmonic functions uk c such that uk gk we have e u 2 u 1 y dy lim k u 2 u 1 y gk y dy by the monotone convergence theorem lim k 2 1 y uk y dy integration by parts lim k e uk w 2 uk w 1 lim k e 2 1 1 2 gk wt dt by ito s formula where by the monotone convergence theorem applied to the wiener measure on the path space as the monotone convergence gk e can be extended to the path space the last line is the same as e 2 1 1 2 e wt dt 2 next for open or cloesd e consider er e br notice er e monotonically as r we can apply arguments in 1 for er and apply the monotone convergence theorem as r 3 now for a measurable e one can find a sequence of increasing compact sets k 1 k 2 k 3 contained in e such that limn e kn 0 and monotonically decreasing sequence of open sets with e on o 1 o 2 o 3 and limn on e 0 let en denote either the sequence kn or on then from the monotone convergence theorem applied to en we have e u 2 u 1 y dy lim n en u 2 u 1 y dy since for the sets en u 2 u 1 y dy e 2 1 1 2 en wt dt from the previous cases we get e u 2 u 1 y dy lim n e 2 1 1 2 en wt dt e 2 1 1 2 lim n en wt dt where for the last equality we applied the monotone convergence theorem to the wiener mea sure on the path space as the monotone sequence en can be extended to the path space this completes the proof the following is a standard fact but we provide its proof for the sake of exposition corollary 4 4 suppose is a bounded compactly supported measure on rd and that 1 2 are stopping times with the given initial distribution and let w i i i 1 2 then 1 2 implies u 1 u 2 moreover the equality holds if and only if 1 2 almost surely the stefan problem and optimal brownian martingale transport 19 proof the order immediately follows from lemma 4 3 for equality suppose u 1 u 2 we lemma 4 3 to e rd to obtain 0 rd u 2 u 1 y dy e 2 1 1 2 dt 1 2 e 2 1 hence e 2 1 0 since 2 1 we conclude that 2 1 almost surely remark 4 5 note that there are many stopping times with the same final distribution there fore u 1 u 2 without an assumption like 1 2 does not give much information now we define our potential flow definition 4 6 for compactly supported measures leb let be a stopping time between and that is w 0 and w we define t to be the distribution of the stopping time t that is w t t we then call u t t 0 as the potential flow associated with note that 0 and from corollary 4 4 we immediately have corollary 4 7 a u t is monotonically nondecreasing in t b u u t u for all t c u t pointwise converges to u and u respectively as t 0 and t we now prove continuity of the potential flow in time lemma 4 8 time continuity suppose c t l rd 0 and that the support of t is bounded uniformly in t then u t is lipschitz in time more precisely for each x 0 u t x u t x c 2 t t for all 0 t t proof recall from lemma 4 3 that for each open set e e u t u t y dy e t t 1 2 e wt dt the first inequality then follows from the spatial continuity of u t for the second inequality apply fubini in above equality to obtain 4 2 e u t u t y dy 1 2 t t prob wr e r dr notice that for each r 0 by definition of t prob wr e r r e since r c this and 4 2 implies 1 e e u t u t y dy c 2 t t now set e br x and let r 0 which completes the proof from lemma 4 1 corollary 4 4 and lemma 4 8 the following holds 20 inwon c kim and young heon kim corollary 4 9 space time lipschitzness of the potential assume that there exists a constant c 0 such that t c for all t 0 and that the support of t is bounded uniformly in t then u t is uniformly c 1 in space and lipschitz in time in rd 0 in particular the convergence in corollary 4 7 c is uniform 4 2 hitting times to monotone barriers and potential functions in this section we investigate the relation between the stopping time and the hitting time to a barrier set generated by the potential u t definition 4 10 for the potential flow u t t 0 given in definition 4 6 we define the time forward backward stopping times u f inf t u t wt u wt u b inf t 0 u t wt u wt we also define the corresponding barrier functions and the barrier sets as follows su f x inf t u t x u x r u f x t t su f x and su b x sup t u t x u x r u b x t t su b x note that because of the time monotonicity of u t as in corollary 4 7 we have u f inf t su f wt t u b inf t su b wt t 0 notice that the condition t 0 for u b is necessary otherwise u b 0 the potential flow u t can be defined for any stopping time even for randomized stopping time so the hitting times u f u b can be associated to any randomized stopping time on the other hand it is easy to see that and either of u f u b do not coincide in general even with a first hitting time it will not be equal to u f u b unless its barrier is monotone in time in case is indeed a hitting time to a time monotone barrier we verify that it is in fact equal to u f u b respectively depending on its monotonicity type this is proved in theorem 4 14 below to see why such equivalence is useful observe the following consequence of the continuity of potential flow lemma 4 11 assume t and its support is uniformly bounded for all t 0 then s u f and su b are lower semicontinuous thus the sets ru f and ru b are closed in rd 0 proof from corollary 4 9 the closeness of the barrier sets is essential in section 5 after we verify below that the optimal stopping time coincides with u f or u b depending on type i or ii of it will imply closedness of the barrier set for which then allow us to apply maximum principle in the pde formulation in section 5 note that the equivalence between and u f or u b is hinted in the formula 4 1 which is a consequence of ito s formula one sees there that more time spent for the brownian motion increases the potential function which is precisely controlled but only in integral expected the stefan problem and optimal brownian martingale transport 21 value sense thus it is not obvious how to use such a control on average quantities to get information for each brownian path we bypass this difficulty in two important steps first we show that the barrier set r of for example the set r for the optimal stopping time as in section 2 contains in a measure theoretic sense the barrier set ru f for costs of type i respectively ru b for costs of type ii this is basically a result of the ito s formula via lemma 4 3 proposition 4 12 let and be as given in definition 4 6 suppose is characterized as inf t t s wt for costs of type i sup t 0 t s wt for costs of type ii for a measurable function s rd r 0 then we have x s x su f x 0 for i and x s x su b x 0 for ii proof we will prove for costs of type i since the argument is parallel for the other case suppose not that is s su f 0 we can then find a constant t 0 such that e 0 where e x s x t su f x since leb this also means e 0 let us define w x t u x u t x from lemma 4 4 and definition of e we have w t 0 on e yielding e w y t dy 0 at the moment we only know that e is a measurable set for example we do not know continuity of s or su f su b but from lemma 4 3 there exists monotonically increasing sequence of compact sets kn e such that e w y t dy limn e t 1 2 kn wt dt limn 1 2 t prob wr kn r dr where the second equality is from fubini s theorem on the other hand recall that inf t t s x hence if wr e and r t then s wr t r and thus r therefore prob wr kn r prob wr e r 0 for each n back to the previous integrals and the limits this then implies that e w y t dy 0 a contradiction completing the proof definition 4 13 we let u commonly denote u f and u b depending on whether t is generated from type i or ii stopping time likewise we use ru as the corresponding barrier sets ru f and ru b and su corresponding to su f and su b 22 inwon c kim and young heon kim proposition 4 12 and 3 3 together imply that u it then implies that we may choose the barrier r of in such a way that r ru the opposite inclusion will show the equivalence between and u this is nontrivial due to unknown nature of regularity for the distribution of u in spite of the fact that most likely it is in fact for type i case from the result of 26 we have u to our knowledge such a result is not available for the type ii case what is necessary for us is a slightly weaker result namely that the set 0 is open which is important for the consistency results in section 5 we prove such a result for both type i and ii by employing the eulerian formulation that connects the brownian motion with stopping time with a parabolic flow theorem 4 14 see also 26 for type i let and be as given in proposition 4 12 for type ii assume that 0 almost surely then the eulerian variable that corresponds to satisfies 4 3 0 ru c in addition when 0 a on its support for a constant a we have 4 4 s su a e proof of theorem 4 14 from proposition 2 2 the stopping time induces its eulerian flow which satisfies 2 2 with r 0 and r 1 furthermore from 29 we have l 2 r h 10 r n let us denote w u u t for i and w u t u for ii for the rest of the proof we focus on type i as ii follows a parallel proof since w t at each t 0 w satisfies 4 5 w x x t x t 0 ds x in rd for type i now for g c r rd with g t cc r d for each t 0 consider solving t g t for each t 0 with decay at infinity using 2 2 for and 4 5 we integrate by parts to obtain rd r g x t t w x dtdx rd r t dtdx rd r 1 2 dtdx rd r 1 2 g x t x t dtdx therefore we have tw 1 2 in type ii the sign is opposite 4 6 let us continue arguing with i integrating 2 2 for in time from zero to infinity using the fact that a subsolution to heat equation with bounded initial data vanishes as t yields that 4 7 1 2 0 x s ds w x 0 the stefan problem and optimal brownian martingale transport 23 from this and 4 6 it follows that w x t 1 2 t x s ds since is nonnegative it follows that the set w 0 includes 0 namely 0 ru c on the other hand we already had u which follows from proposition 4 12 and 3 3 this means that without loss of generality we can assume that r ru or in other words the barrier r of can be chosen to satisfy r ru in particular this implies that ru c 0 and thus solves the heat equation in ru c in particular it follows that is positive in the connected open component of ru c that contains 0 t 0 since ru c decreases in time and is open so is any of its connected component it follows that the set t 0 decreases in time and thus from 4 7 we conclude that w 0 0 ru c and thus 4 3 next we proceed to show 4 4 we will only show the case for type i since parallel arguments hold for ii note that by 4 3 we have ru w 0 0 and ru c w 0 hence combining 4 6 and 4 5 we have 4 8 wt 1 2 w 1 2 w 0 w 0 u u if 0 a b for some constants a b in its support then by standard arguments for parabolic obstacle problem see lemma 5 2 and section 5 3 of 11 w 0 0 has zero space time lebesgue measure we will use this fact in the next paragraph sincer ru we have su s due to proposition 3 9 can only be supported in t s x on the other hand 0 where 0 as shown above and from the equation 0 in any open set where 0 therefore it follows that 0 outside of 0 that is is concentrated in the set 0 since x s ds x proposition 3 9 implies that t s x 0 for a e x since 0 ru c t su x it follows that both points su x x s x x are in 0 since the set 0 decreases in time it follows that the whole segment su x s x x are in 0 hence if su s 0 then it contradicts the fact that the space time measure of 0 is zero now we can conclude 4 4 in the case of ii wt 1 2 with 4 8 changes to wt 1 2 with 4 9 wt 1 2 w 1 2 w 0 1 2 w 0 0 here we use the fact that 0 the rest of the argument is parallel to that of i theorem 4 14 states that if is the hitting time to a monotone in time barrier set then the barrier can be given by ru where the brownian motion reaches note that the barrier sets cannot be unique as wherever the brownian motion does not reach one can modify the barrier set without changing the hitting time from and the final distribution we however can characterize the set ru is the largest barrier set for as any barrier set of should be contained in ru by proposition 4 12 because of this we regard ru as the canonical barrier associated to and from now on we mean ru whenever we say a monotone barrier r for such hitting times as in proposition 4 12 24 inwon c kim and young heon kim we can in fact show that ru so r in our convention is not dependent on but only on and as long as the stopping time is given by the hitting time to a monotone barrier this is not straightforward because ru is determined by the potential flow u t which then is determined by the distribution t w t in particular this yields the uniqueness of the hitting time hitting a forward or backward barrier set for given and when r is finely closed such uniqueness of the barrier is known see e g 10 remarks 2 3 and 6 19 we remove this restrictive assumption in the proof below where we make use of the parabolic obstacle problem that the w variable solves lemma 4 15 let and be as given in proposition 4 12 with uniformly positive in its support in type ii assume that 0 almost surely then for given and the barrier set r more precisely the barrier function s of r is unique a e proof let and w be as given in the proof of theorem 4 14 note that the above parabolic obstacle problem 4 8 and 4 9 each has a unique solution due to comparison principle indeed suppose w 1 and w 2 solve the same parabolic obstacle problem with the same initial data then w 1 w 2 is a subsolution of the heat equation with zero initial data and thus it is zero hence w and w 0 ru c is determined only by and hence we conclude by 4 4 definition 4 16 for as given in lemma 4 15 r s x is each the barrier set and the barrier function associated to for the cost type i or the cost type ii if r ru is the barrier set uniquely given a e in lemma 4 15 in the form of r x t t s x for cost i or r x t t s x for cost ii for the given barrier r the corresponding eulerian flow is uniquely determined due to lemma 2 3 this justifies the following definition 4 17 we say the pair is the eulerian variables associated with for the cost type i or ii if it is the unique pair solving 2 2 in the weak sense with the property l 2 0 h 10 o with r 0 and r 1 for the a e unique barrier r ru determined by here o rd is a bounded open convex set that contains the supports of and 4 3 remarks on the potential approach and the parabolic obstacle problem we have verified in the proof of lemma 4 15 that the function w x t u u t w u t u for ii solves the obstacle problem 4 8 4 9 they are in the form of the parabolic obstacle problem that has been actively studied in the literature in fact this connection between the parabolic obstacle problem and the stefan problem has been used in 21 to introduce a notion of weak solution solely based on 4 8 for a regularized version of st 1 however even ignoring the regularization such notion of weak solutions has its limitations due to lack of sufficient regularity of w variable to track the problem back to st 1 we refer to 11 and 36 for available results on regularity and singularity for solutions of 4 8 we point out that the low regularity of w is due to the fact that wt is non positive in our setting when wt is nonnegative which corresponds to the costs of type ii and thus st 2 much stronger regularity results holds for the parabolic obstacle problem see e g 24 the stefan problem and optimal brownian martingale transport 25 5 consistency with the stefan problem let be the eulerian variables associated with given in definition 4 17 in this section we will show that solves the stefan problems with initial distribution and weight and vice versa this connection has been indicated in 29 with formal analysis let us define weak solutions of the weighted stefan problems st 1 and st 2 with initial density 0 and initial domain e 5 1 0 t 1 2 0 0 0 l 1 rn e lim sup t 0 t 0 definition 5 1 a nonnegative function l 1 rn 0 is a weak solution of st 1 or st 2 with initial data 0 e if a the set t 0 decreases or increases in t b e lim supt 0 t 0 c for any test function c c r n 0 5 2 0 rd or 0 t 1 2 dxdt rd 0 or e x 0 dx we say that is a weak solutions of sti if it is for sti with 1 for i 1 2 remark 5 2 one can check that is a weak solution of st 1 i if 1 2 in the set x x t 0 for some t 0 to see this note that 0 t dxdt x s x 0 tdtdx x x s x e x 0 dtdx where s x sup t x t 0 so the only value of that matters is at x s x a e x remark 5 3 note that the weak solution for st 1 or st 2 requires specifying not only the initial data 0 but the initial domain e to be solved as an initial value problem with this information we can find a unique solution of st 2 by comparison principle for instance see 2 on the other hand even with specified 0 and e st 1 can exhibit a high degree of non uniqueness as we will see in section 6 1 theorem 5 4 let l 1 rd and assume that a 0 for some constant a in its support let be the associated eulerian flow given in definition 4 17 for either i or ii if the optimal stopping time associated with is strictly positive the following holds a for i is a weak solution st 1 with initial data e where e is a set containing the support of b for ii is a weak solution st 2 with initial data e where e is the support of proof let r be the barrier set associated with for either the cost of type i and ii given in definition 4 16 note that the following holds from proposition 3 9 and theorem 4 14 i is supported on t s x 26 inwon c kim and young heon kim ii 0 t s x dt a e for the next set of computations we focus on i let c rn 0 with compact support in space recall that then satisfies 2 2 namely 0 t 1 2 dxdt 0 dxdt x 0 dx we would like to see that satisfies the weak equation for st 1 to this end observe that 0 dxdt 0 x t x t dt dx x x s x dx where the second equality comes from i and the fact that 0 x t dt x a e x next from ii we have 0 t s x dt a e thus by fubini s theorem x x s x dx x s x 0 t x t dtdx x x 0 dx 0 x t x t dtdx x x 0 dx hence 2 2 can be written as 0 t 1 2 dxdt x 0 t x t dx x x x 0 dx hence is a weak solution l 1 rd 0 of st 1 with initial data 0 and the initial trace of the set 0 equal to a set e containing the support of for ii since 0 s x t dt a e again by fubini s theorem 5 3 x x s x dx x s x t x t dtdx 0 x t x t dtdx since 0 we have 0 in 0 0 hence 2 2 for case ii can then be written as 0 t 1 2 dxdt 0 x t x t dxdt x x 0 dx which is the weak expression for st 2 with initial data and the initial support the same as remark 5 5 in the case 0 the theorem will hold with the revised initial data 0 and revised target measure 0 where 0 is the portion of with 0 namely 0 x prob 0 w 0 x x next we consider the reverse direction the stefan problem and optimal brownian martingale transport 27 theorem 5 6 let 0 l rn with compact support suppose that there exists a weak solution l 1 rn 0 of st 1 with initial data e where e is bounded let us define s and by s x sup t x t 0 and 5 4 x x t dxdt x x s x dx for any test function c c r n 0 then sh s x moreover is the eulerian variables between 0 and generated by the optimal stopping time with costs of type i proof by definition of s x 0 t s x this allows us to write for instance in the case of st 1 x s x x dx x 0 x dx x s x 0 t t x dtdx 0 x t t x dtdx arguing as in the proof of theorem 5 4 we can then verify that satisfies the equation 2 2 moreover we have r 0 for the barrier set r x t t s x by the definition of s x observe also that r x t dxdt x 0 dx rn 1 where the first equality holds since is supported in r and the second is due to the mass preserving property of the heat equation let us define t x t dt integrating in time the weak equation for st 1 we see that solves the parabolic obstacle problem t 1 2 1 2 0 on the other hand since we have t in the distribution sense and since vanishes as time tends to infinity it follows that 0 0 t 0 0 hence 0 thus by uniqueness of the parabolic obstacle problem x t w x t t x s ds where is the eulerian variable generated by the optimal stopping time between and in particular 0 0 to conclude note that l 2 0 h 10 r n due to the fact that is a subsolution of the heat equation with compactly supported initial data hence taking their zero set as r where clearly both and 0 are supported we can apply lemma 2 3 to conclude that we finish this section with the corresponding statement for st 2 the proof is parallel to st 1 28 inwon c kim and young heon kim theorem 5 7 let 0 l rn with compact support suppose that there exists a weak solution l 1 rn 0 of st 2 and initial data e where e is bounded let us define s and by s x inf t x t 0 and 5 4 then is the eulerian variables between and generated by the optimal stopping time with costs of type ii where 0 and ec in the next section we will discuss a specific class of the target measures from which solutions to the classical stefan problems st 1 and st 2 are generated 6 subharmonically generated sets this section defines a central notion of the present paper which characterizes a pair of sets by existence of a certain stopping time this notion then is connected to solvability of the supercooled stefan problem st 1 the one without weight definition 6 1 we say the pair e is subharmonically generated by if there is a stopping time with the corresponding eulerian flow 2 2 such that 0 almost surely w 0 and w and e x x t 0 for some t 0 this definition is motivated by the following equivalence result theorem 6 2 consider a compactly supporeted measure leb on rd then for a given set e the following are equivalent a there exists a weak solution of st 1 with initial data e b there exists a measurable set such that e is subharmonically generated by moreover z x with z x sup t x t 0 proof if a holds then b follows from theorem 5 6 with s x with s x sup t x t 0 let us remark that since the set t 0 decreases as t increases we have lim sup t 0 t 0 t 0 t 0 e similarly if b holds then a follows from theorem 5 4 we mention that obtaining as a characteristic function does not guarantee a corre sponding solution for st 1 unless the stopping time is strictly positive even with the stopping time strictly positive for a given and e there can be many such that e is subharmon ically generated by below we will discuss an example that illustrates these points in the next section we will introduce an optimization problem for the target measure that uniquely generates a subharmonically generated pair e e for each given with e explicitly given in terms of more discussion on the stefan problem is to follow in section 9 in conjunction with this optimal target problem we will see therein that our optimal target scheme provides a mechanism to construct solutions of st 1 in a stable and physically reasonable manner the stefan problem and optimal brownian martingale transport 29 6 1 example for nonuniquenss for st 1 the weak solution of st 1 is known to have non uniqueness with given initial data here we give an example that yields infinitely many weak solutions to st 1 with the same initial data e these are solutions that does not vanish in finite time proposition 6 3 let 1 b b and e x 1 then there are infinitely many weak solutions to st 1 with initial data e proof consider the set a 1 a 2 r d consisting of the union of two annuli a 1 2 x r a 2 r x 1 where 0 2 r r 1 assume 1 by choosing appropriate r and r let we will prove claim there exists a randomized stopping time with w 0 and w after verifying this claim we can find the optimal stopping time for the optimal skorokhhod problem p 1 5 then the corresponding eulearian flow as given in propositoin 2 2 gives a solution to st 1 via theorem 5 4 with the initial set e lim sup t 0 t 0 x 1 this is because to reach the outer annulus a 2 the eulerian variable should be active in the whole set x 1 from remark 5 2 the solution we constructed here for st 1 for actually solves the original supercooled stefan st 1 hence by choosing different combinations of r r but still making 1 we can generate infinitely many solutions to st 1 with the above e in this case s x x 2 r x r the outside part of the two annuli in e x 1 it remains to prove the claim we first show that there exists a randomized stopping time with w 0 x 0 such that w to construct such stoping time let r be the first hitting time to s r x r then its distribution r is a uniform d 1 dimensional measure along the set s r that is r cr s r with some constant cr 0 thus we can randomize at t 0 to find a stopping time a with w 0 x 0 whose distribution r is given by a r 2 r 1 rf r dr for some weight f r that can be controlled by the randomization at t 0 in particular we can find such a randomization at t 0 so that a becomes a uniform measure on the annulus a r 1 x r 2 now for such a 1 and a 2 we can consider the randomized stopping time given as a 1 with probability a 1 a 1 a 2 a 2 with probability a 2 a 1 a 2 then it follows that w moreover by the markov property of the brownian motion we can change the randomization at x 0 to a randomization at s that is when the browinian motion from the origin first hits s we make a probabilistic choice how to move from there one can find a randomized stopping time as in the above with w 0 x 0 and w 1 b b for the ball b note that almost surely clearly so this 30 inwon c kim and young heon kim means that for the measure 1 b b there exists a randomized stopping time withw 0 and w verifying the claim 7 optimal target problem from this section on we consider the optimal target problem 1 1 proposed in our intro duction namely solving for the optimal target minimizing the cost function c under the upper density constraint f for a given bounded and measurable function f one can view this as a projection problem in the space of probability measures given p rn what is the closest measure in the constraint set f under the condition that we have the subharmonic order sh here the closeness between the two measures is measured by the cost c for an optimal stopping time between them once we have the optimal target then we can apply theorem 2 1 obtaining the optimal stopping time that is given by the hitting time to a barrier given by a barrier function s let us point out that it is not easy to explicitly construct the optimal target even in simple cases for instance when f 1 and x 0 one may guess that the optimal stopping time is given by the constant time when the heat kernel k t y becomes k 1 this is not the case as we see below for the either cost type i or ii for the rest of the paper will see that the optimal target comes with many interesting characteristics based on the two main features monotonicity and saturation property these two properties allow us to connect the optimal target problem 1 1 with global solvability of the stefan problem see section 9 we begin our discussion with the monotonicity property 7 1 monotonicity the following theorem demonstrates an order between optimal targets of problem 1 1 and the corresponding optimal stopping times theorem 7 1 monotonicity consider i i si i i 1 2 such that i are stopping times given by the barrier function si with initial and target distribution i and i further assume that i f and 1 2 then the following holds 1 if 1 is a solution to 1 1 for 1 while s 1 1 are the corresponding uniquely deter mined uniquely 1 a e sense barrier and the corresponding optimal stopping time then as the stopping times from the initial distribution 1 we have 1 2 almost surely notice that from 1 2 the stopping time 2 from 2 can be restricted to the initial distribution 1 here we do not necessarily assume that 2 is a solution to 1 1 2 if both i is a solution to 1 1 for i while si i are the corresponding uniquely de termined uniquely i a e sense barrier and the corresponding optimal stopping time respectively then 1 2 in particular there is at most one solution to 1 1 the stefan problem and optimal brownian martingale transport 31 remark 7 2 we point out that for 1 we only need 1 to be optimal not 2 this in particular characterizes 1 as the smallest stopping time that starts from 1 among eligible target distributions with the constraint f proof to show 1 we first prove that 1 2 when 2 is restricted to the initial distribution 1 for this it only needs optimality of 1 i case in this case i i 1 2 are the first hitting time to the set ri x t t si x i inf t wt t ri let 1 2 recall that from proposition 3 9 we have w i i ri almost surely i 1 2 therefore min s 1 w s 2 w almost surely now for a brownian path if w x s 1 x s 2 x then 1 so 1 similarly if w x s 2 x s 1 x then 2 therefore denoting the distribution of we have s 1 s 2 1 s 1 s 2 f and s 2 s 1 2 s 2 s 1 f so f and is admissible now recall that 1 is the minimizer for c which implies 1 almost surely as otherwise if prob 1 0 then from the strict monotonicity of c we see c c 1 a contradiction this immediately implies that 1 2 where we understand 2 as the stopping time re stricted to the initial distribution 1 ii case in this case i i 1 2 are randomized at the initial time to give the distribution f i i 1 2 and the rest brownian particles stops when they first hit to the set ri x t t si x which gives the corresponding final distribution i f i from those brownian paths with i 0 that satisfies f f i i 1 2 notice that f f 2 f f 1 due to 1 2 from now on until the end of the proof of this case we restrict 2 to the initial distribution 1 and call it still 2 define a randomized stopping time as follows for the portion 1 f stop immediately and for the rest 1 1 f follow the brownian motion until 1 2 notice that 1 from its construction the rest of proof is similar to i case with additional consideration for stopping at the initial time details follow we show that is admissible namely if we let be its distribution with the initial distribu tion 1 w then f to see this first write 1 f 1 where 1 is the distribution of the rest for brownian particles with positive time 0 that is those accounting for 1 if w x s 1 x s 2 x then 1 so 1 similarly if w x s 2 x s 1 x then 2 so 2 therefore 1 s 1 s 2 1 f 1 s 1 s 2 f f 1 s 2 s 1 as well as 1 s 2 s 1 2 f 2 s 2 s 1 f f 2 s 2 s 1 f f 1 s 2 s 1 from these we have 1 f 1 1 f f f 1 f verifying admissibility of 32 inwon c kim and young heon kim now recall that 1 is the minimizer for c which implies 1 almost surely as otherwise if prob 0 then from the strict monotonicity of c and from 1 we see c c 1 for admissible a contradiction this immediately implies that 1 2 as desired we now show 2 this requires optimality of both 1 and 2 suppose not i e 1 2 f x dx 0 for a small 0 define e x 1 x 2 x 2 1 x and 2 2 1 0 define an auxiliary randomized stopping time from the initial distribution 2 as follows 2 from 2 1 if w 1 e from 1 2 if w 1 6 e from 1 let us explain the meaning of this here the wording from 2 or from 1 should be understood as that at the initial time the brownian particles belong to the distribution 2 or 1 respectively notice that such a decomposition in the initial distribution is allowed for the randomized stopping time as it is like randomizing at the initial time notice that we already proved that 1 2 for brownian motion starting from 1 so the second and third lines in the definition of is well defined now let us show that is admissible define the distribution of that is w from the definition of we see that ec the distribution of w 2 from 2 and from 1 restricted to the set e c therefore ec 2 on the other hand e the distribution of w 1 from 1 the distribution of w 2 from 2 2 1 restricted to the set e 1 2 on e 1 on e by the definition of e f we thus have verified that f therefore is admissible as the stopping time from the initial distribution 2 now notice that by the construction 2 where the latter is optimal from the strict monotonicity of the cost c we see that 2 to see why this leads to a contradiction notice that it implies that for those brownian particles starting from withw 1 e we have 1 2 since 1 is the final distribution the stefan problem and optimal brownian martingale transport 33 for 1 starting from 1 we have 1 e the distribution for 2 starting from 1 restricted to e the distribution for 2 starting from 2 restricted to e because 1 2 2 e note that this is a contradiction to the definition of e thus proves the claim that 1 2 remark 7 3 note that 1 2 should be understood to hold for those brownian paths starting from the initial points x distributed as the common mass 1 1 2 for 1 2 because of markov property of the brownian motion the stopping time 1 can be applied to the initial mass of 2 in the region where 1 0 from the region 1 0 it should be understood that the stopping time 1 0 because from where 1 0 there is no motion for 1 in this sense the inequality 1 2 can be applied to all brownian paths from the initial distribution 2 not only from 1 the rest of the section discusses important consequences of the monotonicity property 7 2 existence here we show the well posedness of the optimization problem 1 1 theorem 7 4 let be bounded and compactly supported and suppose the set a sh is compactly supported and f is nonempty for f l rn then there exists unique optimal target measure for the problem 1 1 proof once existence is established uniqueness is a direct consequence of theorem 7 1 first let us consider the case where f is compactly supported in this case basically the relevant domain for the measures a and brownian motion between and is compact in particular a subset of the convex hull of supp f therefore existence of a minimizer follows easily from the weak compactness of the minimizing sequence since that the condition f is closed with the weak convergence now for the general case let fr f 1 br then for r 1 the corresponding admissibility set ar with fr is nonempty therefore for the initial measure and for each 1 r r applying the compactly supported case we find r r be the optimal solutions with the constraint fr and fr respectively let r r be the corresponding optimal stopping times notice that r also satisfies the density constraint fr fr we can then apply the monotonicity theorem 7 1 1 and get r r it implies that the support of r is contained in the convex hull of the support of r since in the support of r we have fr fr so r should be an optimal solution for the constraint fr because for the cost we have c r c r from uniqueness of optmal solution in the compactly supported constraint case we have r r this implies that the optimal r is independent of r as long as r is sufficiently large that r r 1 is the optimal target for f to see this notice that for any compactly supported target measure f there exists r 0 such that supp br so fr and the cost for r is less than or equal to that of 34 inwon c kim and young heon kim remark 7 5 we note that those f with a 6 are plenty for example f 1 on rd or any f 0 which has a positive lower bound on a ball br r 1 will work or any f 0 that has a positive lower bound in the annulus r 1 x r 2 with 1 r 2 r 2 works of course here how large r r 1 r 2 need to be depends on these are some particular types of f we focus on in this paper especially in section 9 7 3 universality of the optimal target a remarkable consequence of this monotonicity is that for a given initial measure and upperbound constraint f the optimal target is unique regardless of the cost function c as long as c satisfies either i or ii we exploit the fact that theorem 7 1 1 requires optimality only for one target this result will have interesting consequences later in the context of stefan problem see section 9 theorem 7 6 universality for a given assume that i i 1 2 is an optimal solution to 1 1 with the same upperbound constraint f but for costs ci i 1 2 where ci satisfies i or ii then 1 2 proof notice tat 1 2 f let i i 1 2 are the corresponding optimal stopping times for ci i 1 2 respectively for the cost c 1 consider the optimal stopping time 2 for the given target 2 then from theorem 7 1 1 and optimality of 1 we have 1 2 this implies that 1 sh 2 similarly for the cost c 2 consider the optimal stopping time 1 for the given target 1 then from theorem 7 1 1 and optimality of 2 we have 2 1 this implies that 2 sh 1 the two subharmonic orders imply 2 1 completing the proof remark 7 7 above universality is rather surprising since by putting different weights on the location x for l we may expect different optimal target distribution our result says this is not the case namely that the cost function c depends only on the time spent by the brownian paths 7 4 l 1 contraction and bv estimate next we show the l 1 contraction which is a con sequence of the monotonicity and the fact that the total mass of is the same as that of theorem 7 8 l 1 contraction assume either i or ii let 1 1 2 2 be the pairs of the initial distribution and optimal solution of the problem 1 1 then 1 2 l 1 1 2 l 1 proof let 1 2 notice that 1 2 1 let be an optimal solution of the corresponding problem 1 1 with the initial distribution as i i 1 2 we have from the monotonicity theorem 7 1 that i i 1 2 now let e x 1 x 2 x 0 then 1 2 1 2 e 1 e 1 the stefan problem and optimal brownian martingale transport 35 therefore 1 2 l 1 1 l 1 1 l 1 1 2 l 1 as desired notice that the first equality follows from the fact that the problem preserves the total mass i e 1 l 1 1 l 1 l 1 l 1 remark 7 9 the monotonicity and l 1 contraction seem to hold if we add the constraint t in the problem 1 1 namely for a given t argmin p rn f c t w 0 w 7 1 this will be useful for us when we try to use the markov property of the problem and do iteration of the l 1 contraction and consequent bv estimate for we prove the bv estimate as an immediate corollary of the l 1 contraction theorem for ii when f 1 and when 1 0 e with 0 0 this was shown by meirmanov 38 theorem 7 10 bv estimate let be the solution of 1 1 with a constant f then bv bv proof let us first consider the case c 1 let us define where is a standard nonnegative compactly supported mollifier with total mass one since is l 1 and is com pactly supported uniformly converges to in l 1 from lower semi continuity of bv norm under l 1 convergence it is enough to prove that bv bv for small 0 observe that for each y b 1 0 we have x y x dx w y w dw notice that f 1 is translation invariant therefore from the uniqueness result y is the optimal solution of 1 1 for the initial measure y we apply then the l 1 contraction theorem 7 8 and get for any 0 x y x dx x y x dx now for a fixed and are c 1 with compact supports and so by sending 0 in above expression we obtain d x y dx d x y dx we then integrate both sides in y b 1 b 1 d x y dxdy b 1 d x y dy 36 inwon c kim and young heon kim and apply the fubini s theorem b 1 d x y dydx b 1 d x y dydx observe that for any unit vector e 1 we have b 1 d x y dy d x b 1 e 1 y dy and similarly for which leads to d x b 1 e 1 y dy dx d x b 1 e 1 y dy dx therefore we get the inequality d x dx d x dx hence we showed that bv bv as desired let us now consider the general in bv we consider a sequence of measures k c 1 that converges as k to in bv also in l 1 in particular k bv bv consider the corresponding k namely the solution of 1 1 with initial k apply step 1 and get k bv k bv now notice that by the l 1 contraction k converges as k to in l 1 therefore from the lowe semicontinuity of the bv norm in l 1 convergence we get bv bv this completes the proof remark 7 11 the bv estimate is a rather well known consequence of l 1 contraction when the problem is homogeneous with respect to spatial shift 8 saturation property of the optimal target here we prove that the optimal target measure when obtained with positive stopping time saturates up to the upper density limit f we first show a converse to corollary 3 7 for optimal solutions to 1 1 in the following sense lemma 8 1 let be a probabillity measure absolutely continuous with lebesgue measure let be the corresponding optimal solution of the problem 1 1 for i or ii with bounded and measurable f let be the optimal stopping time with w 0 and w let g be a measurable set such that f g 0 suppose that there exists a constant t 1 0 such that prob wt 1 g t 1 0 then g 0 the stefan problem and optimal brownian martingale transport 37 proof suppose for contradiction that g 0 we define a randomized stopping time starting from the distribution as follows for those brownian trajectories with t 1 stop at t for those brownian trajectories with t 1 if wt 1 6 g just proceed until but if wt 1 g then drop a portion of mass at the time t 1 such that the resulting mass is positive but has density f over the set g note that here we are using the fact that g 0 then proceed until note that this is possible because prob wt 1 g t 1 0 as well as f g 0 for f leb to be more precise notice that the density at x of the distribution of wt 1 for those brownian particles with t 1 is bounded from above by kt 1 x of the solution to the heat equation with initial data thus at each x g when wt 1 x g one can stop the mass with the probability min f x kt x kt x 0 and we get the positive stopped density f x therefore this randomized stopping time has distribution w with f moreover notice that for each random path almost surely and prob 0 then the cost c c from the strictness of the cost functional c this contradicts optimality of thus completing the proof as an immediate corollary of this lemma and lemma 3 5 we see that for the optimally stopped brownian motion for our problem 1 1 any set g with zero mass of the final distri bution blocks off the brownian motion corollary 8 2 let and be as given in lemma 8 1 let g is a measurable set with positive measure and suppose that every point of g has positive lebesgue density assume that f g 0 and g 0 then g almost surely proof this is a direct consequence of lemma 8 1 and lemma 3 5 we can combine ideas used in the proof of lemma 8 1 and the result of corollary 3 7 to prove that the optimal solution saturates the density upper bound theorem 8 3 saturation assume leb and be the optimal solution of the problem 1 1 with cost of type i or ii with the optimal stopping time suppose 0 almost surely then the optimal solution to problem 1 1 is given in the form f e for some set e more generally without assuming 0 we have the following results a for costs of type i we have f e f for some set e and f with e f 0 where in e the brownian motion does not stop immediately i e s x 0 for a e x e and in f the brownian paths stop immediately i e s x 0 for a e x f 38 inwon c kim and young heon kim b in the ii case the optimal target measure is given in the following form f where the optimal solution from the initial measure f while the upper bound constraint is given by f f f here is given in the form f e for some set e and the corresponding optimal stopping time satisfies 0 almost surely moreover f x prob w 0 x 0 x before proceeding to the proof of above theorem we state the following characterization of the instantly stopped portion for each cost types using the potential flow corollary 8 4 for cost i and e and f as given in theorem 8 3 we have e w 0 and f w 0 where w 0 is continuous solution of the obstacle problem 8 1 w f w 0 0 proof set w u u then e w 0 and f w 0 to see this for example apply lemma 4 3 and continuity of u and u therefore we see that w f w 0 w 0 f w 0 this completes the proof one can variationally characterize the problem w solves noting that w 0 contains 0 we can write 8 1 as f w 0 w if we let h solve h f then w minimizes d h 2 dx among the functions 0 thus w can be viewed as h 1 rd projection of h onto the space of nonnegative functions remark 8 5 in type ii notice that the set x x f x belongs to the set where the brownian motion under the optimal stops immediately proof of theorem 8 3 we proceed in several steps 1 when 0 almost surely for arbitrary 1 0 let h x d x dx f x our goal is to prove h 0 suppose not for contradiction that is h 0 then corollary 3 7 implies either i h 6 0 or the stefan problem and optimal brownian martingale transport 39 ii there exists a constant t 0 such that prob wt h t 0 for i we define a randomized stopping time starting from the distribution as follows first is randomized at the initial time for for those brownian particles from h in such a way that the distribution of initially stopped particles from h has positive mass with density for the remaining particles it follows then the resulting terminal distribution by say is f by the definition of the set h moreover from the construction of and strict monotonicity of c we have c c which contradicts optimality of therefore the case i should not happen for ii we define in such a way that for those brownian trajectories with t stop at for those brownian trajectories with t if wt 6 h just proceed until but if wt h drop a portion of mass at time t such that the resulting mass is positive but has density over the set h then proceed until note that this is possible because the density at x of the distribution of wt is bounded from above by kt x of the solution to the heat equation with initial data thus at each x h when wt x h one can stop the mass with the probability min kt x kt x 0 and we get the positive stopped density with the total mass therefore this randomized stopping time has distribution with f moreover notice that for each random path almost surely and prob 0 then the cost c c from the strictness of the cost functional c this contradicts optimality of thus completing the proof for the case 0 almost surely we verified that f e for some set e for ii 2 i case recall that in this case inf t t s wt notice that the set f x s x 0 gives a barrier set for wt t that is any brownian path starting from a point in f with the stopping time stops immediately equivalently f as a consequence the resulting final distribution with starting from f is f on the other hand denote f c and apply the stopping time for those brownian particles starting from we let denote such a restriction of notice that 0 almost surely and it is the optimal stopping time for and f f f let be the resulting final distribution from the stopping time then from case 1 we have that f e for some set e where f e 0 moreover notice that f 0 from the definition f c therefore from f since f is part of the barrier and lemma 3 2 we get f 0 this also implies that e f 0 therefore f e f e in summary we have f f e f as desired this completes the proof for i 3 ii case in this case the stopping time which is the optimal stopping time between and is randomized at t 0 to give f and proceed with positive time starting from the rest f which gives the additional final distribution f let denote the 40 inwon c kim and young heon kim stoping time restricted to the initial distribution then its final distribution say gives an optimal solution to 1 1 with the upper bound constraint f f f notice that 0 almost surely thus from case 1 we have f e for a set e notice that f all things combined we verified the result in case 3 this completes the proof for ii 8 1 upper bound for the optimal stopping time in the i case one of the applica tions of the saturation result is the following theorem 8 6 let is a probability measure with compact support and leb and let f be a bounded measurable function with f for a constant 0 then the following holds for costs of type i let be the optimal stopping time for problem 1 1 then there exists a constant t t l 1 such that t almost surely remark 8 7 this result yields in particular that the support of closes off namely that it includes the support of also interestingly the extinction time t does not depend on the size of the support of proof recall that has a barrier function s such that inf t t s wt consider the optimal target and the set e and f from theorem 8 3 a so in the i case which satisfies that 0 implies w e almost surely and 0 implies w 0 f almost surely and that for any measurable set s prob w s 0 w 0 s e s e df s e where the last inequality is from the assumption that f since leb we may assume without loss of generality that ec consists of its lebesgue points by adding the non lebesgue density portion of ec which has zero lebesgue measure to e then from corollary 8 2 we see that if 0 then almost surely ec 8 2 now consider for each t 0 the set zt x s x t notice that zt zt e it suffices to show that there exists t such that zt 0 first recall that from lemma 3 9 we have s almost surely therefore almost surely w zt if and only if t also note that t implies s wt t so wt zt also 8 2 implies wt e when t therefore almost surely w zt implies wt zt e t the stefan problem and optimal brownian martingale transport 41 in particular we have prob w zt w 0 prob wt zt e t w 0 on the other hand let t be the distribution of the heat flow in r d at time t with the initial condition 0 notice that t ct for some constant ct depending only on l 1 and t decaying exponentially to zero as t consider ct zt e zt e d t prob wt zt e w 0 prob wt zt e t w 0 prob w zt w 0 zt zt e zt e by examining the limit t we see that there exists t t l 1 0 such that zt e 0 thus we conclude that zt 0 completing the proof notice that a similar result does not hold in the ii case as easily seen in the following example example 8 8 consider the case under the ii assumption where b 1 b 2 are the balls of radius 1 2 respectively centered at the origin in 2 d b 1 f 1 then we get 1 b 2 and the corresponding barrier function s is radially symmetric and can be given by a function of the form s x 0 for x 1 g x for 1 x 2 for x 2 where g 1 2 r is an increasing function with g 1 0 and g t as t 2 here the optimal stopping time which is the hitting time to such a barrier has not upper bound 9 global time existence of supercooled stefan problem translating the saturation result theorem 8 3 into a pde formulation via the consistency result theorem 5 4 we can derive global time existence of the stefan problem for both super cooled fluid st 1 theorems 9 3 and 9 6 and melting ice st 2 theorem 9 2 our emphasis will be on the supercooled case which has not been well understood in the literature we point out that due to theorem 8 3 1 in the active region of the brownian particles thus satisfies the assumptions of theorem 4 14 b for st 1 we find the unique solution that vanishes in finite time theorem 9 3 for a certain class of initial data e and the unique solution that vanishes outside of its support theorem 9 6 remarkably our choice of the initial domain e is necessary to have such solutions and it is generated as the accumulated 42 inwon c kim and young heon kim active region of the melting st 2 problem theorem 9 10 this connects the two problems that have very different dynamics from each other let us first translate positivity of the target in lemma 8 1 in terms of the eulerian flow lemma 9 1 let be the optimal target measure generated by 1 1 with for type i or ii costs let be the eulerian variable associated with then we have 0 on the set x x t 0 for some t 0 f 0 proof we can apply lemma 8 1 to the set g x t 1 0 for each t 1 0 9 1 stable stefan problem let us first briefly discuss global well posedness for the stable stefan problem st 2 due to the saturation theorem theorem 8 3 it follows that x 1 in the active region 0 if f 1 and is larger than one in its support thus from the consistency theorem theorem 5 4 we have the following theorem 9 2 global time existence for st 2 let 1 0 l rd with 0 0 and a bounded borel set with positive measure then for costs of type ii the corresponding variable for and the optimal target with f 1 is the unique weak solution of the stable stefan problem st 2 st 2 0 t 1 2 0 with initial data 0 in this case the initial set for the active region coincides with the support of the initial distribution this is due to the nature for the type ii costs whose barrier sets in the space time for the optimal stopping are time backward monotone in contrast to the type i costs that gives time forward barrier sets for the supercooled st 1 case corresponding type i not every initial set has a global time solution this will be apparent in the theorems below for the supercooled case 9 2 supercooled stefan problem from the same reasoning as for theorem 9 2 applied to the type i case we immediately get the following for the supercooled stefan problem theorem 9 3 a global time existence for st 1 suppose 1 0 l rd with 0 0 and a bounded borel set with positive measure let f 1 and let e be the corresponding optimal target for costs of type i then the eulerian variable for solves the supercooled stefan problem st 1 0 t 1 2 0 with initial data e moreover we have e w 0 where w 0 solves the obstacle problem 9 1 w 0 w in particular e contains lastly the set 0 vanishes in finite time the stefan problem and optimal brownian martingale transport 43 remark 9 4 in the next subsection we will show that in above theorem is indeed the unique solution with initial data that vanishes in finite time from the point of view of theorem 6 2 we have this result as e e is subharmonically generated via theorem 8 3 for f 1 note that 9 1 follows from 8 1 since we know that in this setting e includes the support of in general case 9 1 no longer holds due to the instantly frozen part of in the region f the finite time extinction of is due to theorem 8 6 and the characterization of e via the obstacle problem is due to corollary 8 4 remark 9 5 relation between st 1 and st 2 note that due to universality theorem 7 6 we have the same optimal target measure for type i and ii for given and f therefore the solution of stable stefan problem st 2 in theorem 9 2 determines the initial set e that gives global time solution for st 1 this aspect can also be understood as the obstacle problem 9 1 can be solved by the solution of st 2 by taking t while our optimal target problem connects to the classical stefan problem st 1 with a restricted initial data of the form e one can generate the solution of st 1 for a wider class of initial data by making use of theorem 8 3 and theorem 5 4 for instance to ensure that there is no instantly frozen set one can choose f k where k and the support of are disjoint then the optimal stopping time must be 0 and due to theorem 8 3 we obtain a solution of st 1 whose positive set instantly expands out to a part of k and then shrink over time with its interface away from the support of more precisely we have the following result which like theorem 9 3 is derived immediatly from lemma 9 1 theorem 8 3 and theorem 5 4 as well as corollary 8 4 theorem 9 6 a global time existence for st 1 for f 0 let be compactly supported nonnegative function in l rd let us set f kc where k is a compact set that includes the support of and let f e e kc be the corresponding optimal target for costs of type i then the eulerian variable for solves st 1 with initial data e here e w 0 where w 0 solves the obstacle problem w f w 0 w 0 kc from the point of view of theorem 6 2 e kc e is subharmonically generated via theorem 8 3 for f kc as in the previous theorem here again can be determined by solving the type ii problem with the same and f or equivalently solving the corresponding st 2 problem in this case does not vanish in finite time it is because the brownian motion will travel forever in the region where no stopping happens there due to the assumption f 0 remark 9 7 uniqueness is in general not true for st 1 with initial data and e see the example in section 6 thus the optimal target problem with f yields a cost and energy oriented criteria for a unique solution of st 1 with initial distribution 44 inwon c kim and young heon kim a discussion on the initial expansion an interesting feature of our solutions of st 1 is the instantly expanded set e it is well understood that the local in time solutions to st 1 develops jump discontinuity when the solution is overloaded namely when the average density goes beyond 1 see for instance 14 when 1 in its support as given in theorem 9 3 is entirely overloaded and thus it is natural that one must expand its support to activate the supercooling process on the other hand when has small density as allowed in theorem 9 6 such expansion follows from our choice of f which describes the particular scenario where the freezing stimulus is only available outside of the initial supercooled region our approach by optimization as well as imposing the energy level f may provide an interesting interpretation to supercooling phenomena where little is understood our characterization of the initial domain e via 8 1 is also reminiscent of the classical paper by dibenedetto and friedman 21 which considers a time integrated version of st 1 see the discussion in section 4 3 remark 9 8 the form of in theorems 9 2 and 9 3 and f in theorem 9 6 were made to ensure the stopping time 0 that is there is no instant stopping with more general an instant stopping may occur as given in the saturation theorem thereom 8 3 those general cases feature immediate phase transition which is not present in the standard stefan problem namely the drain of energy occurs immediately on a certain part say the set f in the case i part of theorem 8 3 or f in the ii part of theorem 8 3 for which the heat particles are not activated in the freezing problem i this is where immediate freezing occurs or perhaps one should understand it as the previously frozen region in the melting problem ii the energy f reduces the drain capacity f only the remaining portion f of energy is used for the melting for the reduced drain capacity f f the heat particles once activated move and in the melting problem ii the region time dependent where the heat particles move is the region where melting occurs 9 3 existence of finite time vanishing solution characterizes the initial set in this section we show that the choice of the initial set e in theorem 9 3 where in particular the solution vanishes in finite time is sharp namely such a choice is necessary for a finite time vanishing solution to exist first let us connect finite time vanishing solutions to the notion of subharmonically generated sets as in theorem 6 2 theorem 9 9 let be a weak solution of st 1 with the initial data e then vanishes in finite time if and only if e e is subharmonically generated by and is the corresponding eulerian variable to e in particular there is at most one solution of st 1 with the initial data e that vanishes in finite time proof the if direction is a direct consequence of theorem 6 2 and theorem 8 6 the only if direction follows from theorem 6 2 and the fact that s x sup t x t 0 t for some finite t the vanishing time of note that that at most one solution follows from theorem 6 2 the stefan problem and optimal brownian martingale transport 45 theorem 9 10 necessary condition for finite time vanishing solution let be a compactly supported measure on rd with leb suppose there is a vanishing in finite time solution to st 1 with the initial data e then the set e is determined by the optimal free target problem 1 1 of type i cost for and f 1 that the optimal target is e before proving theorem we point out that to have such e we must have 0 almost surely this in particular shows that such a set e is determined by the obstacle problem 9 1 hence we arrive at the following conclusion corollary 9 11 unique characterization let be as given above then there is a unique solution of st 1 with the initial data that vanishes in finite time in this case the initial domain e is given by 9 1 and corresponds to the eulerian variable given by and the optimal target e we now prove theorem 9 10 proof for this result we apply theorem 9 9 and theorem 7 1 to have a vanishing in finite time solution to st 1 from theorem 9 9 it is necessary that e e has to be subharmonically generated by there is a corresponding type i optimal stopping time say solving the optimal skorokhod problem p here e moreover e lim supt 0 x x t 0 is the initial set of the active region for the corresponding eulerian flow on the other hand we have the optimal stopping time for the free target problem 1 1 for type i cost from the measure with f 1 with the optimal target with its density 1 everywhere we claim that it suffices to show this claim as it implies the desired equality because they have the same mass to prove the claim first note that the monotonicity result theorem 7 1 part 1 does not require optimality of one of the target therefore we have therefore the eulerian flow for is supported inside the support of the eulerian flow of in particular the initial domain for the eulerian flow is a subset of the initial domain for that is e moreover even when there is instant stopping 0 for a set s since 0 almost surely we have s e from these considerations and the fact that 1 and e we have as desired this completes the proof from parallel reasoning we can uniquely characterize from theorem 9 6 as well corollary 9 12 unique characterization let k and e be as given in theorem 9 6 then is the unique weak solution of st 1 such that t 0 t 0 k in other words e is the unique set for which e kc e is subharmonically generated 10 monotonicity of the optimal barrier functions we show in this section that the barrier function s x for the optimal stopping time enjoys a monotonicity property in the spirit of theorem 7 1 namely the barrier functions 46 inwon c kim and young heon kim si are ordered if the initial distributions i are ordered theorem 10 1 and such order is strict theorem 10 2 the strict monotonicity we obtain generates a comparison principle and we hope it may shed a light on understanding regularity of the barrier function s x like comparison principles do for elliptic pdes understanding regularity of s x so regularity of the free boundaries of the stefan problem is a wide open problem in st 1 where even well posedness is poorly understood our result in theorem 4 14 shows that its corresponding space time barrier set r is closed so s is lower semicontinuous for type i and upper semicontinuous for type ii to our knowledge even this very mild regularity result for s is new for st 1 however for such semicontinuity we only use the optimality of the stopping time for the optimal skorokhod problem p our monotonicity of s below which is a result of optimality of the target measure may lead to a nicer regularity result theorem 10 1 monotonicity for optimal barrier functions assume 1 2 leb and let f be a bounded measurable function on rd let i i 1 2 be the optimal solutions of the problem 1 1 with i i 1 2 respectively let si be the barrier functions associated with i i as in definition 4 16 then we have s 1 s 2 1 a e for type i cost and s 1 s 2 1 a e for type ii cost here we are able to show only a e inequality for i due to technical reasons and we conjecture it holds everywhere for example we immediately get everywhere inequality if si s are continuous to the best of our knowledge the continuity of the barrier function s is not known in general proof we utilize the potential flow formulation in section 4 as well as the monotonicity result for the optimal target problem theorem 7 1 let us define ui r u i and s u i as in definition 4 13 generated by the stopping time i we aim to show the order between s u 1 and s u 2 from which and 4 4 we can conclude let 2 denote the restriction of 2 from the initial distribution 1 which is the common mass 1 2 for 1 2 then 1 2 due to theorem 7 1 let 2 denote its distribution namely w 2 2 recall that 1 and 2 are optimal stopping times between i and i i 1 2 it is also easy to see that 2 is an optimal stopping time between 1 and 2 the monotonicity theorem 7 1 gives 1 2 let 1 t be the distribution of w 1 t that is w 1 t 1 t similarly let w 1 t 1 t w 2 t 2 t since 1 t 2 t from corollary 4 4 we have the potentials satisfy u 1 t u 2 t also restricting 2 to the initial distribution 2 1 0 and applying corollary 4 7 we have u 2 1 u 2 t 2 t u 2 2 below we treat type i and ii separately the stefan problem and optimal brownian martingale transport 47 type i for type i define the functions u 1 x t u 1 x u 1 t x u 2 x t u 2 x u 2 t x and u 2 x t u 2 x u 2 t x notice that they are all nonnegative continuous and monotone decreasing in time due to corollary 4 9 and corollary 4 7 since u u u in general we have u 2 u 2 u 2 2 u 2 t 2 t u 2 recall that rui ui 0 thus to show that s u 1 s u 2 a e it suffices to prove that for each t and for a e x u 2 x t 0 implies u 1 x t 0 or 10 1 u 1 t 0 u 2 t 0 0 from now on let us fix t suppose for contradiction that u 1 t 0 u 2 t 0 0 this implies that u 1 t 0 and u 2 t 0 in e r d for some positive measure set e that only consists of lebesgue density points of density 1 lemma 4 3 then yields that for brownian motions starting from 1 there exists a monotone decreasing sequence of open sets on e with limn on e 0 such that 0 e 1 1 t lim n on wt dt in particular this implies 10 2 0 prob t such that lim n on wt 1 t t 1 note the strict inequality t t 1 in the above expression now if limn on wt 1 for some t for a brownian path then because e consists only of its lebesgue density point we have that for each 0 there exists with positive probability t t t such that wt e here we have used the fact that brownian motion that visits an open neighbourhood of e sufficiently close to e while e has lebesgue density 1 has to visit e with comparable probability since such t exists with t t 1 with positive probability this means that with positive probability there exists t with t t 1 such that wt e however for those t and corresponding brownian paths we have u 2 wt t 0 due to the fact wt e u 2 t 0 since t t and u 2 is monotonically decreasing in time we have u 2 wt t 0 therefore wt t belongs to the barrier u 2 0 of 2 and thus t 2 for those brownian paths on the other hand since 1 2 almost surely we can assume that along such brownian paths we have that t satisfies t 1 contradicting the fact t 1 this proves 10 1 which yields su 1 s u 2 a e type ii for type ii define the functions u 1 x t u 1 t x u 1 x u 2 x t u 2 t x u 1 x and u 2 x t u 2 t x u 2 x 48 inwon c kim and young heon kim notice that they are all nonnegative from theorem 4 14 these give the barrier sets for 1 2 and 2 respectively note that from the definition sui x sup t u 1 x t 0 observe that u 1 u 2 becasue u 1 t u 2 t moreover we have u 2 u 2 u 2 t 2 t u 2 1 u 2 so u 1 u 2 which implies s u 1 s u 2 we now prove strict monotonicity for s which is derived by combining the above theorem with the monotonicity of the stopping time theorem 7 1 and the saturation result theo rem 8 3 as a preparation of the statement of the result let us recall that the potential barrier sets rui i 1 2 for the stopping times in theorem 10 1 are closed therefore their complements are open define for i 1 2 in type i ei lim sup t 0 x i x t 0 10 3 in type ii ei lim sup t x i x t 0 note that due to the monotonicity of ri ei r c i t 0 i t 0 and thus they are open note also that as ei s are connected to the active regions the brownian paths that start from ei s have i 0 almost surely except those in type ii that may immediately stop see theorem 8 3 where the mass that immediately stop in type ii is characterized by the initial data as f thus by taking the initial data as f we may assume i 0 in e is the complement ec 2 is the set where there is immediate and complete stopping occurs for 2 so 2 is zero and so is 1 0 from monotonicity theorem 7 1 there the corresponding si s are 0 in type i case in type ii case moreover in type i case ec 2 is exactly the set where the immediate stopping occurs this justifies that for comparison between si we can without loss of generality assume that i 0 in both type i and ii and compare si s only over e 2 also assuming f 0 everywhere does not cost much generality for our purpose of comparing si s because in the region f 0 no stopping to accumulate mass occurs so the value si can only be either or 0 with these considerations we see that the following theorem essentially covers the general case and the whole domain for the strict monotonicity of s theorem 10 2 strict monotonicity for optimal barrier functions let f i i and si be as given in theorem 10 1 in particular with 1 2 and s 1 s 2 satisfying the monotonicity assume that f 0 everywhere and that i 0 i 1 2 almost surely let o be a path connected component of e 2 given in 10 3 suppose 2 1 on a subset g o with g 0 then su 1 x 6 s u 2 x for a e x o proof from the continuity of brownian paths almost surely any brownian path starting from o should stay inside the corresponding path connected component of the active region say the stefan problem and optimal brownian martingale transport 49 a rd r 0 that is connected to o that is a x t x o t su 2 x in type i a x t x o t s u 2 x in type ii from this and the condition 1 2 we can without loss of generality assume that o e 2 that means we consider only those mass brownian motion and the barriers associated to o for example we assume i e i o i e i o notice that a is a connected open set and that the eulerian flow 2 0 on a from this we also see that 2 0 on o to see this use for example lemma 8 1 which uses optimality of 2 with respect to prob lem 1 1 therefore it suffices to show that su 1 x 6 s u 2 x for 2 a e x recall that 1 2 and 1 2 from theorem 7 1 because of the markov property of brownian motion the inequality can be applied to all brownian paths from the initial distribution 2 not only from 1 see remark 7 3 if s 1 w 1 s 2 w 1 then from the hitting time characterization of i s proposition 3 9 we have that 1 2 therefore almost surely s 1 w 1 s 2 w 1 implies 2 1 10 4 also recall from the saturation result theorem 8 3 that i 6 f only where the brownian paths from i stop immediately from our assumption i 0 almost surely so we have i f on its support therefore to prove the theorem it suffices to show that 2 s 0 where s x s 1 x s 2 x x 1 x 2 x f x o we have from w 0 i o w i i o that i s o prob w i s w 0 x d i x for i 1 2 let g be as given in the theorem and observe that 2 g 0 then for i 1 2 i s g prob w i s w 0 x d i x o g prob w i s w 0 x d i x 10 5 on the other hand for 2 a e x prob w 2 s w 0 x prob w 2 s 2 1 w 0 x prob w 2 s 2 1 w 0 x prob w 2 s 2 1 w 0 x prob w 1 s 2 1 w 0 x 50 inwon c kim and young heon kim from 10 4 it holds that for 2 a e x prob w 1 s 2 1 w 0 x prob w 1 s w 0 x therefore from the previous inequality we have for 2 a e x prob w 2 s w 0 x prob w 1 s w 0 x apply this to the above integrals 10 5 and get 2 s 1 s g prob w 2 s w 0 x d 2 x g prob w 1 s w 0 x d 1 x 0 on the other hand due to the definition of s 1 s 2 s this and the condition 2 1 on g yields 10 6 prob w 2 s w 0 x prob w 1 s w 0 x 0 for 2 a e x in g let 2 be the restriction of 2 to the to the initial distribution 2 g and consider its eulerian flow 2 since the active set a is a connected open set we have 2 0 everywhere in a recall from above that 2 0 on o and that 2 0 on a for the eulerian flow 2 of 2 with 2 in other words 2 0 wherever 2 0 therefore from the markov property of the brownian motion the resulting target distribution 2 of 2 has 2 0 on o because it has to be 0 wherever 2 0 now 10 6 implies that 2 s 0 so 2 s 0 as desired this completes the proof references 1 damon alexander inwon kim and yao yao quasi static evolution and congested crowd transport non linearity 27 4 823 2014 2 hans wilhelm alt and stephan luckhaus quasilinear elliptic parabolic differential equations mathema tische zeitschrift 183 3 311 341 1983 3 i athanasopoulos l caffarelli and sandro salsa regularity of the free boundary in parabolic phase transition problems acta mathematica 176 2 245 282 1996 4 jacques aze ma and marc yor une solution simple au probleme de skorokhod in se minaire de probabilite s xiii pages 90 115 springer 1979 5 j backhoff veraguas m beiglbo ck m huesmann and s ka llblad martingale benamou brenier a probabilistic perspective arxiv e prints august 2017 6 j r baxter and r v chacon potentials of stopped distributions illinois journal of mathematics 18 4 649 656 1974 7 j r baxter and r v chacon compactness of stopping times z wahrscheinlichkeitstheorie und verw gebiete 40 3 169 181 1977 8 mathias beiglbo ck pierre henry laborde re and friedrich penkner model independent bounds for option prices a mass transport approach finance and stochastics 17 3 477 501 2013 9 mathias beiglbo ck and nicolas juillet on a problem of optimal transport under marginal martingale constraints ann probab 44 1 42 106 2016 10 mathias beiglboeck alexander mg cox and martin huesmann optimal transport and skorokhod em bedding inventiones mathematicae 208 2 327 400 2017 the stefan problem and optimal brownian martingale transport 51 11 luis caffarelli arshak petrosyan and henrik shahgholian regularity of a free boundary in parabolic potential theory journal of the american mathematical society pages 827 869 2004 12 l chayes and g swindle hydrodynamic limits for one dimensional particle systems with moving bound aries the annals of probability 24 2 559 598 1996 13 lincoln chayes and inwon c kim a two sided contracting stefan problem communications in partial differential equations 33 12 2225 2256 2008 14 lincoln chayes and inwon c kim the supercooled stefan problem in one dimension communications on pure applied analysis 11 2 845 2012 15 sunhi choi and inwon c kim regularity of one phase stefan problem near lipschitz initial data american journal of mathematics 132 6 1693 1727 2010 16 alexander mg cox and jiajie wang root s barrier construction optimality and applications to variance options the annals of applied probability 23 3 859 894 2013 17 b dahlberg harmonic functions in lipschitz domains harmonic analysis in euclidean spaces proc symp pure math xxxv 313 322 1979 18 tiziano de angelis from optimal stopping boundaries to rosts reversed barriers and the skorokhod em bedding annales de l institut henri poincare probabilite s et statistiques 54 2 1098 1133 05 2018 19 franc ois delarue james inglis sylvain rubenthaler and etienne tanre global solvability of a networked integrate and fire model of mckean vlasov type the annals of applied probability 25 4 2096 2133 2015 20 franc ois delarue sergey nadtochiy and mykhaylo shkolnikov global solutions to the supercooled stefan problem with blow ups regularity and uniqueness arxiv preprint arxiv 1902 05174 2019 21 emmanuele dibenedetto and avner friedman the ill posed hele shaw model and the stefan problem for supercooled water transactions of the american mathematical society 282 1 183 204 1984 22 yan dolinsky and h mete soner martingale optimal transport and robust hedging in continuous time probability theory and related fields 160 1 391 427 oct 2014 23 neil falkner on skorohod embedding in n dimensional brownian motion by means of natural stopping times in se minaire de probabilite s xiv 1978 79 pages 357 391 springer 1980 24 alessio figalli xavier ros oton and joaquim serra the singular set in the stefan problem arxiv preprint arxiv 2103 13379 2021 25 paul gassiat harald oberhauser and gonc alo dos reis root s barrier viscosity solutions of obstacle problems and reflected fbsdes stochastic processes and their applications 125 12 4601 4631 2015 26 paul gassiat harald oberhauser and christina z zou a free boundary characterisation of the root barrier for markov processes probability theory and related fields 180 33 69 2021 27 nassif ghoussoub young heon kim and tongseok lim structure of optimal martingale transport plans in general dimensions the annals of probability 47 1 109 164 2019 28 nassif ghoussoub young heon kim and tongseok lim optimal brownian stopping when the source and target are radially symmetric distributions siam journal on control and optimization 58 5 2765 2789 2020 29 nassif ghoussoub young heon kim and aaron zeff palmer pde methods for skorokhod embeddings calculus of variations and partial differential equations 58 3 113 2019 30 nassif ghoussoub young heon kim and aaron zeff palmer optimal stopping of stochas tic transport minimizing submartingale costs transactions of the american mathematical society https doi org 10 1090 tran 8458 2021 31 nassif ghoussoub young heon kim and aaron zeff palmer a solution to the monge transport problem for brownian martingales the annals of probability 49 2 877 907 march 2021 32 filippo santambrogio guido de philippis alpa r richa rd me sza ros and bozhidar velichkov bv estimates in optimal transportation and applications arch rational mech anal 219 829 860 2016 33 gaoyue guo xiaolu tan and nizar touzi on the monotonicity principle of optimal skorokhod embedding problem siam journal on control and optimization 54 5 2478 2489 2016 34 david hobson the skorokhod embedding problem and model independent bounds for option prices in paris princeton lectures on mathematical finance 2010 pages 267 318 springer 2011 52 inwon c kim and young heon kim 35 matt jacobs inwon kim and jiajun tong darcy s law with a source term archive for rational mechanics and analysis 239 3 1349 1393 2021 36 erik lindgren and re gis monneau pointwise regularity of the free boundary for the parabolic obstacle problem calculus of variations and partial differential equations 54 1 299 347 2015 37 terry r mcconnell the two sided stefan problem with a spatially dependent latent heat transactions of the american mathematical society 326 2 669 699 1991 38 anvarbek mukatovich meirmanov the stefan problem volume 3 walter de gruyter 2011 39 p a meyer convergence faible et compacite des temps d arre t d apre s baxter et chacon se minaire de probabilite s volume xii of lecture notes in mathematics 649 411 423 1978 40 sergey nadtochiy mykhaylo shkolnikov and xiling zhang scaling limits of external multi particle dla on the plane and the supercooled stefan problem arxiv preprint arxiv 2102 09040 2021 41 jan ob lo j the skorokhod embedding problem and its offspring probability surveys 1 321 392 2004 42 edwin perkins the cereteli davis solution to the h 1 embedding problem and an optimal embedding in brownian motion in seminar on stochastic processes 1985 pages 172 223 springer 1986 43 beno t perthame fernando quiro s and juan luis va zquez the hele shaw asymptotics for mechanical models of tumor growth archive for rational mechanics and analysis 212 1 93 127 2014 44 d h root the existence of certain stopping times on brownian motion the annals of mathematical statistics 40 715 718 1969 45 h rost skorokhod stopping times of minimal variance lecture notes in math se minaire de probabilite s x premie re partie univ strasbourg 511 anne e universitaire 1974 1975 1976 46 filippo santambrogio optimal transport for applied mathematicians springer 2015 47 filippo santambrogio crowd motion and evolution pdes under density constraints esaim proceed ings and surveys 64 137 157 october 2018 48 bernard sherman a general one phase stefan problem quarterly of applied mathematics 28 3 377 382 1970 49 a v skorokhod studies in the theory of random processes translated from the russian by scripta technica inc addison wesley publishing co inc reading mass 1965 50 volker strassen the existence of probability measures with given marginals the annals of mathematical statistics 36 2 423 439 1965 51 ce dric villani topics in optimal transportation graduate studies in mathematics american mathemat ical society 2003 52 ce dric villani optimal transport old and new volume 338 springer science business media 2008 department of mathematics university of california at los angeles los angeles ca usa email address ikim math ucla edu department of mathematics university of british columbia vancouver v 6 t 1 z 2 canada email address yhkim math ubc ca 1 introduction 2 preliminaries 3 properties of stopping times 4 stopping times and potential flows 5 consistency with the stefan problem 6 subharmonically generated sets 7 optimal target problem 8 saturation property of the optimal target 9 global time existence of supercooled stefan problem 10 monotonicity of the optimal barrier functions references