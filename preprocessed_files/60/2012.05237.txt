applications of mean field games in financial engineering and economic theory ren carmona abstract this is an expanded version of the lecture given at the ams short course on mean field games on january 13 2020 in denver co the assignment was to discuss applications of mean field games in finance and economics i need to admit upfront that several of the examples reviewed in this chapter were already discussed in book form still they are here accompanied with discussions of and references to works which appeared over the last three years moreover several completely new sections are added to show how recent developments in financial engineering and economics can benefit from being viewed through the lens of the mean field game paradigm the new financial engineering applications deal with bitcoin mining and the energy markets while the new economic applications concern models offering a smooth transition between macro economics and finance and contract theory contents 1 introduction 1 2 financial engineering applications 3 3 games models for energy and the environment 13 4 macro economic growth models 16 5 from macro to finance 23 6 moral hazard contract theory 38 references 51 1 introduction the goal of this chapter is to review applications in financial engineering and econom ics which can be cast and tackled within the framework of the mean field game often abbreviated as mfg in the sequel paradigm sections 2 3 and 4 revisit some of the applications discussed in 21 chapter 1 here we try to give some context and examine developments which occurred since the pub lication of the book while we do not delve into proofs we provide detailed references where the interested reader will be able to find complements on the subject matters this is clearly the case for section 2 reviewing applications to financial engineering 2000 mathematics subject classification primary the author was partially supported by nsf dms 1716673 and aro w 911 nf 17 1 0578 1 ar x iv 2 01 2 05 23 7 v 1 q fi n g n 9 d ec 2 02 0 2 ren carmona economic models often involve optimization over sets of actions behaviors and strate gies engineers and biologists facing similar optimization problems would be likely to re strict themselves to finite action sets but many economists prefer continuous action sets in order to be able to write first order conditions of optimality in differential forms in hope of resolving them with explicit solutions furthermore they have no qualms about using models with a continuum of agents they explain that this guarantees an environment with perfect competition and tractable equilibrium behavior however these formulations often raise eyebrows from colleagues and especially mathematicians our discussion of macro economic models is motivated in part by the desire to reconcile the approach to competitive equilibria with a continuum of players with the paradigm of mean field games addition ally while not all economists like to work with continuous time it has been argued over the last two decades that models in macro economic contract theory finance greatly benefit from the switch to continuous time from the more traditional discrete time models yuli sannikov is certainly one of the most visible crusaders in this respect and we shall follow his lead and consider only continuous time models in this review chapter like it is often the case in the published literature in economics economies are mod eled as populations with a continuum of players and to capture the fact that the influence of any individual member on the aggregate should be infinitesimally small these individ uals are modeled as elements of a measure space with a continuous measure say the unit interval 0 1 with its lebesgue s measure this starting point is different from the typical set up of mean field games which usually starts from n player games with n finite and considers the limit n we shall use both modeling paradigms and refere the reader to 21 section 3 7 for a discussion of the links between the two none of the macro economic papers which we review in this chapter mention the name nash or use the terminology nash equilibrium the authors of these papers are concerned with general equilibria not nash equilibria they first assume that all the aggregate quan tities in the economy are given and they let the participants in the economy optimize their utilities independently of each other next they identify the constraints to be satisfied according to economic theory compile them in a set which they call set of clearing con ditions and check that the results of the participants optimizations are compatible with the clearing conditions as long as the clearing conditions are satisfied while the partici pants in the economy optimize their expected utilities a general equilibrium is said to take place this procedure is very similar to the search for a nash equilibrium identifying the best response function amounts to having the participants optimize their expected utilities given the strategies of the other players and given the constraints of economic theory the search for a fixed point of the best response function appears as an analog of the check that the clearing conditions are satisfied the parallel is even more striking when the clear ing conditions can be written in terms of aggregate quantities indeed these aggregates quantify the interactions between the economy participants and since these aggregates are most often nothing more than empirical means of state variables they spell out mean field interactions in the model it is thus reasonable to cast these general equilibria as nash equilibria for mean field game models and take full advantage of the technology already developed for the analysis of these game models to gain a better understanding of these general equilibria acknowledgements i would like to thank markus brunnermeier for relentless attempts at educating me on some of the subtleties of the economic models discussed in section 5 also i would like to acknowledge the useful comments and suggestions from an anony mous referee financial engineering economics 3 2 financial engineering applications 2 1 systemic risk the study of systemic risk is concerned with the identification and analysis of events or a sequences of events which could trigger severe instability or even collapse of the financial system and the entire economy as a result in finance sys temic risk is approached differently than the risk associated with any one individual insti tution or portfolio in the us it was first brought to the forefront by the federal reserve bank of new york after the september 11 2001 attack see 62 the central bank spearheaded several collaborative research initiatives involving economists and academic researchers including engineers working on the safety of the electric grid mathematicians experts in graph theory and network analysis population biologists but unfortunately what brought this line of research in the limelight is the financial crisis of 2008 for which systemic risk was a major contributor while the mean field game models we discuss below give identical importance to the various institutions involved in the model it is clear that a realistic model of systemic risk in finance should differentiate the roles of those companies considered to be too big to fail and which have been identified officially under the name of sifi for systemically important financial institutions they are the banks insurance companies or other financial institutions that u s federal regulators think would pose a serious risk to the economy if they were to collapse see 47 for an account of the state of the art after the financial crisis we shall briefly discuss extensions of the models re viewed below which could possibly account for the presence of such important players in the models 2 1 1 a toy model of systemic risk our first example is borrowed from 26 we view its main merit as being pedagogical it gives us the opportunity to review some of the main features of linear quadratic lq finite player game models and in so doing explain how one can solve them moreover despite its very simple structure it exhibits several very useful characteristics for each integer n 1 the n player version of the game has a unique closed loop equilibrium a unique open loop equilibrium this open loop equilibrium is in closed loop form but it is different from the closed loop equilibrium however when n both equilibria converge toward the unique equilibrium of the mean field game to describe the model let us assume that the log monetary reserves of n banks say xit i 1 n satisfy dxit a xt xit i t dt 1 2 dw it dw 0 t i 1 n where w it i 0 1 n are independent brownian motions and 0 is a constant the notation x t stands for the empirical mean of the xit for i 1 n a is a constant regulating the mean reversion of xit toward the mean and correlates the idiosyncratic shocks dw it and the common shock dw 0 t so in this model borrowing and lending is done through the drifts in fact if xit is small relative to the empirical mean xt then bank i wants to borrow it 0 if xit is large then bank i will want to lend it 0 4 ren carmona the adapted stochastic process i it t 0 is the control strategy of bank i which tries to minimize the quantity j i 1 n e t 0 1 2 it 2 q it xt x i t 2 xt xit 2 dt 2 xt xit 2 2 1 we could imagine that the quantity q 0 is chosen by the regulator to control the cost of borrowing and lending this model is a simple example of an n player stochastic differential game with mean field interactions since the interactions are through the empirical means of the n states and a common noise explicit solutions for finiten while it is usually very difficult to identify and com pute nash equilibria for finite player games especially when the games are stochastic and dynamic the very special linear quadratic lq nature of the model allows for explicit solutions searching for an open loop nash equilibrium t 0 t t for the game with t 1 t n t being adapted to the filtration generated by the brownian motions can be done using the pontryagin stochastic maximum principle in this particular model one finds that the strategy profile defined by 2 2 it q 1 1 n t xt xit where the deterministic function t 7 t solves the riccati equation 2 3 t 2 a q 1 n q t 1 1 n 2 t q 2 with terminal condition t c this equation is uniquely solvable if we assume q 2 is the unique open loop nash equilibrium notice that t is in closed loop feedback form since it is of the form t t xt for the deterministic function 2 4 t x 7 it x q 1 1 n t x xi with x 1 n n i 1 xi for i 1 n note also that in equilibrium the states of the banks satisfy 2 5 dxit a q 1 1 n t xt xit dt dw 0 t 1 2 dw it for i 1 n so the states evolve according to an ornstein ulhenbeck like process which is gaussian if the initial conditions are gaussian or deterministic searching for a closed loop nash equilibrium t 0 t t with t t xt is usually done by deriving the hamilton jacobi bellman equation for the system of value functions of the players but in this particular instance it can also be done using the pon tryagin stochastic maximum principle in any case one finds that there exists a unique nash equilibrium and like in the open loop case the equilibrium strategy profile is given by feedback functions 1 n given by the same formula 2 4 except for the financial engineering economics 5 fact that the deterministic function t 7 t now solves a slightly different riccati equation namely 2 6 t 2 a q t 1 1 n 2 2 t q 2 with the same terminal condition t c the same remarks apply to the ornstein ulhenbeck nature of the state evolutions in equilibrium however what is remarkable is the fact that the open loop nash equilibrium happens to be in closed loop form but still it is not a closed loop nash equilibrium this is very different from the situation for plain optimization in fact it reinforces the message that looking for a nash equilibrium is a far cry from solving an optimization problem the second point we want to emphasize is that both riccati equations and hence both solutions coincide in the limit n more on that below the interested reader can find complements and detailed proofs in 21 section 2 5 relevance to mean field games mfgs mean field games have been touted as the appropriate limits of n player games when n however beyond appealing in tuitive arguments and rigorous proofs that mfg solutions can be used to construct strategy profiles forming approximate nash equilibria for n player games the larger n the bet ter the approximation proving actual convergence is a difficult problem see for example d lacker chapter in this volume in the present situation because of the explicit nature of the solutions of the finite player games we can take the limit n in the dynamics of the states in the nash equilibrium controls open and closed loop and in the expected costs optimized by the players all that despite the presence of the common noise in fact we can read off the impact of the common noise in the limit n where the open and closed loop models coincide this limit can formally be identified to the so called mean field game model and we can even identify the master equation from the large n behavior of the system of hjb equations mfgs as models for systemic risk being set up in continuous time the above model is multi period in nature this is in sharp contrast with most of the existing math ematical models of systemic risk which are most often cast as static one period models still one of the most valuable feature of the model presented above is being explicitly solvable on the shortcoming side i need to admit that this is a very naive model of bank lending and borrowing among its undesirable features the model does not have any provision for borrowers to repay their debts moreover despite explicit solutions it gives only a small jab at the stability properties of the system still the model raises interesting challenges and it seems reasonable that it can be made more realistic and more useful with some mathematically tractable add ons we cite three of them for the sake of illustration the introduction of major and minor players in this model will allow to capture the crucial role played by the sifis discussed in the introduction to this section game models with major and minor players experienced a renewal of interest recently and systemic risk seems to be a perfect testbed for their implementation in order to palliate some of the unrealistic features of the original model car mona fouque moussavi and sun suggested the introduction of time delays in 6 ren carmona the controls in 25 while increasing the technicalities of the proofs and pre cluding explicit solutions this extension of the model includes provisions for borrowers to repay their debts in a fixed amount of time as another example of the fact that systemic risk is a fertile ground for the in troduction and analysis of new mfg models we mention the recent paper by benazzoli ciampi and di persio 17 in which the authors study a simple illiq uid inter bank market model where the banks can change their reserves only at the jump times of some exogenous poisson processes with a common constant intensity also noteworthy is a recent paper 69 of nadtochyi and shkolnikov who study the mean field limit of systems of particles interacting through hitting times their model was motivated by the contagion of the times of default of financial institutions in periods of economic stress it would be interesting to add the opti mization component to their model and study the endogenously made decisions of the participants finally the introduction of graphical constraints should be a good way to quan tify the various levels of exchanges between the financial institutions introduc ing a weighted graph of interactions between the players of the game changes dramatically the mean field nature of the model and new solution approaches will have to be worked out for any significant progress to be made in this direc tion still despite the obvious challenges of this research program it is under active investigation by many financial engineers 2 2 price impact and optimal execution high frequency markets offer another fertile ground for applications of financial engineering among other things they high lighted the importance of price impact and optimal execution the search for the best possible way to execute a given trade is an old problem and the presence of price impact did not have to wait for the popularity of the high frequency markets a model for price impact we briefly review an mfg model of price impact intro duced by carmona and lacker in 27 there it was solved in the weak formulation but for the purpose of the present discussion the specific approach used to get to a solution will not really matter we start with a model for n traders we denote by xit the inventory i e the number of shares owned at time t by trader i and we assume that this inventory evolves as an it process according to 2 7 dxit i t dt idw it where it represents the rate of trading of trader i this will be their control w i w it t 0 are independent wiener processes for i 1 n and i represents an id iosyncratic volatility we assume that it is independent of i for simplicity note that in essentially all the papers on the subject this volatility is assumed to be 0 in other words inventories are assumed to be differentiable in time our decision to work with i 0 is backed by empirical evidence at least in the high frequency markets as demonstrated by carmona and webster in 30 next we denote bykit the amount of cash held by trader i at time t we have dkit i tst c i t dt where st is the transaction price of one share at time t and the function c 0 models the cost for trading at rate as explained in 30 this function c should be thought financial engineering economics 7 of as the legendre transform of the shape of the order book so for a flat order book we should have c c 2 we model the time evolution of the price st using the natural extension to the case of n traders of the price impact formula of almgren and chriss 7 dst 1 n n i 1 h it dt 0 dw 0 t for some non negative increasing function 7 h and a wiener process w 0 w 0 t t independent of the other ones in this model the wealth v i t of trader i at time t is given by the sum of his holdings in cash and the value of his holdings in the stock as marked at the current value of the stock v it k i t x i tst using the standard self financing condition and it s formula we see that dv it dk i t x i t dst st dx i t c it x i t 1 n n j 1 h j t dt stdw i t 0 x i tdw 0 t 2 8 so if player i minimizes their expected trading costs j i 1 n e t 0 cx x i t dt g x i t v i t where x 7 cx x represents the cost of holding an inventory of sixe x and g x a form of terminal inventory cost using 2 8 we can rewrite these expected costs as j i 1 n e t 0 f t xit n t i t dt g x i t if nt denotes the empirical distribution of 1 t n t and the function f is defined by f t x c cx x x h d remark 2 1 several important remarks are in order at this stage 1 the above model is the epitome of a n player stochastic differential game 2 the state equations are given by 3 1 they are driven by the n independent idiosyncratic noise term dw it the common noise w 0 disappeared from the optimization problem only because of the risk neutrality of the traders namely the fact that they minimize the expectations of their costs should they choose to minimize a nonlinear utility function the common noise would not disappear 3 another remarkable property of this model and one of the reasons its analysis was of great interest is that it is one of the earliest mfg models for which the mean field interaction occurs naturally through the controls an early analysis of these mfgs within the probabilistic approach was given in 21 section 4 6 while the model formulated above is for n traders the mean field formulation n is clear a complete solution of this limit mfg in the weak formulation can be found in 27 and in 21 section 4 7 for the strong formulation later on it was revisited by cardaliaguet and lehalle in 18 where the authors consider agents possible hetero geneities and the introduction of fictitious plays which gives a learning twist to the model it was also extended by cartea and jaimungal in 32 to formulate an optimal execution 8 ren carmona problem for which the authors could still provide solution formulas in quasi explicit forms game models for optimal execution in the presence of price impact did not wait for the theory of mfgs to catch the interest of financial economists and financial engineers the interested reader may want to check the papers 13 19 and 31 for games models shedding light on predatory trading 2 3 models for bank runs mean field games of timing i came across the potential application of mean field games to the important problem of bank runs by at tending jean charles rochet s lectures at the vancouver systemic risk summer school in july 2014 and the talk given by olivier gossner during the conference following the sum mer school both works 71 46 are reported in detail in 21 22 here we only review the second one because it fits better in the class of continuous time models on which we concentrate in this chapter in the spirit of the discussion to follow it is worth mentioning the works of morris and shin 68 and he and xiong 56 like most economists they use a model of the economy with a continuum of players based on an atomless measure space our goal is to recover their models starting with finitely many players and then analyze the mean field limit a continuous time model for bank runs following gossner s talk mentioned ear lier we consider a group of n depositors with individual initial deposits in the amount di 0 1 n for i 1 n they are promised a rate of return r r where r is the cur rent prevailing interest rate we assume that the value yt of the assets of the bank at time t follows an it process and that y 0 1 we also assume the existence of a deterministic function y 7 l y giving the liquidation value of the bank assets when yt y one can imagine that the bank has a rate r credit line of size l yt at time t and that the bank uses this credit line each time a depositor runs withdraws their deposit next we assume that the assets mature at time t and that no transaction takes place after that if at that time yt 1 every one is paid in full but if yt 1 we treat this case as an exogenous default we talk about an endogenous default at time t if depositors try to withdraw more than l yt at that time as time passes each depositor has access to a private signal xit satisfying dxit dyt dw i t i 1 n and at a time i of their choosing they can attempt to withdraw their deposit de facto collecting the return r until time i and trying to maximize j i 1 n e g i y i i where we use the standard notation i 1 i 1 i 1 n and for example g t yt 1 n e r r t e rt l yt nt n 1 n nt i i t is number of withdrawals before t and inf t l yt nt n is the first time the bank cannot withstand the withdrawal requests first let us try to derive some conclusions if the depositors had full information in which case yt would be public knowledge and would be 0 i e 0 if we also assume financial engineering economics 9 that the function y l y is known to the depositors then it is easy to check that in any equilibrium i inf t l yt 1 so all the depositors withdraw at the same time they all run on the bank simultaneously and each depositor gets their deposit back no one gets hurt clearly this scenario is unfor tunately highly unrealistic we should expect that depositors wait longer before running on the bank presumably because they only have imperfect information i e noisy private signals on the health of the bank games of timing let us consider a population of n players with individual states x n i t at time t satisfying equations of the form dx n i t b t x n i t n t dt t x n i t dw i t i 1 n coupled through their empirical distribution nt 1 n n i 1 x n i t each player chooses a fx i stopping time i and tries to maximize j i 1 n e g i x i n 0 i where 1 n n i 1 i is the empirical distribution of the i s g t x p is the reward to a player for exercising their timing decision at time t when their private signal is xit x and the proportion of players who already exercised their right is p taking formally the limit n in this set up we obtain the following mfg formulation of a mean field game of timing assuming that the drift is independent of the empirical distribution of the states for the sake of simplicity i e b t x b t x the dynamics of the state of a generic player are given by an it equation of the form dxt b t xt dt t xt dwt we denote by fx fxt 0 t t the information available to the agent at time t and by sx the set of fx stopping times the mfg of timing paradigm can then be formulated as follows 1 best response optimization for each fixed environment p 0 t solve arg sup sx t e g x 0 2 fixed point step find so that 0 t p t here and throughout we denote by p a the space of probability measures on a 10 ren carmona existence with randomized stopping times in an unpublished phd thesis geoffrey zhu proposed an existence proof for randomized stopping times providing an analog of nash s original existence theorem for the existence of equilibria in mixed strategies before we go any further recall the sobering shortcoming of convergence in distribu tion which says that even if limn x yn x y in law yn is a function of x then y is not necessarily a function of x in other words y x may not hold for the purpose of this existence proof let us assume that the reward function g 0 t r p 0 t 3 t x 7 g t x r is bounded continuous in t x for fixed and lipschitz continuous in for t x fixed note that unfortunately this last assumption is not satisfied for functions t 0 t unless t t 0 t with t finite this will prevent us from using this existence result in the model of bank run discussed earlier in any case under the present assumptions p 0 t p c 0 t 0 t 7 r c 0 t 0 t g t xt dx dt is continuous and since the space s of randomized stopping times is compact because of an old result of baxter and chacon berge s maximum theorem implies that the multivalued function p 0 t 3 arg sup s is upper hemi continuous and compact valued followed by the projection on the first marginal it is still upper hemi continuous and compact valued and kakutani s fixed point theorem implies the desired existence result existence with usual stopping times existence for standard stopping times can be shown to hold under a different set of assumptions using for example the order structure of the space of stopping times instead of topological properties of this space for example if we assume that the time increments of g are monotone in then we can use the fact that the space of stopping times is a complete lattice check that arg sup s e g x f is monotone and use tarski s fixed point theorem here f t p t is the cumula tive distribution function of unfortunately once more this existence result does not apply to the model of bank run discussed earlier solution in the general case including common noise beyond a simple example presented by m nutz in 70 the solution in the general bank run set up introduced earlier is much more difficult and technical than originally thought a complete solution was given by carmona delarue and lacker in 23 see also 11 by c bertucci for an approach relying purely on partial differential equations and quasi variational inequalities and 48 by bouveret dumitrescu and tankov for more on the use of relaxed stopping times financial engineering economics 11 2 4 cryptocurrencies and bitcoin mining given the fact that the bitcoin mania hits the financial markets on a recurrent basis and because of the competitive nature of the mining process involving a large number or miners it is no surprise that mean field game models have been proposed to analyze some of the features of the cryptocurrency space here we briefly review two very recent papers by li reppen and sircar 65 and bertucci bertucci lasry and lions 12 which use continuous time mean field games though in very different ways to analyze some of the features of cryptocurrency generation both papers envision a continuum of miners interacting through the aggregate computational power they allocate to mining the blockchain even though it is not the only cryptocurrency we shall only talk about bitcoin because it is the one getting the most press there are many reasons for that wild price moves being definitely one of them after briefly exceeding 12 000 it crashed down to the 10 000 range before quickly moving up again to high levels the generation of bitcoins is based on blockchain technology the latter was intro duced for the purpose of record keeping in a decentralized ledger still it is at the core of bitcoin generation in bitcoin production independent miners compete for the right to record the next transaction block on the blockchain they follow a proof of work pow protocol their goal is to solve mathematical puzzles designed to be solved by brute force only computations to solve puzzles create a block and earn a reward are otherwise to tally useless as they are not applicable anywhere else once a miner obtains a solution the corresponding block is added on top of the blockchain and the miner obtains their re ward this reward is paid out in cryptocurrency a fixed number of bitcoins currently 12 50 bitcoins for adding a block while electricity and mining hardware need to be paid with traditional fiat currency like the us dollar the supply of bitcoins is constantly growing however it is limited to 21 million of which more than 17 million are already in circulation the security of the network is a serious issue a major fear is a majority attack also called 51 attack when a group of users controls the majority of mining power these instances are rare mostly because they are very difficult to realize due to their enormous costs they are not considered in 65 12 the computing power devoted to mining is called the hash rate it captures the num ber of trials per second trying to solve the mining puzzle in order to maintain stability in the blockchain the mining puzzle difficulty is dynamically adjusted so that on average the time between the creation of two consecutive blocks is constant currently approxi mately 10 minutes therefore as the hash rate increases the difficulty increases so that it is required to compute more hashes for a given block miners control their hash rate to increases their share of the blockchain reward all other things being equal while reducing the share of the other miners on the other hand intensive computations consume a lot of energy and each miner faces significant electricity costs in a nutshell this dilemma is the core of the individual miner optimization problem the aggregate hash rate in the system represents the total computational power devoted to block creation in both papers this aggregate hash rate will be the source of the mean field interaction between the miners in 65 li reppen and sircar focus on the risk borne by risk averse miners and study mining concentration they use a jump process to represent the acquisition of the reward the jump intensity being the control of the typical miner in their model the jump intensity reflects the computer power or hash rate devoted to the effort and the mean of the controls of the individual miners is what creates the mean field interaction in the model given our 12 ren carmona simplistic description of how bitcoins are generated it is natural to assume that the miner s probability of receiving the next mining reward is proportional to the ratio of their hash rate to that of the population the number of rewards each miner receives is modeled by a counting process nt with jump intensity t 0 if the number of miners is m 1 this intensity is given by t t d t m t where m t approximates the total hash rate of the other miners the wealth of the miner is used as state variable it evolves as an it process of the form dxt c tdt pdnt where p is the bitcoin price so the value of each reward is the product of its quantity by p as we mentioned earlier 12 50 bitcoins are granted to a miner for adding a block successfully the total number of rewards in the system as a whole is a poisson process with a constant intensity d 0 this will play the role of a common noise in the model given an adapted process t t 0 representing the conditional mean of the con trols given the common noise the miner optimization problem is to maximize the expected utility of wealth at a fixed terminal time t v t x sup 0 a x e u xt xt x where the controls are restricted to the interval 0 a x when the state is x the authors tackle the optimization problem by solving the hjb equation tv sup 0 a x c xv d m t v 0 and the solution is completed by solving the fixed point equation for the average effort rate the authors provide an explicit solution for exponential utility and no liquidity constraint they go on to the analysis of the effect of liquidity constraints and more general utility functions they provide robust numerical procedures to compute the equilibrium in the case of the crra power utility function they study the concentration of wealth among the miners their conclusion is that the richer the miner the wealthier they will get the authors also introduce a model in which one special miner is singled out for having a significant cost advantage e g benefitting from cheaper electricity prices over the remaining field of miners naturally this special miner is shown to contribute more to the hash rate bertucci bertucci lasry and lions use a different modeling approach very much in the spirit of the work 64 proposing a mean field approach to the dynamics of an order book in the high frequency markets they directly introduce the master equation arguing that this is the best way to study mean field games notice that this is in sharp contrast with the usual approach starting from the introduction of the agents maximization problems using their notation system p is now the nominal hashrate number of hashes per second they define the real hashrate kt e tpt arguing that the rate quantifies technological progress the evolution of kt is modeled in continuous time as miners continuously acquire computing power to compute hashes as we explained earlier the blockchain outputs a fixed number of coins per unit of time so the miners compete against each other to earn a share of this fixed output from the above description it is reason able to assume that the share they get is proportional to their relative share of the total financial engineering economics 13 computational power the authors posit dynamics of the real hash rate in the form dkt ktdt ut kt dt k 0 k where ut represents the flow of entry of computing devices or in other words the value of a unit of real hash rate they introduce the relationship 0 r u k ku k 1 c this partial differential equation pde should be viewed as the master equation of the competitive mean field game with finitely many states the players are the miners and we should think of k as a measure of an aggregate of the population of miners responsible for the mean field interaction if we now assume that the reward is of the form g pt kt where g is a smooth positive function of pt which evolves according to dpt pt dt 2 dwt p 0 p dkt ktdt ut kt pt dt k 0 k where the function is lipschitz 0 and w wt t 0 is a standard wiener process then u k p 0 e r t g pt kt c dt is the value function of one unit of real hashrate in this model pt captures the exchange rate between the value of the cryptocurrency and fiat money and w wt t 0 is a form of common noise in this case the master equation on 0 r reads 0 r u k u ku pu 2 ppu g p k c this is the master equation of a mfg with finite state space and common noise again the monotone structure of the mfg plays a key role in the well posedness of these models indeed existence and uniqueness follow from monotonicity and the existence of a station ary state is also proven and analyzed this is proven in 12 when g is bounded from above and below 12 also discusses model security against attacks proposes extensions to several com peting populations of miners facing different mining costs and a market where mining equipment can be bought and sold 3 games models for energy and the environment in this section we review some of the mfg models which have been touted and used to revisit and extend earlier economic analyses of energy and environment markets we first summarize the discussion given in 21 section 1 4 4 of a first model proposed by gu ant lasry and lions in 54 3 1 mfg models for oil production if we denote by x 10 x n 0 the initial re serves of n oil producers who control their own rates of production and if we denote by xit the oil reserves of producer i at time t the changes in reserves should be given by equations of the form 3 1 dxit i tdt x i tdw i t where 0 is a volatility level common to all the producers the non negative adapted and square integrable processes i it t 0 being the controls exerted by the producers 14 ren carmona and the wi w it t 0 independent standard wiener processes if we denote by pt the price of one barrel of oil at time t and if we denote by c b 2 2 a the cost of producing barrels of oil then producer i tries to maximize 3 2 j i 1 n sup t t 0 t 0 e 0 e rt itpt c i t dt where r 0 is a discount factor as we are about to explain the price pt is the source of coupling between the producers strategies the notion of general equilibrium is intended to characterize situations in which all the producers manage to maximize their profits si multaneously and the market clears in the sense that demand matches supply let us de note by d t p the demand at time t when the price is p the function d t p we tp was used in 54 we use the obvious notation d 1 for the inverse demand function i e q d t p p d 1 t q mean field formulation in the present context the mfg paradigm can be articu lated easily for each fixed deterministic flow t t 0 of probability measures we compute the price pt from the formula pt d 1 t d dt x t dx and the best response to this flow of distributions is given by the solution of the discounted infinite horizon optimal control problem for the instantaneous cost function f t x p c e rt under the dynamic constraint 3 1 the mfg will be solved if one can find a measure flow t t 0 such that the marginal distribution l xt of the solution of the control prob lem matches the flow we started from namely t l xt for all t 0 the analytic approach to mfgs based on the solution of a system of coupled hjb and fokker planck kolmogorov equations is used in 54 to give a solution to this problem numerical illus trations provide comparative statics of the solutions are also given variations and extensions in 36 chan and sircar propose to look at dynamics 3 3 dxs sds dws xt x 0 with a dirichlet boundary condition at xt 0 to guarantee that the reserves of a generic oil producer do not become negative as before t represents the rate of production of a generic producer andxt represents the remaining reserves as in most models for cournot games the price experienced by the producer call it pt for the sake of definiteness is given by a linear inverse demand function of the rates of production and it is chosen to be of the form pt 1 t t where t is the mean production rate for all the exhaustible resources so that the cost function becomes f t x 1 p where denotes the distribution of the control giving the rate of production the mean of this distribution and p the price given by the above inverse demand function this is a typical extended mfg because the mean field interaction is through the controls with a boundary condition to guarantee that the remaining reserves do not become negative in parallel the authors propose a slightly modified model for producers of renewable energy financial engineering economics 15 and analyze the oil market in the presence of both populations of producers in this paper they also propose several variations on the above model their goal was to include several realistic features like strategic blockading the entrance of renewable producers and explo ration and discovery of new reserves while not always worrying about all the subtleties of mathematical existence theorems they provide enlightening numerical illustrations of their conclusions this prompted more mathematically inclined authors like bensoussan and graber to pursue in 52 a complete existence analysis based on partial differential equations techniques of the models proposed by sircar and chan for the sake of completeness we mention that plain models for a macro perspective on the behavior of a large population of oil producers were proposed by giraud gu ant lasry and lions see for example 49 53 54 more recently achdou giraud lasry and lions revisited some of these models including the presence of major and minor players see 2 also note that game theoretical approaches though not involving mean field games per se were used by ludkovski and sircar in 66 to analyze oil production 3 2 mfg models for the electricity markets and the grid general equilibrium models have a long history in the engineering literature on electricity pricing see for example 57 and the references therein more recently djehiche barreiro gomez and tembine proposed a mean field game model for pricing electricity in a smart grid see 41 still to model individual decision in a smart grid alasseur ben tahar and matoussi use in 6 a game with mean field interactions through the controls as a framework to man age storage in 5 a d dumitrescu and tankov use one of the mean field game of timing models reviewed earlier to capture the time at which renewable producers choose to enter a new market and when conventional producers using fossil fuels should exit the market in a different context a d basei and pham investigate in 4 a stackelberg game model where the leader an electricity producing firm and the follower consumer choose strate gies possibly depending upon their distributions so they solve optimal control problems of the mckean vlasov type the main emphasis of the paper is to show that the stackel berg equilibrium is not pareto optimal and to explain the economic consequences of this disparity investigating the valuation of demand response contracts in a model with a continuum of consumers with mean field interactions and the presence of a common noise impacting their consumptions elie hubert mastrolia and possama formulate in 43 the problem as a contract theory problem with moral hazard as those we shall discuss in more detail in section 6 below in their model the principal is an electricity producer who observes con tinuously the consumption of a continuum of risk averse consumers and designs contracts in order to reduce the production costs to be more specific the producer incentivizes the consumers to reduce the average consumptions as well as their volatilities in different regimes without observing the efforts they potentially make this is exactly the type of models we shall investigate in section 6 the recent paper by shrivats firoozi and jaimungal 74 still in the context of the electricity markets offers a smooth transition with the next discussion of the environment markets indeed it proposes mfg models to derive the optimal behavior of electricity producers and an equilibrium price for solar renewable energy certificate srecs in market based systems designed to incentivize solar energy generation 16 ren carmona 3 3 environment economics early general equilibrium models aimed at under standing the effects and the control of externalities and taxes in the spirit of tobin taxes were proposed by golosov hassler krusell and tsyvinski in 50 general equilibrium models were also used in early works on the emissions markets by bueler 16 and haurie 55 and more significantly in the analysis of the european union emission trading sys tem eu ets by carmona fehr hinz and porchet in 24 see also the references therein we argue later on in section 4 that many general equilibrium models can be recast as mean field game models more recently ideas which first appeared in the treatment of mfgs were used by bahn haurie and malham to model negotiations related to environment policies see 9 finally we mention the recent work of carmona dayanikli and lauri re 20 who use mfg models with major and minor players very much in the spirit of the contract theory models we review in section 6 to derive equilibrium analyses of externalities and regulation on one end and investments in renewables on the other when dealing with electricity production 4 macro economic growth models in this section we review several general equilibrium economic growth models we borrowed the first one from a paper by gu ant lasry and lions on mean field games 54 we chose to present it here because by cleverly adapting ideas from a model of aghion and howitt the authors present a model with common noise which can be solved explicitly all the way to the master equation our choice of the second model was driven by a remarkable property even though the original contribution 63 of krusell and smith appeared long before the mean field game paradigm was articulated the numerical algorithm proposed by the authors to approximate numerically the equilibrium characteristics reads as if it had been designed for the compu tation of an mfg equilibrium indeed it is eerie to see how closely the description of their numerical algorithm mimics step by step the mean field game strategy based on the alter nate iteration of steps to approach the solution of the hjb equation and the fokker planck kolmogorov equation we learned of the third example presented in this section from a private conversation with benjamin moll we include it in this review because it can be solved completely both analytically and numerically unfortunately those examples are few and far between the interested reader may also want to consult 3 by achdou han lasry lions and moll for another discussion of continuous time macro economic models recast as mfgs 4 1 a first example based on calculus with pareto distributions we introduce directly the mean field formulation of the game without starting from the definition of the finite player game because the interaction between the players is local in the sense that it is a function of the density of the statistical distribution of the states of the players in the case of finitely many players this distribution is the empirical distribution of the finitely many states and as such it does not have a density per se so in order to avoid the introduction of smoothing of the empirical measures to define the costs to the players we jump directly to the mean field game formulation which can be done directly with densities without any need for mollification arguments in this model there are no idiosyncratic shocks just aggregate shocks common to all the players they are given by the increments of a one dimensional wiener process w 0 w 0 t t 0 we denote by f 0 f 0 t t 0 its filtration we also assume that the financial engineering economics 17 volatility of the state of a generic player is linear that is 0 x x for some positive constant and that each player controls the drift of their state so that the dynamics of their state read 4 1 dxt tdt xtdw 0 t we shall restrict ourselves to markovian controls of the form t t xt for a determin istic function t x 7 t x which will be assumed to be non negative and lipschitz in the variable x under these conditions xt 0 at all times t 0 if x 0 0 note that if xt and x t are solutions of 4 1 for the same linear control t x tx for some continuous path 0 t 3 t 7 t 0 with initial conditions x 0 x 0 then 4 2 x t xt x 0 x 0 e t 0 sds 2 2 t w 0 t we assume that k 0 is a fixed parameter and we introduce a special notation for the fam ily of one sided scaled pareto distributions with decay parameter k for any real number q 0 we denote by q the one sided pareto distribution on the interval q 4 3 q dx k qk xk 1 1 q x dx notice that for any random variable x x 1 is equivalent to qx q for each t 0 we define t dx p xt dx f 0 t the flow t t 0 of probability measures is adapted to the filtration f 0 of the common noise recall that the mfg par adigm in the presence of a common noise is to solve for each fixed f 0 adapted flow of probability measures t t 0 the optimization problem of a generic player and then solve the fixed point problem to guarantee that the flow t t 0 we started from is in fact the flow of conditional marginal laws of the solution of the optimization problem for this particular family of distributions if 0 1 then t qt where qt e t 0 sds 2 2 t w 0 t in other words conditioned on the history of the common noise the distribution of the states of the players remains pareto with parameter k if it starts that way and the left hand point of the distribution qt can be understood as a sufficient statistic characterizing the distribution t so if x 0 1 then t qt this simple remark provides an explicit formula for the time evolution of the conditional marginal distributions of the states given the common noise in general mfgs with a common noise this time evolution is difficult to determine as it requires the solution of a forward stochastic partial differential equation spde for short using the same notation as in 54 we define the running cost function f by f x c xa d dx x b e p p x b for positive constants a b c e and p 1 the economic rationale for the form of this cost function and the meanings of the parameters are discussed in 54 by convention the density appearing in this formula is the density of the absolutely continuous part of the lebesgue s decomposition of the measure and it is set to 0 when the measure is singular the argument of the optimization of the hamiltonian is given by x y y e x b 1 p 1 18 ren carmona this formula can be used to write the master equation which when restricted to one sided pareto distributions can be reduced to a finite dimensional pde because of the above re mark accordingly nash equilibria can be identified in this family of pareto distributions the details far too technical for this review can be found in section 4 5 2 of 22 4 2 the krusell smith s growth model one major difference with the growth model discussed in the previous subsection is the fact that on the top of the common noise affecting all the states we also have idiosyncratic random shocks specific to each individual agent in the economy in 63 the shocks take only finitely many values we suspect that this restrictive assumption was made for the purpose of numerical implementation in the next subsection we change the nature of the random shocks by introducing wiener processes to recast the model in the framework of stochastic differential games description of the economy while economists usually work with models compris ing a continuum of players this is indeed the case in 63 in order to avoid the discussion of measurability issues related to continuum families of independent random variables we first discuss the model of an economy comprising n consumers the random shocks are given by a set of n continuous time markov chains zt it t 0 for i 1 n the common component z captures the health of the overall economy like an aggregate productivity measure so for some constant z 0 zt 1 z in good times and zt 1 z in bad times the idiosyncratic component is specific to the consumer it 1 when consumer i is employed and i t 0 whenever they are unemployed z 0 corresponds to the absence of common noise the production technology is modeled by a cobb douglas production function in the sense that the per capita output is given by 4 4 yt ztk t lt 1 where kt and lt stand for per capita capital and employment rates respectively the constant can be interpreted as the number of units of labor produced by an employed individual the power 0 1 is a constant of the model in such a model two quantities play an important role the capital rent rt and the wage rate wt economic theory says that in equilibrium these marginal rates are defined as the partial derivatives of the per capita output yt with respect to capital and employment rate respectively so 4 5 rt r kt lt zt zt kt lt 1 and 4 6 wt w kt lt zt 1 zt kt lt consumer s optimization problem consumers control their capital consumption rate cit at time t and maximize their expected utilities of consumption e 0 e tu cit dt for some discount factor 0 we use the power utility function 4 7 u c c 1 1 1 financial engineering economics 19 for some 0 1 also known as crra short for constant relative risk aversion utility function consumers must choose their consumptions while making sure that their individual capitals kit remain non negative at all times the individual capitals evolve according to the equation dkit rt kit 1 t i t 1 i t wt dt citdt here the constant 0 represents a depreciation rate the second term in the above right hand side represents the wages earned by the consumer it is equal to wt when the consumer is unemployed quantity which should be understood as an unemployment benefit rate on the other hand it is equal to 1 t wt after adjustment for taxes when they are employed here t ut lt where ut 1 lt is the unemployment rate mfg formulation by de finetti s law of large numbers we expect that the empirical measures k nt of capital and n t of labor k n t 1 n n i 1 kit and n t 1 n n i 1 it converge as n toward a limit which we denote by k zt and z t these limits give the conditional distributions of capital and labor kt and t given the state zt z of the economy since zt can only take two values 1 z and 1 z we only need the knowledge of deterministic flows of measures k dt t 0 k u t t 0 d t t 0 and u t t corresponding to the two values of z say down and up namely d 1 z and u 1 z once the flows of conditional measures are known the computation of the best re sponse of a representative agent reduces to the solution of the optimal control problem max c e 0 e tu ct dt under the constraints kt 0 and dkt r kt lt zt kt 1 t t 1 t w kt lt zt dt ctdt here zt t t 0 is a continuous time markov chain with the same law as any of the zt i t t 0 introduced earlier the rental rate function r and the wage level function w are as in 5 42 and 4 6 and kt k zt t is the mean of the conditional measure zt t namely kt 0 k k u t dk if zt 1 z and kt 0 k k d t dk if zt 1 z and where the aggregate labor lt is defined similarly as the conditional mean of z t the aggregates kt and lt are the conditional means of the capital and labor given the common noise they carry the mean field interactions in the model as we recalled during our discussion of the previous example the mfg paradigm in the presence of a common noise is to solve for each fixed flow of probability measures adapted to the filtration of the common noise the optimization problem of a generic player and then solve the fixed point problem to guarantee that the flow we started from is in fact 20 ren carmona the flow of conditional marginal laws of the solution of the optimization problem note that in the krusell smith s model the common noise and the idiosyncratic noise are correlated and that the labor state variable t whose aggregate is lt is nothing but the idiosyncratic noise so clearly the mfg paradigm reduces to the solution of the individual optimization problem given the aggregate kt and then solving for the fixed point this is exactly what the numerical algorithm proposed in 63 does time discretization is not needed in 63 since the model is introduced in discrete time there then a form of dynamic programming is used to solve the optimization problem given the aggregatekt and then an update ofkt is done by monte carlo simulation before going back to the solution of the optimization problem given the update of kt and so on and so forth while the authors realize that the entire distribution k zt should be updated they argue that updating the mean is sufficient to get reasonable numerical results for a problem whose complexity should have been prohibitive as explained in the introduction even though they never used the term nash equilibrium their numerical search for a recursive competitive equilibrium is exactly the algorithm based on the iteration of the numerical approximation of the solution of the hjb equation followed by the fokker planck kolmogorov equation algorithm re introduced and used over 15 years later for the numerical solution of mean field games 4 3 a diffusion form of aiyagari s growth model as explained in the introduc tion to this section we learned about the model presented in this subsection from a private conversation with benjamin moll it is one of the models discussed in the review 1 by achdou buera lasry lions and moll devoted to partial differential equation models in macroeconomics as far as we know the first and most likely the only complete mathe matical solution as a mean field game of this model can be found in chapter 3 of 21 we first describe the finite player form of the model we shall solve it as a mean field game model later on the n agents i 1 n are the workers comprising the economy the private state at time t of agent i is a two dimensional vector xit z i t a i t for the purpose of this model ait is the wealth at time t of worker i and z i t their labor productivity the time evolutions of the states are given by stochastic differential equations 4 8 dzit z z i t dt z z i t dw i t dait w i tz i t rta i t cit dt the functions z z r r are known we shall specify them later on in the examples we treat theoretically and numerically the random shocks are given by n independent wiener processes wi w it t 0 for i 1 n rt is the interest rate at time t w i t represents the wages of worker i at time t and the consumption process ci cit t 0 is the control of player i remark 4 1 in many economic applications a borrowing limit is imposed math ematically this means that the wealths must satisfy the constraints ait a for some nonpositive constant a 0 moreover the labor productivity processes zi zit t 0 are also restricted by requiring that they are ergodic or even restricted to an interval z z for some finite constants 0 z z we do not know of an economic rationale for these constraints and we suspect that these assumptions are made for the sole benefits of the technical proofs in this model given adapted processes r rt t 0 and wi wit t 0 for i 1 n the workers choose their consumptions c 1 cn in order to maximize their financial engineering economics 21 expected discounted utilities 4 9 j i c 1 cn e 0 e tu cit dt as usual in economic applications the model is set up in infinite horizon and u is an increasing concave utility function the same for all the workers so far it seems like the workers do not interact also we need to explain how the interest rate and the wage processes appear in equilibrium as in the krusell smith model discussed earlier we assume that the aggregate production in the economy is given by a production function y f k l the total capital supplied in the economy at time t say kt being given by the aggregate wealth 4 10 kt a d nxt dz da 1 n n i 1 ait while the total amount of labor lt supplied in the economy at time t is normalized to 1 here we denote by nxt the empirical measure of the sample x 1 t x n t note that only the a marginal enters the definition of kt remark 4 2 as explained in the introduction the fact that the economic agents interact through aggregate quantities is the reason why mean field models and mean field game formulations are so natural for these macro economic models economic theory says that in a competitive equilibrium the interest rate and the wages are given by the partial derivatives of the production function rt kf kt lt lt 1 wt lf kt lt lt 1 where 0 is the rate of capital depreciation so in equilibrium the interaction be tween the agents in the economy is through the mean kt a nx a z of the empirical distribution of the workers wealths ait practical solution we now specify the model further to solve it as a mean field game we use the crra isoelastic utility function with constant relative risk aversion introduced above in 4 7 note that 4 11 u c c and u 1 y y 1 next we use the cobb douglas production function 4 12 f k l ak l 1 for some constants a 0 and 0 1 with this choice in equilibrium rt ak 1 t l 1 t and wt 1 ak t l t and since we normalized the aggregate supply of labor to 1 4 13 rt a k 1 t and wt 1 ak t where kt is given by 4 10 and provides the mean field interaction finally we use an ornstein uhlenbeck process for the mean reverting labor productivity process z zt t 0 by choosing z z 1 z and z 1 for the sake of definiteness moving to 22 ren carmona the mean field game formulation of the model the state xt at zt evolves according to dzt zt 1 dt dwt dat 1 t zt 1 t at ct dt t 0 t where t 0 t t denotes the flow of average wealths in the population in equilibrium it is assumed to take strictly positive values the set a of admissible controls is the set h 2 1 of real valued square integrable f adapted processes c ct 0 t t with non negative values and the cost functional is defined by j c e t 0 u ct dt u at for the crra utility function u given by 4 7 and u a a notice the additional minus signs due to the fact that we want to treat the optimization problem as a minimization problem here we chose to take 0 for the discount rate since we are working on a finite horizon throughout the analysis we shall assume that a 0 0 and z 0 1 so that e zt 1 for any t 0 in order to solve this mfg using the pontryagin maximum principle we introduce the hamiltonian h t z a yz ya c 1 z yz c 1 t z 1 a ya u c where a d z a denotes the mean of the second marginal of the measure the first adjoint equation reads dyz t zh t zt at yz t ya t ct dt z z tdwt yz tdt z z tdwt its solution is yz t 0 because its terminal condition is yz t 0 since the variables z and yz do not play any role in the minimization of the hamiltonian with respect to the control variable c we use the reduced hamiltonian h t a y c c 1 a y u c which is convex in a c and strictly convex in c the form 4 11 of the derivative of the utility function implies that the value of the control minimizing the hamiltonian is c u 1 y y 1 therefore the fbsde derived from the pontryagin stochastic maximum principle reads 4 14 dat 1 t zt 1 t at yt 1 dt dyt yt 1 t dt z tdwt t 0 t yt 1 where we used the notation z t 0 t t to denote the integrand in the quadratic variation part of the backward equation in order to distinguish it from the process zt 0 t t used in the model as the first component of the state despite the fact that the utility function has a singularity at 0 it is not difficult to check that the proof of the sufficient part of the pontryagin principle goes through provided that the adjoint process yt 0 t t lives with probability 1 in a compact subset of 0 we shall refrain from going through the gory details of the rest of the proof we refer the interested reader to 21 section 3 6 3 the major insight is to notice that the backward equation may be decoupled from the forward equation and that its solution is deterministic and is obtained by solving the backward ordinary differential equation dyt yt 1 t dt t 0 t yt 1 the remaining of the proof follows easily financial engineering economics 23 5 from macro to finance in this section we review two recent works of m brunnermeier and y sannikov 14 15 in which the authors compare the historical evolutions of macro economic and finance models arguing that properly framed the analysis of continuous time stochastic models should provide a unifying thread for these sub fields of economics which so far developed in parallel to make their point the authors introduce models of the economy comprising households maximizing consumption like in classical macro economic growth models as well as experts trading in financial markets as explained in the introduction those models lead to mfgs with a common noise the importance of common shocks in macro economics points to the need of a better mathematical understanding of mfgs with a common noise the first model reviewed in this section fits in the class of mfgs with one population of individuals facing idiosyncratic noise terms as well as random shocks common to all it was first introduced in 14 in discrete time while the second model does not have idiosyncratic noise terms it involves two populations of agents this gives us an opportunity to quickly review some of the features of mfgs with several populations which are not discussed often enough in the mathematical literature on mean field games 5 1 economy with one type of agents we consider a one sector economy with a continuum of households with identical preferences we shall use the logarithmic util ity function u x log x and different levels of wealth we denote by i the set of households we choose i 0 1 for the sake of definiteness in this model because each agent s influence on the economy is infinitesimal we use a continuous probability measure on i to sample households for practical purposes we can think of as the lebesgue measure on 0 1 remark 5 1 this suggestion to think of the space of households as the unit interval 0 1 equipped with its lebesgue measure is a flagrant expediency indeed mathematically speaking it does not pass the smell test as in order to manipulate a continuum of idiosyn cratic shocks without having to face severe measurability issues we would have to jump through several hoops for example using rich fubini extensions instead of the lebesgue unit interval see for example 21 section 3 7 for a discussion of such a rigorous ap proach in this model each household operates a firm and holds money the capital stock of a generic household h evolves according to the equation 5 1 dkht kht ht dt 0 dw 0 t dw h t where 0 is a depreciation rate and the function reflects adjustment costs in capital stock this function is assumed to satisfy 0 0 0 1 0 and 0 its concavity captures technological illiquidity ht represents the investment rate of household h in physical capital at time t essentially it gives how many units of physical capital are used in order to produce new physical capital w 0 w 0 t t 0 and w h wht t 0 are independent wiener processes modeling random shocks dw h t represents an idiosyncratic shock specific to the household h while dw 0 t represents a shock common to all the households we shall often call it the common noise the volatilities 0 and are positive constants 24 ren carmona households hold money we denote by mht the amount of money held at time t by household h they consume in the amount cht we denote by h t the fraction of the house hold wealth in money at time t so the control of a household is the triple ht h t c h t the goal of a household is to maximize its long run discounted expected utility of consumption 5 2 jh c e 0 e tu ct dt over the control strategies c t t ct t 0 the constant 0 provides actual ization we now derive the dynamic constraint under which this optimization is performed by each household it is expressed in terms of the wealth nht of the household at time t we use capital letters to denote the aggregates i e the empirical means of each of the variables kht m h t and n h t in other words 5 3 kt ih kht dh mt ih mht dh nt ih nht dh anticipating on the fact that we shall discover that in equilibrium ht t 0 is independent of the household and adapted to the filtration of the common noise which is the case if ht depends only upon aggregate quantities at time t which implies that all the households use the same investment in physical capital strategy we can integrate 5 1 over h and find that 5 4 dkt kt t dt 0 dw 0 t which is a stochastic differential equation only driven by the common noise the idiosyn cratic shocks disappear because of a continuous form of the exact law of large numbers see for example 21 section 3 7 we used the notation t to distinguish this aggregate return on capital from the individual households ht we introduce two more constants q for the price of one unit of physical capital so the real value of aggregate physical capital is qkt and p for the real value of money normalized by the size of the economy as measured by kt so pkt is the real value of total money supply these could be it processes say qt t 0 and pt t 0 driven by the common noise w 0 but for the sake of simplicity we shall assume them to be deterministic constants for the purpose of this presentation given the definition of the constants q and p the total wealth in the economy is 5 5 nt p q kt qkt representing the value of the physical capital and pkt the value of the nominal capital we denote by the fraction of nominal wealth 5 6 p p q the quantity of money in the economy is controlled exogenously by a central bank we assume that money supply follows the following stochastic differential equation 5 7 dmt mt mdt mdw 0 t driven by the common noise financial engineering economics 25 individual household optimization problem we first derive the stochastic differen tial equation driving the dynamics of the wealth of a generic household and then tackle the optimization of the expected utility of consumption by the pontryagin stochastic maximum principle changes in the wealth nht of household h at time t are the sums of three contributions we have 5 8 dnht h t n h t dr m t 1 h t n h t dr h k t h t c h t dt where rmt denotes the rate of return on money and r h k t h t the rate of return on capital if ht n h t is the amount the household holds in money and if we denote by p m t the value of one unit of money namely 5 9 pmt pkt mt then the return on this investment is drmt dpmt pmt d kt mt kt mt since we assume that p is a constant using it s formula with 5 4 and 5 7 we get 5 10 drmt t m m m 0 dt 0 m dw 0 t we now identify the time evolution of the rate of return on capital rh kt h t it has three components the return of investment in physical capital the return on the household cap ital qkht and the seigniorage seigniorage is the amount of money which is transferred to money holders proportionally to their capital given the definition 5 9 of the value of one unit of money we can easily understand the change in the seigniorage over a period t t t it is given by tht t t h t p m t t mt t mt p m t mt t mt p m t t p m t mt t mt so in continuous time i e after taking the limit t 0 dtt p m t dmt d p m m t pkt m 0 m m dt mdw 0 t 5 11 consequently dr h k t h t a ht q dt d qkht qkht dtt qkt a ht q ht p q m 0 m m dt 0 p q m dw 0 t dw h t 5 12 26 ren carmona putting together 5 8 5 10 and 5 12 we get dnht h t n h t dr m t 1 h t n h t dr h k t h t c h t dt ht n h t t m 0 m m dt ht n h t 0 m dw 0 t 1 ht n h t a ht q ht p q m 0 m m dt 1 ht n h t 0 p q m dw 0 t 1 h t n h t dw h t c h t dt nht ht t 1 ht a ht q ht m 0 m m p q ht p q q cht dt nht 0 p q ht p q q m dw 0 t 1 h t n h t dw h t 5 13 the hamiltonian of the optimization problem of a generic household reads h t n y z 0 z c n t 1 a q m 0 m m p q p q q c y n 0 p q p q q m z 0 1 n z e tu c 5 14 if we use the notations y z 0 and z for the adjoint variables sometimes called co states the necessary part of the pontryagin maximum principle suggests to minimize the hamil tonian with respect to the control variables and c moreover since 1 0 we can isolate and minimize a q which gives tobin s q equation 1 q 0 1 1 q and in the case of the function 1 log 1 used in 15 we get 5 15 t q 1 notice that the optimal t is a constant independent of t in general if q is an it process adapted to the filtration of the common noise so is but the fact to remember at this stage is that the optimal t is the same for all the households so from now on t t 1 q 1 expecting that 0 1 minimizing the hamiltonian over could lead to h 0 i e ny a q p q q m 0 m m nz 0 p q q m n z 0 for obvious reasons we write the adjoint variables z and z 0 in the form z y and z 0 y 0 so we can rewrite the first order condition h 0 in equilibrium as 5 16 a q p q q m 0 m m p q q m 0 financial engineering economics 27 this equation does not determine directly the optimal value of t it is sometimes called the pricing equation because it can also be derived from the hjb equation of the optimization problem offering a pricing interpretation finally since we restrict ourselves to y 0 we can write the third first order condition foc as ch 0 y e tu c 0 c u 1 e ty so that in the case of logarithmic utility the optimal consumption rate should be the process c t t 0 given by c ht e t 1 yht where the adjoint process yt t 0 is the first component of the solution of the adjoint equation namely the backward stochastic differential equation bsde equation 5 17 dyht nh t n h t y h t z 0 h t z h t t t c t dt z 0 h t dw 0 t z h t dw h t computing nh from 5 14 and using 5 16 we get nh y m m 0 m 0 m 0 yrht 5 18 if we define the individual household effective interest by 5 19 rht m m 0 m 0 m 0 ht so the adjoint backward stochastic differential equation bsde reads 5 20 dyht yht rht dt 0 hdw 0 t h t dw h t hence the interpretation of rht as an individual household short interest rate and y h t as an individual stochastic discount factor using it s formula with 5 8 and 5 20 and the definition 5 14 of the hamiltonian we get d yht n h t yht n h t cht nht dt 0 p q ht p q q m 0 ht 1 ht h t so if we choose 5 21 0 ht 0 p q ht p q q m and ht 1 t we have that yht n h t e t and consequently 5 22 c ht n h t nb the fact that the optimal rate of consumption is proportional to the wealth is to be expected when using logarithmic utility plugging the expressions 5 21 for 0 ht and h t into the pricing equation 5 16 we find a q p q q m 0 m m p q q m 0 p q ht p q q m 2 1 t from which we derive 5 23 1 ht a q p q q m p q q 2 m 2 2 28 ren carmona using the fraction of nominal wealth defined in 5 6 this gives 5 24 1 ht a q 1 m m 2 2 1 2 1 so not only is the optimal portfolio the same for all the households but we also learn that it is a constant moreover 0 h t 0 m m 1 ht 1 0 m m a q 1 m m 2 2 1 2 and inserting this value of 0 ht into the formula 5 19 we get 5 25 rht m m 0 m 0 m 0 m m a q 1 m m 2 2 1 2 which shows that the individual interest rate is in fact the same constant for all the house holds clearing conditions the goods market clears if total output akt equals the sum of investment tkt and consumption ct so the overall consumption ct cht dh should be equal to a t kt since akt represents the overall production and tkt represents the overall reinvestment in capital if we recall that we are using logarithmic utility we saw that the optimal consumption was proportional to the wealth so ct cht dh nht dh nt p q kt so that the clearing condition amounts to p q a t which gives 5 26 a q 1 the capital market clears if aggregate capital demand equals capital supply kt in other words if 1 t nt q kt and using the fact that nt p q kt we get 5 27 1 t q p q 1 the money market clears by walras law using the clearing condition 5 26 and the optimal value of t 5 15 we get q 1 1 a 1 from which we derive 1 a 1 and p 1 a 1 finally injecting 5 27 and 5 26 into the pricing equation 5 16 we get 1 m m 2 2 financial engineering economics 29 which shows that a stationary meaning the processes pt t 0 and qt t 0 are deterministic and constant given by the real numbers p and q general equilibrium is possible if 5 28 m m 2 0 and m m 2 does all this have anything to do with mean field games since the state variable of an individual household is its wealth nht the typical interaction one should expect if this general equilibrium can be recast as a mean field game should be the aggregate wealth nt so in the presence of the common noise w 0 t one should fix the flow of conditional distri butions of the wealth nht given the filtration of the common noise and search for the best response of this household in other words given the knowledge of nt t 0 which is a stochastic process adapted to the filtration f 0 of w 0 the individual household should find optimal investment rate in physical capital t t 0 optimal investment portfolio t t 0 and optimal consumption rate c t t 0 to maximize its long run discounted expected utility of consumption 5 2 this is exactly what was done in the section dealing with the individ ual household optimization problem the next step of the mfg paradigm is the fixed point step according to which one tries to identify a flow of conditional distributions which ends up being the flow of conditional distributions of the solution of the optimization problem underpinning the search for the best response in typical macro economic general equilibrium problems individual optimizations are performed assuming that the aggregates are known if aggregates can be interpreted as means of some state variables fixing the aggregates amounts to fixing the distributions of these state variables in this example assuming the knowledge of nt t 0 is the same thing as assuming the knowledge of kt t 0 since as we saw nt p q kt which in turn is assuming the knowledge of the process t t 0 representing the aggregate investment rate in physical capital this is the mean field interaction appearing explicitly in the dynamics 5 13 of the state of the individual household since the individual household optimal investment rate in capital is constant as given by tobin s q equation 5 15 a necessary condition for the fixed point step is that t t added to the necessary conditions of optimality which we derived from the pontryagin stochastic maximum principle and the capital market clearing condition this fixed point step leads to the equilibrium solution under the conditions 5 28 because we chose to restrict ourselves to the search for a stationary general equilib rium in which the processes pt t 0 and qt t 0 are deterministic and constant given by the real numbers p and q the deterministic nature of most of the characteristics of the equi libria are rather anti climatic and the reformulation of the solution as the search for nash equilibria in a mean field game is rather contrived we chose to present this model because of the presence of both idiosyncratic and common shocks we refer the interested readert to 14 15 for extensions with deeper financial meaning the next example will be more illustrative of the deep connection with the paradigm of mean field games while it does not involve idiosymcratic shocks it involves two populations and this will give us a chance to highlight the possible benefits of a mean field game reformulation of the model 5 2 economy with two types of agents we present the analysis of the model dis cussed in 15 mutatis mutandis we consider an economy with a continuum of households and experts we denote by ih resp ie the space of households resp experts typi cally we choose ih ie 0 1 which we assume to be equipped with its borel field we shall alo use continuous probability measures h and e on ih and ie respectively 30 ren carmona again for practical purposes and modulo the contents of remark 5 1 at the beginning of the discussion of the previous model we can think of them both as equal to the lebesgue measure on 0 1 in this economy households consume and lend money to experts on the other end experts borrow money from households invest in the production of a single good and con sume the goal of each agent is to maximize their long run expected utility in this model all agents use the logarithmic utility function u c log c so if we denote by cet and cht the consumptions at time t of expert e and household h respectively the optimization problem is sup cit t 0 e 0 e t log cit dt i e h where 0 is a discount factor common to the two classes of agents to be consistent with the computation done throughout this chapter we shall in fact minimize the negative of the above expected utility of consumption individual household optimization problem if we denote by nht the wealth of house hold h at time t we have 5 29 dnht rtn h t dt c h t dt here the process rt t 0 represents the interest rate common to all agents it is one of the stochastic processes to be determined endogenously the hamiltonian of the optimization problem of a generic household reads h t n c rtn c e tu c if we use the notation for the adjoint variable sometimes called the co state which we shall restrict to be negative the necessary part of the pontryagin maximum principle suggests to minimize the hamiltonian with respect to the control variable c this gives the first order condition foc ch 0 e tu c 0 c u 1 e t so that in the case of logarithmic utility the optimal consumption rate is given by c t e t 1 t where the adjoint function t 7 t solves the adjoint equation d t nhdt rt tdt the differentiation product rule gives d tn h t c h t tdt e tdt implying that tnht e t and consequently 5 30 c ht n h t as noted in the previous example the fact that the optimal rate of consumption is propor tional to the wealth and is independent of the interest rate is a well known property of the logarithmic utility function financial engineering economics 31 individual expert optimization problem if at time t we denote by net the wealth of expert e by et the proportion of self worth invested in bonds i e borrowed from the households so et 0 and by et the investment in physical capital we have 5 31 dnet e tn e t rtdt 1 e t n e t dr k t e t c e tdt where rkt e t denotes the return from the investment e t in physical capital the capital stock of a generic expert e evolves according to the equation 5 32 dket ket et dt dw 0 t where 0 is a depreciation rate and the function reflects adjustment costs in capital stock it is assumed to satisfy 0 0 0 1 0 and 0 its concavity captures technological illiquidity the volatility 0 is a positive constant and w 0 w 0 t t 0 is a wiener process modeling random shocks note that this is the same process for all the experts this is an instance of what we call a common noise there is no source of idiosyncratic noise in this model let the price qt at time t of one unit of capital be an it process satisfying 5 33 dqt qt q tdt q t dw 0 t for two processes qt t 0 and q t t 0 adapted to the filtration f 0 of the common noise which will be specified later on the return on capital rkt e t is defined as 5 34 drkt e t a et qt dt d qtk e t qtk e t the first term in the right hand side represents the dividend yield while the second one gives the capital gain using the definitions 5 33 and 5 32 and it s formula for the differential of a product we get 5 35 drkt e t a et qt et q t q t dt q t dw 0 t plugging this formula in the dynamics 5 31 of the wealth of a generic expert we get 5 36 dnet etn e t rt 1 e t n e t a et qt et q t q t cet dt 1 t net q t dw 0 t this equation should be viewed as giving the dynamics of the state variable net as controlled by cet e t e t as before we use pontryagin stochastic maximum principle to solve the optimization of the expected utility of consumption for the sake of simplicity of notation we skip the superscript e throughout the remaining of this subsection no confusion is possible since we are only dealing with the expert optimization problem the hamiltonian of this optimization problem reads h t n c n rt 1 n a qt qt q t c 1 n qt e tu c 5 37 where for reasons which will become clear soon we used the notations which is as sumed to be negative and for the adjoint variables we now have three first order conditions 32 ren carmona since 0 and 1 1 we can isolate the contribution of the control this leads to the maximization of the quantity a qt which leads to 1 qt 0 1 1 qt in the case of the function 1 log 1 used in 15 we get t 1 qt 1 in any case this value is the same for all the experts e and as a control process it is adapted to the filtration of the common noise as before ch 0 e tu c 0 c u 1 e t so that in the case of logarithmic utility the optimal consumption rate is given by c t e t t where the adjoint process t t 0 solves the adjoint equation d t nhdt t tdw 0 t notice that the foc h 0 gives 5 38 rt a qt qt q t t q t and we shall see below that this formula will help us identify the individual expert optimal investment et in terms of the processes rt t 0 qt t 0 q t t 0 q t t 0 computing nh from 5 37 we get nh t n c rt 1 a qt qt q t 1 qt and using 5 38 we get nh t n c rt and the adjoint equation rewrites 5 39 d t t rt dt tdw 0 t which justifies our choice of the form of the second adjoint variable applying it formula to 5 36 and 5 39 we get d tnt tnt ct nt dt t 1 t q t dw 0 t so that choosing 5 40 t 1 t q t we find that as in the case of the computation of the optimal consumption rate of the households tnt e t and consequently 5 41 c et n e t so the fact that the optimal rate of consumption is proportional to the wealth was not affected by the presence of the random shocks it is typical in the case of logarithmic utility plugging our choice 5 40 for t in 5 38 we find 5 42 rt a t qt t q t q t 1 e t q t 2 financial engineering economics 33 from which we can easily extract et as desired clearing constraints and equilibrium the next step in the search for a general equi librium for this macro economic model is to articulate the constraints imposed by the need to have all the markets clear and to show that one can identify processes rt t 0 qt t 0 q t t 0 q t t 0 satisfying these constraints and allowing the simultaneous optimizations of all the agents clearing is best expressed in terms of aggregate quantities for each i h e we denote by cit the aggregate consumption for the agents of type i formally we write cht ih c ht h dh and cet ie c et e de given 5 30 and 5 41 we see that cht n h t and c e t n e t where n h t and n e t are the aggregate worths of the populations of households and experts respectively i e nht ih n ht h dh and net ie n et e de if we denote by kt the aggregate physical capital in the economy at time t i e kt ie ket e de the aggregate wealth in the economy is equal to qtkt clearing of the loan market requires that at each time t the aggregate debt of the experts say det be equal to the aggregate loans of the households so that det ih nht h dh nht so net qtkt d e t qtkt n h t which implies that 5 43 qtkt n h t n e t it will be convenient to use the quantity 5 44 t net nht n e t net qtkt representing the wealth share of the experts notice that all these aggregate quantities are random since they depend upon the common noise w 0 which does not average out in the computation of the aggregates because it is common to all the agents clearing of consumption on the market for goods requires ct a et kt in other words qtkt a et qt kt which implies qt a et qt which in turn implies that the process qt t 0 is in fact a positive constant say q as a consequence q t 0 and q t 0 and if we use the function 1 log 1 proposed in 15 we get 5 45 q 1 a 1 and e a 1 34 ren carmona capital market clearing yields 5 46 1 et qtkt net 1 t knowing that qt has to be a deterministic constant we can use the facts that dnet net dnet net rt 1 et 2 2 cet net dt 1 et dw 0 t 5 47 and dket ket dket ket rt 1 et 2 dt dw 0 t 5 48 to derive from it s formula that d t t d net kt net kt cet net et 2 2 dt et dw 0 t et 2 2 dt et dw 0 t 5 49 which we can rewrite as 5 50 d t 2 1 t 2 t dt 1 t dw 0 t if we use the capital market clearing condition 5 46 interpretation this is a stochastic differential equation on the open interval 0 1 according to feller s theory of one dimensional diffusions the scale function p x and the speed measure m dx are given by p x 1 2 1 1 2 x and m dx 8 2 x 2 1 x 2 dx feller s explosion test can be computed and it says that if started inside the interval 0 1 the diffusion remains inside the interval for ever and in fact limt t 1 almost surely note also that the drift is always positive and very large when t is small so up to the fluctuations due to the random shocks whose sizes 1 t decrease as t get closer to 1 one should expect that t would grow quickly toward 1 and become mostly flat when it gets close to 1 this is illustrated in figure 1 financial engineering economics 35 figure 1 typical sample path of t from an economic point of view this means that the proportion of the wealth held by the experts grows quickly toward a high value close to 100 and eventually converges to this 100 level leaving the households helpless finally revisiting the constraint 5 42 we see that in equilibrium we must have rt a et qt et q t q t 1 e t 2 a et qt et 1 e t 2 a et qt et 2 t 1 log 1 a 1 2 t 5 51 if we use the function 1 log 1 proposed in 15 nb this interest rate is negative for small values of t conclusion given the common random shock process w 0 we solve the stochastic differential equation 5 50 to find a process t t 0 which stays in 0 1 next we define the short interest rate process rt t 0 by 5 51 and with the constant price of capital q given by 5 45 all the agents can maximize their expected long run discounted utility of consumption simultaneously and all the markets clear these are the elements of the desired equilibrium two population infinite horizon mean field game formulation the model de scribed in this section is the epitome of an infinite horizon two population mean field game mfg with a common noise and no idiosyncratic noise we make it explicit di rectly in the limiting mean field limit without motivating it with the description of the finite player analogue because we do not know of examples of this type treated in the existing literature we formulate a rigorous definition in the spirit and with the notations of 21 and 22 and we accommodate the possibility of idiosyncratic random shocks 36 ren carmona the sources of random shocks are three independent rd valued wiener processes w 1 w 1 t t 0 standing for the idiosyncratic noise for the players of the first popu lation w 2 w 2 t t 0 standing for the idiosyncratic noise for the players of the second population and w 0 w 0 t t 0 standing for the noise common to all the players for i 0 1 2 we denote by fi f it t 0 the filtration generated by wi the mfg problem can be formulated as the conjunction of the following two bullet points 1 for any two probability measure 10 and 2 0 on r d and two stochastic flows of random probability measures 1 1 t t 0 and 2 2 t t 0 on r d both adapted to the filtration f 0 of the common noise solve the two optimal control problems sup 1 j 1 1 2 1 and sup 2 j 2 1 2 2 over f 1 progressively measurable rk 1 valued processes 1 1 t t 0 and f 2 progressively measurable rk 2 valued processes 2 2 t t 0 where j 1 1 2 1 e 0 e tf 1 t x 1 t 1 t 2 t 1 t dt j 2 1 2 2 e 0 e tf 2 t x 2 t 1 t 2 t 2 t dt with dx 1 t b 1 t x 1 t 1 t 2 t 1 t dt 1 t x 1 t 1 t 2 t 1 t dw 1 t 1 0 t x 1 t 1 t 2 t 1 t dw 0 t dx 2 t b 2 t x 2 t 1 t 2 t 2 t dt 2 t x 2 t 1 t 2 t 2 t dw 2 t 2 0 t x 2 t 1 t 2 t 2 t dw 0 t for t 0 and l x 10 10 and l x 20 20 2 find f 0 adapted random flows 1 1 t t 0 and 2 2 t t 0 such that con ditioned on the past of the common noise almost surely the marginal distribu tions of the solutions of the above stochastic control problems coincide with the elements of the probability flows we started from in other words t 0 t 1 t l x 1 1 2 t f 0 t 2 t l x 2 1 2 t f 0 t if we denote by x 1 1 2 and x 2 1 2 the solutions of the above optimal control problems in practice specific assumptions are required on the coefficients b 1 1 1 0 b 2 2 2 0 and the running reward functions f 1 and f 2 for the stochastic differential equations deter mining the generic states x 1 t and x 2 t of the two populations to have solutions and the expected costs to make sense moreover much more restrictive assumptions are required for the existence of a couple of measure flows satisfying the fixed point conditions 2 our goal is to explain how the macro economic model presented in the previous sub section is an instance of such a mean field game the individuals in the first population are the households and the individuals of the second population are the experts in the present situation the idiosyncratic noises w 1 and w 2 are not present so we can take 1 2 0 the generic states x 1 t and x 2 t are the wealths nht and net financial engineering economics 37 as a result the interpretation of the fixed point condition in item 2 of the above definition of a solution to the mfg is that in equilibrium the random measures 1 t and 2 t should be the conditional distributions of the states n h t and n e t given the past w 0 s 0 s t of the common noise in fact as we are about to see the forms of the coefficients of the state equations as well as of the reward functions are such that the means first moments of the probability measures 1 t and 2 t are sufficient statistics so instead of working with the full random measures 1 t and 2 t we can restrict ourselves to their means 1 t x 1 t dx and 2 t x 2 t dx which are still functions of the past of the common noise according to item 1 of the above definition of a solution to the mfg for each couple of stochastic flows of random probability measures 1 1 t t 0 and 2 2 t t 0 adapted to the filtration f 0 of the common noise w 0 we need to be able to solve the two optimal control problems before we tackle the fixed point problem stated in item 2 of this definition let me argue that this is exactly what we did in the optimization steps of the construction of a general equilibrium for the macro economic model studied earlier in this section for the following discussion to be more transparent we should think of the means 1 t and 2 t as the stochastic processes nht t 0 and n e t t 0 of the aggregate wealths in the households and experts populations at each time t 0 knowing the averages 1 t and 2 t we can compute t 2 t 1 t 2 t and then the quatity rt from formula 5 51 choosing the control 1 t c h t the drift function b 1 t n h 1 t 2 t 1 t rtn h t cht the volatility 1 0 t nh 1 t 2 t 1 t 0 and the reward function f 1 t n h 1 t 2 t 1 t log c h t for the utility of the household we see that the first optimal control problem in item 1 is exactly what we called the optimization problem of the house holds which we solved using the pontryagin maximum principle notice that in the dynamics of the state namely in the function b 1 the dependence upon the random probability measures 1 t and 2 t appears implicitly through the process rt choosing the control 2 t t t c e t the drift function b 2 t n e 1 t 2 t 2 t trtn e t cet 1 t net a q t the volatility 2 0 t n e 1 t 2 t 2 t 1 t net and the reward function f 2 t n e 1 t 2 t 2 t log c e t we see that the second optimal control problem in item 1 is exactly what we called the optimization problem of the experts which we solved using the pontryagin maximum principle as before the dependence upon the ran dom probability measures 1 t and 2 t appears implicitly through the process rt the fixed point condition in item 2 of the definition of the mfg guarantees that 1 t n h t and 2 t n e t so that the process t t 0 is indeed the wealth share of the experts and the process rt t 0 is indeed the short interest rate process and all the clearing conditions are satisfied 38 ren carmona 5 3 conclusion so the nash equilibrium of the two population mean field game coincides with the general equilibrium constructed in the previous subsections but what have we gained aren t we making matters worse johann wolfgang von goethe once said mathematicians are like frenchmen whatever you say to them they translate into their own language and forthwith it is something en tirely different and i would add that it has to be even worse when the mathematician is french still once the macro economic general equilibrium model is reformulated as a mean field game the technology developed during the last 15 years to analyze these models can be brought to bear to gain insight in these macro economic models among them 1 numerical methods to compute solutions and statics 2 convergence of finite populations models and quan tification of the finite size effects 3 analysis of the uniqueness of the equilibria or lack thereof 4 analysis of the centralized optimization counterpart and comparisons of the global welfares e g computation of the price of anarchy 6 moral hazard contract theory after reviewing some of the major historical developments in contract theory and ex plaining the basics of the models we concentrate on two recent papers using mean field games for the purpose of extending the reach of possible applications of the theory to large populations of agents because this topic was not discussed as a possible application of mean field games in the books 21 22 we spend a significant amount of time review ing the underpinnings of the economic theory as well as some of the recent applications involving mean field models put in layman s terms the purpose of economic contract theory is to address questions of the type a how should a government control a flu outbreak by encouraging citizens to vaccinate b how should taxes be levied to influence people s consumption saving and investment decisions c how should an employer incentivize and compensate their em ployees in order to boost productivity while these are mundane objectives they should shed some initial light on the type of problems contract theory can encompass the eco nomic lingo we shall use and try to elucidate includes terms like agency problem contract theory moral hazard and information asymmetry the agency problem refers to a conflict of interest between two parties when one of them is expected to behave in the other party s best interests the purpose of contract theory is to study how an economic agent can design and structure a contractual agreement to incentivize another agent to behave in his or her best interest this problem is most often set up when the informations available to the two agents are not the same in economics and in finance moral hazard refers to a situation when an agent has an incentive to take excess risk because they do not bear the full consequences of that risk in contract theory and economics information asymmetry deals with the study of decisions in transactions where one party has more or better information than the other the principal agent problem occurs when one agent makes decisions on behalf of another person or entity called the principal financial engineering economics 39 earliest contributions to this important field of economics concentrated on static one period models they are attached to the names of mirrlees 67 and holmstr m 58 59 the first dynamic models were introduced by holmstr m and milgrom 60 61 and it had to wait almost two decades for sannikov s breakthrough 72 73 by focusing on markov diffusion models in continuous time and using the weak formulation of stochastic control problems to capture moral hazard sannilov created a new wave of interest especially among financial mathematicians the book of cvitanic and zhang focusing on the use of backward stochastic differential equations bsdes is a case in point and the more recent work of cvitanic possama and touzi 40 highlighting the real nature of sannikov s trick will be instrumental in the developments we present in this section nb bengt holmstr m and oliver hart were awarded the nobel memorial prize in eco nomic sciences in 2016 for their work on contract theory 6 1 standard data for a contract theory problem in a classical contract theory model two parties are present 1 the principal who devises a contract according to which incentives are given to and or penalties are imposed on 2 the agent who may accept the contract and work for the principal the following are the major assumptions which are usually made implicitly or explicitly in a contract theory model it is assumed that all the agents are rational in the sense that they behave op timally to maximize their own utilities controlling the tradeoff between the re wards penalties they received and the efforts they put in the principal designs the contract after reviewing the terms of the contract the agent may walk away we as sume that the agent has a threshold level e g minimum reward below which they think the contract is not worth the effort we call this threshold the reservation utility of the agent the principal observes the agent actions only partially this is the source of information asymmetry and moral hazard in the problem from a mathematical point of view the fact that the principal de facto does not see all of the agent behavior forces a special formulation of the optimization problem faced by the principal as far as we know sannikov was the first one to realize that this situation was not accommodated properly by the usual mathematical strong formulation of stochastic games and stochastic control he proposed to use the weak formulation of stochastic control also called the martingale approach to stochastic control to set the principal optimization problem we now explain what we mean by weak formulation to accommodate moral hazard 6 2 weak formulation for control two player games we denote by x 0 t the state of the system at time t we shall give detailed explanations of what the state is in each of the applications considered below we assume that the system is controlled by one single controller who takes actions to implement their control the actions of the controller affect the state of the system and the level of the cost reward this describes the set up of a classical control problem games and stochastic games differ in the sense that several controllers can act on the same system i e several controllers players agents take actions in this case each player has a cost reward to worry about and the whole system is affected by the individual actions and their interactions the weak formulation 40 ren carmona of these optimization problems also called the martingale approach is perfectly suited to information asymmetry and moral hazard in this set up the trajectories t x 0 t are not affected by the actions taken by the controllers only the likelihood of the scenarios given by the trajectories can be changed by the controls in other words only the distribution of the process x 0 x 0 t 0 t t is affected by controls in words one can surmise that the choice of a control is equivalent to the choice of a law for the state process still it may not be completely clear why the presence of moral hazard and the lack of symmetry of information suggest the use of the weak formulation given the terms of the contract the agent chooses controls which influence their own reward as well as the rewards of the principal let us denote by t the control effort level of the agent at time t the agent sees the state xt as it is impacted by the control and the agent optimizes their cost reward according to the terms of the contract on the other end through the terms of the contract the principal chooses the remuner ation conditions of the agent but he or she does so without observing directly the effort level t of the agent observing only partially the state xt and seeing the impact of the agent s effort only through the expected returns he or she is getting de facto through the values of expected quantities roughly speaking the principal guesses the expected value of his or her returns through the distribution of the output of the agent this is exactly what the weak formulation ap proach is trying to capture see below for the mathematical details of this approach after this quick and informal review of moral hazard and classical contract theory we now introduce the application we have in mind in this chapter 6 3 contract between one principal and many agents the main features of the new framework can be summarized as follows 1 one principal who devises one single contract according to which incentives are given to and or penalties are imposed on 2 multiple agents who see the same contract and may accept it and work for the principal as before the major assumptions can be captured in a small number of bulllet points the principal designs a contract hoping to maximize their own utility the agents are rational so they will also try to maximize their own utilities the agents have their reservation utilities and so they may decide to walk away the agents are statistically identical in that their contracts are the same they behave selfishly and maximize their utilities we assume that they reach a nash equilibrium the principal designs the contract anticipating that the agents will reach a nash equilibrium in some sense we can say that we are considering the problem of one principal contracting a field of agents as before the principal does not see and cannot control the individual actions taken by the agents the principal only feels the overall expected value of the re ward he or she gets from the actions of the agents this information asymmetry creates the moral hazard which the model captures through the weak formulation of the optimization problem below we give mathematical details when the state space is the euclidean space rd originally treated by elie mastrolia and possama in 45 and the case of finite states treated by carmona and wang in 29 28 financial engineering economics 41 6 4 continuous state case the weak formulation is best set up using the canonical representation of the state process by assuming that is the space of continuous functions from 0 t to e typically e r or e rd wt t for t 0 gives the coordinate process f ft t 0 t is the natural filtration generated by the process w wt t 0 0 is a fixed probability measure on e which serves as the initial distribution of the state i e x 0 0 f ft if we work on a finite time horizon 0 t p is the wiener measure on f f so that w is a wiener process and x 0 t 0 t 0 s x 0 dws for some lipschitz function s x 7 s x which is assumed to be bounded from above and below away from 0 uniformly in s and x in order to be consistent with the existing literature on the subject we allow the coefficients to depend upon the past history of the states we use the notation x and x to denote the whole trajectories of the state note also that 6 1 dx 0 t t x 0 dwt under p irrespective of which control is chosen by the agent next we introduce a the space of admissible control strategies representing the agents effort levels the elements of a are adapted processes t 0 t t which may satisfy further properties to be specified later on next we introduce the drift function b the only part of the dynamics of the state controlled by the agent we assume that the drift t x 7 b t x rd is bounded and progressively measurable for each ad missible control strategy we denote by p the state distribution when the effort level of the agent is it is defined by its density with respect to the measure p given by dp dp e t 0 t x 0 1 b t x 0 t dwt where e m exp mt 12 m m t denotes the doleans exponential of the contin uous square integrable martingale m mt 0 t t girsanov theorem implies that dx 0 t b t x 0 t dt t x 0 dw t under p where w t wt t 0 s x b s x s ds is a brownian motion under the measure p so the same state process x 0 constructed in 6 1 independently of the controls now appears as the state of the process controlled by if one looks at its evolution under the probability measure p more on that remark below we now finalize the weak formulation of the problem by describing the behaviors of the agents in this set up the principal offers a contract r where r rt 0 t t is an adapted process representing the payment stream is a random variable representing a terminal payment the agent decides whether or not to accept the contract and work for the principal and if he or she does accept chooses an effort level t 0 t t to maximize their expected overall reward jr 0 ep ua t 0 ua rt c t x t dt where ua is the agent running utility ua is the agent terminal utility and c t x is the cost for applying the effort level at time t when the history of the state is x 0 t 42 ren carmona given this rational expected behavior of the agent the optimization problem of the principal can be formulated in the following way for each contract r assuming knowledge of the utility and cost functions of the agent and assuming that the agent is rational the principal computes an optimal effort level t 0 t t arg inf a jr 0 which the agent should choose and then search for an optimal contract r r arg inf r ep up xt t 0 rtdt where up is the terminal utility of the principal this is a typical instance of a stackelberg game between the principal going first and the agent what changes with a large number of agents we assume that the agents while competing with each other behave similarly this is the form of symmetry assumption in force in mean field game models and because of their large number their individual influences on the aggregate quantities are negligeable in these conditions the optimization problem of the principal can be formulated as before knowing the utility and cost functions of the agents the principal assumes that for each contract r the agents settle in a mean field nash equilibrium so for each r the principal solves the mfg of the agents computes the effort level t 0 t t of the nash equilibria he or she can compute then search for an optimal contract r r arg inf r ep up xt t 0 rtdt where up is the terminal utility of the principal as before this is a form of stackelberg game between the principal going first and the field of agents going next but now the dynamics of the state and the cost reward functions depend upon the distribution of the state in the sense that b t xt t t and c t xt t t where t is the distribution at time t of the state xt under p details about the formulation of the problem and an example of solvable model es sentially from the linear quadratic family can be found in 45 remark 6 1 one of the major shortcomings of the approach described above is the fact that the agents can only control the drifts of their states this is due to the reliance on girsanov s change of measure allowing the volatility to be controlled requires the repre sentation of the value functions of the optimization problems by so called 2 bsdes instead of regular backward stochastic differential equations bsdes the analysis becomes significantly more technical the interested reader may want to look at the recent work 43 of elie hubert mastrolia and possama for an attempt in this direction financial engineering economics 43 next we consider the same contract theory model when the state space is finite we go over a numerical application in detail to illustrate with a few statics the informational content of the equilibrium when we can actually compute it 6 5 the discrete state case the framework of the above discussion is based on the theory of diffusion processes in continuous time and its application to problems of stochastic control the states are living in euclidean spaces their dynamics are mod eled by stochastic differential equations and sophisticated tools from stochastic analysis starting with girsanov s theory of changes of measure are brought to bear in order to formalize the asymmetry of information and the weak formulation appropriate for the op timization of the principal stochastic dynamical systems taking values with finite state spaces are often used in applications for which numerical implementations are of crucial importance strangely enough what seems like a simplification at first after all finite state spaces should be easier to handle than continuous spaces may not always make the theoretical analysis easier here we review recent works attempting to port the strategy outlined in the previous section to this case in particular we explain how to set up the weak formulation for mean field games with finitely many states and we implement the steps previously outlined in the diffusion case in the framework of finitely valued state processes remark 6 2 mean field games with finitely many states have caught the atten tion of the mfg crowd throughout the past decade all the works dated before 2017 are reviewed thoroughly and commented from an historical perspective in 21 section 7 2 see also 22 section 7 1 9 for a discussion of models with major and minor players the analysis of which bears much resemblence to some of the steps taken to state and solve contract theory problems with a large number of agents for the sake of completeness we mention some of the works on finite state space mean field games which appeared since then and which we know of the probabilistic approach to finite state mean field games is advocated by cecchin and fischer in 33 bayraktar and cohen derived the equivalent of the master equation in 10 and the convergence problem is studied in 42 by doncel gast and gaujal and in 34 by cecchin and pelino finally we note that these models can exhibit all sorts of behavior as shown for example in 35 where cecchin dai pra fischer and pelino identify a two state model without uniqueness the following is a review of results of carmona and wang borrowed from 29 28 the canonical process for the discrete case in this section we assume that the state space is the finite set e e 1 em where for the sake of mathematical convenience we shall assume that the ei s are the unit vectors of the canonical basis of rm the state process x 0 x 0 t 0 t t will be a continuous time markov chain with m states whose sample paths t xt are c dl g i e right continuous with left limits and continuous at t i e xt xt in analogy with the euclidean state space case we introduce the following canonical representation is the space of c dl g functions from 0 t to e continuous at t x 0 t t is the coordinate process f ft t 0 t is the natural filtration generated by x 0 p is a fixed probability on e f ft p is the unique probability on f f for which x 0 is a continuous time markov chain with initial distribution p and transition rates between any two 44 ren carmona different states equal to 1 so if i 6 j and t 0 p xt t ej ft p xt t ej xt and p xt t ej xt ei t o t using the result of 38 37 we see that the process x 0 has the representation x 0 t x 0 0 0 t q 0 x 0 t dt mt where q 0 is the square matrix whose entries are given by q 0 i i m 1 i 1 m q 0 i j 1 if i 6 j and m mt t 0 is a rm valued p martingale we sometime use the symbol to emphasize matrix multiplication the predictable quadratic variation of the martingale m under p is given by the formula 6 2 m m t t 0 tdt where t is given by 6 3 t diag q 0 x 0 t q 0 diag x 0 t diag x 0 t q 0 players controls we assume that all the agents can take actions which are elements of a closed convex subset a of a euclidean space rk for any agent the set a of ad missible control strategies is the set of a valued f predictable process t 0 t t the space of probability measures on the state space being the simplex p e s p rm m i 1 pi 1 pi 0 the controlled state processes will have dynamics determined by q matrices q t p q t i j p 1 i j m where q is a function 0 t 1 m 2 a s p a q t i j p r we shall assume that i q t p is a q matrix ii 0 c 1 q t i j p c 2 iii for all t i j 0 t e 2 a p p s and p a we have q t i j p q t i j p c p p w 1 wherew 1 is the 1 wasserstein distance on p a assumption i is natural given that we start from a canonical process x 0 which is already a continuous time markov chain the strictly positive lower bound of assumption ii may appear to be restrictive at first but if we understand that in fact it is sufficient that it is satisfied for a given power of the matrix this assumption guarantees that all states are attainable through appropriate actions and this is a desirable feature for control problems to be solvable finally assumption iii is to be expected if one thinks of the mathematical analysis needed to study these models now given financial engineering economics 45 t 0 t t a p pt 0 t t a flow of probability measures on e t 0 t t a flow of probability measures on a we define the martingale l p l p t 0 t t by l p t t 0 x s q s s ps s q 0 s dms simple calculations show that l p t x t q t t pt t q 0 t xt which is either 0 when there is no jump at time t or q t i j t pt t 1 if the state jumps from state i to state j at time t in any case l p t 1 also the doleans ex ponential e l p is uniformly integrable so we can apply the extension of girsanov s theorem to processes with jumps and define the probability measure q p by its den sity with respect to p dq p dp e l p t which guarantees that the process m p m p t 0 t t defined as 6 4 m p t mt t 0 q s s ps s q 0 xs ds is a q p martingale and the canonical decomposition of x 0 under q p reads 6 5 x 0 t x 0 0 t 0 q s s ps s x 0 s dt m p t showing that under q p the stochastic intensity rate of x 0 is q t t pt t notice thatx 00 has still distribution p and if t t x 0 t for some measurable function x 0 is a continuous time markov chain with jump rate intensity q t i j t i pt t under the measure q p so as explained earlier in our first mention of the weak formulation the choice of the control of the agents does not affect the trajectories of the state process but it does influence the probability distribution q p in the present case which determines the expected costs and rewards of the principal principal s optimization problem the reward of the principal depends on the distri bution of the agents states and the payments made to the agents we use the notation c 0 0 t s r for the running cost function c 0 s r for the terminal cost function defining the costs of the principal now assuming that all the agents choose t 0 t t as their control strategy that the resulting flow of marginal distribution of the agents states is p p t t 0 t and the contract offered by the principal is r the principal s ex pected total cost is given by j p 0 r e q p t 0 c 0 t p t rt dt c 0 p t 46 ren carmona agents mean field equilibria we assume that for a given contract r proposed by the principal the agents reach a nash equilibrium as defined rigorously in the following statement definition 6 3 the couple p is a nash equilibrium for the contract r p n r in notation if i is the best response to the behavior of the other agents i e it minimizes the cost when the agent is committed to the contract r and the flow of marginal distributions of all the agents is given by the flow p arg inf a eq p t 0 c t xt t p t u rt dt u ii p satisfies the fixed point condition 6 6 t 0 t p t eq p xt notice that this equation is equivalent to p i t q p xt ei for all t 0 t and i 1 m principal s optimal contracting problem as we already explained the principal minimizes his or her total expected cost assuming the agents reach a nash equilibrium so we only consider contracts r that result in at least one nash equilibrium we denote by c the set of all admissible contracts to implement the participation constraint we disregard the equilibria in which the agent s expected total cost is above a given threshold i e take it or leave it behavior of the agents in contract theory if the agents expected total costs exceed a certain threshold they should be able to turn down the contract in summary the optimization problem for the principal reads v inf r c inf p n r jr p eq p t 0 c 0 t p t rt dt c 0 p t solving the individual agent optimization problem for the agent s optimization problem we introduce the hamiltonian h 0 t e rm a s r r defined by h t x z p r c t x p r x q t p q 0 z andhi t z p r h t ei z p r we assume that there exists a unique minimizer i t z p of hi t z p r and that it is uniformly lipschitz in z and we use the notations h i t z p r hi t z i t z p p r and h t x z p r m i 1 h i t z p r 1 x ei for the maximized hamiltonians bsdes driven by markov chains following the strategy at the root of the weak formulation of stochastic control problems we introduce the bsdes 6 7 yt u t t h s xs zs s p s u rt ds t t z sdms financial engineering economics 47 6 8 yt u t t h s xs zs p s u rt ds t t z sdms and we prove the following representation theorems by inspection notice that in the present situation the bsdes are driven by continuous time markov chains lemma 6 4 for each fixed contract r a and measurable mapping p 0 t s i the bsde 6 7 admits a unique solution y z and we have jr p ep y 0 ii the bsde 6 8 admits a unique solution y z and we have inf a jr p ep y 0 in addition the optimal control of the agent is t xt zt p t nash equilibria as solutions of bsdes let y z p q be a solution to the mckean vlasov bsde system yt u t t h s xs zs p s u rs ds t t z sdms 6 9 et 1 t 0 es x s q s s p s q 0 s dms 6 10 t t xt zt p t 6 11 p t eq xt dq dp et 6 12 y is an adapted c dl g process such that ep t 0 y 2 t for all t 0 t z is an adapted square integrable left continuous process a p 0 t s is measurable q is a probability on the following result links the solution of the mckean vlasov bsde 6 9 6 12 to the nash equilibria of the agents theorem 6 5 if the bsde 6 9 6 12 admits a solution y z p q then p is a nash equilibrium conversely if p is a nash equilibrium then the bsde 6 9 6 12 admits a solution y z p q such that dp dt a e and p t p t dt a e principal s optimal contracting problem recall the optimization problem for the principal v inf r c inf p n r jr p eq p t 0 c 0 t p t rt dt c 0 p t unfortunatly this problem is totally intractable so we transform it into a more familiar control problem this is often called the sannikov trick its nature was clearly 48 ren carmona elucidated by cvitanic possama and touzi in 39 we consider the following system of forward mckean vlasov sdes yt y 0 t 0 h s xs zs p s u rs ds t 0 z sdms 6 13 et 1 t 0 es x s q s s p s q 0 s dms 6 14 t t xt zt p t 6 15 p t eq xt dq dp et 6 16 this is the same type of equations as before except that we write the dynamic of y in the forward direction of time that makes the whole difference indeed if we denote its solution by yz br y 0 z z r y 0 z r y 0 p z r y 0 p z r y 0 the expectation under p z r y 0 by e z r y 0 and if we consider the optimal control problem v inf ep y 0 inf z h 2 x r r e z r y 0 t 0 c 0 t p z r y 0 t rt dt c 0 p z r y 0 t u 1 y z r y 0 t then as a direct consequence of the previous theorem we have v v a class of solvable models while informative at the theoretical level still the above results remain of little practical value if they cannot be implemented in the solution of practical problems in this respect it is rewarding to discover that under a reasonable set of assumptions computable solutions can be identified here is an example we fix p s we assume that the space of actions is a bounded interval say a r and that the transition rates are linear in the control in the sense that q t i j p q i j t p i j for i 6 j q t i i p j 6 i q t i j p where i j r for all i 6 j and j 6 i i j 0 for all i q i j 0 t s r are continuous mappings for all i 6 j furthermore we assume that the agent running costs are of the form c t ei p c 1 t ei p i 2 2 where i 0 and the mapping t p c 1 t ei p is continuous for all i 1 m finally we assume that the utility function of continuous reward u is continuous concave and increasing and that the utility of terminal reward is linear say u under these conditions it is possible to show that the minimizer of the hamiltonian is given by t ei z p ei z b 1 i j 6 i i j zj zi for i 1 m where b z min max z under these assumptions one can financial engineering economics 49 reduce the problem to the optimal control of a flow of probability measures and construct an optimal contract see 28 for details we illustrate this result on a concrete example a simple model of epidemic containment i feel compelled to offer a disclaimer before presenting the gory details of the model i propose to use as illustration peiqi wang and i concocted this model over three years ago for the purpose of illustrating the inner workings of the theory and the analytic computations presented in 28 in the spring of 2020 when the paper was accepted for publication in management science the editor in chief asked if we could add a discussion to highlight the relevance of this kind of model to the understanding of the covid 19 pandemic we obliged and while doing so i realized the potential of these new tools to inform policy makers in the control of the spread of epidemics and the localized re opening of an economy after shut down given the dire conditions in which we are finding ourselves at this very moment aurrell dayanikli lauri re and i embarked in a systematic investigation of what extensions of the model could bring to the understanding of the health and economic consequences of regulations this effort resulted in 8 the reader interested in applications of similar equilibrium view to epidemic control can also consult the recent work of elie hubert and turinici 44 below we present the model originally introduced in 28 where plenty numerical illustrations are given illustrating the influence of the various parameters of the model and in particular how the contract proposed by the regulator can influence the propensity of the agents to move from one city to another a regulator tries to control the spread of a virus over a time period 0 t the ju risdiction of the regulator consists of two cities say a and b each individual is ei ther infected i or healthy h lives in city a or b so the state space of the model is e ai ah bi bh and we denote by ai ah bi bh the proportions of individuals in each of these states to describe the time evolution of the state of each individual we introduce the follow ing assumptions 1 the rate of contracting the virus depends on the proportion of infected individuals in the city so the transition rate from state ah to state ai is a ai ai ah transition rate from state bh to state bi is b bi bi bh 2 the rate of recovery is a function of the proportion of healthy individuals in the city so the transition rate from state ai to state ah is a ah ai ah transition rate from state bh to state bi is b bh bi bh 3 each individual can try to move to the other city we denote by i the transition rates between the states ai and bi and by h the transition rates between the states ah and bh 4 status of infection does not change when individual moves between cities the non negative functions a b a and b are increasing differentiable on 0 1 they characterize the quality of health care in the cities a and b so we can change their parameters to make it more or less attractive to individuals to move from one city to the other or to stay put in any case with these simple prescription the q matrix of the system reads ai ah bi bh 50 ren carmona q t a ah ai ah i 0 a ai ai ah 0 h i 0 b bh bi bh 0 h b bi bi bh ai ah bi bh we now introduce the costs first for the agents c 1 t ai c 1 t ah a ai ai ah 6 17 c 1 t bi c 1 t bh b bi bi bh 6 18 ai bi i ah bh h 6 19 where a and b are two increasing functions and next for the regulator namely the principal for whom the running and terminal costs are given in the form c 0 t exp a ai b bi 6 20 c 0 p ai ah 0 a 2 6 21 where 0 a is the population of city a at time 0 choosing the values of the parameters a b and p offer a trade off between the control of the epidemic and population planning to try to minimize the infection rate of both cities in fact a b and p weigh the relative importance the regulator attributes to each of these objectives the analysis of this model reduces to the solution of an explicit forward backward system of ordinary differential equations odes which can easily be solved numerically allow ing for the computation of statics of the model numerical illustrations are provided in 28 6 6 comparison with plain nash equilibria it is natural and enlightening to com pare the equilibrium computed from the solution of the principal agent problem to the nash equilibrium of the mean field game reached by the individuals in the absence of the regu lator in its absence the states of the individuals are still governed by the same transition rates but the individuals rewards or penalties from the authority are not present in the objective functions they optimize in other words they minimize selfishly their expected costs 6 22 eq t 0 c t xt t t dt as part of a regular mean field game and it is plain to compute some of the numerical characteristics of its nash equilibrium note that this formula for the expected costs of the agents does not contain the payment stream r rt 0 t t and the terminal payment which enter the costs to the agents as part of the covenants between them and the principal this comparison it very much in the spirit of the computation of the so called price of anarchy in classical game theory following the analytical approach to finite state mean field games introduced in 51 it is straightforward to derive the system of forward backward odes characterizing the nash equilibrium see the system of odes 12 13 in 51 or 21 section 7 2 in the financial engineering economics 51 particular case of the model discussed in this section the exact form of this system of odes is given in the appendix of 28 references 1 y achdou f buera j m lasry p l lions and b moll partial differential equation models in macroeco nomics philosophical transactions of the royal society 372 2014 2 y achdou p n giraud j m lasry and p l lions a long term mathematical model for mining industries applied mathematics and optimization 74 2016 579 618 3 y achdou j han j m lasry and b moll p l lions income and wealth distribution in macroeconomics a continuous time approach tech report http www nber org papers w 23732 2017 4 r a d r dumitrescu and p tankov a mckean vlasov approach to distributed electricity generation devel opment mathematical methods of operations research 91 2019 269 310 5 the entry and exit game in the electricity markets a mean field game approach tech report arxiv org 2004 14057 2020 6 c alasseur i ben tahar and a matoussi an extended mean field game for storage in smart grids arxiv 1710 08991 2017 7 r almgren and n chriss optimal execution of portfolio transactions journal of risk 3 2001 5 39 8 a aurrell r carmona g dayanikli and m lauri re optimal incentives to mitigate epidemics a stackel berg mean field game approach tech report https arxiv org abs 2011 03105 in preparation 9 o bahn a haurie and r malham limit game models for climate change negotiations advances in dynamic and mean field games j apaloo and b viscolani eds annals of the international society of dynamic games vol 15 birkh user 2017 pp 27 47 10 e bayraktar and a cohen analysis of a finite state many player game using its master equation tech report arxiv arxiv 1707 02648 2017 11 c bertucci optimal stopping in mean field games and obstacle problem approach tech report arxiv 1704 06553 v 2 2017 12 c bertucci l bertucci j m lasry and p l lions mean field game approach to bitcoin mining tech report arxiv 12004 08167 v 1 2020 13 m brunnermeier and l pedersen predatory trading journal of finance 60 2005 1825 1863 14 m brunnermeier and y sannikov on the optimal inflation rate vol 106 2016 pp 484 489 15 macro money and finance a continuous time approach 2017 1497 1546 16 b bueler solving an equilibrium model for trade of co 2 emission permits european journal of operational research 102 1997 no 2 393 403 17 l ciampi c benazzoli and l dipersio mean field games with controlled jump diffusion dynamics exis tence results and an illiquid interbank market model stochastic processes and their applications 30 2020 18 p cardaliaguet and c a lehalle mean field game of controls and an application to trade crowding tech report arxiv 1610 09904 19 b carlin m lobo and s viswanathan episodic liquidity crises cooperative and predatory trading jour nal of finance 65 2007 2235 2274 20 r carmona g dayanikli and m lauri re mean field game models for renewable investment in the elec tricity markets tech report princeton university 2020 21 r carmona and f delarue probabilistic theory of mean field games vol i mean field fbsdes control and games stochastic analysis and applications springer verlag 2017 22 probabilistic theory of mean field games vol ii mean field games with common noise and master equations stochastic analysis and applications springer verlag 2017 23 r carmona f delarue and d lacker mean field games of timing and models for bank runs applied mathematics and optimization 76 2017 217 260 24 r carmona m fehr j hinz and a porchet market design for emissions markets trading schemes siam review 52 2010 403 452 25 r carmona j p fouque m moussavi and l h sun systemic risk and stochastic games with delay tech report 2018 26 r carmona j p fouque and l h sun mean field games and systemic risk a toy model communications in mathematical sciences 13 2015 911 933 27 r carmona and d lacker a probabilistic weak formulation of mean field games and applications annals of applied probability 25 2015 1189 1231 28 r carmona and p wang finite state contract theory with a principal and a field of agents management science 2020 http www nber org papers w 23732 http arxiv org abs 1710 08991 http arxiv org abs 1707 02648 http arxiv org abs 1704 06553 http arxiv org abs 1610 09904 52 ren carmona 29 a probabilistic approach to extended finite state mean field games mathematics of operations research 2020 30 r carmona and k webster the self financing condition in high frequency markets finance stochastics 23 2019 729 759 31 r carmona and j yang predatory trading a game on volatility and liquidity quantitative finance under revision 2011 32 a cartea s jaimungal and j penalva algorithmic and high frequency trading mathematics finance and risk cambridge university press 2015 33 a cecchin and m fischer probabilistic approach to finite state mean field games applied mathematics optimization 2018 34 a cecchin and g pelino convergence fluctuations and large deviations for finite state mean field games via the master equation tech report arxiv 1707 01819 2018 35 a cecchin p dai pra m fischer and g pelino on the convergence problem in mean field games a two state model without uniqueness siam journal on control and optimization 57 2020 2443 2466 36 p chan and r sircar fracking renewables mean field games siam review 59 2017 588 615 37 s cohen and r elliott comparisons for backward stochastic differential equations on markov chains and related no arbitrage conditions the annals of applied probability no 1 267 311 38 solutions of backward stochastic differential equations on markov chains communications in sto chastic analysis 2008 no 2 251 262 39 j cvitanic d possamai and n touzi dynamic programming approach to principal agent problems tech report september 2017 40 j cvitanic d possama and n touzi dynamic programming approach to principal agent problems fi nance and stochastics 22 2018 1 37 41 b djehiche j barreiro gomez and h tembine electricity price dynamics in the smart grid a mean field type game perspective 23 rd international symposium on mathematical theory of networks and systems hong kong university of science and technology 2018 42 j doncel n gast and b gaujal discrete mean field games existence of equilibria and convergence tech report arxiv 1909 01209 2019 43 r elie e hubert t mastrolia and d possama mean field moral hazard for optimal energy demand response management tech report arxiv 1902 10405 2019 44 r elie e hubert and g turinici contact rate epidemic control of covid 19 an equilibrium approach mathematical modelling of natural phenomena 15 2020 45 r elie t mastrolia and d possama a tale of a principal and many many agents mathematics of opera tions research 44 2019 440 467 46 k fong o gossner j h rner and y sannikov coordination under private monitoring from bank runs to the prisoner s dilemma tech report princeton university 2014 47 j p fouque and j langsam eds handbook on systemic risk cambridge university press 2013 48 r dumitrescu g bouveret and p tankov mean field games of optimal stopping a relaxed solution ap proach 2020 49 p n giraud o gu ant j m lasry and p l lions a mean field game model of oil production in presence of alternative energy producers tech report to appear 50 m golosov j hassler p krusell and a tsyvinski optimal taxes on fossil fuel in general equilibrium econometrica 82 2014 41 88 51 d a gomes j mohr and r r souza continuous time finite state mean field games applied mathematics optimization 68 2013 99 143 52 p j graber and a bensoussan existence and uniqueness of solutions for bertrand and cournot mean field games tech report arxiv 1508 05408 v 1 2015 53 o gu ant j m lasry and p l lions mean field games and oil production finance and sustainable devel opment seminar s lectures 2009 54 mean field games and applications paris princeton lectures in mathematical finance iv r car mona et al ed lecture notes in mathematics vol 2003 springer verlag 2010 55 a haurie and l viguier a stochastic dynamic game of carbon emissions trading environmental modeling and assessment 8 2003 no 3 239 248 56 z he and w xiong dynamic debt runs review of financial studies 25 2012 1799 1843 57 j hinz an equilibrium model for electricity auctions appl math warsaw 30 2003 243 249 58 b holmstrom moral hazard and observability the bell journal of economics 10 1979 no 1 74 91 59 moral hazard in teams the bell journal of economics 13 1982 no 2 324 340 http arxiv org abs 1707 01819 financial engineering economics 53 60 b holmstrom and p milgrom aggregation and linearity in the provision of inter temporal incentives econometrica 55 1987 303 328 61 bengt holmstrom and paul milgrom multitask principal agent analyses incentive contracts asset owner ship and job design journal of law economics amp organization 7 1991 24 52 62 j kambhu s weidman and n krishnan eds new directions for understanding systemic risk a report on a conference cosponsored by the federal reserve bank of new york and the national academy of sciences national research council 2007 63 p krusell and jr a smith income and wealth heterogeneity in the macroeconomy journal of political economy 106 1998 867 896 64 a lachapelle j m lasry c a lehalle and p l lions efficiency of the price formation process in presence of high frequency participants a mean field games analysis mathematics and financial economics 10 2016 223 262 65 z li m reppen and r sircar a mean field games model for cryptocurrency mining tech report arxiv 1912 01952 v 1 2019 66 m ludkovski and r sircar game theoretic models for energy production commodities energy and envi ronmental finance springer 2015 67 j mirrlees the optimal structure of incentives and authority within an organization the bell journal of economics 7 1976 no 1 105 131 68 s morris and h s shin unique equilibrium in a model of self fulfilling currency attacks american eco nomic review 1998 587 597 69 s nadtochiy and m shkolnikov mean field systems on networks with singular interaction through hitting times annals of probability 48 2020 520 1556 70 m nutz a mean field game of optimal stopping tech report 2018 71 j c rochet and x vives coordination failures and the lender of last resort journal of the european eco nomic associateion 2 2004 1116 1148 72 yuliy sannikov a continuous time version of the principal agent problem the review of economic studies 75 2008 no 3 957 984 73 contracts the theory of dynamic principal agent relationships and the continuous time approach 10 th world congress of the econometric society 2012 74 a shrivats d firoozi and s jaimungal a mean field game approach to equilibrium pricing optimal gen eration and trading in solar renewable energy certificate srec markets tech report arxiv 2003 04938 2020 department of operations research financial engineering bendheim center for finance program in applied computational mathematics princeton university email address rcarmona princeton edu http arxiv org abs 1912 01952 1 introduction 2 financial engineering applications 3 games models for energy and the environment 4 macro economic growth models 5 from macro to finance 6 moral hazard contract theory references