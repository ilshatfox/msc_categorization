inverse potential problems for divergence of measures with total variation regularization l baratchart c villalobos guillen d p hardin m c northington and e b saff abstract we study inverse problems for the poisson equation with source term the divergence of an r 3 valued measure that is the potential satisfies div and is to be reconstructed knowing a component of the field grad on a set dis joint from the support of such problems arise in several electro magnetic contexts in the quasi static regime for instance when recovering a remanent magnetization from measurements of its magnetic field we develop methods for recovering based on total variation regularization we provide sufficient conditions for the unique recovery of asymptotically when the regularization parameter and the noise tend to zero in a com bined fashion when it is uni directional or when the magnetization has a support which is sparse in the sense that it is purely 1 unrectifiable numerical examples are provided to illustrate the main theoretical results 1 introduction this work is concerned with inverse potential problems with source term in divergence form that is a r 3 valued measure on r 3 has to be recovered knowing one component of the field of the newton potential of its divergence on a piece of surface away from the support such issues typically arise in source identification from field measurements for maxwell s equations in the quasi static regime they occur for instance in electro encephalography eeg magneto encephalography meg geomagnetism and paleomag netism as well as in several non destructive testing problems see e g 3 4 12 36 37 and their bibliographies a model problem of our particular interest is inverse scanning magnetic microscopy as considered for instance in 7 34 5 to recover magnetization dis tributions of thin rock samples but the considerations below are of a more general and abstract nature our main objective is to introduce notions of sparsity that help recovery in this infinite dimensional context when regularization is performed by penalizing the total variation of the measure key words and phrases divergence free distributions solenoidal total variation of measures magneti zation inverse problems purely 1 unrectifiable this research was supported in part by the u s national science foundation under grant dms 1521749 and by the inria grant to the associate team impinge 1 ar x iv 1 80 9 08 33 4 v 1 m at h o c 2 1 s ep 2 01 8 inverse potential problems with total variation regularization 2 1 1 two basic extremal problems for a closed subset s r 3 let m s denote the space of finite signed borel measures on r 3 whose support lies in s in this paper we consider inverse problems associated with the equation 1 div where is an unknown measure in m s 3 to be recovered under suitable conditions on the decay of at infinity there is a unique solution see section 2 such problems arise in magnetostatics our primary motivation where models a magnetization distribution then 2 b 0 grad is the magnetic field b generated by and it follows from 1 that b is divergence free the term h 0 grad is called the magnetic intensity generated by we refer to 1 as a poisson hodge equation since 2 provides a decomposition of into curl free and divergence free terms the mapping b is in general not injective we say that magnetizations m s 3 are s equivalent if b and b agree on r 3 s in which case we write s a magnetization is said to be s silent or silent in r 3 s if it is s equivalent to the zero magnetization i e if b vanishes on r 3 s it is suggestive from 1 see theorem 2 2 below that a divergence free magnetization m s 3 is s silent for the converse direction we introduce the following terminology definition 1 we will call a closed set s r 3 slender with respect to r 3 if its lebesgue measure l 3 s 0 and each connected component c of r 3 s has l 3 c for example a subset of a plane is slender in r 3 while a sphere or a ball is not slender sets form a family of s for which the above mentioned inverse problem makes contact with geometric measure theory since theorem 2 2 shows that if s is a slender set then any s silent magnetization is divergence free smirnov 40 characterizes divergence free magnetizations also known as solenoids in r 3 in terms of magnetizations that are absolutely continuous with respect to 1 dimensional hausdorff measure and we shall make use of this characterization we will assume that scalar data of the form f a v b for some fixed nonzero vector v r 3 is given on a closed subset q r 3 s where a is the forward operator mapping to the restriction on q of v b we will consider the situation where a a m s 3 l 2 q boundedly and b a 0 if and only if is s silent since b is harmonic on r 3 s condition a will hold if q and s are positively sepa rated and if q is compact which is the case in practice then a is a compact operator theorem 2 3 provides sufficient conditions for b to hold condition b means that the observation is faithful i e if the v component of the field on q is zero then the field is indeed zero everywhere off s in this case the null space of a which is a crucial ingredient inverse potential problems with total variation regularization 3 of the inverse problem coincides with s silent magnetizations which depend solely on the geometry of s and can be studied using potential and measure theoretic tools as we shall see a has in general a nontrivial null space and if q is thin enough it has dense range see lemma 3 1 note that a typical magnetic sensor is a coil measuring the component of the field parallel to its axis which is why measurements are assumed to be of the form v b the fact that v is a constant vector means that the orientation of the sensor is kept fixed in some cases e g in magneto encephalography v would depend on the point where a measurement is made we do not consider this more complicated situation as we are particularly motivated by applications to scanning magnetic microscopy smm where measurements of the vertical component of the magnetic field namely b 3 e 3 b ei denotes the i th unit vector of the canonical basis for r 3 for i 1 2 3 are taken on a rectangle q in a plane x 3 h for some h 0 while s is contained in the half space x 3 0 the focus of this paper is on the use of the total variation norm for measures to regularize the ill posed inverse problem of recovering from a let us briefly recall that the total variation measure of m s 3 is the positive borel measure m s such that d u d for some r 3 valued borel measurable function u satisfying u 1 at a e point see 8 the total variation norm of is then defined as 3 tv r 3 if u is constant a e then we call uni directional such magnetizations arise in geological samples whose remanent magnetizations were formed in a uniform external field we investigate two extremal problems for magnetization recovery the first is that of minimizing the total variation over magnetizations s equivalent to a given one to fix notation for m s 3 let 4 m inf tv s extremal problem 1 ep 1 for 0 m s 3 find s 0 such that tv m 0 the second extremal problem involves minimizing the following functional defined for m s 3 f l 2 q and 0 by 5 ff f a 2 l 2 q tv we consider the problem of finding some m s 3 minimizing ff extremal problem 2 ep 2 given f l 2 q find m s 3 such that 6 ff inf m s 3 ff we remark that the total variation norm is convex on m s 3 but not strictly convex and so there may be multiple that solve ep 1 for a given 0 still we show in section 2 that under the assumption that s is slender ep 1 uniquely recovers the magnetization inverse potential problems with total variation regularization 4 in two important cases a the magnetization is supported on a purely 1 unrectifiable set see theorem 2 6 and b the magnetization is piecewise uni directional see theorem 2 11 the notion of purely 1 unrectifiable set is classical from geometric measure theory and means that intersection of the set with any rectifiable arc has 1 dimensional hausdorff measure zero in particular any set with 1 dimensional hausdorff measure zero is purely 1 unrectifiable and so ep 1 recovers a large class of magnetizations with sparse support including for example those with countable or cantor like with hausdorff dimension less than 1 support note that uni directionality involves some sort of sparsity as well this time direction wise in section 2 we also consider the net moment of given by 7 r 3 which is a quantity of physical interest and is useful in our analysis of uni directional magnetizations under the assumption that s is compact or a slender set theorem 2 2 and lemma 2 8 show that s equivalent magnetizations must have the same net moment hence is uniquely defined by the field in this case however remark 2 4 after that proposition shows this needs not hold if s is neither compact nor slender solutions to ep 2 connect to those of ep 1 as follows if f a e with noise e l 2 q any weak accumulation point of the solutions to ep 2 when 0 and e 0 must be a solution of ep 1 this tikhonov like regularization theory is by now essentially understood in a more general context 14 31 13 in section 4 we improve on previous results by showing that this property holds not only for the r 3 valued measures involved but also for their total variation measures and that weak convergence strengthens to narrow convergence see theorem 4 3 hence no mass is lost in the limit this is important for if ep 1 has a unique solution it implies that solutions to ep 2 asymptotically put mass exactly where the true magnetization does a property which is usually not satisfied under weak convergence of measures another feature of solutions to ep 2 which is more specific to the present situation is that they are supported on small sets of codimension at least 1 in s see corollary 4 2 altogether when the true magnetization is sparse in one of the senses mentioned above that is if it can be recovered by ep 1 we obtain in theorem 4 4 and corollary 4 5 asymptotic recovery results which from the strict point of view of inverse problems recap the main contributions of the paper finally let us mention that ep 2 has a unique solution when s is contained in a plane even though ff is not strictly convex if a has a nontrivial null space the usual case considered in this paper a proof would take us too far into the structure of divergence free measures in the plane and is beyond the scope of this paper see 8 whether uniqueness holds more generally is an intriguing open question 1 2 background and related work the class of inverse problems investigated below can be viewed as deconvolution from partial observations note that we work with vector valued measures supported on sets of dimension greater than 1 and the forward operator a whose convolution kernel is weakly singular has a rather large null space which depends inverse potential problems with total variation regularization 5 in a fairly complicated manner on the geometry of the observation set q and of the set s a priori containing the support of the unknown measure the main contribution of the present work is perhaps to connect geometric measure theory with regularization theory for such inverse problems this connection essentially rests on the structure of the null space of the forward operator in fact the conditions on q and s set up in this work for unique recovery of sparse measures to hold are designed so that this null space consists exactly of divergence free measures these conditions generalize those given in 7 for planar distributions to magnetizations supported on more general sets in r 3 this characterization of the null space is central to the present approach and allows us to rely on classical tools from geometric measure theory and on material from 40 to proceed with the proof of our main result about ep 1 namely the minimality of the total variation of a sparse measure in its coset modulo the null space more general situations notably the case where s is a closed surface or where it has positive lebesgue measure in r 3 and thus is not slender are left for future research such situations are relevant in particular to eeg and meg inverse problems as well as to smm on volumic samples whether the property of having purely 1 unrectifiable support qualifies a measure as being sparse is debatable for instance the support could still disconnect the space like the koch curve does in 2 d nevertheless it comprises standard notions of sparsity such as being a finite sum of dirac masses which is why we consider purely 1 unrectifiability of the support as a generalized notion of sparsity in this context moreover if s is slender we shall see that another convenient notion of sparsity is to be a finite sum of measures with disjoint supports each of which assumes constant direction see theorem 2 11 thus sparsity in the present context may also be envisaged direction wise let us now briefly discuss connections to other works dealing with sparse recovery after early studies 22 42 and the seminal work in 16 17 23 24 approximately solving under determined systems of linear equations in rn by minimizing the residuals while penalizing the l 1 norm has proved to be quite successful in identification in fact under appropriate assumptions on the matrix of the system this kind of approximation favors the recovery of sparse solutions i e solutions having a large number of zero components when they exist this has resulted in the theory of compressed sensing which shows by and large that a sparse signal can be recovered from much less linear observations than is a priori needed see for example 28 and the bibliography therein in recent years natural analogs in infinite dimensional settings have been investigated by several authors but then the situation is much less understood a tikhonov like reg ularization theory was developed in 14 31 13 for linear equations whose unknown is a possibly rn valued measure by minimizing the residuals while penalizing the total vari ation as expected from the non reflexive character of spaces of measures consistency estimates generally hold in a rather weak sense such as weak convergence of subse quences to solutions of minimum total variation or convergence in the bregman distance when the so called source condition holds algorithms and proofs typically rely on fenchel duality and reference 13 contains an extension of the soft thresholding algorithm to the case where the unknown gets parametrized as a finite linear combination of dirac masses inverse potential problems with total variation regularization 6 whose location no longer lies on a fixed grid in contrast with the discrete case references 19 18 which deal with inverse source problems for elliptic operators dwell on the same circle of ideas but suggest a different thresholding method connected with a newton step or else a finite element discretization of the equation having a linear combination of dirac masses amongst its solutions these methods yield contructive algorithms to approximate a solution of minimum total variation to the initial equation by a sequence of discrete measures which is always possible in theory since these are weak dense in the space of measures supported on an open subset of rn to obtain an asymptotic recovery result in the weak sense as the regularizing parameter goes to zero it remains to identify condi tions on a measure ensuring that it is the unique element of least total variation in its coset modulo the null space of the forward operator the gist of compressed sensing is that in finite dimension sparsity is such a condition for most operators in infinite dimension when total variation penalization replaces l 1 penalization it is unclear which assumptions imply the desired uniqueness and why they should be connected with sparsity moreover granted the diversity of operators involved in applications it is likely that such assumptions will much depend on the situation under examination still a striking connection with sparsity in the sense of being a sum of dirac masses was recently established for 1 d deconvolution issues where a train of spikes is to be recovered from filtered observation thereof 11 19 21 15 25 more precisely following the work in 15 which identifies a sum of dirac masses as the solution of minimum total variation in the case of an ideal low pass filter it was shown in 25 that a finite train of spikes can be recovered arbitrarily well by total variation regularization when the noise and the regularization parameter are small enough provided that the filter satisfies nondegeneracy conditions and the spikes are sufficiently separated also the algorithm in 13 can be used for that purpose the present work may be viewed as investigating in higher dimension such deconvolution issues the filter being now defined by the biot savart law and corollary 4 5 may be compared to 25 thm 2 1 3 notation we conclude this section with some details of our notation as used above for vectors and vector valued functions and with some preliminaries concerning measures and distributions for a vector x in the euclidean space r 3 we denote the j th component of x by xj and the partial derivative with respect to xj by xj for x y r 3 x y and x x x denote the usual euclidean scalar product and norm respectively we denote the gradient with respect to y by grad y and drop the subscript if the variable with respect to which we differentiate is unambiguous by default we consider vectors x as column vectors e g for x r 3 we write x x 1 x 2 x 3 t where t denotes transpose we use bold symbols to represent vector valued functions and measures and the corresponding nonbold symbols with subscripts to denote the respective components e g 1 2 3 or b b 1 b 2 b 3 we let x stand for the dirac delta measure at a point x r 3 and refer to a magnetization of the form v x for some v r 3 as the point dipole at x with moment v for x r 3 and r 0 we let b x r denote the open ball centered at x with radius r and s x r the boundary sphere given a finite measure m r 3 and a borel set inverse potential problems with total variation regularization 7 e r 3 we denote by be the finite measure obtained by restricting to e i e for every borel set b r 3 be b e b for m s 3 the total variation measure is defined on borel sets b r 3 by 8 b sup p p p p where the supremum is taken over all finite borel partitions p of b since is a radon measure the radon nikodym derivative u d d exists and satisfies u 1 a e with respect to we shall identify m rk k with the linear form on cc rk k the space of rk valued continuous functions on rk with compact support equipped with the sup norm given by 9 f f d f cc rk k the norm of the functional 9 is tv it extends naturally with the same norm to the space c 0 rk k of rk valued continuous functions on rk vanishing at infinity at places we also identify with the restriction of 9 to c c r 3 3 where c c r 3 is the space of c smooth functions with compact support equipped with the usual topology making it an lf space 39 we refer to a continuous linear functional on c c r m n as being a distribution we denote lebesgue measure on r 3 by l 3 and d dimensional hausdorff measure on r 3 by hd we normalize hd for d 1 and 2 so that it coincides with arclength and surface area for smooth curves and surfaces respectively we denote the hausdorff dimension of a set e r 3 by dimh e 2 equivalent magnetizations net moments and total variation in this section we discuss some regularity issues for magnetic fields and potentials and we study the connection between s silent sources and r 3 valued measures which are distributionally divergence free this rests on the notion of a slender set introduced in definition 1 subsequently we solve extremal problem 1 for certain classes of magnetiza tions when s is slender such magnetizations are sparse in the sense that either their support is purely 1 unrectifiable see theorem 2 6 or they assume a single direction on each piece of some finite partition of s see theorem 2 11 we also give conditions on s and q ensuring that the forward operator has kernel the space of s silent magnetizations see lemma 2 3 we first define the magnetic field b and the scalar magnetic potential see 32 generated by a magnetization distribution at points x not in the support of as b x c 1 x y 3 d y 3 x y x y d y x y 5 c grad grad y 1 x y d y 0 grad x x 6 supp 10 inverse potential problems with total variation regularization 8 where c 10 7 hm 1 0 4 c and is given by 11 x 1 4 grad y 1 x y d y 1 4 x y x y 3 d y x 6 supp note that the second equality in 10 follows from the smoothness of the newton kernel 1 x y for x 6 y and the formula grad x grad y 1 x y a a x y 3 3 x y x y a x y 5 for a fixed a r 3 note that and the components of b are harmonic functions on r 3 s we show in proposition 2 1 that can be extended to a locally integrable function on r 3 that satisfies in the sense of distributions the poisson hodge equation 1 furthermore this proposition shows that the magnetic field b extends to a divergence free r 3 valued distribution proposition 2 1 let s be a closed proper subset of r 3 and m s 3 then the integral in the right hand side of 11 converges absolutely for a e x r 3 thereby defining an extension of to all of r 3 denoting this extension by again it holds for each p q with 1 p 3 2 q that lp r 3 lq r 3 and that in the distributional sense div furthermore the distribution 0 grad is divergence free and extends b from a distribution on r 3 s to a distribution on r 3 denoting this extension by b again we have that t f b 0 as for every f c c r 3 3 here t f denotes the translation of the argument of f by remark the decomposition b 0 grad is the helmholtz hodge decompo sition of the r 3 valued measure into the sum of a gradient and a divergence free term although is a distribution of order 0 note that the summands will generally have order 1 hereafter we let and b denote the extensions given in proposition 2 1 proof set k y y 4 y 3 for y r 3 and let c c r 3 be valued in 0 1 identically 1 on b 0 1 and 0 outside of b 0 2 writing f 1 k and f 2 1 k we have that f 1 lp r 3 for 1 p 3 2 and f 2 lq r 3 from 11 we get that k f 1 f 2 off s the product under the convolution integral is here the scalar product for any r 1 jensen s inequality implies that the convolution of a finite signed measure with an lr function is an lr function with norm not exceeding the mass of the measure times the initial norm and fubini s theorem entails that the integrals converge absolutely a e therefore f 1 lp r 3 and f 2 lq r 3 showing that k lp r 3 lq r 3 we next show that 12 k div let n y 1 4 y for y r 3 pick c c r 3 and recall that g n is a smooth function vanishing at infinity such that g 1 cor 4 3 2 4 5 4 now differentiating inverse potential problems with total variation regularization 9 under the integral sign we have that k gradg therefore k k k gradg grad g div g div which proves 12 finally the distribution d 0 grad coincides with b on r 3 s by 10 and it follows from 12 that it satisfies div d 0 div 0 i e d is divergence free renamimg d as b since it extends the latter the finiteness of and the fact that l 1 r 3 3 l 2 r 3 3 show t f b 0 t f divt f 0 as for every f c c r 3 3 2 1 divergence free and silent magnetizations the equation div is sug gestive of the existence of a relationship between s silent and divergence free magnetiza tions as will be seen from the lemma below for any closed set s all divergence free magnetizations supported on s are s silent but the converse is not always true as follows from the next construction example 2 1 let s b 0 1 be the closed unit euclidean ball centered at the origin l 3 bs and m s 3 the r 3 valued measure equal to 4 3 1 e 1 then by the mean value theorem we get that x 1 4 grad y 1 x y d y 1 4 x 1 x 3 x s since 1 4 x 1 x 3 is harmonic on r 3 0 note that 1 4 x 1 x 3 is also the magnetic potential generated by the dipole 0 e 1 therefore and are s equivalent that is is s silent however this magnetization is not divergence free since for every f c c r 3 supported in b 0 1 it holds that f div f div x 1 f 0 an analogous argument shows that for a 3 the area of s 0 1 and h 2 bs 0 1 the r 3 valued measure a 13 e 1 is likewise s equivalent to the following variant of this example is also instructive there is a sequence xn b 0 1 and a sequence cn of real numbers with n cn such that the measure defined by e 1 n cn xn is s equivalent to a 1 3 e 1 which is s equivalent to therefore is an s silent magnetization consisting of countably many point dipoles to see that xn and cn exist recall bonsall s theorem whose proof in the ball is the same as in the disk see 38 thms 5 21 5 22 that whenever xn is a sequence in b 0 1 which is nontangentially dense in s 0 1 each function h l 1 can be written as h n cnpxn where pxn 1 4 1 xn 2 xn 3 is the familiar poisson kernel of the unit ball at xn and cn is a sequence of real numbers with absolutely convergent sum choosing h 1 and observing that for y s y xn y xn 3 y y 3 pxn d inverse potential problems with total variation regularization 10 by the poisson representation of harmonic functions we easily check that e 1 n cn xn is s equivalent to a 13 e 1 as desired example 2 1 shows us that a r 3 valued measure on s which is s silent needs not be divergence free in general it does however when s is slender theorem 2 2 let s r 3 be closed and m s 3 if div 0 then is s silent furthermore if s is a slender set and is s silent then div 0 proof since l 1 r 3 3 l 2 r 3 3 by proposition 2 1 we get from the schwarz inequality 13 e dl 3 c 1 c 2 l 1 2 3 e for some constants c 1 c 2 and each borel set e of finite measure if div 0 then is harmonic on r 3 by the same lemma therefore it is constant by 13 and the mean value theorem see proof of 2 thm 2 1 consequently is s silent for the second statement assume that s is a slender set and that m s 3 is s silent since b grad and is s silent then is constant on each connected component of r 3 s if c is such a component we can apply 13 with e c b 0 n and let n to conclude that the corresponding constant is zero because l 3 c hence must be zero on r 3 s and since l 3 s 0 it follows that is zero as a distribution so that div 0 in typical scanning magnetic microscopy experiments data consists of point wise values of one component of the magnetic field taken on a plane not intersecting s of course finitely many values do not characterize the field but it is natural to ask how one can choose the measurement points to ensure that infinitely many of them would in the limit determine b uniquely we next provide a sufficient condition that such data more generally data measured on an analytic surface which needs not be a plane determines the field in the complement of s the condition dwells on the remark that a nonzero real analytic function on a connected open subset of rk has a zero set of hausdorff dimension at most k 1 it is so because the zero set is locally a countable union of smooth even real analytic embedded submanifolds of strictly positive codimension see 33 thm 5 2 3 this fact sharpens the property that the zero set of a nonzero real analytic function in rk has lebesgue measure zero and will be used at places in the paper using local coordinates it is immediately checked that the previous bound on the hausdorff dimension remains valid when rk is replaced by a smooth real analytic manifold embedded in rm for some m k we also need at this point a version of the jordan brouwer separation theorem for a connected properly embedded i e complete but not necessarily compact surface in r 3 to the effect that the complement of such a surface has two connected components in the smooth case which is our concern here we give in appendix a a short differential topological argument for this result which we assume is known but for which we could not find a published reference inverse potential problems with total variation regularization 11 hereafter we will say that e f r 3 are positively separated from each other if dist e f 0 where dist e f infx e y f x y lemma 2 3 let s r 3 be closed and suppose r 3 s is connected and contains a nonempty open half cylinder of direction v r 3 0 furthermore let a be a smooth complete and connected real analytic surface in r 3 s that is positively separated from s and such that s lies entirely within one of the two connected components of r 3 a let also q r 3 s be such that the closure of q a has hausdorff dimension strictly greater than 1 if m s 3 is such that v b vanishes on q a then is s silent proof suppose m s 3 is such that v b vanishes on q a as v b is harmonic in r 3 s it is real analytic there and since v b vanishes on the closure of q a which has hausdorff dimension 1 it must vanish identically on a observe now that r 3 a has two connected components see theorem a 1 and let u be the one not containing s note using 10 that if m s 3 and x supp then b x 4 c dist x supp 3 tv 14 for r 0 let r bb 0 r and r r then b x b r x b r x and applying 14 to r and r for r large enough using that a is positively separated from s we get that lim supx u x b x for any 0 hence b x 0 as x in u since v b vanishes on the boundary of u we may use the maximum principle to conclude that v b vanishes on u and therefore on r 3 s as the complement of s is connected this implies that the magnetic potential is constant on every line segment parallel to v not intersecting s now r 3 s contains a half cylinder c of direction v and shrinking the latter if necessary we may assume it is positively separated from s from 11 we get x 1 4 dist x supp 2 tv 15 for m s 3 and x supp and we conclude that x goes to zero as x in c hence its value on each half line contained in c is zero so 0 in c consequently it vanishes identically thus also b in the connected open set r 3 s by real analyticity the following example shows that lemma 2 3 needs not hold if s is not contained in a single component of r 3 a or if a fails to be analytic example 2 2 let s be equal to e 3 e 3 e 3 e 3 e 2 v e 3 and a x 3 0 then e 3 b is zero on a but is not s silent also whenever q is a bounded subset of x 3 0 with dimhq 1 there is a closed c smooth surface z containing q such that e 3 and e 3 lie in the same component of r 3 z however z cannot be analytic lemma 2 3 does not hold either if r 3 s is disconnected for instance if s x 3 0 there is a of the form hdl 2 with h h 1 r 2 3 where h 1 r 2 is the real hardy space on r 2 such that b vanishes identically for x 3 0 but not for x 3 0 7 thm 3 2 inverse potential problems with total variation regularization 12 in particular if we let q a x 3 1 we have that b vanishes on q but is not s silent however if r 3 s is not connected but has a connected component v containing a half cylinder then by replacing s with s r 3 v and selecting an appropriate a q and v lemma 2 3 may be applied to the effect that is s silent whenever v b vanishes on q thus if each component vi of r 3 s contains a half cylinder and can be associated with suitable ai qi and vi and if vi b vanishes on qi for all i then is s silent remark if s is as lemma 2 3 and q r 3 is positively separated from s and has closure q of hausdorff dimension 2 then the conclusion of the lemma still holds and the proof is easier in this case indeed it follows directly from the hypothesis on q that v b is identically zero in r 3 s as soon as it vanishes on q and the rest of the proof is as before we shall not investigate this situation which from the point of view of inverse problems corresponds to the case where measurements of the field are taken in a volume rather than on a surface though more information can be gained this way the experimental and computational burden often becomes deterring lemma 2 4 let s s 0 s 1 r 3 for some disjoint closed sets s 0 and s 1 if m s 3 is s silent then for i 0 1 the restriction bsi is si silent proof let b 0 b bs 0 and b 1 b bs 1 note that b 0 and b 1 are harmonic in r 3 s 0 and r 3 s 1 respectively also as is s silent it holds that b 0 x b 1 x for x 6 s hence the function b x b 0 x x r 3 s 0 b 1 x x r 3 s 1 is harmonic on r 3 note that the two definitions agree on r 3 s moreover proposition 2 1 implies that for every f c c r 3 3 16 t f b t f b 0 t f b 1 0 as since b is harmonic the mean value property applied to 16 with f ej where is a non negative radially symmetric smooth function with support b 0 1 implies that b x vanishes as x and therefore is identically 0 by liouville s theorem thus both b 0 and b 1 are zero on r 3 s 0 and r 3 s 1 respectively and hence bs 0 is s 0 silent and bs 1 is s 1 silent 2 2 decomposition of divergence free magnetizations and recovery of magne tizations with sparse support a set e r 2 is said to be 1 rectifiable e g see 35 def 15 3 if there exist lipschitz maps fi r rn i 1 2 such that h 1 e i 1 fi r 0 a set b rn is purely 1 unrectifiable if h 1 e b 0 for every 1 rectifiable set e clearly a set of h 1 measure zero is purely 1 unrectifiable a purely 2 unrectifiable set is defined in the same way only with h 2 instead of h 1 inverse potential problems with total variation regularization 13 we call a lipschitz mapping 0 r 3 a rectifiable curve and let 0 denote its image if is an arclength parametrization of i e if satisfies 17 h 1 0 then we call an oriented rectifiable curve by rademacher s theorem see 26 is differentiable a e on 0 furthermore it follows from 17 that t 1 a e on 0 for a given oriented rectifiable curve we define r m s 3 through the relation 18 r f 0 f t t dt for f c 0 r 3 3 alternatively since r is absolutely continuous with respect to h 1 we may consider the radon nikodym derivative of r with respect to h 1 and we remark that t t for a e t 0 then for a borel set b r 3 we have 19 r b b d h 1 b we remark that if b is purely 1 unrectifiable then r b h 1 b 0 and further more fubini s theorem implies l 3 b 0 let c m s 3 denote the collection of oriented rectifiable curves with topology inher ited from m s 3 suppose div 0 as a distribution smirnov 40 theorem a shows that can be decomposed into elements from c in particular it can be proven that there is a positive measure on c such that 20 b r b d r and 21 b r b d r for any borel set b r 3 from the representation 20 of a divergence free magnetization we immediately obtain the following lemma lemma 2 5 suppose s r 3 is closed and purely 1 unrectifiable if m s 3 is divergence free then 0 theorem 2 6 suppose s r 3 is a closed slender set if m s 3 has support that is purely 1 unrectifiable and m s 3 is s equivalent to then tv tv unless proof since is s silent theorem 2 2 implies div 0 and so can be repre sented in the form 20 where 21 holds since the support of is purely 1 unrectifiable it follows from 21 and the remark after 19 that the measures and are mutually singular thus tv tv tv tv unless example 2 3 recall from example 2 1 that if s b 0 1 the magnetizations modeling a uniformly magnetized ball and which is a point dipole at 0 with the same net moment as are s equivalent moreover it is easy to verify that tv tv since inverse potential problems with total variation regularization 14 the support of is a single point it is purely 1 unrectifiable hence the assumption that s is a slender set cannot be eliminated from theorem 2 6 the previous example entails that total variation minimization is not sufficient alone to distinguish magnetizations with purely 1 unrectifiable support among all equivalent magnetizations supported on s when s is not slender however as the following result shows the recovery problem for general s has at most one solution when restricted to magnetizations whose support is purely 1 unrectifiable and has finite h 2 measure to see this we shall need a consequence of the besicovitch federer projection the orem 35 thm 18 1 namely that the complement of a closed purely 2 unrectifiable set with finite h 2 measure is connected we will also need the fact that a purely 1 unrectifiable set is purely 2 unrectifiable we are confident these facts are known e g see the intro duction in 20 but since we have not explicitly found proofs in the literature we provide outlines of the arguments with regard to the first fact let f r 3 be a closed purely 2 unrectifiable set with finite h 2 measure and suppose b x r b y r are disjoint balls in r 3 f by the besicovitch federer projection theorem there exists a plane p such that the intersection of the or thogonal projections of these balls onto p minus the orthogonal projection of f onto p is nonempty and therefore the balls can be joined by a line segment not intersecting f as to the second fact it follows from 27 lemma 3 2 18 that it is enough for a set f to be purely 2 unrectifiable that h 2 f k 0 for any compact set k r 2 and any bi lipschitz mapping k r 3 since bi lipschitz maps preserve unrectifiability we may restrict our considerations to r 2 where the result follows easily from fubini s theorem as a consequence of these facts the complement of a closed purely 1 unrectifiable set with finite h 2 measure must be connected corollary 2 7 suppose s is a closed proper subset of r 3 and that m s 3 has purely 1 unrectifiable support of finite h 2 measure if m s 3 is s equivalent to but not equal to then the support of is not a purely 1 unrectifiable set with finite h 2 measure proof suppose m s 3 is s equivalent to and has support that is purely 1 unrectifiable with finite h 2 measure then the support s of is also purely 1 unrectifiable with finite h 2 measure therefore its complement is connected and thus s is slender moreover is s silent hence its field vanishes on the nonempty open set r 3 s and since s is closed with l 3 s 0 because it is slender the field must vanish on a nonempty open subset of r 3 s since s has connected complement we conclude that is s silent by real analyticity consequently it is divergence free by theorem 2 2 and hence by lemma 2 5 is the zero measure corollary 2 7 applies in particular if is a finite sum of point dipoles however in view of example 2 1 it does not apply in general to a convergent series of point dipoles 2 3 the net moment of silent magnetizations our next result shows that under certain assumptions on their support silent measures have vanishing moment inverse potential problems with total variation regularization 15 lemma 2 8 let s r 3 be a closed set and m s 3 be s silent assume that one of the following conditions is satisfied a s is compact b div 0 then the net moment 0 proof fix i 1 2 3 let c 0 r 3 be supported in b 0 2 x xi on b 0 1 and for any n 0 let n x n x n note that grad grad n that n is supported in b 0 2 n and for x b 0 n that n x xi grad n x ei and n x 0 if s is compact take n 0 such that s b 0 n then grad n i the i th component of the moment of since is s silent is constant in each connected component of r 3 s and applying 13 with e b 0 r b 0 n we conclude on letting r that 0 in the unbounded component thus is supported on b 0 n and since div by proposition 2 1 we obtain i grad n n div n n 0 therefore taking i 1 2 3 we get that 0 as announced assume next that div 0 for any integer m 0 let dm b 0 2 m 1 b 0 2 m and mm dm because mmm tv we have that 22 grad 2 m dm mm grad 0 as m now let ei be the constant function equal to ei on r 3 by 22 we see that lim m grad 2 m lim m grad 2 m b 0 2 m ei i and since grad n n div 0 for each n 0 by our assumption we conclude that 0 as desired assumptions a or b cannot be dropped in lemma 2 8 for it is not sufficient that a magnetization be s silent for its net moment to vanish as shown by the following example example 2 4 consider the case where s r 3 b 0 r and let vh 2 bs 0 r where v r 3 0 the density of with respect to h 2 bs 0 r is the constant map v s 0 r r 3 given by v x v which is the trace on s 0 r of the gradient of the function x 7 v x which is harmonic on a neighborhood of b 0 r hence v a fortiori belongs to the hardy space h 2 r of harmonic gradients in b 0 r therefore is silent in that ball 6 lemma 4 2 and still 4 v integrating this example over r 1 against the weight 1 r 4 further shows that the r 3 valued measure d x v x 4 x 1 x dl 3 x is silent in the ball b 0 1 but has 4 v this provides us with an example of a non compactly supported measure with non zero total moment which is silent in the complement of its support inverse potential problems with total variation regularization 16 2 4 total variation and unidirectional magnetizations for m s 3 we can write d u d therefore the cauchy schwarz inequality yields that 23 2 u d tv where equality holds if and only if either 0 or u a e with respect to we say that is uni directional if u is constant a e with respect to note that the zero magnetization is uni directional thus 23 implies the following lemma 2 9 if m s 3 then tv with equality if and only if is uni directional we call a magnetization uni dimensional if it is the difference of two uni directional magnetizations the next lemma states that a uni dimensional magnetization which is divergence free must be the zero magnetization lemma 2 10 if m r 3 3 is uni dimensional and div 0 then 0 proof suppose m r 3 3 is uni dimensional and divergence free then v for some v r 3 and m r 3 with 0 div v v grad a standard argument see below shows that is translation invariant with respect to any vector parallel to v and therefore is finite only if it is zero without loss of generality we may assume that v 1 0 0 to see the translation invariance of take any f c c r 3 and let f be a translation of f in the x 1 direction then f f x 1 g with g c c r 3 defined by g x 1 x 2 x 3 x 1 f f y x 2 x 3 dl 1 y and so f f x 1 g g x 1 0 theorem 2 11 let s n i 1 si for some disjoint closed sets s 1 s 2 sn in r 3 and suppose that s is either compact or slender let m s 3 be such that i bsi is uni directional for i 1 2 n if m s 3 is s equivalent to then i bsi and i are si equivalent for i 1 2 n moreover 24 tv tv with equality in 24 if and only if i is uni directional in the same direction as i for i 1 2 n furthermore if s is slender and equality holds in 24 then proof since and are s equivalent their difference is s silent in addition it follows from theorem 2 2 that if s is slender then div 0 by lemma 2 4 the restriction i bsi is si silent and thus i and i are si equivalent since either s is compact or div 0 the same is true of each si i and we can use lemma 2 8 to obtain that i i for i 1 2 n then 25 tv n i 1 i tv n i 1 i n i 1 i n i 1 i tv tv inverse potential problems with total variation regularization 17 where the next to last equality follows from the uni directionality of i by lemma 2 9 equality holds in 25 if and only if each i is uni directional and it must have the direction of i since their moments agree in particular is then unidimensional hence if in addition s is slender so that div 0 we get from lemma 2 10 that equality holds in 24 only when note that if s is not slender and in the previous theorem can be different even when equality holds in 24 indeed for n 1 already example 2 1 yields such a situation 3 magnetization to field operators let s r 3 be closed and q r 3 s be compact for m s 3 and v a unit vector in r 3 the component of the magnetic field b in the direction v at x 6 s is given in view of 10 by 26 bv x v b x 0 4 kv x y d y where 27 kv x v x 3 3 x v x x 5 grad v x x 3 consider a finite positive borel measure with support contained in q and let a m s 3 l 2 q be the operator defined by 28 a x bv x x q since kv is continuous on r 3 0 and q and s are positively separated it follows that bv is continuous on q and consequently a does indeed map m s 3 into l 2 q if l 2 q then using fubini s theorem and 26 we have that 29 a l 2 q 0 4 x kv x y d y d x a where for x s the adjoint operator a is given by 30 a x 0 4 y kv x y d y x s in view of 27 a compact way of re writing 30 is 31 a x 0 grad gradu v x u x 1 4 y x y d y since q and s are positively separated it follows as in the proof of lemma 2 3 that a c 0 s 3 and thus a l 2 q l 2 q c 0 s 3 m s 3 from the point of view of the inverse problem described in section 1 consisting of recovering from measurements of the field of the potential of its divergence in the direction v one should think of s as a set a priori containing the support of the sources to be recovered and of q as the set on which the component of the field in the direction v is measured in the proposition below we single out two additional assumptions on the pair s q namely inverse potential problems with total variation regularization 18 i r 3 q is connected l 3 q 0 and hd s 2 ii r 3 q is connected l 3 q 0 and there is a smooth complete real analytic surface b such that q lies in a single connected component of r 3 b while hd s b 1 proposition 3 1 let s r 3 be closed q r 3 s be compact be a finite positive borel measure with support contained in q and v a unit vector in r 3 a the operator a m s 3 l 2 q defined in 28 is compact b each function in the range of a is the restriction to s of a real analytic r 3 valued function on r 3 q c if either assumption i or ii holds then a is injective hence a has dense range d if q s v satisfy the assumptions of lemma 2 3 and the support of contains q a then every element in the kernel of a is s silent proof let h dist s q 0 outside an open ball of radius h the kernel kv and its first order derivatives are bounded say by some constant c thus if n is a sequence in the unit ball ofm s 3 then bu n and its partial derivatives are bounded by c on q therefore bv n is a uniformly bounded family of equicontinuous functions on the compact set q hence it is relatively compact in the uniform topology by ascoli s theorem a fortiori this family is relatively compact in l 2 q besides since kv is a harmonic vector field in r 3 0 differentiating 30 under the integral sign shows that the components of a are harmonic in r 3 q thus a fortiori real analytic to see that a has dense range if either i or ii is satisfied we prove that a is injective in this case for this assume that a 0 for some l 2 q and let us show that is zero a e assume first that ii holds and consider the r 3 valued function d x 1 4 y x y x y 3 d y x r 3 q arguing as we did to get 12 and observing that l 2 q l 1 q since is finite we find that d extends to a locally integrable function on r 3 with div d d as distribu tions note that grad d v is a harmonic vector field on r 3 q which is equal to a 0 on s hence it vanishes there since s b has hausdorff dimension strictly greater than 1 and b is real analytic it holds that grad d v vanishes on b moreover as kv vanishes at infinity and has compact support grad d v vanishes at infinity as well thus by the maximum principle it must vanish in the component of r 3 b which does not contain q therefore also in r 3 q by real analyticity and since it is connected this means that d v is constant in r 3 q and it is in fact identically zero because it is clear from the compactness of q that d vanishes at infinity now it holds that d grad n d where n y 1 4 y is the newton kernel already used in the proof of proposition 2 1 hence n d must be constant on half lines parallel to v contained in r 3 q and since it vanishes at infinity while q is compact we find that n d is identically zero in r 3 q now being the newton potential of a finite measure n d is a locally integrable function and since l 3 q 0 we just showed that it is zero almost everywhere hence it is the zero distribution and so is its weak laplacian d consequently is zero a e as desired if i holds instead of ii the proof of c is similar but easier because inverse potential problems with total variation regularization 19 we conclude directly that grad d v 0 on r 3 q since it is harmonic there and vanishes on s which has hausdorff dimension strictly greater than 2 finally to prove d observe that if a 0 a e with respect to then by continuity a 0 on the support of and so on q a thus by lemma 2 3 is s silent whenever is in the kernel of a remark note that if q contains a nonempty open ball b then of course l 3 q 6 0 and neither i nor ii is satisfied and if moreover the support of contains b then the image of a is not dense in l 2 q since it consists of functions harmonic in b the density of rana plays no role in the forthcoming results so from the sheer mathe matical point of view we may forget about proposition 3 1 c however it is more often satisfied than not for instance in paleomagnetism q would be a rectangular region in a plane and s a rock sample which is either volumic then i is met or sanded down to a thin slab then ii is met with b a plane in practice if a has dense range then the data can be explained arbitrary well in terms of similarity between the measured and modeled fields at the cost of proposing a model for which is unreasonably large and therefore non physical see theorem 4 3 point b this phenomenon is typical of ill posed problems and a compelling reason why regularization is needeed that is one must trade off be tween the precision of the model against available data and its physical relevance e g the regularization parameter should not be made too small in theorem 4 3 4 regularization by penalizing the total variation in this section we consider the inverse magnetization problem of recovering m s 3 from the knowledge of a where a is the operator defined in 28 we will study the regularization scheme ep 2 based on 6 that penalizes the total variation of the candidate approximant and prove that solutions to ep 2 exist and are necessarily localized in the sense that their support has dimension at most 2 if s has nonempty interior in r 3 and dimension at most 1 if s is contained in some unbounded analytic surface where it has nonempty interior the existence of a solution to ep 2 as well as the optimality condition given in theorem 4 1 fall under the scope of 13 prop 3 6 and could just have been referenced we nevertheless provide a proof partly because it may be interesting in its own right as it is independent from the fenchel duality used in 13 but mainly because we want to discuss non uniqueness in a specific manner we conclude this section with a consistency result showing that solutions to ep 2 approach those of ep 1 in the limit that the regularization parameter and the additive perturbation on the data vanish in a controlled manner our account of this regularization theory is new inasmuch as it includes the asymptotic behavior of total variation measures of the solutions and deals with narrow convergence not just weak hereafter as in section 3 we let s r 3 be closed q r 3 s be compact be a finite positive borel measure supported in q and v a unit vector in r 3 the operator a is then defined by 28 for m s 3 f l 2 q and 0 we recall from 5 the definition of ff 32 ff f a 2 l 2 q tv inverse potential problems with total variation regularization 20 and from 6 that m s 3 denotes a minimizer of ff whose existence is proved in theorem 4 1 below i e 33 ff inf m s 3 ff theorem 4 1 notation and assumptions being as above given f l 2 q there is a solution to 33 a r 3 valued measure m s 3 is such a solution if and only if 34 a f a 2 u a e and a f a 2 everywhere on s moreover m s 3 is another solution if and only if a a 0 b there is a measurable non negative function g and a positive measure s m s singular to and supported on the set x s a f a x 2 such that 35 d gd 2 a f a d s proof fix 0 and let n a minimizing sequence for the right hand side of 33 by construction n tv is bounded hence we can find a subsequence that converges weak to some by the banach alaoglu theorem renumbering if necessary let us denote this subsequence by n again the banach alaoglu theorem also entails that 36 tv lim inf n n tv moreover since a is compact f a n converges to f a in l 2 q hence 37 f a l 2 q lim n f a n l 2 q because n is minimizing it now follows from 36 and 37 that meets 33 and that 36 is both an equality and a true limit let now m s 3 be absolutely continuous with respect to with radon nykodim derivative a l 1 3 that is to say d ad we evaluate ff t for small t on the one hand 38 f a t 2 l 2 q f a 2 l 2 q 2 t f a a t 2 a 2 l 2 q on the other hand since it has unit norm a e the radon nykodim derivative u has a unique norming functional when viewed as an element of l 1 3 given by 7 u d l 1 3 hence the l 1 3 norm is ga teaux differentiable at u 9 part 3 ch 1 prop 2 remark 1 and we get that 39 t tv u t a d tv t a u d t t inverse potential problems with total variation regularization 21 where t 0 when t 0 from 38 and 39 we gather that ff t ff 2 t a f a t a u d o t the left hand side is nonnegative by definition of so the coefficient of t in the right hand side is zero otherwise we could adjust the sign for small t consequently 2 a f a u a d 0 a l 1 which implies the first equation in 34 assume next that the second inequality in 34 is violated 40 a f a x 2 for some x s then x 0 by the first part of 34 just proven and the measure 41 a f a x a f a x x is singular with respect to hence for t 0 42 t tv tv t tv tv t and it follows from 38 41 and 42 that ff t ff 2 t a f a x t o t 2 which is strictly negative for t 0 small enough in view of 40 but this cannot hold since is a minimizer of 32 thereby proving the second inequality in 34 by contradiction conversely assume that 34 holds let m s 3 and write the radon nykodim decomposition of with respect to as d ad d s where a l 1 and s is singular with respect to setting t 1 in 38 we get that 43 f a 2 l 2 q f a 2 l 2 q 2 f a a 2 a f a a d 2 a f a s a u d 2 a f a s a u d s tv in another connection we have that tv u a d s tv 1 2 a u a 2 1 2 d s tv and since u 1 a e with respect to we obtain 44 1 2 a u a 2 1 2 1 a u a e thus if we let e resp e be the subset of supp where u a 1 resp 1 we obtain 45 tv e 1 a u d s tv inverse potential problems with total variation regularization 22 besides it follows from 43 that 46 f a 2 l 2 q f a 2 l 2 q e a u d e d s tv adding up 45 and 46 using that tv e d e d we obtain 47 ff ff 0 thereby showing that indeed meets 33 finally observe that in the previous estimates we neglected the term t 2 a 2 l 2 q in 38 and the term a 2 a u 2 in 44 as well as the term e a u 1 d in 45 and 46 along with the term s tv 2 a f a s in 43 hence equality holds in 47 if and only if they are all zero thus for to be another solution to 33 it is necessary and sufficient that a 0 and a hu with h a real valued function such that h 1 a e with respect to while s is supported on the subset of s where a f a 2 and a f a 2 u s at s a e point thus g s with g 1 h 0 which gives us a and b that any two minimizers of 32 must differ by a member of the kernel of a is but a simple consequence of the strict convexity of the l 2 q norm in particular if the assumptions on q s a and v of lemma 2 3 hold and the support of contains q a then any two minimizers are s equivalent by d of proposition 3 1 the second assertion of theorem 4 1 means that when a holds then tv tv if and only if b holds corollary 4 2 assumptions and notation being as in theorem 4 1 assume in addition that s is contained in the unbounded connected component of r 3 s then the union of the supports of all minimizers of 32 for fixed f and 0 is contained in a finite union of points embedded curves and surfaces each of which is real analytic and bounded if b resp c is an unbounded connected real analytic surface resp curve such that b q does not disconnect b resp c q then the aforementioned union of supports has an intersection with b resp c which is contained in a finite union of points and embedded real analytic curves resp points proof recall from b in proposition 3 1 that a f a is the restriction to s of a r 3 valued real analytic vector field on r 3 q that vanishes at infinity set g a f a 2 which vanishes at infinity and is a real analytic function r 3 q r theorem 4 1 implies that the support of and also of any other minimizer of 32 is included in the zero set of h g 2 4 note that h is independent of the minimizer under consideration since any two have the same image under a by theorem 4 1 now since h is not the zero function on the unbounded component of r 3 q because g vanishes at infinity its zero set is a locally finite union of points and real analytic embedded curves and surfaces see discussion after theorem 2 2 moreover since h tends to 2 4 at infinity the zero set of h intersected with s is contained in a relatively compact open subset of r 3 q therefore inverse potential problems with total variation regularization 23 the support of or any other minimizer is contained in finitely many of these points curves and surfaces the proof of the second assertion is similar reasoning in b q resp c rather than r 3 q remark corollary 4 2 applies for instance in paleomagnetism when trying to recover magnetizations on thin slabs of rock via the regularization scheme 33 a case in which b is a plane note that if we omit the assumption that b resp c is unbounded in corollary 4 2 then we can only conclude that the support of either is contained in finitely many points and arcs resp points or else h 0 on b resp c this remark applies e g in meg inverse problems where b is typically a closed surface even if f rangea say f a 0 for some 0 m s 3 it is clear from 34 that 6 0 when 0 unless 0 0 the purpose of the regularizing term tv in 32 is rather to get a which is not too far from 0 when f gets replaced by fe f e in 33 here e is some error e g due to measurements and fe represents the actual data to clarify the matter whenever f e l 2 q we set fe f e and for 0 we let e be a minimizer of 32 when f gets replaced by fe thus with the notation of 33 we have that 0 typical results to warrant a regularization approach based on approximating 0 by e are of consistency type namely they assert that e yields information on 0 as e l 2 q and go to 0 in a combined fashion see for example 14 thms 2 5 or 31 thm 3 5 4 4 we give below a theorem of this type which goes beyond 31 thm 3 5 in that we deal not just with weak convergence of subsequences n en but more generally with narrow convergence of both n en and n en we will not consider quantitative convergence properties involving the bregman distance that require an additional source condition which needs not be satisfied here in general as an extra piece of notation we define for 0 m s 3 48 m 0 min tv a a 0 the infimum in the right hand side of 48 is indeed attained by the banach alaoglu theorem and since the kernel of a is weak closed when s and q satisfy the conditions of lemma 2 3 then this kernel consists of s silent magnetizations and m 0 is just m 0 defined in 4 but when these conditions are not satisfied for instance if s is smooth compact surface then the two quantities may not coincide recall that a sequence n m s 3 converges in the narrow sense to m s 3 if d n d as n whenever s r 3 is continuous and bounded when s is compact this is equivalent to weak convergence but if s is unbounded it means that n does not loose mass at infinity theorem 4 3 assumptions and notation being as in theorem 4 1 given f l 2 q the following hold a if f a 0 with 0 m s 3 while e l 2 q and 0 then 49 e tv e 2 l 2 q m 0 inverse potential problems with total variation regularization 24 and 50 lim 0 e l 2 q 0 e tv m 0 as 0 and e l 2 q 0 any weak cluster point of e there must be at least one since e tv is bounded meets a a 0 f and satisfies 51 tv m 0 moreover if n 0 and en l 2 q n 0 with n en such that n en converges weak to we have that 52 lim n 2 a fen a n en n u d 0 also n en and n en converge respectively to and in the narrow sense b if f 6 rangea and either assumption i or ii in section 3 holds then e tv as 0 and e 0 c if 2 supx s a f x then the unique minimizer of the right hand side of 4 is the zero magnetization proof if f rangea or if rangea is dense in l 2 q it is clear that ffe e 0 as 0 and e 0 hence f a e l 2 q 0 in this case in particular if f 6 rangea but either assumption i or ii in section 3 holds then rangea is dense by proposition 3 1 c and so e tv otherwise a subsequence would converge weak to some 0 m s 3 implying in the limit that f a 0 a contradiction which proves b next let 0 be a minimizer of the right hand side of 4 so that a 0 f and 0 tv m 0 by the optimality of e we have that 53 fe a e 2 l 2 q e tv ffe e ffe 0 e 2 l 2 q 0 tv e 2 l 2 q m 0 implying that 49 holds thus if is a weak cluster point of e as 0 with e l 2 q o and if n en are sequences with these limiting properties such that n en converges weak to we deduce from the banach alaoglu theorem that 54 tv lim inf n e tv lim sup n e tv m 0 also since a is weak to weak continuous it is even compact we get that 55 f a l 2 q lim n f a e l 2 q 0 where the last equality was obtained in the proof of b from 55 it follows that a f and from 54 we now see that 51 holds by definition of m 0 moreover since a weak convergent subsequence can be extracted from any subsequence of e we deduce inverse potential problems with total variation regularization 25 from what precedes that 50 takes place next if n en are as before we get in view of 50 and 53 that fen a n en 2 l 2 q o n which is equivalent to 0 lim n 2 n fen a n en f a n en 2 n fen a n en en and since en l 2 q o n while f a we obtain 56 0 limn 2 a fen a n en n n en limn 2 a fen a n en n n en limn 2 a fen a n en n limn n en tv 2 a fen a n en n d tv limn 2 a fen a n en n u d where we used the first relation in 34 to get the third equality and 50 51 to get the last one by the second relation in 34 we know that 2 a fen a n n 1 everywhere on s hence 56 implies that for any 0 lim sup n x s 2 a fen a n en n u 1 0 therefore using the borel cantelli lemma and a diagonal argument we may extract a subsequence kn for which 2 a fekn a kn ekn kn converges pointwise a e to u so by dominated convergence it follows that lim n 2 a fekn a kn ekn kn u d 0 and since the reasoning can be applied to any subsequence of n we obtain 52 we now prove that n en converges weak to for this it is enough to show that if n en converges weak to 0 m s then for this let s 0 1 be a continuous function with compact support pick 0 and then n such that the integral in the left hand side of 52 is less than for n n as 2 a fen a n en n 1 everywhere on s by 34 we obtain from the definition of n and 51 that d limn d n en limn 2 a fen a n en n d n en 2 a fen a n en n d d 2 a fen a n en n u d d where we used in the equality above that a fen a n en is continuous on s by proposition 3 1 b since 0 was arbitrary we conclude that 0 however since tv m 0 by 51 whereas tv m 0 by the banach alaoglu theorem we conclude that is the zero measure as desired to establish that n en converges to in the narrow sense pick 0 and n as before fix r so large that s b 0 r tv and for each r let r s 0 1 be inverse potential problems with total variation regularization 26 continuous identically 1 on s b 0 r and 0 on s b 0 2 r reasoning as before we get that tv lim supn n en s b 0 2 r lim supn r d n en limn r 2 a fen a n en n d n en r 2 a fen a n en n d r u d r 2 a fen a n en n u d r d 2 a fen a n en n u d s b 0 r tv 2 hence in view of 50 and 51 we see from what precedes that for n large enough n en s b 0 2 r 3 say therefore if we fix a bounded and continuous s r 3 with m we have since n en converges weak to that lim supn d n en lim supn 2 r d n en lim supn 1 2 r d n en 0 6 m because 0 was arbitrary we deduce that n en converges to in the narrow sense and the fact that n en converges to in the narrow sense as well can be shown in a similar way this proves a finally suppose 2 supx s a f x theorem 4 1 shows that the zero magneti zation is a minimizer of ff and that any other minimizer must be silent but then ff f tv showing that in fact the zero magnetization is the unique mini mizer of ff assertion a of theorem 4 3 entails that any sequence n en with n o 1 and en l 2 q o n has a subsequence converging in the narrow sense to some such that a a 0 f and tv m 0 if such a is unique we get narrow convergence of e to as soon as 0 and e l 2 q 0 using theorems 2 6 and 2 11 we thus obtain a recovery result for sparse magnetizations as follows theorem 4 4 let s q r 3 satisfy the assumptions of lemma 2 3 with q compact and assume in addition that s is a slender set with s n i 1 si for some finite collection of disjoint closed sets s 1 s 2 sn suppose 0 m s 3 and set f a 0 if either a 0 bsi is uni directional for i 1 2 n b or supp 0 is purely 1 unrectifiable then e converges narrowly to 0 and e converges narrowly to 0 as 0 and e l 2 q 0 remark in the setting of theorem 4 3 a it is generally not true that n en tv 0 for instance let s r 2 0 be compact assume that q r 2 h for some h 0 let be 2 dimensional hausdorff measure and 0 sv where v r 3 then 0 is unidirectional and we know from theorem 4 4 that e converges narrowly to 0 as 0 and e l 2 q 0 still the support of e has hausdorff dimension at most inverse potential problems with total variation regularization 27 1 by corollary 4 2 therefore e and 0 are mutually singular hence e 0 tv e tv 0 tv cannot go to zero when goes to zero as a particular case of theorem 4 4 taking into account corollary 4 2 we obtain corollary 4 5 let s q r 3 satisfy the assumptions of lemma 2 3 with q compact and s slender supppose that 0 m s 3 is a finite sum of point dipoles 0 nj 1 vj x j for some vj r 3 0 and x j s and set f a 0 then to each r 0 there is 0 such that whenever 0 and e l 2 q a e b x j r vj for 1 j n b e s nj 1 b x j r c e b x j r vj for 1 j n d supp e is contained in a finite collection of analytic surfaces curves and points remark if s is contained in some unbounded real analytic surface or curve e g a plane or a line which is disjoint from q point d of corollary 4 5 involves only curves and points in case of a surface and only points in case of a curve this follows from corollary 4 2 figure 1 the fields b 3 for left a sparse magnetization consisting of 20 dipoles see figure 2 for and reconstructions and right a piecewise unidirectional magnetization with s consisting of four connected compo nents see figure 3 5 numerical examples in this section we present two examples of numerical reconstructions illustrating theo rem 4 4 in both cases we are considering continuous problems with v e 3 the measured field is b 3 0 e 0 no noise and s and q compact subsets of the z 0 and z h planes respectively we discretize the continuous problems by restricting to magnetiza tions s consisting of a finite number of dipoles located on a rectangular grid in the inverse potential problems with total variation regularization 28 figure 2 example for a sparse magnetization each figure shows for its respective magnetization the magnitude and direction of its dipoles by representing different vectors with diferent colors the closer a dipole is to zero the closer its assigned color is to grey the relative distances in total variation to 0 are 1 294 0 207 and 0 004 respectively confirming convergence as expected convolution with a 3 by 3 cross matrix was used to increase visibility z 0 plane intersected with s and samples b 3 evaluated at points in a rectangular grid in the parallel z h plane intersected with a rectangle q numerical solutions to the discretized problems are then obtained using the fast iterative shrinkage thresholding algorithm fista from 10 together with the in crowd algorithm from 29 we will consider in more detail in forthcoming work the relations between the solutions of such inverse potential problems with total variation regularization 29 discretized problems and the associated continuous problems of the type addressed in this paper and we will also address the algorithmic and computational details for obtaining solutions to these discrete problems the examples provided here are only intended for illustrative purposes the continuous problem for the first example is designed to illustrate the recovery of magnetizations with sparse support as in part b of theorem 4 4 in this example s and figure 3 example for a piece wise unidirectional magnetization the figures are made similarly to the ones of figure 2 with black representing the complement of s here the relative distances are 1 167 0 247 and 0 015 inverse potential problems with total variation regularization 30 q are squares in the planes z 0 and z h 1 respectively and 0 consists of 20 dipoles in s with moments of differing directions the source and measurement grids both have 0187 0187 spacing the source grid consists of 108 108 points and the moments of each dipole are allowed to take on any values in r 3 the measurement grid consists of 215 215 points reconstructions are computed for three values of 10 6 10 9 and 10 12 in the second case s consists of the union of four disjoint compact regions as shown in figure 3 the restriction of the magnetization 0 to each component is unidirectional as in part a of theorem 4 4 the source grid now consists of the grid points that are contained in the set s and again the moments of these dipoles are unconstrained i e there is no uni directionality assumption when solving for a reconstruction the are taken among all magnetizations supported in those regions for equal to 10 6 10 10 and 10 14 references 1 d h armitage and s j gardiner classical potential theory springer monographs in mathematics springer 2001 2 s axler p bourdon and w ramey harmonic function theory springer 2000 3 s baillet j c mosher and r m leahy electromagnetic brain mapping ieee signal processing magazine november 2001 4 h t banks and f kojima identification of material damage in two dimensional domains using the squid based nondestructive evaluation system inverse problems 18 1831 1855 2002 5 l baratchart s chevillard and j leblond silent and equivalent magnetic distributions on thin plates in harmonic analysis function theory operator theory and their applications volume 18 of theta series in advanced mathematics 2017 6 l baratchart and c gerhards on the recovery of core and crustal components of geomagnetic po tential fields siam j appl math 77 5 1756 1780 2017 7 l baratchart d hardin e lima e saff and b weiss characterizing kernels of operators related to thin plate magnetizations via generalizations of hodge decompositions inverse problems 29 1 015004 2013 8 l baratchart d hardin and c villalobos guillen divergence free measures in the plane and inverse magnetization problems in preparation 9 b beauzamy introduction to banach spaces and their geometry volume 68 of north holland mathe matics studies north holland publishing co amsterdam second edition 1985 notas de matema tica mathematical notes 86 10 a beck and m teboulle a fast iterative shrinkage thresholding algorithm for linear inverse problems siam j img sci 2 1 183 202 mar 2009 11 b bhaskar and b recht atomic norm denoising with applications to line spectral estimation in 49 th annual allerton conference on communication control and computing page 261268 2011 12 r j blakely potential theory in gravity and magnetic applications cambridge university press 1995 13 k bredies and h k pikkarainen inverse problems in spaces of measures esaim cocv 19 190 218 2013 14 m burger and s osher convergence rates of convex variational regularization inverse problems 20 1411 1421 2004 15 e j cande s and c fernandez granda towards a mathematical theory of super resolution commu nications on pure and applied mathematics 67 6 906956 2014 16 e j cande s j romberg and t tao robust uncertainty principles exact signal reconstruction from highly incomplete frequency information ieee trans inform theory 52 2 489 509 2006 inverse potential problems with total variation regularization 31 17 e j cande s j romberg and t tao stable signal recovery from incomplete and inaccurate mea surements comm pure appl maths 59 8 1207 1223 2006 18 e casas c clason and k kunisch approximation of elliptic control problems in measure spaces with sparse solutions siam jour on control optimization 50 4 1735 1752 2012 19 c clason and k klunisch a duality based approach to elliptic control problems in non reflexive banach spaces esaim cocv 17 243 266 2011 20 g david and s semmes uniform rectifiability and singular sets ann inst h poincare anal non line aire 13 4 383 443 1996 21 y de castro and f gamboa exact reconstruction using beurling minimal extrapolation journal of mathematical analysis and applications 395 1 336 354 2012 22 d donoho and b logan signal recovery and the large sieve siam j appl maths 52 2 577 591 1992 23 d l donoho compressed sensing ieee trans inform theory 52 4 1289 1306 2006 24 d l donoho for most large underdetermined systems of linear equations the minimal l 1 solution is also the sparsest solution comm pure appl maths 59 6 797 829 2006 25 v duval and g peyre exact support recovery for sparse spikes deconvolution focm 15 5 1315 1355 2015 26 l c evans and r f gariepy measure theory and fine properties of functions studies in advanced mathematics crc press boca raton fl 1992 27 h federer geometric measure theory die grundlehren der mathematischen wissenschaften band 153 springer verlag new york inc new york 1969 28 s foucart and h rauhut a mathematical introduction to compressive sensing birkha user 2013 29 p r gill a wang and a molnar the in crowd algorithm for fast basis pursuit denoising trans sig proc 59 10 4595 4605 oct 2011 30 v guillemin and a pollack differential topology prentice hall 1974 31 b hoffmann b kaltenbacher c po schl and o scherzer a convergence rates result for tikhonov regularization in banach spaces with non smooth operators inverse problems 23 987 1010 2007 32 j d jackson classical electrodynamics john wiley sons inc new york london sydney second edition 1975 33 s g krantz and h r parks a primer of real analytic functions birkha user advanced texts basler lehrbu cher birkha user advanced texts basel textbooks birkha user boston inc boston ma second edition 2002 34 e a lima b p weiss l baratchart d p hardin and e b saff fast inversion of magnetic field maps of unidirectional planar geological magnetization journal of geophysical research solid earth 118 6 2723 2752 2013 35 p mattila geometry of sets and measures in euclidean spaces volume 44 of cambridge studies in advanced mathematics cambridge university press cambridge 1995 fractals and rectifiability 36 r l parker geophysical inverse theory princeton university press 1994 37 r p r kress l ku hn reconstruction of a current distribution from its magnetic field inverse problems 18 1127 1146 2002 38 w rudin functional analysis mc graw hill 1991 39 l schwartz the orie des distributions tome i actualite s sci ind no 1091 publ inst math univ strasbourg 9 hermann cie paris 1950 40 s k smirnov decomposition of solenoidal vector charges into elementary solenoids and the structure of normal one dimensional flows st petersburg math j 5 841 867 1994 41 e spanier algebraic topology mc graw hill 1966 42 r tibshirani regression shrinkage and selection via the lasso j roy stat soc b 58 1 267 288 1996 inverse potential problems with total variation regularization 32 appendix a jordan brouwer separation theorem in the non compact case in this section we record a proof of the jordan brouwer separation theorem for smooth and connected complete but not necessarily compact surfaces in r 3 the argument applies in any dimension we are confident the result is known but we could not find a published reference more general proofs valid for non smooth manifolds as well could be given using deeper facts from algebraic toplogy for instance one based on alexander lefschetz duality can be modelled after theorem 14 13 in www seas upenn edu jean sheaves cohomology pdf which deals with compact topological manifolds more precisely using alexander spanier cohomology with compact support and appealing to 41 ch 6 sec 6 cor 12 and sec 9 thm 10 one can generalize the proof just mentioned to handle the case of non compact manifolds herafter we merely deal with smooth surfaces and rely on basic notions from differential topology namely intersection theory modulo 2 recall that a smooth manifold x of dimension k embedded in rn is a subset of the latter each point of which has a neighborhood v such that v x u where u is an open subset of rk and u rn a c smooth injective map with injective derivative at every point the map is called a parametrization of v with domain u and the image of its derivative d u at u is the tangent space to x at u hereafter denoted by t u x then by the constant rank theorem there is an open set w rn with w x v and a c smooth map w u such that id the identity map of u the restriction v is called a chart with domain v this allows one to carry over to x local tools from differential calculus see 30 ch 1 we say that x is closed if it is a closed subset of rn if x y are smooth manifolds embedded in rm and rn respectively and if z y is a smooth embedded submanifold a smooth map f x y is said to be transversal to z if imdf x tf x z tf x y at every x x such that f x z if f is transversal to z then f 1 z is an embedded submanifold of x whose codimension is the same as the codimension of z in y in particular if x is compact and dimx dimz dimy then f 1 z consists of finitely many points the residue class modulo 2 of the cardinality of such points is the intersection number of f with z modulo 2 denoted by i 2 f z if in addition z is closed in y then i 2 f z is invariant under small homotopic deformations of f and this allows one to define i 2 f z even when f is not transversal to z because a suitable but arbitrary small homotopic deformation of f will guarantee transversality see 30 ch 2 theorem a 1 if a is a c smooth complete and connected surface embedded in r 3 then r 3 a has two connected components proof let w be a tubular neighborhoud of a in r 3 30 ch 2 sec 3 ex 3 16 that is w is an open neighborhood of a in r 3 comprised of points y having a unique closest point from x say x such that y x x where is a suitable smooth and strictly positive function on a thus we can write w x tn x x a t x where n x is a normal vector to a at x of unit length note that for each x a there are two possible opposite choices of n x but the definition of w makes it irrelevant which one we make moreover if we fix n x and 0 1 we can find a neighborhood v of inverse potential problems with total variation regularization 33 x in a such that to each y v there is a unique choice of n y with n y n x indeed if u v is a parametrization with inverse such that x v and if we set ny x 1 y x 2 y x 1 y x 2 y where x 1 x 2 are euclidean coordinates on u r 2 while xj denotes the partial derivative with respect to xj and the wedge indicates the vector product then the two possible choices for n y when y v are ny thus if we select for instance n x nx and subsequently set n y ny we get upon shrinking v if necessary that n x n y and n x n y 2 for y v as a consequence if a b a is a continuous path and if nb is a unit normal vector to a at b there is a continuous choice of n for a b such that n b nb fix x 0 a and let n 0 be an arbitrary choice for n x 0 pick t 0 with 0 t 0 x 0 and define two points in w by x 0 x 0 t 0 n 0 we claim that each y r 3 a can be joined either to x 0 or to x 0 by a continuous arc contained in r 3 a indeed let 0 1 r 3 be a continuous path with 0 y and 1 x 0 let 0 0 1 be smallest such that 0 a such a 0 exists since a is closed pick 0 1 0 close enough to 0 that 1 w say 1 x 1 t 1 n 1 where x 1 a t 1 x 1 and n 1 is a unit vector normal to a at x 1 since a is connected there is a continuous path 1 1 a such that 1 x 1 and 1 x 0 along the path there is a continuous choice of n such that n x 0 n 0 this follows from a previous remark changing the sign of t 1 if necessary we may assume that n 1 n x 1 let 1 1 r be a continuous function such that 0 with 1 t 1 and 1 sgn t 1 t 0 such an exists since is continuous and strictly positive while t 1 x 1 and t 0 x 0 now the concatenation of restricted to 0 1 and 1 1 1 r 3 given by 1 n is a continuous path from y to either x 0 or x 0 depending on the sign of t 1 which is entirely contained in r 3 a this proves the claim showing that r 3 a has at most two components to see that it has at least two it is enough to know that any smooth cycle s 1 r 3 has intersection number i 2 a 0 modulo 2 indeed if this is the case and if x 0 and x 0 could be joined by a continuous arc 0 1 r 3 not intersecting a then could be chosen c smooth see 30 ch 1 sec 6 ex 3 and we could complete it into a cycle s 1 r 3 by concatenation with the segment x 0 x 0 which intersects a exactly once at x 0 in a transversal manner elementary modifications at x 0 and x 0 will arrange things so that becomes c smooth and this would contradict the fact that the number of intersection points with a must be even now if d is the unit disk any smooth map s 1 r 3 extends to a smooth map f d r 3 take for example f rei e 1 1 r ei thus by the boundary theorem 30 p 80 the intersection number modulo 2 of with any smooth and complete embedded submanifold of dimension 2 in r 3 in particular with a must be zero this achieves the proof inverse potential problems with total variation regularization 34 projet apics inria 2004 route des lucioles bp 93 sophia antipolis 06902 cedex france e mail address laurent baratchart inria fr department of mathematics vanderbilt university nashville tn 37240 usa e mail address cristobal villalobos guillen vanderbilt edu department of mathematics vanderbilt university nashville tn 37240 usa e mail address doug hardin vanderbilt edu school of mathematics georgia institute of technology atlanta ga 30313 e mail address mcnv 3 gatech edu department of mathematics vanderbilt university nashville tn 37240 usa e mail address edward b saff vanderbilt edu 1 introduction 1 1 two basic extremal problems 1 2 background and related work 1 3 notation 2 equivalent magnetizations net moments and total variation 2 1 divergence free and silent magnetizations 2 2 decomposition of divergence free magnetizations and recovery of magnetizations with sparse support 2 3 the net moment of silent magnetizations 2 4 total variation and unidirectional magnetizations 3 magnetization to field operators 4 regularization by penalizing the total variation 5 numerical examples references appendix a jordan brouwer separation theorem in the non compact case