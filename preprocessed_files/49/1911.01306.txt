universit paris est marne la vall e habilitation to supervise research habilitation diriger des recherches discipline applied mathematics dynamic programming systems for modeling and control of the traffic in transportation networks presented by nadir farhi research associate charg de recherche at ifsttar cosys grettia defended on december 5 th 2018 in front of the jury composed of rapporteurs c cile appert rolland directrice de recherche universit paris sud saclay said mammar professeur universit d evry val d essonnes markos papageorgiou professor technical university of crete reviewers examinateurs carlos canudas de wit directeur de recherche cnrs inria rhones alpes florian de vuyst professeur universit de technologie de compi gne jean patrick lebacque ing nieur g n ral des ponts des eaux et des for ts ifsttar pierre rouchon professeur ecole des mines paristech pravin varaiya professor university of california at berkeley ifsttar paris marne la vall e 2018 ar x iv 1 91 1 01 30 6 v 1 m at h o c 4 n ov 2 01 9 i this page is intentionally left blank contents a summary in french iv 1 introduction 1 i deterministic dynamic programming based modeling 5 2 deterministic dyn prog based systems 9 2 1 deterministic dynamic programming and min plus algebra 9 2 2 max plus algebra 11 2 3 min plus system theory 13 2 4 network calculus 15 3 max plus model for the train dynamics 17 3 1 introduction 17 3 2 the max plus algebra model 19 3 3 extension 1 train dynamics in a metro line with a junction 27 3 4 the traffic phases 29 3 5 extension 2 train dynamics taking into account the travel demand 32 4 road network calculus 37 4 1 complements network calculus for mimo systems 37 4 2 the road section model 41 4 3 composition of 1 d traffic systems 45 4 4 controlled 2 d traffic systems 46 4 5 roads and itineraries 47 4 6 possible extensions and limits 48 5 summary of my other contributions 51 5 1 packet curves in network calculus 52 5 2 semi decentralized urban traffic control 56 5 3 optimal path selection for vehicular ad hoc networks 60 5 4 simulation of cooperative its in urban networks 64 ii stochastic dynamic programming based modeling 69 6 stochastic dyn prog based systems 71 6 1 non expansive dynamic systems 71 6 2 dynamic programming systems of stochastic optimal control problems 73 6 3 dynamic programming systems of stochastic games 73 ii contents iii 7 multi anticipation modeling 75 7 1 review on the piecewise linear car following modeling 76 7 2 anticipation modeling 77 7 3 stability analysis and stationary regime 78 7 4 transient traffic 80 8 demand dependent train dynamics control 83 8 1 natural instability of the train dynamics 83 8 2 stable dynamic programming model 85 8 3 how to fix the control parameters w j and j 87 8 4 derivation of the asymptotic average dwell and safe separation times 88 8 5 numerical results 88 8 6 conclusion and possible extensions 90 9 summary of my other contributions 91 9 1 robust routing in road networks 92 9 2 logit lane assigment model 96 10 conclusions and perspectives 101 a summary in french introduction la mod lisation et l optimisation de la gestion des syst mes complexes restent parmi les th mes de recherche les plus populaires les syst mes complexes sont des syst mes plusieurs com posants avec ventuellement des sous syst mes interagissant entre eux et avec l environnement ext rieur la mod lisation des syst mes complexes est intrins quement difficile cause de la complexit des relations et des interactions entre diff rents composants et ou sous syst mes pouvant inclure des d pendances des boucles de r troaction des comportements mergents des sous syst mes auto organis s etc la difficult de mod lisation des syst mes complexes complique la bonne compr hension de leurs fonctionnement limite la possibilit d anticipation et rend ainsi difficile l optimisation de leur gestion nous sommes concern s dans ce travail par les syst mes de transport complexes nous nous int ressons plus pr cis ment la mod lisation et la r gulation ou optimisation de la gestion du trafic dans ces syst mes la mod lisation math matique de la dynamique d un syst me complexe se fait par la d termination ou l identification des syst mes dynamiques d crivant son volution l tude et l analyse du fonctionnement du syst me complexe revient alors l tude du syst me dy namique le mod lisant de m me l optimisation de la gestion du syst me complexe revient l optimisation d un ou de plusieurs crit re s associ s cette optimisation peut tre statique ou dynamique contr le optimal temps r el la mod lisation math matique de la dynamique d un syst me peut tre class e en se basant sur diff rents crit res d terministe ou stochas tique selon que les incertitudes sont pr sentes et prises en compte ou non dans la mod lisation discr te ou continue espace et temps selon que les variables d tat de caommande et ou le temps sont discrets ou continus lin aire ou non lin aire dans une telle ou telle alg bre etc la compr hension de la dynamique du syst me peut tre compl te comme elle peut tre partielle ou inatteignable selon la nature et la complexit du syst me dynamique exemples syst mes lin aires syst mes ergodiques syst mes chaotiques etc dans le cas d un syst me chaotique par exemple o l tat est impr visible bien que le syst me est d terministe on se limite la recherche de l existence de r gimes stationnaires tant donn que la compr hension des r gimes transitoires est hors d atteinte nous pr sentons ici aussi bien des mod les d ter ministes que stochastiques bien que la plupart soient d terministes cependant nous verrons que certain mod les d terministes admettent des interpr tations stochastiques int ressantes pour certains de nos mod les nous arrivons montrer la convergence de la dynamique vers un r gime stationnaire et d river les phases du syst me analytiquement dans d autre cas nous montrons que le syst me dynamique est instable dans des cas plus compliqu s nous nous contenterons de simuler la dynamique du syst me pour l analyser un point important dans la mod lisation de la dynamique des syst mes est l chelle de mod lisation cette derni re est d termin e par le choix des variables d tat pour un syst me dynamique dans le cas o on s int resse la dynamique fines des unit s mobiles du syst me positions de v hicules leurs vitesses etc pour un syst me de transport on parle de mod lisation dynamique microscopique dans le cas o on s int resse la dynamique de variables repr sentant des agr gations d autres variables plus fines densit s de v hicules leurs d bits iv a summary in french v etc pour un syst me de transport on parle de mod lisation macroscopique des avantages et inconv nients existent pour chacune des deux chelles de mod lisation l chelle est en g n ral choisie selon les besoins de mod lisation en d autres termes selon le ph nom ne ou le comportement qui nous int resse mod liser ou reproduire nous d terminons l chelle de mod lisation ad quate en g n ral nous utilisons l chelle macroscopique pour mod liser la dynamique de syst mes de grande taille de grands r seaux etc et on utilise l chelle mi croscopique pour mod liser la dynamique de syst mes de taille r duite une partie ou un axe du r seau etc une ou des chelles interm diaires pourraient galement tre consid r es si besoin on parle dans ces cas de mod lisation m soscopique l objectif de cette chelle inter m diaire est de tirer b n fice des avantages des deux chelles microscopique et macroscopique sans subir leurs inconv nients un autre param tre en lien direct avec l chelle de mod lisation de la dynamique des syst mes est le niveau de d cision ou de gestion envisag pour le syst me comme indiqu plus haut nous pourrons mod liser un syst me pour comprendre et pouvoir reproduire et anticiper sa dynamique comme nous pourrons mod liser un syst me pour pouvoir agir sur orienter ou optimiser voire contr ler en temps r el sa dynamique dans ce deuxi me cas le niveau auquel nous voudrons agir sur le syst me pourrait d terminer l chelle de mod lisation requise il se peut galement qu on ait choisir le niveau de d cision selon l chelle de mod lisation possible ou pertinente dans le cas o les chelles de mod lisation ne sont pas toutes possibles ou pas toutes pertinentes trois principaux niveaux de d cisions sont en g n ral distingu s pour la gestion d un syst me un niveau dit strat gique qui concerne les d cisions de long terme et qui n cessite en g n ral une chelle macroscopique de mod lisation du syst me un niveau dit tactique qui concerne des d cisions de moyen terme et dont les strat gies pourraient aussi bien tre d velopp es sur la base d une mod lisation macroscopique ou microscopique voire m soscopique de la dynamique du syst me un niveau dit op rationnel qui concerne en g n ral les d cisions prendre en temps r el et dont les strat gies pourraient aussi bien tre d velopp es sur la base d une mod lisation macroscopique microscopique ou m soscopique le contexte dans lequel sont r alis s les travaux pr sent s ici est celui o la mod lisation et la gestion du trafic dans les r seaux de transport et de la mobilit en g n ral sont en pleine mutation suite notamment l arriv e des technologies d information et de communications tic et du num rique la disponibilit de donn es massives et au d veloppement de nouvelles approches et m thodes pour leur analyse et l automatisation grandissante des v hicules tous ou la majorit des composants et des sous syst mes des syst mes de transport ainsi que leurs interactions sont concern s par ces d veloppements la mobilit des biens et des personnes est en pleine mutation suite ces d veloppements la mod lisation ainsi que les m thodes de gestion de la mobilit et du trafic devraient donc tre adapt es en cons quence comme c est bien connu l tat du trafic v hicules et passagers sur un r seau de transport est r sultat de l interaction entre la demande de d placement des passagers v hicules et l offre de d placement du r seau les tics le num rique les big data et l automatisation des v hicules ont des effets tr s importants aussi bien sur la demande que sur l offre de mobilit au niveau demande de d placement toutes les tapes des choix effectu s par les usagers sont affect es par les nouvelles technologies partant de la g n ration des d placements en passant par la distribution et le choix modal et jusqu au choix d itin raires au niveau de l offre de transport les infrastructures sont ou seraient de plus en plus quip es pour permettre l change d information entre les v hicules passagers et l infrastructure dans les deux sens de plus de nouvelles strat gies et algorithmes de r gulation prenant en compte toutes ces nouvelles technologies se d veloppent actuellement notons aussi que la demande de mobilit subit les effets des nouvelles technologies sur l offre par interaction et vice versa les travaux que nous pr sentons ici concernent l tude de l offre de transport plut t que de sa demande certains travaux concernent la mod lisation du trafic routier autoroutier et urbain d autres travaux concernent le transport collectif et plus pr cis ment la mod lisation a summary in french vi de la dynamique des trains sur une ligne de m tro avec prise en compte de la demande de d placement des passagers tous les mod les et les strat gies de contr le pr sent es ici sont d velopp s dans l esprit du contexte d crit ci dessus ce m moire r sume mes travaux de recherche depuis ma th se de doctorat jusqu d but 2018 sont exclus de ce m moire les travaux confidentiels r alis s dans le cadre d un projet de recherche industrielle avec la soci t metrolab projet de 4 ans ainsi que les travaux de recherche non encore publi s quelques travaux de recherche sont des d veloppements naturels de mes travaux ant rieurs effectu s durant ma th se de doctorat g n ralisation et extension d approches de mod lisation du trafic routier d autres travaux sont de nouvelles approches et mod les ainsi que de nouvelles strat gies de r gulation du trafic routier et du trafic en transport collectif ainsi des mod les microscopiques du trafic routier d velopp s dans ma th se de doc torat 14 21 sont g n ralis s pour tenir compte de l anticipation dans la conduite 20 cette g n ralisation est importante car l anticipation dans la conduite devient de plus en plus perti nente et efficace gr ce aux communications entre v hicules et entre v hicules et infrastructure de transport d autre part en s inspirant des mod les macroscopiques du trafic routier bas s sur l alg bre min plus 14 16 nous avons d velopp une approche duale pour la mod lisa tion de la dynamique des trains sur une ligne de m tro 29 31 32 34 35 33 permettant de d crire les phases du trafic et de comprendre sa physique d autres mod les de la th orie du calcul r seau network calculus sont d velopp s durant mon post doc l inria rhones alpes et l ens paris 81 91 92 j ai ensuite adapt la th orie du network calculus pour le d veloppement d une nouvelle approche th orie des syst mes de trafic routier permettant une mod lisation des syst mes du trafic routier sous forme de syst mes lin aires dans l alg bre min plus 96 95 et de d river ensuite des performances sur ces syst mes en appliquant la th orie du network calculus d autres approches de mod lisation et de r gulation du trafic sont d velopp es ind pendamment des travaux de th se de doctorat je cite ici le d veloppe ment des travaux sur le guidage optimal et robuste effectu dans le cadre de la th se de mme farida manseur ainsi que les travaux sur la simulation du trafic et de strat gies de r gulation du trafic urbain avec prise en compte des communication entre v hicules et infrastructure travaux en collaboration avec cyril nguyen van phu du laboratoire grettia ce m moire est intitul syst mes de programmation dynamique pour la mod lisation et la r gulation du trafic dans les r seaux de transport deux parties sont distingu es dans ce m moire 1 les m thodes et approches bas e sur l alg bre min plus ou max plus o les dy namiques sont des syst mes de programmation dynamique d terministe 2 les m thodes et approches dont les syst mes dynamiques sont non lin aires mais s interpr tent comme des syst mes de programmation dynamique stochastique chacune des deux parties comporte des chapitres principaux ainsi qu un chapitre r sumant d autres contributions moi sur le m me th me de la partie concern e la partie 1 inclut un premier chapitre contenant une introduction et quelques rappels n cessaires deux principaux chapitres l un sur la mod lisation en alg bre max plus de la dynamique de trains sur une ligne de m tro l autre sur l approche calcul r seau network calculus pour la mod lisation et le calcul de bornes de performance sur les r seaux routiers et un dernier chapitre r sumant mes autres contributions sur le th me de cette partie la partie 2 inclut un premier chapitre contenant une introduction et quelques rappels n cessaires deux principaux chapitres l un sur la mod lisation microscopique du trafic prenant en compte l anticipation dans la conduite l autre sur la mod lisation de la dynamique de trains sur une ligne de m tro avec prise en compte de la demande de d placement des passagers et un dernier chapitre r sumant mes autres contributions sur le th me de cette partie ci dessous nous donnons une br ve description de chacun des travaux pr sent s dans ce m moire a summary in french vii synth se des travaux nous donnons dans cette section de br ves descriptions des approches et r sultats des diff rents chapitres de ce m moire partie i mod les bas s sur la programmation dynamique d terministe chapitre 1 ce chapitre donne les rappels n cessaires pour les deux chapitres suivants chapitres 2 et 3 ces rappels incluent les principales notions et r sultats n cessaires la compr hension des mod les et des strat gies de contr le pr sent s aux chapitres 2 et 3 le chapitre est organis en trois parties la premi re partie pr sente les principales d finitions et notions sur les alg bres max plus et min plus ainsi que les principaux r sultats n cessaires aux d veloppe ment des mod les des deux chapitres suivants la deuxi me partie pr sente les principaux th or mes sur l existence et l unicit de r gimes stationnaires pour les syst mes lin aires max plus la troisi me partie donne les rappels n cessaires sur la th orie du calcul r seau network calculus incluant les principaux r sultats et notions chapitre 2 ce chapitre pr sente un mod le pour la dynamique des trains sur une ligne de m tro la dynamique des trains est d crite par un mod le v nements discrets prenant en compte des contraintes sur les temps de parcours inter stations sur les temps de stationnements ainsi que sur les temps de s paration entre trains successifs nous montrons que le mod le s crit lin airement dans l alg bre max plus et que le syst me dynamique admet un r gime stationnaire avec un taux d accroissement moyen unique ind pendant de la condition initiale nous d rivons le taux d accroissement moyen analytiquement en fonction du nombre de trains circulant sur la ligne obtenons ainsi les diagrammes de phases du mod le finalement nous interpr tons ces diagrammes en terme de trafic ferroviaire et d duisons la capacit de la ligne le nombre optimal de trains faire circuler sur la ligne ainsi que la d pendance de la fr quence moyenne asymptotique des trains des diff rent param tres de la ligne temps de parcours temps de stationnement temps de s paration des trains etc les principales r f rences pour ce chapitres sont 29 31 30 chapitre 3 ce chapitre pr sente une nouvelle approche de mod lisation et de calcul de bornes de performance sur les r seaux routiers cette approche est bas e sur l un des mod les macroscopiques du trafic les plus connus le mod le de lighthill whitham and richards lwr 56 57 et sur le sch ma num rique de transmission cellulaire cell transmission model 55 58 nous montrons que la description du trafic suiv ant ce sch ma num rique et sous l hypoth se d un diagramme fondamental trap zo dal du trafic la dynamique s crit lin airement en alg bre des fonctions min plus nous d crivons en d tail le mod le du trafic sur une section de route et nous montrons qu il admet une repr sentation sous forme d un syst me lin aire min plus deux entr es et deux sorties nous d rivons ensuite analytiquement la r ponse impulsionnelle de ce sys t me nous proposons une approche th orie des syst me du trafic qui nous permet de construire de grands syst mes du trafic routier base de syst mes l mentaires pour cela nous d finissons quelques op rateurs qui nous permettent par exemple d obtenir le syst me lin aire min plus mod lisant une route plusieurs sections partir du mod le d une seule section en appliquant une concat nation de toutes les sections un autre op rateur permet de mettre une boucle ferm e sur un syst me existant et permet par exemple de mod liser une route circulaire partir d un mod le d une route ouverte non a summary in french viii circulaire nous montrons galement que la th orie du calcul r seau network calcu lus s applique ce type de syst mes et permet de d river pour un syst me lin aire min plus des bornes de performance interpr t es ici comme des bornes sur les temps de parcours sur les densit s du trafic etc finalement nous donnons quelques id es pour l extension de cette approche aux r seaux routiers en deux dimensions avec pr sence d intersections l approche pourrait dans ce cas tre appliqu e aux r seaux urbains avec prise en compte des strat gies de gestion d intersections ou aux r seaux autoroutiers avec prise en compte des strat gies de gestion des acc s les principales r f rences pour ce chapitre sont 96 95 chapitre 4 ce chapitre r sume quatre de mes autres contributions sur la mod lisation d terministe du trafic le premier travail concerne une nouvelle approche du calcul r seau network cal culus qui nous permet de prendre en compte la variation de la taille des paquets des flux de donn es dans le calcul de bornes de performance pour cela nous avons d fini une nouvelle notion de courbe de paquet les r f rences principales pour ce travail sont 81 91 92 le deuxi me travail r sume une approche semi d centralis e pour la r gulation du trafic urbain que nous avons propos e 79 cette approche est bas e sur un mod le de r gulation centralis e du trafic tuc traffic urban control 76 78 et introduit une fen tre de temps dans les cycles des feux de signalisation durant laquelle la r gulation est d centralis e la taille de cette fen tre est optimis e par le niveau centralis de r gulation la principale r f rence pour ce travail est 79 le troisi me travail est r alis dans le cadre d une collaboration avec mme souaad lahlah de l universit de bejaia alg rie qui est invit e plusieurs reprises au laboratoire grettia durant la pr paration de sa th se de doctorat 102 il s agit d un nouveau protocole de s lection optimal d itin raire pour les vanets la par ticularit de ce protocole est qu il int gre un mod le du trafic routier la principale r f rence pour ce travail est 102 le quatri me travail est r alis en collaboration avec cyril nguyen van phu du laboratoire grettia il s agit du d veloppement d un algorithme pour la r gulation du trafic sur une intersection urbaine o le feux de signalisation est suppos pouvoir communiquer avec les v hicules l algorithme a t valu avec une simulation num rique combinant simulation du trafic urbain sous le simulateur sumo 100 avec simulation de la communication sous le simulateur omnet 101 l aide de l outil open source veins 99 les deux simulateurs sont mis en boucle ferm e et une interface de contr le a t utilis e pour l impl mentation de l algorithme la principale r f rence pour ce travail est 80 partie ii mod les bas s sur la programmation dynamique stochastique chapitre 5 ce chapitre donne les rappels n cessaires aux chapitres 6 et 7 ces rappels sont pr sent s en trois parties syst mes dynamiques non expansifs ces syst mes dynamiques sont d finis par des applications non expansives nous rappelons un r sultat principal qui donne les conditions sous lesquelles ces syst mes admettent un r gime stationnaire syst mes de programmation dynamique associ s aux probl mes de contr le optimal de cha nes de markov nous rappelons qu il s agit d un cas particulier des syst mes non expansifs et r interpr tons les conditions d existence de r gimes stationnaires en terme de cha nes de markov a summary in french ix syst mes de programmation dynamique associ s au jeux stochastiques ergodiques sur une cha ne de markov nous rappelons comme dans le cas pr c dant qu il s agit d un cas particulier des syst mes non expansifs et r interpr tons les conditions d existence de r gimes stationnaires en terme de jeux stochastiques sur cha nes de markov chapitre 6 ce chapitre r sume l extension du mod le du trafic microscopique lin aire par morceaux que nous avons propos e dans 14 pour prendre en compte l anticipation dans la loi de poursuite ce mod le assume une loi de poursuite o chaque v hicule r a girait un stimulus d pendant de l tat du trafic sur plusieurs v hicules le pr c dant au lieu de prendre en compte uniquement un seul v hicule leader nous montrons que la dy namique des v hicules s crit comme un syst me de programmation dynamique associ un jeu stochastique ergodique sur une cha ne de markov nous d rivons le comportement mergeant de cette dynamique par une d rivation analytique du diagramme fondamen tal correspondant au r gime stationnaire finalement nous comparons la dynamique des v hicules et le comportement mergeant par rapport au cas sans anticipation la r f rence principale pour ce travail est 20 chapitre 7 ce chapitre r sume l extension du mod le max plus pour la dynamique des trains pr sent au chapitre 2 cette extension a pour objectif de prendre en compte l effet de la demande de d placement des passagers dans la dynamique des trains et en particulier dans les temps de stationnement des trains en stations nous montrons d abord qu une dynamique de trains non contr l e o les temps de stationnement aug mentent m caniquement avec l augmentation des arriv es de passagers sur les quais est naturellement instable nous proposons ensuite une loi de contr le des temps de sta tionnement pour stabiliser la dynamique des trains nous montrons que la dynamique obtenue s crit comme un syst me de programmation dynamique d un probl me de con tr le optimal d une cha ne de markov nous caract risons ensuite les conditions sous lesquelles la dynamique admet un r gime stationnaire avec un taux d accroissement unique qui s interpr te en terme de trafic comme le temps inter v hiculaire inter trains asymptotique moyen qui est l inverse de la fr quence des trains de plus nous d rivons par simulation num rique la fr quence asymptotique moyenne des trains comme fonction du nombre de trains circulant sur la ligne et comparons les phases du trafic obtenues celles obtenues analytiquement par le mod le max plus du chapitre 2 les r f rences principales pour ce travail sont 29 32 30 33 chapitre 8 ce chapitre r sume deux de mes autres contributions sur la mod lisation stochastique du trafic sur les r seaux de transport le premier travail est sur le guidage optimal et robuste des usagers des r seaux routiers c est le travail de th se de mme farida manseur 53 51 52 54 que j ai encadr e au laboratoire grettia il s agit d une extension d une approche stochastique existante 40 41 42 pour le routage optimal dans les r seaux voir aussi 43 44 45 46 47 nous avons tendu cette approche pour prendre en compte la robustesse des strat gies de routage contre d ventuelles d faillances des liens du r seau les r f rences principales pour ce travail sont 53 51 52 le deuxi me travail r sume une contribution propos e en collaboration avec des coll gues de l ens cachan sur la mod lisation de l affectation des v hicules sur les diff rentes voies d une route en fonction de l tat du trafic nous pr sentons le mod le quelques sch mas num riques associ s et quelques r sultats de simulation la principale r f rence pour ce travail est 116 a summary in french x conclusions et perspectives en conclusion les travaux pr sent s dans ce m moire sont en partie en continuation avec mes travaux ant rieurs de th se de doctorat et de post doctorat et en partie orient s vers de nouvelles directions et approches incluant toutes les nouveaut s du domaine nous pen sons que l tude des syst mes de transport et de la mobilit en g n ral prendra encore plus d importance dans l avenir la mod lisation math matiques la r gulation et la simulation num rique du fonctionnement de ces syst mes sont et resterons n cessaires la compr hen sion l optimisation et l anticipation des diff rents ph nom nes et comportements mer gents de ces syst mes l approche syst mes dynamiques adopt e ici est tr s efficace et utile la compr hension de la physique et de la dynamique des syst mes tudi s cependant comme en tam s dans les travaux de ce m moire les mod les et strat gies de contr le devraient s adapter aux nouvelles donnes des tics des big data du num rique et de l automatisation voire de la robotique en parall le de nouveaux mod les et strat gies de contr le devraient repenser ce domaine de mod lisation et de gestion optimale des syst mes de transport complexes dans ses nouvelles dimensions ind pendamment des anciens mod les et strat gies de contr le en terme d chelle de mod lisation l chelle microscopique prendrait plus de part pour la mod lisation de la mobilit gr ce l quipement grandissant des unit s mobiles et des infrastructures de transport cependant l chelle macroscopique restera indispensable pour la mod lisation des ph nom nes complexes l un des exemples concrets est la mod lisation macroscopique de l affectation des v hicules sur les voies que nous avons pr sent e ici au chapitre 9 voir aussi 116 en effet les changements de voies et d passements des v hicules sur une route sont tr s difficiles mod liser en microscopique cause entre autres de la non lin arit des dynamiques le comportement que nous comprenons et que nous sommes capables de reproduire avec le moins d erreurs est plut t macroscopique les flux s affectant sur les voies selon les vitesses moyennes sur chaque voie cherchant un quilibre en terme de niveau de d cision pour la gestion du trafic et de la mobilit nous aurons de plus en plus de possibilit s de consid rer le niveau op rationnel gr ce l augmentation de la capacit d observation de l tat du syst me rendu possible par la disponibilit et la vari t des capteurs ainsi des flux de donn es int ressantes arriveraient en temps r el et pourraient donc tre utilis s pour une gestion op rationnelle d autre part l agr gation de toutes ces informations combin e des mod les pr dictifs continuerons toujours tre int ressants pour une gestion des niveau plus hauts tactique et strat gique par cons quent nous aurons be soin d imaginer des gestion intelligentes combinant plusieurs niveaux de d cisions et utilisant des informations disponibles tous les niveaux un exemple concret est celui de la r gulation semi d centralis e pour le trafic routier urbain que nous avons propos e au chapitre 5 voir aussi 79 a summary in french xi this page is intentionally left blank chapter 1 introduction modeling and optimization of the management of complex systems remain among the most popular research topics complex systems are multi component systems possibly with sub systems interacting with each other and with the external environment the modeling of complex systems is intrinsically difficult because of the complexity of the relationships and in teractions between different components and or subsystems which may include dependencies feedback loops emerging behaviors self organized subsystems etc the difficulty of modeling complex systems complicates the proper understanding of their operation limits the possibility of anticipation and thus makes it difficult to optimize their management we are concerned in this work by complex transport systems we are particularly interested in the modeling and regulation of traffic in these systems mathematical modeling of the dynamics of a complex system is done by determining or identifying a dynamic system describing its evolution the study and analysis of the operation of the complex system is then done by studying the dynamic system modeling it likewise optimizing the management of a complex system amounts to the optimization of one or more associated criteria this optimization can be static or dynamic optimal control mathe matical modeling of the dynamics of a system can be classified according to several criteria deterministic or stochastic depending on whether the uncertainties are present and taken into account in the proposed model discrete or continuous in space and in time depending on whether the state and or time variables are discrete or continuous linear or nonlinear in stan dard or in other algebras etc the understanding of the system dynamics can be entire or it can be partial or unachievable according to the nature and to the complexity of the dynamic system examples linear systems ergodic systems chaotic systems etc in the case of a chaotic system for example whose state is unpredictable although the system is determinis tic one is limited to look for the existence of stationary regimes since the understanding of transient regimes is out of reach here we present both deterministic and stochastic models although most of them are deterministic however we will see that some of our deterministic models admit interesting stochastic interpretations for some of our models we show the convergence of the dynamics towards a stationary regime and derive analytically the phases of the system in other cases we show that the considered dynamic system is unstable in more complicated cases we will simply simulate the dynamics of the system to analyze them one important point in the dynamic system modeling is the scale of modeling the latter is determined by the choice of the state variables for a dynamic system in the case where one is interested in the fine dynamics of the mobile units of the system vehicle positions their speeds etc for a transport system one speaks of microscopic dynamic modeling in the case where one is rather interested in the dynamics of variables representing aggregations of other finer variables densities of vehicles their flow rates etc for a transport system one speaks of macroscopic modeling advantages and disadvantages exist for each of the two 1 chapter 1 introduction 2 modeling scales the scale is usually chosen according to the modeling needs in other words depending on the phenomenon or the behavior we are interested in modeling or reproducing we determine the appropriate modeling scale in general we use the macroscopic scale to model the dynamics of large systems large networks etc and use the microscopic scale to model the dynamics of small systems a part or an axis of the system etc one or more intermediate scales could also be considered if necessary in these cases we speak of mesoscopic modeling the objective of this intermediate scale is to benefit from the advantages of both microscopic and macroscopic scales without suffering their disadvantages another parameter directly related to the modeling scale of dynamic systems is the level of decision or management envisaged for the system as indicated above one may model a system to understand and be able to reproduce and anticipate its dynamics or may model a system to be able to act on optimize or even control in real time its dynamics in this second case the level at which one likes to act on the system could determine the required modeling scale it may also be necessary to choose the decision level according to the possible or relevant modeling scale in the case where some modeling scales are not possible or relevant three main levels of decision are generally distinguished for the management of a system a so called strategic level which concerns long term decisions and which usually requires a macroscopic modeling scale for the dynamics of the system a so called tactical level which concerns medium term decisions and whose strategies could be developed on the basis of macroscopic or microscopic or even mesoscopic modeling of the dynamics of the system a so called operational level which generally concerns decisions to be made in real time and whose strategies could be developed on the basis of macroscopic microscopic or mesoscopic modeling the context in which the work presented here is carried out is the one in which the modeling and management of traffic in transport networks and of mobility in general are submitted to important changing thanks to the arrival of information and communication technologies ict and digitalization the availability of big data and the development of new approaches and methods for their analysis and the growing automation of vehicles all or most of the components and subsystems of a transport system as well as their interactions are affected by these developments the mobility of goods and people is in turn affected and is also changing the modeling as well as the methods of mobility and traffic management should therefore be adapted accordingly as well known the state of traffic vehicles and passengers on a transportation network is a result of the interaction between the travel demand of passengers vehicles and the trans port supply of the network icts digitalization big data and vehicle automation have very important effects on both the transport demand and supply at the level of travel demand all the stages of the choices made by the users are affected starting from the generation of the displacements via their distribution and the modal choice and up to the route choice at the transport supply level infrastructures are or would be increasingly equipped to al low the exchange of information between vehicles passengers and the infrastructure in both directions in addition new strategies and regulation algorithms taking into account all these new technologies are currently in development it should also be noted that the demand for mobility is affected by the effects of new technologies on supply by interaction and vice versa the works we present here concern the study of transport supply rather than its demand some works concern the modeling of road traffic highway and urban other works concern public transport and more specifically the modeling of train dynamics on a metro line taking into account the passenger travel demand all models and control strategies presented here are developed in the spirit of this context of development of mobility and transport systems this dissertation summarizes my research since my phd until early 2018 the confidential work done in the framework of an industrial research project with the metrolab company 4 year project is excluded from this thesis very recent research not yet published does not chapter 1 introduction 3 appear some research works are natural developments of my previous work done during my phd thesis generalization and extension of road modeling approaches other works are new approaches and models as well as new control strategies for road and mass transit traffic thus microscopic models of road traffic developed in my phd thesis 14 21 are generalized to take into account anticipation in driving 20 this generalization is important because anticipation in driving becomes more and more relevant and efficient thanks to communications between vehicles and between vehicles and transport infrastructure on the other hand by taking inspiration from macroscopic models of road traffic based on the min plus algebra 14 16 we have developed a dual approach for modeling the train dynamics on a metro line 29 31 32 34 35 33 to describe the traffic phases and understand its physics other models of the network calculus theory are developed during my post doc position at inria rhones alpes and at ens paris 81 91 92 i then adapted the network calculus theory for the development of a new approach theory of road traffic systems allowing a modeling of road traffic systems in the form of linear systems in the min plus algebra 96 95 and then derive performance bounds on these systems applying the network calculus theory other modeling and traffic control approaches are developed independent of my phd thesis work i cite here the development of works on the optimal and robust guidance carried out in the framework of the thesis of ms farida manseur as well as the work on simulation of the traffic and of the control strategies for urban traffic with taking into account possible communications between vehicles and infrastructure works in collaboration with cyril nguyen van phu from the grettia laboratory this thesis is entitled dynamic programming systems for modeling and control of the traffic in transportation networks two parts are distinguished in this dissertation 1 methods and approaches based on min plus or max plus algebra where the dynamics are deterministic dynamic programming systems 2 methods and approaches whose dynamic systems are non linear but are interpreted as stochastic dynamic programming systems each of the two parts includes a chapter of necessary reviews two main chapters and a chapter summarizing other works related to the concerned part part 1 includes a first chapter containing an introduction and some necessary reviews two main chapters one on the max plus algebra model for the train dynamics on a metro line the other one on the network calculus approach for modeling and calculating performance bounds on road networks and a final chapter summarizing my other contributions on the topic of this part part 2 includes a first chapter containing an introduction and some necessary reviews two main chapters one on the microscopic modeling of traffic taking into account anticipation in driving the other one on the modeling of the train dynamics on a metro line taking into account the passenger travel demand and a final chapter summarizing my other contributions on the topic of this part chapter 1 introduction 4 this page is intentionally left blank part i deterministic dynamic programming based modeling 5 6 we present in this part our works related to the traffic modeling and control in trans portation networks based on deterministic dynamic programming systems as well known the dynamic programming system associated to a deterministic discrete time optimal control problem is a max plus or min plus linear system depending on whether the optimal control problem maximizes rewards or minimizes payoffs respectively we notice that the max plus and the min plus algebras are dual all the results of the max plus algebra hold in the min plus algebra and vice versa one can easily pass from maximization to minimization by min a b max a b the traffic models we present here are mainly based on the max plus or min plus algebra theory this part is organized in four chapters chapter 2 the first chapter of part i introduces the modeling and control approaches and gives the main theoretic reviews necessary for the development of the models in the three other chapters the reviews consists in the definitions of the main notions of the max plus and min plus algebras the main theorems on the existence and uniqueness of stationary regimes of the linear max plus systems and a review on the network calculus theory including the main notions and results chapter 3 presents the max plus algebra modeling approach we developed for the traffic modeling of the train dynamics in metro line systems we describe the train dynamics in a metro line system with constraints on the train run dwell and safe separation times we show that the train dynamics satisfying those constraints are written linearly in the max plus algebra moreover we show that the resulting dynamic system admits a stationary regime with a unique asymptotic average growth rate interpreted as the asymptotic average train time headway of the metro line furthermore we derive from that phase diagrams for the train dynamics giving the average train frequency as a function of the number of trains running on the metro line we distinguish three traffic phases which we describe in detail we then present briefly two extensions of the approach 1 to the case of a metro line with a junction 2 to the case where the travel demand is taken into account we give the main results obtained with the two extensions we notice here that some other extensions have been performed and presented in chapter 7 of part ii those extensions introduce also the travel passenger demand in the train dynamics and derive its effect on the traffic phases however the dynamic systems considered in the extensions of chapter 7 are no more max plus linear chapter 4 presents the new approach we developed entitled the road network calculus this approach applies the theory of the network calculus to the traffic modeling and control of road networks it proposes a kind of system theory that permits to build traffic systems of road networks basing on predefined elementary traffic systems such as a road section network calculus results are then applied to derive performance bounds in the road networks such as upper bounds on the travel time through given itineraries or upper bounds on the car densities etc moreover these performance bounds are dependent on the control strategies set on the road network therefore the approach can be used to assess and compare different control strategies in term of various performance bounds this is related to consideration of the reliability of the performance of road networks chapter 5 the last chapter of part i summarizes all my other contributions on the de terministic traffic modeling and control this chapter includes first some extensions of the network calculus where we proposed what we called packet curves in order to improve the modeling of the variety of packet sizes in arrival and departures flows of the network calculus second a semi decentralized urban traffic control is presented where basing on a centralized urban traffic control approach we proposed to add a decentralized level of control which is able to benefit from possible vehicle to infrastructure v 2 i communications at the level of a road intersection in relatively short time intervals third a proactive optimal path selection model with coordinator agents assisted routing for vehicular ad hoc networks is presented we proposed a model for the routing in vehicular ad hoc networks where we take into account the vehicular traffic models in particular the car density variation in the road network this 7 work is done in collaboration with mrs souaad lahlah from university of bejaia algeria finally an algorithm for urban traffic control with vehicle to infrastructure equipped traffic lights communications is proposed both the vehicular and the communication traffics are simulated in this work in a closed loop and with an interface permitting us to control in real time the traffic lights in function of the information made available in particular by the communication possibilities 8 this page is intentionally left blank chapter 2 introduction to and reviews on deterministic dynamic programming based systems we introduce in this part the readers to some theoretical tools we use in our models the reviews are organized in three sections first we give the main definitions and notions of the max plus algebras on scalars on square matrices on polynomials and on matrices of polynomials these reviews will be mainly used in chapter 3 where traffic models and control approaches are proposed for the train dynamics in metro line systems second we give main reviews of the min plus algebra system theory those reviews are necessary for chapter 4 where the theory of network calculus which is based on the min plus algebra system theory is applied on the road networks third and finally we give some reviews on the network calculus theory which we need also for chapter 4 2 1 deterministic dynamic programming and min plus algebra let us consider the following deterministic optimal control problem min s s k 1 k 0 c u k i k i k 2 1 i k 1 f i k u k k 0 k k 1 2 2 where i 1 2 n 3 i denotes the state space of the system u 3 u denotes the control action space of the system s is the set of feedback strategies s i u cu k i k denotes the payoff at state i k with control action u k for 0 k k and i k denotes the final payoff at state i k which is independent of the control because we do not have or need a control action at the final time we have in 2 2 a dynamic system where the state of the system i k 1 at time k 1 is given as a function of the state i k at time k and of the control action u k taken at time k payoffs cu k i k are associated to the dynamics where at every time k 0 k k the payoff c u k i k depends on the state of the system i k at time k and on the control action u k taken at time k moreover a final payoff i k is associated to the final state of the system the optimal control problem consists then in minimizing the sum of all the payoffs from time zero to time k with respect to the control strategy and under the dynamics 2 2 both sets i and u are assumed to be discrete and finite 9 chapter 2 deterministic dyn prog based systems 10 in order to write the dynamic programming system associated to the deterministic optimal control problem 2 1 2 2 let us define the value function x as follows xj t min s s k 1 k t c u k i k i k 2 3 i k 1 f i k u k k t k k 1 2 4 i t j 2 5 it is then easy to check that the value function x defined in 2 3 2 5 satisfies the following xj k j j i 2 6 xj t min u u c u t i t xf j u t t 1 j i t 0 t k 1 2 7 system 2 6 2 7 is called the dynamic programming system written in backward i e x t is given as a function of x t 1 associated to the optimal control problem 2 1 2 2 let us now denote by i t in the line vector giving the state of the dynamic system at time t with ip t 1 if i t p 0 otherwise we also denote by mu u u the matrices defined as follows muij 1 if j f i u 0 otherwise we notice here that mu u u are permutation matrices then the dynamics 2 2 of the system can be written as follows i k 1 i k mu k k 0 k k 1 2 8 moreover if we denote by x t the column vector giving the function value for each state in such a way that the pth component of x t gives xp t denote by cu t the column vector giving the payoffs at each state in such a way that the pth component of cu t gives cu t p and denote by the column vector giving the payoffs at the final states in such a way that the pth component of gives p then the dynamic programming system 2 6 2 7 is written as follows x k 2 9 x t p min u u cu t p mu t x t 1 p p 1 p n 2 10 let us now define the following matrix a t with components in r aij t c u t i if m u t ij 1 otherwise then we can easily check that the dynamic programming system 2 9 2 10 can be written as follows x k 2 11 x t a t x t 1 t 0 t k 1 2 12 chapter 2 deterministic dyn prog based systems 11 where xi t 1 i n 0 t k belong now to r and where the operator which is the min plus algebra matrix product operator see section 2 2 below is defined as follows a b ij min 1 p l aip bpj i 1 i n j 1 j m a and b are n l and l m min plus matrices respectively see section 2 2 below an important remark here is that the dynamic programming system associated to deter ministic optimal control problem is written linearly in the min plus algebra one of the well known deterministic optimal control problems for which such formalism can be applied is the shortest path problem in a given network 2 2 max plus algebra as mentioned above dynamic programming systems associated to deterministic optimal con trol problems can be written linearly in the max plus or min plus algebra we present here some reviews on the max plus algebra the main traffic model we propose in chapter 3 is written in the max plus algebra of square matrices of polynomials we recall here the con struction of this algebraic structure and give some results which we used in the analysis of our models 2 2 1 max plus algebra of scalars rmax max plus algebra 2 is the idempotent semi ring r denoted by rmax where the operations and are defined by a b max a b and a b a b the zero element is denoted by and the unity element is 0 denoted by e 2 2 2 max plus algebra of square matrices rn nmax we have the same structure on the set of square matrices if a and b are two max plus matrices of size n n the addition and the product are defined by a b ij aij bij i j and a b ij k aik bkj the zero and the unity matrices are still denoted by and e respectively a matrix a is said to be reducible if there exists a permutation matrix p such that p tap is lower block triangular a matrix that is not reducible is said to be irreducible for a matrix a rn nmax a precedence graph g a is associated the set of nodes of g a is 1 2 n there is an arc from node i to node j in g a if aji 6 a graph is said to be strongly connected if there exists a path from any node to any other node a rn nmax is irreducible if and only if g a is strongly connected 2 that is a is irreducible if 1 i j n m n am ij 6 2 2 3 max plus algebra of polynomials rmax x a formal polynomial in an indeterminate x over rmax is a finite sum p l 0 alx l for some integer p and coefficients al rmax the set of formal polynomials in rmax is denoted rmax x the support of a polynomial f p l 0 alx l is supp f l 0 l p al the degree of f is deg f l supp f l we have the same algebraic structure of idempotent semi ring on rmax x where the addition and the product of two polynomials f p l 0 alx l and g q l 0 blx l in rmax x are defined as follows f g deg f deg g l 0 al bl x l chapter 2 deterministic dyn prog based systems 12 f g def f deg g l 0 i j l ai bj x l the zero element is x 0 and the unity element is e ex 0 we notice that x rmax the valuation mapping f 7 f x is a homomorphism from rmax x into rmax 2 2 4 max plus algebra of polynomial square matrices rmax x n n a polynomial matrix a x rmax x n n is a matrix with polynomial entries aij x p l 0 a l ij x l where a l ij rmax i j 0 i j n and l 1 l p rmax x n n is an idempotent semiring the addition and the product are defined as follows a x b x ij aij x bij x i j a x b x ij k aik x bkj x i j the zero and the unity matrices are still denoted by and e respectively we also have x rmax the valuation mapping a x 7 a x is a homomorphism from rmax x n n into rn nmax a polynomial matrix a x rmax x n n is said to be reducible if there exists a permu tation matrix p x rmax x n n such that p x ta x p x is lower block triangular irreducibility of a matrix depends only on its support that is the pattern of nonzero entries of the matrix as for finite values of x the support of a matrix is preserved by the homomorphism valuation map then a x rmax x n n is irreducible if and only if a e rmax n n is so therefore a x rmax x n n is irreducible if and only if g a e is strongly connected for a polynomial matrix a x rmax x n n a precedence graph g a x is associ ated as for graphs associated to square matrices in rn nmax the set of nodes of g a x is 1 2 n there is an arc i j l from node i to node j in g a x if l 0 l p a l ji 6 moreover a weight w i j l and a duration d i j l are associated to every arc i j l in the graph with w i j l al ij 6 and d i j l l similarly a weight resp duration of a cycle directed cycle in the graph is the standard sum of the weights resp durations of all the arcs of the cycle finally the cycle mean of a cycle c with a weight w c and a duration d c is w c d c 2 2 5 homogeneous linear max plus algebra systems we are interested in the model for the first train dynamics we propose in chapter 3 in the dynamics of a homogeneous p order max plus system x k p l 0 al x k l 2 13 where x k k z is a sequence of vectors in rnmax and al 0 l p are matrices in rn nmax if we define as the back shift operator applied on the sequences of vectors in z such that x k x k 1 and then more generally lx k x k l l n then 2 13 is written as follows xk p l 0 lalx k a xk 2 14 where a p l 0 lal rmax n n is a polynomial matrix in the back shift operator see 2 10 for more details chapter 2 deterministic dyn prog based systems 13 definition 2 1 rmax is said to be a generalized eigenvalue 11 of a with associated generalized eigenvector v rnmax if a 1 v v where a 1 is the matrix obtained by evaluating the polynomial matrix a at 1 theorem 2 1 2 theorem 3 28 9 theorems 7 4 1 and 7 4 7 let a pl 0 al l be an irreducible polynomial matrix with acyclic sub graph g a 0 then a has a unique general ized eigenvalue and finite eigenvectors v such that a 1 v v and is equal to the maximum cycle mean of g a given as follows maxc cw c d c where c is the set of all elementary cycles in g a moreover the dynamic system xk a xk admits an asymptotic average growth vector also called here cycle time vector whose components are all equal to 2 3 min plus system theory we give in this section a short review of the main definitions and results of the min plus system theory which we need for the models proposed in chapter 4 the main variables we use here are the cumulated traffic flows functions of time which we denote with capital letters a dynamic system for the traffic is then seen as a system with input signals car inflows and output signals car outflows the network calculus theory associates an arrival and a service curves to a such system and derives from those curves performance bounds like upper bounds of the delay of passing through the system an arrival curve upper bounds the arrival inflows to the system while a service curve lower bounds the guaranteed service and then the departure outflows from the system in the following we review these two notions of arrival and service curves in the one dimensional case for systems with one arrival inflow and one departure outflow 2 3 1 min plus algebra as for the max plus algebra the min plus algebra of scalars denoted rmin is the set r endowed with the min plus addition such that a b min a b and the product such that a b a b the structure rmin is a commutative dioid idempotent semiring 2 the zero element is still denoted 1 and the identity element is e 0 min plus algebra of functions we are interested here in the min plus algebra of functions in z and then in the min plus algebra of matrices of functions in z we denote by f the set of functions f indexed by t n such that f 0 0 and f is increasing in n thus f is non negative we endow f with two intern operations the addition element wise minimum and the multiplication minimum convolution defined as follows addition f g t min f t g t product f g t min 0 s t f s g t s the algebraic structure f is a dioid see 2 71 72 the zero element and the identity element e are given as follows t t n e 0 0 and e t t 0 1 denotes or depending on the structure considered rmax or rmin respectively chapter 2 deterministic dyn prog based systems 14 for f f fk denotes the power operation with respect to the product fk f fk 1 with f 0 e the sub additive closure on f is then defined as follows f k 0 fk we call deconvolution the operation in f defined as follows f g t sup s 0 f t s g s we consider the two signals p the gain signal and the time shift signal in f p t p for t 0 for t 0 t 0 for 0 t t for t t figure 2 1 the signals 2 3 2 3 and 2 3 respectively it is easy to check that see figure 2 1 p p t 2 15 p 2 2 p 1 1 p 1 1 t 2 1 p 2 p 1 2 16 from figure 2 1 we can easily see that 2 3 t 2 3 t t 0 we denote by f 0 the set of functions f indexed by t n such that f 0 0 and f is increasing in n the structure f 0 is also a dioid for which the zero and the unity e elements coincide 0 e 0 0 and t e t t 0 the dioid of matrices of functions we denote by fn n the set of n n matrices with elements in f the addition still denoted by is the element wise minimum and the product still denoted by is defined as follows f g ij 0 k n fik gkj chapter 2 deterministic dyn prog based systems 15 the zero element still denoted by is the n n matrix with an on all the entries the unity element the n n matrix with an e on every diagonal entry and an elsewhere it is easy to check that we have again a dioid structure the sub additive closure on fn n is defined as follows f k 0 f k where f k denotes the power operation with respect to the product on fn n f k f f k 1 with f 0 e let us consider the system y f y u on the variable y fn where f fn n and u fn a subsolution for that system is a y satisfying y f y u where f g is defined here by f g f then y fn is called the maximum subsolution of the system if it is a subsolution of it and if for any subsolution y of that system we have y y theorem 2 2 linear system with feedback 2 71 the maximum subsolution in the vector of signals y of the system y f y u is given by y f u if f 0 0 then y f u is unique under the same condition we have y f y u y f u 2 4 network calculus in this section we give a short review on the single in single out siso systems let us consider a system seen as a server with an arrival cumulated flow u f and a departure cumulated flow y f figure 2 2 a server definition 2 2 74 75 71 72 the backlog b t at time t is defined b t u t y t the virtual delay d t caused by the server at time t is defined d t inf h 0 y t h u t is a maximum arrival curve for u if u u is a minimum arrival curve for u if u u max 0 s t s u t s is a service curve for the server if y u is a strict service curve for the server if for any busy time period s t we have y t y s t s chapter 2 deterministic dyn prog based systems 16 let us consider the following notations for affine and rate latency curves r s t rt s affine curve 2 17 r t t r t t rate latency curve 2 18 we notice that it is often used to upper bound maximum arrival curves by affine curves 2 17 and lower bound the service curves by rate latency curves 2 18 the following result gives three bounds theorem 2 3 74 75 71 72 the backlog b the delay d and the departure flow y are bounded as follows b t sups 0 s s 0 t 0 d t sups 0 inf h 0 s h s t 0 y y i e is a maximum arrival curve for y for the derivation of performance bounds from arrival and service curves in the one dimension case see 74 75 71 72 chapter 3 max plus algebra model for the train dynamics in metro line systems we present in this chapter a new approach for modeling and control of the train dynamics in metro line systems this approach has been firstly presented in 29 with the main ideas including a first model based on the max plus algebra for the modeling of the train dynamics in a linear metro line without taking into account the passenger travel demand this first model is the basis of the approach the references 29 30 include also two other models presented in part ii of this dissertation for the modeling of the train dynamics taking into account the passenger travel demand through average passenger arrival rates to platforms see also 33 we present also in this chapter some extensions of the approach realized with master s and phd degree students from ecole des ponts paristech enpc the first extension 34 models the train dynamics in a metro line with a junction it has permitted the derivation of analytic formulas giving the phase diagrams of the train dynamics in such a system this allowed us to understand wholly the physics of the traffic in this case and in particular to derive the effect of the junction on the traffic phases and on the traffic control an application of the the model on the metro line 13 of paris has confirmed our analytic results the second extension 35 introduces the running times or train speeds as control variables in addition to the train dwell times at platforms this extension permits in particular to respond easily to increases of the passenger travel demand by extending train dwell times and then compensate by shortening train run times on inter stations we provided here thresholds on the margins on the train run time from which it is possible to compensate an extension of train dwell times at platforms corresponding to a given increase of the passenger travel demand 3 1 introduction mass transit by metro is one of the most efficient safe and comfortable urban passenger transport modes however it is also known to be naturally unstable in case where it is exploited at high frequencies 23 indeed in the latter case the capacity margins are reduced and therefore train delays can be amplified and propagated through the whole metro line in order to avoid such scenarios the development of innovative approaches and methods for real time railway traffic control is needed we present in this chapter discrete event traffic models and control strategies for the train dynamics we provide here guarantees for the train dynamics stability and derive analytically phase diagrams of the dynamics with an interpretation of the traffic phases one of the main control parameters of the train dynamics is the train dwell times at 17 chapter 3 max plus model for the train dynamics 18 platforms the passenger dynamics at platforms and inside the trains do have an effect on train dwell times at platforms and by that on the whole train dynamics indeed accumulation of passengers at platforms and inside the trains induce additional constraints for the train dwell times this situation can be due to high level of passenger travel demand or to delayed trains in case of incidents these additional constraints induce direct extensions of the train dwell times at platforms which induces train delays the latter may then propagate in space and in time inducing secondary delays more incidents and so on several approaches have been developed mathematical simulation based expert system etc for optimization and control of the train dynamics we cite here 26 23 36 27 38 breusegem et al 1991 23 developed interesting discrete event traffic and control models pointing out the nature of traffic instability in metro lines the approach of 23 is based on linear quadratic lq control another interesting approach is the one of goverd 2007 10 who developed an algebraic model for the analysis of timetable stability and robustness against delays other approaches studying and taking into account passenger dynamics and their effect on the train dynamics can be found in 4 1 25 for a recent overview on recovery models and algorithms for real time railway disturbance and disruption management see 24 the modeling approach we propose here as well as the results are new the first model 29 31 of the train dynamics for a metro line without junction and without taking into account the passenger travel demand assumes bounds for the train dwell times at platforms bounds on the train safe separation times on the line and nominal train run times on inter stations the train dynamics are then described with a discrete event system this description is new moreover we characterize here the stationary regime of the train dynamics by giving the conditions for its existence and by deriving analytically the asymptotic average train frequency as a function of the train density in the metro line in the cases where a stationary regime exists this derivation is new and original it permits to distinguish the traffic phases of the train dynamics and by that determine the capacity of the metro line and the optimal number of running trains which realizes the line capacity as functions of all the parameters of the line bounds on the train dwell times at platforms nominal train run times at inter stations and bounds on the train safe separation times the extensions presented here and developed in 34 and 35 are also new the model of the train dynamics in a metro line with a junction 34 derives the asymptotic average train frequency as a function of the number of running trains on the line and of the difference between the number of running trains on the two branches of the line the metro line has a central part and two branches crossing at a junction the traffic phases are then derived this derivation is new and original to our best knowledge it is the first description and analytic derivation of the physics of traffic on a metro line with a junction the second extension 35 proposes a model of the train dynamics in a metro line without junction but where both train dwell times at platforms and train run times on inter stations are controlled depending on the passenger arrival demand similarly the stationary regime of the train dynamics is characterized and the asymptotic average train frequency is derived as a function of the number of running trains on the line and of the level of passenger arrival demand the traffic phases are then derived and interpreted this derivation is also new and original this chapter is organized as follows in section 3 2 we present the first model which de scribes the trains dynamics without taking into account the passenger travel demand the model considers lower bounds for train run times on inter stations train dwell times at plat forms and safe separation times between successive trains we show that the model is linear in the max plus algebra and derive the stationary regime of the train dynamics in section 3 2 1 we define what we called fundamental traffic diagrams of the train dynamics by similarity to the road traffic in section 3 2 2 we describe the traffic phases of the train dynamics derived for the model finally and briefly we present two extensions of the model which have been developed with florain schanzenb cher a phd student at ratp and university of paris chapter 3 max plus model for the train dynamics 19 est section 3 3 presents an extension of the model to the case of metro lines with a junc tion see 34 section 3 5 presents an extension of the model to take into account the travel passenger demand see 35 3 2 the max plus algebra model the main references of this section are 29 31 30 as mentioned above this is a model for the train dynamics in a metro line it is the basis of all other extensions presented in the next sections this first model written in the max plus algebra takes into account minimum run dwell and safe separation time constraints without any control of the train dwell times at platforms and without consideration of the passenger travel demand we show that the dynamics admit a stationary regime with a unique asymptotic average growth rate interpreted here as the asymptotic average train time headway indeed the latter is derived as a max plus eigenvalue of the max plus linear system corresponding to the train dynamics moreover the asymptotic average train time headway dwell time as well as safe separation time are derived analytically as functions of the number of running trains on the metro line by that three traffic phases of the train dynamics are clearly distinguished figure 3 1 representation of a linear metro line we consider a linear metro line of n platforms as shown in figure 3 1 in order to model the train dynamics on the whole line including the dynamics on inter stations we discretize the inter stations space and thus the whole line in segments or sections or blocks the length of every segment must be larger than the length of one train we then consider the following notations n number of platforms n number of all segments of the line m number of running trains l the length of the whole line bj 0 1 boolean number of trains being on segment j at time zero b j 1 bj 0 1 dkj instant of the kth departure from node j notice that k do not index trains but count the number of departures from segment j akj instant of the kth arrival to node j notice that k do not index trains but count the number of arrivals to segment j rj the running time of a train on segment j i e from node j 1 to node j wkj d k j a k j train dwell time corresponding to the kth arrival to and departure from node j tkj rj w k j train travel time from node j 1 to node j corresponding to the kth arrival to and departure from node j chapter 3 max plus model for the train dynamics 20 gkj a k j d k 1 j node or station safe separation time also known as close in time corresponding to the kth arrival to and k 1 st departure from node j hkj d k j d k 1 j g k j w k j departure time headway at node j associated to the k 1 st and kth departures from node j skj g k bj j rj a kind of segment safe separation time not taking into account the running time skj is associated to segment j we also use underlined and over lined notations to denote the maximum and minimum bounds of the corresponding variables respectively then r j t j w j g h j and s j denote maximum run travel dwell safe separation headway and s times respectively rj tj wj g hj and sj denote minimum run travel dwell safe separation headway and s times respectively the average on j and on k asymptotic of those variables are denoted without any subscript or superscript then r t w g h and s denote the average run travel dwell safe separation headway and s times respectively proposition 3 1 we have the following relationships g r s 3 1 t r w 3 2 h g w t s n m t n n m s 3 3 proof indeed 3 1 comes from the definition of skj and 3 2 comes from the definition of t k j for 3 3 h g w comes from the definition of hkj h t s comes from the definition of tkj and s k j and from h g w h nt m average train time headway is given by the travel time of the whole line nt divided by the number of trains h ns n m can be derived from h t s and h nt m the running times rj of trains on every segment j are considered to be constant do not change with k they can be calculated from the running times on inter stations and by means of given inter station speed profiles in the free train flow case depending on the characteristics of the line and of the trains running on it we then have tj rj wj j 3 4 t j rj w j j 3 5 let us notice here that the variable wkj denote dwell times at all nodes j 1 n including non platform nodes the lower bounds wj should be zero for the non platform nodes j and they should be strictly positive for platform nodes therefore the asymptotic average dwell time w on all the nodes is lower than the asymptotic dwell time on the platform nodes we also define g t and s corresponding to platforms and distinguish them from g t and s chapter 3 max plus model for the train dynamics 21 w asymptotic average dwell time at platform nodes g asymptotic average safe separation time on platform nodes t r w asymptotic travel time on segment j upstream of platform node j s g r asymptotic average safe separation time on segment j upstream of platform node j another important remark related to the one above is that as we consider in this first model constant running times on segments and on inter stations then every train deceleration or stopping at the level of an inter station generally caused by an interaction with the train ahead is modeled here by a dwell time extension at one of the nodes at the considered inter station in one of the extensions we present in the next sections inter station train running times are considered as control variables in addition to train dwell times at platforms the model we propose here writes the train dynamics basing on two time constraints a constraint on the travel time on every segment j dkj d k bj j 1 tj 3 6 constraint 3 6 tells first that the kth departure from node j corresponds to the same train as the kth departure from node j 1 in case where there is no train at segment j at time zero bj 0 and corresponds to the same train as the k 1 st departure from node j 1 in case where there is a train at segment j at time zero constraint 3 6 tells in addition that the departure from node j cannot be realized before the corresponding departure from node j 1 plus the minimum travel time tj rj wj from node j 1 to node j a constraint on the safe separation time at every segment j dkj d k b j 1 j 1 a k bj 1 j 1 rj 1 d k b j 1 j 1 g k bj 1 j 1 rj 1 g j 1 rj 1 sj 1 that is dkj d k b j 1 j 1 sj 1 3 7 constraint 3 7 tells first that in term of safety the kth departure from node j is constrained by the k 1 st departure from node j 1 in case where there is no train at segment j 1 at time zero and it is constrained by the kth departure from node j 1 in case where there is a train at segment j 1 at time zero constraint 3 7 tells in addition that the kth departure from node j cannot be realized before the departure constraining it from node j 1 plus the minimum safety time at node j 1 the model then assumes that the kth train departure from segment j is realized as soon as both constraints 3 6 and 3 7 are satisfied therefore the kth train departure time from segment j is given as follows dkj max d k bj j 1 tj d k b j 1 j 1 sj 1 k 1 1 j n 3 8 chapter 3 max plus model for the train dynamics 22 where the index j is taken with modulo n that is to say that for the two particular cases of j 1 and j n the dynamics are written as follows dk 1 max d k b 1 n t 1 d k b 2 2 s 2 k n dkn max d k bn n 1 tn d k b 1 1 s 1 k n with max plus notations and using the back shift operator defined in section 2 2 5 the dynamics 3 8 are written as follows dj tj bjdj 1 sj 1 b j 1 dj 1 1 j n 3 9 we denote by dk the vector with components dkj for j 1 n the dynamics 3 9 are then written as follows dk a dk 3 10 where a is the following max plus polynomial matrix a b 2 s 2 b 1 t 1 b 2 t 2 b 3 s 3 bj tj b j 1 sj 1 b 1 s 1 bntn theorem 3 1 the train dynamics 3 8 converges to a stable stationary regime with a unique average asymptotic growth vector whose components are all equal and are interpreted here as the asymptotic average train time headway h given as follows h max j tj m max j tj sj j sj n m figure 3 2 the graph g a proof the graph g a associated to the matrix a is strongly connected see figure 3 2 therefore by theorem 2 1 we know that the asymptotic average growth vector of the dy namic system 3 8 whose components hj are interpreted here as the asymptotic average time headway of the trains on segment j exists and that all its components are the same h hj limk d k j k j 1 n moreover h coincides with the unique generalized eigenvalue of a given by theorem 2 1 as the maximum cycle mean of the graph g a three different elementary cycles are distinguished in g a see figure 3 2 chapter 3 max plus model for the train dynamics 23 the hamiltonian cycle c in the direction of the train running with cycle mean w c d c j tj j bj j tj m all the cycles cj of two links relying nodes j 1 and j with cycle means w cj d cj tj sj bj b j tj sj j the hamiltonian cycle c in the reverse direction of the train running with cycle mean w c d c j sj j b j j sj n m an important remark on theorem 3 1 is that the asymptotic average train time headway depends on the average number of trains running on the metro line without depending on the initial departure times of the trains initial condition of the dynamic system 3 2 1 fundamental traffic diagram for train dynamics by similarity to the road traffic one can define what is called fundamental traffic diagram for the train dynamics in road traffic such diagrams give relationships between car flow and car density on a road section see for example 21 20 also extended to network or macroscopic fundamental diagrams see for example 15 16 17 22 18 103 let us first notice that the result given in theorem 3 1 can be written as follows h max hmin 1 1 3 11 where h is the asymptotic average train time headway and l m is the average train space headway j tj l 1 v is the inverse of the maximum train speed v hmin maxj hj maxj tj sj j sj l l n is the minimum train space headway relationship 3 11 gives the asymptotic average train time headway as a function of the average train space headway see figure 3 3 one can also write a relationship giving the average train time headway as a function of the average train density m l 1 see figure 3 3 h max hmin 3 12 where n l 1 is the maximum train density on the metro line chapter 3 max plus model for the train dynamics 24 let us know denote f 1 h the average train frequency or flow on the metro line then from 3 12 we obtain a trapezoidal fundamental traffic diagram well known in the road traffic for the metro line see figure 3 3 f min v fmax w 3 13 where fmax 1 hmin is the maximum train frequency over the metro line segments v 1 is the free or maximum train speed on the metro line w 1 is the backward wave speed for the train dynamics 1 relationships 3 11 3 12 and 3 13 show how the asymptotic average train time headway and the asymptotic average train frequency change in function of the number of trains running on the metro line moreover they give the maximum train capacity of the metro line expressed by the average train time headway or by the average train frequency as well as the corresponding optimal number of trains furthermore those relationships describe wholly the traffic phases of the train dynamics theorem 3 2 the asymptotic average dwell time w and safe separation time g are given as follows w max w hmin r g 3 14 g max w r hmin hmin g 3 15 where w j wj n r j rj n and g j gj n proof we have by 3 2 and 3 3 w t r m n h r then we replace h using 3 12 by 3 1 and 3 3 g r s r n m n h then we replace h using 3 12 or directly form 3 3 we have g h w then we replace h using 3 12 and w using 3 14 figure 3 3 illustrates the relationships 3 11 3 12 3 13 3 14 and 3 15 for a linear metro line of 9 stations 18 platforms inspired from the automated metro line 14 of paris 39 the parameters considered for the line are given in table 8 1 according to figure 3 3 the maximum average train frequency for the considered metro line is about 50 trains hour corresponding to an average time headway of 72 seconds the optimal number of running trains to reach the maximum frequency is 21 trains we note that time margins for robustness are not considered here formulas 3 14 and 3 15 are important for the control model we present in section 8 2 of chapter 8 where we consider w as the control vector and g as the traffic state vector and where the formulas 3 12 3 14 and 3 15 of the max plus traffic model are used 1 we use the notation w with a prime for the backward wave speed in order to distinguish it with dwell time notation w chapter 3 max plus model for the train dynamics 25 figure 3 3 analytical phase diagrams for the train dynamics in a linear metro line chapter 3 max plus model for the train dynamics 26 table 3 1 parameters of the metro line considered number of stations 9 18 platforms segment length about 200 meters m free train speed vrun 22 m s about 80 km h train speed on terminus 11 m s about 40 km h min dwell time w 20 seconds min safety time s 30 seconds inter station length in meters s laz mad 618 m mad pyr 712 m pyr cha 1359 m cha g lyo 2499 m g lyo ber 624 m ber c s emi 970 m c s emi bib 947 m bib oly 713 m 3 2 2 the traffic phases of the train dynamics theorems 3 1 and 3 2 and formulas 3 11 3 12 and 3 13 allow the description of the traffic phases of the train dynamics 3 8 three traffic phases are distinguished train free flow traffic phase 0 fmax v during this phase trains move freely on the line which operates under capacity with high average train time headways the average time headway is a sum of the average minimum train dwell time with the average train safe separation time the average train dwell time is independent of the number of running trains while the average train time headway as well as the average train safe separation time decrease rapidly with the number of running trains we notice that the average train frequency increases linearly with respect to the number of running trains similarly the average train time headway increases linearly with respect to the average space headway maximum train frequency traffic phase fmax v fmax w during this phase the metro line operates at its maximum train capacity the latter is constant i e independent of the number of running trains the average train dwell time w increases linearly with the number of the running trains the average train safe separation time g decreases linearly with the number of running trains the average train time headway h g w remains constant and independent of the number of running trains the optimum number of running trains on the line is attained at the beginning of the this traffic phase this optimum number is lfmax v corresponding to train density fmax v however in the case where passenger arrivals are taken into account it can be interesting to increase the number of running trains on the line indeed although the average train time headway remains constant during this phase the average train dwell time increases while the average train safe separation time decreases with the increasing of the number of trains running on the line this induces less average train safe separation time so less time for the accumulation of passengers on platforms in one side and more time to passengers to go onto the trains on the other side without affecting the average train time headway see figure 3 3 train congestion traffic phase fmax w during this phase trains interact with each other and the metro line operates under capacity with high average train time headways the latter is given as the sum of the average train dwell time with the average minimum safe separation time the latter is independent of the number of running trains while the average train time headways as well as the average train dwell times increase rapidly with the number of running trains on the metro line the average train frequency decreases linearly with the number of trains running on the metro line chapter 3 max plus model for the train dynamics 27 3 3 extension 1 train dynamics in a metro line with a junction the main reference of this section is 34 we presented above a max plus model for the train dynamics on a linear metro line without junction we present here an extension of that model to the train dynamics on a metro line with a junction we assume that the junction is symmetrically operating i e one train by two goes to the left right at the divergent and one train by two enters from the left right at the merge see figure 3 4 we extend the train dynamics by adding the description of the train movements at the divergent and at the merge of the junction we show that by means of a changing of variable the model can be still written linearly in the max plus algebra we derive analytically the traffic phases of the train dynamics where eight traffic phases are distinguished in this case we consider a metro line with one junction as in figure 3 4 the junction includes a diver gent where trains go from the central part of the line to the branches and a merge where trains go from the two branches to the central part of the line as above and as in 29 31 32 the line is discretized in a number of segments segments and nodes are indexed as in figure 3 4 we adapted the notations of section 3 2 as follows figure 3 4 a metro line with one junction chapter 3 max plus model for the train dynamics 28 u u 0 1 2 indexes the central part if u 0 the branch 1 if u 1 and the branch 2 if u 2 nu the number of platforms on part u of the line nu the number of segments on part u of the line j u the set of indexes on part u of the line j u 1 2 nu mu the number of trains being on the part u of the line at time zero b u j 0 1 it is 0 resp 1 if there is no train resp one train at segment j of part u b u j 1 b u j dk u j the kth departure time from node j on part u of the line notice that k do not index trains but count the number of train departures ak u j the kth arrival time to node j on part u of the line r u j the average running time of trains on segment j between nodes j 1 and j of part u wk u j dk u j ak u j the kth dwell time on node j on part u of the line tk u j r u j w k u j the kth travel time from node j 1 to node j on part u of the line gk u j ak u j dk 1 u j the kth safe separation time or close in time at node j on part u hk u j dk u j dk 1 u j gk u j wk 1 u j the kth departure time headway at node j on part u sk u j g k b u j u j r u j 3 3 1 the train dynamics besides the junction the train dynamics besides the junction are similar to the train dynamics in the case of a linear metro line without junction section 3 2 and remain linear in the max plus algebra dk u j d k b u j u j 1 t u j k 0 u u j 6 nu 3 16 dk u j d k b u j 1 u j 1 s u j 1 k 0 u u j 6 nu 3 17 3 3 2 train dynamics at the divergence we assume that odd departures go to branch 1 while even ones go to branch 2 the kth departures from the central part dk 0 n d k b 0 n 0 n 1 t 0 n k 0 3 18 dk 0 n d k 1 2 b 1 1 1 1 s 1 1 if k is odd d k 2 b 2 1 2 1 s 2 1 if k is even 3 19 the kth departures from the entry of branch 1 dk 1 1 d 2 k 1 b 1 1 0 n t 1 1 k 0 3 20 dk 1 1 d k b 1 2 1 2 s 1 2 k 0 3 21 chapter 3 max plus model for the train dynamics 29 the kth departures from the entry of branch 2 dk 2 1 d 2 k b 2 1 0 n t 2 1 k 0 3 22 dk 2 1 d k b 2 2 2 2 s 2 2 k 0 3 23 3 3 3 train dynamics at the merge we assume that odd departures at node 0 0 towards the central part correspond to trains coming from branch 1 while even ones correspond to trains coming from branch 2 the kth departures from the central part dk 0 0 d k 1 2 b 1 n 1 n 1 t 1 n if k is odd d k 2 b 2 n 2 n 1 t 2 n if k is even 3 24 dk 0 0 d k b 0 1 0 1 s 0 1 k 0 3 25 the kth departures from the entry of branch 1 dk 1 n 1 d k b 1 n 1 1 n 2 t 1 n 1 k 0 3 26 dk 1 n 1 d 2 k 1 b 1 n 0 0 s 1 n k 0 3 27 the kth departures from the entry of branch 2 dk 2 n 1 d k b 2 n 1 2 n 2 t 2 n 1 k 0 3 28 dk 2 n 1 d 2 k b 2 n 0 0 s 2 n k 0 3 29 we have shown that the train dynamics at the divergence as well as the ones at the merge can be rewritten linearly in the max plus algebra by means of a changing of variables see 34 for the details the whole dynamic system is then a max plus linear system as in section 3 2 we use the graphic approach to derive analytically the asymptotic average growth rate of the train dynamics which gives the average train time headway at the central part and at the two branches we have then obtained the traffic phases of the train dynamics on the metro line with a junction and by that we derive the effect of the junction on the physics of traffic see 34 for more details 3 4 the traffic phases the asymptotic average train time headway and frequency depend on the total number of trains and on the difference between the number of trains on the branches both parameters are time invariant with a time unit of two steps of the train dynamics indeed the differ ence in the number of trains between branches 2 and 1 is invariant in two steps of the train dynamics because we assume here that the junction is symmetrically operating i e one train by two goes to the left right at the divergent and one train by two enters from the left right at the merge let us consider the following additional notations chapter 3 max plus model for the train dynamics 30 mu the number of trains on part u of the line at time zero m m 0 m 1 m 2 the total number of trains on the line m m 2 m 1 the difference in the number of trains between branches 2 and 1 m u nu mu u 0 1 2 m m 0 m 1 m 2 m m 2 m 1 t u j t u j u 0 1 2 su j s u j u 0 1 2 the main results gives then the traffic phases of the train dynamics as follows theorem 3 3 34 the train dynamics admit a unique average growth rate which represents the average train time headway h 0 at the central part of the metro line moreover we have h 0 h 1 2 h 2 2 max hfw hmin hbw hbr with 2 hfw max t 0 t 1 m m t 0 t 2 m m hmin max maxu j t u j s u j u 0 maxu j t u j s u j 2 u 1 2 hbw max s 0 s 1 m m s 0 s 2 m m hbr max t 1 s 2 2 n 2 m s 1 t 2 2 n 1 m proof see 34 corollary 3 1 the average train frequency f 0 on the central part and f 1 f 2 on the branches are given as follows f 0 2 f 1 2 f 2 max 0 min 1 hfw 1 hmin 1 hbw 1 hbr proof directly from theorem 3 3 with f 0 1 h 0 and f 0 0 fig 3 2 illustrates the results of theorem 3 3 and corollary 3 1 we can clearly distinguish the eight traffic phases of the train dynamics for more details on the interpretation of those phase diagrams please see 34 and 35 2 fw forward bw backward min minimum br branches chapter 3 max plus model for the train dynamics 31 table 3 2 the asymptotic average train time headway h 0 and frequency f 0 as functions of the total number m of trains on the line and of the difference m of the number of trains on the two branches we recognize the eight traffic phases of theorem 3 3 and corollary 3 1 chapter 3 max plus model for the train dynamics 32 3 5 extension 2 train dynamics taking into account the travel demand the main reference of this part is 35 we propose in this part a second extension of the model 3 8 for the train dynamic modeling and control we present the model on a linear metro line without junction but it is still extensible to a metro line with a junction we consider the same train dynamics as in 3 8 but here the train dwell and run times are both controlled two control laws are associated to the train dwell and run times depending on the real time train dynamics and on the passenger arrival flow rates the idea here is to be able to extend train dwell times at platforms to respond to high levels of passenger travel demand and in counterpart to shorten the train run time on inter stations in order to compensate and avoid delays and their propagation we show that under given run time margins the train dynamics remain stable against small perturbations relatively to the given run time margins we show that in this case the train dynamics are still linear in the max plus algebra and the asymptotic average train time headway as derived analytically as a function of the number of running trains on the metro line and of the level of the passenger travel demand we use here the same notations as in section 3 2 for the train dynamics for the passenger travel demand we use the following additional notations ij passenger travel demand from platform i to platform j when i and j denote platforms and ij 0 if i or j is not a platform node ini j ij the average passenger arrival rate on origin platform i to any destination platform outj i ij the average passenger arrival rate on any origin platform to destination platform j inj average passenger upload rate on platform j outj average passenger download rate on platform j i ijhi out j time needed for passenger download at platform j inj hj in j time needed for passenger upload at platform j the time needed for passenger upload at platform j is inj hj in j the time needed for passenger download at platform j is i ijhi out j as in 35 we approximate it as follows outj hj out j i i jhi out j two passenger demand parameters xj and xj have been introduced in 35 xj outj outj inj inj 3 30 in such a way that xjhj gives the time needed for passenger download and upload at platform j xj xj 1 xj 3 31 in such a way that xjhj xjgj hj hj h j and gj gj g j and j chapter 3 max plus model for the train dynamics 33 3 5 1 the dwell time control law the dwell time model is the following wkj h k j xj min xjh k j w j 3 32 where the kth dwell time on platform j is the minimum of the needed time for passenger upload and download on the same platform and a maximum dwell time w j to avoid congestion behind a train stopping too long at a platform 3 5 2 the running time control law we propose the following running time law rkj h k j xj max rj r j xj hkj hj 3 33 where r j is the average nominal running time of trains on section j the model 3 33 gives the running time as the maximum between a given minimum running time rj and a term that subtracts xj hkj hj from the nominal running time the term xj hkj hj expresses a deviation of the upload and download time due to a deviation of the train time headway we notice here that the term xjhkj appearing in the dwell time law 3 32 with a sign appears in the running time law 3 33 with a sign the train travel time law is then obtained by summing the dwell time law 3 32 with the running time law 3 33 tkj xj r k j h k j xj w k j h k j xj 3 34 let us use the notations hj h j hj gj g j gj wj w j wj rj r j rj it is then easy to check the following wj xj hj xj gj j then we have the following result theorem 3 4 35 if h 1 j h j 1 1 xj g j j and rj wj xj gj j then the dynamic system 3 8 where the train dwell and run times are controlled as in 3 32 and 3 33 respectively is a max plus linear system and is equivalent to dkj max d k bj j 1 r j xjgj d k b j 1 j 1 sj 1 3 35 proof see 35 let us interpret the two conditions of theorem 3 4 condition h 1 j h j 1 1 xj g j j k limits the initial headway h 1 j i e the initial condition to its upper bound h j which is given by the level of the passenger travel demand xj at platform j and by the upper bound g j on the safe separation time at the same platform this condition tells that the perturbation of train dynamics at time zero is bounded condition rj wj xj gj j limits the margin on the train dwell times to the margin on the train running times this condition tells that every extension of the train dwell time at any platform due to the level of the passenger travel demand at this platform can be compensated by the available margin in train run time at this platform chapter 3 max plus model for the train dynamics 34 3 5 3 the traffic phases under the conditions of theorem 3 4 we have a max plus linear system from which we derive analytically the traffic phases of the train dynamics giving the average train time headway and frequency as functions of the number m of running trains and of the passenger travel demand level x or equivalently x this derivation is similar to the one done in section 3 2 of chapter 3 theorem 3 1 theorem 3 5 the average asymptotic train time headway of the linear max plus system with dynamic dwell and run times depending on the demand is given by the average asymptotic growth rate of the system the average headway depends on the number of trains m on the line and the passenger travel demand for every station xj h m x max j g min j xj r j m max j gminj xj r j sj j sj n m proof see 35 corollary 3 2 the average frequency of the linear max plus system with demand dependent dwell and run times is a function of the number of trains and the travel demand f m x max 0 min m j g min j xj r j 1 maxj g min j xj r j sj n m j sj proof directly from theorem 3 5 with f 1 h and f 0 figures of table 3 3 illustrate the results of theorem 3 5 and corollary 3 2 the parame ters of the metro line are from ratp paris 18 stations with the same passenger demand at all platforms for the interpretation of the traffic phases please see 35 chapter 3 max plus model for the train dynamics 35 table 3 3 average asymptotic train time headway h and frequency f as functions of the total number m of running trains and of the passenger travel demand level x or equivalently x three traffic phases are distinguished linear metro line parameters from ratp paris h m x h m x f m x f m x chapter 3 max plus model for the train dynamics 36 this page is intentionally left blank chapter 4 road network calculus the main references of this chapter are 95 96 we propose a traffic system theory for the calculus of performance bounds in road traffic networks the system theory is made in the min plus algebra of 2 2 matrices of functions 2 the performance bounds are derived basing on basic and extended results of the network calculus theory 74 75 71 72 the road traffic is modeled with the well known 1 st order model lwr lighthil whiteham and richards and following the well known cell transmission model scheme we first present the road section model which will be the basis of our modeling here we write the traffic dynamics on one road section under the cell transmission model with given traffic demand and supply we show that the dynamics can be written linearly in the min plus algebra of 2 2 matrices of functions we derive the impulse response of that system and show that the response can be interpreted as a service guarantee of the traffic system seen as a server second we define a concatenation operator of two road section systems and show that a road link of many sections can be built algebraically by concatenating elementary road section systems we also define a feedback operator for this traffic system theory and use it to model closed traffic systems finally we show how this theory can be extended to two dimensional road traffic we present the model of an urban junction controlled with a traffic light give some insights on other two dimensional traffic control models and on the highway traffic modeling and some directions for further extensions 4 1 complements network calculus for mimo systems we give in this section some complements on the multiple input multiple output mimo systems we are concerned here by the multi dimensional case where multiple inflows arrive to and depart from the system the particular signals e p and t defined in table 4 1 will be used here let us consider a mimo server with n cumulated arrival flows ui i 1 2 n and n cumulated departure flows yi i 1 2 n we recall here that maximum and minimum arrival curves i and i resp can be estimated from the flow ui as follows ui ui i 4 1 ui ui i 4 2 in a system where the service depend on multiple arrival flows it is not sufficient to upper bound each arrival separately but one needs also to bound the dependencies of the arrivals on each other in the following we show that the extension of the definition of arrival curves in the case of one arrival to arrival matrices of curves for the case of multiple arrivals includes 37 chapter 4 road network calculus 38 table 4 1 nomenclature u t inflow at time t u t cumulated inflow from time zero to time t y t outflow at time t y t cumulated outflow from time zero to time t maximum arrival curve time function minimum service curve time function f the set of non decreasing time functions f satisfying f t 0 t 0 element wise operation min plus addition in f f g t min f t g t min plus convolution in f f g t inf 0 s t f s g t s min plus deconvolution in f f g t sups 0 f t s f s max plus deconvolution in f f g t infs 0 f t s f s the zero element of the dioid f t t 0 e the unity element of the dioid f e t t 0 and e 0 0 fk convolution power fk f f f k times b t the backlog at time t b t u t y t d t the virtual delay at time t d t inf h 0 y t h u t p a particular function in f p t t 0 and p 0 p t a particular function in f t t 0 t t and t t t t f max 0 f r s affine maximum arrival curve r s t rt s r t rate latency minimum service curve r t t r t t q car flow qmax maximum car flow qi t car outflow from the ith section at time t qi t cumulated car outflow from the ith section from time zero to time t ni number of cars on the ith section at time zero nmax maximum number of cars that a section can contain average car density c critical car density j jam or maximum car density v free car speed w backward wave speed l road section length q the car flow function of the car density fundamental traffic diagram m the set of n m matrices with entries in f the zero element for m n n e the unity element for m n n ak power operation in m n n a sub additive closure in m n n such that a k 0 a k chapter 4 road network calculus 39 naturally the dependencies of the arrivals on each other let us first introduce a new notion of time shift arrival matrix which we will use to define an arrival matrix time shift arrival matrix for a system with n input and n output flows we need to estimate a matrix arrival which is a matrix of arrival curves such that ii 1 i n are nothing but maximum arrival curves for arrival flows ui 1 i n while ij i 6 j are curves that bound the deviations between each pair of arrival flows i j i 6 j for i 6 j the difference with respect to the case i j is that it is possible to have ui t uj s 0 even for t s indeed if we assume that ui t uj s 0 t s then we get ui s uj s 0 s 0 and similarly uj s ui s 0 s 0 therefore ui s uj s 0 s 0 it is trivial that such an assumption is very restrictive therefore if we like to upper bound ui t uj s for all s t 0 then we need to work with negative times for the arrival curves in order to keep working with non negative times we back shift the curves with negative times to zero to obtain such back shifted arrival matrices we first define what we call here time shift matrix t of non negative entries definition 4 1 time shift matrix the time shift matrix t rn n for arrival flows ui i 1 2 n is defined as follows tij sup t 0 inf s 0 ui t s uj t 0 i j it is easy to see that tii 0 i 1 2 n for two arrival flows ui and uj if we see ui as an output flow of uj then tij can be seen as the maximum virtual delay see definition of virtual delay in table 4 1 from that remark an easy way to estimate the matrix t is given b proposition 4 1 below proposition 4 1 if i and i are resp maximum and minimum arrival curves for ui i 1 2 n and if t is a time shift matrix for ui i 1 2 n then tij sup t 0 inf h 0 i t h j t 0 proof follows directly from the definitions of t and in order that both elements tij and tji of the shift matrix t be finite we need to guarantee that lim t ui t t lim t uj t t and lim t uj t t lim t ui t t hence we need that lim t ui t t lim t uj t t which means that the two flows have the same asymptotic average rate they are comparable in average definition 4 2 arrival matrix for a given n 1 vector u of cumulated arrival flows ui i 1 n a matrix fn n is said to be a maximum resp minimum arrival matrix for u if there exists a time shift matrix t for ui i 1 2 n such that i j 1 2 n s t n ui t uj s ij tij t s resp ui t uj s ij tij t s which can also be written i j 1 2 n ui tij ij uj resp ui tij ij uj chapter 4 road network calculus 40 let us notice that definition 4 2 is different form definition 4 2 1 given in 71 defini tion 4 2 is illustrated in example 4 1 below a procedure for estimating an arrival matrix for a cumulated inflow vector u from the data of u itself is the following 1 estimate maximum and minimum arrival curves for each arrival flow individually by the deconvolution i ii ui ui i i ii ui ui i 2 estimate a shift time matrix from those curves by maximum delay calculus as explained above in proposition 4 1 tij max t 0 min s 0 i t s j t 0 3 estimate non diagonal shift arrival curves by shift deconvolution from definition 4 2 ij satisfy ij tij ui uj it is easy to check that for i j we have tii 0 and then ii is a one dimensional arrival curve example 4 1 in figure 4 1 we show the four curves of an arrival matrix estimated as explained above for a vector of two signals u 1 and u 2 those signal are supposed given from time zero to time 300 the calculus of those curves is done as follows 11 1 u 1 u 1 22 2 u 2 u 2 t 12 maxt 0 min s 0 u 1 t s u 2 t 0 60 t 21 maxt 0 min s 0 u 2 t s u 1 t 0 8 12 t 12 u 1 u 2 21 t 21 u 2 u 1 let us now define the service for a mimo server we base here on an existing definition of service guarantee in multi dimensional case multiple input flows and multiple output flows given in 71 then by combining that definition with definition 4 2 given above we recalculate upper bounds for the virtual delays as well as other performance bounds definition 4 3 service matrix 71 for a given server with input vector u and output vector y a n n matrix is said to be a service matrix for the server if y u definition 4 4 virtual delay 71 for a given server with input vector u and output vector y the virtual delay of the last quantity arrived at time t from the ith input to depart from the ith output denoted di t is defined di t inf d 0 yi t d ui t the following result improves theorem 4 3 6 of 71 which derives upper bounds for the virtual delays through input output pairs chapter 4 road network calculus 41 figure 4 1 the four curves of the arrival matrix of a vector of two signals theorem 4 1 for a given server with input vector u and output vector y if is a shift arrival matrix with t a shift matrix for u and if is a service matrix for the server then i 1 2 n t n di t inf d 0 ij tij s ij s d tij s t j and then the virtual delays di i 1 n are bounded as follows i 1 2 n t n di t max 1 j n sup tij s t inf d 0 ij tij s ij s d or equivalently di t max 1 j n tij sup s 0 inf d 0 ij s ij s d proof the proof is an adaptation of the proof of theorem 4 3 6 in 71 in order to build the traffic system corresponding to a whole traffic network we base in elementary traffic systems which will be used as unit systems in the composition we consider here two elementary systems an uncontrolled and a controlled road sections the composition concatenation we use here are inspired from 14 see also 22 16 15 17 103 21 95 it consists in two operators a concatenation one and a feedback one more details are given in section 4 2 below 4 2 the road section model we give in this section the derivation of a service matrix for a road section traffic system the model gives the traffic dynamics on which this approach is based cell transmission model 55 and by that explain why the network calculus theory can be applied to road traffic networks in a stretch of road subdivided in n sections 1 2 i 1 i i 1 n we consider here one road section section i as the basic traffic system we denote by l the length of the road chapter 4 road network calculus 42 section cars arrive from the left side of the road section input flow pass through it and departs from the right side of it output flow the inputs ufw and ubw represent respectively the traffic demand from the upstream section i 1 to section i and the traffic supply of the downstream section i 1 to section i the outputs yfw and ybw represent respectively the traffic outflow from section i to the downstream section i 1 which is also the traffic demand of section i 1 and the traffic supply of section i to the upstream section i 1 see figure 4 2 figure 4 2 the traffic system of a road section let us clarify the notations ufw yfw ubw and ybw ufw t cumulated forward inflow of cars from time zero to time t yfw t cumulated forward outflow of cars from time zero to time t ubw t cumulated backward supply of section i 1 from time zero to time t ybw t cumulated backward supply of section i from time zero to time t a number of assumptions is considered here first we assume given an initial number n of cars on the road section a time zero second we suppose that cars pass through the road section under the fifo first in first out rule third we assume that the road section cannot contain more than nmax cars in a given time we denote by n nmax n the additional number of cars that the road section could contain at time zero the number n corresponds to the free spaces in the section at time zero in order to simplify the presentation of the ideas and without loss of generality we assume that all the cumulated flows are initialized to zero 1 ufw 0 yfw 0 ubw 0 ybw 0 0 4 3 figure 4 3 a trapezoidal fundamental diagram with j nmax l 1 qmax v 2 j qmax w q j 1 v 1 w c q v j q w 1 indeed we only need that ufw yfw and ubw ybw chapter 4 road network calculus 43 let us now write the traffic dynamics on the road section as in 20 we base on the cell transmission model 55 with a trapezoidal fundamental diagram see figure 4 2 v qmax and w denote here the free flow speed the capacity maximum flow and the backward wave speed for the road section we obtain the following dynamics where we introduce an intermediate variable q which is simply the cumulated forward outflow yfw q t min ufw t l v n q t l v qmaxl v ubw t 4 4 yfw t q t 4 5 ybw t q t l w n 4 6 we will see here the variables u y and q as time signals in the dio d f defined above where the addition of two signals is the point wise minimum and where the multiplica tion of two signals is the minimum convolution of the signals by using the min plus algebra notations see 20 2 we get q f 3 q f 1 ufw ubw 4 7 yfw q e 4 8 ybw f 2 q e 4 9 where f 1 n l v f 2 n l w and f 3 qmaxl v l v figure 4 4 diagram for the system 4 7 4 9 where we added min plus addition the unity vector e to yfw and to ybw in order to satisfy condition 4 3 then by denoting by u and y the two column vectors u ufw ubw and y yfw ybw we can write q aq bu y cq e 4 10 with a qmaxl v l v b denotes the line vector b n l v e c denotes the column vector c e n l w and with e denoting in 4 10 the column vector e e therefore the traffic dynamics on a road section may be represented with three matrices a signal a a line matrix b of two signals and a column matrix c of two signals in a such configuration b represents the action on the traffic demand of the section c gives action on the traffic supply that the section offers for an eventual upstream section while a models the outflow limit qmax imposed by the trapezoidal fundamental diagram from theorem 2 2 the maximum sub solution of 4 10 on the variable q is q a b u moreover we have q a b u therefore we obtain y c a b u e chapter 4 road network calculus 44 then since u 0 0 we have e u hence y c a b u u e c a b u 4 11 from 4 11 we obtain a bound for the impulse response of the min plus linear system 4 10 moreover the formula 4 11 tells that e c a b is a service matrix of the traffic system of one road section seen as a server see definition 4 3 theorem 4 2 a service matrix of the traffic system 4 4 4 6 is e c a b also written e qmaxl v l v n l v e n n l v l w n l w proof it follows directly from 4 11 corollary 4 1 the service matrix for the traffic system 4 10 satisfies 11 qmax l v n 12 qmax l v 21 qmax l v l w n n 22 qmax l w n proof it follows directly from theorem 4 2 we notice here that the n vehicles being on the road section at time zero are counted in the output flow yfw similarly the n free spaces available in the road section at time zero are counted in the backward output flow traffic supply flow ybw by consequent for the calculus of upper bounds travel times end to end delays unserved demand backlogs etc for the road section we have to consider augmented arrival flows ufw n and ubw n rather than ufw and ubw respectively therefore we need to calculate a matrix arrival for the vector ufw n ubw n of arrival flows we notice also that for the calculus of an upper bound for the delay travel time in case of a road traffic system for u without taking into account the n particles being in the system at time zero we need to take the maximum of the horizontal distances between the curves ij and ij by considering only the horizontal segments above n and above n moreover the upper bound on the backlog unsatisfied demand includes the initial n particles example 4 2 if we consider a road section of length l 200 m meters with fundamental diagram parameters v 28 m s about 100 km h w 7 m s about 25 km h j 1 10 veh m 100 veh km and qmax 0 5 veh s 1800 veh h and if we consider a time step dt 5 s and an initial number of vehicles in the road n 10 vehicles i e 1 20 veh m and thus n 10 since nmax 20 then 1 1 50 veh m and 2 1 35 veh m and the service matrix is bounded by corollary 4 1 as follows the time unity being a second 11 t 0 5 t 7 14 10 12 t 0 5 t 7 14 21 t 0 5 t 35 71 20 22 t 0 5 t 28 57 10 more precisely the curves of the service matrix of the road section are given by theorem 4 2 chapter 4 road network calculus 45 4 3 composition of 1 d traffic systems we propose here two operators for the connection of one dimensional road traffic systems traffic systems without junctions the first operator is for concatenating two road traffic systems of two input flows and two output flows the resulting traffic system has also two input and two output flows the concatenation operator permits to build more complicated systems than a road section such as a whole road of many sections the second operator is the feedback operator it permits to model closed traffic systems such as a circular or ring road 4 3 1 concatenation the composition of traffic systems is done in two dimensions since each system has two inputs and two outputs the connection is not in series in the sense that connecting two systems does not mean connect the outputs of one system to the inputs of the other indeed the connection is made here in the two directions by connecting an output of system 1 to an input of system 2 and an output of system 2 to an input of system 1 in figure 4 5 we illustrate the connection of two elementary systems road sections figure 4 5 composition of two min plus linear traffic systems let us consider two min plus linear traffic systems 1 and 2 with service curve matrices 1 and 2 we then have y i fw y i bw i 11 i 12 i 21 i 22 u i fw u i bw 4 12 the resulting system from the concatenation has two input signals u 1 fw and u 2 bw and two output signals y 2 fw and y 1 bw see figure 4 5 we have the following result theorem 4 3 a service matrix for the whole system is given by 11 2 11 1 11 2 11 1 12 2 21 1 12 2 21 1 11 12 2 11 1 12 2 21 1 12 2 22 2 12 21 1 21 1 22 2 21 1 12 2 21 1 11 22 1 22 2 21 1 12 2 22 such that y 2 fw y 1 bw 11 12 21 22 u 1 fw u 2 bw proof the proof is available in 95 as mentioned above the immediate example for the concatenation of road traffic systems is the construction of a whole road with a given number of sections eventually with different chapter 4 road network calculus 46 lengths and characteristics fundamental diagrams service matrices of the road sections can be fixed based on the characteristics of the sections and by means of theorem 4 2 and corollary 4 1 the concatenation permits us to have a service matrix for the whole road by means of theorem 4 3 it suffices then to upper bound the arrival flows of the system forward demand ufw and backward supply ubw by calculating an arrival matrix as explained above in section 4 1 to be able to derive deterministic upper bounds for the travel time through the road the unsatisfied traffic demand the maximum car density etc remark 4 1 an alternative way to build a road of many sections is to consider the whole dynamics of the road as done in section 4 2 dynamics 4 4 4 6 and derive the service matrix directly from the dynamics as done by theorem 4 2 4 3 2 feedback connection the objective here is to build closed traffic systems we define a feedback operator that permits to link the input flows or some of them of a given traffic system with its output flows or some of them one then obtain a closed traffic system such systems can be interesting for academic example analyses and for the derivation of qualitative characteristics without loss of generality we consider a traffic system with two inputs ufw and ubw and two outputs yfw and ybw we then consider the system where the outputs are backed to the inputs in such a way that in the new system the inputs are ufw yfw and ubw yww rather than ufw and ubw respectively see figure 4 6 figure 4 6 a feedback on a traffic system with two inputs and two outputs the traffic system is set in feedback as shown in figure 4 6 we assume given a service matrix for the initial open system we then have y u for the system set in feedback we have yfw 11 ufw yfw 12 ubw ybw ybw 21 ufw yfw 22 ubw ybw which we can simply write y y u then from theorem 2 2 we immediately get y u hence is a service matrix for the system set in feedback therefore we have the following result theorem 4 4 if is a service matrix for an open traffic system then is a service matrix for the system set in feedback proof follows directly from the arguments above 4 4 controlled 2 d traffic systems the calculus of guaranteed service on routes passing through intersections need to take into account the control set on every intersection in the communication network framework one chapter 4 road network calculus 47 calculates residual services for respective flows passing through data routers we focus here on the case of an intersection controlled with a traffic light set in an open loop in this case the control depends only on time and does not depend on the state of the traffic on the road entering or exiting the intersection one can calculate a service guarantee for every flow passing through the intersection independent of the other flows 4 4 1 the system of a road section controlled with a traffic light we consider here an urban road section controlled with a traffic light we denote by c the cycle time of the traffic light and by g and r the green and red times with c g r we only consider this road section but it is implicitly supposed that other road sections are controlled with the same traffic light in such a way that when the light is red for the considered road section it is green for the other traffic systems the traffic dynamics in the controlled road section is the following the same as 4 4 4 6 except the first equation 4 4 q t min ufw t l v r n q t l v g c qmaxl v ubw t 4 13 yfw t q t 4 14 ybw t q t l w n 4 15 the term ufw t l v n in 4 4 is time shifted by r in 4 13 the second term in 4 13 replaces the term q t l v qmaxl v in 4 4 with g c 1 the last term in 4 13 remains as in 4 4 cars arriving to the traffic light may have an additional delay upper bounded by r the dynamics 4 13 tell that the inflow to the traffic light passes through the light with a maximum time delay of r time units under the supply constraint downstream of the light and with a maximum flow of g c qmax theorem 4 5 a service matrix for the controlled road section is c a b with a g c qmaxl v l v b n l v r e proof same proof as the one of theorem 4 2 4 5 roads and itineraries in order to build a road of m sections we need to compose m elementary traffic systems of road sections the service matrix of each road section can be obtained by theorem 4 2 giving fundamental traffic diagrams on each section then the service matrix of the whole road is obtained by the composition of the road section systems and by applying theorem 4 3 a controlled road of m sections is obtained similarly by composing m 1 uncontrolled road sections with one controlled road section a route or an itinerary in a controlled road network is build by composing a number of controlled roads in figure 4 5 we illustrate the composition of controlled roads to obtain a traffic system associated to a whole road network the procedure of computing a service matrix for a traffic flow passing respectively through roads r 1 r 2 r 3 and r 4 is the following determine service matrices for all the uncontrolled sections of the itinerary by theo rem 4 2 chapter 4 road network calculus 48 r 1 r 2 r 3 r 4 length l meter 150 150 100 100 maximum flow qmax veh sec 0 32 0 35 0 4 0 38 initial car density n l veh meter 5 150 10 150 3 100 7 100 cycle time c sec 60 90 80 green time g sec 30 50 45 table 4 2 parameters of the numerical example determine service matrices for all the controlled sections of the itinerary by theorem 4 5 determine a service matrix for the itinerary by connecting the systems r 1 r 2 r 3 r 4 by theorem 4 3 figure 4 7 route traffic system once a service matrix is determined for a given traffic system and having an arrival matrix expressing the traffic demand arriving to the system and the traffic supply that backwards to it it suffices to apply theorem 4 1 to obtain upper bounds for the travel time for an input output couple of the traffic system the results of this example are shown in figure 4 8 the input signals ufw arriving to road 1 and ubw backing from road 4 are taken such that the arrival flows do not exceed the service offered by the whole route the arrival curves of the arrival matrix are computed fol lowing definition 4 2 first the shift times t 12 60 s and t 21 8 s are computed then the curves are deduced by definition 4 2 the service curves are computed following the steps cited above in this section an upper bound for the travel time through the route is then calculated according to theorem 4 1 we are concerned here by the delay d 1 corresponding to the forward travel time the delay d 2 corresponds to the backward travel time of the backward waves we obtained for this example the following result d 1 max d 11 d 12 max 205 241 241 seconds 4 6 possible extensions and limits numerous extensions of this approach are possible we enumerate below some of them by extending the approach to intersections controlled by traffic lights where the decision depends on the feedback of the state of the traffic one may derive performance bounds corresponding to given control strategies at intersections different control strategies for urban traffic can be studied extension to controlled network is then straightforward chapter 4 road network calculus 49 figure 4 8 arrival curves of the arrival matrix service curves of the service matrix and time delays extension to the case of intersections managed by priority rules can also be considered extension to roundabouts extension to highway merge and divergent extension to highway traffic control ramp metering extension to stochastic guarantees by applying stochastic network calculus finally let us mention one of the main limits of this approach and of the applications of network calculus in general in case where cyclic dependencies of the different considered flows the unique existing way to derive the residuated service curves is to solve implicit systems deduced from all the dependencies of the different flows it is known that this way is not optimal and the obtained bounds are in general not tight see 71 for example chapter 4 road network calculus 50 this page is intentionally left blank chapter 5 summary of my other contributions on the deterministic traffic modeling and control this chapter summarizes some of my other contributions on the deterministic traffic modeling and control four contributions are summarized first we summarize a work on the network calculus theory where we proposed a new concept of packet curves which permits to take into account the variance in packet sizes of arrival flows to given servers the existing classical approach takes into account only the maximum packet size for each arrival flows which is very pessimistic the approach we propose here consists in associating to arrival flows curves giving for an amount of data the minimum number of packets this approach follows the same philosophy as the one used for upper bounding arrival flows and adapts it to the number of packets ot equivalently to their sizes the main references of this part are 81 91 92 second we present briefly a new semi decentralized approach for urban traffic control which we proposed in 2015 we have based on a the centralized control strategy tuc traffic urban control 76 and introduced a new time interval within the time cycle whose length is controlled by central level and during which the traffic is locally controlled we have shown that the traffic management in urban networks can be improved by this kind of semi decentralized controls indeed in free flow traffic conditions where the intersections operate under capacity it is possible to set off the traffic lights and alternate a priority rule at the intersection our results are confirmed by means of numeric simulation using the traffic simulator sumo the main reference of this part is 79 third we summarize a work done in collaboration with mrs souaad lahlah from university of bejaja algeria where we proposed a new approach for optimal path selection for vanets it is new proactive protocol where the selection of optimal paths is based on two criteria the distance and the car density the latter is estimated basing on estimations of the car speed on the links of the network and using given fundamental diagrams for the links the performance of the proposed protocol are assessed by numerical simulation using the vehicular traffic simulator sumo combined with the communication simulator ns 2 the new proposed protocol has been compared to existing protocols the main reference of this part is 102 fourth we give some details on a first algorithm we developed for urban traffic control including v 2 i vehicle to infrastructure communications we have assessed the algorithm with the open source tool veins which combines the vehicular traffic simulator sumo with the communication simulator omnet we present here briefly the algorithm and evaluate its performances in term of vehicular traffic and in term of communications the main reference of this part is 80 51 chapter 5 summary of my other contributions 52 5 1 packet curves in network calculus the main references of this part are 81 91 92 we proposed in this work a new notion of packet curve for data packetization in the theory of network calculus packet curves permit to optimize the utilization of all available information of the packet characteristics in com munication networks moreover the definition of packet curves we made here allows us to efficiently improve the derivation and the tightness of performance bounds in such networks this is useful in particular in the case where we have aggregation of flows packet based ser vice policies and shared buffers we illustrate this new notion by a model of wormhole switch and show how our results can be used to get efficient delay bounds we give here the main definitions and results without any proof all the details and proofs can be found in 91 92 let us consider an arrival flow a for a given server s where a t denotes the cumulative arrival data from time zero to time t we denote by b the departure flow in such a way that b t gives the cumulative departure data from the server from time zero to time t we assume that the data arrive in packets of different sizes definition 5 1 a packet operator p r n gives for any amount x r of data the number of entire packets in x for example the application of the packet operator p to an arrival flow data a t at time t gives the number of entire packets of a arrived from time zero to time t therefore p transforms an arrival flow a to a packet flow p where p t p a t the packet flow p may not be perfectly known but some information about it may be available more precise than only the minimum and maximum packet length respectively de noted by lmin and lmax example 5 1 let us for example consider a flow with packets of sizes 1 and 2 we may have more information than only the minimum and maximum length sizes 1 and 2 for example we may know that in three successive packets there are at least one packet of size 1 and at least one packet on size 2 in order to take into account such additional information we introduce here the notion of packet curve of a packet operator definition 5 2 a curve resp is a minimum resp maximum packet curve for p if 0 x y p y p x y x resp p y p x y x for the case considered in example 5 1 one can take as a minimum packet curve the curve x 7 3 5 x 2 3 and as a maximum packet curve the curve x 7 3 4 x 3 2 where x max 0 x stair case functions can be more accurate but rate latency functions and affine functions are easier to handle from an computational viewpoint note that if is defined as x 7 x then lmax and 1 lmax and if is defined as x 7 v ux then v 1 lmin and v 1 chapter 5 summary of my other contributions 53 main properties the following result gives some properties derived directly from the definitions above proposition 5 1 let us consider arrival flows a 1 and a 2 to a given server with associated departure flows b 1 and b 2 respectively and with packet operators p 1 and p 2 respectively we denote a a 1 a 2 and b b 1 b 2 we consider also a packet operator p for a if 1 and 2 are maximum arrival curves for a a 1 and a 2 respectively if 1 and 2 are minimum and 1 2 are maximum packet curves for p p 1 and pi 2 respectively and if is a minimum strict service curve for the server then we have the following 1 and are maximal and minimal packet curves for b 2 is an arrival curve for the packet flow p p a 3 is a minimum strict service curve for p 4 if is a minimum simple resp strict service curve for packet flow p then 1 b c resp 1 d e is a minimum simple resp strict service curve for p 1 p a 5 1 2 is a minimum packet curve for the blind aggregation of a 1 and a 2 proof see 91 examples of modeling network elements a superposition of periodic flows theorem 5 1 superposition of periodic flows for periodic arrival flows a 1 a 2 an such that flow ai includes packets of size si arriving with period ti for 1 i n the total flow a iai where ai are aggregated in fifo admits minimum and maximum packet curves and given as follows x n i 1 x ti j j n i 1 j tj j ti j j x n i 1 x ti j j n i 1 j tj j ti j j where i si ti i 1 2 n the rates of the two curves x and x are equal therefore and are optimal by consequent is better than 1 2 n proof see 91 b non preemptive service curves let us now show how one can derive non preemptive service curves by using this new notion of packet curve figure 5 1 gives the general scheme of computation using the basic properties of packet curves we notice that this scheme is more efficient than the classical one taking into account the minimum and maximum packet sizes only when the service policy is based on counting packets we illustrate here with an example of the round robin routing policy we consider two flows arriving to a server operating under the round robin policy we are interested here in the calculus of the residual service curve for flow 1 we present here the derivation of a service curve for flow 1 with three different methods chapter 5 summary of my other contributions 54 figure 5 1 non preemptive service calculus scheme classical method c t lmin 1 nlmax 1 lmax 2 scheme method s t 1 1 1 n 1 2 1 ad hoc method ah t id 12 1 1 1 lmax 2 example 5 2 with lmin 1 lmax 2 1 2 1 2 and t 10 t we have c t 2 5 t 0 8 s t 4 t 0 97 ah t 4 44 t 0 68 the residual service rate using the scheme method is much better than the one obtained by the classical method the ad hoc method is the best one c shared queues let a 1 and a 2 be two arrival packeted flows to a given server the latter serves the flows packet by packet picking a packet from flow a 1 or flow a 2 respecting fifo service without preemption we assume that when the service of a packet from a given flow finishes then if the next one is from a different flow then the service is re initiated as if the switching time is the beginning of a backlogged period by that we can consider that the servers provide a different service for flows a 1 and a 2 packets of flow a 1 have a strict minimum service curve 1 and packets of flow a 2 have a strict minimum service curve 2 then we have the following result theorem 5 2 shared queues considering only the periods of time when server 1 is active and server 2 is idle 1 is a service curve for flow 1 with 11 x b 1 x c 1 1 11 b 1 x c 11 11 0 chapter 5 summary of my other contributions 55 figure 5 2 shared queues the two servers cannot be active at the same time proof see 91 then an overall service curve for the shared queue is 1 2 even though the curve given by theorem 5 2 is rather pessimistic it gives the key idea to find better service curves that is for each flow compressing time when the server of interest is idle then by bounding the number of idle periods and the lengths of those idle periods we improve the curve this is possible because minimal and maximal packet curves are known application to illustrate the results presented above we give here an application to performance evaluation on a 2 2 switch see fig 5 3 we assume that the input ports of the switch serve the arrival flows under fifo policy while the output ports serve them under packetized round robin rr policy with fixed service rate figure 5 3 a 2 2 switch we propose the following steps for the calculus of service curves for the aggregate as well as the residuated flows considered here the service curves can then be used for example to upper bound the delays of serving different flows the steps are the following 1 compute individual service curves for the output ports rr 2 compute a service curve for the shared queues packetized fifo 3 use the derived service curves to calculate maximum arrival curves for bij 4 go to step 1 and iterate using the additional knowledge obtained chapter 5 summary of my other contributions 56 5 2 semi decentralized urban traffic control we summarize here the semi decentralized approach we proposed in 79 for urban traffic con trol we based on the tuc traffic responsive urban control strategy 76 78 77 where antagonistic stages alternate the pass of way during a fixed or controlled cycle time and we introduce a new contention time window inside the cycle time where antagonistic stages can alternate a priority rule the priority rule gives green color to given stages priority and yellow color for other antagonistic stages no priority by introducing this new time widow inside the cycle time we reduce the red color and by that increase the capacity of the network junctions such priority rule should be realizable by considering possible vehicle to vehicle v 2 v communications where the vehicles entering to a junction from priority approaches can pass the junction without decelerating while the ones entering from non priority approaches decelerate and yield the way we propose a linear quadratic model for the dynamics and the control of such a system with an illustration on a small grid network where the traffic is simulated with the traffic simulator sumo simulation of urban mobility we compare our approach with the classical tuc strategy let us consider the following notations c cycle time duration in seconds k discrete time index corresponding to a duration of kc sec xi k number of cars on link i at discrete time k x i constant nominal number of cars on link i xi k xi k x i si saturation flow on link i gi k green time duration for link i during the kth cycle g i constant nominal green time duration for the stream coming from link i gi k gi k g i ui k gi k c si average outflow from link i during the kth cycle di k arrival demand flow to link i at discrete time k ij turning movement ratio from link i to link j we recall below the principle of store and forward control strategies like tuc the number of cars on link i is updated as follows xi k 1 xi k di k j jisjgj k sigi k 5 1 where j indexes here the upstream links of link i by introducing the nominal amounts and by using vectorial notations we get x k 1 x k b g k 5 2 where b is a matrix built basing on the dynamics 5 1 written on the whole network and where the variations of the arrival demand flows on every link inside the cycle time are assumed to sum to zero bounds for minimum green times and maximum storage capacity of links have also to be considered the criterion is the following where is a discount factor and where an infinite time horizon is considered j min g 1 2 k 0 1 1 k x k 2 q g k 2 r 5 3 q and r are non negative definite diagonal weighting matrices the first term on 5 3 aims to minimize the risk of over saturation and the spill back of link queues while the second term is used to influence the magnitude of the control chapter 5 summary of my other contributions 57 semi decentralization we propose here to divide the red color time into two time periods red and yellow figure 5 4 at intersection a we note g green r red y yellow by considering yellow time durations we need to choose three independent control vari ables among six variables see figure 5 4 according to figure 5 4 we can for example consider the following three independent control variables g 2 k green time duration for link 2 y 2 k yellow time duration for link 2 y 3 k yellow time duration for link 3 the other three dependent control variables are given as follows see figure 5 4 r 2 k c g 2 k y 2 k red time duration for link 2 r 3 k g 2 k y 3 k red time duration for link 3 g 3 k c g 2 k green time duration for link 3 the dynamics let us consider the following additional notations qmaxj capacity maximum flow of junction j qij k total flow going from link i to link j during the kth cycle qouti total flow exiting from link i during the kth cycle j friction coefficient on junction j with 0 1 we write the traffic dynamics on link 1 of figure 5 4 with the new control model x 1 k 1 x 1 k d 1 k q 21 k q 31 k qout 1 k where q 21 k q 31 k and qout 1 k are given in 5 4 5 6 and where we introduce a new parameter j for junction j which we call a friction coefficient and which expresses the interaction between vehicles entering into a junction from antagonistic stages during the con tention time window for example in 5 4 the flows of vehicles going from link 2 to link 1 during different time durations of the kth cycle are given as follows during r 3 k g 2 k y 3 k the flow is 21 s 2 g 2 k y 3 k as usual chapter 5 summary of my other contributions 58 figure 5 5 the state of the traffic at the end of simulation the colors of vehicles correspond to their speed green high speed red low speed on the left side centralized tuc on the right side semi centralized tuc during y 3 k the flow is 21 s 2 y 3 k as usual but multiplied by the friction coefficient a between the streams coming from link 2 with green time and link 3 with yellow time since the local control is activated with a priority rule setting link 2 has priority over link 3 during this time period during r 2 k the flow is zero during y 2 k the stream coming from link 3 has priority over the one coming from link 2 therefore the whole junction capacity qmaxa y 2 k is used by the stream of link 3 and the remaining capacity qmaxa y 2 k s 3 y 2 k is used by link 2 this flow is also multiplied by the coefficient friction a since the two streams pass through junction a during the same time period q 21 k 21 s 2 g 2 k y 3 k a 21 s 2 y 3 k a qmaxa y 2 k s 3 y 2 k 5 4 q 31 k 31 s 3 c g 2 k y 2 k a 31 s 3 y 2 k a qmaxa y 3 k s 2 y 3 k 5 5 qout 1 k s 1 g 1 k y 6 k bs 1 y 6 k b q max b y 1 k s 6 y 1 k 5 6 the dynamics 5 4 5 6 are still linear on the variables xi gi and yi we notice here that the dynamics are written on the independent controls as in the classical tuc model we consider nominal demands d i nominal numbers of cars x i and nominal independent controls g i and y i the choices of x and g can be done by the same way as in the classical tuc model one way to choose y is to take y i c g i this is equivalent to fix the nominal red time to zero this choice can also be dependent on the junction design then we can easily derive a linear dynamics similar to 5 2 the criterion 5 3 is written with the new independent control variables gi we obtain a linear quadratic problem the optimal control is derived by solving a riccati equation as in the classical tuc model numerical results in this section we apply the control model presented above on a small grid network of fig 5 5 we consider here a cycle time of 60 seconds at all the junctions we use the traffic simulator sumo for the traffic simulation with the interface traci for the implementation of the control for more details on the implementation please refer to 79 we present the results in fig 5 5 and fig 5 6 chapter 5 summary of my other contributions 59 on the left side of fig 5 6 we compare the classical tuc control with the our control model with different values of the parameter the comparison is made basing on three criterion the number of running cars in the network the number of ended served cars and the mean travel time we see clearly that our control improves the whole capacity of the network on the right side of fig 5 6 we give the average number of vehicles in the network first row the control in term of durations of the green yellow and red times for the approaches coming from the left side of the circuit junctions second row and form right side of the circuit junctions third row an important result here is that the yellow time is almost fully used i e the red time is almost zero in the case of free traffic flow while the red time appears with important values in case of congestion this result is very important because it confirms the importance of the fact that the activation as well as the duration of the local control the contention time window with yellow times are both controlled by the centralized control which optimizes them in function of the state of the traffic in the network figure 5 6 left side comparison of the classical tuc with the semi decentralized tuc in terms of the number of running vehicles on the network the flow of ended vehicles and the average travel time through the network respectively right side the control in terms of the traffic light times into the cycle time chapter 5 summary of my other contributions 60 5 3 optimal path selection for vehicular ad hoc networks the main reference of this section is 102 we present here a work we have done in collabo ration with mrs souaad lahlah 1 a phd student from the university of bejaia algeria and with her colleagues from the same university we proposed a proactive optimal path selection with coordinator agents assisted routing pscar protocol for vehicular ad hoc networks vanets in an urban environment we consider static nodes as coordinator agents at every intersection of the urban road network all the paths from any coordinator agent to another coordinator agent are known from all the agents since they are static therefore the problem of seeking an optimal path to a given destination node is reduced to search an optimal path to the coordinator agent which is the nearest one to the destination node in such a way that we anticipate the movements of the destination two criteria are used to select the optimal path the distance and the car density on the path the latter is estimated from the car speeds on the links of the path and from given fundamental traffic diagrams on the links we used ns 2 network simulator 2 for the evaluation of the communication performances of pscar and we based on sumo simulation of urban mobility for the road traffic simulation we compare pscar with existing solutions in term of packet delivery ratio end to end delay and network overhead description of pscar we assume that the cars are equipped with gps vehicles periodically broadcast to their neighbors hello beacon packets reporting their position coordinates and eventually other in formation such as speed acceleration etc the nodes build and update neighbor cards basing on all the received hello bacon packets on the other side each coordinator agent a static node deployed at an intersection broadcasts periodically a beacon message to announce its presence to its neighbors vehicles or other coordinator agents each coordinator agent maintains a path table with all the possible paths toward any other coordinator agent op timal paths are selected by the proposed proactive optimal path selection process and they are updated periodically depending on the variation of the car density in the road network the proactive optimal path selection process the proactive optimal path selection process includes three selections to forward a data packet 1 from a forwarder node to a coordinator agent 2 from the first coordinator agent to the last coordinator agent in this step we select the shortest path in which the vehicular traffic is estimated basing on a car density estimation on the links see below and which is sufficiently connected to route the data packets to the destination 3 from the last coordinator agent to the destination node local optimal and solutions in the optimal path selection process based on the proposed traffic density estimation ap proach a local optimum can be reached instead of a global one for such cases we propose a recovery strategy which reroutes the data packet to the desired destination two cases are distinguished here 1 mmrs souaad lahlah has passed two short time visitor internships at the grettia laboratory during the preparation of her phd thesis chapter 5 summary of my other contributions 61 figure 5 7 optimal path selection from a forwarder node to a coordinator agent the source node may not be able to route data packets to the elected coordinator agent because no sufficiently dense path exists from the source node to the coordinator agent in this case the data packets are carrying by the source node until such a path exists the same situation can be presented at an intermediate node in this case we also consider the possibility that the last visited coordinator agent selects a new path to the destination node path update based on the car density estimation approach we propose here an approach for the estimation of the car density of every link of the road network this estimation is used for the calculus of optimum routing paths of data packets in the road network the approach assumes known a fundamental traffic diagram giving the car speed in function of the car density for every link the coordinator agent at the initial extremity of a link estimates the average car speed on link by retrieving all the current car speeds on it and by that deduces the average car density on the link by means of the fundamental diagram of traffic associated to the considered link figure 5 8 shows an example of a fundamental traffic diagram considered here v d min vmax vmax dmax dcr dmax d 5 7 v vmax d dcr and dmax denote the average car speed the maximum car speed the average car density the critical car density and the maximum car density respectively on the considered link performance evaluations the protocol pscar proposed here is evaluated by simulation and is compared to existing ones such as gpcr lochert et al 2005 60 and a star seet et al 2004 61 simulations are performed here by using ns 2 for the simulation of communications and sumo for the simulation of mobility we base our evaluations and comparisons on three main criteria chapter 5 summary of my other contributions 62 figure 5 8 fundamental diagram of vehicular traffic packet delivery ratio the fraction of the data packets successfully delivered to their destination vehicles end to end delay the average time that a packet takes to traverse the network from the source to the destination and network overhead the total bytes transmitted during the simulation including beaconing messages data packets data packets generated during the broadcast mechanism etc figure 5 9 left side packet delivery ratio over number of vehicles right side end to end delay over number of vehicles figure 5 9 compares pscar with gpcr and a star basing on two criteria the packet delivery ratio left side and the end to end delay right side given in function of the number of vehicles in the network car density from the left side of figure 5 9 we see that pscar outperforms gpcr and a star in term of packet delivery ration the latter is 28 respec tively 98 higher with pscar than with the maximum over gpcr and a star for low respectively high car densities on the right side of figure 5 9 we show that in term of end to end delay pscar outperforms both gcpr and a star for high car densities while it is outperformed by a star in low densities indeed when a local optimal occurs pscar uses the carry and forward strategy to permit to a coordinator agent to choose another path this explains its high end to end delay at low densities on figure 5 10 pscar is compared to gpcr and a star in term of network overhead the number of beaconing messages generated during the construction of the neighborhood tables the figure shows that while pscar outperforms gpcr for all the car densities it is outperformed by a star for all the car density we consider that higher network overhead obtained here for pscar compared to a star is a kind of price to pay for its good perfor chapter 5 summary of my other contributions 63 figure 5 10 overhead over number of vehicles mances in term of packet delivery ration and end to end delays moreover we consider that the network overhead performed by pscar is acceptable conclusions and perspectives we proposed in this section a new position based routing protocol for vanets called proactive optimal path selection with coordinator agent assisted routing pscar pscar intro duces a novel car density estimation approach on the links of the road network which permits to assess link connectivity in the network although the car density estimation generates addi tional network overhead pscar permits better performances in term of packet delivery ration and end to end delay compared to existing protocols such as gpcr and a star our per spectives in this direction of research is to improve the beaconing phase perform simulations with realistic street maps using for example tiger database chapter 5 summary of my other contributions 64 5 4 simulation of cooperative its in urban networks the main reference of this section is 80 we summarize here an algorithm we proposed in 80 for urban traffic control including vehicle to infrastructure v 2 i communications us ing wave ieee 802 11 p protocol both vehicles and traffic lights may be equipped with communication devices we assume mixed traffic with equipped and unequipped vehicles as well as mixed infrastructure with equipped and unequipped traffic lights the algorithm is first illustrated on an equipped junction before extending it to a network with equipped and unequipped junctions we used here the open source tool veins 99 which couples the urban traffic simulator sumo 100 with the communication simulator omnet 101 we notice that we have modified veins in order to include tcp ip support over ieee 802 11 p the algorithm uses the information transmitted by equipped cars to equipped junctions on their positions and speeds in order to improve the split time of the equipped traffic lights we have chosen here to keep using traffic lights in order to guarantee the traffic safety the main idea of the algorithm is to alternate the green light over the approaches of the equipped junction but in the case where no equipped vehicle is manifested from a fixed distance on the approach with green light and where at least one equipped vehicle is connected to the traffic light at a short distance on the approach with red light the light switches for a short time and the test is repeated by that we ensure that with zero equipped vehicles we alternate the green light as usual while with a considerable rate of equipped vehicles we may improve the traffic we show that the gain in road traffic performance is significant especially in the case with high penetration rates for equipped vehicles and junctions the algorithm we consider the communication protocol is ieee 802 11 p coupled with the internet protocol version 4 ipv 4 and the transmission control protocol tcp we assume that equipped junctions and cars are able to use those communication capabilities moreover we suppose that equipped cars are also able to localize themselves for example with gps modules let us present our new algorithm for urban traffic control at an equipped junction the algorithm includes three main steps building a map electing a vehicle and actuating the traffic light signal build a dynamic map an equipped junction builds a map of the connected vehicles coming and leaving the junction similarly an equipped vehicle builds a map of the equipped junctions approaching or leaving it in its communication range the built maps are dynamic and are updated periodically each time a message is received for the equipped junction and triggered on timer for the equipped vehicles vehicle election an equipped junction elects periodically the lead vehicles on the ap proaching edges for simplicity and without loss of generality we assume that the junctions have only two incoming edges with one lane each the two incoming edges alternate priority of passing through the junction every c 2 time units where c is the cycle time of the traffic light at most one vehicle among lead vehicles from incoming edges is elected with algorithm 1 below if the latter does not succeed to elect a vehicle it tries again after a given time interval traffic light actuation the elected equipped vehicle sends a message to the equipped junction with its established tcp connection and sets the traffic light to green color for the edge on which it is moving a minimum duration for a given traffic light state is considered during which the traffic light state has to remain unchanged to ensure stability a maximum duration is also considered during which if no traffic light state switch has occurred then the state of the traffic light is automatically changed this permits to avoid blockages we give below some properties of the proposed algorithm chapter 5 summary of my other contributions 65 algorithm 1 vehicle election 1 function elect p v dp dv dmin input p is the identifier of the lead vehicle on the prioritized edge and it is none if no vehicle is detected on the prioritized edge v is the identifier of the lead vehicle on the non prioritized edge and it is none if no vehicle is detected on the non prioritized edge dp represents the distance p is to the junction in case p 6 none dv represents the distance v is to the junction in case v 6 none dmin 0 is the minimum distance to consider a vehicle close to the junction 1 is a coefficient to weight the minimum distance output p or v 2 if p 6 none and v 6 none and dp dmin and dv dmin or p none and v 6 none and dv dmin then 3 elected v 4 else 5 elected p 6 return elected the algorithm assures safety since it works with traffic lights which never give green light to antagonistic stages it is not necessary for a vehicle to be equipped to pass through a junction equipped vehicles are better served and equipped junctions are better managed in case of unequipped junctions and in case of equipped junctions with no equipped vehicles the algorithm is equivalent to an open loop control simulation results we present statistical results of some runs with different seeds first on an equipped junction and then on a small grid network of equipped and unequipped junctions for the scenario of one junction we assume a junction of two incoming links with one lane each the traffic demand is varied as well as the ratio of equipped vehicles we simulate the vehicular traffic as well as the communications for 600 seconds the criteria we used here for performance evaluation of the communication are tcp data divided by simulation time mean tcp end to end delay and mean tcp throughput on road side unit the results are given on the first column of tab 5 1 from table 5 1 we see that the amount of tcp application data sent by the nodes increases as the mean vehicle speed decreases we ca interpret this observation by the fact that as the mean vehicle speed is low the communicating vehicles remain connected longer and then they send more messages we can also see that the mean tcp end to end delay can be as high as 0 8 s when vehicle speed is low about 8 m s finally the throughput on rsu is increasing linearly with the number of communicating vehicles the criteria used for the vehicular traffic are the ratio of the ended vehicles by the inserted vehicles and the mean travel time the results are given on the second column of tab 5 1 chapter 5 summary of my other contributions 66 table 5 1 results of simulation on one equipped junction chapter 5 summary of my other contributions 67 we see on table 5 1 that the ratio of the ended vehicles by the inserted vehicles increases when the demand decrease and when the ratio of equipped vehicles increases for a fixed demand the mean travel time decreases as the number of equipped vehicles increases for the actuator we define the mean action interval as the mean time interval between two consecutive changes of traffic lights state we observe on table 5 1 that the traffic light state is stable with a high traffic demand and a high equipped vehicle penetration rate while for a low demand and a high equipped vehicle penetration rate the control is more reactive for the results on a small grid network we consider a network of 4 horizontal and 4 vertical one lane roads crossing at 16 junctions the direction of the traffic on the horizontal and on the vertical roads is alternated from one road to another first road traffic goes from east north to west south second road from west south to east north and so on the results of simulation on the grid network are given in table 5 2 where we compare our algorithm with an open loop fixed cycle traffic light program we notice that the open loop control case can also be realized by fixing the rate of equipped vehicles to zero we see from table 5 2 that with 100 of equipped junction and 80 of equipped vehicles the gain of our algorithm in terms of ended vehicles resp running vehicles and mean travel time can exceed 35 resp 45 and 35 a particular case is observed here for 20 of equipped vehicles combined with 100 of equipped junctions where the algorithm seems to be non efficient we think that the small rate of equipped vehicles disturbs the control algorithm at every junction and then deteriorates the traffic table 5 2 the results of simulation on the grid network equipped junctions ended penetration rate 0 20 50 80 25 1373 19 1470 33 1507 18 1484 19 0 0 7 1 2 5 9 8 2 4 8 1 1 9 50 1373 19 1499 49 1583 19 1571 20 0 0 9 2 3 4 15 3 1 9 14 5 2 3 100 1373 19 1281 151 1805 49 1877 29 0 0 6 7 11 2 31 5 4 1 36 7 2 8 equipped junctions running penetration rate 0 20 50 80 25 954 16 842 32 817 18 848 21 0 0 11 8 3 5 14 4 2 7 11 2 2 4 50 954 16 835 36 764 17 778 21 0 0 12 4 3 8 19 9 2 1 18 4 2 5 100 954 16 962 80 583 43 517 27 0 0 0 9 8 7 38 9 4 7 45 8 2 9 equipped junctions mtt s penetration rate 0 20 50 80 25 413 9 1 8 381 9 4 3 376 0 3 1 380 0 3 4 0 0 7 7 1 1 9 2 0 8 8 2 0 9 50 413 9 1 8 381 8 15 2 355 6 5 0 354 9 4 5 0 0 7 8 3 8 14 1 1 5 14 2 1 2 100 413 9 1 8 399 6 30 6 302 0 6 9 281 2 4 6 0 0 3 4 7 4 27 0 1 7 32 1 1 2 chapter 5 summary of my other contributions 68 this page is intentionally left blank part ii stochastic dynamic programming based modeling 69 70 we present in this part our works related to the traffic modeling and control in trans portation networks based on stochastic dynamic programming systems the traffic models we present here are mainly based on dynamic programming systems associated to stochastic optimal control of markov chains this part is organized in four chapters chapter 6 provides an introduction to stochastic dynamic programming and its relationship with dynamic systems it reviews some existing results on the existence of asymptotic regimes of additive 1 homogeneous and monotone dynamic systems it focuses in particular on dynamic systems written in the form of stochastic dynamic programming systems associated to optimal control problems of markov chains chapter 7 proposes a multi anticipative vehicular traffic model the model is microscopic and is based on an existing model the piecewise linear car following model 21 we extended the model of 21 in such a way that the drivers can take into account more than one leader vehicle in their car following behavior laws we show that the car dynamics are written as a stochastic dynamic programming system associated to optimal control of a markov chain we give the interpretation of that in terms of vehicular traffic we derive analytically the macroscopic behavior emerging from the microscopic dynamics by obtaining the fundamental traffic diagrams giving the asymptotic traffic flow as a function of the average car density moreover we show that the traffic is more smooth in the case where the drivers have such multi anticipative behaviors chapter 8 proposes many extensions of the max plus algebra model of the train dynamics presented in chapter 3 we first present train dynamics where the effect of the passenger travel demand on the train dwell times is modeled naturally without any control in this case a high level of the passenger travel demand at a given platform extends naturally the train dwell time at the platform we show that the dynamics are unstable in this case and give interpretation of that fact in term of the train dynamics and of the effect of the passenger demand on it we then propose a second model with a control law on the train dwell times in such a way as to guarantee the stability of the train dynamics we show that the controlled train dynamics is written is this case as a dynamic programming system of optimal control problem of a markov chain and give the interpretation of that in term of traffic we show analytically that the train dynamics admit a stationary regime with a unique average growth rate interpreted here as the average asymptotic train time headway we derive then by numerical simulation the asymptotic average train frequency as a function of the number of running trains on the metro line and of the passenger demand level and by that we derive the effect of the passenger travel demand on the train dynamics finally chapter 9 summarizes some of my other contributions on stochastic modeling and control of traffic two works are briefly presented first we present an extension of an existing model for optimal routing in networks the objective of our extension is to introduce robustness of the routing against link failure with an application for the guidance of the users of road networks a routing strategy is said to be robust here if the deterioration of its maximum value probability of arrival is minimized in case of link failure second we present a macroscopic model for multi lane vehicular traffic where we model the assignment and the dynamic reassignment of the traffic to different lanes of a highway stretch chapter 6 introduction to and reviews on stochastic dynamic programming based systems we give in this chapter some necessary reviews and theoretical tools for the models we present in the chapters of this part our models are based on the dynamic programming systems associated to stochastic optimal control problems of markov chains the reviews are organized in three sections first we consider dynamic systems of the form x k f x k 1 where f rn rn is an additive homogeneous of degree 1 and monotone map we recall that under a kind of reducibility condition for f the dynamic system admits a stationary regime with a unique average growth rate we give an extension of this result to dynamic systems of the form x k f x k x k 1 x k m 1 where f rn m rn second we consider the dynamics x k 1 i max u u mux k i c u i i 1 2 n 6 1 which are dynamic programming systems associated to control problems of markov chains with transition matrices mu and reward vectors cu for u u we give some reviews on these dynamics and then consider the extended dynamics x k i max u u mux k 1 i nux k i cui i 1 2 n with possible implicit terms and provide some results third we consider another extension to the dynamic system 6 1 to dynamic systems associated to stochastic games x k 1 i min u u max w w muwx k i c uw i i 1 2 n we give the necessary results of these dynamics for our models 6 1 non expansive dynamic systems we are concerned here with maps f rn rn such a map is additive 1 homogeneous if x rn a r f a 1 x a 1 f x 71 chapter 6 stochastic dyn prog based systems 72 where 1 def t 1 1 1 f is monotone if x y rn x y f x f y where x y means xi yi i 1 i n if f is 1 homogeneous and monotone then it is non expansive or 1 lipschitz for the sup norm 5 i e x y rn f x f y x y a directed graph g f is associated to a non expansive map f g f is defined 8 by the set of nodes 1 2 n and by a set of links such that there exists a link from a node i to a node j if lim fi ej where ej is the jth vector of the canonical basis of rn we recall below an important result on the existence of asymptotic regimes and asymptotic growth rates for non expansive dynamic systems i e dynamic systems defined with non expansive maps theorem 6 1 7 6 if f rn rn is 1 homogeneous and monotone and if g f is strongly connected then f admits a unique additive eigenvalue i e r x rn f x x moreover the dynamic system x k 1 f x k admits a stationary regime with a unique asymptotic average growth vector f defined f limk fk x k furthermore we have f 1 for simplicity we use in this article for all the dynamic systems the notation xk instead of x k we give in the following a natural extension of theorem 6 1 which will permit us to consider dynamic systems of the form xk f xk xk 1 xk m 1 for that let us consider f rm n rn associating for x 0 x 1 x m 1 where x i are vectors in rn a column vector in rn f rm n rn x 0 x 1 x m 1 7 f x we denote by f i i 0 1 m 1 the following maps f i rn rn x 7 f i x f x ithcomponent and by f the following map f rn rn x 7 f x f x x x theorem 6 2 if f is additive 1 homogeneous and monotone and if g f id strongly connected and g f 0 is acyclic then f admits a unique generalized additive eigenvalue and an additive eigenvector v such that f v v v 2 v m 1 v moreover f 1 proof the proof consists in showing that the dynamic system xk f xk xk 1 xk m 1 is equivalent to another dynamic system zk h zk 1 where h is built from f such that h satis fies additive 1 homogeneity monotonicity and connectivity properties needed by theorem 6 1 we give here a sketch of the proof two steps are needed for the proof 1 eliminate the dependence of xk on xk 2 xk 3 xk m 1 this is done by the well known state augmentation technique chapter 6 stochastic dyn prog based systems 73 2 eliminate implicit terms the dependence of xk on xk this is done by defining an order of updating the n components of xk in such a way that no implicit term appears this is possible because g f 0 is acyclic 6 2 dynamic programming systems of stochastic optimal con trol problems we review here a particular non expansive dynamic system encountered in stochastic optimal control of markov chains the dynamic system is written xk 1 i max u u muxk i c u i 1 i n 6 2 where u is a set of indexes corresponding to control actions mu for u u are stochastic matrices i e satisfy muij 0 and m u 1 1 and cu for u u are reward vectors in rn 6 2 is the dynamic programming system associated to the stochastic optimal control of a markov chain with state z z 1 2 n transition matrices mu u u associated rewards cuz u u z z and final rewards z z z max s s e t 1 k 0 cu k zk zt 6 3 where s is the set of feedback strategies s z u the variable xki i 1 2 n k n is interpreted in this case as the function value of the stochastic control problem in the traffic models of the train dynamics we propose in chapter 8 we are concerned with system 6 2 above more precisely we will consider dynamic systems with implicit terms 6 4 xki max u u muxk 1 i n uxk i c u i 1 i n 6 4 where mu u u and nu u u satisfy muij 0 n u ij 0 and j m u ij n u ij 1 i u for the analysis of dynamic system 6 4 we will use theorem 6 2 we notice here that in our traffic models the interpretation of systems 6 2 and 6 4 will be different from the stochastic optimal control one in the sense that in our models such systems model directly the train dynamics and are not derived from stochastic optimal control problems 6 3 dynamic programming systems of stochastic games we review here another particular non expansive dynamic system encountered in stochastic games on a controlled markov chain with two players a minimizer and a maximizer the dynamic system is written xk 1 i min u u max w w muwxk i c uw i 1 i n 6 5 where u is a set of indexes corresponding to the control actions of the minimizer w is a set of indexes corresponding to the control actions of the maximizer muw for u u w w are stochastic transition matrices with muwij 0 and m uw 1 1 of the markov chain and cuw for u u w w are pay off vectors in rn indexed by the controls of both the minimizer and the maximizer chapter 6 stochastic dyn prog based systems 74 6 5 is the dynamic programming system associated to the stochastic game on a controlled markov chain with state z z 1 2 n transition matrices muw u u w w associated pay offs cuwz u u w w z z and final pay offs z z z min max s se t 1 k 0 cu kwk zk zt 6 6 where s is the set of feedback strategies s z u w the variable xki i 1 2 n k n is interpreted in this case as the function value of the stochastic control game in the traffic model of the car dynamics we propose in chapter 7 the interpretation of system 6 5 will be different from the stochastic optimal control one in the sense that in our model the dynamic system models directly the car dynamics and is not derived from a stochastic game problem chapter 7 multi anticipation piecewise linear car following modeling the main reference of this chapter is 20 it consists in an extension of a microscopic traffic model we developed in 14 21 called piecewise linear car following the extension permits to consider anticipation in driving that is to say that the car following law can take into account more than one leader in the calculus of the reaction to stimulus by means of variational formulation we characterize stability and stationary regimes to the model proposed here it is shown that the multi anticipative model realizes the same macroscopic behavior as the non anticipative model in term of the stationary regime nevertheless in the transient traffic the variance in car velocities and accelerations is reduced in the case of multi anticipative driving and the car trajectories are smoothed in the sequel of this chapter time is denoted by t distance car position is denoted by x and n numbers the cars starting by the leader we then consider the following notations x n t the cumulative traveled distance of car n from time zero to time t y n t the inter vehicular distance x n 1 t x n t v n t the velocity of car n at time t in order to situate the model we present here with respect to the existing multi anticipative models and to understand the extension we do let us first give a short review on multi anticipative car following models a straightforward multi leader extension of the model of chandler et al 108 is the bexelius model 107 v n t t m j 1 j v j n t 7 1 where v denotes the acceleration j j 1 2 m are sensitivity parameters with respect to the jth car ahead and where v j n t v n j t v n t this model is very simple but permits some mathematical analysis hoogendoorn et al 114 have noted the non convenience of the additive form of bexelius model 7 1 and proposed the modification v n t t min 1 j m j v j n t 7 2 hoogendoorn et al 114 have also proposed a multi anticipative generalization for the helly model 12 13 v n t t m 1 j 1 j v j n t m 2 j 1 j x j n t sj n 7 3 75 chapter 7 multi anticipation modeling 76 where x j n t x n t x n j t lenz et al 115 have generalized the bando model 3 as follows v n t m j 1 j v x j n t j v n t 7 4 where j expresses the sensitivity of the jth leader 7 1 review on the piecewise linear car following modeling we base here on the piecewise linear car following model proposed in 21 where the behavioral law ve giving the velocity of a vehicle as a function of the inter distance y between the vehicle and its leader is approximated with a min max piecewise linear curve ve y min u u max w w uwy uw 7 5 where uw and uw for u w u w are parameters and u and w are two finite sets of indexes in 7 5 only one leader is considered the position of the considered car is then updated as follows x n t 1 x n t min u u max w w uw x n 1 t x n t uw 7 6 system 7 6 is also written for the traffic of cars 1 2 as follows xn t 1 min u u max w w muwx t n cuwn 1 n 7 7 where muw and cuw for u w u w are matrices and column vectors respectively the dynamics 7 7 have been interpreted in 21 under the assumption uw 0 1 u w u w as a dynamic programming system associated to a stochastic game on a controlled markov chain see 21 for more details two cases have been distinguished in 21 the cars move on a ring road in this case muw and cuw are given by muw 1 uw 0 uw uw 1 uw 0 0 0 uw 1 uw and cuw t uw d uw uw uw where d denotes the car density on the road the dynamics 7 7 are stable under the condition uw 0 1 and the behavior law is realized at the stationary regime v min u u max w w uwy uw 7 8 where v and y denote the asymptotic average car velocity and inter vehicular distance chapter 7 multi anticipation modeling 77 the cars move on an open road where the velocity v 1 t of the first car the leader one varies over time but it converges a stationary one in this case muw and cuw are given by muw 1 0 0 uw 1 uw 0 0 0 uw 1 uw and cuw t t v 1 t uw uw uw again the dynamics 7 7 is stable under the condition uw 0 1 and the reverse behavior law at the stationary regime is obtained as follows y max u u min w wu v 1 uw uw 7 9 where v 1 denotes the asymptotic velocity of the first car 7 2 anticipation modeling we present in this section our extension of the model 7 6 to multi anticipative driving where the velocity of a car is calculated depending on the inter vehicular distance with respect to a given number m of leader cars with m 2 our multi anticipative model is an extension for the piecewise linear car following model 7 6 we use a minimum form as in 7 2 rather than an additive form as in 7 1 moreover we use a uniform form for the sensitivity with respect to the inter vehicular distance as in 7 4 the inter vehicular distance with respect to the jth leader is divided by j we consider the following model xn t 1 xn t min 1 j m 1 j 1 min u u max w w uw xn j t xn t j uw 7 10 where m is the number of leaders taken into account in anticipation and 0 is a discount parameter with respect to the leader index the dynamics 7 10 can be written simply xn t 1 xn t min 1 j m min u u max w w uwj xn j t xn t j uwj 7 11 where u w u w uwj j 1 j m are increasing positive sequences the interpretation of the minimum operator with respect to the jth leader in 7 11 is that a car n maximizes its velocity under the constraints xn t 1 xn t min u u max w w uwj xn j t xn t j uwj 1 j m 7 12 discounting with respect to the leader indexes made by introducing the multiplicative term 1 j 1 permits to favor closer leaders over distant ones in the case where m 1 we retrieve the classical piecewise linear car following model without anticipation if 0 then the cars respond equally to the stimulus of all the leaders j with j 1 2 m the meaning of the anticipation here is the following for example the information that a car i i n 1 n 2 max 1 n m decelerates at time t is immediately transmitted to the car n that reacts at time t 1 with anticipation instead of t i without anticipation we study below in section 7 3 the stability of the car dynamics 7 10 and characterize the existence of stationary regimes two cases are distinguished traffic on a ring road and traffic on an open road in both cases we give the asymptotic car positions when stationary regimes exist transient traffic for the car dynamics 7 10 is treated in section 7 4 chapter 7 multi anticipation modeling 78 7 3 stability analysis and stationary regime as in 21 14 we consider cars moving on a 1 lane road without passing we first study the case where the cars move on a ring road and then explore the open road case 7 3 1 multi anticipation on a ring road cars being moving on a ring road the indexes n j in the dynamics 7 10 are cyclic in the set 1 2 the idea here is to summarize the two minimum operators in 7 10 in only one minimum operator and then retrieve the form of the piecewise linear car following dynamics without anticipation let us denote by z the set of all pairs of indexes j u with 1 j m and u u z z j u 1 j m u u the dynamics 7 10 is then written xn t 1 min z z max w w m zwx t n czwn 1 n 7 13 where the matrices m zw m juw and the column vectors czw cjuw are given as follows m juw 1 juw j 0 juw j 0 0 0 1 juw j juw j 0 juw j juw j 0 juw j 0 0 0 juw j 0 1 juw j cjuw t juw j y juw juw juw juw the dynamics 7 13 have the same form as 7 7 it is then interpreted as a dynamic programming system associated to a stochastic game on a controlled markov chain the stability is guaranteed under the condition juw 0 1 j u w 1 2 m u w see 21 14 for more details the stationary regime is characterized by the additive eigenvalue problem v xn min 1 j m min u u min w w m juwx n cjuwn 1 n 7 14 where v is the asymptotic average car speed the same for all cars and where the vector x gives the asymptotic car positions up to an additive constant the following result gives a solution for the system 7 14 theorem 7 1 if j u w 1 2 m u w juw 0 1 then the system 7 14 admits a solution v x given by v min u u min w w 1 uwy 1 uw x t 1 y 2 y y 0 proof available in 20 theorem 7 1 tells that the asymptotic car positions at the ring road are uniform this is due to the assumption that all the cars have the same behavior chapter 7 multi anticipation modeling 79 7 3 2 multi anticipation on an open road we assume here that cars move on an open road and that the speed v 1 t of the first car is given over time in addition in order to analyze the stability and the stationary regime of the car dynamics we assume that the velocity of the first car approaches a constant value v 1 i e lim t v 1 t v 1 moreover the number of anticipation cars for the nth car is min n 1 m instead of being always m the dynamics 7 10 is then written xn t 1 min 1 j m min u u max w w m juwx t n cjuwn 1 n 7 15 where the matrices m juw and the vectors cjuw are given by m juw 1 0 0 0 0 1 0 0 0 0 0 1 0 0 0 juw j 0 0 1 juw j 0 0 0 juw j 0 0 1 juw j 0 0 0 0 0 0 juw j 0 0 1 juw j 1 2 j j 1 j 2 and cjuw v 1 t juw juw juw 1 2 j j 1 j 2 the entries m juw ik and cjuw i for i k j do not play any role in the car dynamics since cjuw i i j those entries correspond to anticipation of a car i with respect to its jth leader that does not exist since i j the stationary regime is characterized as follows v xn min 1 j m min u u max w w m juwx n cjuwn 1 n 7 16 the following result gives a solution for the system 7 16 theorem 7 2 for all y r satisfying minu u maxw w 1 uwy 1 uw v 1 the couple v x is a solution for the system 7 16 where v v 1 and x is given up to an additive constant by x t 1 y 2 y y 0 7 17 proof available in 20 chapter 7 multi anticipation modeling 80 theorem 7 2 tells that the configuration of the car positions at the stationary regime is uniform moreover it gives the asymptotic inter vehicular distance as a function of the asymptotic speed v 1 of car 1 an important remark here is that the car velocity obtained here in the multi anticipation case is the same as the one obtained for the piecewise linear car following model without anticipation 7 6 moreover the optimal strategy of driving at the stationary regime in the case of multi anticipation is to drive by taking into account only one leader j u w 1 u w therefore at the stationary regime once the traffic is stabilized it is not necessary for drivers to take into consideration more than one leader another important remark here is that even though the cars reduce their approach in the multi anticipative dynamics due to the minimum operator over the leader indices comparing to their dynamics without anticipation as long as the cars approach the stationary regime where the traffic is stable they retrieve what they have lost at the transient regime therefore by introducing the minimum operator on the multi anticipative dynamics the traffic becomes smoother without decreasing the stationary car speed 7 4 transient traffic let us consider the same example taken in 21 and adapt it to multi anticipative driving we simulate the car dynamics 7 10 with a time unit of 1 2 second s and a distance unit of 1 meter m we keep the same parameters of the model as those of example 1 of 21 the parameters have been determined by approximating a given behavior law the car dynamics are simulated on a one lane road of about 10 000 meter we vary in time the number of leaders and the velocity of the first car in order to show the effect of multi anticipation on the transient traffic we give the results on table 7 1 the trajectories of the leader car are the same for all views of table 7 1 we see that the car trajectories shown in table 7 1 are smoothed in case of multi anticipation driving although in practice the number of leaders taken into account by drivers is in general less than 5 we simulated here the anticipation with up to 100 leaders which could be possible if we consider communicating and or automated cars chapter 7 multi anticipation modeling 81 table 7 1 traffic on a 1 lane road on the x axis time on the y axis car position the number of cars taken into account in anticipation are 1 5 10 20 50 and 100 the length of the road is 10 000 meter the total simulation time is 500 seconds 1 leader anticipation 5 leaders anticipation 10 leaders anticipation 20 leaders anticipation 50 leaders anticipation 100 leaders anticipation chapter 7 multi anticipation modeling 82 this page is intentionally left blank chapter 8 demand dependent train dynamics control the main references for this chapter are 30 32 33 we present some extensions of the max plus algebra model of the train dynamics presented in chapter 3 the extensions aim to make the train dwell times at platforms dependent on the passenger travel demand and in some models to control this dependence we first show in section 8 1 that if the dependence of the train dwell times on the passenger travel demand is not controlled then the train dynamics are unstable in a second model section 8 2 we present a control model of the train dwell times based on the feedback of the train dynamics as well as the passenger travel arrival rates we show analytically that the train dynamics are stable with the proposed control model and derive by means of numerical simulation the asymptotic regimes of the train dynamics with the asymptotic average train time headways and frequencies as functions of the number of running trains and of the passenger travel demand finally we discuss some further extensions of the proposed modeling and control approach 8 1 natural instability of the train dynamics we consider in this section train dynamics that take into account the passenger travel demand we introduce this dependence by assuming that train dwell time wj at platform j depends on the passenger volume at the same platform j which depends on the safe separation time gj on the same platform the time during which passengers are accumulated at the platform or equivalently on the train time headway hj the model we present here extends naturally the model of chapter 3 without optimizing the effect of the passenger volumes on the train dynamics in other words we assume that the dependence of the dwell times at platforms with the passenger demand is uncontrolled we will see that in this case the train dynamics are unstable we notice that we do not model the stocks of passengers at platforms or inside the trains we assume that the train dwell times at platforms depend directly on the average passenger arrival rates also we model here the effect of only embarking time of passengers into the trains on the train dwell time we do not model the effect of the alighting time of passengers from the trains on the train dwell time in order to model the effect of passengers on the train dwell times at platforms we con sider the following additional constraint on the dwell time at platforms in addition to con straints 3 6 and 3 7 of chapter 3 wkj j j gkj if j indexes a platform 0 otherwise 8 1 83 chapter 8 demand dependent train dynamics control 84 where j is the total passenger upload rate from platform j onto the trains if j indexes a platform and j is zero otherwise j i ji is the average rate of the total arrival flow of passengers to platform j if j indexes a platform and j is zero otherwise where ji is the origin destination arrival rates of passengers to platform j with platform i as destination jg k j gives the total arrival of passengers in the time interval g k j during which passengers are accumulated onto platform j therefore jgkj j gives the minimum necessary train dwell time to upload the total arrival jgkj by taking into account the additional constraint 8 1 the constraint 3 6 is modified as follows dkj d k bj j 1 rj max wj j j gkj 8 2 we now modify the dynamic model 3 8 by taking into account the new constraint 8 2 we obtain for nodes j indexing platforms the following dkj max d k bj j 1 rj wj 1 j j d k bj j 1 j j dk 1 j 1 j j rj d k b j 1 j 1 sj 1 8 3 for non platform nodes the dynamics remain as in 3 8 let us notice that the dynamic system 8 3 has explicit and implicit terms moreover it can be written in the form 6 4 i e as follows dkj max u u mudk 1 j n udk j c u j 8 4 where mu and nu are square matrices and cu is a family of vectors for u u the matrices nu u u express implicit terms we notice that it suffices that j j 0 to have one of the matrices mu u u or nu u u not being sub stochastic 1 since we have in this case j j j 1 and j j j 0 see the dynamics 8 3 therefore the dynamic system 8 3 cannot be seen as a dynamic programming system of a stochastic optimal control problem of a markov chain see section 6 2 of chapter 6 it is easy to see that if m 0 or m n then the dynamic system 8 3 is fully implicit it is not triangular and therefore we can say that it admits an asymptotic regime with a unique additive eigenvalue h which is also the average growth rate of the system and which is the asymptotic average train time headway this case corresponds to 0 or n running trains on the metro line no train departure is possible for these two cases we have the average train frequency f 0 corresponding to the average time headway h we can also show that if 0 m n then the dynamic system 8 3 is triangular that is to say that it is not fully implicit and there exists an order of updating the components of the state vector dk in such a way that no implicit term appears we know that the dynamic system 8 3 is unstable in general indeed as we noticed above the matrices mu u u or nu u u are not sub stochastic the consequence is that the dynamics are not non expansive in fact they are additive 1 homogeneous but not monotone many behaviors are possible for the dynamic system depending on the parameters and on 1 a matrix a is sub stochastic if 0 aij 1 i j and if i aij 1 i chapter 8 demand dependent train dynamics control 85 the initial conditions expansive behavior chaotic behavior etc in practice let us assume the kth arrival of a given train to platform j is delayed then gkj will increase by definition and wkj will also increase by application of 8 1 by consequent of the increasing of w k j the departure dkj will be delayed and the delay of d k j would be longer than the one of a k j because it accumulates the delay of akj and the increasing of w k j consequently the arrival of the same train to platform j 1 downstream of platform j will be delayed longer comparing to its arrival to platform j therefore the application of the control law 8 1 amplifies the train delays and propagates them through the metro line we notice that the instability of this kind of dynamics has already been pointed out see for example 23 8 2 stable dynamic programming model we propose here an adaptation of the train dynamics 8 3 in order to guarantee its stability as shown above system 8 3 is unstable because of the relationship 8 1 in order to deal with this instability we propose to replace the train dwell time formula 8 1 by the following wkj wj kj kj k j gkj if j indexes a platform 0 otherwise 8 5 where the sign of the relationship between the dwell time wkj and the safe separation time g k j is inversed without inversing the relationship between the dwell time wkj and the ratio k j k j and where wj maximum dwell time at node j and kj are control parameters the dynamics 8 3 are now rewritten for nodes j indexing platforms as follows dkj max d k bj j 1 rj wj 1 kj d k bj j 1 k j d k 1 j 1 kj rj wj d k b j 1 j 1 sj 1 8 6 where kj k j k j k j j k for non platform nodes the dynamics remain as in 3 8 in case where kj are independent of k for every j the dynamic system 8 6 can be written under the form 8 4 as for the dynamic system 8 3 in case where m 0 or m n the system 8 6 is fully implicit and admits an asymptotic regime with a unique average asymptotic train time headway h no train movement is possible in case where 0 m n the dynamic system 8 6 is triangular in the latter case and if kj are independent of k for every j then the dynamic system 8 6 can be written under the form 6 4 if in addition 0 j 1 j then mu and nu are sub stochastic matrices i e satisfying muij 0 n u ij 0 j m u ij 1 and j n u ij 1 moreover we have j m u ij n u ij 1 i u in this case 8 6 is a dynamic programming system of an optimal control problem of a markov chain whose transition matrices and reward vectors can be calculated frommu nu and cu u u they are the transition matrices and reward vectors corresponding to the equivalent explicit dynamic system obtained by solving the implicit terms of 8 6 theorem 8 1 if 0 m n and if kj are independent of k for every j and 0 j 1 j then the dynamic system 8 6 admits a stationary regime with a unique average growth rate h interpreted here as the asymptotic average train time headway independent of the initial state d 0 chapter 8 demand dependent train dynamics control 86 proof the proof uses theorem 6 2 let us denote by f the map associated to the dynamic system 8 6 and use the notations f i i 0 1 and f as defined in section 6 1 of chapter 6 since mu and nu are sub stochastic matrices with j m u ij n u ij 1 i u then f is additive 1 homogeneous and monotone the graph associated to f is strongly connected see figure 8 1 indeed this graph includes the one of the max plus linear dynamics graph of figure 3 2 which is already strongly connected the graph associated to f 0 is acyclic since 0 m n we do not yet have an analytic formula for the asymptotic train time headway we know that it coincides with the average growth rate h but theorem 8 1 guarantees its existence and its uniqueness therefore by iterating the dynamics 8 6 one can approximate for any fixed train density the associated asymptotic average train time headway h as follows h dkj k j for a large k 8 7 in the following we give a result theorem 8 2 which tells us under which condition on the control parameters w j and j the dynamic system 8 6 is max plus linear we will use this result in section 8 3 in order to derive an approach for fixing the control parameters w j and j in such a way that the effect of passenger arrivals on the train dynamics will be well modeled figure 8 1 the graph associated to f in the proof of theorem 8 1 which is also the same graph associated to the max plus linear system in the proof of theorem 8 2 theorem 8 2 let h be the asymptotic average growth rate of the max plus linear system 3 8 the dynamic programming system 8 6 with parameters w j h j and j 1 j is a max plus linear system whose asymptotic average growth rate coincides with h proof it is easy to see that if j 1 j then system 8 6 is a max plus linear one whose associated graph has n additional cycles which are loop cycles comparing to the one associ ated to system 3 8 see figure 8 1 moreover if w j h j then the cycle mean of the loops are all equal to h all the other parameters corresponding to the characteristics of the metro line and of the trains running on it remain the same as the ones of system 3 8 therefore as in theorem 3 1 the asymptotic average time headway h is given by the maximum cycle mean of the graph associated to the max plus linear system obtained from system 8 6 four different elementary cycles are distinguished on that graph see figure 8 1 the hamiltonian cycle in the direction of the train movements with mean j tj m all the cycles of two links relying nodes j 1 and j with mean tj sj each the hamiltonian cycle in reverse direction of the train dynamics with mean j sj n m the n loop cycles with mean h chapter 8 demand dependent train dynamics control 87 hence h max j tj m max j tj sj j sj n m h h 8 3 how to fix the control parameters w j and j according to theorem 8 2 if we fix w j kj h 1 in 8 6 then we obtain a max plus linear train dynamics which do not take into account the passenger demand we assume here that kj k j and k j are independent of k and then denote j j and j respectively let us consider the metro line as a server of passengers we assume that the average arrival of passengers to a platform j is j and that the average passenger service rate at a platform j is min j h where denotes the train capacity maximum number of passengers in a train under the max plus linear model 3 8 of the train dynamics the asymptotic average service rate depends on the number m of trains or equivalently on the train density since the asymptotic average train time headway is given as a function of see 3 12 therefore the asymptotic average service rate is given by min j h let us use the following notation j min j h 8 8 therefore the metro line as a server operating under the max plus linear model is stable under the condition j j j the stability condition of the metro line seen as a server means that if j j j then the train dynamics is max plus linear and can then serve passengers without adapting the train dwell times to the passenger arrival rates basing on this remark we propose an approach for fixing the parameters w j and j in function of the passenger arrivals in such a way that in case where j j j the dynamic system behaves as a max plus linear one therefore the train dwell times are not constrained by the arrival rates of passengers in case where j j j the system switches to a dynamic programming one the train dwell times are constrained by the arrival rates of passengers let us fix w j and j as follows w j h j 8 9 j j max j j j 8 10 we notice here that fixing j as in 8 10 is equivalent to fixing j as follows j j max j j j j j j 8 11 we then have 0 j 1 by definition and in case where j j j we have j 1 j and the dynamic system is max plus linear where the dwell times are not constrained by the arrival rates of passengers in case where j j j we have j j 1 and the system switches to a dynamic programming one the dwell times are constrained by the arrival rates of passengers chapter 8 demand dependent train dynamics control 88 we then have the following result theorem 8 3 for any fixed value of the train density on the metro line the dynamic system 8 6 with parameters w j and j fixed dependent on as in 8 9 and 8 10 respectively admits a stationary regime with a unique asymptotic average growth rate h independent of the initial state d 0 moreover we have h h proof the proof follows from theorem 8 1 and from all the arguments given above in this section in particular from 0 j 1 j 8 4 derivation of the asymptotic average dwell and safe sepa ration times from 3 2 we have w t r from 3 3 we have t m n h then we obtain w m n h r therefore if we have h by simulation by means of 8 7 we deduce w as follows w h r 8 12 similarly from 3 1 we have g r s from 3 3 we have s n m n h then we obtain g r n m n h therefore from 8 7 we obtain g r 1 h 8 13 in 33 other results give the minimum number of trains to run on the metro line in order that the train dynamics behaves as max plus linear one and then the passenger arrivals have no effect on the train dwell times and on the train dynamics practical implementations of this approach have also been discussed in 33 8 5 numerical results we present here some numerical results we consider the symmetric case for the passenger arrivals where the latter are the same at all platforms we vary the average rate in order to derive its effect on the train dynamics and on the traffic phase diagrams table 8 2 table 8 3 and table 8 4 show the obtained results in the left side respectively right side of table 8 2 we see the increase of the train time headways respectively degradation of the train frequencies due to increases of the passenger arrival rates in table 8 3 we see the increase of the average dwell times w at all the nodes and the one at platforms due to increases of the passenger arrival rates in table 8 4 we see the degradation of the safe separation times g due to increases of the passenger arrival rates table 8 1 parameters of the line considered number of stations 9 18 platforms segment length about 200 meters m free train speed vrun 22 m s about 80 km h train speed on terminus 11 m s about 40 km h min dwell time w 20 seconds min safety time s 30 seconds metro line length 17 294 km passenger train capacity 500 passenger train passenger upload rate 30 passengers s chapter 8 demand dependent train dynamics control 89 table 8 2 asymptotic average train time headway h and frequency f as functions of the number m of running trains the average passenger arrivals to platforms are given in the figure denoted by c table 8 3 asymptotic average train dwell time w at all nodes and dwell time at platforms as functions of the number m of running trains the average passenger arrivals to platforms are given in the figure denoted by c chapter 8 demand dependent train dynamics control 90 table 8 4 asymptotic average train safe separation time g as a function of the number m of running trains the average passenger arrivals to platforms are given in the figure denoted by c 8 6 conclusion and possible extensions basing on the conclusions of the max plus linear model of chapter 3 we proposed here an extension to a stochastic dynamic programming model where the passenger arrivals are con sidered the model permits to take into account the effect of the passenger arrival demand on the train dwell times at platforms and by that on the whole dynamics of the trains numer ous extensions of this approach are possible first the derivation of analytic formulas for the asymptotic average train frequency dwell time and safe separation time would allow a better comprehension of the traffic control model second the passenger demand being modeled here through average passenger arrival rates a dynamic model of the number of passengers at platforms an inside the trains would improve the traffic modeling in particular by taking into account the train and platform capacity limits finally the interaction between alighting and boarding passenger flows can also be modeled in order to take into account its effect on the train dwell times and on the train dynamics in general chapter 9 summary of my other contributions on the stochastic traffic modeling and control this chapter summarizes some of my other contributions on the stochastic traffic modeling and control two works are summarized first we present a work done with mrs farida manseur a phd student on optimal and robust routing in road networks we based on an existing approach from 40 41 42 for optimal routing and propose an extension to include a robustness aspect in the routing and guidance of users of road networks the robustness here is against link failure our approach permits to calculate optimal itineraries with respect to minimum and reliable travel times but also with respect to the robustness of the routing strategy against link failure itineraries with several possible and interesting detours are more robust than others we present the approach with some analytical results and then give numerical simulation results where our approach is applied on the well known sioux falls network the main reference of this work is 53 second we present a macroscopic multi lane traffic flow model which is based on a lane assignment of the vehicular flows of road networks the model assumes drivers associate respective specific utilities traffic speed for every lane the drivers then choose the lane with the highest utility the model is expressed by a system of conservation laws with a smooth but implicitly defined flux function first we explore on two data sets how traffic data supports the fact that traffic speed constitutes an explanatory variable of lane assignment second we address the problem of discretization of the model finally we give some directions for future research the main reference of this work is 116 91 chapter 9 summary of my other contributions 92 9 1 robust routing in road networks the main reference of this work is 53 we summarize here a new adaptive algorithm for optimal and robust guidance for the users of road networks the algorithm extends an existing routing algorithm known as the stochastic on time arrival sota 40 41 42 46 47 43 the latter is one of the most appropriate algorithm taking into account the variability of travel times through the road networks it permits the derivation of the maximum cumulative probability distribution of the time arrival to a given destination in the network from which one can get the most reliable origin destination paths under given travel time budgets the extension we proposed here introduces robustness against link and path failures in the routing the idea is to favor itineraries with possible and reliable alternative diversions in case of link failures with respect to itineraries without or with less reliable alternatives we consider both static and dynamic versions of the algorithm in the static version the traffic dynamics is not taken into account we first show some interesting properties of the algorithm in this case then we consider the dynamic version of the algorithm where we interface our routing algorithm in the traffic simulator sumo simulation of urban mobility in order to take into account the car dynamics by means of some routing scenarios we show the effectiveness of the proposed algorithm 9 1 1 review of the sota approach the main references for the existing sota approach are 43 44 45 46 47 40 41 42 a road network is represented by a graph g n a where n is the set of nodes with n n and a is the set of arcs with a a the set of successor and predecessor nodes of a given node i are denoted by 1 i j i j a and 1 i k k i a respectively travel times through the links i j of the network are stochastic with associated probability distribution functions pij sota formulation of the routing problem in the network consists in finding the best routing strategy from any starting node i i 1 2 n that maximizes the probability of arriving to a given destination node denoted d within a time budget t given a node i n and a time budget t ui t denotes the maximum probability for a user to arrive to destination node d within a time t parting from node i the maximum probabilities ui t are written as follows ui t max j 1 i t 0 pij w uj t w dw i n d j 1 i 0 t t 9 1 ud t 1 0 t t 9 2 si t arg max j 1 i t 0 pij w uj t w dw i n d j 1 i 0 t t 9 3 where t is the maximum time budget and where si t is the optimal successor node for the traveler being at node i 9 1 2 robust routing modeling a routing strategy is said here to be robust if it minimizes the deterioration of its maximum value calculated before the depart at the origin against eventual reconfigurations of the net work that may be due to accidents works etc taking into account the fact that one or many links of the selected optimal path may fail during the travel the users may then be sensitive to path changing indeed the users may prefer paths with efficient alternative detours with respect to paths without or with less efficient detours even with a loss in the average travel time and or in its reliability in order to take into account such behaviors we propose a model chapter 9 summary of my other contributions 93 that includes the existence as well as the performance of detours for selected paths in the cal culus of the travel time reliability i e the probability of reaching a destination node this new way of calculating travel time reliability guarantees a kind of robustness of the guidance strategies that is to say that the travel time reliability associated to the obtained optimal guidance strategy is not likely to change however associated adaptive paths change during the travel optimality refers to the robustness of the strategy the idea is to replace the maximum operator in formula 9 1 by a weighted mean over a chosen number of successor nodes instead of calculating ui t basing on the successor node giving the maximum value of ui t we propose here to consider also other successor nodes of i and we rather calculate ui t basing on a weighted mean over a number of successor nodes of i let us consider the following notation aij t t 0 pij w uj t w dw i n d j 1 i 0 t t 9 4 we denote by ai t the vector ai t ai 1 t ai 2 t aini t where ni is the number of successor nodes of node i in the graph we then define n maps si i 1 n as follows si rni rni ai t 7 si ai t i 1 2 n where si ai t is the vector whose components are the same as those of ai t but sorted in a non increasing order sij ai t denotes here the jth component si ai t j of vector si ai t we then rewrite the probability for a user to reach the destination node d from node i in a time budget t as follows ui t m p 1 psip ai t i 6 d 0 t t 9 5 ud t 1 0 t t 9 6 where m is a parameter giving the number of successor nodes taken into account in the sum of formula 9 5 and p are non increasing weighting coefficients satisfying p 0 p 1 2 m m p 1 p 1 and 1 2 m in the examples we give below for illustration we simply take m 2 in order that formula 9 5 will have a meaning p have to be chosen such that 1 2 m that is to say that p decrease as sip ai t decrease with respect to p this dependence of p on aip t makes the model non trivial indeed instead of taking the maximum over aip t with respect to successors p of i as in formula 9 1 we take a weighted mean in formula 9 5 where the weights are in the same order as the one of the quantities sip ai t therefore we need to first sort the quantities aip t before applying the mean operator so the model 9 5 needs more operations than the model 9 1 finally let us notice that if m 1 or if m 1 and p 0 p 2 then the model 9 1 9 2 coincides with the model 9 5 9 6 therefore the model 9 5 9 6 extends the model 9 1 9 2 the optimal guidance strategy is determined by the sequence of successor nodes si t as follows si t arg max j 1 i aij t i n 9 7 we notice here that although formula 9 7 resembles to formula 9 3 the resulted successor nodes from the two formulas are not necessarily the same since the maximized quantities in both formulas are calculated differently chapter 9 summary of my other contributions 94 9 1 3 static routing in sioux falls network we present here an implementation of the robust routing algorithm on the well known sioux falls network we assume that the link travel times on the network are drawn from bi variate gamma distribution figure 9 1 sioux falls test network the nodes as well as the links are numbered in this figure to reach the destination node 10 parting from node 1 we have 2979 elementary paths we apply the robust routing model 9 5 9 6 and derive the probabilities ui t for all origin nodes i of the network let us take the network of figure 9 1 where we remove link 37 by that we penalize in term of robustness the passage by node 12 since we decrease the number of successor nodes of it therefore node 12 will have only two instead of three successor nodes at node 3 coming from node 1 we have three routing actions go to successor node 12 which will give us only two routing options at the next step go to successor node 11 or back to 3 or go to successor node 4 which will give us three routing options at the next step go to successor nodes 5 or 11 or back to 3 indeed if we chose node 12 as successor of node 3 then at node 12 if link 36 fails we have to back to node 3 however if we chose node 4 as successor of node 3 then at node 4 if one of the links 9 or 10 fails we have the possibility to change and take a detour using the other link see figure 9 1 therefore passing by node 4 allows us more options than passing by node 12 we will see below that the propose robust routing model 9 5 9 6 is able to take into account such robustness criterion in the selection of the optimal routing strategy as we take here m 2 we have 1 and 2 with 1 2 and 1 2 1 for simplicity we note 1 1 2 and then 2 is simply given by 1 from figure 9 2 the optimal policies obtained by the proposed robust routing model 9 5 9 6 for the two cases of 1 and 1 2 1 are clearly different for the case 1 we get the same optimal policy for all considered values of time budgets however with low values of 0 95 respectively 0 93 0 9 0 85 0 8 where path robustness is considered we see that with a time budget greater than or equal to 57 time units a time unit is 24 seconds here respectively 56 55 53 time units the optimal successor node of node 3 is node 4 rather than node 12 even though paths passing through node 12 have lower average travel time comparing to those passing through node 4 for example for 0 95 we see that with a time budget lower than 56 time units the robust routing model prefers paths passing through node 12 see blue line on the chapter 9 summary of my other contributions 95 figure 9 2 left side the robust optimal probability of arriving on time in function of the time budget and for different values of right side the robust optimal routing policy on node 3 in function of the time budget and for different values of right side of figure 9 2 however with a time budget higher than 56 time units the optimal policy on node 3 changes and node 4 becomes the robust optimal successor node that means that node 12 which has only two successor nodes is penalized i e it gets low values ui t therefore paths that pass through that node i e paths with small number of alternatives or detours have low probability to be selected as robust optimal paths more details on this approach are available in 53 including evaluation of the price of robustness in term of travel time reliability and in term of travel time budget an approach for fixing the parameter in such a way to utilize the time budget first to satisfy the travel time reliability and then utilize the remaining time budget for robustness of the routing strategy robust dynamic routing with an interface with the traffic simulator sumo chapter 9 summary of my other contributions 96 9 2 logit lane assigment model we summarize in this section a macroscopic traffic model for traffic flow assignment onto the different lanes of a road the model generalizes the ideas of 104 it assumes that at a macroscopic scale it is possible to neglect the microscopic details of the lane change maneuvers and to model only the result of those maneuvers moreover the model is described as a user equilibrium where road users choose the lanes on which to run in function of the car speed the model considers a stochastic utility for the lane choice process cars move in one direction on a multi lane road where lane change is allowed and passing is permitted by lane change we assume that drivers are classified in a number of classes according to their destination this assumption is important because the assignment of drivers on different lanes may depend only on their classes for example approaching a divergent some drivers have to change lane in order to take the desired destination independent of the car density on each lane let us use the following notations i the set of lanes indexed by i d the set of driver classes indexed d id the set of lanes accessible to user class d di the set of user classes that can move on lane i d x t the car density of class users d at location x and time t i x t the car density at location x on lane i at time t di x t the car density of class users d at location x on lane i at time t lane utilities are user class specific and depend on the car speed on every lane which depends on the car density according to the fundamental traffic diagram of each lane we notice that a massive choice of a lane with a high utility has the effect of lowering the car speed on that lane and by that lowering its utility this should induce an equilibrium we notice that the car densities are conservative by user class but not by lane the utility of a lane i for a user of class d is assumed to be udi vi d i d i 9 8 where vi vi i is the car speed on lane i given by the fundamental traffic diagram on the lane di is a constant expressing the preference of class d users for lane i and d i is the gumbel random variable expressing the stochastic elements of the lane choice we assume that the users choose the lane with the highest utility the car density is split on the different lanes according to the logit lane assignment model di d exp vi d d d i j id exp vj d d d j d d i id 9 9 with d j id d j and is a sensitivity parameter we then obtain a fixed point system on the variables di see 106 system 9 9 is an assign ment problem with increasing costs therefore an equivalent formulation by an optimization problem is obtained by beckmann transformation max di d i i id i 0 vi r dr d d i id di d i v d d i id dh di d 9 10 d i id di d d 9 11 chapter 9 summary of my other contributions 97 where h x def x lnx 1 is the negentropy function on can also show that the necessary optimality conditions of 9 10 9 11 are equivalent to 9 9 the partial densities di and i can then be expressed by implicit but smooth functions of the densities per destination let us denote def d d d then we write di r d i i di i ri 9 12 the flows qd for densities by destinations d are qd def qd i id di vi i i id rdi vi ri 9 13 we then define the flow function q def qd d d the logit lane assignment model is then written as follows t xq 0 9 14 it is not easy to solve the system 9 14 analytically for different reasons the flow functions are defined implicitly explicit estimation of the gradient of the flow function is impossible analytic estimation of the eigenvalues of the flow function is impossible 9 2 1 testing the lane choice model on data first tests we have done are to check whether the lane speed is indeed a relevant explanatory variable of lane assignment and whether the logit assignment is compatible with measure ments marius data the objective here is to determine from observations in what proportions a lane choice is explained by the speed or by the random component of the utility i e by unknown explana tory variables the study is conducted for various levels of density in order to assess the importance of this level in the homogeneous case where id i d the logit model is based on the assumption of the utility ui vi i where vi is the known part of the utility the speed and i is the unknown part of the explanatory variables the parameter is proportional to the standard deviation of the distributions of the variables i the experimental distribution is compared to the theoretical one for values of v ranging between 17 km h and 2500 km h the best value is the one minimizing the sum of the squares of the differences between the observed and the theoretical probabilities see figure 9 3 from these preliminary results the speed is not an explanatory variable when the traffic is fully free flow or congested however it is an explanatory variable for intermediate densities moreover for intermediate densities the stochastic assignment model fits the data better than the deterministic one which corresponds to 0 further analysis are presented in 116 on the boulevard p rif rique dataset moreover a number of numerical schemes are given in 116 lax friedrichs euler lagrange and lagrange figure 9 4 shows the distribution of two classes of cars onto a ring road with two lanes under the lagrangian scheme presented in 116 we assumed here that the classe 1 users blue color chapter 9 summary of my other contributions 98 figure 9 3 estimates of horizontal axis vertical axis normalized quadratic error figure 9 4 position of vehicle groups on a ring road with two lanes interior ring lane 1 the size of a dot corresponds to the proportion of the vehicle group on each lane chapter 9 summary of my other contributions 99 move only on lane 1 11 and 1 2 0 while users of classe 2 have the same preference to move on lanes 1 and 2 21 2 2 finally let us notice that the model presented here admits extensions of the schemes to merges and diverges following 105 for example further investigations on experimental aspects are likely to improve the physical aspects of the model at the end the resulting schemes should be complemented with an efficient parametric estimation method and should be used to model an infrastructure such as boulevard p riph rique or on the ngsim data in order to validate the logit lane assignment model chapter 9 summary of my other contributions 100 this page is intentionally left blank chapter 10 conclusions and perspectives in conclusion the work presented in this dissertation is partly in continuation with my previ ous ph d and post doctoral work and partly oriented towards new directions and approaches including all the novelties of the field we believe that the study of transport systems and mobility in general will become even more important in the future the mathematical mod eling control and numerical simulation of these systems are and will remain necessary for the comprehension the optimization and the anticipation of the different phenomena and emerg ing behaviors of these systems the dynamic systems approach adopted here is very effective and useful for understanding the physics and dynamics of the studied systems however as started in the works of this dissertation the models and control strategies should be adapted with the information and communication technologies the big data techniques of analysis the digitalization the automation and even the robotics in parallel new models and control strategies should rethink this area of modeling and optimal management of complex transport systems in its new dimensions regardless of the existing models and control strategies in terms of modeling scale the microscopic scale would take more part for the modeling of the mobility thanks to the growing equipment of the mobile units and the transport in frastructures however the macroscopic scale will remain indispensable for the modeling of complex phenomena one of the concrete examples is the macroscopic modeling of the vehicle assignment on the lanes of a road that we presented here in chapter 9 see also 116 indeed lane change and vehicle passing on a road are very difficult to model in a microscopic scale because inter alia of the non linear dynamics the behavior that we understand and that we are able to reproduce with the least errors is rather macroscopic flows assigned to the different lanes according to the average speed on each lane seeking an equilibrium in terms of the decision making levels for traffic and mobility management we will have more and more possibilities to consider the operational level thanks to the increased capacity for observing the state of the system made possible by the availability and variety of sensors thus interesting data streams would arrive in real time and could therefore be used for operational management on the other hand the aggregation of all this information combined with predictive models will always be interesting for management at higher levels tactical and strategic therefore we will need to imagine intelligent management combining multiple levels of decisions and using information available at all the levels a concrete example is the one of the semi decentralized regulation for urban road traffic we proposed in chapter 5 see also 79 101 chapter 10 conclusions and perspectives 102 this page is intentionally left blank bibliography 1 a andre dwell time model and analysis for the mbta red line available online http ocw nur ac rw 2 f baccelli g cohen g j olsder and j p quadrat synchronization and linearity an algebra for discrete event systems john wiley and sons 1992 3 m bando k hasebe a nakayama a shibata and y sugiyama dynamical model of traffic congestion and numerical simulation physical review e 51 2 1995 4 s h cao z z yuan d zhao characteristics analysis and model establishment for passenger boarding time in urban rail transit journal of the china railway society vol 31 no 3 pp 89 93 mar 2009 5 m g candrall and l tartar some relations between non expansive and order preserving maps in ams 78 3 385 390 1980 6 j gunawardena and m keane on the existence of cycle times for some nonexpansive maps report hpl brims 95 003 hp labs 1995 7 s gaubert and j gunawardena a non linear hierarchy for discrete event dynamical sys tems 4 th iee wodes cagliari 1998 8 s gaubert and j gunawardena existence of eigenvectors for monotone homogeneous functions report hpl brims 99 08 hp labs 1999 9 goverde r m p punctuality of railway operations and timetable stability analysis ph d thesis delft university of technology delft 2005 10 rob m p goverde railway timetable stability analysis using max plus system theory in transportation research part b volume 41 issue 2 february 2007 pages 179 201 11 j cochet terrasson g cohen s gaubert m mcgettrick j p quadrat numerical computation of spectral elements in maxplus algebra in ifac conference on system structure and control nantes france 1998 12 w helly simulation of bottlenecks in single lane traffic flow in international symposium on the theory of traffic flow 1959 13 w helly simulation of bottlenecks in single lane traffic flow in theory of traffic flow elsevier publishing co pages 207 238 1961 14 nadir farhi mod lisation minplus et commande du trafic de villes r guli res phd thesis universit panth on sorbonne paris 1 2008 15 nadir farhi maurice goursat jean pierre quadrat derivation of the fundamental traffic diagram for two circular roads and a crossing using minplus algebra and petri net modeling ieee cdc ecc 2005 103 http ocw nur ac rw bibliography 104 16 nadir farhi maurice goursat jean pierre quadrat the traffic phases of road networks in transportation research part c 19 1 85 102 2011 17 nadir farhi maurice goursat jean pierre quadrat fundamental traffic diagrams of elementary road networks ecc 2007 18 nadir farhi maurice goursat jean pierre quadrat road traffic models using petri nets and minplus algebra in traffic and granular flow 281 286 2007 19 nadir farhi maurice goursat jean pierre quadrat piecewise linear concave dynamical systems appearing in the microscopic traffic modeling linear algebra and its applications 435 7 1711 1735 2011 20 nadir farhi habib haj salem jean patrick lebacque multi anticipative piecewise lin ear car following model in transportation research record 2012 21 nadir farhi piecewise linear car following modeling in transportation research part c emerging technologies 25 100 112 2012 22 nadir farhi modeling and control of elementary 2 d traffic systems using petri nets and minplus algebra in ieee cdc 2009 23 vi van breusegem g campion and g bastin traffic modeling and state feedback control for metro lines ieee tac 36 7 1991 24 v cacchiani d huisman m kidd l kroon p toth l veelenturf j wagenaar an overview of recovery models and algorithms for real time railway rescheduling transportation research b 63 2014 25 x sun s zhang h dong and h zhu optimal train schedule with headway and passenger flow dynamic models ieee 2013 26 j e cury f a c gomide and m j mendes a methodology for generation of optimal schedules for an underground rail system ieee transactions on automatic control vol l 25 no 2 pp 217 222 1980 27 w o assis b e a milani generation of optimal schedules for metro lines using model predictive control automatica 40 8 2004 28 f schanzenbacher r chevrier n farhi fluidification du trafic transilien approche pr dictive et optimisation quadratique roadef 2016 29 n farhi c nguyen van phu h haj salem j p lebacque traffic modeling and real time control in metro lines arxiv 1604 04593 version 1 2016 30 n farhi c nguyen van phu h haj salem j p lebacque traffic modeling and real time control in metro lines arxiv 1604 04593 version 2 2018 31 n farhi c nguyen van phu h haj salem j p lebacque traffic modeling and real time control in metro lines part i a max plus algebra model explaining the traffic phases of the train dynamics acc 2017 32 n farhi c nguyen van phu h haj salem j p lebacque traffic modeling and real time control in metro lines part ii the effect of passenger demand on the traffic phases acc 2017 http arxiv org abs 1604 04593 http arxiv org abs 1604 04593 bibliography 105 33 nadir farhi physical models and control of the train dynamics in a metro line without junction ieee transactions on control systems technology 2018 34 f schanzenb cher n farhi z christoforou f leurent g gabriel a discrete event traffic model explaining the traffic phases of the train dynamics in a metro line system with a junction ieee cdc 2017 35 f schanzenb cher n farhi f leurent g gabriel a discrete event traffic model explaining the traffic phases of the train dynamics on a linear metro line with demand dependent control in american control conference 2018 36 chi kang lee the minimum headway of a rail transit line joumal of the eastem asia society for transportation studies vol 2 no 1 autumn 1997 37 transit capacity and quality of service manual third edition 38 o engelhardt funke and m kolonko analysing stability and investments in railway networks using advanced evolutionary algorithms intl trans in op res 11 381 394 2004 39 http www evous fr metro ligne 14 a paris saint lazare olympiades 1134119 html 1 afwec 60 dx 6 dsmwa 99 40 s samaranayake s blandin a bayen a a tractable class of algorithms for reliable routing in stochastic networks transportation research part c 2012 41 m kobitzsch s samaranayake d schieferdecker pruning techniques for the stochastic on time arrival problem an experimental study computer sciences data structures and algorithm 2014 42 g sabran s samaranayake a bayen precomputation techniques for the stochastic on time arrival problem in alenex siam 2014 138 146 43 y fan r kalaba j e i moore arriving on time j optim theory appl 127 2005 497 513 doi 10 1007 s 10957 005 7498 5 44 y fan y nie optimal routing for maximizing the travel time reliability networks and spatial economics 6 2006 333 344 doi 10 1007 s 11067 006 9287 6 45 y fan y nie arriving on time problem discrete algorithm that ensures convergence transp res record j transp res board 1964 2006 193 200 46 y m nie x wu shortest path problem considering on time arrival probability transp res b methodol 43 2009 597 613 doi 10 1016 j trb 2009 01 008 47 y m nie x wu j f dillenburg p c nelson reliable route guidance a case study from chicago transportation research part a 46 2012 48 christoforou z corbille e farhi n leurent f managing planned disruptions of mass transit systems transportation research record journal of the transportation research board n 2541 pages 46 45 2016 49 haj salem h farhi n lebacque j application of multi objective nonlinear optimization technique for coordinated ramp metering icnaam international conference on numerical analysis and applied mathematics rhodes 2014 amer ican institute of physics aip conference proceedings 2015 http www evous fr metro ligne 14 a paris saint lazare olympiades 1134119 html 1 afwec 60 dx 6 dsmwa 99 http www evous fr metro ligne 14 a paris saint lazare olympiades 1134119 html 1 afwec 60 dx 6 dsmwa 99 bibliography 106 50 farhi n louis x lebacque j preface of the symposium on modeling simulation and optimization of transportation networks icnaam international conference on numerical analysis and applied mathematics rhodes 2014 amer ican institute of physics aip conference proceedings 2015 51 f manseur n farhi h haj salem j p lebacque robust adaptive strategies for the guidance of users in road networks transportation research procedia 2017 52 f manseur n farhi h haj salem j p lebacque an algorithm for robust routing strategies in networks journal of traffic and transportation engineering 2017 53 f manseur algorithmes de guidage optimal des usagers dans les r seaux de transport phd thesis university paris est marne la vall e france 2017 54 nadir farhi habib haj salem jean patrick lebacque on the robust guidance of users in road traffic networks icnaam 2014 and aip conference proceedings 1648 1 530004 2015 55 daganzo cf the cell transmission model a dynamic representation of highway traffic consistent with the hydrodynamic theory transportation research part b 1994 28 4 269 287 56 j lighthill and j b whitham on kinetic waves ii a theory of traffic flow on long crowded roads proc royal society a 229 pp 281 345 1955 57 p i richards shock waves on the highway operations res 4 42 1956 58 lebacque j p the godunov scheme and what it means for the first order traffic flow models in lesort j b ed proceedings of the 13 th isttt 647 678 1996 59 bhouri n farhi n towards efficient and reliable transportation systems transportation research part c 47 1 2 2014 60 lochert c mauve m fera h and hartenstein h geographic routing in city scenarios acm sigmobile mobile computing and communications 9 69 72 2005 61 seet b c liu g lee b s foh c h wong k j lee k k a star a mobile ad hoc routing strategy for metropolis vehicular communications in proceeding network ing 3042 989 999 2004 62 jain r macgregor smith j modeling vehicular traffic flow using m g c c state de pendent queueing models transportation science 1997 31 4 324 336 63 cheah jy macgregor smith j generalized m g c c state dependent queuing models and pedestrian traffic flows queueing systems 1994 15 365 86 64 cruza frb macgregor smith j approximate analysis of m g c c state dependent queueing networks computers and operations research 2007 34 2332 2344 65 cruza frb macgregor smith j queiroz dc service and capacity allocation in m g c c state dependent queueing networks computers and operations research 2005 32 1545 1563 66 n guerouahane congestion urbaine analyse par les syst mes d attente taux de service d pendant de l tat phd thesis university of bejaia algeria 2017 bibliography 107 67 guerrouahane n farhi n aissani d and medjkoune l b a queuing model for road traffic simulation icnaam 2014 and aip conference proceedings 1648 1 530012 2015 68 guerouahane n aissani d farhi n bouallouche medjkoune l m g c c state de pendent queuing model for a road traffic system of two sections in tandem computers operations research volume 87 pages 98 106 2017 69 guerrouahane n aissani d bouallouche medjkoune l farhi n m g c c state de pendent queueing model for road traffic simulation applied mathematics information sciences volume 11 num ro 1 pages 59 68 2017 70 haj salem h farhi n lebacque j bhouri n development of coordinated ramp metering based on multi objective nonlinear optimization functions traffic and safety advances in intelligent systems and computing book series aisc volume 572 pages 334 354 springer cham 2016 71 c s chang performance guarantees in communication networks tncs 2000 72 j y le boudec p thiran network calculus a theory of deterministic queuing sys tems for the internet vol lncs 2050 springer verlag 2001 revised version 4 may 10 2004 url http ica 1 www epfl ch ps files netcalbookv 4 pdf 73 p varaiya the max pressure controller for arbitrary networks of signalized intersections in advances in dynamic network modeling in complex transportation systems ser com plex networks and dynamic systems s v ukkusuri and k ozbay eds springer new york 2013 vol 2 pp 27 66 online available http dx doi org 10 1007 978 1 4614 6243 9 2 74 r l cruz a calculus for network delay part i network elements in isola tion ieee trans information theory vol 37 no 1 pp 114 131 1991 available https doi org 10 1109 18 61109 75 r l cruz a calculus for network delay part ii network analysis ieee trans informa tion theory vol 37 no 1 pp 132 141 1991 available https doi org 10 1109 18 61110 76 diakaki c integrated control of traffic flow in corridor networks ph d thesis ph d thesis technical university of crete department of production engineering and man agement chania greece 1999 77 diakaki c dinopoulou v aboudolas k papageorgiou m ben shabat e sei der e leibov a extensions and new applications of the traffic responsive urban control strategy coordinated signal control for urban networks transportation research record journal of the transportation research board 1856 202 211 2003 78 diakaki c papageorgiou m aboudolas k a multivariable regulator approach to traffic responsive network wide signal control control engineering practice 10 183 195 2002 79 nadir farhi cyril nguyen van phu mouna amir habib haj salem jean patrick lebacque a semi decentralized control strategy for urban traffic ewgt 2015 and trans portation research procedia 2015 80 cyril nguyen van phu nadir farhi habib haj salem jean patrick lebacque a vehicle to infrastructure communication based algorithm for urban traffic control in ieee inter national conference on models and technologies for intelligent transportation systems mt its 2017 http ica 1 www epfl ch ps files netcalbookv 4 pdf http dx doi org 10 1007 978 1 4614 6243 9 http dx doi org 10 1007 978 1 4614 6243 9 bibliography 108 81 n farhi b gaujal performance bounds in wormhole routing a network calculus ap proach arxiv preprint arxiv 1007 4853 2010 82 haj salem h farhi n lebacque j p combining ramp metering and hard shoulder strategies field evaluation results on the ile the france motorway network transportation research procedia 3 1002 1010 2014 83 haj salem h farhi n lebacque j p field evaluation results of new isolated and co ordinated ramp metering strategies in france ifac proceedings volumes 45 6 378 383 2012 84 aguil ra v bhouri n farhi n leurent f seidowsky r proceedings of ewgt 2012 15 th meeting of the euro working group on transportation paris france 10 13 septembre procedia social and behavioral sciences vol 54 4 october elsevier 2012 85 nadir farhi fundamental diagrams of 1 d traffic flow by optimal control models preprint arxiv 1002 2105 2010 86 n farhi m goursat j p quadrat about dynamical systems appearing in the micro scopic traffic modeling preprint arxiv 0911 4672 2009 87 nadir farhi solving the additive eigenvalue problem associated to a dynamics of a 2 d traffic system preprint arxiv 0904 0628 2009 88 nadir farhi a class of periodic minplus homogeneous dynamical systems contemporary mathematics 14 2009 89 n farhi m goursat j p quadrat degree one homogeneous minplus dynamic systems and traffic applications part i idempotent and tropical mathematics and problems of mathematical physics 33 2007 90 n farhi m goursat j p quadrat degree one homogeneous minplus dynamic systems and traffic applications part ii idempotent and tropical mathematics and problems of mathematical physics 33 2007 91 a bouillard n farhi b gaujal packetization and aggregate scheduling inria research report 2011 92 anne bouillard nadir farhi bruno gaujal packetization and packet curves in network calculus in ieee performance evaluation methodologies and tools valuetools 2012 93 n farhi n bhouri p lotito regulation of the bimodal traffic ifac proceedings vol umes 39 12 233 238 2006 94 n farhi and j p quadrat r solution num rique de probl mes de commande optimale de cha nes de markov observ es imparfaitement inria research report rr 5348 2004 95 n farhi h haj salem jp lebacque upper bounds for the travel time on linear traffic systems in 17 th meeting of the ewgt and in transportation research procedia volume 3 pages 349 358 2014 96 n farhi h haj salem and j p lebacque algebraic approach for performance bound calculus in transportation networks road network calculus transportation research record journal of the transportation research board no 2334 washington d c 2013 pp 10 20 doi 10 3141 2334 02 and preprint arxiv 1302 0132 http arxiv org abs 1007 4853 http arxiv org abs 1002 2105 http arxiv org abs 0911 4672 http arxiv org abs 0904 0628 http arxiv org abs 1302 0132 bibliography 109 97 n farhi h haj salem and j p lebacque an algebraic approach for modeling and simulation of road traffic networks arxiv preprint arxiv 1406 6929 2014 98 haj salem h farhi n lebacque j p risk index model building application for field ramp metering safety evaluation on urban motorway traffic in paris cybernetics and in formation technologies 13 4 33 41 2013 99 c sommer r german and f dressler bidirectionally coupled network and road traffic simulation for improved ivc analysis ieee transactions on mobile computing vol 10 no 1 p 3 15 january 2011 100 d krajzewicz j erdmann m behrisch and l bieker recent de velopment and ap plications of sumo simulation of urban mobility international journal on advances in systems and measurements vol 5 no 3 4 pp 128 138 december 2012 101 a varga the omnet discrete event simulation system in in esm 01 2001 102 souaad boussoufa lahlah fouzi semchedine louiza bouallouche medjkoune nadir farhi pscar a proactive optimal path selection with coordinator agents assisted rout ing for vehicular ad hoc networks international journal of high performance computing and networking volume 11 issue 2 pages 129 144 2018 103 n farhi m goursat jp quadrat piecewise linear concave dynamical systems ap pearing in the microscopic traffic modeling linear algebra and its applications 435 7 1711 1735 2011 104 lebacque j p khoshyaran m m a stochastic lane assignment scheme for macroscopic multilane traffic flow modelling in tristan vii 2009 105 khoshyaran m m lebacque j p lagrangian modelling of intersections for the gsom generic macroscopic traffic flow model in aatt athens 2008 106 khoshyaran m m lebacque j p numerical solutions to the logit lane assignment model in procedia social and behavioral sciences ewgt 2012 107 s bexelius an extended model for car following transportation research 2 1 13 21 1968 108 r e chandler r herman and e w montroll traffic dynamics studies in car following operations research 6 165 184 1958 109 f schanzenbacher n farhi f leurent g gabriel comprehensive passenger demand dependent traffic control on a metro line with a junction and a derivation of the traffic phases trb annual meeting washington d c 2018 preprint arxiv 1811 08347 2018 110 c nguyen van phu and n farhi estimation of urban traffic state with probe vehicles preprint arxiv 1811 05394 2018 111 f schanzenbacher n farhi f leurent and g gabrie real time control of metro train dynamics with minimization of train time headway variance 21 st ieee international conference on intelligent transportation systems itsc 2018 112 f manseur n farhi c nguyen van phu h haj salem j p lebacque robust routing its price and the tradeoff between routing robustness and travel time reliability in road networks in european journal of operational research 2018 http arxiv org abs 1406 6929 http arxiv org abs 1811 08347 http arxiv org abs 1811 05394 bibliography 110 113 n guerrouahane d aissani l bouallouche medjkoune n farhi m g c c state de pendent queueing model for road traffic simulation preprint arxiv 1612 09532 2016 114 serge p hoogendoorn saskia ossen and m schreuder empirics of multianticipative car following behavior transportation research record 1965 112120 2006 115 h lenz c k wagner and r sollacher multi anticipative car following model euro pean physical journal b 7 331 335 1999 116 nadir farhi habib haj salem megan khoshyaran jean patrick lebacque francesco salvarani bernard schnetzler florian de vuyst the logit lane assignment model first results trb meeting 2013 and in arxiv preprint arxiv 1302 0142 http arxiv org abs 1612 09532 http arxiv org abs 1302 0142 list of figures 2 1 the signals 2 3 2 3 and 2 3 respectively 14 2 2 a server 15 3 1 representation of a linear metro line 19 3 2 the graph g a 22 3 3 analytical phase diagrams for the train dynamics in a linear metro line 25 3 4 a metro line with one junction 27 4 1 the four curves of the arrival matrix of a vector of two signals 41 4 2 the traffic system of a road section 42 4 3 a trapezoidal fundamental diagram with j nmax l 1 qmax v 2 j qmax w q j 1 v 1 w c q v j q w 42 4 4 diagram for the system 4 7 4 9 43 4 5 composition of two min plus linear traffic systems 45 4 6 a feedback on a traffic system with two inputs and two outputs 46 4 7 route traffic system 48 4 8 arrival curves of the arrival matrix service curves of the service matrix and time delays 49 5 1 non preemptive service calculus scheme 54 5 2 shared queues the two servers cannot be active at the same time 55 5 3 a 2 2 switch 55 5 4 at intersection a we note g green r red y yellow 57 5 5 the state of the traffic at the end of simulation the colors of vehicles cor respond to their speed green high speed red low speed on the left side centralized tuc on the right side semi centralized tuc 58 5 6 left side comparison of the classical tuc with the semi decentralized tuc in terms of the number of running vehicles on the network the flow of ended vehicles and the average travel time through the network respectively right side the control in terms of the traffic light times into the cycle time 59 5 7 optimal path selection from a forwarder node to a coordinator agent 61 5 8 fundamental diagram of vehicular traffic 62 5 9 left side packet delivery ratio over number of vehicles right side end to end delay over number of vehicles 62 5 10 overhead over number of vehicles 63 8 1 the graph associated to f in the proof of theorem 8 1 which is also the same graph associated to the max plus linear system in the proof of theorem 8 2 86 9 1 sioux falls test network the nodes as well as the links are numbered in this figure 94 111 list of figures 112 9 2 left side the robust optimal probability of arriving on time in function of the time budget and for different values of right side the robust optimal routing policy on node 3 in function of the time budget and for different values of 95 9 3 estimates of horizontal axis vertical axis normalized quadratic error 98 9 4 position of vehicle groups on a ring road with two lanes interior ring lane 1 the size of a dot corresponds to the proportion of the vehicle group on each lane 98 list of tables 3 1 parameters of the metro line considered 26 3 2 the asymptotic average train time headway h 0 and frequency f 0 as functions of the total number m of trains on the line and of the difference m of the number of trains on the two branches we recognize the eight traffic phases of theorem 3 3 and corollary 3 1 31 3 3 average asymptotic train time headway h and frequency f as functions of the total number m of running trains and of the passenger travel demand level x or equivalently x three traffic phases are distinguished linear metro line parameters from ratp paris 35 4 1 nomenclature 38 4 2 parameters of the numerical example 48 5 1 results of simulation on one equipped junction 66 5 2 the results of simulation on the grid network 67 7 1 traffic on a 1 lane road on the x axis time on the y axis car position the number of cars taken into account in anticipation are 1 5 10 20 50 and 100 the length of the road is 10 000 meter the total simulation time is 500 seconds 81 8 1 parameters of the line considered 88 8 2 asymptotic average train time headway h and frequency f as functions of the number m of running trains the average passenger arrivals to platforms are given in the figure denoted by c 89 8 3 asymptotic average train dwell time w at all nodes and dwell time at platforms as functions of the number m of running trains the average passenger arrivals to platforms are given in the figure denoted by c 89 8 4 asymptotic average train safe separation time g as a function of the number m of running trains the average passenger arrivals to platforms are given in the figure denoted by c 90 113 a summary in french 1 introduction i deterministic dynamic programming based modeling 2 deterministic dyn prog based systems 2 1 deterministic dynamic programming and min plus algebra 2 2 max plus algebra 2 3 min plus system theory 2 4 network calculus 3 max plus model for the train dynamics 3 1 introduction 3 2 the max plus algebra model 3 3 extension 1 train dynamics in a metro line with a junction 3 4 the traffic phases 3 5 extension 2 train dynamics taking into account the travel demand 4 road network calculus 4 1 complements network calculus for mimo systems 4 2 the road section model 4 3 composition of 1 d traffic systems 4 4 controlled 2 d traffic systems 4 5 roads and itineraries 4 6 possible extensions and limits 5 summary of my other contributions 5 1 packet curves in network calculus 5 2 semi decentralized urban traffic control 5 3 optimal path selection for vehicular ad hoc networks 5 4 simulation of cooperative its in urban networks ii stochastic dynamic programming based modeling 6 stochastic dyn prog based systems 6 1 non expansive dynamic systems 6 2 dynamic programming systems of stochastic optimal control problems 6 3 dynamic programming systems of stochastic games 7 multi anticipation modeling 7 1 review on the piecewise linear car following modeling 7 2 anticipation modeling 7 3 stability analysis and stationary regime 7 4 transient traffic 8 demand dependent train dynamics control 8 1 natural instability of the train dynamics 8 2 stable dynamic programming model 8 3 how to fix the control parameters j and j 8 4 derivation of the asymptotic average dwell and safe separation times 8 5 numerical results 8 6 conclusion and possible extensions 9 summary of my other contributions 9 1 robust routing in road networks 9 2 logit lane assigment model 10 conclusions and perspectives