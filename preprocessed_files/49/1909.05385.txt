ar x iv 1 90 9 05 38 5 v 2 m at h o c 1 3 s ep 2 01 9 a geometrically based criterion to avoid infimum gaps in optimal control michele palladino and franco rampazzo september 16 2019 abstract in optimal control theory the expression infimum gapmeans a stricly negative difference between the infimum value of a given minimum problem and the infimum value of a new problem obtained by the former by extending the original family v of controls to a larger family w now for some classes of domain extensions like convex relaxation or impulsive embedding of unbounded control problems the normality of an extended minimizer has been shown to be sufficient for the avoidance of an infimum gaps a natural issue is then the search of a general hypothesis under which the criterium normality implies no gap holds true we prove that far from being a peculiarity of those specific extensions and from requiring the convexity of the extended dynamics this criterium is valid provided the original family v of controls is abundant in the extended family w abundance which is stronger than the mere c 0 density of the original trajectories in the set of extended trajectories is a dynamical topological notion introduced by j warga and is here utilized in a non convex version which moreover is adapted to differential manifolds to get the main result which is based on set separation arguments we prove an open mapping result valid for quasi differential quotient qdq approximating cones a notion of tangent cone resulted as a peculiar specification of h sussmann s approximate generalized differential quotients agdq approximating cone 1 introduction one of the main reason for enlarging the domain of a minimum problem relies on the aim of establishing the existence of at least one solution actually domain extension is a quite common and variously motivated practice in particular in the calculus of variations and in optimal control of course a crucial requisite of such a domain enlargement consists in the density of the original problem in the new one the extended minimum should be approximable by processes of the original problem however because of the presence of a final target even a dense extension of the domain may result in the occurrence of an infimum gap namely it can happen that the infimum value of the original problem is strictly greater than the infimum value of the extended problem this might be undesirable in many respects for instance in the convergence of numerical schemes as well as in the identification of the value function via hamilton jacobi equations this raises a natural question how can one avoid this gap phenomenon a sufficient condition for gap avoidance seems to emerge from investigations by j warga 42 43 44 45 and from some other more recent papers 28 31 32 33 34 dealing with some particular cases this criterion is the so called normality of minimizers therefore the mentioned question can be turned into the following one q under which hypotheses on a general optimal control problem normality is sufficient for gap avoidance 1 http arxiv org abs 1909 05385 v 2 in order be more precise let us briefly sketch the abstract setting of our optimal control problem the state variable y will range on a riemannian manifold m while the control maps v will belong to an original family v w l 1 0 s w where w is a subset of a metric space or to a larger set w which will be called the extended family of controls given an initial state y m and a time interval 0 s we will consider the control system e dy ds s f s y s w s y 0 y and for every w w we will use y w 0 s m the corresponding supposedly unique solution the original optimal control problem is defined as p v minimize h y v s v v y v s t where the cost function h m r is continuous and t m is a closed set called target replacing the family of controls v by the larger setw one obtains the extended optimal control problem p w minimize h y w s w w y w s t we will assume the existence of a local minimum for the extended problem namely a control w w such that for some c 0 neighbourhood o of y w h y w s h y w s for all w w such that y w s t and y w o the non occurrence of infimum gaps means that the original infimum value is unaffected by the introduction of the extended controls namely h y w s inf h y w s v v y v s t y v o for all sufficiently small neighbourhoods o of y w if on the contrary there exists a neighbourhood o such that h y w s inf h y w s v v y v s t y v o one says that the optimal control problem has an infimum gap at y w obviously via the usual reductions one can formulate a notion of infimum gap for a general bolza problem where an integral cost is involved as well for problems defined on euclidean spaces and such that the extended dynamics is convex an insightfull investigation of the gap question and its relation with normality was carried out by j warga see e g 43 more recently two specific classes of domain extentions still assuming the convexity of the extended dynamics have been studied in 28 32 33 34 as mentioned above these investigations share the fact that a certain condition turns out to be necessary for the gap occurrence a there is an infimum gap only if the minimum of the extended problem is an abnormal extremal 1 since any version of the pmp states that an optimal process y w y w w for the extended problem p w is an extremal in order for a to have a precise meaning one has to specify which version of the pontryagin maximum principle pmp one is considering in turn this is equivalent to specify which kind of approximating cones we are going to utilize for both the reachable set and the target t actually for this goal we shall introduce a generalized differential called quasi differential quotient qdq def 2 3 2 and the 1 equivalently if the minimum is normal not abnormal there is no gap 2 a qdq is a special case of sussmann s approximate generalized differential quotient 40 2 associated notion of qdq approximating cone def 2 5 let us say immediately that this choice is perhaps the most important step for the validity of the main result and while it is impossible at this stage to give an exhaustive description of what qdq approximating cones are let us point out that on the one hand they are sufficiently small for a fixed point theorem to hold true and on the other hand they are enough large to allow the utilization of the notion of abundance which as we shall see proves crucial for normality to imply no gap this said let us give the notion of extremal for simplicity we consider here only the case when the state ranges on a euclidean space moreover if c rn is a cone we use c to denote the polar cone of c namely the set of linear forms rn such that c 0 for all c c definition 1 1 extremal consider a control w w and the corresponding trajectory y y w assume that y s t and let c be a qdq approximating cone of the target t at y s we say that the process y w is an extremal with respect to h and c if there exist an absolutely continuous adjoint path w 1 1 0 s rn and a cost multiplier c 0 1 such that c 6 0 and i d ds f x s s w s ii max w w s f s y s w s f s y s w s a e s 0 s iii s c h y s c furthermore we say that an extremal y w is normal if for every choice of the pair c one has c 1 we say that an extremal y w is abnormal if it is not normal namely if exists a choice of c with c 0 as mentioned above in 32 33 34 where the original set of controls v was embedded in the set w of relaxed controls it has been shown the validity of criterion a that is if the optimal process y w is a normal extremal then an infimum gap cannot occur at y an akin result has been achieved in 28 where the system is control affine and the original set v comprises unbounded controls ranging in a convex cone in that case a space time impulsive extension is considered namely the larger set of trajectories corresponding to w comprises space time paths which are allowed to evolve along fixed time directions 3 it is worth noticing that in both the investigated cases the original set of trajectories is dense in the set of extended trajectories when the latter is endowed with c 0 topology so one might conjecture that criterion a is still valid as soon as the trajectories corre sponding to v are dense in the set of trajectories corresponding to w in fact this is not the case as shown by the simple example in appendix a 1 hence a condition stronger than density is needed for this goal we introduce kaskoz version of j warga s notion of v being abundant in w def 4 1 this condition strength ens density by requiring that the trajectories of the extended system s convexification are uniformly approached by trajectories of the original system we will further extend the notion of abundant subfamily v w to systems defined on manifolds and to fairly general classes of controls which are merely required to belong to a metric space then aiming to express normality of extended trajectories in geometric terms we invoke local set separation of the target from the original reachable set a crucial result for the achievement of the main theorem consists in showing that with this notion of abundance every needle variational cone c at y corresponding to the enlarged domain w is also a qdq approximating cone to the original reachable set theorem 4 1 the next step consists in showing that the local set separation of the target from the original reachable set implies the linear separability between a qdq approximating cone 3 it is well known that under commutativity hypotheses these paths could be regarded as measure while the measure theoretical approach is unfit for non commutative problems see e g 8 24 3 to the target and the above mentioned needle variational cone c theorem 5 1 this is exactly the point where the choice of qdq approximating cones rather then other more classical cones e g boltiansky cones plays essential by expressing this linear separation in terms of adjoint paths one finally gets the main result of the paper corollary 5 1 where under the abundance hypothesis statement a is turned into an actual theorem in section 7 we apply the main theorem to nonlinear systems whose dynamics are neither bounded nor convex finally since normality cannot be verified a priori it is important to find sufficient conditions on the data guaranteeing that all minimizers are normal this is what is provided by theorem 5 2 where a directly verifiable criterion for normality is proved to hold true in the general setting 1 1 basic notions and notation 1 1 1 linear spaces manifolds let e be a real linear space and let us use e to denote the algebraic dual of e if is a given scalar product on e 4 we will use to denote the norm associated with namely for every e e we set e e e for every e e and every real number r 0 let us use e br to denote the closed ball of center e and radius r namely e br e f f r when e 0 we will write br instead of 0 br if e 1 e 2 are real linear spaces and l lin e 1 e 2 we shall use l e to denote the element of e 2 coinciding with the image of e e 1 we will use the symbol also to mean duality furthermore if e 2 and and l lin e 1 e 2 sometimes we will use the notation l to mean the element of e 1 coinciding the image of through the dual map of l while it doesn t generate any confusion this promiscuous use of the notation makes the writing l e unambiguous for one has l e l e for all e e 1 e 2 by saying that m is a riemannian differentiable manifold we will mean that m is a differential manifold and is a riemannan metric for every x m and e f txm e f x will denote the corresponding scalar product of e f and e x e e x will be called the norm of e we will often omit the subscript and we will write e f and e instead of e f x and e x we will use d to denote the distance induced on m by we recall that if x 1 x 2 m the distance d x 1 x 2 is defined as the minimum among the lenghts of the absolutely continuous curves having x 1 x 2 as end points for any x m and any r 0 we will use b x r to denote the closed ball of radius r and center x i e b x r y m d x y r 1 1 2 cones let e be a real linear space a subset k e is a cone if k k for all k 0 k if a e is any subset we use span a to denote the smallest convex cone containing a let us introduce a notion of transversality for cones the idea of a non trivial intersection between cones which plays essential in set separation results like theorem 2 3 below is made formal is made formal by the following notion of tranversality definition 1 2 let e be a linear space and let k 1 k 2 e be convex cones we say that 1 k 1 and k 2 are transverse if k 1 k 2 k 1 k 2 k 1 k 2 k 1 k 2 e 2 k 1 and k 2 are strongly transverse if they are transverse and k 1 k 2 0 4 by scalar product we mean a positive definite symmetric bilinear form 4 transversality differs from strong transversality only when k 1 and k 2 are complemen tary subspaces proposition 1 1 let e be a linear space and let k 1 k 2 e be convex cones then k 1 k 2 are transverse if and only if either k 1 k 2 are strongly transverse or k 1 k 2 are linear subspaces such that k 1 k 2 e definition 1 3 let e be a finite dimensional linear space and let e be its dual space for any subset a e the convex cone a p e p w 0 w a e where the symbol denotes duality will be called the polar cone of a the transversality of two cones is equivalent to their linearly separability more pre cisely proposition 1 2 two convex cones k 1 and k 2 are not transverse if and only if k 1 k 2 0 6 namely there exists a linear form 6 0 such that k 1 0 k 1 k 1 and k 2 0 k 2 k 2 in this case one also says that k 1 and k 2 are linearly separable 1 1 3 scorza dragoni points definition 1 4 scorza dragoni point given a compact set x m and an interval a b r a b let us consider a function a b x rn verifying i a b s 7 s y rn is measurable for each y x ii x y 7 s y is continuous for each s a b we say that s a b is a scorza dragoni point for if for all y x lim r 0 lim 0 1 s s r s y ds 0 1 1 where r s y sup x x x y r d s x s y 1 2 we shall use sd to denote the set of all the scorza dragoni points for the function notice in particular that if s sd one has lim x y 0 s x s y 1 3 for any y x the importance of scorza dragoni points relies on the fact they they form a full measure set 36 theorem 1 1 scorza dragoni the set of all the scorza dragoni points of a caratheodory function a b x rn has measure equal to b a 2 set separation and open mappings 2 1 quasi differential quotients in order to state the set separation theorem th 2 3 we need the notion of quasi dif ferential quotients approximating cone to a set e at a point of its boundary for this purpose let us introduce the notion of quasi differential quotient which in turn is a 5 particular case of sussmann s approximate generalized differential quotient 40 the corresponding set separation theorem is based on an open mapping we prove below let us recall the notion of cellina continuously approximable set valued function which is the building block in the definition of approximate generalized differential quotient definition 2 1 cca let f rn rn be a set valued map we say that f is a cellina continuously approximable cca set valued map if for any compact set k rn the restriction of f on k has compact graph that is the set gr f k x y k rn y f x is compact and there exists a sequence of single valued continuous maps fk k r n k n such that the following condition holds for every open set satisfying gr f k there exists k such that gr fk x y k r n y fk x for every k k we will say that a function 0 0 is a a pseudo modulus if it is mono tonically nondecreasing and lims 0 s 0 0 we call modulus a pseudo modulus taking values in 0 definition 2 2 agdq assume that f rn rn is a set valued map y rn rn lin rn rn is a compact set and rn is any subset we say that is an approximate generalized differential quotient agdq of f at y in the direction of if there exists a pseudo modulus having the property that for every 0 such that there exists cca set valued map a b lin r n rn rn such that inf l l l h and y l h f 5 whenever b and l h a we will use a subclass of agdqs which we call the quasi differential quotients their main property consists in the validity of an actual not punctured open mapping theorem see theorem 2 2 below definition 2 3 qdq assume that f rn rn is a set valued map y rn rn lin rn rn is a compact set and rn is any subset we say that is a quasi differential quotient qdq of f at y in the direction of if there exists modulus 0 0 having the property that for every 0 there exists a continuous map l h b lin r n rn rn such that min l l l h and y l h f whenever b definition 2 4 agdq and qdq on manifolds let n m be c 1 riemannian manifolds assume that f n m is a set valued map y n m lin t n tym is a compact set and n is any subset moreover let u rn and v rn be charts defined on neighbourhoods u and v of and y respectively and assume that 0 y 0 consider the map f 1 u rn and extend it arbitrarily to a map f rn rn we say that is an approximate generalized differential quotient agdq resp a quasi differential quotient qdq of f at y in the direction of if d y d 1 0 is an approximate generalized differential quotient resp a quasi differential quotient of f at 0 0 in the direction of u as pointed out in 40 this definition is intrinsic that is it is independent of the choice of the charts and 5 here denotes the operator norm namely m sup v 1 m v for every linear operator m lin rn rn 6 2 2 open mapping results theorem 2 1 directional open mapping let n n be positive integers and let be a convex cone in rn let f rn rn be a set valued map and let be a agdq of f at y in the direction of let us assume that there is an element w rn such that w int l for every l then there exist a closed convex cone d rn and positive constants verifying w int d and y ba 0 d f ba for all a 0 2 4 if one takes w 0 in the statement of theorem 2 1 the cone d necessarily coincides with the whole rn as a consequence one obtains the following punctured open mapping theorem corollary 2 1 punctured open mapping 6 let n n be positive integers and let be a convex cone in rn let f rn rn be a set valued map and let be an qdq of f at y in the direction of let us assume that is surjective by which we mean that l rn for every l then there are positive constants verifying y ba 0 f ba for all a 0 2 5 if we replace agdq s with qdq we get a real non punctured open mapping result theorem 2 2 open mapping let n n be positive integers and let be a convex cone in rn let f rn rn be a set valued map and let be a gdq of f at y in the direction of as above let us assume that is surjective by which we mean that l rn for every l then the following statements i ii hold true i there are positive constants having the property that y ba 0 f ba for all a 0 2 6 ii there exists 0 such that for every and every l h as in definition 2 3 there exists b such that y l h f 2 7 in particular by possibly reducing the size of one gets the open mapping inclusions y ba f ba for all a 0 proof without loss of generality we can assume y 0 0 and since a qdq is an agdq it is sufficient to prove only statement ii namely for every 0 sufficiently small we have to establish the existence of a b such that 0 l h 2 8 for every 0 let us define the set valued map l 1 r b lin r n rn by setting for every b l 1 r m lin rn rn l m idrn namely l 1 r is the set of right inverse of l let us first observe that for every b and sufficiently small l 1 r is non empty indeed it contains the moore penrose pseudo inverse m l tr l l tr 1 6 the adjective punctured here refers to the fact that y does not belong the image f ba 7 where tr denotes transposition furthermore it is trivial to verify that the set valued map l 1 r is convex valued finally by possibly reducing the size of for every 0 the set valued map l 1 r has compact graph indeed there exist a constant k 0 such that is a compact subset made of linear operators whose right inverse are bounded in the operator norm by k moreover let us consider a sequence m m n b converging to b and for every m n let us choose mm l 1 r m hence one has that l m mm idrn and since the sequence mm ranges in a compact set there exists a subsequence mmk converging to a linear operator m in particular l m lim k l mk mmk idrn so that m l 1 r this proves that the set valued map 7 l 1 r has compact graph now consider the set valued map b r n defined by setting m h m l 1 r b to prove that this map has non empty values for every b it is sufficient to determine a linear mapping m rn rn and an element v such that l m w w w rn m l 1 r m h v 2 9 fix b and choose v verifying l v h such a v exists since l is surjective now a geometrical intuition suggests that m might be obtained by adding a suitable linear operator to an element of l 1 r for instance the linear operator m actually following 40 if is any scalar product on rn we define the linear map m rn rn by setting for every w rn m w m w w h h h v m h it is straightforward to verify thatm verifies conditions 2 9 so that is not empty since for every the map h is continuous and h by possibly reducing the size of we conclude that for every 0 the set valued map verifies b b and has non empty convex values and a closed graph since the domain of is compact and convex the set valued map verifies the hypotheses of the kakutani fixed point theorem so that there exists b such that it follows that there is a matrix m l 1 r such that 0 m h therefore one gets 0 l m h l h which concludes the proof 2 3 qdq approximating cones and set separation assume that m is a c 1 differentiable manifold e m and z e if x is a linear space let us call convex multicone in x any family of convex cones of x definition 2 5 an agdq approximating multicone resp a qdq approximating multi cone to e at z is a convex multicone c tzm such that there exist a non negative integer n a set valued map f rn m a convex cone rn and an agdq resp a qdq of f at 0 z in the direction of such that f e and c l l in the particular case when an agdq approximating multicone resp a qdq approx imating multicone is a singleton namely l for some l lin rn rn we say that c l is an agdq approximating cone resp a qdq approximating cone to e at z 8 let us introduce the notion of local set separation definition 2 6 let x be a topological space and let us consider two subsets a 1 a 2 x and a point z a 1 a 2 we say that a 1 and a 2 are locally separated at z provided there exists a neighborhood v of z such that a 1 a 2 v z we are now ready to state our set separation result which connects set separation with the linear separability of qdq approximating cones furthermore the result includes a special property in the case when the approximating cones are complementary linear subspaces theorem 2 3 set separation let e 1 e 2 be subsets of m and let z e 1 e 2 assume that c 1 c 2 are agdq approximating cones of e 1 and e 2 respectively at z i if c 1 and c 2 are strongly transverse then the sets e 1 and e 2 are not locally separated ii if moreover 1 c 1 c 2 are qdq cones 2 c 1 and c 2 are complementary linear subspaces i e c 1 c 2 tzm 3 for each i 1 2 i r ni is a convex cone fi r ni m is a set valued map and i l i lin rni tzm is a qdq of fi at 0 z in the direction of i fi i ei and ci l i i then there exists a sequence 1 k 2 k 1 2 such that zk f 1 1 k f 2 2 k and zk z remark 2 1 property ii whose proof is based on the open mapping result stated in theorem 2 2 is not true if we replace qdq approximating cones with agdq approxi mating cones of course this is connected with the non validity of a non punctured open mapping result for agdq s proof of theorem 2 3 statement i of theorem 2 3 is direct consequence of 40 theorem 4 37 where an analogous result concerning the non separation of multicones is provided let us prove statement ii because of the local character of the statement there is not loss of generality in considering only the euclidean case when m rn for every i 1 2 let ni 0 be the dimensions of the subspace ci so that n 1 n 2 n and let ni 0 an integer such that i r ni by hypothesis for every i 1 2 there exists a modulus i 0 0 having the property that for every 0 there exists a continuous map li h i b i lin r ni rni rni such that li i l i i h i i and z l i i i h i i fi i whenever i b i let us consider the cone 1 2 r n 1 n 2 and the set valued map f rn defined by setting f 1 2 f 2 2 f 1 1 z 2 z 1 z 1 z 2 f 1 1 f 1 2 1 2 1 2 and observe that if 1 2 is such that 0 f 1 2 then 6 f 2 2 f 1 1 e 2 e 1 furthermore let us set 1 2 and let us define the continuous map l h 1 2 l 2 2 l 1 1 h 2 2 h 1 1 1 2 b 9 defining the linear map l lin rn 1 n 2 rn by setting l v 1 v 2 l 2 v 2 l 1 v 1 one obtains l 1 2 l h and l 1 2 1 2 h 1 2 f 1 2 whenever 1 2 b hence is a qdq of f at 0 0 moreover one has l c 1 c 2 r n so that by the open mapping result stated in theorem 2 2 for k n sufficiently large we get the existence of 1 k 1 1 k 2 b 1 k 1 2 such that setting 1 k 2 k 1 k 1 2 k 2 one has zk z l 1 1 k 1 k 1 k h 1 1 k 1 k z l 2 1 k 2 k 2 k h 2 1 k 2 k f 1 1 k f 2 2 k notice that by h 11 k 1 k 1 1 k 1 k and 1 k 1 k one has lim k zk z which concludes the proof 3 gaps and set separation 3 1 original and extended controls let m be a riemannian c 2 differentiable manifold let 0 s be a time interval and letw be a metric space which we call the set of control values for every s w 0 s w let m y 7 y f s y w tm be a vector field we will consider two families of controls v w l 1 0 s w with v w we will call v and w the original family of controls and the extended family of controls respectively let us choose an initial point y m and for any control map w w let us consider the cauchy problem e dy ds s f s y s w s a e s 0 s y 0 y we shall assume the following regularity hypothesis hypothesis sh i for each s w 0 s w the vector field y 7 f s y w is of class c 1 on m ii there exists an integrable function c l 1 0 s r such that for a e s 0 s f s y w c s df s y w c s 3 10 for every y w m w iii for every y w m w the map s 7 f s y w is measurable iv for every s 0 s the map y w 7 f s y w is continuous in particular for every w w there exists a unique trajectory y w of e let us fix a closed set t m which we will refer to as target remark 3 1 of course through standard cut off arguments in many situations one can replace ii in hypothesis sh with a weaker assumption concerning a neighbourhood of y 0 s istead of the whole state space m definition 3 1 for any control v v resp w w the pair y v y v v resp y w y w w will be called original process resp extended processes an extended process in particular an original process y w is called feasible if y s t 10 3 2 infimum gaps let us endow the set of controls w with the pseudo distance df defined as df w 1 w 2 d y w 1 y w 2 max s 0 s d y w 1 s y w 2 s 3 11 for all controls w 1 w 2 w the set rv y v s v v m 3 12 will be called the original reachable set and the set rw y w s w w m 3 13 will be called the extended reachable set we will also consider local versions of the above reachable sets precisely for a given extended process y w and r 0 we set r w r v y v s v v df w v r r w r w y w s w w df w w r clearly rw rv and r w r w r w r v for all r 0 the occurrence of a local infimum gap is captured by the following definition definition 3 2 let y w be a feasible extended process such that y s rw rv we say that y w satisfies the infimum gap condition if for any continuous cost function h rn r there exists r 0 such that one has h y s inf h y y r w r v t 3 14 despite the name the infimum gap condition 3 14 is clearly a fully dynamical prop erty actually it could be as well rephrased in terms of supremum gap or even indepen dently of any optimization procedure as shown in lemma 3 1 below definition 3 3 let y w be a feasible extended process such that y s rw rv we say that y w is isolated from v if for some r 0 the sets r w r v y s and t are locally separated at y s namely there exists a neighborhood n m of y s such that r w r v y s t n y s lemma 3 1 let y w be an extended feasible process such that y s rw rv then the following conditions are equivalent i y w satisfies 3 14 for a given continuous cost function h and r 0 ii the process y w is isolated from v iii the process y w satisfies the infimum gap condition furthermore the right hand side of 3 14 is equal to proof we give a proof just for the sake of completeness all arguments being trivial let us start proving that i implies ii this means that one has to show that there exists r 0 such that r w r v t r r 3 15 assume that 3 15 is false which means that there exists a sequence rn 0 such that r w rn v t 6 for all natural n this implies that there exists a sequence yk k n verifying 11 yk r w rk v t for every k n so that yn y s which in view of the continuity of h contradicts i hence 3 15 holds true from which we get ii let us now prove that ii iii by hypothesis there exists a neighborhood n of y s such that r w r v y s t n y s since y s rw rv by possibly reducing the size of r 0 one obtains that r w r v t which obviously implies iii with the right hand side of 3 14 equal to finally the relation iii i is trivial 4 abundance our main results namely theorem 5 1 and corollaries 5 1 and 5 2 strongly rely on a property introduced by j warga and called abundance it consists in a particular pervasiveness of v in w which happens to be stronger than density in fact because of the presence of a closed final constraint the mere density of rv into rw is not enough in order to normality to be a sufficient condition for gaps avoidance see subsection a 1 we will make use of a generalization of abundance provided in 21 and we will extend it to manifolds for every positive integer n let n be the convex hull of the union of the origin with the n simplex namely n 1 n rn n j 1 j 1 j 0 j 1 n for any n let us consider the control system on m dy ds s f s y s w s w 1 s wn s y 0 y 4 16 where i the control w w 1 wn belongs to w 1 n and ii the vector field f is defined by setting for every s y 0 s m and w w 1 wn w 1 n f s y w w 1 wn f s y w n i 1 i f s y wi f s y w for every value of the parameter n and every control w w 1 wn w 1 n let us use y w w 1 wn to denote the corresponding solution of 4 16 7 notice in particular that y w y w w w for all w w and for all n definition 4 1 21 we say that a subclass of controls v w is abundant in w if for every integer n every 1 n tuple of controls w w 1 wn w 1 n and every 0 there exists a continuous mapping w w 1 wn n v such that d y w w 1 wn s y w w 1 wn s n 4 17 a sufficient condition for abundance based on concatenation is given in proposition 4 1 below 7 under hipothesis sh such a solution exists and is unique 12 definition 4 2 we say that a set of controls v satisfies the concatenation property if for every s 0 s and for any v 1 v 2 v one has v 1 0 s v 2 s s v 8 where we have used e to denote the indicator function of a subset e 0 s proposition 4 1 21 assume that the subfamily v w satisfies the concatenation property and is dense in w with respect to the pseudo metric df then v is an abundant subset of w the proof of this result for the special case when m rn was given in 21 theorem iv 3 9 by developing some arguments in 18 the required obvious changes to prove the result on a riemannian manifold reduce to a reformulation of estimate 4 17 in local coordinates so we omit them 4 1 approximating the original reachable set by extended cones let us fix a a feasible extended process y w and for any s s 0 s s s let m s s ty s m ty s m denote the differential of the diffeomorphism established by the differential equation y f s y w from a neighborhood of y s to a neighborhood of y s as is known s m s s is the solution of the variational cauchy problem having the following coordinate representation dm ds s f y s y s w s m s m s s idty s m 4 18 definition 4 3 consider a positive integer n n control values w 1 wn w and n instants s 1 sn sd f w sd f w 1 sd f wn 9 0 s 1 sn s the convex cone c s 1 sn w 1 wn span m s si f si y si wi f si y si w si i 1 n ty s m will be called extended variational cone corresponding to the feasible extended process y w the following result can be regarded as claiming a sort of infinitesimal thickness of v in w theorem 4 1 let the original family of controls v w be abundant in w and let a feasible extended process y w be given consider a positive integer n n control values w 1 wn w and n instants s 1 sn sd f w sd f w 1 sd f wn 0 s 1 sn s then for any r 0 the extended variational cones c s 1 sn w 1 wn is a qdq approximating cone to r w r v y s at y s remark 4 1 while the fact thatc s 1 sn w 1 wn is a qdq approximating cone to the extended reachable set r w r w at y s for any r 0 is a classical argument utilized in the proof of the maximum principle 10 the fact that c s 1 sn w 1 wn is a first order approximation for the small reachable set r w r v is anything but obvious it means in a sense that this cone is not too large 8 concatenation is weaker than decomposability of a set s of paths on an interval a b 16 23 30 which prescribes that for any pair of paths v 1 v 2 s and any measurable set e 0 s one has v 1 e v 2 0 s e s 9 we have used the notation sd introduced in subsection 1 1 to mean the full measure scorza dragoni set of a function s y 10 actually the same is true for other more classical cones e g the boltyanski cone and the regular tangent cone 13 proof of theorem 4 1 we will prove this theorem assuming that m is an open subset of rn so that we can identify ty s m with r n clearly this is not restrictive because of the local character of the result let c s 1 sn w 1 wn be an extended variational cone let us set s 0 0 and for every i 1 n consider a number i si si 1 and the control w i i s w s s 0 s si i si wi s si i si 4 19 let us set n 2 min si si 1 i 1 n let us define the set valued map f rn rn as f y 2 w w n 1 w n n s 0 rn 4 20 where rn n denotes the orthogonal projection on n which because of the convexity of n is a continuous single valued map notice that by construction f rv for every r n for each 0 and n b let us choose 1 n 1 n n from 4 24 in lemma 4 1 below it follows that y w w n 1 w n n s y w w n 1 w n n s y s 1 n n i 1 im s si f si y si wi f si y si w si 4 21 for every n b where 0 n b r n is a continuous function which verifies max n b o in view of the abundance property for each 0 and n b there exists 0 n b r n such that y 2 w w n 1 w n n s y w w n 1 w n n s for all n b with max n b 2 therefore y 2 w w n 1 w n n s y s 1 n n i 1 im s si f si y si wi f si y si w si h 4 22 where h observe that h b 4 23 where we have set max n b for every 0 let us define the map a n b lin r n rn rn 7 a l h where l is the linear map defined as l b 1 n n i 1 bim s si f si y si wi f si y si w si b rn 14 notice that because of the continuity w r t of the left hand side of 4 22 for every 0 the map 7 a is continuous by rewriting relation 4 22 as y 2 w w n 1 w n n s y s l h we get y s l h f which means that l is a qdq of f at 0 y s in the direction of the set n therefore is also a qdq of f at 0 y s in the direction of the cone 0 n since c s 1 sn w 1 wn l one concludes that c s 1 sn w 1 wn is a qdq approximating cone to rv y s at y s lemma 4 1 fix n then the map y w w 1 1 w n n s verifies y w w 1 1 w n n s y s n i 1 i im s si f si y si wi f si y si w si 4 24 where is a continuous function verifying max n o proof let us begin proving the lemma in the case when n 1 and 0 1 one has y w w 1 1 s 1 y s 1 y w w 1 1 s 1 1 y s 1 1 s 1 s 1 1 f s y w w 1 1 s w s w 1 f s y s w s ds s 1 s 1 1 f s y w w 1 1 s w s w 1 f s y s w s ds 1 f s 1 y s 1 w s 1 w 1 f s 1 y s 1 w s 1 1 1 2 1 1 f s 1 y s 1 w 1 f s 1 y s 1 w s 1 1 1 2 1 4 25 where 1 1 s 1 s 1 1 f s y w w 1 1 s w s w 1 f s 1 y s 1 w s 1 w 1 ds 2 1 s 1 s 1 1 f s 1 y s 1 w s 1 f s y s w s ds to simplify the notation in what follows we will write y s in place of y w w 1 1 s using hypothesis sh ii one obtains the following estimate y s 1 y s 1 s 1 s 1 1 f s y s w s f s y s w s ds s 1 s 1 1 f s y s w 1 f s y s w s f s y s w s f s y s w 1 ds s 1 s 1 1 f s y s w 1 f s y s w s ds 1 2 s 1 s 1 1 c s y s y s ds s 1 s 1 1 f s y s w 1 f s y s w s ds 4 26 15 setting for s s 1 1 s 1 s s s 1 1 f s y s w 1 f s y s w s ds 4 27 it follows from the gronwall s lemma that y s 1 y s 1 s 1 s 1 s 1 1 1 2 c s exp 1 2 c s s 1 s s ds 2 s 1 s 1 1 c s ds o 1 0 4 28 when 1 0 therefore y s y s 1 y s y s 1 y s 1 y s 1 1 4 s 1 s 1 1 c s ds o 1 4 29 since s 1 is a scorza dragoni point of f w and f w 1 and the maps y 7 f s y w s y 7 f s y w 1 are lipschitz continuous in a neigh bourhood of y 0 s in view of 4 28 4 29 one easily gets max 1 1 0 1 o 1 2 1 o 1 4 30 if we set 1 1 1 2 1 it follows by estimates 4 25 and 4 30 that y w w 1 1 s 1 y s 1 1 f s 1 y s 1 w 1 f s 1 y s 1 w s 1 1 hence one has d d 1 y w w 1 1 s 1 1 0 f s 1 y s 1 w 1 f s 1 y s 1 w s 1 which by the basic theory of linear ode s implies that d d 1 y w w 1 1 s 1 0 m s s 1 d d 1 y w w 1 1 s 1 1 0 m s s 1 f s 1 y s 1 w 1 f s 1 y s 1 w s 1 therefore the lemma is proved for n 1 and for any 0 1 the general case n 2 is easily obtained by a finite induction argument the latter doesn t present any new difficulty with respect to the proof of the case n 1 moreover is almost verbatim the one utilized in the proof of the pontryagin maximum principle when passing from single to multiple finitely many needle variations see e g 35 theorem 4 2 1 for this reason we omit it the reason why we have adopted qdq approximating cones as tangential objects relies on the validity of the following result 11 theorem 4 2 let the original family of controls v w be abundant in w and let a feasible extended process y w be given consider a positive integer n n control values w 1 wn w and n instants s 1 sn sd f w sd f w 1 sd f wn 0 s 1 sn s moreover let c be a qdq approximating 11 such a result would be not true if we chose to utilize agdq approximating cones 16 cone to the target t at y s if c s 1 sn w 1 wn and c are complementary subspaces i e c s 1 sn w 1 wn c ty s m then there exists a sequence zk k n rv t such that lim k zk y s proof in view of theorem 4 1 c s 1 sn w 1 wn is a qdq approximating cone to rv y s at y s furthermore since c is a qdq approximating cone to the target t at y s there exist a positive integer m a set valued map g rm m a convex cone rm and a quasi differential quotient l of g at 0 y s in the direction of such that g t and c l in order to conclude the proof it is enough to apply theorem 2 3 ii with c 1 c s 1 sn w 1 wn c 2 c n 1 n n 2 m 1 0 n 2 f 1 defined as in 4 20 and f 2 g this concludes the proof 5 the main result theorem 5 1 a geometric principle for gaps let us assume that the family of controls v is abundant in w let y w be a feasible extended process satisfying the infimum gap condition then any qdq approximating cone c to t at y s is linearly separable from any extended variational cone c s 1 sn w 1 wn i e there exists a non zero linear form t y s m such that c 1 0 c 2 c 1 c 2 c s 1 sn w 1 wn c let us give the definition of abnormal extremal normal h extremal and h abnormal extremal definition 5 1 abnormal extremal let y w be a feasible extended process and let c be a qdq approximating cone to the target t at y s we say that the process y w is an abnormal extremal with respect to c if there exists a lift y w 1 1 0 s t m of y verifying the following conditions i d ds f y s y s w s ii max w w s f s y s w s f s y s w s a e s 0 s iii s c iv 6 0 definition 5 2 h extremal let y w be a feasible extended process let a cost function h m r be differentiable at y s and let c be a qdq approximating cone of the target t at y s we say that the process y w is an h extremal with respect to h and c if there exist a lift y w 1 1 0 s t m of y and a cost multiplier c 0 1 such that i d ds f y s y s w s ii max w w s f s y s w s f s y s w s a e s 0 s iii s c h y s c iv c 6 0 furthermore we say that an h extremal y w is normal if for every choice of the pair c one has c 1 we say that an h extremal y w is abnormal if it is not normal namely if exists a choice of c with c 0 17 remark 5 1 though these definitions have intrinsic meanings we have chosen to adopt a notation reminiscent of coordinates of course the adjoint equation i might be expressed when coupled with the dynamics as the hamiltonian system d dt y xh s x j dh s x where h t m r is the maximized hamiltonian defined by setting h s x max w w s f s x w s x 0 s t m and xh is the hamiltonian vector field namely xh j dh j being the symplectic matrix and d the differential operator with respect to x and let us also point out that the dot has obvious different meanings according to the context for instance in i of the definitions above it denotes a linear operator on the cotangent space while in ii it denotes the duality product observe that every abnormal extremal is an abnormal h extremal for any cost h differ entiable at y s while every abnormal h extremal is an abnormal extremal we are now ready to state our main result on infimum gaps corollary 5 1 normality no gap criterion let us assume that the family of controls v is abundant in w if a feasible extended process y w satisfies the infimum gap condition then for every qdq approximating cone c to t at y s y w is an abnormal extremal with respect to c when referred to a specific cost h the contrapositive version of this theorem provides a sufficient condition for the absence of local infimum gaps precisely corollary 5 2 a sufficient condition for avoiding infimum gaps let us assume that the family of controls v is abundant in w and let y w be a feasible extended process let h m r be a cost function differentiable at y s and let y w be a normal h extremal for some qdq approximating cone c to t at y s then there is no infimum gap at y w as we have mentioned in the introduction the relation between gap phenomena and abnormality has been quite investigated in two cases of embeddings the embedding of bounded optimal control problems into their convex relaxation 32 33 34 and the embed ding of unbounded convex control systems into their impulsive space time closure 28 since the original control families in such embeddings turn out to be abundant in their extensions these kinds of results can be also obtained by theorem 5 1 12 in section 7 we are going to present a new application to a dynamics which is neither convex nor bounded 5 1 a verifiable sufficient condition for normality in practical situations it may be difficult or even impossible to directly verify the normality of an extremal which in view of corollary 5 2 would guarantee the absence of gaps this motivates theorem 5 2 below which provides a sufficient condition on the data of the problem in order for the extremals to be normal in the following definition we assume that a control system dy ds s f s y s w s w w a e s 0 s 5 31 as above is given with an initial condition y 0 y 5 32 and still we use rw to denote the reachable set from y 12 although the use of different types of cones describing the non transversality condition makes theorem 5 1 and the results in 28 32 33 34 distinct see 31 for the details 18 definition 5 3 consider a point y t and let c ty m be a qdq approximating cone of t at y if s 0 we say that the point y is c needle controllable with respect to 5 31 5 32 at s if for every c 0 there exist 1 0 and 2 0 s such that inf w w sup w w f s y w f s y w 1 a e s s 2 s 5 33 theorem 5 2 consider a feasible process y w 0 s m w of 5 31 5 32 let c be a qdq approximating cone to t at y s and let y s be c needle controllable at s then the process y w is not an abnormal extremal so in particular it does not satisfy the infimum gap condition proof assume by contradiction that the extremal y w is abnormal namely that there exists an absolutely continuous lift y 0 s t m of y such that 6 0 s c and the inequality s f s y s w f s y s w s 0 5 34 holds true for almost every s 0 s i 0 and every w w i 0 having lebesgue measure equal to zero taking s in 5 33 we deduce that there exist 1 2 0 and a neighbourhood u t m of y s such that for all y p u sup w w p f s y w f s y w 1 2 w w a e s s 2 s now by choosing 0 2 sufficiently small for every s s s one has y s s u so that sup w w s f s y s w f s y s w 1 2 w w a e s s s in particular for all s s s i 0 sup w w s f s y s w f s y s w s 0 which contradicts the maximization relation 5 34 6 proofs of the main results 6 1 proof of the geometric principle theorem 5 1 by a basic result on control system see e g 35 9 c s 1 sn w 1 wn turns out to be a qdq approximating cone to the local extended reachable set r w r w at y s 13 more importantly theorem 4 1 states that c s 1 sn w 1 wn is also a qdq approximating cone to the local original reachable set r w r v y s at y s therefore by lemma 3 1 the sets r w r v y s and t are locally separated at y s which by theorem 2 3 i implies that the cones c s 1 sn w 1 wn and c are not strongly transverse since linear separability is equivalent to non transversality proposition 1 2 we have to prove that these cones are not transverse as well indeed in view of proposition 1 1 the only case in which they might happen to be transverse and not strongly transverse is the one in which the cones are complementary subspaces of ty s m however such an instance is excluded by theorem 4 2 and the occurrence of an infimum gap in fact if c s 1 sn w 1 wn and c satisfy c s 1 sn w 1 wn c ty s m then theorem 4 2 assures the existence of a sequence yk k n rv t such that yk y s which contradicts the fact that y w verifies the infimum gap condition this concludes the proof 13 for instance it is well known that c s 1 sn w 1 wn is a boltyanski approximating cone to r w r w at y s see e g 39 furthermore a boltyanski approximating cone is clearly a qdq approximating cone 19 6 2 proof of the normality no gap criterion corollary 5 1 by theorem 5 1 the cones c s 1 sn w 1 wn and c are linearly separable this means that there exists ty s m 0 such that c c s 1 sn w 1 wn now let us set s m s s where m s s is the fundamental matrix defined in 4 18 so that 6 0 s c d ds s s f y s y s w s for a e s 0 s by c s 1 sn w 1 wn it follows that for every i 1 n 0 m s si f si y si wi f si y si w si m s si f si y si wi f si y si w si si f si y si wi f si y si w si 6 35 therefore the lift y verifies i iv of definition 5 1 except that iii is verified only for every finite set of pairs si wi 0 s w i 1 n such that s 1 sn sd f w sd f w 1 sd f wn 0 s 1 sn s to conclude the proof we have to show the validity of iii in the whole control value set w and almost all times this is achieved through non empty intersection arguments borrowed from those utilized in 39 to prove the maximum principle 6 2 1 the case of a finite subset of controls let us consider a finite subset of control values w w and let us set e w w w sd f y w sd f y w 0 s since w is finite e w has measure equal to s therefore by lusin s theorem we can write e w j 0 ej 6 36 where e 0 has zero measure and for every j the set ej is compact and for every w w the restrictions to ej of the map s 7 rw s f s y s w f s y s w s is continuous for every j let dj be the set of density points 14 of ej since for every natural number j ej and dj have the same measure one obtains that 15 meas e w meas d where we have set d j 0 dj now let f be an arbitrary non empty subset of d w and let us define the subset f w ty s m by setting f w ty s m 1 verifies p f where property p f is as follows 14 we recall that an element t b r is a density point for b if lim 0 meas t t 2 1 15 for every measurable subset a 0 s meas a denotes the lebesge measurable of a 20 property p f the pair y w 1 1 0 s t m is a lift of y such that 1 s c 2 d ds f y s y s w s a e s 0 s 3 s f s y s w s s f s y s w for every s w f notice that for every subset f d w f w is compact and moreover f 1 f 2 w f 1 w f 2 w for all f 1 f 2 d w by theorem 5 1 f w 6 as soon as f is finite and can be written as f s 1 w 1 sm wm 0 s 1 si sm s wi w claim one has f w 6 even when f is an arbitrary finite subset of d w namely f can be written as f s 1 w 1 sm wm 0 s 1 si sm wi w indeed every si belongs to a suitable dh which can be labelled as dh i since dh i is made of density points there exist sequences si j such that si j dh i j si lim j si j and s 1 j sm j j n set fj si j w 1 sm j wm so that fj w 6 and choose j fj w since j 1 for all j by possibly taking a subsequence we can assume that j j n con verges to some for every s s 1 s define the lifts y y j w 1 1 s 1 s tm of y such that s j s j and both satisfying the equation d ds f y s y s w s a e s s 1 s the mapping s 7 j s satisfies the inequality j si j f si j y si j w si j j si j f si j y si j w for all j n every i 1 m and w w since for every i 1 m the map s 7 rwi s f s y s wi f s y s w s is continuous on dh i the function s 7 j s r wi s is also continuous on dh i so passing to the limit we can conclude that si f si y si w si si f si y si w for every i 1 m and w w since one also has 0 6 s c the claim is proved 6 2 2 the general case of an infinite control set up to now we have shown that if w is finite and f d w is finite and we write card f then f w is a nonempty compact set we now conclude the proof 21 throgh a standard non empty intersection argument see e g 39 if we take a finite family f 1 f r d w such that card fi for every i 1 r one has f 1 w f r w f 1 f r w 6 for card f 1 f r hence f w f d w cardf is a family of compact subsets such that each finite intersection is nonempty this implies that the infinite intersection of all f w such that cardf is nonempty therefore d w w card f f w card f f w 6 to end the proof in the general case when card w is infinite for any arbitrary subset w w define w ty s m 1 verifies pp f where property pp f is as follows pp f the pair y w 1 1 0 s t m is a lift of y such that 1 s c 2 d ds f y s y s w s a e s 0 s 3 for each w w there exists a subset of full measure iw 0 s such that s f s y s w s s f s y s w for every s iw w w so proving theorem 5 1 is equivalent to showing that w 6 6 37 since w card w w 6 38 once again we have to show that the possibly infinite family w card w has non empty intersection this can easily achieved by the same arguments as above indeed w is not empty and compact as soon as w is finite furthermore for every w 1 w 2 w one has w 1 w 2 w 1 w 2 in particular the family w card w is made of compact subsets and sat isfies the finite intersection property that is the intersection of any finite finite subfamily w card w is not empty therefore it has non empty intersection namely w card w w 6 this concludes the proof of theorem 5 1 22 7 an application to non convex unbounded problems impulsive optimal control problems where the dynamics is unbounded have been exten sively studied together with their applications 3 4 5 8 10 11 13 14 19 20 22 24 25 37 46 the space time representation see 7 40 below can be regarded as an extension of unbounded control systems an important case is the one of a minimum problem with of control affine dynamics p minimizeh t 2 x t 2 t 2 over t 2 r t 2 t 1 x u ac t 1 t 2 m r l 1 t 1 t 2 u such that dx dt t f t x t m j 1 gj t x t u j t a e t t 1 t 2 d dt t u t a e t t 1 t 2 x t 1 t 1 x 0 t 2 x t 2 t 2 t 0 k here the set u where the controls u take values is unbounded furthermore the state x range over a n dimensional riemannian manifold m of class c 2 and the time dependent vector fields f g 1 gm are of class c 1 in x measurable in t and uniformly bounded by a l 1 map moreover the cost h r m r r is a continuous function t 1 x r m is a fixed initial condition k is a non negative fixed constant possibly equal to and the end point constraint t r rn is a closed subset notice incidentally that the function t coincides with the l 1 norm of the control function u u 1 u 2 um on the interval t 1 t the gap abnormality criterion for this kind of systems where one considers the space time extension 7 40 below has been already investigated in the case when the set of controls u is a convex cone 28 actually thanks to corollary 5 1 see also 31 the main result in 28 can be extended to the case in which the state ranges on a riemannian manifold however the generalization made possible by corollary 5 1 allows one to go much further indeed in what follows we are able to deduce from corollary 5 1 that the gap abnormality criterium holds true also in the situation when the control set u is unbounded but is neither convex nor a cone more precisely we will consider the following two cases case i space time convex extension the controls take values on a necessarily un bounded subset u rm such that cou is a convex cone of rm where we have used coe to denote the convex hull of a subset e rm for instance one could consider the set u nm so that co u 0 m case ii space time non convex extension the controls take values on a necessarily unbounded subset u rm such that r u 0 u r s t u u 7 39 notice that if for a given set e we consider the conic e re r e 0 e a cone which we call the conic envelope of e hypothesis 7 39 implies that inf u u d u conic u 0 for instance one could consider the set u n 2 0 0 m 3 m n n so that conic u 0 0 0 0 remark 7 1 we will treat case i in detail describing the extension to the convex space time system obtained by both convexification of the dynamics and the closure of 23 suitably reparameterized processes instead we will only suggest the needed changes to deal with case ii where the only extension comes from reparameterization however case ii is somehow more significative in that it marks the most important improvement with respect to the former literature initiated by warga s work indeed in this case not only the original dynamics but also the extended dynamics is non convex this can be of interest in those application where the convexification of the dynamics is not needed for instance because one gets existence of minima without invoking convexification 7 1 case i space time convex extension in order to formulate this problem by means of the terminology adopted in theorem 5 1 we need to embed our system into a suitably extended one to this aim we need to perform both a compactification to manage unboundedness and a convexification let us begin by setting a a a 1 an 3 0 1 n 3 n 3 i 1 a i 1 a l 1 0 s a w w 0 w 0 cou w 0 w 1 w l 1 0 s w v v 0 v 0 u v 0 v 1 v l 1 0 s v d 0 5 0 5 d l 1 0 s d w a w n 3 d v 1 0 0 v n 3 d and let us consider the optimal control problem p hw minimizeh z 0 s z s s over z 0 z a w 01 w 1 w 0 n 3 wn 3 d ac 0 s r m r w d s t for a e s 0 s dz 0 ds s 1 d s n 3 i 1 ai s w 0 i s dz ds s 1 d s n 3 i 1 ai s f z 0 s z s w 0 i s m j 1 gj z 0 s z s w j i s d ds s 1 d s n 3 i 1 ai s wi s z 0 0 z 0 0 0 x 0 z 0 s z s s t 0 k 7 40 accordingly a pair z 0 z a w 01 w 1 w 0 n 3 wn 3 d such that z 0 z is the solution of the above control system corresponding to the con trol a w 01 w 1 w 0 n 3 wn 3 d is called a process of p hw the embedding of the problem p into p hw is as follows fix s 0 and for every control u t 1 t u 2 u consider the function u t 1 t u 2 0 s defined by u t s tu 2 u 1 t t 1 1 u d s tu 2 u 1 t t 7 41 then define i r ac t 1 t 2 m r r m r ac 0 s r m r r rm by setting i x u z 0 z a w 01 w 1 w 0 n 3 wn 3 d 24 where forall s 0 s and all i 1 m z 0 z s id x 1 u s s 0 s a 1 0 0 d tu 2 u 1 s 1 w 0 i wi 1 1 u 1 u 1 u s by a trivial use of the chain rule one gets the following result see e g 3 for a similar embedding lemma 7 1 the embedding i is injective 16 moreover the image space of the embedding i coincides with the set of all processes z 0 z a w 01 w 1 w 0 n 3 wn 3 d such that a w 01 w 1 w 0 n 3 wn 3 d v thanks to lemma 7 1 we can identify the original problem p with the problem p hv minimizeh z 0 s z s s over z 0 z a w 01 w 1 w 0 n 3 wn 3 d ac 0 s r m r v d s t for a e s 0 s dz 0 ds s 1 d s n 3 i 1 ai s w 0 i s dz ds s 1 d s n 3 i 1 a i s f z 0 s z s w 0 i s m j 1 gj z 0 s z s w j i s d ds s 1 d s n 3 i 1 a i s wi s z 0 0 z 0 0 0 x 0 z 0 s z s s t 0 k we can now apply the theory developed in the previous sections in view of the sufficient condition provided by theorem 4 1 it is trivial to verify that the family of controls v is abundant in w w r t the dynamics of problem p hw therefore by corollary 5 1 one obtains the following infimum gap result theorem 7 1 consider a feasible extended process y 0 y a w 01 w 1 w 0 n 3 w n 3 d d 0 and assume that it satisfies the infimum gap condition then for all approximating cones c to t t 0 k at y 0 y s there exist a number 0 an absolutely contin uous path 0 w 1 1 0 s r 1 n 1 and a zero measure subset i 0 such that the following conditions hold true i 0 6 0 ii 1 d 0 ds s s n 3 i 1 a i s f y 0 y 0 s y s w 0 i s m j 1 gj y 0 y 0 s y s w j i s 16 notice that the injectivity is a consequence of the fact that w 0 i s wi s 1 for a e s 0 s and for i 1 m 25 ii 2 d ds s s n 3 i 1 a i s f y y 0 s y s w 0 i s m j 1 gj y y 0 s y s w j i s a e s 0 s iii 1 d n 3 i 1 a i 0 s w 0 i s f s w 0 i m j 1 g j s w j i wi n 3 i 1 a i s 0 s w 0 i s s f s w 0 i s m j 1 g j s w j i s w i s for every w 0 w d w 0 5 0 5 and s 0 s i 0 17 iv 0 s s c 7 2 case ii space time non convex extension let us recall that we are assuming that 7 39 namely r u 0 u r s t u u unlike the previous case we are not going to convexify the dynamics while we will consider just the impulsive extension without repeating all steps we just observe that the sought extension is obtained by neglecting the sets a and a and by replacing w with the generally non convex set wnc w 0 w 0 u w 0 w 1 respectively in turn problem p hw simplifies into the following non convex problem p nc hw pnc hw minimizeh z 0 s z s s over z 0 z w 0 w d ac 0 s r m r w d s t for a e s 0 s dz 0 ds s 1 d s w 0 s dz ds s 1 d s f z 0 s z s w 0 s m j 1 gj z 0 s z s wj s d ds s 1 d s w s z 0 0 z 0 0 0 x 0 z 0 s z s s t 0 k 7 42 the other objects simplify accordingly and still because of the concatenation property the resulting family v is abundant in the resulting w therefore by applying the infimum gap result stated in corollary 5 1 we get theorem 7 2 consider a feasible extended process y 0 y w 0 w d d 0 and assume that it satisfies the infimum gap condition then for all qdq approximating cones c to t t 0 k at y 0 y s there exist a number 0 an absolutely continuous path 0 w 1 1 0 s r 1 n 1 and a zero measure subset i 0 such that the following conditions hold true 17 we have set f s f y 0 s y s g j s gj y 0 s y s for all s 0 s and i 1 m 26 i 0 6 0 ii d 0 ds s s f y 0 y 0 s y s w 0 s m j 1 gj y 0 y 0 s y s w j s d ds s s f y y 0 s y s w 0 i s m j 1 gj y y 0 s y s w j i s for a e s 0 s iii 1 d 0 s w 0 s f s w 0 m j 1 g j s w j w 0 s w 0 s s f s w 0 s m j 1 g j s w j s w s for every w 0 w d wnc 0 5 0 5 and s 0 s i 0 iv 0 s s c a appendix a 1 an example on why abundance is crucial the following example which is due to h j sussmann 18 shows how the abundance hy pothesis plays crucial for the validity of theorem 5 2 consider the families of controls v w defined as w l 1 0 1 0 5 v v w 1 0 v s ds 6 1 and the optimal control problems p v minimize y 1 over processes y v w 1 1 0 1 r v dy ds s v s a e s 0 1 y 0 0 y 1 1 p w minimize y 1 over processes y w w 1 1 0 1 r w dy ds s w s a e s 0 1 y 0 0 y 1 1 the process y w s s 1 is a minimizer of the extended problem p w with cost equal to 1 if we restrict the controls to the original family of controls v the cost of the problem raises to since every solution y v with v v fails to be feasible in other words the process y w satisfies the infimum gap condition by applying the pontryagin s maximum principle to the minimizer y w of p w we get that there exist multipliers c 6 0 0 such that d ds s 0 s w s w 0 5 s 0 1 in particular this implies s 0 and c 0 therefore if we set h y y for every y r the process y w turns out to be a normal h extremal therefore in view of 18 personal communication 27 corollary 5 1 the set v though being dense in w cannot be abundant in w as a matter of fact one can easily find a positive integer n 0 and n 1 controls w w 1 wn for which w w 1 wn n v verifying the properties of definition 4 1 does not exist indeed consider 1 0 1 w s 0 w 1 s 2 s 0 1 0 and take any mapping 0 1 v in view of definition 4 1 one has lim 0 1 0 s ds 1 0 w s w 1 s w s 2 1 then for every sufficiently small either there exists a 0 1 such that 1 0 s ds 1 or the map 7 1 0 s ds is not continuous since the former case is ruled out by the fact that the map s has to take values in v the map 7 1 0 s ds is not continuous so providing a contradiction references 1 m s aronna j f bonnans p martinon a well posed shooting algorithm for optimal control problems with singular arcs j optim theory applic 158 2 2013 pp 419 459 2 m s aronna m motta f rampazzo infimum gaps for limit solutions set valued var anal 23 no 1 3 22 2015 3 m s aronna f rampazzo l 1 limit solutions for control systems j differential equations 258 no 3 954 979 2015 4 a arutyunov d karamzin and f pereira pontryagin s maximum principle for constrained impulsive control problems nonlinear anal 75 no 3 1045 1057 2012 5 a arutyunov d karamzin and f pereira a nondegenerate maximum principle for the impulse control problem with state constraints siam j control optim 43 no 5 1812 1843 2005 6 d azimov r bishop 2005 new trends in astrodynamics and applications optimal trajectories for space guidance ann new york acad sci 1065 1 189 209 7 bonnans j f and shapiro a perturbation analysis of optimization problems springer new york 2000 8 a bressan f rampazzo on differential systems with vector valued impulsive con trols boll un mat ital b 7 2 no 3 641 656 1988 9 a bressan b piccoli introduction to the mathematical theory of control aims series on applied mathematics 2 american institute of mathematical sciences aims springfield mo 2007 10 aldo bressan hyper impulsive motions and controllizable coordinates for lagrangean systems atti accad naz lincei memorie serie viii vol xix 197 246 1990 11 aldo bressan on some control problems concerning the ski or swing atti accad naz lincei memorie serie ix vol i 147 196 1991 12 a catlla d schaeffer t witelski e monson a lin 2008 on spiking models for synaptic activity and impulsive differential equations siam rev 50 3 553 569 13 v a dykhta the variational maximum principle and quadratic conditions for the optimality of impulse and singular processes russian sibirsk mat zh 35 1994 no 1 70 82 ii translation in siberian math j 35 no 1 65 76 1994 28 14 v a dykhta second order necessary optimality conditions for impulse control prob lem and multiprocesses singular solutions and perturbations in control systems pereslavl zalessky 1997 97 101 ifac proc ser ifac laxenburg 1997 15 a l dontchev t zolezzi well posed optimization springer verlag new york 1993 16 a fryszowsky continuous selections for a class of non convex multivalued maps studia math vol 76 163 174 1983 17 p gajardo h ramirez c a rapaport minimal time sequential batch reactors with bounded and impulse controls for one or more species siam j control optim 47 6 2827 2856 2008 18 r v gamkrelidze on some extremal problems in the theory of differential equa tions with applications to optimal control siam journal on control vol 3 pp 106 128 1965 19 m guerra a sarychev fre chet generalized trajectories and minimizers for varia tional problems of low coercivity j dyn control syst 21 no 3 351 377 2015 20 d y karamzin v a de oliveira f l pereira g n silva on the properness of an impulsive control extension of dynamic optimization problems esaim control optim calc var 21 no 3 857 875 2015 21 b kaskosz extremality controllability and abundant subsets of generalized control systems journal of optimization theory and applications 101 1999 pp 73 108 22 a c lai m motta and f rampazzo minimum restraint functions for unbounded dynamics general and control polynomial systems pure and applied functional analysis volume 1 number 4 pp 583 612 23 a mariconda contractibility and fixed point property the case of decomposable sets nonlinear analysis t m a vol 17 n 7 pp 689 695 1992 24 m miller e y rubinovich impulsive control in continuous and discrete continuous systems kluwer academic plenum publishers new york 2003 25 m motta f rampazzo space time trajectories of nonlinear systems driven by ordi nary and impulsive controls differential integral equations 8 no 2 269 288 1995 26 m motta f rampazzo dynamic programming for nonlinear systems driven by or dinary and impulsive controls siam j control optim 34 no 1 199 225 1996 27 m motta f rampazzo state constrained control problems with neither coercivity nor l 1 bounds on the controls ann mat pura appl 4 177 117 142 1999 28 m motta f rampazzo r b vinter normality and gap phenomena in optimal unbounded control to appear on esaim cocv 29 m motta c sartori on asymptotic exit time control problems lacking coercivity esaim control optim calc var 20 no 4 957 982 2014 30 c olech decomposability as a substitute of convexity lecture notes in mathematics multifunctions and integrands vol 1091 193 2015 1984 31 m palladino f rampazzo a no infimum gap criterion to appear on annual con ference on conference on decision and control cdc 2019 58 th 32 m palladino r b vinter minimizers that are not also relaxed minimizers siam j control and optim 52 2014 no 4 pp 2164 2179 33 m palladino and r b vinter when are minimizing controls also minimizing re laxed controls discrete contin dyn syst series a 35 2015 no 9 pp 4573 4592 34 m palladino and r b vinter when does relaxation reduce the minimum cost of an optimal control problem annual conference on decision and control cdc 2013 ieee 52 nd 29 35 h scha ttler u ledzewicz geometric optimal control theory methods and ex amples springer 2012 36 g scorza dragoni un teorema sulle funzioni continue rispetto ad una e misurabili rispetto ad un altra variabile italian rend sem mat univ padova 17 1948 102 106 37 g silva r vinter measure driven differential inclusions j math anal appl 202 no 3 727 746 1996 38 g silva r vinter necessary conditions for optimal impulsive control problems siam j control optim 35 no 6 1829 1846 1997 39 h j sussmann geometry and optimal control mathematical control theory j baillieul and j c willems eds springer verlag new york 1998 pp 140 198 40 h j sussmann generalized differentials variational generators and the maximum principle with state constraints mathematical control theory j baillieul and j c willems eds springer verlag new york 1998 pp 140 198 41 r b vinter optimal control birkha user boston 2000 42 j warga normal control problems have no minimizing strictly original solutions bulletin of the amer math soc 77 4 1971 pp 625 628 43 j warga optimal control of differential and functional equations academic press new york 1972 44 j warga controllability extremality and abnormality in nonsmooth optimal control j optim theory and applic 41 1 1983 pp 239 260 45 j warga optimization and controllability without differentiability assumptions siam j control and optim 21 6 1983 pp 837 855 46 p wolenski s zabic a differential solution concept for impulsive systems dyn contin discrete impuls syst ser a math anal 13 b 199 210 2006 30 1 introduction 1 1 basic notions and notation 1 1 1 linear spaces manifolds 1 1 2 cones 1 1 3 scorza dragoni points 2 set separation and open mappings 2 1 quasi differential quotients 2 2 open mapping results 2 3 qdq approximating cones and set separation 3 gaps and set separation 3 1 original and extended controls 3 2 infimum gaps 4 abundance 4 1 approximating the original reachable set by extended cones 5 the main result 5 1 a verifiable sufficient condition for normality 6 proofs of the main results 6 1 proof of the geometric principle theorem 6 2 proof of the normality no gap criterion corollary 6 2 1 the case of a finite subset of controls 6 2 2 the general case of an infinite control set 7 an application to non convex unbounded problems 7 1 case i space time convex extension 7 2 case ii space time non convex extension a appendix a 1 an example on why abundance is crucial