ar x iv 1 60 7 05 48 8 v 3 m at h p r 1 d ec 2 01 6 variational calculus for diffusions ke vin hartmann abstract we expand the classic variational formulation of loge e f to the case where f depends on a diffusion and not only a on brownian motion while decreasing the integrability hypothesis on f we also give an entropic characterisation of the invertibility of a perturbation of a diffusion and discuss the attainability of the infimum in the aforementioned variational formulation keywords wiener space invertibility entropy diffusion variational formulation contents 1 introduction 1 2 framework 3 3 action of the composition by xu and invertibility results 6 4 invertibility results 7 5 entropic characterisation of the invertibility of xu 7 6 approximation of absolutely continuous measures 10 7 variational problem 15 references 17 1 introduction denote w the space of continuous functions from 0 1 to rn and h the associated canonical cameron martin space of elements of w which admit a density in l 2 also denote the wiener measure w the coordinate process and ft the canonical filtration of w completed with respect to w is a brownian motion under set f a bounded from above measurable function from w to r in 4 dupuis and ellis prove that loge e f inf e f h 1 1 where the infimum is taken over the probability measures on w which are absolutely continuous with respect to and the relative entropy h is equal to e d d log d d in 1 boue and dupuis use it to derive the variational formulation loge e f inf u e f w u 1 2 1 0 u s 2 ds 1 2 where the infimum is taken over l 2 functions from w to h whose density is adapted to ft this variational formulation is useful to derive large deviation asymptotics as laplace principles for small 1 http arxiv org abs 1607 05488 v 3 2 ke vin hartmann noise diffusions for instance this result was later extended by budhiraja and dupuis to hilbert space valued brownian motions in 2 and then by zhang to abstract wiener spaces in 10 using the framework developed by u stu nel and zakai in 7 the bounded from above hypothesis in 1 2 was weakened significantly by u stu nel in 9 it was replaced with the condition e fe f and the existence of conjugate integers p and q such that f lp e f lq these relaxed hypothesis pave the way to new applications the possibility of using unbounded functions is primordial in dabrowski s application of 1 2 to free entropy in 3 u stu nel s approach is routed in the study of the perturbations of the identity of w which is the co ordinate process and their invertibility the question of the invertibility of an adapted perturbation of the identity is linked to the representability of measures and was put to light by the celebrated example of tsirelson 6 u stu nel proved that if u l 2 h and has an adapted density iw u is a s invertible if and only if h iw u 1 2 e u 2 h to prove 1 2 with the integrability conditions specified above u stu nel uses the fact that h c 1 shifts meaning shifts that are a s fre chet differentiable on h with an a s continuous on h fre chet derivative are a s invertible and that shifts can be approached with h c 1 shifts using the ornstein uhlenbeck semigroup this paper focuses on getting a variational formulation similar as the one above in the case of a diffusion v which satisfies a stochastic differential equation v t c t 0 v s db s t 0 b v s ds where b is a brownian motion thus generalizing the case of the brownian motion we also weaken the integration hypothesis on f since we only require e fe f and f lp for some p 1 u stu nel s proof consists in approaching f with h c 1 functions and then use h c 1 shifts which are invertible obtained using those functions this approach is deeply rooted in the brownian motion specific case since it relies on sophisticated stochastic analysis tool that were developed for a gaussian framework here we write the density e f e e f as the wick exponential of some v and then approach v with retarded shifts which generate invertible perturbations of the identity since we work under the law of a diffusion and not the wiener measure the perturbations of the identity we consider are not affine shifts we work on w under the image measure of v b that we denote x and we construct a brownian motion x such that w verifies w t c t 0 w s d x s t 0 b w s ds we only consider perturbations that verify the girsanov condition if u is such a perturbation we denote xu the solution of the stochastic differential equation xu c t 0 xu s d x u s t 0 b xu s ds variational calculus for diffusions 3 and xu xu x u x u plays the same role as w u in the brownian case and it is invertible if and only if h xu x x 1 2 e x u 2 h we conclude the paper with a discussion over the attainability of the infimum in the variational formulation 2 framework set m d in c rm rm mm d r and b r m rm bounded and lipschitz functions i will denote the i th column of notice that every matrix will be identified with its canonical linear operator set r gt a probability space v a r brownian motion on with values in r d set y a rm valued strong solution of the stochastic differential equation y t c t 0 y s dv s t 0 b y s ds on r gt b the hypotheses on and b ensure the existence and uniqueness of y if we impose its paths to be continuous we denote the wiener measure on c 0 1 rd and x the image measure of x we denote w c 0 1 rm d and we consider the measure x on w we define the processes x and b on w by x t w w w 7 w t rm b t w w w 7 w t rd under x the law of x is x b is a brownian motion and they are independent we denote xi and bi the i th coordinates of x and b define m x c 0 b x s ds and a t for 1 i d m i x i ci 0 bi x s ds is a local martingale and we have m i m j 0 aij x s ds now set y r observe that y ker y im y e 7 y e is an isomorphism and set y the unique element of md m r which is equal to y 1 on im y and 0 on im y and y the unique element of md r which is equal to 0 on ker y and to the identity on ker y notice that we have y id r we define x 0 x s dm s 0 x s db s 4 ke vin hartmann x i will denote the i th coordinate of x x is a brownian motion indeed it is clearly a local martingale and since m and b are independent x i x j t i j t 0 x s x s a x s 0 0 i x s x s t ds t 0 x s x s x s t x s t x s x s t ds tid r moreover m 0 x s d x s indeed m 0 x s d x s is a local martingale and m 0 x s d x s m 0 x s d x s t i j t 0 x s x s i x s x s a x s 0 0 i x s x s i x s x s t ds t 0 x s x s i x s x s t x s x s i t x s x s x s t x s t ds 0 this construction of x is taken from 5 we denote x x x and x its image measure x is a x path continuous strong solution of the stochastic differential equation x c 0 x s d x s 0 b x s ds the filtration of a process m will be denoted fmt the filtration of x will be simply denoted ft except if stated otherwise every filtration considered is completed with respect to x if m is a martingale and v admits a density v whose stochastic integral with respect to m is well defined we will denote mv 1 0 v s dm s we also denote the wick exponential as follow mv exp 1 0 v s dm s 1 2 1 0 v s 2 d m s and for p 0 we denote l p a x h u lp x h u is ft adapted gp x m u lpa x h e x mu 1 variational calculus for diffusions 5 we denote h 0 h s ds h l 2 0 1 rd for u g 0 x x we define u x x u and x u a path continuous strong solution of the stochastic differential equation x u c 0 xu s d u x s 0 b xu s ds on w x ft x once again the hypotheses on ensure the existence and x path uniqueness of xu we also denote m u xu c 0 b xu s ds 0 xu s d u x s and x u xu x u we have a girsanov like change of measure theorem relative to x proposition 1 set u g 0 x x for every bounded borel function f e x f e x f x u xu proof set f a bounded borel function and u g 0 x x denote the probability on w defined by d d x xu according to the girsanov theorem the law of x u under is the same as the law of x under x consequently the law of xu under is the same as the law of x under x and e x f x e x f x u xu theorem 1 set u g 0 x x we have x u x x proof set f cb w and set the measure on w given by d d x xu we have exu f e f x u e x f x u xu e x f so xu x since x xu xu x which conclude the proof set u v g 0 x x this theorem ensures that if g is a random variable defined on w the compo sition g xv is well defined indeed set g and g in the same equivalence class in l 0 x then x g xv g xv xv x g g 1 6 ke vin hartmann since xv x x in particular the compositions u xv and xu xv are well defined since u and xu are random vari ables defined on w with values in h and w respectively 3 action of the composition by xu and invertibility results proposition 2 set u g 0 x x we have x a s mu m xu u x x x u proof we have m xu x c 0 b x s ds xu xu c 0 b xu s ds mu now x x u 0 x s dm s 0 x s db s xu 0 xu s dmu s 0 xu s d u x s 0 xu s xu s d u x s 0 xu s d u x s u x proposition 3 set u v g 0 x x such that v u x u g 0 x x we have x a s x u xv xv u x v we have x u xv xu xv x u x v xu xv x v u x u now xu xv c 0 xu s d u x s 0 b xu s ds xv c 0 xu s d x s 0 xu s du s 0 b xu s ds xv c 0 xu s xv d v x s 0 xu s xv u s xvds 0 b xu s xv ds c 0 xu s xv d v u x v x s 0 b xu s xv ds variational calculus for diffusions 7 xu xv andxv u x v are path continuous strong solutions to the same stochastic differential equation so they are equal x a s finally we have x a s x u xv xv u x v x v u x v xv u x v 4 invertibility results definition 1 a measurable map u w w is said to be x a s left invertible if and only if u x x and there exists a measurable map v w w such that v u iw x a s a measurable map u w w is said to be x a s right invertible if and only if there exists a measurable map v w w such that v x x and u v iw x a s proposition 4 set u v w w measurable maps such that v u iw x a s and v x x then u v iw u x a s so if u x x we also have u v iw x a s in that case we will say that u is x a s invertible proof there exists a w such that x a 1 and for every w a v u w w consider such a set a we have eu x 1 u v w w e x 1 u v u w u w e x 1 u v u w u w 1 w a e x 1 u v u w u w 1 w a e x 1 u w u w 1 w a 1 5 entropic characterisation of the invertibility of xu in this section we prove that the process xu is left invertible if and only if the kinetic energy of the perturbation u is equal to the relative entropy of xu x proposition 5 set u g 2 x x we have h xu x x 1 2 e x u 2 h proof set g cb w and denote l dxu x d x we have e x g x u e x gl e x g x ul xu xu so x a s l xue x xu f x u 1 1 8 ke vin hartmann and h xu x x e x l logl exu x logl e x logl x u e x loge x xu f x u 1 e x log xu 1 2 e x u 2 h now comes the criteria theorem 2 set u g 2 x x the three following propositions are equivalent i h xu x x 1 2 e x u 2 h ii there exists v g 0 x x such that x v xu xu xv iw x a s iii xu is x a s left invertible proof we first prove i ii we still denote l dx u x d x and as in the proof of last proposition we have x a s l xue x xu x u 1 using jensen inequality we have x a s 0 logl xu loge x xu f x u 1 logl xu e x log xu f x u 1 and 0 e x logl x u e x log xu h xu x x 1 2 e x u 2 h 0 so 0 logl xu loge x xu f x u 1 logl xu e x log xu f x u 1 and loge x xu f x u 1 e x log xu f x u 1 the strict concavity of the function log gives e x xu f x u 1 xu finally we have 5 3 l xu xu 1 variational calculus for diffusions 9 since x is a x brownian motion there exists v g 0 x x such that l xv we apply the logarithm to 5 3 to get 0 xv x u 1 2 v xu 2 h xu 1 2 u 2 h we have xv x u 1 0 v s xud x s v x u u h so finally we have 5 4 0 x v x u u 1 2 v xu u 2 h according to girsanov theorem x v is a x u x brownian motion so e x l logl exu x logl exu x 1 0 v s d x s 1 2 1 0 v s 2 ds 1 2 exu x 1 0 v s 2 ds 1 2 e x v xu 2 h so v xu l 2 a x h and we can take the expectation with respect to in 5 4 to obtain u v xu 0 x a s and xv xu iw x a s and xv is a left inverse of xu since xv x x we also have xu xv iw x a s from proposition 4 ii iii is immediate now we prove iii i we still denote l dx u x d x assume that xu admits a left inverse v set v u v we have x a s v xu u and exu x 1 1 0 v s 2 ds e x 1 1 0 u s 2 ds 1 so v l 0 xu x h and v l 0 x h since xu x x now set v n max n min v n v n xu is adapted set a l 2 dt d x an adapted process we have e x xu 1 0 v n s xua s xuds e x 1 0 v n s a s ds e x 1 0 e x v n s fx s a s ds e x xu 1 0 e x v n s fx s xua s xuds so e x v n s fx s xu v n s xu dt d x a s which implies e x v n s fx s v n s dt d x a s since xu x x an algebraic calculation gives x a s xv x u xu 1 10 ke vin hartmann now set g cb w r we have e x gl e x g x u e x g x u xv x u xu e x g xv so l xv and since e x xv 1 we have l xu xu 1 and we can compute h xu x x h xu x x e x l logl e x logl x u e x log xu 1 2 e x u 2 h 6 approximation of absolutely continuous measures theorem 3 if x is such that there exists r 1 such that d d x log d d x l 1 x and log d d x lr x there exists un l a x h in such that for every n x un x x x un is x a s invertible dxun x d x log dxun x d x d d x log d d x in l 1 x dxun x d x log d d x d d x log d d x in l 1 x proof denote l d d x eventually sequentializing afterward we have to prove that for any 0 there exists u l a x h such that xu x x xu is x a s invertible and e x dxu x d x log dxu x d x l logl e x dxu x d x logl l logl 1 variational calculus for diffusions 11 the proof is divided in five steps step 1 we approximate l with a density that is both lower and upper bounded denote n min l n ln n e x n the monotone convergence theorem ensures that e x n 1 so for any 0 1 there exists some n in such that for any n n e x n ln logln converges x a s to l logl and if n n and ln logln n e x n log n e x n 1 n e x n 1 n e x n log n e x n 1 n e x n 1 e 11 n e x n 1 l log l 1 n e x n 1 e 1 l log l so the lebesgue theorem ensures that ln logln converge toward l logl in l 1 x similarly ln logl converges x a s to l logl and if n n ln logl l logl and the lebesgue theorem ensures that ln logl converges to ln logl in l 1 x so there exists n 0 in such that e x ln 0 logln 0 l logl e x ln 0 logl l logl ln 0 a 1 a log ln 0 a 1 a converges x a s to ln 0 logln 0 when a converges to 0 set a 0 1 we have ln 0 a 1 a log ln 0 a 1 a ln 0 a 1 a log ln 0 a 1 a 1 ln 0 1 ln 0 a 1 a log ln 0 a 1 a 1 ln 0 1 e 11 ln 0 1 ln 0 logln 0 1 ln 0 1 e 1 ln 0 logln 0 so the lebesgue theorem ensures that ln 0 a 1 a log ln 0 a 1 a converges to ln 0 logln 0 in l 1 x sim ilarly ln 0 a 1 a logl converges x a s to ln 0 logl and ln 0 a 1 a logl ln 0 1 logl 12 ke vin hartmann and the lebesgue theorem ensures that ln 0 a 1 a logl converges to ln 0 logl in l 1 x and there exists a 0 1 such that e x ln 0 a 1 a log ln 0 a 1 a ln 0 logln 0 e x ln 0 a 1 a logl ln 0 logl ln 0 a 1 a is both lower bounded and upper bounded in l x we denote these bounds respectively d and d also denote m t e x ln 0 a 1 a ft we write m t exp t 0 s d x s 1 2 t 0 s 2 ds with l 0 a x h step 2 we prove that l 2 x h set tn inf t 0 1 t 0 s 2 ds n tn is a sequence of stopping times which increases stationarily toward 1 we have using m 1 0 s m s d x s e x m t tn 1 2 e x t tn 0 s 2 m s 2 ds d 2 e x t tn 0 s 2 ds so e x t tn 0 s 2 ds 1 d 2 e x m t tn 1 2 2 d 2 1 d 2 hence passing to the limit e x 1 0 s 2 ds 2 d 2 1 d 2 step 3 we approximate with an element of l x h define n t w 0 1 w 7 t 0 s w 1 0 tn s w ds and mn t exp t 0 n s d x s 1 2 t 0 n s 2 ds and clearly mn 1 logmn 1 converges x a s to m 1 logm 1 mn 1 logl converges to m 1 logl x a s and mn 1 e x m 1 ftn so x a s mn 1 logmn 1 max e 1 d logd mn 1 logl d logl variational calculus for diffusions 13 so the lebesgue theorem ensures that mn 1 logmn 1 converges to m 1 logm 1 in l 1 x and mn 1 logl converges to m 1 logl in l 1 x and there exists n in such that mn 1 logmn 1 m 1 logm 1 mn 1 logl m 1 logl step 4 we approximate n with a retarded shift for 0 set t w 0 1 w 7 t 0 n s w 1 s ds n t exp t 0 s d x s 1 2 t 0 s 2 ds n 1 logn 1 converges in probability to mn 1 logmn 1 to prove that n 1 logn 1 is uniformly integrable it is sufficient to prove it is bounded in any lp x set p 1 e x n 1 p e x exp p 1 0 s d x s p 2 1 0 s 2 ds e x exp p 1 0 s d x s p 2 2 1 0 s 2 ds exp p 2 p 2 1 0 s 2 ds e x exp 1 0 p s d x s 1 2 1 0 p s 2 ds exp p 2 p 2 n exp p 2 p 2 n so n 1 logn 1 converges tomn 1 logmn 1 in l 1 x furthermore using ho lder inequality we have e x n 1 logl mn 1 logl n 1 mn 1 lr x logl lr x where 1 r 1 r 1 consequently there exists 0 such that e x n 1 logn 1 mn 1 logmn 1 e x n 1 logl mn 1 logl 14 ke vin hartmann using the triangular inequality we have e x l logl n 1 logn 1 e x l logl ln 0 logln 0 e x ln 0 logln 0 ln 0 a 1 a log ln 0 a 1 a e x ln 0 a 1 a log ln 0 a 1 a mn 1 logmn 1 e x m n 1 logmn 1 n 1 logn 1 4 e x l logl n 1 logl e x l logl ln 0 logl e x ln 0 logl ln 0 a 1 a logl e x ln 0 a 1 a logl mn 1 logl e x m n 1 logl n 1 logl 4 step 5 we prove that x is x a s left invertible and is the solution to our problem we know x x iw 1 and that there exists a measurable function such that x x x a s so set a w such that x a 1 and for every w a x w w and x w x w now set w 1 w 2 w such that x w 1 x w 2 we have x w 1 0 s w 1 ds x w 2 0 s w 2 ds for any s 0 x s w 1 x s w 2 being adapted to filtration f x t it implies that for t 0 2 t 0 s w 1 ds t 0 s w 2 ds and x t w 1 x t w 2 an easy iteration shows that x w 1 x w 2 hence w 1 x w 1 x w 1 x w 2 x w 2 w 2 so x is x a s injective and so x a s left invertible and it is of the form xv with v g 0 x x we have for f cb w e x f xv e x f xv x x e x fn 1 variational calculus for diffusions 15 we have dxv x d x n 1 so xv x x and x v x x xv x a s and v 2 h 2 h x v n x a s since xv x x and 2 h n x a s hence v l a x h 7 variational problem as stated in the beginning we aim to provide a variational formulation of loge x e f this first result is from 9 theorem 4 set f w r a measurable function verifying e x f 1 e f denote p the set of probability measures on w f 1 which are absolutely continuous with respect to x then loge x e f inf p e f h x and the unique supremum is attained at the measure d 0 e f e x e f d x proposition 6 set f w r a measurable function verifying e x f 1 e f then loge x e f inf u g 2 x x e x f xu 1 2 u 2 h here is the main result theorem 5 set p 1 and f lp x such that e x f 1 e f then we have loge x e f inf u l a x h xu x a s invertible e x f xu 1 2 u 2 h proof using proposition 6 we have easily loge x e f inf u l a x h xu x a s invertible e x f xu 1 2 u 2 h let 0 be the measure on w defined by d 0 e f e x e f d x 16 ke vin hartmann according to theorem 3 there exists un l a x h in such that for every n in xun is x a s invertible and that dxun x d x log dxun x d x d 0 d x log d 0 d x dxun x d x log d 0 d x d 0 d x log d 0 d x in l 1 x since xun is x a s invertible we have e x f xun 1 2 un 2 h e x f dxun x d x e x dxun x d x log dxun x d x when n goes to infinity we have e x dxun x d x log dxun x d x e x d 0 d x log d 0 d x and since f log d 0 d x loge x e f e x f dxun x d x e x f d 0 d x so finally when n goes to infinity e x f xun 1 2 un 2 h e 0 f h 0 x loge x e f which conclude the proof corollary 1 set f w r such that e x f 1 e f and loge x e f inf u l a x h xu x a s invertible e x f xu 1 2 u 2 h we have loge x e f inf u g 2 x x e x f xu 1 2 u 2 h theorem 6 set f w r a measurable function verifying e x f 1 e f then if there exists some u g 2 x x such that x u is x a s left invertible and dx u x d x e f e x e f then we have loge x e f inf u g 2 x x e x f xu 1 2 u 2 h proof since xu is x a s left invertible and that dx u x d x e f e x e f we have 1 2 e x u 2 h h xu x x e x e f e x e f log e f e x e f and e x f xu 1 2 u 2 h e x e f e x e f f e f e x e f log e f e x e f loge x e f variational calculus for diffusions 17 and we conclude the proof with last proposition theorem 7 set f w r a measurable function such that loge x e f inf u g 2 x x e f xu 1 2 u 2 h denote this infimum j it is attained at u g 2 x x if and only if x u is x a s left invertible and dx u x d x e f e x e f proof the direct implication is given by last theorem conversely if xu is not x a s left invertible h xu x x 1 2 e x u 2 h and loge x e f inf p w e f h x inf g 2 x x ex x f h x x x exu x f h x u x x e x f xu 1 2 u 2 h which is a contradiction we get dx u x d x l by uniqueness of the minimizing measure of inf p w e f h x references 1 m boue p dupuis a variational formulation for certain functional of brownian motion ann probab 26 1641 1659 1998 2 a budhiraja p dupuis a variational formulation for positive functionals of infinite brownian motion probab math statist 20 39 61 2000 3 y dabrowski a laplace principle for hermitian brownian motion and free entropy 2016 4 p dupuis r ellis a weak convergence appoach to the theory of large deviation wiley 1997 5 l c g rogers d williams diffusions markov processes and martingales cambridge mathematical library 2 nd edition 2000 6 b s tsirelson an example of stochastic differential equation having no strong solution theor prob appl 20 416 418 1975 7 a s u stu nel m zakai the construction of filtrations on abstract wiener space j funct ana 143 10 32 1997 8 a s u stu nel entropy invertibility and variational calculus od adapted shifts on wiener space j of funct ana 257 11 3655 3689 2009 9 a s u stu nel variational calculation of laplace transforms via entropy on wiener space and applications j of funct ana 267 8 2014 10 x zhang a variational formulation for random functionals on abstract wiener spaces j math kyoto univ 49 475 490 2009 ke vin hartmann institut telecom telecom paristech ltci cnrs de pt infres 23 avenue d italie 75013 paris france kevin hartmann polytechnique org 1 introduction 2 framework 3 action of the composition by xu and invertibility results 4 invertibility results 5 entropic characterisation of the invertibility of xu 6 approximation of absolutely continuous measures 7 variational problem references