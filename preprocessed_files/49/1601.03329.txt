ar x iv 1 60 1 03 32 9 v 1 m at h o c 1 3 ja n 20 16 fixed endpoint optimal control of bilinear ensemble systems shuo wang and jr shin li abstract optimal control of bilinear systems has been a well studied subject in the area of mathematical control however techniques for solving emerging optimal control problems involving an ensemble of structurally identical bilinear systems are underdeveloped in this work we develop an iterative method to effectively and systematically solve these challenging optimal ensemble control problems in which the bilinear ensemble system is represented as a time varying linear ensemble system at each iteration and the optimal ensemble control law is then obtained by the singular value expansion of the input to state operator that describes the dynamics of the linear ensemble system we examine the convergence of the developed iterative procedure and pose optimality conditions for the convergent solution we also provide examples of practical control designs in magnetic resonance to demonstrate the applicability and robustness of the developed iterative method key words ensemble control iterative methods sweep method fixed endpoint problems bilinear systems optimality conditions magnetic resonance ams subject classifications 1 introduction newly emerging fields in science and engineering such as systems neuroscience synchronization engineering and quantum science and technology give rise to new classes of optimal control problems that involve underactuated manipulation of individ ual and collective behavior of dynamic units in a large ensemble representative examples include neural stimulation for alleviating the symptoms of neurological disorders such as parkinson s disease where a population of neurons in the brain is affected by a small number of electrodes 1 pulse designs for exciting and transporting quantum systems between de sired states where an ensemble of quantum systems is driven by a single or multiple pulses in a pulse sequence 2 3 and the engineering of dynamical structures for complex oscillator networks where sequential patterns of a network of nonlinear rhythmic elements are cre ated and altered by a mild global waveform 4 solving these nontraditional and large scale underactuated control problems requires the development of systematic and computationally tractable and effective methods among these emerging control problems in this paper we will study fixed endpoint op timal control problems involving bilinear ensemble systems which arise from the domain of quantum control 5 and appear in a variety of other different fields such as cancer chemother apy 6 and robotics 7 the control of bilinear systems has been a well studied subject in the area of mathematical control from pontryagin s maximum principle to spectral colloca tion methods a wide variety of theoretical and computational methods have been developed to solve optimal control problems of bilinear systems 8 9 in particular the numerical methods are in principle categorized into direct e g pseudospectral methods 10 11 and indirect approaches e g indirect transcription method 12 and shooting methods 13 im plementing these existing numerical methods to solve optimal control problems involving an ensemble i e a large number finitely or infinitely many or a parameterized family of bilin ear systems may encounter low efficiency slow convergence and instability issues because most of these methods rely on suitable discretization of the continuous time dynamics into a large scale nonlinear program lsnlp in addition the global constraint for such an op this work was supported in part by the national science foundation under the awards cmmi 1301148 cmmi 1462796 and eccs 1509342 department of electrical and systems engineering washington university st louis missouri 63130 usa swang 35 wustl edu department of electrical and systems engineering washington university st louis missouri 63130 usa jsli wustl edu questions comments or corrections to this document may be directed to this email address 1 http arxiv org abs 1601 03329 v 1 mailto swang 35 wustl edu mailto jsli wustl edu 2 s wang and j s li timal ensemble control problem in which each individual system receives the same control input makes the discretized lsnlp very restrictive and intractable to solve or even to find a feasible solution 14 on the other hand optimal control problems involving a linear system or a linear en semble system are often computationally tractable and analytically solvable for many special cases such as the linear quadratic regulator lqr 15 and the minimum energy control of harmonic oscillator ensembles 16 this suggests a bypass to solve optimal control problems of bilinear ensemble systems through solving that of linear ensemble systems and motivates the development of the iterative method in this work the central idea is to represent the bilin ear ensemble system as a linear ensemble system at each iteration and then feasibly calculate the optimal control and trajectory for each iteration until a convergent solution is found itera tive methods have been introduced and adopted to deal with diverse control design problems including the free endpoint quadratic optimal control of bilinear systems 17 and optimal state tracking for nonlinear systems 18 while the fixed endpoint problems along with the emerging problems that involve controlling a bilinear ensemble system remain unexplored in this paper we combine the idea of the aforementioned iterative method with our pre vious work on optimal control of linear ensemble systems to construct an iterative algorithm for solving optimal control problems involving a time invariant bilinear ensemble system of the form d dt x t a x t b u t m i 1 ui t bi x t where x x 1 xn t m rn denotes the state k rd with k compact and d a positive integer u t u 1 t um t t rm is the control and the matrices a rn n b rn m and bi rn n i 1 m for k this paper is structured as follows in the next section we present the developed iter ative method for fixed endpoint optimal control of a time invariant bilinear system where we introduce a sweep method that accounts for the terminal condition based on the notion of flow mapping from the optimal control theory in section 3 we examine the convergence of the iterative method using the fixed point theorem in section 4 we propose the conditions for global optimality of the convergent solution then in section 5 we extend the developed iterative method to solve optimal control problems involving bilinear ensemble systems and show the convergence of the method finally examples and simulations of practical control design problems are illustrated in section 6 to demonstrate the applicability and robustness of the developed iterative procedure 2 iterative method for optimal control of bilinear systems we start with consider ing a fixed endpoint finite time quadratic optimal control problem involving a time invariant bilinear system of the form min j 1 2 t f 0 xt t qx t ut t ru t dt s t x ax bu m i 1 uibi x p 1 x 0 x 0 x t f x f where x t rn is the state and u t rm is the control a rn n bi r n n and b rn m are constant matrices r rm m 0 is positive definite and q rn n 0 is positive semi definite and x 0 x f r n are the initial and the desired terminal state respectively we first fixed endpoint control for bilinear ensembles 3 represent the time invariant bilinear system in p 1 as a time varying linear system x t ax bu n j 1 x j t n j u 2 1 in which we write the bilinear term mi 1 uibi x nj 1 x jn j u with x j the j th element of x n j r n m for j i n and u u 1 um t rm then we solve this optimal control problem by pontryagin s maximum principle the hamiltonian of this problem is 2 2 h x u 1 2 xt qx ut ru t ax b n j 1 x jn j u where t rn is the co state vector the optimal control is then obtained by the necessary condition h u 0 given by 2 3 u r 1 b n j 1 x jn j t and the optimal trajectory of the state x and the co state satisfy for t 0 t f x i ax i b n j 1 x jn j r 1 b n j 1 x jn j t i 2 4 i qx i at i t nir 1 b n j 1 x jn j t b n j 1 x jn j r 1 nti 2 5 with the boundary conditions x 0 x 0 and x t f x f where xi i and i i 1 n are the ith component of the associated vectors by the following change of variables a i j ai j n jr 1 b n j 1 x jn j t b n j 1 x jn j r 1 ntj i 2 6 b r 1 b t br 1 bt n j 1 x jn j r 1 n j 1 x jn j t 2 7 q q 2 8 we can rewrite 2 4 and 2 5 into the form x a x b r 1 b t x 0 x 0 x t f x f 2 9 q x a t 2 10 which coincides with the canonical form of the state and co state equations characterizing the optimal trajectories for the analogous optimal control problem involving the time invariant linear system x a x b u 19 in this way the optimal state and co state trajectories for the optimal control problem p 1 involving a time invariant bilinear system are now expressed in terms of the equations related to a time varying linear system as in 2 9 and 2 10 using this linear system representation together with the sweep method 19 20 we will solve the optimal control problem p 1 in an iterative manner specifically we will consider at each iteration the fixed endpoint linear quadratic optimal control problem min j 1 2 t f 0 x k 1 t t qx k 1 t u k 1 t t ru k 1 t dt s t x k 1 t a k x k 1 b k u k 1 p 2 x k 1 0 x 0 x k 1 t f x f 4 s wang and j s li by treating the previous trajectory x k as a known quantity where k n denotes the itera tion in the following sections we will introduce the sweep method and present the iterative procedure 2 1 sweep method for fixed endpoint problems observe that in 2 9 and 2 10 there are two boundary conditions for the state x while none for the co state it requires implementing specialized computational methods such as shooting methods to solve such a two point boundary value problem which in general involve intensive numerical optimiza tions here we adopt the idea of the sweep method by letting 2 11 t k t x t s t with t f where k t s t rn n and is the multiplier a constant associated with the terminal constraint which in this case is x t f x t f x f from the transversality condition in pontryagin s maximum principle we know that k t f 0 because there is no terminal cost and s t f x x t f i moreover if k is chosen to satisfy the riccati equation k t q a t k t k t a k t b r 1 b t k t 2 12 with the terminal condition k t f 0 then s satisfies the matrix differential equation s t a t k t b r 1 b t s t 2 13 with the terminal condition s t f i by taking the time derivative of 2 11 and using 2 9 2 10 and 2 12 in addition in order to fulfill the terminal condition x t f x f at time t f the multiplier associated with must satisfy x f s t t x t p t 2 14 for all t 0 t f where p t r n n obeys the matrix differential equation p t st t b r 1 b t s t 0 2 15 with the terminal condition p t f 0 it follows from 2 14 using t 0 that 2 16 p 0 1 x f s t 0 x 0 provided p t is invertible for t 0 t f more details about the sweep method based on the notion of flow mapping are provided in appendix 8 1 1 2 2 iteration procedure the optimal solution of the problem p 1 is characterized by the homogeneous time varying linear system described in 2 9 and 2 10 and we will solve for x and via an iterative procedure which is based on analytical expressions and requires no numerical optimizations to proceed this we write 2 9 and 2 10 as the iteration equations x k 1 a k x k 1 b k r 1 b k t k 1 2 17 k 1 q k x k 1 a k t k 1 2 18 with identical boundary conditions x k 1 0 x 0 and x k 1 t f x f for all k 0 1 2 where a k b k r 1 b k t and q k are defined according to 2 6 2 7 and 2 8 by a k i j ai j n jr 1 b n j 1 x k j n j t b n j 1 x k j n j r 1 ntj k i 2 19 b k r 1 b k t br 1 bt n j 1 x k j n j r 1 n j 1 x k j n j t 2 20 q k q 2 21 fixed endpoint control for bilinear ensembles 5 applying the sweep method introduced in section 2 1 we let k 1 t k k 1 t x k 1 t s k 1 t k 1 for t 0 t f where k k satisfies the riccati equation k k 1 q k k k 1 a k a k t k k 1 k k 1 b k r 1 b k t k k 1 2 22 with the boundary condition k k 1 t f 0 and s k follows s k 1 a k t k k 1 b k r 1 b k t s k 1 s k 1 t f i 2 23 moreover the multiplier k satisfies 2 24 k 1 p k 1 0 1 x f s k 1 t 0 x 0 where p t rn n is invertible see lemma 3 1 in section 3 and satisfies the dynamic equation p k 1 s k 1 t b k r 1 b k t s k 1 2 25 with the terminal condition p k 1 t f 0 then the optimal control 2 3 for the original problem p 1 can be expressed as 2 26 u t r 1 b n j 1 x j t n j t k t x t s t if this iterative procedure is convergent where x k x k k k and s k k s remark 1 the iterative method can be initialized by conveniently using the optimal control of the system involving only the linear part of the bilinear system in p 1 i e the lqr control that is the solution x 0 t 0 t to the homogeneous system x 0 ax 0 br 1 bt 0 x 0 0 x 0 x 0 t f x f 0 at 0 however the linear system x ax bu may be uncontrollable so that the desired transfer between x 0 and x f is impossible and the lqr solution does not exist in such a case any state trajectory with the endpoints x 0 and x f can be a feasible initial trajectory x 0 t of the iterative procedure 2 3 a special case minimum energy control of bilinear systems before analyzing the convergence of the iterative method we illustrate the procedure using the example of minimum energy control of bilinear systems which is a special case of problem p 1 with q 0 consider the following fixed endpoint optimal control problem min j 1 2 t f 0 ut t ru t dt s t x t ax bu n j 1 x j t n j u p 3 x 0 x 0 x t f x f the hamiltonian of this problem is h x u 12 u t ru t ax bu nj 1 x jn j u where t rn is the co state vector the optimal control is of the form as in 2 3 and the optimal 6 s wang and j s li state and co state trajectories satisfy 2 9 and 2 10 respectively with q 0 the respective iteration equations follow 2 17 and 2 18 with q k 0 for all k 0 1 2 following the iterative method presented in section 2 2 we represent the costate k 1 t k k 1 t x k 1 t s k 1 t k 1 t 0 t f and the matrix k k 1 t rn n satisfies the riccati equation k k 1 k k 1 a k a k t k k 1 k k 1 b k r 1 b k t k k 1 2 27 with the terminal condition k k 1 t f 0 which has the trivial solution k k 1 t 0 k 0 1 2 and for t 0 t f this gives k 1 t s k 1 t k 1 2 28 and s k 1 satisfies s k 1 a k t s k 1 s k 1 t f i 2 29 in addition the multiplier associated with the terminal constraint is expressed as in 2 24 combining 2 28 with 2 3 gives the minimum energy control at the k 1 th iteration 2 30 u k 1 t r 1 b n j 1 x k 1 j n j t s k 1 k 1 note that the auxiliary variable p k t rn n at each iteration satisfies 2 25 and thus p k 1 0 a k t f 0 w k 1 t a k t f 0 where t a k t f t a k t t t f is the transition matrix for the homogeneous equation 2 29 and w k 1 t f 0 a k 0 b k r 1 b k t t a k 0 d is the controllability gramian for the time varying linear system as in problem p 3 or equiv alently as in 2 9 and 2 10 with q 0 moreover the closed loop expression in 2 30 is consistent with the open loop expression of the minimum energy control in terms of the con trollability gramian that is u k 1 r 1 b n j 1 x k 1 j n j t t a k 0 t w k 1 1 k 2 31 where k a k 0 t f x f x 0 3 convergence of the iterative method following the iterative algorithm described in section 2 2 we expect to find the optimal control for problem p 1 provided the iterations are convergent in this section we show that the convergence of this algorithm is pertinent to the controllability of the linear system considered at each iteration and depends on the choice of the weight matrix r in section 5 we will extend this iterative method to solve optimal control problems involving bilinear ensemble systems to facilitate the proof we introduce the following mathematical tools considering the banach spaces x c 0 t f r n y c 0 t f r n n and z c 0 t f r n with the fixed endpoint control for bilinear ensembles 7 norms x sup t 0 t f x t exp t for x x 3 1 y sup t 0 t f y t exp t f t for y y 3 2 z sup t 0 t f z t exp t f t for z z 3 3 in which v ni 1 vi for v r n and d max 1 j n ni 1 di j for d r n n and the parameter serves as an additional degree of freedom to control the rate of convergence 17 we define the operators t 1 x y z x t 2 x y z y and t 3 x y z z that characterize the dynamics of x x k y and s z as described in section 2 2 given by d dt t 1 x k s t a x t k t s t t 1 x k s t b x t r 1 b t x t t 3 x k s t b x t r 1 b t x t t 2 x k s t t 1 x k s t 3 4 t 1 x k s 0 x 0 d dt t 2 x k s t q t 2 x k s t b x t r 1 b t x t t 2 x k s t t 2 x k s t a x t k t s t a t x t k t s t t 2 x k s t 3 5 t 2 x k s t f 0 d dt t 3 x k s t a t x t k t s t t 2 x k s t b x t r 1 b t x t t 3 x k s t 3 6 t 3 x k s t f t 1 x k s t 2 x k s t 3 x k s where t 1 x k s t 2 x k s t 3 x k s is the multiplier satisfying 2 24 with these definitions and the following lemma the convergence of the iterative method can be devel oped using the fixed point theorem lemma 3 1 the matrix p k 1 t as in 2 25 is nonsingular over t 0 t f at each iteration k if and only if the time varying linear system in problem p 2 is controllable over 0 t f 19 proof see appendix 8 1 3 theorem 3 2 consider the iterative method with the iterations evolving according to x k 1 t t 1 x k k k s k k t 3 7 k k 1 t t 2 x k k k s k k t 3 8 s k 1 t k 1 t 3 x k k k s k k t 3 9 where the operators t 1 t 2 and t 3 are defined in 3 4 3 5 and 3 6 respectively if at each iteration k the linear system as in p 2 is controllable then t 1 t 2 and t 3 are contractive furthermore starting with a triple of feasible trajectories x 0 k 0 s 0 0 the iteration procedure is convergent and the sequences x k k k and s k k converge to the unique fixed points x k and s respectively proof because the linear system in p 2 is controllable at each iteration k by lemma 3 1 the matrix p k 1 defined in 2 25 is invertible and hence the multiplier k 1 expressed in 8 s wang and j s li 2 24 is well defined then we have at time t f s k 1 t f k 1 t 3 x k k k s k k t f k 1 since s k 1 t f i from 2 19 and 2 20 for each fixed t 0 t f we obtain the bounds a k 1 a k n i 1 gi 2 1 2 k 1 k n i j 1 hi j 2 1 2 k 1 x k 1 x k x k k 1 k b k 1 r 1 b k 1 t b k r 1 b k t n i j 1 hi j 2 1 2 x k 1 2 x k 2 where gi nir 1 bt br 1 nti and hi j nir 1 ntj n jr 1 nti and from 2 21 we have q k 1 q k for all k 0 1 2 substituting 2 18 into the above inequalities we can write these bounds in terms of x k 1 x k k k 1 k k and s k 1 k 1 s k k given by a k 1 a k n i 1 gi 2 1 2 x k n i j 1 hi j 2 1 2 k k 1 x k 1 x k k k 1 k k x k s k 1 k 1 s k k 3 10 n i j 1 hi j 2 1 2 k k 1 x k 1 s k 1 k 1 x k 1 x k b k 1 r 1 b k 1 t b k r 1 b k t n i j 1 hi j 2 1 2 x k 1 x k x k 1 x k 3 11 in addition the solution to 2 23 is given by s k 1 t a k t k k 1 b k r 1 b k t t t f s k 1 t f t a k b k r 1 b k t k k 1 t f t 3 12 where denotes the transition matrix associated with the homogeneous system 2 23 and s k 1 t f i then we have s k 1 t s k t t t s k 1 t t 1 s k 1 t a k a k 1 b k r 1 b k t b k 1 r 1 b k 1 t k k 1 3 13 b k 1 r 1 b k 1 t k k 1 k k s k d from the riccati equation for k k described in 2 22 we can write the differential equation for the difference k k 1 k k as d dt k k 1 k k k k 1 k k a k b k r 1 b k t k k 1 a k b k r 1 b k t k k 1 t k k 1 k k 3 14 k k a k a k 1 a k a k 1 t k k 1 k k b k r 1 b k t b k 1 r 1 b k 1 t k k 1 fixed endpoint control for bilinear ensembles 9 with the terminal condition k k 1 t f k k t f 0 applying the variation of constants formula backward in time from t t f to 3 14 and employing 3 12 yield k k 1 t k k t s k t t t f t s k t 1 k k a k a k 1 a k a k 1 t k k 1 k k b k r 1 b k t b k 1 r 1 b k 1 t k k 1 s k 1 1 d s k 1 t which results in k k 1 t k k t t f t 1 a k a k 1 2 b k r 1 b k t b k 1 r 1 b k 1 t d 3 15 where 1 and 2 are both finite time varying coefficients see appendix 8 2 similarly from 2 17 and 2 18 we can write the differential equation for x k 1 x k that is d dt x k 1 x k a k b k r 1 b k t k k 1 x k 1 x k a k a k 1 b k r 1 b k t b k 1 r 1 b k 1 t k k 1 b k 1 r 1 b k 1 t k k 1 k k x k 3 16 b k r 1 b k t b k 1 r 1 b k 1 t s k 1 k 1 b k 1 r 1 b k 1 t s k 1 k 1 s k k with the terminal condition x k 1 t f x k t f 0 applying the variation of constants formula to 3 16 yields x k 1 t x k t s k 1 t t 1 t 0 s k 1 t a k a k 1 b k r 1 b k t b k 1 r 1 b k 1 t k k 1 b k 1 r 1 b k 1 t k k 1 k k x k b k r 1 b k t b k 1 r 1 b k 1 t s k 1 k 1 b k 1 r 1 b k 1 t s k 1 k 1 s k k d it follows that x k 1 t x k t t 0 3 a k a k 1 4 k k 1 k k 5 b k r 1 b k t b k 1 r 1 b k 1 t 3 17 6 s k 1 k 1 s k k d where 3 4 5 and 6 are all finite time varying coefficients see appendix 8 2 further more since k 1 is a constant within each iteration k from 2 23 we can write d dt s k 1 k 1 a k t k k 1 b k r 1 b k t s k 1 k 1 10 s wang and j s li with the terminal condition s k 1 t f k 1 k 1 this allows us to write d dt s k 1 k 1 s k k a k b k r 1 b k t k k 1 t s k 1 k 1 s k k a k a k 1 b k 1 r 1 b k 1 t k k 1 k k b k r 1 b k t b k 1 r 1 b k 1 t k k 1 t s k k with the terminal condition s k 1 t f k 1 s k t f k k 1 k and then s k 1 t k 1 s k t k s k 1 t t 1 k 1 k t f t s k 1 t a k a k 1 b k 1 r 1 b k 1 t k k 1 k k b k r 1 b k t b k 1 r 1 b k 1 t k k 1 t s k k d from 2 24 we may obtain k 1 k p k 1 1 p k 1 t p k t k p k 1 1 s k 1 t s k t x 0 3 18 in which by evolving 2 25 backward in time from t t f the difference p k 1 t p k t satisfies p k 1 t p k t t f t s k 1 s k b k 1 r 1 b k 1 t s k 1 s k s k 1 b k r 1 b k t b k 1 r 1 b k 1 t s k d 3 19 using 3 18 and 3 19 we obtain s k 1 t k 1 s k t k t f t 7 a k a k 1 8 b k r 1 b k t b k 1 r 1 b k 1 t 3 20 9 k k 1 k k d where 7 8 and 9 are finite time varying coefficients see appendix 8 2 combining the bounds in 3 10 3 11 3 15 3 17 and 3 20 and using the def initions of the operators t 1 t 2 and t 3 in 3 4 3 5 and 3 6 respectively we reach the inequality that holds component wise given by t 1 x k k k s k k t 1 x k 1 k k 1 s k 1 k 1 t 2 x k k k s k k t 2 x k 1 k k 1 s k 1 k 1 t 3 x k k k s k k t 3 x k 1 k k 1 s k 1 k 1 m x k x k 1 k k k k 1 s k k s k 1 k 1 3 21 fixed endpoint control for bilinear ensembles 11 where m r 3 3 whose elements are all related to r 1 see appendix 8 3 as a result the eigenvalues of m can be made within the unit circle by choosing sufficiently large r there fore the operators t 1 t 2 and t 3 are contractive and the fixed point theorem 15 warrants the convergence of the iterative procedure to the unique fixed points i e x k x k k k and s k k s note that the choice of r determines the magnitude of eigenvalues of m and thus can also be used to improve the convergence rate of the iterative procedure remark 2 optimality of the convergent solution the convergence of x k x k k k and s k k s immediately leads to k by 2 11 and by the con tinuity of all the variables involved this in turn guarantees that the fixed points x and resulting from the iterative procedure are the solutions to 2 9 and 2 10 with the convergent a and b r 1 b t denoted a and b r 1 b t obtained from 2 6 and 2 7 respectively this implies that the convergent solution pair x satisfies the necessary optimality condition and thus the convergent control u is a candidate of the optimal control for problem p 1 4 global optimality of the convergent solution we have shown in remark 2 that the convergent optimal control u generated by the iterative procedure satisfies the necessary optimality condition in this section we will further illustrate that u may be the unique global optimal control given appropriate assumptions on the value function associated with problem p 2 4 1 optimality of the solution at each iteration for each iteration k p 2 is a time dependent problem with a specified the time horizon and the optimal control satisfies the hamilton jacobi bellman hjb equation given by v k t t x k min u u v k x k t x k t a k 1 x k b k 1 u 1 2 x k t qx k ut ru 0 4 1 with the boundary condition v k t f x k 0 where v k is the value function and u is the set of all admissible controls since the matrix r rn n is positive definite the func tion to be minimized in 4 1 is strictly convex in the control variable u as a result the minimization problem in 4 1 has a unique solution given by the stationary point satisfying b k 1 t v k x k t x k ru k t 0 or equivalently u k t r 1 b k 1 t v k x k t x k 4 2 substituting 4 2 into 4 1 gives a first order nonlinear partial differential equation v k t t x k 1 2 v k x k t x k t a k 1 x k x k t a k 1 t v k x k t x k 1 2 x k t qx k 1 2 v k x k t x k t b k 1 r 1 b k 1 t v k x k t x k 0 4 3 due to the quadratic and symmetric nature of 4 3 we consider the value function of the form v k t x 1 2 xt k k x xt s k k 1 2 k t p k k 4 4 with the boundary condition v k t f x k 0 where k k t s k t p k t rn n t 0 t f and k r it is straightforward to verify that v k t x k u k is a classical solution 12 s wang and j s li to the hjb equation 4 3 if the matrices k k t s k t and p k t satisfy the matrix differ ential equations 2 12 2 13 and 2 15 respectively with the respective boundary condi tions k k t f 0 s k t f i and p k t f 0 note that the value function v k t x k in 4 4 is continuously differentiable on its domain and extends continuously onto the terminal manifold n k x k t f x f 4 2 global optimality of the convergent solution we showed in section 4 1 that the control u k presented in 4 2 is the global optimum for the k th iteration in problem p 2 here we will show that the convergent solution u of u k i e u k u for the linear problem p 2 is indeed the global optimal control for the original bilinear problem p 1 under some regularity conditions on the value function associated with p 2 expressed in 4 4 theorem 4 1 consider the iterative method applied to problem p 2 and suppose that at each iteration k the linear system as in p 2 is controllable let u be the convergent solution of the optimal control sequence u k generated by the iterative procedure for k n i e u k u and let v be the corresponding convergent value function defined in 4 4 i e v k v if i v c 1 and v t and v x are lipschitz continuous and ii there exist real valued l 1 functions g t and hi x i 1 2 n i e g l 1 0 t f and hi l 1 m where m rn such that v k t t x k t g t for all k n and t 0 t f and for each component i v k x t x i hi x for all k n and for all x x k t rn then u is a global optimum for the original problem p 1 proof first of all the conditions in i guarantee the existence of the optimal control because the linear system as in p 2 is controllable at each iteration k there exist unique fixed points for the sequences x k k k and s k k such that x k x k k k and s k k s by theorem 3 2 it follows that the partial derivatives of v k with respect to t and x are convergent denoted v k t t x vt t x and v k x t x vx t x where vt t x 1 2 x t q a t k k a k b r 1 b t k x x t a t k b r 1 b t s 1 2 t s t b r 1 b t s vx t x k x s in which a and b r 1 b t are the limits of a k and b k r 1 b k t respectively following 2 19 and 2 20 because v k t t x k t and v k x t x k t are dominated by g t and h x h 1 hn respectively by the lebesgue dominated convergence theorem we have lim k v k t x lim k t 0 v k x d t 0 lim k v k x d t 0 v x d 4 5 lim k v k t x lim k x t x 0 v k x t x dx x t x 0 lim k v k x t x dx x t x 0 vx t x dx 4 6 where limk v k t x v t x by assumption because v is continuously differentiable with respect to both t and x we obtain from 4 5 and 4 6 the partial derivatives v t t x vt t x v x t x vx t x 4 7 fixed endpoint control for bilinear ensembles 13 in addition due to the convergence of the iterative procedure 4 3 is convergent to vt t x vx t x t a x 1 2 x t qx 1 2 vx t x t b r 1 b tvx t x 0 which by employing 4 7 and vx t x can be rewritten as v t t x v x t x t a x b r 1 b t 1 2 x t qx t b r 1 b t 0 with the boundary condition v t f x 0 because the convergent solution pair x satisfies the necessary condition see remark 2 the above equation is equivalent to by 4 2 2 9 2 10 and 2 1 v t t x v x t x t ax b n i 1 x i ni u 1 2 x t qx u t ru 0 4 8 since v is differentiable according to the dynamic programming principle 19 the quantity on the left hand side in 4 8 is non negative for every control u in the admissible control set u rm it follows that v u is a solution to the hjb equation of the original problem p 1 that is v t t x min u u v x t x t ax b n i 1 xini u 1 2 xt qx ut ru 0 4 9 with the boundary condition v t f x 0 furthermore the optimal control u is global and unique since the minimization in 4 9 is over a convex quadratic function in u and u is of the form as expressed in 2 26 5 optimal control of bilinear ensemble systems the iterative method presented in sections 2 2 and 3 can be directly extended to deal with optimal control problems involving a bilinear ensemble system consider the minimum energy control problem for steering a time invariant bilinear ensemble system indexed by the parameter varying on a compact set k rd given by d dt x t a x t b u m i 1 ui t bi x t 5 1 where x x 1 xn t m rn denotes the state k u 0 t rm is the control the matrices a rn n b rn m and bi rn n i 1 m for k follow ing the iterative procedure developed in section 2 2 we represent the time invariant bilinear ensemble system in 5 1 as an iteration equation and formulate the minimum energy optimal ensemble control problem as min j 1 2 t f 0 u k t t ru k t dt s t d dt x k t a k 1 t x k t b k 1 t u k p 4 x k 0 x 0 x k t f x f which involves a time varying linear ensemble system and where we consider the linear en semble system in a hilbert space setting that is the elements of the matrices a k 1 t r n n and b k 1 t rn m defined analogously as in 2 19 and 2 20 are real valued 14 s wang and j s li l and l 2 functions respectively over the space d 0 t k denoted as a k 1 ln n d and b k 1 ln m 2 d x 0 x f l n 2 k and r r m m 0 by the variation of constants formula the ensemble control law that steers the system in p 4 between x 0 and x f at time t f satisfies for each iteration k the integral equation l k u k k where k k 1 0 t f x f x 0 5 2 k 1 t 0 is the transition matrix associated with a k 1 t and where the linear op erator l k is compact 16 and is defined by l k u t 0 k 1 0 b k 1 u d 5 3 theorem 5 1 consider the optimal ensemble control problem p 4 let k n k n k n be a singular system of the operator l k defined in 5 3 the iterative procedure described according to 3 4 and 3 5 is convergent if the conditions i n 1 k k n 2 k n 2 ii k r l k 5 4 hold at each iteration k n where k is defined in 5 2 r l k denotes the closure of the range space of l k and k t d is the inner product defined in ln 2 k fur thermore starting with a feasible initial ensemble trajectory x 0 t for problem p 4 the sequences x k and u k as in 2 17 and 2 18 generated by the iterative method converge to the unique fixed points x and u respectively proof since the conditions i and ii hold for the operator l k at each iteration k the time varying linear ensemble system in p 4 obtained at each iteration k is ensemble controllable namely there exists a u k lm 2 0 t f that steers the ensemble from x 0 to x f at time t f moreover the minimum energy control that completes this transfer is an infinite weighted sum of the singular functions of l k i e u k n 1 1 k n k k n k n and for any 0 the truncated optimal control of u k i e u k n n k n 1 1 k n k k n k n 5 5 drives the ensemble from x 0 to an neighborhood of x f denoted b x f satisfying x k t f x f 2 where the positive integer n k depends on 0 16 in addition we denote the optimal trajectories corresponding to the controls u k and u k n as x k and x k n respectively then according to theorem 3 2 the iterative procedure applied to solve for problem p 4 will converge with the convergent optimal control and optimal trajectory pair defined by x u i e x k x and u k u however the iterations are evolved based on the linear ensemble system formed by the truncated trajectory x k n given by d dt x k 1 t a k n t x k 1 t b k n t u k 1 5 6 where a k n t a x k n t and b k n t b x k n t depend on x k n therefore it requires to show that at each iteration k the ensemble system as in 5 6 is ensemble fixed endpoint control for bilinear ensembles 15 controllable and furthermore the optimal control and optimal trajectory obtained based on this iteration equation converge to x and u respectively as k now let l k 1 n l m 2 0 t f l n 2 k be the operator defined by l k 1 n u t 0 k n 0 b k n u d 5 7 where k n t 0 is the transition matrix associated with a k n t and u l m 2 0 t f be cause by condition i u k n converges to u k uniformly 16 with u k u k n 2 2 n n 1 1 k n 2 k k n 2 0 as n 5 8 and l k is compact see appendix 8 4 so that l k u k l k u k n 2 2 n n 1 k n 2 u k u k n 2 0 as n 5 9 it follows that x k x k n 2 2 0 as n and consequently we have a k a k n 2 2 0 b k b k n 2 2 0 as n 5 10 which implies that at each iteration k the system 5 6 is also ensemble controllable for sufficiently large n next let u k 1 be the minimum energy control that steers the system in 5 6 at each iter ation from x 0 to b x f which is characterized by l k 1 n u k 1 k 1 where k 1 k n 0 t f x f x 0 also we recall that k n t 0 and k t 0 are the respective transition matrices associated with a k n l n n k and a k ln n k and thus k t 0 k n t 0 2 2 0 as n this guarantees k 0 t k n 0 t 2 2 0 as n since k n t 0 and k t 0 are both bounded then we have l k 1 u k 1 l k 1 n u k 1 2 k 1 k 1 2 k k n 2 x f 2 0 as n since x f ln 2 k this leads to x k 1 x k 1 22 0 as n where x k 1 is the trajectory resulting from u k 1 furthermore the property k k n 2 0 together with 5 7 and 5 10 gives l k 1 n l k 1 2 0 as n 5 11 because l k u k u k l k u k l k n u k l k n l k u k k k l k n l k u k we obtain as n u k 1 u k 1 2 x f 2 l k 1 2 k k n 2 u k 1 2 l k 1 2 l k 1 n l k 1 2 0 by 5 11 and by the facts x f l n 2 k u k lm 2 0 t f and l k 1 2 0 due to controlla bility of the system in p 4 16 s wang and j s li similar to 5 8 and 5 9 we have uniform convergence properties for u k n the truncated control of u k and for l k n such that u k u k n 2 2 0 and l k n u k l k n u k n 2 2 0 as n then the triangle inequality gives u k u k n 2 u k u k 2 u k u k n 2 0 5 12 and hence l k u k l k n u k n 2 l k 2 u k u k n 2 l k l k n 2 u k n 2 5 13 as n which guarantees that at each iteration k the trajectory x k n converges to x k which result from u k n and u k respectively i e x k x k n 2 2 0 as n 5 14 in addition since x k x and u k u as k we have u k n u 2 u k n u k 2 u k u 2 0 5 15 as k n by 5 12 as well as l k l 2 0 as k where l is the operator defined with respect to the convergent solutions x and given by l u t 0 0 b x t u d 5 16 in which t 0 is the transition matrix associated with a x t this then gives l k u k l u 2 l k 2 u k u 2 l k l 2 u 2 0 5 17 as k finally combining 5 13 and 5 17 and applying the triangle inequality yield l u l k n u k n 2 0 as k n which implies that x x k n 0 as k n this together with 5 15 concludes the convergence of the sequences u k n and x k n generated by the iterative method to u and x respectively i e the minimum energy ensemble control law and the optimal ensemble trajectory that satisfy the necessary optimality condition 6 examples and numerical simulations in this section we apply the developed it erative algorithm to solve optimal control problems involving single and ensemble bilinear systems including the well known bloch system that models the evolution of two level quan tum systems 3 ensemble control of bloch systems is a key to many applications in quantum control such as nuclear magnetic resonance spectroscopy and imaging mri quantum com putation and quantum information processing 21 22 as well as quantum optics 23 example 1 population control in socioeconomics we consider a simple but repre sentative bilinear system arising from the field of socioeconomics which models the dynam ics of population growth simplified based on the gibson s population transfer model 24 given by dxdt ux where x r represents the number of domestic laborers and u r denotes the attractiveness for immigration multiplier putting this into the canonical form as presented in 2 1 we have a 0 b 0 and n 1 we consider the design of the optimal control u for reducing two third of the domestic laborer population i e from x 0 1 to x t f 1 3 fixed endpoint control for bilinear ensembles 17 t 0 0 5 1 1 5 2 u 1 0 8 0 6 0 4 0 2 a the convergent optimal control t 0 0 5 1 1 5 2 x 0 0 2 0 4 0 6 0 8 1 b the optimal trajectory fig 1 a the optimal control that steers the bilinear system in example 1 from x 0 1 to x 2 1 3 while minimizing j 2 0 x 2 u 2 dt b the optimal trajectory following the optimal control shown in a 0 0 5 1 1 0 1 2 3 4 5 t u v 0 0 5 1 0 5 0 0 5 1 t x y z a the convergent minimum energy control and the resulting optimal trajectory 1 0 5 0 0 5 1 1 0 1 1 0 5 0 0 5 1 yx z b the optimal trajectory on the bloch sphere fig 2 a the minimum energy excitation 2 pulse left panel that steers the bloch system in 6 1 with 0 5 from x 0 0 0 1 t to x f 1 0 0 t at t f 1 and the resulting optimal trajectory right panel b the optimal trajectory on the bloch sphere in t f 2 which minimizes the cost functional j 2 0 x 2 u 2 dt the optimal control ob tained by the iterative method is shown in figure 1 a and the resulting optimal trajectory is displayed in figure 1 b example 2 excitation of a two level system a canonical example of optimal con trol of bilinear ensemble systems in quantum control is the optimal pulse design for the exci tation of a collection of two level systems 3 in which the dynamics of a quantum ensemble obeys the bloch equations and optimal pulses controls that steer the ensemble between states of interest are pursued the bloch equations form a bilinear control system evolving on the special lie group so 3 given by d dt x 1 x 2 x 3 0 u 1 0 u 2 u 1 u 2 0 x 1 x 2 x 3 6 1 where x x 1 x 2 x 3 t denotes the bulk magnetization of the spins denotes the larmor frequency of the spins and u 1 and u 2 are the radio frequency fields applied on the y and the x direction respectively 25 a common control task is to drive the system from the equi librium state x 0 0 0 1 t to an excited state on the transverse plane e g x f 1 0 0 t and in particular achieving the desired state transfer with minimum energy is of practical importance 3 18 s wang and j s li t 0 2 4 6 8 10 1 0 1 2 3 4 5 6 7 u v a the minimum energy ensemble control law 1 0 5 0 0 5 1 x 10 0 9999 1 1 0001 b the x components of the final states of the ensemble fig 3 a the minimum energy ensemble control that steers an ensemble of bloch systems with 1 1 from x 0 0 0 1 t to a neighborhood of x f 1 0 0 t the weighted matrix r i b the x components of the final states x 10 for 141 spin systems with their frequencies uniformly spaced within 1 1 following the minimum energy control displayed in a here we consider exciting a spin system with the larmor frequency 0 5 and first rewrite the bloch system in the canonical form as presented in 2 1 with a 0 0 0 0 0 0 0 b 0 n 1 0 0 0 0 1 0 n 2 0 0 0 0 0 1 n 3 1 0 0 1 0 0 and apply the iterative method described in section 2 2 to find the minimum energy control figure 2 a illustrates the convergent minimum energy control that steers the spin system from x 0 to x f at t f 1 and minimizes j 1 0 u 2 1 u 2 2 dt and the resulting trajectory is shown in figure 2 b this optimal control and the trajectory converge in 17 iterations starting with an initial trajectory x 0 with endpoints x 0 and x f with the least distance given the stopping criterion x t f x f 10 5 example 3 excitation of an ensemble of two level systems here we apply the iterative method to design a minimum energy broadband excitation 2 pulse that steers an ensemble of spin systems modeled in 6 1 with the ensemble state defined as x t x t y t z t t for 1 1 from x 0 0 0 1 t to x t f 1 0 0 t where t f 10 is the pulse duration at each iteration k the minimum energy ensemble con trol law is calculated using an singular value decomposition svd based algorithm 26 by which the input to state operator l k n as in 5 7 that characterizes the evolution of the system dynamics is approximated by a matrix of finite rank due to the compactness of this operator then the singular values k n and the singular vectors k n and k n are calculated using svd to synthesize the optimal ensemble control expressed in 5 5 26 the convergent minimum energy ensemble control law i e the minimum energy broadband 2 pulse is il lustrated in figure 3 a and the performance i e the x component of the final state x t f t f 10 for 141 spin systems is shown in figure 3 b the iterative algorithm converges in 152 iterations given the stopping criterion x t f x f 10 5 7 conclusion we develop an iterative method for solving fixed endpoint optimal con trol problems involving time invariant bilinear and bilinear ensemble systems we analyze the convergence of the iterative procedure by using the contraction mapping and the fixed point theorem the central idea of our approach is to represent the time invariant bilinear ensemble system as a time varying linear ensemble system and then to show in an iterative manner that the optimal control of the original bilinear ensemble system is the convergent optimal control of the associated linear ensemble system in addition we illustrate the condition for fixed endpoint control for bilinear ensembles 19 global optimality of the convergent solution finally we demonstrate the effectiveness and applicability of the constructed iterative method using several examples involving the control of population growth in socioeconomics and the design of broadband pulses for exciting an ensemble of two level systems which is essential to many applications in quantum control 8 appendix 8 1 sweep method and the notion of flow mapping we illustrate the idea of the developed sweep method for dealing with fixed endpoint optimal control problems presented in section 2 1 using the notion of flow mapping 19 and show the connection between the non singularity of the matrix p defined in 2 15 and the controllability of the system in p 2 8 1 1 flow mapping in optimal control consider the optimal control problem pa rameterized by p given by min j t f 0 l t x t p u t p dt s t x t p f t x t p u t p p 5 where p r represents the perturbation of extremals let e be a cr parameterized family of extremals for problem p 5 and suppose that f e g is the flow restricted on a subset e of the t p space which is a c 1 r diffeomorphism onto an open subset g r rn of the t x space let c be the cost to go function for problem p 5 then the value function ve g r of e defined by ve c f 1 is continuously differentiable in t x and r times continuously differentiable in x for any fixed t see theorem 5 2 1 in 19 in addition the function u g r defined by u u f 1 is an admissible feedback control that is continuous and r times continuously differentiable in x for any fixed t the diagrams below illustrate the relation of the mappings defined above e f c r g v e e f u r g u together the pair ve u is a classical solution to the hamilton jacobi bellman equation and the following identities hold for all p ve t t x t p h t t p x t p u t p ve x t x t p t p where h is the hamiltonian associated with problem p 5 and is the co state of x v e is r 1 times continuously differentiable in x on g because e is nicely cr parameterized and then we have 2 ve x 2 t x t p p t p x p t p 1 provided that x p t p is invertible 8 1 2 sweep method derived based on the flow mapping now consider the param eterized optimal control problem associated with problem p 2 given by min j 1 2 t f 0 xt t p qx t p ut t p ru t p dt s t x t p a x t p b u t p p 2 p x 0 p x 0 x t f p x f 20 s wang and j s li we then have for this parameterized lqr problem d dt x p t p a x p t p b r 1 b t p t p d dt p t p q x p t p a t p t p defining t p p t p k t p x p t p s t p p p 8 1 with t f p 0 where k and s satisfy the matrix differential equations 2 12 and 2 13 with the terminal conditions k t f p 0 r n n and s t f p i r n n respectively 8 1 yields t p d dt p k x p k d dt x p s p p q x p a t p q ka a t k kb r 1 b t k x p k a x p b r 1 b t p a t kt b r 1 b t s p p a t kt b r 1 b t t p this gives t p 0 since t f p 0 and hence guarantees from 8 1 that p t p k t p x p t p s t p p p which we adopted to define 2 11 in order to fulfill the terminal condition x t f p x f at time t f we introduce the auxiliary variables o t p p t p rn n and set x f o t p x t p p t p p 8 2 clearly at t t f we need o t f p i and p t f p 0 taking the time derivative on both sides of 8 2 we get 0 o t p x t p o t p x t p p t p p which results in o t p o t p a b r 1 b t k t p x t p p t p o t p b r 1 b t s t p p 0 since it holds for all x and we have o t p o t p a b r 1 b t k t p 0 with o t f p i 8 3 p t p o t p b r 1 b t s t p 0 with p t f p 0 8 4 observe that from 8 3 o t t p satisfies the same equation for all p as s t in 2 13 with the terminal condition s t f p i hence o t p s t t p for t 0 t f then we can rewrite 8 4 as p t p st t p b r 1 b t s t p 0 8 5 for t 0 t f with the terminal condition p t f p 0 the multiplier associated with the terminal constraint can be expressed by 8 2 as p p t p 1 x f s t t p x t p provided p t p is invertible for t 0 t f note this condition holds for all t 0 t f i e p is a constant for a fixed p hence plugging in t 0 we have p in terms of the initial and terminal states given by 8 6 p p 0 p 1 x f s t 0 p x 0 fixed endpoint control for bilinear ensembles 21 8 1 3 controllability of the system in p 2 p and non singularity of the matrix p the following two lemmas will illustrate that controllability of the system in p 2 p guarantees non singularity of the matrix p so that p in 8 6 is well defined lemma 8 1 the matrix p p is singular if and only if there exists a nontrivial solu tion t p of the linear adjoint equation f x t x t p u t p with the termi nal condition t f p that is perpendicular to the terminal manifold at x t f p such that t p f u t x t p u t p 0 on the interval t f where x t p f t x t p u t p 19 lemma 8 2 a time varying linear system x a t x b t u is controllable over an in terval t f if and only if for every nontrivial solution of the adjoint equation a t the function t b t does not vanish identically on the interval t f it is completely con trollable if this holds for any subinterval t f 19 by lemma 8 2 the linear system x a t x b t u in problem p 2 p is controllable over an interval t t f if and only if for every nontrivial solution of the adjoint equation a t the function t b t does not vanish identically on the interval t t f which by lemma 8 1 is equivalent to the non singularity of p t p t 0 t f in particular for t 0 we have that p 0 t f is invertible if and only if the linear system x a t x b t u in problem p 2 p is controllable over an interval 0 t f 8 2 the coefficients in theorem 3 2 the time varying coefficients i i 1 9 in theorem 3 2 are finite and described below in which 0 t for 0 t t f 1 s k t t s k t 1 k k k k 1 s k 1 1 s k 1 t 2 s k t t s k t 1 k k k k 1 s k 1 1 s k 1 t 3 s k 1 t t 1 s k 1 t x k 4 s k 1 t t 1 s k 1 t b k 1 r 1 b k 1 t x k 5 s k 1 t t 1 s k 1 t k k 1 x k s k 1 k 1 6 s k 1 t t 1 s k 1 t b k 1 r 1 b k 1 t 7 p k 1 1 s k 1 s k b k 1 r 1 b k 1 t k x 0 k s k 1 t t 1 s k 1 t s k t 8 p k 1 1 s k 1 s k b k 1 r 1 b k 1 t k x 0 k s k 1 t t 1 s k 1 t k k 1 s k t p k 1 1 s k 1 s k k 9 p k 1 1 s k 1 s k b k 1 r 1 b k 1 t k x 0 k s k 1 t t 1 s k 1 t b k 1 r 1 b k 1 t s k t 22 s wang and j s li 8 3 the entries of the matrix m in 3 21 let p ni 1 gi 2 and q ni j 1 hi j 2 where gi and hi are defined as in 3 10 and 3 11 the entries of the matrix m in 3 21 satisfy the relations m 11 3 p x k 1 q k k q k k x k s k k 5 q x k x k 1 m 12 3 p x k 1 q x k 1 4 m 13 3 p x k 1 q 6 m 21 1 p x k 1 q k k q k k x k s k k 2 q x k x k 1 m 22 1 p x k 1 q x k 1 m 23 1 p x k 1 q m 31 7 p x k 1 q k k q k k x k s k k 8 q x k x k 1 m 32 7 p x k 1 q x k 1 9 m 33 7 p x k 1 q where denotes proportionality because both p and q are related to r 1 they can be made sufficiently small by choosing large enough r for example r i with 1 where i rm m is the identify matrix in addition for m 12 m 13 and m 32 the coefficients 4 6 and 9 defined in appendix 8 2 involve the factor b k 1 r 1 b k 1 t 0 t f which can also be made arbitrary small by adjusting r more specifically by choosing r with large eigenvalues thus each entry of m can be made sufficiently small through the choice of r 8 4 singular value expansion for compact operators theorem 8 3 singular value expansion 27 let y and z be hilbert spaces k y z be a compact operator and n n n n be a singular system for k then ky n n y n n k z n n z n n for all y y z z in particular if kny nj 1 j y j j for y y and k is of infinite rank namely n then k kn sup j n j 0 as n 9 bibliography references 1 s ching and j t ritt control strategies for underactuated neural ensembles driven by optogenetic stimula tion front neural circuits vol 7 p 54 2013 2 b pryor fourier decompositions and pulse sequence design algorithms for nuclear magnetic resonance in inhomogeneous fields journal of chemical physics vol 125 p 194111 2006 3 j s li j ruths t y yu h arthanari and g wagner optimal pulse design in quantum control a unified computational method proc natl acad sci vol 108 no 5 pp 1879 1884 2011 4 i z kiss c g rusin h kori and j l hudson engineering complex dynamical structures sequential patterns and desynchronization science vol 316 no 5833 pp 1886 1889 2007 5 s ching and j t ritt sampling based learning control of inhomogeneous quantum ensembles physical review a vol 89 p 023402 2014 6 u ledzewicz and h scha ttler optimal bang bang controls for a two compartment model in cancer chemotherapy journal of optimization theory and applications vol 114 pp 609 637 2002 7 a becker and t bretl approximate steering of a unicycle under bounded model perturbation using ensem ble control ieee trans on robotics vol 28 no 3 pp 580 591 2012 8 z aganovic the successive approximation procedure for finite time optimal control of bilinear systems automatic control ieee transactions on vol 39 pp 1932 1935 1994 fixed endpoint control for bilinear ensembles 23 9 r r mohler and a y khapalov bilinear control and application to flexible a c transmission systems journal of optimization theory and applications vol 105 pp 621 637 june 2000 10 q gong w kang and i m ross a pseudospectral method for the optimal control of constrained feedback linearizable systems ieee transactions on automatic control vol 51 no 7 july 2006 11 i ross and f fahroo legendre pseudospectral approximations of optimal control problems in new trends in nonlinear dynamics and control and their applications pp 327 342 2004 12 a v rao a survey of numerical methods for optimal control advances in the astronautical sciences vol 135 no 1 pp 497 528 october 2009 13 e bertolazzi f biral and m d lio symbolicnumeric indirect method for solving optimal control prob lems for large multibody systems multibody system dynamics vol 13 pp 233 252 march 2005 14 j ruths and j s li optimal control of inhomogeneous ensembles ieee transactions on automatic con trol special issue on control of quantum mechanical systems vol 57 no 8 pp 2021 2032 2012 15 r w brockett finite dimensional linear systems new york john wiley sons inc 1970 16 j s li ensemble control of finite dimensional time varying linear systems ieee transactions on auto matic control vol 56 no 2 pp 345 357 2011 17 e p hofer and b tibken an iterative method for the finite time bilinear quadratic control problem journal of optimization theory and applications vol 57 no 3 1988 18 t c imen and s p banks nonlinear optimal trackingcontrol with application to super tankers for autopilot design automatica vol 40 pp 1845 1863 2004 19 h scha ttler and u ledzewicz geometric optimal control theory methods and examples new york springer interdisciplinary applied mathematics 38 2012 20 a e bryson and y c ho applied optimal control optimization estimation and control revised print ing taylor francis group 1975 21 j s li and n khaneja control of inhomogeneous quantum ensembles physical review a vol 73 no 030302 r 2006 22 h mabuchi and n khaneja principles and applications of control in quantum systems international jour nal of robust and nonlinear control vol 15 p 184505 2008 23 m s silver r i joseph and d i hoult selective spin inversion in nuclear magnetic resonance and coherent optics through an exact solution of the bloch riccati equation physical review a vol 31 no 4 pp 2753 2755 1985 24 j e gibson a philosophy for urban simulations ieee transactions on systems man and cybernetics vol smc 2 no 2 april 1972 25 j s li and n khaneja ensemble control of bloch equations ieee transactions on automatic control vol 54 no 3 pp 528 536 2009 26 a zlotnik and j s li synthesis of optimal ensemble controls for linear systems using the singular value decomposition in 2012 american control conference montreal june 2012 27 i gofberg s goldberg and m a kaashoek basic classes of linear operators boston ma birkha user verlag 2003