the numerical search for the internal dynamics of nhims and their pictorial representation francisco gonzalez montoya and christof jung school of mathematics university of bristol bristol bs 8 1 ug united kingdom instituto de ciencias f sicas universidad nacional auto noma de me xico av universidad s n cuernavaca 62251 me xico francisco glz mty gmail com abstract the topic of this article is the numerical search of codimension 2 normally hyperbolic invariant manifolds in hamiltonian systems with 3 degrees of freedom and their internal dynamics we point out relations between different strategies to find such surfaces numerically we can start from index 1 saddles of the effective potential or from a partially integrable case and follow the nhim along some curve in the parameter space of the system or we can look for the stable and unstable manifolds of such surfaces by an appropriate indicator method we show numerical examples for an electron moving in a perturbed magnetic dipole field 1 introduction the study of phase space structures is a fundamental problem in dynamical systems it is essential to understand the behaviour of the trajectories from a theoretical and practical perspective the traditional tools to visualize the phase space structures like the projection of the trajectories onto a plane or poincare maps are important to understand diverse properties of the phase space however the study of the phase space structures of multidimensional systems remains an open and challenging problem new tools have been devel oped to study the phase space structures of multidimensional systems like fast lyapunov exponents fle 1 mean exponential growth factor of nearby orbits megno 2 smaller alignment indices sali generalized align ment indices gali 3 and lagrangian descriptors lds 4 5 the phase space structure indicators are scalar fields constructed with the trajectories of the system the differences in the values of the scalar fields give us informa tion of the phase spaces objects that intersect the set of trajectories considered one of the most intuitive indicators are the lagrangian descriptors based on trajectories arc length some recent examples are presented in the references 6 7 8 9 10 11 the differences in the arc length of the trajectories with nearby initial conditions give us information about the phase space around those 1 ar x iv 2 20 3 10 68 8 v 1 nl in c d 2 1 m ar 2 02 2 initial points in this work we use a quantity related to the arc length the de lay time the delay time is a natural indicator to study the dynamics of open systems the topic of this article is the numerical search for normally hyperbolic invariant manifolds usual abbreviation nhims their internal dynamics and their pictorial representation we concentrate on hamiltonian systems with three degrees of freedom abbreviation 3 dof and work to a large extent with the poincare map of the system which has a 4 dimensional domain for a given value of the energy dynamical systems have some skeleton that directs the global dynamics to a large extent in a 2 dimensional map the most important bones of the skeleton are the fixed points the stable ones are centres of islands of regular motion and the unstable ones are the organizing centres of chaotic regions these unstable fixed points have stable and unstable manifolds which build up horseshoe structures in the map for the importance of horseshoes in dynamical systems see section 3 2 in 12 and for a pictorial explanation of them see chapters 13 and 14 in 13 note that the fixed points are of codimension 2 in the map domain accordingly the stable and unstable manifolds of hyperbolic fixed points are of codimension 1 therefore they form local divisions between regions of different behaviour and they can channel and guide the dynamics in the corresponding chaotic region of the domain of the map when we go over to 4 dimensional maps then the question arises which subsets in this case take over the role that the hyperbolic fixed points play in 2 dimensional maps a first but wrong guess might be that again the completely hyperbolic fixed points play this key role however in 4 dimensions the stable and unstable manifolds of hyperbolic hyperbolic or also of complex unstable fixed points have dimension 2 therefore they are of codimension 2 in the 4 dimensional domain of the map and accordingly they do not form local divisions to provide local divisions we need surfaces of codimension 1 and such dividing surfaces of codimension 1 can be the stable and unstable manifolds of invariant subsets of dimension 2 and thereby also codimension 2 which are hyperbolic in normal directions that is they are normally hyperbolic invariant surfaces of codimension 2 these surfaces are the topic of the present article the principal tasks addressed in this article are the following find 2 dimensional normally hyperbolic invariant manifolds in a 4 dimensional hamiltonian map find the internal dynamics of these nhims and present it graphically of course it is not easy to find such surfaces as long as we do not have any reasonable idea where to start the search and what shape to search for we need some clue in which parts of the phase space we begin our search and what approximately should be the shape of this surface in section 2 we discuss two particular situations where we know beforehand a rather good approximation for the nhim then the initial step is a numerical construction of the nhim for these simple particular starting cases next we need the idea of how to follow the nhim numerically under perturbations of the simple initial cases this can be done by following the stable manifold of the nhim the existence of the nhims and their stable manifolds under sufficiently small perturbations is guaranteed by the persistence theorem see 14 15 in section 3 we demonstrate numerically how a plot of the delay time over some surface of the domain of the map identifies these stable manifolds in section 4 we show how a further selection of only the local segments of the stable manifold allows identifying 2 the internal dynamics of the nhims and their graphical representation as an example of demonstration we use the motion of an electron in a perturbed magnetic dipole field in section 5 we give final remarks and conclusions 2 the particular parameter case to start from the problem is to search for a 2 dimensional nhim surface in a 4 dimensional poincare map this may be not easy if we do not know which region of the domain of the map to start the search very helpful is some information about the location of the nhim for particular parameter cases then we can start from these particular cases and follow the nhim under general changes of the system parameters during changes of the parameters we always have the idea in mind that thanks to the persistence theorem small changes of the parameters cause small changes of the shape and the location of the nhim only the persistence theorem holds as long as the tangential instability on the nhim is smaller than its normal instability so far we are aware of 2 very different possibilities to start at particular parameter values for which we know approximately the location of the nhim the first one is a start at an energy value just a little bit above the energy of an index 1 saddle of the effective potential of the system the second one is a start at a parameter case that is partially integrable in the following subsections we first present these two possibilities and then give some comments on the connection of the second possibility with the first one 2 1 index 1 saddle of the effective potential assume a hamiltonian 3 dof system with position coordinates q 1 q 2 q 3 and canonically conjugate momentum coordinates p 1 p 2 p 3 in the following we just write q or p when we mean the collection of the 3 components the hamil tonian function is given as h p q the effective potential of the system as a function of the position coordinates is given by veff q min p h p q 1 that is we take the minimum of the hamiltonian over the momentum at a fixed position see also 16 17 now assume that veff q has a nondegenerate index 1 saddle point at qs and that veff qs es for total energies e just a little above es it is a good approximation to expand veff q in a power series around qs and to truncate the series after the quadratic terms in this approximation we can calculate analytical solutions of the equations of motion for an index 1 saddle of a 3 dof system we obtain two very special solutions over this saddle the lyapunov orbits 18 they are periodic orbits that oscillate over the saddle and are dynamically unstable in the unstable direction of the potential furthermore there is a 2 dimensional continuum of quasiperiodic trajectories over the saddle we can imagine that over a saddle point of the potential of a 3 dof system there exist 3 normal modes for an index 1 saddle one of them belongs to the unstable direction of the potential and leads to trajectories that run away from the saddle exponentially the other two normal modes are oscillatory and the pure form of an oscillatory normal mode is the corresponding lyapunov orbit 3 we can understand the existence of the continuum of localized trajectories as follows imagine we treat the energy value e es e and we want to excite the stable oscillatory modes over the saddle only then we have a 1 dimensional continuum of possibilities to distribute the energy e between the two oscillatory modes and in addition we have a 1 dimensional continuum of possibilities for the initial relative phase shift between the two oscillatory modes in total we obtain a 2 dimensional continuum of trajectories localized over the saddle and consisting of quasiperiodic superpositions of the two localized normal modes this set of localized trajectories forms a 3 dimensional surface in the 5 dimensional energy shell it is the nhim in the energy shell in quadratic approximation it is a 3 dimensional ellipsoid this surface has two important properties first it is invariant under the dynamics an initial point on this surface leads to a trajectory that stays on this surface for all times and second this surface is dynamically unstable hyperbolic in directions normal to the surface i e in directions of the third unstable normal mode of the potential saddle these two properties of the surface explain the origin of the name normally hyperbolic invariant manifold in many cases it is more convenient to handle poincare maps instead of flows without loss of generality we assume that the intersection condition for the map is q 3 0 in general one particular intersection has to be chosen only in the case of a discrete symmetry q 3 q 3 the orientation is irrelevant and the intersections of both orientations can be used for a 3 dof system at fixed energy the domain of the map has dimension 4 in the map the nhim is represented by a 2 dimensional surface in section 4 of 19 the analytical construction of the nhim in quadratic approximation has been presented in all details for an example from celestial mechanics 2 2 stack construction in the partially integrable case other situations where we know the approximate position of the important nhim beforehand are the cases where the system we are interested in is close to a partially integrable case then we treat first the partially integrable lim iting case and later we switch on the nonintegrable perturbation and follow the nhim along with the perturbation in this subsection we concentrate on the partially integrable case that is we consider the case where there is a second independent conserved quantity besides the energy but there is no third independent conserved quantity we take as an example of demonstration the motion of an electron in a magnetic field where the partially integrable case is the pure dipole field and the perturbation is the addition of higher multipole contributions which destroy the rotational symmetry of the pure dipole case see also 20 21 assume that the given 3 dof hamiltonian h q 1 q 2 q 3 p 1 p 2 p 3 does not depend on q 2 accordingly p 2 is a conserved quantity and q 2 is a cyclic position variable as the intersection condition for the poincare map m we still use q 3 0 with appropriate orientation conditions as explained at the end of the last subsection the domain d of m has the coordinates q 1 q 2 p 1 p 2 the whole phase space and also the domain d have a foliation into invariant leaves of constant p 2 the reduced dynamics inside of each leave is generated by the 2 dof hamiltonian h 2 dof q 1 q 3 p 1 p 3 c where c is a fixed value of p 2 and thereby p 2 acts as a parameter in this reduced dynamics to this reduced 4 dynamics belongs a reduced 2 dimensional poincare map m 2 dof c having the q 1 p 1 plane as domain the intersection condition of m 2 dof c is the same as the one for the full map m now the full dimensional map m can be reconstructed from the reduced map along with the following stack construction first we construct the contin uum of 2 dimensional poincare maps m 2 dof p 2 assume that this dimension reduced map has a hyperbolic fixed point x p 2 in the interval p 2 a b next we pile up the 2 dimensional maps where we use p 2 as stack parameter the stack of the fixed points x p 2 is given by a curve c in this stack which projects 1 1 onto the p 2 axis finally we form the cartesian product of the stack with the manifold a of the possible values of q 2 depending on whether the second degree of freedom is open or closed this manifold a can be either a line or a half line or a finite interval or a circle the cartesian product of c with a results in a 2 dimensional surface s lying in d by construction this surface is invariant and because it originates from a fixed point which is hyperbolic in the q 1 p 1 plane also s is hyperbolic in the q 1 p 1 directions i e it is hyperbolic in its normal directions then s is the nhim for the poincare map that we have been looking for next we demonstrate the procedure for the example of the motion of a charged particle in a magnetic dipole field the partial integrability becomes evident due to the symmetry of the magnetic field with respect to rotations around the axis defined by the magnetic moment of the dipole for this case the hamiltonian in cylindrical coordinates is given as h 1 2 m p 2 p 2 z lz e c a z 2 2 the component of the magnetic dipole potential is given as a a 0 2 z 2 3 2 3 where a 0 is the dipole moment e is the charge of the electron and m its mass and c is the speed of light as explained in 22 all these 4 constants can be scaled away therefore we will set them to the value 1 the other components of the magnetic potential are zero for a pure dipole aligned in the z direction the angle does not appear in h therefore lz is a conserved quantity that we can handle as if it would be a parameter we can separate away the degree of freedom and are left with a 2 dof system whose hamiltonian is still given by eq 2 the corresponding effective potential is given by setting p 0 and pz 0 in eq 2 vlz z 1 2 lz 2 z 2 3 2 2 4 the fig 1 shows a plot of the potential energy vlz z in colour scale for lz 1 this potential has a saddle point qs at 2 lz z 0 with a saddle energy es l 4 32 over the potential saddle we have an unstable periodic orbit lz the lyapunov orbit which for a given total energy e exists in the parameter interval lz lmin lmax where lmax 32 e 1 4 and lmin can only be 5 figure 1 the effective potential vlz z for lz 1 is plotted in colour scale the light green curve is the energy level set of the saddle energy es l 4 32 0 03125 this curve has a selfintersection at the saddle point qs z 2 0 the dark green curve is the minimum of the potential i e vlz z 0 the blue curve is the lyapunov orbit lz over the saddle for lz 1 and e 0 05 this unstable periodic orbit corresponds to the hyperbolic fixed point xlz in the poincare map with intersection condition z 0 and e 0 05 6 determined numerically as lmin 0 788 lmax at lmax the lyapunov orbit lz disappears in the energetic boundary and at lmin it disappears in a saddle centre bifurcation colliding with an elliptic periodic orbit many more details on these events are explained in 23 20 21 the lyapunov orbit corresponds mainly to an oscillatory motion in the z direction and in the 2 dimensional poincare map for the reduced system it appears as a hyperbolic fixed point for the poincare map we choose the intersection condition z 0 where the orientation is irrelevant because of the reflection symmetry in z now we look at the energy shell of the full 3 dof system this 5 dimensional constant energy manifold has a natural invariant foliation into the leaves of con stant lz we can imagine a stack construction where lz is the stack parameter consequently the domain of the full poincare map has this stack structure the stack of the hyperbolic fixed points xlz of the reduced map gives in a first step a curve that extends over the interval lmin lmax and in a second step the inclusion of the cyclic angle gives a cartesian product of this curve segment with a circle s 1 thereby the surface in the 4 dimensional domain of the full map is a 2 dimensional cylinder segment this cylinder segment is the nhim m in the poincare map for the partially integrable case and is given by m lz xlz s 1 5 naturally m has stable and unstable manifolds that we can construct in an analogous way taking the union of all the stable and unstable manifolds of the hyperbolic fixed points xlz parametrized by the conserved quantity lz and take the cartesian product with the circle s 1 that represents their conjugate angle w s u m lz w s u xlz s 1 6 the nhim m for the poincare map corresponds to an unstable invariant surface for the flow in the constant energy manifold it is the starting point to follow the nhim surface through the perturbation of the partial integrability for a lot more details see 21 2 3 effective potential for the partially integrable case in the last two subsections we have presented two possibilities to find nhims for particular parameter cases which we can use as a starting point to investigate the development scenario of a nhim the first possibility works for energies just a little above an index 1 saddle of the effective potential and the second possibility is appropriate for systems close to a partially integrable case now the reader may ask the following can we also apply the first method to a partially integrable case does it lead to the same nhim as the second method which one of the two methods is easier to apply if we try to apply the first method to the hamiltonian h described in the second paragraph of subsection 2 2 then we run immediately into the following problem this hamiltonian does not really depend on the position coordinate q 2 thus the minimalization of this hamiltonian with respect to the momentum 7 figure 2 poincare map of the 3 dof symmetric system the poincare map is constructed as a union of the poincare maps of the 2 dof systems parametrized by the conserved momentum lz and taking the cartesian product with the uni tary circle s 1 that represents their conjugate angle the grey line is formed by the hyperbolic fixed points xlz the stable and unstable manifolds w s u m form spirals when lz grows also leads to an effective potential which does not depend on the position coor dinate q 2 i e the application of eq 1 does not lead to a potential having any nondegenerate extremal point we can avoid this difficulty by the application of a canonical transformation which interchanges the roles of q 2 and p 2 i e we apply the canonical transformation p 2 q 2 and q 2 p 2 then the minimal ization with respect to the new momentum leads to an effective potential that depends explicitly on all three new position coordinates of course it coincides with the effective potential that we obtain when we treat p 2 as a parameter and minimalize the original hamiltonian with respect to p 1 and p 3 only therefore it is obvious that both methods lead to the same effective potential and in the end to the same nhim motivated by these questions and problems we try to apply next the first method to the example of the magnetic dipole we will see that this particu lar example shows interesting additional difficulties the hamiltonian for this system in cartesian coordinates is h q p 3 j 1 1 2 m pj e c aj q 2 7 for any value of q we obtain the minimal possible value of h by setting pj eaj q c and this minimal value is always 0 that is vlz 0 for a charged particle in a magnetic field of course this potential does not have any nondegenerate index 1 saddle points and the method from subsection 1 can not be applied in its original form an effective potential identically zero for a charged particle in any magnetic field is consistent with the properties of the magnetic forces namely magnetic forces are always perpendicular to the velocity of the particle therefore the speed of the particle is constant only the 8 direction of the velocity changes as a consequence the kinetic energy of the particle is conserved and this means that the potential energy is a constant which we always can take to be the value zero now we are led naturally to the following question how can we obtain the effective potential from eq 4 by applying the rule from eq 1 to the dipole case first from eq 4 it becomes clear that we should use cylindrical coordinates which are adapted to the symmetry of the dipole field second in eq 1 we keep the position coordinates fixed and in eq 4 the angular momentum lz acts as a parameter i e it is a quantity that is kept fixed and the conjugate angle is not the appropriate candidate to be fixed this suggests the following idea apply a canonical transformation that interchanges the roles of and lz i e we take q 2 lz and p 2 now an application of the rule from eq 1 immediately leads to the effective potential form eq 4 however this potential does not have any nondegenerate index 1 saddle in its 3 dimensional domain therefore the rule from subsection 1 to construct an approximation for the nhim m still does not work here the following idea helps the force in direction is zero at s 2 lz accordingly for lz lmax there exists the periodic orbit with s and z pz p all identically zero and a constant angular velocity l 3 z 8 in direction in the map it is an invariant circle going around in direction at constant values of the other 3 coordinates p lz of the domain of the map this circle is the upper boundary of the nhim in the map and it is dynamically unstable in the direction for any lz value a little smaller than lmax there must be some value of close to s that belongs to an invariant circle of the map for this value of lz etc thereby starting from lmax we can work our way down in lz numerically in small steps until we approach the so far unknown lmin we notice when we approach lmin by monitoring the normal instability as a function of lz when lz approaches lmin then the normal eigenvalue approaches 1 from above numerically we simply check the loss of instability in direction so we obtain the cylinder segment of the nhim m numerically in the poincare map the example of the dipole suggests the following the application of the first method to a partially integrable case can lead to tricky problems index 1 saddles of the effective potential for the reduced system are not necessarily related to index 1 saddles of the effective potential for the full dimensional sys tem if we can make a dimension reduction of the system then it leads to a simpler system this is consistent with the general recommendation to apply dimensional reductions whenever this is possible the second method is easier to understand and to perform when we have some partially integrable system to start from in previous numerical investigations of the development scenarios of nhims in 3 dof systems we used successfully and without running into unex pected difficulties the second method for the magnetic dipole problem 21 and for a model map also having a rotationally symmetric limit case to start with 24 in contrast we used the first method for several examples from celestial mechanics 20 25 26 27 28 and also for the hydrogen atom in an external rotating field 29 example systems far away from any partial integrability the concluding recommendation is whenever we have a nearby partially integrable system then we use the second method the first method is the only choice and works well if the system is far away from partial integrability if neither of these two strategies is appropriate for a given system then the 9 application of more general indicator methods might be the natural approach the application of indicators is the theme of the next section 3 the delay time as an indicator of stable man ifolds of invariant subsets for the symmetric and perturbed cases the motivation to introduce a delay time comes from the problem of chaotic scattering the reference 30 is a review on chaotic scattering and some recent examples for chaotic scattering can be found in 35 31 32 33 34 36 when an incoming scattering trajectory runs exactly on the stable manifold of a localized subset sitting in the interaction region then the trajectory will converge to this localized subset and gets stuck in the interaction region when the trajectory does not start exactly on the stable manifold but close to it then it comes close to the localized subset and stays some time in its neighbourhood before it leaves the interaction region again and returns to the asymptotic region it has a time delay in the interaction region thereby in the set of all initial asymptotes the time delay in the interaction region is an indicator for the stable manifolds of localized subsets let us assume we prepare the initial conditions of the trajectory on an in coming asymptote at time ti at a point ri and with velocity vi running in the direction towards the interaction region take the point r 0 as some reference point in the interaction region then the initial distance from the interaction region is di ri r 0 and the particle needs the time di vi to reach the inter action region we measure the outcoming asymptote at time tf at a point rf leaving the interaction region with velocity vf accordingly the particle spent the time df vf along the outgoing asymptote the time delay in the interaction region is the elapsed total time minus the time spent along with the incoming and outgoing asymptotes in total we find the time delay t in the interaction region as t tf ti df vf di vi 8 note that according to this definition the time delay is independent of the exact point along the asymptotes where we prepare and measure the asymptotic motion now let us construct an indicator in analogy to these ideas coming from chaotic scattering we choose a plane p of initial conditions in the energy shell which intersects the important phase space objects like the stable and unstable manifolds of a nhim and possibly the nhim itself this plane p will become the domain of the indicator plot let us explain the numerical calculation of the indicator value t for some point x 0 p in the sense of scattering we assume that the initial point lies in the interaction region and we also choose an origin of the position coordinates lying in the interaction region we choose some value of the integration time and construct the trajectory through x 0 up to the time in the future and also up to the time in the past by following the time reversed dynamics 10 at the time the trajectory arrives at a final point x at a distance d from the origin and with speed v then the time delay for the future motion is t d v under the time reversed dynamics the trajectory arrives at the time at the point x at a distance d from the origin and with speed v accordingly the time delay of the past motion is t d v large values of the forward contribution t indicate the stable manifolds and large values of the backward contribution t indicate the unstable mani folds of localized invariant subsets with increasing values of we detect higher levels of the fractal hierarchy of the infinity of tendrils of the invariant mani folds the sum of the forward and backward contributions gives the complete indicator value t defined as t t t 2 d v d v 9 in analogy to eq 8 for the time delay of scattering first let us consider the partially integrable system given by the hamiltonian h from eq 2 and initial conditions in the plane p with lz 1 and z 0 for an arbitrary angle the results for the delay time for integration time 15 are displayed in fig 3 the intersection of stable and unstable manifolds of the nhim with the set of initial conditions has a high value of t the intersections between the stable and unstable manifolds are the points with the highest value of t we can appreciate the complicated structure of the tangles between stable and unstable manifolds in particular in fig 3 we can see two symmetric spirals in the indicator plot for the symmetric 3 dof system also the spirals are shown in the poincare maps in fig 2 of 20 for different values of lz the intersection with the nhim m is the black point 11 figure 3 delay time t for the symmetric system plotted over the canonical plane p with lz 1 and arbitray the intersection between the set of initial conditions and the nhim m is the hyperbolic fixed point xlz in black colour now let us consider a perturbed system with an additional component in the magnetic vector potential corresponding to a magnetic quadrupole in the z direction given by az 2 sin 2 2 z 2 5 2 10 where is the perturbation parameter to see the changes in the phase space of the systems let us calculate the delay time for different values of 0 05 0 2 0 25 the initial conditions in the same plane p with lz 1 z 0 for two angles 4 4 the results for the delay time are dis played in fig 4 for energy e 0 05 the left hand side panels show the results for 4 and on the right hand side for 4 the regions where the indicator has a sharp maximum correspond to initial conditions on invariant manifolds all the delay time calculations are done with the same integration time as before 15 an interesting difference between the plots on the panels d and f with the other plots in fig 4 is that the structures are more blurred and we can see only smaller segments of the invariant manifolds this difference shows that the trajectories in invariant manifolds in panels d and f require more integration time to reveal the invariant manifolds in the next section we are going to explain in more detail the origin of the difference when we calculate the nhim m and its internal dynamics for the same values of the perturbation parameter in the parts a b c and e of the fig 4 we see two rather well defined 12 lines that separate regions of clearly different delay times these two lines cross each other at a point xh at approximately 1 7 p 0 the point xh is the intersection point of the nhim m with the domain of the plot and the two division lines crossing at xh are the intersections of the local segments of the stable and unstable manifolds w s u m with the domain of the plot as always stable and unstable manifolds of codimension 2 invariant subsets act as separatrices between regions of distinct behaviour in contrast in the parts d and f of fig 4 these divisions are already washed out the reason is that for 0 2 or 0 25 the remaining parts of the nhim no longer intersect the p plane for 4 this decay of the nhim m will be shown in more detail in the figures coming up in the next section however we know that the nhim m itself is an accumulation set of homoclinic intersection surfaces and when parts of the nhim m survive the perturbation then also parts of the homoclinic intersection surfaces sur vive they are crossings of surviving parts of the stable and unstable manifolds w s u m and the corresponding bundles of segments of the stable or unsta ble manifold take over the role of the separatrix between different delay times also in regions of the phase space where the nhim m itself has disappeared for this reason we need a different method to study the decay of the nhims which will be presented in the next section 4 the numerical procedure to follow a nhim along a curve of the perturbation parameters in the last section we have seen the intersection of the stable manifold of the nhim m with some surface in general the trajectories close to this stable manifold w s m can be very complicated they can come close to the nhim m several times on very complicated trajectory segments in order to obtain better information on the internal dynamics ofm and to represent its internal dynamics graphically we can select out very special intersection curves in the intersection plane namely the intersections with the local segments of the stable manifold to understand the idea that we follow next we have to remember the folia tion theorem of the stable manifold see 15 essentially it says that the stable manifold transports the internal dynamics of the nhim along with it and when a trajectory starts on some leaf of the stable manifold then it converges to the corresponding substructure of the nhim and traces out this substructure as long as it is very close to the nhim when it starts close to the local seg ment of the stable manifold and is already close to the nhim itself it traces out the substructure over which it has started and now we describe a method to follow the nhim and its internal dynamics through perturbations that utilizes this idea see fig 5 let us assume we have the nhim given in the domain of the map for the parameter value 0 let us call it nhim 0 next we want to construct the nhim numerically in the map domain for a parameter value 1 let us call nhim 1 the corresponding nhim we choose 1 so close to 0 that we are confident that nhim 1 lies in a neighbourhood u 1 of nhim 0 to construct a numerical approximation to a trajectory on nhim 1 we apply the following procedure we 13 a b c d e f figure 4 delay time t plotted over the p plane at lz 1 and 4 in the panels a c d or 4 in the panels b d f respectively the value of the perturbation parameter is 0 05 in the panels a and b 0 2 in the panels c and d and 0 25 in the panels e and f respectively the total energy still is e 0 05 and the integration time is always 15 in the panels a b c and e the intersection point xh with the nhimm lies close to 1 7 p 0 in the panels d and f this point is no longer a part of the nhimm however it is still an accumulation point of homoclinic intersections between the stable and unstable manifold and therefore still appears similar to an intersection of separatrix lines 14 figure 5 algorithm to construct the nhimm and its internal dynamics the procedure to construct the nhim has 3 basic steeps find a point x 0 very close tom calculate its image under the poincare map xa 1 and project the image of this point close to the stable manifold w s m on the side where the dynamics is simple to get x 1 then we repeat the process to get an approximation to the trajectory contained on m 15 choose a line segment a 1 0 in u 1 e g the one with fixed coordinates l and let p run the chosen segment should lie completely inside of u 1 we place a large number of points aj on a 1 0 and calculate the numerical trajectory for each aj and note for each one of them the time tj that this trajectory spends inside of u 1 until it leaves u 1 for the first time let us call this time the dwelling time of the trajectory in u 1 we look for the maximal value of tj let us say it is the one for j j and choose a subset a 1 1 a 1 0 which is the interval from aj 1 to aj 1 then we place many points on a 1 1 calculate the dwelling time for all these points ona 1 1 and search again for the largest value and continue this zoom as long as our numerical accuracy allows so we zoom in to the maximal value of the dwelling time along the curve segment a 1 0 the idea behind this search is the stable manifold of the nhim call it w s nhim 1 has codimension 1 in the domain of the map therefore its local branch the part of this stable manifold that goes out directly from the nhim before starting with its infinity of tendrils should intersect any reasonably chosen 1 dimensional curve in a point and exactly at this point the corresponding trajectory converges to the nhim directly without leaving u 1 ever and the dwelling time diverges of course numerically we only obtain an approximation to this point however we construct a numerical approximation of an initial point on w s nhim 1 when we integrate numerically the trajectory belonging to this initial point then it first approaches the nhim stays in the close neighbourhood of the nhim for a finite time and in the long run leaves the nhim again because of the combination of small errors in the initial condition and the normal instability of the nhim now let us assume we have found this intersection point as well as we can with our finite numerical precision then we let the trajectory run for a time that is clearly smaller than its dwelling time we stop it at some intersection point with the domain of the map let us say it is the point pf then we take this final point as a new initial point construct the line segment within u 1 going in p direction through the point pf and take this new line segment as new a 0 and repeat the whole procedure described above this gives a continuation of the trajectory segment constructed above and so we continue until we have a large trajectory segment containing a lot of intersection points with the domain of the map by this method we obtain the corresponding trajectory in the map the construction is a combination of the numerical trajectory with occasional projections on w s nhim 1 it can be interpreted as a version of the control of chaos 37 38 where we keep a numerical trajectory in the neighbourhood of an unstable invariant subset the projections on w s nhim counteract the numerical errors and the normal instability of the nhim remember that we always project onto the local segment of the stable manifold and this is why the obtained trajectory traces out the substructure over which it has started if we have a sufficient number of points of a trajectory then we choose a new independent initial point and construct the corresponding numerical approxi mation of the trajectory on the nhim etc after having done this construction for many different initial points distributed over the whole nhim we have many points very close to the nhim 1 and also have many trajectories on the poincare map restricted to the nhim this gives first the surface of the nhim in the domain of the map and second it gives a graphical representation of the dynamics restricted to the nhim it is a representation of the 2 dof internal dynamics of the nhim 16 next we choose a new value 2 of the perturbation parameter choose as u 2 an appropriate neighbourhood of nhim 1 and repeat the whole method to obtain nhim 2 etc this provides a sequence of nhim constructions along a path in the parameter space the corresponding plots of the restricted map give a pictorial representation of the development scenario of the nhim for an application of this search strategy to the dipole problem see 21 for the application to several problems from celestial mechanics see 19 25 26 27 and for the application to hydrogen in a rotating field see 29 in this procedure we construct the intersection between a line of initial points and the local branch of w s nhim by searching for the point with the maximal dwelling time in an appropriate neighbourhood there is an alter native way to find this intersection point for some examples this includes the magnetic dipole problem let us mention this alternative method very briefly for the example of the dipole we know that the nhim has the shape of a cylinder segment which divides the domain at least locally into an interior and an exterior part on the part of the line of initial conditions on one side of the true intersection point the trajectories run to the interior and on the other side of the line of initial conditions they run to the exterior we define the neighbourhood u as a layer around the cylindrical nhim and this layer has two boundaries an inner one and an outer one as line segment a we choose a straight line segment that connects the inner and the outer boundary and the intersection of this line segment a with w s nhim is the division point between crossing first the inner and crossing first the outer boundary then we can search for this division point with a bisection method as long as it works reliably this bisection method is numerically faster let us consider the nhim m in the dipole system calculated with the procedure described before as in the previous section we choose again the values 0 05 0 2 0 25 for the perturbation parameter and the energy is still e 0 05 to visualize the nhim m it is convenient to take the poincare surface of section z 0 with both orientations because of the discrete reflection symmetry in z to visualize the iterations of the poncare map we take its projection onto the plane lz like in 21 figs 6 7 8 show the results we can appreciate how the rotational symmetry around the z axis is broken and the nhim bifurcates we observe the following important events in the development scenario of the internal dynamics of the nhim for small perturbations many primary kam curves survive only the primary curve with winding number 1 2 causes large scale secondary structures already for very small values of from this primary kam curve a pair of stable points of period 2 survives at 3 4 and 4 these two stable points become the centres of two large secondary kam islands in addition a pair of unstable points of period 2 survives at 4 and 3 4 these unstable points become the organizing centres of a fine chaos strip which looks like a separatrix curve between the large secondary kam islands and the surviving primary kam lines the red dots in the figures are the points that correspond to the values of and lz for the domains of the indicator plots in fig 4 for increasing perturbation values the primary kam lines disappear quite rapidly and for 0 2 remnants of the nhim are essentially 4 kam islands two of them are the large kam islands of period 2 with centres at 3 4 and 4 already found for very small values of the other two islands are 17 also of period 2 have centres at 4 and 3 4 and they have grown out of the upper boundary of the domain of the map after the destruction of the primary kam lines there are no boundaries on the former nhim surface which prevent general trajectories outside of the secondary kam islands from moving to the former nhim surface s lower boundary and disappearing when we increase the value of further then the new islands coming out of the upper boundary move down to lower values of lz and their centre points of period 2 collide at 0 228 with the unstable points of period 2 coming from the primary kam line of winding number 1 2 in the collision these two pairs of points of period 2 disappear in a saddle centre bifurcation as seen numerically in fig 8 afterwards only the two large period 2 kam islands are the last remnants of the nhim in particular observe that in figs 7 and 8 the red dot at 4 does no longer belong to the surviving nhim surface accordingly the nhim does no longer intersect the domains of the indicator plots in figs 4 d and f this explains the blurred structures already seen in figs 4 d and 4 f fig 9 shows the values of the tangential and the normal eigenvalues of the hyperbolic points of period 2 the normal eigenvalue is always close to 1 and returns exactly to 1 in the saddle centre bifurcation at 0 228 where the curve ends in contrast the normal eigenvalue is always a lot larger which shows that this hyperbolic point always belongs to the nhim surface as long as it exists figure 6 poincare map of the internal dynamics of the nhimm for 0 05 the perturbation breaks the rotational symmetry around the z axis and 2 big kam islands are formed the red dots correspond to the initial conditions for the corresponding plots of t in figs 4 a and 4 b 18 figure 7 poincare map of the internal dynamics of the nhimm for 0 2 the perturbation has already destroyed the primary kam curves outside of two main kam islands and two kam islands with centres at 4 3 4 grow out of the upper bounday the red dots correspond to the initial conditions for the corresponding plots of t in figs 4 c and 4 d figure 8 poincare map of the internal dynamics of the nhimm for 0 25 the perturbation destroyed the two upper kam islands and only the two main kam islands survive the red dot corresponds to the initial conditions for the corresponding plots of t in figs 4 e and 4 f 19 figure 9 eigenvalues of the hyperbolic period 2 point xh in the line 4 in the poincare map of the nhimm in figs 6 7 8 the eigenvalues and corresponds to the eigenvalues on the normal and parallel directions to them respectively 5 final remarks we have discussed methods to identify the points sitting on stable manifolds of unstable invariant subsets and corresponding methods to search numerically for nhims we have put these ideas into a larger frame pointing out their relations the basic idea is always based on the following observation if the initial point of a trajectory sits exactly on the stable manifold of an invariant subset then the trajectory will converge to this invariant subset and the time delay becomes infinite numerically we observe a large time delay in some subset of the phase space this idea has also been employed before in the investigation of chaotic scattering where general scattering functions and in particular the time delay in the interaction region become singular for asymptotic initial conditions on the stable manifold of the chaotic saddle in this sense scattering functions have always been used as indicators on the set of incoming asymptotes figures 3 and 4 of the present article demonstrates this idea graphically by plotting the time delay in the inner region of the phase space over a coordinate plane of initial conditions we see clearly the lines representing the intersections of the plane of initial conditions with the stable and unstable manifolds of the nhim and we also recognize crossings of the stable and unstable manifolds however with the information provided by fig 4 alone it was not yet possible to distinguish between crossings representing the nhim itself and crossings rep resenting general homoclinic intersection surfaces therefore we had to go one step further and identify the intersections of the plane of initial conditions with 20 the local segments of the stable manifolds the corresponding filter criterion is that the trajectory converges to the direct neighbourhood of the nhim mono tonically without making large excursions and this filter was also essential to construct the plots of the internal dynamics of the nhim as shown in figs 6 7 8 and explained in section 4 we have seen that this internal dynamics is dominated by rather regular structures at least in such parts of the nhim that have survived the actual perturbation now the reader may ask whether or not it is general that the internal structure of a nhim is mainly regular or whether this is an exceptional property of the dipole system the numerical results of many different systems indicate that it seems to be general see again the above mentioned references 25 26 27 29 the following arguments may give some explanation we start to investigate the development scenario of the nhim at one of the simple cases explained in section 2 in particular we take the simple case for which the internal dynamics of the nhim is exactly integrable the persistence theorem guarantees that the nhim persists when the tan gential instability is smaller than the normal instability it does not claim that the nhim must decay in regions where the tangential instability becomes larger than the normal instability however there are some indications that this decay is the usual event first in 14 it is mentioned that the nhim surface grows spikes as soon as the tangential instability becomes larger than the normal one this phenomenon has also been observed in a model map 24 here the tangen tial instability of a fixed point in the nhim is parameter dependent and as soon as the local tangential instability becomes larger than the normal instability the fixed point becomes the tip of a spike and leaves the nhim also example 1 1 in section 1 2 1 of 39 suggests the formation of singularities in the nhim as soon as the tangential instability becomes equal to the normal instability this behaviour seems to be common the survival of only regular parts of the nhim is exactly what we see graph ically in the plots of the development scenario in the figs 6 7 8 in addition this closeness to internal integrability implies that the homoclinic trajectories connect a particular initial substructure of the nhim with some particular final substructure for more information on the decay of nhims and the related transient effects see also 28 this closeness to the integrability of the internal dynamics makes evident why we consider it important to apply strategies for the search of nhims that automatically also provide a pictorial display of the internal dynamics of the nhims there are other different methods to calculate nhims using the normal form techniques and the parametrization method see references 40 41 42 43 those methods are able to follow perturbed nhims that persist the method described in the present article is an alternative to study the bifurcations and decay of nhims because it is based on trajectories and does not require any extra hypothesis a new side result in section 2 is the idea of how the effective potential of a reduced system can have index 1 saddles carrying invariant subsets even if the effective potential of the full dimensional system does not have corresponding nondegenerate saddles here the magnetic dipole problem is a very drastic example since the effective potential of the full dimensional system is identically zero the basic ideas presented in this article also work for even more degrees of 21 freedom the only complication for 4 or more degrees of freedom is the graphical presentation of the internal dynamics of the codimension 2 nhims for n dof systems the nhim surface in the domain of the map is 2 n 4 dimensional and for n 3 it can no longer be displayed as a 2 dimensional plot acknowledgment c j thanks dgapa unam for financial support under grant number ig 101122 and conacyt for financial support under grant number 425854 f g m thanks cic ac unam references 1 lega e guzzo m and froeschle c 2016 chaos detection and predictability lecture notes in physics 915 35 2 cincotta p m and giordano c m 2016 chaos detection and predictability lecture notes in physics 915 93 3 skokos c and manos t 2016 chaos detection and predictability lecture notes in physics 915 129 4 jimenez madrid j a and mancho a m 2009 chaos 19 013111 1 5 lopesino c balibrea iniesta f garc a garrido v wiggins s and mancho a 2017 int j bifurcation chaos 27 1730001 6 agaoglou m garcia garrido v j katsanikas m wiggins s 2021 commun nonlinear sci numer simulat 103 105993 7 gonzalez montoya f wiggins s 2019 j phys a math theor 53 235702 8 gonzalez montoya f wiggins s 2020 phys rev e 102 062203 9 gonzalez montoya f garcia garrido v j aguilar sanjuan b wiggins s 2021 commun nonlinear sci numer simulat 102 105917 10 feldmaier m junginger a main j wunner g hernandez r 2017 chem phys lett 687 194 11 feldmaier m schraft p bardakcioglu r reiff j lober m tscho pe m junginger a main j bartsch t hernandez r 2019 j phys chem b 123 2070 12 lichtenberg j a and lieberman m a 1983 regular and stochastic motion new york springer 13 abraham r s and shaw c d 1992 dynamics the geometry of behavior 2 nd edn redwood city addison wesley 14 fenichel n 1971 indiana univ math j 21 193 15 wiggins s 1994 normally hyperbolic invariant manifolds in dynamical systems berlin springer verlag 22 16 smale s 1970 inv math 10 305 ibid 11 45 17 marsden j e 1992 lectures on mechanics london math soc lecture note series vol 174 cambridge university press 18 lyapunov a m 1907 ann fac sci toulouse bf 9 203 19 jung c and zotos e 2016 month not royal astro soc 463 3965 20 gonzalez f and jung c 2012 j phys a math theor 45 265102 21 gonzalez f and jung c 2015 j phys a math theor 48 435101 22 dragt a j and finn m 1976 j geophys res 81 2327 23 jung c and scholz h j 1988 j phys a math gen 21 2301 24 drotos g gonzalez f jung c j phys a math theor 47 045101 25 zotos e e and jung c 2017 month not royal astro soc 465 525 26 zotos e e and jung c 2018 int j non linear mech 99 182 27 zotos e e and jung c 2020 commun nonlinear sci numer simulat 80 104989 28 jung c 2021 j phys complex 2 014001 29 jung c and waalkens h 2020 int j bif chaos 30 2030022 30 seoane j m sanjua n m a f 2012 rep prog phys 76 76 016001 31 bernal j d seoane j m sanjua n m a f 2018 phys rev e 97 042214 32 ferna ndez d s seoane j m sanjua n m a f 2022 chaos solitons frac tals 156 111891 33 nieto a r zotos e e seoane j m sanjua n m a f 2020 nonlinear dy namics 99 3029 34 kluitenberg m 2021 chaotic scattering in relativistic n center problems master thesis university of groningen 35 dro tos g gonza lez montoya f jung c 3 and te l t 2014 phys rev e 90 022906 36 gonzalez montoya f borondo f jung c 2020 commun nonlinear sci numer simulat 90 105282 37 ott e grebogi c and yorke y a 1990 phys rev lett 65 1196 38 shinbrot t ott e grebogi s and yorke y a 1990 phys rev lett 65 3250 39 eldering j normally hyperbolic invariant manifolds the noncompact case 2013 springer atlantis series in dynamical systems vol 2 40 waalkens h schubert r wiggins s 2008 nonlinearity 21 r 1 23 41 haro a canadell m figueras j l luque a mondelo j m 2016 the pa rameterization method for invariant manifolds from rigorous results to effective computations springer 42 canadell m haro a 2017 journal of nonlinear science 6 1829 43 canadell m haro a 2017 journal of nonlinear science 6 1869 24 1 introduction 2 the particular parameter case to start from 2 1 index 1 saddle of the effective potential 2 2 stack construction in the partially integrable case 2 3 effective potential for the partially integrable case 3 the delay time as an indicator of stable manifolds of invariant subsets for the symmetric and perturbed cases 4 the numerical procedure to follow a nhim along a curve of the perturbation parameters 5 final remarks