energy minimization of 2 d incommensurate heterostructures paul cazeaux mitchell luskin and daniel massatt abstract we derive and analyze a novel approach for modeling and computing the mechanical relaxation of incommensurate 2 d heterostructures our approach parametrizes the relaxation pattern by the compact local configuration space rather than real space thus bypassing the need for the standard supercell approximation and giving a true aperiodic atomistic configuration our model extends the computationally accessible regime of weakly coupled bilayers with similar orientations or lattice spacing for example materials with a small relative twist where the widely studied large scale moir patterns arise 22 37 our model also makes possible the simulation of multi layers for which no inter layer empirical atomistic potential exists such as those composed of mos 2 layers and more generally makes possible the simulation of the relaxation of multi layer heterostructures for which a planar moir pattern does not exist key words 2 d materials heterostructures ripples incommensurability atomistic relaxation frenkel kontorova ams subject classifications 65 z 05 70 c 20 74 e 15 70 g 75 introduction two dimensional 2 d crystals have been intensely investigated both experimentally and theoretically since graphene was exfoliated from graphite 27 graphene has been shown to have exceptional mechanical strength and electrical conductivity but its lack of a band gap limits its technological application 12 many other two dimensional crystals such as the insulator h bn and semiconductor mos 2 have since been experimentally realized more recently physicists have developed the ability to stack one layer on another with a twist angle controlled to the scale of 1 degree with the goal of creating 2 d materials with desired electronic optical and mechanical properties 20 although each layer is crystalline and has a periodic structure when isolated the ground state mechanical configuration of weakly coupled multi layer 2 d systems is generally no longer periodic when the individual layers have incommensurate lattice constants such as when graphene is stacked on mos 2 or when one 2 d crystal such as graphene or mos 2 is stacked and rotated on a like layer 6 25 the periodic configu ration of each layer is no longer a mechanical ground state when so stacked and their relaxation may create long range modulations along the moir pattern that strongly affect electronic properties 26 37 such as the recently observed superconductivity at so called magic angles 8 9 36 to study mechanical relaxation for a particular twist angle or set of lattice con stants previous works have approximated the incommensurate system using an ar tificial strain or twist to force the system to be periodic on a supercell in 34 for example the relaxation of bilayer graphene on supercells was studied using inter atomic potentials rebo for intralayer coupling and kolmogorov crespi for interlayer coupling this approach is no longer feasible for small twist angles because the length scale of the supercell approximation scales inversely to the twist angle in addition to restricting the set of configurations which can be probed 32 other previous works have proposed or derived continuum models on moir cells or supercells by imposing a priori periodic boundary conditions bypassing the need department of mathematics university of kansas lawrence ks 66049 pcazeaux ku edu school of mathematics university of minnesota minneapolis mn 55455 luskin umn edu massatt 067 umn edu 1 ar x iv 1 80 6 10 39 5 v 3 ph ys ic s co m p ph 3 a ug 2 01 9 mailto pcazeaux ku edu mailto luskin umn edu mailto massatt 067 umn edu to strain the system into periodicity as for atomistic models it is however not clear how to rigorously link such periodic continuum deformations with the underly ing aperiodic atomistic configurations for incommensurate heterostructures in 17 a continuum elastic model was used for intralayer interactions while a generalized stacking fault energy gsfe for bilayer graphene was used to capture interlayer in teractions and in 38 intralayer interactions in bilayer graphene were also modeled by continuum elasticity and the intralayer interactions were modeled by a disregistry energy calculated from the kolmogorov crespi interlayer atomistic potential in 18 a discrete to continuum model of ginzburg landau type for the approx imation of the in plane and transverse displacement of a deformable square lattice weakly coupled to a rigid square lattice was derived for an empirical potential includ ing harmonic springs torsion and dihedral terms for intralayer interactions and a clas sical lennard jones term to model the weak interlayer interactions an asymptotic derivation was given of a continuum intralayer and interlayer energy and numerical simulations were given of planar moir relaxation patterns this paper presents a new conceptual approach to modeling and computing the mechanical relaxation pattern of general weakly coupled incommensurate deformable multi layers by parametrizing the relaxation pattern by local configuration space rather than real space this concept of hull a compact parametrization of all possi ble local environments was originally introduced for the study of quantum electronic models of general aperiodic solids 2 3 30 and recently extended to incommensurately stacked multi layer assemblies 6 25 the local configuration disregistry is given by the projection of the atomic positions of each layer onto the unit cell of the other layers this method is thus not limited to periodic multi layer configurations or by a supercell approximation and provides the first representation of aperiodic atomistic configurations the 2 d theory presented in this paper was explored in a 1 d model in 13 where a rigorous proof using aubry mather theory is given that energy mini mizers can be parameterized by local configuration an application of this approach to small angle twisted bilayer graphene and mos 2 is given in 11 our main result is the derivation of an elastostatics model 3 9 3 11 for the relaxation of vertical stacks of any number of incommensurate weakly coupled de formable layers for the particular case of bilayer heterostructures this model reduces to the well posed variational problem 4 18 for the continuum displacement field on a periodic moir domain even for aperiodic atomistic configurations quite similar to existing real space continuum models 17 18 38 albeit obtained by a very different route in section 1 we describe the geometry of multi layered structures and in section 2 we propose an atomistic model for the relaxation of weakly coupled incommensurate layers and study the aliasing of the disregistry causing the moir effect in section 3 we present the continuum interpolant in configuration space leading to a novel multi layer elastostatics model using the cauchy born approximation and in section 4 we give an analysis of this model for bilayers in section 5 we present our numerical approximation and give computational results for twisted bilayers 1 geometry of multi layered structures two dimensional heterostructures are vertical stacks of a few crystalline monolayers which typically have different pe riodicities due to the weak van der waals nature of the interactions between layers little relaxation usually take place as the layers are mechanically stacked on top of each other rather each layer essentially keeps the crystalline structure it possesses as an isolated monolayer the resulting assembly is in general an aperiodic system with 2 a b fig 1 illustration of the collective registry driven relaxation of atomic moire pat terns a unrelaxed atomic positions of g g bilayer with a 3 twist angle b domain structure after relaxation the inter layer interaction forces are enhanced by 100 for visualization purpose long range order this order is usually most noticeable when the lattices have close but slightly different spacing and or orientation creating large scale moir patterns in this case an ordered locally collective relaxation motion of atoms can take place as the layers maximize the area of energetically favorable stacking see figure 1 1 1 notation a systematic model of the relaxation of such heterostructures starts by a rigorous depiction and parameterization of the particular geometry of unrelaxed ideal multilayered structures which will serve as a reference configuration in the elastic modeling of the relaxation phenomenon we summarize in this section the findings of 6 where the geometry of these perfect multilayer structures was analyzed and discussed in detail we consider a 3 dimensional system of p parallel 2 dimensional periodic atomic layers denoted lj r 3 j 1 p we denote by pe 1 e 2 e 3 q an orthonormal basis of the physical space such that each layer is perpendicular to e 3 from now on points in physical space will be identified with their cartesian coordinates px y zqt associated with this basis hj the third coordinate or height of the center of layer j we assume that 0 h 1 h 2 hp without loss of generality rj j 1 p the 2 dimensional periodic lattice of layer j ej the matrix in r 2 2 whose columns form a basis generating the layer rj that is 1 1 rj ejz 2 r 2 j r 2 rj the quotient of r 2 by the discrete lattice rj which has the topology of a 2 dimensional torus and can be canonically identified with the periodic unit cell p j ejr 1 2 1 2 q 2 of layer j 3 h 1 0 h 2 h 3 b 1 2 latexit sha 1 base 64 3 j 0 f 39 vpaegk 6 fkyrmy 6 hb 0 bxbe aaacenicbvdltgixfo 3 gc e 16 tjnizexxkxmcahzed 24 xesebcakuwo 0 tdot 9 o 6 rtpghn 6 kgxdq 3 lpy 599 yhgsft 9 l 05 jx 7 b 29 peauuwxw rczk 6 tr 6 rnyzt 7 w 9 s 7 tn 7 x c 6 shrlnvpjclvdihmgoesdhwea 8 akerki 1 gigvxo cc u 5 lf 4 c 6 oy zl 0 q 97 jlicrovzzg 9 gdtoe 0 vd wu 6 d 8 jh 23 vcqaq 1 gpjnn 2 n 0 hjoovxx 867 jjsfxibenotrhlwo dxurjsrlaqqinytz 43 bt 4 kctgub 59 qjzjghq 9 jnlundipn 20 kuy 3 xilc 7 urcqcepbu d 2 reqn 1 saamuhiy 6 evviv 7 ntrloxfgpd mewehnd usgshck 4 bwlytgqywmivrxsyuma 6 iibrnjzotglx 55 mdqltsxxbor 56 uu 8 jsw 6 qsfofhmojkrogtvqhvh 0 ij 7 rk 3 qznqwx 6936 mjvmrhnpifod 6 mhjt 6 b g latexit latexit sha 1 base 64 3 j 0 f 39 vpaegk 6 fkyrmy 6 hb 0 bxbe aaacenicbvdltgixfo 3 gc e 16 tjnizexxkxmcahzed 24 xesebcakuwo 0 tdot 9 o 6 rtpghn 6 kgxdq 3 lpy 599 yhgsft 9 l 05 jx 7 b 29 peauuwxw rczk 6 tr 6 rnyzt 7 w 9 s 7 tn 7 x c 6 shrlnvpjclvdihmgoesdhwea 8 akerki 1 gigvxo cc u 5 lf 4 c 6 oy zl 0 q 97 jlicrovzzg 9 gdtoe 0 vd wu 6 d 8 jh 23 vcqaq 1 gpjnn 2 n 0 hjoovxx 867 jjsfxibenotrhlwo dxurjsrlaqqinytz 43 bt 4 kctgub 59 qjzjghq 9 jnlundipn 20 kuy 3 xilc 7 urcqcepbu d 2 reqn 1 saamuhiy 6 evviv 7 ntrloxfgpd mewehnd usgshck 4 bwlytgqywmivrxsyuma 6 iibrnjzotglx 55 mdqltsxxbor 56 uu 8 jsw 6 qsfofhmojkrogtvqhvh 0 ij 7 rk 3 qznqwx 6936 mjvmrhnpifod 6 mhjt 6 b g latexit latexit sha 1 base 64 3 j 0 f 39 vpaegk 6 fkyrmy 6 hb 0 bxbe aaacenicbvdltgixfo 3 gc e 16 tjnizexxkxmcahzed 24 xesebcakuwo 0 tdot 9 o 6 rtpghn 6 kgxdq 3 lpy 599 yhgsft 9 l 05 jx 7 b 29 peauuwxw rczk 6 tr 6 rnyzt 7 w 9 s 7 tn 7 x c 6 shrlnvpjclvdihmgoesdhwea 8 akerki 1 gigvxo cc u 5 lf 4 c 6 oy zl 0 q 97 jlicrovzzg 9 gdtoe 0 vd wu 6 d 8 jh 23 vcqaq 1 gpjnn 2 n 0 hjoovxx 867 jjsfxibenotrhlwo dxurjsrlaqqinytz 43 bt 4 kctgub 59 qjzjghq 9 jnlundipn 20 kuy 3 xilc 7 urcqcepbu d 2 reqn 1 saamuhiy 6 evviv 7 ntrloxfgpd mewehnd usgshck 4 bwlytgqywmivrxsyuma 6 iibrnjzotglx 55 mdqltsxxbor 56 uu 8 jsw 6 qsfofhmojkrogtvqhvh 0 ij 7 rk 3 qznqwx 6936 mjvmrhnpifod 6 mhjt 6 b g latexit latexit sha 1 base 64 3 j 0 f 39 vpaegk 6 fkyrmy 6 hb 0 bxbe aaacenicbvdltgixfo 3 gc e 16 tjnizexxkxmcahzed 24 xesebcakuwo 0 tdot 9 o 6 rtpghn 6 kgxdq 3 lpy 599 yhgsft 9 l 05 jx 7 b 29 peauuwxw rczk 6 tr 6 rnyzt 7 w 9 s 7 tn 7 x c 6 shrlnvpjclvdihmgoesdhwea 8 akerki 1 gigvxo cc u 5 lf 4 c 6 oy zl 0 q 97 jlicrovzzg 9 gdtoe 0 vd wu 6 d 8 jh 23 vcqaq 1 gpjnn 2 n 0 hjoovxx 867 jjsfxibenotrhlwo dxurjsrlaqqinytz 43 bt 4 kctgub 59 qjzjghq 9 jnlundipn 20 kuy 3 xilc 7 urcqcepbu d 2 reqn 1 saamuhiy 6 evviv 7 ntrloxfgpd mewehnd usgshck 4 bwlytgqywmivrxsyuma 6 iibrnjzotglx 55 mdqltsxxbor 56 uu 8 jsw 6 qsfofhmojkrogtvqhvh 0 ij 7 rk 3 qznqwx 6936 mjvmrhnpifod 6 mhjt 6 b g latexit 1 latexit sha 1 base 64 unnszklews 306 uaddjj 05 nux mq aaacexicbvdlsgmxfm 3 uv 62 vuzdugkvqkggm oqu 6 mzlbwsl 7 vayadqgjjndckcsw 3 ydg 3 fjqsvt 7 c temj 4 w 2 hrhwoofem 5 stxijrcn 1 vk 7 ewuls 8 kl 8 trk 1 vbg 7 z 2 zt 3 okouztuaiug 1 aqkz 4 cgraqfbgrfiraac 1 ypb 1 civ 3 zolertewjbmvis 9 khc 5 jwcktn 3 uavya 4 z 1 n 1 qv 81 hg 907 nj 7 jrmlctz 2 uorkunby 9 p 20 xxcmfa 88 aakikaotu 2 vvieiiwqhueg 0 bnpudh 5 kfhaqwfzojzrfha 5 ijzundylk 2 k hp 2 t 4 wcgd 3 i 2 uqrdwwp 09 krkp 9 vagplms 6 otzbyt 5 zut 6 f 74 kq jbfhijw 91 e 4 ehwqn 8 cicrrkemdsfucxmrpn 2 icawtysge 4 m 1 ez 7 usk 7 z 8 w 5 oipxlarp 5 tif 20 shy 0 dmqogturtve 0 sn 6 rq ozxqyxqx 362 psmromm 7 vod 6 zph 6 evm 70 latexit latexit sha 1 base 64 unnszklews 306 uaddjj 05 nux mq aaacexicbvdlsgmxfm 3 uv 62 vuzdugkvqkggm oqu 6 mzlbwsl 7 vayadqgjjndckcsw 3 ydg 3 fjqsvt 7 c temj 4 w 2 hrhwoofem 5 stxijrcn 1 vk 7 ewuls 8 kl 8 trk 1 vbg 7 z 2 zt 3 okouztuaiug 1 aqkz 4 cgraqfbgrfiraac 1 ypb 1 civ 3 zolertewjbmvis 9 khc 5 jwcktn 3 uavya 4 z 1 n 1 qv 81 hg 907 nj 7 jrmlctz 2 uorkunby 9 p 20 xxcmfa 88 aakikaotu 2 vvieiiwqhueg 0 bnpudh 5 kfhaqwfzojzrfha 5 ijzundylk 2 k hp 2 t 4 wcgd 3 i 2 uqrdwwp 09 krkp 9 vagplms 6 otzbyt 5 zut 6 f 74 kq jbfhijw 91 e 4 ehwqn 8 cicrrkemdsfucxmrpn 2 icawtysge 4 m 1 ez 7 usk 7 z 8 w 5 oipxlarp 5 tif 20 shy 0 dmqogturtve 0 sn 6 rq ozxqyxqx 362 psmromm 7 vod 6 zph 6 evm 70 latexit latexit sha 1 base 64 unnszklews 306 uaddjj 05 nux mq aaacexicbvdlsgmxfm 3 uv 62 vuzdugkvqkggm oqu 6 mzlbwsl 7 vayadqgjjndckcsw 3 ydg 3 fjqsvt 7 c temj 4 w 2 hrhwoofem 5 stxijrcn 1 vk 7 ewuls 8 kl 8 trk 1 vbg 7 z 2 zt 3 okouztuaiug 1 aqkz 4 cgraqfbgrfiraac 1 ypb 1 civ 3 zolertewjbmvis 9 khc 5 jwcktn 3 uavya 4 z 1 n 1 qv 81 hg 907 nj 7 jrmlctz 2 uorkunby 9 p 20 xxcmfa 88 aakikaotu 2 vvieiiwqhueg 0 bnpudh 5 kfhaqwfzojzrfha 5 ijzundylk 2 k hp 2 t 4 wcgd 3 i 2 uqrdwwp 09 krkp 9 vagplms 6 otzbyt 5 zut 6 f 74 kq jbfhijw 91 e 4 ehwqn 8 cicrrkemdsfucxmrpn 2 icawtysge 4 m 1 ez 7 usk 7 z 8 w 5 oipxlarp 5 tif 20 shy 0 dmqogturtve 0 sn 6 rq ozxqyxqx 362 psmromm 7 vod 6 zph 6 evm 70 latexit latexit sha 1 base 64 unnszklews 306 uaddjj 05 nux mq aaacexicbvdlsgmxfm 3 uv 62 vuzdugkvqkggm oqu 6 mzlbwsl 7 vayadqgjjndckcsw 3 ydg 3 fjqsvt 7 c temj 4 w 2 hrhwoofem 5 stxijrcn 1 vk 7 ewuls 8 kl 8 trk 1 vbg 7 z 2 zt 3 okouztuaiug 1 aqkz 4 cgraqfbgrfiraac 1 ypb 1 civ 3 zolertewjbmvis 9 khc 5 jwcktn 3 uavya 4 z 1 n 1 qv 81 hg 907 nj 7 jrmlctz 2 uorkunby 9 p 20 xxcmfa 88 aakikaotu 2 vvieiiwqhueg 0 bnpudh 5 kfhaqwfzojzrfha 5 ijzundylk 2 k hp 2 t 4 wcgd 3 i 2 uqrdwwp 09 krkp 9 vagplms 6 otzbyt 5 zut 6 f 74 kq jbfhijw 91 e 4 ehwqn 8 cicrrkemdsfucxmrpn 2 icawtysge 4 m 1 ez 7 usk 7 z 8 w 5 oipxlarp 5 tif 20 shy 0 dmqogturtve 0 sn 6 rq ozxqyxqx 362 psmromm 7 vod 6 zph 6 evm 70 latexit 3 latexit sha 1 base 64 asty xxpenlrkxitarvz 9 sbcfww aaacenicbvdlsgmxfm 3 uv 62 vqks 3 wskiydbt 7 cnd 0 y 3 lctyw 2 qfk 0 rqntwag 5 i 5 yhv 6 dg 3 fjqsvt 67 c temj 4 w 2 hrhwoofem 5 vjr 4 jrcjxvk 7 w 0 vlk 6 ll 7 pbgxube 9 kd fudbgrymo 0 fkfq eqzwqnwaw 6 cnslfipqfq udq 7 ffv 2 dk 8 zc 4 hwhepel 6 ae 9 yssbi 7 exjc 9 gdtpy 0 vc 3 ertclj 1 iu 2 aqxywur 0 mrr 6 qk 7 bnro 5 tzbgccvejcgcmhgart 7 fere 9 jysgcoifo 3 xscclyekobvslgnfmkwedkipnq 0 nigtasya 3 jpcrutq 4 gyptaecj nsiivlrofrnpytq 1 pewpzpa 8 bqlxsjd 6 iywecnd 3 vjgshe 44 bwhytgqqwnivrxcyumfaiibrnjxotgzn 95 kdty 9 oxt 3 pznkpeznnloab 2 iy sieqqga 1 rfnutri 3 pgr jnerjerhfry 9 qasmyz gprm 8 fmhocbg latexit latexit sha 1 base 64 asty xxpenlrkxitarvz 9 sbcfww aaacenicbvdlsgmxfm 3 uv 62 vqks 3 wskiydbt 7 cnd 0 y 3 lctyw 2 qfk 0 rqntwag 5 i 5 yhv 6 dg 3 fjqsvt 67 c temj 4 w 2 hrhwoofem 5 vjr 4 jrcjxvk 7 w 0 vlk 6 ll 7 pbgxube 9 kd fudbgrymo 0 fkfq eqzwqnwaw 6 cnslfipqfq udq 7 ffv 2 dk 8 zc 4 hwhepel 6 ae 9 yssbi 7 exjc 9 gdtpy 0 vc 3 ertclj 1 iu 2 aqxywur 0 mrr 6 qk 7 bnro 5 tzbgccvejcgcmhgart 7 fere 9 jysgcoifo 3 xscclyekobvslgnfmkwedkipnq 0 nigtasya 3 jpcrutq 4 gyptaecj nsiivlrofrnpytq 1 pewpzpa 8 bqlxsjd 6 iywecnd 3 vjgshe 44 bwhytgqqwnivrxcyumfaiibrnjxotgzn 95 kdty 9 oxt 3 pznkpeznnloab 2 iy sieqqga 1 rfnutri 3 pgr jnerjerhfry 9 qasmyz gprm 8 fmhocbg latexit latexit sha 1 base 64 asty xxpenlrkxitarvz 9 sbcfww aaacenicbvdlsgmxfm 3 uv 62 vqks 3 wskiydbt 7 cnd 0 y 3 lctyw 2 qfk 0 rqntwag 5 i 5 yhv 6 dg 3 fjqsvt 67 c temj 4 w 2 hrhwoofem 5 vjr 4 jrcjxvk 7 w 0 vlk 6 ll 7 pbgxube 9 kd fudbgrymo 0 fkfq eqzwqnwaw 6 cnslfipqfq udq 7 ffv 2 dk 8 zc 4 hwhepel 6 ae 9 yssbi 7 exjc 9 gdtpy 0 vc 3 ertclj 1 iu 2 aqxywur 0 mrr 6 qk 7 bnro 5 tzbgccvejcgcmhgart 7 fere 9 jysgcoifo 3 xscclyekobvslgnfmkwedkipnq 0 nigtasya 3 jpcrutq 4 gyptaecj nsiivlrofrnpytq 1 pewpzpa 8 bqlxsjd 6 iywecnd 3 vjgshe 44 bwhytgqqwnivrxcyumfaiibrnjxotgzn 95 kdty 9 oxt 3 pznkpeznnloab 2 iy sieqqga 1 rfnutri 3 pgr jnerjerhfry 9 qasmyz gprm 8 fmhocbg latexit latexit sha 1 base 64 asty xxpenlrkxitarvz 9 sbcfww aaacenicbvdlsgmxfm 3 uv 62 vqks 3 wskiydbt 7 cnd 0 y 3 lctyw 2 qfk 0 rqntwag 5 i 5 yhv 6 dg 3 fjqsvt 67 c temj 4 w 2 hrhwoofem 5 vjr 4 jrcjxvk 7 w 0 vlk 6 ll 7 pbgxube 9 kd fudbgrymo 0 fkfq eqzwqnwaw 6 cnslfipqfq udq 7 ffv 2 dk 8 zc 4 hwhepel 6 ae 9 yssbi 7 exjc 9 gdtpy 0 vc 3 ertclj 1 iu 2 aqxywur 0 mrr 6 qk 7 bnro 5 tzbgccvejcgcmhgart 7 fere 9 jysgcoifo 3 xscclyekobvslgnfmkwedkipnq 0 nigtasya 3 jpcrutq 4 gyptaecj nsiivlrofrnpytq 1 pewpzpa 8 bqlxsjd 6 iywecnd 3 vjgshe 44 bwhytgqqwnivrxcyumfaiibrnjxotgzn 95 kdty 9 oxt 3 pznkpeznnloab 2 iy sieqqga 1 rfnutri 3 pgr jnerjerhfry 9 qasmyz gprm 8 fmhocbg latexit 3 r 3 latexit sha 1 base 64 vhzapdjodz 3 cwoah 6 z 5 td 8 tx 2 w 4 aaacihicbvbnb 9 naffwxaemkjdajlxvrpupelp 3 qjnyi 9 tjjwpe 2 umxzz 5 tnsuqube 0 iyllf 6 wx huuhkaqn g 1 bd 4 onolik 41 m 3 tudntitwqdn xf 2 nj 1 sbtxevndf x 64 e 3 t 7 bsrk aa 8 qflzaqhmrgurcihkfdyyay 5 qfjy 6 jmbofff xaidt 5 gvomhwqmizgibmilqnynkh d 5 t 0 jpy 3 dwu 22 ow 3 ppwm 4 zxa 7 liipkavri 36 kgqkcmzdfzrm 1 yqhw 91 xvcbpn dwpkzx 6 ue 13 me 5 zrnictiixi 9 lmcxao 2 csl 9 ugnzwddgntpri 0 acvnwcytlftikmm 6 sbu 9 cdkl v 9 gacqyuyrt 5 ckl 2 fqw 4 lpekmdjnyxekuxie 7 z 6 ajjliild 1 exhqnogcm 4 jmc 1 svspmoighlbvqs a 3 v 7 xnbk 33 s tffkr 3 ttdtvmh 78 oece 590 si ckz 4 zeezuyxfyk xy 7 pwfzr 3 zsbrdcdy 7 h qrnl aanaoco latexit latexit sha 1 base 64 vhzapdjodz 3 cwoah 6 z 5 td 8 tx 2 w 4 aaacihicbvbnb 9 naffwxaemkjdajlxvrpupelp 3 qjnyi 9 tjjwpe 2 umxzz 5 tnsuqube 0 iyllf 6 wx huuhkaqn g 1 bd 4 onolik 41 m 3 tudntitwqdn xf 2 nj 1 sbtxevndf x 64 e 3 t 7 bsrk aa 8 qflzaqhmrgurcihkfdyyay 5 qfjy 6 jmbofff xaidt 5 gvomhwqmizgibmilqnynkh d 5 t 0 jpy 3 dwu 22 ow 3 ppwm 4 zxa 7 liipkavri 36 kgqkcmzdfzrm 1 yqhw 91 xvcbpn dwpkzx 6 ue 13 me 5 zrnictiixi 9 lmcxao 2 csl 9 ugnzwddgntpri 0 acvnwcytlftikmm 6 sbu 9 cdkl v 9 gacqyuyrt 5 ckl 2 fqw 4 lpekmdjnyxekuxie 7 z 6 ajjliild 1 exhqnogcm 4 jmc 1 svspmoighlbvqs a 3 v 7 xnbk 33 s tffkr 3 ttdtvmh 78 oece 590 si ckz 4 zeezuyxfyk xy 7 pwfzr 3 zsbrdcdy 7 h qrnl aanaoco latexit latexit sha 1 base 64 vhzapdjodz 3 cwoah 6 z 5 td 8 tx 2 w 4 aaacihicbvbnb 9 naffwxaemkjdajlxvrpupelp 3 qjnyi 9 tjjwpe 2 umxzz 5 tnsuqube 0 iyllf 6 wx huuhkaqn g 1 bd 4 onolik 41 m 3 tudntitwqdn xf 2 nj 1 sbtxevndf x 64 e 3 t 7 bsrk aa 8 qflzaqhmrgurcihkfdyyay 5 qfjy 6 jmbofff xaidt 5 gvomhwqmizgibmilqnynkh d 5 t 0 jpy 3 dwu 22 ow 3 ppwm 4 zxa 7 liipkavri 36 kgqkcmzdfzrm 1 yqhw 91 xvcbpn dwpkzx 6 ue 13 me 5 zrnictiixi 9 lmcxao 2 csl 9 ugnzwddgntpri 0 acvnwcytlftikmm 6 sbu 9 cdkl v 9 gacqyuyrt 5 ckl 2 fqw 4 lpekmdjnyxekuxie 7 z 6 ajjliild 1 exhqnogcm 4 jmc 1 svspmoighlbvqs a 3 v 7 xnbk 33 s tffkr 3 ttdtvmh 78 oece 590 si ckz 4 zeezuyxfyk xy 7 pwfzr 3 zsbrdcdy 7 h qrnl aanaoco latexit latexit sha 1 base 64 vhzapdjodz 3 cwoah 6 z 5 td 8 tx 2 w 4 aaacihicbvbnb 9 naffwxaemkjdajlxvrpupelp 3 qjnyi 9 tjjwpe 2 umxzz 5 tnsuqube 0 iyllf 6 wx huuhkaqn g 1 bd 4 onolik 41 m 3 tudntitwqdn xf 2 nj 1 sbtxevndf x 64 e 3 t 7 bsrk aa 8 qflzaqhmrgurcihkfdyyay 5 qfjy 6 jmbofff xaidt 5 gvomhwqmizgibmilqnynkh d 5 t 0 jpy 3 dwu 22 ow 3 ppwm 4 zxa 7 liipkavri 36 kgqkcmzdfzrm 1 yqhw 91 xvcbpn dwpkzx 6 ue 13 me 5 zrnictiixi 9 lmcxao 2 csl 9 ugnzwddgntpri 0 acvnwcytlftikmm 6 sbu 9 cdkl v 9 gacqyuyrt 5 ckl 2 fqw 4 lpekmdjnyxekuxie 7 z 6 ajjliild 1 exhqnogcm 4 jmc 1 svspmoighlbvqs a 3 v 7 xnbk 33 s tffkr 3 ttdtvmh 78 oece 590 si ckz 4 zeezuyxfyk xy 7 pwfzr 3 zsbrdcdy 7 h qrnl aanaoco latexit fig 2 schematic representation of a configuration p 1 2 3 q p 1 2 shifts and disregistry the hull for incommensurate stackings the precise arrangement of the lattices r 1 r 2 rp depends both on intrinsic charac teristics such as the nature of the lattice hexagonal square etc or the value of the lattice constants and on their position disregistry and orientation twist angle depending on this arrangement the overall structure can be periodic or aperiodic in general periodicity arises when the intersection of the lattices r 1 x xrp forms a superlattice of full rank in the generic case the arrangement is not periodic meaning that a particular local arrangement of atoms is never exactly repeated as we translate horizontally the stack of layers the hull in the context of multilayer stacks the ensemble of possible global reference configurations was rigorously identified in the earlier paper 6 since each layer is perfectly periodic in this reference unrelaxed state the position of all atoms in layer j is fully identified by the knowledge of a single vector j in its periodic unit cell j which we call a disregistry the vertices of this layer j then form the shifted lattice j rj once the origin is fixed the reference configuration can thus be uniquely parameterized as an element p 1 pq of the cartesian product 1 2 1 p we present in figure 2 a one dimensional example where an arbitrary configuration is labeled by an element of finally the change of coordinate origin in the plane is naturally associated with the action of the group r 2 on by translations t that are parallel to the layers 1 3 for a p r 2 ta p 1 pq 1 a p a this description is particularly relevant to incommensurate stacks since the spatial translates of any particular configuration form a dense subset of the full configuration space recall indeed that the dual lattice of a full rank lattice r is defined by r k p r 2 k n p z n p r the following definition identifies the relevant incommensurability condition first presented in 6 4 definition 1 1 the collection of full rank lattices r 1 rp r 2 is called incommensurate if we have for any p tuple pk 1 kpq p r 1 r p 1 4 p j 1 kj 0 kj 0 j 1 p this condition is shown to be equivalent to the ergodicity property proposition 1 2 let r 1 rp be an incommensurate collection of lattices then we have the birkhoff property for any f p cp q and p 1 5 lim r 8 1 br br fpt a qda f 1 fp qd where br is the ball of radius r centered at zero this ensemble of possible configurations can therefore be identified with the so called hull 2 3 introduced previously in the study of the electronic structure of aperiodic materials the idea behind the hull is to picture an arbitrary position of observation in the layer plane as the origin of coordinates and the local environment as the neighboring atoms 1 this is particularly relevant to model the elastic relaxation of the stack since as we shall see in section 2 2 the local environment of an atom typically determines its energetics due to the locality of bonding the transversal in the context of atomistic models of the elastic behavior of the structures the quantity of interest is the displacement of atoms this leads us to introduce the so called canonical transversal of the hull denoted by x which is formed as the set 1 6 x p j 1 ptju xjq where xj p 1 pq p s t j 0 elements of x label special configurations where a lattice site in a particular layer is located at the origin with j being the layer index and p xj indexing the reference configuration the set of allowed translations within x is a discrete subset of the full translation group r 2 called a groupoid 3 a statement of ergodicity mirroring proposition 1 2 can be formulated on the transversal see prop 3 5 in 6 proposition 1 3 let r 1 rp be an incommensurate collection of lattices then we have the birkhoff property for any f p cpxq and p 1 7 lim r 8 1 br p j 1 apljxbr fpj t a q p j 1 xj fpj q j where lj j rj 2 elastic models of relaxation let us now introduce elastic models of moir pattern relaxation based on the previously introduced configuration space parameter ization of the deformation we first discuss a general atomistic energy model subse quently we discuss a continuum model and how it is an effective approximation for the atomistic model 1 a configuration is rigorously defined as the position of all atoms in the system relative to the origin given an arbitrary translation of the system corresponding to a change of viewpoint typically encoded as a radon measure in mpr 3 q formally the hull is a dynamical system p r 2 tq where is the closure of the orbit of the atomic distribution generated by the atoms of all p layers under the action of r 2 through t note that the group of translations ta with a p r 2 acts on the space of compactly supported continuous functions ccpr 3 q naturally through tafpxq fpx aq and thus on the space of radon measures mpr 3 q through ta pfq pt afq 5 2 1 atomistic kinematics our main assumption in this paper is that there exists a one to one smooth correspondance between the displacement of any atom belonging to one of the layers and its initial local configuration through the elastic relaxation process we thus introduce a set of modulation fields with respect to the reference unrelaxed positions which takes the form of a map u x r 2 we will use the notation 2 1 ujp q upj q 1 j p u p cpx r 2 q for the evaluation of functions defined onx and we understand ujp q as the deformed position of an atom of layer j initially placed at the origin in the configuration p xj the fields uj describe the structural modulation of each layer due to the interaction with the others remark 2 1 the key assumption behind the hull description is that there exists a one to one correspondance between the configuration of an atom and its modulated position in the relaxed configuration this is a reasonable assumption due to the inherent stability of the individual lattices of the layers and the weakness of the van der waals interactions between the layers in 1 d this is known to be strictly true for the frenkel kontorova model for atomic chains with strictly convex nearest neighbor atomic potentials sitting in an external incommensurate potential 1 we first formulate an atomistic model with empirical multi body interactions for simplicity of exposition let us start from the simple configuration where none of the layers are initially shifted from the origin i e 0 without loss of generality thanks to ergodicity by picturing temporarily the atom of layer j initially placed at p rj as a new origin of coordinates associated with the translated configuration t 0 p xj the displacement of this atom is prescribed to be ujpt 0 q by 2 1 we thus admit displacements and deformations of the form 2 2 ujp q ujpt 0 q yjp q ujpt 0 q 1 j p p rj where u x r 2 is an unknown modulation field 2 2 the atomistic energy we now propose a formal definition of the atom istic potential energy which we make rigorous through the remainder of the section let bj rjzt 0 u denote intra layer lattice directions or bonds for discrete maps v x r 2 we define the finite difference stencils djvpj q pvjpt q vjp qq pbj for pj q p x 2 3 ijvpj q pvipt q vjp qq p i ri for pj q p x and i j 2 4 next we assume that there exists a many body site energy vj for atoms in layer j such that formally the atomistic potential energy can be presented as a sum over normalized site energies 2 5 eapuq p j 1 prj j j t 0 puq where j puq vj rdju t ijuui js pj q this quantity is not well defined for general modulation u and in fact the sum 2 5 does not exist in general for nonzero modulations u which are continuous on the 6 configuration space x however the corresponding atomistic potential energy by unit area is well defined in the thermodynamic limit 2 6 eapuq lim r 8 p j 1 j br prjxbr j t 0 puq indeed the birkhoff property 1 7 allows us to express directly the large volume spatial average as a simple average over the configuration space proposition 2 2 given continuous many body site energies vj j 1 p the thermodynamic limit 2 6 exists for any continuous modulation field u as in 2 1 and equals 2 7 eapuq p j 1 xj j puqd the definition 2 7 of an elastic energy for relaxed stackings is completely general and establishes the basis of an atomistic model for arbitrary incommensurate stackings which will be studied in forthcoming papers as a first step we focus in this paper on showing how a simple continuum model can be formulated under certain conditions remark 2 3 in the case of multi lattices such as graphene a rigorous treatment should include additionally shift fields allowing for independent motion of the sublat tices 33 for the sake of simplicity we neglect this complication in this paper this simplification can be viewed as an approximation where all atoms in the unit cell share the same displacement 2 3 separation of intra and inter layer contributions the physical na ture of the bonds between atoms of one layer is typically different and of a much stronger nature than the van der waals interactions between adjacent layers in particular the bonding of atoms within an individual layer is mostly independent of the arrangement of the other layers furthermore the most significant contribution of interactions between different layers is a misfit energy due to the local disregistry between adjacent layers to reflect these considerations we propose the site energy for atoms of layer j 2 8 j puq intraj puq inter j puq we make the form of each term intraj and inter j puq explicit below the equilibrium multilayer structure is obtained by minimizing the total energy 2 7 with respect to the modulation field u the competition between the intra layer elastic distortion energy 2 9 and inter layer misfit disregistry energy 2 17 thus drives the deviation from the perfect unrelaxed moir 2 4 intra layer elastic energy the intra layer contribution intra writes 2 9 intraj puq v intra j pdjujp qq individual layers are simply two dimensional crystals so the study of the correspond ing internal elastic energy deriving from the potential v intraj 2 9 is classical see e g 29 we define the intra layer atomistic potential energy 2 10 eaj pujq xj v intraj pdjujp qq d 7 0 r 00 i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit r 01 i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit r 11 i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit r 10 i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit r 00 j latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit r 01 j latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit r 11 j latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit bj i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit b 00 j i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit b 11 j i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit b 10 j i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit r 10 j latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit b 01 j i latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit latexit sha 1 base 64 null null latexit fig 3 illustration of the shifted unit cell used for bilinear interpolation of disregistries cauchy born approximate energy density the cauchy born elastic energy den sity function w r 2 2 ry 8 is as usual defined by 2 11 wjpfq v intraj pf bjq when elastic deformations are smooth the cauchy born model is a popular approx imation to the atomistic model eaj indeed for a smooth real space displacement uj r 2 r 2 of atoms in layer j v intraj pdjujp qqq v intra j p ujp q bjq wjp ujp qq note that the spatial gradient of the atomistic deformation only makes sense after an appropriate interpolant is constructed 29 2 5 inter layer landscape the local disregistry the energy landscape for inter layer interactions is tightly linked to the notion of disregistry i e the relative shift between the layers which we now explore now more in depth in the case of lattices that are almost aligned the disregistry between two layers can be observed to vary slowly on a lengthscale much larger than the lattice constants the moir effect as seen on figure 1 a careful description of this slow variation of the disregistry in real space is key to formulating an effective model of slightly misaligned multilayer systems and we propose the following construction by definition the configuration defined above around a lattice site of layer 1 for example placed at the origin is the collection of its disregistries relative to the other layers p jq 2 j p while 1 0 however these vary quickly under continuous translations see 1 3 and this simple description does not make obvious the moir effect indeed the apparent slow variation described above when moving through the layer is caused by spatial aliasing induced by discrete sampling lattice transla tions let us choose a point within layer j as the origin in some global configuration p 1 pq p let us write j ej s t t with 0 s t 1 the lattice sites near the origin in layer j are located at the four corners of a shifted unit cell of the lattice rj 2 12 r 00 j ej s t r 10 j ej s 1 t r 01 j ej s t 1 r 11 j ej s 1 t 1 similarly let us write i ei s 1 t 1 t and identify within layer i the four lattice 8 sites r 00 i r 10 i r 01 i r 11 i we measure the four disregistries between respective site pairs b 00 j i r 00 i r 00 j ei s 1 t 1 ej s t b 10 j i r 10 i r 10 j b 00 j i pej eiq 1 0 b 01 j i r 01 i r 01 j b 00 j i pej eiq 0 1 b 11 j i r 11 i r 11 j b 00 j i pej eiq 1 1 we will assume henceforth that the lattices r 1 rp are very close 2 13 ej ei 1 for all 1 i j p then these four disregistries differ only slightly from each other as seen on figure 3 motivating the reconstruction at the origin by bilinear interpolation in the variables s and t of the aliased disregistry from layer j towards layer i p 1 sqp 1 tqb 00 j i sp 1 tqb 10 j i p 1 sqtb 01 j i stb 11 j i ei s 1 t 1 ej s t pej eiq sp 1 tq 1 0 p 1 sqt 0 1 st 1 1 ei s 1 s t 1 t i eie 1 j j mod ri this last quantity is well defined in i periodic in both variables i and j we now define it as the local disregistry for any couple of layers in any configuration definition 2 4 for any configuration p 1 pq p we define the reference local disregistry bj i from layer j towards layer i as the quantity 2 14 bj ip 1 pq i eie 1 j j p i note that when a lattice site of layer j is chosen as the origin j 0 we recover the original definition of the disregistry bj ip q i furthermore this new disregistry varies slowly under the action of translations 1 3 when condition 2 13 is satisfied bj ipta q bj ip q pi eie 1 j qa confirming that 2 14 captures the mesoscale pattern formation due to the moir 2 6 inter layer misfit energy the leading order contribution to the local misfit energy between two neighboring slightly misaligned layers j and j 1 where 1 j p corresponds to the stacking fault energy per unit area 35 of an isolated bilayer structure formed of layers j and j 1 and slightly rotated or stretched into periodic alignment which we interpret as a misfit energy functional misfitj j 1 p q in practice such a misfit energy has been shown in the physics literature to be most accurately described as a generalized stacking fault energy 21 which can be determined from accurate density functional theory calculations 15 24 note that out of plane displacements can be taken into account by extending the definition of the misfit energy to include a variable inter layer spacing 3 d gsfe 17 remark 2 5 due to the high cost of accurate first principles calculations includ ing van der waals bonding corrections this energy density is typically computed in the approximation where both layers share the same lattice ea eb or form a small supercell such functionals are directly available in the literature for a number of layer combinations such as g g g hbn or hbn hbn involving graphene g or hexago nal boron nitride hbn monolayers 39 more recently such a functional has been 9 given for mos 2 in 11 alternatively direct summation techniques based on empiri cal potentials such as the kolmogorov crespi g g potentials 23 have been developed and may allow to take into account additional local stress dependence of the stacking fault energy 38 because the local misfit energy depends only on the local reference disregistry of adjacent layers of interest we further introduce the site energies misfitj j 1 r localized on each layer defined by 2 15 misfitj bj pj 1 qp q misfit pj 1 q bpj 1 q jp q misfitj j 1 p q note that by definition 2 14 of the local reference disregistry bj pj 1 q these site energies satisfy the symmetry relation 2 16 misfit pj 1 q pejsq misfit j p ej 1 sq s p e 1 j j e 1 j 1 j 1 r 1 2 1 2 q 2 when the layers are relaxed we propose to write the inter layer contribution inter as 2 17 interj puq 1 2 misfit 1 pb 1 2 rusp qq if j 1 1 2 misfitj pbj j 1 rusp qq 1 2 misfitj pbj j 1 rusp qq if 1 j p 1 2 misfitp pbp p 1 rusp qq if j p where bj irus is a modulated local disregistry of layer j with respect to layer i taking into account the modulation of both layers however the modulation of two different layers may not be defined simultaneously at the origin since pi q r x i e i 0 in general when pj q p x i e j 0 for i j an appropriate definition will be presented below in section 3 3 3 kinematics in configuration space and continuum approximation to build an effective elastic model approximating the atomistic energy 2 7 two essential ingredients are now needed an appropriate continuum interpolant for the atomistic deformation is needed to define a spatial gradient used in the cauchy born approximation 2 11 of the intra layer energy next a modulated local disregistry is needed to compute the inter layer energy 2 17 3 1 continuum interpolant as noted earlier an appropriate interpolant is needed to define a spatial gradient for the atomistic deformation continuum modu lation fields relevant to a continuum e g plate modeling of the elastic behavior take the form of j functions 3 1 ucj p cp r 2 q 1 j p which parameterize the displacement at the origin in each of the layer planes depend ing on the global configuration a first idea to construct an interpolant of an atomistic modulation field 2 1 into a continuum interpolant of the form 3 1 is to interpolate the displacements of the closest sites to the origin as earlier for the definition of the reference local disregistry 2 14 let p 1 pq p be an arbitrary configuration consider a particular layer j and write j ej s t with 0 s t 1 the nearest lattice sites in 10 layer j are located at the four points rab with a b p t 0 1 u defined as in 2 12 then the bilinear interpolant of the atomic modulation of layer j at the origin is 3 2 rucjp q p 1 sqp 1 tq ujpt r 00 q sp 1 tq ujpt r 10 q p 1 sqt ujpt r 01 q st ujpt r 11 q the modulation field rucj is a continuous interpolant which allows us to lift the atomistic modulation defined on the transversal x to a set of continuum modulation fields defined on for each of the layer planes remark 3 1 alternatives could be proposed for this spatial interpolant 3 2 for example using linear interpolation on any triangular mesh based on the lattice or also higher order schemes a second idea is to avoid the construction of the interpolant 3 2 by instead evaluating the atomistic modulation at the interpolated local disregistry of layer j with respect to the other layers 3 3 pucjp q uj p j q where we have introduced the configuration interpolant j defined by 3 4 j pbj 1 p q bj pp qq so that pj j q p x any spatial interpolant such as 3 2 only relies on proximity in physical space the accuracy of a method based on its use can be certified in the sense that it can be framed in the context of well understood atomistic to continuum methods 29 while much easier to use the configuration interpolant 3 3 relies on proximity in configura tion space as seen on figure 3 so its accuracy is not so readily analyzed depending on smoothness properties in configuration space that are not always guaranteed for solutions of the atomistic model 2 2 see 13 let us highlight how the difference between the two proposed approaches is quan tified by smoothness in configuration space with the following analysis since the local disregistry varies slowly at the scale of the moir pattern both approaches are very close as long as the atomic modulation u is smooth enough as a function of the configuration parameter in particular if uj is locally linear in then the two mod ulation interpolants 3 2 and 3 3 are in fact equal this observation is the basis of the following estimate which we prove in appendix a proposition 3 2 let u pw 2 qpxq then 3 5 pucj ru c j lqp q j 2 q 1 1 q 2 2 uj lqpxjq where 2 uj is understood as a 2 linear form for which the norm is defined as sup h 1 h 2 1 rh 1 h 2 s and 3 6 p sup 1 i j p ei ej where denotes the r 2 operator norm 3 2 evaluation of the gradient let us now define a spatial gradient associ ated with a given atomistic modulation field u x r 2 a spatial derivative does not make sense directly for atomistic quantities but we may compute one for the 11 configuration interpolant pucj introduced earlier 3 3 note that this is easier than for a traditional piecewise differentiable spatial interpolant such as 3 2 given a global configuration p in the j th layer smooth real space fields for the displacement uc j and deformation y c j maybe be evaluated at any point x p r 2 from the continuum modulation field pucj by the formulae u c j pxq pu c jpt x q y c j pxq x pu c jpt x q this representation allows us in particular to rewrite the strain as a directional deriva tive in the hull framework given the action of the translation on the hull 1 3 it is appropriate to introduce the spatial derivative on as the operation x p j 1 j leading us to compute xpucjp q i j r iujsp j q i j r iujsp j q p eie 1 j q evaluating at a point pj q p x so that j we obtain the spatial gradient of the atomistic modulation 3 7 p xujp q i j r iujsp q peie 1 j iq for pj q p x 3 3 modulated local disregistry in a deformed state the local disregistry is shifted from its reference value due to the modulation fields we propose the following definition for the local disregistry in the modulated atomic configuration definition 3 3 given an atomistic modulation u we define the modulated local disregistry pbj i of a site of layer j with respect to layer i 3 8 i q pbj ip q bj ip q puci p q ujp q for pj q p x 3 4 elastostatics model for multi layer heterostructures we now build a continuum like model on the atomistic configuration space x using the new tools introduced above a gradient for the atomistic modulation 3 7 and the modulated local disregistry 3 8 note that the dimensionality is thus reduced compared to a true continuum description on the full hull as described in section 3 1 we define an elastic energy density approximating eaj as well as an overall intra layer energy density using the cauchy born approximation 2 11 3 9 ecbj pujq xj wjpp xujp qqd ecbpuq p j 1 ecj pujq as well as an inter layer misfit energy density 3 10 emisfitpuq 1 2 p 1 j 1 xj misfitj p pbj j 1 p qqd 1 2 p j 2 xj misfitj p pbj j 1 p qqd 12 where we have used the interpolated modulated local disregistry pbj j 1 defined ear lier 3 8 finally we formulate the elastostatics model for multilayer heterostructures 3 11 u p arg min ecbpuq emisfitpuq u p h 1 xw 1 8 px r 2 q and we understand 3 11 to be a local minimization problem 5 with respect to the w 1 8 topology on the collection of periodic tori x the compact elastostatics model constituted by equations 3 9 3 10 and 3 11 for the relaxation of multi layer heterostructures generalizes known bilayer approxi mations 17 38 to any number p 2 of incommensurate layers without relying on approximation by periodic configurations supercells the continuum relaxed dis placements uc j are not periodic in any two dimensional real space domain when p 2 but the modulations uj are periodic in the local configuration space formed as a collection of 2 pp 1 q dimensional tori remark 3 4 here we do not include possible external uniform periodic forces in our formulation although our analysis extends this case in a straightforward manner remark 3 5 we also do not include out of plane bending in our presentation though we note all the analysis could be extended to include bending in this case the intra layer continuum model would become more complex to include curvature effects and the modulated disregistry would need to include parallax effects due to out of plane bending as in 17 remark 3 6 we note that the case of a rigid substrate such as considered in 18 can be modeled by adding the constraint u 1 0 to the minimization 3 11 an important question which we will not address in the present manuscript is whether one can show that the solutions to the elastostatics problem 3 11 are in fact close to solutions to the atomistic problem 2 2 it approximates a classical question regarding atomistic to continuum approaches 29 the main difficulty is to show that solutions of the discrete atomistic model are smoothly parameterized in configuration space such that prop 3 2 validates the use of a configuration space interpolant within the context of the one dimensional frenkel kontorova model a full analysis is possible 13 using the non perturbative aubry mather theory and in dicates that the modulation or hull function is smooth in the perturbative regime but becomes fully discontinuous cantor like in the configuration space after the commensurate incommensurate transition indicating the limit beyond which the elas tostatics model 3 11 is not expected to be an effective approximation a similar behavior can be formally expected in 2 d but a rigorous analysis seems presently out of reach as the extension of the aubry mather theory to higher dimensional systems is still essentially an open problem as discussed in section 2 1 1 in 31 4 analytical study and results bilayer case in this section we present a first result on the existence of minimizers for the relaxation problem 3 11 we limit our current scope to the case of bilayers pp 2 q note that there are additional difficulties linked with the degenerate ellipticity of the energy functional ecb for p 3 and we postpone to later studies their investigation 4 1 the moir cell for bilayers let us fix p 2 in this case the configura tion space is simply 1 2 and the transversal for each layer is simply x 1 2 x 2 1 the analysis can be simplified by an appropriate change of variables let us define the moir lattice rm pe 12 e 11 q 1 z 2 13 and the associated periodic moir cell 4 1 m r 2 rm pe 12 e 11 q 1 r 1 2 1 2 q 2 we introduce next the linear mappings 4 2 1 m 1 x pe 1 e 1 2 iqx 2 m 2 x pe 2 e 1 1 iqx one checks easily that 1 and 2 are isomorphisms that satisfy 1 p 1 0 q p 0 2 q and 2 p 0 2 q p 1 0 q using these as change of variables we introduce the new modulation unknowns defined on the new domain m 4 3 um 1 pxq u 1 p 2 pxqq um 2 pxq u 2 p 1 pxqq one of the advantages of working on the domain m is that the spatial gradient defined earlier 3 7 corresponds by the chain rule to the standard gradient 4 4 um 1 pxq p xu 1 p 2 pxqq um 2 pxq p xu 2 p 1 pxqq let us finally reformulate the minimization problem 3 11 on the new domain m 4 5 pu m 1 u m 2 q p arg min te cb mpum 1 um 2 q e misfit m pum 1 um 2 q um 1 um 2 p h 1 xw 1 8 p m r 2 q where 4 6 a ecbmpum 1 um 2 q m w 1 p um 1 q w 2 p um 2 q and 4 6 b emisfitm pum 1 um 2 q 1 2 m 1 p 2 pxq um 2 pxq um 1 pxqq 2 p 1 pxq um 1 pxq um 2 pxqq dx in the remainder of the section we will drop the index m for simplicity whenever it is possible to do so without confusion 4 2 the space of admissible modulations now it is easy to notice that the atomistic and continuum models are both formally translation invariant eapu xq eapuq ecbpu xq ecbpuq emisfitpu xq emisfitpuq x p r 2 in fact the translation of each layer by independent vectors x 1 x 2 corresponds for mally to choosing a different initial configuration and in principle does not modify the energy landscape due to the approximation introduced by the interpolation scheme section 2 1 the misfit energy 3 10 is not exactly invariant under such indepen dent translations of the layers nevertheless these considerations justify formally the following additional constraint on modulation functions 4 7 m uj 0 for j 1 2 14 this leads us to introduce sobolev spaces of periodic null average modulation func tions for n 1 on an arbitrary domain 4 8 w n p p q u pwn pp r 2 r 2 q such that u 1 u 2 0 w 8 p q v p c 8 p r 2 r 2 q such that v 1 v 2 0 we typically omit the explicit dependency on when it is possible to do so without confusion e g in this section m the hilbert space w n 2 is equipped with the norm 4 9 u n 2 n k 0 ku 2 l 2 1 2 where l 2 2 dx 1 2 finally to avoid interpenetration of matter following 29 we assume that displace ment gradients satisfy a uniform bound in practice we set a constant 0 1 and 4 10 k u pw 1 8 p mq u 1 l 8 u 2 l 8 4 2 1 stability we assume that the lattices rj are stable that is 4 11 min 1 j p inf vpcpx r 2 q v l 2 1 2 eaj p 0 qrv vs 0 where we recall that the atomistic energy is defined by 2 10 physically 4 11 ensures that small distortions of the lattice rj will increase the potential energy for layer j in the stack the stability of the layers in the continuous framework can be then expressed by the following result adapted from 29 proposition 5 1 and lemma 5 2 proposition 4 1 suppose the lattices r 1 r 2 are stable and let be defined by 4 11 then 4 12 2 ecbmp 0 qrv vs v 2 l 2 v pw 1 2 furthermore there exists 1 0 such that for 1 4 13 2 ecbmpuqrv vs 1 2 v 2 l 2 v pw 1 2 u p k proof as a first step we note that the interpolant pucj defined above 3 3 allows us by straightforward calculations to write the following birkhoff averaging formula fix um j p k j p t 1 2 u and f p c tf p r 2 2 f u then by prop 2 4 6 for any p m fp um jq fp xpucjqd 1 lim r 8 1 br br f p xpujpt x qq dx now let us show that 4 12 holds fix vm j p c 8 p m r 2 q and p let vj p c 8 pr 2 r 2 q defined by vjpxq vjpt x q such that see also 29 proposition 3 2 2 ecbm jp 0 qrvm j vm js m 2 wj p 0 q r vm j vm js lim r 8 1 br br 2 wj p 0 q r vj vjsdx 15 where ecbm jpvm jq ffl m wjp vm jq for r 0 let r p c 8 pr 2 rq be a smooth cutoff function such that 0 r 1 rpxq 0 for x r 1 rpxq 1 for x r and r is uniformly bounded independently of r by lemma 5 2 in 29 r 2 2 wj p 0 q r p rvjq p rvjqsdx r 2 p rvjq vj 2 l 2 pbrq moreover br 1 zbr 2 wj p 0 q r p rvjq p rvjqsdx 2 wjp 0 q br 1 zbr p rvjq 2 cpr 1 q vj 2 l 2 pbr 1 zbrq where c 0 is a constant independent of r we deduce in the thermodynamic limit lim r 8 1 br br 2 wj p 0 q r vj vjsdx lim r 8 br vj 2 l 2 pbrq by the birkhoff property above this yields the configuration space estimate 2 ecbj p 0 qrvm j vm js vm j 2 l 2 then 4 12 follows by density ofw 8 inw 1 2 the proof of 4 13 is analogous using proposition 5 1 in 29 4 2 2 smoothness using the same idea we can also prove lipschitz bounds on the variations of the intra layer energies following 29 we define the intra layer finite difference stencil space 4 14 dj g pg q pbj g p r 2 g dj equipped with the norm g dj sup pbj g we assume that v intra j p c kpdj q for some k 2 the potential is smooth for injective deformations partial derivatives are denoted as v intraj pgq biv intraj pgq bg 1 bg i for g p dj and p pbjqi and understood as multilinear forms acting on families of vectors h ph 1 hiq denoted as v intraj pgqrhs v intra j 1 i rh 1 his equipped with the norm 4 15 sup hppr 2 qi h 1 hi 1 rhs define quantities measuring the decay of the interatomic potentials v intraj mjp q i l 1 l sup gpdj v intraj pgq for p pbjqi 1 i k then as a consequence of prop 3 2 in 29 proposition 4 2 suppose the atomic potentials satisfy the decay bounds 4 16 m piq max 1 j p ppbjqi mjp q 8 for 1 i k then for k 5 k i 1 1 pi 1 we have 4 17 kecbmpuqrv 1 vks m pkq k i 1 vi lpi 16 4 3 existence of local energy minimizers our goal in this section is to prove the following existence theorem for the energy minimizer in the bilayer case theorem 4 3 suppose the lattices r 1 r 2 are stable in the sense of 4 11 then when the site energies defined earlier 2 15 are such that 1 c 4 p 2 q and 2 c 4 p 1 q are small enough weak inter layer coupling regime there exists a solution u pw 3 2 of the euler lagrange equation 4 18 ecbmpu q rvs emisfitm pu q rvs 0 v pw 3 2 or equivalently u is a solution of two coupled partial differential equations on m 4 19 div p w 1 p u 1 qq fpx u 1 u 2 q div p w 2 p u 2 qq fpx u 1 u 2 q where fpx vq 1 2 p 1 q r 2 pxq vs 1 2 p 2 q r 1 pxq vs furthermore this solution is stable in the sense that there exists c 0 0 such that 4 20 2 ecbmpu q rv vs 2 emisfitm pu q rv vs c 0 v 2 1 2 v pw 1 2 remark 4 4 the multi well nature of the nonlinear forcing term in the right hand side of the euler lagrange equation 4 19 is reminiscent of the ginzburg landau equation as noted in 18 remark 4 5 the existence of global energy minimizers can also be shown by standard methods exploiting the convexity or quasi convexity properties of typical lin ear or nonlinear elastic functionals approximating the cb energy ecb with respect to the gradient xu in the space of null average modulations w 1 p the proofs of theo rem 9 5 2 in 14 in the linear case or theorem 8 31 in 16 for the non linear case apply almost verbatim with slight modifications to account for the periodic boundary conditions proof our proof relies on an application of a quantitative version of the inverse function theorem for example lemma 2 2 in 28 which we recall here for completeness lemma 4 6 let x y be banach spaces a an open subset of x and let f a y be fr chet differentiable suppose that x 0 p a satisfies the conditions fpx 0 q y fpx 0 q 1 lpy x q bx px 0 2 q a fpx 1 q fpx 2 q lpx yq l x 1 x 2 x for xj x 0 x 2 and 2 l 2 1 then there exists a unique x p x such that fpxq 0 and x x 0 x 2 let us set x w 3 2 y w 1 2 x 0 0 and a bx p 0 1 q where 1 is chosen to be small enough that a k thanks to the sobolev embedding w 3 2 w 1 8 define the mapping f a y defined by fpuq ecbmpuq emisfitm puq we compute explicitly from 4 6 with f defined as in 4 19 4 21 ecbmpuq div p w 1 p u 1 qq div p w 2 p u 2 qq emisfitm puq f px u 1 u 2 q f px u 1 u 2 q 17 residual in particular we have 4 22 fp 0 q y emisfitm p 0 q 1 2 2 fp 0 q 1 2 where c 2 j 1 j 8 e 2 e 1 e 1 j 2 j 8 and c is a generic con stant independent of rj and j stability let us compute for v p x 2 emisfitm p 0 qrv vs 1 2 m p 2 1 q 2 p 2 2 q 1 rv 2 v 1 v 2 v 1 sdx so that using proposition 4 1 4 23 2 ecbm p 0 qrv vs 2 emisfitm p 0 qrv vs v 2 l 2 2 j 1 2 j 8 v 2 l 2 2 c 2 p v 2 1 2 assuming that 2 j 1 2 j 8 2 c 2 p where cp is the constant in the poincar wirtinger estimate 4 24 v xvy 1 2 cp v l 2 p m q where xvy m vdx fix v p y by the lax milgram theorem there exists a unique solution u p y to the problem fp 0 qrus v with u 1 2 2 1 c 2 p v 1 2 let g 2 emisfitm p 0 qru s we compute g 1 2 c 2 j 1 2 j 8 e 2 e 1 e 1 j 3 j 8 u 1 2 where c is another generic constant then u is a solution of the elliptic problem with constant coefficients 2 ecbm p 0 qru s v g elliptic regularity see e g 19 section 6 3 1 ensures that u belongs to w 3 2 and one can further show that u 3 2 c v g 1 2 for some constant c 0 independent of j this shows that fp 0 q is a bijection from w 3 2 to w 1 2 with the stability estimate 4 25 fp 0 q 1 lpy x q where c 1 c 1 2 j 1 j c 3 lipschitz estimate using the sobolev inequalities u 1 8 u 2 4 u 3 2 and estimate 4 17 a lengthy but straightforward computation for arbitrary u u 1 v p w 3 2 leads to 2 ecbmpuqrv s 2 ecbmpu 1 qrv s 1 2 div 2 w 1 p u 1 q v 1 2 w 1 p u 11 q v 1 div 2 w 2 p u 2 q v 2 2 w 2 p u 12 q v 2 1 2 c 5 k 3 m pkq u u 1 3 2 v 3 2 18 where c is a generic constant independent of rj and j similarly we compute 2 emisfitm puqrv s 2 emisfitm pu 1 qrv s 1 2 1 2 2 j 1 p vfj px u 1 u 2 q vfj px u 11 u 12 qq pv 1 v 2 q p vfj px u 1 u 2 q vfj px u 11 u 12 qq pv 1 v 2 q 1 2 c u u 1 w 1 8 v w 1 2 c 1 u u 1 3 2 v 3 2 with c 1 c 2 j 1 4 j 8 e 2 e 1 e 1 j 4 j 8 3 j 8 and c a generic constant this shows that f is continuously differentiable on fpuq fpu 1 q lpx yq l u u 1 3 2 v 3 2 with l c 5 k 3 m pkq c 1 we find finally that 2 1 and 2 l 2 1 for 2 j 1 j c 4 small enough then by the quantitative implicit function theorem lemma 4 6 there exists a unique solution u to the euler lagrange equation fpu q 0 such that u 3 2 2 it remains to show that this solution is stable we assume that j c 2 are small enough such that we may choose c 0 0 satisfying the condition 4 26 0 c 0 2 cp 2 j 1 j c 2 then computing as above in 4 23 proposition 4 1 ensures that 4 27 2 ecbmpu q rv vs 2 emisfitm pu q rv vs c 0 v 2 l 2 then u is a stable solution in the sense of 4 20 4 4 asymptotic analysis let us describe more precisely in a semilinear set ting the parameter range where we can ensure a unique solution such as given by theorem 4 3 exists equation 4 26 gives a hint when e 1 e 2 0 the diameter of the moir cell 4 1 and consequently the constant cp in the poincar wirtinger estimate 19 grows to infinity roughly as pe 1 e 2 q 1 until the right hand side in 4 26 becomes negative in particular the physically relevant inter layer inter actions albeit weak may be too large for theorem 4 3 to apply at small angles one possibility is for example that for large scale moir patterns a bifurcation occurs where two or more stable solution branches exist 17 to simplify the analysis we will assume that both layers are made of the same material and the stresses inside each layer are modeled by isotropic linear elasticity i e the intra layer energy density functionals are the same w w 1 w 2 which takes the form 4 28 w puq 2 divpuq 2 puq puq where puq 1 2 p u ut q where 0 and 0 are the lam parameters of the material in addition the lattices basis of both layers are identical and thus share the same lattice basis e simply twisted by a relative angle 0 4 29 e 1 r 2 e e 2 r 2 e where r cosp q sinp q sinp q cosp q 19 a direct computation then shows that for varying the moir cell 4 1 is simply a rescaled copy of a new reference cell 0 4 30 mp q 1 2 sinp 2 q 0 where r 0 e 0 z 2 0 r 2 r 0 with e 0 r 2 e we rescale 4 2 to define consistent disregistry mappings on the reference cell 0 4 31 1 0 1 x r 2 x 2 0 2 x r 2 x also thanks to the symmetry relation 2 16 the generalized stacking fault energy can be transposed as a single functional 4 32 0 pxq 1 2 pxq 2 1 pxq the euler lagrange equation 4 19 for extremal points of the energy functional for any angle 0 can be recast as a problem on the reference cell 0 4 33 div p divpu 1 qi 2 pu 1 qq 1 4 sin 2 p 2 q f px u 1 u 2 q div p divpu 2 qi 2 pu 2 qq 1 4 sin 2 p 2 q f px u 1 u 2 q where 4 34 f px vq 1 2 0 px r 2 vq r 2 1 2 0 px r 2 vq r 2 remark 4 7 local strains are usually small in the physically relevant regime of weak inter layer interactions and moire scale modulations and it is reasonable as a first approximation to model the stresses inside each layer using isotropic linear elasticity at the same time the misfit energy exhibits large variations for atomic scale displacements and hence forces f due to the inter layer misfit cannot be linearized it can be easily be shown that any solution of the system 4 33 satisfies u 1 u 2 then the model 4 33 reduces simply to the single semilinear equation 4 35 div p divpuqi 2 puqq 1 4 sin 2 p 2 q f px 2 uq where u u 1 u 2 remark 4 8 at small angles a taylor expansion of expression 4 34 indicates that f depends only very weakly on f px vq f 0 px vq op 2 p 1 v qq therefore the main parameters governing the relaxation are the profile of the gsfe functional mainly the location of the minima saddle points and maxima which all de pends mostly on the symmetries of the material and the ratio of the gsfe amplitude to the square of the twist angle 20 remark 4 9 the natural rescaling of the gradient by the inverse moir length p 2 sinp 2 qq 1 in 4 35 is reminiscent of the rescaling by l in the continuum euler lagrange equations in 18 where is the inter layer distance and l the lateral size of a domain which is constrained to be of the same order as the moir pattern this explicit rescaling enables us to study explicitly the interplay between twist angle and strength of the inter layer coupling theorem 4 10 assume the functional 0 is twice continuously differentiable a for any n for any integer n there exists solutions to the euler lagrange equation 4 35 in w 1 2 p 0 q which satisfy 4 36 u 1 2 1 c 1 e 0 8 4 sin 2 p 2 q where c 1 e is a fully identifiable constant depending on the lattice basis e only b the solution is unique if 4 37 2 0 8 2 c 0 e 2 where c 0 e 2 c 1 e is another fully identifiable constant depending on the lattice basis e only c if in addition 0 is smooth any solution is also smooth and its derivatives for any k 2 3 satisfy the bounds 4 38 ku l 2 ck sin 2 kp 2 q where the constant ck depends only on e and 0 ck 1 p 0 q proof given any g p l 2 p 0 r 2 q consider the problem find u such that div p divpuqi 2 puqq g the corresponding variational formulation writes 4 39 0 divpuqdivpvq 2 puq pvq 0 g v v pw 1 2 p 0 r 2 q to establish the coercivity of the bilinear form on the left hand side of 4 39 we decompose periodic zero average functions over 0 as the fourier series vpxq kpr 0 zt 0 u vke 2 i k x such that v 21 2 kpr 0 p 1 2 k 2 q vk 2 now we estimate 0 divpvq 2 2 pvq pvq 2 0 pvq pvq 2 kpr 0 zt 0 u p 2 q 2 kb vk vk b k 2 2 kpr 0 zt 0 u 2 k 2 vk 2 21 this implies the coercivity estimates 4 40 0 divpvq 2 2 pvq pvq v 2 l 2 0 divpvq 2 2 pvq pvq c 0 e v 2 l 2 0 divpvq 2 2 pvq pvq c 1 e v 2 1 2 where c 0 e min 2 k 2 k p r 0 zt 0 u and c 1 e c 0 e 1 c 0 e the lax milgram lemma then ensures that there exists unique solutions gpgq u p w 1 2 to problem 4 39 such that g is a continuous linear mapping l 2 w 1 2 satisfying the bounds gpgq l 2 1 c 0 e g l 2 gpgq w 1 2 1 c 1 e g l 2 we also introduce the mapping f l 2 l 2 with fpuq 14 sin 2 p 2 qf p 2 up qq which is bounded fpuq l 2 14 sin 2 p 2 q 0 8 as well as lipschitz continuous fpuq fpu 1 q l 2 2 4 sin 2 p 2 q 2 0 8 u u 1 l 2 now we note that the mapping h g f l 2 w 1 2 is bounded 4 41 hpuq l 2 1 4 sin 2 p 2 q 0 8 c 0 e hpuq w 1 2 1 4 sin 2 p 2 q 0 8 c 1 e and thus maps continuously the following ball of l 2 p 0 r 2 q b u p l 2 u l 2 1 4 sin 2 p 2 q 0 8 c 0 e then because the injection w 1 2 l 2 is compact we can apply schauder s fixed point theorem see e g theorem 9 12 1 in 14 to obtain the existence of at least one fixed point of the mapping h which is a solution to 4 35 the bound 4 36 of a follows from 4 41 furthermore h satisfies the lipschitz bound hpuq hpu 1 q l 2 1 4 sin 2 p 2 q 2 2 0 8 c 1 e u u 1 l 2 thus we may apply the banach fixed point theorem see e g theorem 3 7 1 in 14 to show there exists a unique fixed point to h under the condition 1 4 sin 2 p 2 q c 1 e 2 2 0 8 since 4 sin 2 p 2 q 2 this proves b finally assume that 0 is smooth and u p w 1 2 is a solution of the euler lagrange system 4 35 the finite difference technique for elliptic regularity see 22 e g 19 section 6 3 1 ensures that u p w k 2 for any k 2 let us show the bound 4 38 by recursion set g f px 2 u q for k 2 we test 4 39 with v 1 b v for some v p c 8 p 0 r 2 q and 1 2 then 1 4 sin 2 p 2 q 0 g b v 0 divpuqdivpb vq 2 puq pb vq 0 divpb uqdivpvq 2 pb uq pvq which implies that b u l 2 14 sin 2 p 2 q g l 2 1 4 sin 2 p 2 q 0 l 8 and thanks to 4 36 u 2 2 c 2 4 sin 2 p 2 q where the constant c 2 depends only on e and 0 c 1 p 0 q next for k 2 we use the test function ku and the fourier transform kpr 0 zt 0 u p 2 q 2 2 k 2 k 2 kb u k u k b k 2 2 k u k 2 1 4 sin 2 p 2 q kpr 0 zt 0 u 2 k 2 ku k gk and therefore by the cauchy schartz inequality kpr 0 zt 0 u 2 k 2 k 2 u k 2 1 4 sin 2 p 2 q kpr 0 zt 0 u 2 k k u k 2 k k gk 1 4 sin 2 p 2 q kpr 0 zt 0 u 2 k 2 k u k 2 1 2 kpr 0 zt 0 u 2 k 2 k gk 2 1 2 thus k 1 u 2 l 2 1 4 sin 2 p 2 q ku l 2 kg l 2 now by an appropriate fa di bruno s formula we can show that there exists a generic constant ck 0 independent of and 0 such that kg l 2 ck 0 ck 1 p 1 u k 2 and thus k 1 u 2 l 2 ck 0 ck 1 4 sin 2 p 2 q u k 2 p 1 u k 2 q let us now assume that for k 2 u k 2 ck sinkp 2 q where the constant ck depends only on e and 0 ck note that this is already true for k 2 then we have shown that u 2 k 1 2 c 2 k sin 2 kp 2 q ckck 0 ck 1 4 sin 2 kp 2 q 1 ck sinkp 2 q ck 1 sink 1 p 2 q 2 where ck 1 c 2 k ckp 1 ckq 0 ck 1 4 1 2 proceeding inductively c follows 23 c 0 c 1 c 2 c 3 37 950 47 352 6 832 4 064 0 374 0 095 table 1 elastic moduli and gsfe coefficients for graphene bilayers in units of mev unit cell area 5 numerical study example of graphene bilayers as an illustration of the previous framework and analysis we propose to study numerically the relaxation of a slightly twisted graphene bilayer system 17 this particular assembly is also known for its exceptional electronic properties 7 8 10 which might be influenced by the domain formation due to mechanical relaxation 37 parameters graphene corresponds to a triangular lattice structure with the basis e 3 a 0 3 2 3 2 1 2 1 2 where a 0 1 42 nm such that the twisted lattices are given by 4 29 the inter layer gsfe is assumed to take the form 11 5 1 misfit 1 p 2 q p 2 e 1 2 2 q misfit 2 p 1 q p 2 e 1 1 1 q where the symmetry adapted functional is defined periodically on r 0 2 q 2 as v w c 0 c 1 rcospvq cospwq cospv wqs c 2 rcospv 2 wq cospv wq cosp 2 v wqs c 3 rcosp 2 vq cosp 2 wq cosp 2 v 2 wqs the lam parameters 4 28 of the graphene sheets as well as the gsfe co efficients c 0 3 accurately fitted from vdw dft calculations 11 are summed up in table 1 discretization and numerical scheme for consistency we discretize here directly the minimization problem 3 11 let us define a uniform n n grid on the torus r 1 2 1 2 q 2 5 2 gn tn 2 u n 1 n 0 1 n tn 2 u n 2 where 0 n odd 1 n even we introduce next the set of unknown nodal values un tunn unpgn such that nodal values of the displacements u 1 and u 2 on 2 and 1 respectively are given by un 1 pe 2 nq u n n u n 2 p e 1 nq for n p gn where we have used the symmetry 4 35 to reduce the number of free variables we next interpolate these values by the fourier series 5 3 un 1 p 2 q kpgn punk e 2 i n k e 1 2 2 un 2 p 1 q kpgn punk e 2 i n k e 1 1 1 24 a gsfe landscape before relaxation b gsfe landscape after relaxation 2 1 0 1 2 1 0 0 5 0 0 0 5 1 0 2 c displacement u 1 p 2 q on the unit cell 400 200 0 200 400 400 200 0 200 400 d displacement um 1 pxq on the moir cell fig 4 relaxation for a graphene bilayer with a 0 3 relative twist angle a gsfe functional 1 in the reference configuration space 2 showing the maxima and min ima at shifts corresponding respectively to aa and ab ba stackings b relaxed local misfit energy as a function of original shift 1 p 2 2 u 1 p 2 qq c displace ment of atoms in layer 1 in configuration space u 1 corresponding to the change in the local stacking configuration if layer 2 were not moving d displacement field of atoms in layer 1 in real space with the periodicity of the moir cell note that the fourier coefficients appearing in this expression can be computed ef ficiently from the nodal values un by the fast fourier transform the elastic en ergy 4 28 is then exactly computable while the misfit energy 3 10 can be approx imated by uniform quadrature a straightforward calculation leading to 5 4 emisfitn puq 1 2 n 2 npgn 2 n 2 e 12 u n n 2 n 2 e 11 u n n an explicit expression can also be obtained for the gradient of these energies we implemented this approach in the julia language 4 using the limited memory bfgs quasi newton algorithm from the optim jl julia library to minimize numerically the resulting total energy results and discussion we first discuss numerical results obtained for the twist angle 0 3 presented in figure 4 the grid size is chosen as n 144 we observe the formation of a well defined triangular pattern in configuration space see figure 4 b in real space this corresponds to the triangular meso scale pattern ob served in experiments results 37 relaxation causes the expansion of the regions of lowest energy stacking where the lattices are staggered graphite or bernal stacking into well defined triangular domains arranged in a hexagonal pattern and the con traction of higher energy stacking regions in particular where lattices are vertically 25 aligned note that expansion or contraction in configuration space as seen on fig ure 4 c corresponds to a rotation in real space as seen on figure 4 d such that the effective local twist angle is enhanced in regions of higher energy and reduced in regions of lower energy thus the layers are brought into almost perfect alignment with the ab ba triangular domains next let us discuss briefly the atomistic mappings corresponding to the defor mations computed above to account for the hexagonal multilattice nature of the graphene lattice two sublattices denoted by a b can be introduced with respective shifts a 0 2 e 1 in each of the layers before the twist is taken into account we then make the simplification that the shift field 33 is fixed for each of the two layers the deformed sublattices from a starting configuration p 1 2 q are given by the atomistic deformations y 1 apr 1 q r 1 a 0 2 r 2 e 1 u 1 p 2 r 1 q y 1 bpr 1 q r 1 a 0 2 r 2 e 1 u 1 p 2 r 1 q for r 1 p 1 r 1 y 2 apr 1 q r 2 a 0 2 r 2 e 1 u 2 p 1 r 2 q y 2 bpr 1 q r 2 a 0 2 r 2 e 1 u 2 p 1 r 2 q for r 2 p 2 r 2 these mappings allow us to visualize the domain structures at the atomistic level in real space as presented in figure 1 for a 3 twist angle 2 a closer inspection of these structures reveals that the pattern is not periodic with the moir lattice m although the calculation of the hull functions u 1 and u 2 uses periodic boundary conditions and the moir cell m introduced in paragraph 4 1 resembles a real space supercell in this sense our method allows us to truly model the incommensurability of the lattices r 1 and r 2 without the need for constructing an appropriate supercell as in previous works 17 34 38 conclusion we have presented a novel elastostatics model 3 9 3 11 for the relaxation of an incommensurate multi layered structure our derivation is based on the ergodic properties 1 7 with respect to the translation group of local configura tions for incommensurate multi layers a gradient for the atomistic deformation 3 7 and the modulated local disregistry 3 8 we have presented a rigorous analysis in the bilayer case p 2 showing how the continuum relaxation problem is well posed and amenable to numerical simulations we can construct the actual relaxed aperiodic atomistic positions as in 2 2 i e by sampling the displacement field at the aperi odic atomistic positions of the unrelaxed incommensurate heterostructure as seen in figure 1 this provides the link between the atomistic picture and existing contin uum bilayer models 17 these relaxed atomistic configurations can then be used to compute diffraction patterns 37 the electronic density of states and transport properties 6 25 future perspectives include the further study of the proposed models in particular for p 2 layers where one must face difficulties due to the lack of ellipticity of the elastic energy functional 3 9 from the analytical point of view and the curse of dimensionality from the numerical point of view as the dimension of the configuration space becomes larger than 4 2 note that interlayer coupling used in the computation leading to figure 1 was artifically en hanced by a factor of 100 with respect to the coefficients in 1 such that the scales of both unit and moir cells are visible while still ensuring significant relaxation 26 acknowledgments this work was supported in part by aro muri award w 911 nf 14 1 0247 and by the national science foundation under nsf award dms 1819220 appendix a proof of prop 3 2 in this appendix we detail the technical proof of proposition 3 2 which we recall first for ease of reading proposition a 1 let u pw 2 qpxq then a 1 puj ruj lqp q j 2 q 1 1 q 2 2 uj lqpxjq where xj i j i is the subset of the transversal corresponding to lattice sites of layer j 2 uj is understood as a 2 linear form for which the norm is defined as sup h 1 h 2 1 rh 1 h 2 s and a 2 p sup 1 i j p ei ej where denotes the r 2 operator norm proof it is natural to relate this result to local finite element interpolant error estimation and follow similar steps let p be an arbitrary configuration j be an arbitrary layer number consider a taylor expansion up to degree 1 of uj around the point j t 1 ujp q uj p j q uj p j q where p 1 pq p r 2 p j 0 using the integral formula for the residual of the taylor series we have ujp j q t 1 ujp q 1 0 p 1 hq 2 2 d 2 uj dh 2 p j h qdh 1 0 p 1 hq 2 2 2 ujp j h qr sdh so by jensen s inequality we obtain the estimate a 3 ujp j q t 1 ujp q q 2 q 1 0 p 1 hq 2 q 2 q 2 ujp j h q q dh as earlier see 3 2 let us write j ej s t with 0 s t 1 the lattice sites in layer j around the origin are located at the four points rab with a b p t 0 1 u defined as in 2 12 one checks easily from the definition 3 4 that t rab j ab for a b p t 0 1 u where the shifts 00 10 01 11 can be chosen as 00 pe 1 ejq s t pep ejq s t 10 pe 1 ejq s 1 t pep ejq s 1 t 01 pe 1 ejq s t 1 pep ejq s t 1 11 pe 1 ejq s 1 t 1 pep ejq s 1 t 1 27 since ab is defined on and is thus invariant under lattice shifts note that for a b p t 0 1 u ab j 0 and ab 2 where is defined in 3 6 furthermore the weighted average of these shifts is zero a bpt 0 1 u ab ab 0 where we have introduced the bilinear weights 00 p 1 sqp 1 tq 10 sp 1 tq 01 p 1 sqt 11 st as a consequence by the affine character of the taylor approximant t 1 uj defined above a 4 pujp q t 1 ujp 0 q a bpt 0 1 u ab t 1 ujp abq let us now rewrite the definition 3 2 of the bilinear interpolant ruj as a 5 rujp q a bpt 0 1 u ab ujp j abq taking the difference of the identities a 4 a 5 and using convexity of the norm and the above taylor estimate a 3 we find the pointwise estimate pujp q rujp q q 2 q 1 0 p 1 hq 2 q a bpt 0 1 u ab 2 ujp j h abq q dh we may now integrate over the configuration parameter p 1 pq the dif ference between and p j h abq depends only on s t and h for example p j h 00 q phej p 1 hqe 1 q s t phej p 1 hqepq s t integrating over the variables i for i j with fixed values of j ej s t and h we find that by translation invariance of the lebesgue measure i j i 2 ujp j h abq q op i j d i 2 uj q lqpxj opq this leads to i j i pujp q rujp q q i j d i 2 q 2 uj lqpxj opq 1 0 p 1 hq 2 qdh since the right hand side does not depend on the remaining variable j one last integration over it yields pujp q rujp q q lqp q j 2 q 1 2 q 2 uj q lqpxj opq which proves the desired estimate 3 5 28 references 1 s aubry and p le daeron the discrete frenkel kontorova model and its extensions i exact results for the ground states physica d 8 1983 pp 381 422 2 j bellissard coherent and dissipative transport in aperiodic solids in lecture notes in physics vol 597 springer 2003 pp 413 486 3 j bellissard a van elst and h schulz baldes the noncommutative geometry of the quantum hall effect journal of mathematical physics 35 1994 pp 5373 5451 4 j bezanson a edelman s karpinski and v b shah julia a fresh approach to numerical computing siam review 59 2017 pp 65 98 5 x blanc c le bris and p l lions atomistic to continuum limits for computational materials science esaim mathematical modelling and numerical analysis 41 2007 pp 391 426 6 e canc s p cazeaux and m luskin generalized kubo formulas for the transport prop erties of incommensurate 2 d atomic heterostructures journal of mathematical physics 58 2017 p 063502 7 y cao v fatemi a demir s fang s l tomarken j y luo j d sanchez yamagishi k watanabe t taniguchi e kaxiras and p jarillo herrero correlated insulator behaviour at half filling in magic angle graphene superlattices nature 556 2018 pp 80 84 8 y cao v fatemi s fang k watanabe t taniguchi e kaxiras and p jarillo herrero unconventional superconductivity in magic angle graphene superlattices na ture 556 2018 pp 43 50 9 s carr s fang z zhu and e kaxiras minimal model for low energy electronic states of twisted bilayer graphene arxiv preprint arxiv 1901 03420 2019 10 s carr d massatt s fang p cazeaux m luskin and e kaxiras twistronics manipulating the electronic properties of two dimensional layered structures through their twist angle physical review b 95 2017 p 075420 11 s carr d massatt s b torrisi p cazeaux m luskin and e kaxiras re laxation and domain formation in incommensurate 2 d heterostructures arxiv preprint arxiv 1805 06972 2018 12 a h castro neto f guinea n m r peres k s novoselov and a k geim the electronic properties of graphene reviews of modern physics 81 2009 p 109 13 p cazeaux m luskin and e b tadmor analysis of rippling in incommensurate one dimensional coupled chains multiscale modeling simulation 15 2017 pp 56 73 14 p g ciarlet linear and nonlinear functional analysis with applications vol 130 siam 2013 15 g constantinescu a kuc and t heine stacking in bulk and bilayer hexagonal boron nitride physical review letters 111 2013 p 036104 16 b dacorogna direct methods in the calculus of variations vol 78 springer science business media 2007 17 s dai y xiang and d j srolovitz twisted bilayer graphene moir with a twist nano letters 16 2016 pp 5923 5927 18 m i espa ol d golovaty and j p wilber discrete to continuum modelling of weakly interacting incommensurate two dimensional lattices proceedings of the royal society of london a mathematical physical and engineering sciences 474 2018 19 l c evans partial differential equations second edition springer series in computational physics american mathematical society providence rhode island 2010 20 a k geim and i v grigorieva van der waals heterostructures nature 499 2013 pp 419 425 21 x gong and e mele stacking textures and singularities in bilayer graphene physical review b 89 2014 p 121415 22 k kim a dasilva s huang b fallahazad s larentis t taniguchi k watan abe b j leroy a h macdonald and e tutuc tunable moir bands and strong correlations in small twist angle bilayer graphene proceedings of the national academy of sciences 114 2017 pp 3364 3369 23 a n kolmogorov and v h crespi smoothest bearings interlayer sliding in multiwalled carbon nanotubes physical review letters 85 2000 p 4727 24 n marom j bernstein j garel a tkatchenko e joselevich l kronik and o hod stacking and registry effects in layered materials the case of hexagonal boron nitride physical review letters 105 2010 p 046801 25 d massatt m luskin and c ortner electronic density of states for incommensurate 29 layers multiscale modeling simulation 15 2017 pp 476 499 26 n n nam and m koshino lattice relaxation and energy band modulation in twisted bilayer graphene physical review b 96 2017 p 075311 27 k s novoselov a k geim s v morozov d jiang y zhang s v dubonos i v grigorieva and a a firsov electric field effect in atomically thin carbon films science 306 2004 pp 666 669 28 c ortner a priori and a posteriori analysis of the quasinonlocal quasicontinuum method in 1 d mathematics of computation 80 2011 pp 1265 1285 29 c ortner and f theil justification of the cauchy born approximation of elastodynamics archive for rational mechanics and analysis 207 2013 pp 1025 1073 30 e prodan quantum transport in disordered systems under magnetic fields a study based on operator algebras applied mathematics research express 2013 2013 pp 176 265 31 x su and r de la llave a continuous family of equilibria in ferromagnetic media are ground states communications in mathematical physics 354 2017 pp 459 475 32 g a tritsaris s n shirodkar e kaxiras p cazeaux m luskin p plech and e canc s perturbation theory for weakly coupled two dimensional layers journal of materials research 31 2016 pp 959 966 33 b van koten and c ortner symmetries of 2 lattices and second order accuracy of the cauchy born model multiscale modeling simulation 11 2013 pp 615 634 34 m m van wijk a schuring m i katsnelson and a fasolino relaxation of moir patterns for slightly misaligned identical lattices graphene on graphite 2 d materials 2 2015 p 034010 35 v vitek intrinsic stacking faults in body centred cubic crystals philosophical magazine 18 1968 pp 773 786 36 m wen s carr s fang e kaxiras and e b tadmor dihedral angle corrected registry dependent interlayer potential for multilayer graphene structures physical review b 98 2018 p 235404 37 h yoo r engelke s carr s fang k zhang p cazeaux s h sung r hov den a w tsen t taniguchi k watanabe g c yi m kim m luskin e b tadmor e kaxiras and p kim atomic and electronic reconstruction at van der waals interface in twisted bilayer graphene arxiv preprint arxiv 1804 03806 2018 38 k zhang and e b tadmor energy and moir patterns in 2 d bilayers in translation and rotation a study using an efficient discrete continuum interlayer potential extreme mechanics letters 14 2017 pp 16 22 39 s zhou j han s dai j sun and d j srolovitz van der waals bilayer energetics generalized stacking fault energy of graphene boron nitride and graphene boron nitride bilayers physical review b 92 2015 p 155438 30 1 geometry of multi layered structures 1 1 notation 1 2 shifts and disregistry the hull for incommensurate stackings 2 elastic models of relaxation 2 1 atomistic kinematics 2 2 the atomistic energy 2 3 separation of intra and inter layer contributions 2 4 intra layer elastic energy 2 5 inter layer landscape the local disregistry 2 6 inter layer misfit energy 3 kinematics in configuration space and continuum approximation 3 1 continuum interpolant 3 2 evaluation of the gradient 3 3 modulated local disregistry 3 4 elastostatics model for multi layer heterostructures 4 analytical study and results bilayer case 4 1 the moir cell for bilayers 4 2 the space of admissible modulations 4 2 1 stability 4 2 2 smoothness 4 3 existence of local energy minimizers 4 4 asymptotic analysis 5 numerical study example of graphene bilayers appendix a proof of prop 3 2 references