ar x iv 1 60 7 03 69 0 v 1 m at h f a 1 3 ju l 20 16 a fast fourier transform for fractal approximations calvin hotchkiss and eric s weber abstract we consider finite approximations of a fractal generated by an iterated function system of affine transformations on rd as a discrete set of data points considering a signal supported on this finite approximation we propose a fast fractal fourier transform by choosing appropriately a second iterated function system to generate a set of frequencies for a collection of exponential functions supported on this finite approximation since both the data points of the fractal approximation and the frequencies of the exponential functions are generated by iterated function systems the matrix representing the discrete fourier transform dft satisfies certain recursion relations which we describe in terms of dit a s construction for large hadamard matrices these recursion relations allow for the dft matrix calculation to be reduced in complexity to o n logn as in the case of the classical fft 1 introduction the fast fourier transform fft is celebrated as a significant mathematical achievement see for example 1 the fft utilizes symmetries in the matrix representation of the discrete fourier transform dft 3 for 2 n equispaced data points on 0 1 the matrix representation of the dft is given by fn e 2 i jk 2 n jk where 0 j k 2 n the fft is obtained from the dft by a permutation of the columns of fn fn e 2 i j k 2 n jk for 0 j k 2 n where k 2 k 0 k 2 n 1 2 k 1 2 n 1 k 2 n the significance of the permutation is that the permuted matrix can be written in the fol lowing block form 1 fnp fn 1 dfn 1 fn 1 dfn 1 where d is a diagonal matrix this block form reduces the computational complexity of the associated matrix multiplication recursively fn 1 can be permuted and written in block form as well repeated application of the column permutation reduces the computational complexity further and results in overall complexity o n 2 n date july 14 2016 2000 mathematics subject classification primary secondary 1 http arxiv org abs 1607 03690 v 1 2 calvin hotchkiss and eric s weber we take the view in the present paper that the dft arises naturally in the context of iterated function systems and the fft arises as reordering of the iterated function system indeed consider the following set of generators 0 x x 2 1 x x 1 2 the invariant set of this ifs is the interval 0 1 and the invariant measure is lebesgue measure restricted to 0 1 consider the approximation for the invariant set given by sn jn 1 jn 2 j 1 j 0 0 jk 0 1 this is an approximation in the sense that 0 1 nsn but the significance for our purposes is that sn consists of 2 n equispaced points sn k 2 n k z 0 k 2 n define a second iterated function system generated by 0 x 2 x 1 x 2 x 1 since these are not contractions the ifs will not have a compact invariant set but we consider the finite orbits of 0 under this ifs just as before define tn jn 1 jn 2 j 1 j 0 0 jk 0 1 note that tn k k z 0 k 2 n with the inherited ordering on sn and tn from r say sn s 0 s 1 s 2 n 1 and tn t 0 t 1 t 2 n 1 we obtain fn e 2 itjsk jk for 0 k 2 n we write k n 1 n 0 jn 2 n with jn 0 1 then 2 jn 1 jn 2 j 0 0 k 2 n sk however 3 j 0 j 1 jn 1 0 k tk we define a new ordering on sn as follows 4 s k j 0 j 1 jn 1 0 where k is written in base 2 as we shall see in theorem 9 this new ordering on sn results in the following matrix equality 5 e 2 itj s k jk fnp as in equation 1 we will call the compositions in equations 3 and 4 the obverse ordering the compo sition in equation 2 will be called the reverse ordering as suggested previously and will be established in theorem 9 if the elements of sn and tn are both ordered with the obverse a fast fourier transform for fractal approximations 3 compositions then the permuted dft matrix obtained is as in equation 5 however if both sn and tn are ordered using the reverse compositions then the matrix becomes e 2 it jsk jk pfn fn 1 fn 1 fn 1 d fn 1 d a block form that will allow the inverse f 1 n to have a fast multiplication algorithm consider the measure n 1 2 n s sn s this sequence of measures converges weakly to lebesgue measure restricted to 0 1 the invariant measure for the ifs generated by 0 1 moreover we consider the exponential functions e 2 it t tn l 2 n this set will be an orthonormal basis and the dft is the matrix representation of this basis up to a scaling factor thus the ifs generated by 0 1 gives rise to a fractal and the ifs generated by 0 1 gives rise to the frequencies of an orthonormal set of exponentials a probability measure is spectral if there exists a set of frequencies r such that e 2 i l 2 is an orthonormal basis if the measure is spectral the set is called a spectrum for jorgensen and pederson 13 prove that the uniform measure supported on the middle thirds cantor set is not spectral however they prove that the invariant measure 4 for the iterated function system generated by 0 x x 4 1 x x 2 4 is spectral and moreover the spectrum is obtained via the iterated function system generated by 0 x 4 x 1 x 4 x 1 in fact the orbit of 0 under the iterated function system generated by 0 1 is a spectrum for 4 for a generic iterated function system 0 k 1 consisting of contractions on r d we will consider an approximation sn to the invariant set given by sn jn 1 jn 2 j 1 j 0 0 jk 0 1 k 1 this collection of points we will consider as the locations of data points we then will choose a second iterated function system 0 k 1 and consider the finite orbit of 0 tn jn 1 jn 2 j 1 j 0 0 jk 0 1 k 1 these will be the frequencies for an exponential basis in l 2 n where n 1 kn s sn s a necessary and sufficient condition to obtain an exponential basis for l 2 n from the frequencies in tn is that the matrix hn e 2 isjtk j k is invertible where sj and tk range through sn and tn under any ordering respectively preferably the matrix hn would be hadamard i e h nhn k nikn since it automatically has entries of modulus 1 since this would correspond to an orthogonal exponential basis as we will show if h 1 is invertible hadamard then all hn will be invertible hadamard respectively moreover we will put an ordering namely the obverse ordering on sn and tn so that under this ordering the matrix hn has a block form in the manner of dit a s construction for large hadamard matrices this block form will allow for the computational complexity of the matrix multiplication to be reduced then sn and tn will be reordered using the reverse 4 calvin hotchkiss and eric s weber ordering so that the inverse of hn will have a similar block form again allowing for a fast algorithm for the matrix multiplication we note that for a generic ifs the set sn will consist of irregularly spaced points we view the matrix hn as being a fourier transform for a signal or set of data points located at the points in sn and thus hn and its block form as shown in theorem 9 can be considered a non equispaced fft we further note however that this is not a full irregularly spaced fft since all of the data point locations in sn are rationally related please see 8 9 11 for the irregularly spaced fft 1 1 dit a s construction of large hadamard matrices dit a s construction for large hadamard matrices is as follows 4 15 if a is a k k hadamard matrix b is an m m hadamard matrix and e 1 ek 1 are m m unitary diagonal matrices then the km km block matrix h is a hadamard matrix 6 h a 00 b a 01 e 1 b a 0 k 1 ek 1 b a 10 b a 11 e 1 b a 1 k 1 ek 1 b a k 1 0 b a k 1 1 e 1 b a k 1 k 1 ek 1 b since we will also consider invertible matrices not just hadamard matrices we show that for a b e 1 ek 1 invertible h will also be invertible and its inverse has a similar block form proposition 1 suppose a and b are invertible e 1 ek 1 are invertible and diagonal let c a 1 for the matrix h in equation 6 7 h 1 c 00 b 1 c 01 b 1 c 0 k 1 b 1 c 10 b 1 e 11 c 11 b 1 e 11 c 1 k 1 b 1 e 11 c k 1 0 b 1 e 1 k 1 c 1 k 1 b 1 e 1 k 1 c k 1 k 1 b 1 e 1 k 1 proof let g be the block matrix in equation 7 and let e 0 im note that the product of h and g will have a block form multiplying the j th row of h with the th column of g we obtain that the j block of hg is k 1 k 0 ajkekb ck b 1 e 1 k k 1 k 0 ajkck im since k 1 k 0 ajkck j we obtain hg ikm if a b 0 bk 1 e 1 ek 1 are all unitary then the construction for h 1 gives h so h is also unitary 1 2 complexity of matrix multiplication in dit a s construction let v be a vector of length km consider h v where h is the block matrix as in equation 6 we divide the a fast fourier transform for fractal approximations 5 vector v into k vectors of length m as follows v v 0 v 1 vk 1 then the matrix multiplication h v can be reduced in complexity since h v k 1 j 0 a 0 jejb v 0 k 1 j 0 a 1 jejb v 1 k 1 j 0 a k 1 jejb vk 1 let om be the number of operations required to multiply the a vector w of length m by the matrix b the total number of operations required for each component of h v is om m k 1 mk multiplications and m k 1 additions the total number of operations for h v is then kom 3 mk 2 2 mk we have just established the following proposition proposition 2 the product h v requires at most kom 3 mk 2 2 mk operations since om o m 2 we obtain that the computational complexity ofh is o m 2 k mk 2 whereas for a generic km km matrix the computational complexity is o k 2 m 2 thus the block form of h reduces the computational complexity of the matrix multiplication 2 a fast fourier transform on sn we consider an iterated function system generated by contractions 0 1 k 1 on r d of the following form j x a x bj where a is a d d invertible matrix with a 1 we require a 1 to have integer entries the vectors bj z d and without loss of generality we suppose b 0 0 we then choose a second iterated function system generated by 0 1 k 1 of the form j x bx cj where b at 1 with cj z d and c 0 0 we require the matrix m 1 e 2 i cj a bk j k be invertible or hadamard note that depending on a and b 0 b 1 bk 1 there may not be any choice c 0 c 1 ck 1 so that m 1 is invertible however for many ifs s there is a choice proposition 3 if the set b 0 b 1 bk 1 is such that for every pair j 6 k a bj a bk z d then there exists c 0 c 1 ck 1 such that the matrix m 1 is invertible proof the mappings 1 x 7 e 2 i x a bj and 2 x 7 e 2 i x a bk are characters on g z d bzd since a bj a bk z d the characters are distinct thus by schur orthogonality 6 calvin hotchkiss and eric s weber x g 1 x 2 x 0 therefore the matrix m e 2 i xk a bj j k where xk is any enu meration of g has orthogonal columns thus there is a choice of a square submatrix of m which is invertible even under the hypotheses of proposition 3 there is not always a choice of c s so that m 1 is hadamard this is the case for the middle third cantor set which is the attractor set for the ifs generated by 0 x x 3 1 x x 2 3 and is a reflection of the fact that 3 is not spectral notation 1 we define our notation for compositions of the ifs s using two distinct order ings let n n for j 0 1 kn 1 write j j 0 j 1 k jn 1 k n 1 with j 0 jn 1 0 1 k 1 we define j n j 0 j 1 jn 1 rj n j 0 j 1 jn 1 these give rise to enumerations of sn and tn as follows sn j n 0 j 0 1 k n 1 tn rj n 0 j 0 1 k n 1 we call these the obverse orderings of sn and tn likewise we define j n jn 1 jn 2 j 0 r j n jn 1 jn 2 j 0 which also enumerate sn and tn we call these the reverse orderings remark 1 note that for n 1 j 1 j 1 and rj 1 r j 1 we define the matrices mn and m n as follows mn jk e 2 irj n 0 k n 0 and m n jk e 2 ir j n 0 k n 0 both of these are the matrix representations of the exponential functions with frequencies given by tn on the data points given by sn the matrix mn corresponds to the obverse ordering on both tn and sn whereas the matrix m n corresponds to the reverse ordering on both since these matrices arise from different orderings of the same sets there exist permutation matrices p and q such that 8 qm np mn indeed define for j 0 kn 1 a conjugate as follows if j j 0 j 1 k jn 1 k n 1 let j jn 1 jn 2 k j 0 k n 1 note then that j j and 9 k n k n r k n rk n now define a kn kn permutation matrix p by p mn 1 if n m and 0 otherwise lemma 4 for p defined above pm np mn a fast fourier transform for fractal approximations 7 proof we calculate pm np mn k p mk m n k p n p mm m n m n p n n e 2 ir m n 0 n n 0 e 2 irm n 0 n n 0 mn mn by virtue of equation 9 proposition 5 for scale n 1 m 1 m 1 1 1 1 1 exp 2 i c 1 a b 1 exp 2 i c 1 a bk 1 1 exp 2 i ck 1 a b 1 exp 2 i ck 1 a bk 1 proof the proof follows from remark 1 lemma 6 for n n 0 j kn and x y rd i j n x y j n x a n y ii j n x y j n x a n y iii rj n x y rj n x b n y iv r j n x y r j n x b n y proof we prove by induction on n the base case is easily checked assume the equality in item i holds for n 1 for j j 0 j 1 k jn 1 k n 1 let j jn 1 k n 1 we have j n x y n 1 jn 1 x y n 1 jn 1 x a y n 1 jn 1 x a n 1 a y j n x a n y the proofs for the other three identities are analogous lemma 7 for n n and 0 j kn i j n 0 a n z for some z zd ii j n 0 a n z for some z zd iii rj n 0 z d iv r j n 0 z d proof we prove by induction on n the base case is easily checked assume the equality in item i holds for n 1 for j j 0 j 1 k jn 1 k n 1 let qj j jn 1 k n 1 we have j n 0 jn 1 qj n 1 0 a an 1 z bj an z a n 1 bj 8 calvin hotchkiss and eric s weber since a 1 is an integer matrix so is a n 1 and thus z a n 1 bj z d item ii is analogous for item iii note first that j z d zd so by induction j 0 jn 1 0 z d likewise for item iv lemma 8 assume n 2 let be an integer between 0 and k 1 and suppose l kn 1 j l 1 kn 1 then i j n 0 j l kn 1 n 1 0 a n bl ii j n 0 a j l kn 1 n 1 0 a bl iii rj n 0 rj l kn 1 n 1 0 b n 1 cl iv r j n 0 br j l kn 1 n 1 0 cl proof for l kn 1 j l 1 kn 1 jn 1 l so we have j n 0 j 0 j 1 jn 2 l 0 j 0 j 1 jn 2 a 0 bl j l kn 1 n 1 0 a bl applying lemma 6 item i to j l kn 1 n 1 j l kn 1 n 1 0 a bl j l kn 1 n 1 0 a n 1 a bl the proof of item iii is similar to item i with one crucial distinction so we include the proof here we have rj n 0 j 0 j 1 jn 2 l 0 j 0 j 1 jn 2 b 0 cl rj l kn 1 n 1 0 cl applying lemma 6 item iii to rj l kn 1 n 1 rj l kn 1 n 1 0 cl rj l kn 1 n 1 0 b n 1 cl for item ii we have j n 0 j kn 1 n 1 0 a j kn 1 n 1 0 a b the proof of item iv is analogous note that in item i the extra term involves an whereas in item iii the extra term involves bn 1 we are now in a position to prove our main theorem theorem 9 the matrix mn representing the exponentials with frequencies given by tn on the fractal approximation sn when both are endowed with the obverse ordering has the form 10 mn m 00 mn 1 m 01 dn 1 mn 1 m 0 k 1 dn k 1 mn 1 m 10 mn 1 m 11 dn 1 mn 1 m 1 k 1 dn k 1 mn 1 m k 1 0 mn 1 m k 1 1 dn 1 mn 1 m k 1 k 1 dn k 1 mn 1 here dn m are diagonal matrices with dn m pp e 2 irp n 1 0 a n bm and mjk m 1 jk a fast fourier transform for fractal approximations 9 proof let us first subdivide mn into blocks b m of size k n 1 kn 1 so that mn b 00 b 0 k 1 b k 1 0 b k 1 k 1 fix 0 j k kn and suppose kn 1 j 1 kn 1 and mkn 1 k m 1 kn 1 with 0 m k let qj j k n 1 and qk k mk n 1 observe that 11 mn jk b m qjqk using lemma 8 items ii and iv we calculate rj n 0 k n 0 rqj n 1 0 b n 1 c qk n 1 0 a n bm by lemma 7 item i for some z zd bn 1 c qk n 1 0 b n 1 c a n 1 z c z z note that bn 1 c a n bm c a bm therefore combining the above we obtain mn jk e 2 irj n 0 k n 0 e 2 irqj n 1 0 qk n 1 0 e 2 irqj n 1 0 a n bme 2 i c a bm mn 1 qjqke 2 irqj n 1 0 a n bm m 1 m 12 letting j vary between kn 1 and 1 kn 1 and k vary between mkn 1 and m 1 kn 1 corresponds to qj and qk varying between 0 and k n 1 therefore we obtain from equations 11 and 12 the matrix equation b m m 1 mdn mmn 1 where dn m pp e 2 irp n 1 0 a n bm as claimed corollary 10 the matrixmn is invertible ifm 1 is hadamard thenmn is also hadamard proof if m 1 is invertible then by induction mn is invertible via proposition 1 if m 1 is hadamard then again by induction mn is hadamard by dit a s construction theorem 11 the matrix m n representing the exponentials with frequencies given by tn on the fractal approximation sn when both are endowed with the reverse ordering has the form 13 m n m 00 m n 1 m 01 m n 1 m 0 k 1 m n 1 m 10 m n 1 d n 1 m 11 m n 1 d n 1 m 1 k 1 m n 1 d n 1 m k 1 0 m n 1 d n k 1 m k 1 1 m n 1 d n k 1 m k 1 k 1 m n 1 d n k 1 here d n q is a diagonal matrix with d n pp e 2 ic a p n 1 0 and mjk m 1 jk 10 calvin hotchkiss and eric s weber proof the proof proceeds similarly to the proof theorem 9 let us first subdivide m n into kn 1 kn 1 blocks b m so that m n b 00 b 0 k 1 b k 1 0 b k 1 k 1 fix 0 j k kn and suppose kn 1 j 1 kn 1 and mkn 1 k m 1 kn 1 with 0 m k let qj j k n 1 and qk k mk n 1 observe that 14 m n jk b m qjqk we calculate using lemma 8 items ii and iv r j n 0 k n 0 br qj n 1 0 c a qk n 1 0 a bm r qj n 1 0 qk n 1 0 c a qk n 1 0 r qj n 1 0 bm c a bm by lemma 7 item iv r qj n 1 0 bm z thus b m qjqk mn 1 qjqke 2 i c a qk n 1 0 m 1 m and as in the proof of theorem 9 we have b m m 1 mm n 1 d n 2 1 computational complexity of theorems 9 and 11 as a consequence of proposi tion 2 the matrix mn can be multiplied by a vector of dimension k n in at most kpn 1 3 kn 1 2 kn operations where pn 1 is the number of operations required by the matrix multiplication for mn 1 since mn 1 has the same block form as mn pn 1 can be deter mined by pn 2 etc the proof of the following proposition is a standard induction argument which we omit note that this says that the computational complexity formn is comparable to that for the fft recognizing the difference in the number of generators for the respective ifs s proposition 12 the number of operations to calculate the matrix multiplication mn v is pn k n 1 p 1 3 n 1 k n 1 2 n 1 kn consequently pn o n k n the significance of theorem 11 concerns the inverse of mn if p is the permutation matrix as in lemma 4 then m 1 n pm 1 n p by proposition 1 m 1 n has the form of dit a s construction and so the computational complexity of m 1 n is the same asmn thus modulo multiplication by the permutation matrices p the computational complexity of multiplication by m 1 n is the same as that for mn a fast fourier transform for fractal approximations 11 2 2 the diagonal matrices the matrices mn and m n have the form of dit a s construc tion as shown in theorems 9 and 11 the block form of dit a s construction involves diagonal matrices which in equations 10 and 13 are determined by the ifs s used to generate the matrices mn and m n as such the diagonal matrices satisfy certain recurrence relations theorem 13 the diagonal matrices which appear in the block form of mn equation 10 satisfy the recurrence relation dn m dn 1 m en m where en m is the k k diagonal matrix with en m uu e 2 icu a n bm that is dn m pp dn 1 m p p e 2 i cp 0 a n bm where p p p 0 k likewise the diagonal matrices which appear in the block form of m n equation 13 satisfy the recurrence relation d n d n 1 e n where e n is the k k diagonal matrix with e n uu e 2 i c a n bu that is d n pp dn 1 p p e 2 i c a n bp 0 proof as demonstrated in theorem 9 for p 0 1 kn 1 dn m pp e 2 irp n 1 0 a n bm note that pn 1 0 and 0 0 0 we want to cancel one power of a in a n bm so we factor out a b from rp n 1 0 rp n 1 0 p 0 p 1 pn 2 0 b p 1 pn 2 0 cp 0 since p p 1 p 2 k pn 2 k n 3 rp n 1 0 brp n 2 0 cp 0 thus dn m pp e 2 irp n 1 0 a n bm e 2 i brp n 2 0 a a n 1 bm e 2 i cp 0 a n bm e 2 i rp n 2 0 a n 1 bm e 2 i cp 0 a n bm dn 1 m p p e 2 i cp 0 a n bm similarly as demonstrated in theorem 11 d n pp e 2 i c a p n 1 0 we write p n 1 0 pn 2 pn 3 p 1 p 0 0 pn 2 pn 3 p 1 0 a bp 0 p n 2 0 a bp 0 p n 2 0 a n 1 bp 0 where in the last equality we use lemma 6 item ii therefore d n pp e 2 ic a p n 1 0 e 2 i c a p n 2 0 a n 1 bp 0 e 2 i c a p n 2 0 a n bp 0 e 2 i c a p n 2 0 e 2 i c a n bp 0 d n 1 p p e 2 i c a n bp 0 12 calvin hotchkiss and eric s weber references 1 l auslander and r tolimieri is computing with the finite fourier transform pure or applied mathemat ics bull amer math soc n s 1 1979 no 6 847 897 mr 546312 81 e 42020 2 teodor banica quantum permutations hadamard matrices and the search for matrix models banach center publ 98 2012 11 42 3 james w cooley and john w tukey an algorithm for the machine calculation of complex fourier series math comp 19 1965 297 301 mr 0178586 31 2843 4 p dit a some results on the parametrization of complex hadamard matrices j phys a 37 2004 no 20 5355 5374 mr 2065675 2005 b 15045 5 dorin ervin dutkay deguang han and qiyu sun on the spectra of a cantor measure adv math 221 2009 no 1 251 276 mr mr 2509326 6 dorin ervin dutkay john hausserman and eric weber spectral properties of small hadamard matrices preprint 2014 7 dorin ervin dutkay and palle e t jorgensen fourier frequencies in affine iterated function systems j funct anal 247 2007 no 1 110 137 mr mr 2319756 2008 f 42007 8 a dutt and v rokhlin fast fourier transforms for nonequispaced data siam j sci comput 14 1993 no 6 1368 1393 mr 1241591 95 d 65114 9 fast fourier transforms for nonequispaced data ii appl comput harmon anal 2 1995 no 1 85 100 mr 1313101 95 m 65222 10 kenneth falconer fractal geometry johnwiley sons ltd chichester 1990 mathematical foundations and applications mr mr 1102677 92 j 28008 11 leslie greengard and june yub lee accelerating the nonuniform fast fourier transform siam rev 46 2004 no 3 443 454 mr 2115056 2006 g 65222 12 john e hutchinson fractals and self similarity indiana univ math j 30 1981 no 5 713 747 mr mr 625600 82 h 49026 13 palle e t jorgensen and steen pedersen dense analytic subspaces in fractal l 2 spaces j anal math 75 1998 185 228 mr mr 1655831 2000 a 46045 14 james h mcclellan and thomas w parks eigenvalue and eigenvector decomposition of the discrete fourier transform ieee trans audio electroacoust au 20 1972 no 1 66 74 mr 0399751 53 3593 15 wojciech tadej and karol z yczkowski a concise guide to complex hadamard matrices open syst inf dyn 13 2006 no 2 133 177 mr 2244963 2007 f 15020 department of mathematics iowa state university 396 carver hall ames ia 50011 e mail address hotchkis iastate edu e mail address esweber iastate edu 1 introduction 1 1 dita s construction of large hadamard matrices 1 2 complexity of matrix multiplication in dita s construction 2 a fast fourier transform on sn 2 1 computational complexity of theorems and 2 2 the diagonal matrices references