ar x iv 1 50 9 03 76 1 v 1 m at h c a 1 2 s ep 2 01 5 haar bases on quasi metric measure spaces and dyadic structure theorems for function spaces on product spaces of homogeneous type anna kairema ji li m cristina pereyra and lesley a ward abstract we give an explicit construction of haar functions associated to a system of dyadic cubes in a geometrically doubling quasi metric space equipped with a positive borel measure and show that these haar functions form a basis for lp next we focus on spaces x of homogeneous type in the sense of coifman and weiss where we use these haar functions to define a discrete square function and hence to define dyadic versions of the function spaces h 1 x and bmo x in the setting of product spaces x x 1 xn of homogeneous type we show that the space bmo x of functions of bounded mean oscillation on x can be written as the intersection of finitely many dyadic bmo spaces on x and similarly for ap x reverse h lder weights on x and doubling weights on x we also establish that the hardy space h 1 x is a sum of finitely many dyadic hardy spaces on x and that the strong maximal function on x is pointwise comparable to the sum of finitely many dyadic strong maximal functions these dyadic structure theorems generalize to product spaces of homogeneous type the earlier euclidean analogues for bmo and h 1 due to mei and to li pipher and ward contents 1 introduction 1 2 systems of dyadic cubes 4 3 dyadic structure theorems for maximal functions and for weights 7 4 explicit construction of haar functions and completeness 13 5 definitions and duality of dyadic h 1 d x and dyadic bmod x 20 6 dyadic structure theorems for h 1 x and bmo x 29 references 35 1 introduction this paper has three main components 1 the explicit construction of a haar basis asso ciated to a system of dyadic cubes on a geometrically doubling quasi metric space equipped with a positive borel measure 2 definitions of dyadic product function spaces by means of this haar basis on product spaces of homogeneous type in the sense of coifman and weiss date november 16 2021 2000 mathematics subject classification primary 42 b 35 secondary 42 c 40 30 l 99 42 b 30 42 b 25 key words and phrases metric measure spaces haar functions spaces of homogeneous type bmo function spaces quasi metric spaces doubling weights ap weights reverse h lder weights hardy space maximal function carleson measures dyadic function spaces the second and fourth authors were supported by the australian research council grant no arc dp 120100399 part of the results in this paper was done during the second author s working in sun yat sen university supported by the nnsf of china grant no 11001275 by a china postdoctoral science foundation funded project grant no 201104383 and by the fundamental research funds for the central universities grant no 11 lgpy 56 1 http arxiv org abs 1509 03761 v 1 2 anna kairema ji li m cristina pereyra and lesley a ward and 3 dyadic structure theorems relating the continuous and dyadic versions of these func tion spaces on product spaces of homogeneous type we describe these components in more detail below the function spaces we deal with in this paper are the hardy space h 1 the space bmo of functions of bounded mean oscillation and the classes of muckenhoupt ap weights reverse h lder weights and doubling weights much of the theory of these function spaces can be found in joni fs gcrf and ste here we are concerned with generalising the dyadic structure theorems established for euclidean underlying spaces in lpw and mei a central theme in modern harmonic analysis has been the drive to extend the calder n zygmund theory from the euclidean setting namely where the underlying space is rn with the euclidean metric and lebesgue measure to more general settings to this end coifman and weiss formulated the concept of spaces of homogeneous type in cw 71 specifically by a space x of homogeneous type in the sense of coifman and weiss we mean a set x equipped with a quasi metric and a borel measure that is doubling there is a large literature devoted to spaces of homogeneous type in both their one parameter and more recently multiparameter forms see for example cw 71 cw 77 ms djs h 94 hs h 98 abi 07 dh hll clw and ah some non euclidean examples of spaces of homogeneous type are given by the carnot carath odory spaces whose theory is developed by nagel stein and others in ns 04 ns 06 and related papers there the quasi metric is defined in terms of vector fields satisfying the h rmander condition on an underlying manifold meyer noted in his preface to dh that one is amazed by the dramatic changes that occurred in analysis during the twentieth century in the 1930 s complex methods and fourier series played a seminal role after many improvements mostly achieved by the calder n zygmund school the action takes place today on spaces of homogeneous type no group structure is available the fourier transform is missing but a version of harmonic analysis is still present indeed the geometry is conducting the analysis when we go beyond the euclidean world and attempt to prove our dyadic structure theo rems in the setting of spaces of homogeneous type we immediately encounter the following two obstacles first the euclidean proofs rely on the so called one third trick which says in effect that each ball is contained in some cube whose measure is uniformly comparable to that of the ball and which belongs either to the usual dyadic lattice or to a fixed translate of the dyadic lattice however in a space of homogeneous type there is no notion of translation second in the euclidean proofs one uses a definition of dyadic function spaces in terms of the haar coefficients however the theory of haar bases on spaces of homogeneous type is not fully developed in the literature in the present paper we overcome the first obstacle by means of the adjacent systems of dyadic cubes constructed by the first author and hyt nen in hk and the second obstacle by our full development of an explicit construction of haar bases for lp in a setting somewhat more general than that of spaces of homogeneous type we now describe in more detail the three main components of this paper listed at the start of the introduction 1 we include in this paper a detailed construction of a haar basis associated to a system of dyadic cubes on a geometrically doubling quasi metric space equipped with a positive borel measure the geometric doubling condition says that each ball can be covered by a uniformly bounded number of balls of half the radius of the original ball this setting is somewhat more general than that of spaces of homogeneous type in the sense of coifman and weiss although such bases have been discussed in the existing literature see below to our knowledge a full construction has not appeared before we believe that such bases will also be useful for other purposes beyond the definitions of dyadic function spaces for which they are used in this paper haar type bases for l 2 x have been constructed in general metric spaces and the construction is well known to experts haar type wavelets associated to nested partitions in haar bases and dyadic structure theorems 3 abstract measure spaces are provided by girardi and sweldens gs such haar functions are also used in nrv in geometrically doubling metric spaces for the case of spaces of homogeneous type we refer to the papers by aimar et al aim abi 07 ag see also abi 05 abn 11 a abn 11 b for related results in the present paper the context is a slightly more general geometrically doubling quasi metric space x with a positive borel measure our approach differs from that of the mentioned prior results and it uses results from general martingale theory we provide the details noting that essentially the same construction can be found for example in hyt chapter 4 in the case of euclidean space with the usual dyadic cubes and a non doubling measure 2 it is necessary to develop in the setting of product spaces x of homogeneous type careful definitions of the continuous and dyadic versions of the function spaces we consider in the euclidean setting the theory of product bmo and h 1 was developed by chang and r fefferman in the continuous case cha fef cf and by bernard in the dyadic case ber we recall that x is a space of homogeneous type in the sense of coifman and weiss if is a quasi metric and is a nonzero measure satisfying the doubling condition a quasi metric x x 0 satisfies i x y y x 0 for all x y x ii x y 0 if and only if x y and iii the quasi triangle inequality there is a constant a 0 1 such that for all x y z x x y a 0 x z z y 1 1 in contrast to a metric the quasi metric may not be h lder regular and quasi metric balls may not be open see for example hk p 5 a nonzero measure satisfies the doubling condition if there is a constant c such that for all x x and all r 0 b x 2 r c b x r 1 2 we do not impose any assumptions about regularity of the quasi metric nor any additional properties of the measure as shown in cw 71 spaces of homogeneous type are geometrically doubling thus our construction of the haar basis is valid on x we denote the product of such spaces by x x 1 xn with the product quasi metric 1 n and the product measure 1 n the task of defining our function spaces on the product space x is straightforward for ap rhp and doubling weights as in the euclidean case the product weights on x are simply those weights that have the one parameter ap rhp or doubling property in each factor and lebesgue measure is replaced by the borel measure the situation is more delicate for h 1 and bmo for the continuous versions we use the definition from hlw of h 1 x via a square function that makes use of the orthonormal wavelet bases developed in ah for spaces of homogeneous type in the sense of coifman and weiss we define bmo x in terms of summation conditions on the ah wavelet coefficients as is shown in hlw these definitions yield the expected hardy space theory and the duality relation between h 1 x and bmo x for the dyadic versions of h 1 and bmo on x we replace the ah wavelets in these definitions by a basis of haar wavelets constructed in the present paper associated to a given system of dyadic cubes as constructed in hk 3 in this paper we show that on product spaces x of homogeneous type in the sense of coifman and weiss the space bmo of functions of bounded mean oscillation coincides with the intersection of finitely many dyadic bmo spaces the product euclidean version of this result appears in lpw the one parameter euclidean version in mei and the one parameter version for spaces x of homogeneous type in hk in addition generalizing the euclidean results of lpw we establish the analogous intersection results for muckenhoupt s ap weights ap x 1 p for the reverse h lder weights rhp x 1 p and 4 anna kairema ji li m cristina pereyra and lesley a ward for the class of doubling weights on x the result that the hardy space h 1 x is the sum of finitely many dyadic hardy spaces on x the result that the strong maximal function on x is comparable to the sum of finitely many dyadic maximal functions on x we note that our methods should suffice to establish the generalizations to spaces of homogeneous type of the weighted dyadic structure results in lpw namely theorem 8 1 for product h 1 weighted by an a weight and theorem 8 2 for the strong maximal function weighted by a doubling weight we leave it to the interested reader to pursue this direction we note that in a different direction not pursued in the present paper a connection between continuous and dyadic function spaces via averaging is developed in the papers gj war pw tre pwx and clw for both euclidean spaces and spaces of homogeneous type specifically a procedure of translation averaging for bmo or geometric arithmetic averaging for ap rhp and doubling weights converts a suitable family of functions in the dyadic version of a function space into a single function that belongs to the continuous version of that function space we do not discuss the averaging approach further in the present paper this paper is organized as follows in section 2 we first recall the definition of systems of dyadic cubes and the related properties of those cubes next we recall the result of hyt nen and the first author see theorem 2 7 on the existence of a collection of adjacent systems of dyadic cubes which provides a substitute in the setting of spaces of homogeneous type for the one third trick in the euclidean setting in section 3 we prove our dyadic structure results for the ap rhp and doubling weights as well as for maximal functions in section 4 we construct the haar functions on a geometrically doubling quasi metric space x equipped with a positive borel measure theorem 4 8 then we prove that the haar wavelet expansion holds on lp x for all p 1 theorem 4 9 in section 5 we recall the definitions of the continuous product hardy and bmo spaces from hlw and provide the definitions of the dyadic product hardy and bmo spaces by means of the haar wavelets we have constructed in section 6 we establish the dyadic structure theorems for the continuous and dyadic product hardy and bmo spaces theorems 6 1 and 6 2 by proving the dyadic atomic decomposition for the dyadic product hardy spaces theorem 6 5 2 systems of dyadic cubes the set up for section 2 is a geometrically doubling quasi metric space a quasi metric space x that satisfies the geometric doubling property that there exists a positive integer a 1 n such that any open ball b x r y x x y r of radius r 0 can be covered by at most a 1 balls b xi r 2 of radius r 2 by a quasi metric we mean a mapping x x 0 that satisfies the axioms of a metric except for the triangle inequality which is assumed in the weaker form x y a 0 x z z y for all x y z x with a constant a 0 1 a subset x is open in the topology induced by if for every x there exists 0 such that b x a subset f x is closed if its complement x f is open the usual proof of the fact that f x is closed if and only if it contains its limit points carries over to the quasi metric spaces however some open balls b x r may fail to be open sets see hk sec 2 1 constants that depend only on a 0 the quasi metric constant and a 1 the geometric doubling constant are referred to as geometric constants haar bases and dyadic structure theorems 5 2 1 a system of dyadic cubes in a geometrically doubling quasi metric space x a countable family d k z dk dk q k ak of borel sets qk x is called a system of dyadic cubes with parameters 0 1 and 0 c 1 c 1 if it has the following properties 2 1 x ak qk disjoint union for all k z 2 2 if k then either q q k or q k q 2 3 for each k and each k there exists a unique such that qk q for each k there exist between 1 and m a fixed geometric constant such that qk 1 q k and q k q dk 1 q qk q 2 4 2 5 b xk c 1 k qk b x k c 1 k b qk 2 6 if k and q q k then b q b q k the set qk is called a dyadic cube of generation k with center point x k q k and side length k the interior and closure of qk are denoted by q k and q k respectively we recall from hk the following construction which is a slight elaboration of seminal work by m christ chr as well as sawyer wheeden sw theorem 2 1 let x be a geometrically doubling quasi metric space then there exists a system of dyadic cubes with parameters 0 12 a 30 1 and c 1 3 a 2 0 1 c 1 2 a 0 the construction only depends on some fixed set of countably many center points xk having the properties that xk x k k 6 min x xk k for all x x and a certain partial order among their index pairs k in fact this system can be constructed in such a way that 2 7 q k x k and 2 8 q k intq k 6 q k c and 2 9 q k q k q k where qk are obtained from the closed sets q k and the open sets q k by finitely many set operations remark 2 2 the proof in hk shows that the first and the second inclusion in 2 5 hold with qk replaced by q k and q k respectively we mention that for any q d the number m of dyadic sub cubes as in 2 4 is bounded by m a 21 a 0 log 2 a 1 6 anna kairema ji li m cristina pereyra and lesley a ward 2 2 further properties of dyadic cubes the following additional properties follow di rectly from the properties listed in 2 1 2 6 x is bounded if and only if there exists q d such that x q 2 10 for every x x and k z there exists a unique q dk such that 2 11 x q qk x x x is an isolated point if and only if there exists k z such that x q x 2 12 for all k 2 3 dyadic system with a distinguished center point the construction of dyadic cubes requires their center points and an associated partial order be fixed a priori however if either the center points or the partial order is not given their existence already follows from the assumptions any given system of points and partial order can be used as a starting point moreover if we are allowed to choose the center points for the cubes the collection can be chosen to satisfy the additional property that a fixed point becomes a center point at all levels given a fixed point x 0 x for every k z there exists such that x 0 x k the center point of q k dk 2 13 this property is crucial in some applications and has useful implications such as the follow ing lemma 2 3 given x y x there exists k z such that y qk x moreover if x y k then y qk 1 x in particular if x y 0 there do not exist arbitrarily large indices k such that y qk x proof pick k z such that x y b x 0 c 1 k the first assertion follows from 2 5 for the qk that has x 0 as a center point for the second assertion suppose x y k denote by xk 1 the center point of q k 1 x then y xk 1 a 1 0 x y x x k 1 a 1 0 k c 1 k 1 c 1 k 1 since 12 a 30 1 and c 1 2 a 0 showing that y q k 1 x lemma 2 4 suppose and are non trivial positive borel measures on x and a x is a measurable set with a 0 then there exists a dyadic cube q d such that q 0 and a q 0 in particular if x is a quasi metric measure space e x is a set with e 0 and x x then there exists a dyadic cube q such that x q and e q 0 proof for k z consider the sets bk b x 0 c 1 k and ak a bk first observe that bk 0 for k k 0 and ak 0 for k k 1 indeed x k 1 bk and b 1 b 2 so that 0 x limk bk similarly a k 1 ak and a 1 a 2 so that 0 a limk ak set k max k 0 k 1 and let q d be the dyadic cube of generation k centred at x 0 then bk q by 2 5 and it follows that q bk 0 and a q a bk ak 0 we will need the following consequence of 2 13 lemma 2 5 for any x x qk x x as k proof given x x pick k z such that x b x 0 c 1 k where x 0 x is as in 2 13 then x qk where qk is the dyadic cube in dk with center point x 0 the assertion follows by qk b x 0 c 1 k x as k haar bases and dyadic structure theorems 7 remark 2 6 note that the usual euclidean dyadic cubes of the form 2 k 0 1 n m k z m zn in rn do not have the property 2 13 and that lemmata 2 3 2 4 and 2 5 depend on this property a simple example of a system with a distinguished center point using triadic rather than dyadic intervals is as follows in the real line divide each interval n n 1 n z into three triadic intervals of equal length divide each of these intervals in three and so on now require that the parent interval of 0 1 is 1 2 so that 0 1 is the middle third of its parent interval similarly require that the parent interval of 1 2 is 4 5 and so on then the point x 0 1 2 is a distinguished center point for this system 2 4 adjacent systems of dyadic cubes in a geometrically doubling quasi metric space x a finite collection d t t 1 2 t of families d t is called a collection of adjacent systems of dyadic cubes with parameters 0 1 0 c 1 c 1 and 1 c if it has the following properties individually each d t is a system of dyadic cubes with parameters 0 1 and 0 c 1 c 1 collectively for each ball b x r x with k 3 r k 2 k z there exist t 1 2 t and q d t of generation k and with center point txk such that x txk 2 a 0 k and 2 14 b x r q b x cr we recall from hk the following construction theorem 2 7 let x be a geometrically doubling quasi metric space then there exists a collection d t t 1 2 t of adjacent systems of dyadic cubes with parameters 0 96 a 60 1 c 1 12 a 4 0 1 c 1 4 a 2 0 and c 8 a 3 0 3 the center points txk of the cubes q d tk have for each t 1 2 t the two properties txk txk 4 a 2 0 1 k 6 min x txk 2 a 0 k for all x x moreover these adjacent systems can be constructed in such a way that each d t satisfies the distinguished center point property 2 13 remark 2 8 for t the number of the adjacent systems of dyadic cubes we have the estimate 2 15 t t a 0 a 1 a 6 1 a 4 0 log 2 a 1 note that in the euclidean space rn with the usual structure we have a 0 1 a 1 2 n and 1 2 so that 2 15 yields an upper bound of order 27 n we mention that t mei mei has shown that in rn the conclusion 2 14 can be obtained with just n 1 cleverly chosen systems d t further we have the following result on the smallness of the boundary proposition 2 9 suppose that 144 a 80 1 let be a positive finite measure on x then the collection d t t 1 2 t may be chosen to have the additional property that q 0 for all q t t 1 d t 3 dyadic structure theorems for maximal functions and for weights in this section we establish that in the setting of product spaces of homogeneous type the strong maximal function is pointwise comparable to a sum of finitely many dyadic maximal functions and that the strong ap class is the intersection of finitely many dyadic ap classes and similarly for reverse h lder weights rhp and for doubling measures 8 anna kairema ji li m cristina pereyra and lesley a ward 3 1 maximal functions let x be a space of homogenenous type and let d t t 1 t be a collection of adjacent systems of dyadic cubes in x as in theorem 2 1 similarly for each j 1 k let xj j j be a space of homogeneous type with an associated collection of adjacent systems of dyadic cubes d tj tj 1 tj let x x 1 xk with the product quasi metric 1 k and the product measure 1 k theorem 3 1 the maximal function m or strong maximal function ms in the product case controls each dyadic maximal function pointwise and is itself controlled pointwise by a sum of dyadic maximal functions as follows i let x be a space of homogeneous type then there is a constant c 0 such that for each f l 1 loc x and for all x x we have the pointwise estimates m tdf x cmf x for each t 1 t and mf x c t t 1 m tdf x ii let xj j j j 1 k be spaces of homogeneous type then there is a constant c 0 such that for each f l 1 loc x m t 1 tk d f x cmsf x for each tj 1 tj j 1 k and msf x c t 1 t 1 1 tk tk 1 m t 1 tk d f x these maximal operators are defined as follows for f l 1 loc x let mf denote the hardy littlewood maximal function given by mf x sup b x 1 b b f y d y where the supremum is taken over all balls b x that contain x for each t 1 t denote by m tdf the dyadic maximal function with respect to the system d t of dyadic cubes in x here the supremum is taken over only those dyadic cubes q d t that contain x in the multiparameter case instead of the hardy littlewood maximal function we consider the strong maximal function msf defined as follows take x x 1 xk x and f l 1 loc x 1 k let msf x sup b 1 bk x 1 k j 1 j bj b 1 bk f y d 1 y 1 d k yk 3 1 where y y 1 yk and the supremum is taken over all products b 1 bk of balls bj xj bj xj for j 1 k next for each choice of tj 1 tj for j 1 k let m t 1 tk d f denote the associated dyadic strong maximal function defined by m t 1 tk d f x sup q 1 qk x 1 k j 1 j qj q 1 qk f y d 1 y 1 d k yk restricting the supremum in formula 3 1 to dyadic rectangles q 1 qk d t 1 d tk that contain x proof of theorem 3 1 i fix x x fix t 1 t and suppose q x q d t then q qt k for some k and and by condition 2 5 there is a ball b b x k c 1 k that contains q since is doubling we see that 1 q q f y d y c b b f y d y haar bases and dyadic structure theorems 9 where c c log 2 c 1 c 1 1 dbl and c 1 c 1 are the constants in 2 5 see proposition 3 4 i it follows that m tdf x mf x for the second inequality fix x 0 x and a ball b x r x 0 by 2 14 there exist t 1 t and q d t such that b x r q b x cr since is doubling b x cr b x r q it follows that mf x t t 1 m t df x ii fix x x and fix t 1 tk 1 t 1 1 tk then suppose q 1 qk x q 1 qk d t 1 d tk iteration of the argument in i using in each factor the condition 2 5 and the assumption that each j is doubling establishes the first inequality similarly iteration of the argument for the second inequality in i using in each factor the condition 2 14 and the assumption that j is doubling establishes that msf x t 1 t 1 1 tk tk 1 m t 1 tk d f x 3 2 doubling ap and rhp weights like in the previous section for each j 1 k let xj j j be a space of homogeneous type with an associated collection of adjacent systems of dyadic cubes d tj tj 1 tj let x x 1 xk with the product quasi metric 1 k and the product measure 1 k by a weight on x a space of homogeneous type we mean a nonnegative locally integrable function x 0 we begin with the main result of this subsection definitions of doubling weights ap weights and rhp weights are discussed below theorem 3 2 fix k n for each j 1 2 k let xj j j be a space of homo geneous type and as in theorem 2 7 let d tj tj 1 tj be a collection of adjacent systems of dyadic cubes for xj then the following assertions hold a a weight x 1 xk is a product doubling weight if and only if is dyadic doubling with respect to each of the t 1 t 2 tk product dyadic systems d t 1 1 d tk k where tj runs over 1 tj for each j 1 2 k with comparable constants b for each p with 1 p k parameter ap x 1 xk is the intersection of t 1 t 2 tk k parameter dyadic ap spaces as follows ap x 1 xk t 1 t 1 1 t 2 t 2 1 tk tk 1 a t 1 t 2 tk p d x 1 xk with comparable constants c for each p with 1 p k parameter rhp x 1 xk is the intersection of t 1 t 2 tk k parameter dyadic rhp spaces as follows rhp x 1 xk t 1 t 1 1 t 2 t 2 1 tk tk 1 rh t 1 t 2 tk p d x 1 xk with comparable constants the constant ap depends only on the constants a t 1 t 2 tk p d for 1 tj tj 1 j k and vice versa and similarly for the other classes we note that one difference from the euclidean setting is that on x or x it is not immediate that a continuous function space is a subset of its dyadic counterpart since in general the dyadic cubes are not balls we address this question in the proof of theorem 3 2 below we begin with some definitions and observations for brevity we include only the one parameter versions on x the product definitions on x follow the pattern described for the euclidean case in lpw section 7 2 in particular the product ap weights are those which are uniformly ap in each variable separately and so on 10 anna kairema ji li m cristina pereyra and lesley a ward definition 3 3 i a weight on a homogeneous space x is doubling if there is a constant cdbl such that for all x x and all r 0 0 b x 2 r cdbl b x r as usual e e d for e x ii a weight on a homogeneous space x equipped with a system d of dyadic cubes is dyadic doubling if there is a constant cdydbl such that for every dyadic cube q d and for each child q of q 0 q cdydbl q proposition 3 4 i let x be a space of homogeneous type then for all x x r 0 and 0 we have 3 1 b x r cdbl 1 log 2 b x r ii the condition in definition 3 3 ii of dyadic doubling weights above is equivalent to the following condition there is a constant c such that for each cube q d for all children subcubes q and q of q 3 2 1 c q q c q proof the proofs are elementary ii is an immediate consequence of the fact that each cube q in d is the disjoint union of its children condition 2 4 we note that in the euclidean setting the theory of product weights was developed by k c lin in his thesis lin and the dyadic theory was developed in buckley s paper buc the definitions of ap and rhp and their dyadic versions on x and x are obtained by the natural modifications of the euclidean definitions which are summarised in for example pwx for ap 1 p and rhp 1 p and in lpw for rh 1 for brevity we omit the definitions for ap and a t p d and include only those for the reverse h lder classes rhp and rh t p d definition 3 5 let x be a nonnegative locally integrable function on x for p with 1 p we say is a reverse h lder p weight written rhp if rhp sup b b p 1 p b 1 for p 1 we say is a reverse h lder 1 weight written rh 1 or b 1 if rh 1 sup b b b log b for p we say is a reverse h lder infinity weight written rh or b if rh sup b ess sup x b b 1 here the suprema are taken over all quasi metric balls b x and b denotes 1 b b d the quantity rhp is called the rhp constant of for p with 1 p and t 1 2 t we say is a dyadic reverse h lder p weight related to the dyadic system dt written rh tp d if i the analogous condition rh tp d holds with the supremum being taken over only the dyadic cubes q dt and ii in addition is a dyadic doubling weight we define the rh tp d constant rh t p d of to be the larger of this dyadic supremum and the dyadic doubling constant haar bases and dyadic structure theorems 11 note that the ap inequality or the rhp inequality implies that the weight is doubling and the dyadic ap inequality implies that is dyadic doubling however the dyadic rhp inequality does not imply that is dyadic doubling which is why the dyadic doubling assumption is needed in the definition of rh tp d it is shown in aht that the self improving property of reverse h lder weights does not hold on some spaces of homogeneous type but does hold on doubling metric measure spaces with some additional geometric properties such as the annular decay property see also maa our work here does not involve the self improving property proof of theorem 3 2 the multiparameter case follows from the one parameter case by a straightforward iteration argument as in the euclidean setting see lpw theorem 7 3 the one parameter proof that each continuous function class contains the intersection of its dyadic counterparts follows that of theorem 7 1 in lpw replacing lebesgue measure by and replacing the two dyadic grids related through translation by a collection of adjacent systems of dyadic grids we give the details for the cases of doubling weights and rhp weights parts a and c and omit them for ap weights part b a we show that doubling weights on x are dyadic doubling with respect to each of the systems d t of dyadic cubes t 1 t given by theorem 2 7 these systems have parameters c 1 1 12 a 4 0 c 1 4 a 2 0 and c 8 a 3 0 3 let be a doubling weight on x fix t 1 t fix a dyadic cube qk d t and a child qk 1 of q k then b qk b x k c 1 k b xk 1 2 a 0 c 1 k since for x b qk x xk 1 a 0 x x k x k x k 1 2 a 0 c 1 k by proposition 3 4 i it follows that qk b x k c 1 k b xk 1 2 a 0 c 1 k b xk 1 2 a 0 c 1 c 1 c 1 k 1 cdbl 1 log 2 2 a 0 c 1 c 1 b xk 1 c 1 k 1 cdbl 1 log 2 2 a 0 c 1 c 1 qk 1 therefore is dyadic doubling with constant cdbl 1 log 2 2 a 0 c 1 c 1 with respect to each system d t for t 1 t for the other inclusion let be a weight that is dyadic doubling with constant cdydbl with respect to each d t for t 1 t fix x x and r 0 pick k z such that k 3 2 r k 2 by property 2 14 applied to b x 2 r there is some t 1 t and some q qk d t of generation k such that 3 3 b x 2 r q qk b x 2 cr we claim there is an integer n independent of q and t such that there is a descendant q q of q at most n generations below q with q q q d t and q b x r if so then b x r q cndydbl q cndydbl b x r and so is a doubling weight it remains to establish the claim first choose z such that 6 a 30 1 r 1 second by the choice of the center points for the adjacent systems of dyadic cubes as in theorem 2 7 there is a such that x x 2 a 0 it follows that q q b x r for given y q we have y x a 0 y x x x a 0 c 1 2 a 0 12 anna kairema ji li m cristina pereyra and lesley a ward 6 a 30 r so y b x r hence q b x r now we have 1 k k 2 r 3 r 8 a 30 16 a 30 4 it follows that k log 16 a 30 4 log 1 thus it suffices to choose n log 16 a 30 4 log 1 we note that with the parameter choices as in theorem 2 7 of c 1 1 12 a 4 0 c 1 4 a 2 0 c 8 a 30 3 and choosing 1 96 a 60 at the upper end of the range in theorem 2 7 we find that 16 a 30 4 16 964 a 270 1 while 1 96 a 2 0 thus with these parameter choices we have 1 n we also note that the parameter choices in theorem 2 7 are consistent with those in theorem 2 1 this completes the proof of part a b the proof for ap weights is similar to part c below and we omit the details c now we turn to the reverse h lder weights it suffices to prove the one parameter case suppose 1 p we show first that rhp rh t p d for each t 1 2 t fix such a t and fix rhp consider the quantity v q p 1 p q 1 3 4 where q is any fixed dyadic cube in dt for that dyadic cube q we denote by bc 1 and bc 1 the two balls from property 2 5 then since q bc 1 we have that v 1 q q p d 1 p q q 1 q bc 1 p d 1 p bc 1 q next since bc 1 q we have q bc 1 c bc 1 where the last inequality follows from the doubling property of and the constant c c 1 log 2 c 1 c 1 1 similarly we have q bc 1 c bc 1 where the last inequality follows from the doubling property of and the constant c c 1 log 2 c 1 c 1 dbl 1 hence v 1 c 1 p c 1 bc 1 bc 1 p d 1 p bc 1 bc 1 1 c 1 p c sup b b p 1 p b 1 rhp c 1 p c which implies that rh tp d next we prove that t t 1 rh t p d rhp suppose t t 1 rh t p d then for each fixed quasi metric ball b x r x by property 2 14 there exist an integer k with k 3 r k 2 a number t 1 t and a cube q d t of generation k and with center point xk such that x xk 2 a 0 k and b x r q b x cr here each d t is a system of dyadic cubes with parameters 0 1 and 0 c 1 c 1 hence writing b b x r we have b p 1 p b 1 1 b b p d 1 p b b 1 b q p d 1 p q b haar bases and dyadic structure theorems 13 also from the doubling property of we have b c b x cr c q where c c 1 log 2 c 1 similarly b c b x cr c q where c c 1 log 2 c dbl 1 as a consequence we get b p 1 p b 1 1 c 1 pc 1 q q p d 1 p q q 1 c 1 pc rh tp d which implies that rhp similar arguments apply to the cases p 1 and p 4 explicit construction of haar functions and completeness this section is devoted to our construction of a haar basis hqu q d u 1 mq 1 for lp x 1 p associated to the dyadic cubes q d with the properties listed in theorems 4 1 and 4 2 below here mq ch q r dk 1 r q denotes the number of dyadic sub cubes children the cube q dk has theorem 4 1 let x be a geometrically doubling quasi metric space and suppose is a positive borel measure on x with the property that b for all balls b x for 1 p for each f lp x we have f x mx f q d mq 1 u 1 f hqu h q u x where the sum converges unconditionally both in the lp x norm and pointwise almost everywhere and mx f 1 x x fd if x 0 if x the following theorem collects several basic properties of the functions hqu theorem 4 2 the haar functions hqu q d u 1 mq 1 have the following properties i hqu is a simple borel measurable real function on x ii hqu is supported on q iii hqu is constant on each r ch q iv hqu d 0 cancellation v hqu h q u 0 for u 6 u u u 1 mq 1 vi the collection q 1 21 q hqu u 1 mq 1 is an orthogonal basis for the vector space v q of all functions on q that are constant on each sub cube r ch q vii if hqu 6 0 then hqu lp x qu 1 p 1 2 for 1 p and viii hqu l 1 x h q u l x 1 in the remainder of this section we develop the haar functions and their properties and establish theorems 4 1 and 4 2 the section is organized as follows section 4 1 describes our assumptions on the underlying space x and measure section 4 2 presents the dyadic algebras and conditional expectations we use section 4 3 provides our indexing of the sub cubes of a given dyadic cube and section 4 4 develops the martingale difference decomposition that leads to our explicit definition of the haar functions in section 4 4 14 anna kairema ji li m cristina pereyra and lesley a ward we also deal with the situation when a dyadic cube has only one child and sum up our haar function definitions and results in theorems 4 8 and 4 9 which complete the proof of theorems 4 1 and 4 2 4 1 set up the set up for section 4 is a geometrically doubling quasi metric space x equipped with a positive borel measure we assume that the algebra of measurable sets f contains all balls b x with b this implies that is finite in other words the sub collection f 0 f f f contains a countable cover there is a collection of at most countably many sets f 1 f 2 in f 0 such that x i 1 fi the space x is called a geometrically doubling quasi metric measure space we emphasize that in this section section 4 we do not assume that the measure is doubling that assumption is only needed in sections 5 and 6 below 4 2 dyadic algebras and conditional expectations let d k zdk be a fixed system of dyadic cubes with the additional distinguished center point property 2 13 let fk dk be the dyadic algebra generated by the countable partition dk it is an easy exercise to check that fk i qk i ak the collection of all unions lemma 4 3 properties of the filtration fk the family fk of algebras is a filtration that is fi fj f for all i j each x fk is finite and k z fk f proof the first assertion is clear since every dyadic cube is a finite union of smaller dyadic cubes the collection dk fk forms a countable cover and the second assertion follows immediately from the assumption b imposed on balls recall that dyadic cubes are borel sets thus k zfk f and consequently k zfk f then suppose that f we may assume that is an open set for each x there is q qx d such that x q consequently is a countable union of dyadic cubes and hence k zfk the proof for the following martingale convergence theorem can be found for example in the lecture notes hyt theorem 4 4 martingale convergence let x be a geometrically doubling quasi metric measure space suppose that fk k z is any filtration such that the spaces x fk are finite and k z fk f then for every f lp f 1 p there holds e f fk f as k the convergence takes place both in the lp x norm and pointwise a e haar bases and dyadic structure theorems 15 we consider the filtration fk k z generated by the dyadic cubes the associated condi tional expectation operators and the corresponding martingale differences for k z and q dk the conditional expectation and its local version are defined for f l 1 loc x f by ekf e f fk and eqf 1 qekf and they admit the explicit representation ekf q dk 1 q q q fd q dk eqf if q 0 for some cube then the corresponding term in the above series is taken to be 0 we use the shorthand notation f q 1 q q f d for the integral average of f on q with this notation eqf 1 q f q the martingale difference operators and their local versions are defined by dkf ek 1 f ekf dqf 1 qdkf by martingale convergence for each m z 4 5 f k m dkf emf k m q dk dqf q dm eqf 4 3 the indexing of the sub cubes recall that a classical l 2 normalized haar function hq in r n associated to a standard euclidean dyadic cube q satisfies the size conditions hq l 1 q 1 2 and hq l q 1 2 in the present context for the cancellative haar functions there is no upper bound for the norm hqu l in terms of the measure q however this will be compensated for by the smallness of the norm hqu l 1 in the sense that the following estimate still holds hqu l 1 h q u l 1 this type of estimate is established in lsmp for haar functions on r to obtain this control we introduce the following ordering of the sub cubes of q let the index sets ak indexing the cubes q k of generation k be initial intervals finite or infinite in n recall from 2 4 that for q dk the cardinality of the set of dyadic sub cubes ch q r dk 1 r q is bounded by ch q mq 1 m m m a 0 a 1 the number mq depends of course on q but we may omit this dependence in the notation whenever it is clear from the context for the usual dyadic cubes in the euclidean space rn we have mq 2 n for every q we order the sub cubes from the smallest to the largest more precisely we have the following result lemma 4 5 given q d there is an indexing of the sub cubes qj ch q such that 4 6 mq j u qj 1 u 1 m 1 q q for every u 1 2 mq proof the case u 1 is clear for any ordering of the sub cubes for u 1 fix some indexing if mq 1 we are done otherwise we proceed as follows suppose we have an indexing 16 anna kairema ji li m cristina pereyra and lesley a ward of the sub cubes q 1 qm m 1 such that 4 6 holds for all u 1 m mq in particular 1 m 1 m 1 q q mq j m qj 1 mq m mq j m mq m 6 j q mq m 1 mq m max j m mq mq m q qj thus we may choose n m mq such that mq m q qn mq m mq m 1 1 m 1 m 1 q q 1 mm 1 q q we reorder the cubes qj with j m by setting m n obtaining an indexing such that inequality 4 6 holds for all u 1 m 1 if mq m 1 we proceed as before the claim follows we observe that one way to obtain an indexing satisfying inequality 4 6 of lemma 4 5 is to order the cubes so that q 1 q 2 qmq as a short calculation shows from now on let the indexing of the sub cubes qj of a given cube q d be one provided by lemma 4 5 for each u 1 mq set 4 7 eu eu q mq j u qj then in particular e 1 q emq qmq and eu qu eu 1 where the union is disjoint lemma 4 6 for every u 1 mq 1 4 8 q m eu q and 4 9 1 m eu 1 eu m 2 where m is the uniform bound for the maximal number of sub cubes in particular eu q and eu 1 eu 1 for all u proof the first estimate in 4 8 follows directly from lemma 4 6 and the second estimate is immediate for 4 9 by lemma 4 6 1 m 1 mq mq u mq 1 um 1 q q q eu 1 mq j u 1 qj eu 1 eu mq j u qj 1 q 1 1 u 1 m 1 q mq mq u 1 mq 2 m 2 4 4 martingale difference decomposition we will decompose the operators ek and dk by representing the projections eq and dq in terms of haar functions as 4 10 eqf f h q 0 h q 0 dqf mq 1 u 1 f hqu h q u haar bases and dyadic structure theorems 17 here h q 0 q 1 21 q is a non cancellative haar function and h q u u 1 mq 1 are cancellative ones to this end given q dk let the indexing of the sub cubes qj j 1 mq be the one provided by lemma 4 5 generalize the notation eq by denoting eaf 1 a a a f d for any measurable set a with a 0 with this notation we obtain the splitting of the martingale difference dq as dq ek 1 ek 1 q m u 1 equ eq m 1 u 1 equ eqm eq m 1 u 1 equ m 1 u 1 eeu 1 eeu m 1 u 1 equ eeu 1 eeu m 1 u 1 dqu here eu is the set defined in 4 7 with e 1 q and em qm take a closer look at the operator dqu if qu 0 then d q u f 0 and we define the corresponding haar function to be hqu 0 for qu 0 we write recall that eu qu eu 1 with a disjoint union dqu f equ eeu 1 eeu f 1 qu qu qu fd 1 eu 1 eu 1 eu 1 fd 1 eu eu eu fd 1 qu qu qu fd 1 eu 1 eu 1 eu 1 fd 1 qu 1 eu 1 eu qu fd eu 1 fd eu 1 qu eu 1 qu qu 1 qu qu fd 1 eu 1 eu 1 1 eu 1 eu 1 fd 1 qu qu 1 eu 1 eu 1 fd 1 eu 1 eu 1 1 qu qu fd eu 1 qu eu 1 qu qu 1 eu 1 eu 1 1 qu qu 1 eu 1 eu 1 fd hqu hqu fd f h q u h q u where 4 11 hqu au 1 qu bu 1 eu 1 au eu 1 1 2 qu 1 2 eu 1 2 bu qu 1 2 eu 1 2 eu 1 1 2 remark 4 7 we note that it may happen that a given cube q has only one child r so that r q as sets in this case the formula 4 11 is not meaningful but also not relevant as we do not need to add a cancellative haar function corresponding to an only child r we examine this situation more closely a cube can be its own only child for finitely many generations or even forever in the first case it means there will not be cancellative haar functions associated to the cube until it truly subdivides in the second case it turns out that the cube q must be a single point and the point must be an isolated point in a geometrically doubling metric space there are at most countably many isolated points and the only ones that contribute something are the ones that have positive finite measure that is point masses given a cube that is a point mass there are two scenarios either the cube is its own parent forever or else the cube is a proper child of its parent in the first case x is a point mass with finite measure and in that case we need to include the function 1 x x 1 2 to get a basis in fact that is the only element in the basis it is an orthonormal basis although 18 anna kairema ji li m cristina pereyra and lesley a ward the orthogonality holds by default because there are no pairs to be checked in the second case we don t need to add any functions to the basis in fact one may then wonder whether the characteristic function of the point mass set can be represented with the haar functions we already have the answer is yes we can always represent the characteristic function of any given cube using the haar functions associated to ancestors of the given cube much as on r one can represent the function 1 0 1 in terms of the haar functions corresponding to the intervals 0 2 n for n 1 see project 9 7 in perw for all this and more see wei theorem 4 8 let x be a geometrically doubling quasi metric space and suppose is a positive borel measure on x with the property that b for all balls b x for each q d let h q 0 q 1 21 q and for u 1 2 mq 1 let hqu 0 if qu 0 au 1 qu bu 1 eu 1 if qu 0 where au eu 1 1 2 qu 1 2 eu 1 2 bu qu 1 2 eu 1 2 eu 1 1 2 the haar functions hqu q d u 0 1 mq 1 have the following properties i each hqu is a simple borel measurable real function on x ii each hqu is supported on q iii each hqu is constant on each r ch q iv hqu d 0 for u 1 2 mq 1 cancellation v hqu h q u 0 if u 6 u u u 0 1 mq 1 vi the collection hqu u 0 1 mq 1 is an orthogonal basis for the vector space v q of all functions on q that are constant on each sub cube r ch q vii for u 1 2 mq 1 if h q u 6 0 then hqu lp x qu 1 p 1 2 for 1 p and viii for u 0 1 mq 1 we have hqu l 1 x h q u l x 1 note that theorem 4 8 completes the proof of theorem 4 2 proof of theorem 4 8 properties i v are clear from the definition of the haar functions for property vi observe that q has mq children and v q is a finite dimensional vector space with dimension dim v q mq the functions h q u mq 1 u 0 are orthogonal and there are mq of them so they span v q property vii take hqu with u 1 2 mq 1 for 1 p we have hqu p lp x qu hqu x p d x eu 1 hqu x p d x qu au p d x eu 1 bu p d x eu 1 eu p 2 qu qu p 2 i qu p 2 eu p 2 eu 1 p 2 eu 1 ii haar bases and dyadic structure theorems 19 by lemma 4 6 i qu 1 p 2 and ii qu p 2 eu 1 eu 1 p qu p 2 q p 1 qu p 2 qu p 1 qu 1 p 2 since also ii 0 it follows that qu 1 p 2 i i ii hqu p lp x qu 1 p 2 and so hqu lp x qu 1 p 1 2 as required now suppose p note that by lemma 4 6 au qu 1 2 and bu qu 1 2 eu qu 1 2 q qu 1 2 qu qu 1 2 as 0 qu q therefore for all x we have hqu x au 1 qu x bu 1 eu 1 x qu 1 2 it follows that hqu l x qu 1 2 also if hqu 6 0 then for x qu we have h q u x au qu 1 2 while for x eu 1 we have h q u x bu qu 1 2 then hqu l x qu 1 2 thus for hqu 6 0 we find that h l x qu 1 2 as required as an aside we note that although hqu x qu 1 2 for all x the reverse inequality need not hold since if the measure is not doubling for x eu 1 the quantity h q u x bu qu 1 2 q may be arbitrarily small compared with qu 1 2 property viii for u 0 it is immediate from the definition that h q 0 l 1 x h q 0 l x q 1 2 q 1 2 1 for u 1 mq 1 by property vii we have hqu l 1 x h q u l x qu 1 1 2 qu 1 2 1 as required we collect the convergence results of this section in the following theorem theorem 4 9 let x be a geometrically doubling quasi metric space and suppose is a positive borel measure on x with the property that b for all balls b x for 1 p for each f lp x and for each m z we have f x k m q dk mq 1 u 1 f hqu h q u x q dm f h q 0 h q 0 x where the first sum converges both in the lp x norm and pointwise a e for the second sum we have q dm f h q 0 h q 0 x 0 as m if x 1 x x fd as m if x as a consequence f x mx f q d mq 1 u 1 f hqu h q u x note that theorem 4 9 completes the proof of theorem 4 1 20 anna kairema ji li m cristina pereyra and lesley a ward proof of theorem 4 9 the first equality follows directly from 4 5 and 4 10 for the second sum fix x x and recall that there exists a unique q qm dm such that x q thus q dm f h q 0 h q 0 x f h qm 0 h qm 0 x 1 qm x qm qm f d if x then 1 qm x qm qm f d f lp qm 1 p 0 as m by lemma 2 5 for the case x the asserted convergence is clear 5 definitions and duality of dyadic h 1 d x and dyadic bmod x we begin this section by recalling the definitions of continuous product h 1 x and bmo x developed in hlw here the underlying space x x 1 xn is a product space of homogeneous type then we introduce the definitions of the dyadic product hardy and bmo spaces h 1 d d x and bmod d x associated to a system of dyadic cubes on x for simplicity of notation we work in the setting of two parameters but everything goes through to the n parameter setting including the material we quote from hlw hlpw these dyadic spaces are defined by means of the haar functions constructed in section 4 above we note that tao used the same approach to define dyadic product h 1 and bmo on euclidean underlying spaces in the note tao finally we prove the duality relation h 1 d d x bmod d x here our approach is to prove the duality of the product sequence spaces s 1 and c 1 which are models for h 1 d d x and bmod d x and to pull this result across by means of the lifting and projection operators tl and tp we recall from hlw the definitions of the hardy space h 1 x and the bounded mean oscillation space bmo x these definitions rely on the orthonormal basis and the wavelet expansion in l 2 x which were recently constructed by auscher and hyt nen ah to state their result we must first recall the set xk of reference dyadic points as follows let be a fixed small positive parameter for example as noted in section 2 2 of ah it suffices to take 10 3 a 100 for k 0 let x 0 x 0 be a maximal collection of 1 separated points in x inductively for k z let x k xk x k 1 and x k x k x k 1 be k and k separated collections in x k 1 and x k 1 respectively lemma 2 1 in ah shows that for all k z and x x the reference dyadic points satisfy xk x k k 6 x x k min x xk 2 a 0 k 5 1 also taking c 0 1 c 0 2 a 0 and 10 3 a 100 we see that c 0 c 0 and satisfy the conditions in theorem 2 2 of hk therefore we may apply hyt nen and kairema s construction theorem 2 2 hk with the reference dyadic points xk k z x k playing the role of the points zk k z ak to conclude that there exists a set of half open dyadic cubes qk k z x k associated with the reference dyadic points xk k z x k we call the reference dyadic point xk the center of the dyadic cube q k we also identify with x k the set of indices corresponding to xk x k note that x k x k 1 for k z so that every xk is also a point of the form x k 1 we denote y k x k 1 x k and relabel the points xk that belong to y k as yk we now recall the orthonormal wavelet basis of l 2 x constructed by auscher and hyt nen haar bases and dyadic structure theorems 21 theorem 5 1 ah theorem 7 1 let x be a space of homogeneous type with quasi triangle constant a 0 and let 5 2 a 1 2 log 2 a 0 1 there exists an orthonormal wavelet basis k k z y k y k of l 2 x having expo nential decay k x c b yk k exp yk x k a 5 3 h lder regularity k x k y c b yk k x y k exp yk x k a 5 4 for x y k and the cancellation property x k x d x 0 for k z y k y k 5 5 here is a fixed small parameter say 10 3 a 100 and c 0 and 0 1 are constants independent of k x and yk moreover the wavelet expansion is given by f x k z y k f k k x k z kf x in the sense of l 2 x where kf y k f k k x is the orthogonal projection onto the subspace wk spanned by k y k in what follows we refer to the functions k as wavelets throughout sections 5 and 6 of this paper a denotes the exponent from 5 2 and denotes the h lder regularity exponent from 5 4 we now consider the product setting x 1 1 1 x 2 2 2 where xi i i i 1 2 is a space of homogeneous type as defined in section 1 for i 1 2 let a i 0 be the constant in the quasi triangle inequality 1 1 and let c i be the doubling constant as in inequality 1 2 on each xi by theorem 5 1 there is a wavelet basis ki i with h lder exponent i as in inequality 5 4 we refer the reader to hlw definitions 3 9 and 3 10 and the surrounding discussion for the definitions of the space g of product test functions and its dual space g of product distributions on the product space x 1 x 2 in hlw g is denoted by g 1 2 1 2 and g is denoted by g 1 2 1 2 where the i and i are parameters that quantify the size and smoothness of the test functions and i 0 i where i is the regularity exponent from theorem 5 1 in fact in hlw the theory is developed for i 0 i but for simplicity here we only use i 0 i since that is all we need we note that the one parameter scaled auscher hyt nen wavelets k x b yk k are test functions and that their tensor products k 1 1 x k 2 2 y 1 b y k 1 1 k 11 2 b y k 2 2 k 22 1 2 are product test functions in g for all i 0 i and all i 0 for i 1 2 these facts follow from the theory in hlw specifically definition 3 1 and the discussion after it theorem 3 3 and definitions 3 9 and 3 10 and the discussion between them 22 anna kairema ji li m cristina pereyra and lesley a ward as shown in theorem 3 11 of hlw the reproducing formula 5 6 f x 1 x 2 k 1 1 k 2 2 f k 1 1 k 2 2 k 1 1 x 1 k 2 2 x 2 holds in g for all i i 0 i for i 1 2 and hence by duality 5 6 also holds in g next we define the product hardy space h 1 this is the special case p 1 of the definition of hp in definition 5 1 in hlw definition 5 2 hlw definition 5 1 the product hardy space h 1 on x is defined as h 1 x f g s f l 1 x where s f is the littlewood paley g function related to the orthonormal basis introduced in ah as follows s f x 1 x 2 k 1 1 k 2 2 k 1 1 k 2 2 f q k 1 1 x 1 qk 2 2 x 2 2 1 2 5 7 with q k 1 1 x 1 qk 1 1 x 1 1 q k 1 1 1 2 and q k 2 2 x 2 qk 2 2 x 2 2 q k 2 2 1 2 as noted in hlpw it follows from definition 5 2 that h 1 x l 2 x is dense in h 1 x with respect to the h 1 x norm f h 1 sf l 1 x we first give the definition of atoms for the product hardy space this definition is the special case with q 2 p 1 of definition 4 7 in hlpw definition 5 3 hlpw definition 4 7 a function a x 1 x 2 defined on x is called an atom of h 1 x if a x 1 x 2 satisfies the following properties 1 3 1 supp a where is an open set of x with finite measure 2 a l 2 1 2 and 3 a can be further decomposed into rectangle atoms ar associated to dyadic rectangles r q 1 q 2 satisfying the following properties i iii i supp ar cr where c is an absolute constant independent of a and r ii x 1 ar x 1 x 2 d 1 x 1 0 for a e x 2 x 2 and x 2 ar x 1 x 2 d 2 x 2 0 for a e x 1 x 1 iii a r m ar and r m ar 2 l 2 1 the special case p 1 q 2 of the following result from hlpw shows that the atomic hardy space defined in terms of the atoms from definition 5 3 coincides with the dense subset h 1 x l 2 x of h 1 x this atomic decomposition will be used in section 6 theorem 5 4 hlpw theorem 4 8 suppose that max 1 1 1 2 2 2 p 1 q then f lq x 1 x 2 h p x 1 x 2 if and only if f has an atomic decomposition that is f i iai 5 8 where ai are p q atoms i i p and the series converges in both hp x 1 x 2 and lq x 1 x 2 moreover f hp x 1 x 2 inf i i p 1 p f i iai where the infimum is taken over all decompositions as above and the implicit constants are independent of the lq x 1 x 2 and h p x 1 x 2 norms of f haar bases and dyadic structure theorems 23 we turn to the definition of the product bmo space definition 5 5 hlw definition 5 2 we define the product bmo space on x as bmo x f g c 1 f l with c 1 f defined as follows c 1 f sup 1 r q k 1 1 q k 2 2 k 1 1 k 2 2 f 2 1 2 5 9 where runs over all open sets in x with finite measure and r runs over all dyadic rectangles contained in we are now ready to define the dyadic versions of our function spaces definition 5 6 we define the dyadic product hardy space h 1 on x as h 1 d d x f l 1 x 1 x 2 sd d f l 1 x where sd d f is the littlewood paley g function related to the haar orthonormal basis built in the previous sections as follows sd d f x 1 x 2 q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 f hu 1 q 1 h u 2 q 2 q 1 x 1 q 2 x 2 2 1 2 5 10 where q 1 x 1 q 1 x 1 1 q 1 1 2 and q 2 x 2 q 2 x 2 2 q 2 1 2 definition 5 7 we define the dyadic product bmo space on x as bmod d x f l 1 loc cd d f l with cd d f defined as follows cd d f sup 1 r q 1 q 2 d 1 d 2 r mq 1 1 u 1 1 mq 2 1 u 2 1 f hu 1 q 1 h u 2 q 2 2 1 2 5 11 where runs over all open sets in x with finite measure and r runs over all dyadic rectangles contained in remark 5 8 we note that our definitions of h 1 d d x and bmod d x can be rephrased in terms of martingales as follows however in the rest of this paper we work with the definitions above in terms of haar functions for h 1 d d x the dyadic square function sd d f used in definition 5 6 can be replaced by s d d f x 1 x 2 k 1 1 k 2 2 d q k 1 1 d q k 2 2 f x 1 x 2 2 1 2 5 12 where d q k 1 1 d q k 2 2 f x 1 x 2 means we first apply the orthogonal projection dqk 2 2 to f x 1 for a e x 1 and then apply dqk 1 1 to the resulting function of x 1 the space h 1 d d x f l 1 x 1 x 2 s d d f l 1 x coincides with h 1 d d x and moreover sd df l 1 x 1 x 2 s d df l 1 x 1 x 2 see tre sec tion 3 2 3 and fj the advantage of using the square function sd d is that only the absolute 24 anna kairema ji li m cristina pereyra and lesley a ward value of the individual coefficients appears in the definition and there is no further cancel lation involved also notice that using the local martingale differences and expectations we can write sd d as follows sd d f x 1 x 2 k 1 1 k 2 2 e q k 1 1 e q k 2 2 d q k 1 1 d q k 2 2 f x 1 x 2 2 1 2 5 13 for bmod d x the quantity cd d f used in definition 5 7 can be written as follows c d d 1 f sup 1 r q k 1 1 q k 2 2 d 1 d 2 r x 1 x 2 d q k 1 1 d q k 2 2 f x 1 x 2 2 d 1 x 1 d 2 x 2 1 2 5 14 where runs over all open sets in x with finite measure and r runs over all dyadic rectangles contained in this time we get equality because we are integrating the square of the local martingale differences orthogonal projection onto the subspace generated by the haar functions associated to the rectangle r qk 1 1 q k 2 2 and we can use plancherel to replace the square of the l 2 norm by the sum of the squares of the haar coefficients for each dyadic cube q the space w q span f x supp f q f r is constant for each r ch q and f 0 of all functions supported on q that are constant on each child of q and have mean zero is a finite dimensional vector space with dimension dim w q mq 1 it is a subspace of the space v q defined in the proof of theorem 4 8 above there are many possible bases of haar functions for w q in addition to the basis we chose above however it follows from the remarks in the three preceding paragraphs that the definitions of h 1 d d x and bmod d x are independent of the haar functions chosen on each finite dimensional subspace w qki i since in the definitions we are using the orthogonal projections d q k 1 1 d q k 2 2 f we now establish the duality h 1 d d x bmod d x following the approach used in hll for the continuous case we do so by passing to the corresponding duality result for certain sequence spaces s 1 and c 1 which are models for h 1 d d x and bmod d x respectively these sequence spaces are part of the homogeneous triebel lizorkin family of sequence spaces adapted to the product setting in the notation used in fj and tre s 1 f 0 2 1 and c 1 f 0 2 we begin with the definitions and properties of these sequence spaces we define s 1 to be the sequence space consisting of the sequences s sq 1 u 1 q 2 u 2 of complex numbers with s s 1 q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 q 1 x 1 q 2 x 2 2 1 2 l 1 x 1 x 2 5 15 we define c 1 to be the sequence space consisting of the sequences t tq 1 u 1 q 2 u 2 of complex numbers with t c 1 sup 1 r q 1 q 2 d 1 d 2 r mq 1 1 u 1 1 mq 2 1 u 2 1 tq 1 u 1 q 2 u 2 2 1 2 5 16 where the supremum is taken over all open sets in x with finite measure the main result for these sequence spaces is their duality haar bases and dyadic structure theorems 25 theorem 5 9 the following duality result holds s 1 c 1 proof first we prove that for each t c 1 if l s s t q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 tq 1 u 1 q 2 u 2 for all s s 1 5 17 then l s c s s 1 t c 1 5 18 to see this define for each k z the following subsets k and k of x 1 x 2 and the subcollection bk of certain rectangles in d 1 d 2 k x 1 x 2 x 1 x 2 q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 q 1 x 1 q 2 x 2 2 1 2 2 k bk r q 1 q 2 d 1 d 2 k r 1 2 r k 1 r 1 2 r and k x 1 x 2 x 1 x 2 ms k 1 2 where ms is the strong maximal function on x 1 x 2 remark 5 10 first notice that since s s 1 we have k second each rectangle r belongs to exactly one set bk third note that k c k because the strong maximal function is bounded on l 2 x fourth if r bk then r k therefore r bkr k and bk r r k fifth if r bk then k k 1 r r 2 by h lder s inequality the linear functional l s from 5 17 satisfies l s k r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 1 2 r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 tq 1 u 1 q 2 u 2 2 1 2 k k 1 2 r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 1 2 5 19 1 k r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 tq 1 u 1 q 2 u 2 2 1 2 k k 1 2 r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 1 2 t c 1 in the last inequality we have used the fact that bk r r k as stated in re mark 5 10 next we point out that from the definition of k 1 and remark 5 10 we have k k 1 r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 q 1 x 1 1 q 1 q 2 x 2 2 q 2 d 1 x 1 d 2 x 2 22 k 1 k k 1 c 2 2 k k 26 anna kairema ji li m cristina pereyra and lesley a ward moreover by the monotone convergence theorem and remark 5 10 we have k k 1 r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 q 1 x 1 1 q 1 q 2 x 2 2 q 2 d 1 x 1 d 2 x 2 r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 1 1 q 1 1 2 q 2 k k 1 r 1 2 r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 as a consequence we obtain that r q 1 q 2 d 1 d 2 r bk mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 c 22 k k substituting this back into the last inequality of 5 19 yields that l s c k k 1 22 k k 1 2 t c 1 c k 2 k k t c 1 c s s 1 t c 1 conversely we need to verify that for any l s 1 there exists t c 1 with t c 1 l such that for all s s 1 l s q 1 u 1 q 2 u 2 sq 1 u 1 q 2 u 2 tq 1 u 1 q 2 u 2 now let sq 1 u 1 q 2 u 2 be the sequence that equals 0 everywhere except at the q 1 u 1 q 2 u 2 entry where it equals 1 then it is easy to see that sq 1 u 1 q 2 u 2 s 1 1 for all s s 1 we have s q 1 u 1 q 2 u 2 sq 1 u 1 q 2 u 2 s q 1 u 1 q 2 u 2 where the limit holds in the norm of s 1 for each l s 1 let tq 1 u 1 q 2 u 2 l s q 1 u 1 q 2 u 2 since l is a bounded linear functional on s 1 we see that l s l q 1 u 1 q 2 u 2 sq 1 u 1 q 2 u 2 s q 1 u 1 q 2 u 2 q 1 u 1 q 2 u 2 sq 1 u 1 q 2 u 2 tq 1 u 1 q 2 u 2 let t tq 1 u 1 q 2 u 2 then we only need to check that t c 1 l for each fixed open set x 1 x 2 with finite measure let be a new measure such that r r when r and r 0 when r and let l 2 be a sequence space such that when s l 2 r q 1 q 2 d 1 d 2 r mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 r 1 2 it is easy to see that l 2 l 2 next 1 r q 1 q 2 d 1 d 2 r mq 1 1 u 1 1 mq 2 1 u 2 1 tq 1 u 1 q 2 u 2 2 1 2 5 20 r 1 2 tq 1 u 1 q 2 u 2 l 2 sup s s l 2 1 r q 1 q 2 d 1 d 2 r mq 1 1 u 1 1 mq 2 1 u 2 1 r 1 2 tq 1 u 1 q 2 u 2 sq 1 u 1 q 2 u 2 r haar bases and dyadic structure theorems 27 sup s s l 2 1 l sq 1 u 1 q 2 u 2 r 1 2 r q 1 q 2 d 1 d 2 r u 1 1 mq 1 1 u 2 1 mq 2 1 sup s s l 2 1 l sq 1 u 1 q 2 u 2 r 1 2 r q 1 q 2 d 1 d 2 r u 1 1 mq 1 1 u 2 1 mq 2 1 s 1 by 5 15 and the cauchy schwarz inequality we have sq 1 u 1 q 2 u 2 r 1 2 r q 1 q 2 d 1 d 2 r u 1 1 mq 1 1 u 2 1 mq 2 1 s 1 r q 1 q 2 d 1 d 2 r mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 2 r 1 2 hence we obtain that 5 20 is bounded by sup s s l 2 1 l s l 2 l which implies that t c 1 l we now define s 2 corresponding to f 0 2 2 2 to be the sequence space consisting of the sequences s sq 1 u 1 q 2 u 2 of complex numbers with s s 2 q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 q 1 x 1 q 2 x 2 2 1 2 l 2 x 1 x 2 5 21 then we have the following density argument proposition 5 11 the set s 1 s 2 is dense in s 1 in terms of the s 1 norm moreover c 1 s 2 is dense in c 1 in terms of the weak type convergence as follows for each t c 1 there exists tn n c 1 s 2 such that s tn s t when n tends to for all s s 1 where s t is the inner product defined as in 5 17 proof for each sequence s sq 1 u 1 q 2 u 2 s 1 we define a truncated sequence sn as follows 5 22 sn snq 1 u 1 q 2 u 2 snq 1 u 1 q 2 u 2 sq 1 u 1 q 2 u 2 an q 1 q 2 where an q 1 q 2 k 1 k 2 n n q 1 dk 1 q 1 b x 0 1 n q 2 dk 2 q 2 b x 0 2 n for each positive integer n where x 01 and x 0 2 are arbitrary fixed points in x 1 and x 2 respec tively then sn is in s 1 with sn s 1 s s 1 we also have that s s 2 with sn s 2 k 1 k 2 n n q 1 dk 1 q 1 b x 0 1 n q 2 dk 2 q 2 b x 0 2 n sq 1 u 1 q 2 u 2 2 1 2 moreover it is easy to check that sn tends to s in the sense of s 1 norm as a consequence we have that s 1 s 2 is dense in s 1 in terms of the s 1 norm now we turn to c 1 for each t tq 1 u 1 q 2 u 2 c 1 we define tn analogously to sn then similarly we have tn c 1 s 2 with tn c 1 t c 1 for each positive integer n moreover since s tn and s t are both bounded by c s s 1 t c 1 for all s s 1 we have s tn k 1 k 2 n n q 1 dk 1 q 1 b x 0 1 n q 2 dk 2 q 2 b x 0 2 n mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 tq 1 u 1 q 2 u 2 28 anna kairema ji li m cristina pereyra and lesley a ward q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 sq tq s t as n which shows that tn tends to t in the weak type convergence now we define the lifting and projection operators as follows definition 5 12 for functions f l 2 x 1 x 2 define the lifting operator tl by tl f f hu 1 q 1 h u 2 q 2 q 1 u 1 q 2 u 2 5 23 definition 5 13 for sequences s sq 1 u 1 q 2 u 2 define the projection operator tp by tp s q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 sq 1 u 1 q 2 u 2 h u 1 q 1 x 1 h u 2 q 2 x 2 5 24 then it is clear that f tp tl f in the sense of l 2 x 1 x 2 next we give the following two auxiliary propositions which show that the lifting opera tor tl maps h 1 d d x 1 x 2 l 2 x 1 x 2 to s 1 s 2 and maps bmod d x 1 x 2 l 2 x 1 x 2 to c 1 s 2 proposition 5 14 for all f l 2 x 1 x 2 h 1 d d x 1 x 2 we have tl f s 1 f h 1 d d x 1 x 2 5 25 proposition 5 15 for all f bmod d x 1 x 2 we have tl f c 1 c d 1 f 5 26 proposition 5 16 for all s s 1 s 2 we have tp s h 1 d d x 1 x 2 s s 1 5 27 proposition 5 17 for all t c 1 s 2 we have cd 1 tp t t c 1 5 28 these four propositions follow directly from the definitions of the hardy spaces h 1 d d x 1 x 2 and the sequence space s 1 and from the definitions of the bmo space bmod d x 1 x 2 and the sequence space c 1 theorem 5 18 for each bmod d x 1 x 2 the linear functional given by f f x 1 x 2 f x 1 x 2 d 1 x 1 d 2 x 2 5 29 initially defined on h 1 d d x 1 x 2 l 2 x 1 x 2 has a unique bounded extension to h 1 d d x 1 x 2 with ccd 1 conversely every bounded linear functional on h 1 d d x 1 x 2 l 2 x 1 x 2 can be realized in the form of 5 29 i e there exists bmod d x 1 x 2 with such that 5 29 holds for all f h 1 d d x 1 x 2 l 2 x 1 x 2 and cd 1 c haar bases and dyadic structure theorems 29 proof suppose bmod d x 1 x 2 and we define the linear functional as in 5 29 for f h 1 d d x 1 x 2 l 2 x 1 x 2 then by the haar expansion we have f x 1 x 2 q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 f hu 1 q 1 h u 2 q 2 hu 1 q 1 x 1 h u 2 q 2 x 2 d 1 x 1 d 2 x 2 q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 f hu 1 q 1 h u 2 q 2 hu 1 q 1 h u 2 q 2 c f hu 1 q 1 h u 2 q 2 s 1 hu 1 q 1 h u 2 q 2 c 1 where the inequality follows from 5 18 as a consequence we obtain that f c tl f s 1 tl c 1 c f h 1 d d x 1 x 2 cd 1 which implies that is a bounded linear functional on h 1 d d x 1 x 2 l 2 x 1 x 2 and hence has a unique bounded extension to h 1 d d x 1 x 2 with cc d 1 since h 1 d d x 1 x 2 l 2 x 1 x 2 is dense in h 1 d d x 1 x 2 conversely suppose is a bounded linear functional on h 1 d d x 1 x 2 l 2 x 1 x 2 we set 1 tp then it is obvious that 1 is a bounded linear functional on s 1 s 2 note that f tp tl f for every f l 2 x 1 x 2 we have f tp tl f 1 tl f where 1 tp now by the duality of s 1 with c 1 we obtain that there exists t c 1 with t c 1 such that 1 s t s for all s s 1 hence we have 1 tl f t tl f q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 tq 1 u 1 q 2 u 2 f h u 1 q 1 hu 2 q 2 f q 1 d 1 q 2 d 2 mq 1 1 u 1 1 mq 2 1 u 2 1 tq 1 u 1 q 2 u 2 h u 1 q 1 hu 2 q 2 f tp t which implies that f f tp t and moreover cd 1 tp t c t c 1 c 6 dyadic structure theorems for h 1 x and bmo x in this final section we prove our dyadic structure results namely the product hardy space h 1 x is a sum of finitely many dyadic product hardy spaces and the product bmo x space is an intersection of finitely many dyadic product bmo spaces we also establish the atomic decomposition of the dyadic product hardy spaces h 1 d t 1 1 d t 2 2 x which plays a key role in the proofs of the dyadic structure results as in the previous section these results all hold for n parameters but for notational simplicity we write in terms of two parameters 30 anna kairema ji li m cristina pereyra and lesley a ward theorem 6 1 let x x 1 x 2 be a product space of homogeneous type then h 1 x 1 x 2 t 1 t 1 1 t 2 t 2 1 h 1 d t 1 1 d t 2 2 x 1 x 2 the corresponding result holds for n parameters as a consequence of theorem 6 1 we obtain the following by duality theorem 6 2 let x x 1 x 2 be a product space of homogeneous type then bmo x t 1 t 1 1 t 2 t 2 1 bmo d t 1 1 d t 2 2 x the corresponding result holds for n parameters to do this we first give the definition of atoms for the dyadic product hardy space h 1 d t 1 1 d t 2 2 x and then provide the atomic decomposition where t 1 1 t 1 t 2 1 t 2 for brevity we will drop the reference to the parameters t 1 t 2 until we return to the proof of theorem 6 1 definition 6 3 a function a x 1 x 2 defined on x is called a dyadic atom of h 1 d 1 d 2 x if a x 1 x 2 satisfies 1 supp a where is an open set of x with finite measure 2 a l 2 1 2 3 a can be further decomposed into rectangle atoms ar associated to dyadic rectangle r q 1 q 2 d 1 d 2 satisfying the following three conditions i supp ar r localization ii x 1 ar x 1 x 2 d 1 x 1 0 for a e x 2 x 2 and x 2 ar x 1 x 2 d 2 x 2 0 for a e x 1 x 1 cancellation iii a r m ar and r m ar 2 l 2 x 1 size remark 6 4 we note that the only difference between the dyadic atoms defined here and the continuous atoms defined earlier in definition 5 3 is that here the rectangle atoms ar are supported on the rectangles r while for the continuous atoms the rectangle atoms ar are supported on a dilate of r next we provide the atomic decomposition for h 1 d 1 d 2 x theorem 6 5 if f h 1 d 1 d 2 x l 2 x then f k kak where each ak is an atom of h 1 d 1 d 2 x as in definition 6 3 and k k c f h 1 d 1 d 2 x conversely suppose f k kak where each ak is an atom of h 1 d 1 d 2 x as in definition 6 3 and k k c then f h 1 d 1 d 2 x and f h 1 d 1 d 2 x c k k proof suppose f h 1 d 1 d 2 x then sd d f l 1 x for each k z we now define k x 1 x 2 x sd d f x 1 x 2 2 k bk r q 1 q 2 d 1 d 2 k r 1 2 r and k 1 r 1 2 r k x 1 x 2 x ms k x 1 x 2 c haar bases and dyadic structure theorems 31 where ms is the strong maximal function on x and c is a constant to be determined later now by the haar expansion convergent in l 2 x and since each rectangle r d 1 d 2 belongs to exactly one set bk we have f q 1 q 2 d 1 d 2 mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 hu 1 q 1 h u 2 q 2 k q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 hu 1 q 1 h u 2 q 2 k kak where ak x 1 x 2 1 k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 hu 1 q 1 x 1 h u 2 q 2 x 2 and k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 1 2 k 1 2 to see that the atomic decomposition k kak converges to f in the l 2 norm we only need to show that k kak 2 0 as this follows from the following duality argument let g l 2 with g 2 1 then k kak 2 sup g 2 1 k kak g note that k kak g k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 g hu 1 q 1 h u 2 q 2 applying h lder s inequality gives k kak g k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 1 2 k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 g hu 1 q 1 h u 2 q 2 2 1 2 note again that k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 g hu 1 q 1 h u 2 q 2 2 1 2 c g 2 c and k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 1 2 tends to zero as tends to infinity this implies that k kak 2 0 as and hence the series k kak converges to f in the l 2 norm 32 anna kairema ji li m cristina pereyra and lesley a ward next it is easy to see that for each k supp ak k since r bk implies that r k when we choose c 1 2 hence we see that condition 1 holds now for each k from the definition of k and the h lder s inequality we have ak l 2 x sup g g l 2 x 1 ak g 1 k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 g hu 1 q 1 h u 2 q 2 1 k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 1 2 r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 g hu 1 q 1 h u 2 q 2 2 1 2 k 1 2 which implies that condition 2 holds it remains to check that ak satisfies condition 3 of definition 6 3 to see this we can further decompose ak as ak r m k ak r where m k denotes the collection of maximal dyadic rectangles r d 1 d 2 contained in k and ak r x 1 x 2 1 k r q 1 q 2 bk r r mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 hu 1 q 1 x 1 h u 2 q 2 x 2 by definition we can verify that supp ak r r by the facts that hu 1 q 1 x 1 d 1 x 1 hu 2 q 2 x 2 d 2 x 2 0 we have for a e x 2 x 2 x 1 ak r x 1 x 2 d 1 x 1 0 and for a e x 1 x 1 x 2 ak r x 1 x 2 d 2 x 2 0 which yield that the conditions i and ii of 3 in definition 6 3 hold it remains to show that ak satisfies the condition iii of 3 to see this we first note that ak r 2 1 k r q 1 q 2 bk r r mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 hu 1 q 1 x 1 h u 2 q 2 x 2 2 from the definition of k by applying the same argument as for the estimates of ak 2 we can obtain that r m k ak r 2 l 2 k 1 2 which implies that condition iii holds we now prove that k k c f h 1 d 1 d 2 x haar bases and dyadic structure theorems 33 first note that by definition of k 1 and remark 5 10 k k 1 sd d f x 1 x 2 2 d 1 x 1 d 2 x 2 2 2 k 1 k c 2 2 k 1 k moreover by the monotone convergence theorem and by remark 5 10 we have k k 1 sd d f x 1 x 2 2 d 1 x 1 d 2 x 2 k k 1 r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 q 1 x 1 q 2 x 2 d 1 x 1 d 2 x 2 r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 k k 1 r r 1 2 r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 since r bk implies that k 1 k 1 r r 2 from the definition of k we have k k c k r q 1 q 2 bk mq 1 u 1 1 mq 2 u 2 1 f hu 1 q 1 h u 2 q 2 2 1 2 k 1 2 c k 2 k 1 k 1 2 k 1 2 c k 2 k k c f h 1 d 1 d 2 x conversely suppose f k kak where each ak is an atom of h 1 d 1 d 2 x as in defini tion 6 3 and k k c then sd d f x 1 x 2 sd d k kak x 1 x 2 k k sd d ak x 1 x 2 it suffices to estimate the l 1 x norm of sd d ak x 1 x 2 for the sake of simplicity we drop the subscript k for the atom and now estimate sd d a l 1 x where a is a dyadic atom as in definition 6 3 with support now let r m 100 r we have sd d a l 1 x sd d a l 1 sd d a l 1 c it is obvious that sd d a l 1 1 2 sd d a l 2 c 1 2 a l 2 x c where c is a positive constant independent of a from the definition of the atom a we have sd d a l 1 c r m 100 r c sd d ar x 1 x 2 d 1 x 1 d 1 dx 2 34 anna kairema ji li m cristina pereyra and lesley a ward for each rectangle r q 1 q 2 that appears in this sum we have from the definition of the square function sd d ar that sd d ar x 1 x 2 q 1 d 1 q 2 d 2 m q 1 1 u 1 1 m q 2 1 u 2 1 ar hu 1 q 1 h u 2 q 2 q 1 x 1 q 2 x 2 2 1 2 now if q 2 is a child of q 2 then hq 2 is constant on q 2 and so ar h u 1 q 1 hu 2 q 2 q 1 q 2 ar x 1 x 2 h u 1 q 1 x 1 h u 2 q 2 x 2 d 1 x 1 d 2 x 2 q 1 c q 2 ar x 1 x 2 d 2 x 2 hu 1 q 1 x 1 d 1 x 1 0 by the cancellation property of ar similarly if q 1 is a child of q 1 then ar h u 1 q 1 hu 2 q 2 0 clearly if qi q i for i 1 or i 2 then the inner product is also zero thus sd d ar x 1 x 2 q 1 d 1 q 1 q 1 q 2 d 2 q 2 q 2 m q 1 1 u 1 1 m q 2 1 u 2 1 ar hu 1 q 1 h u 2 q 2 q 1 x 1 q 2 x 2 2 1 2 this implies that sd d ar x 1 x 2 is supported in r thus 100 r c sd d ar x 1 x 2 d 1 x 1 d 2 x 2 0 as a consequence we have sd d a l 1 x c where c is a positive constant independent of a then sd d f l 1 x k k sd d ak l 1 x c k k it remains to prove theorem 6 1 proof of theorem 6 1 first we prove the inclusionh 1 x 1 x 2 t 1 t 1 1 t 2 t 2 1 h 1 d t 1 1 d t 2 2 x 1 x 2 suppose f h 1 x 1 x 2 l 2 x 1 x 2 from theorem 5 4 we obtain that f j jaj where each aj is anh 1 x 1 x 2 atom as defined in definition 5 3 and j j c f h 1 x 1 x 2 thus from the definition 5 3 we see that aj is supported in an open set j x 1 x 2 with finite measure moreover aj r m j aj r where each aj r is supported in cr since r is a dyadic rectangle we have r qk 1 1 q k 2 2 for some k 1 k 2 z and 1 ak 1 and 2 ak 2 thus from the definition of the dyadic cubes in section 2 1 we further have r b xk 1 1 c 1 k 1 b xk 2 2 c 2 k 2 as a consequence we obtain that suppaj r is contained in b xk 1 1 cc 1 k 1 b xk 2 2 cc 2 k 2 cr next from lemma 4 12 in hk we see that b xk 1 1 cc 1 k 1 must be contained in some qt 11 k 1 1 d t 1 for some t 1 in 1 2 t 1 similarly b x k 2 2 cc 2 k 2 must be contained in qt 22 k 2 2 d t 2 for some t 2 in 1 2 t 2 moreover there exists a constant c such that qt 11 k 1 1 c b x k 1 1 cc 1 k 1 and that qt 22 k 2 2 c b x k 2 2 cc 2 k 2 as a consequence supp aj r is contained in q t 1 1 k 1 1 q t 2 2 k 2 2 haar bases and dyadic structure theorems 35 thus we can divide the summation aj r m j aj r as follows aj t 1 t 1 1 t 2 t 2 1 r m j cr q t 1 1 k 1 1 q t 2 2 k 2 2 aj r we now set aj t 1 t 2 r m j cr q t 1 1 k 1 1 q t 2 2 k 2 2 aj r then we can verify that aj t 1 t 2 is anh 1 dt 1 dt 2 x 1 x 2 atom moreover ft 1 t 2 j jaj t 1 t 2 h 1 dt 1 dt 2 x 1 x 2 with ft 1 t 2 h 1 d t 1 dt 2 x 1 x 2 j j c f h 1 x 1 x 2 hence we obtain that f j jaj t 1 t 1 1 t 2 t 2 1 ft 1 t 2 where ft 1 t 2 h 1 dt 1 dt 2 x 1 x 2 and t 1 t 1 1 t 2 t 2 1 ft 1 t 2 h 1 d t 1 dt 2 x 1 x 2 ct 1 t 2 f h 1 x 1 x 2 this implies that h 1 x 1 x 2 l 2 x 1 x 2 t 1 t 1 1 t 2 t 2 1 h 1 d t 1 1 d t 2 2 x 1 x 2 moreover note that h 1 x 1 x 2 l 2 x 1 x 2 is dense in h 1 x 1 x 2 we obtain that h 1 x 1 x 2 t 1 t 1 1 t 2 t 2 1 h 1 d t 1 1 d t 2 2 x 1 x 2 second we prove that h 1 d t 1 1 d t 2 2 x h 1 x for every t 1 1 t 1 t 2 1 t 2 to see this we now apply the atomic decomposition for the dyadic product hardy space h 1 d t 1 1 d t 2 2 x i e theorem 6 5 for f h 1 d t 1 1 d t 2 2 x l 2 x we have f k kak where each ak is a dyadic atom as in definition 6 3 and k k c f h 1 d t 1 1 d t 2 2 x note that the dyadic atom in definition 6 3 is a special case of the h 1 x atom we obtain that f h 1 x and that f h 1 x c f h 1 d t 1 1 d t 2 2 x which yields that h 1 d t 1 1 d t 2 2 x l 2 x h 1 x as a consequence we obtain that h 1 d t 1 1 d t 2 2 x h 1 x references aim h aimar construction of haar type bases on quasi metric spaces with finite assouad dimension anal acad nac cs ex f y nat buenos aires 54 2002 abi 05 h aimar a bernardis and b iaffei comparison of hardy littlewood and dyadic maxi mal functions on spaces of homogeneous type j math anal appl 312 1 2005 105 120 abi 07 h aimar a bernardis and b iaffei multiresolution approximations and unconditional bases on weighted lebesgue spaces on spaces of homogeneous type j approx theory 148 1 2007 12 34 abn 11 a h aimar a bernardis and l nowak dyadic fefferman stein inequalities and the equiv alence of haar bases on weighted lebesgue spaces proc roy soc edinburgh sect a 141 1 2011 1 21 abn 11 b h aimar a bernardis and l nowak equivalence of haar bases associated with different dyadic systems j geom anal 21 2 2011 288 304 ag h aimar and o gorosito unconditional haar bases for lebesgue spaces on spaces of ho mogeneous type proc spiee 4119 wavelet applications in signal and image processing viii 2000 556 563 36 anna kairema ji li m cristina pereyra and lesley a ward aht t c anderson t hyt nen and o tapiola weak a weights and weak reverse h lder property in a space of homogeneous type arxiv 1410 3608 ah p auscher and t hyt nen orthonormal bases of regular wavelets in spaces of homogeneous type appl comput harmon anal 34 2013 no 2 266 296 ber a bernard espaces h 1 de martingales deux indices dualit avec les martingales de type bmo french bull sci math 2 103 1979 no 3 297 303 buc s m buckley summation conditions on weights michigan math j 40 1993 153 170 cha s y a chang carleson measure on the bi disc annals of math 109 1979 no 3 613 520 cf s y a chang and r fefferman a continuous version of duality of h 1 with bmo on the bidisc annals of math 112 1980 no 1 179 201 clw p chen j li and l a ward bmo from dyadic bmo via expectations on product spaces of homogeneous type j funct anal 265 2013 2420 2451 chr m christ a t b theorem with remarks on analytic capacity and the cauchy integral colloq math 60 61 1990 no 2 601 628 cw 71 r r coifman and g weiss analyse harmonique non commutative sur certains espaces homog nes tude de certaines int grales singuli res french lecture notes in mathematics vol 242 springer verlag berlin 1971 cw 77 r r coifman and g weiss extensions of hardy spaces and their use in analysis bull amer math soc 83 1977 569 645 djs g david j l journ and s semmes calder n zygmund operators para accretive func tions and interpolation rev mat iberoamericana 1 1985 no 4 1 56 dh d g deng and y han harmonic analysis on spaces of homogeneous type with a preface by yves meyer lecture notes in mathematics vol 1966 springer verlag berlin 2009 fs c fefferman and e m stein hp spaces of several variables acta math 129 1972 no 3 4 137 193 fef r fefferman bounded mean oscillation on the polydisk annals of math 110 1980 no 3 395 406 fj m frazier and b jawerth a discrete transform and decompositions of distribution spaces j funct anal 93 1990 no 1 34 170 gcrf j garcia cuerva and j l rubio de francia weighted norm inequalities and related topics north holland new york ny 1985 gj j b garnett and p w jones bmo from dyadic bmo pacific j math 99 1982 no 2 351 371 gs m girardi and w sweldens a new class of unbalanced haar wavelets that form an uncon ditional basis for lp on general measure spaces j fourier anal appl 3 4 1997 457 474 h 94 y han calder n type reproducing formula and the tb theorem rev mat iberoamericana 10 1994 51 91 h 98 y han plancherel p lya type inequality on spaces of homogeneous type and its applications proc amer math soc 126 1998 no 11 3315 3327 hll y han j li and c c lin t 1 theorem on product carnot carath odory spaces arxiv 1209 6236 hlw y han j li and l a ward hardy space theory on spaces of homogeneous type via orthonormal wavelet bases submitted 2014 hlpw y han j li m c pereyra and l a ward equivalence of definitions of product bmo on spaces of homogeneous type in preparation hs y han and e t sawyer littlewood paley theory on spaces of homogeneous type and the classical function spaces mem amer math soc 110 1994 no 530 vi 126 pp hyt t hyt nen martingales and harmonic analysis preprint 2013 hk t hyt nen and a kairema systems of dyadic cubes in a doubling metric space colloq math 126 2012 no 1 1 33 joni f john and l nirenberg on functions of bounded mean oscillation comm pure appl math 14 1961 415 426 lpw j li j pipher and l a ward dyadic structure theorems for multiparameter function spaces rev mat iberoamericana to appear lin k c lin harmonic analysis on the bidisc ph d thesis ucla 1984 lsmp l d l pez s nchez j m martell and j parcet dyadic harmonic analysis beyond doubling measures adv in math 267 2014 44 93 maa o e maasalo the gehring lemma in metric spaces arxiv 0704 3916 v 3 ms r a mac as and c segovia lipschitz functions on spaces of homogeneous type adv in math 33 1979 257 270 arxiv 1410 3608 arxiv 1209 6236 arxiv 0704 3916 v 3 haar bases and dyadic structure theorems 37 mei t mei bmo is the intersection of two translates of dyadic bmo c r acad sci paris ser i 336 2003 1003 1006 nrv f nazarov a reznikov and a volberg the proof of a 2 conjecture in a geometrically doubling metric space indiana univ math j 62 2013 no 5 1503 1533 ns 04 a nagel and e m stein on the product theory of singular integrals rev mat iberoameri cana 20 2004 531 561 ns 06 a nagel and e m stein the b complex on decoupled boundaries in c n ann of math 2 164 2006 649 713 perw m c pereyra and l a ward harmonic analysis from fourier to haar american math ematical society providence ri 2012 pw j pipher and l a ward bmo from dyadic bmo on the bidisc j london math soc 77 2008 524 544 pwx j pipher l a ward and x xiao geometric arithmetic averaging of dyadic weights rev mat iberoamericana 27 2011 no 3 953 976 sw e sawyer and r wheeden weighted inequalities for fractional integrals on euclidean and homogeneous spaces amer j math 114 1992 813 874 ste e m stein harmonic analysis real variable methods orthogonality and oscillatory integrals princeton university press princeton nj 1993 tao t tao dyadic product h 1 bmo and carleson s counterexample short stories http www math ucla edu tao tre s treil h 1 and dyadic h 1 in linear and complex analysis dedicated to v p havin on the occasion of his 75 th birthday ed s kislyakov a alexandrov a baranov advances in the mathematical sciences 226 2009 ams 179 194 war l a ward translation averages of dyadic weights are not always good weights rev mat iberoamericana 18 2002 379 407 wei d weirich forthcoming phd dissertation university of new mexico department of mathematics and statistics p o b 68 gustaf h llstr min katu 2 fi 00014 university of helsinki finland e mail address anna kairema helsinki fi department of mathematics macquarie university nsw 2019 australia e mail address ji li mq edu au department of mathematics and statistics university of new mexico albuquerque nm 87131 usa e mail address crisp math unm edu school of information technology and mathematical sciences university of south aus tralia mawson lakes sa 5095 australia e mail address lesley ward unisa edu au http www math ucla edu tao 1 introduction 2 systems of dyadic cubes 3 dyadic structure theorems for maximal functions and for weights 4 explicit construction of haar functions and completeness 5 definitions and duality of dyadic h 1 d x 0365 x and dyadic bmod x 0365 x 6 dyadic structure theorems for h 1 x 0365 x and bmo x 0365 x references