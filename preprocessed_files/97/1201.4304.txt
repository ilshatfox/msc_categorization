ijcsi international journal of computer science issues vol 8 issue 6 no 3 november 2011 issn online 1694 0814 www ijcsi org 163 improving security levels of ieee 802 16 e authentication by diffie hellman method mohammad zabihi 1 ramin shaghaghi 2 mohammad esmail kalantari 3 1 department of electrical engineering islamic azad university shahre rey branch tehran iran 2 department of electrical engineering islamic azad university shahre rey branch tehran iran 3 department of electrical engineering islamic azad university shahre rey branch tehran iran abstract in this paper we proposed an authentication method according to diffie hellman first we introduce different methods for authentication in ieee 802 16 then we proposed an authentication method according to diffie hellman and in the last we compare different methods for authentication to improve security in ieee 802 16 e cpn is a useful for simulation and compare protocol together so we use cpn tools in this paper keywords wimax authentication color petri net pkm diffie hellman 1 introduction the importance of ieee 802 16 worldwide interoperability for microwave access wimax is growing and will complete with technologies such as 3 g the acceptance and adoption of technologies also depend on security ieee 802 16 wimax standard consists of a protocol stack with well defined interfaces the wimax protocol layer contains mac layer and phy layer mac layer includes three sub layers contain of the service specific convergence sub layer mac cs the mac common part sub layer mac cps and the security sub layer or privacy sub layer the former ieee 802 16 standards used the privacy and key management pkm protocol which had many critical drawbacks in ieee 802 16 e a new version of this protocol called pkmv 2 is released the authentication and key management protocols are specified in the security sub layer of ieee 802 16 standard the security sub layer is meant to provide subscribers with privacy and authentication and operators with strong protection from theft of service authentication options are unilateral authentication mutual authentication and no authentication sections ieee s 02 16 e 2005 standard states that pkm has two versions pkmvl and pkmv 2 and it allows for four types of authentication a rsa base authentication pki system public key infrastructure eap based authentication optional rsa based authentication followed by eap authentication diffie hellman base authentication 2 rsa base authentication protocol 2 1 pkmv 1 authentication protocol ss uses message 1 formally named as the authentication information message to push its x 509 certificate which identifies its manufacturer to bs bs uses this certificate to decide whether ss is a trusted device bs may use this message in order to allow access only to devices from recognized manufacturers according to its security policy ss sends message 2 named as the authorization request immediately after message 1 figure 1 message 2 consists of ss s x 509 certificate with the ss public key its security capabilities which are actually the authentication and encryption algorithms that ss support and the security association identity said which is the id of the secure link between ss and bs using the certificate bs determines whether to authorize ss and the public key of ss which is also in the certificate lets bs construct message 3 1 if successful namely ss is authorized after bs verifies its certificate bs responds with message 3 the authorization reply this message includes the ak encrypted using the rsa public key encryption protocol using the public key of ss which was obtained in the previous message the lifetime of the ak as a 32 bit ijcsi international journal of computer science issues vol 8 issue 6 no 3 november 2011 issn online 1694 0814 www ijcsi org 164 unsigned number in unit of seconds the sequence number for ak as a 4 bit value and the list of sa descriptors each including an said and the sa cipher suit 1 fig 1 pkmv 1 authentication protocol 2 2 pkmv 2 authentication protocol the latest standard ieee 802 16 e 2005 includes a new version pkmv 2 of the protocol that caters for the shortcomings of the first version pkmv 2 supports two different mechanisms for authentication the ss and the bs may use rsa based authentication or extensible authentication protocol eap based authentication we will focus in this paper on rsa based authentication for pkmv 2 authentication protocol the flow of messages exchange in rsa based authentication is shown as follows figure 2 the ss initiates the rsa based mutual authentication process by sending two messages the first message contains the manufacturer x 509 certificate the second authorization request message contains the ss s x 509 certificate 64 bit ss random number ns list of security capabilities that the ss supports the said and the ss signature if the ss is authenticated and authorized to join the network the bs sends an authorization reply message in the response message the bs includes the 64 bit ss random number ns received its own 64 bit random number nb a 256 bit key pre primary authorization key pre pak encrypted with the ss s public key the pre pak key lifetime and its sequence number a list of saids one or more the bs s x 509 certificate and bs s signature in the authorization reply the ss verifies liveness by comparing the ns it sent with the received ns in the authorization response message it then extracts the pak because only the authorized ss can extract the pak this can be used as a proof of authorization finally the last message of this authentication is send by the ss to confirm the authentication of the bs the ss includes the bs random number nb received in the authorization response message used to proof liveness the ss s mac address and a cryptographic checksum of the message at the end of the rsa authorization exchange both ss and bs are authenticated by each other 5 fig 2 pkmv 2 authentication protocol the extensible authentication protocol eap is an authentication framework that is widely used in wifi 802 11 and wimax 802 16 wireless networks eap is a basis to transfer authentication information between a client and a network it provides a basic request response protocol framework over which to implement a specific authentication algorithm so called eap method commonly used eap methods are eap md 5 eapleap eap tls eap ttls and eap peap within the eap framework three entities are involved in the authentication process supplicant authenticator and authentication server the supplicant is a user that is trying to access the network it is also known as the peer the authenticator is an access point ap that is requiring eap authentication prior to granting access to a network it provides users a point of entry into the network the authentication server as is the entity that negotiates the use of a specific eap method with an eap supplicant then validates the supplicant and authorizes access to the network fig 3 eap tls base authentication ijcsi international journal of computer science issues vol 8 issue 6 no 3 november 2011 issn online 1694 0814 www ijcsi org 165 typically the supplicant is a mobile station ms and the authentication server is a remote authentication dial in user service radius figure 3 shows the brief message flow of eap tls in a wlan network the ap creates a radius access request using the supplicant s identity and sends it to the as the as then provides its certificate to the supplicant and asks for the supplicant s certificate the supplicant provides its certificate to as if the received as s certificate is valid after the as validates the supplicant s certificate it will send the result message radius access success failure to deny or permit access to the network 3 4 proposed protocol diffie hellman key exchange d h is a cryptographic protocol that allows two parties that have no prior knowledge of each other to establish together a shared secret key over an insecure communications channel then they use this key to encrypt subsequent communications using a symmetric key cipher the scheme was first published publicly by whitfield diffie and martin hellman in 1976 the diffie hellman exchange by itself does not provide authentication of the communicating parties and is thus susceptible to a man in the middle attack an attacking person in the middle may establish two different diffie hellman key exchanges with the two members of the party a and b appearing as a to b and vice versa allowing the attacker to decrypt and read or store then re encrypt the messages passed between them a method to authenticate the communicating parties to each other is generally needed to prevent this type of attack 2 as shown in figure 4 as sends a request message to the bs that includes the certificate then the as responds this message by sending cert bs p nonce h ybs f nonce to a being a rsa encryption p can encrypt nonce and user a can decrypt to receive nonce fig 4 proposed protocol now nonce is shared by ms and bs and then as sends yms h yms nonce to bs bs calculates h yas nonce if h yas nonce is equal to h yas nonce bs believes this message sent by as or interrupts this communication similarly as calculates h ybs f nonce by ybs and from as if h ybs f nonce is equal to h ybs f nonce as believes this message sent by bs and calculates the k ya xb mod q or interrupts this communication after a sends a massage h nonce as a confirmation signal to bs as and bs calculate the ak yas xbs mod q ybs xas mod q 1 5 threat analysis intercepts messages during the process of communication establishment or a public key exchange and then retransmits them tampering the information contained in the messages so that the two original parties still appear to be communicating with each other in a man in the middle attacks the intruder uses a program that appears to be the access point ap to ss and appears to be the ss to ap denial of service dos attack is an incident in which a subscriber is deprived of the service of a resource they would normally expect to have a considerable amount of denial of service attacks implement across the internet by flooding the propagation medium with noise and forge messages the victim is overwhelmed by the sheer volume of traffic with either its network bandwidth or its computing power exhausted by the flood of information almost all the dos vulnerabilities in mobile wimax standard are due to unauthenticated or unencrypted management messages we discussed these vulnerabilities in three processes the initial network process resource saving process and handover process 7 eavesdropping of management messages is a critical threat for users and a major threat to a system for example an attacker could use this vulnerability to verify the presence of a victim at its location before perpetrating a crime additionally it might be used by a competitor to map the network another major vulnerability is the encryption mode based on data encryption standard des the 56 bit des key is easily broken with modern computers by brute force attack furthermore the des encryption mode includes no message integrity or replay protection functionality and is thus vulnerable to active or replay attacks the secure aes encryption mode should be preferred over des eavesdropping mostly affects the transfer of information and rarely causes system outage the assessment of the eavesdropping threat is minor to the system but high for the user 8 in table 1 we show vulnerability for each method the proposed authentication protocol has best function in comparison with other protocol ijcsi international journal of computer science issues vol 8 issue 6 no 3 november 2011 issn online 1694 0814 www ijcsi org 166 6 protocol analysis by cpn we used a petri net to model our security protocol colored petri nets cp nets or cpns is a graphical we used a petri net to model our security protocol colored petri nets cp nets or cpns is a graphical language for constructing models of concurrent systems table 1 attack in authentication protocol attack pkmv 2 with nonce eap proposed protocol mitm about weak resistant resistant replay about weak resistant resistant interception resistant resistant resistant and analysing their properties cpnets is a discrete event modeling language combining petri nets and the functional programming language cpn ml which is based on standard ml a cpn model of a system describes the states of the system and the events transitions that can cause the system to change state by making simulations of the cpn model it is possible to investigate different scenarios and explore the behaviors of the system very often the goal of simulation is to debug and investigate the system design cp nets can be simulated interactively or automatically 11 petri nets are composed from graphical symbols designating places shown as circles transitions shown as rectangles and directed arcs shown as arrows the petri net model is illustrated in figure 7 the model is simulated with the time color petri net simulation tool the basic information about the size of the state space and standard behavioral properties of the cpn model can be found in the state space report for the cpn model of the proposed protocol in this study the state space report is shown in figure 6 as shown in figure 6 we have data about state space statistics strongly connected component scc graph liveness properties dead markings dead transition instances and live transition instances the state space statistics inform about the size of the state space for the model of proposed protocol there are 11 nodes and 10 arcs if the nodes and arcs in the state space and scc graph are equal it means that there are no cycles in the model the number of nodes and arcs in the state space and scc graph of two protocols are equal it means that the token will not fall in a loop and we have finite occurrence sequences a dead marking is a mark in which no element is enabled this means that the marking corresponding to node 11 in figure 7 is a dead marking a transition is live if from any reachable marking we can always find an occurrence sequence containing the transition as shown in figure 6 there are no live transitions 10 two protocols have a dead marking so they have not live transitions it is noted that no transition could be enabled from the dead marking also there are no dead transitions in two protocols a transition is dead if there is no reachable marking in which it is enabled there is no dead transition which means that each transition in the protocol has the possibility to occur at least once if a model has a dead transition then it fig 6 state space report corresponds to parts of the model that can never be activated hence we can remove dead transitions from the model without changing the behavior of it to compare the service delivery time of four protocols we assume that each transition in two protocols takes 5 time units 10 several different kinds of output can be generated for data collector monitors all of the data that is collected by a data collector can be saved in a data collector log file table 2 the log file also contains information about the steps and model times at which the data was collected 11 table 2 timed static for propose protocol 7 conclusion in this paper we have introduced a authentication protocol for wimax network the proposed protocol provides mutual authentication key exchange between ms and bs so the probability of some threats such as eavesdropping mitm and replay is reduced also we have compared the performance of proposed protocol with another protocols by using cpn tools it has been shown that by omission of some transactions the number of place and transition are reduced also the execution time is reduced significantly and the network resources are reserved the state space reports are shown in table 3 ijcsi international journal of computer science issues vol 8 issue 6 no 3 november 2011 issn online 1694 0814 www ijcsi org 167 table 3 state space statistic property pkmv 2 rsa eap proposed simulation step 7 13 10 model time 40 90 50 number of place 12 12 10 number of transition 5 9 5 state space nodes 10 19 11 state space arc 9 22 10 dead marking 20 21 22 6 19 11 fig 7 petri net model for proposed protocol references 1 e yuksel analysis of the pkmv 2 protocol in ieee 802 16 e 2005 using static analysis technical university of denmark feb 2007 2 n li research on diffie hellman key exchange protocol ieee 2010 3 l han a threat analysis of the extensible authentication protocol apr 2006 4 j hur h shim p kim h yun n oak song security considerations for handover shemes in mobile wimax networks ieee 2008 5 a taha a abdel hamid a tahar formal verification of ieee 802 16 security sublayer using scyther tools esrgroups france 2009 6 z you x xie w zheng verification and research of a wimax authentication protocol based on ssm icetc 2010 7 c j kaufman rocky mountain research lab boulder co private communication may 1995 8 m bogdanoski p latkoski a risteski b popovski ieee 802 16 security issues a survey telecommunication forum 2008 9 h tseng r hong jan w yang a chaotic maps base key agreement protocol that preseres user anonymity ieee icc 2009 10 m shaikhan a sobhani m e kalantari modification of mobile web shopping protocol using gaa and analysis by colored petri nets satccn 2011 11 k jensen l michael kristensen l wells coloured petri nets and cpn tools for modelling and validation of concurrent systems department of computer science 2008 12 j huang c tser huang secure mutual authentication protocols for mobile multi hop relay wimax networks against rogue base relay stations ieee 2011 ijcsi international journal of computer science issues vol 8 issue 6 no 3 november 2011 issn online 1694 0814 www ijcsi org 168 13 s sidharth m p sebastian a revised secure authentication protocol for ieee 802 16 e international conference on advances in computer engineering 2010 14 m holbal t welzer an improved authentication protocol based on one way hash functions and diffie hellman key exchange international conference on availability reliability and security 2009 15 f leu y huang c hong chiu improving security levels of ieee 802 16 e authentication by involving diffie hellman pkds international conference on complex intelligent and software intensive systems 2010 16 ergang liu kaizhi huang and liang jin the design of trusted access scheme base on identity for wimax network ieee computer society international workshop on education technology and computer science 2009 mohammad zabihi recived the b s in 1997 and m s degree in 2011 in communication engineering from islamic azad university shahre rey branch now he is an expert in telecommunication company his research interests include network security mobile communication and ngn networks ramin shaghaghi kandovan received the b s degree in electronic engineering from tehran university tehran iran in 1990 and m s and ph d degrees in communication engineering from islamic azad university tehran iran in 1993 and 2002 respectively he is currently an associate professor in communication engineering department of islamic azad university shahre rey branch his research interests include higher order statistics security in communication networks signal processing he has been the head of post graduate center of iau shahre rey branch since 2009 mohammad esmail kalantari received the b s degree in communication engineering from communication technical faculty tehran iran in 1972 and m s and ph d degrees in communication engineering from ecole national superieur des telecommunications enst paris france in 1979 and 1982 respectively he has been an assistant professor in electrical engineering department of khaje nasir toosi university of technology for 30 years now he is an academic member of islamic azad university shahre rey branch iran his research interests include security in communication networks next generation networks and mobile communication systems