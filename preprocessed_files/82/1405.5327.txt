analysis of series expansions for non algebraic singularities anthony j guttmann abstract existing methods of series analysis are largely designed to analyse the structure of algebraic singularities functions with such singularities have their nth coefficient behaving asymptotically as a n ng recently a number of problems in statistical mechanics and combinatorics have been encountered in which the coefficients behave asymptotically as b n n 1 ng where typically 12 or 1 3 identifying this behaviour and then extracting estimates for the critical parameters b 1 and g presents a significant numerical challenge we describe methods developed to meet this challenge 1 introduction the method of series analysis has for many years been a powerful tool in the study of many problems in statistical mechanics combinatorics fluid mechanics and computer science in essence the problem is the following given the first n coefficients of the series expansion of some function where n is typically as low as 5 or 6 or as high as 100 000 or more determine the asymptotic form of the coefficients subject to some underlying assumption about the asymptotic form or equivalently the nature of the singularity of the function typical examples include the susceptibility of the ising model and the generating function of self avoiding walks saws these are believed to behave as f z n cnz n c 1 z zc 1 in the ising case for regular two dimensional lattices the values of both zc and 7 4 are exactly known and the amplitude c is known to more than 100 decimal places in the saw case the value of zc is only known for the hexagonal lattice 8 and the value of 43 32 is universally believed but not proved the method of series analysis is used when one or more of the critical parameters is not known for example for the three dimensional versions of the above problems none of the quantities c zc or are exactly known from the binomial theorem it follows that cn c z nc n 1 2 1 ar x iv 1 40 5 53 27 v 1 m at h ph 2 1 m ay 2 01 4 here c zc and are referred to as the critical amplitude the critical point and the critical exponent respectively the aim of series analysis is to obtain as accurately as possible estimates of the critical parameters from the first n coefficients since obtaining these coefficients is typically a problem of exponential complexity the usual consequence is that fewer than 100 terms are known and in some cases far fewer 1 there are literally thousands of such problems in statistical mechanics combinatorics computer science and fluid mechanics and other areas where such a situation arises the methods to extract estimates of the critical parameters from the known series expansion largely fall into two classes one class is based on the ratio method initially developed by domb and sykes 7 and subsequently refined and expanded by many authors the second is based on analysing a differential equation the solution of which has an algebraic singularity 1 it is constructed so that the first n terms of the power series expansion of its solution precisely agree with the known expansion coefficients of the un derlying problem the first development of this nature was due to baker 1 based on taking pade approximants of the logarithmic derivative of known series this was then substantially extended by guttmann and joyce 17 who developed the method of differ ential approximants which is still the most successful method in use today for analysing series with algebraic singularities typified by 1 while as noted many problems have such an algebraic singularity structure an in creasing number of situations have been encountered in which a more complex singularity structure prevails those cases are characterised by coefficients with dominant asymptotics of the form bn c z nc n 1 ng 3 that is to say there is a sub dominant term n 1 giving rise to two additional parameters 1 and if 1 1 we can write down a generic generating function whose coefficients have this asymptotic behaviour but if 1 1 a generic generating function does not appear to be known at least not by the author an important caveat to this work is that as we argue below the exponent appearing in eqn 3 is a simple rational fraction indeed in all the situations we ve encountered it takes one of only three values 1 2 1 3 or 2 3 for the interacting partially directed self avoiding walk ipdsaw model defined in section 8 and more general models of the collapse transition in interacting walk models 20 there are powerful physical arguments based on the presence of a surface free energy that can be shown 9 to give rise to such a term with exponent d 1 d where d is the dimensionality of the system in other cases such as dyck paths counted by both length and height as discussed in section 7 probabilistic arguments 2 based on the expected behaviour in the scaling limit of the 1 in the case of the susceptibility of the two dimensional ising model polynomial time algorithms for enumerating the coefficients have been developed 26 5 and in that case we have hundreds of terms unfortunately this is a rare situation 2 r pemantle private communication 2 objects being counted can be used to prove that 1 3 the existence of such asymptotic behaviour has been proved in some cases for exam ple the coefficients of the exponential generating function egf of fragmented partitions 13 and the ordinary generating function ogf of dyck paths subjected to a compress ing force applied to the top most vertex discussed below in other cases one has field theoretical arguments such as those used by duplantier and colleagues 11 10 9 in their discussion of two dimensional collapsed dense polymers and multiple manhattan lattice walks and careful numerical work based on series expansions of an exact solution 2 of interacting partially directed self avoiding walks ipdsaw by owczarek et al 25 another important observation is that for functions whose coefficients have the asymp totic form 2 the underlying generating function has almost invariably an algebraic singularity of the form 1 for functions whose coefficients have the asymptotic form 3 the underlying generating function can be a well behaved d finite function as in the case of fragmented permutations or a function with a natural boundary as in the case of integer partitions as well as perhaps something in between of which we don t have an example so while for algebraic singularities one can perhaps carelessly fail to distinguish between the singularity and its asymptotic form one must be much more careful when discussing series whose coefficients behave like 3 for want of a better name we ll refer to these as non algebraic singularities while accepting that that describes a much wider class of singularities than those considered here in this work we develop methods to identify the asymptotic form of the coefficients assuming it is or 3 we will have nothing to say about the underlying singularity very recently my colleagues and i have come across several situations in which this generic asymptotic behaviour seems to arise in combinatorics the notoriously unsolved problem of 1324 pattern avoiding permutations has conjecturally this asymptotic be haviour 6 a number of two dimensional self avoiding walk saw problems in which the walk is subject to a compressive force also conjecturally have coefficients with this asymptotic form these include self avoiding bridges saws and polygons in these models we consider the situation in which the bridge walk polygon originates in a horizontal line the two variable generating function is g x y n h gn hx nzh where gn h is the number of objects of length n with maximal height y coordinate h if z 1 then squat broad objects are favoured over tall slim objects this then models a compressive force applied to the object for these models in the compressed regime there are physical arguments as alluded to above that make plausible the existence of the asymptotic structure 3 and these models will be discussed in future publications currently in preparation 3 3 a number of papers by various subsets of n beaton a j guttmann i jensen e j janse van rensburg and s g whittington are currently being written 3 given the increasingly frequent occurrence of problems where coefficients have such an asymptotic form it has become pressing to develop numerical techniques to estimate the various critical parameters that is the purpose of this article we first outline the two principal methods used to analyse algebraic singularities we then discuss how these methods behave when applied to the class of non algebraic singularity we are considering here naturally they fail in this case but the nature of their failure gives information about the true nature of the singularity we then show how the ratio method can be modified and extended to be useful in analysing these non physical singularities and how the method of differential approximants can also be applied to provide useful information in the next section we describe the traditional ratio method in the following two sections we describe the method of pade approximants and then the method of differential approximants das showing just how precise estimates can be obtained in favourable circumstances our main purpose here is to show just how good the da method is in estimating the critical parameters of algebraic singularities by contrast it performs very poorly when given a series possessing the type of non algebraic singularity considered here it is precisely this poor performance that indicates the presence of this type of singularity 4 in section 5 we discuss this particular non algebraic asymptotic behaviour and give a generic ogf that has coefficients with the appropriate asymptotic form when 1 1 we show how to modify and extend the ratio method so that it can be used in such situations we then discuss the application of the method of differential approximants to such non physical singularities and show how the coefficients can be transformed to new coefficients which behave to leading order like those of an algebraic singularity in subsequent sections we study three examples of increasing difficulty which are known to have non algebraic singularities with the asymptotic behaviour considered here our first example is a slightly modified version of the generating function for frag mented permutations the second is an analysis of dyck paths subjected to a compressing force at their top vertex and our final example is that of ipdsaws we then conclude by giving a method or more precisely a number of methods which collectively provide an effective recipe for analysing series expansions with coefficients of this non algebraic asymptotic form furthermore the methods provide effective tools for predicting that the asymptotic form is of the presumed type 2 ratio method the ratio method was perhaps the earliest systematic method of series analysis employed and is still a useful starting point prior to the application of more sophisticated methods 4 indeed this observation was the catalyst for this work our series analysis in a problem of compressed polygons we were studying behaved so uncharacteristically badly we were driven to find out why and this work is the result 4 0 00 0 05 0 10 0 15 1 n 2 8 3 0 3 2 3 4 3 6 3 8 4 0 4 2 r a t io s 1 z c figure 1 plot of ratios against 1 n for triangular lattice polygons a straight line through the last few data points intercepts the ratios axis at 1 zc it was first used by m f sykes in his 1951 d phil studies under the supervision of c domb from equation 2 it follows that the ratio of successive terms rn cn cn 1 1 zc 1 1 n o 1 n 4 from this idea it is then natural to plot the successive ratios rn against 1 n if the correc tion terms o 1 n can be ignored 5 such a plot will be linear with gradient 1 zc and intercept 1 zc at 1 n 0 as an example we apply the ratio method to the generating function of self avoiding polygons saps on the triangular lattice the first few terms in the generating function from p 3 to p 26 are 2 3 6 15 42 123 380 1212 3966 13265 45144 155955 545690 1930635 6897210 24852576 90237582 329896569 1213528736 4489041219 16690581534 62346895571 233893503330 880918093866 plotting successive ratios against 1 n re sults in the plot shown in figure 1 the critical point is estimated 21 to be at zc 0 240917574 1 4 15079722 from the figure one sees that the locus of points after some initial low n curvature becomes linear to the naked eye for n 15 or so cor responding to 1 n 0 067 visual extrapolation to 1 zc is quite obvious a straight line drawn through the last 4 6 data points intercepts the horizontal axis around 1 n 0 13 thus the gradient is approximately 4 1508 2 8 0 13 10 39 from which we conclude that the 5 for a purely algebraic singularity 1 with no confluent terms the correction term will be o 1 n 2 5 exponent 1 10 39 zc 2 50 it is believed 24 that the exact value is 3 2 which is in complete agreement with this simple graphical analysis various refinements of the method can be readily derived if the critical point is known exactly it follows from equation 4 that estimators of the exponent are given by n n zc rn 1 1 o 1 if zc is unknown estimates of the exponent can be obtained by defining estimators n of and extrapolating these against 1 n here n 1 n 2 1 rn rn 1 o 1 5 similarly if the exponent is known estimators of the critical point zc are given by z n c n 1 nrn zc o 1 one problem with the ratio method is that if the singularity closest to the origin is not the singularity of interest the so called physical singularity then the ratio method will not give information about the physical singularity worse still if the closest singularity to the origin is a conjugate pair of singularities the ratios will vary dramatically in both sign and magnitude to overcome this difficulty g a baker jr 1 proposed the use of pade approximants applied to the logarithmic derivative of the series expansion we should also mention that there exists a vast literature of extrapolation techniques in numerical analysis and many such methods can be advantageously applied to extrapolate the sequence of ratios in order to estimate the radius of convergence which is the critical point some of these methods applied to series analysis problems are discussed in the review 15 in particular the bulirsch stoer algorithm 4 has been found to be quite powerful as it allows for the more general situation when convergence is not linear in 1 n recall that for an isolated algebraic singularity convergence is always linear in 1 n so in that case the bulirsch stoer method affords no advantage we have used the bulirsch stoer method to estimate the radius of convergence in all the examples with non algebraic singularities that we consider below 3 pade approximants the basic idea of using pade approximants for series analysis is very simple given a function f z with a simple pole at some point zc we use the series expansion of f z to form a rational approximation to f z f z pi z qj z 6 6 where pi z and qj z are polynomials of degree i and j respectively whose coefficients are chosen such that the first i j 1 terms in the series expansion of f z are identical to those of the expansion of pi z qj z with qj 0 1 for uniqueness constructing the polynomials only involves solving a system of linear equations in order to use the pade approximation scheme to reliably approximate an algebraic singularity rather than just a meromorphic functions we must first transform the series into a suitable form this brings us to the classic method called dlog pade approximation 1 if we have a function with expected behaviour typical of algebraic singular points as given by equation 1 then taking the derivative of the logarithm of f z gives f z d dz logf z zc z o 1 7 this form is perfectly suited for pade analysis as taking the logarithmic derivative has turned the function into a meromorphic function at least to leading order we see that an estimate of the critical point zc can be obtained from the roots of the denominator polynomial qj z while an estimate of the critical exponent is obtainable from the residue of the pade approximant to f z at zc that is lim z zc zc z pi z qj z 8 since f z f z f z we see that forming a dlog pade approximant is simply equivalent to seeking an approximation to f z by solving the first order homogeneous differential equation f z qj z f z pi z 0 this observation leads us directly to the more powerful and more general method of dif ferential approximants by noting that we can approximate f z by a solution to a higher order ode possibly inhomogeneous this method was first proposed and developed by guttmann and joyce 17 in 1972 and was subsequently extended to the inhomogeneous case by au yang and fisher 12 and hunter and baker 18 in 1979 the advantage of a higher order ode is that confluent singularities can be accommodated as well as a more complicated singularity structure in general functions that satisfy such an ode are called d finite or holonomic 4 differential approximants the generating functions of many lattice models in statistical mechanics and combina torics are often algebraic or otherwise given by the solution of simple linear odes this observation originally made in the context of the 2 d ising model is the origin of the 7 method of differential approximants the basic idea is to approximate a generating func tion f x by solutions of differential equations with polynomial coefficients the singular behaviour of such odes is a well known classical mathematics problem see e g 14 19 and the singular points and exponents are easily calculated even if globally the function is not describable by a solution of a such a linear ode as is usually the case one hopes that locally in the vicinity of the physical critical points the generating function is still well approximated by a solution to a linear ode an m th order differential approximant da to a function f z is formed by matching the coefficients in the polynomials qk z and p z of degree nk and l respectively so that the formal solution of the inhomogeneous differential equation m k 0 qk z z d dz kf z p z 9 agrees with the first n l k nk 1 series coefficients of f z constructing such odes only involves solving systems of linear equations the function f z thus agrees with the power series expansion of the generally unknown function f z up to the first n series expansion coefficients we normalise the da by setting qm 0 1 thus leaving us with n rather than n 1 unknown coefficients to find in order to specify the ode the choice of the differential operator z d dz in 9 forces the origin to be a regular singular point the reason for this choice is that most lattice models with holonomic solutions for example the free energy of the two dimensional ising model possess this property from the theory of odes the singularities of f z are approximated by zeros zi i 1 nm of qm z and the associated critical exponents i are estimated from the indicial equation if there is only a single root at zi this is just i m 1 qm 1 zi ziq m zi 10 details as to which approximants should be used and how the estimates from many approximants are combined to give a single estimate are given in 16 in the next sub section we give an example of the application of the method 4 1 the honeycomb sap generating function in this sub section we apply the method of differential approximants to the generating function for self avoiding polygons saps on the honeycomb lattice the generating func tion p x n 1 pnx 2 n is expected to have a dominant singularity const 1 x 2 x 2 c 2 on this lattice the critical point is known rigorously 8 and the critical exponent and some universal amplitude 8 table 1 critical point and exponent estimates for self avoiding polygons numbers in parentheses give the uncertainty in the last quoted digits l second order da third order da x 2 c 2 x 2 c 2 0 0 29289321854 19 1 50000065 41 0 29289321865 12 1 50000040 28 5 0 29289321875 21 1 50000010 59 0 29289321852 48 1 50000041 99 10 0 29289321855 23 1 50000060 48 0 29289321878 32 1 49999999 97 15 0 29289321859 19 1 50000054 43 0 29289321861 37 1 50000035 67 20 0 29289321866 15 1 50000038 33 0 29289321860 21 1 50000049 43 ratios are believed to be known exactly in table 1 we have listed the estimates for the critical point x 2 c and exponent 2 obtained from second and third order das we note that all the estimates are in agreement in that within error bars they take the same value from this we arrive at the estimate x 2 c 0 2928932186 5 10 10 and 2 1 5000004 1 10 6 the final estimates are in perfect agreement with the exact values 8 x 2 c 1 2 1 2 2 0 292893218813 and 2 3 2 not surprisingly the estimates improve as the number of available series terms increases this can be seen in the left panel of figure 2 where the estimates from third order das for x 2 c vs the highest order coefficient index n nmax used by the da are plotted each dot in the figure is an estimate obtained from a specific approximant as can be seen the estimates clearly settle down to the conjectured exact value solid line as n is increased and there is no evidence of any systematic drift at large n in the right hand panel we show the variation in the exponent estimates with the critical point estimates thus if one knows or conjectures either the exponent or critical point a more precise estimate of the other can be obtained the curve traced out by the estimates passes through the intersection of the lines given by the exact values the apparent branching into two arcs is probably spurious one of the reasons for giving this example is to show just how successful and precise the method is under favourable circumstances we argue that by contrast when the method behaves badly with poorly converged estimates of the radius of convergence and wildly varying exponent estimates that this is a signal that the underlying singularity is not an algebraic singularity in the next section we discuss other types of singularities that give rise to a more complicated asymptotic form 9 80 100 120 140 160 0 29289315 0 29289320 0 28289325 0 292893218 19 20 1 499996 1 499998 1 500000 1 500002 x 2 c 2 n x 2 c figure 2 plot of estimates from third order differential approximants for x 2 c vs the highest order term used and the right panel shows 2 vs x 2 c the straight lines are the exact predictions 5 functions with non algebraic singularities a number of solved and we claim unsolved problems that arise in lattice critical phenom ena and algebraic combinatorics have coefficients with a more complex asymptotic form with a sub dominant term o n 1 rather then o n g in fact the sub sub dominant term is of o ng perhaps the best known example of this sort of behaviour is the number of partitions of the integers though in that case the leading exponential growth term n is absent or equivalently 1 there are a number of models in mathematical physics that also have a more com plex asymptotic structure of the type we are discussing here in particular duplantier and saleur 11 and duplantier and david 10 studied the case of dense polymers in two dimensions and found the partition functions had the asymptotic form qn const n n 1 ng in 25 owczarek prellberg and brak investigated an exactly solvable model of interacting partially directed self avoiding walks ipdsaw for which the solution had previously been given by brak guttmann and whittington in 2 in particular they analysed a 6000 term series expansion for ipdsaws in the collapse regime and estimated 1 2 g 3 4 while 1 was found to at least 6 digit accuracy from 2 the value of is exactly known subsequently duplantier 9 pointed out that 1 2 is to be expected not only for ipdsaws but also for saws in the collapsed regime in subsection 8 we show that the methods we develop below can give good results using only about 100 terms occasionally 200 rather than 6000 used in 25 this is of practical importance as for many unsolved problems one typically only has 20 200 terms available 10 an example from combinatorics is given by the exponential generating function egf of fragmented permutations 6 13 which is f z exp z 1 z then with fn z n f z we have 13 p 563 fn e 2 n 2 e n 3 4 this follows from wright 27 28 who calculated the leading asymptotic form of the expansion of f z 1 z exp a 1 z a 0 0 11 for 1 wright s saddle point analysis yields zn f z nn 1 2 exp a 1 n 2 a 1 12 with n n a 1 1 this asymptotic form can be written as b n n 1 ng 13 where 1 exp a 1 1 1 so in particular 1 1 also 1 and g 1 2 1 for this situation with 1 1 the term involving n 1 rapidly dominates the term ng for any value of g however if 1 1 the term n 1 is eventually smaller than the contribution of the term ng for the situation 1 1 we are unaware of any analogue of wright s expansion that is to say we do not know what generic closed form expression analogous to 11 has an asymptotic expansion of the form 13 with 1 1 in the remainder of this paper we develop numerical methods to analyse functions whose coefficients have the asymptotic form given in eqn 13 based on extensions of the ratio method and the method of differential approximants we then take three ex amples of functions of increasing complexity with coefficients that are known to behave asymptotically as in eqn 13 and see how successful or otherwise the methods are 6 a fragmented permutation is an unordered collection of non empty sub permutations of a given permu tation for example there are three fragmented permutations of two elements 1 2 2 1 and 1 2 11 5 1 ratio method for non algebraic singularities if the coefficients of some generating function behave as bn b n n 1 ng 14 then the ratio of successive coefficients rn bn bn 1 is rn 1 log 1 n 1 g n 2 log 2 1 2 n 2 2 2 log 1 2 g log 1 2 n 2 3 log 3 1 6 n 3 3 o n 2 3 o n 2 15 in the examples considered in this paper as well as other examples encountered takes the simple values 1 2 or 1 3 when 1 2 15 specialises to rn 1 log 1 2 n g 1 8 log 2 1 n log 3 1 6 24 g log 1 48 n 3 2 o n 2 16 and when 1 3 to rn 1 log 1 3 n 2 3 g n log 2 1 18 n 4 3 2 6 g log 1 18 n 5 3 o n 2 17 so given a series if one applies the ratio method and finds the ratio plots are not linear and can be linearized by plotting the ratios against 1 n 1 with 1 2 or 1 3 then this suggests that the asymptotic form of the coefficients could well be of the type considered here from 15 one sees that rn 1 const n 1 18 accordingly a log log plot of rn 1 versus log n should be linear with gradient 1 we would expect an estimate of close to that which linearised the ratio plot estimating this way requires knowledge of or at worst a very precise estimate of the growth constant while is exactly known in the three examples considered below more generally is not known and must be estimated along with all the other critical parameters in order to estimate without knowing we can use one or both of the following estimators from eqn 15 it follows that r n rn rn 1 1 1 log 1 n 2 o 1 n 2 19 12 so can be estimated from a log log plot of r n against n another estimator of follows from eqn 14 a n b 1 n n b 1 n 1 n 1 1 1 log 1 n 2 o 1 n 2 20 so again can be estimated from a log log plot of a n against n while these two estimators are equal to leading order they differ in their higher order terms and indeed as shown below which of the two is more informative varies from problem to problem 5 2 direct fitting for non algebraic singularities another perhaps obvious idea is to try and fit the critical parameters directly to the assumed asymptotic form the assumed asymptotic form is bn b n n 1 ng therefore log bn logb n log n log 1 g log n 21 so if is known or assumed we have four unknowns in this linear equation it is then straightforward to solve the linear system log bk c 1 k c 2 k c 3 log k c 4 for k n 2 n 1 n n 1 with n ranging from 3 to n 1 where n is the power of the highest known series coefficient then c 1 estimates log c 2 estimates log 1 c 3 estimates g and c 4 gives estimators of logb an obvious variation arises in those cases where say is known then one can solve bk k log c 2 k c 3 log k c 4 from three successive coefficients as before increasing the order of the lowest used coefficient by one until one runs out of coefficients 5 3 using the method of differential approximants in this sub section we investigate the use of the method of differential approximants in the analysis of series with asymptotic coefficients of the form 3 we will see in our first example a modified version of the generating function for fragmented permutations that the egf is in fact holonomic satisfying a first order linear ode so an appropriately 13 chosen differential approximant will solve this problem completely based on only a few terms in the series expansion so this is not a testing example our second example that of height weighted dyck paths is more typical if one simply applies the method of differential approximants the results discussed in section 7 suggest that the generating function is not well approximated by a linear ode of the assumed type and hence that the singularity is not likely to be algebraic this behaviour is typical of those cases where the singularity is not of the assumed algebraic type that is to say in such cases one typically sees imprecise and inaccurate estimates of the critical point unrealistic values of the associated critical exponent and sometimes a concentration of other critical points along the real axis this behaviour is characteristic of the situation in which the differential approximants are trying unsuccessfully to represent the singularity ies of the coefficients of the underlying generating function earlier in this section we discussed wright s function 11 which generates coefficients of the asymptotic form 3 considered here however as discussed wright s function only generates asymptotic forms for its coefficients when 1 1 for those situations when 1 1 wright s function does not generate coefficients of the required asymptotic form indeed if one asks the natural question what ogf has coefficients with asymptotic behaviour const 4 n n 1 31 ng where 1 1 the answer seems to be unknown 7 we can partially side step this difficulty by constructing an ogf with coefficients which are just the reciprocals of the original coefficients for if cn const n n 1 ng then dn 1 cn const n 1 1 n n g so if 1 1 the coefficients are now of a form given by the asymptotic expansion of wright s function unfortunately this new generating function maps singularities that were previously beyond the radius of convergence in the original series closer to the origin than the mapped physical singularity and if there are several of these they dominate the asymptotic behaviour note that if we take the logarithmic derivative of wright s function 11 we obtain f z d dz logf z f z f z 1 z a 1 z 1 22 f z now has algebraic singularities and so might be amenable to analysis by the method of differential approximants that is to say we might expect the logarithmic derivative of the ogf of the reciprocal series to behave as a function with algebraic singularities at z 1 and with exponents 1 a simple pole and a dominant branch point with exponent 1 numerical experiments show that these transformations taking the logarithmic derivative of the ogf with reciprocal coefficients substantially improve the performance of the differential approximants method for the analysis of non physical singularities of the assumed type but while useful are not as accurate as we need for a reliable method fortunately we have developed a different transformation that is more effective 7 it is certainly not given by wright s ogf with a 0 for in that case the coefficients actually change sign with a known periodicity 14 5 4 transforming series to remove the factor n 1 as noted above the method of differential approximants is of limited use in analysing series which are not dominated by an algebraic singularity for those series with coefficients with the asymptotic form considered here it is the presence of the n 1 term that is responsible for the lack of applicability of the method however we can manipulate the series to remove the offending term and then use this powerful method from eqn 21 one has when 1 2 log bn logb n log n log 1 g log n o 1 n then with b n log bn n we can form new coefficients cn cn 2 n 3 2 b n b n 1 2 g logb n log g log n o 1 n 23 exponentiating these coefficients we have dn exp cn d n n g 1 o 1 n where d e 2 g b when 1 3 one has log bn logb n log n 1 3 log 1 g log n o 1 n 1 3 then defining b n bn n 1 3 one has cn 3 2 n 4 3 b n b n 1 3 g logb 2 n log g 2 log n o 1 n 1 3 24 so in this case dn exp cn d n n g 2 1 o 1 n 1 3 where d e 3 g 2 b in this way we have transformed the series to one whose coefficients dn behave asymp totically at least to leading order like a function with an algebraic singularity we can therefore analyze the series with transformed coefficients dn by the method of differential approximants das note however that the correction terms are o 1 n whereas for an isolated algebraic singularity they are o 1 n so one can t expect the standard methods like the method of differential approximants to perform as well with the transformed series as say the example in section 4 1 we can also apply other standard techniques to the analysis of the transformed series the ratios of successive terms dn of the transformed series when plotted against 1 n are now linear but as the simple ratio method doesn t give us a particularly accurate estimate of we don t give the results here rather we extrapolate the ratios of the coefficients 15 of the transformed series using the bulirsch stoer algorithm with parameter w 1 as appropriate for an expected correction term o 1 n in order to estimate the critical exponent g we also tried the simple ratio method extrapolating estimators gn n 2 1 rn rn 1 of the exponent against 1 n as described at eqn 5 in summary it is clearly useful to transform the original series as described by eqns 23 24 and apply the standard methods of series analysis in the next three sections we will consider three problems whose coefficients have the assumed asymptotic form bn b n n 1 ng in all cases we first try to estimate the value of and after determining the value of the estimate of is refined next we estimate the other critical parameters 1 and g finally the amplitude term b is estimated 6 example 1 modified fragmented permutations we take as our first example a minor variant of the egf of fragmented permutations and consider f 1 z exp 2 z 1 2 z 25 then with fn z n f 1 z fn 2 n 1 e 2 n e n 3 4 26 f 1 z is clearly holonomic satisfying the simple ode 1 2 z 2 f 1 z 2 f 1 z f 1 0 1 but we don t make use of this in the subsequent analysis we have generated the series expansion of 25 up to the coefficient of z 50 to attempt an analysis 8 applying the ratio method 4 to these coefficients the resulting plot is shown in figure 3 a that is to say we plot the ratios rn fn fn 1 against 1 n unlike the case of an algebraic singularity with ratio plots shown in figure 1 here one sees considerable curvature in the plot this is the hallmark of the type of non algebraic singularity we are considering here we show in figure 3 b the same ratios but now plotted against 1 n this plot appears to be linear and also to be approaching the expected limit of 2 as n plotting the ratios against 1 n 2 3 not shown also gives a plot that looks almost as linear as figure 3 b 8 of course it is trivial to generate vastly longer series but a series of 50 terms is not atypical in those frequent cases where the coefficients have to be calculated by some algorithm of exponential complexity 16 a plot of ratios of coefficients of 25 against 1 n b plot of ratios of coefficients of 25 against 1 n figure 3 so trying to distinguish the correct value of in this way is not very precise the best we can do is to estimate that is in the range 0 4 0 7 in order to more accurately estimate the value of we show in figure 4 a a log log plot of rn 1 versus log n this is seen to be linear and the gradient calculated from the last two ratios r 49 and r 50 is 0 475 recall that this gradient should be 1 if one accepts that is a simple rational number the value of 1 2 is inescapable if we didn t know the value of we could estimate from the gradient of log log plots of r n see eqn 19 or a n see eqn 20 it turns out that they are equally good and we show in figure 4 b the estimate of given by the gradient of the line joining the points r k and r k 1 as k ranges from 15 to 50 there is some curvature in the plot but clearly a limit of 0 5 is attainable we extended the plot to 250 terms not shown and the curvature increased making the known limit 0 5 totally evident the point we want to make here is that if one wants to identify as a simple fraction likely to be 1 2 or 1 3 then we have good evidence that it is 1 2 this can then be used in subsequent analysis assuming that 1 2 we next refine the estimate of we could linearly extrapolate the ratio plot in figure 3 b which can be seen to be plausibly going to a value around 2 on the ordinate and we might guess that the value was exactly 2 however more generally does not take an integral nor perhaps even an algebraic value so it needs to be estimated quite precisely it is therefore necessary to use an extrapolation algorithm 17 table 2 last seven entries in each row of the table of bulirsch stoer extrapolants with w 1 2 each successive row is the result of a successively higher degree of extrapolation the available number of coefficients for extrapolation is n 50 in this example the highest order estimates and presumably most precise are all in the last column l t l n l 6 t l n l 5 t l n l 4 t l n l 3 t l n l 2 t l n l 1 t l n l 1 2 04480268 2 04389959 2 04303343 2 04220194 2 04140304 2 04063483 2 03989554 2 1 99676653 1 99688812 1 99700239 1 99710994 1 99721130 1 99730695 1 99739734 3 2 00011650 2 00011119 2 00010622 2 00010156 2 00009719 2 00009309 2 00008924 4 2 00000401 2 00000347 2 00000299 2 00000258 2 00000222 2 00000190 2 00000163 5 1 99999280 1 99999360 1 99999429 1 99999488 1 99999539 1 99999583 1 99999622 6 1 99999862 1 99999870 1 99999878 1 99999885 1 99999891 1 99999897 1 99999902 7 1 99999991 1 99999990 1 99999989 1 99999989 1 99999989 1 99999990 1 99999990 which can accommodate the expected asymptotic behaviour of the ratios the bulirsch stoer algorithm 4 is such an algorithm as it extrapolates sequences that behave as sn s c nw the parameter w is given by the user in this example we set w 1 2 and extrapolate the first 50 ratios the method produces rows of extrapolants that take into account successively higher powers of terms of order n w as well as terms of order n m where m 1 2 typically the first few rows behave smoothly while higher order rows become erratic we retain only those lower order rows which behave smoothly in the example given here in table 2 the first six rows behave smoothly by which we mean monotonically this is unusually good behaviour frequently rather fewer rows are monotonic there is a breakdown of monotonicity in the last row one would estimate from this table that the limiting value was 1 9999999 and it wouldn t be considered unreasonable to conjecture that the limit is exactly 2 we will continue the analysis assuming 1 2 and 2 in order to estimate the other parameters 1 and g in the asymptotic form 13 from 16 one has rn 2 1 log 1 2 n g 1 8 log 2 1 n o n 3 2 27 in order to estimate 1 and g we solve sequentially the pair of equations rj 2 1 c 1 j c 2 j 28 for j k 1 and j k with k ranging from 1 up to 50 the results are shown in figures 5 a and 5 b giving estimates of the parameters c 1 and c 2 respectively the first neglected term in 27 is o n 3 2 which is o 1 n smaller 18 a log log plot of rn 1 against n b estimators of from gradient ratios against 1 n figure 4 than the term with coefficient c 1 so c 1 is plotted against 1 n by a similar argument c 2 is plotted against 1 n a simple extrapolation literally with a straight edge gives the estimates c 1 1 00 and c 2 0 25 from 27 c 1 log 1 2 and c 2 g log 2 1 8 hence we estimate log 1 2 and g 0 75 as it happens one sees from eqn 26 that these values are exact we next tried the idea of direct fitting to the coefficients as described in subsection 5 2 recall that this involves fitting the logarithm of the coefficients to the assumed form and solving successive quartets of equations still using just 50 terms in the generating function 25 we estimate c 1 0 6932 implying 2 0001 recall that it is exactly 2 c 2 1 999 implying 1 exp 1 999 recall that it is exactly exp 2 c 3 0 77 compared to the exact value 0 75 and c 4 1 8 implying b 0 16 compared to the exact value b 0 17109 these estimates were obtained quite simply by plotting the successive estimates of each parameter against 1 n and visually extrapolating in each case without wishing to be too precise we expect errors to be confined to the last quoted digit fitting to three parameters imposing the fact that 2 is known or guessing it from the results of the above analysis the remaining parameters are estimated with significantly improved precision we estimate c 2 1 9995 c 3 0 75 and c 4 1 77 the exact value is 1 76556 next we apply the method of differential approximants to the transformed series as 19 a estimates of parameter c 1 of 28 against 1 n b estimates of parameter c 2 of 28 against 1 n figure 5 described in section 5 4 the approximants are found to be well converged and we estimate xc 1 0 49999989 which differs from the exact value in the 7 th decimal place and g 0 749 these are quite close to the exact values 1 2 and 3 4 respectively however this is not a particularly testing example as the original generating function is holonomic we also extrapolated the ratios of the coefficients of the transformed series using the bulirsch stoer algorithm with parameter w 1 as appropriate for an expected correction term o 1 n which arises when taking ratios we estimate 2 00000060 compared to the exact value 2 0 we can also use the transformed series to directly estimate the exponent g either imposing prior knowledge of the growth constant or not in this instance we did not assume the value of was known and so extrapolated estimators gn n 2 1 rn rn 1 of the exponent g against 1 n as described by eqn 5 in this way we estimated g 0 755 compared to the exact value 3 4 finally to estimate the amplitude we did the most obvious thing and divided the coef ficient fn by the terms we ve already identified in the asymptotics form of the coefficients that is we calculated the sequence bn fn n 3 4 2 n n 1 with 1 exp 2 extrapolating the first 50 values bn against 1 n 3 4 gave a straight line 20 which could be extrapolated just with a straight edge to give the estimate b 0 1705 the exact value is b 0 171099 so for this rather simple example we see that the suite of methods we have developed combine to give good numerical estimates of the critical parameters in the asymptotic form of the coefficients we emphasise that the estimates are predicated on correctly identifying the exponent 7 example 2 dyck paths enumerated by maximum height as the second example we consider the problem of dyck paths enumerated not just by length but also by height which we define to be the maximum vertical distance of a dyck path from the horizontal axis let dn h be the number of dyck paths of length 2 n and height h so the ogf is d x y n h dn hx 2 nyh then x 2 n d x y n h 1 dn hy h 29 for y 1 d x y const xc y 2 x 2 where xc y y y 1 and the constant is y dependent for y 1 the well known result is d x 1 1 1 4 x 2 2 and for y 1 the solution is usually given as an infinite sum of algebraic functions from which the asymptotic behaviour is difficult to extract however it is possible to do so 22 9 and with constants a 25 3 5 6 3 c 3 2 2 3 and r log y this is x 2 n d x y 1 y y 2 r 1 3 a 4 nn 5 6 e cr 2 3 n 1 3 1 o n 1 3 30 so for y 1 we see that coefficients of dyck paths indexed by length and height behave as 13 with b 1 y y 2 r 1 3 a 4 1 exp cr 2 3 13 and g 5 6 in the next subsection we will attempt to determine the critical parameters assuming the coefficients have the generic asymptotic behaviour 3 from the analysis of the series with y chosen to be 0 5 and using just 50 terms in the series we actually generated 2500 9 i posed this problem at an oberwolfach meeting in march 2014 within hours robin pemantle con firmed the subdominant behaviour n 1 3 1 and within 24 hours brendan mckay gave the complete solution of the dominant asymptotic behaviour given above subsequently nick beaton derived the sub dominant term 21 7 1 numerical analysis of dyck path series applying the method of differential approximants to the original series the very poorly converged approximants suggest the presence of a singularity at xc 0 2511 rather than 0 25000 and with critical exponent in the range 6 8 which is both an unlikely value and a very imprecise one furthermore the approximants suggest that there are other singularities on the real axis at x 0 256 with an exponent around 15 x 0 286 with an exponent around 12 x 0 328 with an exponent around 1 7 and poles at x 0 381 x 0 500 x 0 643 and x 110 so this is our first indication that the singularity is non algebraic accordingly we test for the plausibility that the appropriate asymptotic form of the coefficients are given by eqn 13 we assume that we don t know the asymptotic form 30 but just have the first 50 terms in the expansion for y 0 5 we repeat the analysis used for example 1 above we first try a simple ratio plot the result of which is shown in figure 6 a some curvature is evident though not as much as in figure 3 a which is not surprising as from 17 we expect the ratios to become linear when plotted against 1 n 2 3 whereas in the case of fragmented permutations the appropriate abscissa was 1 n in figure 6 b we show the ratios plotted against 1 n 2 3 which looks visually linear and also to be approaching the expected limit of 4 plotting the ratios against 1 n looks almost as linear and similarly to the previous example this crude linearity test only allows us to estimate the value of to be in the range 0 4 0 7 as in the previous example in order to better estimate the value of we show in figure 7 a a log log plot of 1 rn against log n this is seen to be linear and the gradient calculated from the last two ratios r 49 and r 50 is 0 675 if one accepts that is likely to be a simple rational number the value of 1 3 is the most compelling guess recall that the gradient of this plot should be 1 11 alternatively if we didn t know the value of we could estimate from the gradient of log log plots of r n see eqn 19 or a n see eqn 20 it turns out that estimators from 19 are decreasing below 1 3 only turning around after some 300 terms however estimators from 20 are quite informative and we show in figure 7 b the estimate of given by the gradient of the line joining the points a k and a k 1 as k ranges from 15 to 50 there is some curvature in the plot but clearly a limit of 1 3 is quite plausible again we see that if one wants to identify as a simple fraction likely to be 1 2 or 1 3 then we have good evidence that it is 1 3 this can then be used in subsequent analysis in the subsequent analysis we assume that 1 3 in this case we next require a good estimate of which from ratio plots we know to be around 4 as in the preceding 10 the exact solution does indeed appear to have singularities along the real axis x 1 4 and which are dense along that ray 11 a more detailed analysis can be conducted in which the estimates of the gradient formed from increasing successive pairs of ratios rn and rn 1 are extrapolated against 1 n and this does indeed give a value around 0 667 but we don t consider that refinement necessary for this example 22 a plot of ratios of coefficients of height weighted dyck paths with y 0 5 against 1 n b plot of ratios of coefficients of height weighted dyck paths with y 0 5 against 1 n 2 3 figure 6 a log log plot of 1 rn 4 against n b estimators of from a n ratios against 1 n figure 7 23 table 3 last seven entries in each row of the table of bulirsch stoer extrapolants each successive row is the result of a successively higher degree of extrapolation the available number of coefficients for extrapolation is n 50 in this example the highest order estimates and presumably most precise are all in the last column apart from the last entry l t l n l 6 t l n l 5 t l n l 4 t l n l 3 t l n l 2 t l n l 1 t l n l 1 4 05166625 4 05040592 4 04920422 4 04805741 4 04696196 4 04591457 4 04491214 2 4 01339530 4 01305370 4 01273785 4 01244288 4 01216455 4 01189944 4 01164488 3 4 00367431 4 00401802 4 00425109 4 00437641 4 00440515 4 00435326 4 00423894 4 4 00762463 4 00735417 4 00682191 4 00600406 4 00485767 4 00334352 4 00147659 5 4 00761475 4 00567628 4 00495234 4 00459579 4 00442333 4 00438206 4 00447112 example we can extrapolate the ratios using the bulirsch stoer algorithm this time with parameter w 2 3 the results are given in table 3 the first four rows behave smoothly by which we mean monotonically the monotonicity breaks down in the fifth row one would estimate from this table that the limiting value was around 4 001 and one might conjecture that the limit is exactly 4 if one uses 100 terms instead of 50 the last entries are around 4 0008 and slowly declining for the remainder of the analysis we assume 4 000 not much changes if we use 4 001 in order to estimate 1 and g recall that from 17 it follows that rn 4 1 log 1 3 n 2 3 g n o n 4 3 31 as in the previous example we solve sequentially the pair of equations rj 4 1 c 1 j 2 3 c 2 j 32 for j k 1 and j k with k ranging from 1 up to 50 the results are shown in figures 8 a and 8 b giving estimates of the parameters c 1 and c 2 respectively the first neglected term in equation 31 is o n 4 3 which is o 1 n 2 3 smaller than the term with coefficient c 1 so c 1 is plotted against 1 n 2 3 by a similar argument c 2 is plotted against 1 n 1 3 a simple extrapolation literally with a straight edge gives the estimate c 1 1 05 the plot for c 2 exhibits some curvature and the best we can estimate is c 2 1 from 17 c 1 log 1 3 and c 2 g hence we estimate log 1 3 15 and g 1 the exact values are log 1 3 175 and g 5 6 if we take 100 terms in the expansion instead of the 50 that we ve used this method gives the 24 a estimates of parameter c 1 of 28 against 1 n 2 3 b estimates of parameter c 2 of 28 against 1 n 1 3 figure 8 more accurate results log 1 3 171 and g 0 83 as we expect critical exponents to be simple rational fractions the exact value g 5 6 may well be guessed assuming 1 3 and directly fitting to the remaining parameters as described in subsection 5 2 above we estimate c 1 1 3868 implying 4 002 rather than the exact value of 4 c 2 3 28 rather than the exact value 3 175 c 3 is in the range 0 9 0 7 compared to the exact value of 5 6 and c 4 1 8 rather than the exact value of 2 1308 if in addition we assume that 4 and fit to the remaining three parameters we find c 2 3 20 rather than the exact value 3 175 c 3 0 78 compared to the exact value of 5 6 and c 4 1 95 rather than the exact value of 2 1308 we next considered the transformed series 24 the differential approximants applied to the transformed series while useful are not as well converged as those in the previous example with estimates of xc differing from the exact value in the 5 th decimal place allowing the useful estimate xc 0 24998 the corresponding exponent estimate is g 0 80 which can be compared to the correct value 0 83333 we extrapolated the ratios of the coefficients of the transformed series using the bulirsch stoer algorithm with parameter w 1 we estimate 4 00036 compared to the exact value of 4 0 this is more precise than the same analysis applied to the original series as in the previous example we estimated the exponent g by extrapolating estimators gn n 2 1 rn rn 1 against 1 n as described at eqn 5 for this example we estimate g 0 84 compared to the exact value of 5 6 25 finally to estimate the amplitude we did as with the first example and divided the coefficients by the terms we ve identified in the asymptotic form of the coefficients that is we calculated the sequence bn x 2 n d x y n 5 6 4 n n 1 31 with 1 taken to be in the range 0 0405 0 043 from the various estimates found above the exact value is 1 0 04179 extrapolating the first 50 values bn against 1 n 3 4 gave a straight line which could be extrapolated just with a straight edge to give an estimate of b in the rather broad range 7 3 9 6 this large variation is due entirely to the uncertainty in the value of 1 using the correct value of 1 leads to the estimate b 8 4 the exact value is b 8 42208 this example displays behaviour typical of that which we have encountered in other problems such as saws saps and bridges subject to a force it can be seen that the methods we have developed can clearly identify the nature of the singularity and also provide good estimates of the various critical parameters provided a sufficient number of coefficients is known 8 example 3 interacting partially directed self avoiding walks for our third and final example we consider ipdsaw these are random walks on the square lattice with both west steps and immediate reversals forbidden the two constraints immediately imply that the paths are self avoiding paths are counted by length and by the number of monomer monomer interactions which occur between adjacent sites that are not consecutive vertices of the walk the appropriate ogf is g x y n h cn mx nym where cn m is the number of n step ipdsaws with m monomer monomer interactions then xn g x y n m 1 cn my m 33 this model was solved in 2 let g 0 1 j 1 x 2 j x q jqj j 1 2 j i 1 xq i x xqi q 26 and g 1 x x j 1 x 2 j x q jqj j 1 2 qj j i 1 xq i x xqi q where q xy then for y 6 1 with a x 2 2 4 x and b x 2 6 4 x the solution is g x y 2 xg 1 ag 0 bg 0 2 xg 1 34 the asymptotic form of the coefficients is difficult to extract from 34 but based on an analysis of a 6000 term series owczarek prellberg and brak 25 conjectured the asymptotic form numerically as b n n 1 n 3 4 where both 1 and 1 1 depend on the monomer monomer interaction strength y in the collapsed regime y yc 3 383 recently nguyen and pe tre lis 23 have given a more probabilistic exposition of this problem which has the advantage that the term n 1 in the asymptotic form of the co efficients in the collapsed regime is seen as a natural consequence of the law governing a symmetric random walk as an aside we remark that pemantle s argument footnote 9 for a term of the form n 1 3 1 arising in the dyck path case just discussed is a consequence of the law for reflected brownian bridges we expanded 34 to obtain 100 terms in the series it was necessary to obtain some what longer series than in our previous examples as the low order terms involve no monomer monomer interactions and it is not until about length 20 that a significant num ber of interactions occur as shown in 2 the tricritical point occurs at xc yc 1 yc yc where yc 3 382975 for y yc there is a line of critical points lying on the hyperbola xy 1 as long as we choose a value of y yc we are in the so called collapsed regime where the coefficients have the asymptotic form 13 for simplicity we have chosen y 5 so the generating function g x 5 will have a critical point at xc 1 5 so 5 in eqn 13 in this example constructing differential approximants to the original series gives very poorly converged results which as discussed above is an indication that the underlying ogf does not have a dominant algebraic singularity the approximants suggest that the critical point is around 0 205 rather then 0 2 exactly with an exponent in the range 5 8 again this large numerical value for the exponent and its imprecision suggests that a non algebraic singularity is dominant as before we first plot the ratios of successive terms against 1 n as shown in figure 9 a some curvature is evident we next plot the same ratios in figure 9 b against 1 n and the plot is seen to be visually linear implying 1 2 to more accurately determine the value of we show in figure 10 a a log log plot of 1 rn against n this is seen to be linear and the gradient calculated from the last two ratios r 99 and r 100 is 0 532 if one accepts that is likely to be a simple rational number the value 1 2 is inescapable 12 12 with 200 terms the gradient estimate is improved to 0 522 27 a plot of ratios of coefficients of ipdsaws with y 5 against 1 n b plot of ratios of coefficients of ipdsaws with y 5 against 1 n figure 9 again if we didn t know the value of we could estimate from the gradient of log log plots of r n see eqn 19 or a n see eqn 20 it turns out in contrast to the situation with the previous example that estimators from 20 require hundreds of terms before a clear approach to the limit can be seen however estimators from 19 are quite informative though we still require 200 terms to draw any convincing conclusions we show in figure 10 b the estimate of given by the gradient of the line joining the points r k and r k 1 as k ranges from 100 to 200 there is some curvature and oscillation in the plot but clearly a limit of 1 2 is attainable once again we see that if one wants to identify as a simple fraction likely to be 1 2 or 1 3 then we have good evidence that it is 1 2 this can then be used in subsequent analysis in this plot we used the fact that we knew 5 exactly if we didn t we could linearly extrapolate the ratio plot in figure 9 b which can be seen to be plausibly going to an ordinate value around 5 as in the preceding examples we can also extrapolate the ratios using the bulirsch stoer algorithm this time with parameter w 1 2 the results are shown in table 4 only the first row behaves smoothly by which we mean monotonically the monotonicity breaks down already in the second row this is not totally surprising as this series behaves slightly erratically like the number of partitions of the integers the number of interactions is not a fixed fraction of the length and so low order ratio plots are 28 a log log plot of 1 rn 5 against n b estimators of from r n ratios against 1 n figure 10 a little erratic going from one term to the next though the global trend is uniform one might estimate from this table that the limiting value was around 5 00 and a brave person might conjecture that the limit is exactly 5 if one uses 200 terms instead of 100 the last entries are around 4 9995 assuming then that 1 2 and 5 from 16 it follows that rn 5 1 log 1 2 n g 1 8 log 2 1 n o n 3 2 as in example 1 in order to estimate 1 and g we solve sequentially the pair of equations rj 5 1 c 1 j c 2 j 35 for j k 1 and j k with k ranging from 2 up to 200 the results are shown in figures 11 a and 11 b simple visual extrapolation using the data points up to n 100 gives the estimate c 1 0 71 the plot for c 2 exhibits some curvature and the best we can estimate is c 2 0 65 from just 100 terms note the negative gradient when 1 n 0 1 from 16 these estimates imply log 1 1 42 and g 0 9 if we take 200 terms in the expansion instead of 100 we see that the plots have turning points at around n 100 and that with n 200 our estimate of c 2 is close to 0 4 the 200 term series lets us make the more precise estimates log 1 1 44 and 29 table 4 last seven entries in each row of the table of bulirsch stoer extrapolants each successive row is the result of a successively higher degree of extrapolation the available number of coefficients for extrapolation is n 100 in this example the highest order estimates and presumably most precise are in the last column l t l n l 6 t l n l 5 t l n l 4 t l n l 3 t l n l 2 t l n l 1 t l n l 1 5 06838354 5 06758779 5 06712079 5 06606462 5 06548413 5 06480880 5 06412456 2 5 00326229 5 00301024 5 02650700 4 98291297 5 01522399 5 00691875 5 00510306 a estimates of parameter c 1 of 35 against 1 n b estimates of parameter c 2 of 35 against 1 n figure 11 g 0 66 it turns out that we need some 500 terms in the series before we can confidently estimate g 0 750 we also estimated log 1 1 4396 from a 500 terms series this agrees with the analysis in 25 based on a 6000 term series though they claim a more accurate estimate of 1 which is not given for this example the direct fitting method was somewhat less successful as there is a substantial degree of oscillation in the plots of the various parameters due to parity effects as discussed above nevertheless the results were useful and if we use more than 100 terms quite good accuracy can be achieved but just using 100 terms assuming 1 2 and directly fitting to the remaining parameters as described in subsection 5 2 above we 30 estimate c 1 1 61 implying 5 003 rather than the exact value of 5 c 2 1 5 so log 1 1 5 rather than the more precise value 1 439 c 3 is in the range 1 4 0 5 compared to the exact value of 3 4 and c 4 4 rather than the actual value of around 0 8 if we assume that 5 and fit to the remaining three parameters we estimate c 2 1 415 so log 1 1 415 rather than the more precise value 1 439 c 3 0 6 compared to the exact value of 3 4 while c 4 1 4 is still a rather poor estimate if we use 200 terms the estimates improve to c 2 1 44 c 3 0 75 and c 4 0 9 for ipdsaws as discussed above the series do not behave smoothly at low order due to the rather granular way the number of interactions increases with the length of the walk so even the transformed series are not well suited to analysis by the method of differential approximants nevertheless the results of this approach are not without value the critical point is estimated to be at xc 0 2016 but with a second singularity very close by at x 0 208 the two singularities have associated exponents of opposite sign and varying magnitude so that g cannot be estimated this way we extrapolated the ratios of the coefficients of the transformed series using the bulirsch stoer algorithm with parameter w 1 for ipdsaw the bulirsch stoer extrapolants are as expected not monotonic but do quickly settle down to values in the range 4 9996 5 0010 in reasonable agreement with the exact value of 5 0 in order to estimate the critical exponent g we extrapolated estimators gn n 2 1 rn rn 1 of the exponent against 1 n as described at eqn 5 the extrapolants are not monotonic but do quickly settle down to values in the range 1 0 7 using 250 terms in the series allows the much more precise estimate g 0 78 and with 500 terms that improves to g 0 75 the exact value is g 3 4 note that these values were obtained without recourse to knowledge of the value of the growth constant as with the previous two examples we estimated the amplitude by dividing the coeffi cients by the terms we ve identified in the asymptotic form the uncertainty in the value of 1 again gives rise to a rather large uncertainty in the estimate of the amplitude b with the correct value of 1 or rather correct to four significant digits this procedure gave b 2 22 with a 100 term series the estimate was slightly improved to b 2 210 with a 700 term series this example represents the most difficult problem of this class one in which the coef ficients do not vary smoothly and yet one has a singularity of the non algebraic type that we are studying here despite this a clear indication of the nature of the singularity was obtained and reasonably accurate estimates of the critical parameters were also obtained provided one has sufficient series coefficients 31 9 general methods to analyse such series on the basis of these three examples and others we have studied but not discussed at length here we are now in a position to propose a method for analysing problems that may have coefficients of the assumed asymptotic form 3 make a plot of the ratios against 1 n if this plot is linear or approaching linearity as n increases this is suggestive of an algebraic singularity analyse the series by the method of differential approximants if one obtains well converged estimates of the position of the critical point s and exponent s and these are consistent with the ratio analysis this is further evidence for an algebraic singularity in those cases when the convergence is rapid and precise as in the example of hexagonal saps in section 4 1 one can have abundant confidence in this conclusion if however the differential approximants are not well converged and the associated exponent is poorly estimated and considered unlikely for a problem of the class be ing studied then there is good reason to doubt that the underlying singularity is algebraic if the ratio plot can be made linear by plotting the ratios against 1 n or 1 n 2 3 or other simple rational exponent 1 n 1 this is then further evidence suggesting that the asymptotic form is not algebraic but rather of the form 13 if one knows or can accurately estimate the radius of convergence xc then denoting the ratio of successive coefficients by rn a plot of log rnxc 1 against log n should give an estimate of the exponent needed to linearise the ratio plot this should be consistent with that found by choosing an exponent by trial and error to linearise the ratio plot otherwise if is unknown can be estimated from the gradient of log log plots of r n and or a n against n where these quantites are defined in eqns 19 and 20 respectively the bulirsch stoer or other appropriate extrapolation algorithm should be used to extrapolate the ratios of the coefficients in order to get a more reliable estimate of the growth constant if the bulirsch stoer algorithm is used the parameter w 1 where is estimated from the value needed to linearise the ratio plots the estimate of can then be used in a log log plot to refine the estimate of in this way a consistent pair of estimates of both and can be obtained once the exponent is well established a four parameter fit to the assumed asymp totic form as described in section 5 2 should be conducted using the best estimate of the critical point 1 this should be incorporated and a three parameter fit tried naturally parameter estimates by different methods should be mutually consistent 32 then an analysis which involves fitting successive pairs of ratios to rn xc 1 c 1 n 1 c 2 n and extrapolating estimates of c 1 and c 2 should be performed the estimates of c 1 and c 2 provide estimators of 1 and g if one has very many terms this can be taken further and successive triples of ratios can be used to estimate the coefficients ci i 1 2 3 in rn xc 1 c 1 n 1 c 2 n c 3 n 2 2 finally the series should be transformed to remove the factor n 1 as discussed in section 5 4 and the transformed series subject to standard analysis such as ratio analysis differential approximant analysis and ratio extrapolation by the bulirsch stoer algorithm the estimates of the critical parameters should be consistent with and hopefully more precise than those obtained by the other methods described 10 conclusion we have described a number of methods to distinguish between coefficients of a generating function with algebraic singularities and those with more complicated non algebraic sin gularities of the form b n n 1 ng we have developed methods to identify coefficients in this latter class and then shown how to extract estimates for the critical parameters b 1 and g our methods are based on extending the existing traditional methods for analysing algebraic singularities the ratio method and the method of differential approximants in the latter case we don t extend the method so much as its application the fairly natural idea of directly fitting to the asymptotic form is also investigated and found to be useful we illustrate these methods by applying them to three examples they are the gener ating functions of fragmented permutations of compressed dyck paths and of ipdsaws in subsequent papers of which 6 is the first we apply these ideas to previously unsolved problems 11 acknowledgements i would like to thank nick beaton andrew conway iwan jensen einar steingr msson and stu whittington for careful reading of the manuscript which resulted in very substantial improvement i have benefited from discussions with mireille bousquet me lou and bruno salvy on questions of singularities and asymptotic behaviour of coefficients for which i am grateful i m also grateful to robin pemantle and brendan mckay who sorted out the asymptotic behaviour of coefficients in the generating function for compressed dyck paths as discussed in section 7 i would also like to thank the australian research council who have supported this work through grant dp 120100939 33 references 1 g a baker jr application of the pade approximant method to the investigation of some magnetic properties of the ising model phys rev 124 768 774 1961 2 r brak a j guttmann and s g whittington a collapse transition in a directed walk model j phys a math gen 25 2437 2446 1992 3 b d mckay private communication 4 r bulirsch and j stoer fehlerabscha tzungen und extrapolation mit rationalen funk tionen bei verfahren vom richardson typus num math 6 413 427 1964 5 y b chan a j guttmann b g nickel and j h h perk the ising susceptibility scaling function j stat phys 145 545 590 2011 6 a r conway and a j guttmann on 1324 pattern avoiding permutations arxiv 2014 7 c domb and m f sykes on metastable approximations in co operative assemblies proc roy soc a 235 247 259 1956 8 h duminil copin and s smirnov the connective constant of the honeycomb lattice equals 2 2 ann of math 175 3 1653 1665 2012 9 b duplantier exact scaling form for the collapsed 2 d polymer phase phys rev lett 71 4274 1993 10 b duplantier and f david exact partition functions and correlation functions of multiple hamiltonian walks on the manhattan lattice j stat phys 51 327 434 1988 11 b duplantier and h saleur exact critical properties of two dimensional dense self avoiding walks nucl phys b 290 fs 20 291 326 1987 12 m e fisher and h au yang inhomogeneous differential approximants for power series j phys a 12 1677 1692 1979 13 p flajolet and r sedgewick analytic combinatorics cambridge up cambridge 2009 14 a r forsyth part iii ordinary linear equations vol iv of theory of differential equations cambridge up cambridge 1902 15 a j guttmann in phase transitions and critical phenomena vol 13 eds c domb and j lebowitz academic press london and new york 1989 34 16 a j guttmann and i jensen series analysis chapter 8 of polygons polyominoes and polycubes lecture notes in physics 775 ed a j guttmann springer heidelberg 2009 17 a j guttmann and g s joyce a new method of series analysis in lattice statistics j phys a 5 l 81 84 1972 18 d l hunter and g a baker jr methods of series analysis iii integral approximant methods phys rev b 19 3808 21 1979 19 e l ince ordinary differential equations longmans green and co london 1927 20 e j janse van rensburg the statistical mechanics of interacting walks polygons animals and vesicles oxford university press 2000 21 i jensen self avoiding walks and polygons on the triangular lattice j stat mech p 10008 2004 22 b mckay private communication 23 g b nguyen and n pe tre lis a variational formula for the free energy of the partially directed polymer collapse j stat phys 151 1099 1120 2013 24 b nienhuis exact critical point and exponent of the o n model in two dimensions phys rev lett 49 1062 1065 1982 25 a owczarek t prellberg and r brak new scaling form for the collapsed polymer phase phys rev lett 71 951 3 1993 26 w p orrick b g nickel a j guttmann and j h h perk the susceptibility of the square lattice ising model new developments j stat phys 102 795 841 2001 27 e m wright the coefficients of a certain power series j london math soc 7 256 262 1932 28 e m wright on the coefficients of power series having exponential singularities j london math soc 24 304 309 1949 35 1 introduction 2 ratio method 3 pad approximants 4 differential approximants 4 1 the honeycomb sap generating function 5 functions with non algebraic singularities 5 1 ratio method for non algebraic singularities 5 2 direct fitting for non algebraic singularities 5 3 using the method of differential approximants 5 4 transforming series to remove the factor 1 n 6 example 1 modified fragmented permutations 7 example 2 dyck paths enumerated by maximum height 7 1 numerical analysis of dyck path series 8 example 3 interacting partially directed self avoiding walks 9 general methods to analyse such series 10 conclusion 11 acknowledgements