ar x iv 0 70 7 37 25 v 2 m at h r a 2 5 o ct 2 00 7 relating two hopf algebras built from an operad f chapoton and m livernet november 20 2018 abstract starting from an operad one can build a family of posets from this family of posets one can define an incidence hopf algebra by another construction one can also build a group directly from the operad we then consider its hopf algebra of functions we prove that there exists a surjective morphism from the latter hopf algebra to the former one this is illustrated by the case of an operad built on rooted trees the nap operad where the incidence hopf algebra is identified with the connes kreimer hopf algebra of rooted trees 1 introduction operads were introduced in algebraic topology to deal with loop spaces more than 40 years ago this new algebraic notion has been somewhat neglected after its introduction until it appears to be useful in many other domains for instance in the algebraic geometry of moduli spaces of curves during the 1990 s since then there seems to be a regular activity around operads operads can be defined as objects of any symmetric monoidal category most of the examples considered in the literature live in the category of sets of topological spaces of vector spaces over a field or of chain complexes the aim of the present article is to relate two different constructions both starting from the data of an operad p in the category of sets of graded com mutative hopf algebras or from the dual point of view of pro algebraic groups the first construction goes as follows from an operad p in the category of sets one can define a family of posets in which the partial order reflects part of the algebraic structure of the operad this partial order has been introduced by mendez and yang 13 but rather in the context of species and without using the term operad it was rediscovered later by vallette 17 who used this to link the koszul property of the operad to the cohen macaulay properties of the posets then one can use this family of posets which has some adequate closure property under taking subintervals as an input to the schmitt definition of an incidence hopf algebra therefore one can build in this way a first hopf algebra hp from an operad p through the associated posets the second construction of a hopf algebra from an operad is a direct one it is rather the equivalent construction of a pro algebraic group gp this has been considered from different point of views in 18 3 10 as a space the group gp is an affine subspace of the completed free p algebra on one generator 1 http arxiv org abs 0707 3725 v 2 our main general result is the existence of a surjective morphism of hopf algebras from the hopf algebra of functions qgp to the incidence hopf algebra hp from the group point of view this means that the pro algebraic group spechp is a subgroup of gp in the last section of the article these results are applied to an operad built on rooted trees the operad nap we give a precise description of the posets associated to this operad we then show that the incidence hopf algebra for the nap operad is isomorphic to the hopf algebra of rooted trees which was introduced by connes and kreimer in 6 this gives a second link between this hopf algebra and operads after the one obtained in 4 with the pre lie operad the general theorem is then used together with a computation of the mo bius numbers to find the inverse of a special element of gnap we also provide some other examples of elements of the group gnap and morphisms from this group to more familiar groups of formal power series in one variable the present work received support from the anr grant blan 06 1 136174 2 set operads and posets here we recall first the general setting of species and operads then the con struction of posets starting from an operad mendez and yang 13 3 4 and vallette 17 and related results 2 1 species the theory of species has been introduced by joyal 9 as a natural way to deal with generating series it is closely related to the notion of s module just as vector spaces are related to sets a species is a functor p from the groupoid of finite sets the category whose objects are finite sets and morphisms are bijections to the category of sets for example the species comm maps a finite set i to the singleton i and there is no choice for the bijections the category of species is a monoidal category with tensor product defined by f g i f i j i g j where i is a finite set and runs over the set of equivalence relations on i note that this monoidal functor is not symmetric the data of a species p is equivalent to the data of a collection of sets p n with actions of the symmetric groups the set p n can be defined as p 1 n with the obvious action of the symmetric group sn the other way round one can recover the set p i as a colimit 2 2 set operads a set operad p is a monoid with unit in the monoidal category of species for the tensor product this means the data of a morphism of species p p p 2 which has to be associative and a map e from the unit object to p satisfying the usual unit axioms an augmented operad p is an operad such that p is empty and the image by p of any singleton is a singleton we will always assume that the operads we consider are augmented there is an alternative way to describe the composition map of an operad p the data of as above is equivalent to the data of maps for each finite set i and collection of finite sets ji i i p i i i p ji p i i ji 1 which map x yi i i to x yi i i a basic set operad is a set operad such that for each y i i p ji the map x 7 x y is injective 2 3 posets from set operads let p be a set operad let us denote by p the species comm p let i be a finite set one can build a family of posets on the species p more precisely there is a partial order on p i for each finite set i and this construction is functorial in i this means that the species p has values in the category of posets rather than just in the category of sets from the definition of one can see that an element x of p i is the data of a partition x of i and of an element xj of p j for each part j of the partition x the definition of the composition maps of p in the diagram 1 lifts to the maps p i i i p ji p i i ji 2 which send x xu u x y yi i i to x y xu yi i u u x these maps satisfy the following associativity relation x y z x y z 3 then x y in p i if there exists an element x y p x such that x y x y note that this definition implies that the partition x is finer than the partition y the poset p i has a unique minimal element denoted by 0 the following proposition is statement 3 in 13 thm 3 4 proposition 2 1 let p be a basic set operad let x p i the poset y p i x y is isomorphic to the poset p x 3 proof since p is a basic set operad if x y there is a unique x y p x such that x y x y the bijection sends y to x y the inverse map sends a p x to a x assume x y z by definition x y x y and x z x z since y z there is a unique y z p y such that y z y z as a consequence using the associativity relation 3 one has z y z y y z x y x y z x y x x z x the uniqueness of the elements permits to conclude that y z x y x z and x y x z conversely if a b p x one has clearly a x b x if this construction is applied to the set operad comm the poset comm i is the usual partial order by refinement on the partitions of the set i one can similarly get the poset of pointed partitions when this construction is applied to the set operad perm 5 vallette has used these posets to give a koszulness criteria for operads let us just recall the result here proposition 2 2 17 theorem 12 let p be a set operad which is basic quadratic and augmented then the associated linear operad qp is koszul if and only if all maximal intervals in p i are cohen macaulay for all i 3 incidence hopf algebras here we recall briefly a construction of william schmitt 15 building a commu tative hopf algebra from a family of posets satisfying some conditions we then derive our first hopf algebra built from an operad from the composition of the construction of mendez yang and vallette with this construction of schmitt 3 1 good families of posets suppose we are given a collection of posets p a the collection p a is called a good collection if it satisfies the following conditions 1 each poset p has a minimal element 0 and a maximal element 1 it is an interval 2 for all a and all x in p the interval 0 x is isomorphic to a product of posets p and the interval x 1 is isomorphic to a product of posets p as a simple example of good collection one can consider the family of all total orders another example is the family of boolean posets remark it follows from this definition applied to the interval 0 0 in any poset p that a good collection contains at least one poset p with only one element 4 3 2 hopf algebra from a good collection let p a be a good collection let us consider the collection of all finite products p let us denote by a this larger set of posets the collection a of posets is closed under products by construction it is also closed under taking initial intervals 0 x or final intervals x 1 hence it is also closed under taking any subinterval because any interval x y is a final interval in the initial interval 0 y a collection of posets which is closed under products and closed under taking subintervals is called a hereditary collection in 15 the collection a is therefore a hereditary collection let us denote by a the set of isomorphism classes of posets in a and by a the set of isomorphism classes of posets in a elements in these sets will be denoted by which will also mean the isomorphism class of a or a one can then consider the vector space ha with a basis f indexed by the set a then ha is a commutative algebra for the product induced by the direct product of posets f f f this algebra is generated by the elements f with a note that one can remove the unit f from this set of generators the algebra ha may not be free on this reduced set of generators as there can be isomorphisms p p with a different number of factors or with non pairwise isomorphic factor posets the space ha is also a coalgebra for a coproduct whose value on the generator f is f x p f b 0 x f x b 1 where the intervals in indices stand for their isomorphism classes in fact this formula is enough to define the coproduct which is compatible with the product on ha to summarize proposition 3 1 the space ha endowed with its commutative product and the coproduct is a commutative hopf algebra the unit is f where is the isomorphism class of the singleton interval this is a consequence of the general theorem of schmitt on hereditary col lections of posets 15 theorem 4 1 3 3 group from a good family the commutative hopf algebra ha is the space of functions on a pro algebraic group specha the elements of which can be seen as some formal power series indexed by elements of a the fact that ha is not necessarily a polynomial algebra on the set f a is equivalent to the possible existence of some universal relations between the coefficients of these series see lemma 6 12 for an instance of this phenomenon the fact that f is the unit means that the coefficient of in these series is 1 5 an element of this pro algebraic group can be considered as a function on the collection of isomorphism classes of posets p a the product in the group provides information on the posets by the classical theory of mo bius functions zeta functions and incidence algebra of posets see 14 16 the following proposition gives an example of computation in the pro algebraic group specha proposition 3 2 15 7 the group product in specha gives the usual con volution product on functions over the posets p for a consider in specha the mo bius series m a p where p is the mo bius number of the poset p and the zeta series z a then m is the inverse of z in specha 3 4 from operads to incidence hopf algebras here we show that one can use the posets p i associated with a basic set operad p to define an incidence hopf algebra hp by using schmitt construction for an hereditary family indeed the intervals in p i are products of minimal intervals as stated in the following proposition proposition 3 3 let y p n for some n let 0 x y assume that x has components xu u x the interval 0 x is isomorphic to the product of posets u x 0 xu the interval x 1 x y is isomorphic to the poset 0 x y where x y is the unique element of p x such that x y x y proof the isomorphism between 0 x and u x 0 xu is a direct consequence of the definition of the partial order indeed one has z x if and only if the partition z is finer than the partition x and for each part u of x one has zu xu where zu and xu are the restrictions of z and x to u this allows to prove the expected isomorphism let us now consider the interval x y the order preserving isomorphism of prop 2 1 between z x z and p x induces an isomorphism between the intervals x y and 0 x y as a consequence if x y p i and y yu u y then x y u y 0 xu yu 4 let ap be the set of coinvariants for the species p for each coinvariant p n sn let r be a representative of in p n let us define a poset p as the interval 0 r in p n 6 proposition 3 4 the collection of posets p ap is a good family of posets the resulting incidence hopf algebra is denoted by hp proof obviously all posets p are intervals there remains only to prove the stability property for any ap two representatives r and s give two isomorphic intervals 0 r and 0 s in p n thus the stability property follows from prop 3 3 4 groups from operads here we recall the construction of a group from an operad the hopf algebra of its functions gives our second hopf algebra built from an operad we will work with a set operad p but the construction is just the same for an operad in the category of vector spaces this simple construction has already been considered from different viewpoints in 18 chap i 1 2 and 3 10 let p be an augmented set operad in this section we will use the description of a species p as a collection of modules p n over the symmetric groups let qap nqp n sn be the direct sum of the coinvariant spaces which can be identified with the underlying vector space of the free p algebra on one generator and q ap nqp n sn be its completion let m m n n be two elements of q ap with m m elements of qp m sm choose any representatives xm r m of m resp ym r m of m in qp m then one can check that the following formula defines a product on q ap m 1 n 1 nm 1 xm yn 1 ynm 5 where is the quotient map to the coinvariants and x y 1 ym 7 x y 1 ym is the composition map of the operad p proposition 4 1 the product defines the structure of an associative monoid on the vector space q ap furthermore this product is q linear on its left argu ment proof let us first prove the associativity let p p and fix representatives zp r p on the one hand one has m p 1 pm r m zp 1 zpm m n 1 nm p 1 pn 1 nm xm yn 1 ynm zp 1 zpn 1 nm 6 on the other hand one has m n 1 nm xm r n 1 r nm m n 1 nm qi j xm yn 1 zq 1 1 zq 1 n 1 ynm zqm 1 zqm nm 7 7 using then the associativity of the operad one gets the associativity of it is easy to check that the image of the unit e of the operad p is a two sided unit for the product the left q linearity is clear from the formula 5 proposition 4 2 an element of q ap is invertible for if and only if the first component 1 of is non zero proof the direct implication is trivial the converse is proved by a very standard recursive argument let us call gp the set of elements of q ap whose first component is exactly the unit this is a subgroup for the product of the set of invertible elements proposition 4 3 the construction g is a functor from the category of aug mented operads to the category of groups proof the functoriality follows from inspection of the definitions of q ap and in fact one can see gp as the group of q points of a pro algebraic and pro unipotent group the lie algebra of this pro algebraic group is given by the usual linearization process on the tangent space an affine subspace of q ap resulting in the formula m 1 n 1 xm yn yn xm where xm yn m i 1 xm e e i 1 units yn e e the graded lie algebra structure on qap defined by the same formulas has already appeared in the work of kapranov and manin on the category of right modules over an operad 10 th 1 7 3 the hopf algebra q gp of functions on gp is the free commutative algebra generated by g for in the set ap but the unit invariant an element g of gp can be seen as a formal sum g ap g g where g 1 as a function on gp the value of g on an element g of gp is the coefficient of in the expansion of g 5 main theorem here we show that the incidence hopf algebrahp defined in 3 4 is a quotient of the hopf algebra of functions q gp on the group of formal power series defined directly from the operad p by the construction of 4 this also means that the group spechp is a subgroup of the group gp 8 let us consider the coproduct in the incidence hopf algebra hp this space has a basis indexed by the set a p of isomorphism classes of products of posets the set ap is a subset of a p if one considers the coproduct on one element f with ap then it can be written uniquely as a linear combination f f f f where in ap a p ap indeed the fact that this sum only runs over ap and not a p follows from the description of the subintervals in prop 3 3 therefore for each triple in ap a p ap one can define a coefficient f by the previous expansion similarly one can consider the hopf algebra of functions on the group gp and define for each triple with an element of p n sn for some n an element of p k sk for some k n and an element of p n sn with k parts a coefficient g by g g g g where g is the product t g t over the set of components of let us choose for the rest of this section a triple as above we will compare the coefficients f and g let us denote by the projections to coinvariants from p n to p n sn let us pick a representative r of in p n and a representative r of in p k let us also choose a representative r of in skp n with the following property the partition of 1 n induced by the components of the representative r is the standard partition pstd 1 1 1 1 1 2 1 k 1 1 1 k this allows to define a bijection between the set of components of and the set 1 k then one will denote by i the component indexed by i by the unique increasing renumbering this also gives representatives r i of i in p i let us introduce the automorphism groups aut aut and aut they are rather the automorphisms groups of representatives r r and r the group aut decomposes into a semi direct product aut k i 1 aut i aut 0 where aut 0 is a subgroup of the permutation group sk of the set of compo nents of from the description of the coproduct in the incidence hopf algebra the coefficient f is the cardinal number of the following set p sk u vi r u v 1 vk u v i i 8 9 where p is a partition of 1 n with k parts pi ordered by their least element sk u p k and vi p pi for i 1 k let us introduce the set ef consisting of p i u vi r u v 1 vk u r v i i r i where p is a partition of 1 n with k parts pi ordered by their least element sk u p k vi p pi for i 1 k sk and i is bijection from the part p i to the set 1 i proposition 5 1 the set ef satisfies aut aut f ef proof the group aut aut acts freely on ef and the orbits are in bijection with the set described in 8 whose cardinality is f from the description of the product in the group gp the coefficient g is the cardinal of the following set sk aut 0 r r 1 r k 9 let us introduce the set eg consisting of sk sn r r r 1 r k proposition 5 2 the set eg satisfies aut aut 0 g eg proof the group aut aut 0 acts freely on eg and the orbits are in bijection with the set described in 9 whose cardinality is g let us now show that the sets ef and eg are just the same proposition 5 3 there is a bijection between ef and eg proof recall the definition of the set ef consisting of p i u vi r u v 1 vk u r v i i r i let us pick an element in this set then there exists a unique permutation sn induced by the collection of bijections i this bijection maps the par tition p to the standard partition pstd changing the order of the parts according to it provides an isomorphism between r and 1 u r 1 r k then one can use and 1 to define a unique isomorphism between 1 u and r this gives us an equality 1 u r 1 r k r r 1 r k hence a unique element in the set eg sk sn r r r 1 r k 10 one can now prove the existence of a morphism between hopf algebras or equivalently between groups theorem 5 4 the map g 7 f aut defines a surjective morphism from the hopf algebra q gp of coordinates on the group gp to the incidence hopf algebra hp in terms of groups this means that the group spechp is a subgroup of the group gp proof the hopf algebra q gp is commutative and freely generated by the set of coinvariants of p but the unit on the other hand the incidence hopf algebra is commutative and generated by the isomorphism classes of maximal intervals but the trivial interval as intervals coming from the same coinvariant are obviously isomorphic the proposed map is well defined from the set of coinvariants to the set of isomorphism classes of intervals then one can uniquely extend this map into a morphism of algebras because q gp is a free commutative algebra this morphism is surjective by construction according to the notation introduced before we have to prove that aut g t aut t aut f by the semi direct product structure of aut this is equivalent to aut aut 0 g aut aut f this follows in turn from prop 5 1 prop 5 2 and prop 5 3 let us consider briefly a simple example which is the operad comm for each n the space comm n is the trivial module over the symmetric group sn hence comm n sn has dimension 1 the algebra of functions q gcomm is free on one generator gn in each degree 2 using the definition of gcomm one can check that the group gcomm is isomorphic to the group of formal power series f x n 2 gn f x n for composition a group of formal diffeomorphisms on the other hand there is only one interval in comm n which is the usual poset of partitions the incidence hopf algebra of this family of posets is very classical 15 ex 14 1 freely generated by one element fn in each degree and isomorphic to the faa di bruno hopf algebra which is the hopf algebra of functions on the group of formal power series f x n 2 fn f xn n for composition hence in the case of comm the morphism from q gcomm to hcomm which maps gn to fn n is an isomorphism the next section is devoted to the case of the operad nap where the surjective morphism is not an isomorphism 11 6 application to the nap operad 6 1 the nap operad the us first recall the definition of the nap operad which has been introduced in 11 the name nap stands for non associative permutative let i be a finite set the set nap i is the set of rooted trees with vertices i that is connected and simply connected graphs with a distinguished vertex called the root the unit is the unique rooted tree on the set i for any singleton we use the notation t b r t 1 tk for a rooted tree t built from the rooted trees ti by adding an edge from the root of each rooted tree ti to a disjoint vertex r which becomes the root of t let us describe the composition t si i i where t nap i and si nap ji consider the disjoint union of the rooted trees si and add some edges for each edge of t between i and i in i add an edge between the root of si and the root of si the result is a rooted tree on the vertices iji this is t si i i the root of this rooted tree is the root of sk where k is the index of the root of t a nap algebra is a vector space v endowed with a bilinear map from v v v such that a b c a c b the free nap algebra on a set s of generators has a basis indexed by rooted trees together with a bijection from vertices to s the product s t of two such rooted trees is obtained by grafting the root of t on the root of s b r s 1 sk t b r s 1 sk t let us note here that nap is a basic set operad indeed one can recover t from u t si i i and the collection si i i as the restriction of u to the vertices which are roots of some rooted tree si 6 2 posets associated with nap let us describe the posets nap i the set nap i consists of forests of rooted trees with vertices labeled by i the covering relations can be described as follows a forest x is covered by a forest y if y is obtained from x by grafting the root of one component of x on the root of another component of x in the other direction x is obtained from y by removing an edge incident to the root of one component of y by relation 4 any interval in nap i is a product of intervals of the form 0 t for t nap j let us introduce the following order on rooted trees t s t or t is a sub rooted tree of t if t is the restriction of t to a subset of vertices containing the root of t such that every vertex of t lying on the path between the root and a vertex of t is also in t if t itself is seen as a poset with its root as minimum element then this just means that t is a lower ideal of t let 1 denotes the root of t and t 1 s be the interval between t and 1 for the order s a rooted tree t is covered by a rooted tree t if t is obtained from t by removing a leaf 12 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 235 4 1 2 3 4 5 1 23 4 51 2 3 4 5 1 2 3 4 5 1 2 3 45 1 2 3 4 5 figure 1 an interval in the poset nap 1 2 3 4 5 proposition 6 1 the interval 0 t is isomorphic to the interval t 1 s proof let x be a forest such that x t and let rx be the family of its roots by definition of the order relation there exists a rooted tree z such that t z x it means that the vertices indexed by rx form a sub rooted tree of t the isomorphism from 0 t to t 1 s sends x to this sub rooted tree the inverse morphism is the following let t be a sub rooted tree of t and rt the set of its vertices again in view of the composition there is a unique forest x t whose roots are indexed by rt such that t t x this proposition in fact shows that 0 t is isomorphic to the lattice of lower order ideals of the rooted tree t seen as a poset from this it follows that 0 t is a distributive lattice 1 according to 12 example 2 4 this also implies prop 6 2 below proposition 6 2 the intervals in nap n are sn el shellable and supersolv able lattices a poset p is called totally semi modular if for all x y p if there is z that is covered by both x and y then there is w which covers both x and y proposition 6 3 the intervals in nap n are totally semi modular lattices proof by relation 4 and prop 6 1 it is enough to prove the proposition for an interval of the form t 1 s let x y be two sub rooted trees of t assume x and y cover a sub rooted tree z hence x is obtained from z by removing a leaf lx and y is obtained from z by removing a leaf ly 6 lx the sub rooted tree w obtained from z by removing the leaves lx and ly covers both x and y corollary 6 4 the posets nap n are cohen macaulay 13 proof this follows from shellability hence either from prop 6 3 as total semi modularity implies cl shellability 2 or from prop 6 2 corollary 6 5 the operad nap is koszul proof this follows from vallette s criterion prop 2 2 and the previous corol lary proposition 6 6 in the nap case coinvariants are the same as isomorphism classes of posets between rooted trees proof coinvariants are given by unlabeled rooted trees it is clear that if two rooted trees have the same underlying unlabeled rooted trees then their asso ciated posets are isomorphic conversely let 0 t and 0 t be two isomorphic posets then t 1 s and t 1 s are isomorphic this isomorphism induces a bijection between the labelling of the vertices of the two rooted trees and proves that t and t have the same underlying unlabeled rooted tree this does not work for forests the hopf algebra hnap is not free on the coinvariants as there are relations given by the following proposition proposition 6 7 let t b r t 1 tk be a rooted tree the poset 0 t is isomorphic to the product over j 1 k of the posets 0 b r tj proof by prop 6 1 we prove the equivalent result for the interval t 1 s any sub rooted tree u of t writes u b r u 1 uk where ui is a sub rooted tree of ti or may be the empty tree the isomorphism sends u to the product of the rooted trees b r uj 6 3 isomorphism between hnap and the hopf algebra of connes and kreimer in 6 connes and kreimer build a commutative hopf algebra hr polynomial on unlabeled rooted trees we prove in this section that hnap is isomorphic to this hopf algebra proposition 6 8 the hopf algebra hnap is a free commutative algebra on the unlabeled rooted trees of root valence 1 proof according to 15 theorem 6 4 the hopf algebra hp is a free commu tative algebra on its set of indecomposable elements but each poset 0 t with t of root valence 1 cannot be written as a product because there is only one element covered by 1 hence is indecomposable conversely any other interval decomposes as a product of such intervals by prop 6 7 lemma 6 9 the elements f t where t runs over the set of rooted trees form a basis of the vector space hnap proof as hnap is a free algebra on the elements f x where x is an unlabeled rooted tree of root valence one by prop 6 8 a vector space basis is given by products f t 1 f tk with ti b r t i by prop 6 7 there exists a unique rooted tree t b r t 1 t k such that i 0 ti 0 t this gives a bijection between forests of unlabeled rooted trees of root valence one and unlabeled rooted trees therefore the elements f t where t are unlabeled rooted trees form a basis 14 the hopf algebra of connes et kreimer hr is the free commutative algebra on unlabeled rooted trees with the following coproduct t 1 t t 1 c p c t rc t where c stands for all the admissible cuts p c t is a forest and rc t is a rooted tree defined from an admissible cut c see 6 the coproduct has an alternative definition given by induction b t 1 tk b t 1 tk 1 id b t 1 tk where b t 1 tk b r t 1 tk this means that the linear map b hr hr is a 1 cocycle in the complex computing the hochschild cohomology of the coalgebra hr indeed connes and kreimer prove that hr is a solution to a universal problem in hochschild cohomology theorem 6 10 6 the pair hr b is universal among commutative hopf algebras h l satisfying l x l x 1 id l x x h 10 more precisely given such a hopf algebra there exists a unique morphism of hopf algebras hr h such that l b as a consequence of the universal property the hopf algebra of connes and kreimer is unique up to isomorphism we use this criteria to prove that hnap is isomorphic to hr theorem 6 11 the hopf algebra hnap is isomorphic to the hopf algebra hr of connes and kreimer the unique isomorphism compatible with the universal property sends f b r t 1 tk to the forest t 1 tk proof let us define a 1 cocycle lnap on hnap by lemma 6 9 it is enough to define lnap as lnap f t f b r t for each rooted tree t let us prove that lnap satisfies equation 10 for any rooted tree u let u be the isomorphism from 0 u to u 1 s the coproduct is then given by f u x u f x f u x where x is a forest of rooted trees and u x is a sub rooted tree of u hence f b r t x b r t f x f b r t x f b r t 1 x t f x f b r t x 15 indeed since t is the unique rooted tree covered by b r t any x b r t is the forest obtained from a forest of rooted trees x t by adding the rooted tree with the single vertex r as a consequence b r t x b r t x hence l satisfies equation 10 let h l be a commutative hopf algebra satisfying relation 10 in order to build a morphism of hopf algebras hnap h it is enough to give its values on the rooted trees of root valence 1 but such a generator can be written f b r t lnap f t hence we define f b r 1 since the rooted tree with single vertex r is the unit and by induction f b r t l f t where f t is a product of generators of degree less than b r t it is straightforward to check that is a morphism of hopf algebras such that l lnap as a consequence hnap is isomorphic to hr and the isomorphism goes as follows f b r t 1 tk is sent to the forest t 1 tk let us give examples for the coproduct in the incidence hopf algebra hnap f 1 f 2 f f f f f 1 f 1 f f f f f 2 f f f 1 and f 1 f 3 f f 3 f f f 1 where we have used that f is the unit 1 the last example also follows from the equality see prop 6 7 f f 3 the similar coproducts in the hopf algebra q gnap are g 1 g g g g g g 1 g 1 g g 2 g g g 2 g g g 1 and g 1 g g g g g g 1 where we have also used that g is the unit 1 6 4 examples of elements of the group gnap the group gnap can be considered as a group of formal power series indexed by the set of unlabeled rooted trees in this section we give a criterion for an element of gnap to be in spechnap then describe several examples of elements of gnap and compute their inverses let us first describe explicitly the image of spechnap in gnap 16 lemma 6 12 a series f t gt f t in gnap is in the subgroup spechnap if and only if for each tree t b r t 1 tk one has aut b r t 1 tk gb r t 1 tk f k i 1 aut b r ti gb r ti f proof indeed if the series f is the image of an element f in spechnap then one has gt f f t f aut t and the multiplicative behavior follows from prop 6 7 conversely if the multiplicativity property holds one can build a unique element f in spechnap that maps to f the first example is in fact an element of the subgroup spechnap and we can therefore deduce its inverse by first computing the mo bius numbers of the maximal intervals in nap n proposition 6 13 let t be a rooted tree if t is a corolla with n 1 vertices then 0 t 1 n if not then 0 t 0 proof we compute the mo bius number of the poset t 1 s if t is the rooted tree t 2 with only two vertices then the mo bius number of the interval t 1 s is clearly 1 hence the prop 6 7 yields the result for the corollas if the valence of the root of t is one then 1 covers a unique rooted tree which is t 2 if t has at least 3 vertices then t 2 is different from t and the mo bius number of the interval t 1 s is 0 if the valence of the root of t is greater than 2 and t is not a corolla then in the decomposition of t b r t 1 tk there exists ti having at least two vertices the rooted tree b r ti has root valence 1 and has at least 3 vertices so its mo bius number is 0 we conclude with prop 6 7 we now deduce from this computation an identity in the group gnap consider the series where each rooted tree has weight the inverse of the order of its automorphism group z 1 2 1 6 1 2 by lemma 6 12 this belongs to the image of spechnap and should be called the zeta function following the standard notation in algebraic combinatorics of posets 14 16 by the general result prop 3 2 its inverse in the group spechnap is known to be the generating series for mo bius numbers hence by the computation of mo bius numbers done in prop 6 13 and the inclusion of spechnap in gnap obtained in th 5 4 the inverse of z in the group gnap is the similar sum m restricted on corollas and with additional signs m 1 2 1 6 1 24 we now give some other examples of elements of gnap let us introduce the sum of all corollas in gnap c 17 and the alternating sum of linear trees l the series c satisfies the simple functional equation c c 11 where is the nap product on rooted trees theorem 6 14 in the group gnap one has c l 1 proof from the functional equation 11 for c one gets c 1 c 1 by product by c 1 on the right since one has in gnap the relation c d e c e d e but the unique solution to this equation is easily seen to be l one can see from lemma 6 12 that the series c and l do not belong to the subgroup spechnap as the coefficients aut t gt do not have the necessary multiplicativity property for instance the coefficients of corollas vanish in l but the coefficient of the tree does not 6 5 morphisms from gnap to usual power series there are two morphisms from the group gnap to the multiplicative group of formal power series in one variable x either one can project on corollas t gt t 7 n 0 gcnx n where cn is the corolla with n leaves or project on linear trees t gt t 7 n 0 g nx n where n is the linear tree with n 1 vertices recall that the hopf algebra of functions on the multiplicative group of formal power series 1 n 1 mnx n is the free commutative algebra with one generator mn in each degree n 1 and coproduct mn n i 0 mi mn i with the convention that m 0 1 it is indeed easy to check that corollas and linear trees are closed on the coproduct and that the coproduct is the same as in the multiplicative group 18 in the case of linear trees the induced morphism from spechnap to the multiplicative group of formal power series is again a projection this means that it defines a hopf subalgebra of hnap corresponding to the ladder hopf subalgebra in hr the reader may want to check that the image of the inverse is the inverse of the image in the examples c l z and m given above there is a morphism from the group gnap to the group of formal power series in one variable x for composition given by the sum of the coefficients of all rooted trees of same degree t gt t 7 n 1 t nap n sn gt xn this comes from the morphism of operads from nap to the commutative op erad comm which sends every element of nap n to the unique element of comm n one can easily check that the images of the series c and l are inverses for composition for the images of the series z and m this is less obvious this implies that the image of z is n 1 nn 1 xn n which is the functional inverse of x exp x this is related to the lambert w function 7 the inverse of x exp x it is easy to see that the induced morphism from spechnap to the compo sition group of formal power series is again a projection hence defines a hopf subalgebra of hnap this hopf algebra is isomorphic to the faa di bruno hopf algebra as pointed out in 5 the generators of the subalgebra q gcomm in q gnap are t nap n sn gt for n 2 hence the generators of the subalgebra in hnap are t nap n sn 1 aut t f t for n 2 let us give explicitly the first generators of this hopf subalgebra of hnap 1 f 2 f 1 2 f f 1 2 f 2 3 f 1 2 f f 1 6 f f 1 2 f f f 1 6 f 3 where we have used the multiplicative property of the f functions to get from sums over all rooted trees to polynomials in rooted trees of root valence 1 19 by mapping these elements to the connes kreimer algebra hr by the iso morphism of theorem 6 11 one can see that this hopf subalgebra is different from the connes moscovici subalgebra and also from the other hopf subalgebras of hr introduced recently by foissy 8 references 1 g birkhoff lattice theory third edition american mathematical soci ety colloquium publications vol xxv american mathematical society providence r i 1967 2 a bjo rner and m wachs on lexicographically shellable posets trans amer math soc 277 1 323 341 1983 3 f chapoton rooted trees and an exponential like series arxiv math qa 0209104 4 f chapoton and m livernet pre lie algebras and the rooted trees operad internat math res notices 8 395 408 2001 5 f chapoton and b vallette pointed and multi pointed partitions of type a and b j algebraic combin 23 4 295 316 2006 6 a connes and d kreimer hopf algebras renormalization and noncomu tative geometry comm math phys 199 203 242 1998 7 r m corless g h gonnet d e g hare d j jeffrey and d e knuth on the lambert w function adv comput math 5 4 329 359 1996 8 l foissy faa di bruno subalgebras of the hopf algebras of planar trees arxiv 0707 1204 2007 9 a joyal foncteurs analytiques et espe ces de structures in combinatoire e nume rative montreal que 1985 quebec que 1985 volume 1234 of lecture notes in math pages 126 159 springer berlin 1986 10 m kapranov and yu manin modules and morita theorem for operads amer j math 123 5 811 838 2001 11 m livernet a rigidity theorem for pre lie algebras j pure appl algebra 207 1 1 18 2006 12 p mcnamara el labelings supersolvability and 0 hecke algebra actions on posets j combin theory ser a 101 1 69 89 2003 13 m me ndez and j yang mo bius species adv math 85 1 83 128 1991 14 g c rota on the foundations of combinatorial theory i theory of mo bius functions z wahrscheinlichkeitstheorie und verw gebiete 2 340 368 1964 1964 15 w r schmitt incidence hopf algebras j pure appl algebra 96 3 299 330 1994 20 16 r p stanley enumerative combinatorics vol 1 volume 49 of cambridge studies in advanced mathematics cambridge university press cambridge 1997 with a foreword by gian carlo rota corrected reprint of the 1986 original 17 b vallette homology of generalized partition posets j pure appl alge bra 208 2 699 725 2007 18 p van der laan operads hopf algebras and coloured koszul duality phd thesis universiteit utrecht 2004 muriel livernet laboratoire analyse ge ome trie et applications umr 7539 du cnrs institut galile e universite paris nord avenue jean baptiste cle ment 93430 villetaneuse livernet math univ paris 13 fr fre de ric chapoton universite de lyon universite lyon 1 institut camille jordan cnrs umr 5208 43 boulevard du 11 novembre 1918 f 69622 villeurbanne cedex fchapoton math univ lyon 1 fr 21 introduction set operads and posets species set operads posets from set operads incidence hopf algebras good families of posets hopf algebra from a good collection group from a good family from operads to incidence hopf algebras groups from operads main theorem application to the nap operad the nap operad posets associated with nap isomorphism between hnap and the hopf algebra of connes and kreimer examples of elements of the group gnap morphisms from gnap to usual power series