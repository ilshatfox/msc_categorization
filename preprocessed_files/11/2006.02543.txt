ar x iv 2 00 6 02 54 3 v 4 m at h n t 2 9 ju l 20 21 families of differential operators for overconvergent hilbert modular forms jon aycock abstract we construct differential operators for families of overconvergent hilbert mod ular forms by interpolating the gauss manin connection on strict neighborhoods of the ordinary locus this is related to work done by harron and xiao and by andreatta and iovita in the case of modular forms and by zheng liu for siegel modular forms it has applications to p adic l functions of cm fields contents 1 introduction 1 2 hilbert modular forms 4 3 nearly hilbert modular forms 8 4 descent 20 references 22 1 introduction 1 1 motivation in ser 72 serre introduced the idea of using p adic families of modular forms to p adically interpolate values of l functions in particular he used the family of eisenstein series with q expansion 1 2 g 2 k q 1 2 k 2 n 1 2 k 1 n q n he showed that congruences between the coefficients of qn for n 1 for particular values of k imply the existence of such a congruence between the constant terms 1 k as well and used this to show that an appropriate normalization of the riemann zeta function is p adically continuous when restricted to inputs of negative odd integers this is one construction of the kubota leopoldt p adic zeta function which interpolates the values of the riemann zeta function at negative odd integers serre was able to use a well known family of modular forms whose values at the cusp are equal to special values of the riemann zeta function though the result was generalized to dedekind zeta functions for totally real fields in dr 80 these can be tricky to come up with in more generality one important addition to the theory was katz s use of differential operators in particular those built from the gauss manin connection as a key ingredient in the construction of these families in kat 76 kat 78 katz s operators give a p adic analog of the maass shimura operators which shimura used to prove algebraicity results date august 2 2021 1 http arxiv org abs 2006 02543 v 4 2 jon aycock in shi 76 shi 00 and which were adapted by harris to prove algebraicity results for higher rank groups in har 81 har 86 katz leveraged this idea to p adically interpolate the zeta function for a cm field k using hilbert modular forms attached to its maximal totally real subfield k he started with a holomorphic eisenstein series and used successive powers of these differential operators to produce a family of not necessarily holomorphic eisenstein series by damerell s formula in e g gs 81 sums of the values of these eisenstein series at the cm points of the modular curve give the central values l s 0 of the l functions for a specific class of hecke characters known as characters of type a 0 viewing the zeta function as a function on the space of characters this fact reduces the p adic interpolation of k to the study of how powers of the gauss manin connection behave p adically as noted in his introduction katz s method only succeeds when we can choose an or dinary cm type which is only possible when every prime above p in the totally real field k splits in k k this is due to the fact that his differential operators are only defined over the ordinary locus which does not contain the cm points that are supersingular at p the present work extends these operators to be defined on the overconvergent loci using methods from liu 19 and using the geometry developed in aip 15 aip 16 this extension allows damerell s formula to be used in more general situations whenever the eisenstein series is defined at the cm points 1 2 description of results the present work culminates in the following theorem which is theorem 3 6 2 in the body of the paper theorem 1 2 1 fix a tuple v vi with each vi 0 for each embedding f k and any k 1 there is a differential operator k acting on families of nearly v overconvergent hilbert modular forms which raises the weight by 2 k and the type by k the operators k and commute for any pair of embeddings and these k are the p adic analogs of the maass shimura operators in the archimedean case as we prove in section 3 5 the absence of these overconvergent operators in kat 78 prevented katz from constructing p adic l functions for cm fields in the case that the cm points were not ordinary i e when p is not split ink k the overconvergent operators for elliptic modular forms have been previously constructed and are used in ai 21 to construct p adic l functions for quadratic imaginary fields our construction lays the groundwork to generalize that construction to a general cm field in defining the differential operators we work rigid analytically however we give a discussion of the integrality of the operator in section 3 7 as in aip 16 we are careful to make a distinction between two possible meanings of the phrase hilbert modular form given a totally real field f the term may refer to the automorphic forms on either of the following groups 2 g resof zgl 2 or g g resof z gm gm for any commutative ring r the r points of g are simply the 2 2 invertible matrices with entries in of z r while the r points of g are those matrices from g r with determinant in r of z r each of these groups has an advantage g has a nicer hecke theory including a commutative hecke algebra while g allows us to use geometric tools since its associated pel type moduli problem is representable by a shimura variety the inclusion g g gives a restriction map from the space of automorphic forms on g to those on g and in fact there is an explicit geometric criterion that picks out the space of differential operators for hilbert modular forms 3 automorphic forms for g inside the space of automorphic forms for g in the following we focus first on g so that we may use the geometric tools it affords us after which we shift our attention to this criterion which allows us to transport our results to the group g we get the following theorem theorem 4 4 2 in the body of this paper which allows these operators to be used in either situation theorem 1 2 2 the differential operators k constructed in theorem 1 2 1 preserve the space of hilbert modular forms for g inside the space of hilbert modular forms for g in section 2 we present the geometric construction of holomorphic hilbert modular forms followed by families of overconvergent hilbert modular forms on the group g from aip 16 in section 3 we generalize to nearly holomorphic and nearly overconvergent forms including the scaffolding of g q modules which are used to construct the differential operator as in liu 19 in section 4 we transport the results of the previous section to the group g using a criterion similar to the one mentioned above 1 3 relationship to recent developments this paper adds to the recent investi gations into extending p adic differential operators past the ordinary locus or into when the ordinary locus is empty including those in dsg 14 dsg 19 em 21 urb 14 liu 19 liu 20 shortly after posting this paper on the arxiv the author learned from giacomo graziani that his dissertation gra 20 currently in preparation is closely related his paper uses the vbms vector bundles with marked sections formalism present in e g ai 21 while we use g q modules as in liu 19 in hx 14 the authors ask whether or not their construction can be adapted to avoid a choice of the hodge filtration building on the work of ai 21 liu 19 this work answers that question in the affirmative additionally other works note that in order to use nearly overconvergent hilbert modular forms to interpolate the values of p adic l functions a canonical splitting of the hodge filtration must be chosen see for example the introduction to ai 21 for this in the situation of damerell s formula our methods translate this into a need for a canonical choice of frame for the relative de rham cohomology of the modular curve in the nearly holomorphic case seeing as a canonical trivialization i e a frame for the modular sheaf must already be chosen in serre s setting this is a natural bit of data to consider for the nearly overconvergent case we take preimages of the andreatta iovita pilloni torsors for overconvergent hilbert modular forms in the space of frames for the de rham cohomology this construction works for elliptic modular forms and seems eminently generalizable to be used for the automorphic forms on more groups such as hilbert siegel and hermitian modular forms the author of the present paper is currently working on a sequel extending his approach to the higher rank setting in particular hilbert siegel modular forms 1 4 acknowledgements i am grateful to have received support from nsf grant dms 1751281 i would like to thank my advisor ellen eischen as well as nicolas addington sean howe and zheng liu in addition i would like to thank giacomo graziani for alerting me to the fact that his dissertation is about the same subject i hope that our two perspectives give a fuller view than either would have alone 4 jon aycock 2 hilbert modular forms fix a totally real field f of degree f q d 1 in this section we will build up the geometric theory of holomorphic and overconvergent hilbert modular forms of level 1 n here a hilbert modular form is an automorphic form on the group g 2 1 weights let k be a local field that splits f so that f q k k d it should often be a p adic field for some chosen prime p but in some contexts it is allowed to be r we consider the algebraic group t resof zgm the weight space of classical hilbert modular forms is the space of characters of the split torus t k each embedding f k determines a character of t k let i denote the set of such embeddings all algebraic weights i e classical weights with no nebentypus at p if k is a p adic field are of the form k z i often recorded as a tuple k we fix a prime p and a finite extension k of qp we define the weight space w a rigid analytic space defined over k associated to the algebra zpjt zp k the cp points of w parametrize continuous homomorphisms t zp c p which are the p adic weights of hilbert modular forms as a rigid analytic space it is isomorphic to a finite disjoint union of open unit balls of dimension d where each component is labeled by a finite order character of the torsion subgroup of t zp a character of t zp is called algebraic if it is in z i and locally algebraic if it is the product of a finite order character and an algebraic character locally algebraic characters are dense in the weight space for any value 1 w v of the rigid analytic group t has two important subgroups the first t 0 w consists of units congruent to 1 modulo p w the second tw is generated by t 0 w and t zp let a be an affinoid algebra and let t zp a be a family of characters parametrized by the affinoid space u spa as asserted in aip 16 such a character is w analytic for some w meaning that it factors as a composition as follows for some linear map 3 t 0 w zp 1 pw of zp logf pwof zp pa exp 1 pa a there is a universal character un w t zp c p where un x t evaluates the charac ter associated to the point x at the input t t zp corresponding to the natural character t zp okjt zp k sending g to g the universal character is 1 analytic any family of characters as above may be specified by pulling back the universal character by a map u w 2 2 moduli setup let c be an ideal of f p a prime number and n 5 an integer prime to p a c polarized hilbert blumenthal abelian variety hbav we suppress c from the notation defined over a base scheme s is a string a where a s is an semi abelian scheme 2 of relative dimension d of end a is a real multiplication on a n z d 1 f a is a closed embedding and a of c a is a c polarization if c is principal we say a is principally polarized we let c and the degree of the isogeny be prime to p often we will use a as a shorthand for the entire string 1 if p ramifies with index e w 1 e z writing p w should make sense as an ideal of of and we will sometimes write pw abusively even if there is no such element 2 a group scheme which is an extension of an abelian variety by a torus differential operators for hilbert modular forms 5 let s be a scheme over specz n 1 x s be the moduli space of hbavs over s and a x be the universal hbav over x the modular sheaf is 1 a x this is locally free of rank d as a sheaf of ox modules with an action of of there is a largest open subscheme xr of x such that restricts to a locally free sheaf of of zoxr modules if we use s specok as our base the complement of xr in x is empty if p does not divide the discriminant of f in general it is of codimension 2 in the fiber of x over the closed point of s the space xr is known as the rapoport locus and the condition that a hbav a corresponds to a point of xr is called the rapoport condition remark 2 2 1 in the definition of hbav we really want a to be an abelian variety rather than a semi abelian scheme if we take this alternate definition and write y as the moduli space of these varieties then x is a projective toroidal compactification of y we write c x y and refer to c as the boundary or the cusps allowing semi abelian schemes in the definition of hbav is similar to talking about the moduli space of generalized elliptic curves and the universal generalized elliptic curve when discussing elliptic modular forms 2 3 holomorphic hilbert modular forms over x k the bundle decomposes as a direct sum so that c of acts on as c k for a tuple of positive integers k z 1 i we can form the line bundle k 1 1 k d d over x k definition 2 3 1 a hilbert modular form of level 1 n and weight k is a global section of the k vector space of hilbert modular forms of level 1 n and weight is thus h 0 x we remark that t isomx f of z ox the of frame bundle of is a t torsor 3 this means that the ring of functions of t k is graded by the characters of t k or rather by the algebraic weights of hilbert modular forms the graded portion corresponding to the weight k is and we find that the ring of hilbert modular forms is the space of global sections of z i ot each line bundle can be recovered fromot by considering the homogeneous functions with the property that for any g t any hbav a and any frame of z ox 4 f a g g k f a g 1 f a somewhat less explicitly we may view these as functions from t to the representation w of t defined over k the action of t is g w g w and the functions are homogeneous in the sense that f a g g 1 f a remark 2 3 2 homogeneous functions on t which are homogeneous as in equation 4 are identified with sections of as follows the pullback of to t is canonically trivialized by giving a trivialization of for each and thus a trivialization of with 1 1 k acting on the trivialization by some g t k sends to g and g g take a section v of defined on all of x k and pull it back to a section over t its value v a at a point corresponding to a hbav a with a trivialization of its cotangent bundle is a multiple f a of the canonical basis 1 for the line bundle since v was pulled back from a section defined over x we have that v a v a g for any 3 i e the frame bundle of taking the of module structure into account the subscripts x and f denote the fact that these isomorphisms should be ox linear and of linear respectively 6 jon aycock g t k but the canonical trivialization of the fiber of over a g is g times that of the canonical trivialization over a thus we have 5 f a g g 1 f a 2 4 comparison to classical theory in the classical theory hilbert modular forms are presented as holomorphic functions satisfying some transformation conditions which is part of why we call them holomorphic here we compare our theory which is based on geometry to this one it serves as a base for section 3 5 in which we give a similar comparison for nearly holomorphic hilbert modular forms for this section we let k r let h z c im z 0 be the upper half plane and consider the product hf i h z z h for all i then let be a congruence subgroup of sl 2 of 4 it acts on hf by 6 a b c d z a z b c z d a hilbert modular form is a function on hf which behaves well with respect to this action as made precise in definition 2 4 1 definition 2 4 1 a hilbert modular form of level and weight k is a holomorphic function f hf c such that for all and z z hf 7 f z c z d k f z let 1 n we consider the non compactified modular variety y the largest open subscheme of x for which the pullback of the universal hbav is an abelian scheme there is a morphism hf t y c sending a tuple z to a principally polarized hbav over c with a trivialization of its cotangent bundle note thatof acts naturally onof zc c and let lz be the lattice inside c generated as an of module by 1 and z then we write z az z z z z where 1 az is the complex abelian variety whose c points are of c lz 2 the action z of of on az is induced by its natural action on of z c which descends to the quotient because oflz lz 3 z includes n d 1 f 1 nof of into of c lz in the natural way 4 z is induced by the pairing sending w 1 w 2 of zc to tracef q im w 1 w 2 and 5 we trivialize 1 az by identifying the tangent space of az with of z c c and picking dw 1 az to be the c linear functional that sends 1 in each component to 1 further there is an action of 1 n on t y c for which is equivariant thus we can pull back a complex hilbert modular form which is a function on t y c to a holomorphic function on hf it is somewhat nontrivial to check that f satisfies the transformation property we omit it here because we prove a more general fact in theorem 3 5 2 4 this is what we want for g for g elements of should have totally positive determinant not just determinant 1 differential operators for hilbert modular forms 7 2 5 canonical subgroups and related constructions let k be a p adic field so we can base change to s specok we formally complete x along p to obtain a formal scheme x with rigid analytic fiber x inside of x we have a formal open subscheme xord x which classifies ordinary hbavs it is known as the ordinary locus and its rigid analytic fiber is denoted x ord for each of the g primes p of f lying over p we have a hodge height hdgp which measures how supersingular a hbav is it only depends on the substring a with hdgp a q 0 1 this hodge height is the truncated valuation of the hasse invariant which is the determinant of verschiebung acting on a is ordinary at p if and only if hdgp a 0 for all p lying over p for any v v 1 vg we construct the v overconvergent locus x v which is a normal formal scheme that classifies hbavs a with hdgpi a vi for all i this description gives a well defined subset of the rigid analytic fiber x v x we take a formal model x v for it by taking admissible formal blowups as in aip 16 and normalize it in x v to obtain the formal overconvergent locus x v for each tuple v with vi 1 pn for all i we have a canonical subgroup cn x v of order pnd in fact it is an of submodule of a pn its fiber over the ordinary locus is locally isomorphic to pn d 1 f its fiber over the complement x v xord is isomorphic to a different formal group scheme but both become isomorphic to each other and to the constant group scheme of pnof at the rigid fiber we move to the rigid fiber cn x v in order to define in isomx v cn pn z d 1 f the map hn in x v is a finite e tale cover with galois group t z pnz we then let in be the formal model of in obtained by normalizing x v inside in and we let hn also refer to the covering in x v we call in and in partial igusa towers the canonical subgroups help us pick out an important subsheaf f which is described in aip 16 proposition 3 4 proposition 2 5 1 there is a unique subsheaf f of which is locally free of rank 1 as a of z oin module and contains p supi vi p 1 moreover for all 0 w n supi vi pnp 1 we have of linear maps 8 htw c d n h n f pwh n f these induce isomorphisms 9 htw 1 c d n oin pwoin h n f pwh n f we refer to aip 16 proposition 3 4 and aip 15 proposition 4 3 1 for a proof remark 2 5 2 the fact that f p supi vi p 1 shows that f ok k ok k as families of modules their rigid fibers give different integral structures to the rigid analytification of and only f gives a locally free sheaf of of modules specifically the rigid fiber of and the rigid fiber of f should be thought of as two versions of the ball of radius 1 inside the analytification of pulled back to in 2 6 overconvergent hilbert modular forms we fix a tuple v such that vi 1 pn for all i we have our canonical subgroup of level pn cn x v and a partial igusa tower in we write evd 1 in cdn for the map sending u to ud 1 this descends to a map of formal schemes evd 1 in c d n by the universal property of the relative normaliza tion following aip 16 we define the formal affine morphism w t f w in for any 8 jon aycock n 1 w n sup vi pnp 1 as follows for every normal p adically complete and sepa rated flat ok algebra r and for every morphism spf r in its r valued points over classify frames f of z r such that htw evd 1 u 1 1 mod pw the reference cited above writes this as needing to send 1 to 1 in the composite 10 of pnof ud cdn r htw f pw f of z r pwr the map w t f w in is a formal torsor for the group t 0 w composing with the projection in x v gives a formal torsor prw t f w x v for the group tw the rigid fiber is denoted t f w remark 2 6 1 in aip 16 this is called iw w in other references such as aip 15 liu 19 there are two related formal torsors one is called iw w while the other is t f w in the case of hilbert modular forms the two coincide we use the second name here so that our discussion in section 3 6 better parallels that of liu 19 section 3 4 for any representation w of tw we may construct a corresponding sheaf w on x v over an affinoid open u spr x v when u is trivial sections of w correspond to functions 11 h 0 x v f iw w u w r f a g g 1 f a definition 2 6 2 let be a w analytic weight a v overconvergent hilbert modular form of level 1 n and weight is a global section of thek vector space of v overconvergent hilbert modular forms of level 1 n and weight is thus h 0 x v w an overconvergent hilbert modular form is a v overconvergent hilbert modular form for some tuple v with each vi 0 the k vector space of overconvergent hilbert modular forms is the union vh 0 x v w 3 nearly hilbert modular forms 3 1 the de rham sheaf consider the relative de rham cohomology h 1 dr a x r 1 a x of a x this sheaf has a natural subsheaf h which is locally free of rank 2 as a sheaf of of z ox modules 5 over k it fits into an exact sequence of sheaves ofof z ox modules known as the hodge filtration 12 0 h 0 over k and are locally free of rank 1 as sheaves of of z ox modules so they are projective thus the sequence splits though non canonically in addition h admits a nondegenerate alternating pairing with respect to which is a maximal totally isotropic subspace which gives the explicit isomorphism between h and finally we note that h splits as a direct sum h h as did this gives a similar exact sequence for each embedding 13 0 h 0 this sequence gives a filtration h of h which induces filtrations on symkh for each k with filr symkh k r symrh we also get a filtration on sym h symk h indexed by the partially ordered set z 0 i where a pure tensor s is in 5 in fact h 1 dr a x agrees with h over y this h is a canonical extension of h 1 dr a y a locally free sheaf of of z of modules of rank 2 to such a sheaf defined over all of x differential operators for hilbert modular forms 9 fil sym h if s fil symk h for all in particular fil 0 sym h where 0 means 0 we define two x schemes as follows consider the sheaf of modules of z ox 2 with a filtration given by making the first copy of of ox serve as a submodule then let t h isomx f of z ox 2 h be the honest of frame bundle of h and t h isom x f of zox 2 h be the filtered of frame bundle for h where the superscript indicates that the isomorphisms must respect the filtration the structure map h t h x is a torsor for g aut of z ox 2 resof zgl 2 while h t h x is a torsor for the group aut of z ox 2 of automorphisms that respect the filtration which is the borel subgroup q consisting of upper triangular matrices there are maps t h t h as any frame of h that respects the filtration is a frame ofh and t h t as the isomorphism restricted to the first step of the filtration is exactly a frame for we have a functor e from the category of algebraic representations of q to the category of coherent sheaves on x given a representation v the sections of the associated sheaf e v are homogeneous functions to v we can write this explicitly over an affine open u specr x when the restriction h u is trivial 14 h 0 u e v f 1 h u v r f g g 1 f remark 3 1 1 the associated bundle is often written as a contracted product e v t h qv if v is the restriction of a given representation of g we may also form t h g v which will agree with e v this is a general construction which applies to a torsor for any group and any algebraic representation of that group if v is the standard representation of gl 2 we can form theg module sym v symk v over k where g g r acts on a pure tensor v by sending it to g v thene sym v sym h when the g representation sym v is restricted to q is acquires a filtration for which fil sym v is stabilized by q and e fil sym v fil sym h remark 3 1 2 since sym v is a g module we could have described sym h as t h g sym v instead of using t h however the same cannot be said for e g fil 0 sym h this is an important distinction the q torsor t h is useful for describing weights and types of nearly holomorphic hilbert modular forms however the gauss manin connection does not respect the filtration while it does give a principal connection on t h and on any associated bundles thereof it does not give one on t h this tension is why the theory of nearly holomorphic automorphic forms exists 3 2 the gauss manin connection the relative de rham cohomology admits a gauss manin connection which extends to a connection on h with logarithm poles on the bound ary c we denote it by h h 1 x logc it induces a principal connection on t h and a connection on any associated bundle t h g v for any representation v of g we can describe it in terms of the action of the lie algebra specifically we let u specr x be an affine open for which h u is trivial and we pick d a derivation r r viewing it as an element of tx u 6 then the covariant derivative in the direction of d is a linear map d h h which also commutes with the action of of any frame t h gives a natural basis for the fibers and d is given in this basis by some matrix 6 the exterior derivative d r 1 u gives rise to a directional derivative d d r r for any d tx u the directional derivative in the direction of d is a derivation on r and every derivation arises this way 10 jon aycock x d m 2 of zr if u meets the boundary it will actually be in m 2 of zfracr with logarithm poles over c this is g r where g is the lie algebra of g the map x d is g equivariant in the sense that x d g ad g 1 x d for all g g this is the standard condition for to induce a principal connection on t h one can see this formula at the level of linear algebra by using g as a change of basis matrix and noting that the ad action of g on g is given by conjugation let v be a representation of g so that it is also a representation of g then the associated bundle t h g v acquires a connection whose covariant derivative v can be described as 15 v f df x d f the action on pure tensors f r v r is d f r f d r and x d f r x d f r remark 3 2 1 one might think of functions to v r as r linear combinations of vectors in v the df term in equation 15 differentiates the function r r using the exterior derivative while the x d f term differentiates the sections of v this shows that it is a natural form for a connection that might be easier to describe in other ways the gauss manin connection is also used to define the kodaira spencer map consider the following composition 16 id h id h 1 x logc id pr id 1 x logc 1 x logc this morphism is surjective and over k it identifies 1 x logc with the summand 2 of 2 we write this isomorphism as ks 1 x logc 2 we will also use the projection ks 1 x logc 2 3 3 g q modules as noted in remark 3 1 2 the gauss manin connection does not re spect the filtration of h this presents a problem since the filtration is critical to describing the type not just the weight of a nearly holomorphic hilbert modular form fortunately there is a workaround which we take from liu 19 section 2 2 7 let g lieg and q lieq be the lie algebras of g and of its borel subgroup q respectively definition 3 3 1 a g q module defined over an algebra e is an algebraic representa tion v of both g and q on locally free e modules satisfying the following compatibility conditions 1 the action of q g is the same as that induced by q 2 for any g q x g and v v 17 ad g x v g x g 1 v any representation v of g has a natural action of g and of q these actions will be compatible in both senses above in fact any finite rank g q module arises this way c f liu 19 remark 2 7 in order to produce a g q module one can start with a representation v of q and form a basis of g whose first elements are a basis of q g the elements of q act in the way 7 the ideas seem to have existed before liu s paper liu does not claim to be the original source pointing instead to fc 90 section vi 4 however liu s paper is the only source the author knows of which defines g q modules explicitly for use in the context of automorphic forms so we cite it here differential operators for hilbert modular forms 11 induced by q so one only needs to give formulas for the action of the rest in a compatible way remark 3 3 2 another way to describe a g q module v is to pick some ring r and extend the q r module v r to a representation v r of an open subgroup q r g r containing q r since q r is open in g r its lie algebra is g one then checks that the action of g preserves v r as a subspace of v r and then calculates the formulas for the action which will automatically be compatible these formulas will only involve scalars from r so they will define a g q module over r if the scalars all come from a subring of r and the basis is defined over that subring then the formulas will define a g q module over that subring this is done e g in liu 19 section 2 3 a more conceptual proof after equation 2 5 for r zp we will use this method in section 3 4 as well let v be a g q module the formula in equation 15 shows that the gauss manin connection on the bundle associated to ag module is given in terms of the exterior derivative and the action of g thus one might hope that we can define a connection on v t h qv this is most of the content of the following proposition proposition 3 3 3 let v be a g q module then there is an integrable connection v on the associated bundle v t h q v given by the formula 18 v d v dv x d v proof the formula certainly gives a map o t h o t h 1 x logc in order to show that it gives a connection on v we have to show that the homogeneity property holds v v g g 1 v v in fact it holds for each term separately and we treat them separately first 19 dv g d g 1 v g 1 dv the first equality is by the homogeneity of v and the second by the chain rule for the exterior derivative d then 20 x d g v g ad g 1 x d g 1 v g 1 x d g g 1 v this reduces to g 1 x d v here we have used the second compatibility condition for g q modules in the second equality thus we have 21 v d v g dv g x d g v g g 1 dv g 1 x d v g 1 v v this is what we wanted to show the connection is integrable because d and both are 3 4 nearly holomorphic hilbert modular forms nearly holomorphic hilbert mod ular forms are sections of certain vector bundles in particular there should be finite rank representations v of q for all z i and r z 0 i so that a nearly holomor phic hilbert modular form of weight and type is a section of v t h q v each individual v is not a g q module which complicates the definition of the differential operators however we will have inclusion v 1 v 2 whenever i r i and r 2 r 1 for all and the union v v is a g q module it will satisfy g v v thus 12 jon aycock by proposition 3 3 3 and the forthcoming remark 3 4 3 we will obtain a connection v on v v satisfying 22 v v v 2 v 1 x logc the specifics are laid out in the rest of the section for now we fix an auxilliary prime which is unramified in f q l an adic field which splits f and ol its ring of integers we let i denote the set of embeddings of f into l we fix a weight k z i with w the corresponding 1 dimensional representa tion of t defined over ol we build the g q module v following the course laid out in remark 3 3 2 we begin by giving names to important non algebraic subgroups of g ol we will use the neighborhood ig ol q ol which contains the lower parabolic subgroup q ig ol and the levi subgroup h ol 23 ig ol a bc d g ol c pof ol q ig ol a 0 c d g ol c pof ol h ol a 00 d g ol note that q ig ol projects onto t ol by picking out the top left entry a we in flate the representation w l from t ol to q ig ol we have a unique choice of adic topology on the finite dimensional banach space w l consider the adic ana lytic induction v ol indig ol q ig ol w l which is the set of adic analytic functions ig ol w l which are homogeneous with respect to the action of q ig ol in the sense that hx h x for all x ig ol h q ig ol it is a representation of ig ol by right translation g x xg for all g x ig ol by the iwahori decomposition every coset q ig ol x q ig ol ig ol can be written as 24 q ig ol x q ig ol 1 y 0 1 this is for some unique choice of y of ol so that each v is determined by its values on these matrices we note that the coset spaces q ig ol ig ol and h ol q ol are the same down to the choice of representatives and view v as an algebraic representation defined over ol which consists of adic analytic functions from the coset space h q to w this allows us to write v r w origh q where origh q is the space of adic analytic functions on the rigid space h q for any ol algebra r we have natural coordinates on h q r of r r called y for each embedding f l 8 by standard theory of rigid spaces the ring of adic analytic functions on h q is orig h q spr r y the space of power series over r in the variables y whose coefficients go to 0 adically 8 this is where we use the fact that our auxilliary prime is unramified differential operators for hilbert modular forms 13 one may explicitly compute the action of ig ol on v ol obtaining the formulas 25 g p y a y c p a y c 1 b y d g a b c d here y and the entries of g are viewed as elements of the ring of ol the induced action of q ol and g ol may be computed from this formula for q ol this is simple substitute 0 for c in the formula above this gives the induced action of q ol on v ol to describe the action of the rest of g ol we need a basis since g ol gl 2 ol we may specify the actions of f l where is the element of gl 2 ol which is 0 0 1 0 in the entry corresponding to and the zero matrix in all other entries with our fixed choice of coordinates y we find that 26 p y y p y y 2 y p y here lie t gl 1 ol is the tuple with a 1 in the entry corresponding to and 0 in all other entries acting naturally on w specifically w k w for any w w notice that the space of polynomials w y is preserved by the actions of both q ol and g ol though it is not preserved by ig ol these are the algebraic functions on the scheme h q we have thus defined a g q module structure on v w oh q where now oh q is the space of algebraic functions on the coset space h q over ol this is the polynomial ring oh q r ol y ol y now we fix an algebra r over the ring of integers in the galois closure of f such that the discriminant of f is invertible in r over r we may write v w oh q w y where y y is our natural set of coordinates and we can extend any basis for q to a basis for g by using we have actions given by formulas for q 27 g p y a p a 1 b y d g a b 0 d for g we specify the action of the 28 p y y p y y 2 y p y these formulas give compatible actions since they were compatible on v remark 3 4 1 if we replace r by a subring o r then g o is a subalgebra of g r gl 2 r thus these formulas can still be used to describe the action but we have to be careful about what elements of the direct product we consider this is particularly important if p ramifies in f when r k is our chosen p adic field and o ok is its ring of integers not only does the action of q preserve the degree of the polynomial it preserves the degree in each variable y separately thus v has a filtration indexed by the partially ordered set z 0 i such that v is the space of polynomials of degree at most r in the variable y the lie algebra q also preserves the filtration we write g g over k since g is generated by q and it preserves the degree as a function of y for each and raises the degree as a function of y by at most 1 by the formula in equation 28 we have g v v 14 jon aycock definition 3 4 2 the sheaf of nearly holomorphic hilbert modular forms of weight is v t h q v the sheaf of nearly holomorphic hilbert modular forms of weight and type is v t h q v the k vector space of nearly holomorphic hilbert modular forms of weight and type is thus h 0 x v remark 3 4 3 using the filtration we can refine the statement of proposition 3 3 3 define the differential operator to be the composition 29 v v v 1 x logc 1 ks v 2 v 2 then d is given by the action of x d g where d is the projection of d 1 x logc onto the summand 2 thus it sends v into v 2 v 2 specifically raises the weight of a nearly holomorphic hilbert modular form by 2 and its type by note that we have written with no reference to or since they are clear from context while is not in addition we write k in order to make better sense of what character 2 corresponds to it is known c f kat 78 lemma 2 1 14 that and commute for any pair of em beddings and thus we may unambiguously write for the differential operator that raises weights by 2 k and types k 3 5 comparison to classical theory let hf be as in section 2 4 and let s hf c be the smooth function s s z 1 z z following shi 00 section 13 11 we define definition 3 5 1 a nearly holomorphic hilbert modular form of level weight k and type r is a c function f hf c such that 1 f z is nearly holomorphic i e it can be written as a polynomial in the variables s whose coefficients are holomorphic functions hf c and whose degree as a function of only s is at most r and 2 for all and z z hf we let z c z d gm c t c and f satisfies the transformation property 30 f z z f z let s s z s z for k we may write s sk by viewing s as an element of gm c t c the maass shimura differential operators are defined to be the composition 31 d f s z s 1 f it is classical that d raises the weight by 2 and the type by we have defined nearly holomorphic hilbert modular forms in terms of functions on t h in order to pull these back to nearly holomorphic functions on hf we need to extend our map hf t y c from section 2 4 to a map hf t h y c for z z hf we get the abelian variety az of z c lz its tangent space isof zc c which has a natural r basis the copy of c corresponding to is spanned by 1 and z the de rham cohomology h 1 dr az is the complexification of the cotangent bundle so this basis of the tangent space gives a dual basis i for the de rham cohomology for any a b z c 32 a b z a and a b z b differential operators for hilbert modular forms 15 this c basis for h 1 dr az gives rise to a of zc basis for the de rham cohomoogy it is horizontal for the gauss manin connection 0 however it does not respect the filtration so it does not determine an element of t h instead we take dw from section 2 4 which trivializes and above this dw is a holomorphic frame for h 1 dr az as a of c module as sheaves of c hf c modules there is another basis dw dw for h 1 dr az this basis does not give a suitable element of t h but it does if we replace it by dw dws our two bases are related by 33 dw dws dw 1 s 0 1 we define a map from global sections of v to nearly holomorphic hilbert modular forms in the sense of definition 3 5 1 34 f z f az z z z dw dws y 0 we may use equation 33 to get another description since dw is a holomorphic frame we may write f az z z z dw pf y for some polynomial pf of degree at most r in each y whose coefficients vary holomorphically with z then 35 f z f az z z z dw dws y 0 f az z z z dw 1 s 0 1 y 0 1 s 0 1 f az z z z dw y 0 1 s 0 1 pf y y 0 pf y s y 0 pf s z so f z f az z z z dw dws y 0 f az z z z dw y s z pf s z since pf is a polynomial of degree at most r in the y s whose coefficients are holomorphic functions on hf f pf s z is such a polynomial in the s s whose coefficients are such holomorphic functions hf c this map leads to two comparison theorems theorem 3 5 2 let n be the space of nearly holomorphic hilbert modular forms of level 1 n weight and type in the sense of definition 3 5 1 then h 0 x v n is an isomorphism proof let f be a global section of v by the discussion immediately preceding this theorem f is written as a polynomial of the correct degree in the s s whose coefficients are holomorphic maps hf c the correspondence pf y pf s is easily reversed so we just need to show that the transformation property is preserved for z z hf and we let z t c be 36 z c z d gm c t c a b c d 16 jon aycock then we want to show that f z z f z z f z the map gives an isomorphism az a z w z 1 w this modifies the frames for the de rham cohomology 37 dw dws dw dws z 1 0 0 z from the action of q on v we get the desired transformation property 38 f z f a z z z z dw dws y 0 f az z z z dw dws y 0 f az z z z dw dws z 1 00 z y 0 z f az z z z dw dws y 0 z f z thus is an isomorphism from the space of global sections of v to the space of nearly holomorphic hilbert modular forms of weight and type in the sense of shimura theorem 3 5 3 the map is the analog of the maass shimura operator in the sense that d proof want to show d f z f z we compute the left hand side using the fact that s z s 2 while s z 0 if by the definition of the maass shimura operator in equation 31 39 d f z s z z s z 1 f z s k f z z f z writing f z pf s as above we differentiate with respect to z noting that both the coefficients of pf and the input s depend on z 40 z f z z pf s pf y z y s pf y s s z we are left with 41 d f z s k f z pf z y s s 2 pf y s differential operators for hilbert modular forms 17 for the right hand side we use the fact that dw dw to compute using the definition of 42 f az z z z dw z f f az z z z dw z pf y pf y pf z y y p y y 2 pf y y evaluating at y s gives f z since pf k pf we find that these agree the fact that above is the correct analog for the maass shimura operators in this formulation of nearly holomorphic hilbert modular forms informs how we construct the analog in the overconvergent setting remark 3 5 4 let f be a nearly holomorphic hilbert modular form of weight and type written as a polynomial 43 f z r r fr z sr r r fr z s r the holomorphic projection of f is the holomorphic function f 0 implicit in this statement is the reliance on a given splitting of the hodge filtration which picks out as a certain submodule of h consisting of anti holomorphic differentials thus we may say that with respect to this splitting the holomorphic projection of f is f 0 viewing nearly holomorphic hilbert modular forms as homogeneous functions to v the holomorphic projection with respect to this splitting can be recovered by the map v w y w which sets y 0 i e realizing the form as a nearly holomorphic function and then taking its holomorphic projection is the same as setting y 0 and then realizing the form we note that at cm points this splitting of the hodge filtration is algebraic and is still given by setting y 0 finally we note that the space of splittings of the hodge filtration is isomorphic to the coset space h q a splitting corresponds an of basis for h up to scale where the first vector in the basis should generate and the second generates its complement the group q acts freely and transitively on these bases and the action of h simply rescales the vectors in the basis in such a way that it does not change the direct sum decomposition of h viewing nearly hilbert modular forms as functions to v w oh q we can regard the holomorphic projection with respect to a splitting of the hodge filtration as evaluation at the point corresponding to that splitting in oh q under this view the splitting that picks out the anti holomorphic differentials as a complement to h serves as our base point corresponding to the trivial coset h with coordinates y 0 by viewing v w oh q and h q as being non canonically isomorphic to the space of splittings for the hodge filtration we get the following philosophy a nearly automorphic form is a gadget that takes in a splitting of the hodge filtration and spits out an honest automorphic form 3 6 nearly overconvergent hilbert modular forms there is a natural homomor phism q t that picks out the top left entry let q 0 w be the rigid analytic group which is the preimage of t 0 w under this projection and qw the preimage of tw 18 jon aycock we have previously considered the ok schemes t isomx of z ox and t h isom x of z ox 2 h where the superscript means that the isomorphisms should respect the filtrations we write t an and t h an for their rigid analytifications and t an v and t h an v for their base changes to x v we have a map t h an v t an v given by forgetting everything but the isomorphism on the submodules of z ox v and then let t f w iw x v be the rigid fiber of the chain of morphisms defined in section 2 6 this maps to t an as well 9 we thus form the fiber product 44 t h w v t h an v t an v t f w v the map w t h w v x v is a torsor for the group qw let be a w analytic weight there is an associated rigid analytic representation w w of tw which we inflate to qw in similar fashion to the holomorphic case we define the analytic g qw module v w by 45 v w w w oh q we give g k the same basis as before since qw is open in q its lie algebra is still q g we define the actions of g k and qw k by the same formulas 46 g p y a p a 1 b y d for all g a b 0 d qw r 47 p y y p y y 2 y p y compatibility is checked in the same way since the action of qw preserves the degree of each y there is a qw submodule v w v w consisting of polynomials with degree at most r in the variable y for each since g raises the degree by at most g v w v w definition 3 6 1 the sheaf of nearly v overconvergent hilbert modular forms of level 1 n w analytic weight and type is v w v t h w v qw v w a nearly overcon vergent hilbert modular form of level 1 n w analytic weight and type is a section of v w v for some v with each vi satisfying 0 vi 1 pw proposition 3 3 3 gives us a connection w v w v w 1 x v logc and the kodaira spencer morphism gives us our differential operators 48 w v w v 2 w the discussion of remark 3 4 3 applies giving 49 w v w v 2 w each w commutes with w for any pair of embeddings i thus we may unambiguously write w for the differential operator that raises weights by 2 k and types by k we can also base change to x v for any v v i with 0 v i vi for each i 9 it does not map to the rigid fiber of the formal completion of t as the points of either space should be of z ok bases for the respective sheaves which do not match up the points of t an are instead of k bases for differential operators for hilbert modular forms 19 this construction works just as well for a single weight as it does for the universal w analytic weight unw and pulling back by the inclusion of an affinoid open u ww allows us to apply these differential operators to families parametrized by u we summarize these results in the following theorem theorem 3 6 2 fix a tuple v vi with 0 vi 1 pw for all i for each embedding f k and any k 1 there is a differential operator k acting on families of nearly v overconvergent hilbert modular forms of w analytic weight which raises the weight by 2 k and the type by k the operators k and commute for any pair of embeddings and 3 7 integrality as constructed this differential operator is defined over k however when p is unramified in f it is defined over ok each module v r is defined over z but our description and the basis we chose are only defined over k a priori it is true that the connection is defined over ok in general however there is a problem to defining when p is ramified in f over k we can decompose g g any trivialization t h over an affine open u specr defined over k determines a trivialization of and thus of 50 2 1 x logc we let d tx u be the direction dual to that trivialization and x d g r such that d v x d v in fact we get a basis d for each 2 we embed that sheaf as a summand of 1 x logc and view the set d as a basis of the latter sheaf let d tx u be dual to d we have x d g r and d d giving x d x d specifically x d g r corresponds to the tuple x d g r under this formalism we have v x d v with this in mind we turn to integrality when p is unramified in f the decomposition g g manifests over ok and acts integrally however when p ramifies there is no guarantee that x d g ok under the assumption that x d g ok however we can quantify by how much this fails and we do so using the following lemma lemma 3 7 1 let r r ok there exists some not depending on r such that p r of ok ok proof pick a z basis e 1 ed forof and order the embeddings of f intok 1 d the ok linear map of ok ok is given in this basis by the matrix 51 m 1 e 1 d e 1 1 ed d ed it is classical that detm 2 is the discriminant of f q further the index of the image of this ok linear map is ok detm let p be the maximal ideal in ok and write detm p for some we have ok p pf where f is the residue field degree thus pf r of ok whenever r ok this exponent does not depend on the choice of r so the lemma is proven remark 3 7 2 in fact we can say more since ok of ok is a ok module of order pf it is killed by p the worst case scenario is that the quotient is indecomposable and thus isomorphic to the indecomposable module ok p this module has size pf but is killed by p 20 jon aycock we use this to prove more about the lie algebra g corollary 3 7 3 let x x g ok gl 2 ok g k view x as the tuple 0 x 0 in gl 2 ok g k then there exists some independent of x such that p x g ok proof pick as in lemma 3 7 1 note that the elements of g ok should be viewed as 2 2 matrices with entries in of ok while x is a priori a tuple of 2 2 matrices with entries in ok we may instead view x as a 2 2 matrix with entries in ok scaling x by p simply scales its entries so by our choice of the entries of p x are in of ok and p x g ok by the corollary we have p x d g ok thus p x d acts integrally 52 x d v ok 1 p v ok v k on the level of sheaves the above translates to 53 v ok 1 p v 2 ok v 2 k this allows us to control denominators 4 descent 4 1 two groups the phrase hilbert modular form is ambiguous in that it can refer to the space of automorphic forms on one of two groups the group g resof zgl 2 is one for any commutative ring r its r points are g r gl 2 of z r determinants of such matrices live in t resof zgm recall that over k t is a split torus its diagonal subgroup is isomorphic to gm the second group denoted g is defined as the fiber product g g t gm it is a subgroup of g with r points g r g g r det g 1 r of r each group has its advantages the hecke theory for g is canonical while the theory for g is not producing a non commutative hecke algebra on the other hand while both are the groups of interest in a pel type moduli problem only the moduli problem associated to g is actually representable by a scheme this is exactly the reason why the previous sections were only concerned with the automorphic forms on g since g is a subgroup of g we may restrict the automorphic forms on g to the group g viewing them as automorphic forms on the latter group as in aip 16 we record the geometric condition that distinguishes these restricted forms from other automorphic forms on g let f be an automorphic form on g of weight 2 nmw f q it can be extended to an automorphic form on g if for all o f we have 54 f a f a we will avoid using this criterion it is included to stress the fact that whether or not an automorphic form on g extends to g can be detected geometrically we will opt instead to use a criterion involving the symmetric space this will be enough as proposition 4 4 1 can be stated in terms of classical hilbert modular forms and easily transported to the space of overconvergent ones differential operators for hilbert modular forms 21 4 2 weights in section 2 1 we introduced the weight space for overconvergent modular forms on g here we continue with the weight space for g including the weight of a restricted modular form the space of algebraic weights for g is characters of t k z with a map to the algebraic weights for g given by w 2 wnmf q in particular if w is a weight for g w g g 2 nmf q g w for any g t zp if we have a modular form of weight w on g its restriction to g will have weight w the space of p adic weights for g is characters of t zp zp the map sending a p adic weight for g to a p adic weight for g uses the same formula as above 4 3 descent of modular forms we can quantify the difference between automorphic forms on g and automorphic forms on g using the ade lic viewpoint let k be a maximal compact subgroup of the connected component of the identity g r in g r and k the same for g r let k 0 n and k 0 n be the natural choices of compact open subsets of the finite ade les consisting of matrices which are upper triangular modulo n the inclusion g g induces a map on the symmetric spaces g r k z g r g r k z g r which ends up being a bijection thus automorphic forms on g and automorphic forms on g are functions on the same space the only difference comes from the congruence subgroups 55 0 n g q k 0 n a bc d sl 2 of c 0 mod n g 0 n g q k 0 n a bc d gl 2 of c 0 mod n for any o f let g 00 1 equation 54 is simply a translation of the fact that g g 0 n while g 0 n in a strict sense this is the only discrepancy as 0 n and these matrices g together generate g 0 n we define an action of o f on the space of automorphic forms on g of weight w to be 56 f f g the discussion above implies that f is a modular form for g if and only if o f acts on f via its nebentypus 4 4 descent of operators at the moment the differential operators are defined as maps that send hilbert modular forms on g to hilbert modular forms on g a priori if f is a nearly overconvergent hilbert modular form for g f is only a nearly overconvergent hilbert modular form for g we will argue that it extends to g proposition 4 4 1 the action of o f defined in equation 56 commutes with the gauss manin connection h h 1 x proof this is classical and seen e g as a special case of shi 00 proposition 12 10 2 for another proof we note that the slash operator is defined in such a way that it commutes with the exterior derivative d defined for differential forms since arises as a differential in the spectral sequence associated to a filtered de rham complex whose differentials are this d it commutes with the slash operator as well 22 jon aycock this leads to our second main theorem theorem 4 4 2 the differential operators constructed in theorem 3 6 2 preserve the space of hilbert modular forms for g inside the space of hilbert modular forms for g proof this is essentially a special case of proposition 3 3 3 the fiber of t h over some point x corresponding to a hbav a only depends on the substring a so we may identify the fibers over any x with the fibers over g x under this identification the slash operator is just the natural action of q g on v and we proved that this action commutes with in the previously cited proposition thus the fact descends to each references ai 21 fabrizio andreatta and adrian iovita katz type p adic l functions for primes p non split in the cm field 2021 aip 15 fabrizio andreatta adrian iovita and vincent pilloni p adic families of siegel modular cuspforms ann of math 2 181 2015 no 2 623 697 mr 3275848 aip 16 on overconvergent hilbert modular cusp forms aste risque 2016 no 382 163 193 mr 3581177 dr 80 pierre deligne and kenneth a ribet values of abelian l functions at negative integers over totally real fields invent math 59 1980 no 3 227 286 mr 579702 dsg 14 ehud de shalit and eyal z goren a theta operator on picard modular forms modulo an inert prime research in the mathematical sciences 3 2014 1 65 dsg 19 ehud de shalit and eyal z goren theta operators on unitary shimura varieties algebra number theory 13 2019 no 8 1829 1877 em 21 e eischen and e mantovan p adic families of automorphic forms in the ordinary setting amer j math 143 2021 no 1 1 52 mr 4201778 fc 90 gerd faltings and ching li chai degeneration of abelian varieties ergebnisse der mathematik und ihrer grenzgebiete 3 results in mathematics and related areas 3 vol 22 springer verlag berlin 1990 with an appendix by david mumford mr 1083353 gra 20 giacomo graziani modular sheaves of de rham classes on hilbert formal modular schemes for unramified primes ph d thesis 2020 gs 81 catherine goldstein and norbert schappacher se ries d eisenstein et fonctions l de courbes ellip tiques a multiplication complexe j reine angew math 327 1981 184 218 mr 631315 har 81 michael harris special values of zeta functions attached to siegel modular forms annales scien tifiques de l e cole normale supe rieure ser 4 14 1981 no 1 77 120 en mr 82 m 10046 har 86 arithmetic vector bundles and automorphic forms on shimura varieties ii compositio mathematica 60 1986 no 3 323 378 en mr 869106 hx 14 robert harron and liang xiao gauss manin connections for p adic families of nearly overconver gent modular forms ann inst fourier grenoble 64 2014 no 6 2449 2464 mr 3331170 kat 76 nicholas m katz p adic interpolation of real analytic eisenstein series ann of math 2 104 1976 no 3 459 571 mr 506271 kat 78 p adic l functions for cm fields invent math 49 1978 no 3 199 297 mr 513095 liu 19 zheng liu nearly overconvergent siegel modular forms ann inst fourier grenoble 69 2019 no 6 2439 2506 mr 4033924 liu 20 p adic l functions for ordinary families on symplectic groups j inst math jussieu 19 2020 no 4 1287 1347 mr 4120810 ser 72 j p serre formes modulaires et fonctions ze ta p adiques proc internat summer school univ antwerp 1972 pp 101 268 shi 76 goro shimura the special values of the zeta functions associated with cusp forms communications on pure and applied mathematics 29 1976 no 6 783 804 shi 00 arithmeticity in the theory of automorphic forms mathematical surveys and monographs vol 82 american mathematical society providence ri 2000 mr 1780262 urb 14 eric urban nearly overconvergent modular forms iwasawa theory 2012 contrib math comput sci vol 7 springer heidelberg 2014 pp 401 441 mr 3586822 differential operators for hilbert modular forms 23 jon aycock department of mathematics university of oregon fenton hall eugene or 97403 1222 usa email address jaycock uoregon edu 1 introduction 2 hilbert modular forms 3 nearly hilbert modular forms 4 descent references