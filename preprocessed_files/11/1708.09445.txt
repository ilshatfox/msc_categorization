coppersmith s lattices and focus groups an attack on small exponent rsa stephen d miller bhargav narayanan miller narayanan math rutgers edu and ramarathnam venkatesan venkie microsoft com december 18 2020 abstract we present a principled technique for reducing the lattice and ma trix size in some applications of coppersmith s lattice method for find ing roots of modular polynomial equations it relies on extrapolating patterns from the actual behavior of coppersmith s attack for smaller parameter sizes which can be thought of as focus group testing when applied to the small exponent rsa problem our technique re duces lattice dimensions and consequently running times and hence can be applied to a wider range of exponents moreover in many dif ficult examples our attack is not only faster but also more successful in recovering the rsa secret key we include a discussion of subtleties concerning whether or not existing metrics such as enabling condition bounds are decisive in predicting the true efficacy of attacks based on coppersmith s method finally indications are given which suggest certain lattice basis reduction algorithms such as nguyen stehle s l 2 may be particularly well suited for coppersmith s method keywords factoring small exponent rsa lattice attacks lat tice basis reduction coppersmith s method supported by nsf grants cns 1526333 and cns 1815562 supported by nsf grant dms 1800521 1 ar x iv 1 70 8 09 44 5 v 3 cs c r 1 6 d ec 2 02 0 1 introduction ever since shamir s devastating attack on the knapsack cryptosystem 19 lattice basis reduction algorithms such as lll 15 have found surprising success against cryptosystems that a priori have nothing to do with lattices a fundamental example is the rsa cryptosystem 18 whose public key consists of an integer n pq where p and q are large secret primes of comparable size and an encryption exponent e in situations where some extra information about the public key is known e g certain bits of p or q it is sometimes possible to use the lattice basis reduction method of coppersmith 7 to discover the factorization of n one notable such situation is when the secret decryption exponent d is small 1 1 d n 1 2 see section 2 for more background on rsa wiener 21 showed that contin ued fractions expose d when 1 4 essentially instantaneously continued fraction approximations can be thought of as the simplest example of lattice basis reduction namely for 2 dimensional lattices boneh durfee 4 apply coppersmith s method with higher dimensional lattices to give an attack for 1 2 1 2 1 2 292 more precisely they prove that lll s output on a particular lattice pro duces enough information to factor n subject to an algebraic independence assumption it is an important open problem to improve 1 the bound 1 2 which still stands as the current record despite many attempts to improve it or to even rigorously establish the needed algebraic independence see 2 1 this raises the question of what precisely constitutes an improvement over boneh durfee s 292 result 4 merely replacing 292 by a larger constant alone is insufficient since algebraic dependence may creep for smaller indeed bauer 1 gives an attack in which the right hand side of 1 2 can be replaced by 34 but which suffers from a failure of algebraic independence at a much earlier point on the other hand it should be pointed out that we don t even know at present whether or not boneh durfee s attack suffers from the same problem before reaching 292 see the end of section 2 for more comments on the practical side one sees another obstacle from 1 3 attacks which require enor mous lattices are infeasible and cannot come close to their theoretical limitations anyhow our approach here is to develop a method which gives experimentally verified improve ments over previous work 2 since the lll algorithm has a widespread reputation for outperforming its provable guarantees one might surmise that the bound 1 2 is more modest than actual experiments would indicate surprisingly the opposite is true all successful experiments in the literature work only for relatively far below the theoretical upper bound of 1 2 1 2 292 4 5 22 the reason for this is that 1 2 is an asymptotic estimate that requires very large lattices specifically for 1 024 bit moduli n 1 3 boneh durfee s attack requires lattices of dimension 500 for 278 the difficulty of finding short vectors in lattices of dimension 500 already serves as the hard underlying problem behind other cryptosystems and in deed 278 is close to the limit of known experiments in 4 5 22 2 thus implementing lattice based attacks can itself face impractically diffi cult problems even in ranges covered by theoretical guarantees it is therefore natural to ask the following questions q 1 can one practically solve small exponent rsa instances for signifi cantly larger than the experiments reported in 4 5 22 q 2 is there a barrier from algebraic independence that creeps in before the theoretical upper bound is reached if so how does one estimate the true range of validity of the attack q 3 how can coppersmith s method be modified to reduce the size of the matrices and their entries involved it has long been considered to look at sublattices but what are the optimal sublattices to choose in section 2 we review coppersmith s method and the boneh durfee at tack and comment on some nuances of comparing theoretical analyses to actual outcomes in applications of coppersmith s method e g q 2 the main contribution of this paper is to q 3 by introducing a method in sec tion 3 influenced by the idea from machine learning of trying to find patterns in known examples rather than being guided solely by theory to cut down the matrix size and hence push back the choke point that high dimensional 2 it follows that it is important to distinguish between theoretical ranges of applicability of coppersmith s method and the practical ranges that they could possibly be applied to in light of the difficulty of lattice basis reduction in large dimensions 3 lattice basis reduction algorithms face in practice we use that to address q 1 in section 4 where we show our method is faster and often more effective in section 5 we present another example of how the focus group method can be applied to the attack in 3 6 where the size of the spanning set can be reduced significantly we chose these two examples because they are prominent theoretical and practical applications of coppersmith s method to rsa all the computations here unless otherwise noted were performed in mathematica 3 v 11 on a dell poweredge r 740 xd server equipped with two intel xeon silver 4114 2 2 ghz processors and 256 gb ram in particular we did not use specialized lattice basis reduction packages such as 9 20 we would like to thank dan boneh henry cohn nadia heninger jeff hoffstein antoine joux daniel lichtblau alexander may oded regev adi shamir noah stephens davidowitz and david wong for their helpful discussions we are also very appreciative of the anonymous referee for their very helpful comments and to galen collier and the staff of the rutgers office of advanced research computing for their assistance with rutgers amarel high performance cluster 2 an overview of coppersmith s method and boneh durfee s attack on rsa as before let p and q be secret large prime numbers of comparable size and n pq the public rsa modulus let e be the public encryption exponent and d n be the secret decryption exponent which satisfy ed 1 mod n where n p 1 q 1 n p q 1 in this case d s relation to e can be restated as the existence of an integer k such that 2 1 e d 1 k n where k n in which we have made the natural and trivially verifiable assumption that the public exponent e has comparable size to n after dividing both 3 specifically using mathematica s latticereduce command which implements the l 2 algorithm of nguyen and stehle 17 4 sides by d n and using the fact that n n o n this implies 2 2 en kd en e n e n kd o e n 3 2 1 d n o n 1 2 wiener 21 observed that if 1 4 the fraction k d approximates e n much more accurately than d 2 n 2 which is an unusually good approximation of a real number by a rational number of denominator d hence k d occurs among the continued fraction approximants to e n and can be very efficiently computed following 4 consider the bivariate polynomial 2 3 f x y x n y 1 which according to 2 1 satisfies 2 4 f x 0 y 0 0 mod e where 2 5 x 0 k o e and y 0 n n o e are both relatively small compared to the modulus e coppersmith s method in this example following howgrave graham 11 is used to promote a polynomial congruence relation such as 2 4 into a system of two integer polynomial equalities which can then be solved using classical methods to illustrate this in terms of the boneh durfee attack define x shifts and y shifts 2 6 gi m x y x i f x y em and hj m x y y j f x y em for 2 7 0 m 0 i m and 1 j t they satisfy 2 8 gi m x 0 y 0 hi m x 0 y 0 0 mod em 5 and span a sublattice of r x y the latter of which is endowed with the sum of squares norm on polynomial coefficients a short vector in this sublattice is a polynomial with small coefficients ideally small enough that its value at a particular point such as x 0 y 0 will itself be relatively small by 2 8 that value is also a multiple of em thus if it is less than em in absolute value it must actually vanish to make this more precise in our setting let x and y be upper bounds for x 0 and y 0 respectively such as provided in 2 5 howgrave graham 11 observed that if a polynomial p x y satisfies 4 2 9 p xx yy em wp where wp is the number of nonzero monomials in p then an application of cauchy schwartz shows p x 0 y 0 em in particular x 0 y 0 is a root of p over z since p x 0 y 0 0 mod em boneh durfee prove that this norm condition is met for the shortest vector outputted by lll provided 2 10 em w 1 w 2 w 1 w 2 w dim where denotes the covolume of for 7 6 7 3 284 this enabling condition is met for sufficiently large values of m and e we shall refer to this as the boneh durfee 284 attack in order to distinguish it from their more refined analysis using a carefully selected sublattice that extends the range to 1 2 1 2 292 see also 5 12 14 for other attacks theoretically deriving exponents of this size or close to it under the enabling condition 2 10 the two shortest vectors outputted by lll are coefficients of bivariate polynomials which vanish at x 0 y 0 boneh durfee point out that in practice these polynomials are algebraically independent and thus their common roots can be extracted using resultants however this observed algebraic independence has not yet been rigorously established see 2 in principle as can happen for example if one does not use any of the polynomials hj m the shortest vectors may all result in 4 note that vector length is not necessarily the appropriate metric the length condition 2 9 is quadratic in the polynomial coefficients but the actual value of interest the polynomial evaluated at a particular point is instead linear it is the value of a linear functional on of course bounding the norm bounds the value of a linear functional but possibly with a significant loss one might imagine leveraging some geometric information about x 0 and y 0 such as their sign which is known in advance 6 polynomials which are trivial multiples of each other and hence not give enough equations to reveal the two unknowns x 0 and y 0 an interesting example consider the 1 000 bit rsa modulus n pq and key d n given by p 327534248375076317083641611376534056264358811260976111454743 469579874653650577266211366585026890270802159105074832098421 5116927258714434174724054953133 q 327462704072360233831723075103626846066746692190298143145154 087005180715732984190358817594057449905589163120424047417288 3400239374471379393571624577657 and d 300147077152565471186517713474704374146330287118250537992743 5326735028048350149451 2707 we applied the bkz lattice basis reduction from 20 with block size 3 to the lattice from boneh durfee s 292 attack with parameters m t 5 2 of the 25 output vectors only one of them the fifth longest 5 produces a polynomial which vanishes at x 0 y 0 interestingly and perhaps counterin tuitively applying bkz with larger block size such as 5 failed to produce any vectors vanishing at x 0 y 0 we were unable to do any better using the implementation of bkz in sagemath this example demonstrates that the vector length of the output basis is not the sole determinant of success in addition to the sensitivity to the choice of lattice basis reduction method it is worth mentioning other lattice attacks which use polynomials dif ferent from 2 3 and which also consistently beat wiener s 1 4 bound bauer s thesis 1 chapter 4 discusses a three variable analog based on us ing a short continued fraction approximation of e n stopping roughly at the point at which it is theoretically expected to differ from that of e n two additional integer parameters are then substituted to account for the remain 5 a similar feature was already observed in a bauer s ph d thesis 1 7 ing part of the continued fraction approximation 6 a lattice is again formed as above using congruences modulo powers of e her analysis of the enabling condition shows that when 34 the lattice has short vectors that produce polynomials which vanish at the desired roots alternatively one can instead apply the lattice method of 13 to this partial continued fraction approach as we have attempted in experiments its analogous enabling condition holds for 1 3 these are theoretical ranges in which coppersmith s method will provably find short vectors for large enough lattice sizes yet possibly nevertheless fail to factor n because of algebraic dependence both ranges extend much further than boneh durfee s 1 2 1 2 292 range and the lattice sizes in both attacks can be improved using the focus group methodology in section 3 below indeed despite the promising increase in this range for from 292 to 1 3 or 34 neither of these approaches comes near 292 in practice the results of our limited experimental trials indicate that the actual performance of either of these algorithms seems roughly comparable to that of boneh durfee s in particular the experiments show that algebraic independence fails at a much earlier point well before the enabling condition of 1 3 or 34 is reached furthermore the lattice sizes necessary to study such large ex ponents are themselves impractically large that calls into question the direct practical relevance of the enabling condition itself and demonstrates the importance of a better understanding of the actual performance of these attacks remarks on sublattices and minimizing in order to leverage prov able guarantees that a lattice basis reduction algorithm will find a sufficiently short vector sublattices in variants of coppersmith s attack are often taken in order to effectively reduce the covolume see q 3 in section 1 this is primarily done to ensure the validity of an enabling condition such as 2 10 while this allows for rigorous theoretical analysis there are geometric rea sons why it may not be optimal if does not behave like a random lattice it may have vectors at several length scales that do not interact much with each other 6 see also the paper 8 the anonymous referee of the present paper kindly suggested another approach attempt to guess a portion of the bits of these unknown parameters in the hopes of gaining a more than compensating savings from the smaller lattices which result from analyzing the remaining portion 8 for example suppose one appends a very long vector to a short basis of a lattice perpendicular to it this would magnify the covolume without affecting the outcome of lattice basis reduction at all the ultimate goal in coppersmith s method is not to reduce the co volume but to increase the likelihood of finding a short vector it is more important to identify sublattices having short vectors which is not well measured by the covolume as we have noted in the above discussion of bauer s thesis 1 attacks with very different enabling condition bounds may perform similarly in practice since algebraic dependence may creep in before the enabling condition is reached thus itself may not actually enter into a meaningful bound anyhow we conclude this section by remarking that the lattices produced in the boneh durfee attack appear to be far from random as is evidenced by their vector lengths this appears to be in contrast with the lattices produced in other applications of coppersmith s method though not all e g 6 for example one typically expects a basis outputted by the lll algorithm 15 to have vectors of comparable length figure 1 shows the logarithms of the vector lengths in the original and reduced lattice bases for an instance of the boneh durfee 284 attack with n 26 000 and 284 at this logarithmic scale one can see clumps of basis vectors of roughly the same length yet nev ertheless the overall lengths of the basis vectors do differ significantly within each plot the plot the left indicates that the input basis has several different regimes owing to the structure of 2 6 2 7 the plot on the right shows that the output basis also has vectors in fewer clumps of similar logarith mic length in particular with a large separation between the shortest vector which represents a constant polynomial and the others not surprisingly the attack failed in this particular instance understanding this clumping phenomenon may help gain insight into coppersmith s method for exam ple is there inhomogeneity in the geometry of the lattice that effectively reduces its dimension if so can it be exploited this is the underlying geometric motivation behind the focus group method in section 3 which is an approach to identifying sublattices having short vectors 9 figure 1 natural logarithms of lengths of lattice basis vectors in the boneh durfee 284 attack with n 26 000 and 284 before and after lattice basis reduction the attack failed in this instance 3 focus group attacks applying lattice basis reduction to a sublattice may increase the chances of finding short vectors while of course simultaneously decreasing run time given the inherent limitations in performing lattice basis reduction in high dimensions sometimes finding an appropriate sublattice can make the dif ference between finding solutions and finding no solutions at all or not even being able to fully execute lattice reduction in this section we describe a principled evidence based approach to se lecting a sublattice in certain lattice basis reduction problems such as ap plications of coppersmith s method its main idea is to deform to a simpler problem in which one can directly determine which basis vectors contribute nontrivially to the shortest vectors this methodology is applied in section 4 to small exponent rsa and in section 5 to the coppersmith in the wild smart card attack of 3 this focus group attack consists of three main steps 1 set small parameters find a regime with the same lattice dimen sion but reduced sizes of basis vectors coordinate entries this makes it faster or even possible to execute lattice basis reduction on large matrices for example in the case of small exponent rsa we set in 1 1 to be slightly larger than 1 4 which is the point at which wiener s continued fraction attack ceases to work of course would be desirable to improve this step by theoretically understanding in advance which basis vectors to keep e g using the notion of helpful vector from 16 chapter 7 rather to rely on experiments but this may not be practical because of the complexity of lattice basis reduction 10 figure 2 a representation of the change of basis matrix for the lattice basis reduction step in boneh durfee s 284 attack see the text for more details the matrix has a number of columns with many zero entries marked white 2 check the output to see which parts of the original basis were actually used figure 2 pictorially represents the change of basis matrix for the lattice basis reduction step in boneh durfee s 284 attack for a 6 000 bit rsa modulus n with 251 and parameters m t 4 2 see 2 7 the columns are indexed by the input basis vectors and the rows are indexed by the output basis vectors each entry in the matrix is plotted as blue dark gray positive orange light gray negative or white zero the long white vertical streaks emanating from the top of the figure reveal that certain input basis vectors are not used in forming the short est vectors in the lattice output those basis elements from 2 6 2 7 can be graphically represented as in figure 3 where the figure on the left represents the x shifts and the figure on the right represents the y shifts here the unfilled white circles indicate unused vectors and filled black circles indicate useful vectors boneh durfee s 292 attack refines their 284 attack by discarding some y shifts from 2 7 but not the same ones as here theirs are chosen to minimize the covolume 11 figure 3 a representation of which polynomials in 2 6 2 7 are actually used black circles in forming the shortest vector in the lattice basis reduc tion step for a particular instance of the boneh durfee attack the unfilled white circles represent discarded basis vectors see the text for more details in fact the figure indicates that most of the y shifts are not actually used it is more striking that some of the smaller x shifts are not used consistent with the utility of a similar device in 5 4 similar patterns arise for larger parameter sizes and were used to formulate the attack in section 4 indeed examples of patterns yield useful descriptions in terms of extra additional parameters which are then used to extrap olate good guesses for which families of sublattices to look at in more challenging situations 3 remove unused basis elements this has advantages for run time storage and quality of results since lattice basis reduction on smaller lattices typically performs dramatically better after all the approxi mation factor in lattice basis reduction is tighter in smaller dimensions 12 4 the focus group attack on small exponent rsa we now specialize the methodology of section 3 to small exponent rsa trials of the boneh durfee 284 attack 4 with small parameters suggest a particular sublattice to use which we shall describe below previous work has selected sublattices using other methods for example boneh durfee suggest in their 292 attack to remove certain hj m which contribute large factors to the covolume later work by blo mer and may 5 suggests removing some of the gi m as well see also 12 14 our approach is guided by which vectors are likely to contribute to a nontrivial solution but not directly by determinant considerations we in troduce two integer parameters and in addition to m and t and exclude from 2 7 all indices with i and 2 j this is motivated by the shape of the black and white circles in figure 3 that is the polynomials in 2 6 are taken for indices 4 1 0 m max 1 i m and 1 j min t 1 2 instead of 2 7 we choose x d 2 e e and y d 2 e 1 2 e as rough integral upper bounds for x 0 and y 0 respectively cf 2 5 experiments we ran timings using mathematica v 11 on a dell poweredge r 740 xd server with two intel xeon silver 4114 2 2 ghz processors and 256 gb ram we did not seriously attempt to optimize the lattice basis reduction computations relying instead on mathematica s latticereduce command which is an implementation of 17 timing results are presented in table 1 and include as a control experiment a comparison with an implementation of boneh durfee s 292 and 284 attacks using mathematica on the same machine with the same parameters m and t it would be interesting to perform a similar comparison with the algorithm of 5 whose sublattice is more similar to the one selected by the focus group attack the attack in 5 also satisfies the enabling condition for the same 1 1 2 292 range as boneh durfee s attack 4 we have not rigorously analyzed at what point our enabling condition breaks down as it may be moot anyhow algebraic independence might be lost before that point see the comments at the end of section 2 13 bits of n trials m t focus group boneh durfee 292 boneh durfee 284 time dim time dim time dim 1000 100 270 6 2 2 0 8 46 s 28 15 95 s 34 30 29 s 42 4000 100 273 6 2 2 0 60 37 s 28 103 49 s 34 182 92 s 42 6000 15 277 8 3 2 1 1905 81 s 54 2170 15 s 57 3920 45 s 72 10000 100 260 3 1 1 0 1 70 s 14 2 76 s 17 4 47 s 20 10000 100 265 4 1 1 0 12 94 s 14 17 90 s 17 24 76 s 20 10000 15 277 8 3 2 1 4565 47 s 54 5063 59 s 57 8492 21 s 72 table 1 timings of trials of the focus group attack on small exponent rsa times listed are averages over many trials of rsa keys in which each of the three attacks on the right is performed on the same key comparisons are given in the last two columns for the boneh durfee 292 and 284 attacks with the same values of m and t we list the average time in seconds as well as the dimension of the lattices involved which get progressively larger as one goes from the focus group attack to the boneh durfee 284 attack the focus group attack is significantly faster and uses less memory due to the smaller lattice size all computations were run on the same machine using the same lattice basis reduction algorithm times refer to the lattice basis reduction step only bits of n trials m t focus group boneh durfee 292 boneh durfee 284 success dim success dim success dim 1000 100 270 6 2 2 0 100 28 100 34 100 42 1000 100 273 6 2 2 0 43 28 64 34 64 42 1000 100 277 8 3 2 1 21 54 10 57 9 72 1000 100 279 10 4 2 3 62 92 26 85 26 110 1000 100 280 10 4 2 3 1 92 0 85 0 110 4000 100 273 6 2 2 0 58 28 100 34 100 42 6000 15 277 8 3 2 1 100 54 100 57 100 72 10000 100 260 3 1 1 0 100 14 100 17 100 20 10000 100 265 4 1 1 0 100 14 100 17 100 20 10000 15 277 8 3 2 1 100 54 100 57 100 72 table 2 success rates of the three algorithms in table 1 as measured by producing multiple polynomials which vanish on the secret key as a time saving proxy to allow for more experiments to be run again each trial involves the three attacks on the right applied to the same rsa key the focus group attack has a lower success rate than boneh durfee s attacks for some smaller values of but appears to outperform the boneh durfee attack for larger values of and lattice dimensions more data is shown in the plots in figure 4 14 figure 4 these plots amplify the data in table 2 and show how the focus group method compares to the boneh durfee 292 attack near their limits of failure for larger exponents it appears the focus group method outperforms the boneh durfee 292 attack for larger and lattice dimensions 15 extraction of the secret key after lattice basis reduction can be fairly slow but we always found it to be possible so long as more than one output polynomial vanishes on the secret key in order to generate more data on the success of the method and avoid this bottleneck we ran a number of experiments in which success was measured by finding more than one such polynomial in order to be more confident that no algebraic dependence issues arose we performed a more rigorous analysis on several sample lattice reduction outputs and found sufficient algebraic independence in all cases table 2 and figure 4 show the probability of success for the focus group method compared to the boneh durfee attacks these experiments were run on many machines in rutgers amarel high performance cluster for some parameter choices m t the focus group attack is more successful than the boneh durfee attacks e g in the first plot in figure 4 but not for all for example in the entry for 4000 bit moduli n with m t 6 2 2 0 and 273 the boneh durfee attack was successful on 100 out of 100 randomly chosen rsa keys whereas the focus group attack was successful only 58 of those same 100 rsa keys the second plot in figure 4 shows this holds true for the same choice of m t 6 2 2 0 and for exponents in a nearby range however it appears this phenomenon may be limited to smaller and matrix sizes when one instead considers the larger lattices with m t 8 3 2 1 the last plot in figure 4 the situation apparently reverses and the focus group method is more successful than boneh durfee s attack table 2 s entries for 1000 bit n and the first plot in figure 4 also suggest that the focus group may be more successful than boneh durfee s attack in runs that involve larger lattices and exponents we should caution however that we have not systematically analyzed this beyond the experiments presented here we are also unsure exactly what to attribute this apparent improvement to though we suspect it is that lattice basis reduction algorithms have superior performance on smaller lattices as an aside the timings demonstrate the power of the implementa tion of the l 2 lattice basis reduction algorithm 17 used in mathematica s latticereduce command which typically outperformed the bkz implemen tations in ntl and sagemath for example the exponents achieved here are higher than in previously reported experiments e g 4 5 22 with the size of d in the last entry in table 1 being 220 bits longer than achieved in 4 for a 10 000 bit rsa modulus n recall that table 1 makes a controlled com parison between different approaches to coppersmith s method on the same rsa keys by using the same hardware and same lattice basis reduction al 16 gorithms it is interesting to speculate whether certain features of 17 are particularly useful when applied to the lattices produced by coppersmith s method and if so how to leverage them further recall also the example in section 2 where bkz is more helpful with block size 3 than block size 5 5 the focus group attack applied to partial key recovery methods of 3 in this section we apply the focus group methodology to the coppersmith in the wild partial key recovery attack of 3 6 which as far as we are aware was the first coppersmith style attack successfully applied to real world keys in their situation n pq 21024 is an rsa modulus and p 2512 has the special form 5 1 p a 2 ts r where a and t are or at least suspected to be known but s and t are unknown the authors consider the polynomial f x y a 2 tx y and form the k 2 2 dimensional lattice spanned by the polynomials 5 2 xiyhf x y 0 i h k 1 xjyhn 0 j h k for an integer parameter k 0 lattice basis reduction is then used if successful to obtain two small algebraically independent polynomials from which the values of s and t are extracted we performed experiments with one particular set of parameters success fully studied in 3 6 2 namely k 4 t 428 a 2511 2510 x 2100 and y 228 experiments with small parameters revealed that solutions are often found within sublattices generated by the polynomials in 5 2 having h h 0 where h 0 is fixed see figure 5 7 following the focus group method ology we considered such a sublattice in this particular example with h 0 1 and verified that by taking these ten polynomials instead of the 25 in 5 2 we could just as easily recover the factorization of n using lattice basis re duction applied to the corresponding sublattice thus the same performance 7 after removing a common factor of yh 0 the generators of this sublattice are given by 5 2 but with k replaced by k h 0 this might explain the remark on 3 p 355 that some experiments for small k worked in situations where theoretically no useful output was expected 17 in this example is obtained from using this chosen ten dimensional sublattice of the ambient 25 dimensional lattice the use of hermite normal form in the focus group method hermite normal form has previously been applied to coppersmith s method e g 10 example 19 3 2 for example one can obtain the hermite normal form of matrix whose rows form a generating set of the lattice perhaps strictly larger than a basis and then apply lattice basis reduction to only some of the rows of the output thus instead of using the generating set directly produced by coppersmith s method we instead transform it to a different generating set using hermite normal form and apply the focus group methodology of selecting a sublattice at this secondary stage instead this approach via hermite normal form did not work well when applied to the previous example but did find success when applied to primes 5 1 of a different type than those studied in 3 namely here we arbitrarily chose a to be the smallest positive integer congruent to 31 000 mod 2512 and ran domly generated p of the form 5 1 with x y 225 and t 488 we took k 5 and studied the 36 21 matrix of coefficients of the generating set 5 2 with respect to the monomial basis xiyh 0 i h k and considered the lattice spanned by the top k 1 2 15 rows of its hermite normal form as generated by mathematica s hermitedecomposition command lattice ba sis reduction applied to this 15 dimensional lattice then yielded polynomials which easily recovered the factorization of n 6 conclusions we have considered the small exponent rsa problem and attacks on it using coppersmith s method which relies on finding short vectors in a lattice us ing theoretical and experimental observations we have proposed a principled technique to restrict lattice basis reduction to a carefully selected sublattice based on the behaviour of simpler examples this focus group attack specifically takes into account which parts of the lattice are likely to be used when applied to the small exponent rsa problem it points to a geometric structure of the lattice in boneh durfee s attack 4 that can be leveraged to reduce the running time and memory usage of the lattice basis reduction step while allowing the attack to be applied to more rsa keys several interesting questions remain for future investigations for ex ample mathematica s implementation of the l 2 17 lattice basis reduction 18 figure 5 a representation of which polynomials from 5 2 are actually used black circles in solving for s and t in small examples in this example k 5 and h in 5 2 is at least h 0 3 algorithm accounted for a several hundred bit improvement in some exper iments over previous work which instead used lll 15 an improvement which cannot be explained by hardware advances alone is it possible that special features of the lattices generated by coppersmith s method can be exploited by new specially designed lattice basis reduction algorithms after all figure 1 suggests these lattices strongly differ from random lattices which opens the door to such a prospect is it possible to specifically understand from initial principles or perhaps even by machine learning which parts of the lattice are not used and perhaps redesign coppersmith s method to include more useful vectors from the outset finally might the difficult issue of algebraic independence which is needed to establish rigorously provable results be easier to settle using these smaller sublattices references 1 aure lie bauer vers une ge ne ralisation rigoureuse des me thodes de coppersmith pour la recherche de petites racines de polyno mes ph d thesis 2008 2 aure lie bauer and antoine joux toward a rigorous variation of coppersmith s al gorithm on three variables in advances in cryptology eurocrypt 2007 pp 361 378 lecture notes in comput sci 4515 springer berlin 2007 19 3 daniel j bernstein yun an chang chen mou cheng li ping chou nadia heninger tanja lange and nicko van someren factoring rsa keys from certi fied smart cards coppersmith in the wild in advances in cryptology asiacrypt 2013 pp 341 360 lecture notes in comput sci 8270 springer berlin 2013 4 dan boneh and glenn durfee cryptanalysis of rsa with private key less than n 0 292 ieee transactions on information theory 46 pp 1339 1349 july 2000 5 johannes blo mer and alexander may low secret exponent rsa revisited in cryp tography and lattice conference calc 2001 lecture notes in computer science 2146 pp 4 19 springer verlag 2001 6 henry cohn and nadia heninger approximate common divisors via lattices ants x 2012 the open book series 1 no 1 pp 271 293 2013 7 don coppersmith finding a small root of a bivariate integer equation factoring with high bits known in advances in cryptology eurocrypt 96 lecture notes in computer science 1070 pp 178 189 springer verlag 1996 8 andrej dujella a variant of wiener s attack on rsa computing 85 2009 77 83 9 the fplll development team fplll a lattice reduction library available at https github com fplll fplll 10 steven galbraith mathematics of public key cryptography http www math auckland ac nz sgal 018 crypto book crypto book html 11 nick howgrave graham finding small roots of univariate modular equations re visited in proceedings of the 6 th ima international conference on cryptography and coding pp 131 142 springer verlag 1997 12 mathias herrmann and alexander may maximizing small root bounds by linearization and applications to small secret exponent rsa in proc of pkc 2010 springer lecture notes in computer science 6056 pp 53 69 2010 13 ellen jochemsz and alexander may a strategy for finding roots of multivariate poly nomials with new applications in attacking rsa variants in advances in cryptology asiacrypt 2006 lecture notes in computer science 4284 springer berlin heidelberg pp 267 282 14 noburo kunihiro naoyuki shinohara and tetsya izu a unified framework for small secret exponent attack on rsa in proc of sac 2011 springer lecture notes in com puter science 7118 pp 260 277 2011 15 arjen k lenstra jr hendrik w lenstra and laszlo lovasz factoring polynomials with rational coefficients mathematische annalen 261 pp 513 534 1982 16 alexander may new rsa vulnerabilities using lattice reduction meth ods ph d thesis 2003 https www math uni frankfurt de dmst teaching ws 2014 vorlesung alex may pdf 17 phong q nguyen and damien stehle an lll algorithm with quadratic complexity siam j comput 39 pp 874 903 2009 20 https github com fplll fplll http www math auckland ac nz sgal 018 crypto book crypto book html http www math auckland ac nz sgal 018 crypto book crypto book html https www math uni frankfurt de dmst teaching ws 2014 vorlesung alex may pdf https www math uni frankfurt de dmst teaching ws 2014 vorlesung alex may pdf 18 ronald rivest adi shamir and leonard adleman a method for obtaining digital signatures and public key cryptosystems communications of the acm 21 pp 120 126 1978 19 adi shamir a polynomial time algorithm for breaking the basic merkle hellman cryp tosystem in 23 rd annual symposium on foundations of computer science chicago ill 1982 pp 145 152 ieee new york 1982 20 victor shoup ntl a library for doing number theory http www shoup net ntl 21 m wiener cryptanalysis of short rsa secret exponents ieee transactions on in formation theory 36 pp 553 558 1990 22 david wong https github com mimoo rsa and lll attacks 21 http www shoup net ntl http www shoup net ntl https github com mimoo rsa and lll attacks 1 introduction 2 an overview of coppersmith s method and boneh durfee s attack on rsa 3 focus group attacks 4 the focus group attack on small exponent rsa 5 the focus group attack applied to partial key recovery methods of wild 6 conclusions