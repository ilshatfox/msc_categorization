generalized solitary waves in a finite difference korteweg de vries equation n joshi 1 and c j lustri 2 1 school of mathematics and statistics f 07 the university of sydney new south wales 2006 australia 2 department of mathematics and statistics 12 wally s walk macquarie university new south wales 2109 australia abstract generalized solitary waves with exponentially small non decaying far field oscillations have been studied in a range of singularly perturbed differential equations including higher order korteweg de vries kdv equations many of these studies used exponential asymptotics to compute the behaviour of the oscillations revealing that they appear in the solution as special curves known as stokes lines are crossed recent studies have identified similar behaviour in solutions to difference equations motivated by these studies the seventh order kdv and a hierarchy of higher order kdv equations are investigated identifying conditions which produce generalized solitary wave solutions these results form a foundation for the study of infinite order differential equations which are used as a model for studying lattice equations finally a lattice kdv equation is generated using finite difference discretization in which a lattice generalized solitary wave solution is found 1 introduction following widespread interest in in the existence of generalized solitary waves gsw in korteweg de vries kdv type continuous models we show for the first time that gsw appear in a discrete kdv equation arising from finite difference discretization this is related to an infinite order partial differential equation and so we investigate related phenomena in fifth and seventh order kdv equations to lay the groundwork for our study following this line of reasoning we then consider a finite difference discretization of the unperturbed kdv equation producing a lattice equation that is given in 34 while this system does not immediately appear to have an obvious singular perturbation singularly perturbed terms are in fact introduced into the system by the discretization process itself adapting the discrete exponential asymptotic methods used in 25 26 27 we provide the first example of gsw in a lattice 1 1 background generalized solitary waves are nonlinear travelling waves with a central core that demonstrates classical solitary wave behaviour as well as non decaying oscillations that continue away from the core indefinitely in one or both directions and have amplitude that is exponentially small in some asymptotic parameter electronic address nalini joshi sydney edu au electronic address christopher lustri mq edu au corresponding author 1 ar x iv 1 80 8 09 65 4 v 2 m at h ph 2 1 d ec 2 01 8 a b c d figure 1 schematic of solitary and generalized solitary waves figure a depicts a spatially localized solitary wave figures b and c depict a two and one sided generalized solitary wave respectively figure d depicts a solitary wave with exponentially small oscillations that decay away from the wave core this is distinct from classical solitary waves such as those exhibited by the korteweg de vries equation kdv discussed below which are localized in a frame that moves with the wave core examples of solitary waves and gsw are displayed in figure 1 these gsw also known in the literature as nanoptera have been studied in a physical contexts particularly arising in fluid dynamics including solitary water waves with surface tension this problem has been studied analytically in 16 17 37 40 typically using a fifth order kortweg de vries model nu merical studies illustrating gsw in gravity capillary wave systems include 10 13 42 and the existence of these waves was rigorously proven by 3 23 38 gsw have also more recently been studied in discrete problems including both difference and differential difference equations systems that have been shown to demonstrate this behaviour include discrete nonlinear schro dinger lattices 1 31 30 36 fermi pasta ulan tsingou systems 15 21 and toda chains 29 41 the discrete klein gordon equation 2 the frenkel kontorova dislocation model 27 and nonlinear chains of oscillators 24 given that there are many difference equations which produce gsw it seems natural to expect that there are also lattice equations which produce gsw solutions typically gsw occur in singular perturbations of systems that already contain solitary wave solu tions for example generalized solitary water waves with surface tension are governed by a fifth order perturbation to the classical kdv equation in their studies of this equation pomeau et al 37 and grimshaw joshi 16 used borel summation of the divergent asymptotic series to determine the be haviour of amplitude of the oscillations present on either side of the wave core it is reasonable to ask if all singular perturbations of the kdv equation produce gsw and if not what conditions are required to produce this phenomenon this question was addressed by pomeau et al 37 who noted that while the fifth order kdv does produce gsw this is not necessarily true of the corresponding seventh order kdv the seventh order kdv equation 7 kdv discussed in 37 is given by e u 4 7 u x 7 2 5 u x 5 3 u x 3 6 u u x u t 0 1 this is not a water wave equation and therefore does not have the same physical relevance as the fifth order kdv equation instead this was viewed as a testing ground for understanding the general behaviour of singular perturbations to the undisturbed kdv equation given by e 0 u 3 u x 3 6 u u x u t 0 2 pomeau et al 37 applied borel summation methods to show that 7 kdv only possesses gsw solutions for 1 4 if is greater than critical value any oscillations are damped in the far field leading to a 2 localized classical solitary wave solution in later work grimshaw et al 18 showed that similar results do hold for the corresponding fifth order kdv equation 2 5 u x 5 3 u x 3 6 u u x u t 0 3 finding that the critical value of is zero in subsequent work grimshaw joshi 17 showed that the results of pomeau et al for the fifth order kdv equation could be explained by studying this equation using exponential asymptotic techniques this was further confirmed in later studies 16 40 they determined that the gsw could be understood be consider the behaviour of special curves in the solution domain known as stokes lines across which exponentially small behaviour in the solution appears in this paper we will show that the results of 37 for 7 kdv can also be explained by using direct exponential asymptotic methods using exponential asymptotics we will determine the location of stokes lines in the solution and we will directly compute the exponentially small oscillations that are switched as these stokes lines are crossed from these computations we will see that these oscillations decay away from the core of the wave when 1 4 producing localized solitary waves as identified by 37 while similar in some respects to the analysis of 37 this method explicitly demonstrates the important role played by stokes phenomenon in the asymptotic solution furthermore using this stokes line analysis technique we will extend this result and determine corresponding critical values for a full kdv hierarchy and subsequently apply an adapted form this this methodology to study gsw in a lattice kdv equation for more detailed descriptions of the foundations of exponential asymptotics see 5 6 7 for more details on the exponential asymptotic techniques used in this paper see 11 35 2 seventh order kdv in this section we study the exponentially small oscillations present in travelling wave solutions to the seventh order kdv equation 1 using exponential asymptotics we will show that these oscillations are switched on across special curves known as stokes lines and recover the condition that gsw solutions appear for 1 4 37 2 1 formulation and series expansion consider 7 kdv given by e u 0 in 1 we expand u x t as a power series in 2 u x t j 0 2 j uj x t 4 applying this expansion to 7 kdv and matching at o 1 as 0 gives e 0 u 0 0 showing that u 0 satisfies the kdv equation 2 we select u 0 x t to be the one soliton solution to the kdv equation given by u 0 x t 1 2 c sech 2 1 2 c x ct 5 where c is an arbitrary choice of the soliton speed we will also include the condition that the full asymptotic solution must be symmetric about the wave core located at x ct at this point we note that previous analyses of the kdv equation as well as higher order kdv equations frequently introduce a moving reference frame say x ct in order to express the system as an ordinary differential equation as well as impose the symmetry condition about 0 this approach would work for the present analysis however we would like to allow for the possibility of leading order kdv solutions that are more complicated than a single travelling wave such as interacting solitons or solutions with arbitrary initial conditions while we do not consider such systems in the present study they present interesting mathematical challenges that could be considered in further work we discuss this possibility in more detail in section 4 3 analytically continuing the solution in the x plane shows that u 0 x t has singularities at xs ct i m c where m 2 z 1 in the neighbourhood of these singularities the leading order behaviour is given by u 0 x t 2 x xs 2 as x xs 6 the singularities that will dominate the solution behaviour for real physical values of x are those closest to the real x axis associated with m 1 in subsequent analysis we will denote the location of these singularities as x and x to find subsequent terms in the series we must match apply the series 4 to 7 kdv and match at higher orders of matching at o 2 k for k 2 gives the general recurrence equation 7 uk 2 x 7 5 uk 1 x 5 3 uk x 3 6 k r 0 ur uk r x uk t 0 k 2 7 repeatedly applying this recursion relation produces terms in the series 4 however this will not capture the far field oscillations as they are exponentially small in the limit 0 and hence beyond the reach of the algebraic series expression however this recurrence relation permits us to obtain the form of uj in the limit that j known as the late order series behaviour 2 2 late order asymptotic terms following 14 35 we observe that this is a singularly perturbed problem with singularities in the ana lytically continued leading order behaviour this series will therefore diverge in a predictable factorial over power fashion as the late order behaviour is dominated by the results of repeatedly differentiating the singular term 14 we therefore follow 11 and propose an ansatz for the late order terms of the form uj f x t 2 j x t 2 j as j 8 substituting this expression into the recurrence relation 7 and taking the leading order as k gives f 7 x 5 x 3 x 2 k 3 2 k 3 fx 7 6 x 5 4 x 3 2 x 2 k 2 2 k 2 3 f xx 6 5 x 4 3 x 2 x 2 k 2 2 k 2 0 9 where the terms omitted are o uk 1 2 in the limit as k matching at o uk 3 2 as j gives 7 x 5 x 3 x 0 noting that x cannot be zero we simplify this to give the singulant equation 4 x 2 x 1 0 10 this has four solutions x i 1 2 1 4 1 11 where the signs are chosen independently if 1 4 the solutions to this equation are complex with nonzero real and imaginary parts we denote the solution with positive real and imaginary part as x the four solutions are given by x and where the bar corresponds to complex conjugation if 1 4 the solutions are imaginary conjugate pairs we denote the solution with smallest positive imaginary part as x i with r we first consider the case 1 4 recalling that the singulant must be zero at the location of the leading order singularities denoted xs we solve 10 to give 1 x xs 2 x xs 3 x xs 4 x xs 12 4 the two singularities located at xs x and xs x therefore each have four associated late order contributions corresponding to the four singulants if we perform a full analysis on all eight contributions we find that only four produce stokes switching that affects real values of x we recall that stokes switching only occurs in asymptotic contributions that are exponentially small in subsequent analysis we will find that the late order contributions have a form given by 20 from this form we see that the remainder contribution is only exponentially small for real x if re 0 on the real axis and therefore stokes switching may only affect these terms consequently we restrict our attention to the four terms that satisfy this condition associated with 1 x x 2 x x 3 x x 4 x x 13 the remaining analysis will be performed in detail for the contribution associated with 1 with cor responding results stated for the remaining singulants to determine the prefactor associated with 1 we return to 9 and match at o uk 1 noting that xx 0 we find that fx 0 consequently f is independent of x we require that the singularity strength of the ansatz 8 in the limit that x approaches the singularity must be consistent with the local leading order singular strength in 6 the inner limit of this outer behaviour is given by uj x t f t 2 j x x 2 j as x x and j 14 from the recurrence relation 7 it is apparent that strength of the singularity at x x increases by two at each order and we therefore require 2 in order for the singularity strength of this term to be consistent with the leading order singularity behaviour given in 6 to determine the value of f we now match the behaviour of the late order terms with a local expansion in the neighbourhood of the singularity at xs this inner analysis is performed in appendix a and shows that the prefactors for each of the contributions are constant the constant associated with 1 is denoted by f x t in appendix a we perform an example calculation with 1 that shows 0 711 0 694 i we subsequently find that the corresponding constants associated with 2 and 3 are equal to while the constant associated with 4 is also equal to the late order terms responsible for stokes switching in the solution are hence given by uj 2 j 2 x x 2 j 2 2 j 2 x x 2 j 2 2 j 2 x x 2 j 2 2 j 2 x x 2 j 2 15 as j where x ct i c a similar analysis may be applied to the case 1 4 in this case we need only consider the singulants with smallest absolute value on the real axis which will dominate the late order behaviour we therefore have only two relevant contributions x i the form of the late order terms is given by uj 2 j 2 i x x 2 j 2 2 j 2 i x x 2 j 2 16 the inner analysis for this problem required to determine the constant value of is significantly simpler than the 1 4 case as each singularity corresponds to only one late order contribution in 16 the differences in the inner analysis are discussed in appendix a in which we also show that is always real for this case we demonstrate an example inner analysis for 1 8 finding that 11 70 2 3 exponential asymptotics in this section we perform straightforward application of the matched asymptotic expansion technique described in 35 in order to determine the amplitude of the exponentially small oscillations present in the solution we therefore omit several technical computations and direct the reader to this reference for further details 5 to perform an exponential asymptotic analysis on the late order terms from 15 and 16 we must truncate the asymptotic series optimally ensuring that the remainder is exponentially small 6 7 8 to find the optimal truncation point which we denote as n we follow the commonly used heuristic described by 8 in which the series is truncated at its smallest term the resultant expression gives n 2 we therefore set n 2 where 0 1 is selected so that n z we note that n in the limit that 0 justifying the assumption that n is large in the asymptotic limit we truncate the series 36 at the optimal truncation point to give u x t n 1 j 0 2 j uj r x t 17 where r is the truncation remainder we apply this expression to 1 and use 7 to eliminate series terms leaving 4 7 r x 7 2 5 r x 5 3 r x 3 6 r n 1 j 0 2 j uj x 6 r x n 1 j 0 2 j uj r t 2 n 2 7 un 1 x 7 2 n 7 un 2 x 7 2 n 5 un 1 x 5 18 keeping only the largest terms in the limit that 0 and n and applying 7 to simplify the right hand side of the expression we obtain 4 7 r x 7 2 5 r x 5 3 r x 3 2 n 3 un x 3 19 where the omitted terms do not contribute to the dominant behaviour as 0 the right hand side only contributes to the remainder behaviour in the neighbourhood of the stokes line we can therefore determine the behaviour away from the stokes line by solving the homogeneous problem for r using a wkb or liouville green ansatz u f x t e g x t we see that this is satisfied by g consequently we select the form of the remainder in the limit that 0 as r se 20 where s x t is the stokes multiplier that captures the variation in the neighbourhood of the stokes line applying this expression to 19 and applying the late order ansatz 15 gives sxe 2 n 2 x 3 2 n 5 2 n 5 as 0 21 where 7 6 x 5 4 x 3 2 x recalling that the limit 0 corresponds to n we now set the optimal truncation point n 2 and express the singulant using polar terms so that ei we note that the right hand side is exponentially small except on 0 which is the stokes line location this corresponds to re 0 and im 0 or the straight line extending downwards form the singularity along re x ct we define a set of inner coordinates to consider 21 in a neighbourhood of width o near the stokes line this process can be seen in more detail in 35 solving the inner equation and converting back to outer coordinates gives s i 2 x 2 2 e s 2 2 ds s 0 22 where s 0 is a constant of integration consequently the jump in s as the stokes line is crossed from left to right is given by s 2 i 2 x 2 23 at this point the exponential asymptotic analysis is valid for general and may therefore be applied to both 15 and 16 in order to analyse the jump across the stokes line it is useful to consider 1 4 and 1 4 seperately we denote these as case a and case b solutions respectively 6 re x im x stokes line x ct i c x ct i c r r r r figure 2 stokes line in u x t across which the exponentially small contributions to the solution switch for both cases of the 7 kdv equation 1 and the lkdv equation 34 the singularities are denoted by circles and the stokes line is depicted as a thick line on the left of the stokes line the exponential contribution r is given by r and on the right of the stokes line the contribution is given by r 2 3 1 case a using the remainder ansatz 20 and the value of 1 the jump in the stokes multiplier 23 corresponds to a jump in the remainder of r 1 2 i 2 2 e x ct i c 24 where we have denoted this as r 1 to indicate that it is the contribution associated with 1 we require that the oscillations are exponentially small in the far field however this contribution becomes exponen tially large for x ct 3 c this necessitates that the exponential contribution be inactive in this region consequently this contribution is inactive on the left hand side of the stokes line and switched on as the stokes line at x ct is crossed from left to right therefore the remainder r 1 switches from r 1 to r 1 as the stokes line is crossed from left to right where r 1 0 r 1 2 i 2 2 e x ct i c 25 this stokes structure is illustrated in figure 2 the remaining contributions can be calculated using nearly identical analyses the contribution r 3 gives a complex conjugate expression to 25 the contributions r 2 and r 4 are complex conjugate quantities that are exponentially large in the region x ct 3 c these quantities are therefore present to the left of the stokes line and switched off as the stokes line is crossed from left to right r 2 and r 4 are in fact a reflection of r 1 and r 3 respectively about the point x ct consequently the system is symmetric about this point the full remainder r is given by r 4 2 e r x ct i c re 2 e i i x ct r c 26 for x ct and r 4 2 e r ct x i c re 2 e i i ct x r c 27 for x ct where r i i and o 1 2 denotes the inner region that contains the smooth transition between the two remainder expressions the remainder expressions in 26 and 27 contain rapid exponentially small oscillations the amplitude of these oscillations decays as x ct this solution to 1 therefore does not produce gsw in contrast to the singularly perturbed fifth order kdv equation instead the solitary wave in 7 kdv is exponentially localized in space the decaying oscillations are shown in figure 3 7 1 8 1 8 1 1 log 10 r ct stokes line x 10 20 30 40 ct 4 ct 2 ct 2 ct 4 r r r r figure 3 logarithmic plot of r for 0 1 and c 1 with 1 and 1 8 on the left hand side of the stokes line the remainder is given by r 27 and on the right of the stokes line the remainder is given by r 26 for 1 the the remainder is given in 30 and has constant non decaying amplitude 2 3 2 case b in this case we instead find that the jump in the exponential behaviour is given by r 1 2 i 2 2 e i x ct i c 28 the remainder term clearly does not grow exponentially on either side of the stokes line and therefore we are free to select s 0 in 22 arbitrarily in order for the solution to be symmetric about the point x ct we must select s 0 so that s 0 on the stokes line the remainder term switches rapidly from s to s as the stokes line is crossed where s 2 2 s 2 2 29 we perform a similar analysis on the late order terms associated with 2 and find the resultant contri bution is the complex conjugate of r 1 from the switching information given in 29 and knowing that r se we find that the combined exponentially small remainder term r switches from r to r as the stokes line at re x ct is crossed from left to right where these quantities are given by r 2 2 2 e c sin x ct r 2 2 2 e c sin x ct 30 these oscillations are symmetric about x ct as required consequently figure 2 also shows the stokes structure for the 1 4 case where the remainder terms are non decaying oscillatory functions given in 30 we see that as first noted in 37 7 kdv only produces gsw if 1 4 and instead has exponentially localized solutions if 1 4 the behaviour of r for 1 8 is illustrated in figure 3 it is clear that these contributions do not decay in the far field unlike the example shown for 1 finally we note that in case a 1 4 the sum of the four exponentially small components satisfied the symmetry condition about x ct that was imposed on the solution as each contribution could only be active on one side of the stokes line the exponentially small contribution is therefore unique and symmetric in case b 1 4 the exponentially small oscillations could be active on both sides of the stokes line and we instead enforced the symmetry requirement by selecting the value s 0 appropriately this allows for the possibility that we could make a different choice such as selecting s 0 to restrict the oscillations to lie on only one side of the central wave core see for example 29 or in some other asymmetric configuration 8 5 0 8 0 2 0 4 3 2 1 0 4 0 6 lo g 1 0 a m p li tu d e log 10 asymptotic numerical figure 4 comparison between far field oscillation amplitude predicted by exponential asymptotics 30 shown as a solid line and the amplitude calculated using a numerical split step method shown as circles the results were calculated for 1 8 and c 1 as expected the asymptotic analysis becomes more accurate as 0 2 4 comparison of results in figure 4 we compare the asymptotic prediction of the far field amplitude of the gsw with velocity c 1 in a system with 1 8 with the corresponding numerically calculated far field amplitude the numerical amplitudes were obtained by adapting the split step method for solving the kdv equation introduced in 39 this commonly used method involves splitting the time stepping procedure into a linear part and a nonlinear part the linear step is calculated using the fast fourier transform in the frequency domain while the nonlinear step is computed directly in the time domain for more details on split step methods see for example 39 we computed the solution of the 7 kdv equation on a large periodic domain using u 0 x 0 from 5 as the initial condition as the system evolved in time exponentially small oscillations spread from the right hand side of the wave core the total time was taken to be sufficiently large for the oscillation amplitude to reach a steady value for the values considered in figure 4 the system was computed over 0 t 3 and 50 x 50 a similar numerical approach was used to calculate the amplitude of gsw oscillations in the fifth order kdv equation in 4 importantly using this method produced solutions in which the oscillations appear one one side of the central wave core producing a one sided gsw solution similar to the illustration in figure 1 c from the jump condition 29 we know that the amplitude of the symmetric gsw solution is obtained by halving the far field amplitude of the one sided gsw solution a comparison between the results of this computation and the asymptotic prediction from 30 is depicted in figure 4 it is apparent from this figure that the asymptotic analysis becomes more accurate as 0 providing numerical support for the asymptotic approximation 2 5 higher order kdv equations the decay of the exponentially small oscillations in 7 kdv for 1 4 could have been predicted directly from the form of the singulant 10 knowing that the form of the exponentially small remainder is generally 20 it is clear that non decaying oscillations correspond to imaginary values of x any real component of x will cause the remainder to grow or decay exponentially in space violating the definition of a gsw for example we consider a general class of singularly perturbed kdv equations of order n 2 k 3 9 10 20 30 40 0 5 0 25 7 kdv 50 1 0 2 7 kdv k even k even 0 25 7 kdv exponentially localized solitary waves generalized solitary waves figure 5 values of crit for a range of even k values denoted by circles if crit solitary wave solutions to 31 are exponentially localized in space if crit the solutions are generalized solitary waves with non decaying oscillations in the far field choices of k with even k in the white region correspond to spatially localized solutions and choices of k with even k in the shaded region correspond to generalized solitary wave solutions the 7 kdv corresponds to k crit 2 1 4 whose value is indicated on each axis for k 1 this class contains 1 and is given by 2 k 2 k 3 u x 2 k 3 k 1 r 0 2 r 2 r 3 u x 2 r 3 6 u u x u t 0 31 with r and 6 0 if we expand this as a power series using 4 the behaviour of u 0 is always governed by the kdv equation and therefore permits solutions of the form 5 obtaining the late order terms using an ansatz as in section 2 2 we find that the singulant satisfies 2 k x k 1 r 0 2 r x 0 6 0 32 the roots of this equation determine which solitary wave solutions contain exponentially small non decaying oscillations we identify the presence of gsw by finding imaginary solutions for x for particular combinations of and k if k is odd 32 has imaginary solutions for x if 0 but no imaginary solutions if 0 therefore travelling wave solutions for 0 are gsw while for 0 all oscillations decay in the far field meaning that the solitary wave is exponentially localized in space this is consistent with the critical value of 0 obtained in 18 for the fifth order kdv equation which corresponds to k 1 if k is even there exists some positive crit such that if crit there are no imaginary solutions to 32 while if crit there are imaginary solutions for x consequently the travelling wave solution to 31 has non decaying far field oscillations if crit numerical investigation suggests that crit increases as k increases and that crit 12 as k values of crit are shown for a range of even k in figure 5 in order to visualise the distribution of solutions for x as k varies we consider the case of 31 for 1 the corresponding singulant equation is given by k r 0 2 r x 0 33 noting that x 6 0 it is clear from direct factorization that when k is odd this polynomial has solutions given by x i while figure 5 shows that this polynomial has no imaginary solutions when k is even 10 a k 1 b k 2 c k 3 d k 4 e k 7 f k 10 re x im x i i re x im x 1 2 i 3 2 1 2 i 3 2 1 2 i 3 2 1 2 i 3 2 re x im x 2 2 i 2 2 2 2 i 2 2 2 2 i 2 2 2 2 i 2 2 i i re x im x i i re x im x re x im x figure 6 solutions to 33 for a range of k values filled circles denote solutions with nonzero real part and empty circles denote imaginary solutions the diagrams in a and b correspond to the singularly perturbed fifth and seventh order kdv equations respectively when k is odd there are solutions x i but there are no imaginary solutions if k is even generalized solitary waves can only appear in systems with imaginary solutions which correspond to odd values of k some examples of the solutions to this polynomial are seen in figure 6 in each case solutions for x that do not lie on the imaginary axis correspond to oscillations that grow or decay as x ct while the labelled solutions on the imaginary axis correspond to non decaying oscillations in the far field therefore we conclude that only when k is odd can the higher order kdv equation given in 31 for 1 produce gsw the corresponding solutions when k is even must decay exponentially in the far field as x ct we do note from the pattern of solutions in figure 6 that for sufficiently large even k the nearest x that are nearest to the imaginary axis can be found arbitrarily close to x i as the real part of these solutions is very small the spatial decay will be comparatively slow however the associated exponential behaviour will always decay away from x ct 3 finite difference kdv 3 1 formulation and series expansion the previous analysis suggests that the exponential asymptotic analysis holds in a straightforward fash ion even as the order of the partial differential equation is taken to be arbitrarily large in this case the analysis is that of an infinite order system which is typically associated with a difference or delay equation such as those considered in 25 26 27 we therefore consider the behaviour of a lattice kdv equation generated by applying a finite difference scheme to the kdv equation consider a finite difference approximation of the kdv equation with spatial grid distance given by h and time step by where h and are positive using central difference approximations for partial 11 derivatives in time and space we obtain a lattice version of the kdv equation lkdv u x 2 h t 2 u x h t 2 u x h t u x 2 h t 2 h 3 6 u x t u x h t u x h t 2 h u x t u x t 2 0 34 a similar analysis could be applied to other typical finite difference approximations such as using forward difference approximations for the time derivatives the resultant analysis proceeds in a nearly identical fashion we set h and take the limit that h 0 applying a taylor approximation around h 0 gives 1 h 3 r 0 2 h 2 r 1 2 r 1 2 r 1 u x t x 2 r 1 2 h 3 r 0 h 2 r 1 2 r 1 2 r 1 u x t x 2 r 1 6 u x t h r 0 h 2 r 1 2 r 1 2 r 1 u x t x 2 r 1 1 h r 0 h 2 r 1 2 r 1 2 r 1 u x t t 2 r 1 0 35 we expand u x t as a power series in h 2 giving u x t j 0 h 2 j uj x t 36 applying this to 35 gives r 0 22 r 1 h 2 r 2 2 r 1 j 0 h 2 j 2 r 1 uj x 2 r 1 2 r 0 h 2 r 2 2 r 1 j 0 h 2 j 2 r 1 uj x 2 r 1 6 j 0 h 2 j uj r 0 h 2 r 2 r 1 j 0 h 2 j 2 r 1 uj x 2 r 1 2 r 0 2 rh 2 r 2 r 1 j 0 h 2 j 2 r 1 uj t 2 r 1 0 37 we see that although we discretized an unperturbed kdv equation the discretization process has introduced higher order derivatives which disappear for h 0 consequently the singular perturbation was created by the discretization process matching this expression at o 1 as h 0 shows that u 0 is governed by the unperturbed kdv equation 2 we therefore select as our leading order solution the soliton solution of kdv given in 5 we again denote the relevant singularities in the analytic continuation of u 0 x t as x and x located at x ct i c to find subsequent terms in the series we must match 37 at higher orders of h matching at o h 2 k gives the equation k r 0 22 r 1 2 r 1 2 r 1 uk r 1 x 2 r 1 2 k r 0 1 2 r 1 2 r 1 uk r 1 x 2 r 1 0 6 k j 0 k j r 0 uj 2 r 1 2 r 1 uk r j x 2 r 1 2 k r 0 2 r 2 r 1 2 r 1 uk r t 2 r 1 0 38 3 2 late order asymptotic terms as before this is a singularly perturbed problem with singularities in the analytically continued leading order behaviour and that the series 36 will therefore diverge we therefore again propose an ansatz for the late order series terms of the form 8 substituting this ansatz into the recurrence relation 38 gives k r 0 22 r 1 2 r 1 f 2 r 1 x 2 k 3 2 k 3 k r 0 22 r 1 2 r fx 2 r x 2 k 2 2 k 2 k r 0 22 r 1 2 r f 2 r 1 x xx 2 k 2 2 k 2 0 39 12 where the terms omitted are o uk 1 2 in the limit as k matching at o uk 3 2 as k gives k r 0 22 r 1 2 r 1 x 2 r 1 0 40 recalling that the ansatz 8 applies to late order terms for which k is large we follow 25 26 27 and take the limit of the summation term as k this introduces only exponentially small error into the behaviour of which has no significant impact on the oscillatory tails in the solution the resultant singulant equation is given by 1 cosh x sinh x 0 41 or x i n where n z recalling that the singulant must be zero at the location of the leading order singularities denoted xs we solve 41 to give i n x xs n z 42 the dominant contributions to the late order behaviour those associated with nonzero solutions of which have the smallest absolute value on the real axis corresponding to n 1 this gives four possible late order term contributions however a full analysis shows that only two of these will produce exponentially small contributions in the solution associated with i x x i x x 43 returning to 39 and matching at o uk 1 noting that xx 0 we find k r 0 22 r 1 fx 2 r 0 44 again we may take k while introducing only exponentially small error into the final contribution we find that this gives 2 fx 0 consequently f is independent of x as in the analysis of 7 kdv in section 2 2 we find that the ansatz can only be consistent with the leading order solution near the singularity 6 if 2 so that the inner limit of the late order ansatz is given by uj x t f t 2 j 2 i x x 2 j 2 as x x and j 45 a similar analysis applies to the late order terms corresponding to the singularity at x x we determine f by matching the behaviour of the late order terms with a local expansion in the neighbourhood of the singularity at xs in the same fashion as the 7 kdv analysis this inner analysis is performed in appendix b and shows that the prefactors associated with both of are constant both given by f x t 2 68 103 the late order terms responsible for stokes switching in the solution are therefore given by uj 2 j 2 i x x 2 j 2 2 j 2 i x x 2 j 2 as j 46 where x i c ct 3 3 exponential asymptotics the exponential asymptotic analysis for the lattice kdv equation is almost identical to the analysis of 7 kdv however we demonstrate the analysis in order to illustrate the changes that occur due to the taylor series terms in 35 the first step of the exponential asymptotic analysis is again to optimally truncate the divergent series we apply the heuristic from 8 and determine that n 2 h as h 0 we therefore set 13 n 2 h where 0 1 is chosen so that n z we truncate the series 36 at this point to give u x t n 1 j 0 h 2 j uj r x t 47 where r is the truncation error we apply this expression to 37 and apply 38 to eliminate series terms the largest remaining terms can be rearranged to give 4 r 0 2 h 2 r 2 2 r 1 2 r 1 r x 2 r 1 2 r 0 h 2 r 2 2 r 1 2 r 1 r x 2 r 1 6 r u 0 x r 0 h 2 r 2 r 1 2 r 1 r x 2 r 1 2 r 0 2 r 2 r 1 2 r 1 r t 2 r 1 h 2 n 3 xun 48 where again the omitted remainder terms are negligible in the limit h 0 the right hand side again only contributes to the remainder behaviour in the neighbourhood of the stokes line we can therefore determine the behaviour away from the stokes line by solving the homogeneous problem for r using a wkb or liouville green ansatz we again find the appropriate form for the remainder is given in the limit that h 0 as r se h applying this expression to 48 gives after some simplification 2 h 2 r 0 22 r 1 2 rx 2 r sxe h h 2 n 3 xun as h 0 49 evaluating the summation terms for x i and applying the late order ansatz 8 gives 4 h 2 sxe h h 2 n 3 x 2 n 5 2 n 5 50 where the omitted terms are smaller than those retained in the limit that h 0 and n the remaining analysis is practically identical to case b of the 7 kdv analysis in section 2 3 2 we apply the late order ansatz 8 to 50 and and set the optimal truncation point to be n 2 h we transform into polar coordinates so that ei and then consider the behaviour near 0 which corresponds to the stokes line we again find that s is exponentially small except on the curve 0 hence this curve describes the stokes line across which s varies rapidly which has the same location as the stokes curve in the fifth and seventh order kdv problems the stoke line behaviour is therefore identical to that shown in figure 2 where r and r are given below in 53 we introduce inner coordinates h 1 2 and solve the resultant expression converting back into outer coordinates gives s i 2 x 2 h 2 h e s 2 2 ds s 0 51 where s 0 is a constant of integration consequently we see that the jump in s as the stokes line is crossed from left to right is given by s 2 i 2 x h 2 52 the amplitude of the remainder is constant and exponentially small and therefore does not decay or grow in the far field as in case b of the 7 kdv analysis we are free to choose s 0 in 51 choosing this value so that s 0 on the stokes line produces symmetric oscillatory behaviour about x ct gives r 2 3 h 2 e 2 h c sin h x ct r 2 3 h 2 e 2 h c sin h x ct 53 where r r for x ct and r r for x ct these oscillations are symmetric about x ct as required consequently figure 2 also shows the stokes structure for the lattice kdv problem where the remainder terms are non decaying oscillatory functions given in 53 14 25 50 0 2 0 1 5 1 0 5 log 10 h lo g 1 0 a m p li tu d e log 1 0 a m p litu d e c 1 c 50 figure 7 amplitude of far field oscillations calculated using 53 plotted logarithmically from right to left the curves correspond to c 1 2 5 10 20 50 the oscillations are exponentially small but they do not decay in space or time the amplitude of the far field oscillations varies depending on the choice of c and h shown in figure 7 the oscillations are clearly exponentially small in h however they do not decay in the far field we again note that s 0 could be chosen to enforce other conditions such as requiring the system to be free of far field oscillations either behind or ahead of the the point x ct 3 4 lattice equations with parameters it is straightforward to extend this methodology to higher order variants of the kdv equation in fact the method is almost identical as the resultant expression after applying a finite difference discretization and then a taylor series approximation is always a differential equation of infinite order as in 35 consequently the only significant difference in approach when studying discretized versions of higher order kdv equations is the algebraic complexity of the discretized expression using this methodology it is interesting to show that the process of discretization affects bifurcation parameters such as those in 1 or 3 here we consider discretization of the simplest kdv extension that contains a bifurcation parameter the fifth order kdv 3 which we will denote as 5 kdv we recall that grimshaw et al 18 showed that the value of played a key role in the behaviour of the continuous problem 3 finding that the solution only contains gsw if 0 using a similar argument to section 2 5 we will show that this is no longer true after discretization we apply a central difference discretization to the fifth order kdv equation 3 using as the lattice interval in space and time we then apply a nearly identical process to the analysis of lkdv in order to obtain a singulant equation given by 1 cosh x 8 sinh x 2 4 sinh x 0 54 this equation has two sets of solutions which we denote 1 and 2 that satisfy 1 x n 2 x 4 n log 1 1 1 4 2 55 where n z and the signs in 2 x may be chosen independently if 1 4 there are imaginary solutions of 2 x hence the gsw in the solution contain oscillatory terms associated with the singulant 1 x xs 56 where xs is the singularity location and we have restricted our attention to the dominant singulant contributions given by n 1 these oscillations are clearly independent of however if 1 4 all 15 values of 2 x are imaginary in this case the dominant singulant contributions are choices of 2 with n 0 and the first sign choice in 55 taken as positive this gives after some simplification 2 1 2 log 1 1 1 4 2 x xs 57 in this case the behaviour of the far field oscillations does depend on hence we see that unlike solutions to the corresponding continuous fifth order kdv equation the asymptotic solution to the discretized version of 5 kdv contains exponentially small oscillations in the far field for any choice of there is however a critical value of this parameter crit 1 4 at which the behaviour of the far field oscillations of the gsw changes if crit the singulant and hence the oscillation frequency does not depend on however if crit the dominant oscillatory behaviour is dependent on the value of consequently crossing the critical parameter value does not switch off the oscillations entirely as in the continuous problem but rather changes their form we conclude that the process of discretization can cause significant changes in the behaviour of bifurcation parameters in systems such as 5 kdv an equivalent process may be applied to discretized versions of higher order kdv extensions from the hierarchy 31 such as 7 kdv for these problems the asymptotic analysis is nearly identical to the analysis of 5 kdv and the critical parameter value is associated with a change in oscillation regimes rather than changing between classical and generalized solitary wave solutions as the asymptotic analysis of later equations in the kdv hierarchy from 31 is nearly identical to the analysis in this section the details are not presented here 4 discussion and conclusions the purpose of this study was to identify instances of gsw in a lattice equation we considered a finite difference discretization scheme to the unperturbed kdv equation 2 and utilized taylor expansions in order to represent the lattice equation in terms of an infinite sum of derivative terms we then applied methods developed in 25 26 27 for difference equations in order to study exponentially small contributions to the solution behaviour we found that the solution contains stokes lines across which non decaying exponentially small oscillations are switched this demonstrates that lattice equations can produce gsw solutions in the asymptotic limit corresponding to the discretization parameter even if the system being discretized is not singularly perturbed we also showed that the same process can be applied to higher order lattice equations by studying the lattice version of the singularly perturbed fifth order kdv we demonstrated that the discretization can alter the both the critical value and effects of bifurcation parameters in the system we first motivated this result by considering exponentially small terms in the seventh order kdv equation 1 and subsequently a higher order kdv hierarchy 31 this extends the work of 16 17 40 who considered the singularly perturbed fifth order kdv using exponential asymptotic methods we first identified that the exponentially small oscillations in 7 kdv have constant non decaying amplitude in the far field for 1 4 if instead 1 4 then the oscillations can only decay in the far field meaning that the wave is localized and the solution is a classical solitary wave this is consistent with the result obtained by 37 we then found that solutions of the kdv hierarchy also critical values of at which the solution changed between gsw and classical solitary waves for even k corresponding to singularly perturbed differential equations with order 4 z 1 we found that travelling wave solutions for 0 were gsw while solutions for 0 were localized solitary waves this result is consistent with the work of 18 for the fifth order kdv in this hierarchy an important consequence of this work is that discretized systems can potentially produce exponen tially small oscillations in the continuum limit as a consequence of the discretization process we note 16 that the taylor approximation for f x ah about h 0 is written as r 0 ah r r rf x xr finite difference approximations are composed of a sum of terms with advances and delays and hence applying a taylor series approximation to a finite difference system must produce a differential equation of infinite order that is singularly perturbed in the lattice continuum limit h 0 such as 35 this analysis demonstrates the far reaching consequence that exponentially small solution effects can appear in the continuum limit due to the discretization process which produces a singularly perturbed system even in cases where the equation does not have a natural small parameter or obvious singular perturbation similar effects also be seen in asymptotic solutions of difference equations as in 25 26 while the amplitude of oscillations introduced by discretization is typically extremely small see figure 7 these could cause difficulties in the study of systems such as the 7 kdv which can have oscillations of comparably small size see figure 3 it is apparent from the oscillation amplitude in figure 7 that this difficulty can be averted by selecting appropriately small values of h this value should be chosen in order to ensure that any oscillations caused by the discretization of the system are much smaller than any other feature of interest in the solution such as non decaying oscillatory behaviour that is present in the asymptotic solution to the original non discretized problem there are a number of extensions to the problems considered here that warrant closer examination it would be of interest to understand how gsw in these systems interact the problems considered here concentrated on the one soliton solution 5 however it would be of interest to see if more complicated behaviours and interaction effects arise as a consequence of wave interactions in n soliton solutions in particular such solutions would allow us to identify bound states as in 9 19 in which the oscillations that are switched on by one solitary wave are switched off by another this means that even though the solutions are gsw the waves are not necessarily present in the far field but rather restricted to the region between to travelling wave cores it would also be of great interest to study the behaviour of solutions in lattice equations that are not travelling waves but rather the evolution of some prescribed initial condition in the study of partial differential equations using exponential asymptotic methods 12 22 complicated stokes switching effects such as higher order and second generation stokes switching these effects have never been computed in lattice equations and it would be of significant interest to determine whether such effects are present in lattice equation solutions which are allowed to evolve from general initial data one problem not considered in this paper is the interaction of small parameters in our analysis of the discretization of 5 kdv found in section 3 4 we selected the small parameter contained in the original problem as our lattice parameter however if we chose the lattice distance to be an independent small quantity denoted by h we could study the h and h cases separately if h the leading order oscillations in the asymptotic solution must be identical to those found by the lkdv analysis from section 3 if h the asymptotic lattice behaviour would be obtained by instead first discretizing the full fifth order system it would be particularly interesting to study the distinguished limit h o and show how it connects the two regimes a study of these individual cases would provide insight into how best to formulate singularly perturbed systems using finite difference methods in order to ensure that the behaviour caused by the singular perturbation is captured correctly in the discretized equation furthermore there are a number of other problems that could be studied using the methods described in the present study it would be of particular interest to study oscillations present in singularly perturbed variants of higher order integrable variants of the kdv equation such as the seventh order lax equation 28 or members of the classical kdv hierarchy described in 32 the unperturbed versions of these equations possess solitary wave solutions it would be interesting to study the effect of discretization on these systems and whether applying a taylor series expansion to the discretized equations would produce gsw solutions 17 it would also be worthwhile to apply exponential asymptotic methods to integrable discretizations of the kdv equations such as the lattice kdv derived in 34 and studied at length in 33 there exist many other integrable discretizations of kdv variants catalogued in 20 as these discrete systems are integrable they permit classical solitary wave or plane wave solutions this suggests that the process of discretization process does not necessarily produce gsw solutions in the manner seen for the non integrable hierarchy 31 and it would be of interest to understand how this occurs 5 acknowledgements nj was supported by australian laureate fellowship grant no fl 120100094 from the australian re search council cjl was supported by macquarie university new staff grant no 63934274 references 1 g l alfimov a s korobeinikov c j lustri and d e pelinovsky standing lattice solitons in the discrete nls equation with saturation arxiv 1809 10828 2018 2 g l alfimov e v medvedeva and d e pelinovsky wave systems with an infinite number of localized traveling waves phys rev lett 112 2014 no 5 054103 3 t j beale exact solitary water waves with capillary ripples at infinity comm pure appl math 44 1991 no 2 211 257 4 e s benilov r grimshaw and e p kuznetsova the generation of radiating waves in a singularly perturbed korteweg de vries equation physica d nonlinear phenomena 69 1993 no 3 4 270 278 5 m v berry stokes phenomenon smoothing a victorian discontinuity pub math de l ihe s 68 1988 211 221 6 asymptotics superasymptotics hyperasymptotics asymptotics beyond all orders h se gur s tanveer and h levine eds plenum amsterdam 1991 pp 1 14 7 m v berry and c j howls hyperasymptotics proc roy soc lond a 430 1990 no 1880 653 668 8 j p boyd the devil s invention asymptotic superasymptotic and hyperasymptotic series acta appl math 56 1999 no 1 1 98 9 d c calvo and t r akylas on the formation of bound states by interacting nonlocal solitary waves physica d 101 1997 no 3 270 288 10 a r champneys j m vanden broeck and g j lord do true elevation gravity capillary solitary waves exist a numerical investigation j fluid mech 454 2002 403 417 11 s j chapman j r king j r ockendon and k l adams exponential asymptotics and stokes lines in nonlinear ordinary differential equations proc roy soc lond a 454 1998 no 1978 2733 2755 12 s j chapman and d b mortimer exponential asymptotics and stokes lines in a partial differential equation proc roy soc lond a 461 2005 2385 2421 13 d clamond d dutykh and a dura n a plethora of generalised solitary gravity capillary water waves j fluid mech 784 2015 664 680 14 r b dingle asymptotic expansions their derivation and interpretation academic press new york 1973 15 timothy e faver and j douglas wright exact diatomic fermi pasta ulam tsingou solitary waves with optical band ripples at infinity siam journal on mathematical analysis 50 2018 no 1 182 250 18 16 r grimshaw exponential asymptotics and generalized solitary waves asymptotic methods in fluid mechanics survey and recent advances h steinru ck f pfeiffer f g rammerstorfer j salenc on b schrefler and p serafini eds cism courses and lectures vol 523 springer vienna 2011 pp 71 120 17 r grimshaw and n joshi weakly nonlocal solitary waves in a singularly perturbed korteweg de vries equation siam j appl math 55 1995 no 1 124 135 18 r grimshaw b malomed and e benilov solitary waves with damped oscillatory tails an analysis of the fifth order korteweg de vries equation physica d 77 1994 no 4 473 485 19 r grimshaw and b a malomed a note on the interaction between solitary waves in a singularly perturbed korteweg de vries equation j phys a 26 1993 no 16 4087 20 j hietarinta n joshi and f w nijhoff discrete systems and integrability vol 54 cambridge university press 2016 21 a hoffman and j d wright nanopteron solutions of diatomic fermi pasta ulam tsingou lattices with small mass ratio physica d 358 2017 33 59 22 c j howls p j langman and a b olde daalhuis on the higher order stokes phenomenon proc roy soc lond a 460 2004 no 2121 2285 2303 23 g iooss and k kirchga ssner water waves for small surface tension an approach via normal form proc roy soc edinb a 122 1992 no 3 4 267 299 24 travelling waves in a chain of coupled nonlinear oscillators comm math phys 211 2000 no 2 439 464 25 n joshi and c j lustri stokes phenomena in discrete painleve i proc r soc a 471 2015 no 2177 20140874 26 n joshi c j lustri and s luu stokes phenomena in discrete painleve ii proc r soc a 473 2017 no 2198 20160539 27 j r king and s j chapman asymptotics beyond all orders and stokes lines in nonlinear differential difference equations euro j appl math 12 2001 433 463 28 p d lax integrals of nonlinear equations of evolution and solitary waves comm pure apply math 21 1968 no 5 467 490 29 c j lustri and m a porter nanoptera in a period 2 toda chain siam j appl dyn sys 17 2018 no 2 1182 1212 30 t r o melvin a r champneys p g kevrekidis and j cuevas radiationless traveling waves in saturable nonlinear schro dinger lattices phys rev lett 97 2006 no 12 124101 31 t r o melvin a r champneys and d e pelinovsky discrete traveling solitons in the salerno model siam j app dyn sys 8 2009 no 2 689 709 32 a c newell solitons in mathematics and physics vol 48 siam 1985 33 f w nijhoff and h w capel the discrete korteweg de vries equation acta appl math 39 1995 no 1 3 133 158 34 f w nijhoff g r w quispel and h w capel direct linearization of nonlinear difference difference equations phys lett a 97 1983 no 4 125 128 35 a b olde daalhuis s j chapman j r king j r ockendon and r h tew stokes phenomenon and matched asymptotic expansions siam j app math 55 1995 no 6 1469 1483 36 o f oxtoby and i v barashenkov moving solitons in the discrete nonlinear schro dinger equation phys rev e 76 2007 no 3 036603 19 37 y pomeau a ramani and b grammaticos structural stability of the korteweg de vries solitons under a singular perturbation physica d 31 1988 no 1 127 134 38 s m sun existence of a generalized solitary wave solution for water with positive bond number less than 13 j math anal appl 156 1991 no 2 471 504 39 f tappert numerical solutions of the korteweg de vries equation and its generalizations by the split step fourier method nonlin wave mot 15 1974 215 216 40 p h trinh exponential asymptotics and stokes line smoothing for generalized solitary waves asymptotic methods in fluid mechanics survey and recent advances h steinru ck f pfeiffer f g rammerstorfer j salenc on b schrefler and p serafini eds cism courses and lectures vol 523 springer vienna 2011 pp 121 126 41 a vainchtein y starosvetsky j d wright and r perline solitary waves in diatomic chains phys rev e 93 2016 no 4 042210 42 j m vanden broeck elevation solitary waves with surface tension phys fluids a 3 1991 no 11 2659 2663 a inner analysis for the seventh order kdv in order to determine the behaviour of f x t we need to match the late order ansatz 8 to the inner problem near the singularity at x x we define an inner spatial variable x x and a new independent coordinate v t 2 u x t the governing equation 1 becomes 3 7 v t 7 1 3 5 v t 5 1 3 3 v t 3 6 v t 3 v t x 1 2 v t t 0 58 in order to match the outer behaviour with the inner region we require only the leading order governing equation for the inner region behaviour in the limit that 0 which contains terms that are o 1 3 the inner expansion therefore satisfies 7 v 7 5 v 5 3 v 3 6 v v x 0 59 we note that time derivatives do not contribute at this order and therefore vj is constant in time we now apply an asymptotic expansion in the inner coordinate in the limit that given by v t j 0 vj 2 j 2 60 we set v 0 2 in order for this expression be consistent with the local singularity behaviour described in 6 we match this expression at successive orders of in order to obtain a recurrence relation for vj by matching at o 1 2 k 5 and simplifying the expression we obtain the recurrence relation 2 k 4 2 k 1 12 kv 0 vk 2 k 4 vk 2 2 k 3 2 k 4 vk 1 2 k 1 6 k 1 r 1 2 k 2 r 2 vrvk r 61 where we use the convention that vj 0 for j 0 this expression can be rearranged to obtain a recurrence relation for vk in terms of vj for j k beginning with v 0 2 by repeatedly applying this recurrence relation values of vj may be obtained for any choice of j matching the inner expansion 60 with the outer ansatz 14 requires some care as we must account for both of the contributions that dominate behaviour in the neighbourhood of x x the full inner limit of the outer expansion 14 is therefore uj x t f 1 t 2 j 2 x x 2 j 2 f 2 t 2 j 2 x x 2 j 2 62 20 25 50 75 0 694 0 694 0 694 0 711 1 0 5 0 5 0 1 1000 j re 1 2 im 1 im 2 figure 8 approximation for 1 and 2 obtained by computing the expression in 63 and 64 for increasing values of j the real part and imaginary parts of i for i 1 2 are represented by black and white circles respectively as j and x x where 12 i 3 2 matching between the outer limit of the inner expansion 60 and the inner limit of the outer expansion 62 is complicated by the fact that there are two contributions of equal size we follow the strategy for finding the prefactor with multiple contributions used in 1 25 26 and adapt it to consider the sum of three consecutive terms consequently we find that 3 f 1 t lim j vj 2 j 2 2 j 2 vj 1 2 j 4 2 j 4 vj 2 2 j 6 2 j 6 63 where the fact that 1 2 4 0 ensures that all terms containing f 2 are eliminated from the expression if we instead multiply throughout by we similarly find that 3 f 2 t lim j vj 2 j 2 2 j 2 vj 1 2 j 4 2 j 4 vj 2 2 j 6 2 j 6 64 as vj does not vary in time f 1 and f 2 clearly take constant values we will denote this value as f 1 and 2 respectively by evaluating vj for sufficiently large values of j using 61 we can approximate i for i 1 2 using 63 and 64 this process is illustrated in figure 8 for 1 we see that as vj increases tends to a constant value this process was continued to j 600 establishing that if 1 we have 1 0 711 0 694 i and 2 1 a similar analysis in the neighbourhood of x x shows that 3 1 and 4 2 this is a consequence of the fact that uj and vj are always real and therefore must be the sum of complex conjugates we will subsequently denote 1 giving 3 and 2 4 in the 1 4 case matching the inner expansion 60 with the outer ansatz 45 simply requires that lim j vj i 2 j 2 2 j 2 65 where is the constant associated with the singularity at x x this is always a real valued expression meaning that unlike the 1 4 case will only take real values an example calculation for 1 8 using the recurrence relation 61 is illustrated in figure 9 the value of was approximated using 8 with j 600 giving 11 70 a similar analysis shows that the corresponding constant associated with the singularity at x x denoted is identical to we therefore denote both using the constant b inner analysis for the lattice kdv in order to determine the behaviour of f x t we need to match the late order ansatz 8 to the inner problem near the singularity at x x the process is similar to appendix a although the recurrence 21 25 50 75 11 70 11 70 10 15 5 0 100 0 j figure 9 approximation for obtained by computing the expression in 65 for increasing values of j 30 60 90 1 103 2 103 120 3 103 0 j 2 68 103 2 68 103 figure 10 approximation for obtained by computing the expression in 69 for increasing values of j relation is more complicated as the number of terms depends on the recursion depth we define an inner spatial variable h x x and a new independent coordinate v t h 2 u x t the governing equation 35 becomes 1 h 3 r 0 22 r 1 2 r 1 2 r 1 v t 2 r 1 2 h 3 r 0 1 2 r 1 2 r 1 v t 2 r 1 6 v t h 3 r 0 1 2 r 1 2 r 1 v t 2 r 1 1 h 2 r 0 h 2 r 2 r 1 2 r 1 v t t 2 r 1 0 66 the matching requires only the leading order terms the limit that h 0 at o 1 h 3 we have r 0 22 r 1 2 r 1 2 r 1 v 2 r 1 2 r 0 1 2 r 1 2 r 1 v 2 r 1 6 v r 0 1 2 r 1 2 r 1 v 2 r 1 0 67 the time derivatives again do not contribute at this order and therefore vj is a constant we now apply an asymptotic expansion in the inner coordinate in the limit that given by 60 we again set v 0 2 in order for this expression be consistent with the local singularity behaviour described in 6 and match in order to obtain a recurrence relation for vj at o 1 2 k 5 we obtain the recurrence relation k 1 r 1 2 k 4 2 r 1 2 2 r 1 vk r 1 3 k l 0 l r 0 2 k 4 2 r 1 vk lvl r 0 68 this expression can be rearranged to obtain a recurrence relation for vk in terms of vj for j k beginning with v 0 2 by repeatedly applying this recurrence relation values of vj may be obtained for any choice of j 22 matching the inner expansion 60 with the outer ansatz 45 requires that f t lim j vj i 2 j 2 2 j 2 69 as vj is constant f t must also be a constant which we again denote as by evaluating vj for sufficiently large values of j using 68 we can approximate using 69 this process is illustrated in figure 10 as vj increases the approximation for tends to a constant value this process was continued to j 200 establishing that 2 68 103 23 1 introduction 1 1 background 2 seventh order kdv 2 1 formulation and series expansion 2 2 late order asymptotic terms 2 3 exponential asymptotics 2 3 1 case a 2 3 2 case b 2 4 comparison of results 2 5 higher order kdv equations 3 finite difference kdv 3 1 formulation and series expansion 3 2 late order asymptotic terms 3 3 exponential asymptotics 3 4 lattice equations with parameters 4 discussion and conclusions 5 acknowledgements a inner analysis for the seventh order kdv b inner analysis for the lattice kdv