tree decomposition of reeb graphs parametrized complexity and applications to phylogenetics anastasios stefanou 1 abstract inspired by the interval decomposition of persistence modules and the extended newick format of phylogenetic networks we show that inside the larger category of ordered reeb graphs every reeb graph with n leaves and first betti number s is equal to a coproduct of at most 2 s trees with n s leaves reeb graphs are therefore classified up to isomorphism by their tree decomposition an implication of this result is that the isomorphism problem for reeb graphs is fixed parameter tractable when the parameter is the first betti number we propose ordered reeb graphs as a model for time consistent phylogenetic networks and propose a certain hausdorff distance as a metric on these structures key words coproducts decomposition complexity betti number reeb graphs phylogenetic networks acknowledgements a stefanou was partially supported by the national science foundation through the grant nsf ccf 1740761 tripods tgda osu and also by the grant nsf dms 1440386 mathematical biosciences institute at the ohio state university the author gratefully thanks two anonymous reviewers whose feedback significantly increased the quality of the manuscript furthermore the author thankfully acknowledge f m moli e munch j curry s kurtek w khudabukhsh and a foroughipour for many helpful discussions during the course of this work 1 introduction reeb graphs encode the evolution of connected components of a space x along a real valued map f on x 31 originated from morse theory reeb graphs have been of particular interest to the fields of computational geometry 13 2 23 18 and computational topology 28 20 14 3 and they have found a plethora of applications in computer graphics and computer science 21 24 12 22 17 35 see 4 for a survey one variation of reeb graphs that has recently been proposed is mapper 33 which has been quite successful on big data sets 30 37 1 1 related work de silva et al 2016 showed that any reeb graph can be identified with a constructible set valued cosheaf on r 16 thus reeb graphs can be thought of as generalized persistence modules in the setting of bubenik et al 2015 8 a generalized persistence module is any functor f p c from a poset p to a category c 8 when p r the poset of real numbers and c vectk is the category of finite dimensional k vector spaces we obtain the notion of a pointwise finite dimensional p f d persistence module crawley boevey 2015 has shown that every p f d persistence module v r vectk decomposes into a direct sum of interval persistence modules 15 the multiset of intervals b v associated to v is called the barcode of v 11 because of this decomposition one can easily check that the isomorphism complexity of p f d persistence modules is polynomial however this is no longer true for arbitrary generalized persistence modules bjerkevik et al 2018 has shown that the isomorphism complexity of reeb graphs is gi complete 6 namely deciding if two reeb graphs are isomorphic it is at least as hard as the graph isomorphism problem however the graph isomorphism problem has shown to be 1 stefanou 3 osu edu 614 688 3198 orcid id https orcid org 0000 0002 5408 9317 mathematical biosciences institute department of mathematics the ohio state university 1 ar x iv 1 90 2 05 85 5 v 3 m at h a t 1 7 s ep 2 01 9 fixed parameter tractable with respect to several parameters such as tree distance width 36 tree depth 7 and tree width 26 hence it is natural to wonder whether reeb graphs like graphs are fixed parameter tractable with respect to some topologically meaningful parameter on the other hand we can think of any reeb graph as a weighted directed acyclic graph weighted directed acyclic graphs are used as the main method for modelling phylogenetic trees and networks 9 5 32 25 the isomorphism classes of phylogenetic trees are in one to one correspondence with nested parentheses a method known today as the newick format which was already noticed by a cayley 1857 for general phylogenetic networks cardona et al 2008 proposed a variant of the newick format called the extended newick format 10 the idea is given a fixed ordering on the children nodes of a rooted phylogenetic network with n labelled leaves and s reticulations betti number we can represent that network as a phylogenetic tree with n s labelled leaves where some of the leaves are allowed to have repeated nodes a dress 2007 proposed a categorical approach to view phylogenetic networks called x nets 19 1 2 our contribution inspired by the decomposition of p f d persistence modules into interval persistence modules we show that any reeb graph decomposes into a coproduct of trees the construction of each of these trees is an analogue of the extended newick format in the setting of arbitrary reeb graphs not necessary rooted first in sec 2 and 3 we mention the basic definitions and tools from category theory 27 and the setting of reeb graphs as studied in 16 which we need in order to formulate properly the tree decomposition of reeb graphs in sec 4 we show that the category of reeb graphs with a fixed edge structure forms a thin category inside of which every reeb graph decomposes into a coproduct of trees as an implication of this decomposition we show that reeb graph isomorphism is fixed parameter tractable where the parameter is the first betti number 2 categorical structures category theory is fundamentally a language that formalizes mathematical structure having the capability of bridging together different mathematical constructions or theories in this section we give the basic definitions and tools from category theory that we need 2 1 basic definitions category theory is a general theory of functions a general notion of a function is called a morphism and the notion of a set is replaced by an object an object can be any mathematical construction and its not necessary to be a set in contrast with set theory the focus is concentrated in the study of morphisms between objects rather than just study the objects themselves in particular we require that morphisms between objects to have a composition operation that is associative and unital the structure we obtain is said to be a category a good source for an introduction to category theory is 27 first we define the notion of a category here by a class we mean a collection of sets that is unambiguously defined by property that all these sets share in common a class might not be a set and if that is the case is called a proper class definition 2 1 a category c consists of a class obc whose elements x y are called objects together with for each pair of objects x y in c a set morc x y whose elements are called morphisms and denoted by f x y and each having a unique source x and a unique target y for each object x in c an identity morphism ix x x a binary operation morc x y morc y z morc x z f g 7 g f called composition which is associative and unital i e h g f h g f f ix iy f for any triple of morphisms f x y g y z and h z w in c definition 2 2 a morphism f x y is said to be an isomorphism from x to y if there exists a morphism g y x often called the inverse such that g f ix and f g iy two objects are said to be isomorphic if there exists an isomorphism from x to y 2 example 2 3 examples of categories include the category set whose objects are sets and morphisms are functions between sets the category top whose objects are topological spaces and morphisms are continuous maps the category groups whose objects are groups and morphisms are group homomorphisms the category ab whose objects are abelian groups and morphisms are group homomorphisms definition 2 4 a category d whose objects and morphisms are in c and with the same identities and composition operation as of c is said to be a subcategory of c let c be a category and let s be any subset of obc then we can consider the same sets morc x y of morphisms between x y s that way we obtain a category with the same morphisms but fewer objects we say that s forms a full subcategory of c in a full subcategory we only need to specify what are the objects so we often say s is the full subcategory of c whose objects are in s for example the category ab is the full subcategory of groups whose objects are abelian groups example 2 5 the type of categories we work on are the following slice categories given a category c and an object x we consider the slice category c x whose objects are tuples y f where y obc and f morc y x and morphisms y f z g are ordinary morphisms y z in c such that g f thin categories a category c is called thin if for every pair of objects x y in c there exists at most one morphism f x y in c when a morphism f x y exists we write x y a thin category coincides with the notion of a preorder now we define the notion of maps that preserve the structure of a category definition 2 6 a functor f c d between categories consists of a function f obc obd x 7 f x together with for each pair of objects x y in c a function fx y morc x y mord f x f z f 7 f f such that for any object x and any morphisms f x y g y z in c f g f f g f f f ix if x when c d f is called an endofunctor a special case is the identity endofunctor ic c c that sends each object and morphism to itself the collection of all functors from a category c to a category d forms a category on its own called a functor category and it is denoted by c d the objects are functors f c d and the morphisms are natural transformations f g definition 2 7 a natural transformation f g consists of a family of morphisms x f x g x in d one for each object x in c such that the diagram f x g x f y g y x f f g f y commutes for every morphism f x y in c in the special case where each x is an isomorphism in d then is said to be a natural isomorphism and we write f g every time we write f g we mean there exists a natural isomorphism f g definition 2 8 a pair of categories c d are said to be equivalent if there exist functors f c d and g d c such that f g id and g f ic in the special case where f g id and g f ic the categories c and d are said to be isomorphic 3 2 2 coproducts we define the notion of a coproduct of objects in a category c this is the dual notion of a product 27 however here we focus only on the definition of coproducts since this is the only notion we use definition 2 9 let x 1 xn be objects in c an object is called the coproduct of x 1 x 2 xn written xi if there exist morphisms j xj xi j 1 2 n satisfying the following universal property for any object y and any pair of morphisms fj xj y j 1 2 n there exists a unique morphism f xi y such that the diagrams xj xi y j fj f commute for j 1 2 n note that by the universal property of coproducts the morphisms j are uniquely defined up to a unique natural isomorphism the morphisms j xj xi are called coprojections definition 2 10 an object x is said to be decomposable if it is isomorphic to a coproduct of n objects in c where n 2 otherwise x is said to be indecomposable example 2 11 here we give some basic examples of categorical coproducts if c is the category of all sets set then the coproduct is given by the disjoint union of sets if c is the category of groups groups then the coproduct is given by the free product of groups if c is the category of abelian groups ab then the coproduct is the direct sum of abelian groups 3 combinatorial structures in this section we consider the setting of reeb graphs as developed by v de silva et al 2016 16 we define reeb graphs and examine how they relate to directed acyclic graphs 3 1 reeb graphs the main tool we use to visualize relationships among objects is a graph a graph g v e consists of a collection v of objects called vertices e g v 1 v 2 and a set e of connections e 1 e 2 between vertices called edges generally we can define a reeb graph as a connected graph x together with a real valued map f x r which is strictly monotone when restricted to edges however with this definition we are not making precise the exact way x can be constructed in conjunction with the map f being monotone restricted to edges making this more precise is what we do in this paragraph first we need to talk about the general setting of r spaces an r space x f is a space x together with a real valued continuous map f x r a morphism of r spaces x f y g also called a function preserving map is an ordinary continuous map x y such that g f the collection of these objects forms the slice category top r now let us return to reeb graphs definition 3 1 a connected r space x f is said to be a reeb graph if it is constructed by the following procedure which we call a structure on x f let s a 1 ak be an ordered subset of r with k 2 for each i 1 k we specify a non empty set vi of vertices which lie over ai for each i 1 k 1 we specify a non empty set of edges ei which lie over ai ai 1 for i 1 k 1 we specify a down map di ei vi for i 1 k 1 we specify an upper map ui ei vi 1 the space x is the quotient u of the disjoint union u k i 1 vi ai k 1 i 1 ei ai ai 1 with respect to the identifications di e ai e ai and ui e ai 1 e ai 1 for all i 1 k 1 with the map f being the projection onto the second factor 4 remark 3 2 note that to every reeb graph corresponds a unique minimal set s known as the critical set of x 16 we consider a definition for arbitrary set s because this allows for more flexibility we can describe the morphisms between reeb graphs easily if we consider a common set s for both reeb graphs e g by considering the union of their two s sets the set v k i 1 vi is said to be a vertex set for x and the set e k 1 i 1 ei is said to be a edge set for x 2 if we forget the map f associated to a reeb graph then topologically x forms a graph v e on its own see fig 1 for an example of a reeb graph definition 3 3 a morphism of reeb graphs x f and y g is any morphism x f y g between these r spaces thus the collection of all reeb graphs forms a full subcategory reeb of top r as shown in 16 reeb graphs can be identified with constructible set valued cosheaves on r this equivalence of categories allows for one to consider the following combinatorial description of the morphisms of reeb graphs proposition 3 4 prop 3 12 in 16 let x f y g be a pair of reeb graphs with a common set s a 1 ak let vx vy and ex ey be their vertex sets and edge sets respectively any function preserving map x f y g of reeb graphs is completely determined by functions vi v x i vyi functions ei e x i eyi satisfying the consistency conditions vid x i d y i e i and v i 1 u x i u y i e i for all 1 i k 1 any function preserving map x f y g since f and g are by definition the projections to the second coordinate of x and y respectively is given by x f y g v t 7 vi v t for all v v x i for all i 1 k e t 7 ei e t for all e e x i for all i 1 k 1 3 3 2 reeb graphs viewed as directed acyclic graphs if we allow the edges e of a graph g to have a direction i e x e y then the resulting graph is said to be a digraph and the edges are called directed edges or arrows a directed path of length n on a digraph is a sequence of arrows x 0 x 1 x 2 x 3 xn 1 xn in g a directed path that starts and end at the same vertex is called a directed cycle a digraph with no directed cycles is said to be a directed acyclic graph dag with the map f x r we give a direction to each edge e connecting x 1 and x 2 in x by declaring e x 1 x 2 whenever f x 1 f x 2 that way the underlying graph v e of a reeb graph x obtains the structure of a directed acyclic graph furthermore each vertex v of x receives a real weight w v f v via f so every reeb graph can be thought of as a vertex weighted dag remark 3 5 note in particular for reeb graphs because of the vertex weight w v f v each directed edge e x 1 x 2 receives a strictly positive weight w e f x 1 f x 2 0 where f x 1 ai 1 and f x 2 ai for some i 1 k 1 are consecutive critical numbers of x f let x f be a reeb graph with critical set s a 1 ak let x be a vertex of x with f x ai then an edge e d 1 i x e u 1 i 1 is said to be an edge incident from above below of x also the number of edges indeg x d 1 i x that are incident from above of x is called the indegree of x similarly the number of edges outdeg x u 1 i 1 x is called the outdegree of x there are three cases that can happen for a node x if indeg x 1 then x is said to be a tree vertex if indeg x 2 and with x a cycle in the reeb graph viewed as a dag closes x is the bottom of a cycle then x is said to be a reticulation vertex if indeg x 2 and with x no cycles closes in the reeb graph then x again is said to be a tree vertex 2 the reason we call these sets in this way e g we say a vertex set instead of the vertex set is because they depend on the choice of s 5 figure 1 an example of a reeb graph a vertex x such that indeg x outdeg x 1 is called regular we denote by t x the set of tree vertices of x and by r x the set of all reticulation vertices of x if outdeg x 0 or outdeg x 1 and indeg x 0 then x is said to be a leaf by definition it may happen that a leaf is also a reticulation vertex i e outdeg x 0 and indeg x 2 remark 3 6 the reason we consider this definition of leaves is so that the tree decomposition of reeb graphs to work for this type of reticulation vertices this would be more clear in ex 4 12 we denote by l x the set of all leaves of x then l x t x viewing reeb graphs as dags is also important for computing the betti number s b 1 x of a reeb graph x the betti number counts the minimum number of cycles of a graph that generate all possible cycles in the graph by definition a reeb graph x f is a tree if and only if it has no reticulation vertices and thus no cycles since x is always connected by definition the euler characteristic provides the formula s e v 1 furthermore from the theory of directed graphs we have the degree sum formula x v indeg x x v outdeg x e by combining these two equations we get s 1 x v indeg x 1 proposition 3 7 let r 1 rm be the reticulation vertices of x with indegrees d 1 dm 2 respectively then s m i 1 di 1 6 proof thinking of x as a dag then if we remove for each reticulation vertex ri all of its incident from above edges except one from the dag x then we get back a directed tree tx vtx etx having the same tree vertices and their incident from above edges as in x plus another m additional vertices r 1 rm that now are viewed as tree vertices each having indegree 1 this implies that t vx r 1 rm vtx and m i 1 indegtx ri 1 0 we compute s 1 x v indeg x 1 1 x t v indeg x 1 x r v indeg x 1 1 x t v indeg x 1 0 m i 1 di 1 1 x t v indeg x 1 m i 1 indegtx ri 1 m i 1 di 1 1 x vtx indeg x 1 m i 1 di 1 s tx m i 1 di 1 0 m i 1 di 1 m i 1 di 1 finally note that although any reeb graph can be thought of as a vertex weighted dag the other direction is not true not every vertex weighted dag is a reeb graph example 3 8 consider the vertex weighted dag g v g e g w that has edges e 1 x 1 x 2 e 2 x 2 x 3 connecting x 1 with x 2 and x 2 with x 3 and an edge e 3 x 1 x 3 connecting directly x 1 with x 3 with a single edge and such that w x 1 2 and w x 2 w x 3 1 then we claim that there exists no reeb graph x f such that v x v g and f v g w indeed assume the contrary there is one such f then f x 1 2 and f x 2 f x 3 1 by definition of g there exists an edge e 2 x 2 x 3 by remk 3 5 we get a strictly positive edge weight w e 2 0 howver we compute w e 2 f x 2 f x 3 w x 2 w x 3 1 1 0 a contradiction hence the weighted dag g cannot be realized as a reeb graph this dag it is not consistent with time in the sense that the edge e 2 x 2 x 3 represents a change in the nodes from x 2 to x 3 that happen instantaneously in other words the edge e 2 is a horizontal edge reeb graphs cannot have horizontal edges from their construction x 1 x 2 x 3 4 classifying reeb graphs up to isomorphism we show that inside a larger category of reeb graphs any reeb graph is a coproduct of trees 4 1 ordered reeb graphs definition 4 1 an ordered reeb graph x f x is an ordinary reeb graph x f such that its edge sets and its vertex sets as in defn 3 1 are in particular partially ordered sets posets i e ei ei i 1 k 1 and vi vi i 1 k and also the down maps and upper maps preserve the partial orders i e ui ei ei vi 1 vi 1 and di ei ei vi vi for i 1 k 1 the partial orders of the edge posets and vertex posets induce a partial order both on the disjoint union and the quotient space namely the reeb graph denoted by x indeed it 7 is known that the category pos of posets just like sets admit coequalizers and therefore quotients see joy of cats pg 119 1 definition 4 2 we define the category reebord whose objects x f x are ordered reeb graphs morphisms x f x y g y are ordinary morphisms of reeb graphs x f y g that preserve the partial orders of the edge posets and vertex posets i e ei exi ex i eyi ey i i 1 k 1 and vi vxi vx i vyi vy i i 1 k are order preserving maps composition is defined in the obvious way any finite set a x 1 xn can be trivially thought of as a poset a by considering xi xj xi xj namely the only inequalities are the identities thus any reeb graph x f has its edge sets and vertex sets trivially partially ordered i e the inequalities are only the identities hence any reeb graph x f is an object of reebord that is ob reeb ob reebord in particular reeb is a full subcategory of reebord indeed let x f y g be a morphism in reeb then again trivially we can think of when restricted to the edge sets and vertex sets respectively as an order preserving map between trivially partially ordered sets therefore reeb is a full subcategory of reebord 4 2 ordered reeb graphs with a fixed edge structure fix an ordered subset s a 1 ak of r consider an ordered reeb graph x f x with edge posets e e e 1 e 1 ek 1 ek 1 where ei i 1 k 1 as in defn 3 1 we call e e 1 ek 1 an edge sequence of the ordered reeb graph x f with respect to s given a common set s a 1 ak for a pair of reeb graphs x f x and y g y we say that their edge sequences ex ex 1 exk 1 and e y ey 1 eyk 1 are equivalent and denote it by e x ey if exi eyi for all i 1 k 1 as sets in other words x f x and y g y have equivalent edge sequences if ei e i for all i 1 k 1 where denotes the cardinality definition 4 3 let x f and y g be two reeb graphs with common set s we say x f y g have the same edge structure if their edge sequences are equivalent note that the relation x f y g x f y g have the same edge structure forms an equivalence relation this equivalence relation induces a partition on the objects of reeb i e we get ob reeb a a xa fa for some index set a where denotes the equivalence class this fact suggests that each of these blocks can be turned into a category on its own fix an edge sequence e definition 4 4 we define reebord e the category whose objects x f x x are ordered reeb graphs x f x together with a family x xi k 1 i 1 of bijections xi e x i ei for all i 1 k 1 called an e edge labelling or simply an edge labelling if e is given the morphisms are ordinary morphisms x f x y g y in reebord that preserve the edge labeling namely y ej e x e for all e exj and all j 1 k 1 composition is defined in the obvious way lemma 4 5 the category reebord e is thin proof let x f x x y g y y be two morphisms in reebord e by prop 3 4 we have to show that the maps agree at the edge posets and vertex posets by definition y 1 x when restricted to edge posets because the labellings are bijections let v be a node in x say v vxi for some i we claim that vi v vi v now v is either the down image or the upper image of some edge e exi for some i 1 k 1 so we have two cases 8 case 1 v dxi e by prop 3 4 we have that v v i d x i e d y i e i e d y i y 1 x e d y i e i e v i d x i e v case 2 v uxi e the proof of case 2 is similar to that of case 1 and is omitted remark 4 6 we define the full subcategoryreeb e ofreebord e whose objects are reeb graphs with the trivial partial order i e ordinary reeb graphs and with the same edge structure as e by definition of we observe that x f and y g have the same edge structure if and only if both x f and y g are objects of reeb e for some edge sequence e 4 3 tree decomposition theorem 4 7 fix an edge sequence e let n s 0 inside the larger category reebord e any reeb graph x f in reeb e with n leaves and betti number b 1 x s is a coproduct of ordered trees with n s leaves and same e edge labelling i e x f t t x t ft t for some set of ordered trees t x proof let x x f be a reeb graph in reeb e with n leaves and b 1 x s let x be its trivial partial order let l x l 1 lt r x r 1 rm be its sets of leaves and reticulation vertices respectively let di be the indegree of the reticulation vertex ri for all i 1 m also for any reticulation vertex ri i 1 m let us denote by e i 1 e i di the set of all edges that are incident of ri from above it the basic idea of the proof is to construct a collection of ordered trees with n s leaves and same edge labelling as x out of x t x t w 1 wm f w 1 wm w 1 wm 1 wi di for all i 1 m by breaking up in all possible ways the reticulation vertices the bottom of the cycles of x without changing the connectivity of the graph in order to create a tree out of x by introducing new leaves consider vxj and e x j and the upper and down maps uxj and d x j j 1 k 1 as in defn 3 1 for simplicity of the proof we denote any m tuple w 1 wm by w let w m i 1 1 di we construct an ordered tree t tw fw w with n s leaves by changing the structure of x so as to make an odered tree following the steps below 1 we define for any j 1 k 1 the set etwj e x j equipped with the trivial partial order ex j that way the edge sequence and thus the edge structure remains the same i e etwj e x j for all j 1 k 1 moreover consider the same e edge labelling tw as for x for any j 1 k the vertex poset vtwj vtw j where 4 vtwj v x j f ri aj e i t 1 t di and t 6 wi and the partial order vtw j is given by the identities on the elements and the additional formal inequalities ri w e i t for all 1 t di with t 6 wi 4 if f ri 6 aj for all j then the right component of the direct sum is the emptyset and we get v tw j v x j 9 remark 4 8 these nontrivial innequalities formalize the idea that the vertex ri is isolated from the new vertices leaf nodes that are formed after cutting the reticulation vertex ri of x while keeping it connected from above with the edge e i wi this observation is crucial since on one hand the trees tw are distinguised for all choces of w and on the other hand this makes the coproduct well defined as we will see e g in ex 4 12 the function dtwj e tw j v tw j given by d tw j e dxj e if d x j e is not a reticulation vertex ri if e e i wi for some i 1 m e if dxj e ri and e 6 e i wi for all i 1 m the function utwj e tw j v t j 1 given by u t j e u x j e note that since the edge sets are trivially partially ordered as such these functions are trivially order preserving i e dtwj e tw j etw j vtwj vtw j and utwj e tw j etw j vtj 1 vtw j 1 for all j 2 tw is the quotient of the disjoint union k j 1 vtwj aj k 1 j 1 etwj ai ai 1 with respect to the identifications utwj e aj 1 e aj 1 and d tw j e aj e aj define fw to be the projection of tw to the second coordinate both the disjoint union and the resulting quotient space receive a partial order from the partial orders on vtwj and e tw j we denote the resulting partial order on tw by tw remark 4 9 note also that by definition of dtw the identifications dtwj e aj e aj are the trivial ones e aj e aj whenever e 6 e i wi for all i 1 m that formally expresses the fact that the tree tw is constructed from x by cutting the bottom of all cycles keeping for all 1 i m only the edge e i wi connected to the reticulation vertex ri and diconnecting the others to sum up tw forms an an ordered tree tw fw w in reebord e furthermore each ordered tree tw fw w is equipped with the obvious quotient map qw tw fw w x f x where q e w e tw ex e 7 e and q v w v tw vx v 7 v for all v vx e i t 7 ri for all 1 t di with t 6 wi for all i 1 m by definition the quotient map qw glues back the new vertices of the tree tw yielded by the w cut to form the original reeb graph x note that no matter what the order of the new vertices is from the cut of ri via the quotient map qw they are glued to a single vertex ri hence qw trivially preserves the partial orders namely qw kills the only non trivial innequalities ri e i t for all t 6 wi and i 1 m moreover by construction tw has the same edge sets as x thus making qw to be trivially e labelling preserving so indeed qw is a morphism in reebord e now we claim that the coproduct of all the trees tw fw w in reebord e is isomorphic to the ordered reeb graph x f x where again x is the trivial order of the reeb graph with the coprojections morphisms being the quotient maps qw let w tw fw w y g y y be any w indexed family of morphisms in reebord e then in particular w tw fw w y g y v t 7 vw j v t for all v v x j e t 7 ew j e t for all e e x j 10 for some order preserving maps vw j and e w j satisfying the consistency conditions as described in prop 3 4 we claim that there exists a unique morphism x f x y g y y in reebord e such that each of the diagrams tw fw w x f x y g y y qw w commutes since the category reebord e is thin all diagrams commute by default and if exists then it is unique therefore we only need to show that there exists a morphism x f x y g y y v t 7 vj v t for all v v x j e t 7 ej e t for all e e x j for some order preserving maps vj and e j satisfying the consistency conditions as described in prop 3 4 lets return to w each map ew j is trivially order preserving the edge posets are just edge sets and therefore they have the trivial partial order given only by the identities since w is e edge labelling preserving we get ew j e y 1 e for all e etwj thus e w j it is independent of w so naturally we define e j by e j e e w j e y 1 e for all e exj e tw j now lets focus on the order preserving maps vw j v tw j vtw j vyj vy j for j 1 k we compute v w j ri v w j d tw j e i wi d y j e w j e i wi d y j e j e i wi and v w j e i t v w j d tw j e i t d y j e w j e i t d y j e j e i t for all 1 t di with t 6 wi on the other hand the inequalities ri vtw j e i t yield the innequalities v w j ri vy j vw j e i t therefore d y j e j e i wi vy j d y j e j e i t however note that since wi was chosen in random we can as well get the inequality d y j e j e i t vy j d y j e j e i wi by formally replacing wi with t therefore we obtain the equalities d y j e j e i t d y j e j e i s for all 1 t s di for all i 1 m 1 thus we see that v w j ri v w j e i t for all 1 t di with t 6 wi 2 and in particular by eqn 1 we see that this is independent of w so naturally setting vj ri v w j ri is well defined now for any vertex v vxj which is not a reticulation vertex by construction of tw we have v v tw j in particular v vtwj is either the down image of some e e tw j via the map d tw or the upper image of some e etwj 1 via the map u tw because of that we can again show that vw j v is independent of the choice of w so we define vj v v w j v to sum up v j v v w j v is a well defined map for all v vxj we claim that the maps vj and e j satisfy the consistency conditions as described in prop 3 4 we only need to check the consisteny condition vjd x j d y j e j the other one is true since u tw j e u x j e for all e ej 1 if we show that vjd x j d y ej then the map x f x g would be an actual morphism in reeb indeed fix any w let e etwj we have the following cases 11 case 1 dxj e is not a reticulation vertex we compute v jd x j e v w jd tw j e by definition of d tw j and because e x j e tw j d y e w j e by consistency of e w j d y e j e case 2 dxj e ri and e e i wi we compute v jd x j e i wi v j ri v w j ri v w j d tw j e i wi by definition of dtwj d y e w j e i wi by consistency of ew j d y e j e i wi case 3 dxj e ri and e 6 e i wi we compute v jd x j e v j ri v w j ri v w j e by eqn 2 v w jd tw j e by definition of d tw j d y e w j e by consistency of e w j d y e j e hence there exists a map x f x g in reeb note that since x x f is trivially partially ordered then w is trivially order preserving finally by definition we have ej y 1 hence is e edge labelling preserving therefore is a morphism in reebord e remark 4 10 by definition of tw each of the leaves of tw that have been created after the w cut is identified with an edge that is incident from above of a reticulation vertex but is not equal to e i wi for all i 1 m therefore the cardinality of the set of the leaves that are additional to the n leaves of x is exactly m i 1 di 1 which is equal to the first betti number b 1 s of x because of prop 3 2 hence each tree tw has n s leaves example 4 11 consider a reeb graph x x f with four leaves and one cycle and edges labelled by e 1 e 2 e 8 as shown in fig 2 by applying thm 4 7 we get two trees with 5 leaves in the tree decomposition of x for each of the trees the one additional leaf to the four leaves of x corresponds to one of the two edges e 5 and e 6 respectively thus there are exactly two such trees with 5 leaves example 4 12 consider a reeb graph x x f with a single reticulation vertex where in this particular example we also think of it as a leaf three edges and two cycles and edges labelled by e 1 e 2 e 3 as shown in fig 3 by applying thm 4 7 we get three trees with 4 leaves in the tree decomposition of x note that the trees are in one to one correspondece with all possibilities of isolating an edge which is identified with the reticulation vertex from the other edges given that they are incident from above some reticulation vertex thus there are exactly three such trees with 4 leaves 5 isomorphism complexity of reeb graphs thm 4 7 can help improve our understanding of the isomorphism complexity of reeb graphs under some fixed parameter here we will refer to isomorphism complexity simply by complexity 12 figure 2 an example describing the tree decomposition for n 4 and s 1 figure 3 an example describing the tree decomposition for n 1 and s 2 5 1 upper bound on the complexity let x x f be a reeb graph with edge sequence e let y y g any reeb graph checking whether y has same edge structure as x is equivalent to checking whether y has equivalent edge sequence with e this takes time o e where e is the cardinality of e now by euler s characteristic formula we have s e v 1 and so e v s 1 by definition if two reeb graphs x f y g are isomorphic then they have the same edge structure therefore complexity of reeb graphs complexity of reeb graphs of same edge structure o v s 13 by thm 4 7 two reeb graphs of same edge structure with n leaves and betti number b 1 x s are isomorphic if and only if they have the same tree decomposition to check for isomorphism it takes at worst as many number of steps as the cardinality of the set t x times the complexity of checking whether two ordered trees with n s leaves are isomorphic in reebord e where e is the edge structure of x namely complexity of reeb graphs of same edge structure complexity of ordered trees o t x now checking if two trees with n s leaves are isomorphic takes time o n s 5 by construction the cardinality of t x of a reeb graph x is equal to the product of indegrees of the reticulation vertices i e t x m i 1 di therefore we get complexity of reeb graphs o n s m i 1 di o v s now because l x v and l x n we get n v also since s 0 s 0 if x is a tree and v 2 we have the obvious bounds n s v s v 1 s thus complexity of reeb graphs o v 1 s m i 1 di o v 1 s o v 1 s m i 1 di 5 2 parametrized complexity although this is a good bound we would like to consider an upper bound on the isomorphism complexity that does not depend on the indegrees of reticulation vertices but only depends on the number of vertices v and the betti number b 1 x s since each of the indegrees of the reticulation nodes is di 1 we have the bound di 2 di 1 taking the product over all these inequalities and since m i 1 di 1 s we get complexity of reeb graphs with b 1 x s o v 1 s 2 s hence the reeb graph isomorphism problem is fixed parameter tractable when the parameter is the first betti number of the graph finally note that the bound di 2 di 1 is tight indeed if we consider reeb graphs with n leaves and b 1 x s such that the indegree of each of its reticulation vertices is 2 then the product of all the indegrees is exactly 2 s 6 phylogenetic networks viewed as ordered reeb graphs in computational phylogenetics a phylogenetic network is any rooted dag g that can be used to represent the evolutionary relationships among biological organisms e g genes often called taxa these taxa are represented by an ordering on the leaves of the rooted dag remark 6 1 quite often in practice the taxa are represented by the totaly ordered set 1 2 n however this is very restrictive for general phylogenetic networks namely one can have a phylogenetic network where some of its leaves are ordered in many different ways and some of them might not be labelled at all so it is better to consider a partial order on the leaves naturally one considers a pair of phylogenetic networks to be isomorphic if there is an isomorphism between their underlying dags that also preserves the order of their corresponding taxa 5 it is known from basic graph theory that checking if two trees with k leaves are isomorphic takes o k steps 14 6 1 time consistent phylogenetic networks in many applications phylogenetic networks are equipped with a time assignment on the nodes or vertices which we can think of as a height function f g r on the graph g the time assignment map f is often required to be time consistent which essentially means that the time stamp of any non root node should be strictly larger than the time stamp of its parent node see 25 pg 167 this is exactly what reeb graphs satisfy as we emphasized in ex 3 8 moreover if we restrict to ordered reeb graphs then these structures can be thought of as vertex weighted dags see sec 3 2 such that their edge sets and vertex sets are partially ordered in a compative way so we believe that ordered rooted reeb graphs whould serve as a natural mathematical model for time consistent phylogenetic networks by thinking of a time consistent phylogenetic network as an ordered reeb graph we can also consider its tree decomposition given by thm 4 7 since the phylogenetic network is rooted and has its leaves partially ordered by construction each of the trees tw yielded by the network s tree decomposition would have their leaves partially ordered therefore each tree tw is a phylogenetic tree 6 2 hausdorff distance among many distance metrics we can utilize the p cophenetic metrics dp for 1 p for comparing a pair of phylogenetic trees 9 29 lets focus on d for p the idea is that via the cophenetic map 34 any phylogenetic tree with n ordered leaves 1 n can be identified with a single point in the n n 1 2 dimensional euclidean space the i j th coordinate of the point where i j corresponds to the time stamp of the least common ancestor of the leaves i j in the phylogenetic tree 29 then we simply consider the norm for comparing a pair of phylogenetic trees with n ordered leaves by the tree decompostion of thm 4 7 we can thus identify any time consistent phylogenetic network with n ordered leaves and first betti number s as a finite subset of the the n s n s 1 2 dimensional euclidean space hence we can utilize the hausdorff distance for comparing a pair of phylogenetic networks definition 6 2 let x dx be any metric space and let a b be any subsets of x the hausdorff distance of a b is dh a b max max a a min b b dx a b max b b min a a dx a b example 6 3 consider the pair n 1 n 2 of time consistent phylogenetic networks as in fig 4 modelled as ordered reeb graphs and having the non trivial partial order on their leaves 1 2 figure 4 a pair of time consistent phylogenetic networks each having 2 leaves and 1 cycle also assume 0 a b c d and c b b a d c as in fig 4 it is easy to check that if we forget the non trivial order on the leaves of n 1 n 2 then these networks are isomorphic as ordinary reeb graphs however they are not order preserving isomorphic we do this by showing that the hausdorff distance with respect to d of the 15 figure 5 the additional leaf in each tree corresponds to an edge incident from above the reticulation vertex tree decompositions of n 1 n 2 is non zero let t n 1 t 1 t 2 and t n 2 t 3 t 4 be the tree decompositions 16 of n 1 and n 2 as in fig 5 we have d t 1 t 3 d b a c a c c a b d a c d c d t 1 t 4 d b a c a c c b a d a c d c d t 2 t 3 d a a c b c c a b d a c d c d t 2 t 4 d a a c b c c b a d a c d c since c b b a d c hence we obtain dh t n 1 t n 2 max max 1 i 2 min 3 j 4 d ti tj max 3 j 4 min 1 i 2 d ti tj d c 0 remark 6 4 assume a b are finite by definition the hausdorff distance between a b can be computed in at most a b many steps that means in particular that computing the hausdorff distance of a pair of phylogenetic networks with n leaves and first betti number s takes o v 2 1 s 24 s time namely computing the hausdorff distance is fixed parameter tractable when the parameter is the first betti number 7 concluding remarks in this manuscript we showed that reeb graphs are classified up to isomorphism by their tree decomposition we constructed upper bounds for their isomorphism complexity and showed that the isomorphism problem for reeb graphs is fixed parameter tractable when the parameter is the first betti number we proposed reebord as model for phylogenetic networks moreover we proposed the use of hausdorff distance as a metric for phylogenetic networks with n leaves and first betti number s we speculate that our results on one hand would further our understanding of both the structure and isomorphism complexity of reeb graphs and on the other hand they will enhance the existing methods on phylogenetic networks by providing new insights on how to do statistics and data analysis on these structures future work it is in the author s interests to apply properly the notion of hausdorff distance to define a metric on time consistent phylogenetic networks in order to do that some restrictions on the ordered reeb graphs phylogenetic networks may need to be considered in addition to requiring a fixed number of leaves and cycles e g we may need to assume in particular a total order on the leaves and reticulation vertices also a natural question to ask is whether there exist other tree decompositions for general ordered reeb graphs perhaps with fewer tree factors and how do they look like furthermore just like reeb graphs can be identified with nice enough cosheaves on r valued in the category set of all sets 16 it seems that ordered reeb graphs can be identified with constructible cosheaves f int pos on r valued in the category pos of all posets if this speculation is true then one can define a notion of interleaving distance for ordered reeb graphs in the sense of bubenik et al 8 and thus phylogenetic networks in particular the interleaving distance will thus be a metric on the collection of arbitrary phylogenetic networks i e not just the ones with fixed number of leaves and first betti number this would give an advantage for one to use the interleaving metric over the hausdorff distance as a metric for phylogenetic networks by rem 6 4 computing the hausdorff distance of a pair of phylogenetic networks is fixed paremeter tractable when the parameter is the first betti number but we do not know whether this is the case also for the interleaving distance in the near future the author wishes to work towards the sheaf theoretic aspects of ordered reeb graphs and their implications to phylogenetics e g defining an intelreaving metric for the comparison of arbitrary time consistent phylogenetic networks 8 conflict of interest statement the author states that there is no conflict of interest 17 references 1 jiri ad mek herrlich and h strecker ge abstract and concrete categories the joy of cats pure and applied mathematics a wiley interscience publication john wiley sons inc new york xiv 1990 2 pankaj k agarwal herbert edelsbrunner john harer and yusu wang extreme elevation on a 2 manifold discrete computational geometry 36 4 553 572 2006 3 ulrich bauer elizabeth munch and yusu wang strong equivalence of the interleaving and functional dis tortion metrics for reeb graphs in lars arge and j nos pach editors 31 st international symposium on computational geometry socg 2015 volume 34 of leibniz international proceedings in informatics lipics pages 461 475 dagstuhl germany 2015 schloss dagstuhl leibniz zentrum fuer informatik 4 silvia biasotti daniela giorgi michela spagnuolo and bianca falcidieno reeb graphs for shape analysis and applications theoretical computer science 392 1 3 5 22 2008 5 louis j billera susan p holmes and karen vogtmann geometry of the space of phylogenetic trees advances in applied mathematics 27 4 733 767 2001 6 h vard bakke bjerkevik and magnus bakke botnan computational complexity of the interleaving distance in bettina speckmann and csaba d t th editors 34 th international symposium on computational geom etry socg 2018 volume 99 of leibniz international proceedings in informatics lipics pages 13 1 13 15 dagstuhl germany 2018 schloss dagstuhl leibniz zentrum fuer informatik 7 adam bouland anuj dawar and eryk kopczy ski on tractable parameterizations of graph isomorphism in international symposium on parameterized and exact computation pages 218 230 springer 2012 8 peter bubenik vin de silva and jonathan scott metrics for generalized persistence modules foundations of computational mathematics 15 6 1501 1531 2015 9 gabriel cardona arnau mir francesc rossell lucia rotger and david s nchez cophenetic metrics for phylogenetic trees after sokal and rohlf bmc bioinformatics 14 1 3 2013 10 gabriel cardona francesc rossell and gabriel valiente extended newick it is time for a standard represen tation of phylogenetic networks bmc bioinformatics 9 1 532 2008 11 gunnar carlsson afra zomorodian anne collins and leonidas j guibas persistence barcodes for shapes international journal of shape modeling 11 02 149 187 2005 12 fr d ric chazal and jian sun gromov hausdorff approximation of metric spaces with linear structure arxiv preprint arxiv 1305 1172 2013 13 david cohen steiner herbert edelsbrunner and john harer extending persistence using poincar and lefschetz duality foundations of computational mathematics 9 1 79 103 2009 14 kree cole mclaughlin herbert edelsbrunner john harer vijay natarajan and valerio pascucci loops in reeb graphs of 2 manifolds discrete computational geometry 32 2 231 244 2004 15 william crawley boevey decomposition of pointwise finite dimensional persistence modules journal of algebra and its applications 14 05 1550066 2015 16 vin de silva elizabeth munch and amit patel categorified reeb graphs discrete computational geometry 55 4 854 906 2016 17 tamal k dey fengtao fan and yusu wang an efficient computation of handle and tunnel loops via reeb graphs acm transactions on graphics tog 32 4 32 2013 18 barbara di fabio and claudia landi the edit distance for reeb graphs of surfaces discrete computational geometry 55 2 423 461 2016 19 andreas dress the category of x nets in networks from biology to theory pages 3 22 springer 2007 20 herbert edelsbrunner john harer and amit k patel reeb spaces of piecewise linear mappings in symposium on computational geometry pages 242 250 2008 18 http arxiv org abs 1305 1172 21 francisco escolano edwin r hancock and silvia biasotti complexity fusion for indexing reeb digraphs in international conference on computer analysis of images and patterns pages 120 127 springer 2013 22 xiaoyin ge issam i safa mikhail belkin and yusu wang data skeletonization via reeb graphs in advances in neural information processing systems pages 837 845 2011 23 william harvey yusu wang and rephael wenger a randomized o m log m time algorithm for computing reeb graphs of arbitrary simplicial complexes in proceedings of the twenty sixth annual symposium on computational geometry pages 267 276 acm 2010 24 masaki hilaga yoshihisa shinagawa taku kohmura and tosiyasu l kunii topology matching for fully automatic similarity estimation of 3 d shapes in proceedings of the 28 th annual conference on computer graphics and interactive techniques pages 203 212 acm 2001 25 daniel h huson regula rupp and celine scornavacca phylogenetic networks concepts algorithms and appli cations cambridge university press 2010 26 daniel lokshtanov marcin pilipczuk micha pilipczuk and saket saurabh fixed parameter tractable canon ization and isomorphism test for graphs of bounded treewidth siam journal on computing 46 1 161 189 2017 27 saunders mac lane categories for the working mathematician volume 5 springer science business media 2013 28 dmitriy morozov kenes beketayev and gunther weber interleaving distance between merge trees discrete and computational geometry 49 22 45 52 2013 29 elizabeth munch and anastasios stefanou the cophenetic metric for phylogenetic trees as an interleaving distance arxiv preprint arxiv 1803 07609 2018 30 monica nicolau arnold j levine and gunnar carlsson topology based data analysis identifies a subgroup of breast cancers with a unique mutational profile and excellent survival proceedings of the national academy of sciences 108 17 7265 7270 2011 31 georges reeb sur les points singuliers d une forme de pfaff completement integrable ou d une fonction numerique on the singular points of a completely integrable pfaff form or of a numerical function comptes rendus acad sciences paris 222 847 849 1946 32 charles semple mike a steel richard a caplan mike steel et al phylogenetics volume 24 oxford university press on demand 2003 33 gurjeet singh facundo m moli and gunnar e carlsson topological methods for the analysis of high dimen sional data sets and 3 d object recognition in spbg pages 91 100 2007 34 robert r sokal and f james rohlf the comparison of dendrograms by objective methods taxon pages 33 40 1962 35 zo wood hugues hoppe mathieu desbrun and peter schr der removing excess topology from isosurfaces acm transactions on graphics tog 23 2 190 208 2004 36 koichi yamazaki hans l bodlaender babette de fluiter and dimitrios m thilikos isomorphism for graphs of bounded distance width in italian conference on algorithms and complexity pages 276 287 springer 1997 37 yuan yao jian sun xuhui huang gregory r bowman gurjeet singh michael lesnick leonidas j guibas vijay s pande and gunnar carlsson topological methods for exploring low density states in biomolecular folding pathways the journal of chemical physics 130 14 04 b 614 2009 19 http arxiv org abs 1803 07609 1 introduction 1 1 related work 1 2 our contribution 2 categorical structures 2 1 basic definitions 2 2 coproducts 3 combinatorial structures 3 1 reeb graphs 3 2 reeb graphs viewed as directed acyclic graphs 4 classifying reeb graphs up to isomorphism 4 1 ordered reeb graphs 4 2 ordered reeb graphs with a fixed edge structure 4 3 tree decomposition 5 isomorphism complexity of reeb graphs 5 1 upper bound on the complexity 5 2 parametrized complexity 6 phylogenetic networks viewed as ordered reeb graphs 6 1 time consistent phylogenetic networks 6 2 hausdorff distance 7 concluding remarks 8 conflict of interest statement