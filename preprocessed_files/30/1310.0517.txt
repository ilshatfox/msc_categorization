ar x iv 1 31 0 05 17 v 1 m at h p r 1 o ct 2 01 3 pathwise taylor expansions for random fields on multiple dimensional paths rainer buckdahn jin ma and jianfeng zhang abstract in this paper we establish the pathwise taylor expansions for random fields that are regular in the spirit of dupire s path derivatives 6 our result is motivated by but extends the recent result of buckdahn bulla ma 3 when translated into the language of pathwise calculus we show that with such a language the pathwise taylor expansion can be naturally carried out to any order and for any dimension and it coincides with the existing results when reduced to these special settings more importantly the expansion can be both forward and backward i e the temporal increments can be both positive and negative and the remainder is estimated in a pathwise manner this result will be the main building block for our new notion of viscosity solution to forward path dependent pdes corresponding to forward stochastic pdes in our accompanying paper 4 keywords path derivatives pathwise taylor expansion functional ito formula ito ventzell formula stochastic partial differential equations 2000 ams mathematics subject classification 60 h 07 15 30 35 r 60 34 f 05 de partement de mathe matiques universite de bretagne occidentale f 29285 brest cedex france and school of mathematics shandong university jinan 250100 p r china email rainer buckdahn univ brest fr department of mathematics university of southern california los angeles 90089 usa email jinma usc edu this author is supported in part by us nsf grant 1106853 department of mathematics university of southern california los angeles ca 90089 usa e mail jianfenz usc edu this author is supported in part by nsf grant 1008873 1 http arxiv org abs 1310 0517 v 1 1 introduction in this paper we are interested in establishing the pathwise taylor expansions for the ito type random field of the form u t x u 0 x t 0 s x ds t 0 s x dbs 1 1 where b is a d dimensional standard brownian motion defined on a complete probability space f p and means stratonovic integral in particular we are interested in such expansions for the solution to the following fully nonlinear stochastic partial differential equations spde u t x u 0 x t 0 f s x u xu xxu ds t 0 g s x u xu dbs 1 2 where f and g are random fields that have certain regularity in their spatial variables in our previous work 2 we studied the so called pathwise stochastic taylor expansion for a class of ito type random fields the main result can be briefly described as follows suppose that u is a random field of the form 1 1 and b is a one dimensional brownian motion if we denote f ft t 0 to be the natural filtration generated by b and augmented by all p null sets in f then under reasonable regularity assumptions on the integrands and the following stochastic taylor expansion holds for any stopping time and any f measurable square integrable random variable and for any sequence of random variables k k where k s are stopping times such that either k k or k k and k s are all f k measurable square integrable random variables converging to in l 2 it holds that u k k u a k b b k b p k 1 3 c 2 b k b 2 q k b k b 1 2 x k 2 o k k 2 where a b c p q x are all f measurable random variables and the remainder o k are such that o k k 0 as k in probability furthermore the six tuple a b c p q x can be determined explicitly in terms of and their derivatives in certain sense while the taylor expansion 1 3 reveals the possibility of estimating the remainder in a stronger form than mean square cf e g 13 it is not satisfactory for the study of pathwise property of the random fields which is essential in the study of e g stochastic viscosity solution in a subsequent paper buckdahn bulla ma 3 the result was extended to the case where the expansion could be made around any random time space point 2 where does not have to be a stopping time and more importantly the remainder was estimated in a pathwise manner in the spirit of the kolmogorov continuity criterion in other words modulo a p null set the estimate holds for each locally uniformly in t x furthermore all the coefficients can be calculated explicitly in terms of a certain kind of derivatives for ito type random field introduced in 3 see more detailed description in 8 of this paper it is noted however that a main drawback of the result in 3 is that the derivatives involved are not intuitive and are difficult to verify a more significant weakness of the result is that the dimension of the brownian motion is restricted to 1 which as we shall see in this paper reduced the complexity of the taylor expansion drastically the main purpose of this paper is to re investigate the taylor expansion in a much more general setting but with a different language in particular we shall allow both the spatial variable and the brownian motion to be multi dimensional and the random field is regular in a very different way to be more precise we shall introduce a new notion of path derivative in the spirit of dupire 6 to impose a different type of regularity that is the regularity on the variable such a language turns out to be very effective and many originally cumbersome expressions in stochastic analysis becomes intuitive and very easy to understand for example even without using the stratonovic integral the ito ventzell formula reads exactly like the multi dimensional ito formula and both integrands for the lebesgue integral and the stochastic integral can be memorized simply as chain rule with respect to time and path respectively for this reason we shall name it pathwise ito ventzell formula see section 4 below for details we should note however that our path derivative is much weaker than the original one by dupire see also 5 and applies to all semi martingales but on the other hand such a generality brings out some intrinsic rough path nature of the brownian motion among other things for example the hessian under the current path derivatives will be asymmetric in a general multi dimensional setting reflecting the nature of le vy area in the rough path theory cf e g 15 or 10 we would like to point out that the taylor expansion for stochastic processes especially for the solutions of stochastic differential equations is not new there is a large amount of literature on the subject from various perspectives we refer to the books of kloeden platten 13 from the numerical approximation point of view and of friz victoir 10 from the rough path point of view as well as the numerous references cited therein in fact all taylor expansions resemble each other in their forms language notwithstanding and the difference often lies in the error remainder estimates the main feature of our results is the following first our taylor expansion applies to general random fields and stochastic 3 processes and therefore does not depend on the special structure for being a solution to a differential equation whence non markovian in nature second unlike our previous work we shall provide a unified treatment of the taylor expansion up to any order and allowing the temporal increment to be both forward and backward finally and most importantly we pursue the pathwise estimate for the remainder that is the error of the expansion is estimated uniformly for all paths modulo a common null set the main difficulty compared to an l 2 estimate or in the sense of in probability that we often see in the literature is that one cannot use the isometry between the l 2 norms of stochastic integrals and the l 2 norms of the lesbesgue integrals thus it requires some novel treatments of multiple integrals the trade off for being able to do this however is that we require some new regularities of the random field with respect to the paths these requirements when unified under our new language of pathwise analysis are direct and easy to check to our best knowledge the pathwise taylor expansion in such a generality is new it is worth noting that our taylor expansion is the first step of our study of the viscosity solution to the forward path dependent pdes ppdes corresponding to the forward spde 1 2 which will be the main topic of our accompanying paper 4 we would only like to comment here that a classical solution in the traditional sense does not necessarily permit a pathwise taylor expansion therefore a somewhat convoluted treatment of the solution to the spdes will have to be carried out based on the pathwise taylor expansions as it was seen in the deterministic viscosity solution theory as well as the existing studies of stochastic viscosity solutions cf e g 2 the rest of the paper is organized as follows in section 2 we give all necessary notations and introduce the definition of path derivatives in section 3 we give a heuristic analysis for a simpler case the second order expansion for ito processes to illustrate the main points of our method in section 4 we prove the crucial estimates for the remainders of higher order taylor expansions in section 5 we extend the taylor expansion to ito random fields and in section 6 we weaken the regularity assumptions of the coefficients to ho lder spaces in section 7 we apply the taylor expansion to the solutions to stochastic pdes and finally in section 8 we compare the main theorem with our previous result 3 2 preliminaries throughout this paper we denote c 0 rd 0 0 to be the set of continuous paths starting from the origin b the canonical process on p 0 the wiener measure f ft t 0 the p 0 augmented filtration generated by b and 0 4 here and in the sequel we use 0 to denote vectors or matrices with appropriate dimensions whose components are all equal to 0 and for any dimension m we take the convention that rm rm 1 denotes the set of column vectors define x x m i 1 xix i for any x x rm tr t for any rm n and x 2 x x 2 here t denotes the transpose 2 1 path derivatives for ito processes let l 0 rm n denote the set of f progressively measurable processes u rm n and l 0 l 0 r strongly motivated by the functional ito formula initiated by dupire 6 see also cont and fournie 5 and a slight variation by ekren touzi zhang 8 in what follows we introduce the notion of path derivatives which will be the foundation of our pathwise stochastic analysis recall that u l 0 is a semimartingale if there exist a l 0 and l 0 rd such that ut u 0 at t 0 s dbs and v t 0 a t 0 s 2 ds t 0 p 0 a s 2 1 where v t 0 a is the total variation of a on 0 t definition 2 1 let u be a semimartingale in the form of 2 1 we define u 2 2 moreover if is a semimartingale and at t 0 sds for some l 0 then we define 2 u u and tu 1 2 tr 2 u 2 3 we remark that the path derivatives whenever they exist are unique in p 0 a s sense remark 2 2 functional ito formula when the path derivatives tu u 2 u exist we have tu 1 2 tr 2 u and u in other words the functional ito formula holds for t 0 ut u 0 t 0 tu 1 2 tr 2 u s ds t 0 u s dbs p 0 a s 2 4 in particular this implies that u is continuous in t equivalently since u is a semi martingale by using the stratonovich integral denoted by dbs one has ut u 0 t 0 tu s ds t 0 u s dbs t 0 p 0 a s 2 5 5 remark 2 3 i the main result in 6 and 5 is the functional ito formula 2 4 and in 8 the functional ito formula 2 4 is used to define the derivatives in this sense our definition is consistent with theirs ii in 6 and 5 one needs to extend the processes from to the space of ca dla g paths in 8 the definition is restricted to the space only but it still requires the processes and all the derivatives involved be continuous in our path derivatives do not require such regularity in particular our derivatives are defined only in p 0 a s sense in this aspect our definition is weaker and is convenient for our study of spdes in 4 as typically one cannot expect the solution of a spde to be continuous in iii in 6 5 and 8 the path derivative u is not required to be an ito process in this sense our definition is stronger this is mainly because our pathwise taylor expansion below requires stronger regularity than the functional ito formula iv when u t v t t with v c 1 2 0 rd by the standard ito formula we see that u t t xv t t if we assume further that xv c 1 2 0 rd then 2 u t 2 xxv t t and tu t tv t t so our path derivatives are consistent with the standard derivatives in markovian case however as pointed out in iii we need a slightly stronger regularity requirements remark 2 4 i in general the differential operators t and cannot commute moreover in the case d 1 the hessian matrix 2 u may not be symmetric which implies that in general i and j do not commute either see example 2 5 below ii when u t v t t 1 t tn t for some t 1 tn and some deterministic smooth function v then 2 u is symmetric and i and j commute iii under the conditions of 6 or 5 the hessian 2 u is always symmetric in fact being uniformly continuous in t the process u in 5 and 6 can be approximated by processes in the form of ii above iv in 8 the 2 u is by definition symmetric indeed the 2 u in 8 corresponds to 1 2 2 u 2 u t here however in this case the relation 2 u u may fail to hold which not only is somewhat unnatural but also makes the definition of higher order derivatives much more difficult our new definition modified this point we should also note that the process u in example 2 5 ii below is not continuous in t and thus is not in the framework of 5 6 or 8 example 2 5 i let d 1 and du btdt then u 0 tu bt it is clear that t u 0 6 1 tu 6 ii let d 2 and du b 2 t db 1 t then u b 2 0 t and thus 2 u 0 1 0 0 is not symmetric in particular 1 2 u 0 6 1 2 1 u we note that the path derivatives can be extended to any order in a natural way we now introduce some lp spaces that will be frequently used in the paper we begin by introducing the following norms on u l 0 u 0 p t u p t sup 0 t t e ut p 1 p 2 6 u 1 p t u p t d i 1 iu 0 p t 2 7 u n p t u p t tu n 2 p t d i 1 iu n 1 p t n 2 we then define the spaces h n p u l 0 u n p t t 0 n 0 2 8 we shall also define the following ho lder norms for any 0 1 u 0 p t u p t u p t e sup 0 t t 0 ut ut p p 2 1 p u 1 p t u p t d i 1 iu p t 2 9 u n p t u p t tu n 2 p t d i 1 iu n 1 p t n 2 then we define correspondingly h n p u h n u n p t t 0 n 0 2 10 it should be noted that h n 1 p is not a subspace of h n p however one can show that if p 0 is large enough more precisely p 2 1 then it holds that h n 2 p h n p for any n 0 see lemma 6 1 below 2 2 path derivatives for random fields let o rd be an open domain q 0 o and q we denote by l 0 rm n the set of f progressively measurable random fields u rm n and 7 l 0 l 0 r when there is no confusion we shall omit the variable in u and write it as u t x given u l 0 we define its derivatives in x in the standard way and for any fixed x its path derivatives in t in the sense of definition 2 1 notice that q is not compact for any n 1 denote kn x o x n d x oc 1 n and qn 0 n kn 2 11 it is clear that kn is compact increasing in n and n 1 kn o n 1 qn q and x h kn 1 for any x kn h 1 n n 1 2 12 similar to the process case we can define the norms for p 1 and n 2 u 0 p n u p n sup t 0 n e sup x kn u t x p 1 p u 1 p n u p n d i 1 xiu 0 p n d i 1 iu 0 p n u n p n u p n tu n 2 p n d i 1 xiu n 1 p n d i 1 iu n 1 p n u 0 p n u p n u p n sup x kn e sup 0 t t n u t x u t x p t t p 2 1 p 2 13 sup 0 t n e sup x x kn u t x u t x p x x p 1 p 0 1 u 1 p n u p n d i 1 xiu p n d i 1 iu p n u n p n u p n tu n 2 p n d i 1 xiu n 1 p n d i 1 iu n 1 p n we now define the following spaces for p 1 0 1 and n 0 h n p u l 0 u n p n n 0 h n p u h n p u n p n n 0 2 14 again as we shall see in lemma 6 1 one can show that h n 2 p h n p for any n 0 0 1 and p 21 2 15 8 2 3 ito random fields and ito ventzell formula we recall that u l 0 is called an ito random field if for any x o u t x u 0 x t 0 s x ds t 0 s x dbs t 0 p 0 a s 2 16 where l 0 l 0 rd satisfy t 0 s x s x 2 ds p 0 a s for all t x q it is worth noting that in contrast to remark 2 4 the spatial derivative x commutes with both t and in fact we have the following result since the proof is quite straight forward we omit it lemma 2 6 let u l 0 be an ito random field in the form of 2 16 i assume u 0 are differentiable in x and for any n 0 the processes x x and x x 2 are uniformly integrable on 0 n uniformly on x kn then xu exists and is also an ito random field for each i 1 d xiu t x xiu 0 x t 0 xi s x ds t 0 xi s x dbs t 0 p 0 a s in particular this implies that xu x u 2 17 ii assume further that is an ito random field and each of its components satisfies the property of u in i then 2 xu x 2 u and t xu x tu 2 18 as an important application of the path derivatives we recast the ito ventzell formula which turns out to be exactly the same as a multidimensional funtional ito formula proposition 2 7 ito ventzell formula let x h 2 2 taking values in o and u h 2 2 such that u c 0 2 q and u c 0 1 q for p 0 a e then the following chain rule for our path derivatives holds t u t xt tu xu txt u t xt u xt t xu 2 19 in particular if dxt btdt t dbt du t x t x dt t x dbt t 0 then the ito ventzell formula holds for t 0 p 0 a s du t xt tu xu txt dt u xt t xu dbt 2 20 xu bt 1 2 2 xxu t t t x t dt tt xu dbt 9 proof since x h 2 2 and u h 2 2 one can write dxt btdt t dbt and du t x t x dt t x dbt where bi tx i 1 2 tr 2 x i i x i i 1 d and tu 12 tr 2 u u next under our conditions we may apply the standard ito ventzell formula and obtain du t xt xu bt 12 2 xxu t t t x t t xt dt t t xu t xt dbt therefore the definition of path derivatives leads to that u t xt t t xu u t xt xt t xu t xt t u t xt xu bt 1 2 2 xxu t t t x t 1 2 tr u t xt 2 21 note that 2 u u differentiating u t xt again we have 2 u t xt u xt x u t d i 1 x i t xiu x i t xi u xixu x i t now plugging this into 2 21 and recalling the definition of x 2 x u 2 u with some simple computation we prove 2 19 whence 2 20 immediately remark 2 8 i if u is deterministic then u 0 and we have the ito formula ii as the chain rule 2 19 completely characterizes the expression 2 20 we may refer to it as pathwise ito ventzell formula 2 4 multiple differentiation and integration our taylor expansion will involve multiple differentiation and integration however due to the noncommutative property of the path derivatives in remark 2 4 and example 2 5 we need to specify the differentiation and integration indices precisely to simplify presentation we first introduce some notations for i 0 1 d define iu tu utdit utdt if i 0 iu iu utdit ut dbit if 1 i d 2 22 next for 1 1 2 n 0 1 d n and s t we define recursively by d u 1 d u i s t u i s t s urd 1 r i s t i s t 1 2 23 10 notice that the above definition also implies for n d u 1 nu d nu i s t u t s tn s t 2 s ut 1 d 1 t 1 d ntn t s i s r u d nr 2 24 moreover for the purpose of backward expansion later we introduce n 1 and i t s u 1 ni s t u for s t 2 25 noting the relation between the horizontal derivative tu and 2 u cf 2 3 we introduce the following weighted norm for 0 1 d n 0 n n n i 1 1 i 0 2 26 moreover when 0 we take the notational convention that d u u i s t u ut 2 27 due to the commutative property of lemma 2 6 the high order differentiation operator in x is simpler let n be the set of nonnegative integers for 1 d nd denote d xu 1 x 1 d xd u x d i 1 x i i d i 1 i d i 1 i 2 28 we shall set d xu u x 1 and 1 if 0 furthermore together with 2 26 we can introduce a weighted norm on the index set n 0 0 1 d n nd 2 29 note that if we denote n n then by applying lemma 2 6 one can easily check that if u h n 2 then all derivatives of u up to order n can be written as d xd u for some n counting t as a second order derivative 3 taylor expansion for ito processes second order case in this section we give some heuristic arguments for the simplest second order taylor expan sion for ito processes we shall establish both forward and backward temporal expansions in what follows we shall always denote for s t s t t s and we will use the following simple fact frequently for any semimartingales t t d t t t d t t t d t 3 1 11 3 1 forward temporal expansion let t 0 0 and denote t t repeatedly applying the functional ito formula 2 5 formally we have ut ut t t tusds d i 1 t t ius dbis ut d i 1 iutb i t t t t tusds d i 1 t t iu t s dbis ut d i 1 iutb i t t t t tusds d i 1 t t s t t iurdr d j 1 s t j iur dbjr dbis ut d i 1 iutb i t t tut d i j 1 j iut t t b j t s db i s t t tu t sds d i 1 t t s t t iurdr dbis d i j 1 t t s t j iu t r dbjr dbis here we used the fact that iut and j iut are ft measurable and can be moved out from the related stochastic integrals we note that this will not be the case when we consider backward temporal expansion later then ut ut d i 1 iutb i t t tut d i j 1 j iut t t b j t s db i s r 2 t 3 2 where r 2 t t t s t tturdrds d i j 1 t t s t r t t j iu d dbjr dbis 3 3 d i 1 t t s t itur dbirds d i 1 t t s t t iurdr dbis d i j k 1 t t s t r t k j iu dbk dbjr dbis to simplify the presentations let us make use of the notations for multiple derivatives and integrations defined in 2 22 2 24 then it is straightforward to check that 3 2 and 12 3 3 can be rewritten as a more compact form ut ut d i 0 d i uti i t t d i j 1 d j i uti j i t t r 2 t 3 4 r 2 t i 0 0 t t d 0 0 u d i j 1 i 0 j i t t d 0 j i u 3 5 d i 1 i i 0 t t d i 0 u d i 1 i 0 i t t d 0 i u d i j k 1 i k j i t t d k j i u 3 2 backward temporal expansion let 0 t and denote t t then similar to the forward expansion we can obtain u t ut t t tusds d i 1 t t u i s dbis 3 6 ut tut t t tu t s ds d i 1 iut bi t t t t iu t s dbis we should note that the above expansion would be around t instead of t we therefore modify it as follows first we write tut tut tu t t iut bi t t iutb i t t iu t t bi t t 3 7 next we apply integration by parts formula and or standard ito formula to get tu t t t t tu t s ds t t s t d tus t t ttus s t ds d i 1 t t itus s t db i s iu t t bi t t t t iu t s dbis 3 8 t t bi t s d ius t t bi t s t iusds d j 1 j ius dbjs t t t iusb i t s ds d j 1 t t j iusb i t s dbjs t t t iusb i t s ds d j 1 j iut t t bi t s dbjs d j 1 j i t t t t bi t s dbjs d j 1 t t j iu t s bi t s dbjs 13 and j iu t t t t bi t s dbjs t t j iu t s bi t s dbjs 3 9 t t s t bi t r dbjr d j ius t t t j ius s t bi t r dbjr ds d k 1 t t k j ius s t bi t r dbjr dbks plugging 3 9 into 3 8 and then plugging 3 7 3 8 into 3 6 we obtain u t ut d i 1 iutb i t t tut d i j 1 j iut t t bi t s dbjs r 2 t 3 10 where r 2 t t t ttus s t ds d i j 1 t t t j ius s t bi t r dbjr ds d i 1 t t t iusb i t s ds d i 1 t t itus s t db i s 3 11 d i j k 1 t t k j ius s t bi t r dbjr dbks using the notations for multiple derivatives and integrations again we see that 3 10 and 3 11 can again be written as the compact form u t ut d i 0 d i uti i t t d i j 1 d j i uti i j t t r 2 t 3 12 where r 2 t i 0 t t d 0 0 u i 0 t d i j 1 i 0 t t d 0 j i u i i j t d i 1 i 0 t t d 0 i u i i t d i 1 i i t t d i 0 u i 0 t d i j k 1 i k t t d k j i u i i j t 3 13 we should point out here that 3 12 is slightly different from 3 4 but by applying the relation 2 25 we can rewrite 3 12 as u t ut d i 0 d i uti i t t d i j 1 d j i uti j i t t r 2 t 3 14 we see that 3 14 is indeed consistent with the forward expansion 3 4 14 remark 3 1 i if we define for s t bs t t s bis r dbjr 1 i j d as t bs t bs t t 3 15 then we can write ut ut tut ut bt t 2 ut bt t r 2 t u t ut tut ut bt t 2 ut bt t r 2 t 3 16 it is worth noting that bs t and as t are essentially the step 2 signature and the le vy area respectively in rough path theory cf e g 10 ii note that t s bis r dbjr t s bjs r dbir bis tb j s t or equivalently bs t bs t t bs tb t s t then 3 16 becomes ut ut tut ut bt t 1 2 2 ut bt t b t t t 1 2 2 ut at t r 2 t u t ut tut ut bt t 1 2 2 ut bt t bt t t 1 2 2 ut at t r 2 t 3 17 clearly if 2 u is symmetric in particular when u t v t t for some deterministic smooth function v we have 2 ut at t 2 ut at t 0 and thus ut ut tut ut bt t 1 2 2 ut bt t b t t t r 2 t u t ut tut ut bt t 1 2 2 ut bt t bt t t r 2 t 3 18 this is exactly the standard taylor expansion we shall emphasize though in general 2 u is not symmetric see example 2 5 ii thus the taylor expansion 3 17 should have a correction term 1 2 2 u a remark 3 2 by bichteler 1 or karandikar 12 one may interpret utdb i t in a pathwise manner whenever u is continuous in t in particular bs t and as t can be understood pathwisely as we pointed out in the introduction the main results of this paper are the pathwise remainder estimates since the proof of the second order estimate is similar to that of the inductional argument for the m th order estimate we shall prove a general result directly 15 4 taylor expansion for ito processes general case we now consider the general form of pathwise taylor expansion up to any order m denote for 0 t 1 t 2 and 0 d t 0 r 0 t 0 d t 1 t 2 t d t 1 t t 2 4 1 for any m 0 and u h m 2 in light of 3 4 and 3 14 we shall define the m th order remainder by for any t d and u t m d u t i t t rm u t 4 2 we emphasize that can be negative here and the right side of 4 2 is pathwise in light of remark 3 2 moreover when there is no confusion we shall always omit the variable the main result of this section is the following pathwise estimate for the remainder rm theorem 4 1 assume that u h m 2 p 0 for some m 0 and p 0 2 then for any 0 1 2 p 0 and p p 0 it holds that for any t 0 e sup t d 1 0 t rm u t m 2 p 4 3 to prove theorem 4 1 we need the following crucial estimate since its proof is quite lengthy we shall complete its proof after we prove theorem 4 1 proposition 4 2 assume that u h m 2 p 0 for some m 0 and p 0 2 then for any p p 0 t 0 0 and 0 it holds that e sup t d t 0 t 0 rm u t p c p m 1 2 4 4 where c may depend on u m 2 p 0 t for some t t 0 2 proof of theorem 4 1 in what follows we shall fix t and allow the generic constant c 0 to depend on u m 2 p 0 t 1 clearly it suffices to prove 4 3 for large p and we thus assume without loss of generality that 2 1 p p 0 for any 0 1 set ti i i 0 t 1 then by proposition 4 2 we have e sup t d 0 t rm u t p t i 0 e sup t d ti ti rm u t p c p m 1 2 1 16 consequently since 0 1 2 p 0 2 1 p p 0 it holds that e sup t d 1 0 t rm u t m 2 p n 0 e sup t d 1 0 t 2 n 1 2 n rm u t m 2 p n 0 2 p m n 1 2 e sup t d 2 n 0 t rm u t p c n 0 2 p m n 1 2 2 n p m 1 2 1 c 2 p m 2 n 0 2 n 2 p 1 2 completing the proof remark 4 3 i the estimate 4 3 amounts to saying that for each m 0 t 0 there exist a set m with p m 1 and a nonnegative random variable cm t such that rm u t cm t m 2 m t d 1 0 t in theorem 5 2 below this pathwise estimate also holds true locally uniformly in the spatial variable x ii we should point out that in 4 2 0 is allowed that is the temporal expansion can be backward such an expansion along with the pathwise estimates is crucial for the study of viscosity solutions of spdes in 4 in our previous works 2 3 these results were also obtained in the case m 2 d 1 but the present treatment is more direct and the conditions are easier to verify see 8 for a detailed comparison with the result in 3 iii there have been many works on stochastic taylor expansions see e g the books of 10 and 13 and the references cited therein we also note that in a recent work 14 the dupire type path derivatives were also used the main difference between the existing results and ours however lies in that in these works the remainder rm is estimated in l 2 sense or in probability which is not desirable for our study of viscosity solutions moreover no backward expansion was considered in these works in the rest of this section we prove the key estimate 4 4 in proposition 4 2 to simplify the presentation we split the proof into several lemmas that are interesting in their own rights we begin by establishing a representation formula for rm extending 3 5 and 3 13 in what follows we denote t t and t t for 0 lemma 4 4 let u h m 2 2 for some m 0 then for any 0 it holds that rm u t m 1 i t t d u m i t t t td usds 4 5 17 furthermore denoting 1 then for t one has rm u t m 1 1 0 t t d us i t s d 1 s m 1 0 t t td us i t s ds 4 6 proof i we first verify 4 5 by induction for m 0 we recall the notational convention 2 27 then it is readily seen that the right side of 4 5 reads 1 t t d usd s t t tusds d i 1 t t ius dbis t t tusds thus the equality follows immediately from the functional ito formula 2 5 now assume 4 5 holds for m then rm 1 u t rm u t m 1 d uti t t m 1 i t t d u m i t t t td usds m 1 d uti t t m 1 i t t d u t m i t t t td usds applying the functional ito formula 2 5 on d us we obtain rm 1 u t m 1 i t t t td usds d i 1 t id us dbis m i t t t td usds m 1 i t t t td usds m 1 d i 1 i t t t id us dbis m i t t t td usds one may check directly that the last line above is exactly equal to m 2 i t t d u namely 4 5 holds for m 1 thus 4 5 holds for all m ii we now prove 4 6 again by induction for m 0 the argument is similar to i assume now 4 6 holds for m then rm 1 u t rm u t m 1 1 0 d ut i t t m 1 1 0 t t d us i t s d 1 s m 1 0 t t td us i t s ds m 1 1 0 d ut t t i t s d 1 s 18 applying integration by parts formula we have d ut t t i t s d 1 s t t d us i t s d 1 s t t i t s d d us t t i t s td usds d i 1 id us dbis consequently we obtain rm 1 u t m 1 1 0 t t td us i t s ds m 1 1 0 t t i t s d us dbs m 1 0 t t td us i t s ds one may now check directly that the last line above is exactly equal to denoting 1 m 2 1 0 t t d us i t s d 1 s thus 4 6 holds for m 1 proving ii whence the lemma to simplify notation in what follows we denote for any semi martingale and any p 1 0 t 1 t 2 i p t 1 t 2 e t 2 t 1 s 2 ds p 2 t 2 t 1 s ds p 1 p 4 7 it is clear that i is increasing in p and ip p t 1 t 2 sup t 1 t t 2 e t p t 2 t 1 p 2 sup t 1 t t 2 e t p t 2 t 1 p 4 8 in light of the above representations the following estimate is crucial lemma 4 5 let t 0 0 0 1 q p 1 and be a semimartingale then for any 1 there exists constant c cp q 0 such that e sup 0 sup t 0 t t 0 i t t p c p 1 2 ip q t 0 t 0 2 4 9 proof let a p denote the left side of 4 9 and i p i p t 0 t 0 2 without loss of generality we may assume i q we proceed by induction on n 0 i first assume n 1 namely 1 we estimate a p in two cases case 1 2 namely 1 0 then i t t t t sds and thus a p e t 0 2 t 0 s ds p c p 2 i p p c p 2 i q p 19 case 2 1 namely 1 i for some i 1 d then i t t t t 0 t t 0 s dbis 1 2 t t i sds and thus a p ce sup t 0 t t 0 2 t t 0 sdb i s p ce t 0 2 t 0 i s ds p which together with the burkholder davis gundy inequality implies 4 9 immediately ii we next prove 4 9 by induction assume it holds true for n and we now assume 0 n 1 denote 1 s s t 0 rd 1 r and q p q 2 notice that 0 n and i 1 p 2 for any p then we may use the induction assumption and obtain a p e sup 0 sup t 0 t t 0 i t t ti t t 1 p ca p c a 1 q p q a 1 2 pq q p q p 2 q c p 1 2 i q p c p 1 1 2 i q p p 1 2 i 1 3 pq q p p c p 1 2 i q p c p 1 2 i q p then clearly 4 9 with 0 n 1 follows from the following claim i q c 1 2 i q 4 10 we again proceed in two cases case 1 1 2 namely 1 0 then s s t 0 rdr and j s 0 thus i q q e t 0 2 t 0 s t 0 rdr 2 ds q 2 q 2 e t 0 2 t 0 r dr q q i q q case 2 1 1 namely 1 i for some i 1 d then s s t 0 r dbir s t 0 rdb i r 1 2 s t 0 i rdr j s s 1 j i and thus i q q ce t 0 2 t 0 s t 0 rdb i r 2 s t 0 i rdr 2 ds q 2 t 0 2 t 0 s ds q c q 2 e sup t 0 s t 0 2 s t 0 rdb i r q t 0 2 t 0 i r dr q t 0 2 t 0 s 2 ds q 2 20 then 4 10 follows immediately from the burkholder davis gundy inequality we are now ready to prove proposition 4 2 proof of proposition 4 2 first by 4 5 we have for 0 rm u t m 1 i t t d u m i t t t 0 td usds i t t 1 t t 0 td usds denote d t 0 t 0 t t 0 and note that t t 0 td usds 0 then combine lemma 4 5 and 4 8 and recall t t 0 2 we have e sup t d rm u t p 4 11 c m 1 e sup t d i t t d u p c m e sup t d i t t t 0 td usds p c m e t 0 2 t 0 td us ds p 0 p p 0 e sup t d i t t 1 pp 0 p 0 p p 0 p p 0 c m 1 d u p p t p m 1 2 d u p p t p m 2 2 c pm 2 m sup t 0 t t 0 2 e t t 0 td usds p c m td u p p 0 t p pm 2 c m 1 d u p p 0 t p m 1 2 d u p p 0 t p m 2 2 c m td u p p 0 t p m 2 2 td u p p 0 t p m 1 2 c u m 2 p 0 t p m 1 2 next for 1 1 2 n applying the integration by parts formula and recalling 2 24 and 2 25 we have for d u t t si t s d 1 s t t sd 1 s i t t t t s t rd 1 r di t s i 1 t t i n 2 t t 1 t t i 1 t s i n 3 t s d 2 s repeating the above arguments we obtain t t si t s d 1 s n i 1 1 i 1 i 1 i t t i n i 1 t t 1 4 12 21 then by changing variable t to t and denoting q p p 0 2 we have e sup 0 sup t 0 t t 0 t t d usi t s d 1 s p 4 13 c n i 1 e sup 0 sup t 0 t t 0 i 1 i t t d u i n i 1 t t 1 p c n i 1 e sup 0 sup t 0 t t 0 i 1 i t t d u q p q e sup 0 sup t 0 t t 0 i n i 1 t t 1 2 pq p 0 p p 0 p 2 q c n i 1 p 1 i 1 2 ip d u p 0 t 0 t 0 2 p n i 1 2 c p 1 2 ip d u p 0 t 0 t 0 2 thanks to lemma 4 5 now following similar arguments as in 4 11 one may easily derive from 4 6 that e sup 0 sup t 0 t t 0 rm u t p c u m 2 p 0 t p m 1 2 4 14 finally note that sup t d t 0 t 0 rm u t sup 0 sup t 0 t t 0 rm u t sup 0 sup t 0 t t 0 rm u t combining 4 11 and 4 14 we obtain 4 4 5 pathwise taylor expansion for random fields in this section we extend our results to ito random fields again denote t t and we emphasize that could be negative let us denote d t x h 0 o r rd t x h q d n t x h t x qn h 2 1 n n 1 t 0 5 1 we remark that t x h qn 1 for any t x h d n furthermore for any m 0 and u h m 2 in light of 4 2 and noting that the spatial derivative x commutes with all the path derivatives we shall define the m th order taylor expansion by u t x h m 1 d xd u t x h i t t rm u t x h 5 2 22 for any t x h d and clearly if 0 then we recover the standard taylor expansion in x and if h 0 then we recover the taylor expansion 4 2 for ito processes moreover if m 2 then we have u t x h u tu xu h u bt t 1 2 2 xxu hh t 5 3 x u h bt t t 2 u bt t t x r 2 u t x h again we begin with the following simple recursive relations for the remainders lemma 5 1 let u h m 1 for some m 1 then rm u t x h rm u t x 0 d i 1 hi 1 0 rm 1 xiu t x h i d 5 4 where hi h 1 hi 1 hi 0 0 proof given t x h d we write u t x h u t x e 0 d i 1 ei 5 5 where e 0 u t x u t x and ei u t x hi 1 u t x hi 0 note that by applying the temporal expansion we have e 0 1 m d u t x i t t rm u t x 0 1 m 0 1 d xd u t x h i t t rm u t x 0 5 6 on the other hand for i 1 d using the taylor expansion for xu we can write ei hi 1 0 xiu t x h i d hi 1 0 m 1 1 d xd xiu t x hi i t t rm 1 xiu t x h i d m 1 i 1 d 0 h 11 h i 1 i 1 h i 1 i 1 i 1 i 1 xid xd u t x i t t hi 1 0 rm 1 xiu t x h i d m i 1 i 1 d 0 h d xd u t x i t t hi 1 0 rm 1 xiu t x h i d 23 where we replaced 1 i 0 0 with 1 i 1 i 1 0 0 then d i 1 ei m 1 h d xd u t x i t t d i 1 hi 1 0 rm 1 xiu t x h i d this together with 5 5 and 5 6 implies that u t x h u t x 1 m h d xd u t x i t t rm u t x 0 d i 1 hi 1 0 rm 1 xiu t x h i d now 5 4 follows immediately from 5 2 our main result of this section is the following pathwise estimate for the remainders extending theorem 4 1 theorem 5 2 assume u h m 2 p 0 for some m 0 and p 0 p m 1 d 2 then for any p p 0 and 0 1 p p 0 it holds that for any n 0 e sup t x h d n rm u t x h h 2 m 2 p 5 7 proof we fix n and let 0 1 4 n 2 n 1 2 then for any t x qn recall 2 11 and h we have t x h qn 1 and t 2 x h qn 1 in what follows our generic constant c will depend on u m 2 p 0 n 1 denote for t 0 x 0 qn and n 0 d n t 0 x 0 t x h h 2 t 0 t t 0 t 0 x x 0 n 1 2 5 8 we split the proof into the following steps i we first show that for any t 0 x 0 qn and p p 0 e sup t x h d 0 t 0 x 0 r 0 u t x h p c p 2 5 9 indeed note that r 0 u t x h u t x h u t x r 0 1 r 0 2 where r 0 1 u t x h u t x 0 u t x 0 u t x and r 0 2 u t x 0 u t x 0 note that r 0 2 is for fixed x 0 applying proposition 4 2 we get e sup t x h d 0 t 0 x 0 r 0 2 p c p 2 5 10 24 moreover note that r 0 1 x x 0 h 1 0 xu t x 0 x x 0 h d x x 0 1 0 xu t x 0 x x 0 d and x 0 x x 0 x 0 x x 0 h kn 1 thanks to 2 12 then since xu h m 1 p 0 h 0 p 0 and p p 0 we have e sup t x h d 0 t 0 x 0 r 0 1 p c p 2 this together with 5 10 proves 5 9 ii we next show by induction on m that for any m 0 any t 0 x 0 dn and p p 0 e sup t x h d m t 0 x 0 rm u t x h p c p m 1 2 5 11 indeed by 5 9 we have 5 11 for m 0 assume 5 11 holds true for m 1 applying lemma 5 1 we have e sup t x h d m t 0 x 0 rm u t x h p ce sup t x h d m t 0 x 0 rm u t x 0 p c p 2 d i 1 1 0 e sup t x h d m t 0 x 0 rm 1 xiu t x h i p d note that xiu h m 1 p 0 and t x h i d m t 0 x 0 d m 1 t 0 x 0 then by induction assumption we have e sup t x h d m t 0 x 0 rm 1 xiu t x h i p c pm 2 so it suffices to prove e sup t x h d m t 0 x 0 rm u t x 0 p c p m 1 2 5 12 to this end we note that rm u t x 0 rm u t x 0 rm u t x 0 0 rm u t x 0 0 5 13 applying proposition 4 2 again we have e sup t x h d m t 0 x 0 rm u t x 0 0 p c p m 1 2 5 14 25 on the other hand recall that rm u t x 0 u t x md u t x i t t then rm u t x 0 rm u t x 0 0 x x 0 1 0 xu t x 0 x x 0 m xd u t x 0 x x 0 i t t d notice that xu xd h 1 p 0 for m and x x 0 m 1 2 for t x h d m t 0 x 0 then by lemma 4 5 e sup t x h d m t 0 x 0 rm u t x 0 rm u t x 0 0 p c p m 1 2 plugging this and 5 11 into 5 13 we obtain 5 12 which in turn implies 5 11 iii we now claim that e sup t x h d n h 2 rm u t x h p c p d m 1 2 1 5 15 indeed set ti i i 0 n 1 and let xj kn j 1 2 n m 1 2 d 1 be discrete grids such that the union of their m 1 2 neighborhood covers kn then we have t x h d n h 2 i j d m ti xj thus by 5 11 e sup t x h d n h 2 rm u t x h p i j e sup t x h d m ti xj rm u t x h p c i j p m 1 2 c 1 d m 1 2 p m 1 2 c p d m 1 2 1 iv finally without loss of generality we may assume p 1 p p 0 by 5 15 we have e sup t x h d n rm u t x h h 2 m 2 p e sup n 0 sup 2 n 1 h 2 2 n sup t x h d n rm u t x h h 2 m 2 p n 0 e sup 2 n 1 h 2 2 n sup t x h d n rm u t x h h 2 m 2 p n 0 2 p m n 1 2 e sup h 2 2 n sup t x h d n rm u t x h p c n 0 2 p m n 1 2 2 n p d m 1 2 1 c 2 p m 2 n 0 2 n 2 p 1 p completing the proof 26 6 extension to ho lder continuous case in this section we weaken the requirement u h m 2 p 0 in theorem 4 1 slightly by replacing the highest order differentiability with a certain ho lder continuity first recall the space h n p defined in 2 14 we shall now prove 2 15 lemma 6 1 let 0 1 and p 2 1 then h n 2 p h n p for any n 0 proof without loss of generality we shall only prove the case that n 0 let u h 2 p first for any 0 t 0 t and 0 1 applying functional ito formula 2 4 and then lemma 4 5 we have e sup 0 sup t 0 t t 0 ut ut p c p 2 then the lemma follows exactly the same arguments as in the proof of theorem 4 1 in what follows we shall assume u h m 1 p 0 h m 0 p 0 for some appropriate m p 0 and 0 note that in this case rm is still well defined by 4 2 however we cannot use the representations 4 5 and 4 6 anymore because of their involvement of the m 2 th order derivatives in order to estimate rm in this case we first establish the following recursive represen tation recall that s t t s lemma 6 2 let u h m 1 2 for some m 1 then for any 0 it holds that rm u t m 2 i 6 0 t t rm 2 td u t s t i s t ds 6 1 m 1 i 6 0 t t td usi s t ds m i 6 0 i t t d u t rm u t m 1 0 rm d u t i t t t 6 2 proof i we first prove 6 1 we claim that for m 2 rm u t t t rm 2 tu t s t ds d i 1 t t rm 1 iu t s t dbis 6 3 indeed denote by r m u t the right side above and notice the simple fact m 2 d tut t t i t sds m 1 d iut d i 1 t t i t s dbis 1 m d uti t t 6 4 27 applying the functional ito formula 2 5 and by 4 2 we have ut ut t t tusds d i 1 t t ius dbis ut t t m 2 d tuti t s rm 2 tu t s t ds d i 1 t t m 1 d iuti t s rm 1 iu t s t dbis ut m 2 d tut t t i t sds m 1 d iut d i 1 t t i t s dbis r m u t then 6 3 follows immediately from 6 4 and 4 2 we now prove 6 1 when m 1 the right side of 6 1 becomes t t tusds d i 1 t t iu t s dbis t t tusds d i 1 t t ius dbis d i 1 iutb i t t ut ut d i 1 iutb i t t r 1 u t for m 2 applying 6 3 repeatedly on the stochastic integral terms in 6 3 we obtain rm u t m 2 i 6 0 i t t t rm 2 td u t s t ds 6 5 m 1 i 6 0 i t t r 1 d u t t applying stochastic fubini theorem repeatedly we have i t t t rm 2 td u t s t ds t t rm 2 td u t s t i s t ds moreover note that d u h 2 2 for m 1 then r 1 d u t s t d u t s d j 1 jd utb j t s s t td urdr d j 1 s t jd ur dbjr d j 1 jd utb j t s s t td urdr d j 1 s t jd u t r dbjr 28 thus 6 5 leads to rm u t m 2 i 6 0 t t rm 2 td u t s t i s t ds m 1 i 6 0 i t t t td urdr d j 1 t jd u t r dbjr which together with stochastic fubini theorem again implies 6 1 immediately ii we next prove 6 2 by applying 4 2 twice we have rm u t ut m 1 0 d uti t t u t m 1 0 m d d ut i t t rm d u t i t t we now define m rm u t m 1 0 rm d u t i t t 6 6 u t m 1 0 m d d ut i t t i t t denote 1 n then one can check that m 1 m 1 0 1 d ut a where a n i 0 1 ii 1 i t t i n i 1 t t by setting 1 in 4 12 we see that a 0 for all 1 m then m 0 and we complete the proof with the above representations we can now extend theorem 4 1 theorem 6 3 assume that u h m 1 p 0 h m 0 p 0 for some m 0 0 0 1 and p 0 2 0 the for any p p 0 and 0 0 2 p 0 it holds that for any t 0 e sup t d 1 0 t rm u t m 2 p 6 7 proof applying the representations 6 1 and 6 2 one can easily prove by induction on m that e sup 0 sup t 0 t t 0 rm u t p sup 0 sup t 0 t t 0 rm u t p c p m 0 2 6 8 29 extending 4 4 the result then follows from very similar arguments as those in 4 we leave the details to interested reader along the similar lines of arguments we can also weaken the assumptions of theorem 5 2 the case for random field to the ho lder conditions since the proof is a routine combination of the previous results we omit it theorem 6 4 assume that u h m 1 p 0 h m 0 p 0 for some m 0 0 0 1 and p 0 p 1 0 m 0 d 2 then for any p p 0 and 0 0 1 p p 0 5 7 holds for any n 0 7 application to forward stochastic pdes one of the main purposes of our study on the pathwise taylor expansion is to lay the foundation for the notion of pathwise viscosity solution for stochastic pdes and the associated forward path dependent pdes which will be articulated in our accompanying paper 4 more precisely we are particularly interested in the case when the random field u is a classical solution in standard sense of the following spde du t x f t x u xu 2 xu dt g t x u xu dbt t 0 p 0 a s 7 1 where f t x y z and g t x y z are f progressively measurable and taking values in r and rd respectively with the variable omitted as usual clearly the spde 7 1 can be rewritten as the following system of forward path dependent pde ppde tu f t x u xu 2 xxu 0 u t x g t x u xu 7 2 we will be particularly interested in the version of theorem 5 2 applyied to the solutions of 7 1 or equivalently 7 2 in the case m 2 to this end we first assume that u is a solution of spde 7 1 that is smooth enough in our sense we shall also assume that g is sufficiently smooth it is then clear that u t x g t x u t x xu t x 7 3 differentiating both sides above in x we get suppressing variables and noting that g g 1 gd t for i 1 d and j 1 d 2 xi ju xi gj t x u xu xigj ygj xiu d k 1 zkgj 2 xixk u 7 4 30 or in matrix form 2 x u xi ju 1 i d 1 j d xg xu yg t 2 xxu zg rd d 7 5 similarly we can easily derive 2 u g u yg t 2 x u t zg 7 6 g g yg t xg xu yg t 2 xxu zg t zg in light of 5 2 withm 2 we can now formally write down the pathwise taylor expansion u t x h u t x 1 2 1 d xd u t x h i t t r u t x h f t x u xu 2 xxu xu h g tt 1 2 2 xxu hh t xg xu yg t 2 xxu zg h bt t t 7 7 g g yg t xg xu yg t 2 xxu zg t zg bt t r u t x h for any t x h d where the right hand side above is evaluated at t x and bt t is defined by 3 15 applying theorem 5 2 we then obtain the following result theorem 7 1 assume that spde 7 1 has a solution u h 4 p 0 for some p 0 p 3 d 2 and that the coefficient g is regular enough so that all the derivatives in 7 6 are well defined let r u t x h be determined 7 7 then for any p p 0 and 0 1 p p 0 the remainder r satisfies 5 7 with m 2 remark 7 2 the spde 7 1 can be written as the following ito form du t x f t x u xu 2 xu dt g t x u xu dbt t 0 p 0 a s 7 8 where f t x y z f 1 2 tr g g yg t xg z yg t zg t zg it is thus natural to define the parabolicity of the ppde 7 2 as f f 1 2 zg zg t 0 7 9 clearly this is exactly the coercivity condition in the spde literature see e g rozovskii 19 and ma yong 17 in linear cases 31 we should note that the requirement u h 4 p 0 in theorem 7 1 is much stronger than u being a classical solution due to the involvement of path derivatives in the rest of this section we shall establish the connection between the two concepts to begin with let us recall some sobolev spaces for any m 0 and p 1 wmp u l 0 u wmp n n 0 w m p 1 wmp 7 10 where u pwmp n sup 0 t t me kn d xu t x pdx next we extend the spatial derivatives slightly to those involving x y z to this end recall the multi index set and the norm on defined by 2 29 we define d x y z d xd y z d and d x y z d xd y z d 7 11 where by a slight abuse of notation n 1 d and n 1 d d d respectively and t x y z is any random field such that these derivatives exist moreover we define and in an obvious way we now state the main result of this section proposition 7 3 let m 1 p d and denote pm p 1 m m 1 2 assume that i for any m 1 d x y z g exists for all m and is uniformly bounded when 1 moreover d xd g is uniformly lipschitz continuous in y z and d xd g 0 0 w 0 pm for m ii for any m 2 d x y z f exists for all m 1 and is uniformly bounded when 1 moreover d xd f is uniformly lipschitz continuous in y z and d xd f 0 0 0 w 0 pm for m 1 let u wm 1 pm be a classical solution in the standard sense with differentiability in x only to spde 7 1 then u h m p to prove proposition 7 3 we need a technical lemma that would transform all path derivatives to the x derivatives let us first introduce some notations for any random fields t x y z and u u t x we define suppressing variables t x t x u xu xxu 7 12 next for a given we define with n 1 d n 1 d d d a 1 a 1 a 2 a 2 1 1 7 13 a 3 a 3 2 2 32 let us now consider the random fields of the following form a 1 d xu a 1 a 2 d x y z g a 2 a 3 d x y z f a 3 7 14 where a 1 a 3 n and a 2 nd we note that by definition the derivatives in 7 11 have the same dimension as the function in particular since g is rd valued the meaning of d g a a nd in 7 14 should be understood as that of x defined in 2 28 moreover for each such we define its index by a 1 a 1 a 2 0 a 2 a 3 0 a 3 7 15 we remark that in the above we do not include the exponents when 0 or 0 since the y z derivatives are assumed to be bounded in proposition 7 3 the following lemma will be crucial to the proof of proposition 7 3 since its proof is rather lengthy we defer it to the end of the section in order not to disturb our discussion lemma 7 4 assume f and g are smooth enough with respect to all variables t x y z and u is a classical solution in standard sense to spde 7 1 with sufficient regularity in x then for any d xd u is a linear combination of the terms in the form 7 14 moreover for each term the following estimate holds for its index 1 0 1 2 7 16 assuming this lemma we now prove proposition 7 3 proof of proposition 7 3 first we recall so called morrey s inequality cf e g 11 which states for any o r that is in w 1 p o namely the generalized derivative x is in lp o where o rd is a bounded domain with c 1 boundary and any p d and 0 1 d p it holds that sup x o x p sup x x o x x x x p c o p x p dx 7 17 now for n 0 recall the set kn defined by 2 11 let o be a domain with c 1 boundary such that kn o kn 1 from morrey s inequality 7 17 we deduce that sup x kn u t x p cn kn 1 u t x p xu t x p dx 33 thus to prove the proposition it suffices to show that d xd u w 1 p for all m that is d xd u w 0 p for all m m 1 7 18 to this end we fix as in 7 18 if m 1 then d xd u is either d xu for 2 or d x iu d xgi for some i 1 d and 1 and one can check 7 18 immediately we thus assume m 2 denote for ai ai i 1 2 3 we see that a 1 d xu a 2 0 d xd g 0 0 a 3 0 d xd f 0 0 0 note that d xd g d xd g 0 0 c u xu c a 2 d xd f d xd f 0 0 0 c u xu xxu c a 3 note that 1 0 1 2 1 m m 1 2 for any in 7 18 applying lemma 7 4 one can then check that d xd u c 1 m m 1 2 which leads to 7 18 immediately we now complete this section by proving lemma 7 4 proof of lemma 7 4 for simplicity in this proof we assume d d 1 in particular in this case n and thus we first remark that if 1 n are the terms taking form of 7 14 then so is n i 1 i furthermore it holds that n i 1 i n i 1 i 7 19 we shall proceed in two steps step 1 we first prove by induction on that d x f is a linear combination of terms 2 d xu a 1 d x y z f a 3 7 20 and the index satisfies the estimate 2 a 1 0 a 3 1 7 21 indeed when 0 we have f then all a 1 s and a 3 s are equal to 0 except a 3 1 for 0 and thus 1 34 assume the results hold true for m and 1 with m let be a term in 7 20 corresponding to then a typical term of d f x d f should come from x by 7 19 we now check the x derivative of each factor of and see its impact on first for 2 we have x d xu d 1 x u we see that 1 2 2 2 and the corresponding next for x d x y z f xd x y z f yd x y z f xu zd x y z f xxu d x y z f xxxu the derivatives of the f terms are up to the order 1 1 and those of the u terms are up to the order 3 2 so each term is still in the form of 7 20 moreover the first three terms do not increase while the last term increase by 1 summarizing we see that each term of x is in the form of 7 20 and 1 then we prove 7 21 for similarly we can prove that d x g is a linear combination of terms 1 d xu a 1 d x y z g a 2 7 22 and the index satisfies the estimate 1 a 1 0 a 2 1 step 2 we now prove the lemma by induction on 0 when 0 0 the results are obvious assume the results hold true for n and 1 with 0 n note that d xd u 1 d xd u let be a term in the form of 7 14 corresponding to then a typical term of d xd u should come from 1 we show that is in the form of 7 14 corresponding to and 7 23 this clearly implies 7 16 for we prove 7 23 in two cases denote m and m case 1 1 0 then 2 m m 2 and d xd u t d xd u by 7 19 we now check the t derivative for each factor of and see its impact on first for a 1 we have t d xu d x f note that 2 m 2 m and m m 2 then 7 20 implies that each term of d x f is in the form of 7 14 moreover by 7 21 this differentiation increases the index from 1 up to 1 1 m then m 35 next for a 2 with m 1 a 2 is empty when m 0 we have t d x y z g d x y z td g yd x y z d g tu zd x y z d g xtu d x y z td g yd x y z d g f zd x y z d g x f the derivatives of g are up to the order 2 m 1 2 m 1 and its path derivatives are up to the order 2 1 2 1 then these terms are in the form of 7 14 moreover since m 3 by 7 20 one can easily see that all the terms of f and x f are in the form of 7 14 furthermore all the g terms do not increase the term f increases up to 1 m when m 2 the term x f increase up to 1 1 m when m 1 we must have 0 then one can check straightforwardly that the increases from 1 to 2 namely the increase is 1 m so in all the cases we have m finally for a 3 with m 2 a 3 is empty when m 1 we have t d x y z f d x y z td f yd x y z d f f zd x y z d f x f d x y z d f xx f the derivatives of f are up to the order 2 m 2 2 m 2 and its path derivatives are up to the order 2 2 2 2 then these terms are in the form of 7 14 moreover since m 4 by 7 20 one can easily see that all the terms of f x f and xx f are in the form of 7 14 furthermore similarly to the g case above one can show that m case 2 1 1 then m m 1 and x u x u by using 7 22 and following similar arguments as in case 1 we can easily prove the result 8 consistency with 3 in this section we compare our stochastic taylor expansions 7 7 with those in our previous works 2 3 in particular the one in 3 and consequently unify them under the language of our path derivatives to be consistent with 2 3 we assume in what follows that d 1 o rd and that the coefficients f and g in 7 1 are deterministic we should note that in this case we have att 0 and bt t 1 2 tt 2 we begin by recalling the definition of the n fold derivatives introduced in 3 36 definition 8 1 a random field c 0 n fb 0 t rd is called n fold differentiable in the spatial variable x if there exist n random fields i c 0 n f 0 t rd rdi 2 i n 1 with d 1 d and di n 2 i n 1 and functions fi gi 0 t rd rdi 1 rd i 1 n such that denoting 1 the following properties are satisfied 1 fi gi c p i 1 n 2 for 1 i n it holds that i t x i 0 x t 0 fi s x i 1 s x ds t 0 gi s x i 1 s x dbs 8 1 for all t x 0 t rd with i 0 c 2 rd rdi 1 i n 3 for any 1 i n 1 n 1 and n it holds that sup d x i t x t 0 t x n p 1 lp f p 0 we shall call i i 2 n 1 the generalized derivatives of 1 with coefficients fi gi i 1 n the notion of the n fold derivatives is particularly motivated by the structure of spde 7 1 or more precisely 7 8 in fact if we define 1 u 2 u xu xxu f 1 f and g 1 g then 8 1 holds for i 1 moreover if we assume that the coefficients f g are sufficiently smooth so that the solution u is 3 fold differentiable then all the coefficients of the 3 fold generalized derivatives can be determined by differentiating the equation 7 8 in x repeatedly clearly to compare the taylor expansion we need only compare the derivatives in definition 8 1 and the path derivatives defined in definition 2 1 for notational simplicity in what follows we shall assume d 1 to begin with we note that by definition 8 1 we have 1 u 2 u xu xxu 3 u xu xxu xxxu xxxxu thus we have f 1 g 1 f g and the coefficients of the 2 fold derivative are f 2 f 1 2 f 2 2 f 3 2 and g 2 g 1 2 g 2 2 g 3 2 where f 1 2 f g 1 2 g and f 2 2 g 2 2 can be determined by differentiating the equation 7 8 with respect to x namely xu t x u 0 x t 0 f 2 2 t x 3 t x ds t 0 g 2 2 t x 3 t x dbs 8 2 where by direct calculation it is readily seen that g 2 2 t x 3 xg yg xu zg 2 xxu 8 3 37 note that g is deterministic we have g 0 and by 8 2 8 3 and the definition of path derivative xu xu g 2 2 t x 3 xg yg xu zg 2 xxu x u 8 4 now applying functional ito s formula or chain rule to g u xu we have dg t x u xu f g t x 3 dt yg u zg xu dbs 8 5 where we simply denote the drift by f g as it is irrelevant to our argument note that denoting z y z we can write g 1 t x z g 1 2 t x z g t x z g t x y z and d z g gy gz 0 therefore yg u zg xu ygg zgg 2 2 t x 3 dzg t x 2 g 2 t x 3 8 6 this together with the fact u g and 8 5 shows that 2 u g dzg g 2 t x 3 8 7 tu f t x 2 1 2 2 u f t x 2 1 2 d z g g 2 t x 3 8 8 we can now recast the pathwise taylor expansion of buckdahn bulla ma 3 in the new path derivative language recall that bts s t for s t theorem 8 2 let u be the classical solution to the spde 7 1 with deterministic coef ficients f and g and assume that it is 3 fold differentiable then for every 1 3 1 2 and m n there exist a subset m with p m 1 such that for all t y 0 t bm 0 m the following taylor expansion holds u t h y k u t y ah bbtt h c 2 btt h 2 pk 1 2 xk 2 qkbtt h h k 2 3 r m t t h y y k 8 9 for all t h y k 0 t bm 0 here the coefficients a b c p q x are given by a tu t x b u t x c u t x p xu t x q xu t x x xxu t x 8 10 furthermore the remainder of taylor expansion r m 0 t 2 rd 2 7 r is a measurable random field such that r m sup t s 0 t y z bm 0 r m t s y z p 1 lp f p 8 11 38 proof again we assume d 1 since u satisfies 7 1 and is 3 fold differentiable by a direct application of theorem 2 3 in 3 with 1 u 2 u ux uxx and f 1 f g 1 g we obtain a stochastic taylor expansion 8 9 with the following coefficients a f t x 2 f t x 2 1 2 d z g t x 2 g 2 t x 3 b g t x 2 c dzg t x 2 g 2 t x 3 p xu t x x xxu t x 8 12 q xg t x 2 dzg t x 2 dx 2 combining 7 3 8 4 8 7 and 8 8 we have a f t x 2 f t x 2 1 2 d z g t x 2 g 2 t x 3 tu b g t x 2 u c d z g t x 2 g 2 t x 3 2 u q xg t x 2 dzg t x 2 dx 2 xg yg xu zg 2 xxu 2 x u this proves 8 10 whence the theorem references 1 bichteler k stochastic integration and lp theory of semi martingales ann prob 9 1981 48 89 2 buckdahn r and ma j pathwise stochastic taylor expansions and stochastic vis cosity solutions for fully nonlinear stochastic pdes annals of probability vol 30 no 3 2002 1131 1171 3 buckdahn r bulla i and ma j pathwise taylor expansions for ito random fields mathematical control and related fields vol 1 no 4 2011 pp 437 468 4 buckdahn r ma j and zhang j pathwise viscosity solutions for stochastic pdes and forward path dependent pdes working paper 5 cont r and fournie d functional ito calculus and stochastic integral representation of martingales ann probab 41 2013 no 1 109 133 6 dupire b functional ito calculus papers ssrn com 39 7 ekren i keller c touzi n and zhang j on viscosity solutions of path depedent pdes annals of propability to appear arxiv 1109 5971 8 ekren i touzi n and zhang j viscosity solutions of fully nonlinear parabolic path dependent pdes part i preprint arxiv 1210 0006 9 friedman a generalized functions and partial differential equations prentice hall englewood cliffs n j 1963 10 friz p and victoir n multidimensional stochastic processes as rough paths the ory and applications cambridge university press 2010 11 gilbarg d and trudinger n s elliptic partial differential equations of second order second edition springer 1998 12 karandikar r on pathwise stochastic integration stochastic processes and their ap plications 57 1995 11 18 13 kloeden p e and platen e numerical solution of stochastic differential equations springer verlag berlin heidelberg 1992 14 litterer c and oberhauser h a chen fliess approximation for diffusion functionals preprint arxiv 1110 2481 15 lyons t caruana m and le vy t differential equations driven by rough paths lectures from the 34 th summer school on probability theory held in saint flour july 624 2004 lecture notes in mathematics 1908 springer berlin 2007 16 j ma h yin and j zhang on non markovian forward backward sdes and back ward stochastic pdes stochastic processes and their applications 122 2012 no 12 3980 4004 17 ma j and yong j on linear backward stochastic partial differential equations probab theory relat fields 113 1999 135 170 18 pardoux e and peng s backward doubly stochastic differential equations and systems of quasilinear spdes probab theory relat fields 98 1994 209 227 19 rozovskii b l stochastic evolution systems linear theory and applications to non linear filtering kluwer academic publishers boston 1990 40 http arxiv org abs 1210 0006 http arxiv org abs 1110 2481 1 introduction 2 preliminaries 2 1 path derivatives for it processes 2 2 path derivatives for random fields 2 3 it random fields and it ventzell formula 2 4 multiple differentiation and integration 3 taylor expansion for it processes second order case 3 1 forward temporal expansion 3 2 backward temporal expansion 4 taylor expansion for it processes general case 5 pathwise taylor expansion for random fields 6 extension to h lder continuous case 7 application to forward stochastic pdes 8 consistency with bbm