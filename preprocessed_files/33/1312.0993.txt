arxiv 1312 0993 v 1 math pr 4 dec 2013 ar x iv 1 31 2 09 93 v 1 m at h p r 4 d ec 2 01 3 computational tools for the shot noise with random amplitude jean fran ois chamayou 18 octobre 2018 msc primary 60 d 33 secondary 62 d keywords random difference equations triggered shot noise iterated cosine bessel functions logarithmic distribution functions saddle point method asymptotic calcu lations generalized hypergeometric functions psi functions i abstract introduction the following random recurrency wn 1 un 1 wn n 1 where w 1 0 is known to be associated with the shot noise see scheme 1 wt 0 tk t ke t tk where the tk are the dates of a poisson process the ui i 0 1 are independent uniform variables this can be extended to the triggered shot noise cf ref 7 see scheme 2 wt 0 tlk t lke t tlk l 1 2 3 the random amplitudes i i 0 1 are positive dufresne independent variables which laplace transform of the density is pfq a b s p 1 q or variables c a b independent which characteristic function is cf ref 9 2 p 1 f 2 p c a a 1 2 b b 1 2 s 2 laboratoire de statistique et probabilit s universit paul sabatier 31062 toulouse france e mail jfchamay math univ toulouse fr 1 http arxiv org abs 1312 0993 v 1 or more generally even density variables which characteristic function i e the fourier transform is pfq a b s 2 p 1 q the generalized hypergeometric function with the sequences of parameters p q a a 1 ap 0 b b 1 bq 0 defined for 1 s 1 pfq a b s 2 n 0 a n b n s 2 n n where a s a s a is the pochhammer symbol and the gamma function the compact notation used means for the products a n a 1 n ap n and an empty set of parameters our aim is to provide tools to compute the density of the stationnary behaviour of the random recurrency i e of the classical or triggered shot noise special cases have already been studied this work take advantage of previous results for different type of laws with the follo wing transforms laplace 1 deterministic 0 f 0 s exp s ref 8 2 gamma 1 f 0 a s 1 1 s a a 0 ref 7 3 beta 1 f 1 a b s b a 0 or fourier 1 laplace 1 f 0 a s 2 1 1 s 2 a a 0 ref 7 2 cauchy 0 f 0 s exp s ref 7 3 standard normal 0 f 0 s 2 2 exp s 2 2 ref 7 4 arcsine 0 f 1 1 s 2 4 j 0 s ref 6 7 5 bernoulli 0 f 1 12 s 2 4 cos s ref 5 7 we intend to illustrate the general case with the particular example combinating the 2 last ones sum of arcsine and bernoulli variables i e 0 f 1 1 2 s 2 4 0 f 1 1 s 2 4 cos s j 0 s 2 f 3 1 4 3 4 1 2 1 2 1 s 2 see 20 7 15 1 3 p 609 2 ii shot noise the stationnary density is obtained from a first order differential equation giving the transform laplace fourier taking into account the characteristic function of the random amplitude g s see 8 h s c s exp s g d where c is the normalization factor the density of probability is given after the formal inversion of the fourier transform for our general case by f x c 0 cos xt exp t pfq a b 2 d dt t the normalization factor is given by see the appendix for the proof c exp 1 2 a b where a is the logarithmic derivative of the a function the euler constant the compact notation used means for the sums a a 1 ap the previous papers required the use of known special functions exponential sine cosine hyperbolic bessel modified integral we introduce now the generalized hypergeometric integral pt iq a b x 2 2 x pfq a b 2 d ln x a b pt inq a b x 2 see the appendix for the computation of the integration constant where the complemen tary function is pt inq a b x 2 2 x 0 1 pfq a b 2 d k 1 a k b kkk x 2 k the asymptotical behavior for x is given traditionally by integration by parts for not integer b 2 x pfq a b 2 d k 1 b k k 1 1 k 1 a kx 2 k pfq a k b k x 2 3 we could have introduced even more general function like meijer function where the hypergeometric function is replaced by its extension see 20 iii 8 2 2 3 page 618 gm np q a b m k 1 m j 1 bj bk n j 1 1 aj bk q j m 1 1 bj bk p j n 1 aj bk pfq 1 1 a 1 bk 1 ap bk 1 b 1 bk 1 bq bk 1 p m n where the normalization gives gm np q 0 a b m k 1 m j 1 bj bk n j 1 1 aj bk q j m 1 1 bj bk p j n 1 aj bk ii 1 asymptotical study an asymptotical study by the saddle point method of the stationary density is under taken by considering the inverse laplace transform f x 1 2 i a 0 exp sx s 0 pfq a b 2 1 d ds where a 0 is a vertical path in the s plane through the saddle point s 0 if s sx s 0 pfq a b 2 1 d the saddle points s 0 are the roots of s x pfq a b s 2 1 s then the density f x can be approximated by f x exp s 0 2 s 0 x for x sufficiently large s has only one root s 0 x tending to infinity with x this fact can be seen using the asymptotical representation of pfq a b s 2 the calculation of the roots of 1 xs 0 pfq a b s 2 0 gives an idea of the asymptotic behavior first with s 1 0 o ln x 4 ii 2 our favorite example we handle the following random recurrency wn 1 un 1 wn cos vn 1 n 1 where w 0 u 0 cos v 0 0 n 0 1 the density of w 0 is the following f 0 x 1 2 2 x x 1 2 2 x f 1 x the density of w 1 is given from the intermediary step calculation of g 1 y the density of y w 0 cos v 1 1 obtained using complete elliptic functions k g 1 y 1 2 2 k 1 y 2 4 1 2 2 2 y 2 k 2 y 2 y 2 1 4 4 y then f 1 can be expressed through the integral 1 x 1 2 0 k 5 1 2 1 5 1 2 2 d integrated by series expansion see prudnikov vol iii page 36 the comparisons between the densities and the monte carlo simulations are presented in figure 1 for f and figure 2 for g only on the positive abscissae due to parity the previous recurrency is associated to the shot noise wt 0 tk t cos vn 1 n 1 e t tk where the tk are the dates of a poisson process the ui vi i 0 1 are independent uniform random variables and the i i 0 1 independent bernoulli variables 1 2 1 1 this random amplitude can be considered as the product of the same bernoulli by a beta 1 1 2 1 2 multiplied by 2 this fact is also shown by the carlson identity 4 entry 11 p 1 a 1 2 q 1 b 1 2 pf 2 q 1 a 2 a 1 2 1 2 b 2 b 1 2 s 2 1 2 pfq a b i 2 1 q ps pfq a b i 21 q ps a numerical computation of the stationary density is tractable by splitting the inte gration domain of the integral and negleting the minor integration part see appendix for the normalization constant f x 2 e 0 cos xt exp t cos j 0 d dt t 5 2 e x 1 0 cos xt exp t cos j 0 d dt t sin xx 1 xx 1 exp x 1 cos j 0 d x 2 x 1 1 cos t j 0 t xt sin xt exp t cos j 0 d dt t o 1 xx 22 where o 1 xx 2 2 o h 2 h is the integration step from the trapezoidal rule of this oscilla ting integral see 11 for the numerical results the computations are based on earlier results obtained with other types of laws arc sine or bernoulli alone they require now the calculations of the special function cosine bessel integral in accordance with the agrest s papers 1 2 3 for the function exponential bessel integral we can choose between several expansions cos x j 0 x k 0 1 2 2 k 2 k 2 4 x 2 k which gives the following moments k 2 k 1 2 2 k 2 2 k 2 k k 2 k 1 0 k 0 1 or cos x j 0 x k 0 1 k 4 k 2 k 3 x 2 2 k found in 13 5 24 30 p 92 and the hypergeometrical representation already established cos x j 0 x 2 f 3 1 4 3 4 1 2 1 2 1 x 2 n 0 1 4 n 3 4 n 1 2 n 1 2 n x 2 n n 2 which is more convenient for our purpose we get cji x x cos j 0 d 1 0 ci 2 x sin 2 2 d m 1 ln x cjin x where ci is the cosine integral the integral uses the integral representation of the bessel function and the complementary function is cjin x x 0 1 cos j 0 d n 1 1 4 n 3 4 n 1 2 n 1 2 n x 2 n 2 n n 2 m 1 being the integration constant computed in the appendix the constant is given by m 1 1 2 1 4 3 4 2 1 2 1 ln 2 cf ref 21 for the values or the pseudo code of its computation the asymptotical behavior for x is given by an integration by parts due to the integer parameter of the hypergeometric function using the hankel asymptotic expansion for j 0 see abramovitz 0 page 364 x cos j 0 d 2 1 12 x 2 cos 2 x 4 4 x x 1 x 5 2 6 ii 3 asymptotical study of the example the asymptotic behavior of the density is given from the saddle point method by considering the bilateral inverse laplace transform f x 1 2 i a 0 exp sx s 0 ch i 0 1 d ds where a 0 is a vertical path in the s plane through the saddle point s 0 if s sx s 0 ch i 0 1 d the saddle points s 0 are the roots from s x ch s i 0 s 1 s then the density f x can be approximated by f x e s 0 2 s 0 x for x sufficiently large s has only one root s 0 x tending to infinity with x and using the following asymptotic representations for the modified bessel function and the hyper bolic functions in s es 2 s ch s sh s e s 2 the calculation of the roots from 1 xs 0 e 2 s 0 2 2 s 0 gives an idea of the asymptotic behavior first s 1 0 o 1 2 ln x and s 2 0 1 2 ln x 3 4 ln ln x 1 4 ln x the analogous relations exist for the special function hyperbolic cosine modified bessel integral for the asymptotic study with the help of the saddle point method cii x ln x 2 ciin x where ciin x x 0 ch i 0 1 d n 1 1 4 n 3 4 n 1 2 n 1 2 n x 2 n 2 n n 2 again the asymptotic behavior for x is given by an integration using the asymptotic expansion of i 0 see abramovitz 0 page 377 ch i 0 d 2 exp 2 x 8 x x exp 2 x x 5 2 7 iii triggered shot noise iii 1 general case the approximated stationary density of the random recurrency is obtained from a lth order differential equation giving the transforms laplace fourier h s taking into account the characteristic function of the random amplitude g s see 7 for l 2 s 2 h s 3 sh s 1 g s h s 0 the h expansion in the neighbourhood of zero is h s i 0 cis i the coefficients are identified using the g s expansion we get c 0 1 c 2 n 1 0 c 2 n 1 4 n n 1 n 1 j 1 c 2 jk 2 n j 2 n j n 1 2 where the kn are the moments of the random amplitude the iterative computation according to cf 6 of h s sh 2 s c 1 ln s 1 t i 2 s 2 t i 3 s c 2 c 1 1 t i 2 s is used for the calculation of the 2 constants c 1 c 2 from the comparison with j 0 cjs j which allows the knowledge of the asymptotical behavior for the triggered case for the triggered shot noise we need to introduce the special function iterated generalized hypergeometric integral function pt i n q a b x 2 2 x pt i n 1 q a b 2 d where pt i 0 q a b x 2 2 pfq a b x 2 and pt in n q a b x 2 k 1 a k b k k nk x 2 k the semiconvergent asymptotic forms x of the iterated exponential integral can be found in kunstner 17 van de hulst 22 page 11 and of the iterated cosine integral in hallen 12 for the iterated bessel integral we get the following result from bessel integral ji 1 x approximation found in petiau 19 smith page 254 ji 2 x j 0 x 1 x 2 20 x 4 1 n 1 2 nn 2 n 1 n 1 n 1 k 1 1 k 1 2 n x 2 n j 1 x 4 x 3 96 x 5 1 n 1 2 nn 2 n k 1 1 k x 2 n 1 8 iii 2 our favorite example according to the results in 7 on the triggered shot noise we get for the w 0 density f 0 x 1 2 x x arctg 2 x x 1 2 2 x figure 3 shows the comparison with a monte carlo simulation of the process the link between iterated integral functions and their complementary is given cf 14 for n using m 2 m 3 see appendix by m 2 1 222 1 4 3 4 2 1 2 2 4 m 3 1 233 2 1 1 4 3 4 2 1 2 1 16 3 4 3 4 28 3 2 8 1 3 3 3 then cji 2 x 1 2 ln x 2 2 2 4 n 1 1 4 n 3 4 n 1 2 n 1 2 n x 2 n 2 n 2 n 2 cji 3 x 1 3 ln x 2 3 2 4 ln x 2 3 3 n 1 1 4 n 3 4 n 1 2 n 1 2 n x 2 n 2 n 3 n 2 where the zeta function 3 1 2020569032 since these functions are necessary to the computation according to cf 6 of sh 2 s c 1 ln s 1 cji 2 s 2 cji 3 s c 2 c 1 1 cji 2 s 1 s 9 for the calculation of the 2 constants c 1 c 2 from the comparison with j 0 cjs j which allows the knowledge of the asymptotical behavior for the triggered case figure 4 shows the comparison only for positive abscissae due to the parity the asymptotical behavior for x is given by a double integration by parts using the hankel asymptotic expansion for j 0 see abramovitz 0 page 364 x 1 cos j 0 d d 4 1 6 x x 1 x 5 2 the knowledge of the asymptotic behaviour is necessary to compute by inverse fourier transform the density with short support from the characteristic function with extended support as shown in figure 5 9 iii 3 waiting time paradox it is necessary to take into account the waiting time correction for the triggered shot noise see 23 7 when l 2 for instance fwaiting time x 1 4 3 2 x x 2 arctg 2 x x 1 2 2 x the density of the product of the random amplitude by 3 independent uniforms va riables can also be calculated in closed form f 0 x 2 2 x x arctg 2 x x 1 2 ln r 1 4 cl 2 2 cl 2 2 cl 2 2 1 2 2 x where r 1 2 x arctg 2 x x and arctg rsin 1 rcos with the help of the clausen integral see 18 cl 2 k 1 sin k k 2 0 ln 2 sin 2 d figure 5 shows the comparison of f 0 with the monte carlo simulation of the random recurrency the first term is sufficient except for an accurate computation of the tail of the stationnary density all the other numerical resuls and graphs can be found in the report 11 iv appendix auxiliary result the method to compute the integration constants of the iterated integral functions follows the line of the proof in 16 pages 258 259 lemma 1 let g s be the transform laplace or fourier of the random amplitude density with moments kk k 1 2 we get g n s s g n 1 d g 0 s g s we get g n s mn 1 1 n lnn s n 1 n k 1 1 k 1 kks k knk n 2 l 0 1 n l 1 lnn l 1 s ml l n l 1 10 where mn 0 g lnn n d proof integrating by parts g n s 1 g s lnn 1 n 1 d n 1 2 splitting the domain of integration we get for g n s 1 s g s lnn 1 n 1 d 1 s 0 1 g s ln n 1 n 1 d 1 s 1 lnn 1 n 1 d 1 0 1 g s lnn 1 n 1 d 1 g lnn 1 s n 1 d 1 0 1 g lnn 1 s n 1 d 1 n lnn s n k 1 1 k 1 kks k k 1 0 xk 1 lnn 1 n 1 d 1 g lnn 1 n 1 d 1 0 1 g ln n 1 n 1 d 1 nln n s n 1 n k 1 1 k 1 kks k knk n 2 l 0 1 n l 1 lnn l 1 s l n l 1 1 g lnl d 1 0 1 g ln l d mn 1 1 n lnn s n 1 n k 1 1 k 1 kks k knk n 2 l 0 1 n l 1 lnn l 1 s ml l n l 1 the integrals mn are also obtained by integration by parts mn 1 g lnn n d 1 0 1 g lnn n d 0 g lnn n d generally this integral is unknown in closed form for any g s more likely we will obtain the following one mn 1 n dn dsn k s s 0 1 n dn dsn 0 g sd s 0 this is true for instance for the fox h function a very general special function see 20 iii paragraph 8 3 pp 626 g s hm np q s a a b b 11 where cf 20 iii 8 3 2 15 page 629 for the differentiation of the fox function sg s h m n 1 p 1 q 1 s 0 1 a a b b 1 1 from the definition using mellin barnes integrals see 20 iii 8 3 1 1 page 626 we get for the integral k k s 0 s 1 h m n 1 p 1 q 1 0 1 a a b b 1 1 d s m j 1 bj bjs n j 1 1 aj ajs q j m 1 1 bj bjs p j n 1 aj ajs returning to our general case lemma 2 for g s pfq a b s 2 the integrals mn 1 n dn dsn 0 g sd s 0 n 1 2 are given by the recurrency mn mn m 1 mn 1 m 0 0 n 1 2 where mk 1 2 kk k 1 1 1 k k 1 a k 1 b k 1 2 the k are the derivative of the function proof cf 20 for the differentiation of the hypergeometric function g s 2 s a 1 b 1 pfq a 1 b 1 s 2 then from the definition of the generalized hypergeometric functions using mellin barnes integrals cf 20 7 3 4 12 page 438 we get k s a 1 b 1 0 pfq a 1 b 1 s 2 d a s 2 1 s 2 b s 2 from which k s 1 2 a s 2 1 s 2 b s 2 a s 2 1 s 2 b b s 2 2 b s 2 1 s 2 a s 2 a b s 2 12 then m 1 m 1 k 0 1 2 1 b a however to continue it will be more convenient to introduce the expansion of ln k s using the expansions of the logarithm of the function cf 13 54 111 p 358 where the riemann hurwitz function is given in terms of derivative of the function k a 1 k k 1 k 1 a we get ln k s ln a s 2 a ln b s 2 b ln 1 s 2 1 1 2 1 a b t 2 k 2 tk 2 kk k 1 1 1 k k 1 a k 1 b finally mk 1 2 kk k 1 1 1 k k 1 a k 1 b k 1 2 the mn are obtained from the mk using the application of the method presented in 10 14 mn mn m 1 mn 1 m 0 0 n 1 2 13 v references 0 abramovitz m stegun i a handbook of mathematical functions 1964 natio nal bureau of standards 1 m m agrest generalization of some relations for the bessel integral functions bull acad sci georgian ssr 126 2 1987 241 244 2 m m agrest t s chachibaya expansions of bessel exponential integral func tions and related functions soviet math iz vuz 32 4 1988 1 13 3 m m agrest certain relations for exponential integral bessel functions of genus 1 soviet math iz vuz 35 6 1991 67 69 4 b c carlson some extensions of lardner s relations between 0 f 3 and bessel functions siamj math anal 1 1970 232 242 mr 41 3819 5 j f chamayou numerical evaluation of a solution of a special mixed type diffe rential difference equation calcolo 15 1978 395 414 6 j f chamayou mod le de bruit de grenaille trigonom trique journ es de sta tistique lyon 24 27 mai actes universit claude bernard 1983 19 7 j f chamayou j l dunau random difference equations with logarithmic dis tribution and the triggered shot noise adv appl math 29 2002 454 470 8 j f chamayou j l dunau random difference equations an asymptotical result j comput appl math 154 1 2003 183 193 9 j f chamayou products of double gamma gamma and beta distributions stat probab lett 68 2 2004 199 208 10 e a gussmann modifizierung der gewichtsfunktionenmethode zur berechnung der fraunhoferlinien in sonnen und sternspektren zeitschrift astrophysik 65 1967 456 497 11 j l habemont k hami eddine simulation du bruit de grenaille rapport 4 gmm institut national sciences appliqu es mai universit toulouse 2005 12 e hallen iterated sine and cosine integrals trans roy inst techn stock holm 12 1947 13 e r hansen a table of series and products 1975 prentice hall 14 k s kolbig on the integral 0 e tt 1 logmtdt math comput 41 1983 171 182 14 15 k s kolbig the polygamma function k x for x 1 4 and x 3 4 j comput appl math 75 1 1996 43 46 16 v kourganoff i w busbridge basic methods in transfer problems 1952 clarendon oxford 17 h kunstner zur berechnung zweier spezieller integrale wissensch ft zeit wilhem pieck uni rostock naturw reihe 3 1984 63 64 18 l lewin polylogarithms and associated functions 1981 north holland newyork 19 g petiau la th orie des fonctions de bessel cnrs 1955 20 a p prudnikov y a brychkov o i marichev elementary functions special functions more special functions vol 1 to 3 in integrals and series 1992 gordon breach 21 v g smith an asymptotic expansion of ji 0 x x j 0 t t dt j math phys 22 1943 58 59 21 j spanier k b oldham an atlas of functions 1987 hemisphere publ washington d c springer verlag berlin 22 h c van de hulst multiple scattering 1980 acad press new york 23 k van harn f w steutel infinite divisibility and the waiting time paradox commun statist stochastic models 11 3 1995 527 540 15 i t 0 t 1 t 2 tn k tn wt t scheme 1 shot noise process 16 i t 0 t 1 t 2 t 3 t 2 n k t 2 n wt t scheme 2 triggered shot noise process 17 0 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 0 0 5 1 1 5 2 2 5 3 3 5 4 h is to g ra m m e e t d e n si te classes des variables uniforme arsin bernoulli simulation densite theorique un terme densite theorique deux termes f ig u r e 1 ex a m p le 1 8 0 0 05 0 1 0 15 0 2 0 25 0 3 0 35 0 4 0 45 0 0 5 1 1 5 2 2 5 3 3 5 4 h is to g ra m m e e t d e n si te classes des variables arsin bernoulli uniforme arsin bernoulli simulation densite theorique f ig u r e 2 ex a m p le 1 9 0 0 5 1 1 5 2 2 5 3 3 5 0 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 1 8 2 h is to g ra m m e e t d e n si te classes des variables uniforme uniforme arsin bernoulli simulation densite theorique f ig u r e 3 ex a m p le 2 0 0 4 0 5 0 6 0 7 0 8 0 9 1 1 5 2 2 5 3 3 5 4 4 5 5 f o n ct io n c a ra ct e ri st iq u e valeur variable de fourier fit caracteristique cosinus bessel caracteristique exacte approximation caracteristique f ig u r e 4 ex a m p le 2 1 1 0 1 2 3 4 5 0 0 2 0 4 0 6 0 8 1 1 2 1 4 1 6 1 8 2 d e n si te valeur variable aleatoire fit cosinus bessel simulation approximation logarithmique densite theorique fourier inverse lisse f ig u r e 5 ex a m p le 2 2 0 1 2 3 4 5 6 7 8 9 10 0 0 2 0 4 0 6 0 8 1 h is to g ra m m e e t d e n si te classes des variables uniforme uniforme uniforme arsin bernoulli simulation densite theorique f ig u r e 6 ex a m p le 2 3