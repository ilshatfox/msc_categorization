electronic density of states for incommensurate layers daniel massatt mitchell luskin christoph ortner abstract we prove that the electronic density of states dos for 2 d incom mensurate layered structures where bloch theory does not apply is well defined as the thermodynamic limit of finite clusters in addition we obtain an explicit representation formula for the dos as an integral over local configurations next based on this representation formula we propose a novel algorithm for com puting electronic structure properties in incommensurate heterostructures which overcomes limitations of the common approach to artificially strain a large supercell and then apply bloch theory 1 introduction bloch theory provides an elegant solution for describing the electronic structure of periodic materials however there has been a lot of focus recently on the study of incommensurate layers of two dimensional crystal structures 16 17 in the absence of periodicity computing the electronic structure of such materials becomes more challenging a common approach to approximate the electronic properties of such a system is to artificially strain it to obtain periodicity on a large supercell and then apply bloch theory to this periodic system 4 9 11 16 commensurate approximations to an incommensurate system are computationally expensive and their approximation error is unclear here we introduce a new method for computing a class of observables derived from the density of states for multi layer incommensurate heterostructures without requiring an artificial strain in the system to approximate an observable of an infinite incommensurate system we approx imate local lattice site contributions to the observable we observe that a site is uniquely defined by its local geometry using an equidistribution theorem there is a predictable distribution of local geometries and hence site contributions conse quently we can express observables in incommensurate heterostructures in terms of an integral over a unit cell in a fashion rather similar to bloch theory this unit cell classification of local configurations is related to bellisard s noncommutative bril louin zone for aperiodic solids 1 prodan used the bellisard formalism to compute electronic properties for periodic materials with on site defects modeled by a tight binding model 13 here we consider the density of states and related observables for incommensurate multi layers while the methodology is in principle generic our derivation and analysis focuses on tight binding models which are commonly employed for computing the electronic date october 15 2018 dm was supported by nsf pire grant oise 0967140 ml was supported in part by aro muri award w 911 nf 14 1 0247 and by the radcliffe institute for advanced study at harvard university co was supported by erc starting grant 335120 1 ar x iv 1 60 8 01 96 8 v 1 m at h ph 5 a ug 2 01 6 2 daniel massatt mitchell luskin christoph ortner structure of 2 d materials 2 8 we consider the density of states and related ob servables for incommensurate multi layers we use chebyshev polynomial methods to approximate the density of states as a function 6 12 14 15 19 and from this function any observable can be computed outline in section 2 we introduce the results for the bilayer case and briefly discuss their extension to the multi layer case in section 2 1 we introduce incommensurate systems and the equidistribution result in section 2 2 we specify the details of our model problem and in section 2 3 we show how to compute the local density of states in section 2 4 we prove the infinite system is well posed and express the observables as an integral over local observables section 3 we describe an approximation scheme and present numerical results in section 3 1 we discuss the integral discretization in section 3 2 we introduce a chebyshev kernel polynomial method and in section 3 4 we present numerical results in section 4 we present the details of the proofs 2 main results 2 1 incommensurate heterostructures consider two periodic atomic sheets in parallel 2 d planes separated by a constant distance each individual sheet can be described as a bravais lattice embedded in r 2 by neglecting the out of plane distance this coordinate is not relevant for classifying the aperiodicity and will be incorporated in section 2 2 for sheet j 1 2 we define the bravais lattice rj ajn n z 2 where aj is a 2 2 invertible matrix we define the unit cell for sheet j as j aj 0 1 2 each individual sheet is trivially periodic since rj ajn rj for n z 2 however the combined system r 1 r 2 need not be periodic figure 1 a note that here r 1 r 2 is only considered to describe geometry not as an indexing of the atoms as it would have the failure of identifying the origins from each lattice since we are interested in aperiodic systems we make the following standing as sumption assumption 2 1 the lattices r 1 and r 2 are incommensurate that is for v r 2 v r 1 r 2 r 1 r 2 v 0 0 since the majority of material simulation tools rely on periodicity the most com mon method at present to simulate incommensurate layers is to adjust one of the two layers slightly in order to make the system commensurate on some larger supercell figure 2 in contrast we take advantage of an equidistribution of local geometries to parameterize the local geometries we define the modulation operator modj r 2 j on sheet j for position u r 2 modj u u rj where rj rj such that u rj j electronic density of states for incommensurate layers 3 sheet 2 sheet 1 a an incommensurate hexagonal bi layer sheet 1 is rotated by 6 rela tive to sheet 2 mod 2 r 1 r 1 r 2 sheet 1 sheet 2 b mod 2 r 1 is the shift of the first lat tice relative to the second lattice figure 1 visualisation of incommensurate bilayer geometry then the relative shift of site r 1 r 1 is mod 2 r 1 2 see figure 1 b the local geometry of site r 1 r 1 is defined by r 1 r 2 r 1 r 1 r 2 r 1 r 1 r 2 mod 2 r 1 hence the local geometry is determined by the relative shift mod 2 r 1 the same argument holds for relative configurations around a site on sheet two a fundamental idea in this method is that the distribution of modj rpj j is uniform in the sense of theorem 2 1 below we let br y r 2 y r for r 0 for j 1 2 we let pj be the transposition that is p 1 2 and p 2 1 a incommensurate cell b commensurate cell approxima tion figure 2 a two lattices spheres and lines that are incommensu rate b the sphere lattice is slightly rotated to obtain a commensurate cell approximation 4 daniel massatt mitchell luskin christoph ortner theorem 2 1 consider r 1 and r 2 incommensurate lattices embedded in r 2 i e satisfying assumption 2 1 then for g cper pj we have 2 1 1 rj br rj br g 1 pj pj g b db in particular local geometries around sheet 1 sites can be parameterized by 2 while local geometries around sheet 2 sites can be parameterized by 1 theorem 2 1 suggests the following strategy for defining and computing electronic structure properties in incommensurate heterostructures 1 split an observable into local contributions from each atomic site we will employ the local density of states 2 employ theorem 2 1 to demonstrate that the thermodynamic limit from finite clusters exist observe that 2 1 is a sum over a finite cluster 3 use the right hand side of 2 1 to compute the limit quantity 2 2 tight binding model electronic structure is governed by solutions to the schro dinger eigenproblem it is typically approximated using methods such as the kohn sham dft ks dft model or the hartree fock approximation 8 for sys tems in the thousands of atoms however the standard ks dft calculation becomes intractable the tight binding tb model applies further approximations and as a result can treat larger systems ranging in the millions of atoms let ai denote the set of indices of orbitals associated with each unit cell of sheet i we assume that ai are finite and that a 1 a 2 then the full degree of freedom space is r 1 a 1 r 2 a 2 the interaction between orbitals indexed by r and r is denoted by h r r where h c r 2 although the sheets have a vertical displacement between them this distance is constant and hence can be encoded into h using the assumption that a 1 a 2 we will further use the following assumption assumption 2 2 orbital interactions h are uniformly continuous on r 2 and decay exponentially that is h x ce x for x r 2 this applies in most scenarios since in most tight binding models the orbitals are tightly bound around the atomic sites 8 or are exponentially decaying we then formally define a matrix h such that hr r h r r this is an infinite matrix hence the eigenproblem h e for cn cannot be solved directly instead we will define a class of observables for the infinite system by first defining them for finite sub systems and then passing to the limit in 2 4 for with n the associated hamiltonian is h hij i j mn c where mn c denotes the set of n n hermitian matrices over c the density of states for can be defined via its action on test functions or observables g by d h g 1 n tr g h g c r electronic density of states for incommensurate layers 5 we will later slightly extend the space of observables for example we can consider the bond energy d h ut where ut ft and ft 1 e kt 1 is the fermi function formally the value of the observable for the infinite system is the limit of d h g as for future reference we remark that since h is defined in terms of the lattices rj and the hopping functions h we will say h satisfies assumptions 2 2 and 2 1 to mean that r 1 r 2 satisfy assumption 2 1 and h satisfy assumption 2 2 2 3 local density of states the next step is to define the local density of states distribution which will allow us to identify local site contribution to an observable consider a finite sub system with associated hamiltonian h mn c then the local density of states distribution is defined as dk h g g h kk k g c r note that 1 n k dk h g d h g this reformulation puts us very close to the setting of theorem 2 1 it remains to control the dependence of dk h g on which we will achieve in the next section by fixing k and letting while controlling the error sheet 1 sheet 2 origin figure 3 all the sites in r for a hexagonal bravais lattice the central site for sheet 1 is highlighted towards that end we now specify a sequence of local degree of freedom spaces r r 1 br a 1 r 2 br a 2 for r 0 see also figure 3 for r 0 and b r 2 we define hr j b m r c by hr j b r r h b apj apj r r for r r r physically hr j b describes a cluster of radius r of the bilayer system in which the sheet pj is shifted by b the local configuration is determined 6 daniel massatt mitchell luskin christoph ortner by the relative shift so b indexes which local configuration we are considering then 2 2 d hr j b d 0 hr j b for aj is an approximate local density of states distribution of the infinite system at a local configuration indexed by b pj at orbital on sheet j 2 4 thermodynamic limit we now consider the limit as r of the ldos which will allow us to define the dos for the infinite system let e h sup r 0 j 1 2 sup b j hr j b 2 where h 2 sup cn 0 h 2 2 for h mn c then the local density of states distribution will be supported on the interval s h e h e h we can now generalize observables to be functions g c s h and supply this space with the norm g sup x s h g x for g c s h for u c we define the distance d u s h inf z u z s h z z this is a bound on the distance between u and the spectrum to pass to the limit in the ldos and later in the dos we narrow down admissible test functions to g c r g is analytic on s h if g then there exists d 0 such that g d which is defined as d g c r g is analytic at z for d z s h d theorem 2 2 1 suppose that h satisfies assumptions 2 1 and 2 2 then for aj there exists a function d h pj c s h c such that for g d hr j b g d h b g as r the distribution d h b g is the local density of states for the infinite system 2 the map g 7 d h b g is a bounded linear functional more precisely d h b g g for g c s h 3 there exist constants c 0 such that for d 0 and g d d h b g d hr j b g cd 2 sup d z s h d g z e d r we next analyze the regularity of the map b 7 d h b g for fixed g which will allow us to integrate with respect to b let n z m m 1 m 2 n 2 such that m 1 m 2 n then for f cn r 2 we employ the usual multi index notation mf m 1 m 2 f xm 11 x m 2 2 electronic density of states for incommensurate layers 7 theorem 2 3 suppose h cn r 2 for n n 0 mb 1 m b 2 h is uniformly continuous for m m n and satisfies mb 1 m b 2 h r ce r then for aj and g d h g cnper pj our next objective is to rigorously define the density of states distribution for the infinite incommensurate bilayer system h taking a sequence of finite incommensu rate clusters surrounded by vacuum that grow towards infinity and combining our results on the equidistribution of local configurations with the convergence of the local density of states we obtain the following representation formula theorem 2 4 suppose that h satisfies assumptions 2 1 and 2 2 then there exists a bounded linear functional d h c s h c such that for g we have d hr j 0 g d h g as r for j 1 2 and d h g 2 j 1 aj pj d h b g db where 1 a 2 1 a 1 2 if g d then we have the explicit error bound d h g 2 j 1 aj pj d hr j b g db cd 2 sup d z s h d g z e d r where c are independent of r d and g remark 2 1 the finite systems employed in the thermodynamic limit are defined by the matrices hr j 0 for j 1 2 they represent finite incommensurate clusters surrounded by vacuum since the boundary hamiltonian entries are not chosen by dft calculations or experimental values they will not be accurate however as long as the boundary coefficients satisfy assumption 2 2 the limit of the density of states d hr j 0 will be independent of the choice of boundary terms remark 2 2 for the sake of convenience we have chosen a circular shape for the approximating domains weaker requirements can be readily formulated e g domains should contain balls centered at the origin with radii growing to infinity while at the same time keeping a suitable bound on the surface area to volume ratio remark 2 3 the riesz markov kakutani representation theorem states that the dual space of the continuous compact functions are the radon measures since all our density of states and local density of states operators are continuous linear functionals over the space of compact continuous functions they are all radon measures remark 2 4 this methodology can easily be extended to three or more incommen surate layers but at the cost of multiple integrals since one must integrate over all relative shifts between the layers the local density of states can be easily analyzed for multiple layers without adding much to the cost 8 daniel massatt mitchell luskin christoph ortner 3 numerical simulations 3 1 quadrature to compute the integrals occuring in theorem 2 4 numerically we can use the smoothness properties from theorem 2 3 which can be strengthened further by assuming analyticity on h theorem 3 1 assume h is analytic and satisfies assumption 2 2 let sj aj i 1 ndisc i 2 ndisc 0 i 1 i 2 ndisc be the uniform discretization sample points then we have pj n 2 disc b spj aj d h b g aj pj d h b g db cd 1 sup z d z s h d g z e d ndisc for some 0 remark 3 1 in practice h has a finite cut off and hence cannot be analytic how ever we can think of it as an approximation to an exact analytic h preasymptot ically it is therefore useful to treat h as if it were itself analytic 3 2 kernel polynomial method approximation a complete eigensolve on hr j b for each quadrature point b is computationally expensive with scaling o r 6 instead we use a chebyshev kernel polynomial method kpm to compute the den sity of states 19 this method scales as o r 2 where the constant depends on the desired accuracy it yields the density of states operator as a smooth function from which multiple observables can then be computed lemma 3 1 assume that h satisfies assumptions 2 2 and 2 1 and that f c r r c and g then d h f g d d h f g d proof this result follows immediately from remark 2 3 and fubini s theorem we note that d h g g and hence 3 1 d h f g d d h g f g d g note that this bound trivially extends from to c s h moreover if f e e then the smooth function df d h f d h in the sense of equation 3 1 we now choose a convenient f recall that the chebyshev polynomials are a basis defined recursively by 3 2 t 0 e 1 t 1 e e and tn 1 e 2 etn e tn 1 e the polynomials are orthogonal in the sense that 1 1 1 1 e 2 tn e tm e de 1 0 n 2 nm electronic density of states for incommensurate layers 9 an approximation to the shifted delta function e at 1 1 is given by p e 1 1 2 m p gpmtm tm e e 1 1 where gpm 2 m 0 p m 1 cos m p 1 sin m p 1 arctan p 1 p 1 are the so called jackson coefficients designed to remove the gibbs phenomenon 19 to approximate the density of states on the interval s h e h e h we rescale p e p e e 1 1 where is a positive constant selected so that e h 1 we approximate d h by d p 2 j 1 aj pj d h b p db and subsequently approximate the integrand d h b p by d hr j b p p hr j b 0 0 1 2 m p gpmtm tm hr j b 0 0 3 3 note that for all the calculation requires the same tm hr j b 0 0 coefficients which is the core of our algorithm a the approximation error for the output d of algorithm a is estimated in the following result theorem 3 2 suppose that h satisfies assumptions 2 1 and 2 2 then for g d d h g d g d cd 2 sup d z s h d g z e d r truncation error cd 1 sup d z s h d g z e d ndisc discretization error c g p g d kernel polynomial method error here 0 are independent of the choice of d proof the truncation error follows from theorem 2 2 the discretization error from theorem 3 1 and the kernel polynomial error from 3 1 remark 3 2 if we do not assume that h is analytic and use h cn 0 r 2 in stead the truncation error above is replaced with the standard periodic discretization error 18 theorem 1 but the bound does not give the dependence of ndisc on d 10 daniel massatt mitchell luskin christoph ortner algorithm a approximate dos step 1 choose quadrature parameter ndisc n and domain truncation radius r 0 for each j 1 2 and b spj construct the matrix hr j b step 2 let ei r r such that ei j ij is the ith coordinate vector using the recursion 3 2 we compute for aj v 0 e 0 v 1 hr j b e 0 store t 0 hr j b 0 0 e 0 v 0 and t 1 hr j b 0 0 e 0 v 1 for loop 1 m p 1 vm 1 2 hr j b vm vm 1 store tm 1 hr j b 0 0 e 0 vm 1 this yields the coefficients tm hr j b 0 0 for 3 3 step 3 compute the expression d hr j b p 1 2 m p gpmtm tm hr j b 0 0 this yields a local density of states approximation which is interesting in its own right step 4 the total density of states approximation is obtained by evaluating d n 2 disc 2 j 1 aj b spj pj d hr j b p for all desired 3 3 convergence rates we briefly discuss a heuristic to choose the approxima tion parameters p ndisc n and r 0 in practice one is interested in calculating the density of states at a point or in calculating an observable d h g for g d for the first case we note that p acts similar to an approximation to the identity of width proportional to p 1 19 with well preserved regularity because of the jack son coefficients for analytic purposes we can consider p e p 1 e p for some analytic function x e c x for x s h and for some c 0 an approximation of the density of states at a given energy point is given by d h p d h p 1 p to approximate d h p we use the orem 3 2 letting d p 1 to see that the errors will be balanced if 3 4 r ndisc p log p suppose the density of states is a function i e d h g dos g d electronic density of states for incommensurate layers 11 where dos has lipschitz constant m then we can estimate dos d h p mp 1 to obtain d dos c pe ndisc p p 2 e r p mp 1 if the constants in 3 4 are chosen sufficiently small we have 3 5 d dos m c p 1 where c 0 is independent of smoothness properties of dos if the dos is c 2 at a point of interest then we may even expect 3 6 d dos cp 2 due to the fact that xe ax 2 dx 0 for any a 0 for the second case when the observable g is fixed no polynomial degree approximation parameter p we have in principle exponential decay of the error in r and ndisc this seems to imply that it would be optimal to calculate the observable directly using an eigensolve thus avoiding the slower decay in p however the decay rate in r is strongly coupled to the value of d from theorem 2 2 which is fairly small for interesting observables therefore the involved matrices are typically quite large rendering direct eigensolves impractical 3 4 numerical results we test our approximation scheme using a tight binding model for twisted bilayer graphene 5 with a relative twist angle of 6 we fix an a 1 and then verify numerically the following two results 1 as predicted in theorem 2 2 d hr 1 b p d h b p as r with exponential rate see figure 4 2 as predicted by theorem 3 2 and 3 6 d dos pointwise as p r ndisc with quadratic rate see figure 5 20 40 60 80 100 120 140 r 10 15 10 10 10 5 100 l d o s r e la t iv e e r r o r p 100 p 150 p 200 figure 4 relative error of d hr 1 0 p 0 converging to d h p 0 for increasing values of p furthermore we demonstrate the practicality of algorithm a by reproducing twisted bilayer effects in the density of states of two stacked graphene sheets with 12 daniel massatt mitchell luskin christoph ortner 60 70 80 90 100 110 120 130 p 10 1 100 r el a ti v e e rr o r d 0 relative error slope 2 figure 5 relative error of d 0 dos 0 pointwise where r and ndisc scale as in 3 4 the slope is 1 98 2 as predicted in 3 6 a relative twist of 6 as predicted in 5 see figure 6 we included the dos for monolayer graphene for comparison the conical region near the 6 energy region is called the dirac cone when the two layers interact the curve splits near the cone tip the dirac point forming two van hove singularities on either side of the tip in practice the vhs needs higher resolution we will explore how to achieve high resolutions in a future work e 2 1 5 1 0 5 0 0 5 1 1 5 d os 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 0 8 bilayer monolayer test function vhs figure 6 approximation of the dos with r 180 p 700 and ndisc 4 we can see van hove singularities vhs forming near the dirac point agreeing with theoretical results 5 we include the test function which is to scale in the e axis but not in the dos axis electronic density of states for incommensurate layers 13 4 proofs to attain bounds on the density of states objects we will use resolvent bounds as introduced in 3 we denote c a contour around s h which contains the spectrum we can write for finite h m c k and g analytic g h kk 1 2 i c g z z h 1 kkdz we will then rely on decay estimates for z h 1 kk as we will vary our choice of c to tune the error bounds 4 1 proof of theorem 2 1 although this result is conceptually close to the equidistribution theorem 20 our specific statement of the result seems to be un available hence we prefer to give a complete proof without loss of generality we let j 1 and hence pj 2 then we wish to show for g cper 2 we have 1 r 1 br r 1 br g 1 2 2 g b db upon transforming coordinates we may assume without loss of generality that a 1 id hence for some matrix a dependent on the original coordinates and vr abr we get 4 1 1 vr n z 2 abr g n 1 2 2 g x dx since c per 2 is dense in cper 2 we assume g c per 2 on expanding g into fourier modes it suffices to show 4 1 for an arbitrary fourier mode g x e 2 im a 1 2 x where m z 2 if m 0 0 then the left hand side of 4 1 converges to 1 which is the value of the right hand side for m 6 0 0 the left hand side of 4 1 vanishes so we need to prove that 1 vr n z 2 abr f n 0 as r we first rewrite 1 vr n z 2 abr f n 1 vr n z 2 abr e 2 im ta 12 n 1 vr n z 2 abr e 2 ia n where a 1 a 2 m ta 12 if both a 1 and a 2 were rational then this would contradict assumption 2 1 hence we assume without loss of generality that a 2 q let c 0 such that n z 2 abr n 1 cr cr moreover for n 1 cr cr z 2 let f 1 n 1 f 2 n 2 z 2 such that n 1 n 2 z 2 abr if and only if f 1 n 1 n 2 f 2 n 2 we can now compute 1 vr n z 2 abr e 2 ia n 1 vr n 1 cr cr z 2 e 2 ia 1 n 1 f 2 n 2 n 2 f 1 n 1 e 2 ia 2 n 2 1 vr n 1 cr cr z 2 e 2 ia 1 n 1 e 2 ia 2 f 1 n 1 1 e 2 ia 2 f 2 n 1 1 1 e 2 ia 2 14 daniel massatt mitchell luskin christoph ortner since a 2 is irrational 1 e 2 ia 2 6 0 hence we can estimate 1 vr n z 2 abr e 2 ia n 4 cr 1 e 2 ia 2 vr cr 1 which vanished in the limit r as required this completes the proof of theorem 2 1 4 2 proof of theorem 2 2 recall that g c r g is analytic on s h in particular note that is dense in c s h in the sense that for any f c s h and 0 there exists g such that g s h f this will be useful for extending the density of states operators from to c s h lemma 4 1 suppose h mn c and y 1 2 n r 2 such that h k ce y k y for some 0 let n n r 0 and suppose that for all x r 2 y j y j br x n then there exists 0 such that for all z c dist z s h d z h 1 k c d 1 e d y k y here c and are dependent on n r and c proof this is a version of lemma 2 2 from 3 in particular the previous lemma applies to the matrices hr j b to apply it we will set y r where in the following we define r r 2 r r r for the next lemma recall the definition of hr j b from 2 2 lemma 4 2 suppose that h satisfies assumptions 2 2 and 2 1 let be a set of indices and h j b be the matrix defined over with shift b relative to sheet j that is h j b r r h b apj apj r r suppose that r 0 such that r and d 0 such that d z s h d then z h j b 1 k z hr j b 1 k cd 2 min e d r k r r e d min r r k r r where c and are independent of and r see figure 7 proof we define the matrix h r j b m c such that h r j b k hr j b if k r 0 otherwise we write h j b h r j b h j b h r j b and z h j b 1 k z h r j b h j b h r j b 1 k electronic density of states for incommensurate layers 15 thus after defining b z h r j b h j b h r j b and f b 1 k we need to estimate f 1 f 0 differentiating with respect to yields f b 1 h j b h r j b b 1 k t s b 1 kt h j b h r j b ts b 1 s now h j b h r j b ts is only nonzero if t or s r we use the definition r x x x r from lemma 4 1 we have h 1 st cd 1 e d r s r t therefore we obtain the bound f t s r b 1 kt h j b h r j b ts b 1 s s t r b 1 kt h j b h r j b ts b 1 s cd 2 t s r e d r k r t r t r s r s r cd 2 s t r e d r k r t r t r s r s r c d 2 min e d r k r r e d min r r k r r hence we conclude that z h j b 1 k z hr j b 1 k f 1 f 0 1 0 f d c d 2 min e d r k r r e d min r r k r r lemma 4 2 shows that the resolvent difference is bounded by the site distances from the edge of the first cut off region the circle with radius r and the distance between the two sites this is consistent with lemma 4 1 let c be a contour around s h such that d 2 d c s h d by lemma 4 2 we have for g d that d hr j b g d hr j b g 12 i c g z z hr j b 1 0 0 z hr j b 1 0 0 c d 2 r sup z c g z e d r 16 daniel massatt mitchell luskin christoph ortner origin sheet 2 sheet 1 r 0 r r r k r r k r 0 r k r 0 r figure 7 for given sites and k we plot the relevant distances in solid lines and system radii in dotted lines for considering resolvent error in lemma 4 2 hence d hrn j b n is a cauchy sequence for rn which therefore has some limit d h b g d h is linear in g since each element of the cauchy sequence is linear further we have the error bound d h b g d hr j b g c d 2 r sup z c g z e d r since the linear functional d hr j b is bounded by d hr j b 1 we also obtain that d h b is a bounded linear functional and so has a unique extension to a bounded linear functional on the space c s h this completes the proof of theorem 2 2 4 3 proof of theorem 2 3 lemma 4 3 suppose h cn r 2 for n n and mb 1 m b 2 h is uniformly continuous for m m n we further assume the decay estimate 4 2 bm bm h r ce r then for k 0 we have b 7 z hr j b 1 kk cnper pj and we have the limit b 7 lim r z hr j b 1 kk cnper pj for d z s h 0 furthermore for all b r 2 z 7 z hr j b 1 kk is analytic in c s h proof we will only consider the derivative b 1 the treatment of higher and lower order derivatives follow the same line of argument but are more cumbersome let electronic density of states for incommensurate layers 17 k 0 for some aj then b 1 z hr j b 1 kk b 1 z hr j b 1 kk s r z hr j b 1 ks b 1 hr j b s z hr j b 1 k lemma 4 2 implies that for r r 0 r r r k s z hr j b 1 ks z hr j b 1 ks c min e r k r s r e min r r k r r s where c and are independent of r note also that for s r we have b 1 hr j b s b 1 hr j b s recalling that r k r 0 0 and employing 4 2 we estimate b 1 z hr j b 1 kk b 1 z hr j b 1 kk c s r r r r k s e r r k r r r k e r s r k b 1 hr j b s s r r r z hr j b 1 ks b 1 hr j b s z hr j b 1 k c s r r r r k s e r r r r k e r s e r s r r e r c r s r e r r s r r s r c r e r c r 2 s r e r r s min r s c r e r c e r for any choice of min where c depends on the choice of therefore as rn z hrn j b 1 kk forms a cauchy sequence and in par ticular has a limit l 1 b lim r b 1 z hr j b 1 kk next we define l b lim r z hr j b 1 kk we need to show that b 1 l exists and satisfies b 1 l l 1 we denote res b z hr j b 1 kk since b 1 h is uniformly continuous there exists a modulus of continuity such that b 1 h b b 1 h b b b we then observe that for 0 and e 1 1 0 1 res b e 1 res b z hr j b 1 b 1 hr j b o z hr j b 1 kk b 1 res b o 18 daniel massatt mitchell luskin christoph ortner here o is independent of r letting r we have 1 l b e 1 l b l 1 b o letting 0 shows that l c 1 0 per j and b 1 l l 1 which is the desired result continuity with respect to b follows the same argument analyticity with respect to z follows from section 5 2 of 7 theorem 2 3 follows immediately from lemma 4 3 4 4 proof of theorem 2 4 without loss of generality let j 1 fix g r 0 and 1 then we have d hr 1 0 g 1 r k r dk hr 1 0 g 1 r k r r dk hr 1 0 g k r dk hr 1 0 g we define a a 1 a 2 such that a r by lemma 4 2 we have for k r r and aj that dk hr 1 0 g d h modpj r k g c sup z c g z e r 1 the site k is at least a distance r 1 from the boundary of r consider the distribution d h g 2 j 1 aj pj d h b g db since the integrand is continuous with respect to b see theorem 2 3 the integration is well defined we now estimate d h g d hr 1 0 g 1 r k r r dk hr 1 0 g d h g 1 r 2 j 1 r r aj d h modpj r g 1 r 2 j 1 r r aj d h modpj r g 1 r k r dk hr 1 0 g 1 r r 1 r k r dk hr 1 0 g the first and fourth terms are easily seen to be bounded by o 1 2 by theorem 2 1 the second term converges to 0 as r finally the third term can be electronic density of states for incommensurate layers 19 estimated by 1 r 2 j 1 r r aj d h modpj r g 1 r r r dr hr 1 0 g c sup z c g z e r 1 therefore if we choose a pair of sequences j rj such that j 1 rj and rj 1 j we conclude that d hr 1 0 g d h g since d h is a bounded linear functional it can be extended as before to be a bounded linear functional over c s h 4 5 proof of theorem 3 1 we denote z z 1 z 2 c 2 let z c then if c 0 is sufficiently small and im z 1 im z 2 c c we have z hr j z 2 0 and hence c g z z hr j z 1 0 0 is analytic at z satisfying im z 1 im z 2 c c we pick a contour c enclosing s h such that d 2 d c s h d and then chose c 0 small enough but keeping c d since c g z z hr j z 1 0 0 dz is analytic with respect to z we can apply theorem 2 of 18 to deduce c g z z hr j z 1 0 0 cd 1 sup z d z s h d g z e d ndisc for some c 0 independent of r the result follows 5 conclusion the main result of this work theorem 2 4 is a representation formula for the ther modynamic limit of the electronic structure of incommensurate layered heterostruc tures the result is reminiscent of bellisard s noncommutative brillouin zone for aperiodic solids 1 replacing on site randomness with a number theoretic equidistri bution theorem crucially our representation formula lends itself to numerical approximation in 3 we formulate and analyze at a heuristic level an efficient kernel polynomial method to approximately compute the density of states in twisted bilayer graphene this preliminary exploration provides not only quantitative confirmation of our analytical results but also demonstrates the utility of our approach for applications to real material models acknowledgement the authors would like to thank stephen carr and paul cazeaux for helpful com ments on the theme of this paper 20 daniel massatt mitchell luskin christoph ortner references 1 j bellissard dynamics of dissipation chapter coherent and dissipative transport in aperiodic solids an overview pages 413 485 springer berlin heidelberg berlin heidelberg 2002 2 a h castro neto f guinea n m r peres k s novoselov and a k geim the electronic properties of graphene rev mod phys 81 109 162 jan 2009 3 h chen and c ortner qm mm methods for crystalline defects part 1 locality of the tight binding model arxiv e prints may 2015 4 a ebnonnasir b narayanan s kodambaka and c v ciobanu tunable mos 2 bandgap in mos 2 graphene heterostructures applied physics letters 105 3 2014 5 s fang r kuate defo s n shirodkar s lieu g a tritsaris and e kaxiras ab initio tight binding hamiltonian for transition metal dichalcogenides phys rev b 92 20 205108 nov 2015 6 c huang a voter and d perez the kernel polynomial method rev mod phys 78 1 mar 2006 7 t kato perturbation theory for linear operators classics in mathematics springer berlin heidelberg 1995 8 e kaxiras atomic and electronic structure of solids cambridge university press cambridge 2003 9 d s koda f bechstedt m marques and l k teles coincidence lattices of 2 d crystals het erostructure predictions and applications the journal of physical chemistry c 120 20 10895 10908 2016 10 h p komsa and a v krasheninnikov electronic structures and optical properties of realistic transition metal dichalcogenide heterostructures from first principles phys rev b 88 085318 aug 2013 11 g c loh and r pandey a graphene boron nitride lateral heterostructure a first principles study of its growth electronic properties and chemical topology j mater chem c 3 5918 5932 2015 12 g mazzi and b j leimkuhler dimensional reductions for the computation of time dependent quantum expectations siam j sci comput 33 4 2024 2038 jan 2011 13 e prodan quantum transport in disordered systems under magnetic fields a study based on operator algebras appl math res express pages 176 255 2013 14 h ro der r n silver d a drabold and j j dong kernel polynomial method for a nonorthogonal electronic structure calculation of amorphous diamond phys rev b 55 23 15382 15385 june 1997 15 r n silver h roeder a f voter and j d kress kernel polynomial approximations for densities of states and spectral functions j comp phys 124 1 115 130 1996 16 h terrones and m terrones bilayers of transition metal dichalcogenides different stackings and heterostructures journal of materials research 29 373 382 2 2014 17 g a tritsaris s n shirodkar e kaxiras p cazeaux m luskin p plecha c and e cance s perturbation theory for weakly coupled two dimensional layers journal of materials research to appear 18 j a c weideman numerical integration of periodic functions a few examples the american mathematical monthly 109 1 21 36 2002 19 a wei e g wellein a alvermann and h fehske the kernel polynomial method rev mod phys 78 275 306 mar 2006 20 a zorzi an elementary proof for the equidistribution theorem the mathematical intelligencer 37 3 1 2 2015 1 introduction outline 2 main results 2 1 incommensurate heterostructures 2 2 tight binding model 2 3 local density of states 2 4 thermodynamic limit 3 numerical simulations 3 1 quadrature 3 2 kernel polynomial method approximation 3 3 convergence rates 3 4 numerical results 4 proofs 4 1 proof of theorem 4 2 proof of theorem 4 3 proof of theorem 4 4 proof of theorem 4 5 proof of theorem 5 conclusion acknowledgement references