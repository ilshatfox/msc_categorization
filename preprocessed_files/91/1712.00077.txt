fluctuation identities with continuous monitoring and their application to price barrier options carolyn e phelan financial computing and analytics group department of computer science university college london c phelan cs ucl ac uk daniele marazzina department of mathematics politecnico di milano daniele marazzina polimi it gianluca fusai department of economics and business studies disei universita del piemonte orientale amedeo avogadro novara faculty of finance cass business school city university london gianluca fusai unipmn it gianluca fusai 1 city ac uk guido germano financial computing and analytics group department of computer science university college london systemic risk centre london school of economics g germano ucl ac uk g germano lse ac uk december 4 2017 abstract we present a numerical scheme to calculate fluctuation identities for exponential le vy processes in the continuous monitoring case this includes the spitzer identities for touching a single upper or lower barrier and the more difficult case of the two barriers exit prob lem these identities are given in the fourier laplace domain and require numerical inverse transforms thus we cover a gap in the literature that has mainly studied the discrete mon itoring case indeed there are no existing numerical methods that deal with the continuous case as a motivating application we price continuously monitored barrier options with the underlying asset modelled by an exponential le vy process we perform a detailed error analysis of the method and develop error bounds to show how the performance is limited by the truncation error of the sinc based fast hilbert transform used for the wiener hopf factorisation by comparing the results for our new technique with those for the discretely monitored case which is in the fourier z domain as the monitoring time step approaches 1 ar x iv 1 71 2 00 07 7 v 1 q fi n c p 3 0 n ov 2 01 7 zero we show that the error convergence with continuous monitoring represents a limit for the discretely monitored scheme keywords finance wiener hopf factorisation hilbert transform laplace transform spectral filter 1 introduction identities providing the fourier z transform of probability distribution functions of the extrema of a random path subject to monitoring at discrete intervals were first published by spitzer 1956 they were extended to the continuous case by baxter and donsker 1957 and to double barriers by kemperman 1963 the identities for the minimum and maximum of a path for use with a single upper or lower barrier and for the two barrier exit problem are comprehensively described in the discrete monitoring case by fusai et al 2016 who proposed numeric methods to compute them for exponential le vy processes the discretely and continuously monitored identities are in the fourier z and fourier laplace domains respectively this means that with the application of the inverse z or laplace transform as appropriate they can be used within fourier transform option pricing methods which we will use as an example in this paper the relevance of the spitzer identity in several fields within operational research is nowadays well recognised we mention for example the application to queuing systems see the classical contributions by cohen 1975 1982 and prabhu 1974 and more recent work by bayer and boxma 1996 markov chains rogers 1994 insurance chi and lin 2011 inventory systems cohen and pekelman 1978 grassmann and jain 1989 and applied probability grassman 1990 as well as in mathematical finance pricing derivatives especially exotic options is a challenging problem often covered also in the operations research literature see e g kou 2008 fusai et al 2016 provide extensive references for this as well as for many non financial applications of the hilbert transform and the related topics of wiener hopf factorisation and spitzer identities in insurance queuing theory physics engineering applied mathematics etc derivative pricing with fourier transforms was first investigated by heston 1993 carr and madan 1999 published the first method with both the characteristic function and the payoff in the fourier domain fang and oosterlee 2008 2009 devised the cos method based on the fourier cosine expansion the hilbert transform king 2009 has also been successfully employed by feng and linetsky 2008 to price barrier options using backward induction in fourier space and by marazzina et al 2012 and fusai et al 2016 to compute the factorisations required by the spitzer identities via the plemelj sokhotsky relations feng and linetsky showed that computing the hilbert transform with the sinc expansion as studied by stenger 1993 2011 gives errors that reduce exponentially as the number of fast fourier transform fft grid points increases however the feng and linetsky method cannot be extended to continuously monitored options because its recursive structure makes it an inherently discrete scheme in contrast green et al 2010 showed that methods based on the spitzer identities can be extended to continuous monitoring using the laplace transform in the time domain rather than the z transform in this article we implement a method to numerically calculate the required wiener hopf 2 factors and thence the spitzer identities in continuous time we apply this to price continuously monitored options with general exponential le vy processes for continuous monitoring the wiener hopf factorisation can be done analytically if the characteristic exponent is rational i e for the gaussian and kou double exponential processes or in some special cases e g when the jumps are only positive or negative it is also possible to approximate a non rational exponent with a rational one that is easily factored kuznetsov 2010 however an analytical solution for the continuous monitoring case which is usable for any exponential le vy process and does not require approximation has not been found yet in the discrete case an analytical wiener hopf factorisation can be done only for a gaussian process fusai et al 2006 but from a numerical point of view the problem is easier and there are a number of papers dealing with exponential le vy processes however it is well known that the convergence of numerical methods for discrete monitoring to the continuous monitoring limit are very slow see e g broadie et al 1997 therefore this work contributes to the literature both in probability as well as in applied mathematics and operational research by providing a method to find exit probabilities in the continuous monitoring case with non rational characteristic exponents whereas previous numerical methods have concentrated on the discrete monitoring case this method follows the approach suggested by green et al 2010 and is based on the fusai germano and marazzina fgm method fusai et al 2016 with spectral filtering phelan et al 2017 while the latter is for discrete monitoring and thus in the fourier z domain here we operate in the fourier laplace domain besides the discrete fourier transform dft or actually the fast fourier transform fft which is a standard technique we also require a numerical inverse laplace transform for the latter we used a algorithm proposed by abate and whitt 1992 a 1995 which is based on a fourier series and is derived in a similar way to their well established numerical inverse z transform abate and whitt 1992 b the error convergence is slightly worse than first order polynomial we explain this in detail with reference to the truncation error of the sinc based discrete hilbert transform our results show that the error convergence is consistent with the error bound and the performance of the discretely monitored technique as the monitoring interval goes to zero the structure of this paper is as follows in section 2 we briefly run through fourier hilbert laplace and z transforms and explain how they are used for the calculation of the spitzer identities we then present a numerical pricing scheme for continuously monitored options and explain its relationship with the fgm pricing scheme with discrete monitoring section 3 provides a discussion of the error convergence of the pricing technique with special reference to the truncation error of the sinc based hilbert transform section 4 shows the results that were achieved comparing them with the results for the fgm method for discretely monitored options 2 fourier transform methods for option pricing in this paper we make extensive use of the fourier transform see e g kreyszig 2011 polyanin and vladimirovich 1998 an integral transform with many applications historically it has been widely employed in spectroscopy and communications therefore much of the literature 3 refers to the function in the fourier domain as its spectrum according to the usual convention in financial literature the forward and inverse fourier transforms are defined as f fx f x ei xf x dx 1 f x f 1 x f 1 2 e i xf d 2 let s t be the price of an underlying asset and x t log s t s 0 its log price to find the price v x t of an option at time t 0 when the initial price of the underlying is s 0 s 0 and thus its log price is x 0 0 we need to discount the expected value of the undamped option payoff x t e x t at maturity t t with respect to an appropriate risk neutral probability distribution function pdf p x t whose initial condition is p x 0 x as shown by lewis 2001 this can be done using the plancherel relation v 0 0 e rte x t e x t x 0 0 e rt x e xp x t dx e rt 2 p i t d e rtf 1 x p i t 0 3 here p i t is the complex conjugate of the fourier transform of e xp x t to price options using this relation we need the fourier transforms of both the damped payoff and the pdf a double barrier option has the damped payoff x e xs 0 e x ek 1 l u x 4 where e x is the damping factor 1 for a call 1 for a put 1 a x is the indicator function of the set a k log k s 0 is the log strike u log u s 0 is the upper log barrier l log l s 0 is the lower log barrier k is the strike price u is the upper barrier and l is the lower barrier the fourier transform of the damped payoff x is available analytically s 0 e 1 i a e 1 i b 1 i ek i a ek i b i 5 where for a call option a u and b max k l while for a put option a l and b min k u the fourier transform of the pdf p x t of a stochastic process x t is the characteristic function t e ei x t ei xp x t dx fx p x t p t 6 for a le vy process the characteristic function can be written as t e t where the characteristic exponent is given by the le vy khincine formula as i 1 2 2 2 r ei 1 i 1 1 1 d 7 the le vy khincine triplet uniquely defines the le vy process defines the linear drift of the process is the volatility of the diffusion part of the process and the jump part of the 4 process is specified so that is the intensity of a poisson process with jump size under the risk neutral measure the parameters of the triplet are linked by the equation r q 1 2 2 r e 1 i 1 1 1 d 8 where r is the risk free interest rate and q is the dividend rate in general the characteristic function of a le vy process is available in closed form for example for the gaussian schoutens 2003 normal inverse gaussian nig barndorff nielson 1998 cgmy carr et al 2002 kou double exponential kou 2002 merton jump diffusion merton 1976 le vy alpha stable nolan 2017 variance gamma vg madan and seneta 1990 and meixner schoutens 2003 processes some pricing techniques based on the fourier transform also use the hilbert transform which is an integral transform related to the fourier transform unlike with the fourier transform the function under transformation remains in the same domain rather than moving between the x and domains the hilbert transform of a function in the fourier domain is defined as h f p v 1 f d lim 0 1 1 f d 1 f d 9 where p v denotes the cauchy principal value applying the hilbert transform in the fourier domain is equivalent to multiplying the function in the x domain by i sgnx whilst the fourier and hilbert transform operate on the state variable here the log price the laplace transform is applied to time the forward and reverse laplace transforms are lt s f t f s 0 e stf t dt s c 10 l 1 s t f s f t 1 2 i a i a i estf s ds 11 where a r is on the right of all singularities of f s in the complex plane the laplace transform is closely related to the z transform of a discrete function f tn f n n n 0 zn q f n n 0 qnf tn q c 12 given a continuous function fc t we define the discrete function fd tn consisting of sampled values of the former where t is the sampling interval and tn n t are the sampling times then with a z transform parameter q e s t the laplace and z transforms are related in the 5 limit t lt s fc t 0 e stfc t dt lim t 0 t n 0 e sn tfc n t lim t 0 t n 0 e s t nfd tn lim t 0 t n 0 qnfd tn lim t 0 tz fd tn 13 2 1 spitzer identities for continuous monitoring if we wish to use eq 3 to price barrier options the required characteristic functions are more complicated than the closed form expressions referred to above we need the characteristic function of the pdf of the value of a stochastic process x t at time t t conditional on the process remaining inside continuously monitored upper and lower barriers we use the identities published by spitzer 1956 which were extended to the continuously monitored case by baxter and donsker 1957 and to double barriers by kemperman 1963 the spitzer identities provide the fourier z transform of the pdf of a stochastic process x t at time t t conditional on whether x t reaches a barrier at discretely monitored times the fourier transform is applied to the process values and the z transform is applied to the discrete monitoring times baxter and donsker 1957 demonstrated that we can obtain the equivalent identities for continuously monitored barriers in the fourier laplace domain green et al 2010 showed that the relationship between the laplace and z transforms described in eq 13 can be exploited to price continuously monitored options using the spitzer identities in the fourier laplace domain an important aspect in the calculation of the spitzer identities is the decomposition of a function f into and parts f fx f x 1 r x and f fx f x 1 r x such that f f f this can be done directly in the fourier domain using the plemelj sokhotsky relations king 2009 fusai et al 2016 f 1 2 f ih f 14 f 1 2 f ih f 15 the shift theorem fx f x b f e ib allows to obtain the generalised plemelj sokhotsky relations for an arbitrary barrier b f b 1 2 f eib ih e ib f 16 f b 1 2 f eib ih e ib f 17 the calculation of the spitzer identities also requires to factorise a function i e obtain g and g such that g g g this is achieved by decomposing the logarithm h log g and then exponentiating the results to obtain g exp h and g exp h green et al 2010 dealt with fluctuation identities that can be used for lookback single 6 barrier and double barrier options here we concentrate on the identities for single barrier down and out and double barrier options the first step is always to factorise c s s c s c s for a single barrier down and out option the laplace transform of the required characteristic function is p s 1 c s pcl s c s pcl s c s 18 where pc s 1 c s is decomposed with respect to the lower log barrier l using eqs 16 and 17 for a double barrier option the laplace transform of the required characteristic function is p s 1 c s jcl s c s jcu s c s 19 where jcu s and jcl s are the solution to the pair of coupled equations jcu s 1 c s jcl s c s u 20 jcl s 1 c s jcu s c s l 21 for u jcu 0 and jcl pcl thus recovering the spitzer identity for the single barrier eq 18 the latter can be calculated directly while so far only an iterative solution has been found fusai et al 2016 phelan et al 2017 to the coupled eqs 20 and 21 2 1 1 relationship to the spitzer identities for discrete monitoring in section 4 we show numerical results comparing the error convergence obtained using the spitzer identities for continuous monitoring with the performance of the closely related method using the spitzer identities for discrete monitoring green et al 2010 fusai et al 2016 phelan et al 2017 the relationship between the two methods originates in the connection between the z transform and the laplace transform described in eq 13 as described in section 2 1 the first step in pricing continuously monitored barrier options is the calculation of c s s in the fourier laplace domain the equivalent quantity in the fourier z domain for discrete monitoring is q 1 q t we can use the relation in eq 13 with q e s t to relate the two lim t 0 t q lim t 0 t 1 q t lim t 0 t 1 e s te t lim t 0 t 1 e s t 1 s 1 c s 22 the same factorisation and decomposition steps described in section 2 1 green et al 2010 fusai et al 2016 are applied to both q and c s to price options with respectively discrete or continuous monitoring 7 2 2 numerical methods the methods in the previous section are described analytically however as they involve some expressions which cannot be solved in closed form their implementation requires the use of numerical approximation techniques which we discuss in the following sections 2 2 1 discrete fourier and hilbert transforms and spectral filters the forward and inverse fourier transforms shown in eq 1 and eq 2 are integrals over an infinite domain and in order to implement them numerically we need to approximate each with a discrete fourier transform dft we implement this in practice using the built in matlab fft function which is based on the fftw library by frigo and johnson 1998 the calculation of the hilbert transform of a function f can be realised with an in verse forward fourier transform pair and multiplication by the sign function in between ih f fx sgn x f 1 xf 23 however this gives an error convergence which is polynomially decreasing with the number of grid points m in order to obtain exponential error convergence feng and linetsky 2008 and fusai et al 2016 have implemented the hilbert transform using the sinc expansion techniques studied by stenger 1993 2011 stenger showed that given a function f which is analytic in the whole plane the function and its hilbert transform can be expressed as f k f k sin k k 24 h f k f k 1 cos k k 25 where is the grid step in the fourier domain stenger 1993 also showed that when the function f is analytic in a strip of the complex plane including the real axis the expressions in eqs 24 and 25 are approximations whose error decays exponentially as decreases in addition to discretisation the infinite sum in eq 25 must also be truncated to the grid size m so that the hilbert transform approximation becomes h f m 2 k m 2 f k 1 cos k k 26 feng and linetsky 2008 2009 showed that if f decays at least exponentially as i e f exp c then the error in the hilbert transform and thus in the plemelj sokhotsky relations caused by truncating the series in eq 25 is also exponentially bounded furthermore feng and linetsky showed that if f is polynomially bounded then although the accuracy of the series in eq 25 is retained the error caused by truncating the sum is no longer exponentially bounded however it has subsequently been shown that multiplying the input to the hilbert transform by a filter can improve the error convergence phelan et al 8 figure 1 shape of the exponential filter plotted with different values of p 2017 in the papers by gottlieb and shu 1997 and vandeven 1991 a filter of order p is defined as a function supported on 1 1 with the properties a 0 1 l 0 0 b 0 for 1 27 c cp 1 the scaled variable is related to in our application as max in this paper we use the exponential filter which has the form gottlieb and shu 1997 e p 28 where p is even this does not strictly meet criterion b in eq 27 as it does not go exactly to zero when 1 however if we select log 10 where 10 is the machine precision then the filter coefficients are within computational accuracy of the requirements the exponential filter has the advantages that it has a simple form and that it can be used for any even value of p moreover the order of the filter is a parameter which is directly input to the filter equation filter shapes for a range of p values are shown in figure 1 many filters other than the exponential can be used e g the planck taper phelan et al 2017 and the raised cosine ruijter et al 2015 2 2 2 inverse laplace transform the spitzer identities provide the laplace transform of the characteristic function so to calcu late the option price using eq 3 we must apply the inverse laplace transform we implement the numerical scheme by abate and whitt 1995 which uses the trapezoidal rule to approxi mate the analytic expression for the inverse laplace transform shown in eq 11 with f t ea 2 2 t ref a 2 t ea 2 t k 1 1 kref a 2 k i 2 t 29 9 0 20 40 60 80 100 t 0 2 0 0 2 0 4 0 6 0 8 1 1 2 1 4 f t a 18 4 m e 11 n e 10 m e 61 n e 100 m e 111 n e 1000 0 20 40 60 80 100 t 0 2 0 0 2 0 4 0 6 0 8 1 1 2 1 4 a 23 m e 11 n e 10 m e 61 n e 100 m e 111 n e 1000 0 20 40 60 80 100 t 0 2 0 0 2 0 4 0 6 0 8 1 1 2 1 4 a 27 m e 11 n e 10 m e 61 n e 100 m e 111 n e 1000 figure 2 output of the inverse laplace transform of f s e 10 s s increasing ne and me reduces the size of the oscillations but it is not improved by increasing a where f a 2 k i 2 t is the laplace transform f s with s a 2 k i 2 t the value of a is selected to control the accuracy of the approximation for an accuracy of 10 we must select a log 10 we then use the euler transform to accurately approximate this infinite series first the partial sums bk ea 2 2 t ref a 2 t ea 2 t k j 1 1 jref a 2 j i 2 t 30 are calculated for k ne ne me we then take the binomially weighted average euler transform of these terms i e f t 1 2 me me k 0 me k bne k 31 the values of ne and me are selected large enough to give sufficient accuracy but low enough to avoid unnecessary computational effort numerical tests were carried out inverting the laplace transform of a delayed unit step function f s e s s where the delay 10 this is an extreme test case as the step function has a jump discontinuity and abate and whitt 1992 a state that the performance bound of 10 e a does not apply in the presence of jumps however it is important to consider the performance of the inverse laplace transform with discontinuities in the time domain as the value of the contracts that we are pricing will abruptly become zero on expiry the recovered functions for different values of a ne and me are shown in figure 2 and the errors are shown in figures 3 and 4 the empirical results in figure 4 show that we can select values for a me and ne so that away from the discontinuity the performance matches the bound of 10 e a specified by abate and whitt furthermore we show in sections 3 and 4 that the error bounds and observed results for the pricing procedure are limited by the performance of the sinc based hilbert transform therefore we can use the abate and whitt inverse laplace transform method to price mid to long dated options we base the selection of the parameters for the inverse laplace transform on the empirical results from figures 2 and 3 we can see that the size of the oscillations due to the disconti 10 0 20 40 60 80 100 t 0 5 0 0 5 e rr o r a 18 4 m e 11 n e 10 m e 61 n e 100 m e 111 n e 1000 0 20 40 60 80 100 t 0 5 0 0 5 a 23 m e 11 n e 10 m e 61 n e 100 m e 111 n e 1000 0 20 40 60 80 100 t 0 5 0 0 5 a 27 m e 11 n e 10 m e 61 n e 100 m e 111 n e 1000 figure 3 error of the inverse laplace transform of f s e 10 s s increasing ne and me reduces the size of the errors due to the oscillations but it is not improved by increasing a 20 40 60 80 100 t 1 015 1 02 1 025 1 03 1 035 e rr o r 10 8 a 18 4 m e 61 n e 100 m e 111 n e 100 m e 61 n e 1000 m e 111 n e 1000 20 40 60 80 100 t 1 0 1 2 3 4 5 10 10 a 23 m e 61 n e 100 m e 111 n e 100 m e 61 n e 1000 m e 111 n e 1000 20 40 60 80 100 t 5 0 5 10 10 10 a 27 m e 61 n e 100 m e 111 n e 100 m e 61 n e 1000 m e 111 n e 1000 figure 4 error of the inverse laplace transform of f s e 10 s s increasing a decreases the error floor while the latter is unaffected by increasing ne and me the noise on the error floor is 10 10 11 nuity are predominantly affected by me and ne the error floor is controlled by a the values of 18 4 23 and 27 in figures 2 4 correspond to errors of approximately 10 8 10 10 and 10 12 respectively however figure 4 shows that the noise around the error floor is 10 10 and therefore there is no advantage in selecting values of a larger than 23 for the pricing calcula tions we use a 23 me 61 and ne 100 which give a combination of high accuracy and fast computation time 2 2 3 pricing procedure single barrier options we describe the pricing procedure for single barrier down and out options as an example but the use of the spitzer identities is equally applicable to other types of barrier options and also to lookback options the pricing formulae described by green et al 2010 include methods for single barrier up and out and knock in options the pricing method is adapted from the scheme by fusai et al 2016 and phelan et al 2017 using the relationship between q and c s described in section 2 1 1 1 compute the characteristic exponent i where is the damping parameter intro duced in section 2 eq 4 2 use the plemelj sokhotsky relations with the sinc based hilbert transform to factorise c s s i c s c s 32 for all s a 2 k i 2 t required for the inverse laplace transform in eq 30 3 decompose with respect to l pc s max c s pcl s pcl s 33 and calculate p s pcl s c s 34 where max is an exponential filter of order p see section 3 2 4 calculate the option price as v 0 0 f 1 x l 1 s t p s 0 35 where is the complex conjugate of the fourier transform of the damped payoff function given in eq 5 2 2 4 pricing procedure double barrier options the pricing procedure for double barrier options is very similar to the method for the single barrier options described in section 2 2 3 in that it uses wiener hopf factorisation and decom position to compute the appropriate spitzer identity however the major difference in this case is that the equations cannot be solved directly and so require the use of a fixed point algorithm 12 the steps in the pricing procedure are the same as those for single barrier down and out options described in section 2 2 3 with the exception of step 3 which is now replaced by the fixed point algorithm 3 a set jcu s jcl s 0 b decompose with respect to l pc s max 1 c s jcu s c s pcl s pcl s 36 and set jcl s pcl s c decompose with respect to u qc s max 1 c s jcl s c s qcu s qcu s 37 and set jcu s qcu s d calculate p s max 1 c s jcl s c s jcu s c s 38 e if the difference between the new and the old value of p s is less than a predefined tolerance or the number of iterations is greater than a certain threshold then continue otherwise return to step b numerical tests have shown that an iteration threshold of 5 is sufficient as higher values do not yield improvements 3 error convergence of the pricing procedure we examine the performance of each stage of the pricing procedure and discuss the respective error bounds in addition the effect of each step on the shape of the output function in the fourier domain is investigated as this influences the error convergence of later steps stenger 1993 showed that the discretisation error in eq 25 is exponentially convergent when the function f is analytic in a strip of the complex plane including the real axis therefore the error calculations here concern the truncation error from the approximation in eq 26 the truncation error using the sinc based hilbert transform depends on the behaviour of the characteristic exponent as table 1 shows the characteristic exponents of five le vy processes the damping parameter is omitted to make the notation more concise which is appropriate as its value becomes insignificant as 3 1 factorisation after calculating the characteristic exponent the next step in the pricing procedure is the numerical factorisation of c s s in order to understand the error convergence we must consider the way that the function behaves for large values of the characteristic 13 process characteristic exponent normal i 1 2 2 2 kou i 1 2 2 2 1 2 2 i 1 1 i merton i 1 2 2 2 ei 1 2 2 2 1 nig 2 i 2 2 2 vg 1 log 1 i 1 2 2 2 table 1 characteristic exponent of some le vy processes exponents of the processes listed in table 1 will take high negative values which will dominate c s so that as we can approximate s the function to be decomposed in the factorisation stage is therefore log this is an increasing function in so the bounds for the truncation error of the sinc based hilbert transform feng and linetsky 2008 theorems 6 4 6 6 cannot be used moreover if we consider the truncation errors from eq 26 for positive and negative values of k individually we obtain two infinite summations that do not converge however table 1 shows that as the values of and will become increasingly similar we can exploit this similarity to find a bound by combining the positive and negative truncations the truncation error of f h log c s is bounded as f f m k m 2 log c k s k k m 2 log c k s k k m 2 log c k s k log c k s k k m 2 log c k s log c k s 2 k 2 2 k m 2 k log c k s log c k s 2 k 2 2 39 where f is the value of the infinite summation in eq 25 and f m is the result of the truncated summation in eq 26 the next step in bounding the error convergence is to show that the expression in eq 39 is dominated by the first sum as m as k k for k log c k s log c k s 0 as k however k is also present in the numerator and increases linearly with k by determining the rate of decrease of log c k s log c k s we show that the second term is bounded as o 1 k 2 and therefore the first term dominates eq 39 we then calculate a bound for the error based on the first summation term in eq 39 these steps are carried out in a slightly different way depending on the form of the characteristic exponents shown in table 1 14 3 1 1 normal merton and kou processes for the normal merton and kou processes when k c k becomes dominated by k 2 i k as shown in table 1 the parameters and are specific to the distribution we can therefore approximate the second expression in the summation by k log c k s log c k s 2 k 2 2 k 2 k 2 2 log c k s c k s k 2 k 2 2 log 2 k 2 2 i k 2 k 2 2 i k k 2 k 2 2 log 1 2 i 2 k 1 2 i 2 k 40 the logarithm in eq 40 is of the form log 1 x 1 x where x 2 i 2 k for x 0 log 1 x 1 x 2 x thus k 2 k 2 2 log 1 2 i 2 k 1 2 i 2 k k 2 k 2 2 4 i 2 k 4 i 2 2 k 2 2 41 gives an approximation for the second term in eq 39 due to the denominator this is o 1 k 2 thus as log c k s log c k s is increasing in k the error is indeed dominated by the first term in eq 39 for the normal kou and merton processes c k s and c k s 2 log k as k therefore the error bound is f f m c k m 2 log c k s 2 k 2 2 c 1 k m 2 log k 2 2 k 2 2 42 where c and c 1 are some constants here as eq 42 gives the error at fixed values of i e the chosen grid points the can be absorbed into c however as m increases our range of values increases therefore as there is a linear dependence of the error bound on we should consider the effect of errors at large values of on the error of the final solution in doing this we can take account of the shape of the output from the factorisation c s which decays as and the use of filtering on the input to the next step as described in section 3 2 these effects combine to mean that the error as a proportion of the value of c s at high is less significant to the error of the overall solution than the relationship between the value of m and the error in c s for low values of approximating the summation by an integral 15 10 0 10 1 10 2 10 3 10 4 10 5 10 6 m 10 10 10 8 10 6 10 4 10 2 e rr o r b o u n d e s ti m a te 0 001 0 0005 0 0002 0 0001 am 1 figure 5 eq 44 plotted for different values of to show the estimate of the error bound on the sinc based numerical factorisation of c s notice that the predicted error bound from the factorisation has a decay that increases in slope as m increases and is slightly shallower than o 1 m for the values of m which we are using sections 3 1 1 3 1 2 and 3 1 3 show that this bound applies for the normal nig kou merton and vg processes with m m 2 we obtain f f m c 2 m log 2 d c 2 log 1 m c 2 logm m 1 m 43 where c 2 is some constant having applied the sinc based discrete hilbert transform we can calculate the positive and negative functions using the plemelj sokhotsky relations and then exponentiate the results to obtain the wiener hopf factors therefore using the expression in eq 43 we can bound the truncation error of the wiener hopf factors and by extension the total error as the truncation error dominates as c m c c 1 em m 44 where is some constant here c denotes the theoretical wiener hopf factors gen erated using the series in eq 25 and m c denotes the wiener hopf factors calculated using the truncated summation in eq 26 figure 5 shows eq 44 plotted against m for different values of this demonstrates that the predicted error bound from the factorisation has a decay that increases in slope as m increases and is slightly shallower than o 1 m for the values of m which we are using 16 3 1 2 normal inverse gaussian process in the case of the nig process the characteristic exponent is 2 i 2 2 2 45 the presence of a square root around the i and 2 terms means that as k the equiva lent expression to the logarithm in eq 40 is 1 2 log 1 2 i k 1 2 i k furthermore c k s and c k s become dominated by log k as k therefore the only difference be tween the truncation error bound for the nig process and the result in eq 43 is the size of the constants 3 1 3 variance gamma process the characteristic function of the vg process is 1 log 1 i 1 2 2 2 46 this is significantly different from the other characteristic exponents that we have considered being the log of a polynomial similarly to the previous methods we show that as k the decrease rate of log c k s c k s is at least o 1 k log c k s c k s log log ik 2 k 2 2 log ik 2 k 2 2 log log 1 2 ik 2 k 2 log 2 k 2 2 log 1 2 ik 2 k 2 log 2 k 2 2 log 2 ik 2 k 2 log 2 k 2 2 2 ik 2 k 2 log 2 k 2 2 log 1 2 i 2 k log 2 k 2 2 1 2 i 2 k log 2 k 2 2 4 i 2 k log 2 k 2 2 47 this decreases quicker than o 1 k and thus eq 39 is dominated by the first term the equivalent expression to eq 42 for the vg process is f f m c k m 2 log c k s 2 k 2 2 c 1 k m 2 log log k 2 2 k 2 2 48 as log log x is bounded by log x as x the factorisation error of the method with the vg process is also bounded by eq 44 17 figure 6 example plot of the real and imaginary parts of c s plotted against with s a 2 t as specified for the abate and whitt inverse laplace transform notice that although the value of c s is bounded by a constant as the rate of decay is very slow and we have not been able to determine a decreasing bound 3 2 decomposition error the output of the factorisation is shown in figure 6 the next step in the calculation is to find the positive part with respect to l of pc s 1 c s we can attempt to bound the truncation error of this calculation by combining the errors from the positive and negative truncations as before f f m k m 2 pc k k k m 2 pc k k k m 2 pc k k pc k k k m 2 pc k pc k 2 k 2 k pc k pc k 2 k 2 49 figure 6 shows that for high pc pc is bounded from above by a constant however we do not have a decreasing bound for pc pc therefore we can only bound the second term in eq 49 as k m 2 k pc k pc k 2 k 2 c k m 2 k 2 k 2 50 where c is some positive constant this does not converge we can compare it with the discretely monitored version from fusai et al 2016 where the first date is taken out of the scheme mean ing that the function undergoing decomposition is multiplied with the characteristic function for processes other than vg this restores the exponential slope of the function for high values 18 of which again means that the truncation error of the sinc based discrete hilbert transform is exponentially bounded to improve the error of the decomposition in the continuously mon itored case we can improve the slope of the function on the input to the hilbert transform by using a spectral filter we use an exponential filter which has previously achieved good results in option pricing applications ruijter et al 2015 phelan et al 2017 the filter is described by eq 28 and its shape is shown in figure 1 numerical tests have shown that the use of this filter improves the error of the decomposition step so that it no longer limits the error convergence of the pricing scheme however the overall error of the pricing procedure will be continue to be limited by the error from the initial factorisation step as described in eq 44 and shown in figure 5 4 results we present results for the spitzer laplace pricing procedure for continuously monitored single and double barrier options for the nig kou and vg processes we also show that the error convergence represents a limiting case of the performance of the fgm method for discretely monitored options as n and t 0 where n is the number of monitoring dates and t is the time interval between them 4 1 results for spitzer laplace method for continuously monitored options the error convergence for single barrier down and out options is shown in figure 7 figure 8 shows the results for double barrier options the computed prices are given in tables 2 and 3 for single and double barrier options respectively although the absolute error is worse for double barrier options the speed of error convergence is very similar for all cases and is slightly worse than o 1 m which concurs with the simulated results for the factorisation error shown in figure 5 the details of the contract and underlying processes are shown in table 6 in appendix a 10 2 10 3 10 4 10 5 10 6 m 10 8 10 7 10 6 10 5 10 4 a b s o lu te e rr o r o f th e s o lu ti o n nig price am 1 10 2 10 3 10 4 10 5 10 6 m 10 8 10 7 10 6 10 5 10 4 a b s o lu te e rr o r o f th e s o lu ti o n kou price am 1 10 2 10 3 10 4 10 5 10 6 m 10 8 10 7 10 6 10 5 10 4 a b s o lu te e rr o r o f th e s o lu ti o n vg price am 1 figure 7 error convergence for a continuously monitored single barrier option the error con vergence conforms to the calculated error bound only the first point of the kou process deviates slightly from the overall behaviour and shows the typical sub polynomial error convergence for higher values of m 19 10 2 10 3 10 4 10 5 10 6 m 10 4 10 3 10 2 10 1 10 0 a b s o lu te e rr o r o f th e s o lu ti o n nig price am 1 10 2 10 3 10 4 10 5 10 6 m 10 4 10 3 10 2 10 1 10 0 a b s o lu te e rr o r o f th e s o lu ti o n kou price am 1 10 2 10 3 10 4 10 5 10 6 m 10 4 10 3 10 2 10 1 10 0 a b s o lu te e rr o r o f th e s o lu ti o n vg price am 1 figure 8 error convergence for the continuously monitored double barrier option the absolute error is worse than that for the single barrier option but the error convergence conforms to the calculated error bound process price normal inverse gaussian 4 77403523401 e 2 kou 4 32042632202 e 2 variance gamma 4 70627023105 e 2 table 2 prices calculated for single barrier options with the contract details and process pa rameters described in table 6 in appendix a and m 217 process price normal inverse gaussian 2 78787488 e 2 kou 3 30368034 e 2 variance gamma 2 82666693 e 2 table 3 prices calculated for double barrier options with the contract details and process parameters described in table 6 in appendix a and m 217 20 4 2 comparison with the error convergence of spitzer z pricing method for discretely monitored options in section 2 1 1 we described the relationship between the fourier laplace based method for continuously monitored options and the fgm method based in the fourier z domain for discretely monitored options the latter method as measured for a single barrier in fusai et al 2016 and double barriers in phelan et al 2017 with the number of monitoring dates up to n 103 is exponentially convergent with the number of grid points for the nig and kou processes and better than second order polynomially convergent for the vg process therefore we investigate the performance of the discretely monitored method with a very high number of dates i e t 0 to better understand the difference in performance between the two pricing schemes in green et al 2010 the error between the discretely and continuously monitored prices was shown to be bounded as o 1 n where n is the number of monitoring dates we therefore also consider whether lower errors might be achieved by approximating the price for a continuously monitored option with the price for a discretely monitored option with a very high number of monitoring dates we use the same implementation as the one described in fusai et al 2016 for single barrier options and phelan et al 2017 for double barrier options although the maximum number of monitoring dates is far higher than would ever be used for discretely monitored options in practice due to the o 1 n error bound between the prices for continuously and discretely monitored options we must select a very large number of monitoring dates in order for this effect to be less significant than the error from the continuously monitored pricing method the error convergence of the discrete pricing method as n or t 0 is shown in figures 10 and 11 the results show that as t 0 the error convergence for discrete monitoring degrades until it approaches that of continuously monitored options moreover it demonstrates that rather than being an anomaly the error convergence of the continuously monitored method is consistent with that of the discretely monitored method as t 0 this can be understood by considering how t changes with t for the discrete example as t 0 t e t decays to 0 more and more slowly as therefore the error convergence of the pricing technique for continuously monitored barrier options is a limit of the error convergence for the discrete case as t 0 computed prices for continuously and discretely monitored options are plotted against m in figures 12 and 13 in addition computation times of the pricing methods for the discrete and continuously monitored methods are shown in tables 4 and 5 figures 12 and 13 show that as expected the larger the number of monitoring dates the closer the price is to the continuously monitored price however they also show that the direction of convergence depends on the type of option and the process being used therefore in order to obtain the cpu times in tables 4 and 5 we take the lowest time where the convergence error for the discretely monitored method is significantly lower i e ten times than the error compared to the price for the continuously monitored case with maximum m this shows that for relatively high errors 10 4 for a single barrier and 10 2 for double barriers the discretely monitored method is slightly quicker however the discretely monitored method is unable to achieve the lower 21 errors 10 6 for a single barrier and 10 4 for double barriers which are attained by the continuously monitored method and therefore is not a sufficiently accurate approximation can we can achieve a better approximation of the continuous method by increasing the number of monitoring dates further previous literature e g green et al 2010 has shown that the convergence of the discrete method to the continuous method with increasing monitoring dates is o 1 n from figure 9 we can observe that although the discrete method with the kou process does indeed have this rate of convergence it achieves approximately o 1 n with the nig and vg processes therefore if we wished to decrease the error of the discrete approximation so that it is significantly i e ten times less than the continuous case then we would have to increase the maximum number of monitoring dates in tables 4 and 5 by 100 times for the nig and vg processes and by 2002 times for the kou process we can see from figures 10 and 11 that at m 217 the discrete methods with these numbers of dates have an error which is worse than the required accuracy of ten times better than the continuous method thus the only possibility would be to also increase m and by extension the cpu time of the discrete monitoring method causing its computational cost to be greater than that for continuous monitoring process dates error time m and cont 3 21 e 04 0 07 1024 1008 1 60 e 04 0 07 4096 cont 1 86 e 04 0 13 2048 cont 5 74 e 05 0 50 8192 cont 1 69 e 05 2 03 32768 vg 252 2 31 e 04 0 04 2048 cont 2 57 e 04 0 06 1024 504 1 13 e 04 0 11 4096 cont 1 49 e 04 0 17 2048 1008 5 29 e 05 0 14 8192 cont 4 74 e 05 0 49 8192 cont 1 43 e 05 2 01 32768 cont 4 19 e 06 11 52 131072 kou 252 3 02 e 04 0 01 512 cont 1 57 e 04 0 02 256 504 2 03 e 04 0 01 512 cont 1 57 e 04 0 02 256 1008 1 47 e 04 0 02 1024 cont 1 57 e 04 0 02 256 cont 6 69 e 05 0 12 2048 cont 2 35 e 05 0 49 8192 cont 7 36 e 06 2 07 32768 table 4 cpu times and errors for the continuously monitored method and the discretely monitored method as an approximation to continuous monitoring for the single barrier case the cpu times for the discretely monitored price are chosen for the grid size m which gives the lowest cpu time where the convergence error is significantly about ten times lower than the error compared to the continuously monitored price 22 10 2 10 3 10 4 n 10 6 10 5 10 4 10 3 10 2 e rr o r v s c o n ti n u o u s m o n it o ri n g nig kou vg a 1 n 1 a 2 n 1 a 3 n 1 2 10 2 10 3 10 4 n 10 5 10 4 10 3 10 2 10 1 e rr o r v s c o n ti n u o u s m o n it o ri n g nig kou vg a 4 n 1 a 5 n 1 a 6 n 1 2 figure 9 error for discretely monitored barrier options used as an approximation of the price for the continuously monitored case plotted as a function of the number of monitoring dates the error is calculated as the difference between the prices for discrete and continuous monitoring at the maximum grid size of 217 results for single and double barrier options are displayed on the left and right hand plots respectively notice that the error for the kou process converges as o 1 n whereas the error for the nig and vg processes converges a rate of approximately o 1 n 10 2 10 3 10 4 10 5 10 6 m 10 12 10 10 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e s o lu ti o n vg cont n 10 2 n 10 3 n 10 4 n 10 6 n 10 8 10 2 10 3 10 4 10 5 10 6 m 10 12 10 10 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e s o lu ti o n nig 10 2 10 3 10 4 10 5 10 6 m 10 15 10 10 10 5 10 0 a b s o lu te e rr o r o f th e s o lu ti o n kou figure 10 error as a function of the grid size m for continuously monitored single barrier op tions compared to discretely monitored options as the number of monitoring dates n increases the error for each number of dates including continuous monitoring is calculated against the price for the same number of dates with 218 grid points for all processes as t 0 the slope of the error convergence of the discretely monitored scheme approaches that of the continuously monitored scheme 23 10 2 10 3 10 4 10 5 10 6 m 10 14 10 12 10 10 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e s o lu ti o n nig 10 2 10 3 10 4 10 5 10 6 m 10 14 10 12 10 10 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e s o lu ti o n kou 10 2 10 3 10 4 10 5 10 6 m 10 10 10 8 10 6 10 4 10 2 10 0 a b s o lu te e rr o r o f th e s o lu ti o n vg cont n 10 2 n 10 3 n 10 4 n 10 6 n 10 8 figure 11 error as a function of the grid size m for continuously monitored double barrier op tions compared to discretely monitored options as the number of monitoring dates n increases the error for each number of dates including continuous monitoring is calculated against the price for the same number of dates with 218 grid points for all processes as t 0 the slope of the error convergence of the discretely monitored scheme approaches that of the continuously monitored scheme 10 2 10 3 10 4 10 5 10 6 grid size m 4 7715 4 772 4 7725 4 773 4 7735 4 774 4 7745 4 775 4 7755 4 776 4 7765 p ri c e nig continuous discrete n 52 discrete n 252 discrete n 504 discrete n 1008 10 2 10 3 10 4 10 5 10 6 grid size m 4 3195 4 32 4 3205 4 321 4 3215 p ri c e kou continuous discrete n 52 discrete n 252 discrete n 504 discrete n 1008 10 2 10 3 10 4 10 5 10 6 grid size m 4 701 4 702 4 703 4 704 4 705 4 706 4 707 4 708 p ri c e vg continuous discrete n 52 discrete n 252 discrete n 504 discrete n 1008 figure 12 price plotted against the grid size m for continuously monitored single barrier op tions compared to discretely monitored options as the number of monitoring dates n increases note that the larger the value of n the closer the price is to the continuously monitored option price 24 process dates error time m nig 252 2 35 e 02 0 16 4096 cont 2 38 e 02 0 11 512 504 1 32 e 02 0 14 4096 cont 1 48 e 02 0 24 1024 1008 7 24 e 03 0 29 8192 cont 8 78 e 03 0 54 2048 cont 1 58 e 03 5 03 16384 cont 4 69 e 04 20 94 65536 vg 252 5 10 e 03 0 08 2048 cont 6 86 e 03 0 24 1024 504 2 51 e 03 0 13 4096 cont 2 40 e 03 1 15 4096 1008 1 15 e 03 0 29 8192 cont 1 36 e 03 2 44 8192 cont 7 56 e 04 5 16 16384 cont 2 25 e 04 21 21 65536 kou 252 4 90 e 02 0 03 1024 cont 3 54 e 02 0 07 256 504 3 51 e 02 0 07 2048 cont 3 54 e 02 0 07 256 1008 2 47 e 02 0 04 1024 cont 2 84 e 02 0 14 512 cont 7 23 e 03 1 19 4096 cont 2 33 e 03 5 30 16384 cont 7 03 e 04 21 05 65536 table 5 cpu times and errors for the continuously monitored method and the discretely monitored method as an approximation to continuous monitoring for the double barrier case the cpu times for the discretely monitored price are chosen for the grid size m which gives the lowest cpu time where the convergence error is significantly about ten times lower than the error compared to the continuously monitored price 10 2 10 3 10 4 10 5 10 6 grid size m 2 7 2 72 2 74 2 76 2 78 2 8 2 82 2 84 2 86 2 88 2 9 p ri c e nig continuous discrete n 52 discrete n 252 discrete n 504 discrete n 1008 10 2 10 3 10 4 10 5 10 6 grid size m 3 22 3 24 3 26 3 28 3 3 3 32 3 34 3 36 3 38 3 4 3 42 p ri c e kou continuous discrete n 52 discrete n 252 discrete n 504 discrete n 1008 10 2 10 3 10 4 10 5 10 6 grid size m 2 7 2 72 2 74 2 76 2 78 2 8 2 82 2 84 2 86 2 88 2 9 p ri c e vg continuous discrete n 52 discrete n 252 discrete n 504 discrete n 1008 figure 13 price plotted against grid size m for continuously monitored double barrier options compared to discretely monitored options as the number of monitoring dates n increases note that the larger the value of n the closer the price is to the continuously monitored option price 25 5 conclusions we showed that the numerical method for calculating the discretely monitored spitzer identities described by fusai et al 2016 can be modified for continuous monitoring by using the fourier laplace domain instead of the fourier z domain we implemented this with the inverse laplace transform by abate and whitt 1992 a 1995 which achieves an accuracy of approximately 10 11 sufficient for our chosen application of pricing barrier options we presented results showing that the conversion from discrete to continuous monitoring means that exponential convergence is no longer achieved but instead the error convergence becomes sub polynomial due to the performance of the wiener hopf factorisation by examining the effect of truncating the sinc based discrete hilbert transform we were able to provide an error bound which is well matched to the observed accuracy of the pricing procedure for continuously monitored options it is notable that previous papers have shown that the discretely monitored case achieves exponential convergence fusai et al 2016 phelan et al 2017 but the continuous case de scribed here does not however we showed that as the number of monitoring dates increases and t 0 the error convergence for the discretely monitored case degrades and approaches that of the continuously monitored case thus the performance of the pricing technique for continuously monitored barrier options is consistent with previous results being a limit of the error convergence for the discretely monitored case furthermore we have compared the error vs computational time of the continuously moni tored scheme with that of an approximate solution generated by the discretely monitored scheme with a high number of monitoring dates we show that for higher errors the discrete scheme may produce a rapidly calculated approximation to the continuously monitored scheme but when lower errors are required the continuously monitored scheme must be used acknowledgments the support of the economic and social research council esrc in funding the systemic risk centre grant number es k 002309 1 and of the engineering and physical sciences research council epsrc in funding the uk centre for doctoral training in financial computing and analytics grant number 1482817 are gratefully acknowledged references abate j w whitt 1992 a the fourier series method for inverting transforms of probability distributions queueing systems 10 1 2 5 88 doi 10 1007 bf 01158520 abate j w whitt 1992 b numerical inversion of probability generating functions operations research letters 12 4 245 251 doi 10 1016 0167 6377 92 90050 d abate j w whitt 1995 numerical inversion of laplace transforms of probability distribu tions orsa journal on computing 7 1 36 43 doi 10 1287 ijoc 7 1 36 barndorff nielson o e 1998 processes of normal inverse gaussian type finance and statistics 2 1 41 68 doi 10 1007 s 007800050032 26 baxter g m d donsker 1957 on the distribution of the supremum functional for processes with stationary independent increments transactions of the american mathematical society 85 1 73 87 bayer n o j boxma 1996 wiener hopf analysis of an m g 1 queue with negative customers and of a related class of random walks queueing systems 23 1 301 316 doi 10 1007 bf 01206563 broadie m p glasserman s kou 1997 a continuity correction for discrete barrier options mathematical finance 7 4 325 349 doi 10 1111 1467 9965 00035 carr p h geman d b madan m yor 2002 the fine structure of asset returns an empirical investigation journal of business 75 2 305 332 doi 10 1086 338705 carr p d madan 1999 option valuation using the fast fourier transform journal of computational finance 2 4 61 73 chi y s x lin 2011 on the threshold dividend strategy for a generalized jump diffusion risk model insurance mathematics and economics 48 3 326 337 doi 10 1016 j insmatheco 2010 11 006 cohen j w 1975 the wiener hopf technique in applied probability j gani ed perspectives in probability and statistics papers in honour of m s bartlett on the occasion of his sixty fifth birthday academic press london 145 156 cohen j w 1982 the single server queue north holland amsterdam cohen m a d pekelman 1978 lifo inventory systems management science 24 11 1150 1162 doi 10 1287 mnsc 24 11 1150 fang f c w oosterlee 2008 a novel pricing method for european options based on fourier cosine series expansions siam journal on scientific computing 31 2 826 848 doi 10 1137 080718061 fang f c w oosterlee 2009 pricing early exercise and discrete barrier options by fourier cosine series expansions numerische mathematik 114 1 27 62 doi 10 1007 s 00211 009 0252 4 feng l v linetsky 2008 pricing discretely monitored barrier options and defaultable bonds in le vy process models a hilbert transform approach mathematical finance 18 3 337 384 doi 10 1111 j 1467 9965 2008 00338 x feng l v linetsky 2009 computing exponential moments of the discrete maximum of a le vy process and lookback options finance and stochastics 13 4 501 529 doi 10 1007 s 00780 009 0096 x frigo m s g johnson 1998 fftw an adaptive software architecture for the fft proceed ings of the 1998 ieee international conference on acoustics speech and signal processing vol 3 ieee 1381 1384 doi 10 1109 icassp 1998 681704 27 fusai g i d abrahams c sgarra 2006 an exact analytical solution for discrete barrier options finance and stochastics 10 1 1 26 fusai g g germano d marazzina 2016 spitzer identity wiener hopf factorisation and pricing of discretely monitored exotic options european journal of operational research 251 4 124 134 doi 10 1109 icassp 1998 681704 gottlieb d c shu 1997 on the gibbs phenomenon and its resolution siam review 39 4 644 668 doi 10 1137 s 0036144596301390 grassman w k 1990 computational methods in probability theory d p heyman m j sobel eds handbooks in operations research and management science vol 2 elsevier amsterdam 199 254 grassmann w k j l jain 1989 numerical solutions of the waiting time distribution and idle time distribution of the arithmetic gi g 1 queue operations research 37 1 141 150 doi 10 1287 opre 37 1 141 green r g fusai i d abrahams 2010 the wiener hopf technique and discretely monitored path dependent option pricing mathematical finance 20 2 259 288 doi 10 1111 j 1467 9965 2010 00397 x heston s l 1993 a closed form solution for options with stochastic volatility with applications to bond and currency options review of financial studies 6 2 327 343 doi 10 1093 rfs 6 2 327 kemperman j h b 1963 a wiener hopf type method for a general random walk with a two sided boundary annals of mathematical statistics 34 4 1168 1193 url http www jstor org stable 2238330 king f w 2009 hilbert transforms cambridge university press cambridge kou s g 2002 a jump diffusion model for option pricing management science 48 8 1086 1101 doi 10 1287 mnsc 48 8 1086 166 kou s g 2008 discrete barrier and lookback options j birge v linetsky eds handbooks in operations research and management science vol 15 elsevier amsterdam 343 373 kreyszig e 2011 advanced engineering mathematics 10 th ed wiley new york kuznetsov a 2010 wiener hopf factorization and distribution of extrema for a family of le vy processes annals of applied probability 20 5 1801 1830 doi 10 1214 09 aap 673 lewis a 2001 a simple option formula for general jump diffusion and other exponential le vy processes ssrn 282110 madan d b e seneta 1990 the variance gamma v g model for share market returns journal of business 63 4 511 524 url http www jstor org stable 2353303 28 http www jstor org stable 2238330 http www jstor org stable 2238330 http www jstor org stable 2353303 marazzina d g fusai g germano 2012 pricing credit derivatives in a wiener hopf frame work m cummins f murphy j j h miller eds topics in numerical methods for finance springer new york 139 154 springer proceedings in mathematics statistics vol 19 merton r c 1976 option pricing when underlying stock returns are discontinuous journal of financial economics 3 1 125 144 doi 10 1016 0304 405 x 76 90022 2 nolan j p 2017 stable distributions models for heavy tailed data birkha user boston in progress chapter 1 online at academic 2 american edu jpnolan phelan c g fusai d marazzina g germano 2017 hilbert transform spectral filters and option pricing submitted polyanin a d a vladimirovich 1998 handbook of integral equations crc press boca raton prabhu n u 1974 wiener hopf techniques in queueing theory a b clarke ed mathematical methods in queueing theory springer berlin 81 90 series on lecture notes in economics and mathematical systems vol 98 rogers l c g 1994 fluid models in queueing theory and wiener hopf factorization of markov chains annals of applied probability 4 2 390 413 url http www jstor org stable 2245162 ruijter m j m m versteegh c w oosterlee 2015 on the application of spectral filters in a fourier option pricing technique journal of computational finance 19 1 75 106 url http oai cwi nl oai asset 23070 23070 d pdf schoutens w 2003 le vy processes in finance wiley new york spitzer f 1956 a combinatorial lemma and its application to probability the ory transactions of the american mathematical society 82 2 323 339 doi 10 1090 s 0002 9947 1956 0079851 x stenger f 1993 numerical methods based on sinc and analytic functions springer berlin stenger f 2011 handbook of sinc numerical methods crc press boca raton vandeven h 1991 family of spectral filters for discontinuous problems journal of scientific computing 6 2 159 192 doi 10 1007 bf 01062118 29 http www jstor org stable 2245162 http www jstor org stable 2245162 http oai cwi nl oai asset 23070 23070 d pdf appendix a table 6 contains all the parameters used for the numerical experiments which produced the results presented in section 4 description symbol value option parameters maturity t 1 year initial spot price s 0 1 strike k 1 1 upper barrier double barrier u 1 40 lower barrier double barrier u 0 60 upper barrier down and out u lower barrier down and out l 0 80 risk free rate r 0 05 dividend rate q 0 02 model t symbol value nig e t 2 i 2 2 2 15 5 0 5 kou e t 2 2 2 1 p 2 2 i p 1 1 i 1 p 0 3 3 0 1 1 40 2 12 vg 1 i 2 2 2 t 1 9 1 3 3 0 25 table 6 parameters for the numerical tests and processes used t is the characteristic function of the process that models the log return of the underlying asset 30 1 introduction 2 fourier transform methods for option pricing 2 1 spitzer identities for continuous monitoring 2 1 1 relationship to the spitzer identities for discrete monitoring 2 2 numerical methods 2 2 1 discrete fourier and hilbert transforms and spectral filters 2 2 2 inverse laplace transform 2 2 3 pricing procedure single barrier options 2 2 4 pricing procedure double barrier options 3 error convergence of the pricing procedure 3 1 factorisation 3 1 1 normal merton and kou processes 3 1 2 normal inverse gaussian process 3 1 3 variance gamma process 3 2 decomposition error 4 results 4 1 results for spitzer laplace method for continuously monitored options 4 2 comparison with the error convergence of spitzer z pricing method for discretely monitored options 5 conclusions