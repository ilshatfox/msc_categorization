ar x iv 1 40 8 70 10 v 1 q fi n m f 2 9 a ug 2 01 4 long term optimal investment in matrix valued factor models scott robertson and hao xing abstract long term optimal investment problems are studied in a factor model with matrix valued state variables explicit parameter restrictions are obtained under which for an isoelastic investor the finite horizon value function and optimal strategy converge to their long run counter parts as the investment horizon approaches infinity this convergence also yields portfolio turnpikes for general utilities by using results on large time behavior of semi linear partial differential equa tions our analysis extends affine models where the wishart process drives investment opportunities to a non affine setting furthermore in the affine setting an example is constructed where the value function is not exponentially affine in contrast to models with vector valued state variables 1 introduction when investment opportunities are stochastic and the market is incomplete optimal strategies in portfolio choice problems rarely admit explicit forms the main source of difficulty is that the hedging demand depends implicitly upon the investment horizon this difficulty motivates approximating optimal policies and one useful approximation occurs by considering the long run limit this approximation enables tractability for optimal strategies and illuminates the relationship between investor preferences underlying economic factors and dynamic asset demand long run approximations typically take two forms first the long run optimal investment or risk sensitive control problem seeks to identify growth optimal policies for isoelastic utilities second the portfolio turnpike problem seeks to connect optimal policies for general utilities with those for a corresponding isoelastic utility in this article long run optimal investment and portfolio turnpike problems are studied in a multi asset factor model where the state variable takes values in the space of positive definite matrices such models generalize the wishart model of 8 27 amongst many others which has been successfully employed in a wide range of problems in mathematical finance in addition to identifying optimal long run policies and proving turnpike theorems we are particularly concerned with connecting the finite horizon and long run problems here the goal is to provide conditions when optimal policies for finite horizons converge to their long run counterparts positive results in this direction are necessary to validate long run analysis though heuristics indicate convergence from a technical standpoint it is not a priori clear that the long run policy arises as the limit of finite horizon policies for isoelastic utilities the risk sensitive control or long run optimal investment problem aims to maximize the expected utility growth rate this problem has been addressed by many authors date january 21 2018 key words and phrases portfolio choice long run risk sensitive control portfolio turnpike wishart process 1 http arxiv org abs 1408 7010 v 1 2 long term optimal investment in matrix valued factor models see for example 5 6 4 17 18 35 16 39 13 23 26 in these studies an ergodic hamilton jacobi bellman hjb equation is analyzed this ergodic equation is typically obtained via a heuristic argument where one first derives the finite horizon hjb equation and then conjectures that for long horizons the reduced value function decomposes into the sum of a spatial component and a temporal growth component thus if v t denotes the finite horizon value function the long run value function takes the form t v then ergodic hjb equation follows by substituting the latter function into the finite horizon hjb equation the above heuristic derivation indicates that finite and infinite horizon optimal investment prob lems are parallel in many aspects of primary importance is to connect these two class of problems as the investment horizon t approaches infinity does the finite horizon value function v t con verge to its long run analogue t v if so in what sense does the optimal strategy for the finite horizon problem converge to a long run limit as previously mentioned affirmative answers to these questions verify the intuition underpinning the study of the risk sensitive controls and provide consistency between the finite horizon and long run problems moving away from the isoelastic case portfolio turnpikes provide another approximation for optimal policies of generic utility functions qualitatively turnpike theorems state that in a growing market i e one where the riskless asset tends to infinity as the investment horizon becomes large the optimal trading strategy of a generic utility converges over any finite time window to the optimal trading strategy of its isoelastic counterpart see assumption 2 8 for a precise formulation of counterpart turnpike theorems were first investigated in 38 for utilities with affine risk tolerance and have since been extensively studied in particular we mention 36 44 25 30 10 32 29 15 14 where turnpike theorems are proved in differing levels of generality for the risk sensitive control and turnpike approximations we summarize the relationship be tween the finite and long horizon problems in statements 2 7 and 2 10 respectively verification of these statements allows investors with a long horizon to replace their optimal but implicit strategies with explicit long run approximations which lead to minimal loss of their wealth and utility while providing considerable tractability each of statements 2 7 and 2 10 have been proved in 22 in a factor model with univariate state variable and constant correlation of hedgeable and unhedgeable shocks the present paper extends these results to a multivariate setting which allows for stochastic interest rates volatility and correlation here in our main results proposition 3 2 and theorems 3 10 3 12 we provide explicit parameter assumptions upon the model coefficients under which both statements 2 7 and 2 10 hold as previously stated we focus on a factor model where the state variable is matrix valued this is motivated by consideration of the wishart process cf 7 and example 2 4 below which has been applied to option pricing cf 20 21 11 12 its application to portfolio optimization was pioneered by 8 which highlighted the impact of the multivariate state variable on the hedging demand in particular using practical relevant parameters the numerical example in section b 3 therein showed that the hedging demand converges to a steady state level when the investment horizon is longer than 5 years our results confirm this observation in 27 the portfolio optimization problem is solved in the wishart case via a matrix riccati differential equation in 2 logarithmic utility is studied and in 42 the indifference pricing is discussed long term optimal investment in matrix valued factor models 3 in contrast to the aforementioned results which exploit the affine structure of the wishart pro cess our results rely upon large time asymptotic analysis of partial differential equations with quadratic nonlinearities in the gradient using techniques developed in 43 we are able to con sider non affine models and hence discuss general matrix valued state variables as in section 2 1 moreover stochastic correlation between the state variable and risky assets can be treated whereas a special constant correlation structure is needed to ensure the affine structure furthermore our analysis when applied to affine models yields new insight we construct a counter example example 3 4 to the long held belief that optimal policies are affine in affine models indeed the model in this example is affine but the associated value function is not exponentially affine hence the optimal policy is not affine this happens when the dimension of state variable is larger than the number of risky assets and is due to the noncommuntative property of the matrix product the paper is organized as follows after the model and statements 2 7 and 2 10 are introduced in section 2 the main results are presented in section 3 for ease of exposition the general results are first specified to when the state variable follows a wishart process in section 3 1 here the invest ment model may or may not be affine depending upon the asset drifts and covariances proposition 3 2 provides simple mild especially in the case where the investor risk aversion exceeds that of a logarithmic investor parameter restrictions under which the main results follow proposition 3 3 explicitly identifies the long run limit policy when the model is further specified to the classical affine wishart model considered in 8 27 and example 3 4 constructs the non exponentially affine counter example after considering the wishart case the main results for general matrix valued state variables are given in section 3 2 see theorem 3 10 for the long run limit results and the orem 3 12 for the turnpike results all proofs are deferred to appendices a b and c finally we summarize several notations used throughout the paper md k denotes the space of d k matrices with md md d for x md k denote by x the transpose of x for x md denote by tr x the trace of x and x tr x x for x y md the kronecker product of x and y is denoted by x y md 2 denote by 1 d the identity matrix in md and 1 d the d dimensional vector with each component 1 sd denotes the space of d d symmetric matrices and sd the cone of positive definite matrices for x sd denote by x the unique element y sd such that y 2 x for x y sd x y when x y is positive semi definite for e md k f mm n and 0 1 denote by c e f the space of times continuously differentiable functions from e to f whose derivatives of order up to is locally ho lder continuous with exponent 2 set up let ft t 0 f p be a filtered probability space with ft t 0 a right continuous filtration following the treatment in 22 all n negligible sets cf 3 definition 1 3 23 and 40 are included into f 0 such a completion of f 0 ensures for all t 0 that ft 0 t t ft p satisfies the usual conditions consider a financial model with one risk free asset s 0 and n risky assets s 1 sn investment opportunities are driven by a sd valued state variable x before writing down the dynamics for 4 long term optimal investment in matrix valued factor models the assets it is necessary to introduce the state variable x as the dynamics for x involve matrix notation 2 1 a sd valued state variable let b b ij i j 1 d be a m d valued brownian motion on ft t 0 f p the state variable x has dynamics 2 1 dxt b xt dt f xt dbtg xt g xt db tf xt x 0 sd here b c 1 sd sd and f g c 2 sd md are given functions we require b f g to be such that x possesses a unique strong solution which is non explosive i e p x xt sd t 0 1 for all x sd where px is the probability such that x 0 x a s to enforce this requirement through restrictions upon b f and g the results as well as notation of 37 are used namely define 2 2 f x ff x and g x g g x x sd next given b f g sd sd and r define h sd r via 2 3 h x b tr b x 1 1 tr fx 1 gx 1 tr f x 1 tr g x 1 x sd here we have omitted the function arguments from b f g but have explicitly identified the drift function b in h since in the sequel h will be used with various b to understand h note that if x from 2 1 has a strong solution satisfying 2 1 then ito s formula implies the drift in the dynamics for log det xt is h 0 xt b thus the following as sumption ensures that x from 2 1 neither explodes in norm nor has degenerate determinate and hence possesses a unique global strong solution xt t r on s d cf 37 theorem 3 4 assumption 2 1 i g f and b are locally lipschitz and of linear growth ii infx sd h 0 x b remark 2 2 a direct calculation using 28 section 4 2 shows that g f x g f y 2 2 g x 2 f x f y 2 f y 2 g x g y 2 g f x 2 f x 2 g x 2 tr f tr g for x y sd thus g f will be locally lipschitz and of linear growth once f and g are locally lipschitz and f x g x c 1 x or equivalently if tr f tr g c 1 x 2 assumption 2 1 establishes well posedness of 2 1 the next assumption implies that the volatil ity of x is non degenerate in the interior of sd assumption 2 3 for each x sd f x 0 and g x 0 indeed note that 2 1 is short hand for the following system dx ij t bij xt dt d k l 1 f xt ikdb kl t g xt lj d k l 1 f xt jkdb kl t g xt li i j 1 d long term optimal investment in matrix valued factor models 5 for i j 1 d define the matrix aij sd md by a ij kl x fikglj fjkgli x k l 1 d x sd then the above system takes the form dx ij t bij xt dt tr aij xt db t then 43 lemma 5 1 shows that under assumption 2 3 for any x sd and sd 2 4 d i j k l 1 ijtr aij akl x kl 4 tr f x g x c x 2 for some constant c x 0 example 2 4 the primary example to keep in mind is when x is the wishart process cf 7 2 5 dxt ll kxt xtk dt xtdbt db t xt where k l md then both assumptions 2 1 and 2 3 are satisfied when 2 6 ll d 1 0 indeed here b x ll kx xk f x x and g x using remark 2 2 it follows that b g f are locally lipschitz and of linear growth furthermore calculation shows that h 0 x b tr ll d 1 x 1 2 tr k thus the first inequality in 2 6 implies h 0 x b 2 tr k on sd and assumption 2 1 holds assumption 2 3 readily follows from the second inequality in 2 6 2 2 the financial model having fixed notation and established well posedness for the state variable we may now define the financial model as mentioned above there is one risk free asset s 0 and n risky assets s 1 sn whose dynamics are given by ds 0 t s 0 t r xt dt s 0 0 1 2 7 dsit sit r xt i xt dt m j 1 ij xt dz j t s i 0 0 i 1 n 2 8 here r c sd r c 1 sd rn c 2 sd mn m and z z 1 zm is a rm valued brownian motion that is of full rank as well as the existence of market price of risk i e sd rn such that on sd are ensured by the following assumption assumption 2 5 i when m n x x 0 for x sd then 1 ii when m n x 0 for x sd and there exists c 1 sd rn such that iii when m n x 0 for x sd and here again 1 to allow for potentially stochastic instantaneous correlations between asset returns and the state variable we define z in terms of the brownian motion b which drives x and an independent rm valued brownian motion w specifically let c c 2 sd mm d and c 2 sd rd be such that 6 long term optimal investment in matrix valued factor models assumption 2 6 x cc x 1 m for each x sd set d 1 m cc c 2 sd sd we then may define z by 2 9 z j t d k l 1 t 0 cjk xu db kl u l xu m k 1 t 0 djk xu dw k u t 0 j 1 m by construction z is a m dimensional brownian motion furthermore the instantaneous correla tion between z and b is d zj bkl t cjk xt l xt dt for 1 j m 1 k l d in particular when m d c 1 d and rd is constant d zi bjl t ij ldt where ij 1 for i j and 0 otherwise this particular correlation structure is assumed in 8 27 2 42 here the matrix c introduces general correlation structure and allow its dependence upon the state variable x 2 3 the optimal investment problem consider an investor whose preference is described by a utility function u r r which is strictly increasing strictly concave continuously differentiable and satisfies the inada conditions u 0 and u 0 in particular we pay special attention to utilities with constant relative risk aversion henceforth crra u x xp p for 0 6 p 1 starting from an initial capital this investor trades in the market until a time horizon t r she puts a proportion of her wealth t t t into the risky assets and the remaining into the risk free asset given her strategy the price dynamics in 2 7 and 2 8 imply that the wealth process w has dynamics 2 10 dw t w t r xt t xt xt dt t xt dzt the set of admissible strategies are those which are f adapted and such that px w t 0 t t 1 for all x sd in a 1 below positive super martingalem are constructed such thatmw is a super martingale for any admissible strategy in the presence of such super martingale deflators arbitrage is excluded from the model cf 33 the investor seeks to maximize the expected utility of her terminal wealth at t by choosing admissible strategies i e 2 11 e u w t max in the remainder of this section we will focus on the optimal investment problem for crra utilities and derive the associated hjb equation via a heuristic argument to this end define the reduced value function v via 2 12 sup admissible e 1 p w t p wt w xt x 1 p wpev t t x 0 t t w 0 x sd set l as the infinitesimal generator of 2 1 2 13 l 1 2 d i j k l 1 tr aij akl d 2 ij kl d i j 1 bijd ij long term optimal investment in matrix valued factor models 7 where d ij xij and d 2 ij kl 2 xijxkl the standard dynamic programming argument yields the following hjb equation for v tv lv 1 2 d i j k l 1 d ij vtr aij akl d kl v p r sup p d i j 1 caij d ij v 1 2 p p 1 t 0 x sd 0 v 0 x x sd 2 14 the optimizer in the previous equation can be obtained pointwise and is given by 2 15 t x v 1 1 p 1 d i j 1 ca ij d ij v t x m n 1 1 p 1 d i j 1 ca ij d ij v t x m n t 0 x sd define q p p 1 as the conjugate of p and the function sd sd via 2 16 x 1 x m n 1 m m n x sd plugging in the formula for in 2 15 into 2 14 a lengthy calculation yields the following semi linear cauchy problem for v vt t x f v t x 0 t x sd v 0 x 0 x sd 2 17 here the differential operator f is defined as 2 18 f 1 2 d i j k l 1 a ij kl d 2 ij kl d i j 1 b ijd ij 1 2 d i j k l 1 d ij a ij kl d kl v with a ij kl x tr aij akl x a ij kl x tr aij akl x q aij c cakl x b ij x bij x q caij x v x pr x 1 2 q x i j k l 1 d x sd 2 19 note that in 2 15 and f in 2 18 take different forms depending on m n or m n with the two forms coinciding at m n and that using the definition of l from 2 13 we have 2 20 f l q d i j 1 caij d ij 1 2 d i j k l 1 d ij a ij kl d kl v in section 3 well posedness of 2 17 is proved under appropriate parameter assumptions and it is shown that the solution v with appropriate growth constraint to 2 17 is the reduced value 8 long term optimal investment in matrix valued factor models function in 2 12 moreover the optimal strategy for 2 12 is given by 2 21 tt t t xt v 0 t t for v from 2 15 2 4 long horizon convergence as mentioned in the introduction this article is concerned with the large time behavior of the optimal investment problem such behavior for a crra investor is closely related to the ergodic analog of 2 17 given by f v x x sd 2 22 a solution to 2 22 is defined as a pair v where r and v c 2 sd r which satisfy 2 22 since f v only depends on derivatives of v v in a solution is only determined up to an additive constant in particular we are interested in the smallest such that 2 22 admits a solution in the study of long horizon optimal investment and risk sensitive control problems when the state variable is in e rd under appropriate restrictions 31 23 there does exist a smallest such that 2 22 has a solution v such that the candidate reduced long run value function accounting for the growth rate is t v x the candidate long run optimal strategy is 2 23 t xt v t 0 where v from 2 15 with v replaced by v which does not have a time argument now when the state variable is matrix valued proposition 3 9 below establishes the existence of such v comparing the finite and long horizon problems we are interested in proving the following claim statement 2 7 long horizon convergence i define h t x v t x t v x for t 0 and x sd then h t c and h t 0 in c sd as t here c is a constant d ij 1 i j d is the gradient operator and convergence in c sd stands for locally uniformly convergence in sd ii as functions of x sd the finite horizon strategies converge to the long run counterpart i e lim t t v v in c sd iii let t and be as in 2 21 and 2 23 let wt and w be the wealth processes employing t and respectively starting with initial capital w then for all x sd and all t 0 p x lim t sup 0 u t wtu w u 1 0 2 24 p x lim t t 0 tu u xu tu u du 0 2 25 here px lim stands for convergence in probability px in statement 2 7 i claims that the reduced value function for the finite horizon problem converges to its infinite horizon counterpart moreover ii indicates that the finite horizon optimal strategy also converges in feedback form to a myopic long run limit in addition to these analytic results iii states convergence in probabilistic terms that is the ratio between optimal wealth processes long term optimal investment in matrix valued factor models 9 and distance between optimal strategies when measured in a finite time window 0 t converge to zero in probability therefore when statement 2 7 holds a crra investor with long horizon can slightly modify her optimal strategy t to at the beginning of investment period and incur a minimal loss of wealth and utility indeed under appropriate parameter assumptions statement 2 7 is proved in 22 when the state variable is r valued and has constant correlation with risky assets in section 3 below we will verify statement 2 7 in the matrix setting 2 5 turnpike theorems to state turnpike results we consider two investors the first one has a general utility function u which satisfies conditions at the beginning of section 2 3 the second investor has a crra utility u x xp p for 0 6 p 1 1 the two investors are connected through the ratio of their marginal utilities u x xp 1 as in the following assumption assumption 2 8 with r x u x xp 1 it follows that 2 26 lim x r x 1 assumption 2 8 ensures that preferences of the two investors are similar for large wealths the next assumption ensures that the market described in section 2 2 is growing over time assumption 2 9 for r x as in 2 7 there exits constants 0 r r such that r r x r for all x sd in order to present the turnpike results for the investor with general utility u set 1 t as the optimal strategy of 2 11 and w 1 t as the associated optimal wealth process starting from initial wealth w we are interested in proving the turnpike theorem statement 2 10 turnpike theorem for all x sd and all t 0 p x lim t sup u t w 1 tu w u 1 0 2 27 p x lim t t 0 1 tu u xu 1 tu u du 0 2 28 where from 2 23 and w is the wealth process starting from w following the first convergence above states that the ratio when measured in an finite time window of the optimal wealth process for the generic investor and the long run wealth process for the crra investor is uniformly close to one in probability as the horizon becomes large the message behind the second convergence is that as the horizon becomes long the optimal investment strategy for the generic utility investor approaches the long run limit strategy of the crra investor such a result is called an explicit turnpike using the terminology of 22 where statement 2 10 is proved in a factor model with r valued state variable and constant correlation in section 3 below we will extend this result to when the state variable is matrix valued 1 the logarithmic utility case is excluded here since 22 proposition 2 5 already shows that turnpike theorems hold in a general semimartingale setting including the current case 10 long term optimal investment in matrix valued factor models remark 2 11 statements 2 7 and 2 10 are not specific to models with matrix valued state variables as mentioned in introduction the main technique to confirm these statements is the large time asymptotic analysis of 2 14 in 43 in particular a general framework is introduced in 43 section 2 where convergence results cf theorems 2 9 and 2 11 therein are obtained for a general state space e the main message therein is when two lyapunov functions and exist and satisfy appropriate assumptions then the desired convergence results hold when the state space is specified assumptions on and are translated to explicit parameter restrictions in particular when the state space is rd these parameter restrictions are given in 43 section 3 1 therefore proof of statements 2 7 and 2 10 in this case follows from essentially the same line of reasoning as in the matrix case and is in fact much more straightforward 3 main results 3 1 the generalized wishart factor model before presenting results for the general matrix setting in section 2 1 let us highlight the case when x is a wishart process as in example 2 4 we specify the financial model in section 2 2 to the following m d c x 1 d d x 1 x 1 d r x r 0 tr r 1 x x x x x x x x x for x sd where r 0 r and r 1 md we assume that c 1 sd rn c 2 sd mn d and c 2 sd rd are all bounded functions and supx sd x 1 when these functions are not constant the previous model is not affine in contrast to 8 27 2 42 for the given assumption 2 5 takes the form assumption 3 1 i when d n x 0 for x sd ii when d n x 0 for x sd iii when d n x x 0 for x sd the following proposition verifies statements 2 7 and 2 10 in the current model under explicit parameter restrictions the proof of proposition 3 2 is in appendix c proposition 3 2 let assumption 3 1 hold assume the following parameter restrictions i ll d 1 0 ii when p 0 r 1 satisfies r 1 r 1 0 and there exists 0 such that either p r 1 r 1 q x 1 d x sd or k q x k q x 1 d x sd iii when 0 p 1 there exists 0 such that k q x k q x 1 d x sd and 3 1 2 8 1 q dtr sup x sd p r 1 r 1 q x long term optimal investment in matrix valued factor models 11 then the long horizon convergence results in statement 2 7 hold additionally when r 1 0 the turnpike theorems in statement 2 10 hold for all utility functions u satisfying assumption 2 8 in the previous parameter restrictions part i is slightly stronger than the well posedness con dition 2 6 the restriction in the p 0 case is mild when r 1 r 1 0 it follows that p r 1 r 1 q x 1 d for some 0 since q 0 thus part ii holds when r 1 r 1 is non negative but may degenerate consider a generalized wishart process x with dynamics dx t ll k x t xt xtk x t dt xtdbt db t x t where k x k q x 2 then we require x is mean reverting to verify part ii when 0 p 1 we require the force of mean reversion to be sufficiently strong in this case 3 1 is necessary because the potential v x pr 0 ptr r 1 x 1 2 q x x x pr 0 1 2 tr x p r 1 r 1 q x may not be uniformly bounded from above on sd 3 1 1 an explicit long run optimal strategy and a counter example we now focus on the clas sical wishart model where and in the previous section are constants taking values in rd rn and mn d respectively here it is shown that if the dimension d of the wishart process is less than or equal to n the number of risky assets then the solution v to 2 22 with minimal is an affine function of x i e up to an additive constant v x tr m x for a symmetric matrix m satisfying the riccati equation given in 3 3 below however surprisingly if d n then v may not be affine hence in 2 23 is not affine either this is due to the non commutative property of matrix product to streamline the presentation we assume that p 0 and r 1 r 1 0 hence proposition 3 2 follows if ll d 1 0 and the constant matrix satisfies assumption 3 1 we consider candidate solutions to 2 22 given by 3 2 v x tr mx m m 3 first we present the result when d n proposition 3 3 assume d n and are constant let satisfy assumption 3 1 and assume p 0 r 1 r 1 0 ll d 1 0 consider the following matrix riccati equation in m 3 3 0 2 m 1 q m k q m m k q 1 2 p r 1 r 1 q there exists a unique m sd solving 3 3 such that v with tr ll m pr 0 and v x tr m x solves 2 22 and is the smallest with accompanying v 2 this sde admits a unique global strong solution x this is because h 0 x b 2 tr k x which is uniformly bounded from below due to the boundedness assumption of and on sd hence the existence follows from 37 theorem 3 4 3 we can assume m m without loss of generality since x sd implies tr mx tr m x 1 2 tr m m x 12 long term optimal investment in matrix valued factor models we next present a counter example in the d n case showing that solutions v to 2 22 cannot be of the affine form in 3 2 however the existence of solutions to 2 22 is still ensured by proposition 3 2 example 3 4 take n 1 d 2 and 12 l 12 for 3 k 12 c 12 1 0 r 1 1 for 0 2 2 1 r 0 0 r 1 r 112 for r 1 0 3 4 consider functions v as in 3 2 writing the generic element x sd and the matrix m as 3 5 x x y y z x z 0 y 2 xz m m 1 m 2 m 2 m 3 we have that x x x 0 so that assumption 3 1 holds furthermore ll 3 2 3 12 0 and for p 0 p r 1 r 1 q x 2 pr 112 0 thus the assumptions of proposition 3 2 hold for p 0 a lengthy calculation shows that cf lemma b 2 in appendix b f v x 2 m 21 m 2 2 2 q 2 m 1 m 2 2 2 m 1 2 q m 1 m 2 pr 1 1 2 q 2 y 4 m 2 m 2 m 3 4 q 2 m 1 m 2 m 2 m 3 4 m 2 2 q m 2 m 3 z 2 m 22 m 2 3 2 m 3 pr 1 y 2 x 2 q 2 m 2 m 3 2 pr 0 2 m 1 m 3 3 6 as can be seen from b 4 in lemma b 1 below the problem term y 2 x arises when evaluating a from 2 19 since for d n 3 7 x x x x x 1 x 1 x x 1 0 1 0 x x y y y 2 x whereas for arbitrary model coefficients if d n then x x x x thus if f v for some constant it must be that each coefficient of x y z y 2 x in 3 6 is equal to zero by considering y 2 x it follows thatm 2 m 3 0 plugging this into the coefficient of y givesm 2 0 and hencem 3 0 then the coefficient of z being zero yields 0 pr 1 a contradiction since r 1 0 thus the function v cannot be affine 3 2 general state variables we now consider the general case when x has dynamics as in 2 1 where in addition to the aforementioned regularity restrictions the model coefficients satisfy assumptions 2 1 and 2 3 as in the previous section the goal is to provide conditions based entirely upon the model coefficients under which statements 2 7 and 2 10 hold to list the coefficient assumptions let f g be as in 2 2 b v as in 2 18 and recall h x b from 2 3 assumption 3 5 below gives a number of restrictions under which the main convergence results hold though the list below is lengthy it can be readily checked for particular models of interest long term optimal investment in matrix valued factor models 13 assumption 3 5 there exists n 0 0 such that the following hold for x n 0 1 b has at most linear growth 2 there exists 1 0 so that tr f x tr g x 1 x 3 there exits 1 r c 1 0 so that tr b x x 1 x 2 c 1 4 there exists 1 2 r and c 2 0 so that 2 x c 2 v x 1 x c 2 v x is uniformly bounded from above for x n 0 5 max 1 1 0 furthermore i if 1 0 1 0 then there exist 2 0 c 3 r so that tr f x xg x x 2 x 3 c 3 ii if 1 0 1 0 then 2 1 16 1 1 0 where 1 is from part 2 1 when p 0 and 1 q when 0 p 1 iii if 1 0 1 0 then no additional restrictions are necessary there exists c 0 c 1 0 such that a infx sd h x b note here we are using b instead of b in 2 3 b lim infdet x 0 h x b c 0 log det x c limdet x 0 h 0 x b c 1 v x remark 3 6 when p 0 and the interest rate function r x is bounded from below on sd e g r x 0 then 1 0 hence the complicated part 5 ii in assumption 3 5 is never required the parameter restrictions in assumption 3 5 have a similar interpretation to those in proposition 3 2 indeed consider a sd valued diffusion x with dynamics 3 8 dx ij t b ij x t dt tr aij x t dw t i j 1 d comparing to 2 1 the drift is adjusted to b the given regularity assumptions and parts 1 and 2 imply that the coefficients of x are locally lipschitz and have at most linear growth on the other hand due to the second inequality in 2 4 h is decreasing in hence part a implies h 0 x b is bounded from below on sd as a result assumption 2 1 specified to x from 3 8 holds and 37 theorem 3 4 ensures that 3 8 has a unique global strong solution in assumption 3 5 parts 3 and 4 if 1 0 then x is mean reverting and if 1 0 the potential v decays to uniformly as x thus part 5 requires either mean reversion or a decaying potential if both happen then no additional parameter restrictions is necessary however if mean reversion fails we require uniform ellipticity for a x in the direction of x if 1 0 then a delicate relationship in 5 ii between the growth and degeneracy of a mean reversion of b and the growth of v is needed finally assumption 3 5 parts b and c are restrictions when the determinant of x is small these two assumptions help to bound the value function v from above and below ensuring v is finite close to the boundary x sd det x 0 of the state space from a technical point of view assumption 3 5 helps to construct an upper bound for solutions to 2 17 it is shown in 43 section 3 that well posedness of 2 17 is established among solutions which are bounded from above up to an additive constant by 0 x c log det x c x x c 14 long term optimal investment in matrix valued factor models where c c 0 and c 0 is chosen so that 0 is non negative on s d here c 0 is a cutoff function satisfying 0 1 x 1 when x n 0 2 and x 0 for x n 0 1 for the given n 0 assumption 3 5 helps to verify the heuristic argument in section 2 3 43 propositions 2 5 2 7 and theorem 3 9 prove that proposition 3 7 let assumptions 2 3 2 5 2 6 and 3 5 hold then there exists a unique solution v c 1 2 0 sd c 0 sd to 2 17 such that sup t x 0 t sd v t x 0 x for each t 0 combining with the following verification result whose proof is deferred to appendix a we obtain that the optimization problem in 2 12 is well posed for any horizon t 0 proposition 3 8 let assumptions 2 3 2 5 2 6 and 3 5 hold then for v in proposition 3 7 and any t 0 2 12 holds and t from 2 21 is the optimal strategy for 2 12 the aforementioned parameter assumptions also ensure the well posedness of 2 22 43 propo sition 2 3 and lemma 5 3 prove that proposition 3 9 let assumptions 2 3 2 5 2 6 and 3 5 hold there exists v solving 2 22 such that v is unique up to an additive constant and is the smallest such that there exists a corresponding v solving 2 22 we are now ready to state our first main result whose proof is presented in appendix c theorem 3 10 let assumptions 2 3 2 5 2 6 and 3 5 hold then the long horizon results in statement 2 7 hold to state the portfolio turnpike result we need to make an additional assumption which is a mild strengthening of assumption 2 6 assumption 3 11 for and c in assumption 2 6 cc x 1 m for all x sd under the previous assumption it is possible to construct not only super martingale deflators cf a 1 below but also equivalent local martingale measures qt for all t 0 i e qt is equivalent to p on ft and e 0 r xu dus is a qt local martingale on 0 t this is needed to utilize duality results in 34 to establish the existence of an optimal strategy to 2 11 for the generic utility u we are now ready to state the following turnpike result theorem 3 12 let assumptions 2 1 2 3 2 5 3 5 and 3 11 hold then the turnpike theorems in statement 2 10 hold appendix a proof of proposition 3 8 we first define a class of supermartingale deflators on 0 t for any t 0 given a md valued process with t 0 u 2 du a s define m via note for a function g of sd we will write gu long term optimal investment in matrix valued factor models 15 for g xu m t e t 0 rudue u ucudbu u tr udb u u uc u ucudbu u t e u udu u uc u udu dwu t e t 0 rudue d k l 1 dbklu c k l kl c c k l u t e d k 1 dw ku d k d c k u t t t a 1 when 0 e 0 rudum defines the minimal martingale measure provided the stochastic exponen tials are indeed martingales see 19 hence we call a risk premia for any admissible strategy m w is a positive super martingale indeed using 2 9 2 10 and a 1 the stochastic integration by parts formula shows that the drift of m w has the following integrand omitting function arguments and time subscripts m w c c c c d d d c m w cc dd c cc dd c m w c c 0 where the second identity follows from cc dd x 1 m and the third identity holds due to therefore m w is a positive local martingale hence a super martingale before proving proposition 3 8 we must introduce some notation for a fixed c 1 2 0 sd r the regularity assumptions on the coefficients and ellipticity assumption in 2 4 ensure that the generalized martingale problem on sd for a 2 l t t 1 2 d i j k l 1 a ij kl d ij kl d i j 1 b ij d k l 1 a ij kl d kl t t d ij t t has a unique solution p t x x sd cf 41 when does not depend upon t we will write l and denote the solution as p x x sd the martingale problem for l t is well posed if the coordinate process x does not hit the boundary sd p t x a s before t for any x sd similarly if does not depend upon time then well posedness follows if the coordinate process does not hit the boundary in finite time p x a s for any x sd 16 long term optimal investment in matrix valued factor models for the given define the stochastic exponential z t t e 0 d k l 1 dbklu q c k l d i j 1 a ij kl q c caij k l d ij t u xu t e 0 m k 1 dw ku q d k q d i j 1 d caij kd ij t u xu t t t a 3 for not depending upon time write z for z t and note that z is defined for all t 0 recall from section 2 1 that assumption 2 1 ensures the well posedness of 2 1 hence the martingale problem for l in 2 13 is well posed now if the martingale problem for l t is also well posed it follows from 9 remark 2 6 that the first stochastic exponential on the right hand side of a 3 is a px martingale on 0 t on the other hand since x and w are px independent it follows from 33 lemma 4 8 that z t is also a px martingale on 0 t therefore we may define a new measure p t x on ft via dp t x dpx ft z t t moreover girsanov s theorem yields that x has generator l t under p t x when does not have time argument and the martingale problem for l is well posed the same argument as above yields that z is a px martingale on 0 hence a new measure p x is defined via dp x dpx ft z t t 0 note that p x is consistently defined on t 0 ft lastly we recall that p is ergodic if x is recurrent under p and there exists an invariant probability measure remark a 1 set v from proposition 3 9 if pv x is well defined then girsanov s theorem together with 2 8 and a 3 yield the following dynamics of s under pv x dsit sit r xt 1 1 p d k l 1 cakl d kl v t t xt dt m j 1 ij xt dz j t i 1 n where z is a pv x brownian motion comparing the previous dynamics with in 2 23 it follows that is the optimal strategy for a logarithmic investor under pv x hence its associated wealth process w has the nume raire property i e w w is a pv x supermartingale for any admissible wealth process w for the proof of proposition 3 8 we prepare following two lemmas whose proofs are postponed until after the proof of proposition 3 8 lemma a 2 let assumptions 2 3 2 5 and 2 6 hold let a and a be as in 2 19 set a 4 1 0 p 1 1 q p 0 and 1 q 0 p 1 1 p 0 then for all x sd and sd a 5 d i j k l 1 ija ij kl x kl d i j k l 1 ija ij kl x kl d i j k l 1 ija ij kl x kl long term optimal investment in matrix valued factor models 17 for c 1 2 0 sd r define function sd md via a 6 kl t x d i j 1 a ij kl d ij t x k l 1 d t 0 x sd define tt t t xt t 0 t when is v from proposition 3 7 resp v from proposition 3 9 then t x v resp x v is expected to be the optimal risk premium for the dual problem of 2 12 resp its long run analogue the following result is the key to prove proposition 3 8 lemma a 3 let c 1 2 0 sd r satisfy t f on 0 sd where f is defined in 2 18 for any t 0 let t t t xt t t t xt for t 0 t and let w and m be the associated wealth process and super martingale deflator respectively then the following identities hold p log w t p log w t 0 xt t t xt log z t t log z t t q log m t q log m t 1 q 0 xt t t xt log z t t log z t t a 7 where z t is given in a 3 using lemmas a 2 and a 3 the proof of proposition 3 8 is now given proof of proposition 3 8 note that in a 4 0 holds for both 0 p 1 and p 0 thus 43 assumption 3 4 is ensured by assumption 2 3 and lemma a 2 additionally 43 assumptions 3 5 and 3 6 are exactly assumption 3 5 here as the assumptions of 43 lemma 4 1 are verified the well posedness of the martingale problem for lv t follows from 43 lemma 4 1 since the martingale problem for l is also well posed it then follows from the discussion after a 3 that zv t is a px martingale applying lemma a 3 to v it then follows from a 7 and v 0 x 0 that a 8 e w t w t p ft ev t t xt e m t m t q ft 1 1 q for all t t therefore the optimality of follows from 23 lemma 5 and 2 12 is verified in the previous identity proof of lemma a 2 from 2 18 d i j k l 1 ija ij kl x kl d i j k l 1 ijtr aij akl x kl q d i j k l 1 ij aij c cakl kl define the matrix y via ykl d i j 1 a ij kl ij for k l 1 d it then follows that d i j k l 1 ij aij c cakl kl y c cy we claim that a 9 0 y c cy tr y y 18 long term optimal investment in matrix valued factor models admitting this fact and plugging back in for y yields a 10 0 d i j k l 1 ij aij c cakl kl d i j k l 1 ijtr aij akl x kl if p 0 then q 0 and a 5 holds for 1 q and 1 if 0 p 1 then q 0 and hence a 5 holds for 1 and 1 q it remains to show a 9 when x 0 d the d dimensional vector with all components 0 it is clear that y c cy 0 and a 9 holds when x 6 0 d it follows from 0 that y c cy 0 on the other hand since by construction 1 see 2 16 we have y c cy y c cy 1 y y 1 tr y y where the second inequality holds by assumption 2 6 and the fact that c c and cc have the same eigenvalues note that the eigenvalues of 1 are 1 and 0 and that tr nmn mtr nn for any n md andm sd where m is the maximal eigenvalue ofm therefore 1 tr y y tr y y and a 9 is confirmed finishing the proof proof of lemma a 3 the proof is similar that of 24 lemma b 3 however since herein we work with a semi linear equation and a matrix valued state variable the notational differences in the calculations are such that for clarity we will present a detailed proof first of all set a p log w t p log w t 0 xt t t xt b q log m t q log m t 1 q 0 xt t t xt a 11 the identities in a 7 are verified in the following four steps 1 use the dynamics for w in 2 10 the definition of m in a 1 and the definitions of in 2 15 and a 6 to write a t t a 1 udu d k l 1 t t a 2 klu db kl u m k 1 t t a 3 kudw k u b t t b 1 udu d k l 1 t t b 2 klu db kl u m k 1 t t b 3 kudw k u a 12 where a 1 b 1 0 t sd r a 2 b 2 0 t sd md and a 3 b 3 0 t sd rm these functions with time subscripts represent for example a 1 u a 1 t u xu 2 add and subtract 1 2 d k l 1 t t a 2 klu 2 du 1 2 m k 1 t t a 3 ku 2 du 1 2 d k l 1 t t b 2 klu 2 du 1 2 m k 1 t t b 3 ku 2 du a 13 long term optimal investment in matrix valued factor models 19 to the right hand side of a and b respectively to obtain a t t a 1 u 1 2 d k l 1 a 2 klu 2 1 2 m k 1 a 3 ku 2 du log zt log zt b t t b 1 u 1 2 d k l 1 b 2 klu 2 1 2 m k 1 b 3 ku 2 du log z t log z t where z e d k l 1 a 2 klu db kl u m k 1 a 3 kudw l u z e d k l 1 b 2 klu db kl u m k 1 b 3 kudw k u a 14 3 show that for u t and x sd a 1 1 2 d k l 1 a 2 kl 2 1 2 m k 1 a 3 k 2 t u x t f t u x 0 b 1 1 2 d k l 1 b 2 kl 2 1 2 m k 1 b 3 k 2 t u x t f t u x 0 4 show that z z z t combining the above four steps a 7 is then verified remark a 4 for notational ease the following conventions are used 1 we will omit t t and the integrator du from all integrals 2 we will suppress the argument t u xu from all functions 3 we will also drop all time subscripts thus for example we will write f g db h dw t t f t u xu du t t g t u xu dbu xu t t h t u xu dwu the first identity in a 7 is now shown using cc dd 1 m and the dynamics of w in 2 10 ito s formula gives a 12 where a 1 pr p 1 2 p t l a 2 kl p c k l d i j 1 a ij kld ij a 3 k p d k a 15 20 long term optimal investment in matrix valued factor models while the second step follows from definitions of z and z we move onto the third step for u t and x sd it follows that a 1 1 2 d k l 1 a 2 kl 2 m k 1 a 3 k 2 pr p 1 2 p t l 1 2 p 2 cc p d i j 1 caij d ij 1 2 d i j k l 1 d ij tr aij akl d kl 1 2 p 2 dd 1 2 p p 1 p p d ij 1 caij d ij pr t l 1 2 d i j k l 1 d ij tr aij akl d kl a 16 the terms above containing are 1 2 p p 1 p d i j 1 caij d ij using 2 15 we obtain the following expression for the quadratic function in the previous line 1 2 q q d i j 1 caij d ij 1 2 q d i j k l 1 d ij aij c cakl d kl for both cases m n or m n thus substituting the previous expression into a 16 using the expressions for a v in 2 19 and f in 2 20 gives a 1 1 2 d k l 1 a 2 kl 2 m k 1 a 3 k 2 pr 1 2 q q d i j 1 caij d ij 1 2 d i j k l 1 d ij aij c cakl d kl t l 1 2 d i j k l 1 d ij tr aij akl d kl t l q d i j 1 caij d ij 1 2 d i j k l 1 d ij a ij kl d kl v t f 0 a 17 long term optimal investment in matrix valued factor models 21 finishing the third step for the last step recall the definition of z t from a 3 comparing with the definition of z in a 14 it suffices to show that a 2 kl q c k l d i j 1 a ij kl q c caij k l d ij a 3 k q d k q d i j 1 d caij k d ij a 18 using 2 15 for m n it follows that recall 1 when m n p q 1 d i j 1 caij d ij q q d i j 1 caij d ij similarly using 2 15 for m n gives recall 1 m for m n p q 1 d i j 1 caij d ij q q d i j 1 caij d ij therefore in both cases m n m n we have using the definition of a 2 a 3 in a 15 that a 2 kl p c k l d i j 1 a ij kld ij q c k l d i j 1 a ij kl q c caij k l d ij a 3 k p d k q d k q d i j 1 d caij kd ij which verifies a 18 the proof for the second identity in a 7 is similar first using the definition of m in a 1 ito s formula yields the second identity in a 12 where b 1 qr 1 q t l 1 2 q d k l 1 c k l kl c c k l 2 m k 1 d k d c k 2 b 2 kl q c k l kl c c k l 1 q d i j 1 a ij kld ij b 3 k q d k d c k a 19 22 long term optimal investment in matrix valued factor models using 1 q p q we obtain b 1 1 2 d k l 1 b 2 kl 2 1 2 m k 1 b 3 k 2 1 q pr 1 q t l 1 2 q 1 q d k l 1 c k l kl c c k l 2 m k 1 d k d c k 2 q 1 q d i j k l 1 c k l kl c c k l a ij kld ij 1 2 1 q 2 d k l 1 d i j 1 a ij kld ij 2 a 20 now using cc dd 1 m gives d k l 1 c k l kl c c k l 2 m k 1 d k d c k 2 cc tr c cc c 2 c 2 cc c 2 c c dd c dd c 2 dd c cc dd c cc dd c 2 cc dd c tr 2 c 2 c c c c 2 c tr 2 c 2 c c tr c c where the last equality follows since the definition of in 2 16 implies both and we also have d i j k l 1 c k l kl c c k l a ij kld ij d i j 1 caij tr aij c caij d ij d k l 1 d i j 1 a ij kl d ij 2 d i j k l 1 d ij tr aij akl d kl long term optimal investment in matrix valued factor models 23 plugging all of this into a 20 yields 1 1 q b 1 1 2 d k l 1 b 2 kl 2 1 2 m k 1 b 3 k 2 pr t l 1 2 q tr c c q d i j 1 caij tr aij c caij d ij 1 2 1 q d i j k l 1 d ij tr aij akl d kl a 21 on the right hand side terms involving are 1 2 qtr 1 2 q c c q d i j 1 tr aij d ij q d i j 1 c caij d ij a 22 for in a 6 the following identities hold tr d i j k l 1 d ij tr aij akl d kl c c d i j k l 1 d ij aij c cakl d kl d i j 1 tr aij d ij d i j k l 1 d ij tr aij akl d kl d i j 1 c caij d ij d i j k l 1 d ij aij c cakl d kl using above identities in a 22 we obtain the following expression for a 22 1 2 q d i j k l 1 d ij tr aij akl aij c cakl d kl 24 long term optimal investment in matrix valued factor models inserting this into a 21 gives 1 1 q b 1 1 2 d i j 1 b 2 ij 2 1 2 m l 1 b 3 l 2 pr t l 1 2 q q d i j 1 caij d ij 1 2 1 q d i j k l 1 d ij tr aij akl d kl 1 2 q d i j k l 1 d ij tr aij akl aij c cakl d kl t l q d i j 1 caij d ij 1 2 d i j k l 1 d ij tr aij akl q aij c cakl d kl pr 1 2 q t f 0 where the second to last equality uses 2 19 and 2 20 thus the third step is complete turning to the last step comparing z t in a 3 with z in a 14 it suffices to show b 2 kl q c k l d i j 1 a ij kl q c caij k l d ij b 3 k q d k q d i j 1 d caij k d ij using the definitions of b 2 and b 3 in a 19 it suffices to show that q kl q c c k l 1 q d i j 1 a ij kl d ij d i j 1 a ij kl q c caij k l d ij d c k d i j 1 d caij kd ij since kl d i j 1 a ij kl d ij from a 6 the last two identities readily follow finishing the proof appendix b proofs for subsection 3 1 1 throughout this section the model is from section 3 1 with and constant furthermore is assumed to satisfy assumption 3 1 we begin with the following lemma which identifies f v for v as in 3 2 long term optimal investment in matrix valued factor models 25 lemma b 1 for v tr mx as in 3 2 it follows for d n that f v x tr x 2 m 1 q m k m mk q m qm 1 2 p r 1 r 1 q tr ll m pr 0 b 1 for d n f v x tr x 2 m m k m mk q m qm 1 2 p r 1 r 1 q 2 qtr x x 1 xm m tr ll m pr 0 b 2 proof plugging in the model coefficients gives b x ll kx xk a ij kl x xik jl xjk il r x r 0 tr r 1 x x x x c x 1 d x therefore using the definitions in 2 19 calculation shows that b ij x ll kx xk ij q x ij q x ji a ij kl x xik jl xil jk xjk il xjl ik v x pr 0 1 2 ptr x r 1 r 1 1 2 qtr x b 3 and a ij kl x xik jl q x x x ik jl xil jk q x x x il jk xjk il q x x x jk il xjl ik q x x x jl ik b 4 for the given v d ij v d ji v mij and d ij kl v 0 therefore d i j k l 1 a ij kl d ij kl v 0 d i j 1 b ijd ij v tr x k m mk q m qm tr ll m b 5 where we have used repeatedly that m x are symmetric and that tr abc tr bca tr cab for matrices a b c when d n it follows that x 1 d and a from b 4 simplifies to a ij kl x xik q jl xil q jk xjk q il xjl q ik and hence using the symmetry for q b 6 1 2 d i j k l 1 a ij kl d ij vd kl v 2 tr x m 1 q m 26 long term optimal investment in matrix valued factor models therefore b 1 follows using b 3 b 5 b 6 and the definition of f in 2 18 when d n x x x x 1 x x x x 1 x thus using b 4 it follows that 1 2 d i j k l 1 a ij kl d ij vd kl v 2 tr xm m 2 qtr x x 1 xm m b 7 b 2 now follows from b 3 b 5 and b 7 proof of proposition 3 3 using lemma b 1 it follows for d n that if m solves 3 3 then f v with tr ll m pr 0 now with d m 3 3 takes the form d 2 1 q d d k q k q d 1 2 p r 1 r 1 q 0 since the eigenvalues of are and 0 then 2 1 q 2 1 q 0 furthermore by assumption p r 1 r 1 q 0 thus the riccati equation takes the form b 8 dbb d da a d cc 0 where b 2 1 q a k q and c 1 2 p r 1 r 1 q by 1 lemma 2 4 1 if there exists matrices f 1 and f 2 such that a bf 1 0 4 and a cf 2 0 then there is a unique solution m d to the above such that a bb d a bb m k q 2 1 q m 0 b 9 note that f 1 b 1 1 d a and f 2 c 1 1 d a are two such matrices hence b 8 admits a unique solution m such that b 9 holds for v tr m x consider the generator lv from a 2 which takes the form lv 1 2 d i j k l 1 a ij kl d ij kl d i j 1 b ij d k l 1 a ij kl m kl d ij the drift i e the first order term above takes the form b ij d k l 1 a ij kl m kl ll k q 2 1 q m x x k q 2 1 q m ij ll a bb m x x a bbm ij thus we see that the process x with generator given by lv is a wishart process of the form in 2 5 moreover b 9 implies thatk a bb m 0 hencex is ergodic indeed ll d 1 0 ensures x does not explode to the boundary of sd furthermore consider u x c log detx c x x 4 here and in what follows we write m 0 for a given matrix m md with m m 0 long term optimal investment in matrix valued factor models 27 where c c are two constants to be determined later and y is a smooth function satisfying 0 y 1 y 1 for y 1 and 0 for y 1 2 observe that lim x u x and limdet x 0 u x where both limits are uniform as x approaches the boundaries on the other hand a calculation similar to that in 43 lemmas 5 2 and 5 3 with therein equal to 0 shows the existence of c c 0 and a sufficiently large sub domain e sd such that lv u x for all x sd e therefore 41 theorem 6 1 3 shows that pv is ergodic hence v is equal to tr m x and tr ll m pr 0 this fact follows from 43 proposition 2 3 and 31 theorems 2 1 2 2 which shows the equivalency between lv being ergodic and being the smallest with accompanying solution v to f v lemma b 2 in the setting of example 3 4 for v as in 3 2 f v takes the form in 3 6 proof f v is given in b 2 of lemma b 1 specifying to the example coefficients and using the representation for x m from 3 5 2 m m k m mk q m qm 1 2 p r 1 r 1 q 2 m 2 2 m q 1 1 0 0 m q m 1 0 1 0 pr 1 1 0 0 1 1 2 q 2 1 0 0 0 2 m 21 m 2 2 m 2 m 1 m 3 m 2 m 1 m 3 m 2 2 m 2 3 2 m 1 m 2 m 2 m 3 q m 1 m 2 m 2 m 3 0 0 q m 1 m 2 0 m 2 m 3 0 pr 1 1 0 0 1 1 2 q 2 1 0 0 0 2 m 21 m 2 2 2 m 1 2 q m 1 m 2 pr 1 12 q 2 2 m 2 m 1 m 3 2 m 2 q m 2 m 3 2 m 2 m 1 m 3 2 m 2 q m 2 m 3 2 m 22 m 23 2 m 3 pr 1 thus tr x 2 m m k m mk q m qm 1 2 p r 1 r 1 q x 2 m 21 m 2 2 2 m 1 2 q m 1 m 2 pr 1 1 2 q 2 y 4 m 2 m 1 m 3 4 m 2 2 q m 2 m 3 z 2 m 22 m 2 3 2 m 3 pr 1 b 10 now as for the non constant term on the second line of b 2 from 3 7 we have 2 qtr x x 1 xm m 2 q 2 tr x y y y 2 x m 1 1 1 1 m 2 q 2 tr x y y y 2 x m 1 m 2 2 m 1 m 2 m 2 m 3 m 1 m 2 m 2 m 3 m 2 m 3 2 x 2 q 2 m 1 m 2 2 y 4 q 2 m 1 m 2 m 2 m 3 y 2 x 2 q 2 m 2 m 3 2 b 11 28 long term optimal investment in matrix valued factor models since tr ll m pr 0 2 m 1 m 3 pr 0 3 6 follows from b 10 and b 11 appendix c remaining proofs from section 3 proof of theorem 3 10 under assumptions of theorem 3 10 statement 2 7 part i is proved in 43 theorems 2 11 and 3 9 note that h v v part ii follows from h t 0 in part i and the form of in 2 15 to prove part iii let us collect two facts from 43 first 43 proposition 2 3 i implies that pv x as the solution to the martingale problem for lv is a well defined probability measure therefore discussion after a 3 proves that pv x is equivalent to px on ft for any t 0 second c 1 lim t e pv x t 0 d i j k l 1 d ij ha ij kl d kl h t u xu du 0 indeed since the integrand in c 1 is independent of the brownian motion w c 1 is proved in 43 theorems 2 9 and 3 9 let us use the previous two facts to prove 2 25 first to this end using 2 15 we obtain in either cases m n or m n t t x v x v x t t x v x v 1 1 p 2 d i j k l 1 d ij h aij c cakl d kl h t t x 1 1 p 2 d i j k l 1 d ij htr aij akl d kl h t t x 1 1 p 2 d i j k l 1 d ij ha ij kl d kl h t t x where the first inequality follows from a 10 and the second inequality follows from the first inequality in a 5 then c 1 yields lim t e pv x t 0 tu u xu tu u du 0 this implies the convergence in probability pv x hence in px since pv x is equivalent to px on ft to prove 2 24 apply the first identity of a 7 where we choose v from proposition 3 7 and t from 2 21 taking difference of this identity when t t and t 0 respectively yields wtt w p z v t t e v t x v t t xt on the other hand apply the first identity of a 7 again but choose from 2 23 and t x t v x where v comes from proposition 3 9 and the current choice of satisfies t f due to 2 22 taking difference of this identity when t t and t 0 respectively we obtain w t w p z v t e t v x t t v xt long term optimal investment in matrix valued factor models 29 therefore the ratio between the previous two identities reads c 2 wtt w t z v t t z v t eh t x h t t xt 1 p where h is defined in statement 2 7 part i it has been proved in part i that h t c for some constant c therefore eh t x h t t xt 1 a s as t in the next paragraph we will show c 3 pv x lim t z v t t z v t 1 plugging the previous two convergence back into c 2 it follows p v x lim t wtt w t 1 recall from remark a 1 that wt w is a pv x supermartingale combining the previous conver gence with scheffe s lemma we obtain lim t e pv x wtt w t 1 0 applying 22 lemma 3 9 under pv x the previous convergence then yields p v x lim t sup 0 u t wtu w u 1 0 hence 2 24 is confirmed after utilizing the equivalence between pv x and px it remains to prove c 3 to this end using a 3 for v and v and the definition of h it follows that z v t t z v t e lt t where the pv x local martingale lt takes the form ltt t 0 d k l 1 db klu d i j 1 a ij kl q c caij k l d ij h t u xu t 0 m k 1 dw ku q d i j 1 d caij kd ij h t u xu t t where b and w are pv x independent md and rm dimensional brownian motions calculation using cc dd 1 m and shows that lt lt t t 0 d i j k l 1 d ij h a ij kl q 1 q aij c cakl d kl h t u xu du using a 10 at dh sd it follows for p 0 0 q 1 that lt lt t t 0 d i j k l 1 d ij ha ij kl d kl h t u xu du 30 long term optimal investment in matrix valued factor models and for 0 p 1 q 0 that lt lt t t 0 d i j k l 1 d ij h a ij kl q 1 q tr aij akl d kl h t u xu du 1 q 1 q t 0 d i j k l 1 d ij ha ij kl d kl h t u xu du where the last inequality uses lemma a 2 from c 1 it thus follows that lim t e pv x lt lt t 0 which implies pv x limt lt lt t 0 combining the previous convergence and the fact that lt is continuous local martingales it follows pv x limt e lt t 1 hence c 3 holds proof of theorem 3 12 given results in 43 theorems 2 9 and 3 9 the statement follows from the same argument in 22 theorem 2 9 we now check that the assumptions in 22 are satisfied in the current setting first for each t 0 there exists a probability measure qt x such that qt x is equivalent to px on ft and such that e 0 r xu dus is a qt x local martingale on 0 t indeed let sd 7 rk be a continuous function and set zt e 0 d k 1 k xu dw k u t the continuity of and the p independence of x and w ensure that z is also a px martingale cf 33 lemma 4 8 under assumption 3 11 we may choose d dd 1 and it follows that is continuous since z is a px martingale for each t we may define a probability qt x which is equivalent to px on ft via dqt x dpx ft zt using girsanov s theorem a direct calculation shows that e 0 r xu dus is qt x local martingale therefore 22 assumption 2 3 is satisfied on the other hand propositions 3 7 and 3 8 combined implies that the value of the optimization problem in 2 12 is finite for all t 0 therefore 22 assumption 2 4 is satisfied as well on the other hand assumptions 2 8 and 2 9 are exactly 22 assumptions 2 1 and 2 2 respectively therefore 22 proposition 2 5 proves that for all 0 lim t p v t x sup u t w 1 tu wtu 1 0 lim t p v t x t 0 1 tu tu xu 1 tu tu du 0 c 4 here since the martingale problem for lv t is well posed cf 43 lemma 4 1 pt v x is defined via a 3 with v from the definitions of pv t x and pv x it follows dpv t x dpv x ft z v t t z v t long term optimal investment in matrix valued factor models 31 note that both events on the left hand side of c 4 are ft measurable therefore c 3 implies c 4 holds when pv t x is replaced by pv x hence also by px since pv x and px are equivalent on ft lastly the extension to statement 2 10 is immediate after utilizing statement 2 7 part iii proof of proposition 3 2 let us verify assumption 3 5 is satisfied under the parameter restrictions of this proposition then the statements readily follow from theorems 3 10 and 3 12 first for the wishart factor model described in section 3 1 v x pr 0 1 2 tr x p r 1 r 1 q x b x ll k x x xk x where k k q x since are bounded it is clear that b has at most linear growth we have seen from example 2 4 that f x x and g x then tr f x tr g x tr x tr dtr x in particular 1 in assumption 3 5 part 2 can be chosen as dtr to see the previous inequality let i i 1 d be eigenvalues of x then cauchy schwarz inequality yields tr x d i 1 i d d i 1 2 i 1 2 d x to verify assumption 3 5 part 3 we choose 1 to be larger than any largest eigenvalue of k k x for x sd since k x is bounded on sd its largest eigenvalue is uniformly bounded on s d move on to assumption 3 5 part 4 when 0 p 1 q 0 then pr 0 1 2 p r 1 r 1 q x x v x pr 0 1 2 p r 1 r 1 q x x x sd hence we can choose 1 2 1 2 supx sd p r 1 r 1 q x when p 0 q 0 then pr 0 1 2 p r 1 r 1 q x x v x pr 0 min x x where min x is the smallest eigenvalue of 1 2 p r 1 r 1 q x hence we can choose the same 2 as above but infx sd min x as 1 therefore assumption 3 5 part 4 is verified let us now check part 5 when p 0 because r 1 r 1 0 and 0 min x 0 for any x sd then 1 0 when k k x 1 d for any x sd 1 0 hence part 5 iii is satisfied when p r 1 r 1 q x 1 d for any x sd 1 0 hence we are in part 5 i in such a case tr f x xg x x tr x 3 2 x 3 for some 2 0 where the inequality holds due to 0 when 0 p 1 then 1 1 2 supx sd p r 1 r 1 q x 0 recall 1 q from lemma a 2 and 1 dtr from part 2 then 3 1 is equivalent to 21 16 1 1 0 from part 5 ii therefore assumption 3 5 part 5 is satisfied as well finally let us verify part a c for a calculation shows that h x b tr ll 1 d x 1 2 tr k x then ll d 1 ensures the existence of 0 such that ll 1 d 0 hence the previous inequality and the assumption that k is bounded on sd implies that infx sd h x b as for b part a implies the existence of 0 such that h x b tr x 1 2 tr k x observe that for any c 0 0 tr x 1 c 0 log det x as det x 0 then part b is confirmed lastly for part c there exist c 0 such that h 0 x b c 1 v x tr x 1 2 x c which goes to as detx 0 this concludes verification of all parameter restrictions in assumption 3 5 32 long term optimal investment in matrix valued factor models references 1 h abou kandil g freiling v ionescu and g jank matrix riccati equations systems control foundations applications birkha user verlag basel 2003 in control and systems theory 2 n ba uerle and z li optimal portfolios for financial markets with wishart volatility j appl probab 50 2013 pp 1025 1043 3 k bichteler stochastic integration with jumps vol 89 of encyclopedia of mathematics and its applications cambridge university press cambridge 2002 4 t bielecki d hernandez hernandez and s pliska risk sensitive asset management with constrained trading strategies in recent developments in mathematical finance shanghai 2001 world sci publishing river edge nj 2002 pp 127 138 5 t bielecki and s pliska risk sensitive dynamic asset management appl math optim 39 1999 pp 337 360 6 risk sensitive asset management with transaction costs finance stoch 4 2000 pp 1 33 7 m f bru wishart processes j theoret probab 4 1991 pp 725 751 8 a buraschi p porchia and f trojani correlation risk and optimal portfolio choice journal of finance 65 2010 pp 393 420 9 p cheridito d filipovic and m yor equivalent and absolutely continuous measure changes for jump diffusion processes ann appl probab 15 2005 pp 1713 1732 10 j cox and c f huang a continuous time portfolio turnpike theorem j econom dynam control 16 1992 pp 491 507 11 j da fonseca m grasselli and c tebaldi a multifactor volatility heston model quant finance 8 2008 pp 591 604 12 option pricing when correlations are stochastic an analytic framework rev deriv res 10 2010 pp 151 180 13 m davis and s lleo risk sensitive benchmarked asset management quant finance 8 2008 pp 415 426 14 j detemple and m rindisbacher dynamic asset allocation portfolio decomposition formula and applica tions review of financial studies 23 2010 pp 25 100 15 p dybvig l rogers and k back portfolio turnpikes review of financial studies 12 1999 pp 165 195 16 n el karoui and s hamade ne bsdes and risk sensitive control zero sum and nonzero sum game problems of stochastic functional differential equations stochastic process appl 107 2003 pp 145 169 17 w fleming and s sheu risk sensitive control and an optimal investment model math finance 10 2000 pp 197 213 18 risk sensitive control and an optimal investment model ii ann appl probab 12 2002 pp 730 767 19 h fo llmer and m schweizer hedging of contingent claims under incomplete information in applied sto chastic analysis london 1989 vol 5 of stochastics monogr gordon and breach new york 1991 pp 389 414 20 c gourieroux continuous time wishart process for stochastic risk econometric rev 25 2006 pp 177 217 21 c gourieroux j jasiak and r sufana the wishart autoregressive process of multivariate stochastic volatility j econometrics 150 2009 pp 167 181 22 p guasoni c kardaras s robertson and h xing abstract classic and explicit turnpikes finance stoch 14 2014 pp 75 114 23 p guasoni and s robertson portfolios and risk premia for the long run ann appl probab 22 2012 pp 239 284 24 p guasoni and s robertson static fund separation of long term investments math finance 2014 25 n hakansson convergence to isoelastic utility and policy in multiperiod portfolio choice journal of financial economics 1 1974 pp 201 224 26 l p hansen and j a scheinkman long term risk an operator approach econometrica 77 2009 pp 177 234 27 h hata and j sekine risk sensitive asset management with wishart autoregressive type factor model journal of mathematical finance 3 2013 pp 222 229 long term optimal investment in matrix valued factor models 33 28 r a horn and c r johnson topics in matrix analysis cambridge university press cambridge 1991 29 c f huang and t zariphopoulou turnpike behavior of long term investments finance stoch 3 1999 pp 15 34 30 g huberman and s ross portfolio turnpike theorems risk aversion and regularly varying utility functions econometrica 51 1983 pp 1345 1361 31 n ichihara recurrence and transience of optimal feedback processes associated with bellman equations of ergodic type siam j control optim 49 2011 pp 1938 1960 32 x jin consumption and portfolio turnpike theorems in a continuous time finance model j econom dynam control 22 1998 pp 1001 1026 33 i karatzas and c kardaras the nume aire portfolio in semimartingale financial models finance stoch 11 2007 pp 447 493 34 i karatzas and g z itkovic optimal consumption from investment and random endowment in incomplete semimartingale markets ann probab 31 2003 pp 1821 1858 35 k kuroda and h nagai risk sensitive portfolio optimization on infinite time horizon stoch stoch rep 73 2002 pp 309 331 36 h leland on turnpike portfolios in mathematical methods in investment and finance k s g szego ed north holland amsterdam 1972 37 e mayerhofer o pfaffel and r stelzer on strong solutions of positive definite jump diffusions sto chastic process appl 121 2011 pp 2072 2086 38 j mossin optimal multiperiod portfolio policies journal of business 41 1968 pp 215 229 39 h nagai optimal strategies for risk sensitive portfolio optimization problems for general factor models siam j control optim 41 2003 pp 1779 1800 electronic 40 j najnudel and a nikeghbali a new kind of augmentation of filtrations esaim probab stat 15 2011 pp 39 57 41 r pinsky positive harmonic functions and diffusion vol 45 of cambridge studies in advanced mathematics cambridge university press cambridge 1995 42 a richter explicit solutions to quadratic bsdes and applications to utility maximization in multivariate affine stochastic volatility models stochastic process appl 124 2014 pp 3578 3611 43 s robertson and h xing large time behavior of solutions to semi linear equations with quadratic growth in the gradient in revision 2014 44 s ross portfolio turnpike theorems for constant policies journal of financial economics 1 1974 pp 171 198 scott robertson department of mathematical sciences wean hall 6113 carnegie mellon univer sity pittsburgh pa 15213 usa e mail address scottrob andrew cmu edu hao xing department of statistics london school of economics and political science 10 houghton st london wc 2 a 2 ae uk e mail address h xing lse ac uk 1 introduction 2 set up 2 1 a s d valued state variable 2 2 the financial model 2 3 the optimal investment problem 2 4 long horizon convergence 2 5 turnpike theorems 3 main results 3 1 the generalized wishart factor model 3 2 general state variables appendix a proof of proposition 3 8 appendix b proofs for subsection 3 1 1 appendix c remaining proofs from section 3 references