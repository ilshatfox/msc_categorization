nick williams 2014 title conclusions from a na ve bayes operator predicting the medicare 2011 transaction data set abstract introduction the united states federal government operates one of the world s largest medical insurance programs medicare to ensure payment for clinical services for the elderly illegal aliens and those without the ability to pay for their care directly the program is mired in controversy over its costs and consequences this paper evaluates the medicare 2011 transaction data set which details the transfer of funds from medicare to private and public clinical care facilities for specific clinical services drg for the operational year 2011 methods data mining was conducted to establish the relationships between reported and computed transaction values in the data set to better understand the drivers of medicare transactions at a programmatic level na ve bayes is a classification algorithm for establishing the predictability of a labeled class variable of data given the presence of other data elements this paper adapts the traditional na ve effort to characterize the added model value that class attributes have on a data set permuted by redaction one class redaction set per available class second the cross validation algorithm was trained to the redaction sets computing model values for the highest accuracy and kappa lowest accuracy and kappa as well as mikro or average accuracy and kappa of the cross trained models per redacted set results the models averaged 88 for average model accuracy and 38 for average kappa during training some reported classes are highly independent from the available data as their predictability remains stable regardless of redaction of supporting and contradictory evidence drg or procedure type appears to be unpredictable from the available financial transaction values this independence from the financial and geographic values in the data set across the redaction matrix suggests that charges payments and financial losses are not driven by procedure even when adjusted for discharge conclusions overlay hypotheses such as charges being driven by the volume served or drg being related to charges or payments is readily false in this analysis despite 28 million americans being billed through medicare in 2011 and the program distributing over 70 billion in this transaction set alone it may be impossible to predict the dependencies and data structures the payer of last resort without data from payers of first and second resort political concerns about medicare would be better served focusing on these first and second order payer systems as what medicare costs is not dependent on medicare itself overview the medicare 2011 transaction data set mtds is a joined transformation of the medicare provider charge data sets which aggregates and compiles all values from the inpatient and outpatient sets for the year 2011 i this mtds details the transfer of money from the united states federal government s medicare insurance program to provider facilities for specific clinical services while the complexity of the multi billion dollar program is as vast and complicated as the clinical experiences of the tens of millions it serves and the providers it enrichesii or impoverishesiii there has been little work to understand the structure and independence of financial transactions rather glib understandings and shallow evaluations have dogged the program from its inception fueling various and sometimes contradictory political debates from the proper cost of medical care iv to the explosion of physician salaries relative to the incomes of the general public whom they claim to serve lately the immigration debate v medicare will pay for clinical procedures for illegal aliens has refueled the politicization of a largely unevaluated program mirroring yesteryear s medicare debate about the racial integration of public and private hospitals using federal funds following the civil rights act in 1964 vi what we want medicare to prove and what medicare transactions actually detail will remain a mystery as long as medicare remains under described in the terms which it actually operates as the payer of last resort medicare is a stop gap measure that insures facilities will be paid regardless of the financial constraints of whom they practice on this utility while essential for any market system that offers essential clinical care at cost and often for profit has some glaring undersides including the inflation of the need for carevii the conflation of care and cost independent of price as well as wild departures between the charge for identical care facility to facility within the same country and reimbursement system as specialty care and unique clinical experiences of patients become increasingly legible to reimbursement schemes that aim to leave no one behind they fall under increasing weight to become economically responsible and confrontational to cost without accounting for or documenting profits graph one mtds total charges costs payment and discharges by facility drg transaction here we see charges widely outstrip authorized payments the difference loss is also varied across the program further outpatient far right drg s take on most of the people receiving services yet garner lower charges and even lower payments than inpatient care with variation 0 20000 40000 60000 80000 100000 120000 140000 160000 180000 150 000 000 00 100 000 000 00 50 000 000 00 0 00 50 000 000 00 100 000 000 00 150 000 000 00 200 000 000 00 total charge total payment total loss total population the mtds offers facility level transparency at least for one health insurance system inside the united states one of many government health care funding schemes a full understanding of health transactions would require line item surveillance of private public and personal expenditures on health while the relationship between charge and undocumented cost may be a data mining nightmare there is sufficient data reported in the mtds to evaluate the added contribution each class value has on the annualized programmatic structure of the data set when an artificial intelligence method like na ve bayes is used to discover and detail structures within the mtds this publication explores the structural dependencies of each class variable of the 2011 mtds methods the na ve bayes classifier has many uses and deploymentsviii over the last several years it has become the method of choice and a popular resource for the innovation and testing of data mining and predictive methodsix using a traditional posterior distribution model na ve efforts assume the independent of information in a data set and asks how this independent evidence fits with other variables and then returns a predictive value traditional artificial intelligence schema such as training values uncertainty matrices and cross annotated x validation are methodologically relevant but too complex to be detailed here contrary to popular convention the independence within a na ve model is not necessary for the test to work it is a pun or a play on words but rather it is the variation of that independence which cannot be total for a bayesian statistician from other evidence or data that rates and offers relative predictive value training opportunities accuracy and various contributions to statistical outputs in a na ve bayes operator this paper evaluates the mtds for the independence increase or decrease in accuracy and kappa scores of each class variable contained within the data set in a blinded framework using the rapid miner open source data mining suite the use of a na ve evaluation on financial data is fairly rare outside of fraud detection and even more novel for an annualized evaluation of a programmatic outcomes data set due to discretizationx the availability of time series data and other challenges of working with transaction data ai methods are often avoided in favor of health econometric and patient level evaluation the use of a data mining method like na ve bayes on a data set like this requires some grounding in both transaction data data structures and blind testing below i detail briefly the overall concepts as well as the study protocol the data set the data model the data follows a traditional rectangular format a spreadsheet uses this format where variable names are printed in the left side of the tuple and each transaction is detailed below in alphabetical order by provider facility transactions are detailed by individual provider aggregated charges by number discharged or the total drgs by transaction type blind testing blind redaction is a data mining method it is used to detect the added value of a class variable to the overall structure of a data set it can be used on any rectangular data matrix some considerations are necessary for spatial square and triangular matrices it detects the added value of a class variable by subtracting redacting a whole class of information from the data set and applying a single statistical predictability or learning test for each class value the redacted variable is then returned to the data set and another variable is redacted and the remaining values are retested until we have a statistical score for the predicative evidence of each variable under each blinded condition one unique data set and one statistical test per variable class within the original data set the scores are then graphed using a simple method line bar box plot and displayed to quickly discern the collapse of the accuracy of a prediction of a class value given the absence of a blind class this value of the accuracy of the data in the face of the blinded class allows us to see the added value given the blinded subtraction its absence would have lent to the prediction of a given class a na ve bayes classifier gets extra statistical umph from running the model and training it to predict classes multiple times this is called x pronounced cross validation as it is typically though not necessarily run ten times the averages of the accuracy scores given x validation is the micro score which is the average of the accuracy out of 100 this protocol ran the cross validation 10 times protocol the order of operations is to compile the data transform through aggregation and discharge adjustment of discharge averaged transactions label the classes blind the data iteratively compute the score using na ve bayes apply cross x 10 validation to the na ve model and record the statistical scores and then repeat until each score is populated see tables 1 and 2 finally we graph the iterative scores to see the added value an absence blind subtraction in the data makes kappa and accuracy scores were used as the statistical output in this model mikro scores or the average of the model s kappa and accuracy were also recorded results if accuracy is low near 0 the available data did not inform the predictability of the value if the accuracy is high near 100 then the component data variables in the data set that was not blinded enable predictability of the accuracy value proportionately the kappa shows the agreement between the models during x validation the mikro or average accuracy or average kappa will show us how the models fared when x trained to predict the best model given the available data the accuracy or kappa is the most accurate model agreement out of ten x training sessions is the lowest often the first and mikro is the average of all trained sets under the x validation operation please note that graph 2 and graph 4 have the same data they are simply sorted differently to demonstrate dimensionality the same is true of graphs 3 and 5 table one accuracy mikro scores accuracy charge per discharge facility total charge discharges drg loss per discharge facility total loss payment per discharge facility total paymemt state zip blind charge per discharge n a 99 28 99 96 1 23 97 96 98 66 95 98 99 42 99 69 99 83 blind facility total charge 98 27 n a 99 84 1 23 98 12 98 37 95 82 99 52 99 74 99 83 blind city 98 98 93 99 75 1 89 97 89 98 14 95 83 99 21 99 37 99 57 blind discharge 98 13 99 09 n a 1 14 97 99 98 41 96 09 99 33 99 75 99 81 blind drg 98 16 98 98 99 84 n a 97 88 98 26 94 22 99 23 99 66 99 78 blind inoroutpt 98 24 99 23 99 93 1 06 98 05 98 6 95 65 99 46 99 66 99 77 blind loss per discharge 97 91 99 27 99 96 1 21 n a 98 66 95 95 99 43 99 69 99 83 blind facility total loss 98 29 99 13 99 89 1 22 98 13 n a 95 83 99 54 99 74 99 83 blind payment per discharge 91 1 99 3 99 95 0 1 97 92 98 72 n a 99 52 99 78 99 86 blind facility total paymemt 98 22 99 25 99 62 1 2 98 06 98 06 95 68 n a 99 71 99 8 blind provider 99 38 98 89 99 73 6 42 97 72 98 02 95 72 99 2 99 2 99 2 blind state 98 25 99 06 99 91 1 3 98 1 98 39 95 75 99 26 n a 99 19 blind zip 98 21 99 1 99 9 1 3 98 07 98 4 95 75 99 35 98 81 n a when payment per discharge is blind charge per discharge becomes 7 harder to predict across model values drg is comparatively unlearnable with an average of 6 being the highest accuracy when individual provider is blinded from the model other predictions were between 94 and 99 accurate or predictable given the other data variables in the model table two kappa mikro scores kappa charge per discharge facility total charge discharges drg loss per discharge facility total loss payment per discharge facility total paymemt state zip blind charge per discharge n a 0 095 0 595 0 005 0 386 0 172 0 487 0 038 0 997 0 998 blind facility total charge 0 423 n a 0 289 0 005 0 427 0 119 0 481 0 038 0 997 0 998 blind city 0 392 0 069 0 222 0 011 0 403 0 131 0 483 0 028 0 993 0 995 blind discharge 0 398 0 077 n a 0 004 0 407 0 149 0 481 0 033 0 997 0 998 blind drg 0 404 0 07 0 267 n a 0 394 0 137 0 377 0 029 0 996 0 997 blind inoroutpt 0 406 0 087 0 437 0 003 0 406 0 163 0 461 0 041 0 996 0 997 blind loss per discharge 0 351 0 094 0 601 0 004 n a 0 172 0 481 0 039 0 997 0 998 blind facility total loss 0 425 0 074 0 364 0 004 0 428 n a 0 481 0 047 0 997 0 998 blind payment per discharge 0 0 095 0 484 0 006 0 377 0 175 n a 0 045 0 998 0 998 blind facility total paymemt 0 416 0 091 0 119 0 004 0 42 0 42 0 469 n a 0 997 0 997 blind provider 0 067 0 067 0 207 0 057 0 384 0 126 0 479 0 028 0 992 0 99 blind state 0 42 0 075 0 442 0 005 0 426 0 147 0 472 0 03 n a 0 99 blind zip 0 415 0 079 0 389 0 005 0 422 0 148 0 474 0 034 0 988 n a facility total charge facility total loss and facility total payment averaged low kappa for agreement between models under x validation this indicates that these fields are the hardest to learn and predict given the available un blinded data in the set when payment per discharge is redacted the model lost integrity learned the wrong things when attempting to predict drg graph two effects of values top when blinded bottom accuracy range value blind charge pp charge total discharge drg loss pp loss total payment pp payment total state zip c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e 0 50 100 a c c u ra c y 0 50 100 m ik ro 0 10 20 a c c u ra cy highest accuracy approaches 100 for the best most learned x validated models drg is notably unpredictable with even the average training score being very low further payment pp pp per discharge per person and charge pp blinded by payment pp has lower learning success graph three effects of values top when blinded bottom kappa range value blind charge pp charge total discharge drg loss pp loss total payment pp payment total state zip c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t t o ta l p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p r o v id e r s t a t e z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r z ip c h a rg e p p c h a rg e t o ta l c it y d is c h a r g e d r g in o ro u t p t l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l p r o v id e r s t a t e 0 0 0 5 1 0 k a p p a 0 0 0 5 1 0 m ik ro 0 00 0 05 0 10 k a p p a model agreement found four patterns zip and state show weak openings and strong finishes from learning payment total drg and charge total show weak agreement between models which does not improve charge pp loss pp and payment pp follow a modest agreement improvement lastly the inconsistent agreement for discharge models suggests that the values in discharge class are highly dependent on other values when achieving model agreement graph four effects of values bottom when blinded top accuracy blind value charge pp charge total city discharge drg inoroutpt loss pp loss total payment pp payment total provider state zip c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te 0 50 100 a c c u ra c y 0 50 100 m ik ro 0 10 20 a c c u ra cy when payment pp is blinded charge pp becomes readily predictable as the lowest accuracy score approaches 100 predicting drg does not have the same relationship even after cross validation sessions graph five effects of values bottom when blinded top kappa blind value charge pp charge total city discharge drg inoroutpt loss pp loss total payment pp payment total provider state zip c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l z ip c h a rg e p p c h a rg e t o ta l d is c h a r g e d r g l o s s p p l o s s t o ta l p a y m e n t p p p a y m e n t t o ta l s ta te 0 0 0 5 1 0 k a p p a 0 0 0 5 1 0 m ik ro 0 00 0 05 0 10 k a p p a the kappa of the learning process is fairly consistent here as values respond differently have different added value given the blinded sets further many kappa s are consistent across the blinded sets suggesting good model cohesion and learning ability discharge appears easier to learn initially than other elements discussion medicare is the payer of last resort this position within a wider insurance scheme should be considered when evaluating medicare transactions as the specific procedure is not predictable given the financial constraints and the availability of strong prediction values of the same legality while discretization by a financial range may help to classify drg values assuming such classes are uniform across providers geographies and price charts in and out patient difference and cost differences between in and outpatient procedures failed to train the models appropriately to predict drg further the data model of the transaction set itself is not sufficient evidence of behavior to predict drg despite the transaction values contained in the set and strong prediction values from other model runs conclusions the overlay hypotheses such as charges being driven by the volume served or drg being related to charges or payments is readily false in this analysis despite 28 million americans being billed through medicare in 2011 and the program distributing over 70 billion in this transaction set alone it may be impossible to predict the dependencies and data structures of the payer of last resort without data from payers of first and second resort political concerns about medicare would be better served focusing on these first and second order payer systems as what medicare costs is not dependent on medicare itself i the original sets are available on line at http www cms gov research statistics data and systems statistics trends and reports medicare provider charge data ii weeks wb wallace ae wallace mm welch hg a comparison of the educational costs and incomes of physicians and other professionals n engl j med 1994 330 18 1280 6 iii bryan t vaughn steven r devrieze shelby d reed and kevin a schulman can we close the income and wealth gap between specialists and primary care physicians doi 10 1377 hlthaff 2009 0675 health aff may 2010 vol 29 no 5 933 940 iv gerard f anderson from soak the rich to soak the poor recent trends in hospital pricing doi 10 1377 hlthaff 26 3 780 health aff may 2007 vol 26 no 3 780 789 v dana p goldman james p smith and neeraj sood immigrants and the cost of medical care doi 10 1377 hlthaff 25 6 1700 health aff november 2006 vol 25 no 6 1700 1711 vi jill quadagno promoting civil rights through the welfare state how medicare integrated southern hospitals social problems vol 47 no 1 feb 2000 pp 68 89 vii peter conrad the medicalization of society on the transformation of human conditions jhu press apr 1 2008 viii harry zamg the optimality of naive bayes http www academia edu 5833043 the optimality of naive bayes ix the weka data mining software an update newsletteracm sigkdd explorations newsletter archivevolume 11 issue 1 june 2009 pages 10 18 acm new york ny usa table of contents doi 10 1145 1656274 1656278 x ying yang geoffrey i webb on why discretization works for naive bayes classifiers ai 2003 advances in artificial intelligence lecture notes in computer science volume 2903 2003 pp 440 452 http dl acm org citation cfm id j 721 picked prox cfid 412319380 cftoken 35090079 http dx doi org 10 1145 1656274 1656278 http dl acm org citation cfm id 1656274 picked prox cfid 412319380 cftoken 35090079 http www acm org publications