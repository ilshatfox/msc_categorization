1 spatial alignment group strategy and non kin selection enable the evolution of cooperation xiaoliang wang 1 2 andrew harrison 3 1 college of life sciences zhejiang university hangzhou 310058 china 2 school of physical sciences university of science and technology of china hefei 230026 china 3 department of mathematical sciences university of essex colchester co 4 3 sq uk correspondence x w wxliang mail ustc edu cn a h harry essex ac uk abstract this article considers a mechanism to explain the emergence and evolution of social cooperation selfish individuals tend to benefit themselves which makes it hard for the maintenance of cooperation between unrelated individuals we propose and validate that a smart group strategy can effectively facilitate the evolution of cooperation provided cooperators spatially align whilst cooperating at a new level of alliance the general evolutionary model presented here shows that a non kin selection effect is a possible cause for cooperation between unrelated individuals and highlights that non kin selection may be a hallmark of biological evolution keywords biological evolution group strategy non kin selection evolutionary origins evolutionary theory main text a long standing puzzle in biological evolution is how cooperative behavior can be maintained within the selfish natural world 1 6 in prisoner s dilemma defection is often the evolutionarily stable strategy ess see fig 1 explaining cooperation is essential to understand the major evolutionary transitions in biology 7 many explanations for cooperation 8 27 are proposed such as kin selection 4 8 9 group selection 10 13 tit for tat strategy 14 16 reciprocity 17 19 policing and punishment 4 20 and biological range expansion 21 23 however the basic evolutionary question why the living world evolves from simple to complex organizations has not been explained directly kin selection theory which is encapsulated in hamilton s rule rb c 0 r is the genetic relatedness between actor and recipient b and c are benefits and costs of cooperation respectively argues that cooperation will evolve if the benefits produced by an individual s cooperative behavior lead to individuals with genes that increase their inclusive fitness 9 28 such an explanation can only account for the maintenance of cooperation among genetic relatives especially in animal societies 29 31 although many theories and models have also been proposed for cooperation between non kin 32 34 there are few unified evolutionary models and explanations for the continued cooperation between kin and that between non kin which has universally occurred in cooperation between genomes organelles and even humans 28 32 35 a unified evolutionary theory is important as it can help to reveal the evolutionary rules for all organisms here based on a quantitative agent based approach 36 37 we propose that a smart group strategy gs taken by a group of individuals independent on whether they are genetically related or unrelated can effectively increase their fitness and promote their competition with opponents we develop a general evolutionary model to explain the preservation of cooperation between related and unrelated individuals we find that non kin selection is a natural law of biological evolution the idea of a group strategy arises from our counterintuitive observation chemotaxis of microbial individuals the directed motion guided by beneficial chemical cues with which individuals can improve their fitness impedes rather than promotes their competition with opponents at the population level figs 2 a and mailto wxliang mail ustc edu cn mailto harry essex ac uk 2 2 b this highlights a conflict between individual and population level interests figs 2 c and 2 d this result demonstrates that in the competition between populations an individual s evolutionary advantage might not be that of a population instead it may even become deleterious to a population s evolution and the short sighted selfish behaviors of individuals may not be that favored as we expect this situation sets a higher requirement for the evolution of populations and a smarter group strategy will be favored we first validate the group strategy see box 1 for methods and the game rule for the evolution of cooperation through implementing it into the natural selection term of the stepping stone model ssm see supporting information s 1 1 fig 1 a shows that when cooperators take group strategy in the prisoner s dilemma taking place within a one dimensional closed space cooperation is increasingly favored and is finally selected for evolution with the higher levels of gss taken larger which means larger cooperation alliances involving more members this result is important for evolutionary theory which has showed the possibility of natural selection in explaining the self organization of individuals into complex biological organizations in the cheating world in theory the well mixed finite population the condition for the evolutionary stability of cooperation cooperation is ess is derived as f g k eg k k 1 b c d d b f 0 1 where eg k is the benefit obtained via the group strategy which is conducted among k cooperators fg k is the frequency that the total individuals conducting that group strategy occupy within the cooperator population represents the highest gs level taken and f 0 is the initial frequency of cooperators within the whole population we consider the linear benefit distribution of gss fig 1 b with the higher benefit increment produced by a new level of gs higher cooperators can take a lower level of gss to outcompete defectors fig 1 c which suggests the importance of cooperation efficiency the difference between simulations and the theory box 1 eq 2 is mainly due to the finite population size effect 38 from the obtained phase diagram in the two dimensional space consisting of and the population size n population density fig 1 d we can observe the evolution phase of cooperation invades the non evolution phase at small n but stabilizes at a steady interface when n 40 we further include the effect of the initial frequency f 0 and plot in fig 1 e the landscape of the lowest gs level taken for the evolution of cooperation we can see that both higher n and f 0 can facilitate the evolution of cooperation with the lower required to be taken in particular the evolution of cooperation is impossible even for a high initial frequency provided the population size is too small e g n 10 this means that a sufficient number of individuals are necessary to establish an effective group strategy box 1 group strategy consider species a cooperators within a population takes the group strategy gs namely establishes a cooperative spatial alignment within a group of independent individuals with any genotypes let 1 2 denote a set of group strategies conducted within finite populations where is the group strategy conducted among k individuals box figure a and represents the highest cooperation level of the system n note that k 1 indicates no cooperation between individuals let be the number of then the number distribution of group strategies n 1 2 let be the total number of individuals that participate into then the size distribution of the populations involved in specific group strategies 3 1 2 with 1 where is the total number of species a inside the whole population let be the frequency that the total individuals conducting occupy within the whole population of species a then the frequency distribution 1 2 with 1 1 let 1 2 denote the benefit distribution of the set of group strategies where is the benefit that an individual can obtain via the group strategy so we can derive the resultant fitness of one cooperator within this system as a 1 where a in the payoff matrix has incorporated the cooperation structure different levels of cooperation among individuals when 1 a 1 which represents the inherent fitness of cooperators resulting from their individual cooperative behavior box figure a illustration of cooperative spatial alignments taking the specific group strategy by cooperators b the game rule in ssm simulations according to the nash equilibrium the well mixed infinite population the condition for cooperation is ess is wa 0 0 1 0 wb 0 c 0 d 1 0 namely 1 0 1 in our ssm simulations we make cooperators preferentially take the high level group strategy provided there is a sufficient number of individuals to compose that group the game rule for example for a 10 person group if their highest cooperation level is to take the group strategy 5 i e 5 then these 10 individuals will organize into two 5 person alignments box figure b if 3 the set of gss taken by the 10 people are three 3 person alignments and one 1 person group for infinite populations under our game rules cooperators can all take the highest level of group strategy if they succeed in evolving in such a case 1 therefore in the well mixed infinite population with the incorporation of the group strategy the approximate condition for the evolution of cooperation is reduced to alignments 5 a n 0 0 0 0 2 n 0 0 0 0 10 f 0 0 0 0 1 n 0 1 0 2 n 0 2 0 8 f 0 0 2 0 0 8 n 1 0 3 n 1 0 9 f 0 1 0 0 9 b 2 person 5 person 3 person 2 3 4 0 2 in evolution the group strategy can also be taken by defectors one can expect that such a situation will enhance the difficulty for the evolution of cooperation and compel cooperators to evolve to a higher level of cooperation organization within this expectation cooperators always need to take a new level of group strategy when defectors take an increasingly high level of gs fig 1 f this result can explain why the living world generally evolves in the direction of more complex organizations and the group strategy may play a significant role in biological evolution under more severe prisoner s dilemmas larger c a and d b higher levels of gss are expected to be taken fig 1 g we validated the effectiveness of group strategy for repeated games between cooperator and defector groups in well mixed finite populations figs 3 a and 3 b see box 2 for methods we wondered how cooperation can be maintained between genetically unrelated individuals to get the essence of problem we develop a general model for the evolution of social cooperation fig 4 a we find that cooperation can be preserved to a large degree among unrelated individuals only if cooperators can be continuously supplemented with new cooperator members of genotypes that have little genetic dependence on old cooperator members i e little kin selection effect when new cooperator members are selected from the gene pool with a strong genetic dependence on old members the extreme example is that the new members are reproduced by old members the total number of cooperator genotypes decreases over time despite the continuous increase of cooperators within the whole population fig 4 b after a long period of evolution only one of the original fifteen cooperator genotypes survived and took over the whole population genetic relatedness 1 fig 4 c with the others all removed during this process fig 4 d however if new cooperator members are supplemented with no genetic dependence on the cooperator group e g new members are selected from the gene pool with the equal probability of the 15 genotypes the cooperator group can still preserve those original 15 genotypes and maintain the low genetic relatedness among members over a long period of evolution figs 4 e g we next investigate the effect of kin selection strength ckin on the evolution of cooperator genotypes in the population with the reducing kin selection impact more cooperator genotypes can be preserved in the cooperator group fig 4 h and fig 3 c we can further observe from the landscape of the number of preserved cooperator genotypes ngt in the population that the kin selection effect is stronger at smaller n below the dashed line with fewer genotypes to be preserved fig 4 i this is owing to the strong sampling effect arising from the small number of individuals at the low population size 37 39 40 the impact of kin selection on ngt in a large range of n is observed to obey a unified threshold function of the form fig 5 a ngt a 1 ckin 1 ckin 1 kkin 1 2 where both the parameter a and the threshold kkin are related to n figs 5 b d especially 1 kkin is observed to exponentially decay as n with a characteristic constant 37 our results demonstrate that the cause for the low genetic relatedness between individuals in the biological systems we have studied is the non kin selection effect on various cooperator groups which is taken by the nature since natural non kin selection is the evolutionary force box 2 eq 1 it will gradually drag the biological attribute of organisms from kin selection to the final non kin selection the most significant difference between humans and animals may be that we humans have evolved to abandon the absolute kin selection to survive throughout the operation of our lives fig 4 j 5 box 2 evolutionary model for repeated social games in each round of the game between cooperator and defector groups fig 4 a the winning side has a chance to add one new member from the gene pool into its group and the losing side will remove one old member from its group this updating continues until one side completely takes over the whole population the chance to add one new member for both sides is proportional to the current fitness of these two competition groups the fitness of each side is calculated according to the payoff matrix described in the stepping stone model see supporting information s 1 1 wa af 1 f wb cf d 1 f here f is the frequency of cooperators in the whole population both sides can choose to take the group strategy proposed here in that case the element a will be replaced with a to explore how cooperation can long be preserved among genetically unrelated individuals we make the population continue to update even after cooperators have taken over the whole population during this process in each round one new cooperator member is selected from the gene pool and one old cooperator member in the group is removed throughout the whole evolutionary process the removed member is randomly selected from its group with the probability proportional to its abundance in that group while the newly added member is chosen randomly from the gene pool with the probability expressed as where fgety i is the frequency of genotype i in the cooperator defector group ngety is the total number of genotypes in the corresponding gene pool ckin 0 1 is the coefficient which can be used to tune kin selection strength when ckin 0 the newly added member is selected with the equal probability of genotypes in gene pool that is genetically independent of old members in competition groups when ckin 1 the addition of new members will completely depend on corresponding old genetically related members the group strategy proposed here is possibly a key evolutionary mechanism for shaping complex biological organizations when and only when the non kin selection effect is included the cooperation between unrelated individuals can long be preserved providing a good explanation for cooperation between non kin 1 j f nash proc natl acad sci usa 1950 36 48 2 j m smith j theor biol 1974 47 209 221 3 m a nowak science 2006 314 1560 4 s a west a s griffin a gardner p d stephen nat rev microbiol 2006 4 597 5 s a west a s griffin a gardner curr biol 2007 17 r 661 6 k l asfahl m schuster fems microbiol rev 2017 41 92 7 e szathmary j m smith nature 1995 374 227 232 8 w d hamilton am nat 1963 97 354 9 w d hamilton i ii j theor biol 1964 7 1 pgety i ckin fgety i 1 ckin 1 ngety 1 pgety i ngety i 1 1 biological kin selection natural non kin selection 6 10 v c wynne edwards oliver and boyd edinburgh 1962 11 d s wilson proc natl acad sci usa 1975 72 143 12 a traulsen m a nowak proc natl acad sci usa 2006 103 10952 13 a gardner group selection oxford bibliographies in evolutionary biology oxford university press 2018 14 r axelrod basic books new york 1984 15 m a nowak k sigmund nature 1992 355 250 16 m a nowak a sasaki c taylor d fudenberg nature 2004 428 646 17 r trivers q rev biol 1971 46 35 18 h ohtsuki c hauert e lieberman m a nowak nature 2006 441 502 19 d preussger et al curr biol 2020 30 3580 20 k sigmund c hauert m a nowak proc natl acad sci usa 2001 98 10757 21 c d nadell k r foster j b xavier plos comput biol 2010 6 e 1000716 22 j d van dyken m j i muller k m l mack m m desai curr biol 2013 23 919 23 m s datta k s korolev i cvijovic c dudley j gore proc natl acad sci usa 2013 110 7354 24 a s griffin s a west a buckling nature 2004 430 1024 25 j gore h youk a van oudenaarden nature 2009 459 253 26 c hilbea s simsa k chatterjee m a nowak nature 2018 559 246 27 a li et al nat commun 2020 11 y 2259 28 a gardner a s griffin s a west els john wiley sons 2016 29 s a west a gardner a s griffn curr biol 2006 16 r 482 30 r m fisher c k cornwallis s a west curr biol 2013 23 1120 31 p kennedy a d higginson a n radford s sumner nature 2018 555 359 32 e fehr u fischbacher nature 2003 425 785 33 c j goodnight popul ecol 2005 47 3 34 t clutton brock nature 2009 462 51 35 t kay l lehmann l keller curr biol 2019 29 r 438 36 m kimura g h weiss genetics 1964 49 561 37 k s korolev m avlund o hallatschek d r nelson rev mod phys 2010 82 1691 38 m a nowak k sigmund science 2004 303 793 39 o hallatschek p hersen s ramanathan d r nelson proc natl acad sci usa 2007 104 19926 40 o hallatschek d r nelson phys today 2009 62 42 acknowledgements this work is supported by zhejiang university national natural science foundation of china and the research builds on research on the calibration of gene expression experiments funded by the uk bbsrc bb e 001742 1 we are grateful to comments from antonio marco on an earlier version of the manuscript author contributions x w conceived this research developed models implemented theoretical calculations and data analysis and wrote the paper a h evaluated the article provided revision suggestions and contributed to the writing all authors participated in discussion conflict of interest the authors declare no conflict of interest data and materials availability all calculation data and code are available from x w upon request 7 figure 1 group strategy gs for the evolution of cooperation in prisoner s dilemma within one dimensional finite populations a evolution of cooperation under different gs levels initial frequency f 0 0 5 0 1 population size n 30 b variation of benefit of the group strategy with the gs level c the lowest gs levels taken for the evolution of cooperation under various benefit elevating gradients f 0 0 5 n 30 d the phase diagram for the evolution of cooperation 0 1 f 0 0 5 e heat map of the lowest gs levels taken for the evolution of cooperation for varying population size n and initial frequency f 0 0 1 f the lowest gs level taken by cooperators for survival under different levels of gss taken by defectors f 0 0 5 n 30 g heat map of the lowest gs levels for varying c a and d b f 0 0 5 n 30 0 1 elements benefits a and d are respectively the inherent growth rates of species a and b b is the additional fitness b imposed on a and c is that a imposed on b both b and c only arise from social interactions between a and b default benefits in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 migration number mn 2 per generation periodic boundary conditions are used each data point is tested for 10 rounds 0 1 a y x c d k eg k b c population size n y x nan evolve lose d n f 0 4 5 6 7 9 14 12 10 8 lose evolve e defector cooperator f payoff matrix a cooperation b defection a b a b a b c d prisoner s dilemma a c and b d a b a b 0 3 0 0 5 0 1 0 1 g c a d b 8 figure 2 2 d on lattice simulation of the radial microbial range expansion e coli strains chemotaxis effect on the evolution of cooperation in prisoner s dilemma a evolutionary games with the incorporation of chemotaxis of single cooperators and lower migration rate of individuals m 0 1 h 1 cooperation can be selected in biological range expansion if the spatial segregation between cooperators and defectors can be established in a timely manner 19 e g under the low migration rates which means less frequent encounters with defectors when the chemotaxis of cooperators is incorporated with an increase in chemotaxis strength evolutionary outcome is observed to transition from cooperation to defection b evolutionary games with the incorporation of chemotaxis of single defectors and higher migration rate of individuals m 0 5 h 1 defection is selected under a higher migration rate of individuals when no chemotaxis is involved with the incorporation of chemotaxis of defectors and the increase in chemotaxis strength natural selection increasingly favors cooperation c d illustration of the discrepancy between individual and population level profits at the expanding frontier c chemotaxis of cooperators cooperators might move into a deme location where no defectors exist but several cooperators might exist which reduces the probability of them colonizing virgin space in advance in considering the prisoner s dilemma however the evolutionary advantage for cooperation is to colonize virgin space in the range expansion direction cooperation may not be favored by competition in such cases d chemotaxis of defectors defectors are more likely to move into the demes with more cooperators which will leave aside a minor of cooperators which are at low density to survive and reproduce defectors will be always directed by cooperators in this case and are therefore in passive position in evolution parameters ka and kb represent the chemotaxis strength the population size of each deme n 20 growth rates in the payoff matrix are respectively 0 3 h 1 0 0 5 h 1 and 0 1 h 1 see supporting information for methods and the precision of our models chemotaxis of cooperators chemotaxis of defectors low migration rate m 0 1 h 1 cooperator defector a b high migration rate m 0 5 h 1 e x p a n s io n d ir e c ti o n c d defector cooperator chemotactic direction strategic direction ka 1 2 ka 1 5 ka 0 3 kb 0 3 kb 1 kb 0 1 kb 0 05 kb 0 frequency ka 0 frequency ka 0 1 9 figure 3 group strategy and non kin selection effect in well mixed finite populations a cooperation is increasingly favored with the higher level of group strategy taken initial frequency f 0 0 5 benefit gradient 0 1 and the population size n 30 b effect of the population size on the evolution of cooperation cooperation can be maintained within a large range of population size n initial frequency f 0 0 5 0 1 6 c effect of kin selection strength ckin on the terminal number distribution of cooperator genotypes in the whole population initial number of cooperator genotypes in the population is equal to that in the gene pool ngety 15 with the increase in kin selection impact fewer cooperator genotypes are preserved after a long period of evolution f 0 0 5 0 1 6 n 30 n 50 n 100 n 10 n 20 5 6 1 3 ckin 0 7 rounds 1 10 5 ckin 0 99 rounds 1 10 5 ckin 0 95 rs 1 10 5 a b ckin 0 1 rounds 1 10 5 c residual getys 14 residues 4 residual getys 10 residual getys 2 10 figure 4 the evolution of social cooperation in well mixed finite populations a illustration of the evolutionary model for repeated social games b d kin selection effect b evolution of total numbers of cooperators and their genotypes with the number of game rounds c the final frequency distribution of cooperator genotypes d evolution of the frequency distribution of cooperator genotypes within the cooperator group e g non kin selection effect e evolution of total numbers of cooperators and their genotypes f the frequency distribution of cooperator genotypes at the game rounds 1 10 5 g evolution of the frequency distribution of cooperator genotypes h effect of kin selection strength ckin on the evolution of the total number of cooperator genotypes i heat map of the number of preserved cooperator genotypes ngt for varying population size n and kin selection strength ckin each data point is tested for 5 rounds j qualitative categories of kin selection effect in the living world the default population size n 30 initial cooperator frequency f 0 0 5 and the total number of cooperator genotypes in the gene pool ngety 15 elements scores in the payoff matrix are respectively 0 3 0 0 5 and 0 1 only cooperators take the group strategy gs and the gs level taken here 6 0 1 cooperators gene pool 1 genotypes defectors gene pool 2 genotypes a ckin 1 1 b ckin 1 kin selection c ckin 0 non kin selection e f rounds 1 105 g h d i n ckin n gt ckin r e la te d n e ss 0 0 9 0 99 1 1 j human an im a ls m ic ro b e s 0 8 1 0 0 8 a b a b a b c d a c and b d 11 figure 5 a the impact of non kin selection on the number of preserved cooperator genotypes is observed to obey a simple threshold function law within a large range of population size n once kin selection impact ckin is beyond a certain threshold kkin there will be a prominent reduction in preserved cooperator genotypes each data point is tested for 5 rounds b variation of the parameter a in the threshold function with the population size n c d variation of the threshold value kkin that corresponds to prominent kin selection impact as a function of n plotted on c linear and d semi logarithmic axes 1 kkin is observed to exponentially decay as n is the characteristic population size 0 3798 36 67 0 5 10 15 0 0 2 0 4 0 6 0 8 1 n g t ckin n 16 n 30 n 50 n 100 formula formula formula formula a 10 11 12 13 14 15 0 30 60 90 120 p a ra m e te r a population size n simulation y x b 0 5 0 6 0 7 0 8 0 9 1 0 30 60 90 120 t h re s h o ld v a lu e k k in population size n simulation a fit y 1 e c 0 01 0 1 0 30 60 90 120 1 k k in population size n simulation a fit y e d